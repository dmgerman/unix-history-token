begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*********************************************************************** ** ** Generate Skein rotation constant candidate sets and test them. ** ** Source code author: Doug Whiting, 2008. ** ** This algorithm and source code is released to the public domain. ** ************************************************************************/
end_comment

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<time.h>
end_include

begin_include
include|#
directive|include
file|<ctype.h>
end_include

begin_include
include|#
directive|include
file|<math.h>
end_include

begin_include
include|#
directive|include
file|<assert.h>
end_include

begin_include
include|#
directive|include
file|"brg_types.h"
end_include

begin_comment
comment|/* get Brian Gladman's platform-specific definitions */
end_comment

begin_define
define|#
directive|define
name|uint
value|unsigned int
end_define

begin_define
define|#
directive|define
name|u08b
value|uint_8t
end_define

begin_define
define|#
directive|define
name|u32b
value|uint_32t
end_define

begin_define
define|#
directive|define
name|u64b
value|uint_64t
end_define

begin_comment
comment|/* Threefish algorithm parameters */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|BITS_PER_WORD
end_ifndef

begin_define
define|#
directive|define
name|BITS_PER_WORD
value|(64)
end_define

begin_comment
comment|/* number of bits in each word of a Threefish block */
end_comment

begin_endif
endif|#
directive|endif
end_endif

begin_define
define|#
directive|define
name|ROUNDS_PER_CYCLE
value|(8)
end_define

begin_comment
comment|/* when do we inject keys and start reusing rotation constants? */
end_comment

begin_define
define|#
directive|define
name|MAX_BITS_PER_BLK
value|(1024)
end_define

begin_define
define|#
directive|define
name|MAX_WORDS_PER_BLK
value|(MAX_BITS_PER_BLK/BITS_PER_WORD)
end_define

begin_define
define|#
directive|define
name|MAX_ROTS_PER_CYCLE
value|(MAX_WORDS_PER_BLK*(ROUNDS_PER_CYCLE/2))
end_define

begin_comment
comment|/* default search parameters for different block sizes */
end_comment

begin_define
define|#
directive|define
name|DEFAULT_GEN_CNT_4
value|(5500)
end_define

begin_define
define|#
directive|define
name|DEFAULT_ROUND_CNT_4
value|( 8)
end_define

begin_define
define|#
directive|define
name|MIN_HW_OR_4
value|(50)
end_define

begin_define
define|#
directive|define
name|MAX_SAT_ROUNDS_4
value|( 9)
end_define

begin_define
define|#
directive|define
name|DEFAULT_GEN_CNT_8
value|(1600)
end_define

begin_define
define|#
directive|define
name|DEFAULT_ROUND_CNT_8
value|( 8)
end_define

begin_define
define|#
directive|define
name|MIN_HW_OR_8
value|(36)
end_define

begin_define
define|#
directive|define
name|MAX_SAT_ROUNDS_8
value|(10)
end_define

begin_define
define|#
directive|define
name|DEFAULT_GEN_CNT_16
value|(400)
end_define

begin_comment
comment|/* the 1024-bit search is slower, so search for fewer iterations :-( */
end_comment

begin_define
define|#
directive|define
name|DEFAULT_ROUND_CNT_16
value|( 9)
end_define

begin_define
define|#
directive|define
name|MIN_HW_OR_16
value|(40)
end_define

begin_define
define|#
directive|define
name|MAX_SAT_ROUNDS_16
value|(11)
end_define

begin_define
define|#
directive|define
name|MAX_ROT_VER_CNT
value|( 4)
end_define

begin_define
define|#
directive|define
name|MAX_ROT_VER_MASK
value|((1<< MAX_ROT_VER_CNT ) - 1)
end_define

begin_define
define|#
directive|define
name|MAX_POP_CNT
value|(1024)
end_define

begin_comment
comment|/* size of population */
end_comment

begin_define
define|#
directive|define
name|MIN_POP_CNT
value|(  32)
end_define

begin_define
define|#
directive|define
name|DEFAULT_POP_CNT
value|(MAX_POP_CNT)
end_define

begin_define
define|#
directive|define
name|ID_RECALC_BIT_NUM
value|(16)
end_define

begin_define
define|#
directive|define
name|TWIDDLE_CNT_BIT0
value|(17)
end_define

begin_define
define|#
directive|define
name|TWIDDLE_CNT_MASK
value|((1<< TWIDDLE_CNT_BIT0  ) - 1)
end_define

begin_define
define|#
directive|define
name|ID_RECALC_BIT
value|( 1<< ID_RECALC_BIT_NUM )
end_define

begin_define
define|#
directive|define
name|ID_NUM_MASK
value|((1<< ID_RECALC_BIT_NUM ) - 1)
end_define

begin_if
if|#
directive|if
name|BITS_PER_WORD
operator|==
literal|64
end_if

begin_typedef
typedef|typedef
name|u64b
name|Word
typedef|;
end_typedef

begin_elif
elif|#
directive|elif
name|BITS_PER_WORD
operator|==
literal|32
end_elif

begin_typedef
typedef|typedef
name|u32b
name|Word
typedef|;
end_typedef

begin_else
else|#
directive|else
end_else

begin_error
error|#
directive|error
literal|"Invalid BITS_PER_WORD"
end_error

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* tstFlag bits */
end_comment

begin_define
define|#
directive|define
name|TST_FLG_SHOW
value|(1u<< 0)
end_define

begin_define
define|#
directive|define
name|TST_FLG_SHOW_HIST
value|(1u<< 1)
end_define

begin_define
define|#
directive|define
name|TST_FLG_VERBOSE
value|(1u<< 2)
end_define

begin_define
define|#
directive|define
name|TST_FLG_STDERR
value|(1u<< 3)
end_define

begin_define
define|#
directive|define
name|TST_FLG_QUICK_EXIT
value|(1u<< 4)
end_define

begin_define
define|#
directive|define
name|TST_FLG_USE_ABS
value|(1u<< 5)
end_define

begin_define
define|#
directive|define
name|TST_FLG_KEEP_MIN_HW
value|(1u<< 6)
end_define

begin_define
define|#
directive|define
name|TST_FLG_WEIGHT_REP
value|(1u<< 7)
end_define

begin_define
define|#
directive|define
name|TST_FLG_CHECK_ONE
value|(1u<< 8)
end_define

begin_define
define|#
directive|define
name|TST_FLG_DO_RAND
value|(1u<< 9)
end_define

begin_comment
comment|/* parameters for ShowSearchRec */
end_comment

begin_define
define|#
directive|define
name|SHOW_ROTS_FINAL
value|(4)
end_define

begin_define
define|#
directive|define
name|SHOW_ROTS_H
value|(3)
end_define

begin_define
define|#
directive|define
name|SHOW_ROTS_PRELIM
value|(2)
end_define

begin_define
define|#
directive|define
name|SHOW_ROTS
value|(1)
end_define

begin_define
define|#
directive|define
name|SHOW_NONE
value|(0)
end_define

begin_typedef
typedef|typedef
struct|struct
block|{
name|Word
name|x
index|[
name|MAX_WORDS_PER_BLK
index|]
decl_stmt|;
block|}
name|Block
typedef|;
end_typedef

begin_typedef
typedef|typedef
name|void
name|cycle_func
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
function_decl|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
comment|/* record for dealing with rotation searches */
block|{
name|u08b
name|rotList
index|[
name|MAX_ROTS_PER_CYCLE
index|]
decl_stmt|;
comment|/* rotation constants */
name|uint
name|CRC
decl_stmt|;
comment|/* CRC of rotates[] -- use as a quick "ID" */
name|uint
name|ID
decl_stmt|;
comment|/* (get_rotation index) + (TwiddleCnt<< TWIDDLE_CNT_BIT0) */
name|uint
name|parentCRC
decl_stmt|;
comment|/* CRC of the parent (allows us to track genealogy a bit) */
name|uint
name|rWorst
decl_stmt|;
comment|/* "worst" min bit-to-bit differential */
name|u08b
name|hw_OR
index|[
name|MAX_ROT_VER_CNT
index|]
decl_stmt|;
comment|/* min hamming weights (over all words), using OR */
block|}
name|rSearchRec
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
comment|/* pass a bunch of parameters to RunSearch */
block|{
name|uint
name|tstFlags
decl_stmt|;
name|uint
name|rounds
decl_stmt|;
name|uint
name|minHW_or
decl_stmt|;
name|uint
name|minOffs
decl_stmt|;
name|uint
name|diffBits
decl_stmt|;
name|uint
name|genCntMax
decl_stmt|;
name|uint
name|sampleCnt
decl_stmt|;
name|uint
name|maxSatRnds
decl_stmt|;
name|uint
name|seed0
decl_stmt|;
name|uint
name|rotVerMask
decl_stmt|;
name|uint
name|popCnt
decl_stmt|;
name|uint
name|runHours
decl_stmt|;
comment|/* 0 ==> never */
name|uint
name|dupRotMask
decl_stmt|;
comment|/* zero --> allow dup rots within the same round */
name|uint
name|regradeCnt
decl_stmt|;
comment|/* default = 3 */
name|u64b
name|goodRotCntMask
decl_stmt|;
comment|/* which rotation values are ok? */
block|}
name|testParms
typedef|;
end_typedef

begin_comment
comment|/* globals */
end_comment

begin_decl_stmt
name|cycle_func
modifier|*
name|fwd_cycle
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|cycle_func
modifier|*
name|rev_cycle
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|cycle_func
modifier|*
name|fwd_cycle_or
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* slow but steady */
end_comment

begin_decl_stmt
name|cycle_func
modifier|*
name|rev_cycle_or
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|cycle_func
modifier|*
name|fwd_cycle_or_rN
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* optimized for the current # rounds (for speed) */
end_comment

begin_decl_stmt
name|cycle_func
modifier|*
name|rev_cycle_or_rN
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
name|rotFileName
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* read from file instead of generate random? */
end_comment

begin_decl_stmt
name|uint
name|bitsPerBlock
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* default is to process all block sizes */
end_comment

begin_decl_stmt
name|uint
name|rotsPerCycle
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint
name|wordsPerBlock
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* macro "functions" */
end_comment

begin_define
define|#
directive|define
name|RotCnt_Bad
parameter_list|(
name|rotCnt
parameter_list|)
value|(((t.goodRotCntMask>> (rotCnt))& 1) == 0)
end_define

begin_define
define|#
directive|define
name|left_rot
parameter_list|(
name|a
parameter_list|,
name|N
parameter_list|)
value|(((a)<< (N)) | ((a)>> (BITS_PER_WORD - (N))))
end_define

begin_define
define|#
directive|define
name|right_rot
parameter_list|(
name|a
parameter_list|,
name|N
parameter_list|)
value|(((a)>> (N)) | ((a)<< (BITS_PER_WORD - (N))))
end_define

begin_define
define|#
directive|define
name|DUP_64
parameter_list|(
name|w32
parameter_list|)
value|((w32) | (((u64b) (w32))<< 32))
end_define

begin_comment
comment|/********************** use RC4 to generate test data ******************/
end_comment

begin_comment
comment|/* Note: this works identically on all platforms (big/little-endian)   */
end_comment

begin_struct
specifier|static
struct|struct
block|{
name|uint
name|I
decl_stmt|,
name|J
decl_stmt|;
comment|/* RC4 vars */
name|u08b
name|state
index|[
literal|256
index|]
decl_stmt|;
block|}
name|prng
struct|;
end_struct

begin_function
name|void
name|RandBytes
parameter_list|(
name|void
modifier|*
name|dst
parameter_list|,
name|uint
name|byteCnt
parameter_list|)
block|{
name|u08b
name|a
decl_stmt|,
name|b
decl_stmt|;
name|u08b
modifier|*
name|d
init|=
operator|(
name|u08b
operator|*
operator|)
name|dst
decl_stmt|;
for|for
control|(
init|;
name|byteCnt
condition|;
name|byteCnt
operator|--
operator|,
name|d
operator|++
control|)
comment|/* run RC4  */
block|{
name|prng
operator|.
name|I
operator|=
operator|(
name|prng
operator|.
name|I
operator|+
literal|1
operator|)
operator|&
literal|0xFF
expr_stmt|;
name|a
operator|=
name|prng
operator|.
name|state
index|[
name|prng
operator|.
name|I
index|]
expr_stmt|;
name|prng
operator|.
name|J
operator|=
operator|(
name|prng
operator|.
name|J
operator|+
name|a
operator|)
operator|&
literal|0xFF
expr_stmt|;
name|b
operator|=
name|prng
operator|.
name|state
index|[
name|prng
operator|.
name|J
index|]
expr_stmt|;
name|prng
operator|.
name|state
index|[
name|prng
operator|.
name|I
index|]
operator|=
name|b
expr_stmt|;
name|prng
operator|.
name|state
index|[
name|prng
operator|.
name|J
index|]
operator|=
name|a
expr_stmt|;
operator|*
name|d
operator|=
name|prng
operator|.
name|state
index|[
operator|(
name|a
operator|+
name|b
operator|)
operator|&
literal|0xFF
index|]
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* get a pseudo-random 8-bit integer */
end_comment

begin_function
name|uint
name|Rand08
parameter_list|(
name|void
parameter_list|)
block|{
name|u08b
name|b
decl_stmt|;
name|RandBytes
argument_list|(
operator|&
name|b
argument_list|,
literal|1
argument_list|)
expr_stmt|;
return|return
operator|(
name|uint
operator|)
name|b
return|;
block|}
end_function

begin_comment
comment|/* get a pseudo-random 32-bit integer in a portable way */
end_comment

begin_function
name|uint
name|Rand32
parameter_list|(
name|void
parameter_list|)
block|{
name|uint
name|i
decl_stmt|,
name|n
decl_stmt|;
name|u08b
name|tmp
index|[
sizeof|sizeof
argument_list|(
name|uint
argument_list|)
index|]
decl_stmt|;
name|RandBytes
argument_list|(
name|tmp
argument_list|,
sizeof|sizeof
argument_list|(
name|tmp
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
name|n
operator|=
literal|0
init|;
name|i
operator|<
sizeof|sizeof
argument_list|(
name|tmp
argument_list|)
condition|;
name|i
operator|++
control|)
name|n
operator|=
name|n
operator|*
literal|256
operator|+
name|tmp
index|[
name|i
index|]
expr_stmt|;
return|return
name|n
return|;
block|}
end_function

begin_comment
comment|/* get a pseudo-random 64-bit integer in a portable way */
end_comment

begin_function
name|u64b
name|Rand64
parameter_list|(
name|void
parameter_list|)
block|{
name|uint
name|i
decl_stmt|;
name|u64b
name|n
decl_stmt|;
name|u08b
name|tmp
index|[
sizeof|sizeof
argument_list|(
name|u64b
argument_list|)
index|]
decl_stmt|;
name|RandBytes
argument_list|(
name|tmp
argument_list|,
sizeof|sizeof
argument_list|(
name|tmp
argument_list|)
argument_list|)
expr_stmt|;
name|n
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
sizeof|sizeof
argument_list|(
name|tmp
argument_list|)
condition|;
name|i
operator|++
control|)
name|n
operator|=
name|n
operator|*
literal|256
operator|+
name|tmp
index|[
name|i
index|]
expr_stmt|;
return|return
name|n
return|;
block|}
end_function

begin_comment
comment|/* init the (RC4-based) prng */
end_comment

begin_function
name|void
name|Rand_Init
parameter_list|(
name|u64b
name|seed
parameter_list|)
block|{
name|uint
name|i
decl_stmt|,
name|j
decl_stmt|;
name|u08b
name|tmp
index|[
literal|4
operator|*
literal|256
index|]
decl_stmt|;
comment|/* init the "key" in an endian-independent fashion */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|8
condition|;
name|i
operator|++
control|)
name|tmp
index|[
name|i
index|]
operator|=
call|(
name|u08b
call|)
argument_list|(
name|seed
operator|>>
operator|(
literal|8
operator|*
name|i
operator|)
argument_list|)
expr_stmt|;
comment|/* initialize the permutation */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|256
condition|;
name|i
operator|++
control|)
name|prng
operator|.
name|state
index|[
name|i
index|]
operator|=
operator|(
name|u08b
operator|)
name|i
expr_stmt|;
comment|/* now run the RC4 key schedule */
for|for
control|(
name|i
operator|=
name|j
operator|=
literal|0
init|;
name|i
operator|<
literal|256
condition|;
name|i
operator|++
control|)
block|{
name|j
operator|=
operator|(
name|j
operator|+
name|prng
operator|.
name|state
index|[
name|i
index|]
operator|+
name|tmp
index|[
name|i
operator|%
literal|8
index|]
operator|)
operator|&
literal|0xFF
expr_stmt|;
name|tmp
index|[
literal|256
index|]
operator|=
name|prng
operator|.
name|state
index|[
name|i
index|]
expr_stmt|;
name|prng
operator|.
name|state
index|[
name|i
index|]
operator|=
name|prng
operator|.
name|state
index|[
name|j
index|]
expr_stmt|;
name|prng
operator|.
name|state
index|[
name|j
index|]
operator|=
name|tmp
index|[
literal|256
index|]
expr_stmt|;
block|}
name|prng
operator|.
name|I
operator|=
name|prng
operator|.
name|J
operator|=
literal|0
expr_stmt|;
comment|/* init I,J variables for RC4 */
comment|/* discard some initial RC4 keystream before returning */
name|RandBytes
argument_list|(
name|tmp
argument_list|,
sizeof|sizeof
argument_list|(
name|tmp
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* implementations of Skein round functions for various block sizes */
end_comment

begin_function
name|void
name|fwd_cycle_16
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
for|for
control|(
init|;
name|rounds
operator|>
literal|0
condition|;
name|rounds
operator|-=
literal|8
control|)
block|{
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|+=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|+=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|8
index|]
operator|+=
name|b
index|[
literal|9
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|^=
name|b
index|[
literal|8
index|]
expr_stmt|;
name|b
index|[
literal|10
index|]
operator|+=
name|b
index|[
literal|11
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|^=
name|b
index|[
literal|10
index|]
expr_stmt|;
name|b
index|[
literal|12
index|]
operator|+=
name|b
index|[
literal|13
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|^=
name|b
index|[
literal|12
index|]
expr_stmt|;
name|b
index|[
literal|14
index|]
operator|+=
name|b
index|[
literal|15
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|^=
name|b
index|[
literal|14
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|1
condition|)
break|break;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|9
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|13
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|+=
name|b
index|[
literal|11
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|+=
name|b
index|[
literal|15
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|10
index|]
operator|+=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|10
index|]
expr_stmt|;
name|b
index|[
literal|12
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|12
index|]
expr_stmt|;
name|b
index|[
literal|14
index|]
operator|+=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|14
index|]
expr_stmt|;
name|b
index|[
literal|8
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|8
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|2
condition|)
break|break;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|16
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|17
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|18
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|19
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|12
index|]
operator|+=
name|b
index|[
literal|15
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|20
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|^=
name|b
index|[
literal|12
index|]
expr_stmt|;
name|b
index|[
literal|14
index|]
operator|+=
name|b
index|[
literal|13
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|21
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|^=
name|b
index|[
literal|14
index|]
expr_stmt|;
name|b
index|[
literal|8
index|]
operator|+=
name|b
index|[
literal|11
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|22
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|^=
name|b
index|[
literal|8
index|]
expr_stmt|;
name|b
index|[
literal|10
index|]
operator|+=
name|b
index|[
literal|9
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|23
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|^=
name|b
index|[
literal|10
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|3
condition|)
break|break;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|15
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|24
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|11
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|25
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|+=
name|b
index|[
literal|13
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|26
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|+=
name|b
index|[
literal|9
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|27
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|14
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|28
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|14
index|]
expr_stmt|;
name|b
index|[
literal|8
index|]
operator|+=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|29
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|8
index|]
expr_stmt|;
name|b
index|[
literal|10
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|30
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|10
index|]
expr_stmt|;
name|b
index|[
literal|12
index|]
operator|+=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|31
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|12
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|4
condition|)
break|break;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|32
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|33
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|+=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|34
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|+=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|35
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|8
index|]
operator|+=
name|b
index|[
literal|9
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|36
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|^=
name|b
index|[
literal|8
index|]
expr_stmt|;
name|b
index|[
literal|10
index|]
operator|+=
name|b
index|[
literal|11
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|37
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|^=
name|b
index|[
literal|10
index|]
expr_stmt|;
name|b
index|[
literal|12
index|]
operator|+=
name|b
index|[
literal|13
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|38
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|^=
name|b
index|[
literal|12
index|]
expr_stmt|;
name|b
index|[
literal|14
index|]
operator|+=
name|b
index|[
literal|15
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|39
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|^=
name|b
index|[
literal|14
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|5
condition|)
break|break;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|9
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|40
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|13
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|41
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|+=
name|b
index|[
literal|11
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|42
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|+=
name|b
index|[
literal|15
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|43
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|10
index|]
operator|+=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|44
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|10
index|]
expr_stmt|;
name|b
index|[
literal|12
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|45
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|12
index|]
expr_stmt|;
name|b
index|[
literal|14
index|]
operator|+=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|46
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|14
index|]
expr_stmt|;
name|b
index|[
literal|8
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|47
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|8
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|6
condition|)
break|break;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|48
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|49
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|50
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|51
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|12
index|]
operator|+=
name|b
index|[
literal|15
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|52
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|^=
name|b
index|[
literal|12
index|]
expr_stmt|;
name|b
index|[
literal|14
index|]
operator|+=
name|b
index|[
literal|13
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|53
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|^=
name|b
index|[
literal|14
index|]
expr_stmt|;
name|b
index|[
literal|8
index|]
operator|+=
name|b
index|[
literal|11
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|54
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|^=
name|b
index|[
literal|8
index|]
expr_stmt|;
name|b
index|[
literal|10
index|]
operator|+=
name|b
index|[
literal|9
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|55
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|^=
name|b
index|[
literal|10
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|7
condition|)
break|break;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|15
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|56
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|11
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|57
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|+=
name|b
index|[
literal|13
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|58
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|+=
name|b
index|[
literal|9
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|59
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|14
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|60
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|14
index|]
expr_stmt|;
name|b
index|[
literal|8
index|]
operator|+=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|61
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|8
index|]
expr_stmt|;
name|b
index|[
literal|10
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|62
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|10
index|]
expr_stmt|;
name|b
index|[
literal|12
index|]
operator|+=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|63
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|12
index|]
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|fwd_cycle_8
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
for|for
control|(
init|;
name|rounds
operator|>
literal|0
condition|;
name|rounds
operator|-=
literal|8
control|)
block|{
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|+=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|+=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|1
condition|)
break|break;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|+=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|+=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|2
condition|)
break|break;
name|b
index|[
literal|4
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|3
condition|)
break|break;
name|b
index|[
literal|6
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|4
condition|)
break|break;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|16
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|17
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|+=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|18
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|+=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|19
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|5
condition|)
break|break;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|20
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|+=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|21
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|+=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|22
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|23
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|6
condition|)
break|break;
name|b
index|[
literal|4
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|24
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|25
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|26
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|27
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|7
condition|)
break|break;
name|b
index|[
literal|6
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|28
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|29
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|30
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|31
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|fwd_cycle_4
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
for|for
control|(
init|;
name|rounds
operator|>
literal|0
condition|;
name|rounds
operator|-=
literal|8
control|)
block|{
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|1
condition|)
break|break;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|2
condition|)
break|break;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|3
condition|)
break|break;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|4
condition|)
break|break;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|5
condition|)
break|break;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|6
condition|)
break|break;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|7
condition|)
break|break;
name|b
index|[
literal|0
index|]
operator|+=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|+=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* reverse versions of the cipher */
end_comment

begin_function
name|void
name|rev_cycle_16
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
for|for
control|(
init|;
name|rounds
operator|>
literal|0
condition|;
name|rounds
operator|=
operator|(
name|rounds
operator|-
literal|1
operator|)
operator|&
operator|~
literal|7
control|)
block|{
switch|switch
condition|(
name|rounds
operator|&
literal|7
condition|)
block|{
case|case
literal|0
case|:
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|12
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|63
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|12
index|]
operator|-=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|10
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|62
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|10
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|8
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|61
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|8
index|]
operator|-=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|14
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|60
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|14
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|59
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|-=
name|b
index|[
literal|9
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|58
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|-=
name|b
index|[
literal|13
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|57
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|11
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|56
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|15
index|]
expr_stmt|;
case|case
literal|7
case|:
name|b
index|[
literal|9
index|]
operator|^=
name|b
index|[
literal|10
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|55
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|10
index|]
operator|-=
name|b
index|[
literal|9
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|^=
name|b
index|[
literal|8
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|54
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|8
index|]
operator|-=
name|b
index|[
literal|11
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|^=
name|b
index|[
literal|14
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|53
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|14
index|]
operator|-=
name|b
index|[
literal|13
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|^=
name|b
index|[
literal|12
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|52
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|12
index|]
operator|-=
name|b
index|[
literal|15
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|51
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|50
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|49
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|48
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|7
index|]
expr_stmt|;
case|case
literal|6
case|:
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|8
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|47
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|8
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|14
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|46
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|14
index|]
operator|-=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|12
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|45
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|12
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|10
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|44
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|10
index|]
operator|-=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|43
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|-=
name|b
index|[
literal|15
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|42
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|-=
name|b
index|[
literal|11
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|41
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|13
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|40
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|9
index|]
expr_stmt|;
case|case
literal|5
case|:
name|b
index|[
literal|15
index|]
operator|^=
name|b
index|[
literal|14
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|39
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|14
index|]
operator|-=
name|b
index|[
literal|15
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|^=
name|b
index|[
literal|12
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|38
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|12
index|]
operator|-=
name|b
index|[
literal|13
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|^=
name|b
index|[
literal|10
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|37
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|10
index|]
operator|-=
name|b
index|[
literal|11
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|^=
name|b
index|[
literal|8
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|36
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|8
index|]
operator|-=
name|b
index|[
literal|9
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|35
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|-=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|34
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|-=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|33
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|32
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
case|case
literal|4
case|:
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|12
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|31
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|12
index|]
operator|-=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|10
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|30
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|10
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|8
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|29
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|8
index|]
operator|-=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|14
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|28
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|14
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|27
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|-=
name|b
index|[
literal|9
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|26
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|-=
name|b
index|[
literal|13
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|25
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|11
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|24
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|15
index|]
expr_stmt|;
case|case
literal|3
case|:
name|b
index|[
literal|9
index|]
operator|^=
name|b
index|[
literal|10
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|23
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|10
index|]
operator|-=
name|b
index|[
literal|9
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|^=
name|b
index|[
literal|8
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|22
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|8
index|]
operator|-=
name|b
index|[
literal|11
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|^=
name|b
index|[
literal|14
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|21
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|14
index|]
operator|-=
name|b
index|[
literal|13
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|^=
name|b
index|[
literal|12
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|20
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|12
index|]
operator|-=
name|b
index|[
literal|15
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|19
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|18
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|17
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|16
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|7
index|]
expr_stmt|;
case|case
literal|2
case|:
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|8
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|8
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|14
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|14
index|]
operator|-=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|12
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|12
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|10
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|10
index|]
operator|-=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|-=
name|b
index|[
literal|15
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|-=
name|b
index|[
literal|11
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|13
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|9
index|]
expr_stmt|;
case|case
literal|1
case|:
name|b
index|[
literal|15
index|]
operator|^=
name|b
index|[
literal|14
index|]
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|14
index|]
operator|-=
name|b
index|[
literal|15
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|^=
name|b
index|[
literal|12
index|]
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|12
index|]
operator|-=
name|b
index|[
literal|13
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|^=
name|b
index|[
literal|10
index|]
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|10
index|]
operator|-=
name|b
index|[
literal|11
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|^=
name|b
index|[
literal|8
index|]
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|8
index|]
operator|-=
name|b
index|[
literal|9
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|-=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|-=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|rev_cycle_8
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
for|for
control|(
init|;
name|rounds
operator|>
literal|0
condition|;
name|rounds
operator|=
operator|(
name|rounds
operator|-
literal|1
operator|)
operator|&
operator|~
literal|7
control|)
block|{
switch|switch
condition|(
name|rounds
operator|&
literal|7
condition|)
block|{
case|case
literal|0
case|:
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|31
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|30
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|29
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|28
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
case|case
literal|7
case|:
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|27
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|26
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|25
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|24
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
case|case
literal|6
case|:
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|23
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|22
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|-=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|21
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|-=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|20
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
case|case
literal|5
case|:
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|19
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|-=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|18
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|-=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|17
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|16
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
case|case
literal|4
case|:
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
case|case
literal|3
case|:
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
case|case
literal|2
case|:
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|-=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|-=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
case|case
literal|1
case|:
name|b
index|[
literal|7
index|]
operator|^=
name|b
index|[
literal|6
index|]
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|6
index|]
operator|-=
name|b
index|[
literal|7
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|^=
name|b
index|[
literal|4
index|]
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|4
index|]
operator|-=
name|b
index|[
literal|5
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|rev_cycle_4
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
for|for
control|(
init|;
name|rounds
operator|>
literal|0
condition|;
name|rounds
operator|=
operator|(
name|rounds
operator|-
literal|1
operator|)
operator|&
operator|~
literal|7
control|)
block|{
switch|switch
condition|(
name|rounds
operator|&
literal|7
condition|)
block|{
case|case
literal|0
case|:
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
case|case
literal|7
case|:
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
case|case
literal|6
case|:
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
case|case
literal|5
case|:
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
case|case
literal|4
case|:
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
case|case
literal|3
case|:
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
case|case
literal|2
case|:
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
case|case
literal|1
case|:
name|b
index|[
literal|3
index|]
operator|^=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|2
index|]
operator|-=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|^=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|b
index|[
literal|0
index|]
operator|-=
name|b
index|[
literal|1
index|]
expr_stmt|;
block|}
block|}
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|TEST_OR
end_ifdef

begin_comment
comment|/* enable this to simplify testing, since OR is not invertible */
end_comment

begin_define
define|#
directive|define
name|AddOp
parameter_list|(
name|I
parameter_list|,
name|J
parameter_list|)
value|b[I] += b[J]
end_define

begin_define
define|#
directive|define
name|SubOp
parameter_list|(
name|I
parameter_list|,
name|J
parameter_list|)
value|b[I] -= b[J]
end_define

begin_define
define|#
directive|define
name|XorOp
parameter_list|(
name|I
parameter_list|,
name|J
parameter_list|)
value|b[I] ^= b[J]
end_define

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* this is the "real" OR version */
end_comment

begin_define
define|#
directive|define
name|AddOp
parameter_list|(
name|I
parameter_list|,
name|J
parameter_list|)
value|b[I] |= b[J]
end_define

begin_define
define|#
directive|define
name|SubOp
parameter_list|(
name|I
parameter_list|,
name|J
parameter_list|)
value|b[I] |= b[J]
end_define

begin_define
define|#
directive|define
name|XorOp
parameter_list|(
name|I
parameter_list|,
name|J
parameter_list|)
value|b[I] |= b[J]
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* "OR" versions of the cipher: replace ADD, XOR with OR */
end_comment

begin_function
name|void
name|fwd_cycle_16_or
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
for|for
control|(
init|;
name|rounds
operator|>
literal|0
condition|;
name|rounds
operator|-=
literal|8
control|)
block|{
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|8
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|10
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|12
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|14
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|14
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|1
condition|)
break|break;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|10
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|12
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|14
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|8
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|8
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|2
condition|)
break|break;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|16
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|17
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|18
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|19
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|12
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|20
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|14
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|21
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|8
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|22
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|10
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|23
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|10
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|3
condition|)
break|break;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|24
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|25
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|26
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|27
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|14
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|28
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|8
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|29
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|10
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|30
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|12
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|31
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|12
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|4
condition|)
break|break;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|32
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|33
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|34
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|35
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|8
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|36
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|10
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|37
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|12
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|38
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|14
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|39
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|14
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|5
condition|)
break|break;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|40
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|41
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|42
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|43
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|10
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|44
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|12
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|45
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|14
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|46
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|8
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|47
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|8
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|6
condition|)
break|break;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|48
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|49
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|50
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|51
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|12
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|52
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|14
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|53
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|8
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|54
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|10
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|55
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|10
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|7
condition|)
break|break;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|56
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|57
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|58
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|59
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|14
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|60
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|8
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|61
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|10
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|62
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|12
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|63
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|12
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|fwd_cycle_8_or
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
for|for
control|(
init|;
name|rounds
operator|>
literal|0
condition|;
name|rounds
operator|-=
literal|8
control|)
block|{
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|1
condition|)
break|break;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|2
condition|)
break|break;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|2
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|3
condition|)
break|break;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|4
condition|)
break|break;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|16
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|17
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|18
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|19
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|5
condition|)
break|break;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|20
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|21
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|22
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|23
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|6
condition|)
break|break;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|24
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|25
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|26
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|27
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|2
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|7
condition|)
break|break;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|28
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|29
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|30
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|31
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|fwd_cycle_4_or
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
for|for
control|(
init|;
name|rounds
operator|>
literal|0
condition|;
name|rounds
operator|-=
literal|8
control|)
block|{
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|1
condition|)
break|break;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|2
condition|)
break|break;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|3
condition|)
break|break;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|4
condition|)
break|break;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|5
condition|)
break|break;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|6
condition|)
break|break;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
if|if
condition|(
name|rounds
operator|==
literal|7
condition|)
break|break;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* reverse versions of the cipher, using OR */
end_comment

begin_function
name|void
name|rev_cycle_16_or
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
for|for
control|(
init|;
name|rounds
operator|>
literal|0
condition|;
name|rounds
operator|=
operator|(
name|rounds
operator|-
literal|1
operator|)
operator|&
operator|~
literal|7
control|)
block|{
switch|switch
condition|(
name|rounds
operator|&
literal|7
condition|)
block|{
case|case
literal|0
case|:
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|63
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|12
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|62
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|10
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|61
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|8
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|60
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|14
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|59
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|58
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|57
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|56
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|15
argument_list|)
expr_stmt|;
case|case
literal|7
case|:
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|55
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|10
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|54
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|8
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|53
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|14
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|52
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|12
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|51
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|50
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|49
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|48
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|7
argument_list|)
expr_stmt|;
case|case
literal|6
case|:
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|47
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|8
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|46
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|14
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|45
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|12
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|44
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|10
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|43
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|42
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|41
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|40
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|9
argument_list|)
expr_stmt|;
case|case
literal|5
case|:
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|39
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|14
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|38
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|12
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|37
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|10
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|36
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|8
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|35
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|34
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|33
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|32
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
case|case
literal|4
case|:
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|31
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|12
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|30
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|10
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|29
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|8
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|28
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|14
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|27
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|26
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|25
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|24
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|15
argument_list|)
expr_stmt|;
case|case
literal|3
case|:
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|23
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|10
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|22
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|8
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|21
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|14
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|20
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|12
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|19
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|18
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|17
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|16
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|7
argument_list|)
expr_stmt|;
case|case
literal|2
case|:
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|8
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|14
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|12
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|10
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|9
argument_list|)
expr_stmt|;
case|case
literal|1
case|:
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|14
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|12
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|10
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|8
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|rev_cycle_8_or
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
for|for
control|(
init|;
name|rounds
operator|>
literal|0
condition|;
name|rounds
operator|=
operator|(
name|rounds
operator|-
literal|1
operator|)
operator|&
operator|~
literal|7
control|)
block|{
switch|switch
condition|(
name|rounds
operator|&
literal|7
condition|)
block|{
case|case
literal|0
case|:
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|31
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|30
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|29
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|28
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
case|case
literal|7
case|:
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|27
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|26
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|25
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|24
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|1
argument_list|)
expr_stmt|;
case|case
literal|6
case|:
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|23
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|22
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|21
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|20
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
case|case
literal|5
case|:
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|19
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|18
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|17
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|16
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
case|case
literal|4
case|:
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
case|case
literal|3
case|:
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|1
argument_list|)
expr_stmt|;
case|case
literal|2
case|:
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
case|case
literal|1
case|:
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|rev_cycle_4_or
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
for|for
control|(
init|;
name|rounds
operator|>
literal|0
condition|;
name|rounds
operator|=
operator|(
name|rounds
operator|-
literal|1
operator|)
operator|&
operator|~
literal|7
control|)
block|{
switch|switch
condition|(
name|rounds
operator|&
literal|7
condition|)
block|{
case|case
literal|0
case|:
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
case|case
literal|7
case|:
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
case|case
literal|6
case|:
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
case|case
literal|5
case|:
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
case|case
literal|4
case|:
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
case|case
literal|3
case|:
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
case|case
literal|2
case|:
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
case|case
literal|1
case|:
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_comment
comment|/* optimized versions for default round counts */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__BORLANDC__
argument_list|)
end_if

begin_pragma
pragma|#
directive|pragma
name|argsused
end_pragma

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|_MSC_VER
argument_list|)
end_elif

begin_pragma
pragma|#
directive|pragma
name|warning
name|(
name|disable
name|:
name|4100
name|)
end_pragma

begin_endif
endif|#
directive|endif
end_endif

begin_function
name|void
name|fwd_cycle_16_or_r9
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|8
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|10
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|12
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|14
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|10
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|12
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|14
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|8
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|16
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|17
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|18
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|19
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|12
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|20
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|14
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|21
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|8
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|22
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|10
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|23
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|24
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|25
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|26
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|27
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|14
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|28
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|8
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|29
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|10
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|30
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|12
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|31
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|32
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|33
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|34
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|35
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|8
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|36
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|10
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|37
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|12
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|38
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|14
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|39
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|40
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|41
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|42
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|43
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|10
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|44
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|12
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|45
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|14
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|46
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|8
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|47
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|48
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|49
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|50
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|51
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|12
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|52
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|14
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|53
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|8
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|54
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|10
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|55
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|56
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|57
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|58
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|59
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|14
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|60
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|8
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|61
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|10
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|62
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|12
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|63
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|8
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|10
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|12
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|14
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|14
argument_list|)
expr_stmt|;
block|}
end_function

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__BORLANDC__
argument_list|)
end_if

begin_pragma
pragma|#
directive|pragma
name|argsused
end_pragma

begin_endif
endif|#
directive|endif
end_endif

begin_function
name|void
name|fwd_cycle_8_or_r8
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|16
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|17
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|18
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|19
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|20
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|21
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|22
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|23
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|24
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|25
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|26
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|27
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|28
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|29
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|30
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|4
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|31
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|__BORLANDC__
end_ifdef

begin_pragma
pragma|#
directive|pragma
name|argsused
end_pragma

begin_endif
endif|#
directive|endif
end_endif

begin_function
name|void
name|fwd_cycle_4_or_r8
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AddOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|left_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* reverse versions of the cipher, using OR, for fixed round numbers */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|__BORLANDC__
end_ifdef

begin_pragma
pragma|#
directive|pragma
name|argsused
end_pragma

begin_endif
endif|#
directive|endif
end_endif

begin_function
name|void
name|rev_cycle_16_or_r9
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|14
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|12
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|10
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|8
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|63
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|12
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|62
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|10
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|61
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|8
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|60
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|14
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|59
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|58
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|57
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|56
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|55
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|10
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|54
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|8
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|53
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|14
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|52
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|12
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|51
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|50
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|49
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|48
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|47
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|8
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|46
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|14
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|45
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|12
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|44
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|10
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|43
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|42
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|41
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|40
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|39
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|14
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|38
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|12
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|37
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|10
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|36
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|8
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|35
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|34
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|33
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|32
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|31
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|12
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|30
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|10
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|29
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|8
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|28
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|14
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|27
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|26
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|25
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|24
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|23
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|10
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|22
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|8
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|21
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|14
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|20
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|12
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|19
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|18
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|17
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|16
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|8
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|14
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|12
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|10
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|15
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|b
index|[
literal|15
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|15
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|14
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|13
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|b
index|[
literal|13
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|13
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|12
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|11
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|b
index|[
literal|11
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|11
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|10
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|9
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|b
index|[
literal|9
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|9
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|8
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|__BORLANDC__
end_ifdef

begin_pragma
pragma|#
directive|pragma
name|argsused
end_pragma

begin_endif
endif|#
directive|endif
end_endif

begin_function
name|void
name|rev_cycle_8_or_r8
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|31
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|30
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|29
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|28
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|27
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|26
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|25
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|24
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|23
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|22
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|21
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|20
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|19
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|18
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|17
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|16
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|b
index|[
literal|7
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|7
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|6
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|b
index|[
literal|5
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|5
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|4
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|__BORLANDC__
end_ifdef

begin_pragma
pragma|#
directive|pragma
name|argsused
end_pragma

begin_endif
endif|#
directive|endif
end_endif

begin_function
name|void
name|rev_cycle_4_or_r8
parameter_list|(
name|Word
modifier|*
name|b
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|,
name|int
name|rounds
parameter_list|)
block|{
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|14
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|13
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|12
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|11
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|10
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|9
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|8
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|b
index|[
literal|3
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|3
index|]
argument_list|,
name|rotates
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XorOp
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|b
index|[
literal|1
index|]
operator|=
name|right_rot
argument_list|(
name|b
index|[
literal|1
index|]
argument_list|,
name|rotates
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|SubOp
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* test that fwd and rev ciphers are truly inverses */
end_comment

begin_function
name|void
name|InverseChecks
parameter_list|(
name|void
parameter_list|)
block|{
name|uint
name|i
decl_stmt|,
name|j
decl_stmt|,
name|k
decl_stmt|,
name|wCnt
decl_stmt|,
name|tstCnt
decl_stmt|;
name|int
name|r
decl_stmt|,
name|rN
decl_stmt|;
name|Block
name|pt
decl_stmt|,
name|ct
decl_stmt|,
name|xt
decl_stmt|;
name|u08b
name|rots
index|[
name|MAX_ROTS_PER_CYCLE
index|]
decl_stmt|;
name|uint
name|TEST_CNT
init|=
operator|(
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
operator|==
literal|8
operator|)
condition|?
literal|64
else|:
literal|8
decl_stmt|;
name|cycle_func
modifier|*
name|fwd
decl_stmt|;
name|cycle_func
modifier|*
name|rev
decl_stmt|;
name|cycle_func
modifier|*
name|fwd_or
decl_stmt|;
name|cycle_func
modifier|*
name|fwd_or_rN
decl_stmt|;
ifdef|#
directive|ifdef
name|TEST_OR
name|cycle_func
modifier|*
name|rev_or
decl_stmt|;
name|cycle_func
modifier|*
name|rev_or_rN
decl_stmt|;
endif|#
directive|endif
name|Rand_Init
argument_list|(
literal|0
argument_list|)
expr_stmt|;
for|for
control|(
name|wCnt
operator|=
literal|4
init|;
name|wCnt
operator|<=
name|MAX_WORDS_PER_BLK
condition|;
name|wCnt
operator|*=
literal|2
control|)
block|{
switch|switch
condition|(
name|wCnt
condition|)
block|{
case|case
literal|4
case|:
name|fwd
operator|=
name|fwd_cycle_4
expr_stmt|;
name|rev
operator|=
name|rev_cycle_4
expr_stmt|;
name|fwd_or
operator|=
name|fwd_cycle_4_or
expr_stmt|;
name|fwd_or_rN
operator|=
name|fwd_cycle_4_or_r8
expr_stmt|;
break|break;
case|case
literal|8
case|:
name|fwd
operator|=
name|fwd_cycle_8
expr_stmt|;
name|rev
operator|=
name|rev_cycle_8
expr_stmt|;
name|fwd_or
operator|=
name|fwd_cycle_8_or
expr_stmt|;
name|fwd_or_rN
operator|=
name|fwd_cycle_8_or_r8
expr_stmt|;
break|break;
default|default:
name|fwd
operator|=
name|fwd_cycle_16
expr_stmt|;
name|rev
operator|=
name|rev_cycle_16
expr_stmt|;
name|fwd_or
operator|=
name|fwd_cycle_16_or
expr_stmt|;
name|fwd_or_rN
operator|=
name|fwd_cycle_16_or_r9
expr_stmt|;
break|break;
block|}
ifdef|#
directive|ifdef
name|TEST_OR
switch|switch
condition|(
name|wCnt
condition|)
block|{
case|case
literal|4
case|:
name|rev_or_rN
operator|=
name|rev_cycle_4_or_r8
expr_stmt|;
name|rev_or
operator|=
name|rev_cycle_4_or
expr_stmt|;
break|break;
case|case
literal|8
case|:
name|rev_or_rN
operator|=
name|rev_cycle_8_or_r8
expr_stmt|;
name|rev_or
operator|=
name|rev_cycle_8_or
expr_stmt|;
break|break;
default|default:
name|rev_or_rN
operator|=
name|rev_cycle_16_or_r9
expr_stmt|;
name|rev_or
operator|=
name|rev_cycle_16_or
expr_stmt|;
break|break;
block|}
endif|#
directive|endif
for|for
control|(
name|tstCnt
operator|=
literal|0
init|;
name|tstCnt
operator|<
name|TEST_CNT
condition|;
name|tstCnt
operator|++
control|)
block|{
if|if
condition|(
name|tstCnt
operator|==
literal|0
condition|)
block|{
name|memset
argument_list|(
name|pt
operator|.
name|x
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|pt
argument_list|)
argument_list|)
expr_stmt|;
comment|/* make the first test simple, for debug */
name|pt
operator|.
name|x
index|[
literal|0
index|]
operator|++
expr_stmt|;
block|}
else|else
name|RandBytes
argument_list|(
name|pt
operator|.
name|x
argument_list|,
name|wCnt
operator|*
sizeof|sizeof
argument_list|(
name|pt
operator|.
name|x
index|[
literal|0
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|RandBytes
argument_list|(
name|rots
argument_list|,
sizeof|sizeof
argument_list|(
name|rots
argument_list|)
argument_list|)
expr_stmt|;
comment|/* use random rotation constants */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|MAX_ROTS_PER_CYCLE
condition|;
name|i
operator|++
control|)
name|rots
index|[
name|i
index|]
operator|&=
operator|(
name|BITS_PER_WORD
operator|-
literal|1
operator|)
expr_stmt|;
for|for
control|(
name|r
operator|=
literal|1
init|;
name|r
operator|<
literal|32
condition|;
name|r
operator|++
control|)
block|{
name|ct
operator|=
name|pt
expr_stmt|;
name|rev
argument_list|(
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|r
argument_list|)
expr_stmt|;
name|fwd
argument_list|(
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|r
argument_list|)
expr_stmt|;
if|if
condition|(
name|memcmp
argument_list|(
name|pt
operator|.
name|x
argument_list|,
name|ct
operator|.
name|x
argument_list|,
name|wCnt
operator|*
sizeof|sizeof
argument_list|(
name|pt
operator|.
name|x
index|[
literal|0
index|]
argument_list|)
argument_list|)
condition|)
block|{
name|printf
argument_list|(
literal|"Inverse failure: #%03d: wCnt=%d. r=%2d"
argument_list|,
name|tstCnt
argument_list|,
name|wCnt
argument_list|,
name|r
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|8
argument_list|)
expr_stmt|;
block|}
name|fwd
argument_list|(
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|r
argument_list|)
expr_stmt|;
name|rev
argument_list|(
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|r
argument_list|)
expr_stmt|;
if|if
condition|(
name|memcmp
argument_list|(
name|pt
operator|.
name|x
argument_list|,
name|ct
operator|.
name|x
argument_list|,
name|wCnt
operator|*
sizeof|sizeof
argument_list|(
name|pt
operator|.
name|x
index|[
literal|0
index|]
argument_list|)
argument_list|)
condition|)
block|{
name|printf
argument_list|(
literal|"Inverse failure: #%03d: wCnt=%d. r=%2d"
argument_list|,
name|tstCnt
argument_list|,
name|wCnt
argument_list|,
name|r
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|8
argument_list|)
expr_stmt|;
block|}
ifdef|#
directive|ifdef
name|TEST_OR
name|fwd_or
argument_list|(
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|r
argument_list|)
expr_stmt|;
name|rev
argument_list|(
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|r
argument_list|)
expr_stmt|;
if|if
condition|(
name|memcmp
argument_list|(
name|pt
operator|.
name|x
argument_list|,
name|ct
operator|.
name|x
argument_list|,
name|wCnt
operator|*
sizeof|sizeof
argument_list|(
name|pt
operator|.
name|x
index|[
literal|0
index|]
argument_list|)
argument_list|)
condition|)
block|{
name|printf
argument_list|(
literal|"Inverse failure (fwd_or): #%03d: wCnt=%d. r=%2d"
argument_list|,
name|tstCnt
argument_list|,
name|wCnt
argument_list|,
name|r
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|8
argument_list|)
expr_stmt|;
block|}
name|fwd
argument_list|(
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|r
argument_list|)
expr_stmt|;
name|rev_or
argument_list|(
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|r
argument_list|)
expr_stmt|;
if|if
condition|(
name|memcmp
argument_list|(
name|pt
operator|.
name|x
argument_list|,
name|ct
operator|.
name|x
argument_list|,
name|wCnt
operator|*
sizeof|sizeof
argument_list|(
name|pt
operator|.
name|x
index|[
literal|0
index|]
argument_list|)
argument_list|)
condition|)
block|{
name|printf
argument_list|(
literal|"Inverse failure (rev_or): #%03d: wCnt=%d. r=%2d"
argument_list|,
name|tstCnt
argument_list|,
name|wCnt
argument_list|,
name|r
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|8
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|r
operator|!=
operator|(
operator|(
name|wCnt
operator|==
literal|16
operator|)
condition|?
literal|9
else|:
literal|8
operator|)
condition|)
continue|continue;
name|fwd_or_rN
argument_list|(
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|r
argument_list|)
expr_stmt|;
name|rev
argument_list|(
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|r
argument_list|)
expr_stmt|;
if|if
condition|(
name|memcmp
argument_list|(
name|pt
operator|.
name|x
argument_list|,
name|ct
operator|.
name|x
argument_list|,
name|wCnt
operator|*
sizeof|sizeof
argument_list|(
name|pt
operator|.
name|x
index|[
literal|0
index|]
argument_list|)
argument_list|)
condition|)
block|{
name|printf
argument_list|(
literal|"Inverse failure (fwd_or_rN): #%03d: wCnt=%d. r=%2d"
argument_list|,
name|tstCnt
argument_list|,
name|wCnt
argument_list|,
name|r
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|8
argument_list|)
expr_stmt|;
block|}
name|fwd
argument_list|(
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|r
argument_list|)
expr_stmt|;
name|rev_or_rN
argument_list|(
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|r
argument_list|)
expr_stmt|;
if|if
condition|(
name|memcmp
argument_list|(
name|pt
operator|.
name|x
argument_list|,
name|ct
operator|.
name|x
argument_list|,
name|wCnt
operator|*
sizeof|sizeof
argument_list|(
name|pt
operator|.
name|x
index|[
literal|0
index|]
argument_list|)
argument_list|)
condition|)
block|{
name|printf
argument_list|(
literal|"Inverse failure (rev_or_rN): #%03d: wCnt=%d. r=%2d"
argument_list|,
name|tstCnt
argument_list|,
name|wCnt
argument_list|,
name|r
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|8
argument_list|)
expr_stmt|;
block|}
else|#
directive|else
comment|/* validate that "quick" Hamming weight checks are ok, using OR */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|wCnt
condition|;
name|i
operator|++
control|)
block|{
name|memset
argument_list|(
name|ct
operator|.
name|x
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|ct
operator|.
name|x
argument_list|)
argument_list|)
expr_stmt|;
name|ct
operator|.
name|x
index|[
name|i
index|]
operator|=
literal|1
expr_stmt|;
name|fwd_or
argument_list|(
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|r
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|1
init|;
name|j
operator|<
literal|64
condition|;
name|j
operator|++
control|)
block|{
name|memset
argument_list|(
name|xt
operator|.
name|x
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|xt
operator|.
name|x
argument_list|)
argument_list|)
expr_stmt|;
name|xt
operator|.
name|x
index|[
name|i
index|]
operator|=
operator|(
operator|(
name|u64b
operator|)
literal|1
operator|)
operator|<<
name|j
expr_stmt|;
name|fwd_or
argument_list|(
name|xt
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|r
argument_list|)
expr_stmt|;
for|for
control|(
name|k
operator|=
literal|0
init|;
name|k
operator|<
name|wCnt
condition|;
name|k
operator|++
control|)
if|if
condition|(
name|left_rot
argument_list|(
name|ct
operator|.
name|x
index|[
name|k
index|]
argument_list|,
name|j
argument_list|)
operator|!=
name|xt
operator|.
name|x
index|[
name|k
index|]
condition|)
block|{
name|printf
argument_list|(
literal|"Quick HW check failure: blk=%4d bits. r=%d. j=%d"
argument_list|,
name|wCnt
operator|*
literal|64
argument_list|,
name|r
argument_list|,
name|j
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|2
argument_list|)
expr_stmt|;
block|}
block|}
block|}
endif|#
directive|endif
block|}
block|}
comment|/* test the "hard coded" versions against variable versions of OR routines */
for|for
control|(
name|tstCnt
operator|=
literal|0
init|;
name|tstCnt
operator|<
name|TEST_CNT
condition|;
name|tstCnt
operator|++
control|)
block|{
name|RandBytes
argument_list|(
name|rots
argument_list|,
sizeof|sizeof
argument_list|(
name|rots
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|MAX_ROTS_PER_CYCLE
condition|;
name|i
operator|++
control|)
name|rots
index|[
name|i
index|]
operator|&=
operator|(
name|BITS_PER_WORD
operator|-
literal|1
operator|)
expr_stmt|;
name|rN
operator|=
operator|(
name|wCnt
operator|==
literal|16
operator|)
condition|?
literal|9
else|:
literal|8
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|wCnt
operator|*
literal|64
condition|;
name|i
operator|++
control|)
block|{
name|memset
argument_list|(
name|pt
operator|.
name|x
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|pt
argument_list|)
argument_list|)
expr_stmt|;
name|pt
operator|.
name|x
index|[
name|i
operator|/
literal|64
index|]
operator|=
operator|(
operator|(
name|u64b
operator|)
literal|1
operator|)
operator|<<
operator|(
name|i
operator|%
literal|64
operator|)
expr_stmt|;
name|ct
operator|=
name|pt
expr_stmt|;
name|xt
operator|=
name|pt
expr_stmt|;
name|fwd_or
argument_list|(
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|rN
argument_list|)
expr_stmt|;
name|fwd_or_rN
argument_list|(
name|xt
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|rN
argument_list|)
expr_stmt|;
if|if
condition|(
name|memcmp
argument_list|(
name|xt
operator|.
name|x
argument_list|,
name|ct
operator|.
name|x
argument_list|,
name|wCnt
operator|*
sizeof|sizeof
argument_list|(
name|xt
operator|.
name|x
index|[
literal|0
index|]
argument_list|)
argument_list|)
condition|)
block|{
name|printf
argument_list|(
literal|"OR failure: #%03d: wCnt=%d. i=%2d"
argument_list|,
name|tstCnt
argument_list|,
name|wCnt
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|8
argument_list|)
expr_stmt|;
block|}
block|}
block|}
block|}
block|}
end_function

begin_comment
comment|/* count the bits set in the word */
end_comment

begin_function
name|uint
name|HammingWeight
parameter_list|(
name|Word
name|x
parameter_list|)
block|{
if|#
directive|if
name|BITS_PER_WORD
operator|==
literal|64
name|x
operator|=
operator|(
name|x
operator|&
name|DUP_64
argument_list|(
literal|0x55555555
argument_list|)
operator|)
operator|+
operator|(
operator|(
name|x
operator|>>
literal|1
operator|)
operator|&
name|DUP_64
argument_list|(
literal|0x55555555
argument_list|)
operator|)
expr_stmt|;
name|x
operator|=
operator|(
name|x
operator|&
name|DUP_64
argument_list|(
literal|0x33333333
argument_list|)
operator|)
operator|+
operator|(
operator|(
name|x
operator|>>
literal|2
operator|)
operator|&
name|DUP_64
argument_list|(
literal|0x33333333
argument_list|)
operator|)
expr_stmt|;
name|x
operator|=
operator|(
name|x
operator|&
name|DUP_64
argument_list|(
literal|0x0F0F0F0F
argument_list|)
operator|)
operator|+
operator|(
operator|(
name|x
operator|>>
literal|4
operator|)
operator|&
name|DUP_64
argument_list|(
literal|0x0F0F0F0F
argument_list|)
operator|)
expr_stmt|;
name|x
operator|=
operator|(
name|x
operator|&
name|DUP_64
argument_list|(
literal|0x00FF00FF
argument_list|)
operator|)
operator|+
operator|(
operator|(
name|x
operator|>>
literal|8
operator|)
operator|&
name|DUP_64
argument_list|(
literal|0x00FF00FF
argument_list|)
operator|)
expr_stmt|;
name|x
operator|=
operator|(
name|x
operator|&
name|DUP_64
argument_list|(
literal|0x0000FFFF
argument_list|)
operator|)
operator|+
operator|(
operator|(
name|x
operator|>>
literal|16
operator|)
operator|&
name|DUP_64
argument_list|(
literal|0x0000FFFF
argument_list|)
operator|)
expr_stmt|;
name|x
operator|=
operator|(
name|x
operator|&
name|DUP_64
argument_list|(
literal|0x000000FF
argument_list|)
operator|)
operator|+
operator|(
operator|(
name|x
operator|>>
literal|32
operator|)
operator|&
name|DUP_64
argument_list|(
literal|0x000000FF
argument_list|)
operator|)
expr_stmt|;
else|#
directive|else
name|x
operator|=
operator|(
name|x
operator|&
literal|0x55555555
operator|)
operator|+
operator|(
operator|(
name|x
operator|>>
literal|1
operator|)
operator|&
literal|0x55555555
operator|)
expr_stmt|;
name|x
operator|=
operator|(
name|x
operator|&
literal|0x33333333
operator|)
operator|+
operator|(
operator|(
name|x
operator|>>
literal|2
operator|)
operator|&
literal|0x33333333
operator|)
expr_stmt|;
name|x
operator|=
operator|(
name|x
operator|&
literal|0x0F0F0F0F
operator|)
operator|+
operator|(
operator|(
name|x
operator|>>
literal|4
operator|)
operator|&
literal|0x0F0F0F0F
operator|)
expr_stmt|;
name|x
operator|=
operator|(
name|x
operator|&
literal|0x00FF00FF
operator|)
operator|+
operator|(
operator|(
name|x
operator|>>
literal|8
operator|)
operator|&
literal|0x00FF00FF
operator|)
expr_stmt|;
name|x
operator|=
operator|(
name|x
operator|&
literal|0x0000FFFF
operator|)
operator|+
operator|(
operator|(
name|x
operator|>>
literal|16
operator|)
operator|&
literal|0x000000FF
operator|)
expr_stmt|;
endif|#
directive|endif
return|return
operator|(
name|uint
operator|)
name|x
return|;
block|}
end_function

begin_comment
comment|/* use the CRC value as quick ID to help identify/verify rotation sets */
end_comment

begin_function
name|void
name|Set_CRC
parameter_list|(
name|rSearchRec
modifier|*
name|r
parameter_list|)
block|{
define|#
directive|define
name|CRC_FDBK
value|((0x04C11DB7u>> 1) ^ 0x80000000u)
comment|/* CRC-32-IEEE-802.3 (from Wikipedia) */
name|uint
name|i
decl_stmt|,
name|h
init|=
operator|~
literal|0u
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|rotsPerCycle
condition|;
name|i
operator|++
control|)
block|{
name|h
operator|^=
name|r
operator|->
name|rotList
index|[
name|i
index|]
expr_stmt|;
name|h
operator|=
operator|(
name|h
operator|&
literal|1
operator|)
condition|?
operator|(
name|h
operator|>>
literal|1
operator|)
operator|^
name|CRC_FDBK
else|:
operator|(
name|h
operator|>>
literal|1
operator|)
expr_stmt|;
name|h
operator|=
operator|(
name|h
operator|&
literal|1
operator|)
condition|?
operator|(
name|h
operator|>>
literal|1
operator|)
operator|^
name|CRC_FDBK
else|:
operator|(
name|h
operator|>>
literal|1
operator|)
expr_stmt|;
name|h
operator|=
operator|(
name|h
operator|&
literal|1
operator|)
condition|?
operator|(
name|h
operator|>>
literal|1
operator|)
operator|^
name|CRC_FDBK
else|:
operator|(
name|h
operator|>>
literal|1
operator|)
expr_stmt|;
name|h
operator|=
operator|(
name|h
operator|&
literal|1
operator|)
condition|?
operator|(
name|h
operator|>>
literal|1
operator|)
operator|^
name|CRC_FDBK
else|:
operator|(
name|h
operator|>>
literal|1
operator|)
expr_stmt|;
name|h
operator|=
operator|(
name|h
operator|&
literal|1
operator|)
condition|?
operator|(
name|h
operator|>>
literal|1
operator|)
operator|^
name|CRC_FDBK
else|:
operator|(
name|h
operator|>>
literal|1
operator|)
expr_stmt|;
name|h
operator|=
operator|(
name|h
operator|&
literal|1
operator|)
condition|?
operator|(
name|h
operator|>>
literal|1
operator|)
operator|^
name|CRC_FDBK
else|:
operator|(
name|h
operator|>>
literal|1
operator|)
expr_stmt|;
name|h
operator|=
operator|(
name|h
operator|&
literal|1
operator|)
condition|?
operator|(
name|h
operator|>>
literal|1
operator|)
operator|^
name|CRC_FDBK
else|:
operator|(
name|h
operator|>>
literal|1
operator|)
expr_stmt|;
name|h
operator|=
operator|(
name|h
operator|&
literal|1
operator|)
condition|?
operator|(
name|h
operator|>>
literal|1
operator|)
operator|^
name|CRC_FDBK
else|:
operator|(
name|h
operator|>>
literal|1
operator|)
expr_stmt|;
block|}
name|r
operator|->
name|CRC
operator|=
name|h
expr_stmt|;
block|}
end_function

begin_comment
comment|/* qsort routine for search records: keep in descending order */
end_comment

begin_function
name|int
name|Compare_SearchRec_Descending
parameter_list|(
specifier|const
name|void
modifier|*
name|aPtr
parameter_list|,
specifier|const
name|void
modifier|*
name|bPtr
parameter_list|)
block|{
name|uint
name|wA
init|=
operator|(
operator|(
specifier|const
name|rSearchRec
operator|*
operator|)
name|aPtr
operator|)
operator|->
name|rWorst
decl_stmt|;
name|uint
name|wB
init|=
operator|(
operator|(
specifier|const
name|rSearchRec
operator|*
operator|)
name|bPtr
operator|)
operator|->
name|rWorst
decl_stmt|;
if|if
condition|(
name|wA
operator|<
name|wB
condition|)
return|return
operator|+
literal|1
return|;
if|if
condition|(
name|wA
operator|>
name|wB
condition|)
return|return
operator|-
literal|1
return|;
else|else
block|{
comment|/* equal metric. Sort by ID number */
name|wA
operator|=
operator|(
operator|(
specifier|const
name|rSearchRec
operator|*
operator|)
name|aPtr
operator|)
operator|->
name|ID
expr_stmt|;
name|wB
operator|=
operator|(
operator|(
specifier|const
name|rSearchRec
operator|*
operator|)
name|bPtr
operator|)
operator|->
name|ID
expr_stmt|;
if|if
condition|(
name|wA
operator|<
name|wB
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|wA
operator|>
name|wB
condition|)
return|return
operator|+
literal|1
return|;
return|return
literal|0
return|;
block|}
block|}
end_function

begin_function
specifier|const
name|char
modifier|*
name|ASCII_TimeDate
parameter_list|(
name|void
parameter_list|)
block|{
name|time_t
name|t
decl_stmt|;
name|time
argument_list|(
operator|&
name|t
argument_list|)
expr_stmt|;
return|return
name|ctime
argument_list|(
operator|&
name|t
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/* test the rotation set for minimum hamming weight>= minHW */
end_comment

begin_comment
comment|/*   [try to do it fast: rely on rotational symmetry using OR, */
end_comment

begin_comment
comment|/*    and do an early exit if hamming weight is too low] */
end_comment

begin_function
name|int
name|Cycle_Min_HW
parameter_list|(
name|uint
name|rounds
parameter_list|,
specifier|const
name|u08b
modifier|*
name|rotList
parameter_list|,
name|uint
name|minHW
parameter_list|,
name|uint
name|verMask
parameter_list|)
block|{
name|uint
name|i
decl_stmt|,
name|j
decl_stmt|,
name|v
decl_stmt|,
name|hw
decl_stmt|,
name|hMin
decl_stmt|;
name|u08b
name|rots
index|[
name|MAX_ROTS_PER_CYCLE
index|]
decl_stmt|;
name|Block
name|b
decl_stmt|;
name|hMin
operator|=
name|BITS_PER_WORD
expr_stmt|;
for|for
control|(
name|v
operator|=
literal|0
init|;
name|v
operator|<
name|MAX_ROT_VER_CNT
condition|;
name|v
operator|++
control|)
block|{
if|if
condition|(
operator|(
name|verMask
operator|&
operator|(
literal|1
operator|<<
name|v
operator|)
operator|)
operator|==
literal|0
condition|)
continue|continue;
if|if
condition|(
name|v
operator|&
literal|1
condition|)
block|{
comment|/* do it on the "half-cycle" */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|rotsPerCycle
condition|;
name|i
operator|++
control|)
block|{
name|rots
index|[
name|i
index|]
operator|=
name|rotList
index|[
operator|(
name|i
operator|>=
name|rotsPerCycle
operator|/
literal|2
operator|)
condition|?
name|i
operator|-
name|rotsPerCycle
operator|/
literal|2
else|:
name|i
operator|+
name|rotsPerCycle
operator|/
literal|2
index|]
expr_stmt|;
block|}
block|}
else|else
name|memcpy
argument_list|(
name|rots
argument_list|,
name|rotList
argument_list|,
name|rotsPerCycle
operator|*
sizeof|sizeof
argument_list|(
name|rots
index|[
literal|0
index|]
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|wordsPerBlock
condition|;
name|i
operator|++
control|)
block|{
name|memset
argument_list|(
name|b
operator|.
name|x
argument_list|,
literal|0
argument_list|,
name|wordsPerBlock
operator|*
sizeof|sizeof
argument_list|(
name|b
operator|.
name|x
index|[
literal|0
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|b
operator|.
name|x
index|[
name|i
index|]
operator|=
literal|1
expr_stmt|;
comment|/* test propagation into one word */
if|if
condition|(
name|minHW
condition|)
block|{
comment|/* use the "_rN" versions for speed */
if|if
condition|(
name|v
operator|&
literal|2
condition|)
name|rev_cycle_or_rN
argument_list|(
name|b
operator|.
name|x
argument_list|,
name|rots
argument_list|,
operator|(
name|int
operator|)
name|rounds
argument_list|)
expr_stmt|;
else|else
name|fwd_cycle_or_rN
argument_list|(
name|b
operator|.
name|x
argument_list|,
name|rots
argument_list|,
operator|(
name|int
operator|)
name|rounds
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|/* saturation check */
if|if
condition|(
name|v
operator|&
literal|2
condition|)
name|rev_cycle_or
argument_list|(
name|b
operator|.
name|x
argument_list|,
name|rots
argument_list|,
operator|(
name|int
operator|)
name|rounds
argument_list|)
expr_stmt|;
else|else
name|fwd_cycle_or
argument_list|(
name|b
operator|.
name|x
argument_list|,
name|rots
argument_list|,
operator|(
name|int
operator|)
name|rounds
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|wordsPerBlock
condition|;
name|j
operator|++
control|)
block|{
name|hw
operator|=
name|HammingWeight
argument_list|(
name|b
operator|.
name|x
index|[
name|j
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|minHW
operator|>
name|hw
condition|)
return|return
literal|0
return|;
comment|/* stop if this isn't good enough */
if|if
condition|(
name|hMin
operator|>
name|hw
condition|)
comment|/* else keep track of min */
name|hMin
operator|=
name|hw
expr_stmt|;
block|}
block|}
block|}
return|return
name|hMin
return|;
block|}
end_function

begin_comment
comment|/* compute/set the minimum hamming weight of the rotation set */
end_comment

begin_comment
comment|/*   [more thorough check than Cycle_Min_HW] */
end_comment

begin_function
name|uint
name|Set_Min_hw_OR
parameter_list|(
name|rSearchRec
modifier|*
name|r
parameter_list|,
name|uint
name|verMask
parameter_list|,
name|uint
name|rounds
parameter_list|)
block|{
name|uint
name|i
decl_stmt|,
name|j
decl_stmt|,
name|v
decl_stmt|,
name|hw
decl_stmt|,
name|hwMin
decl_stmt|;
name|u08b
name|rots
index|[
name|MAX_ROTS_PER_CYCLE
index|]
decl_stmt|;
name|Block
name|b
decl_stmt|;
name|Set_CRC
argument_list|(
name|r
argument_list|)
expr_stmt|;
name|hwMin
operator|=
name|BITS_PER_WORD
expr_stmt|;
for|for
control|(
name|v
operator|=
literal|0
init|;
name|v
operator|<
name|MAX_ROT_VER_CNT
condition|;
name|v
operator|++
control|)
block|{
name|r
operator|->
name|hw_OR
index|[
name|v
index|]
operator|=
name|BITS_PER_WORD
expr_stmt|;
if|if
condition|(
operator|(
name|verMask
operator|&
operator|(
literal|1
operator|<<
name|v
operator|)
operator|)
operator|==
literal|0
condition|)
continue|continue;
if|if
condition|(
name|v
operator|&
literal|1
condition|)
block|{
comment|/* do it on the "half-cycle" */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|rotsPerCycle
condition|;
name|i
operator|++
control|)
block|{
name|rots
index|[
name|i
index|]
operator|=
name|r
operator|->
name|rotList
index|[
operator|(
name|i
operator|>=
name|rotsPerCycle
operator|/
literal|2
operator|)
condition|?
name|i
operator|-
name|rotsPerCycle
operator|/
literal|2
else|:
name|i
operator|+
name|rotsPerCycle
operator|/
literal|2
index|]
expr_stmt|;
block|}
block|}
else|else
name|memcpy
argument_list|(
name|rots
argument_list|,
name|r
operator|->
name|rotList
argument_list|,
name|rotsPerCycle
operator|*
sizeof|sizeof
argument_list|(
name|rots
index|[
literal|0
index|]
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|bitsPerBlock
condition|;
name|i
operator|+=
name|BITS_PER_WORD
control|)
block|{
name|memset
argument_list|(
name|b
operator|.
name|x
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|b
operator|.
name|x
argument_list|)
argument_list|)
expr_stmt|;
name|b
operator|.
name|x
index|[
name|i
operator|/
name|BITS_PER_WORD
index|]
operator||=
operator|(
operator|(
operator|(
name|u64b
operator|)
literal|1
operator|)
operator|<<
operator|(
name|i
operator|%
name|BITS_PER_WORD
operator|)
operator|)
expr_stmt|;
if|if
condition|(
name|v
operator|&
literal|2
condition|)
name|rev_cycle_or
argument_list|(
name|b
operator|.
name|x
argument_list|,
name|rots
argument_list|,
operator|(
name|int
operator|)
name|rounds
argument_list|)
expr_stmt|;
else|else
name|fwd_cycle_or
argument_list|(
name|b
operator|.
name|x
argument_list|,
name|rots
argument_list|,
operator|(
name|int
operator|)
name|rounds
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|wordsPerBlock
condition|;
name|j
operator|++
control|)
block|{
name|hw
operator|=
name|HammingWeight
argument_list|(
name|b
operator|.
name|x
index|[
name|j
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|hwMin
operator|>
name|hw
condition|)
name|hwMin
operator|=
name|hw
expr_stmt|;
if|if
condition|(
name|r
operator|->
name|hw_OR
index|[
name|v
index|]
operator|>
operator|(
name|u08b
operator|)
name|hw
condition|)
name|r
operator|->
name|hw_OR
index|[
name|v
index|]
operator|=
operator|(
name|u08b
operator|)
name|hw
expr_stmt|;
block|}
block|}
block|}
return|return
name|hwMin
return|;
block|}
end_function

begin_comment
comment|/* show how the Hamming weight varies as a function of # rounds */
end_comment

begin_function
name|void
name|Show_HW_rounds
parameter_list|(
specifier|const
name|u08b
modifier|*
name|rotates
parameter_list|)
block|{
name|uint
name|i
decl_stmt|,
name|r
decl_stmt|,
name|minHW
decl_stmt|,
name|hw
index|[
literal|4
index|]
decl_stmt|;
for|for
control|(
name|r
operator|=
literal|4
init|;
name|r
operator|<
literal|12
condition|;
name|r
operator|++
control|)
block|{
name|minHW
operator|=
name|bitsPerBlock
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|4
condition|;
name|i
operator|++
control|)
block|{
name|hw
index|[
name|i
index|]
operator|=
name|Cycle_Min_HW
argument_list|(
name|r
argument_list|,
name|rotates
argument_list|,
literal|0
argument_list|,
literal|1
operator|<<
name|i
argument_list|)
expr_stmt|;
if|if
condition|(
name|minHW
operator|>
name|hw
index|[
name|i
index|]
condition|)
name|minHW
operator|=
name|hw
index|[
name|i
index|]
expr_stmt|;
block|}
name|printf
argument_list|(
literal|"%2d rounds: minHW = %2d  ["
argument_list|,
name|r
argument_list|,
name|minHW
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|4
condition|;
name|i
operator|++
control|)
comment|/* show the different "versions" */
name|printf
argument_list|(
literal|" %2d"
argument_list|,
name|hw
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|" ]\n"
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* read rotations value from file */
end_comment

begin_function
specifier|const
name|u08b
modifier|*
name|get_rotation_file
parameter_list|(
specifier|const
name|char
modifier|*
name|rfName
parameter_list|)
block|{
enum|enum
block|{
name|MAX_LINE
init|=
literal|512
block|}
enum|;
name|char
name|line
index|[
name|MAX_LINE
operator|+
literal|4
index|]
decl_stmt|;
name|uint
name|i
decl_stmt|,
name|rotVal
decl_stmt|;
name|uint
name|rotShow
init|=
literal|0
decl_stmt|;
specifier|static
name|FILE
modifier|*
name|rf
init|=
name|NULL
decl_stmt|;
specifier|static
name|u08b
name|rotates
index|[
name|MAX_ROTS_PER_CYCLE
index|]
decl_stmt|;
specifier|static
name|uint
name|rotCnt
init|=
literal|0
decl_stmt|;
comment|/**** sample format:  +++++++++++++ Preliminary results: sampleCnt =  1024, block =  256 bits rMin = 0.425. #079C[*21] [CRC=D89E7C72. hw_OR=62. cnt= 1024. blkSize= 256]              46   52    21   38    13   13    20   27    14   40    43   26    35   29    19   63 rMin = 0.425. #0646[*17] [CRC=527174F3. hw_OR=61. cnt= 1024. blkSize= 256]              26   24    50   48    40   25    36   55    10   20    10   16    60   55    18    7 ... ****/
if|if
condition|(
name|rfName
index|[
literal|0
index|]
operator|==
literal|'+'
condition|)
block|{
name|rfName
operator|++
expr_stmt|;
name|rotShow
operator|=
literal|1
expr_stmt|;
block|}
if|if
condition|(
name|rf
operator|==
name|NULL
condition|)
block|{
name|rf
operator|=
name|fopen
argument_list|(
name|rfName
argument_list|,
literal|"rt"
argument_list|)
expr_stmt|;
if|if
condition|(
name|rf
operator|==
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"Unable to open rotation file '%s'"
argument_list|,
name|rfName
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|2
argument_list|)
expr_stmt|;
block|}
name|rotCnt
operator|=
literal|0
expr_stmt|;
for|for
control|(
init|;
condition|;
control|)
comment|/* skip to "preliminary results" section */
block|{
name|line
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|fgets
argument_list|(
name|line
argument_list|,
sizeof|sizeof
argument_list|(
name|line
argument_list|)
operator|-
literal|4
argument_list|,
name|rf
argument_list|)
operator|==
name|NULL
operator|||
name|line
index|[
literal|0
index|]
operator|==
literal|0
condition|)
block|{
name|fclose
argument_list|(
name|rf
argument_list|)
expr_stmt|;
comment|/* eof --> stop */
name|rf
operator|=
name|NULL
expr_stmt|;
return|return
name|NULL
return|;
block|}
comment|/* check for the header */
if|if
condition|(
name|line
index|[
literal|0
index|]
operator|!=
literal|'+'
operator|||
name|line
index|[
literal|1
index|]
operator|!=
literal|'+'
operator|||
name|line
index|[
literal|2
index|]
operator|!=
literal|'+'
operator|||
name|strstr
argument_list|(
name|line
argument_list|,
literal|"reliminary results:"
argument_list|)
operator|==
name|NULL
condition|)
continue|continue;
comment|/* now check for the correct block size */
for|for
control|(
name|i
operator|=
name|strlen
argument_list|(
name|line
argument_list|)
init|;
name|i
condition|;
name|i
operator|--
control|)
comment|/* start at eol and look backwards */
if|if
condition|(
name|line
index|[
name|i
operator|-
literal|1
index|]
operator|==
literal|'='
condition|)
comment|/* check for '=' sign for block size */
break|break;
if|if
condition|(
name|i
operator|>
literal|0
operator|&&
name|sscanf
argument_list|(
name|line
operator|+
name|i
argument_list|,
literal|"%u bits"
argument_list|,
operator|&
name|i
argument_list|)
operator|==
literal|1
operator|&&
name|i
operator|==
name|bitsPerBlock
condition|)
break|break;
block|}
block|}
comment|/* now at the rMin line */
name|line
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|fgets
argument_list|(
name|line
argument_list|,
sizeof|sizeof
argument_list|(
name|line
argument_list|)
operator|-
literal|4
argument_list|,
name|rf
argument_list|)
operator|==
name|NULL
operator|||
name|line
index|[
literal|0
index|]
operator|==
literal|0
operator|||
name|strncmp
argument_list|(
name|line
argument_list|,
literal|"rMin ="
argument_list|,
literal|6
argument_list|)
condition|)
block|{
name|fclose
argument_list|(
name|rf
argument_list|)
expr_stmt|;
name|rf
operator|=
name|NULL
expr_stmt|;
return|return
name|NULL
return|;
block|}
comment|/* now read in all the rotation values */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|rotsPerCycle
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|fscanf
argument_list|(
name|rf
argument_list|,
literal|"%u"
argument_list|,
operator|&
name|rotVal
argument_list|)
operator|!=
literal|1
operator|||
name|rotVal
operator|>=
name|bitsPerBlock
condition|)
block|{
comment|/* Invalid rotation value */
name|fclose
argument_list|(
name|rf
argument_list|)
expr_stmt|;
name|rf
operator|=
name|NULL
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|rotates
index|[
name|i
index|]
operator|=
operator|(
name|u08b
operator|)
name|rotVal
expr_stmt|;
block|}
if|if
condition|(
name|fgets
argument_list|(
name|line
argument_list|,
sizeof|sizeof
argument_list|(
name|line
argument_list|)
operator|-
literal|4
argument_list|,
name|rf
argument_list|)
operator|==
name|NULL
condition|)
comment|/* skip eol */
block|{
name|fclose
argument_list|(
name|rf
argument_list|)
expr_stmt|;
name|rf
operator|=
name|NULL
expr_stmt|;
block|}
if|if
condition|(
name|rotShow
condition|)
block|{
comment|/* show the hamming weight profile */
name|printf
argument_list|(
literal|"\n:::::::::::\n"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"Rot #%02d [%4d-bit blocks] read from file '%s':\n"
argument_list|,
name|rotCnt
argument_list|,
name|bitsPerBlock
argument_list|,
name|rfName
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|rotsPerCycle
condition|;
name|i
operator|++
control|)
name|printf
argument_list|(
literal|"%4d%s"
argument_list|,
name|rotates
index|[
name|i
index|]
argument_list|,
operator|(
operator|(
name|i
operator|+
literal|1
operator|)
operator|%
operator|(
name|wordsPerBlock
operator|/
literal|2
operator|)
operator|)
condition|?
literal|""
else|:
literal|"\n"
argument_list|)
expr_stmt|;
name|Show_HW_rounds
argument_list|(
name|rotates
argument_list|)
expr_stmt|;
comment|/* show HW results for different numbers of rounds */
name|printf
argument_list|(
literal|":::::::::::\n"
argument_list|)
expr_stmt|;
block|}
name|rotCnt
operator|++
expr_stmt|;
return|return
name|rotates
return|;
block|}
end_function

begin_comment
comment|/* generate a randomly chosen set of rotation constants of given minimum hamming weight (using OR) */
end_comment

begin_comment
comment|/* (this may take a while, depending on minHW,rounds) */
end_comment

begin_function
name|uint
name|get_rotation
parameter_list|(
name|rSearchRec
modifier|*
name|r
parameter_list|,
name|testParms
name|t
parameter_list|)
block|{
specifier|static
name|u64b
name|rCnt
init|=
literal|1
decl_stmt|;
specifier|static
name|u64b
name|rCntOK
init|=
literal|0
decl_stmt|;
specifier|static
name|uint
name|rScale
init|=
name|BITS_PER_WORD
decl_stmt|;
specifier|static
name|uint
name|hwBase
init|=
literal|0
decl_stmt|;
specifier|static
name|uint
name|rID
init|=
literal|1
decl_stmt|;
name|uint
name|i
decl_stmt|,
name|j
decl_stmt|,
name|k
decl_stmt|,
name|m
decl_stmt|,
name|n
decl_stmt|,
name|b
decl_stmt|,
name|hw
decl_stmt|,
name|q
decl_stmt|,
name|qMask
decl_stmt|;
specifier|static
name|u08b
name|rotates
index|[
name|MAX_ROTS_PER_CYCLE
index|]
decl_stmt|;
comment|/*  last generated rotation set */
name|u08b
name|goodRots
index|[
name|BITS_PER_WORD
index|]
decl_stmt|;
name|uint
name|goodRotCnt
decl_stmt|;
name|r
operator|->
name|rWorst
operator|=
literal|0
expr_stmt|;
name|r
operator|->
name|parentCRC
operator|=
operator|~
literal|0u
expr_stmt|;
if|if
condition|(
name|rotFileName
condition|)
comment|/* get from search results file? */
block|{
specifier|const
name|u08b
modifier|*
name|rf
init|=
name|get_rotation_file
argument_list|(
name|rotFileName
argument_list|)
decl_stmt|;
if|if
condition|(
name|rf
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|rotsPerCycle
condition|;
name|i
operator|++
control|)
name|r
operator|->
name|rotList
index|[
name|i
index|]
operator|=
name|rf
index|[
name|i
index|]
expr_stmt|;
name|Set_Min_hw_OR
argument_list|(
name|r
argument_list|,
name|t
operator|.
name|rotVerMask
argument_list|,
name|t
operator|.
name|rounds
argument_list|)
expr_stmt|;
name|r
operator|->
name|ID
operator|=
name|rID
operator|++
expr_stmt|;
return|return
literal|1
return|;
block|}
comment|/* here with file exhausted. Keep going with randomized values */
name|rotFileName
operator|=
name|NULL
expr_stmt|;
comment|/* don't use file any more */
return|return
literal|0
return|;
block|}
for|for
control|(
name|i
operator|=
name|goodRotCnt
operator|=
literal|0
init|;
name|i
operator|<
name|BITS_PER_WORD
condition|;
name|i
operator|++
control|)
if|if
condition|(
operator|!
name|RotCnt_Bad
argument_list|(
name|i
argument_list|)
condition|)
block|{
name|goodRots
index|[
name|goodRotCnt
operator|++
index|]
operator|=
operator|(
name|u08b
operator|)
name|i
expr_stmt|;
block|}
name|qMask
operator|=
operator|(
operator|(
name|wordsPerBlock
operator|/
literal|2
operator|)
operator|-
literal|1
operator|)
operator|&
name|t
operator|.
name|dupRotMask
expr_stmt|;
comment|/* filter for dup rotate counts in the same round? */
for|for
control|(
init|;
condition|;
name|rCnt
operator|++
control|)
block|{
if|if
condition|(
name|hwBase
operator|==
literal|0
condition|)
block|{
comment|/* pick a rotation set at random */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|rotsPerCycle
condition|;
control|)
block|{
name|rotates
index|[
name|i
index|]
operator|=
name|goodRots
index|[
name|Rand32
argument_list|()
operator|%
name|goodRotCnt
index|]
expr_stmt|;
comment|/* filter out unapproved rotation sets here */
for|for
control|(
name|q
operator|=
name|i
operator|&
operator|~
name|qMask
init|;
name|q
operator|<
name|i
condition|;
name|q
operator|++
control|)
comment|/* check for dups in the same round */
if|if
condition|(
name|rotates
index|[
name|i
index|]
operator|==
name|rotates
index|[
name|q
index|]
condition|)
break|break;
if|if
condition|(
name|q
operator|>=
name|i
condition|)
comment|/* no dup, value ok, so this value is ok */
name|i
operator|++
expr_stmt|;
block|}
name|hw
operator|=
name|Cycle_Min_HW
argument_list|(
name|t
operator|.
name|rounds
argument_list|,
name|rotates
argument_list|,
name|t
operator|.
name|minHW_or
operator|-
name|t
operator|.
name|minOffs
argument_list|,
name|t
operator|.
name|rotVerMask
argument_list|)
expr_stmt|;
if|if
condition|(
name|hw
operator|==
literal|0
condition|)
comment|/* did we get close? */
continue|continue;
name|rCntOK
operator|++
expr_stmt|;
name|hwBase
operator|=
name|hw
expr_stmt|;
if|if
condition|(
name|hw
operator|>=
name|t
operator|.
name|minHW_or
condition|)
if|if
condition|(
name|Cycle_Min_HW
argument_list|(
name|t
operator|.
name|maxSatRnds
argument_list|,
name|rotates
argument_list|,
literal|0
argument_list|,
name|t
operator|.
name|rotVerMask
argument_list|)
operator|==
name|BITS_PER_WORD
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|rotsPerCycle
condition|;
name|i
operator|++
control|)
name|r
operator|->
name|rotList
index|[
name|i
index|]
operator|=
name|rotates
index|[
name|i
index|]
expr_stmt|;
name|rScale
operator|=
literal|1
expr_stmt|;
comment|/* set up for scaling below */
block|}
block|}
comment|/* use odd scaling for randomly generated rotations */
for|for
control|(
init|;
name|rScale
operator|<
name|BITS_PER_WORD
condition|;
control|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|rotsPerCycle
condition|;
name|i
operator|++
control|)
block|{
name|r
operator|->
name|rotList
index|[
name|i
index|]
operator|=
operator|(
name|rotates
index|[
name|i
index|]
operator|*
name|rScale
operator|)
operator|%
name|BITS_PER_WORD
expr_stmt|;
if|if
condition|(
name|RotCnt_Bad
argument_list|(
name|r
operator|->
name|rotList
index|[
name|i
index|]
argument_list|)
condition|)
break|break;
block|}
name|rScale
operator|+=
literal|2
expr_stmt|;
comment|/* bump scale factor for next time */
if|if
condition|(
name|i
operator|>=
name|rotsPerCycle
condition|)
block|{
comment|/* all values ok: this one's a keeper */
name|Set_Min_hw_OR
argument_list|(
name|r
argument_list|,
name|t
operator|.
name|rotVerMask
argument_list|,
name|t
operator|.
name|rounds
argument_list|)
expr_stmt|;
name|r
operator|->
name|ID
operator|=
name|rID
operator|++
expr_stmt|;
return|return
literal|1
return|;
block|}
block|}
comment|/* Try nearby values to see if hw gets better: monotonic hill climb. */
comment|/*      -- exhaustively try all possible values of pairs of changes  */
for|for
control|(
name|m
operator|=
literal|0
init|;
name|m
operator|<
name|rotsPerCycle
condition|;
name|m
operator|++
control|)
for|for
control|(
name|b
operator|=
literal|0
init|;
name|b
operator|<
name|BITS_PER_WORD
condition|;
name|b
operator|++
control|)
block|{
name|k
operator|=
name|rotsPerCycle
operator|-
literal|1
operator|-
name|m
expr_stmt|;
comment|/* work backwards, since we're already close */
name|rotates
index|[
name|k
index|]
operator|++
expr_stmt|;
name|rotates
index|[
name|k
index|]
operator|&=
operator|(
name|BITS_PER_WORD
operator|-
literal|1
operator|)
expr_stmt|;
if|if
condition|(
name|RotCnt_Bad
argument_list|(
name|rotates
index|[
name|k
index|]
argument_list|)
condition|)
continue|continue;
for|for
control|(
name|q
operator|=
name|k
operator||
name|qMask
init|;
name|q
operator|>
name|k
condition|;
name|q
operator|--
control|)
comment|/* check for dups in the same round */
if|if
condition|(
name|rotates
index|[
name|k
index|]
operator|==
name|rotates
index|[
name|q
index|]
condition|)
break|break;
if|if
condition|(
name|q
operator|>
name|k
condition|)
continue|continue;
for|for
control|(
name|i
operator|=
name|m
operator|+
literal|1
init|;
name|i
operator|<
name|rotsPerCycle
condition|;
name|i
operator|++
control|)
block|{
name|n
operator|=
name|rotsPerCycle
operator|-
literal|1
operator|-
name|i
expr_stmt|;
comment|/* work backwards */
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|BITS_PER_WORD
condition|;
name|j
operator|++
control|)
block|{
name|rotates
index|[
name|n
index|]
operator|++
expr_stmt|;
comment|/* try another rotation value */
name|rotates
index|[
name|n
index|]
operator|&=
operator|(
name|BITS_PER_WORD
operator|-
literal|1
operator|)
expr_stmt|;
if|if
condition|(
name|RotCnt_Bad
argument_list|(
name|rotates
index|[
name|n
index|]
argument_list|)
condition|)
continue|continue;
for|for
control|(
name|q
operator|=
name|n
operator||
name|qMask
init|;
name|q
operator|>
name|n
condition|;
name|q
operator|--
control|)
comment|/* check for dups in the same round */
if|if
condition|(
name|rotates
index|[
name|n
index|]
operator|==
name|rotates
index|[
name|q
index|]
condition|)
break|break;
if|if
condition|(
name|q
operator|>
name|n
condition|)
continue|continue;
name|k
operator|=
operator|(
name|t
operator|.
name|minHW_or
operator|>
name|hwBase
operator|)
condition|?
name|t
operator|.
name|minHW_or
else|:
name|hwBase
expr_stmt|;
name|hw
operator|=
name|Cycle_Min_HW
argument_list|(
name|t
operator|.
name|rounds
argument_list|,
name|rotates
argument_list|,
name|k
argument_list|,
name|t
operator|.
name|rotVerMask
argument_list|)
expr_stmt|;
if|if
condition|(
name|hw
operator|>
name|hwBase
condition|)
if|if
condition|(
name|Cycle_Min_HW
argument_list|(
name|t
operator|.
name|maxSatRnds
argument_list|,
name|rotates
argument_list|,
literal|0
argument_list|,
name|t
operator|.
name|rotVerMask
argument_list|)
operator|==
name|BITS_PER_WORD
condition|)
block|{
comment|/* must improve hw to accept this new rotation set */
name|assert
argument_list|(
name|hw
operator|>=
name|t
operator|.
name|minHW_or
argument_list|)
expr_stmt|;
name|hwBase
operator|=
name|hw
expr_stmt|;
name|rScale
operator|=
literal|3
expr_stmt|;
comment|/* set up for scaling next time */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|rotsPerCycle
condition|;
name|i
operator|++
control|)
name|r
operator|->
name|rotList
index|[
name|i
index|]
operator|=
name|rotates
index|[
name|i
index|]
expr_stmt|;
name|Set_Min_hw_OR
argument_list|(
name|r
argument_list|,
name|t
operator|.
name|rotVerMask
argument_list|,
name|t
operator|.
name|rounds
argument_list|)
expr_stmt|;
name|r
operator|->
name|ID
operator|=
name|rID
operator|++
expr_stmt|;
return|return
literal|1
return|;
block|}
block|}
block|}
block|}
name|hwBase
operator|=
literal|0
expr_stmt|;
comment|/* back to random  */
block|}
block|}
end_function

begin_comment
comment|/* display a search record result */
end_comment

begin_function
name|void
name|ShowSearchRec
parameter_list|(
name|FILE
modifier|*
name|f
parameter_list|,
specifier|const
name|rSearchRec
modifier|*
name|r
parameter_list|,
name|testParms
name|t
parameter_list|,
name|uint
name|showMode
parameter_list|,
name|char
name|markCh
parameter_list|,
name|uint
name|showNum
parameter_list|)
block|{
name|uint
name|i
decl_stmt|,
name|j
decl_stmt|,
name|n
decl_stmt|,
name|hwMin
decl_stmt|;
specifier|const
name|char
modifier|*
name|s
decl_stmt|;
name|char
name|fStr
index|[
literal|200
index|]
decl_stmt|;
name|hwMin
operator|=
name|BITS_PER_WORD
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|MAX_ROT_VER_CNT
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|hwMin
operator|>
operator|(
name|uint
operator|)
name|r
operator|->
name|hw_OR
index|[
name|i
index|]
condition|)
name|hwMin
operator|=
operator|(
name|uint
operator|)
name|r
operator|->
name|hw_OR
index|[
name|i
index|]
expr_stmt|;
switch|switch
condition|(
name|showMode
condition|)
block|{
case|case
name|SHOW_ROTS_FINAL
case|:
name|sprintf
argument_list|(
name|fStr
argument_list|,
literal|".final:%02d "
argument_list|,
name|showNum
argument_list|)
expr_stmt|;
name|s
operator|=
name|fStr
expr_stmt|;
break|break;
case|case
name|SHOW_ROTS_H
case|:
name|s
operator|=
literal|".format"
expr_stmt|;
break|break;
case|case
name|SHOW_ROTS_PRELIM
case|:
name|s
operator|=
literal|".prelim"
expr_stmt|;
break|break;
default|default:
name|s
operator|=
literal|""
expr_stmt|;
break|break;
block|}
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"rMin = %5.3f.%c [CRC=%08X. parent=%08X. ID=%08X. hw_OR=%2d. cnt=%5d. bits=%4u]%-10s%s%s\n"
argument_list|,
name|r
operator|->
name|rWorst
operator|/
operator|(
name|double
operator|)
name|t
operator|.
name|sampleCnt
argument_list|,
name|markCh
argument_list|,
name|r
operator|->
name|CRC
argument_list|,
name|r
operator|->
name|parentCRC
argument_list|,
name|r
operator|->
name|ID
argument_list|,
name|hwMin
argument_list|,
name|t
operator|.
name|sampleCnt
argument_list|,
name|bitsPerBlock
argument_list|,
name|s
argument_list|,
operator|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_USE_ABS
operator|)
condition|?
literal|" useAbs"
else|:
literal|""
argument_list|,
operator|(
name|r
operator|->
name|ID
operator|&
name|ID_RECALC_BIT
operator|)
condition|?
literal|" recalc"
else|:
literal|""
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|showMode
condition|)
block|{
case|case
name|SHOW_NONE
case|:
break|break;
case|case
name|SHOW_ROTS_H
case|:
comment|/* format for "skein.h" */
for|for
control|(
name|j
operator|=
name|n
operator|=
literal|0
init|;
name|j
operator|<
name|rotsPerCycle
operator|/
operator|(
name|wordsPerBlock
operator|/
literal|2
operator|)
condition|;
name|j
operator|++
control|)
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"   "
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|wordsPerBlock
operator|/
literal|2
condition|;
name|i
operator|++
control|)
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
operator|(
name|wordsPerBlock
operator|==
literal|16
operator|)
condition|?
literal|" R%04d"
else|:
literal|" R_%03d"
argument_list|,
name|wordsPerBlock
operator|*
literal|64
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"_%d_%d=%2d,"
argument_list|,
name|j
argument_list|,
name|i
argument_list|,
name|r
operator|->
name|rotList
index|[
name|n
operator|++
index|]
argument_list|)
expr_stmt|;
block|}
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
break|break;
default|default:
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|rotsPerCycle
condition|;
name|i
operator|++
control|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"   %2d%s"
argument_list|,
name|r
operator|->
name|rotList
index|[
name|i
index|]
argument_list|,
operator|(
operator|(
name|i
operator|+
literal|1
operator|)
operator|%
operator|(
name|wordsPerBlock
operator|/
literal|2
operator|)
operator|)
condition|?
literal|""
else|:
literal|"\n"
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
end_function

begin_comment
comment|/* compute Skein differentials for a given rotation set */
end_comment

begin_function
name|uint
name|CheckDifferentials
parameter_list|(
name|rSearchRec
modifier|*
name|r
parameter_list|,
name|testParms
name|t
parameter_list|)
block|{
enum|enum
block|{
name|HIST_BINS
init|=
literal|20
block|}
enum|;
name|uint
name|i
decl_stmt|,
name|j
decl_stmt|,
name|k
decl_stmt|,
name|v
decl_stmt|,
name|n
decl_stmt|,
name|d
decl_stmt|,
name|dMax
decl_stmt|,
name|minCnt
decl_stmt|,
name|maxCnt
decl_stmt|,
name|vCnt
decl_stmt|,
name|q
decl_stmt|;
name|uint
name|rMin
decl_stmt|,
name|rMax
decl_stmt|,
name|hwMin
decl_stmt|,
name|hwMax
decl_stmt|,
name|hw
decl_stmt|,
name|rMinCnt
decl_stmt|,
name|rMaxCnt
decl_stmt|,
name|iMin
decl_stmt|,
name|jMin
decl_stmt|,
name|iMax
decl_stmt|,
name|jMax
decl_stmt|;
name|uint
name|hist
index|[
name|HIST_BINS
operator|+
literal|1
index|]
decl_stmt|;
name|u08b
name|rots
index|[
name|MAX_ROTS_PER_CYCLE
index|]
decl_stmt|;
name|u64b
name|totSum
decl_stmt|,
name|w
decl_stmt|,
name|y
decl_stmt|,
name|z
decl_stmt|,
name|oMask
decl_stmt|;
name|double
name|fSum
decl_stmt|,
name|fSqr
decl_stmt|,
name|x
decl_stmt|,
name|var
decl_stmt|,
name|denom
decl_stmt|;
specifier|static
name|u64b
name|onesCnt
index|[
literal|3
index|]
index|[
name|MAX_BITS_PER_BLK
index|]
index|[
name|MAX_BITS_PER_BLK
operator|/
literal|8
index|]
decl_stmt|;
comment|/* pack eight 8-bit counts into each u64b (for speed) */
name|u64b
modifier|*
name|oPtr
decl_stmt|;
struct|struct
block|{
name|Block
name|pt
decl_stmt|,
name|ct
decl_stmt|;
block|}
name|a
struct|,
name|b
struct|;
name|r
operator|->
name|rWorst
operator|=
name|t
operator|.
name|sampleCnt
expr_stmt|;
name|dMax
operator|=
literal|1u
operator|<<
operator|(
name|t
operator|.
name|diffBits
operator|&
operator|(
name|BITS_PER_WORD
operator|-
literal|1
operator|)
operator|)
expr_stmt|;
name|iMin
operator|=
name|jMin
operator|=
name|iMax
operator|=
name|jMax
operator|=
name|bitsPerBlock
operator|+
literal|1
expr_stmt|;
for|for
control|(
name|v
operator|=
name|vCnt
operator|=
literal|0
init|;
name|v
operator|<
name|MAX_ROT_VER_CNT
condition|;
name|v
operator|++
control|)
block|{
comment|/* different versions of rotation schedule, including "inverse" cipher */
if|if
condition|(
operator|(
name|t
operator|.
name|rotVerMask
operator|&
operator|(
literal|1
operator|<<
name|v
operator|)
operator|)
operator|==
literal|0
condition|)
continue|continue;
name|vCnt
operator|++
expr_stmt|;
comment|/* number of versions processed */
if|if
condition|(
name|v
operator|&
literal|1
condition|)
block|{
comment|/* do it on the "half-cycle" */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|rotsPerCycle
condition|;
name|i
operator|++
control|)
block|{
name|rots
index|[
name|i
index|]
operator|=
name|r
operator|->
name|rotList
index|[
operator|(
name|i
operator|>=
name|rotsPerCycle
operator|/
literal|2
operator|)
condition|?
name|i
operator|-
name|rotsPerCycle
operator|/
literal|2
else|:
name|i
operator|+
name|rotsPerCycle
operator|/
literal|2
index|]
expr_stmt|;
block|}
block|}
else|else
name|memcpy
argument_list|(
name|rots
argument_list|,
name|r
operator|->
name|rotList
argument_list|,
name|rotsPerCycle
operator|*
sizeof|sizeof
argument_list|(
name|rots
index|[
literal|0
index|]
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|d
operator|=
literal|1
init|;
name|d
operator|<
name|dMax
condition|;
name|d
operator|+=
literal|2
control|)
comment|/* multi-bit difference patterns (must start with a '1' bit)  */
block|{
name|hwMax
operator|=
literal|0
expr_stmt|;
name|hwMin
operator|=
name|bitsPerBlock
operator|+
literal|1
expr_stmt|;
name|memset
argument_list|(
name|onesCnt
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|onesCnt
argument_list|)
argument_list|)
expr_stmt|;
comment|/* clear stats before starting */
name|oMask
operator|=
name|DUP_64
argument_list|(
literal|0x01010101
argument_list|)
expr_stmt|;
comment|/* mask for adding, 8 bins at a time */
for|for
control|(
name|n
operator|=
literal|1
init|;
name|n
operator|<=
name|t
operator|.
name|sampleCnt
condition|;
name|n
operator|++
control|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|wordsPerBlock
condition|;
name|i
operator|++
control|)
comment|/* generate input blocks in a portable way */
name|a
operator|.
name|pt
operator|.
name|x
index|[
name|i
index|]
operator|=
name|Rand64
argument_list|()
expr_stmt|;
name|a
operator|.
name|ct
operator|=
name|a
operator|.
name|pt
expr_stmt|;
if|if
condition|(
name|v
operator|&
literal|2
condition|)
name|rev_cycle
argument_list|(
name|a
operator|.
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|t
operator|.
name|rounds
argument_list|)
expr_stmt|;
else|else
name|fwd_cycle
argument_list|(
name|a
operator|.
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|t
operator|.
name|rounds
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|bitsPerBlock
condition|;
name|i
operator|++
control|)
block|{
name|b
operator|.
name|pt
operator|=
name|a
operator|.
name|pt
expr_stmt|;
name|b
operator|.
name|pt
operator|.
name|x
index|[
name|i
operator|/
name|BITS_PER_WORD
index|]
operator|^=
name|left_rot
argument_list|(
operator|(
name|u64b
operator|)
name|d
argument_list|,
operator|(
name|i
operator|%
name|BITS_PER_WORD
operator|)
argument_list|)
expr_stmt|;
comment|/* inject input difference  */
name|b
operator|.
name|ct
operator|=
name|b
operator|.
name|pt
expr_stmt|;
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_DO_RAND
condition|)
name|RandBytes
argument_list|(
name|b
operator|.
name|ct
operator|.
name|x
argument_list|,
sizeof|sizeof
argument_list|(
name|b
operator|.
name|ct
operator|.
name|x
argument_list|)
argument_list|)
expr_stmt|;
comment|/* random results as a comparison point */
elseif|else
if|if
condition|(
name|v
operator|&
literal|2
condition|)
name|rev_cycle
argument_list|(
name|b
operator|.
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|t
operator|.
name|rounds
argument_list|)
expr_stmt|;
comment|/* let Skein do the mixing */
else|else
name|fwd_cycle
argument_list|(
name|b
operator|.
name|ct
operator|.
name|x
argument_list|,
name|rots
argument_list|,
name|t
operator|.
name|rounds
argument_list|)
expr_stmt|;
comment|/* let Skein do the mixing */
name|z
operator|=
literal|0
expr_stmt|;
comment|/* accumulate total hamming weight in z */
name|oPtr
operator|=
name|onesCnt
index|[
literal|0
index|]
index|[
name|i
index|]
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|wordsPerBlock
condition|;
name|j
operator|++
control|)
block|{
comment|/* inner-most loop: unroll it fully */
name|w
operator|=
name|b
operator|.
name|ct
operator|.
name|x
index|[
name|j
index|]
operator|^
name|a
operator|.
name|ct
operator|.
name|x
index|[
name|j
index|]
expr_stmt|;
comment|/* xor difference in each ciphertext word */
name|y
operator|=
operator|(
name|w
operator|)
operator|&
name|oMask
expr_stmt|;
name|oPtr
index|[
literal|0
index|]
operator|+=
name|y
expr_stmt|;
name|z
operator|+=
name|y
expr_stmt|;
comment|/* sum 8 bins at a time (bits 0,8,16,24...,56) */
name|y
operator|=
operator|(
name|w
operator|>>
literal|1
operator|)
operator|&
name|oMask
expr_stmt|;
name|oPtr
index|[
literal|1
index|]
operator|+=
name|y
expr_stmt|;
name|z
operator|+=
name|y
expr_stmt|;
name|y
operator|=
operator|(
name|w
operator|>>
literal|2
operator|)
operator|&
name|oMask
expr_stmt|;
name|oPtr
index|[
literal|2
index|]
operator|+=
name|y
expr_stmt|;
name|z
operator|+=
name|y
expr_stmt|;
comment|/* do it 8 times to cover all bits in w */
name|y
operator|=
operator|(
name|w
operator|>>
literal|3
operator|)
operator|&
name|oMask
expr_stmt|;
name|oPtr
index|[
literal|3
index|]
operator|+=
name|y
expr_stmt|;
name|z
operator|+=
name|y
expr_stmt|;
name|y
operator|=
operator|(
name|w
operator|>>
literal|4
operator|)
operator|&
name|oMask
expr_stmt|;
name|oPtr
index|[
literal|4
index|]
operator|+=
name|y
expr_stmt|;
name|z
operator|+=
name|y
expr_stmt|;
name|y
operator|=
operator|(
name|w
operator|>>
literal|5
operator|)
operator|&
name|oMask
expr_stmt|;
name|oPtr
index|[
literal|5
index|]
operator|+=
name|y
expr_stmt|;
name|z
operator|+=
name|y
expr_stmt|;
name|y
operator|=
operator|(
name|w
operator|>>
literal|6
operator|)
operator|&
name|oMask
expr_stmt|;
name|oPtr
index|[
literal|6
index|]
operator|+=
name|y
expr_stmt|;
name|z
operator|+=
name|y
expr_stmt|;
name|y
operator|=
operator|(
name|w
operator|>>
literal|7
operator|)
operator|&
name|oMask
expr_stmt|;
name|oPtr
index|[
literal|7
index|]
operator|+=
name|y
expr_stmt|;
name|z
operator|+=
name|y
expr_stmt|;
name|oPtr
operator|+=
literal|8
expr_stmt|;
block|}
comment|/* sum up the total hamming weight bins (very carefully) */
name|z
operator|=
operator|(
name|z
operator|&
name|DUP_64
argument_list|(
literal|0x00FF00FF
argument_list|)
operator|)
operator|+
operator|(
operator|(
name|z
operator|>>
literal|8
operator|)
operator|&
name|DUP_64
argument_list|(
literal|0x00FF00FF
argument_list|)
operator|)
expr_stmt|;
name|hw
operator|=
call|(
name|uint
call|)
argument_list|(
name|z
operator|+
operator|(
name|z
operator|>>
literal|16
operator|)
operator|+
operator|(
name|z
operator|>>
literal|32
operator|)
operator|+
operator|(
name|z
operator|>>
literal|48
operator|)
argument_list|)
operator|&
literal|0xFFFF
expr_stmt|;
if|if
condition|(
name|hwMin
operator|>
name|hw
condition|)
name|hwMin
operator|=
name|hw
expr_stmt|;
comment|/* update total hw min/max stats */
if|if
condition|(
name|hwMax
operator|<
name|hw
condition|)
name|hwMax
operator|=
name|hw
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|n
operator|&
literal|0x7F
operator|)
operator|==
literal|0
condition|)
block|{
comment|/* prevent onesCnt[0] overflow by "transferring" MSBs of 8-bit bytes into onesCnt[1] */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|bitsPerBlock
condition|;
name|i
operator|++
control|)
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|bitsPerBlock
operator|/
literal|8
condition|;
name|j
operator|++
control|)
block|{
comment|/* add the MSB (bit 7) of each byte into onesCnt[1], then mask it off in onesCnt[0] */
name|onesCnt
index|[
literal|1
index|]
index|[
name|i
index|]
index|[
name|j
index|]
operator|+=
operator|(
name|onesCnt
index|[
literal|0
index|]
index|[
name|i
index|]
index|[
name|j
index|]
operator|>>
literal|7
operator|)
operator|&
name|oMask
expr_stmt|;
name|onesCnt
index|[
literal|0
index|]
index|[
name|i
index|]
index|[
name|j
index|]
operator|&=
operator|~
operator|(
name|oMask
operator|<<
literal|7
operator|)
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|n
operator|&
literal|0x3FFF
operator|)
operator|==
literal|0
condition|)
block|{
comment|/* propagate overflow into onesCnt[2] (occasionally, as needed) */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|bitsPerBlock
condition|;
name|i
operator|++
control|)
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|bitsPerBlock
operator|/
literal|8
condition|;
name|j
operator|++
control|)
block|{
name|onesCnt
index|[
literal|2
index|]
index|[
name|i
index|]
index|[
name|j
index|]
operator|+=
operator|(
name|onesCnt
index|[
literal|1
index|]
index|[
name|i
index|]
index|[
name|j
index|]
operator|>>
literal|7
operator|)
operator|&
name|oMask
expr_stmt|;
name|onesCnt
index|[
literal|1
index|]
index|[
name|i
index|]
index|[
name|j
index|]
operator|&=
operator|~
operator|(
name|oMask
operator|<<
literal|7
operator|)
expr_stmt|;
block|}
block|}
block|}
if|if
condition|(
name|n
operator|==
literal|32
operator|&&
name|d
operator|==
literal|1
operator|&&
operator|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_QUICK_EXIT
operator|)
condition|)
block|{
comment|/* quick exit if not even close to random looking after a few samples */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|bitsPerBlock
condition|;
name|i
operator|++
control|)
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|bitsPerBlock
operator|/
literal|8
condition|;
name|j
operator|++
control|)
block|{
if|if
condition|(
operator|(
name|onesCnt
index|[
literal|0
index|]
index|[
name|i
index|]
index|[
name|j
index|]
operator|&
operator|~
name|oMask
operator|)
operator|==
literal|0
condition|)
comment|/* any count less than 2? */
block|{
comment|/** Since an ideal random function has prob=0.5 each for input/output bit                               ** pair, the expected distribution of onesCnt[i][j] is binomial.                               ** Thus, at this point, the probability of onesCnt[i][j]< 2 is:                              **     ((1+32)/2)/(2**-32)                              ** This probability is roughly 2**(-27), so when we observe such an                              ** occurrence, we exit immediately to save taking a lot of stats just                              ** to fail later. This filter significantly speeds up the search, at a                              ** very low probability of improperly dismissing a "good" rotation set.                              **/
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_SHOW
operator|&&
name|vCnt
operator|>
literal|1
condition|)
block|{
comment|/* show why we stopped, if we already showed something */
name|printf
argument_list|(
literal|"%23s/* quick exit: %d/%d */\n"
argument_list|,
literal|""
argument_list|,
operator|(
name|uint
operator|)
name|onesCnt
index|[
literal|0
index|]
index|[
name|i
index|]
index|[
name|j
index|]
argument_list|,
name|n
argument_list|)
expr_stmt|;
block|}
return|return
name|r
operator|->
name|rWorst
operator|=
literal|0
return|;
comment|/* not a good result */
block|}
block|}
block|}
block|}
comment|/* now process the stats from the samples we just generated */
name|assert
argument_list|(
name|t
operator|.
name|sampleCnt
operator|<
operator|(
literal|1
operator|<<
literal|22
operator|)
argument_list|)
expr_stmt|;
comment|/* 2**22 is big enough not to worry! */
name|memset
argument_list|(
name|hist
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|hist
argument_list|)
argument_list|)
expr_stmt|;
name|fSum
operator|=
name|fSqr
operator|=
literal|0.0
expr_stmt|;
name|denom
operator|=
literal|1.0
operator|/
operator|(
name|double
operator|)
name|t
operator|.
name|sampleCnt
expr_stmt|;
name|rMin
operator|=
name|minCnt
operator|=
operator|~
literal|0u
expr_stmt|;
name|totSum
operator|=
name|rMax
operator|=
name|rMinCnt
operator|=
name|rMaxCnt
operator|=
name|maxCnt
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|bitsPerBlock
condition|;
name|i
operator|++
control|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|bitsPerBlock
operator|/
literal|8
condition|;
name|j
operator|++
control|)
block|{
name|w
operator|=
name|onesCnt
index|[
literal|0
index|]
index|[
name|i
index|]
index|[
name|j
index|]
expr_stmt|;
comment|/* 7+ bits here */
name|y
operator|=
name|onesCnt
index|[
literal|1
index|]
index|[
name|i
index|]
index|[
name|j
index|]
expr_stmt|;
comment|/* 7+ bits here */
name|z
operator|=
name|onesCnt
index|[
literal|2
index|]
index|[
name|i
index|]
index|[
name|j
index|]
expr_stmt|;
comment|/* 8  bits here.  Total = 22 bits */
for|for
control|(
name|k
operator|=
literal|0
init|;
name|k
operator|<
literal|8
condition|;
name|k
operator|++
operator|,
name|w
operator|>>=
literal|8
operator|,
name|y
operator|>>=
literal|8
operator|,
name|z
operator|>>=
literal|8
control|)
block|{
name|q
operator|=
call|(
name|uint
call|)
argument_list|(
operator|(
name|w
operator|&
literal|0xFF
operator|)
operator|+
operator|(
operator|(
name|y
operator|&
literal|0xFF
operator|)
operator|<<
literal|7
operator|)
operator|+
operator|(
operator|(
name|z
operator|&
literal|0xFF
operator|)
operator|<<
literal|14
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|maxCnt
operator|<
name|q
condition|)
block|{
name|maxCnt
operator|=
name|q
expr_stmt|;
name|iMax
operator|=
name|i
expr_stmt|;
name|jMax
operator|=
name|j
expr_stmt|;
if|if
condition|(
name|rMax
operator|<
name|q
condition|)
block|{
name|rMax
operator|=
name|q
expr_stmt|;
name|rMaxCnt
operator|=
literal|0
expr_stmt|;
block|}
block|}
if|if
condition|(
name|minCnt
operator|>
name|q
condition|)
block|{
name|minCnt
operator|=
name|q
expr_stmt|;
name|iMin
operator|=
name|i
expr_stmt|;
name|jMin
operator|=
name|j
expr_stmt|;
if|if
condition|(
name|rMin
operator|>
name|q
condition|)
block|{
name|rMin
operator|=
name|q
expr_stmt|;
name|rMinCnt
operator|=
literal|0
expr_stmt|;
block|}
block|}
if|if
condition|(
name|rMin
operator|==
name|minCnt
condition|)
name|rMinCnt
operator|++
expr_stmt|;
if|if
condition|(
name|rMax
operator|==
name|maxCnt
condition|)
name|rMaxCnt
operator|++
expr_stmt|;
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_SHOW
condition|)
block|{
comment|/* compute more extensive stats only if showing results below */
name|totSum
operator|+=
name|q
expr_stmt|;
name|x
operator|=
name|q
operator|*
name|denom
expr_stmt|;
comment|/* update stats for stdDev  */
name|fSum
operator|+=
name|x
expr_stmt|;
name|fSqr
operator|+=
name|x
operator|*
name|x
expr_stmt|;
name|hist
index|[
operator|(
name|uint
operator|)
name|floor
argument_list|(
name|x
operator|*
name|HIST_BINS
argument_list|)
index|]
operator|++
expr_stmt|;
comment|/* track histogram  */
block|}
block|}
block|}
block|}
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_USE_ABS
operator|&&
name|rMin
operator|>
name|t
operator|.
name|sampleCnt
operator|-
name|rMax
condition|)
block|{
name|rMin
operator|=
name|t
operator|.
name|sampleCnt
operator|-
name|rMax
expr_stmt|;
comment|/* use max variation from 1/2 */
name|iMin
operator|=
name|iMax
expr_stmt|;
name|jMin
operator|=
name|jMax
expr_stmt|;
block|}
if|if
condition|(
name|r
operator|->
name|rWorst
operator|>
name|rMin
condition|)
block|{
name|r
operator|->
name|rWorst
operator|=
name|rMin
expr_stmt|;
if|if
condition|(
name|rMin
operator|==
literal|0
condition|)
block|{
comment|/* if far worse than current best, stop now (to speed up the search) */
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_SHOW
operator|&&
operator|(
name|d
operator|>
literal|1
operator|||
name|vCnt
operator|>
literal|1
operator|)
condition|)
comment|/* show why we stopped, if we already showed something */
name|printf
argument_list|(
literal|"%23s/* early exit */\n"
argument_list|,
literal|""
argument_list|)
expr_stmt|;
return|return
name|r
operator|->
name|rWorst
operator|=
literal|0
return|;
block|}
block|}
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_SHOW
condition|)
block|{
comment|/* show some detailed results of the test */
if|if
condition|(
name|d
operator|==
literal|1
condition|)
block|{
comment|/* put out the rotation info the first time thru */
if|if
condition|(
operator|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_DO_RAND
operator|)
operator|==
literal|0
condition|)
block|{
name|printf
argument_list|(
literal|"Rotation set [CRC=%08X. hw_OR=%2d. sampleCnt=%5d. block=%4d bits. v=%d]:\n"
argument_list|,
name|r
operator|->
name|CRC
argument_list|,
name|r
operator|->
name|hw_OR
index|[
name|v
index|]
argument_list|,
name|t
operator|.
name|sampleCnt
argument_list|,
name|bitsPerBlock
argument_list|,
name|v
argument_list|)
expr_stmt|;
if|if
condition|(
name|vCnt
operator|==
literal|0
condition|)
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|rotsPerCycle
condition|;
name|i
operator|++
control|)
name|printf
argument_list|(
literal|"   %2d%s"
argument_list|,
name|r
operator|->
name|rotList
index|[
name|i
index|]
argument_list|,
operator|(
operator|(
name|i
operator|+
literal|1
operator|)
operator|%
operator|(
name|wordsPerBlock
operator|/
literal|2
operator|)
operator|)
condition|?
literal|""
else|:
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
name|printf
argument_list|(
literal|"rnds=%2d,cnt=%5d"
argument_list|,
name|t
operator|.
name|rounds
argument_list|,
name|t
operator|.
name|sampleCnt
argument_list|)
expr_stmt|;
name|x
operator|=
name|fSum
operator|/
operator|(
name|bitsPerBlock
operator|*
name|bitsPerBlock
operator|)
expr_stmt|;
name|var
operator|=
operator|(
name|fSqr
operator|/
operator|(
name|bitsPerBlock
operator|*
name|bitsPerBlock
operator|)
operator|)
operator|-
name|x
operator|*
name|x
expr_stmt|;
name|printf
argument_list|(
literal|" min=%5.3f.[%c] max=%5.3f.[%c]  hw=%3d..%3d.  avg=%7.5f. std=%6.4f. d=%X. [%3d,%3d]"
argument_list|,
name|rMin
operator|*
name|denom
argument_list|,
operator|(
name|rMinCnt
operator|>
literal|9
operator|)
condition|?
literal|'+'
else|:
literal|'0'
operator|+
name|rMinCnt
argument_list|,
name|rMax
operator|*
name|denom
argument_list|,
operator|(
name|rMaxCnt
operator|>
literal|9
operator|)
condition|?
literal|'+'
else|:
literal|'0'
operator|+
name|rMaxCnt
argument_list|,
name|hwMin
argument_list|,
name|hwMax
argument_list|,
operator|(
name|totSum
operator|*
name|denom
operator|)
operator|/
operator|(
name|bitsPerBlock
operator|*
name|bitsPerBlock
operator|)
argument_list|,
name|sqrt
argument_list|(
name|var
argument_list|)
argument_list|,
operator|(
name|uint
operator|)
name|d
argument_list|,
name|iMin
argument_list|,
name|jMin
argument_list|)
expr_stmt|;
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_SHOW_HIST
condition|)
block|{
comment|/* very wide histogram display */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<=
name|HIST_BINS
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|hist
index|[
name|i
index|]
condition|)
name|printf
argument_list|(
literal|" %7.5f"
argument_list|,
name|hist
index|[
name|i
index|]
operator|/
call|(
name|double
call|)
argument_list|(
name|bitsPerBlock
operator|*
name|bitsPerBlock
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"  _     "
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_DO_RAND
condition|)
name|printf
argument_list|(
literal|" [RANDOM] "
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_DO_RAND
condition|)
break|break;
comment|/* no need to do more than one random setting per rotation set */
block|}
comment|/* for (d=1;d<dMax;d+=2) */
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_DO_RAND
condition|)
break|break;
comment|/* no need to do more than one random setting per rotation set */
block|}
return|return
name|r
operator|->
name|rWorst
return|;
block|}
end_function

begin_comment
comment|/* twiddle a bit with an entry, but keep maxSatRounds satisfied */
end_comment

begin_function
name|void
name|Twiddle
parameter_list|(
name|rSearchRec
modifier|*
name|r
parameter_list|,
name|testParms
name|t
parameter_list|)
block|{
enum|enum
block|{
name|MAX_TWIDDLE_CNT
init|=
literal|100
block|,
name|MAX_ROT_CNT
init|=
literal|6
block|}
enum|;
name|uint
name|i
decl_stmt|,
name|j
decl_stmt|,
name|k
decl_stmt|,
name|n
decl_stmt|,
name|v
index|[
name|MAX_ROT_CNT
index|]
decl_stmt|;
name|u08b
name|old
index|[
name|MAX_ROT_CNT
index|]
decl_stmt|;
name|u64b
name|usedBitmap
decl_stmt|;
name|u08b
name|goodRots
index|[
name|BITS_PER_WORD
index|]
decl_stmt|;
name|uint
name|goodRotCnt
decl_stmt|;
name|assert
argument_list|(
name|rotsPerCycle
operator|<=
sizeof|sizeof
argument_list|(
name|usedBitmap
argument_list|)
operator|*
literal|8
argument_list|)
expr_stmt|;
name|r
operator|->
name|ID
operator|+=
operator|(
literal|1
operator|<<
name|TWIDDLE_CNT_BIT0
operator|)
expr_stmt|;
comment|/* bump count of number of times twiddled */
name|r
operator|->
name|ID
operator|&=
operator|~
name|ID_RECALC_BIT
expr_stmt|;
comment|/* show this one hasn't been had recalc yet */
name|r
operator|->
name|parentCRC
operator|=
name|r
operator|->
name|CRC
expr_stmt|;
comment|/* track genealogy */
for|for
control|(
name|i
operator|=
name|goodRotCnt
operator|=
literal|0
init|;
name|i
operator|<
name|BITS_PER_WORD
condition|;
name|i
operator|++
control|)
if|if
condition|(
operator|!
name|RotCnt_Bad
argument_list|(
name|i
argument_list|)
condition|)
block|{
name|goodRots
index|[
name|goodRotCnt
operator|++
index|]
operator|=
operator|(
name|u08b
operator|)
name|i
expr_stmt|;
block|}
name|n
operator|=
literal|1
operator|+
operator|(
name|Rand08
argument_list|()
operator|%
name|MAX_ROT_CNT
operator|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|4
condition|;
name|i
operator|++
control|)
block|{
name|usedBitmap
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|n
condition|;
name|j
operator|++
control|)
block|{
comment|/* pick which set of n rotation constants to change */
do|do
block|{
name|v
index|[
name|j
index|]
operator|=
name|Rand08
argument_list|()
operator|%
name|rotsPerCycle
expr_stmt|;
comment|/* rotation index */
block|}
do|while
condition|(
operator|(
name|usedBitmap
operator|>>
name|v
index|[
name|j
index|]
operator|)
operator|&
literal|1
condition|)
do|;
comment|/* make sure all v[j] values are unique */
name|usedBitmap
operator||=
operator|(
operator|(
operator|(
name|u64b
operator|)
literal|1
operator|)
operator|<<
name|v
index|[
name|j
index|]
operator|)
expr_stmt|;
name|old
index|[
name|j
index|]
operator|=
name|r
operator|->
name|rotList
index|[
name|v
index|[
name|j
index|]
index|]
expr_stmt|;
comment|/* save current value */
block|}
for|for
control|(
name|k
operator|=
literal|0
init|;
name|k
operator|<
name|MAX_TWIDDLE_CNT
operator|/
literal|4
condition|;
name|k
operator|++
control|)
block|{
comment|/* here with n rotation indices (v[0..n-1]) to be changed */
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|n
condition|;
name|j
operator|++
control|)
block|{
do|do
block|{
name|r
operator|->
name|rotList
index|[
name|v
index|[
name|j
index|]
index|]
operator|=
name|goodRots
index|[
name|Rand32
argument_list|()
operator|%
name|goodRotCnt
index|]
expr_stmt|;
block|}
comment|/* make sure new rotation value changes */
do|while
condition|(
name|r
operator|->
name|rotList
index|[
name|v
index|[
name|j
index|]
index|]
operator|==
name|old
index|[
name|j
index|]
condition|)
do|;
block|}
if|if
condition|(
name|Cycle_Min_HW
argument_list|(
name|t
operator|.
name|maxSatRnds
argument_list|,
name|r
operator|->
name|rotList
argument_list|,
literal|0
argument_list|,
name|t
operator|.
name|rotVerMask
argument_list|)
operator|==
name|BITS_PER_WORD
condition|)
block|{
if|if
condition|(
name|i
operator|>=
literal|2
operator|||
operator|!
operator|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_KEEP_MIN_HW
operator|)
operator|||
name|Cycle_Min_HW
argument_list|(
name|t
operator|.
name|rounds
argument_list|,
name|r
operator|->
name|rotList
argument_list|,
name|t
operator|.
name|minHW_or
argument_list|,
name|t
operator|.
name|rotVerMask
argument_list|)
operator|>=
operator|(
name|int
operator|)
name|t
operator|.
name|minHW_or
condition|)
block|{
name|Set_Min_hw_OR
argument_list|(
name|r
argument_list|,
name|t
operator|.
name|rotVerMask
argument_list|,
name|t
operator|.
name|rounds
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|n
condition|;
name|j
operator|++
control|)
comment|/* didn't work: go back to the old values */
name|r
operator|->
name|rotList
index|[
name|v
index|[
name|j
index|]
index|]
operator|=
name|old
index|[
name|j
index|]
expr_stmt|;
block|}
block|}
comment|/* twiddling failed to produce a valid set (very rare). Select a brand new one */
name|get_rotation
argument_list|(
name|r
argument_list|,
name|t
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* run a full search */
end_comment

begin_function
name|void
name|RunSearch
parameter_list|(
name|testParms
name|t
parameter_list|)
block|{
enum|enum
block|{
name|KEEP_DIV
init|=
literal|16
block|,
name|KEEP_REP
init|=
literal|10
block|,
name|SHOW_CNT
init|=
literal|8
block|}
enum|;
name|rSearchRec
name|popList
index|[
name|MAX_POP_CNT
operator|+
literal|2
index|]
decl_stmt|;
name|uint
name|i
decl_stmt|,
name|j
decl_stmt|,
name|k
decl_stmt|,
name|n
decl_stmt|,
name|repCnt
decl_stmt|,
name|genCnt
decl_stmt|,
name|keepCnt
decl_stmt|,
name|prevBest
index|[
name|SHOW_CNT
index|]
decl_stmt|,
name|showMask
decl_stmt|;
specifier|const
name|char
modifier|*
name|timeStr
decl_stmt|;
name|time_t
name|t0
decl_stmt|,
name|t1
decl_stmt|;
name|Rand_Init
argument_list|(
name|t
operator|.
name|seed0
operator|+
operator|(
operator|(
operator|(
name|u64b
operator|)
name|bitsPerBlock
operator|)
operator|<<
literal|32
operator|)
argument_list|)
expr_stmt|;
name|memset
argument_list|(
name|prevBest
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|prevBest
argument_list|)
argument_list|)
expr_stmt|;
comment|/* now set up the globals according to selected Skein blocksize */
switch|switch
condition|(
name|bitsPerBlock
condition|)
block|{
case|case
literal|256
case|:
name|t
operator|.
name|genCntMax
operator|=
operator|(
name|t
operator|.
name|genCntMax
operator|)
condition|?
name|t
operator|.
name|genCntMax
else|:
name|DEFAULT_GEN_CNT_4
expr_stmt|;
name|t
operator|.
name|rounds
operator|=
operator|(
name|t
operator|.
name|rounds
operator|)
condition|?
name|t
operator|.
name|rounds
else|:
name|DEFAULT_ROUND_CNT_4
expr_stmt|;
name|t
operator|.
name|minHW_or
operator|=
operator|(
name|t
operator|.
name|minHW_or
operator|)
condition|?
name|t
operator|.
name|minHW_or
else|:
name|MIN_HW_OR_4
expr_stmt|;
name|t
operator|.
name|maxSatRnds
operator|=
operator|(
name|t
operator|.
name|maxSatRnds
operator|)
condition|?
name|t
operator|.
name|maxSatRnds
else|:
name|MAX_SAT_ROUNDS_4
expr_stmt|;
name|fwd_cycle_or_rN
operator|=
operator|(
name|t
operator|.
name|rounds
operator|!=
literal|8
operator|)
condition|?
name|fwd_cycle_4_or
else|:
name|fwd_cycle_4_or_r8
expr_stmt|;
name|rev_cycle_or_rN
operator|=
operator|(
name|t
operator|.
name|rounds
operator|!=
literal|8
operator|)
condition|?
name|rev_cycle_4_or
else|:
name|rev_cycle_4_or_r8
expr_stmt|;
name|fwd_cycle_or
operator|=
name|fwd_cycle_4_or
expr_stmt|;
name|rev_cycle_or
operator|=
name|fwd_cycle_4_or
expr_stmt|;
name|fwd_cycle
operator|=
name|fwd_cycle_4
expr_stmt|;
name|rev_cycle
operator|=
name|rev_cycle_4
expr_stmt|;
name|showMask
operator|=
literal|7
expr_stmt|;
break|break;
case|case
literal|512
case|:
name|t
operator|.
name|genCntMax
operator|=
operator|(
name|t
operator|.
name|genCntMax
operator|)
condition|?
name|t
operator|.
name|genCntMax
else|:
name|DEFAULT_GEN_CNT_8
expr_stmt|;
name|t
operator|.
name|rounds
operator|=
operator|(
name|t
operator|.
name|rounds
operator|)
condition|?
name|t
operator|.
name|rounds
else|:
name|DEFAULT_ROUND_CNT_8
expr_stmt|;
name|t
operator|.
name|minHW_or
operator|=
operator|(
name|t
operator|.
name|minHW_or
operator|)
condition|?
name|t
operator|.
name|minHW_or
else|:
name|MIN_HW_OR_8
expr_stmt|;
name|t
operator|.
name|maxSatRnds
operator|=
operator|(
name|t
operator|.
name|maxSatRnds
operator|)
condition|?
name|t
operator|.
name|maxSatRnds
else|:
name|MAX_SAT_ROUNDS_8
expr_stmt|;
name|fwd_cycle_or_rN
operator|=
operator|(
name|t
operator|.
name|rounds
operator|!=
literal|8
operator|)
condition|?
name|fwd_cycle_8_or
else|:
name|fwd_cycle_8_or_r8
expr_stmt|;
name|rev_cycle_or_rN
operator|=
operator|(
name|t
operator|.
name|rounds
operator|!=
literal|8
operator|)
condition|?
name|rev_cycle_8_or
else|:
name|rev_cycle_8_or_r8
expr_stmt|;
name|fwd_cycle_or
operator|=
name|fwd_cycle_8_or
expr_stmt|;
name|rev_cycle_or
operator|=
name|rev_cycle_8_or
expr_stmt|;
name|fwd_cycle
operator|=
name|fwd_cycle_8
expr_stmt|;
name|rev_cycle
operator|=
name|rev_cycle_8
expr_stmt|;
name|showMask
operator|=
literal|3
expr_stmt|;
break|break;
case|case
literal|1024
case|:
name|t
operator|.
name|genCntMax
operator|=
operator|(
name|t
operator|.
name|genCntMax
operator|)
condition|?
name|t
operator|.
name|genCntMax
else|:
name|DEFAULT_GEN_CNT_16
expr_stmt|;
name|t
operator|.
name|rounds
operator|=
operator|(
name|t
operator|.
name|rounds
operator|)
condition|?
name|t
operator|.
name|rounds
else|:
name|DEFAULT_ROUND_CNT_16
expr_stmt|;
name|t
operator|.
name|minHW_or
operator|=
operator|(
name|t
operator|.
name|minHW_or
operator|)
condition|?
name|t
operator|.
name|minHW_or
else|:
name|MIN_HW_OR_16
expr_stmt|;
name|t
operator|.
name|maxSatRnds
operator|=
operator|(
name|t
operator|.
name|maxSatRnds
operator|)
condition|?
name|t
operator|.
name|maxSatRnds
else|:
name|MAX_SAT_ROUNDS_16
expr_stmt|;
name|fwd_cycle_or_rN
operator|=
operator|(
name|t
operator|.
name|rounds
operator|!=
literal|9
operator|)
condition|?
name|fwd_cycle_16_or
else|:
name|fwd_cycle_16_or_r9
expr_stmt|;
name|rev_cycle_or_rN
operator|=
operator|(
name|t
operator|.
name|rounds
operator|!=
literal|9
operator|)
condition|?
name|rev_cycle_16_or
else|:
name|rev_cycle_16_or_r9
expr_stmt|;
name|fwd_cycle_or
operator|=
name|fwd_cycle_16_or
expr_stmt|;
name|rev_cycle_or
operator|=
name|rev_cycle_16_or
expr_stmt|;
name|fwd_cycle
operator|=
name|fwd_cycle_16
expr_stmt|;
name|rev_cycle
operator|=
name|rev_cycle_16
expr_stmt|;
name|showMask
operator|=
literal|1
expr_stmt|;
break|break;
default|default:
name|printf
argument_list|(
literal|"Invalid block size!"
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|2
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|t
operator|.
name|popCnt
operator|>
name|MAX_POP_CNT
condition|)
name|t
operator|.
name|popCnt
operator|=
name|MAX_POP_CNT
expr_stmt|;
if|if
condition|(
name|t
operator|.
name|popCnt
operator|<
name|MIN_POP_CNT
condition|)
name|t
operator|.
name|popCnt
operator|=
name|MIN_POP_CNT
expr_stmt|;
name|wordsPerBlock
operator|=
name|bitsPerBlock
operator|/
name|BITS_PER_WORD
expr_stmt|;
name|rotsPerCycle
operator|=
operator|(
name|wordsPerBlock
operator|/
literal|2
operator|)
operator|*
name|ROUNDS_PER_CYCLE
expr_stmt|;
name|keepCnt
operator|=
name|t
operator|.
name|popCnt
operator|/
name|KEEP_DIV
expr_stmt|;
name|assert
argument_list|(
name|keepCnt
operator|*
operator|(
literal|1
operator|+
name|KEEP_REP
operator|)
operator|<=
name|t
operator|.
name|popCnt
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"******************************************************************\n"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"Random seed = %u. BlockSize =%4d bits. sampleCnt =%6d. rounds = %2d. minHW_or=%d. CPU = %d-bit\n"
argument_list|,
name|t
operator|.
name|seed0
argument_list|,
name|bitsPerBlock
argument_list|,
name|t
operator|.
name|sampleCnt
argument_list|,
name|t
operator|.
name|rounds
argument_list|,
name|t
operator|.
name|minHW_or
argument_list|,
operator|(
name|uint
operator|)
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
operator|*
literal|8
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"Population  = %d. keepCnt = %d. repCnt = %d. rest = %d. keepMinHW = %d\n"
argument_list|,
name|t
operator|.
name|popCnt
argument_list|,
name|keepCnt
argument_list|,
name|KEEP_REP
argument_list|,
name|t
operator|.
name|popCnt
operator|-
name|keepCnt
operator|*
operator|(
literal|1
operator|+
name|KEEP_REP
operator|)
argument_list|,
operator|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_KEEP_MIN_HW
operator|)
condition|?
literal|1
else|:
literal|0
argument_list|)
expr_stmt|;
name|timeStr
operator|=
name|ASCII_TimeDate
argument_list|()
expr_stmt|;
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_STDERR
condition|)
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Start: %sBlock size = %d bits. popCnt = %d. sampleCnt = %d. keepMinHW = %d"
argument_list|,
name|timeStr
argument_list|,
name|bitsPerBlock
argument_list|,
name|t
operator|.
name|popCnt
argument_list|,
name|t
operator|.
name|sampleCnt
argument_list|,
operator|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_KEEP_MIN_HW
operator|)
condition|?
literal|1
else|:
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|t
operator|.
name|runHours
condition|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|". run time = %d hours"
argument_list|,
name|t
operator|.
name|runHours
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
else|else
name|showMask
operator|=
literal|0
expr_stmt|;
name|printf
argument_list|(
literal|"Start: %s  \n"
argument_list|,
name|timeStr
argument_list|)
expr_stmt|;
name|time
argument_list|(
operator|&
name|t0
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
for|for
control|(
name|n
operator|=
literal|0
init|;
name|n
operator|<
name|t
operator|.
name|popCnt
condition|;
name|n
operator|++
control|)
block|{
comment|/* initialize the population with rotations that have "reasonable" hw_OR */
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_STDERR
condition|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"\rGetRot: %04X    \r"
argument_list|,
name|t
operator|.
name|popCnt
operator|-
name|n
argument_list|)
expr_stmt|;
if|if
condition|(
name|get_rotation
argument_list|(
operator|&
name|popList
index|[
name|n
index|]
argument_list|,
name|t
argument_list|)
operator|==
literal|0
condition|)
name|t
operator|.
name|popCnt
operator|=
name|n
expr_stmt|;
comment|/* stop after end of file read in */
block|}
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_STDERR
condition|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"\r%25s\r"
argument_list|,
literal|""
argument_list|)
expr_stmt|;
for|for
control|(
name|genCnt
operator|=
literal|0
init|;
name|genCnt
operator|<
name|t
operator|.
name|genCntMax
condition|;
name|genCnt
operator|++
control|)
block|{
comment|/* advance to the next generation */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|t
operator|.
name|popCnt
condition|;
name|i
operator|++
control|)
block|{
comment|/* generate stats for all entries (this loop is where all the time is spent!) */
if|if
condition|(
operator|(
name|i
operator|&
name|showMask
operator|)
operator|==
literal|1
condition|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"#%04X \r"
argument_list|,
name|t
operator|.
name|popCnt
operator|-
name|i
argument_list|)
expr_stmt|;
if|if
condition|(
name|genCnt
operator|==
literal|0
operator|||
name|i
operator|>=
name|keepCnt
condition|)
block|{
name|CheckDifferentials
argument_list|(
operator|&
name|popList
index|[
name|i
index|]
argument_list|,
name|t
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|i
operator|<=
name|keepCnt
operator|/
literal|2
operator|&&
operator|(
name|popList
index|[
name|i
index|]
operator|.
name|ID
operator|&
name|ID_RECALC_BIT
operator|)
operator|==
literal|0
condition|)
block|{
comment|/* recalc with bigger sampleCnt for better accuracy */
name|t
operator|.
name|sampleCnt
operator|<<=
literal|2
expr_stmt|;
name|CheckDifferentials
argument_list|(
operator|&
name|popList
index|[
name|i
index|]
argument_list|,
name|t
argument_list|)
expr_stmt|;
name|t
operator|.
name|sampleCnt
operator|>>=
literal|2
expr_stmt|;
name|popList
index|[
name|i
index|]
operator|.
name|rWorst
operator|=
operator|(
name|popList
index|[
name|i
index|]
operator|.
name|rWorst
operator|+
literal|2
operator|)
operator|/
literal|4
expr_stmt|;
name|popList
index|[
name|i
index|]
operator|.
name|ID
operator||=
name|ID_RECALC_BIT
expr_stmt|;
block|}
block|}
name|qsort
argument_list|(
name|popList
argument_list|,
name|t
operator|.
name|popCnt
argument_list|,
sizeof|sizeof
argument_list|(
name|popList
index|[
literal|0
index|]
argument_list|)
argument_list|,
name|Compare_SearchRec_Descending
argument_list|)
expr_stmt|;
if|if
condition|(
name|t
operator|.
name|genCntMax
operator|==
literal|1
condition|)
block|{
name|keepCnt
operator|=
name|t
operator|.
name|popCnt
expr_stmt|;
break|break;
block|}
comment|/* allow quick processing from file */
comment|/* now update the population for the next generation */
name|n
operator|=
name|t
operator|.
name|popCnt
operator|-
literal|1
expr_stmt|;
comment|/* start discarding at the end of the list */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|keepCnt
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_WEIGHT_REP
condition|)
name|repCnt
operator|=
operator|(
name|i
operator|<
name|keepCnt
operator|/
literal|2
operator|)
condition|?
name|KEEP_REP
operator|+
literal|2
else|:
name|KEEP_REP
operator|-
literal|2
expr_stmt|;
else|else
name|repCnt
operator|=
name|KEEP_REP
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|repCnt
condition|;
name|j
operator|++
operator|,
name|n
operator|--
control|)
block|{
comment|/* replicate the best ones, replacing the worst ones */
name|popList
index|[
name|n
index|]
operator|=
name|popList
index|[
name|i
index|]
expr_stmt|;
if|if
condition|(
name|j
operator|==
literal|0
condition|)
block|{
comment|/* splice two together, but only if they are from the same initial rotation set */
name|k
operator|=
name|Rand32
argument_list|()
operator|%
name|keepCnt
expr_stmt|;
if|if
condition|(
operator|(
operator|(
name|popList
index|[
name|n
index|]
operator|.
name|ID
operator|^
name|popList
index|[
name|k
index|]
operator|.
name|ID
operator|)
operator|&
name|ID_NUM_MASK
operator|)
operator|==
literal|0
condition|)
name|memcpy
argument_list|(
name|popList
index|[
name|n
index|]
operator|.
name|rotList
argument_list|,
name|popList
index|[
name|k
index|]
operator|.
name|rotList
argument_list|,
name|rotsPerCycle
operator|*
sizeof|sizeof
argument_list|(
name|popList
index|[
name|n
index|]
operator|.
name|rotList
index|[
literal|0
index|]
argument_list|)
operator|/
literal|2
argument_list|)
expr_stmt|;
block|}
name|Twiddle
argument_list|(
operator|&
name|popList
index|[
name|n
index|]
argument_list|,
name|t
argument_list|)
expr_stmt|;
comment|/* tweak the replicate entry a bit */
name|assert
argument_list|(
name|n
operator|>=
name|keepCnt
argument_list|)
expr_stmt|;
comment|/* sanity check  */
block|}
block|}
for|for
control|(
init|;
name|n
operator|>=
name|keepCnt
condition|;
name|n
operator|--
control|)
comment|/* just tweak the rest */
block|{
name|Twiddle
argument_list|(
operator|&
name|popList
index|[
name|n
index|]
argument_list|,
name|t
argument_list|)
expr_stmt|;
block|}
name|time
argument_list|(
operator|&
name|t1
argument_list|)
expr_stmt|;
comment|/* show current best */
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_STDERR
condition|)
block|{
comment|/* first to stderr (assuming redirected stdout */
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"\r%4d: "
argument_list|,
name|genCnt
operator|+
literal|1
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
name|j
operator|=
literal|0
init|;
name|i
operator|<
name|SHOW_CNT
condition|;
name|i
operator|++
control|)
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|" %5.3f%c"
argument_list|,
name|popList
index|[
name|i
index|]
operator|.
name|rWorst
operator|/
operator|(
name|double
operator|)
name|t
operator|.
name|sampleCnt
argument_list|,
operator|(
name|popList
index|[
name|i
index|]
operator|.
name|ID
operator|&
name|ID_RECALC_BIT
operator|)
condition|?
literal|'r'
else|:
literal|' '
argument_list|)
expr_stmt|;
name|j
operator||=
operator|(
name|popList
index|[
name|i
index|]
operator|.
name|rWorst
operator|^
name|prevBest
index|[
name|i
index|]
operator|)
expr_stmt|;
comment|/* track changes */
name|prevBest
index|[
name|i
index|]
operator|=
name|popList
index|[
name|i
index|]
operator|.
name|rWorst
expr_stmt|;
block|}
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"  {%6d sec%c}\n"
argument_list|,
call|(
name|uint
call|)
argument_list|(
name|t1
operator|-
name|t0
argument_list|)
argument_list|,
operator|(
name|j
operator|)
condition|?
literal|'*'
else|:
literal|' '
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_VERBOSE
condition|)
block|{
comment|/* then more details to stdout */
name|printf
argument_list|(
literal|"::::: Gen =%5d. Best =%6.3f. PopCnt =%5d. SampleCnt =%5d. time=%6d.\n"
argument_list|,
name|genCnt
operator|+
literal|1
argument_list|,
name|popList
index|[
literal|0
index|]
operator|.
name|rWorst
operator|/
operator|(
name|double
operator|)
name|t
operator|.
name|sampleCnt
argument_list|,
name|t
operator|.
name|popCnt
argument_list|,
name|t
operator|.
name|sampleCnt
argument_list|,
call|(
name|uint
call|)
argument_list|(
name|t1
operator|-
name|t0
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|keepCnt
condition|;
name|i
operator|++
control|)
name|ShowSearchRec
argument_list|(
name|stdout
argument_list|,
operator|&
name|popList
index|[
name|i
index|]
argument_list|,
name|t
argument_list|,
name|SHOW_ROTS_PRELIM
argument_list|,
operator|(
name|i
operator|)
condition|?
literal|' '
else|:
literal|'-'
argument_list|,
name|i
operator|+
literal|1
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|t
operator|.
name|runHours
operator|&&
name|t
operator|.
name|runHours
operator|*
literal|3600
operator|<
call|(
name|uint
call|)
argument_list|(
name|t1
operator|-
name|t0
argument_list|)
condition|)
break|break;
comment|/* timeout? */
block|}
comment|/* re-grade the top entries using larger sampleCnt values */
name|printf
argument_list|(
literal|"\n+++++++++++++ Preliminary results: sampleCnt = %5d, block = %4d bits\n"
argument_list|,
name|t
operator|.
name|sampleCnt
argument_list|,
name|bitsPerBlock
argument_list|)
expr_stmt|;
name|qsort
argument_list|(
name|popList
argument_list|,
name|keepCnt
argument_list|,
sizeof|sizeof
argument_list|(
name|popList
index|[
literal|0
index|]
argument_list|)
argument_list|,
name|Compare_SearchRec_Descending
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|keepCnt
condition|;
name|i
operator|++
control|)
name|ShowSearchRec
argument_list|(
name|stdout
argument_list|,
operator|&
name|popList
index|[
name|i
index|]
argument_list|,
name|t
argument_list|,
name|SHOW_ROTS_PRELIM
argument_list|,
literal|' '
argument_list|,
name|i
operator|+
literal|1
argument_list|)
expr_stmt|;
comment|/* re-run several times, since there will be statistical variations */
name|t
operator|.
name|rotVerMask
operator|=
name|MAX_ROT_VER_MASK
expr_stmt|;
name|t
operator|.
name|diffBits
operator|=
operator|(
name|t
operator|.
name|diffBits
operator|&
literal|0x100
operator|)
condition|?
name|t
operator|.
name|diffBits
else|:
literal|3
expr_stmt|;
name|t
operator|.
name|sampleCnt
operator|*=
literal|2
expr_stmt|;
name|t
operator|.
name|tstFlags
operator||=
name|TST_FLG_SHOW
expr_stmt|;
name|t
operator|.
name|tstFlags
operator|&=
operator|(
name|TST_FLG_STDERR
operator||
name|TST_FLG_SHOW
operator||
name|TST_FLG_USE_ABS
operator||
name|TST_FLG_CHECK_ONE
operator||
name|TST_FLG_SHOW_HIST
operator|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
operator|(
operator|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_CHECK_ONE
operator|)
condition|?
literal|1u
else|:
literal|2u
operator|)
condition|;
name|j
operator|++
control|)
block|{
comment|/* do it twice, once with and once without USE_ABS, unless TST_FLG_CHECK_ONE set */
if|if
condition|(
operator|!
operator|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_CHECK_ONE
operator|)
condition|)
name|t
operator|.
name|tstFlags
operator|^=
name|TST_FLG_USE_ABS
expr_stmt|;
for|for
control|(
name|n
operator|=
literal|0
init|;
name|n
operator|<
name|t
operator|.
name|regradeCnt
condition|;
name|n
operator|++
control|)
block|{
name|t
operator|.
name|sampleCnt
operator|*=
literal|2
expr_stmt|;
name|printf
argument_list|(
literal|"+++ Re-running differentials with sampleCnt = %d, blockSize = %4d bits.%s\n"
argument_list|,
name|t
operator|.
name|sampleCnt
argument_list|,
name|bitsPerBlock
argument_list|,
operator|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_USE_ABS
operator|)
condition|?
literal|" absDiff"
else|:
literal|""
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|keepCnt
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_STDERR
condition|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"       Re-run: samples=%d, blk=%4d. #%02d.%s    \r"
argument_list|,
name|t
operator|.
name|sampleCnt
argument_list|,
name|bitsPerBlock
argument_list|,
name|keepCnt
operator|-
name|i
argument_list|,
operator|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_USE_ABS
operator|)
condition|?
literal|" absDiff"
else|:
literal|""
argument_list|)
expr_stmt|;
name|CheckDifferentials
argument_list|(
operator|&
name|popList
index|[
name|i
index|]
argument_list|,
name|t
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|keepCnt
operator|==
literal|1
condition|)
block|{
comment|/* show random comparison for final values */
name|printf
argument_list|(
literal|"        RANDOM OUTPUT: /* useful stats for comparison to 'ideal' */\n"
argument_list|)
expr_stmt|;
name|t
operator|.
name|tstFlags
operator||=
name|TST_FLG_DO_RAND
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|2
condition|;
name|i
operator|++
control|)
block|{
name|popList
index|[
name|keepCnt
index|]
operator|=
name|popList
index|[
name|keepCnt
operator|-
literal|1
index|]
expr_stmt|;
name|CheckDifferentials
argument_list|(
operator|&
name|popList
index|[
name|keepCnt
index|]
argument_list|,
name|t
argument_list|)
expr_stmt|;
block|}
name|t
operator|.
name|tstFlags
operator|&=
operator|~
name|TST_FLG_DO_RAND
expr_stmt|;
block|}
comment|/* sort per new stats */
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_STDERR
condition|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"\r%60s\r"
argument_list|,
literal|""
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n+++++++++++++ Final results: sampleCnt = %5d, blockSize = %4d bits.%s\n"
argument_list|,
name|t
operator|.
name|sampleCnt
argument_list|,
name|bitsPerBlock
argument_list|,
operator|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_USE_ABS
operator|)
condition|?
literal|" absDiff"
else|:
literal|""
argument_list|)
expr_stmt|;
name|qsort
argument_list|(
name|popList
argument_list|,
name|keepCnt
argument_list|,
sizeof|sizeof
argument_list|(
name|popList
index|[
literal|0
index|]
argument_list|)
argument_list|,
name|Compare_SearchRec_Descending
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
name|keepCnt
init|;
name|i
condition|;
name|i
operator|--
control|)
name|ShowSearchRec
argument_list|(
name|stdout
argument_list|,
operator|&
name|popList
index|[
name|i
operator|-
literal|1
index|]
argument_list|,
name|t
argument_list|,
name|SHOW_ROTS_FINAL
argument_list|,
operator|(
name|i
operator|==
literal|1
operator|)
condition|?
literal|'-'
else|:
literal|' '
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
block|}
name|printf
argument_list|(
literal|"\n+++++++++++++ Formatted results: sampleCnt = %5d, blockSize = %4d bits. %s\n"
argument_list|,
name|t
operator|.
name|sampleCnt
argument_list|,
name|bitsPerBlock
argument_list|,
operator|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_USE_ABS
operator|)
condition|?
literal|" absDiff"
else|:
literal|""
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
name|keepCnt
init|;
name|i
condition|;
name|i
operator|--
control|)
block|{
name|ShowSearchRec
argument_list|(
name|stdout
argument_list|,
operator|&
name|popList
index|[
name|i
operator|-
literal|1
index|]
argument_list|,
name|t
argument_list|,
name|SHOW_ROTS_H
argument_list|,
literal|' '
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Show_HW_rounds
argument_list|(
name|popList
index|[
name|i
operator|-
literal|1
index|]
operator|.
name|rotList
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
name|t
operator|.
name|sampleCnt
operator|>>=
name|n
expr_stmt|;
comment|/* revert to original sampleCnt */
block|}
name|time
argument_list|(
operator|&
name|t1
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"End:   %s\n"
argument_list|,
name|ASCII_TimeDate
argument_list|()
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"Elapsed time = %6.3f hours\n\n"
argument_list|,
operator|(
name|t1
operator|-
name|t0
operator|)
operator|/
operator|(
name|double
operator|)
literal|3600.0
argument_list|)
expr_stmt|;
if|if
condition|(
name|t
operator|.
name|tstFlags
operator|&
name|TST_FLG_STDERR
condition|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"\r%60s\n"
argument_list|,
literal|""
argument_list|)
expr_stmt|;
comment|/* clear the screen if needed */
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|GiveHelp
parameter_list|(
name|void
parameter_list|)
block|{
name|printf
argument_list|(
literal|"Usage:   skein_rot_search [options/flags]\n"
literal|"Options: -Bnn   = set Skein block size in bits (default=512)\n"
literal|"         -Cnn   = set count of random differentials taken\n"
literal|"         -Dnn   = set number bits of difference pattern tested (default=1)\n"
literal|"         -Gnn   = set min invalid rotation value (default 0)\n"
literal|"         -Inn   = set rotation version mask\n"
literal|"         -Onn   = set Hamming weight offset\n"
literal|"         -Pnn   = set population count\n"
literal|"         -Rnn   = set round count\n"
literal|"         -Snn   = set initial random seed (0 --> randomize)\n"
literal|"         -Tnn   = set max time to run (in hours)\n"
literal|"         -Wnn   = set minimum hamming weight\n"
literal|"         -Xnn   = set max test rotation count\n"
literal|"         -Znn   = set max rounds needed for saturation using OR\n"
literal|"         @file  = read rotations from file\n"
literal|"Flags:   -A     = use min, not absolute difference\n"
literal|"         -E     = no stderr output\n"
literal|"         -H     = show histogram (very wide)\n"
literal|"         -K     = keep minHW_or during twiddling\n"
literal|"         -Q     = disable quick exit in search\n"
literal|"         -U     = weighted repeat count (repeat best more frequently)\n"
literal|"         -V     = verbose mode\n"
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|0
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|int
name|main
parameter_list|(
name|int
name|argc
parameter_list|,
name|char
modifier|*
name|argv
index|[]
parameter_list|)
block|{
name|uint
name|i
decl_stmt|,
name|bMin
decl_stmt|,
name|bMax
decl_stmt|;
name|testParms
name|t
decl_stmt|;
name|uint
name|chkInv
init|=
literal|1
decl_stmt|;
comment|/* check inverse functions at startup (slow for debbuging) */
name|uint
name|goodRot
init|=
literal|2
decl_stmt|;
comment|/* first allowed rotation value (+/-) */
name|uint
name|seed
init|=
literal|1
decl_stmt|;
comment|/* 0 = randomize based on time, else use specified seed */
name|uint
name|do8
init|=
literal|0
decl_stmt|;
comment|/* optimize 8-bit CPU performance */
name|t
operator|.
name|rounds
operator|=
literal|0
expr_stmt|;
comment|/* number of Skein rounds to test */
name|t
operator|.
name|minHW_or
operator|=
literal|0
expr_stmt|;
comment|/* minHW (using OR) required */
name|t
operator|.
name|minOffs
operator|=
literal|4
expr_stmt|;
comment|/* heuristic used to speed up rotation search */
name|t
operator|.
name|diffBits
operator|=
literal|1
expr_stmt|;
comment|/* # consecutive bits of differential inputs tested */
name|t
operator|.
name|sampleCnt
operator|=
literal|1024
expr_stmt|;
comment|/* number of differential pairs tested */
name|t
operator|.
name|genCntMax
operator|=
literal|0
expr_stmt|;
comment|/* number of "generations" tested */
name|t
operator|.
name|maxSatRnds
operator|=
literal|0
expr_stmt|;
comment|/* number of rounds to Hamming weight "saturation" */
name|t
operator|.
name|rotVerMask
operator|=
literal|3
expr_stmt|;
comment|/* mask of which versions to run */
name|t
operator|.
name|runHours
operator|=
literal|0
expr_stmt|;
comment|/* stop searching after this many hours */
name|t
operator|.
name|dupRotMask
operator|=
literal|0
expr_stmt|;
comment|/* default is to allow same rotation value in a round */
name|t
operator|.
name|regradeCnt
operator|=
literal|3
expr_stmt|;
comment|/* how many scaled up counts to try */
name|t
operator|.
name|popCnt
operator|=
name|DEFAULT_POP_CNT
expr_stmt|;
comment|/* size of population */
name|t
operator|.
name|tstFlags
operator|=
name|TST_FLG_STDERR
operator||
name|TST_FLG_VERBOSE
operator||
name|TST_FLG_USE_ABS
operator||
name|TST_FLG_CHECK_ONE
expr_stmt|;
comment|/* default flags */
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<
operator|(
name|uint
operator|)
name|argc
condition|;
name|i
operator|++
control|)
block|{
comment|/* parse command line args */
if|if
condition|(
name|argv
index|[
name|i
index|]
index|[
literal|0
index|]
operator|==
literal|'?'
condition|)
name|GiveHelp
argument_list|()
expr_stmt|;
elseif|else
if|if
condition|(
name|argv
index|[
name|i
index|]
index|[
literal|0
index|]
operator|==
literal|'-'
operator|||
name|argv
index|[
name|i
index|]
index|[
literal|0
index|]
operator|==
literal|'+'
condition|)
block|{
define|#
directive|define
name|arg_toi
parameter_list|(
name|s
parameter_list|)
value|atoi(s + ((s[2] == '=') ? 3 : 2))
switch|switch
condition|(
name|toupper
argument_list|(
name|argv
index|[
name|i
index|]
index|[
literal|1
index|]
argument_list|)
condition|)
block|{
case|case
literal|'?'
case|:
name|GiveHelp
argument_list|()
expr_stmt|;
break|break;
case|case
literal|'A'
case|:
name|t
operator|.
name|tstFlags
operator|&=
operator|~
name|TST_FLG_USE_ABS
expr_stmt|;
break|break;
case|case
literal|'E'
case|:
name|t
operator|.
name|tstFlags
operator|&=
operator|~
name|TST_FLG_STDERR
expr_stmt|;
break|break;
case|case
literal|'H'
case|:
name|t
operator|.
name|tstFlags
operator||=
name|TST_FLG_SHOW_HIST
expr_stmt|;
break|break;
case|case
literal|'K'
case|:
name|t
operator|.
name|tstFlags
operator||=
name|TST_FLG_KEEP_MIN_HW
expr_stmt|;
break|break;
case|case
literal|'Q'
case|:
name|t
operator|.
name|tstFlags
operator||=
name|TST_FLG_QUICK_EXIT
expr_stmt|;
break|break;
case|case
literal|'U'
case|:
name|t
operator|.
name|tstFlags
operator||=
name|TST_FLG_WEIGHT_REP
expr_stmt|;
break|break;
case|case
literal|'V'
case|:
name|t
operator|.
name|tstFlags
operator|&=
operator|~
name|TST_FLG_VERBOSE
expr_stmt|;
break|break;
case|case
literal|'1'
case|:
name|t
operator|.
name|tstFlags
operator|&=
operator|~
name|TST_FLG_CHECK_ONE
expr_stmt|;
break|break;
case|case
literal|'B'
case|:
name|bitsPerBlock
operator|=
name|arg_toi
argument_list|(
name|argv
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'C'
case|:
name|t
operator|.
name|sampleCnt
operator|=
name|arg_toi
argument_list|(
name|argv
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'D'
case|:
name|t
operator|.
name|diffBits
operator|=
name|arg_toi
argument_list|(
name|argv
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'G'
case|:
name|goodRot
operator|=
name|arg_toi
argument_list|(
name|argv
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'I'
case|:
name|t
operator|.
name|rotVerMask
operator|=
name|arg_toi
argument_list|(
name|argv
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'J'
case|:
name|t
operator|.
name|regradeCnt
operator|=
name|arg_toi
argument_list|(
name|argv
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'O'
case|:
name|t
operator|.
name|minOffs
operator|=
name|arg_toi
argument_list|(
name|argv
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'P'
case|:
name|t
operator|.
name|popCnt
operator|=
name|arg_toi
argument_list|(
name|argv
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'R'
case|:
name|t
operator|.
name|rounds
operator|=
name|arg_toi
argument_list|(
name|argv
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'S'
case|:
name|seed
operator|=
name|arg_toi
argument_list|(
name|argv
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'T'
case|:
name|t
operator|.
name|runHours
operator|=
name|arg_toi
argument_list|(
name|argv
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'W'
case|:
name|t
operator|.
name|minHW_or
operator|=
name|arg_toi
argument_list|(
name|argv
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'X'
case|:
name|t
operator|.
name|genCntMax
operator|=
name|arg_toi
argument_list|(
name|argv
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'Z'
case|:
name|t
operator|.
name|maxSatRnds
operator|=
name|arg_toi
argument_list|(
name|argv
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'2'
case|:
name|t
operator|.
name|dupRotMask
operator|=
operator|~
literal|0u
expr_stmt|;
break|break;
case|case
literal|'0'
case|:
name|chkInv
operator|=
literal|0
expr_stmt|;
break|break;
case|case
literal|'8'
case|:
name|do8
operator|=
literal|1
expr_stmt|;
break|break;
default|default :
name|printf
argument_list|(
literal|"Unknown option: %s\n"
argument_list|,
name|argv
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|GiveHelp
argument_list|()
expr_stmt|;
break|break;
block|}
block|}
elseif|else
if|if
condition|(
name|argv
index|[
name|i
index|]
index|[
literal|0
index|]
operator|==
literal|'@'
condition|)
block|{
name|rotFileName
operator|=
name|argv
index|[
name|i
index|]
operator|+
literal|1
expr_stmt|;
name|t
operator|.
name|genCntMax
operator|=
literal|1
expr_stmt|;
comment|/* stop after one generation */
block|}
block|}
if|if
condition|(
name|chkInv
condition|)
name|InverseChecks
argument_list|()
expr_stmt|;
comment|/* check fwd vs. rev transforms (slow in debugger) */
name|t
operator|.
name|goodRotCntMask
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
name|goodRot
init|;
name|i
operator|<=
name|BITS_PER_WORD
operator|-
name|goodRot
condition|;
name|i
operator|++
control|)
name|t
operator|.
name|goodRotCntMask
operator||=
operator|(
operator|(
operator|(
name|u64b
operator|)
literal|1
operator|)
operator|<<
name|i
operator|)
expr_stmt|;
if|if
condition|(
name|do8
condition|)
name|t
operator|.
name|goodRotCntMask
operator|=
operator|(
operator|(
operator|(
name|u64b
operator|)
literal|0x03838383
operator|)
operator|<<
literal|32
operator|)
operator||
literal|0x83838380
expr_stmt|;
if|if
condition|(
name|bitsPerBlock
operator|==
literal|0
condition|)
block|{
name|printf
argument_list|(
literal|"Running search for all Skein block sizes (256, 512, and 1024)\n"
argument_list|)
expr_stmt|;
name|t
operator|.
name|rounds
operator|=
literal|0
expr_stmt|;
comment|/* use defaults, since otherwise it makes little sense */
name|t
operator|.
name|minHW_or
operator|=
literal|0
expr_stmt|;
block|}
name|bMin
operator|=
operator|(
name|bitsPerBlock
operator|)
condition|?
name|bitsPerBlock
else|:
literal|256
expr_stmt|;
name|bMax
operator|=
operator|(
name|bitsPerBlock
operator|)
condition|?
name|bitsPerBlock
else|:
literal|1024
expr_stmt|;
for|for
control|(
name|bitsPerBlock
operator|=
name|bMin
init|;
name|bitsPerBlock
operator|<=
name|bMax
condition|;
name|bitsPerBlock
operator|*=
literal|2
control|)
block|{
name|t
operator|.
name|seed0
operator|=
operator|(
name|seed
operator|)
condition|?
name|seed
else|:
operator|(
name|uint
operator|)
name|time
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
comment|/* randomize based on time if -s0 is given */
name|RunSearch
argument_list|(
name|t
argument_list|)
expr_stmt|;
block|}
return|return
literal|0
return|;
block|}
end_function

end_unit

