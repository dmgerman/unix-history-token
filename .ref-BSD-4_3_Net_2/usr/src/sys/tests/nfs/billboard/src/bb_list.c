begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  ******************************************************************************  *  * Module: bb_list.c  *  * Functions:   *	    bb_alist_1() - Return list of servers successfully tested against  *	    bb_blist_1() - Return list of servers unsuccessfully tested against  *	    bb_clist_1() - Return list of clients successfully tested against  *	    bb_dlist_1() - Return list of clients unsuccessfully tested against  *  *  ******************************************************************************  */
end_comment

begin_comment
comment|/*  ******************************************************************************  * Include Files  ******************************************************************************  */
end_comment

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<rpc/rpc.h>
end_include

begin_include
include|#
directive|include
file|"common.h"
end_include

begin_include
include|#
directive|include
file|"protocol.h"
end_include

begin_include
include|#
directive|include
file|"server.h"
end_include

begin_escape
end_escape

begin_comment
comment|/************************************************************************* **									** **  bb_alist_1() - Given the identifier get the list of servers this	** **  client has successfully tested against.				** **									** *************************************************************************/
end_comment

begin_function
name|BB_list_out
modifier|*
name|bb_alist_1
parameter_list|(
name|p_in
parameter_list|)
name|BB_list_in
modifier|*
name|p_in
decl_stmt|;
comment|/* The list input structure.		*/
block|{
specifier|static
name|BB_list_out
name|result
decl_stmt|;
comment|/* The result of the list operation.	*/
name|int
name|imp_cnt
decl_stmt|;
comment|/* The number of implementations.	*/
name|int
name|i
decl_stmt|;
comment|/* Nice loop variable name.		*/
name|int
name|j
decl_stmt|;
comment|/* The number of vendors found.		*/
name|BB_row
name|list
decl_stmt|;
comment|/* The list of tests in the database.	*/
name|BB_co_data
name|codata
decl_stmt|;
comment|/* The company data returned.		*/
name|BB_vendor
name|vendors
index|[
name|BB_MAX_IMP
index|]
decl_stmt|;
comment|/* Place to store output*/
name|result
operator|.
name|status
operator|=
name|BB_SUCCESS
expr_stmt|;
name|result
operator|.
name|data
operator|.
name|data_len
operator|=
literal|0
expr_stmt|;
comment|/*     **  If the machine being used to send this request is not one     **  of the ones owned by this client group then a password must     **  be specified.     */
if|if
condition|(
name|bb_check_ip
argument_list|(
name|p_in
operator|->
name|id
argument_list|)
operator|!=
name|BB_SUCCESS
condition|)
block|{
if|if
condition|(
operator|(
name|result
operator|.
name|status
operator|=
name|bb_check_passwd
argument_list|(
name|p_in
operator|->
name|id
argument_list|,
name|p_in
operator|->
name|passwd
argument_list|)
operator|)
operator|!=
name|BB_SUCCESS
condition|)
block|{
name|result
operator|.
name|status
operator|=
name|BB_BAD_PASSWD
expr_stmt|;
return|return
operator|&
name|result
return|;
block|}
block|}
comment|/*     **  Passed verification so get the data.     */
name|imp_cnt
operator|=
name|bb_get_imp_cnt
argument_list|()
expr_stmt|;
if|if
condition|(
name|bb_get_servers
argument_list|(
name|p_in
operator|->
name|id
argument_list|,
name|list
argument_list|)
operator|!=
name|BB_SUCCESS
condition|)
block|{
name|result
operator|.
name|status
operator|=
name|BB_FAILURE
expr_stmt|;
return|return
operator|&
name|result
return|;
block|}
comment|/*     **  For each implementation check to see if the tests have     **  been passed and if so get the company data for that index.     */
name|j
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|imp_cnt
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|list
index|[
name|i
index|]
operator|==
name|BB_BOARD_SET
condition|)
block|{
comment|/* 	    **  If can't get the company data just skip it. 	    */
if|if
condition|(
name|bb_get_codata
argument_list|(
name|i
argument_list|,
operator|&
name|codata
argument_list|)
operator|==
name|BB_SUCCESS
condition|)
block|{
name|vendors
index|[
name|j
index|]
operator|.
name|booth
operator|=
name|codata
operator|.
name|booth
expr_stmt|;
name|strncpy
argument_list|(
name|vendors
index|[
name|j
index|]
operator|.
name|company
argument_list|,
name|codata
operator|.
name|company
argument_list|,
name|BB_COMPANY_NAME_LEN
argument_list|)
expr_stmt|;
name|strncpy
argument_list|(
name|vendors
index|[
name|j
index|]
operator|.
name|imp
argument_list|,
name|codata
operator|.
name|imp
argument_list|,
name|BB_IMP_NAME_LEN
argument_list|)
expr_stmt|;
name|strncpy
argument_list|(
name|vendors
index|[
name|j
index|]
operator|.
name|id
argument_list|,
name|codata
operator|.
name|id
argument_list|,
name|BB_ID_NAME_LEN
argument_list|)
expr_stmt|;
name|j
operator|++
expr_stmt|;
block|}
block|}
block|}
name|result
operator|.
name|data
operator|.
name|data_len
operator|=
name|j
expr_stmt|;
name|result
operator|.
name|data
operator|.
name|data_val
operator|=
name|vendors
expr_stmt|;
return|return
operator|&
name|result
return|;
block|}
end_function

begin_escape
end_escape

begin_comment
comment|/************************************************************************* **									** **  bb_blist_1() - Given the identifier get the list of servers this	** **  client has not successfully tested against.				** **									** *************************************************************************/
end_comment

begin_function
name|BB_list_out
modifier|*
name|bb_blist_1
parameter_list|(
name|p_in
parameter_list|)
name|BB_list_in
modifier|*
name|p_in
decl_stmt|;
comment|/* The list input structure.		*/
block|{
specifier|static
name|BB_list_out
name|result
decl_stmt|;
comment|/* The result of the list operation.	*/
name|int
name|imp_cnt
decl_stmt|;
comment|/* The number of implementations.	*/
name|int
name|i
decl_stmt|;
comment|/* Nice loop variable name.		*/
name|int
name|j
decl_stmt|;
comment|/* The number of vendors found.		*/
name|BB_row
name|list
decl_stmt|;
comment|/* The list of tests in the database.	*/
name|BB_co_data
name|codata
decl_stmt|;
comment|/* The company data returned.		*/
name|BB_vendor
name|vendors
index|[
name|BB_MAX_IMP
index|]
decl_stmt|;
comment|/* Place to store output*/
name|result
operator|.
name|status
operator|=
name|BB_SUCCESS
expr_stmt|;
name|result
operator|.
name|data
operator|.
name|data_len
operator|=
literal|0
expr_stmt|;
comment|/*     **  If the machine being used to send this request is not one     **  of the ones owned by this client group then a password must     **  be specified.     */
if|if
condition|(
name|bb_check_ip
argument_list|(
name|p_in
operator|->
name|id
argument_list|)
operator|!=
name|BB_SUCCESS
condition|)
block|{
if|if
condition|(
operator|(
name|result
operator|.
name|status
operator|=
name|bb_check_passwd
argument_list|(
name|p_in
operator|->
name|id
argument_list|,
name|p_in
operator|->
name|passwd
argument_list|)
operator|)
operator|!=
name|BB_SUCCESS
condition|)
block|{
return|return
operator|&
name|result
return|;
block|}
block|}
comment|/*     **  Passed verification so get the data.     */
name|imp_cnt
operator|=
name|bb_get_imp_cnt
argument_list|()
expr_stmt|;
if|if
condition|(
name|bb_get_servers
argument_list|(
name|p_in
operator|->
name|id
argument_list|,
name|list
argument_list|)
operator|!=
name|BB_SUCCESS
condition|)
block|{
name|result
operator|.
name|status
operator|=
name|BB_FAILURE
expr_stmt|;
return|return
operator|&
name|result
return|;
block|}
comment|/*     **  For each implementation check to see if the tests have     **  been passed and if so get the company data for that index.     */
name|j
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|imp_cnt
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|list
index|[
name|i
index|]
operator|==
name|BB_BOARD_UNSET
condition|)
block|{
comment|/* 	    **  If can't get the company data just skip it. 	    */
if|if
condition|(
name|bb_get_codata
argument_list|(
name|i
argument_list|,
operator|&
name|codata
argument_list|)
operator|==
name|BB_SUCCESS
condition|)
block|{
name|vendors
index|[
name|j
index|]
operator|.
name|booth
operator|=
name|codata
operator|.
name|booth
expr_stmt|;
name|strncpy
argument_list|(
name|vendors
index|[
name|j
index|]
operator|.
name|company
argument_list|,
name|codata
operator|.
name|company
argument_list|,
name|BB_COMPANY_NAME_LEN
argument_list|)
expr_stmt|;
name|strncpy
argument_list|(
name|vendors
index|[
name|j
index|]
operator|.
name|imp
argument_list|,
name|codata
operator|.
name|imp
argument_list|,
name|BB_IMP_NAME_LEN
argument_list|)
expr_stmt|;
name|strncpy
argument_list|(
name|vendors
index|[
name|j
index|]
operator|.
name|id
argument_list|,
name|codata
operator|.
name|id
argument_list|,
name|BB_ID_NAME_LEN
argument_list|)
expr_stmt|;
name|j
operator|++
expr_stmt|;
block|}
block|}
block|}
name|result
operator|.
name|data
operator|.
name|data_len
operator|=
name|j
expr_stmt|;
name|result
operator|.
name|data
operator|.
name|data_val
operator|=
name|vendors
expr_stmt|;
return|return
operator|&
name|result
return|;
block|}
end_function

begin_escape
end_escape

begin_comment
comment|/************************************************************************* **									** **  bb_clist_1() - Given the identifier get the list of clients this	** **  server has successfully tested against.				** **									** *************************************************************************/
end_comment

begin_function
name|BB_list_out
modifier|*
name|bb_clist_1
parameter_list|(
name|p_in
parameter_list|)
name|BB_list_in
modifier|*
name|p_in
decl_stmt|;
comment|/* The list input structure.		*/
block|{
specifier|static
name|BB_list_out
name|result
decl_stmt|;
comment|/* The result of the list operation.	*/
name|int
name|imp_cnt
decl_stmt|;
comment|/* The number of implementations.	*/
name|int
name|i
decl_stmt|;
comment|/* Nice loop variable name.		*/
name|int
name|j
decl_stmt|;
comment|/* The number of vendors found.		*/
name|BB_row
name|list
decl_stmt|;
comment|/* The list of tests in the database.	*/
name|BB_co_data
name|codata
decl_stmt|;
comment|/* The company data returned.		*/
name|BB_vendor
name|vendors
index|[
name|BB_MAX_IMP
index|]
decl_stmt|;
comment|/* Place to store output*/
name|result
operator|.
name|status
operator|=
name|BB_SUCCESS
expr_stmt|;
name|result
operator|.
name|data
operator|.
name|data_len
operator|=
literal|0
expr_stmt|;
comment|/*     **  If the machine being used to send this request is not one     **  of the ones owned by this client group then a password must     **  be specified.     */
if|if
condition|(
name|bb_check_ip
argument_list|(
name|p_in
operator|->
name|id
argument_list|)
operator|!=
name|BB_SUCCESS
condition|)
block|{
if|if
condition|(
operator|(
name|result
operator|.
name|status
operator|=
name|bb_check_passwd
argument_list|(
name|p_in
operator|->
name|id
argument_list|,
name|p_in
operator|->
name|passwd
argument_list|)
operator|)
operator|!=
name|BB_SUCCESS
condition|)
block|{
return|return
operator|&
name|result
return|;
block|}
block|}
comment|/*     **  Passed verification so get the data.     */
name|imp_cnt
operator|=
name|bb_get_imp_cnt
argument_list|()
expr_stmt|;
if|if
condition|(
name|bb_get_clients
argument_list|(
name|p_in
operator|->
name|id
argument_list|,
name|list
argument_list|)
operator|!=
name|BB_SUCCESS
condition|)
block|{
name|result
operator|.
name|status
operator|=
name|BB_FAILURE
expr_stmt|;
return|return
operator|&
name|result
return|;
block|}
comment|/*     **  For each implementation check to see if the tests have     **  been passed and if so get the company data for that index.     */
name|j
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|imp_cnt
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|list
index|[
name|i
index|]
operator|==
name|BB_BOARD_SET
condition|)
block|{
comment|/* 	    **  If can't get the company data just skip it. 	    */
if|if
condition|(
name|bb_get_codata
argument_list|(
name|i
argument_list|,
operator|&
name|codata
argument_list|)
operator|==
name|BB_SUCCESS
condition|)
block|{
name|vendors
index|[
name|j
index|]
operator|.
name|booth
operator|=
name|codata
operator|.
name|booth
expr_stmt|;
name|strncpy
argument_list|(
name|vendors
index|[
name|j
index|]
operator|.
name|company
argument_list|,
name|codata
operator|.
name|company
argument_list|,
name|BB_COMPANY_NAME_LEN
argument_list|)
expr_stmt|;
name|strncpy
argument_list|(
name|vendors
index|[
name|j
index|]
operator|.
name|imp
argument_list|,
name|codata
operator|.
name|imp
argument_list|,
name|BB_IMP_NAME_LEN
argument_list|)
expr_stmt|;
name|strncpy
argument_list|(
name|vendors
index|[
name|j
index|]
operator|.
name|id
argument_list|,
name|codata
operator|.
name|id
argument_list|,
name|BB_ID_NAME_LEN
argument_list|)
expr_stmt|;
name|j
operator|++
expr_stmt|;
block|}
block|}
block|}
name|result
operator|.
name|data
operator|.
name|data_len
operator|=
name|j
expr_stmt|;
name|result
operator|.
name|data
operator|.
name|data_val
operator|=
name|vendors
expr_stmt|;
return|return
operator|&
name|result
return|;
block|}
end_function

begin_escape
end_escape

begin_comment
comment|/************************************************************************* **									** **  bb_dlist_1() - Given the identifier get the list of clients this	** **  server has not successfully tested against.				** **									** *************************************************************************/
end_comment

begin_function
name|BB_list_out
modifier|*
name|bb_dlist_1
parameter_list|(
name|p_in
parameter_list|)
name|BB_list_in
modifier|*
name|p_in
decl_stmt|;
comment|/* The list input structure.		*/
block|{
specifier|static
name|BB_list_out
name|result
decl_stmt|;
comment|/* The result of the list operation.	*/
name|int
name|imp_cnt
decl_stmt|;
comment|/* The number of implementations.	*/
name|int
name|i
decl_stmt|;
comment|/* Nice loop variable name.		*/
name|int
name|j
decl_stmt|;
comment|/* The number of vendors found.		*/
name|BB_row
name|list
decl_stmt|;
comment|/* The list of tests in the database.	*/
name|BB_co_data
name|codata
decl_stmt|;
comment|/* The company data returned.		*/
name|BB_vendor
name|vendors
index|[
name|BB_MAX_IMP
index|]
decl_stmt|;
comment|/* Place to store output*/
name|result
operator|.
name|status
operator|=
name|BB_SUCCESS
expr_stmt|;
name|result
operator|.
name|data
operator|.
name|data_len
operator|=
literal|0
expr_stmt|;
comment|/*     **  If the machine being used to send this request is not one     **  of the ones owned by this client group then a password must     **  be specified.     */
if|if
condition|(
name|bb_check_ip
argument_list|(
name|p_in
operator|->
name|id
argument_list|)
operator|!=
name|BB_SUCCESS
condition|)
block|{
if|if
condition|(
operator|(
name|result
operator|.
name|status
operator|=
name|bb_check_passwd
argument_list|(
name|p_in
operator|->
name|id
argument_list|,
name|p_in
operator|->
name|passwd
argument_list|)
operator|)
operator|!=
name|BB_SUCCESS
condition|)
block|{
return|return
operator|&
name|result
return|;
block|}
block|}
comment|/*     **  Passed verification so get the data.     */
name|imp_cnt
operator|=
name|bb_get_imp_cnt
argument_list|()
expr_stmt|;
if|if
condition|(
name|bb_get_clients
argument_list|(
name|p_in
operator|->
name|id
argument_list|,
name|list
argument_list|)
operator|!=
name|BB_SUCCESS
condition|)
block|{
name|result
operator|.
name|status
operator|=
name|BB_FAILURE
expr_stmt|;
return|return
operator|&
name|result
return|;
block|}
comment|/*     **  For each implementation check to see if the tests have     **  been passed and if so get the company data for that index.     */
name|j
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|imp_cnt
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|list
index|[
name|i
index|]
operator|==
name|BB_BOARD_UNSET
condition|)
block|{
comment|/* 	    **  If can't get the company data just skip it. 	    */
if|if
condition|(
name|bb_get_codata
argument_list|(
name|i
argument_list|,
operator|&
name|codata
argument_list|)
operator|==
name|BB_SUCCESS
condition|)
block|{
name|vendors
index|[
name|j
index|]
operator|.
name|booth
operator|=
name|codata
operator|.
name|booth
expr_stmt|;
name|strncpy
argument_list|(
name|vendors
index|[
name|j
index|]
operator|.
name|company
argument_list|,
name|codata
operator|.
name|company
argument_list|,
name|BB_COMPANY_NAME_LEN
argument_list|)
expr_stmt|;
name|strncpy
argument_list|(
name|vendors
index|[
name|j
index|]
operator|.
name|imp
argument_list|,
name|codata
operator|.
name|imp
argument_list|,
name|BB_IMP_NAME_LEN
argument_list|)
expr_stmt|;
name|strncpy
argument_list|(
name|vendors
index|[
name|j
index|]
operator|.
name|id
argument_list|,
name|codata
operator|.
name|id
argument_list|,
name|BB_ID_NAME_LEN
argument_list|)
expr_stmt|;
name|j
operator|++
expr_stmt|;
block|}
block|}
block|}
name|result
operator|.
name|data
operator|.
name|data_len
operator|=
name|j
expr_stmt|;
name|result
operator|.
name|data
operator|.
name|data_val
operator|=
name|vendors
expr_stmt|;
return|return
operator|&
name|result
return|;
block|}
end_function

end_unit

