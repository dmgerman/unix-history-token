begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* vprint.c - pepy printer support */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
modifier|*
name|rcsid
init|=
literal|"$Header: /f/osi/pepsy/RCS/vprint.c,v 7.4 91/02/22 09:50:15 mrose Interim $"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/*   * $Header: /f/osi/pepsy/RCS/vprint.c,v 7.4 91/02/22 09:50:15 mrose Interim $  *  *  * $Log:	vprint.c,v $  * Revision 7.4  91/02/22  09:50:15  mrose  * Interim 6.8  *   * Revision 7.3  90/12/23  18:42:12  mrose  * update  *   * Revision 7.2  90/11/11  09:59:04  mrose  * touch-up  *   * Revision 7.1  90/07/27  08:49:12  mrose  * update  *   * Revision 7.0  90/07/01  19:54:34  mrose  * *** empty log message ***  *   * Revision 7.0  89/11/23  22:12:08  mrose  * Release 6.0  *   */
end_comment

begin_comment
comment|/*  *				  NOTICE  *  *    Acquisition, use, and distribution of this module and related  *    materials are subject to the restrictions of a license agreement.  *    Consult the Preface in the User's Manual for the full terms of  *    this agreement.  *  */
end_comment

begin_comment
comment|/* LINTLIBRARY */
end_comment

begin_include
include|#
directive|include
file|<ctype.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<varargs.h>
end_include

begin_include
include|#
directive|include
file|"UNIV-types.h"
end_include

begin_include
include|#
directive|include
file|"psap.h"
end_include

begin_include
include|#
directive|include
file|"pepsy.h"
end_include

begin_include
include|#
directive|include
file|"logger.h"
end_include

begin_function_decl
name|int
name|fprintf
parameter_list|()
function_decl|;
end_function_decl

begin_comment
comment|/*
comment|DATA */
end_comment

begin_define
define|#
directive|define
name|VPRINT
parameter_list|(
name|s
parameter_list|)
value|vprint1 (), vwrite ((s)), vprint2 ()
end_define

begin_decl_stmt
specifier|static
name|int
name|vlevel
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|didname
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|didvpop
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|didvpush
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|docomma
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|py_classlist
index|[]
init|=
block|{
literal|"UNIVERSAL"
block|,
literal|"APPLICATION"
block|,
literal|""
block|,
literal|"PRIVATE"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|vbp
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|vsp
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|IFP
name|vfnx
init|=
name|fprintf
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|FILE
modifier|*
name|vfp
init|=
name|stdout
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|PS
name|vps
init|=
name|NULLPS
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|oct2str
argument_list|()
decl_stmt|,
modifier|*
name|newbuf
argument_list|()
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*
comment|VPUSH/VPOP */
end_comment

begin_macro
name|vpush
argument_list|()
end_macro

begin_block
block|{
if|if
condition|(
name|didvpush
condition|)
name|vwrite
argument_list|(
literal|"\n"
argument_list|)
operator|,
name|didvpush
operator|=
literal|0
expr_stmt|;
elseif|else
if|if
condition|(
operator|!
name|didname
operator|&&
name|docomma
condition|)
name|vwrite
argument_list|(
literal|",\n"
argument_list|)
expr_stmt|;
if|if
condition|(
name|didname
condition|)
name|vwrite
argument_list|(
literal|" "
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|vfp
operator|&&
name|vlevel
operator|>
literal|0
condition|)
call|(
modifier|*
name|vfnx
call|)
argument_list|(
name|vfp
argument_list|,
literal|"%*s"
argument_list|,
name|vlevel
operator|*
literal|3
argument_list|,
literal|""
argument_list|)
expr_stmt|;
name|vwrite
argument_list|(
literal|"{"
argument_list|)
expr_stmt|;
name|vlevel
operator|++
expr_stmt|;
name|didname
operator|=
name|didvpop
operator|=
name|docomma
operator|=
literal|0
operator|,
name|didvpush
operator|=
literal|1
expr_stmt|;
block|}
end_block

begin_macro
name|vpop
argument_list|()
end_macro

begin_block
block|{
if|if
condition|(
name|didname
operator|||
name|docomma
condition|)
name|vwrite
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|vlevel
operator|--
expr_stmt|;
if|if
condition|(
operator|!
name|didvpush
operator|&&
name|vfp
operator|&&
name|vlevel
operator|>
literal|0
condition|)
call|(
modifier|*
name|vfnx
call|)
argument_list|(
name|vfp
argument_list|,
literal|"%*s"
argument_list|,
name|vlevel
operator|*
literal|3
argument_list|,
literal|""
argument_list|)
expr_stmt|;
name|vwrite
argument_list|(
literal|"}"
argument_list|)
expr_stmt|;
if|if
condition|(
name|vlevel
operator|==
literal|0
condition|)
name|vwrite
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|didname
operator|=
name|didvpush
operator|=
literal|0
operator|,
name|didvpop
operator|=
name|docomma
operator|=
name|vlevel
condition|?
literal|1
else|:
literal|0
expr_stmt|;
block|}
end_block

begin_comment
comment|/*
comment|VNAME/VTAG */
end_comment

begin_macro
name|vname
argument_list|(
argument|name
argument_list|)
end_macro

begin_decl_stmt
name|char
modifier|*
name|name
decl_stmt|;
end_decl_stmt

begin_block
block|{
if|if
condition|(
name|didvpush
condition|)
name|vwrite
argument_list|(
literal|"\n"
argument_list|)
operator|,
name|didvpush
operator|=
literal|0
expr_stmt|;
elseif|else
if|if
condition|(
name|docomma
condition|)
name|vwrite
argument_list|(
literal|",\n"
argument_list|)
expr_stmt|;
if|if
condition|(
name|vfp
operator|&&
name|vlevel
operator|>
literal|0
condition|)
call|(
modifier|*
name|vfnx
call|)
argument_list|(
name|vfp
argument_list|,
literal|"%*s"
argument_list|,
name|vlevel
operator|*
literal|3
argument_list|,
literal|""
argument_list|)
expr_stmt|;
name|vwrite
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|didname
operator|=
literal|1
expr_stmt|;
block|}
end_block

begin_macro
name|vtag
argument_list|(
argument|class
argument_list|,
argument|id
argument_list|)
end_macro

begin_decl_stmt
name|int
name|class
decl_stmt|,
name|id
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|char
modifier|*
name|bp
decl_stmt|;
specifier|static
name|char
name|buffer
index|[
name|BUFSIZ
index|]
decl_stmt|;
if|if
condition|(
name|didname
condition|)
return|return;
name|bp
operator|=
name|buffer
expr_stmt|;
operator|*
name|bp
operator|++
operator|=
literal|'['
expr_stmt|;
switch|switch
condition|(
name|class
condition|)
block|{
case|case
name|PE_CLASS_UNIV
case|:
case|case
name|PE_CLASS_APPL
case|:
case|case
name|PE_CLASS_PRIV
case|:
operator|(
name|void
operator|)
name|sprintf
argument_list|(
name|bp
argument_list|,
literal|"%s "
argument_list|,
name|py_classlist
index|[
name|class
index|]
argument_list|)
expr_stmt|;
name|bp
operator|+=
name|strlen
argument_list|(
name|bp
argument_list|)
expr_stmt|;
break|break;
case|case
name|PE_CLASS_CONT
case|:
default|default:
break|break;
block|}
operator|(
name|void
operator|)
name|sprintf
argument_list|(
name|bp
argument_list|,
literal|"%d]"
argument_list|,
name|id
argument_list|)
expr_stmt|;
name|vname
argument_list|(
name|buffer
argument_list|)
expr_stmt|;
block|}
end_block

begin_comment
comment|/*
comment|VPRINT */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_macro
name|vprint
argument_list|(
argument|va_alist
argument_list|)
end_macro

begin_macro
name|va_dcl
end_macro

begin_block
block|{
name|char
name|buffer
index|[
name|BUFSIZ
index|]
decl_stmt|;
name|va_list
name|ap
decl_stmt|;
name|vprint1
argument_list|()
expr_stmt|;
name|va_start
argument_list|(
name|ap
argument_list|)
expr_stmt|;
name|_asprintf
argument_list|(
name|buffer
argument_list|,
name|NULLCP
argument_list|,
name|ap
argument_list|)
expr_stmt|;
name|va_end
argument_list|(
name|ap
argument_list|)
expr_stmt|;
name|vwrite
argument_list|(
name|buffer
argument_list|)
expr_stmt|;
name|vprint2
argument_list|()
expr_stmt|;
block|}
end_block

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* VARARGS */
end_comment

begin_macro
name|vprint
argument_list|(
argument|fmt
argument_list|)
end_macro

begin_decl_stmt
name|char
modifier|*
name|fmt
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|vprint
argument_list|(
name|fmt
argument_list|)
expr_stmt|;
block|}
end_block

begin_endif
endif|#
directive|endif
end_endif

begin_expr_stmt
specifier|static
name|vprint1
argument_list|()
block|{
if|if
condition|(
name|didvpush
condition|)
block|{
name|vwrite
argument_list|(
literal|"\n"
argument_list|)
operator|,
name|didvpush
operator|=
literal|0
expr_stmt|;
goto|goto
name|indent
goto|;
block|}
end_expr_stmt

begin_elseif
elseif|else
if|if
condition|(
name|didname
condition|)
name|vwrite
argument_list|(
literal|" "
argument_list|)
expr_stmt|;
end_elseif

begin_else
else|else
block|{
if|if
condition|(
name|docomma
condition|)
name|vwrite
argument_list|(
literal|",\n"
argument_list|)
expr_stmt|;
name|indent
label|:
empty_stmt|;
if|if
condition|(
name|vfp
operator|&&
name|vlevel
operator|>
literal|0
condition|)
call|(
modifier|*
name|vfnx
call|)
argument_list|(
name|vfp
argument_list|,
literal|"%*s"
argument_list|,
name|vlevel
operator|*
literal|3
argument_list|,
literal|""
argument_list|)
expr_stmt|;
block|}
end_else

begin_macro
unit|}   static
name|vprint2
argument_list|()
end_macro

begin_block
block|{
if|if
condition|(
name|vlevel
operator|==
literal|0
condition|)
name|vwrite
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|didname
operator|=
name|didvpop
operator|=
literal|0
operator|,
name|docomma
operator|=
name|vlevel
condition|?
literal|1
else|:
literal|0
expr_stmt|;
block|}
end_block

begin_comment
comment|/*
comment|*/
end_comment

begin_expr_stmt
specifier|static
name|vwrite
argument_list|(
argument|s
argument_list|)
name|char
operator|*
name|s
expr_stmt|;
end_expr_stmt

begin_block
block|{
if|if
condition|(
name|vfp
condition|)
call|(
modifier|*
name|vfnx
call|)
argument_list|(
name|vfp
argument_list|,
literal|"%s"
argument_list|,
name|s
argument_list|)
expr_stmt|;
else|else
block|{
specifier|register
name|char
name|c
decl_stmt|,
modifier|*
name|cp
decl_stmt|;
if|if
condition|(
name|vps
condition|)
for|for
control|(
name|cp
operator|=
name|s
init|;
operator|*
name|cp
condition|;
name|cp
operator|++
control|)
block|{
if|if
condition|(
operator|*
name|cp
operator|==
literal|'\n'
condition|)
operator|(
name|void
operator|)
name|ps_write
argument_list|(
name|vps
argument_list|,
operator|(
name|PElementData
operator|)
literal|" "
argument_list|,
literal|1
argument_list|)
expr_stmt|;
else|else
operator|(
name|void
operator|)
name|ps_write
argument_list|(
name|vps
argument_list|,
operator|(
name|PElementData
operator|)
name|cp
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
for|for
control|(
name|cp
operator|=
name|s
init|;
operator|*
name|cp
condition|;
control|)
operator|*
name|vbp
operator|++
operator|=
operator|(
name|c
operator|=
operator|*
name|cp
operator|++
operator|)
operator|!=
literal|'\n'
condition|?
name|c
else|:
literal|' '
expr_stmt|;
block|}
block|}
end_block

begin_comment
comment|/*
comment|VSTRING */
end_comment

begin_expr_stmt
name|vstring
argument_list|(
name|pe
argument_list|)
specifier|register
name|PE
name|pe
expr_stmt|;
end_expr_stmt

begin_block
block|{
specifier|register
name|PE
name|p
decl_stmt|;
switch|switch
condition|(
name|pe
operator|->
name|pe_form
condition|)
block|{
case|case
name|PE_FORM_PRIM
case|:
case|case
name|PE_FORM_ICONS
case|:
name|VPRINT
argument_list|(
name|oct2str
argument_list|(
operator|(
name|char
operator|*
operator|)
name|pe
operator|->
name|pe_prim
argument_list|,
operator|(
name|int
operator|)
name|pe
operator|->
name|pe_len
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|PE_FORM_CONS
case|:
name|vpush
argument_list|()
expr_stmt|;
for|for
control|(
name|p
operator|=
name|pe
operator|->
name|pe_cons
init|;
name|p
condition|;
name|p
operator|=
name|p
operator|->
name|pe_next
control|)
name|vstring
argument_list|(
name|p
argument_list|)
expr_stmt|;
name|vpop
argument_list|()
expr_stmt|;
break|break;
block|}
block|}
end_block

begin_comment
comment|/*
comment|*/
end_comment

begin_function
specifier|static
name|char
modifier|*
name|oct2str
parameter_list|(
name|s
parameter_list|,
name|len
parameter_list|)
specifier|register
name|char
modifier|*
name|s
decl_stmt|;
specifier|register
name|int
name|len
decl_stmt|;
block|{
name|int
name|ia5ok
decl_stmt|;
specifier|register
name|int
name|k
decl_stmt|;
specifier|register
name|char
modifier|*
name|bp
decl_stmt|,
modifier|*
name|cp
decl_stmt|,
modifier|*
name|dp
decl_stmt|,
modifier|*
name|zp
decl_stmt|;
name|ia5ok
operator|=
literal|1
operator|,
name|k
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|dp
operator|=
operator|(
name|cp
operator|=
name|s
operator|)
operator|+
name|len
init|;
name|cp
operator|<
name|dp
condition|;
name|cp
operator|++
control|)
block|{
switch|switch
condition|(
operator|*
name|cp
condition|)
block|{
case|case
literal|' '
case|:
continue|continue;
case|case
literal|'"'
case|:
break|break;
case|case
literal|'\b'
case|:
case|case
literal|'\f'
case|:
case|case
literal|'\n'
case|:
case|case
literal|'\r'
case|:
case|case
literal|'\t'
case|:
case|case
literal|'\\'
case|:
name|ia5ok
operator|=
operator|-
literal|1
operator|,
name|k
operator|++
expr_stmt|;
continue|continue;
case|case
literal|'-'
case|:
if|if
condition|(
name|cp
operator|>
name|s
operator|&&
operator|*
operator|(
name|cp
operator|+
literal|1
operator|)
operator|==
literal|'-'
condition|)
break|break;
continue|continue;
default|default:
if|if
condition|(
name|iscntrl
argument_list|(
operator|*
name|cp
argument_list|)
operator|||
name|isspace
argument_list|(
operator|*
name|cp
argument_list|)
operator|||
operator|(
operator|*
name|cp
operator|&
literal|0x80
operator|)
condition|)
break|break;
continue|continue;
block|}
name|ia5ok
operator|=
literal|0
expr_stmt|;
break|break;
block|}
switch|switch
condition|(
name|ia5ok
condition|)
block|{
case|case
literal|1
case|:
name|zp
operator|=
name|newbuf
argument_list|(
name|len
operator|+
literal|2
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|sprintf
argument_list|(
name|zp
argument_list|,
literal|"\"%*.*s\""
argument_list|,
name|len
argument_list|,
name|len
argument_list|,
name|s
argument_list|)
expr_stmt|;
break|break;
case|case
operator|-
literal|1
case|:
name|bp
operator|=
name|zp
operator|=
name|newbuf
argument_list|(
name|len
operator|+
name|k
operator|+
literal|2
argument_list|)
expr_stmt|;
operator|*
name|bp
operator|++
operator|=
literal|'"'
expr_stmt|;
for|for
control|(
name|cp
operator|=
name|s
init|;
name|cp
operator|<
name|dp
condition|;
name|cp
operator|++
control|)
if|if
condition|(
operator|*
name|cp
operator|>=
literal|' '
operator|&&
operator|*
name|cp
operator|!=
literal|'\\'
condition|)
operator|*
name|bp
operator|++
operator|=
operator|*
name|cp
expr_stmt|;
else|else
block|{
operator|*
name|bp
operator|++
operator|=
literal|'\\'
expr_stmt|;
switch|switch
condition|(
operator|*
name|cp
condition|)
block|{
case|case
literal|'\b'
case|:
operator|*
name|bp
operator|++
operator|=
literal|'b'
expr_stmt|;
break|break;
case|case
literal|'\f'
case|:
operator|*
name|bp
operator|++
operator|=
literal|'f'
expr_stmt|;
break|break;
case|case
literal|'\n'
case|:
operator|*
name|bp
operator|++
operator|=
literal|'n'
expr_stmt|;
break|break;
case|case
literal|'\r'
case|:
operator|*
name|bp
operator|++
operator|=
literal|'r'
expr_stmt|;
break|break;
case|case
literal|'\t'
case|:
operator|*
name|bp
operator|++
operator|=
literal|'t'
expr_stmt|;
break|break;
case|case
literal|'\\'
case|:
operator|*
name|bp
operator|++
operator|=
literal|'\\'
expr_stmt|;
break|break;
block|}
block|}
operator|(
name|void
operator|)
name|sprintf
argument_list|(
name|bp
argument_list|,
literal|"\""
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0
case|:
default|default:
name|bp
operator|=
name|zp
operator|=
name|newbuf
argument_list|(
name|len
operator|*
literal|2
operator|+
literal|3
argument_list|)
expr_stmt|;
operator|*
name|bp
operator|++
operator|=
literal|'\''
expr_stmt|;
for|for
control|(
name|cp
operator|=
name|s
init|;
name|cp
operator|<
name|dp
condition|;
name|cp
operator|++
control|)
block|{
operator|(
name|void
operator|)
name|sprintf
argument_list|(
name|bp
argument_list|,
literal|"%02x"
argument_list|,
operator|*
name|cp
operator|&
literal|0xff
argument_list|)
expr_stmt|;
name|bp
operator|+=
name|strlen
argument_list|(
name|bp
argument_list|)
expr_stmt|;
block|}
operator|(
name|void
operator|)
name|sprintf
argument_list|(
name|bp
argument_list|,
literal|"'H"
argument_list|)
expr_stmt|;
break|break;
block|}
return|return
name|zp
return|;
block|}
end_function

begin_comment
comment|/*
comment|*/
end_comment

begin_function
name|char
modifier|*
name|bit2str
parameter_list|(
name|pe
parameter_list|,
name|s
parameter_list|)
name|PE
name|pe
decl_stmt|;
name|char
modifier|*
name|s
decl_stmt|;
block|{
name|int
name|ia5ok
decl_stmt|;
specifier|register
name|int
name|hit
decl_stmt|,
name|i
decl_stmt|,
name|j
decl_stmt|,
name|k
decl_stmt|;
specifier|register
name|char
modifier|*
name|bp
decl_stmt|,
modifier|*
name|cp
decl_stmt|,
modifier|*
name|zp
decl_stmt|;
name|j
operator|=
name|pe
operator|->
name|pe_nbits
expr_stmt|;
if|if
condition|(
operator|(
name|cp
operator|=
name|s
operator|)
operator|&&
operator|*
operator|++
name|cp
condition|)
block|{
name|ia5ok
operator|=
literal|1
operator|,
name|hit
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|j
condition|;
control|)
if|if
condition|(
name|bit_test
argument_list|(
name|pe
argument_list|,
name|i
operator|++
argument_list|)
operator|==
literal|1
condition|)
block|{
do|do
block|{
if|if
condition|(
operator|!
operator|(
name|k
operator|=
operator|*
name|cp
operator|++
operator|&
literal|0xff
operator|)
condition|)
break|break;
if|if
condition|(
name|k
operator|==
name|i
condition|)
block|{
name|hit
operator|+=
name|hit
condition|?
literal|2
else|:
literal|1
expr_stmt|;
for|for
control|(
init|;
operator|*
name|cp
operator|>
literal|' '
condition|;
name|cp
operator|++
control|)
name|hit
operator|++
expr_stmt|;
block|}
else|else
for|for
control|(
init|;
operator|*
name|cp
operator|>
literal|' '
condition|;
name|cp
operator|++
control|)
continue|continue;
block|}
do|while
condition|(
name|k
operator|!=
literal|0
operator|&&
name|k
operator|<
name|i
condition|)
do|;
if|if
condition|(
name|k
operator|==
literal|0
operator|||
name|k
operator|>
name|i
condition|)
block|{
name|ia5ok
operator|=
literal|0
expr_stmt|;
break|break;
block|}
block|}
block|}
else|else
name|ia5ok
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|ia5ok
condition|)
block|{
name|bp
operator|=
name|zp
operator|=
name|newbuf
argument_list|(
name|hit
operator|+
literal|3
argument_list|)
expr_stmt|;
operator|*
name|bp
operator|++
operator|=
literal|'{'
expr_stmt|;
name|cp
operator|=
name|s
operator|,
name|cp
operator|++
expr_stmt|;
for|for
control|(
name|i
operator|=
name|hit
operator|=
literal|0
init|;
name|i
operator|<
name|j
condition|;
control|)
if|if
condition|(
name|bit_test
argument_list|(
name|pe
argument_list|,
name|i
operator|++
argument_list|)
operator|==
literal|1
condition|)
block|{
do|do
block|{
if|if
condition|(
operator|!
operator|(
name|k
operator|=
operator|*
name|cp
operator|++
operator|&
literal|0xff
operator|)
condition|)
break|break;
if|if
condition|(
name|k
operator|==
name|i
condition|)
block|{
if|if
condition|(
name|hit
condition|)
operator|*
name|bp
operator|++
operator|=
literal|','
expr_stmt|;
operator|*
name|bp
operator|++
operator|=
literal|' '
expr_stmt|;
for|for
control|(
init|;
operator|*
name|cp
operator|>
literal|' '
condition|;
name|cp
operator|++
control|)
operator|*
name|bp
operator|++
operator|=
operator|*
name|cp
expr_stmt|;
block|}
else|else
for|for
control|(
init|;
operator|*
name|cp
operator|>
literal|' '
condition|;
name|cp
operator|++
control|)
continue|continue;
block|}
do|while
condition|(
name|k
operator|!=
literal|0
operator|&&
name|k
operator|<
name|i
condition|)
do|;
if|if
condition|(
name|k
operator|==
literal|0
operator|||
name|k
operator|>
name|i
condition|)
break|break;
name|hit
operator|++
expr_stmt|;
block|}
operator|(
name|void
operator|)
name|sprintf
argument_list|(
name|bp
argument_list|,
literal|"%s}"
argument_list|,
name|hit
condition|?
literal|" "
else|:
literal|""
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|bp
operator|=
name|zp
operator|=
name|newbuf
argument_list|(
name|j
operator|+
literal|3
argument_list|)
expr_stmt|;
operator|*
name|bp
operator|++
operator|=
literal|'\''
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|j
condition|;
name|i
operator|++
control|)
operator|*
name|bp
operator|++
operator|=
name|bit_test
argument_list|(
name|pe
argument_list|,
name|i
argument_list|)
condition|?
literal|'1'
else|:
literal|'0'
expr_stmt|;
operator|(
name|void
operator|)
name|sprintf
argument_list|(
name|bp
argument_list|,
literal|"'B"
argument_list|)
expr_stmt|;
block|}
return|return
name|zp
return|;
block|}
end_function

begin_comment
comment|/*
comment|*/
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|vunknown
end_ifdef

begin_undef
undef|#
directive|undef
name|vunknown
end_undef

begin_endif
endif|#
directive|endif
end_endif

begin_expr_stmt
name|vunknown
argument_list|(
name|pe
argument_list|)
specifier|register
name|PE
name|pe
expr_stmt|;
end_expr_stmt

begin_block
block|{
name|int
name|i
decl_stmt|;
ifdef|#
directive|ifdef
name|notyet
comment|/* could comment this in, but then all programs need -lm */
name|double
name|j
decl_stmt|;
endif|#
directive|endif
name|OID
name|oid
decl_stmt|;
specifier|register
name|PE
name|p
decl_stmt|;
switch|switch
condition|(
name|pe
operator|->
name|pe_form
condition|)
block|{
case|case
name|PE_FORM_PRIM
case|:
switch|switch
condition|(
name|PE_ID
argument_list|(
name|pe
operator|->
name|pe_class
argument_list|,
name|pe
operator|->
name|pe_id
argument_list|)
condition|)
block|{
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_PRIM_BOOL
argument_list|)
case|:
if|if
condition|(
operator|(
name|i
operator|=
name|prim2flag
argument_list|(
name|pe
argument_list|)
operator|)
operator|==
name|NOTOK
condition|)
goto|goto
name|bad_pe
goto|;
name|VPRINT
argument_list|(
name|i
condition|?
literal|"TRUE"
else|:
literal|"FALSE"
argument_list|)
expr_stmt|;
break|break;
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_PRIM_INT
argument_list|)
case|:
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_PRIM_ENUM
argument_list|)
case|:
if|if
condition|(
operator|(
name|i
operator|=
name|prim2num
argument_list|(
name|pe
argument_list|)
operator|)
operator|==
name|NOTOK
operator|&&
name|pe
operator|->
name|pe_errno
operator|!=
name|PE_ERR_NONE
condition|)
goto|goto
name|bad_pe
goto|;
name|vprint
argument_list|(
literal|"%d"
argument_list|,
name|i
argument_list|)
expr_stmt|;
break|break;
ifdef|#
directive|ifdef
name|notyet
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_PRIM_REAL
argument_list|)
case|:
if|if
condition|(
operator|(
name|j
operator|=
name|prim2real
argument_list|(
name|pe
argument_list|)
operator|)
operator|==
name|NOTOK
operator|&&
name|pe
operator|->
name|pe_errno
operator|!=
name|PE_ERR_NONE
condition|)
goto|goto
name|bad_pe
goto|;
name|vprint
argument_list|(
literal|"%g"
argument_list|,
name|j
argument_list|)
expr_stmt|;
break|break;
endif|#
directive|endif
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_PRIM_BITS
argument_list|)
case|:
if|if
condition|(
operator|(
name|p
operator|=
name|prim2bit
argument_list|(
name|pe
argument_list|)
operator|)
operator|==
name|NULLPE
condition|)
goto|goto
name|bad_pe
goto|;
if|if
condition|(
name|p
operator|->
name|pe_nbits
operator|<
name|LOTSOFBITS
condition|)
block|{
name|VPRINT
argument_list|(
name|bit2str
argument_list|(
name|p
argument_list|,
literal|"\020"
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
comment|/* else fall... */
default|default:
name|bad_pe
label|:
empty_stmt|;
name|vtag
argument_list|(
operator|(
name|int
operator|)
name|pe
operator|->
name|pe_class
argument_list|,
operator|(
name|int
operator|)
name|pe
operator|->
name|pe_id
argument_list|)
expr_stmt|;
comment|/* fall */
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_PRIM_OCTS
argument_list|)
case|:
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_DEFN_IA5S
argument_list|)
case|:
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_DEFN_NUMS
argument_list|)
case|:
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_DEFN_PRTS
argument_list|)
case|:
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_DEFN_T61S
argument_list|)
case|:
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_DEFN_VTXS
argument_list|)
case|:
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_DEFN_GENT
argument_list|)
case|:
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_DEFN_UTCT
argument_list|)
case|:
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_DEFN_GFXS
argument_list|)
case|:
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_DEFN_VISS
argument_list|)
case|:
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_DEFN_GENS
argument_list|)
case|:
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_DEFN_CHRS
argument_list|)
case|:
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_PRIM_ODE
argument_list|)
case|:
name|vstring
argument_list|(
name|pe
argument_list|)
expr_stmt|;
break|break;
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_PRIM_NULL
argument_list|)
case|:
name|VPRINT
argument_list|(
literal|"NULL"
argument_list|)
expr_stmt|;
break|break;
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_PRIM_OID
argument_list|)
case|:
if|if
condition|(
operator|(
name|oid
operator|=
name|prim2oid
argument_list|(
name|pe
argument_list|)
operator|)
operator|==
name|NULLOID
condition|)
goto|goto
name|bad_pe
goto|;
name|VPRINT
argument_list|(
name|oid2ode
argument_list|(
name|oid
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
break|break;
case|case
name|PE_FORM_CONS
case|:
switch|switch
condition|(
name|PE_ID
argument_list|(
name|pe
operator|->
name|pe_class
argument_list|,
name|pe
operator|->
name|pe_id
argument_list|)
condition|)
block|{
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_CONS_SEQ
argument_list|)
case|:
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_CONS_SET
argument_list|)
case|:
break|break;
case|case
name|PE_ID
argument_list|(
name|PE_CLASS_UNIV
argument_list|,
name|PE_CONS_EXTN
argument_list|)
case|:
operator|(
name|void
operator|)
name|print_UNIV_EXTERNAL
argument_list|(
name|pe
argument_list|,
literal|1
argument_list|,
name|NULLIP
argument_list|,
name|NULLVP
argument_list|,
name|NULLCP
argument_list|)
expr_stmt|;
return|return;
default|default:
name|vtag
argument_list|(
operator|(
name|int
operator|)
name|pe
operator|->
name|pe_class
argument_list|,
operator|(
name|int
operator|)
name|pe
operator|->
name|pe_id
argument_list|)
expr_stmt|;
break|break;
block|}
name|vpush
argument_list|()
expr_stmt|;
for|for
control|(
name|p
operator|=
name|pe
operator|->
name|pe_cons
init|;
name|p
condition|;
name|p
operator|=
name|p
operator|->
name|pe_next
control|)
name|vunknown
argument_list|(
name|p
argument_list|)
expr_stmt|;
name|vpop
argument_list|()
expr_stmt|;
break|break;
case|case
name|PE_FORM_ICONS
case|:
name|vtag
argument_list|(
operator|(
name|int
operator|)
name|pe
operator|->
name|pe_class
argument_list|,
operator|(
name|int
operator|)
name|pe
operator|->
name|pe_id
argument_list|)
expr_stmt|;
name|vstring
argument_list|(
name|pe
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
end_block

begin_comment
comment|/*
comment|VPUSHFP/VPOPFP */
end_comment

begin_macro
name|vpushfp
argument_list|(
argument|fp
argument_list|,
argument|pe
argument_list|,
argument|s
argument_list|,
argument|rw
argument_list|)
end_macro

begin_decl_stmt
name|FILE
modifier|*
name|fp
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|PE
name|pe
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|s
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|rw
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|vpushpp
argument_list|(
operator|(
name|caddr_t
operator|)
name|fp
argument_list|,
name|fprintf
argument_list|,
name|pe
argument_list|,
name|s
argument_list|,
name|rw
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|vsetfp
argument_list|(
argument|fp
argument_list|,
argument|s
argument_list|)
end_macro

begin_decl_stmt
name|FILE
modifier|*
name|fp
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|s
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|vfp
operator|=
name|fp
expr_stmt|;
name|vfnx
operator|=
name|fprintf
expr_stmt|;
if|if
condition|(
name|s
operator|!=
name|NULLCP
condition|)
call|(
modifier|*
name|vfnx
call|)
argument_list|(
name|vfp
argument_list|,
literal|"%s\n"
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|vlevel
operator|=
name|didname
operator|=
name|didvpush
operator|=
name|didvpop
operator|=
name|docomma
operator|=
literal|0
expr_stmt|;
block|}
end_block

begin_macro
name|vpopfp
argument_list|()
end_macro

begin_block
block|{
call|(
modifier|*
name|vfnx
call|)
argument_list|(
name|vfp
argument_list|,
literal|"-------\n"
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|fflush
argument_list|(
name|vfp
argument_list|)
expr_stmt|;
name|vpopp
argument_list|()
expr_stmt|;
block|}
end_block

begin_comment
comment|/*
comment|VPUSHSTR/VPOPSTR */
end_comment

begin_macro
name|vpushstr
argument_list|(
argument|cp
argument_list|)
end_macro

begin_decl_stmt
name|char
modifier|*
name|cp
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|vfp
operator|=
name|NULL
expr_stmt|;
name|vbp
operator|=
name|vsp
operator|=
name|cp
expr_stmt|;
name|vlevel
operator|=
name|didname
operator|=
name|didvpush
operator|=
name|didvpop
operator|=
name|docomma
operator|=
literal|0
expr_stmt|;
block|}
end_block

begin_macro
name|vpopstr
argument_list|()
end_macro

begin_block
block|{
while|while
condition|(
operator|--
name|vbp
operator|>=
name|vsp
condition|)
if|if
condition|(
operator|*
name|vbp
operator|!=
literal|' '
condition|)
break|break;
operator|*
operator|++
name|vbp
operator|=
name|NULL
expr_stmt|;
name|vfp
operator|=
name|stdout
expr_stmt|;
block|}
end_block

begin_comment
comment|/*
comment|VPUSHPP */
end_comment

begin_macro
name|vpushpp
argument_list|(
argument|pv
argument_list|,
argument|pfnx
argument_list|,
argument|pe
argument_list|,
argument|text
argument_list|,
argument|rw
argument_list|)
end_macro

begin_decl_stmt
name|caddr_t
name|pv
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|IFP
name|pfnx
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|register
name|PE
name|pe
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|text
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|rw
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|vfp
operator|=
operator|(
name|FILE
operator|*
operator|)
name|pv
operator|,
name|vfnx
operator|=
name|pfnx
expr_stmt|;
call|(
modifier|*
name|vfnx
call|)
argument_list|(
name|vfp
argument_list|,
literal|"%s %s"
argument_list|,
name|rw
condition|?
literal|"read"
else|:
literal|"wrote"
argument_list|,
name|text
condition|?
name|text
else|:
literal|"pdu"
argument_list|)
expr_stmt|;
if|if
condition|(
name|pe
operator|->
name|pe_context
operator|!=
name|PE_DFLT_CTX
condition|)
call|(
modifier|*
name|vfnx
call|)
argument_list|(
name|vfp
argument_list|,
literal|", context %d"
argument_list|,
name|pe
operator|->
name|pe_context
argument_list|)
expr_stmt|;
call|(
modifier|*
name|vfnx
call|)
argument_list|(
name|vfp
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
name|vlevel
operator|=
name|didname
operator|=
name|didvpush
operator|=
name|didvpop
operator|=
name|docomma
operator|=
literal|0
expr_stmt|;
block|}
end_block

begin_macro
name|vpopp
argument_list|()
end_macro

begin_block
block|{
name|vfp
operator|=
name|stdout
operator|,
name|vfnx
operator|=
name|fprintf
expr_stmt|;
block|}
end_block

begin_macro
name|vpushquipu
argument_list|(
argument|ps
argument_list|)
end_macro

begin_decl_stmt
name|PS
name|ps
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|vps
operator|=
name|ps
expr_stmt|;
name|vfp
operator|=
name|NULL
expr_stmt|;
name|vlevel
operator|=
name|didname
operator|=
name|didvpush
operator|=
name|didvpop
operator|=
name|docomma
operator|=
literal|0
expr_stmt|;
block|}
end_block

begin_macro
name|vpopquipu
argument_list|()
end_macro

begin_block
block|{
name|vpopp
argument_list|()
expr_stmt|;
name|vps
operator|=
name|NULLPS
expr_stmt|;
block|}
end_block

begin_comment
comment|/*
comment|PVPDU - for pepsy */
end_comment

begin_undef
undef|#
directive|undef
name|pvpdu
end_undef

begin_expr_stmt
name|pvpdu
argument_list|(
name|lp
argument_list|,
name|ind
argument_list|,
name|mod
argument_list|,
name|pe
argument_list|,
name|text
argument_list|,
name|rw
argument_list|)
specifier|register
name|LLog
operator|*
name|lp
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|int
name|ind
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* index into tables */
end_comment

begin_decl_stmt
name|modtyp
modifier|*
name|mod
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* pointer to tables */
end_comment

begin_decl_stmt
specifier|register
name|PE
name|pe
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|text
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|rw
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|char
modifier|*
name|bp
decl_stmt|;
name|char
name|buffer
index|[
name|BUFSIZ
index|]
decl_stmt|;
name|vfp
operator|=
operator|(
name|FILE
operator|*
operator|)
name|lp
operator|,
name|vfnx
operator|=
name|ll_printf
expr_stmt|;
name|bp
operator|=
name|buffer
expr_stmt|;
operator|(
name|void
operator|)
name|sprintf
argument_list|(
name|bp
argument_list|,
literal|"%s %s"
argument_list|,
name|rw
condition|?
literal|"read"
else|:
literal|"wrote"
argument_list|,
name|text
condition|?
name|text
else|:
literal|"pdu"
argument_list|)
expr_stmt|;
name|bp
operator|+=
name|strlen
argument_list|(
name|bp
argument_list|)
expr_stmt|;
if|if
condition|(
name|pe
operator|->
name|pe_context
operator|!=
name|PE_DFLT_CTX
condition|)
block|{
operator|(
name|void
operator|)
name|sprintf
argument_list|(
name|bp
argument_list|,
literal|", context %d"
argument_list|,
name|pe
operator|->
name|pe_context
argument_list|)
expr_stmt|;
name|bp
operator|+=
name|strlen
argument_list|(
name|bp
argument_list|)
expr_stmt|;
block|}
name|LLOG
argument_list|(
name|lp
argument_list|,
name|LLOG_ALL
argument_list|,
operator|(
literal|"%s"
operator|,
name|buffer
operator|)
argument_list|)
expr_stmt|;
name|vlevel
operator|=
name|didname
operator|=
name|didvpush
operator|=
name|didvpop
operator|=
name|docomma
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|mod
operator|==
name|NULL
condition|)
operator|(
name|void
operator|)
name|vunknown
argument_list|(
name|pe
argument_list|)
expr_stmt|;
else|else
operator|(
name|void
operator|)
name|prnt_f
argument_list|(
name|ind
argument_list|,
name|mod
argument_list|,
name|pe
argument_list|,
literal|1
argument_list|,
name|NULLIP
argument_list|,
name|NULLVP
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|ll_printf
argument_list|(
name|lp
argument_list|,
literal|"-------\n"
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|ll_sync
argument_list|(
name|lp
argument_list|)
expr_stmt|;
name|vfp
operator|=
name|stdout
operator|,
name|vfnx
operator|=
name|fprintf
expr_stmt|;
block|}
end_block

begin_comment
comment|/*
comment|MISC */
end_comment

begin_decl_stmt
specifier|static
name|char
modifier|*
name|bp
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|char
modifier|*
name|newbuf
parameter_list|(
name|i
parameter_list|)
name|int
name|i
decl_stmt|;
block|{
specifier|static
name|unsigned
name|int
name|len
init|=
literal|0
decl_stmt|;
if|if
condition|(
name|i
operator|++
operator|<
name|len
condition|)
return|return
name|bp
return|;
if|if
condition|(
name|bp
condition|)
name|free
argument_list|(
name|bp
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|bp
operator|=
name|malloc
argument_list|(
operator|(
name|unsigned
name|int
operator|)
name|i
argument_list|)
operator|)
condition|)
name|len
operator|=
name|i
expr_stmt|;
else|else
name|len
operator|=
literal|0
expr_stmt|;
return|return
name|bp
return|;
block|}
end_function

begin_comment
comment|/*  VPDU - support for backwards compatibility */
end_comment

begin_expr_stmt
name|_vpdu
argument_list|(
name|lp
argument_list|,
name|fnx
argument_list|,
name|pe
argument_list|,
name|text
argument_list|,
name|rw
argument_list|)
specifier|register
name|LLog
operator|*
name|lp
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|IFP
name|fnx
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|register
name|PE
name|pe
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|text
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|rw
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|char
modifier|*
name|bp
decl_stmt|;
name|char
name|buffer
index|[
name|BUFSIZ
index|]
decl_stmt|;
name|vfp
operator|=
operator|(
name|FILE
operator|*
operator|)
name|lp
operator|,
name|vfnx
operator|=
name|ll_printf
expr_stmt|;
name|bp
operator|=
name|buffer
expr_stmt|;
operator|(
name|void
operator|)
name|sprintf
argument_list|(
name|bp
argument_list|,
literal|"%s %s"
argument_list|,
name|rw
condition|?
literal|"read"
else|:
literal|"wrote"
argument_list|,
name|text
condition|?
name|text
else|:
literal|"pdu"
argument_list|)
expr_stmt|;
name|bp
operator|+=
name|strlen
argument_list|(
name|bp
argument_list|)
expr_stmt|;
if|if
condition|(
name|pe
operator|->
name|pe_context
operator|!=
name|PE_DFLT_CTX
condition|)
block|{
operator|(
name|void
operator|)
name|sprintf
argument_list|(
name|bp
argument_list|,
literal|", context %d"
argument_list|,
name|pe
operator|->
name|pe_context
argument_list|)
expr_stmt|;
name|bp
operator|+=
name|strlen
argument_list|(
name|bp
argument_list|)
expr_stmt|;
block|}
name|LLOG
argument_list|(
name|lp
argument_list|,
name|LLOG_ALL
argument_list|,
operator|(
literal|"%s"
operator|,
name|buffer
operator|)
argument_list|)
expr_stmt|;
name|vlevel
operator|=
name|didname
operator|=
name|didvpush
operator|=
name|didvpop
operator|=
name|docomma
operator|=
literal|0
expr_stmt|;
call|(
name|void
call|)
argument_list|(
operator|*
name|fnx
argument_list|)
argument_list|(
name|pe
argument_list|,
literal|1
argument_list|,
name|NULLIP
argument_list|,
name|NULLVP
argument_list|,
name|NULLCP
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|ll_printf
argument_list|(
name|lp
argument_list|,
literal|"-------\n"
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|ll_sync
argument_list|(
name|lp
argument_list|)
expr_stmt|;
name|vfp
operator|=
name|stdout
operator|,
name|vfnx
operator|=
name|fprintf
expr_stmt|;
block|}
end_block

begin_ifdef
ifdef|#
directive|ifdef
name|PEP_TEST
end_ifdef

begin_macro
name|free_bp
argument_list|()
end_macro

begin_block
block|{
if|if
condition|(
name|bp
condition|)
name|free
argument_list|(
name|bp
argument_list|)
expr_stmt|;
block|}
end_block

begin_endif
endif|#
directive|endif
end_endif

end_unit

