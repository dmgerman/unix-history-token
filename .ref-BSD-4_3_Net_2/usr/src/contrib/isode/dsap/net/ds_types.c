begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* ds_types.c - Bind argument and operation argument type routines */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
modifier|*
name|rcsid
init|=
literal|"$Header: /f/osi/dsap/net/RCS/ds_types.c,v 7.2 91/02/22 09:21:11 mrose Interim $"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/*   * $Header: /f/osi/dsap/net/RCS/ds_types.c,v 7.2 91/02/22 09:21:11 mrose Interim $  *  *  * $Log:	ds_types.c,v $  * Revision 7.2  91/02/22  09:21:11  mrose  * Interim 6.8  *   * Revision 7.1  90/10/17  11:43:27  mrose  * sync  *   * Revision 7.0  90/07/26  14:45:33  mrose  * *** empty log message ***  *   */
end_comment

begin_comment
comment|/*  *                                NOTICE  *  *    Acquisition, use, and distribution of this module and related  *    materials are subject to the restrictions of a license agreement.  *    Consult the Preface in the User's Manual for the full terms of  *    this agreement.  *  */
end_comment

begin_comment
comment|/* LINTLIBRARY */
end_comment

begin_include
include|#
directive|include
file|"quipu/util.h"
end_include

begin_include
include|#
directive|include
file|"quipu/bind.h"
end_include

begin_include
include|#
directive|include
file|"quipu/common.h"
end_include

begin_include
include|#
directive|include
file|"quipu/dsargument.h"
end_include

begin_decl_stmt
specifier|extern
name|LLog
modifier|*
name|log_dsap
decl_stmt|;
end_decl_stmt

begin_macro
name|bind_arg_free
argument_list|(
argument|arg
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|ds_bind_arg
modifier|*
name|arg
decl_stmt|;
end_decl_stmt

begin_block
block|{
if|if
condition|(
name|arg
operator|->
name|dba_time1
operator|!=
name|NULLCP
condition|)
name|free
argument_list|(
name|arg
operator|->
name|dba_time1
argument_list|)
expr_stmt|;
if|if
condition|(
name|arg
operator|->
name|dba_time2
operator|!=
name|NULLCP
condition|)
name|free
argument_list|(
name|arg
operator|->
name|dba_time2
argument_list|)
expr_stmt|;
name|dn_free
argument_list|(
name|arg
operator|->
name|dba_dn
argument_list|)
expr_stmt|;
comment|/* free signature */
comment|/* free certificate_list */
block|}
end_block

begin_macro
name|op_arg_free
argument_list|(
argument|arg
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|ds_op_arg
modifier|*
name|arg
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|DLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_TRACE
argument_list|,
operator|(
literal|"op_arg_free()"
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|arg
operator|->
name|dca_dsarg
operator|.
name|arg_type
operator|==
operator|-
literal|1
condition|)
comment|/* Already freed - argument part anyway */
return|return;
name|DLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_TRACE
argument_list|,
operator|(
literal|"op_arg_free() - for real"
operator|)
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|arg
operator|->
name|dca_dsarg
operator|.
name|arg_type
condition|)
block|{
case|case
name|OP_ABANDON
case|:
name|ds_arg_free
argument_list|(
operator|&
operator|(
name|arg
operator|->
name|dca_dsarg
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_GETEDB
case|:
case|case
name|OP_READ
case|:
case|case
name|OP_COMPARE
case|:
case|case
name|OP_LIST
case|:
case|case
name|OP_SEARCH
case|:
case|case
name|OP_ADDENTRY
case|:
case|case
name|OP_REMOVEENTRY
case|:
case|case
name|OP_MODIFYENTRY
case|:
case|case
name|OP_MODIFYRDN
case|:
name|ch_arg_free
argument_list|(
operator|&
operator|(
name|arg
operator|->
name|dca_charg
operator|)
argument_list|)
expr_stmt|;
name|ds_arg_free
argument_list|(
operator|&
operator|(
name|arg
operator|->
name|dca_dsarg
operator|)
argument_list|)
expr_stmt|;
break|break;
default|default:
break|break;
block|}
block|}
end_block

begin_macro
name|ch_arg_free
argument_list|(
argument|arg
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|chain_arg
modifier|*
name|arg
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|DLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_TRACE
argument_list|,
operator|(
literal|"ch_arg_free()"
operator|)
argument_list|)
expr_stmt|;
name|dn_free
argument_list|(
name|arg
operator|->
name|cha_originator
argument_list|)
expr_stmt|;
name|dn_free
argument_list|(
name|arg
operator|->
name|cha_target
argument_list|)
expr_stmt|;
if|if
condition|(
name|arg
operator|->
name|cha_domaininfo
operator|!=
name|NULLPE
condition|)
name|pe_free
argument_list|(
name|arg
operator|->
name|cha_domaininfo
argument_list|)
expr_stmt|;
if|if
condition|(
name|arg
operator|->
name|cha_trace
operator|!=
name|NULLTRACEINFO
condition|)
name|trace_info_free
argument_list|(
name|arg
operator|->
name|cha_trace
argument_list|)
expr_stmt|;
if|if
condition|(
name|arg
operator|->
name|cha_timelimit
operator|!=
name|NULLCP
condition|)
name|free
argument_list|(
name|arg
operator|->
name|cha_timelimit
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|ds_arg_free
argument_list|(
argument|arg
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|DSArgument
modifier|*
name|arg
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|DLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_TRACE
argument_list|,
operator|(
literal|"ds_arg_free()"
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|arg
operator|->
name|arg_type
operator|==
operator|-
literal|1
condition|)
comment|/* Already freed */
return|return;
name|DLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_TRACE
argument_list|,
operator|(
literal|"ds_arg_free() for real"
operator|)
argument_list|)
expr_stmt|;
comment|/* free argument structure */
switch|switch
condition|(
name|arg
operator|->
name|arg_type
condition|)
block|{
case|case
name|OP_READ
case|:
name|read_arg_free
argument_list|(
operator|&
operator|(
name|arg
operator|->
name|arg_rd
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_COMPARE
case|:
name|compare_arg_free
argument_list|(
operator|&
operator|(
name|arg
operator|->
name|arg_cm
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_ABANDON
case|:
break|break;
case|case
name|OP_LIST
case|:
name|list_arg_free
argument_list|(
operator|&
operator|(
name|arg
operator|->
name|arg_ls
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_SEARCH
case|:
name|search_arg_free
argument_list|(
operator|&
operator|(
name|arg
operator|->
name|arg_sr
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_ADDENTRY
case|:
name|addentry_arg_free
argument_list|(
operator|&
operator|(
name|arg
operator|->
name|arg_ad
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_REMOVEENTRY
case|:
name|removeentry_arg_free
argument_list|(
operator|&
operator|(
name|arg
operator|->
name|arg_rm
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_MODIFYENTRY
case|:
name|modifyentry_arg_free
argument_list|(
operator|&
operator|(
name|arg
operator|->
name|arg_me
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_MODIFYRDN
case|:
name|modifyrdn_arg_free
argument_list|(
operator|&
operator|(
name|arg
operator|->
name|arg_mr
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_GETEDB
case|:
name|getedb_arg_free
argument_list|(
operator|&
operator|(
name|arg
operator|->
name|arg_ge
operator|)
argument_list|)
expr_stmt|;
break|break;
default|default:
break|break;
block|}
comment|/* indicate as freed */
name|arg
operator|->
name|arg_type
operator|=
operator|-
literal|1
expr_stmt|;
block|}
end_block

begin_macro
name|read_arg_free
argument_list|(
argument|arg
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|ds_read_arg
modifier|*
name|arg
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|ca_free
argument_list|(
operator|&
name|arg
operator|->
name|rda_common
argument_list|)
expr_stmt|;
name|dn_free
argument_list|(
name|arg
operator|->
name|rda_object
argument_list|)
expr_stmt|;
name|as_free
argument_list|(
name|arg
operator|->
name|rda_eis
operator|.
name|eis_select
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|compare_arg_free
argument_list|(
argument|arg
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|ds_compare_arg
modifier|*
name|arg
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|ca_free
argument_list|(
operator|&
name|arg
operator|->
name|cma_common
argument_list|)
expr_stmt|;
name|dn_free
argument_list|(
name|arg
operator|->
name|cma_object
argument_list|)
expr_stmt|;
name|AttrT_free
argument_list|(
name|arg
operator|->
name|cma_purported
operator|.
name|ava_type
argument_list|)
expr_stmt|;
name|AttrV_free
argument_list|(
name|arg
operator|->
name|cma_purported
operator|.
name|ava_value
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|list_arg_free
argument_list|(
argument|arg
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|ds_list_arg
modifier|*
name|arg
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|ca_free
argument_list|(
operator|&
name|arg
operator|->
name|lsa_common
argument_list|)
expr_stmt|;
name|dn_free
argument_list|(
name|arg
operator|->
name|lsa_object
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|search_arg_free
argument_list|(
argument|arg
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|ds_search_arg
modifier|*
name|arg
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|ca_free
argument_list|(
operator|&
name|arg
operator|->
name|sra_common
argument_list|)
expr_stmt|;
name|dn_free
argument_list|(
name|arg
operator|->
name|sra_baseobject
argument_list|)
expr_stmt|;
name|as_free
argument_list|(
name|arg
operator|->
name|sra_eis
operator|.
name|eis_select
argument_list|)
expr_stmt|;
name|filter_free
argument_list|(
name|arg
operator|->
name|sra_filter
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|addentry_arg_free
argument_list|(
argument|arg
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|ds_addentry_arg
modifier|*
name|arg
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|ca_free
argument_list|(
operator|&
name|arg
operator|->
name|ada_common
argument_list|)
expr_stmt|;
name|dn_free
argument_list|(
name|arg
operator|->
name|ada_object
argument_list|)
expr_stmt|;
name|as_free
argument_list|(
name|arg
operator|->
name|ada_entry
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|removeentry_arg_free
argument_list|(
argument|arg
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|ds_removeentry_arg
modifier|*
name|arg
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|ca_free
argument_list|(
operator|&
name|arg
operator|->
name|rma_common
argument_list|)
expr_stmt|;
name|dn_free
argument_list|(
name|arg
operator|->
name|rma_object
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|modifyentry_arg_free
argument_list|(
argument|arg
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|ds_modifyentry_arg
modifier|*
name|arg
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|ca_free
argument_list|(
operator|&
name|arg
operator|->
name|mea_common
argument_list|)
expr_stmt|;
name|dn_free
argument_list|(
name|arg
operator|->
name|mea_object
argument_list|)
expr_stmt|;
name|ems_free
argument_list|(
name|arg
operator|->
name|mea_changes
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|modifyrdn_arg_free
argument_list|(
argument|arg
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|ds_modifyrdn_arg
modifier|*
name|arg
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|ca_free
argument_list|(
operator|&
name|arg
operator|->
name|mra_common
argument_list|)
expr_stmt|;
name|dn_free
argument_list|(
name|arg
operator|->
name|mra_object
argument_list|)
expr_stmt|;
name|rdn_free
argument_list|(
name|arg
operator|->
name|mra_newrdn
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|getedb_arg_free
argument_list|(
argument|arg
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|getedb_arg
modifier|*
name|arg
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|dn_free
argument_list|(
name|arg
operator|->
name|ga_entry
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|char
operator|*
operator|)
name|arg
operator|->
name|ga_version
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|op_res_free
argument_list|(
argument|res
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|ds_op_res
modifier|*
name|res
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|DLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_TRACE
argument_list|,
operator|(
literal|"op_res_free()"
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|res
operator|->
name|dcr_dsres
operator|.
name|result_type
operator|==
operator|-
literal|1
condition|)
comment|/* Already freed - result part anyway */
return|return;
name|DLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_TRACE
argument_list|,
operator|(
literal|"op_res_free() - for real"
operator|)
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|res
operator|->
name|dcr_dsres
operator|.
name|result_type
condition|)
block|{
case|case
name|OP_ABANDON
case|:
case|case
name|OP_GETEDB
case|:
name|ds_res_free
argument_list|(
operator|&
operator|(
name|res
operator|->
name|dcr_dsres
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_READ
case|:
case|case
name|OP_COMPARE
case|:
case|case
name|OP_LIST
case|:
case|case
name|OP_SEARCH
case|:
case|case
name|OP_ADDENTRY
case|:
case|case
name|OP_REMOVEENTRY
case|:
case|case
name|OP_MODIFYENTRY
case|:
case|case
name|OP_MODIFYRDN
case|:
name|ch_res_free
argument_list|(
operator|&
operator|(
name|res
operator|->
name|dcr_chres
operator|)
argument_list|)
expr_stmt|;
name|ds_res_free
argument_list|(
operator|&
operator|(
name|res
operator|->
name|dcr_dsres
operator|)
argument_list|)
expr_stmt|;
break|break;
default|default:
break|break;
block|}
block|}
end_block

begin_macro
name|ch_res_free
argument_list|(
argument|res
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|chain_res
modifier|*
name|res
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|DLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_TRACE
argument_list|,
operator|(
literal|"ch_res_free()"
operator|)
argument_list|)
expr_stmt|;
comment|/* free chain bits */
if|if
condition|(
name|res
operator|->
name|chr_domaininfo
operator|!=
name|NULLPE
condition|)
name|pe_free
argument_list|(
name|res
operator|->
name|chr_domaininfo
argument_list|)
expr_stmt|;
name|cross_refs_free
argument_list|(
name|res
operator|->
name|chr_crossrefs
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|ds_res_free
argument_list|(
argument|res
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|DSResult
modifier|*
name|res
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|DLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_TRACE
argument_list|,
operator|(
literal|"ds_res_free()"
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|res
operator|->
name|result_type
operator|==
operator|-
literal|1
condition|)
comment|/* Already freed */
return|return;
name|DLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_TRACE
argument_list|,
operator|(
literal|"ds_res_free() - for real"
operator|)
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|res
operator|->
name|result_type
condition|)
block|{
case|case
name|OP_READ
case|:
comment|/* 		dn_free (&res->res_rd.rdr_common.cr_requestor); */
name|entryinfo_comp_free
argument_list|(
operator|&
name|res
operator|->
name|res_rd
operator|.
name|rdr_entry
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_COMPARE
case|:
comment|/* 		dn_free (&res->res_cm.cmr_common.cr_requestor); */
name|dn_free
argument_list|(
name|res
operator|->
name|res_cm
operator|.
name|cmr_object
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_LIST
case|:
comment|/* 		dn_free (&res->res_ls.lsr_common.cr_requestor); */
name|dn_free
argument_list|(
name|res
operator|->
name|res_ls
operator|.
name|lsr_object
argument_list|)
expr_stmt|;
name|subords_free
argument_list|(
name|res
operator|->
name|res_ls
operator|.
name|lsr_subordinates
argument_list|)
expr_stmt|;
name|crefs_free
argument_list|(
name|res
operator|->
name|res_ls
operator|.
name|lsr_cr
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_SEARCH
case|:
name|search_result_free
argument_list|(
operator|&
operator|(
name|res
operator|->
name|res_sr
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_GETEDB
case|:
break|break;
comment|/* don't free EDB */
default|default:
break|break;
block|}
name|res
operator|->
name|result_type
operator|=
operator|-
literal|1
expr_stmt|;
block|}
end_block

begin_macro
name|trace_info_free
argument_list|(
argument|ti
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|trace_info
modifier|*
name|ti
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|DLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_TRACE
argument_list|,
operator|(
literal|"trace_info_free()"
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|ti
operator|==
name|NULLTRACEINFO
condition|)
return|return;
name|dn_free
argument_list|(
name|ti
operator|->
name|ti_target
argument_list|)
expr_stmt|;
name|dn_free
argument_list|(
name|ti
operator|->
name|ti_dsa
argument_list|)
expr_stmt|;
name|trace_info_free
argument_list|(
name|ti
operator|->
name|ti_next
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|char
operator|*
operator|)
name|ti
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|ca_free
argument_list|(
argument|ca
argument_list|)
end_macro

begin_decl_stmt
name|CommonArgs
modifier|*
name|ca
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|DLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_TRACE
argument_list|,
operator|(
literal|"ca_free()"
operator|)
argument_list|)
expr_stmt|;
name|dn_free
argument_list|(
name|ca
operator|->
name|ca_requestor
argument_list|)
expr_stmt|;
name|extension_free
argument_list|(
name|ca
operator|->
name|ca_extensions
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|extension_free
argument_list|(
argument|ext
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|extension
modifier|*
name|ext
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|DLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_TRACE
argument_list|,
operator|(
literal|"extension_free()"
operator|)
argument_list|)
expr_stmt|;
for|for
control|(
init|;
name|ext
operator|!=
name|NULLEXT
condition|;
name|ext
operator|=
name|ext
operator|->
name|ext_next
control|)
block|{
if|if
condition|(
name|ext
operator|->
name|ext_item
operator|!=
name|NULLPE
condition|)
name|pe_free
argument_list|(
name|ext
operator|->
name|ext_item
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|char
operator|*
operator|)
name|ext
argument_list|)
expr_stmt|;
block|}
block|}
end_block

begin_macro
name|cross_refs_free
argument_list|(
argument|xref
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|cross_ref
modifier|*
name|xref
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|DLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_TRACE
argument_list|,
operator|(
literal|"cross_refs_free()"
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|xref
operator|==
name|NULLXREF
condition|)
return|return;
name|dn_free
argument_list|(
name|xref
operator|->
name|xref_dn
argument_list|)
expr_stmt|;
name|aps_free
argument_list|(
name|xref
operator|->
name|xref_ap
argument_list|)
expr_stmt|;
name|cross_refs_free
argument_list|(
name|xref
operator|->
name|xref_next
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|char
operator|*
operator|)
name|xref
argument_list|)
expr_stmt|;
block|}
end_block

begin_comment
comment|/* Copy routines */
end_comment

begin_function
name|int
name|ds_arg_dup
parameter_list|(
name|src
parameter_list|,
name|tgt
parameter_list|)
name|struct
name|DSArgument
modifier|*
name|src
decl_stmt|;
name|struct
name|DSArgument
modifier|*
name|tgt
decl_stmt|;
block|{
name|DLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_TRACE
argument_list|,
operator|(
literal|"ds_arg_dup()"
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|src
operator|->
name|arg_type
operator|==
operator|-
literal|1
condition|)
block|{
comment|/* Has been freed */
name|LLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_DEBUG
argument_list|,
operator|(
literal|"ds_arg_dup(): src already freed"
operator|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|NOTOK
operator|)
return|;
block|}
switch|switch
condition|(
name|tgt
operator|->
name|arg_type
operator|=
name|src
operator|->
name|arg_type
condition|)
block|{
case|case
name|OP_READ
case|:
return|return
operator|(
name|read_arg_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|arg_rd
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|arg_rd
operator|)
argument_list|)
operator|)
return|;
case|case
name|OP_COMPARE
case|:
return|return
operator|(
name|compare_arg_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|arg_cm
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|arg_cm
operator|)
argument_list|)
operator|)
return|;
case|case
name|OP_ABANDON
case|:
return|return
operator|(
name|abandon_arg_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|arg_ab
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|arg_ab
operator|)
argument_list|)
operator|)
return|;
case|case
name|OP_LIST
case|:
return|return
operator|(
name|list_arg_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|arg_ls
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|arg_ls
operator|)
argument_list|)
operator|)
return|;
case|case
name|OP_SEARCH
case|:
return|return
operator|(
name|search_arg_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|arg_sr
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|arg_sr
operator|)
argument_list|)
operator|)
return|;
case|case
name|OP_ADDENTRY
case|:
return|return
operator|(
name|addentry_arg_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|arg_ad
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|arg_ad
operator|)
argument_list|)
operator|)
return|;
case|case
name|OP_REMOVEENTRY
case|:
return|return
operator|(
name|removeentry_arg_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|arg_rm
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|arg_rm
operator|)
argument_list|)
operator|)
return|;
case|case
name|OP_MODIFYENTRY
case|:
return|return
operator|(
name|modifyentry_arg_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|arg_me
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|arg_me
operator|)
argument_list|)
operator|)
return|;
case|case
name|OP_MODIFYRDN
case|:
return|return
operator|(
name|modifyrdn_arg_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|arg_mr
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|arg_mr
operator|)
argument_list|)
operator|)
return|;
case|case
name|OP_GETEDB
case|:
return|return
operator|(
name|getedb_arg_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|arg_ge
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|arg_ge
operator|)
argument_list|)
operator|)
return|;
default|default:
name|LLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_DEBUG
argument_list|,
operator|(
literal|"ds_arg_dup(): unknown arg type %d"
operator|,
name|src
operator|->
name|arg_type
operator|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|NOTOK
operator|)
return|;
block|}
block|}
end_function

begin_function
name|int
name|read_arg_dup
parameter_list|(
name|src
parameter_list|,
name|tgt
parameter_list|)
name|struct
name|ds_read_arg
modifier|*
name|src
decl_stmt|;
name|struct
name|ds_read_arg
modifier|*
name|tgt
decl_stmt|;
block|{
if|if
condition|(
name|ca_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|rda_common
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|rda_common
operator|)
argument_list|)
operator|!=
name|OK
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|src
operator|->
name|rda_object
operator|==
name|NULLDN
condition|)
name|tgt
operator|->
name|rda_object
operator|=
name|NULLDN
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|rda_object
operator|=
name|dn_cpy
argument_list|(
name|src
operator|->
name|rda_object
argument_list|)
operator|)
operator|==
name|NULLDN
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|eis_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|rda_eis
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|rda_eis
operator|)
argument_list|)
operator|!=
name|OK
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
return|return
operator|(
name|OK
operator|)
return|;
block|}
end_function

begin_function
name|int
name|compare_arg_dup
parameter_list|(
name|src
parameter_list|,
name|tgt
parameter_list|)
name|struct
name|ds_compare_arg
modifier|*
name|src
decl_stmt|;
name|struct
name|ds_compare_arg
modifier|*
name|tgt
decl_stmt|;
block|{
if|if
condition|(
name|ca_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|cma_common
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|cma_common
operator|)
argument_list|)
operator|!=
name|OK
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|src
operator|->
name|cma_object
operator|==
name|NULLDN
condition|)
name|tgt
operator|->
name|cma_object
operator|=
name|NULLDN
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|cma_object
operator|=
name|dn_cpy
argument_list|(
name|src
operator|->
name|cma_object
argument_list|)
operator|)
operator|==
name|NULLDN
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|ava_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|cma_purported
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|cma_purported
operator|)
argument_list|)
operator|!=
name|OK
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
return|return
operator|(
name|OK
operator|)
return|;
block|}
end_function

begin_function
name|int
name|abandon_arg_dup
parameter_list|(
name|src
parameter_list|,
name|tgt
parameter_list|)
name|struct
name|ds_abandon_arg
modifier|*
name|src
decl_stmt|;
name|struct
name|ds_abandon_arg
modifier|*
name|tgt
decl_stmt|;
block|{
name|tgt
operator|->
name|aba_invokeid
operator|=
name|src
operator|->
name|aba_invokeid
expr_stmt|;
return|return
operator|(
name|OK
operator|)
return|;
block|}
end_function

begin_function
name|int
name|list_arg_dup
parameter_list|(
name|src
parameter_list|,
name|tgt
parameter_list|)
name|struct
name|ds_list_arg
modifier|*
name|src
decl_stmt|;
name|struct
name|ds_list_arg
modifier|*
name|tgt
decl_stmt|;
block|{
if|if
condition|(
name|ca_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|lsa_common
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|lsa_common
operator|)
argument_list|)
operator|!=
name|OK
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|src
operator|->
name|lsa_object
operator|==
name|NULLDN
condition|)
name|tgt
operator|->
name|lsa_object
operator|=
name|NULLDN
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|lsa_object
operator|=
name|dn_cpy
argument_list|(
name|src
operator|->
name|lsa_object
argument_list|)
operator|)
operator|==
name|NULLDN
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
return|return
name|OK
return|;
block|}
end_function

begin_function
name|int
name|search_arg_dup
parameter_list|(
name|src
parameter_list|,
name|tgt
parameter_list|)
name|struct
name|ds_search_arg
modifier|*
name|src
decl_stmt|;
name|struct
name|ds_search_arg
modifier|*
name|tgt
decl_stmt|;
block|{
name|struct
name|filter
modifier|*
name|filter_cpy
parameter_list|()
function_decl|;
if|if
condition|(
name|ca_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|sra_common
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|sra_common
operator|)
argument_list|)
operator|!=
name|OK
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|src
operator|->
name|sra_baseobject
operator|=
name|NULLDN
condition|)
name|tgt
operator|->
name|sra_baseobject
operator|=
name|NULLDN
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|sra_baseobject
operator|=
name|dn_cpy
argument_list|(
name|src
operator|->
name|sra_baseobject
argument_list|)
operator|)
operator|==
name|NULLDN
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
name|tgt
operator|->
name|sra_subset
operator|=
name|src
operator|->
name|sra_subset
expr_stmt|;
if|if
condition|(
name|src
operator|->
name|sra_filter
operator|==
name|NULLFILTER
condition|)
name|tgt
operator|->
name|sra_filter
operator|=
name|NULLFILTER
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|sra_filter
operator|=
name|filter_cpy
argument_list|(
name|src
operator|->
name|sra_filter
argument_list|)
operator|)
operator|==
name|NULLFILTER
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
name|tgt
operator|->
name|sra_searchaliases
operator|=
name|src
operator|->
name|sra_searchaliases
expr_stmt|;
if|if
condition|(
name|eis_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|sra_eis
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|sra_eis
operator|)
argument_list|)
operator|!=
name|OK
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
return|return
operator|(
name|OK
operator|)
return|;
block|}
end_function

begin_function
name|int
name|addentry_arg_dup
parameter_list|(
name|src
parameter_list|,
name|tgt
parameter_list|)
name|struct
name|ds_addentry_arg
modifier|*
name|src
decl_stmt|;
name|struct
name|ds_addentry_arg
modifier|*
name|tgt
decl_stmt|;
block|{
if|if
condition|(
name|ca_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|ada_common
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|ada_common
operator|)
argument_list|)
operator|!=
name|OK
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|src
operator|->
name|ada_object
operator|==
name|NULLDN
condition|)
name|tgt
operator|->
name|ada_object
operator|=
name|NULLDN
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|ada_object
operator|=
name|dn_cpy
argument_list|(
name|src
operator|->
name|ada_object
argument_list|)
operator|)
operator|==
name|NULLDN
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|src
operator|->
name|ada_entry
operator|=
name|NULLATTR
condition|)
name|tgt
operator|->
name|ada_entry
operator|=
name|NULLATTR
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|ada_entry
operator|=
name|as_cpy
argument_list|(
name|src
operator|->
name|ada_entry
argument_list|)
operator|)
operator|==
name|NULLATTR
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
return|return
operator|(
name|OK
operator|)
return|;
block|}
end_function

begin_function
name|int
name|removeentry_arg_dup
parameter_list|(
name|src
parameter_list|,
name|tgt
parameter_list|)
name|struct
name|ds_removeentry_arg
modifier|*
name|src
decl_stmt|;
name|struct
name|ds_removeentry_arg
modifier|*
name|tgt
decl_stmt|;
block|{
if|if
condition|(
name|ca_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|rma_common
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|rma_common
operator|)
argument_list|)
operator|!=
name|OK
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|src
operator|->
name|rma_object
operator|==
name|NULLDN
condition|)
name|tgt
operator|->
name|rma_object
operator|=
name|NULLDN
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|rma_object
operator|=
name|dn_cpy
argument_list|(
name|src
operator|->
name|rma_object
argument_list|)
operator|)
operator|==
name|NULLDN
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
return|return
operator|(
name|OK
operator|)
return|;
block|}
end_function

begin_function
name|int
name|modifyentry_arg_dup
parameter_list|(
name|src
parameter_list|,
name|tgt
parameter_list|)
name|struct
name|ds_modifyentry_arg
modifier|*
name|src
decl_stmt|;
name|struct
name|ds_modifyentry_arg
modifier|*
name|tgt
decl_stmt|;
block|{
name|struct
name|entrymod
modifier|*
name|ems_cpy
parameter_list|()
function_decl|;
if|if
condition|(
name|ca_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|mea_common
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|mea_common
operator|)
argument_list|)
operator|!=
name|OK
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|src
operator|->
name|mea_object
operator|==
name|NULLDN
condition|)
name|tgt
operator|->
name|mea_object
operator|=
name|NULLDN
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|mea_object
operator|=
name|dn_cpy
argument_list|(
name|src
operator|->
name|mea_object
argument_list|)
operator|)
operator|==
name|NULLDN
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|src
operator|->
name|mea_changes
operator|==
operator|(
expr|struct
name|entrymod
operator|*
operator|)
name|NULL
condition|)
name|tgt
operator|->
name|mea_changes
operator|=
operator|(
expr|struct
name|entrymod
operator|*
operator|)
name|NULL
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|mea_changes
operator|=
name|ems_cpy
argument_list|(
name|src
operator|->
name|mea_changes
argument_list|)
operator|)
operator|==
operator|(
expr|struct
name|entrymod
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
return|return
operator|(
name|OK
operator|)
return|;
block|}
end_function

begin_function
name|int
name|modifyrdn_arg_dup
parameter_list|(
name|src
parameter_list|,
name|tgt
parameter_list|)
name|struct
name|ds_modifyrdn_arg
modifier|*
name|src
decl_stmt|;
name|struct
name|ds_modifyrdn_arg
modifier|*
name|tgt
decl_stmt|;
block|{
if|if
condition|(
name|ca_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|mra_common
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|mra_common
operator|)
argument_list|)
operator|!=
name|OK
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|src
operator|->
name|mra_object
operator|==
name|NULLDN
condition|)
name|tgt
operator|->
name|mra_object
operator|=
name|NULLDN
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|mra_object
operator|=
name|dn_cpy
argument_list|(
name|src
operator|->
name|mra_object
argument_list|)
operator|)
operator|==
name|NULLDN
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|src
operator|->
name|mra_newrdn
operator|==
name|NULLRDN
condition|)
name|tgt
operator|->
name|mra_newrdn
operator|=
name|NULLRDN
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|mra_newrdn
operator|=
name|rdn_cpy
argument_list|(
name|src
operator|->
name|mra_newrdn
argument_list|)
operator|)
operator|==
name|NULLRDN
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
name|tgt
operator|->
name|deleterdn
operator|=
name|src
operator|->
name|deleterdn
expr_stmt|;
return|return
operator|(
name|OK
operator|)
return|;
block|}
end_function

begin_function
name|int
name|getedb_arg_dup
parameter_list|(
name|src
parameter_list|,
name|tgt
parameter_list|)
name|struct
name|getedb_arg
modifier|*
name|src
decl_stmt|;
name|struct
name|getedb_arg
modifier|*
name|tgt
decl_stmt|;
block|{
if|if
condition|(
name|src
operator|->
name|ga_entry
operator|==
name|NULLDN
condition|)
name|tgt
operator|->
name|ga_entry
operator|=
name|NULLDN
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|ga_entry
operator|=
name|dn_cpy
argument_list|(
name|src
operator|->
name|ga_entry
argument_list|)
operator|)
operator|==
name|NULLDN
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
name|tgt
operator|->
name|ga_version
operator|=
name|strdup
argument_list|(
name|src
operator|->
name|ga_version
argument_list|)
expr_stmt|;
name|tgt
operator|->
name|get_next
operator|=
name|NULL_GETARG
expr_stmt|;
return|return
operator|(
name|OK
operator|)
return|;
block|}
end_function

begin_function
name|int
name|ca_dup
parameter_list|(
name|src
parameter_list|,
name|tgt
parameter_list|)
name|struct
name|common_args
modifier|*
name|src
decl_stmt|;
name|struct
name|common_args
modifier|*
name|tgt
decl_stmt|;
block|{
name|struct
name|security_parms
modifier|*
name|secp_cpy
parameter_list|()
function_decl|;
name|struct
name|signature
modifier|*
name|sig_cpy
parameter_list|()
function_decl|;
name|struct
name|extension
modifier|*
name|ext_cpy
parameter_list|()
function_decl|;
name|tgt
operator|->
name|ca_servicecontrol
operator|=
name|src
operator|->
name|ca_servicecontrol
expr_stmt|;
comment|/* struct copy */
if|if
condition|(
name|src
operator|->
name|ca_requestor
operator|=
name|NULLDN
condition|)
name|tgt
operator|->
name|ca_requestor
operator|=
name|NULLDN
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|ca_requestor
operator|=
name|dn_cpy
argument_list|(
name|src
operator|->
name|ca_requestor
argument_list|)
operator|)
operator|==
name|NULLDN
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
name|tgt
operator|->
name|ca_progress
operator|=
name|src
operator|->
name|ca_progress
expr_stmt|;
comment|/* struct copy */
name|tgt
operator|->
name|ca_aliased_rdns
operator|=
name|src
operator|->
name|ca_aliased_rdns
expr_stmt|;
if|if
condition|(
name|src
operator|->
name|ca_security
operator|=
operator|(
expr|struct
name|security_parms
operator|*
operator|)
name|NULL
condition|)
name|tgt
operator|->
name|ca_security
operator|=
operator|(
expr|struct
name|security_parms
operator|*
operator|)
name|NULL
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|ca_security
operator|=
name|secp_cpy
argument_list|(
name|src
operator|->
name|ca_security
argument_list|)
operator|)
operator|==
operator|(
expr|struct
name|security_parms
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|src
operator|->
name|ca_sig
operator|==
operator|(
expr|struct
name|signature
operator|*
operator|)
name|NULL
condition|)
name|tgt
operator|->
name|ca_sig
operator|=
operator|(
expr|struct
name|signature
operator|*
operator|)
name|NULL
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|ca_sig
operator|=
name|sig_cpy
argument_list|(
name|src
operator|->
name|ca_sig
argument_list|)
operator|)
operator|==
operator|(
expr|struct
name|signature
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|src
operator|->
name|ca_extensions
operator|==
operator|(
expr|struct
name|extension
operator|*
operator|)
name|NULL
condition|)
name|tgt
operator|->
name|ca_extensions
operator|=
operator|(
expr|struct
name|extension
operator|*
operator|)
name|NULL
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|ca_extensions
operator|=
name|ext_cpy
argument_list|(
name|src
operator|->
name|ca_extensions
argument_list|)
operator|)
operator|==
operator|(
expr|struct
name|extension
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
return|return
operator|(
name|OK
operator|)
return|;
block|}
end_function

begin_function
name|struct
name|security_parms
modifier|*
name|secp_cpy
parameter_list|(
name|sp
parameter_list|)
name|struct
name|security_parms
modifier|*
name|sp
decl_stmt|;
block|{
name|struct
name|certificate_list
modifier|*
name|cpair_cpy
parameter_list|()
function_decl|;
name|struct
name|random_number
modifier|*
name|random_cpy
parameter_list|()
function_decl|;
name|struct
name|security_parms
modifier|*
name|ret
decl_stmt|;
if|if
condition|(
name|sp
operator|==
operator|(
expr|struct
name|security_parms
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|security_parms
operator|*
operator|)
name|NULL
operator|)
return|;
if|if
condition|(
operator|(
name|ret
operator|=
operator|(
expr|struct
name|security_parms
operator|*
operator|)
name|smalloc
argument_list|(
sizeof|sizeof
argument_list|(
expr|struct
name|security_parms
argument_list|)
argument_list|)
operator|)
operator|==
operator|(
expr|struct
name|security_parms
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|security_parms
operator|*
operator|)
name|NULL
operator|)
return|;
if|if
condition|(
name|sp
operator|->
name|sp_path
operator|==
operator|(
expr|struct
name|certificate_list
operator|*
operator|)
name|NULL
condition|)
name|ret
operator|->
name|sp_path
operator|=
operator|(
expr|struct
name|certificate_list
operator|*
operator|)
name|NULL
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|ret
operator|->
name|sp_path
operator|=
name|cpair_cpy
argument_list|(
name|sp
operator|->
name|sp_path
argument_list|)
operator|)
operator|==
operator|(
expr|struct
name|certificate_list
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|security_parms
operator|*
operator|)
name|NULL
operator|)
return|;
if|if
condition|(
name|sp
operator|->
name|sp_name
operator|==
name|NULLDN
condition|)
name|ret
operator|->
name|sp_name
operator|=
name|NULLDN
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|ret
operator|->
name|sp_name
operator|=
name|dn_cpy
argument_list|(
name|sp
operator|->
name|sp_name
argument_list|)
operator|)
operator|==
name|NULLDN
condition|)
return|return
operator|(
operator|(
expr|struct
name|security_parms
operator|*
operator|)
name|NULL
operator|)
return|;
name|ret
operator|->
name|sp_time
operator|=
name|strdup
argument_list|(
name|sp
operator|->
name|sp_time
argument_list|)
expr_stmt|;
if|if
condition|(
name|sp
operator|->
name|sp_random
operator|==
operator|(
expr|struct
name|random_number
operator|*
operator|)
name|NULL
condition|)
name|ret
operator|->
name|sp_random
operator|=
operator|(
expr|struct
name|random_number
operator|*
operator|)
name|NULL
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|ret
operator|->
name|sp_random
operator|=
name|random_cpy
argument_list|(
name|sp
operator|->
name|sp_random
argument_list|)
operator|)
operator|==
operator|(
expr|struct
name|random_number
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|security_parms
operator|*
operator|)
name|NULL
operator|)
return|;
name|ret
operator|->
name|sp_target
operator|=
name|sp
operator|->
name|sp_target
expr_stmt|;
return|return
operator|(
name|ret
operator|)
return|;
block|}
end_function

begin_function
name|struct
name|random_number
modifier|*
name|random_cpy
parameter_list|(
name|rand
parameter_list|)
name|struct
name|random_number
modifier|*
name|rand
decl_stmt|;
block|{
name|struct
name|random_number
modifier|*
name|ret
decl_stmt|;
if|if
condition|(
name|rand
operator|==
operator|(
expr|struct
name|random_number
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|random_number
operator|*
operator|)
name|NULL
operator|)
return|;
if|if
condition|(
operator|(
name|ret
operator|=
operator|(
expr|struct
name|random_number
operator|*
operator|)
name|smalloc
argument_list|(
sizeof|sizeof
argument_list|(
expr|struct
name|random_number
argument_list|)
argument_list|)
operator|)
operator|==
operator|(
expr|struct
name|random_number
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|random_number
operator|*
operator|)
name|NULL
operator|)
return|;
name|ret
operator|->
name|n_bits
operator|=
name|rand
operator|->
name|n_bits
expr_stmt|;
name|ret
operator|->
name|value
operator|=
name|strdup
argument_list|(
name|rand
operator|->
name|value
argument_list|)
expr_stmt|;
return|return
operator|(
name|ret
operator|)
return|;
block|}
end_function

begin_function
name|struct
name|signature
modifier|*
name|sig_cpy
parameter_list|(
name|sig
parameter_list|)
name|struct
name|signature
modifier|*
name|sig
decl_stmt|;
block|{
name|struct
name|signature
modifier|*
name|ret
decl_stmt|;
if|if
condition|(
name|sig
operator|==
operator|(
expr|struct
name|signature
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|signature
operator|*
operator|)
name|NULL
operator|)
return|;
if|if
condition|(
operator|(
name|ret
operator|=
operator|(
expr|struct
name|signature
operator|*
operator|)
name|smalloc
argument_list|(
sizeof|sizeof
argument_list|(
expr|struct
name|signature
argument_list|)
argument_list|)
operator|)
operator|==
operator|(
expr|struct
name|signature
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|signature
operator|*
operator|)
name|NULL
operator|)
return|;
operator|(
name|void
operator|)
name|alg_cpy
argument_list|(
name|ret
operator|->
name|alg
argument_list|,
name|sig
operator|->
name|alg
argument_list|)
expr_stmt|;
if|if
condition|(
name|sig
operator|->
name|encoded
operator|==
name|NULLPE
condition|)
name|ret
operator|->
name|encoded
operator|=
name|NULLPE
expr_stmt|;
else|else
name|ret
operator|->
name|encoded
operator|=
name|pe_cpy
argument_list|(
name|sig
operator|->
name|encoded
argument_list|)
expr_stmt|;
name|ret
operator|->
name|n_bits
operator|=
name|sig
operator|->
name|n_bits
expr_stmt|;
name|ret
operator|->
name|encrypted
operator|=
name|strdup
argument_list|(
name|sig
operator|->
name|encrypted
argument_list|)
expr_stmt|;
return|return
operator|(
name|ret
operator|)
return|;
block|}
end_function

begin_function
name|struct
name|extension
modifier|*
name|ext_cpy
parameter_list|(
name|ext
parameter_list|)
name|struct
name|extension
modifier|*
name|ext
decl_stmt|;
block|{
name|struct
name|extension
modifier|*
name|ret
decl_stmt|;
if|if
condition|(
name|ext
operator|==
operator|(
expr|struct
name|extension
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|extension
operator|*
operator|)
name|NULL
operator|)
return|;
if|if
condition|(
operator|(
name|ret
operator|=
operator|(
expr|struct
name|extension
operator|*
operator|)
name|smalloc
argument_list|(
sizeof|sizeof
argument_list|(
expr|struct
name|extension
argument_list|)
argument_list|)
operator|)
operator|==
operator|(
expr|struct
name|extension
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|extension
operator|*
operator|)
name|NULL
operator|)
return|;
name|ret
operator|->
name|ext_id
operator|=
name|ext
operator|->
name|ext_id
expr_stmt|;
name|ret
operator|->
name|ext_critical
operator|=
name|ext
operator|->
name|ext_critical
expr_stmt|;
if|if
condition|(
name|ext
operator|->
name|ext_item
operator|==
name|NULLPE
condition|)
name|ret
operator|->
name|ext_item
operator|=
name|NULLPE
expr_stmt|;
else|else
name|ret
operator|->
name|ext_item
operator|=
name|pe_cpy
argument_list|(
name|ext
operator|->
name|ext_item
argument_list|)
expr_stmt|;
if|if
condition|(
name|ext
operator|->
name|ext_next
operator|==
operator|(
expr|struct
name|extension
operator|*
operator|)
name|NULL
condition|)
name|ret
operator|->
name|ext_next
operator|=
operator|(
expr|struct
name|extension
operator|*
operator|)
name|NULL
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|ret
operator|->
name|ext_next
operator|=
name|ext_cpy
argument_list|(
name|ext
operator|->
name|ext_next
argument_list|)
operator|)
operator|==
operator|(
expr|struct
name|extension
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|extension
operator|*
operator|)
name|NULL
operator|)
return|;
return|return
operator|(
name|ret
operator|)
return|;
block|}
end_function

begin_function
name|struct
name|filter
modifier|*
name|filter_cpy
parameter_list|(
name|flt
parameter_list|)
name|struct
name|filter
modifier|*
name|flt
decl_stmt|;
block|{
name|struct
name|filter
modifier|*
name|ret
decl_stmt|;
if|if
condition|(
name|flt
operator|==
operator|(
expr|struct
name|filter
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|filter
operator|*
operator|)
name|NULL
operator|)
return|;
if|if
condition|(
operator|(
name|ret
operator|=
operator|(
expr|struct
name|filter
operator|*
operator|)
name|smalloc
argument_list|(
sizeof|sizeof
argument_list|(
expr|struct
name|filter
argument_list|)
argument_list|)
operator|)
operator|==
operator|(
expr|struct
name|filter
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|filter
operator|*
operator|)
name|NULL
operator|)
return|;
switch|switch
condition|(
name|ret
operator|->
name|flt_type
operator|=
name|flt
operator|->
name|flt_type
condition|)
block|{
case|case
name|FILTER_ITEM
case|:
if|if
condition|(
name|filter_item_dup
argument_list|(
operator|&
operator|(
name|flt
operator|->
name|flt_un
operator|.
name|flt_un_item
operator|)
argument_list|,
operator|&
operator|(
name|ret
operator|->
name|flt_un
operator|.
name|flt_un_item
operator|)
argument_list|)
operator|!=
name|OK
condition|)
return|return
operator|(
operator|(
expr|struct
name|filter
operator|*
operator|)
name|NULL
operator|)
return|;
break|break;
case|case
name|FILTER_AND
case|:
case|case
name|FILTER_OR
case|:
case|case
name|FILTER_NOT
case|:
if|if
condition|(
name|flt
operator|->
name|flt_un
operator|.
name|flt_un_filter
operator|==
operator|(
expr|struct
name|filter
operator|*
operator|)
name|NULL
condition|)
name|ret
operator|->
name|flt_un
operator|.
name|flt_un_filter
operator|=
operator|(
expr|struct
name|filter
operator|*
operator|)
name|NULL
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|ret
operator|->
name|flt_un
operator|.
name|flt_un_filter
operator|=
name|filter_cpy
argument_list|(
name|flt
operator|->
name|flt_un
operator|.
name|flt_un_filter
argument_list|)
operator|)
operator|==
operator|(
expr|struct
name|filter
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|filter
operator|*
operator|)
name|NULL
operator|)
return|;
break|break;
default|default:
name|DLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_DEBUG
argument_list|,
operator|(
literal|"filter_cpy(): unknown filter type %d"
operator|,
name|flt
operator|->
name|flt_type
operator|)
argument_list|)
expr_stmt|;
return|return
operator|(
operator|(
expr|struct
name|filter
operator|*
operator|)
name|NULL
operator|)
return|;
block|}
if|if
condition|(
name|flt
operator|->
name|flt_next
operator|==
operator|(
expr|struct
name|filter
operator|*
operator|)
name|NULL
condition|)
name|ret
operator|->
name|flt_next
operator|=
operator|(
expr|struct
name|filter
operator|*
operator|)
name|NULL
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|ret
operator|->
name|flt_next
operator|=
name|filter_cpy
argument_list|(
name|flt
operator|->
name|flt_next
argument_list|)
operator|)
operator|==
operator|(
expr|struct
name|filter
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|filter
operator|*
operator|)
name|NULL
operator|)
return|;
return|return
operator|(
name|ret
operator|)
return|;
block|}
end_function

begin_function
name|int
name|filter_item_dup
parameter_list|(
name|src
parameter_list|,
name|tgt
parameter_list|)
name|struct
name|filter_item
modifier|*
name|src
decl_stmt|;
name|struct
name|filter_item
modifier|*
name|tgt
decl_stmt|;
block|{
switch|switch
condition|(
name|tgt
operator|->
name|fi_type
operator|=
name|src
operator|->
name|fi_type
condition|)
block|{
case|case
name|FILTERITEM_EQUALITY
case|:
case|case
name|FILTERITEM_GREATEROREQUAL
case|:
case|case
name|FILTERITEM_LESSOREQUAL
case|:
case|case
name|FILTERITEM_APPROX
case|:
if|if
condition|(
name|ava_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|fi_un
operator|.
name|fi_un_ava
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|fi_un
operator|.
name|fi_un_ava
operator|)
argument_list|)
operator|!=
name|OK
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
break|break;
case|case
name|FILTERITEM_PRESENT
case|:
if|if
condition|(
name|src
operator|->
name|fi_un
operator|.
name|fi_un_type
operator|==
name|NULLAttrT
condition|)
name|tgt
operator|->
name|fi_un
operator|.
name|fi_un_type
operator|=
name|NULLAttrT
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|fi_un
operator|.
name|fi_un_type
operator|=
name|AttrT_cpy
argument_list|(
name|src
operator|->
name|fi_un
operator|.
name|fi_un_type
argument_list|)
operator|)
operator|==
name|NULLAttrT
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
break|break;
case|case
name|FILTERITEM_SUBSTRINGS
case|:
if|if
condition|(
name|fi_sub_dup
argument_list|(
operator|&
operator|(
name|src
operator|->
name|fi_un
operator|.
name|fi_un_substrings
operator|)
argument_list|,
operator|&
operator|(
name|tgt
operator|->
name|fi_un
operator|.
name|fi_un_substrings
operator|)
argument_list|)
operator|!=
name|OK
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
break|break;
default|default:
name|DLOG
argument_list|(
name|log_dsap
argument_list|,
name|LLOG_DEBUG
argument_list|,
operator|(
literal|"filter_item_dup(): unknown filter_item type %d"
operator|,
name|src
operator|->
name|fi_type
operator|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|NOTOK
operator|)
return|;
block|}
name|tgt
operator|->
name|fi_ifp
operator|=
name|src
operator|->
name|fi_ifp
expr_stmt|;
return|return
operator|(
name|OK
operator|)
return|;
block|}
end_function

begin_function
name|int
name|fi_sub_dup
parameter_list|(
name|src
parameter_list|,
name|tgt
parameter_list|)
name|Filter_Substrings
modifier|*
name|src
decl_stmt|;
name|Filter_Substrings
modifier|*
name|tgt
decl_stmt|;
block|{
if|if
condition|(
name|src
operator|->
name|fi_sub_type
operator|==
name|NULLAttrT
condition|)
name|tgt
operator|->
name|fi_sub_type
operator|=
name|NULLAttrT
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|fi_sub_type
operator|=
name|AttrT_cpy
argument_list|(
name|src
operator|->
name|fi_sub_type
argument_list|)
operator|)
operator|==
name|NULLAttrT
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|src
operator|->
name|fi_sub_initial
operator|==
name|NULLAV
condition|)
name|tgt
operator|->
name|fi_sub_initial
operator|=
name|NULLAV
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|fi_sub_initial
operator|=
name|avs_cpy
argument_list|(
name|src
operator|->
name|fi_sub_initial
argument_list|)
operator|)
operator|==
name|NULLAV
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|src
operator|->
name|fi_sub_any
operator|==
name|NULLAV
condition|)
name|tgt
operator|->
name|fi_sub_any
operator|=
name|NULLAV
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|fi_sub_any
operator|=
name|avs_cpy
argument_list|(
name|src
operator|->
name|fi_sub_any
argument_list|)
operator|)
operator|==
name|NULLAV
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|src
operator|->
name|fi_sub_final
operator|==
name|NULLAV
condition|)
name|tgt
operator|->
name|fi_sub_final
operator|=
name|NULLAV
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|fi_sub_final
operator|=
name|avs_cpy
argument_list|(
name|src
operator|->
name|fi_sub_final
argument_list|)
operator|)
operator|==
name|NULLAV
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
name|tgt
operator|->
name|fi_sub_match
operator|=
name|strdup
argument_list|(
name|src
operator|->
name|fi_sub_match
argument_list|)
expr_stmt|;
return|return
operator|(
name|OK
operator|)
return|;
block|}
end_function

begin_function
name|struct
name|entrymod
modifier|*
name|ems_cpy
parameter_list|(
name|em
parameter_list|)
name|struct
name|entrymod
modifier|*
name|em
decl_stmt|;
block|{
name|struct
name|entrymod
modifier|*
name|ret
decl_stmt|;
if|if
condition|(
name|em
operator|==
operator|(
expr|struct
name|entrymod
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|entrymod
operator|*
operator|)
name|NULL
operator|)
return|;
if|if
condition|(
operator|(
name|ret
operator|=
operator|(
expr|struct
name|entrymod
operator|*
operator|)
name|smalloc
argument_list|(
sizeof|sizeof
argument_list|(
expr|struct
name|entrymod
argument_list|)
argument_list|)
operator|)
operator|==
operator|(
expr|struct
name|entrymod
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|entrymod
operator|*
operator|)
name|NULL
operator|)
return|;
name|ret
operator|->
name|em_type
operator|=
name|em
operator|->
name|em_type
expr_stmt|;
if|if
condition|(
name|em
operator|->
name|em_what
operator|==
name|NULLATTR
condition|)
name|ret
operator|->
name|em_what
operator|=
name|NULLATTR
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|ret
operator|->
name|em_what
operator|=
name|as_cpy
argument_list|(
name|em
operator|->
name|em_what
argument_list|)
operator|)
operator|==
name|NULLATTR
condition|)
return|return
operator|(
operator|(
expr|struct
name|entrymod
operator|*
operator|)
name|NULL
operator|)
return|;
if|if
condition|(
name|em
operator|->
name|em_next
operator|==
operator|(
expr|struct
name|entrymod
operator|*
operator|)
name|NULL
condition|)
name|ret
operator|->
name|em_next
operator|=
operator|(
expr|struct
name|entrymod
operator|*
operator|)
name|NULL
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|ret
operator|->
name|em_next
operator|=
name|ems_cpy
argument_list|(
name|em
operator|->
name|em_next
argument_list|)
operator|)
operator|==
operator|(
expr|struct
name|entrymod
operator|*
operator|)
name|NULL
condition|)
return|return
operator|(
operator|(
expr|struct
name|entrymod
operator|*
operator|)
name|NULL
operator|)
return|;
return|return
operator|(
name|ret
operator|)
return|;
block|}
end_function

begin_function
name|int
name|eis_dup
parameter_list|(
name|src
parameter_list|,
name|tgt
parameter_list|)
name|struct
name|entryinfoselection
modifier|*
name|src
decl_stmt|;
name|struct
name|entryinfoselection
modifier|*
name|tgt
decl_stmt|;
block|{
name|tgt
operator|->
name|eis_allattributes
operator|=
name|src
operator|->
name|eis_allattributes
expr_stmt|;
if|if
condition|(
name|src
operator|->
name|eis_select
operator|==
name|NULLATTR
condition|)
name|tgt
operator|->
name|eis_select
operator|=
name|NULLATTR
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|eis_select
operator|=
name|as_cpy
argument_list|(
name|src
operator|->
name|eis_select
argument_list|)
operator|)
operator|==
name|NULLATTR
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
name|tgt
operator|->
name|eis_infotypes
operator|=
name|src
operator|->
name|eis_infotypes
expr_stmt|;
return|return
operator|(
name|OK
operator|)
return|;
block|}
end_function

begin_function
name|int
name|ava_dup
parameter_list|(
name|src
parameter_list|,
name|tgt
parameter_list|)
name|struct
name|ava
modifier|*
name|src
decl_stmt|;
name|struct
name|ava
modifier|*
name|tgt
decl_stmt|;
block|{
if|if
condition|(
name|src
operator|->
name|ava_type
operator|==
name|NULLAttrT
condition|)
name|tgt
operator|->
name|ava_type
operator|=
name|NULLAttrT
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|ava_type
operator|=
name|AttrT_cpy
argument_list|(
name|src
operator|->
name|ava_type
argument_list|)
operator|)
operator|==
name|NULLAttrT
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
if|if
condition|(
name|src
operator|->
name|ava_value
operator|==
name|NULLAttrV
condition|)
name|tgt
operator|->
name|ava_value
operator|=
name|NULLAttrV
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|tgt
operator|->
name|ava_value
operator|=
name|AttrV_cpy
argument_list|(
name|src
operator|->
name|ava_value
argument_list|)
operator|)
operator|==
name|NULLAttrV
condition|)
return|return
operator|(
name|NOTOK
operator|)
return|;
return|return
operator|(
name|OK
operator|)
return|;
block|}
end_function

end_unit

