begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* ** $Id: lopcodes.c,v 1.49.1.1 2013/04/12 18:48:47 roberto Exp $ ** Opcodes for Lua virtual machine ** See Copyright Notice in lua.h */
end_comment

begin_define
define|#
directive|define
name|lopcodes_c
end_define

begin_define
define|#
directive|define
name|LUA_CORE
end_define

begin_include
include|#
directive|include
file|"lopcodes.h"
end_include

begin_comment
comment|/* ORDER OP */
end_comment

begin_decl_stmt
name|LUAI_DDEF
specifier|const
name|char
modifier|*
specifier|const
name|luaP_opnames
index|[
name|NUM_OPCODES
operator|+
literal|1
index|]
init|=
block|{
literal|"MOVE"
block|,
literal|"LOADK"
block|,
literal|"LOADKX"
block|,
literal|"LOADBOOL"
block|,
literal|"LOADNIL"
block|,
literal|"GETUPVAL"
block|,
literal|"GETTABUP"
block|,
literal|"GETTABLE"
block|,
literal|"SETTABUP"
block|,
literal|"SETUPVAL"
block|,
literal|"SETTABLE"
block|,
literal|"NEWTABLE"
block|,
literal|"SELF"
block|,
literal|"ADD"
block|,
literal|"SUB"
block|,
literal|"MUL"
block|,
literal|"DIV"
block|,
literal|"MOD"
block|,
literal|"POW"
block|,
literal|"UNM"
block|,
literal|"NOT"
block|,
literal|"LEN"
block|,
literal|"CONCAT"
block|,
literal|"JMP"
block|,
literal|"EQ"
block|,
literal|"LT"
block|,
literal|"LE"
block|,
literal|"TEST"
block|,
literal|"TESTSET"
block|,
literal|"CALL"
block|,
literal|"TAILCALL"
block|,
literal|"RETURN"
block|,
literal|"FORLOOP"
block|,
literal|"FORPREP"
block|,
literal|"TFORCALL"
block|,
literal|"TFORLOOP"
block|,
literal|"SETLIST"
block|,
literal|"CLOSURE"
block|,
literal|"VARARG"
block|,
literal|"EXTRAARG"
block|,
name|NULL
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|opmode
parameter_list|(
name|t
parameter_list|,
name|a
parameter_list|,
name|b
parameter_list|,
name|c
parameter_list|,
name|m
parameter_list|)
value|(((t)<<7) | ((a)<<6) | ((b)<<4) | ((c)<<2) | (m))
end_define

begin_decl_stmt
name|LUAI_DDEF
specifier|const
name|lu_byte
name|luaP_opmodes
index|[
name|NUM_OPCODES
index|]
init|=
block|{
comment|/*       T  A    B       C     mode		   opcode	*/
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgR
argument_list|,
name|OpArgN
argument_list|,
name|iABC
argument_list|)
comment|/* OP_MOVE */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgK
argument_list|,
name|OpArgN
argument_list|,
name|iABx
argument_list|)
comment|/* OP_LOADK */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgN
argument_list|,
name|OpArgN
argument_list|,
name|iABx
argument_list|)
comment|/* OP_LOADKX */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgU
argument_list|,
name|OpArgU
argument_list|,
name|iABC
argument_list|)
comment|/* OP_LOADBOOL */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgU
argument_list|,
name|OpArgN
argument_list|,
name|iABC
argument_list|)
comment|/* OP_LOADNIL */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgU
argument_list|,
name|OpArgN
argument_list|,
name|iABC
argument_list|)
comment|/* OP_GETUPVAL */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgU
argument_list|,
name|OpArgK
argument_list|,
name|iABC
argument_list|)
comment|/* OP_GETTABUP */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgR
argument_list|,
name|OpArgK
argument_list|,
name|iABC
argument_list|)
comment|/* OP_GETTABLE */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
name|OpArgK
argument_list|,
name|OpArgK
argument_list|,
name|iABC
argument_list|)
comment|/* OP_SETTABUP */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
name|OpArgU
argument_list|,
name|OpArgN
argument_list|,
name|iABC
argument_list|)
comment|/* OP_SETUPVAL */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
name|OpArgK
argument_list|,
name|OpArgK
argument_list|,
name|iABC
argument_list|)
comment|/* OP_SETTABLE */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgU
argument_list|,
name|OpArgU
argument_list|,
name|iABC
argument_list|)
comment|/* OP_NEWTABLE */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgR
argument_list|,
name|OpArgK
argument_list|,
name|iABC
argument_list|)
comment|/* OP_SELF */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgK
argument_list|,
name|OpArgK
argument_list|,
name|iABC
argument_list|)
comment|/* OP_ADD */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgK
argument_list|,
name|OpArgK
argument_list|,
name|iABC
argument_list|)
comment|/* OP_SUB */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgK
argument_list|,
name|OpArgK
argument_list|,
name|iABC
argument_list|)
comment|/* OP_MUL */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgK
argument_list|,
name|OpArgK
argument_list|,
name|iABC
argument_list|)
comment|/* OP_DIV */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgK
argument_list|,
name|OpArgK
argument_list|,
name|iABC
argument_list|)
comment|/* OP_MOD */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgK
argument_list|,
name|OpArgK
argument_list|,
name|iABC
argument_list|)
comment|/* OP_POW */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgR
argument_list|,
name|OpArgN
argument_list|,
name|iABC
argument_list|)
comment|/* OP_UNM */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgR
argument_list|,
name|OpArgN
argument_list|,
name|iABC
argument_list|)
comment|/* OP_NOT */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgR
argument_list|,
name|OpArgN
argument_list|,
name|iABC
argument_list|)
comment|/* OP_LEN */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgR
argument_list|,
name|OpArgR
argument_list|,
name|iABC
argument_list|)
comment|/* OP_CONCAT */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
name|OpArgR
argument_list|,
name|OpArgN
argument_list|,
name|iAsBx
argument_list|)
comment|/* OP_JMP */
block|,
name|opmode
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|,
name|OpArgK
argument_list|,
name|OpArgK
argument_list|,
name|iABC
argument_list|)
comment|/* OP_EQ */
block|,
name|opmode
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|,
name|OpArgK
argument_list|,
name|OpArgK
argument_list|,
name|iABC
argument_list|)
comment|/* OP_LT */
block|,
name|opmode
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|,
name|OpArgK
argument_list|,
name|OpArgK
argument_list|,
name|iABC
argument_list|)
comment|/* OP_LE */
block|,
name|opmode
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|,
name|OpArgN
argument_list|,
name|OpArgU
argument_list|,
name|iABC
argument_list|)
comment|/* OP_TEST */
block|,
name|opmode
argument_list|(
literal|1
argument_list|,
literal|1
argument_list|,
name|OpArgR
argument_list|,
name|OpArgU
argument_list|,
name|iABC
argument_list|)
comment|/* OP_TESTSET */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgU
argument_list|,
name|OpArgU
argument_list|,
name|iABC
argument_list|)
comment|/* OP_CALL */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgU
argument_list|,
name|OpArgU
argument_list|,
name|iABC
argument_list|)
comment|/* OP_TAILCALL */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
name|OpArgU
argument_list|,
name|OpArgN
argument_list|,
name|iABC
argument_list|)
comment|/* OP_RETURN */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgR
argument_list|,
name|OpArgN
argument_list|,
name|iAsBx
argument_list|)
comment|/* OP_FORLOOP */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgR
argument_list|,
name|OpArgN
argument_list|,
name|iAsBx
argument_list|)
comment|/* OP_FORPREP */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
name|OpArgN
argument_list|,
name|OpArgU
argument_list|,
name|iABC
argument_list|)
comment|/* OP_TFORCALL */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgR
argument_list|,
name|OpArgN
argument_list|,
name|iAsBx
argument_list|)
comment|/* OP_TFORLOOP */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
name|OpArgU
argument_list|,
name|OpArgU
argument_list|,
name|iABC
argument_list|)
comment|/* OP_SETLIST */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgU
argument_list|,
name|OpArgN
argument_list|,
name|iABx
argument_list|)
comment|/* OP_CLOSURE */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|1
argument_list|,
name|OpArgU
argument_list|,
name|OpArgN
argument_list|,
name|iABC
argument_list|)
comment|/* OP_VARARG */
block|,
name|opmode
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
argument|OpArgU
argument_list|,
argument|OpArgU
argument_list|,
argument|iAx
argument_list|)
comment|/* OP_EXTRAARG */
block|}
decl_stmt|;
end_decl_stmt

end_unit

