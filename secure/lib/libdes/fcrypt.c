begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* crypto/des/fcrypt.c */
end_comment

begin_comment
comment|/* Copyright (C) 1995-1996 Eric Young (eay@mincom.oz.au)  * All rights reserved.  *   * This file is part of an SSL implementation written  * by Eric Young (eay@mincom.oz.au).  * The implementation was written so as to conform with Netscapes SSL  * specification.  This library and applications are  * FREE FOR COMMERCIAL AND NON-COMMERCIAL USE  * as long as the following conditions are aheared to.  *   * Copyright remains Eric Young's, and as such any Copyright notices in  * the code are not to be removed.  If this code is used in a product,  * Eric Young should be given attribution as the author of the parts used.  * This can be in the form of a textual message at program startup or  * in documentation (online or textual) provided with the package.  *   * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  * 3. All advertising materials mentioning features or use of this software  *    must display the following acknowledgement:  *    This product includes software developed by Eric Young (eay@mincom.oz.au)  *   * THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  *   * The licence and distribution terms for any publically available version or  * derivative of this code cannot be changed.  i.e. this code cannot simply be  * copied and put under another distribution licence  * [including the GNU Public Licence.]  */
end_comment

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_comment
comment|/* Eric Young.  * This version of crypt has been developed from my MIT compatable  * DES library.  * The library is available at pub/Crypto/DES at ftp.psy.uq.oz.au  * eay@mincom.oz.au or eay@psych.psy.uq.oz.au  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|HEADER_DES_LOCL_H
end_ifndef

begin_if
if|#
directive|if
name|defined
argument_list|(
name|NOCONST
argument_list|)
end_if

begin_define
define|#
directive|define
name|const
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* I now assume that you have des.h available */
end_comment

begin_include
include|#
directive|include
file|"des.h"
end_include

begin_define
define|#
directive|define
name|ITERATIONS
value|16
end_define

begin_define
define|#
directive|define
name|HALF_ITERATIONS
value|8
end_define

begin_define
define|#
directive|define
name|c2l
parameter_list|(
name|c
parameter_list|,
name|l
parameter_list|)
value|(l =((DES_LONG)(*((c)++)))    , \ 			 l|=((DES_LONG)(*((c)++)))<< 8, \ 			 l|=((DES_LONG)(*((c)++)))<<16, \ 			 l|=((DES_LONG)(*((c)++)))<<24)
end_define

begin_define
define|#
directive|define
name|l2c
parameter_list|(
name|l
parameter_list|,
name|c
parameter_list|)
value|(*((c)++)=(unsigned char)(((l)    )&0xff), \ 			 *((c)++)=(unsigned char)(((l)>> 8)&0xff), \ 			 *((c)++)=(unsigned char)(((l)>>16)&0xff), \ 			 *((c)++)=(unsigned char)(((l)>>24)&0xff))
end_define

begin_decl_stmt
specifier|static
specifier|const
name|DES_LONG
name|des_SPtrans
index|[
literal|8
index|]
index|[
literal|64
index|]
init|=
block|{
block|{
comment|/* nibble 0 */
literal|0x00820200L
block|,
literal|0x00020000L
block|,
literal|0x80800000L
block|,
literal|0x80820200L
block|,
literal|0x00800000L
block|,
literal|0x80020200L
block|,
literal|0x80020000L
block|,
literal|0x80800000L
block|,
literal|0x80020200L
block|,
literal|0x00820200L
block|,
literal|0x00820000L
block|,
literal|0x80000200L
block|,
literal|0x80800200L
block|,
literal|0x00800000L
block|,
literal|0x00000000L
block|,
literal|0x80020000L
block|,
literal|0x00020000L
block|,
literal|0x80000000L
block|,
literal|0x00800200L
block|,
literal|0x00020200L
block|,
literal|0x80820200L
block|,
literal|0x00820000L
block|,
literal|0x80000200L
block|,
literal|0x00800200L
block|,
literal|0x80000000L
block|,
literal|0x00000200L
block|,
literal|0x00020200L
block|,
literal|0x80820000L
block|,
literal|0x00000200L
block|,
literal|0x80800200L
block|,
literal|0x80820000L
block|,
literal|0x00000000L
block|,
literal|0x00000000L
block|,
literal|0x80820200L
block|,
literal|0x00800200L
block|,
literal|0x80020000L
block|,
literal|0x00820200L
block|,
literal|0x00020000L
block|,
literal|0x80000200L
block|,
literal|0x00800200L
block|,
literal|0x80820000L
block|,
literal|0x00000200L
block|,
literal|0x00020200L
block|,
literal|0x80800000L
block|,
literal|0x80020200L
block|,
literal|0x80000000L
block|,
literal|0x80800000L
block|,
literal|0x00820000L
block|,
literal|0x80820200L
block|,
literal|0x00020200L
block|,
literal|0x00820000L
block|,
literal|0x80800200L
block|,
literal|0x00800000L
block|,
literal|0x80000200L
block|,
literal|0x80020000L
block|,
literal|0x00000000L
block|,
literal|0x00020000L
block|,
literal|0x00800000L
block|,
literal|0x80800200L
block|,
literal|0x00820200L
block|,
literal|0x80000000L
block|,
literal|0x80820000L
block|,
literal|0x00000200L
block|,
literal|0x80020200L
block|, }
block|,
block|{
comment|/* nibble 1 */
literal|0x10042004L
block|,
literal|0x00000000L
block|,
literal|0x00042000L
block|,
literal|0x10040000L
block|,
literal|0x10000004L
block|,
literal|0x00002004L
block|,
literal|0x10002000L
block|,
literal|0x00042000L
block|,
literal|0x00002000L
block|,
literal|0x10040004L
block|,
literal|0x00000004L
block|,
literal|0x10002000L
block|,
literal|0x00040004L
block|,
literal|0x10042000L
block|,
literal|0x10040000L
block|,
literal|0x00000004L
block|,
literal|0x00040000L
block|,
literal|0x10002004L
block|,
literal|0x10040004L
block|,
literal|0x00002000L
block|,
literal|0x00042004L
block|,
literal|0x10000000L
block|,
literal|0x00000000L
block|,
literal|0x00040004L
block|,
literal|0x10002004L
block|,
literal|0x00042004L
block|,
literal|0x10042000L
block|,
literal|0x10000004L
block|,
literal|0x10000000L
block|,
literal|0x00040000L
block|,
literal|0x00002004L
block|,
literal|0x10042004L
block|,
literal|0x00040004L
block|,
literal|0x10042000L
block|,
literal|0x10002000L
block|,
literal|0x00042004L
block|,
literal|0x10042004L
block|,
literal|0x00040004L
block|,
literal|0x10000004L
block|,
literal|0x00000000L
block|,
literal|0x10000000L
block|,
literal|0x00002004L
block|,
literal|0x00040000L
block|,
literal|0x10040004L
block|,
literal|0x00002000L
block|,
literal|0x10000000L
block|,
literal|0x00042004L
block|,
literal|0x10002004L
block|,
literal|0x10042000L
block|,
literal|0x00002000L
block|,
literal|0x00000000L
block|,
literal|0x10000004L
block|,
literal|0x00000004L
block|,
literal|0x10042004L
block|,
literal|0x00042000L
block|,
literal|0x10040000L
block|,
literal|0x10040004L
block|,
literal|0x00040000L
block|,
literal|0x00002004L
block|,
literal|0x10002000L
block|,
literal|0x10002004L
block|,
literal|0x00000004L
block|,
literal|0x10040000L
block|,
literal|0x00042000L
block|, }
block|,
block|{
comment|/* nibble 2 */
literal|0x41000000L
block|,
literal|0x01010040L
block|,
literal|0x00000040L
block|,
literal|0x41000040L
block|,
literal|0x40010000L
block|,
literal|0x01000000L
block|,
literal|0x41000040L
block|,
literal|0x00010040L
block|,
literal|0x01000040L
block|,
literal|0x00010000L
block|,
literal|0x01010000L
block|,
literal|0x40000000L
block|,
literal|0x41010040L
block|,
literal|0x40000040L
block|,
literal|0x40000000L
block|,
literal|0x41010000L
block|,
literal|0x00000000L
block|,
literal|0x40010000L
block|,
literal|0x01010040L
block|,
literal|0x00000040L
block|,
literal|0x40000040L
block|,
literal|0x41010040L
block|,
literal|0x00010000L
block|,
literal|0x41000000L
block|,
literal|0x41010000L
block|,
literal|0x01000040L
block|,
literal|0x40010040L
block|,
literal|0x01010000L
block|,
literal|0x00010040L
block|,
literal|0x00000000L
block|,
literal|0x01000000L
block|,
literal|0x40010040L
block|,
literal|0x01010040L
block|,
literal|0x00000040L
block|,
literal|0x40000000L
block|,
literal|0x00010000L
block|,
literal|0x40000040L
block|,
literal|0x40010000L
block|,
literal|0x01010000L
block|,
literal|0x41000040L
block|,
literal|0x00000000L
block|,
literal|0x01010040L
block|,
literal|0x00010040L
block|,
literal|0x41010000L
block|,
literal|0x40010000L
block|,
literal|0x01000000L
block|,
literal|0x41010040L
block|,
literal|0x40000000L
block|,
literal|0x40010040L
block|,
literal|0x41000000L
block|,
literal|0x01000000L
block|,
literal|0x41010040L
block|,
literal|0x00010000L
block|,
literal|0x01000040L
block|,
literal|0x41000040L
block|,
literal|0x00010040L
block|,
literal|0x01000040L
block|,
literal|0x00000000L
block|,
literal|0x41010000L
block|,
literal|0x40000040L
block|,
literal|0x41000000L
block|,
literal|0x40010040L
block|,
literal|0x00000040L
block|,
literal|0x01010000L
block|, }
block|,
block|{
comment|/* nibble 3 */
literal|0x00100402L
block|,
literal|0x04000400L
block|,
literal|0x00000002L
block|,
literal|0x04100402L
block|,
literal|0x00000000L
block|,
literal|0x04100000L
block|,
literal|0x04000402L
block|,
literal|0x00100002L
block|,
literal|0x04100400L
block|,
literal|0x04000002L
block|,
literal|0x04000000L
block|,
literal|0x00000402L
block|,
literal|0x04000002L
block|,
literal|0x00100402L
block|,
literal|0x00100000L
block|,
literal|0x04000000L
block|,
literal|0x04100002L
block|,
literal|0x00100400L
block|,
literal|0x00000400L
block|,
literal|0x00000002L
block|,
literal|0x00100400L
block|,
literal|0x04000402L
block|,
literal|0x04100000L
block|,
literal|0x00000400L
block|,
literal|0x00000402L
block|,
literal|0x00000000L
block|,
literal|0x00100002L
block|,
literal|0x04100400L
block|,
literal|0x04000400L
block|,
literal|0x04100002L
block|,
literal|0x04100402L
block|,
literal|0x00100000L
block|,
literal|0x04100002L
block|,
literal|0x00000402L
block|,
literal|0x00100000L
block|,
literal|0x04000002L
block|,
literal|0x00100400L
block|,
literal|0x04000400L
block|,
literal|0x00000002L
block|,
literal|0x04100000L
block|,
literal|0x04000402L
block|,
literal|0x00000000L
block|,
literal|0x00000400L
block|,
literal|0x00100002L
block|,
literal|0x00000000L
block|,
literal|0x04100002L
block|,
literal|0x04100400L
block|,
literal|0x00000400L
block|,
literal|0x04000000L
block|,
literal|0x04100402L
block|,
literal|0x00100402L
block|,
literal|0x00100000L
block|,
literal|0x04100402L
block|,
literal|0x00000002L
block|,
literal|0x04000400L
block|,
literal|0x00100402L
block|,
literal|0x00100002L
block|,
literal|0x00100400L
block|,
literal|0x04100000L
block|,
literal|0x04000402L
block|,
literal|0x00000402L
block|,
literal|0x04000000L
block|,
literal|0x04000002L
block|,
literal|0x04100400L
block|, }
block|,
block|{
comment|/* nibble 4 */
literal|0x02000000L
block|,
literal|0x00004000L
block|,
literal|0x00000100L
block|,
literal|0x02004108L
block|,
literal|0x02004008L
block|,
literal|0x02000100L
block|,
literal|0x00004108L
block|,
literal|0x02004000L
block|,
literal|0x00004000L
block|,
literal|0x00000008L
block|,
literal|0x02000008L
block|,
literal|0x00004100L
block|,
literal|0x02000108L
block|,
literal|0x02004008L
block|,
literal|0x02004100L
block|,
literal|0x00000000L
block|,
literal|0x00004100L
block|,
literal|0x02000000L
block|,
literal|0x00004008L
block|,
literal|0x00000108L
block|,
literal|0x02000100L
block|,
literal|0x00004108L
block|,
literal|0x00000000L
block|,
literal|0x02000008L
block|,
literal|0x00000008L
block|,
literal|0x02000108L
block|,
literal|0x02004108L
block|,
literal|0x00004008L
block|,
literal|0x02004000L
block|,
literal|0x00000100L
block|,
literal|0x00000108L
block|,
literal|0x02004100L
block|,
literal|0x02004100L
block|,
literal|0x02000108L
block|,
literal|0x00004008L
block|,
literal|0x02004000L
block|,
literal|0x00004000L
block|,
literal|0x00000008L
block|,
literal|0x02000008L
block|,
literal|0x02000100L
block|,
literal|0x02000000L
block|,
literal|0x00004100L
block|,
literal|0x02004108L
block|,
literal|0x00000000L
block|,
literal|0x00004108L
block|,
literal|0x02000000L
block|,
literal|0x00000100L
block|,
literal|0x00004008L
block|,
literal|0x02000108L
block|,
literal|0x00000100L
block|,
literal|0x00000000L
block|,
literal|0x02004108L
block|,
literal|0x02004008L
block|,
literal|0x02004100L
block|,
literal|0x00000108L
block|,
literal|0x00004000L
block|,
literal|0x00004100L
block|,
literal|0x02004008L
block|,
literal|0x02000100L
block|,
literal|0x00000108L
block|,
literal|0x00000008L
block|,
literal|0x00004108L
block|,
literal|0x02004000L
block|,
literal|0x02000008L
block|, }
block|,
block|{
comment|/* nibble 5 */
literal|0x20000010L
block|,
literal|0x00080010L
block|,
literal|0x00000000L
block|,
literal|0x20080800L
block|,
literal|0x00080010L
block|,
literal|0x00000800L
block|,
literal|0x20000810L
block|,
literal|0x00080000L
block|,
literal|0x00000810L
block|,
literal|0x20080810L
block|,
literal|0x00080800L
block|,
literal|0x20000000L
block|,
literal|0x20000800L
block|,
literal|0x20000010L
block|,
literal|0x20080000L
block|,
literal|0x00080810L
block|,
literal|0x00080000L
block|,
literal|0x20000810L
block|,
literal|0x20080010L
block|,
literal|0x00000000L
block|,
literal|0x00000800L
block|,
literal|0x00000010L
block|,
literal|0x20080800L
block|,
literal|0x20080010L
block|,
literal|0x20080810L
block|,
literal|0x20080000L
block|,
literal|0x20000000L
block|,
literal|0x00000810L
block|,
literal|0x00000010L
block|,
literal|0x00080800L
block|,
literal|0x00080810L
block|,
literal|0x20000800L
block|,
literal|0x00000810L
block|,
literal|0x20000000L
block|,
literal|0x20000800L
block|,
literal|0x00080810L
block|,
literal|0x20080800L
block|,
literal|0x00080010L
block|,
literal|0x00000000L
block|,
literal|0x20000800L
block|,
literal|0x20000000L
block|,
literal|0x00000800L
block|,
literal|0x20080010L
block|,
literal|0x00080000L
block|,
literal|0x00080010L
block|,
literal|0x20080810L
block|,
literal|0x00080800L
block|,
literal|0x00000010L
block|,
literal|0x20080810L
block|,
literal|0x00080800L
block|,
literal|0x00080000L
block|,
literal|0x20000810L
block|,
literal|0x20000010L
block|,
literal|0x20080000L
block|,
literal|0x00080810L
block|,
literal|0x00000000L
block|,
literal|0x00000800L
block|,
literal|0x20000010L
block|,
literal|0x20000810L
block|,
literal|0x20080800L
block|,
literal|0x20080000L
block|,
literal|0x00000810L
block|,
literal|0x00000010L
block|,
literal|0x20080010L
block|, }
block|,
block|{
comment|/* nibble 6 */
literal|0x00001000L
block|,
literal|0x00000080L
block|,
literal|0x00400080L
block|,
literal|0x00400001L
block|,
literal|0x00401081L
block|,
literal|0x00001001L
block|,
literal|0x00001080L
block|,
literal|0x00000000L
block|,
literal|0x00400000L
block|,
literal|0x00400081L
block|,
literal|0x00000081L
block|,
literal|0x00401000L
block|,
literal|0x00000001L
block|,
literal|0x00401080L
block|,
literal|0x00401000L
block|,
literal|0x00000081L
block|,
literal|0x00400081L
block|,
literal|0x00001000L
block|,
literal|0x00001001L
block|,
literal|0x00401081L
block|,
literal|0x00000000L
block|,
literal|0x00400080L
block|,
literal|0x00400001L
block|,
literal|0x00001080L
block|,
literal|0x00401001L
block|,
literal|0x00001081L
block|,
literal|0x00401080L
block|,
literal|0x00000001L
block|,
literal|0x00001081L
block|,
literal|0x00401001L
block|,
literal|0x00000080L
block|,
literal|0x00400000L
block|,
literal|0x00001081L
block|,
literal|0x00401000L
block|,
literal|0x00401001L
block|,
literal|0x00000081L
block|,
literal|0x00001000L
block|,
literal|0x00000080L
block|,
literal|0x00400000L
block|,
literal|0x00401001L
block|,
literal|0x00400081L
block|,
literal|0x00001081L
block|,
literal|0x00001080L
block|,
literal|0x00000000L
block|,
literal|0x00000080L
block|,
literal|0x00400001L
block|,
literal|0x00000001L
block|,
literal|0x00400080L
block|,
literal|0x00000000L
block|,
literal|0x00400081L
block|,
literal|0x00400080L
block|,
literal|0x00001080L
block|,
literal|0x00000081L
block|,
literal|0x00001000L
block|,
literal|0x00401081L
block|,
literal|0x00400000L
block|,
literal|0x00401080L
block|,
literal|0x00000001L
block|,
literal|0x00001001L
block|,
literal|0x00401081L
block|,
literal|0x00400001L
block|,
literal|0x00401080L
block|,
literal|0x00401000L
block|,
literal|0x00001001L
block|, }
block|,
block|{
comment|/* nibble 7 */
literal|0x08200020L
block|,
literal|0x08208000L
block|,
literal|0x00008020L
block|,
literal|0x00000000L
block|,
literal|0x08008000L
block|,
literal|0x00200020L
block|,
literal|0x08200000L
block|,
literal|0x08208020L
block|,
literal|0x00000020L
block|,
literal|0x08000000L
block|,
literal|0x00208000L
block|,
literal|0x00008020L
block|,
literal|0x00208020L
block|,
literal|0x08008020L
block|,
literal|0x08000020L
block|,
literal|0x08200000L
block|,
literal|0x00008000L
block|,
literal|0x00208020L
block|,
literal|0x00200020L
block|,
literal|0x08008000L
block|,
literal|0x08208020L
block|,
literal|0x08000020L
block|,
literal|0x00000000L
block|,
literal|0x00208000L
block|,
literal|0x08000000L
block|,
literal|0x00200000L
block|,
literal|0x08008020L
block|,
literal|0x08200020L
block|,
literal|0x00200000L
block|,
literal|0x00008000L
block|,
literal|0x08208000L
block|,
literal|0x00000020L
block|,
literal|0x00200000L
block|,
literal|0x00008000L
block|,
literal|0x08000020L
block|,
literal|0x08208020L
block|,
literal|0x00008020L
block|,
literal|0x08000000L
block|,
literal|0x00000000L
block|,
literal|0x00208000L
block|,
literal|0x08200020L
block|,
literal|0x08008020L
block|,
literal|0x08008000L
block|,
literal|0x00200020L
block|,
literal|0x08208000L
block|,
literal|0x00000020L
block|,
literal|0x00200020L
block|,
literal|0x08008000L
block|,
literal|0x08208020L
block|,
literal|0x00200000L
block|,
literal|0x08200000L
block|,
literal|0x08000020L
block|,
literal|0x00208000L
block|,
literal|0x00008020L
block|,
literal|0x08008020L
block|,
literal|0x08200000L
block|,
literal|0x00000020L
block|,
literal|0x08208000L
block|,
literal|0x00208020L
block|,
literal|0x00000000L
block|,
literal|0x08000000L
block|,
literal|0x08200020L
block|,
literal|0x00008000L
block|,
literal|0x00208020L
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|DES_LONG
name|skb
index|[
literal|8
index|]
index|[
literal|64
index|]
init|=
block|{
block|{
comment|/* for C bits (numbered as per FIPS 46) 1 2 3 4 5 6 */
literal|0x00000000L
block|,
literal|0x00000010L
block|,
literal|0x20000000L
block|,
literal|0x20000010L
block|,
literal|0x00010000L
block|,
literal|0x00010010L
block|,
literal|0x20010000L
block|,
literal|0x20010010L
block|,
literal|0x00000800L
block|,
literal|0x00000810L
block|,
literal|0x20000800L
block|,
literal|0x20000810L
block|,
literal|0x00010800L
block|,
literal|0x00010810L
block|,
literal|0x20010800L
block|,
literal|0x20010810L
block|,
literal|0x00000020L
block|,
literal|0x00000030L
block|,
literal|0x20000020L
block|,
literal|0x20000030L
block|,
literal|0x00010020L
block|,
literal|0x00010030L
block|,
literal|0x20010020L
block|,
literal|0x20010030L
block|,
literal|0x00000820L
block|,
literal|0x00000830L
block|,
literal|0x20000820L
block|,
literal|0x20000830L
block|,
literal|0x00010820L
block|,
literal|0x00010830L
block|,
literal|0x20010820L
block|,
literal|0x20010830L
block|,
literal|0x00080000L
block|,
literal|0x00080010L
block|,
literal|0x20080000L
block|,
literal|0x20080010L
block|,
literal|0x00090000L
block|,
literal|0x00090010L
block|,
literal|0x20090000L
block|,
literal|0x20090010L
block|,
literal|0x00080800L
block|,
literal|0x00080810L
block|,
literal|0x20080800L
block|,
literal|0x20080810L
block|,
literal|0x00090800L
block|,
literal|0x00090810L
block|,
literal|0x20090800L
block|,
literal|0x20090810L
block|,
literal|0x00080020L
block|,
literal|0x00080030L
block|,
literal|0x20080020L
block|,
literal|0x20080030L
block|,
literal|0x00090020L
block|,
literal|0x00090030L
block|,
literal|0x20090020L
block|,
literal|0x20090030L
block|,
literal|0x00080820L
block|,
literal|0x00080830L
block|,
literal|0x20080820L
block|,
literal|0x20080830L
block|,
literal|0x00090820L
block|,
literal|0x00090830L
block|,
literal|0x20090820L
block|,
literal|0x20090830L
block|, }
block|,
block|{
comment|/* for C bits (numbered as per FIPS 46) 7 8 10 11 12 13 */
literal|0x00000000L
block|,
literal|0x02000000L
block|,
literal|0x00002000L
block|,
literal|0x02002000L
block|,
literal|0x00200000L
block|,
literal|0x02200000L
block|,
literal|0x00202000L
block|,
literal|0x02202000L
block|,
literal|0x00000004L
block|,
literal|0x02000004L
block|,
literal|0x00002004L
block|,
literal|0x02002004L
block|,
literal|0x00200004L
block|,
literal|0x02200004L
block|,
literal|0x00202004L
block|,
literal|0x02202004L
block|,
literal|0x00000400L
block|,
literal|0x02000400L
block|,
literal|0x00002400L
block|,
literal|0x02002400L
block|,
literal|0x00200400L
block|,
literal|0x02200400L
block|,
literal|0x00202400L
block|,
literal|0x02202400L
block|,
literal|0x00000404L
block|,
literal|0x02000404L
block|,
literal|0x00002404L
block|,
literal|0x02002404L
block|,
literal|0x00200404L
block|,
literal|0x02200404L
block|,
literal|0x00202404L
block|,
literal|0x02202404L
block|,
literal|0x10000000L
block|,
literal|0x12000000L
block|,
literal|0x10002000L
block|,
literal|0x12002000L
block|,
literal|0x10200000L
block|,
literal|0x12200000L
block|,
literal|0x10202000L
block|,
literal|0x12202000L
block|,
literal|0x10000004L
block|,
literal|0x12000004L
block|,
literal|0x10002004L
block|,
literal|0x12002004L
block|,
literal|0x10200004L
block|,
literal|0x12200004L
block|,
literal|0x10202004L
block|,
literal|0x12202004L
block|,
literal|0x10000400L
block|,
literal|0x12000400L
block|,
literal|0x10002400L
block|,
literal|0x12002400L
block|,
literal|0x10200400L
block|,
literal|0x12200400L
block|,
literal|0x10202400L
block|,
literal|0x12202400L
block|,
literal|0x10000404L
block|,
literal|0x12000404L
block|,
literal|0x10002404L
block|,
literal|0x12002404L
block|,
literal|0x10200404L
block|,
literal|0x12200404L
block|,
literal|0x10202404L
block|,
literal|0x12202404L
block|, }
block|,
block|{
comment|/* for C bits (numbered as per FIPS 46) 14 15 16 17 19 20 */
literal|0x00000000L
block|,
literal|0x00000001L
block|,
literal|0x00040000L
block|,
literal|0x00040001L
block|,
literal|0x01000000L
block|,
literal|0x01000001L
block|,
literal|0x01040000L
block|,
literal|0x01040001L
block|,
literal|0x00000002L
block|,
literal|0x00000003L
block|,
literal|0x00040002L
block|,
literal|0x00040003L
block|,
literal|0x01000002L
block|,
literal|0x01000003L
block|,
literal|0x01040002L
block|,
literal|0x01040003L
block|,
literal|0x00000200L
block|,
literal|0x00000201L
block|,
literal|0x00040200L
block|,
literal|0x00040201L
block|,
literal|0x01000200L
block|,
literal|0x01000201L
block|,
literal|0x01040200L
block|,
literal|0x01040201L
block|,
literal|0x00000202L
block|,
literal|0x00000203L
block|,
literal|0x00040202L
block|,
literal|0x00040203L
block|,
literal|0x01000202L
block|,
literal|0x01000203L
block|,
literal|0x01040202L
block|,
literal|0x01040203L
block|,
literal|0x08000000L
block|,
literal|0x08000001L
block|,
literal|0x08040000L
block|,
literal|0x08040001L
block|,
literal|0x09000000L
block|,
literal|0x09000001L
block|,
literal|0x09040000L
block|,
literal|0x09040001L
block|,
literal|0x08000002L
block|,
literal|0x08000003L
block|,
literal|0x08040002L
block|,
literal|0x08040003L
block|,
literal|0x09000002L
block|,
literal|0x09000003L
block|,
literal|0x09040002L
block|,
literal|0x09040003L
block|,
literal|0x08000200L
block|,
literal|0x08000201L
block|,
literal|0x08040200L
block|,
literal|0x08040201L
block|,
literal|0x09000200L
block|,
literal|0x09000201L
block|,
literal|0x09040200L
block|,
literal|0x09040201L
block|,
literal|0x08000202L
block|,
literal|0x08000203L
block|,
literal|0x08040202L
block|,
literal|0x08040203L
block|,
literal|0x09000202L
block|,
literal|0x09000203L
block|,
literal|0x09040202L
block|,
literal|0x09040203L
block|, }
block|,
block|{
comment|/* for C bits (numbered as per FIPS 46) 21 23 24 26 27 28 */
literal|0x00000000L
block|,
literal|0x00100000L
block|,
literal|0x00000100L
block|,
literal|0x00100100L
block|,
literal|0x00000008L
block|,
literal|0x00100008L
block|,
literal|0x00000108L
block|,
literal|0x00100108L
block|,
literal|0x00001000L
block|,
literal|0x00101000L
block|,
literal|0x00001100L
block|,
literal|0x00101100L
block|,
literal|0x00001008L
block|,
literal|0x00101008L
block|,
literal|0x00001108L
block|,
literal|0x00101108L
block|,
literal|0x04000000L
block|,
literal|0x04100000L
block|,
literal|0x04000100L
block|,
literal|0x04100100L
block|,
literal|0x04000008L
block|,
literal|0x04100008L
block|,
literal|0x04000108L
block|,
literal|0x04100108L
block|,
literal|0x04001000L
block|,
literal|0x04101000L
block|,
literal|0x04001100L
block|,
literal|0x04101100L
block|,
literal|0x04001008L
block|,
literal|0x04101008L
block|,
literal|0x04001108L
block|,
literal|0x04101108L
block|,
literal|0x00020000L
block|,
literal|0x00120000L
block|,
literal|0x00020100L
block|,
literal|0x00120100L
block|,
literal|0x00020008L
block|,
literal|0x00120008L
block|,
literal|0x00020108L
block|,
literal|0x00120108L
block|,
literal|0x00021000L
block|,
literal|0x00121000L
block|,
literal|0x00021100L
block|,
literal|0x00121100L
block|,
literal|0x00021008L
block|,
literal|0x00121008L
block|,
literal|0x00021108L
block|,
literal|0x00121108L
block|,
literal|0x04020000L
block|,
literal|0x04120000L
block|,
literal|0x04020100L
block|,
literal|0x04120100L
block|,
literal|0x04020008L
block|,
literal|0x04120008L
block|,
literal|0x04020108L
block|,
literal|0x04120108L
block|,
literal|0x04021000L
block|,
literal|0x04121000L
block|,
literal|0x04021100L
block|,
literal|0x04121100L
block|,
literal|0x04021008L
block|,
literal|0x04121008L
block|,
literal|0x04021108L
block|,
literal|0x04121108L
block|, }
block|,
block|{
comment|/* for D bits (numbered as per FIPS 46) 1 2 3 4 5 6 */
literal|0x00000000L
block|,
literal|0x10000000L
block|,
literal|0x00010000L
block|,
literal|0x10010000L
block|,
literal|0x00000004L
block|,
literal|0x10000004L
block|,
literal|0x00010004L
block|,
literal|0x10010004L
block|,
literal|0x20000000L
block|,
literal|0x30000000L
block|,
literal|0x20010000L
block|,
literal|0x30010000L
block|,
literal|0x20000004L
block|,
literal|0x30000004L
block|,
literal|0x20010004L
block|,
literal|0x30010004L
block|,
literal|0x00100000L
block|,
literal|0x10100000L
block|,
literal|0x00110000L
block|,
literal|0x10110000L
block|,
literal|0x00100004L
block|,
literal|0x10100004L
block|,
literal|0x00110004L
block|,
literal|0x10110004L
block|,
literal|0x20100000L
block|,
literal|0x30100000L
block|,
literal|0x20110000L
block|,
literal|0x30110000L
block|,
literal|0x20100004L
block|,
literal|0x30100004L
block|,
literal|0x20110004L
block|,
literal|0x30110004L
block|,
literal|0x00001000L
block|,
literal|0x10001000L
block|,
literal|0x00011000L
block|,
literal|0x10011000L
block|,
literal|0x00001004L
block|,
literal|0x10001004L
block|,
literal|0x00011004L
block|,
literal|0x10011004L
block|,
literal|0x20001000L
block|,
literal|0x30001000L
block|,
literal|0x20011000L
block|,
literal|0x30011000L
block|,
literal|0x20001004L
block|,
literal|0x30001004L
block|,
literal|0x20011004L
block|,
literal|0x30011004L
block|,
literal|0x00101000L
block|,
literal|0x10101000L
block|,
literal|0x00111000L
block|,
literal|0x10111000L
block|,
literal|0x00101004L
block|,
literal|0x10101004L
block|,
literal|0x00111004L
block|,
literal|0x10111004L
block|,
literal|0x20101000L
block|,
literal|0x30101000L
block|,
literal|0x20111000L
block|,
literal|0x30111000L
block|,
literal|0x20101004L
block|,
literal|0x30101004L
block|,
literal|0x20111004L
block|,
literal|0x30111004L
block|, }
block|,
block|{
comment|/* for D bits (numbered as per FIPS 46) 8 9 11 12 13 14 */
literal|0x00000000L
block|,
literal|0x08000000L
block|,
literal|0x00000008L
block|,
literal|0x08000008L
block|,
literal|0x00000400L
block|,
literal|0x08000400L
block|,
literal|0x00000408L
block|,
literal|0x08000408L
block|,
literal|0x00020000L
block|,
literal|0x08020000L
block|,
literal|0x00020008L
block|,
literal|0x08020008L
block|,
literal|0x00020400L
block|,
literal|0x08020400L
block|,
literal|0x00020408L
block|,
literal|0x08020408L
block|,
literal|0x00000001L
block|,
literal|0x08000001L
block|,
literal|0x00000009L
block|,
literal|0x08000009L
block|,
literal|0x00000401L
block|,
literal|0x08000401L
block|,
literal|0x00000409L
block|,
literal|0x08000409L
block|,
literal|0x00020001L
block|,
literal|0x08020001L
block|,
literal|0x00020009L
block|,
literal|0x08020009L
block|,
literal|0x00020401L
block|,
literal|0x08020401L
block|,
literal|0x00020409L
block|,
literal|0x08020409L
block|,
literal|0x02000000L
block|,
literal|0x0A000000L
block|,
literal|0x02000008L
block|,
literal|0x0A000008L
block|,
literal|0x02000400L
block|,
literal|0x0A000400L
block|,
literal|0x02000408L
block|,
literal|0x0A000408L
block|,
literal|0x02020000L
block|,
literal|0x0A020000L
block|,
literal|0x02020008L
block|,
literal|0x0A020008L
block|,
literal|0x02020400L
block|,
literal|0x0A020400L
block|,
literal|0x02020408L
block|,
literal|0x0A020408L
block|,
literal|0x02000001L
block|,
literal|0x0A000001L
block|,
literal|0x02000009L
block|,
literal|0x0A000009L
block|,
literal|0x02000401L
block|,
literal|0x0A000401L
block|,
literal|0x02000409L
block|,
literal|0x0A000409L
block|,
literal|0x02020001L
block|,
literal|0x0A020001L
block|,
literal|0x02020009L
block|,
literal|0x0A020009L
block|,
literal|0x02020401L
block|,
literal|0x0A020401L
block|,
literal|0x02020409L
block|,
literal|0x0A020409L
block|, }
block|,
block|{
comment|/* for D bits (numbered as per FIPS 46) 16 17 18 19 20 21 */
literal|0x00000000L
block|,
literal|0x00000100L
block|,
literal|0x00080000L
block|,
literal|0x00080100L
block|,
literal|0x01000000L
block|,
literal|0x01000100L
block|,
literal|0x01080000L
block|,
literal|0x01080100L
block|,
literal|0x00000010L
block|,
literal|0x00000110L
block|,
literal|0x00080010L
block|,
literal|0x00080110L
block|,
literal|0x01000010L
block|,
literal|0x01000110L
block|,
literal|0x01080010L
block|,
literal|0x01080110L
block|,
literal|0x00200000L
block|,
literal|0x00200100L
block|,
literal|0x00280000L
block|,
literal|0x00280100L
block|,
literal|0x01200000L
block|,
literal|0x01200100L
block|,
literal|0x01280000L
block|,
literal|0x01280100L
block|,
literal|0x00200010L
block|,
literal|0x00200110L
block|,
literal|0x00280010L
block|,
literal|0x00280110L
block|,
literal|0x01200010L
block|,
literal|0x01200110L
block|,
literal|0x01280010L
block|,
literal|0x01280110L
block|,
literal|0x00000200L
block|,
literal|0x00000300L
block|,
literal|0x00080200L
block|,
literal|0x00080300L
block|,
literal|0x01000200L
block|,
literal|0x01000300L
block|,
literal|0x01080200L
block|,
literal|0x01080300L
block|,
literal|0x00000210L
block|,
literal|0x00000310L
block|,
literal|0x00080210L
block|,
literal|0x00080310L
block|,
literal|0x01000210L
block|,
literal|0x01000310L
block|,
literal|0x01080210L
block|,
literal|0x01080310L
block|,
literal|0x00200200L
block|,
literal|0x00200300L
block|,
literal|0x00280200L
block|,
literal|0x00280300L
block|,
literal|0x01200200L
block|,
literal|0x01200300L
block|,
literal|0x01280200L
block|,
literal|0x01280300L
block|,
literal|0x00200210L
block|,
literal|0x00200310L
block|,
literal|0x00280210L
block|,
literal|0x00280310L
block|,
literal|0x01200210L
block|,
literal|0x01200310L
block|,
literal|0x01280210L
block|,
literal|0x01280310L
block|, }
block|,
block|{
comment|/* for D bits (numbered as per FIPS 46) 22 23 24 25 27 28 */
literal|0x00000000L
block|,
literal|0x04000000L
block|,
literal|0x00040000L
block|,
literal|0x04040000L
block|,
literal|0x00000002L
block|,
literal|0x04000002L
block|,
literal|0x00040002L
block|,
literal|0x04040002L
block|,
literal|0x00002000L
block|,
literal|0x04002000L
block|,
literal|0x00042000L
block|,
literal|0x04042000L
block|,
literal|0x00002002L
block|,
literal|0x04002002L
block|,
literal|0x00042002L
block|,
literal|0x04042002L
block|,
literal|0x00000020L
block|,
literal|0x04000020L
block|,
literal|0x00040020L
block|,
literal|0x04040020L
block|,
literal|0x00000022L
block|,
literal|0x04000022L
block|,
literal|0x00040022L
block|,
literal|0x04040022L
block|,
literal|0x00002020L
block|,
literal|0x04002020L
block|,
literal|0x00042020L
block|,
literal|0x04042020L
block|,
literal|0x00002022L
block|,
literal|0x04002022L
block|,
literal|0x00042022L
block|,
literal|0x04042022L
block|,
literal|0x00000800L
block|,
literal|0x04000800L
block|,
literal|0x00040800L
block|,
literal|0x04040800L
block|,
literal|0x00000802L
block|,
literal|0x04000802L
block|,
literal|0x00040802L
block|,
literal|0x04040802L
block|,
literal|0x00002800L
block|,
literal|0x04002800L
block|,
literal|0x00042800L
block|,
literal|0x04042800L
block|,
literal|0x00002802L
block|,
literal|0x04002802L
block|,
literal|0x00042802L
block|,
literal|0x04042802L
block|,
literal|0x00000820L
block|,
literal|0x04000820L
block|,
literal|0x00040820L
block|,
literal|0x04040820L
block|,
literal|0x00000822L
block|,
literal|0x04000822L
block|,
literal|0x00040822L
block|,
literal|0x04040822L
block|,
literal|0x00002820L
block|,
literal|0x04002820L
block|,
literal|0x00042820L
block|,
literal|0x04042820L
block|,
literal|0x00002822L
block|,
literal|0x04002822L
block|,
literal|0x00042822L
block|,
literal|0x04042822L
block|, }
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* See ecb_encrypt.c for a pseudo description of these macros. */
end_comment

begin_define
define|#
directive|define
name|PERM_OP
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|t
parameter_list|,
name|n
parameter_list|,
name|m
parameter_list|)
value|((t)=((((a)>>(n))^(b))&(m)),\ 	(b)^=(t),\ 	(a)^=((t)<<(n)))
end_define

begin_define
define|#
directive|define
name|HPERM_OP
parameter_list|(
name|a
parameter_list|,
name|t
parameter_list|,
name|n
parameter_list|,
name|m
parameter_list|)
value|((t)=((((a)<<(16-(n)))^(a))&(m)),\ 	(a)=(a)^(t)^(t>>(16-(n))))\  #endif
end_define

begin_ifndef
ifndef|#
directive|ifndef
name|NOPROTO
end_ifndef

begin_function_decl
specifier|static
name|int
name|body
parameter_list|(
name|DES_LONG
modifier|*
name|out0
parameter_list|,
name|DES_LONG
modifier|*
name|out1
parameter_list|,
name|des_key_schedule
name|ks
parameter_list|,
name|DES_LONG
name|Eswap0
parameter_list|,
name|DES_LONG
name|Eswap1
parameter_list|)
function_decl|;
end_function_decl

begin_ifndef
ifndef|#
directive|ifndef
name|HEADER_DES_LOCL_H
end_ifndef

begin_decl_stmt
specifier|static
name|int
name|fcrypt_set_key
argument_list|(
name|des_cblock
argument_list|(
operator|*
name|key
argument_list|)
argument_list|,
name|des_key_schedule
name|schedule
argument_list|)
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_else
else|#
directive|else
end_else

begin_function_decl
specifier|static
name|int
name|body
parameter_list|()
function_decl|;
end_function_decl

begin_ifndef
ifndef|#
directive|ifndef
name|HEADER_DES_LOCL_H
end_ifndef

begin_function_decl
specifier|static
name|int
name|fcrypt_set_key
parameter_list|()
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_ifdef
ifdef|#
directive|ifdef
name|HEADER_DES_LOCL_H
end_ifdef

begin_define
define|#
directive|define
name|fcrypt_set_key
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|des_set_key(a,b)
end_define

begin_else
else|#
directive|else
end_else

begin_function_decl
specifier|static
name|int
name|fcrypt_set_key
parameter_list|(
name|key
parameter_list|,
name|schedule
parameter_list|)
function_decl|des_cblock
parameter_list|(
function_decl|*key
end_function_decl

begin_empty_stmt
unit|)
empty_stmt|;
end_empty_stmt

begin_decl_stmt
name|des_key_schedule
name|schedule
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|static
specifier|const
name|int
name|shifts2
index|[
literal|16
index|]
init|=
block|{
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|}
decl_stmt|;
specifier|register
name|DES_LONG
name|c
decl_stmt|,
name|d
decl_stmt|,
name|t
decl_stmt|,
name|s
decl_stmt|;
specifier|register
name|unsigned
name|char
modifier|*
name|in
decl_stmt|;
specifier|register
name|DES_LONG
modifier|*
name|k
decl_stmt|;
specifier|register
name|int
name|i
decl_stmt|;
name|k
operator|=
operator|(
name|DES_LONG
operator|*
operator|)
name|schedule
expr_stmt|;
name|in
operator|=
operator|(
name|unsigned
name|char
operator|*
operator|)
name|key
expr_stmt|;
name|c2l
argument_list|(
name|in
argument_list|,
name|c
argument_list|)
expr_stmt|;
name|c2l
argument_list|(
name|in
argument_list|,
name|d
argument_list|)
expr_stmt|;
comment|/* I now do it in 47 simple operations :-) 	 * Thanks to John Fletcher (john_fletcher@lccmail.ocf.llnl.gov) 	 * for the inspiration. :-) */
name|PERM_OP
argument_list|(
name|d
argument_list|,
name|c
argument_list|,
name|t
argument_list|,
literal|4
argument_list|,
literal|0x0f0f0f0fL
argument_list|)
expr_stmt|;
name|HPERM_OP
argument_list|(
name|c
argument_list|,
name|t
argument_list|,
operator|-
literal|2
argument_list|,
literal|0xcccc0000L
argument_list|)
expr_stmt|;
name|HPERM_OP
argument_list|(
name|d
argument_list|,
name|t
argument_list|,
operator|-
literal|2
argument_list|,
literal|0xcccc0000L
argument_list|)
expr_stmt|;
name|PERM_OP
argument_list|(
name|d
argument_list|,
name|c
argument_list|,
name|t
argument_list|,
literal|1
argument_list|,
literal|0x55555555L
argument_list|)
expr_stmt|;
name|PERM_OP
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|t
argument_list|,
literal|8
argument_list|,
literal|0x00ff00ffL
argument_list|)
expr_stmt|;
name|PERM_OP
argument_list|(
name|d
argument_list|,
name|c
argument_list|,
name|t
argument_list|,
literal|1
argument_list|,
literal|0x55555555L
argument_list|)
expr_stmt|;
name|d
operator|=
operator|(
operator|(
operator|(
name|d
operator|&
literal|0x000000ffL
operator|)
operator|<<
literal|16
operator|)
operator||
operator|(
name|d
operator|&
literal|0x0000ff00L
operator|)
operator||
operator|(
operator|(
name|d
operator|&
literal|0x00ff0000L
operator|)
operator|>>
literal|16
operator|)
operator||
operator|(
operator|(
name|c
operator|&
literal|0xf0000000L
operator|)
operator|>>
literal|4
operator|)
operator|)
expr_stmt|;
name|c
operator|&=
literal|0x0fffffffL
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ITERATIONS
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|shifts2
index|[
name|i
index|]
condition|)
block|{
name|c
operator|=
operator|(
operator|(
name|c
operator|>>
literal|2
operator|)
operator||
operator|(
name|c
operator|<<
literal|26
operator|)
operator|)
expr_stmt|;
name|d
operator|=
operator|(
operator|(
name|d
operator|>>
literal|2
operator|)
operator||
operator|(
name|d
operator|<<
literal|26
operator|)
operator|)
expr_stmt|;
block|}
else|else
block|{
name|c
operator|=
operator|(
operator|(
name|c
operator|>>
literal|1
operator|)
operator||
operator|(
name|c
operator|<<
literal|27
operator|)
operator|)
expr_stmt|;
name|d
operator|=
operator|(
operator|(
name|d
operator|>>
literal|1
operator|)
operator||
operator|(
name|d
operator|<<
literal|27
operator|)
operator|)
expr_stmt|;
block|}
name|c
operator|&=
literal|0x0fffffffL
expr_stmt|;
name|d
operator|&=
literal|0x0fffffffL
expr_stmt|;
comment|/* could be a few less shifts but I am to lazy at this 		 * point in time to investigate */
name|s
operator|=
name|skb
index|[
literal|0
index|]
index|[
operator|(
name|c
operator|)
operator|&
literal|0x3f
index|]
operator||
name|skb
index|[
literal|1
index|]
index|[
operator|(
operator|(
name|c
operator|>>
literal|6L
operator|)
operator|&
literal|0x03
operator|)
operator||
operator|(
operator|(
name|c
operator|>>
literal|7L
operator|)
operator|&
literal|0x3c
operator|)
index|]
operator||
name|skb
index|[
literal|2
index|]
index|[
operator|(
operator|(
name|c
operator|>>
literal|13L
operator|)
operator|&
literal|0x0f
operator|)
operator||
operator|(
operator|(
name|c
operator|>>
literal|14L
operator|)
operator|&
literal|0x30
operator|)
index|]
operator||
name|skb
index|[
literal|3
index|]
index|[
operator|(
operator|(
name|c
operator|>>
literal|20L
operator|)
operator|&
literal|0x01
operator|)
operator||
operator|(
operator|(
name|c
operator|>>
literal|21L
operator|)
operator|&
literal|0x06
operator|)
operator||
operator|(
operator|(
name|c
operator|>>
literal|22L
operator|)
operator|&
literal|0x38
operator|)
index|]
expr_stmt|;
name|t
operator|=
name|skb
index|[
literal|4
index|]
index|[
operator|(
name|d
operator|)
operator|&
literal|0x3f
index|]
operator||
name|skb
index|[
literal|5
index|]
index|[
operator|(
operator|(
name|d
operator|>>
literal|7L
operator|)
operator|&
literal|0x03
operator|)
operator||
operator|(
operator|(
name|d
operator|>>
literal|8L
operator|)
operator|&
literal|0x3c
operator|)
index|]
operator||
name|skb
index|[
literal|6
index|]
index|[
operator|(
name|d
operator|>>
literal|15L
operator|)
operator|&
literal|0x3f
index|]
operator||
name|skb
index|[
literal|7
index|]
index|[
operator|(
operator|(
name|d
operator|>>
literal|21L
operator|)
operator|&
literal|0x0f
operator|)
operator||
operator|(
operator|(
name|d
operator|>>
literal|22L
operator|)
operator|&
literal|0x30
operator|)
index|]
expr_stmt|;
comment|/* table contained 0213 4657 */
operator|*
operator|(
name|k
operator|++
operator|)
operator|=
operator|(
operator|(
name|t
operator|<<
literal|16
operator|)
operator||
operator|(
name|s
operator|&
literal|0x0000ffffL
operator|)
operator|)
operator|&
literal|0xffffffffL
expr_stmt|;
name|s
operator|=
operator|(
operator|(
name|s
operator|>>
literal|16
operator|)
operator||
operator|(
name|t
operator|&
literal|0xffff0000L
operator|)
operator|)
expr_stmt|;
name|s
operator|=
operator|(
name|s
operator|<<
literal|4
operator|)
operator||
operator|(
name|s
operator|>>
literal|28
operator|)
expr_stmt|;
operator|*
operator|(
name|k
operator|++
operator|)
operator|=
name|s
operator|&
literal|0xffffffffL
expr_stmt|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_block

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/******************************************************************  * modified stuff for crypt.  ******************************************************************/
end_comment

begin_comment
comment|/* The changes to this macro may help or hinder, depending on the  * compiler and the achitecture.  gcc2 always seems to do well :-).   * Inspired by Dana How<how@isl.stanford.edu>  * DO NOT use the alternative version on machines with 8 byte longs.  */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|DES_PTR
end_ifdef

begin_define
define|#
directive|define
name|CR_ENCRYPT
parameter_list|(
name|L
parameter_list|,
name|R
parameter_list|,
name|S
parameter_list|)
define|\
value|t=(R^(R>>16)); \ 	u=(t&E0); \ 	t=(t&E1); \ 	u=((u^(u<<16))^R^s[S  ])<<2; \ 	t=(t^(t<<16))^R^s[S+1]; \ 	t=(t>>2)|(t<<30); \ 	L^= \ 	*(DES_LONG *)((unsigned char *)des_SP+0x0100+((t    )&0xfc))+ \ 	*(DES_LONG *)((unsigned char *)des_SP+0x0300+((t>> 8)&0xfc))+ \ 	*(DES_LONG *)((unsigned char *)des_SP+0x0500+((t>>16)&0xfc))+ \ 	*(DES_LONG *)((unsigned char *)des_SP+0x0700+((t>>24)&0xfc))+ \ 	*(DES_LONG *)((unsigned char *)des_SP+       ((u    )&0xfc))+ \   	*(DES_LONG *)((unsigned char *)des_SP+0x0200+((u>> 8)&0xfc))+ \   	*(DES_LONG *)((unsigned char *)des_SP+0x0400+((u>>16)&0xfc))+ \  	*(DES_LONG *)((unsigned char *)des_SP+0x0600+((u>>24)&0xfc));
end_define

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* original version */
end_comment

begin_define
define|#
directive|define
name|CR_ENCRYPT
parameter_list|(
name|L
parameter_list|,
name|R
parameter_list|,
name|S
parameter_list|)
define|\
value|t=(R^(R>>16)); \ 	u=(t&E0); \ 	t=(t&E1); \ 	u=(u^(u<<16))^R^s[S  ]; \ 	t=(t^(t<<16))^R^s[S+1]; \ 	t=(t>>4)|(t<<28); \ 	L^=	des_SPtrans[1][(t    )&0x3f]| \ 		des_SPtrans[3][(t>> 8)&0x3f]| \ 		des_SPtrans[5][(t>>16)&0x3f]| \ 		des_SPtrans[7][(t>>24)&0x3f]| \ 		des_SPtrans[0][(u    )&0x3f]| \ 		des_SPtrans[2][(u>> 8)&0x3f]| \ 		des_SPtrans[4][(u>>16)&0x3f]| \ 		des_SPtrans[6][(u>>24)&0x3f];
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* Added more values to handle illegal salt values the way normal  * crypt() implementations do.  The patch was sent by   * Bjorn Gronvall<bg@sics.se>  */
end_comment

begin_decl_stmt
specifier|static
name|unsigned
specifier|const
name|char
name|con_salt
index|[
literal|128
index|]
init|=
block|{
literal|0xD2
block|,
literal|0xD3
block|,
literal|0xD4
block|,
literal|0xD5
block|,
literal|0xD6
block|,
literal|0xD7
block|,
literal|0xD8
block|,
literal|0xD9
block|,
literal|0xDA
block|,
literal|0xDB
block|,
literal|0xDC
block|,
literal|0xDD
block|,
literal|0xDE
block|,
literal|0xDF
block|,
literal|0xE0
block|,
literal|0xE1
block|,
literal|0xE2
block|,
literal|0xE3
block|,
literal|0xE4
block|,
literal|0xE5
block|,
literal|0xE6
block|,
literal|0xE7
block|,
literal|0xE8
block|,
literal|0xE9
block|,
literal|0xEA
block|,
literal|0xEB
block|,
literal|0xEC
block|,
literal|0xED
block|,
literal|0xEE
block|,
literal|0xEF
block|,
literal|0xF0
block|,
literal|0xF1
block|,
literal|0xF2
block|,
literal|0xF3
block|,
literal|0xF4
block|,
literal|0xF5
block|,
literal|0xF6
block|,
literal|0xF7
block|,
literal|0xF8
block|,
literal|0xF9
block|,
literal|0xFA
block|,
literal|0xFB
block|,
literal|0xFC
block|,
literal|0xFD
block|,
literal|0xFE
block|,
literal|0xFF
block|,
literal|0x00
block|,
literal|0x01
block|,
literal|0x02
block|,
literal|0x03
block|,
literal|0x04
block|,
literal|0x05
block|,
literal|0x06
block|,
literal|0x07
block|,
literal|0x08
block|,
literal|0x09
block|,
literal|0x0A
block|,
literal|0x0B
block|,
literal|0x05
block|,
literal|0x06
block|,
literal|0x07
block|,
literal|0x08
block|,
literal|0x09
block|,
literal|0x0A
block|,
literal|0x0B
block|,
literal|0x0C
block|,
literal|0x0D
block|,
literal|0x0E
block|,
literal|0x0F
block|,
literal|0x10
block|,
literal|0x11
block|,
literal|0x12
block|,
literal|0x13
block|,
literal|0x14
block|,
literal|0x15
block|,
literal|0x16
block|,
literal|0x17
block|,
literal|0x18
block|,
literal|0x19
block|,
literal|0x1A
block|,
literal|0x1B
block|,
literal|0x1C
block|,
literal|0x1D
block|,
literal|0x1E
block|,
literal|0x1F
block|,
literal|0x20
block|,
literal|0x21
block|,
literal|0x22
block|,
literal|0x23
block|,
literal|0x24
block|,
literal|0x25
block|,
literal|0x20
block|,
literal|0x21
block|,
literal|0x22
block|,
literal|0x23
block|,
literal|0x24
block|,
literal|0x25
block|,
literal|0x26
block|,
literal|0x27
block|,
literal|0x28
block|,
literal|0x29
block|,
literal|0x2A
block|,
literal|0x2B
block|,
literal|0x2C
block|,
literal|0x2D
block|,
literal|0x2E
block|,
literal|0x2F
block|,
literal|0x30
block|,
literal|0x31
block|,
literal|0x32
block|,
literal|0x33
block|,
literal|0x34
block|,
literal|0x35
block|,
literal|0x36
block|,
literal|0x37
block|,
literal|0x38
block|,
literal|0x39
block|,
literal|0x3A
block|,
literal|0x3B
block|,
literal|0x3C
block|,
literal|0x3D
block|,
literal|0x3E
block|,
literal|0x3F
block|,
literal|0x40
block|,
literal|0x41
block|,
literal|0x42
block|,
literal|0x43
block|,
literal|0x44
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|unsigned
specifier|const
name|char
name|cov_2char
index|[
literal|64
index|]
init|=
block|{
literal|0x2E
block|,
literal|0x2F
block|,
literal|0x30
block|,
literal|0x31
block|,
literal|0x32
block|,
literal|0x33
block|,
literal|0x34
block|,
literal|0x35
block|,
literal|0x36
block|,
literal|0x37
block|,
literal|0x38
block|,
literal|0x39
block|,
literal|0x41
block|,
literal|0x42
block|,
literal|0x43
block|,
literal|0x44
block|,
literal|0x45
block|,
literal|0x46
block|,
literal|0x47
block|,
literal|0x48
block|,
literal|0x49
block|,
literal|0x4A
block|,
literal|0x4B
block|,
literal|0x4C
block|,
literal|0x4D
block|,
literal|0x4E
block|,
literal|0x4F
block|,
literal|0x50
block|,
literal|0x51
block|,
literal|0x52
block|,
literal|0x53
block|,
literal|0x54
block|,
literal|0x55
block|,
literal|0x56
block|,
literal|0x57
block|,
literal|0x58
block|,
literal|0x59
block|,
literal|0x5A
block|,
literal|0x61
block|,
literal|0x62
block|,
literal|0x63
block|,
literal|0x64
block|,
literal|0x65
block|,
literal|0x66
block|,
literal|0x67
block|,
literal|0x68
block|,
literal|0x69
block|,
literal|0x6A
block|,
literal|0x6B
block|,
literal|0x6C
block|,
literal|0x6D
block|,
literal|0x6E
block|,
literal|0x6F
block|,
literal|0x70
block|,
literal|0x71
block|,
literal|0x72
block|,
literal|0x73
block|,
literal|0x74
block|,
literal|0x75
block|,
literal|0x76
block|,
literal|0x77
block|,
literal|0x78
block|,
literal|0x79
block|,
literal|0x7A
block|}
decl_stmt|;
end_decl_stmt

begin_ifndef
ifndef|#
directive|ifndef
name|NOPROTO
end_ifndef

begin_ifdef
ifdef|#
directive|ifdef
name|PERL5
end_ifdef

begin_function_decl
name|char
modifier|*
name|des_crypt
parameter_list|(
name|char
modifier|*
name|buf
parameter_list|,
name|char
modifier|*
name|salt
parameter_list|)
function_decl|;
end_function_decl

begin_else
else|#
directive|else
end_else

begin_function_decl
name|char
modifier|*
name|crypt
parameter_list|(
specifier|const
name|char
modifier|*
name|buf
parameter_list|,
specifier|const
name|char
modifier|*
name|salt
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_else
else|#
directive|else
end_else

begin_ifdef
ifdef|#
directive|ifdef
name|PERL5
end_ifdef

begin_function_decl
name|char
modifier|*
name|des_crypt
parameter_list|()
function_decl|;
end_function_decl

begin_else
else|#
directive|else
end_else

begin_function_decl
name|char
modifier|*
name|crypt
parameter_list|()
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_ifdef
ifdef|#
directive|ifdef
name|PERL5
end_ifdef

begin_decl_stmt
name|char
modifier|*
name|des_crypt
argument_list|(
name|buf
argument_list|,
name|salt
argument_list|)
else|#
directive|else
name|char
modifier|*
name|crypt
argument_list|(
name|buf
argument_list|,
name|salt
argument_list|)
endif|#
directive|endif
decl|const
name|char
modifier|*
name|buf
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
name|salt
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|unsigned
name|int
name|i
decl_stmt|,
name|j
decl_stmt|,
name|x
decl_stmt|,
name|y
decl_stmt|;
name|DES_LONG
name|Eswap0
decl_stmt|,
name|Eswap1
decl_stmt|;
name|DES_LONG
name|out
index|[
literal|2
index|]
decl_stmt|,
name|ll
decl_stmt|;
name|des_cblock
name|key
decl_stmt|;
name|des_key_schedule
name|ks
decl_stmt|;
specifier|static
name|unsigned
name|char
name|buff
index|[
literal|20
index|]
decl_stmt|;
name|unsigned
name|char
name|bb
index|[
literal|9
index|]
decl_stmt|;
name|unsigned
name|char
modifier|*
name|b
init|=
name|bb
decl_stmt|;
name|unsigned
name|char
name|c
decl_stmt|,
name|u
decl_stmt|;
comment|/* eay 25/08/92 	 * If you call crypt("pwd","*") as often happens when you 	 * have * as the pwd field in /etc/passwd, the function 	 * returns *\0XXXXXXXXX 	 * The \0 makes the string look like * so the pwd "*" would 	 * crypt to "*".  This was found when replacing the crypt in 	 * our shared libraries.  People found that the disbled 	 * accounts effectivly had no passwd :-(. */
name|x
operator|=
name|buff
index|[
literal|0
index|]
operator|=
operator|(
operator|(
name|salt
index|[
literal|0
index|]
operator|==
literal|'\0'
operator|)
condition|?
literal|'A'
else|:
name|salt
index|[
literal|0
index|]
operator|)
expr_stmt|;
name|Eswap0
operator|=
name|con_salt
index|[
name|x
index|]
expr_stmt|;
name|x
operator|=
name|buff
index|[
literal|1
index|]
operator|=
operator|(
operator|(
name|salt
index|[
literal|1
index|]
operator|==
literal|'\0'
operator|)
condition|?
literal|'A'
else|:
name|salt
index|[
literal|1
index|]
operator|)
expr_stmt|;
name|Eswap1
operator|=
name|con_salt
index|[
name|x
index|]
operator|<<
literal|4
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|8
condition|;
name|i
operator|++
control|)
block|{
name|c
operator|=
operator|*
operator|(
name|buf
operator|++
operator|)
expr_stmt|;
if|if
condition|(
operator|!
name|c
condition|)
break|break;
name|key
index|[
name|i
index|]
operator|=
operator|(
name|c
operator|<<
literal|1
operator|)
expr_stmt|;
block|}
for|for
control|(
init|;
name|i
operator|<
literal|8
condition|;
name|i
operator|++
control|)
name|key
index|[
name|i
index|]
operator|=
literal|0
expr_stmt|;
name|fcrypt_set_key
argument_list|(
operator|(
name|des_cblock
operator|*
operator|)
operator|(
name|key
operator|)
argument_list|,
name|ks
argument_list|)
expr_stmt|;
name|body
argument_list|(
operator|&
operator|(
name|out
index|[
literal|0
index|]
operator|)
argument_list|,
operator|&
operator|(
name|out
index|[
literal|1
index|]
operator|)
argument_list|,
name|ks
argument_list|,
name|Eswap0
argument_list|,
name|Eswap1
argument_list|)
expr_stmt|;
name|ll
operator|=
name|out
index|[
literal|0
index|]
expr_stmt|;
name|l2c
argument_list|(
name|ll
argument_list|,
name|b
argument_list|)
expr_stmt|;
name|ll
operator|=
name|out
index|[
literal|1
index|]
expr_stmt|;
name|l2c
argument_list|(
name|ll
argument_list|,
name|b
argument_list|)
expr_stmt|;
name|y
operator|=
literal|0
expr_stmt|;
name|u
operator|=
literal|0x80
expr_stmt|;
name|bb
index|[
literal|8
index|]
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|2
init|;
name|i
operator|<
literal|13
condition|;
name|i
operator|++
control|)
block|{
name|c
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|6
condition|;
name|j
operator|++
control|)
block|{
name|c
operator|<<=
literal|1
expr_stmt|;
if|if
condition|(
name|bb
index|[
name|y
index|]
operator|&
name|u
condition|)
name|c
operator||=
literal|1
expr_stmt|;
name|u
operator|>>=
literal|1
expr_stmt|;
if|if
condition|(
operator|!
name|u
condition|)
block|{
name|y
operator|++
expr_stmt|;
name|u
operator|=
literal|0x80
expr_stmt|;
block|}
block|}
name|buff
index|[
name|i
index|]
operator|=
name|cov_2char
index|[
name|c
index|]
expr_stmt|;
block|}
name|buff
index|[
literal|13
index|]
operator|=
literal|'\0'
expr_stmt|;
return|return
operator|(
operator|(
name|char
operator|*
operator|)
name|buff
operator|)
return|;
block|}
end_block

begin_function
specifier|static
name|int
name|body
parameter_list|(
name|out0
parameter_list|,
name|out1
parameter_list|,
name|ks
parameter_list|,
name|Eswap0
parameter_list|,
name|Eswap1
parameter_list|)
name|DES_LONG
modifier|*
name|out0
decl_stmt|;
name|DES_LONG
modifier|*
name|out1
decl_stmt|;
name|des_key_schedule
name|ks
decl_stmt|;
name|DES_LONG
name|Eswap0
decl_stmt|;
name|DES_LONG
name|Eswap1
decl_stmt|;
block|{
specifier|register
name|DES_LONG
name|l
decl_stmt|,
name|r
decl_stmt|,
name|t
decl_stmt|,
name|u
decl_stmt|;
ifdef|#
directive|ifdef
name|DES_PTR
specifier|register
name|unsigned
name|char
modifier|*
name|des_SP
init|=
operator|(
name|unsigned
name|char
operator|*
operator|)
name|des_SPtrans
decl_stmt|;
endif|#
directive|endif
specifier|register
name|DES_LONG
modifier|*
name|s
decl_stmt|;
specifier|register
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
specifier|register
name|DES_LONG
name|E0
decl_stmt|,
name|E1
decl_stmt|;
name|l
operator|=
literal|0
expr_stmt|;
name|r
operator|=
literal|0
expr_stmt|;
name|s
operator|=
operator|(
name|DES_LONG
operator|*
operator|)
name|ks
expr_stmt|;
name|E0
operator|=
name|Eswap0
expr_stmt|;
name|E1
operator|=
name|Eswap1
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|25
condition|;
name|j
operator|++
control|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
operator|(
name|ITERATIONS
operator|*
literal|2
operator|)
condition|;
name|i
operator|+=
literal|4
control|)
block|{
name|CR_ENCRYPT
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
name|i
argument_list|)
expr_stmt|;
comment|/*  1 */
name|CR_ENCRYPT
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
name|i
operator|+
literal|2
argument_list|)
expr_stmt|;
comment|/*  2 */
block|}
name|t
operator|=
name|l
expr_stmt|;
name|l
operator|=
name|r
expr_stmt|;
name|r
operator|=
name|t
expr_stmt|;
block|}
name|t
operator|=
name|r
expr_stmt|;
name|r
operator|=
operator|(
name|l
operator|>>
literal|1L
operator|)
operator||
operator|(
name|l
operator|<<
literal|31L
operator|)
expr_stmt|;
name|l
operator|=
operator|(
name|t
operator|>>
literal|1L
operator|)
operator||
operator|(
name|t
operator|<<
literal|31L
operator|)
expr_stmt|;
comment|/* clear the top bits on machines with 8byte longs */
name|l
operator|&=
literal|0xffffffffL
expr_stmt|;
name|r
operator|&=
literal|0xffffffffL
expr_stmt|;
name|PERM_OP
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
name|t
argument_list|,
literal|1
argument_list|,
literal|0x55555555L
argument_list|)
expr_stmt|;
name|PERM_OP
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
name|t
argument_list|,
literal|8
argument_list|,
literal|0x00ff00ffL
argument_list|)
expr_stmt|;
name|PERM_OP
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
name|t
argument_list|,
literal|2
argument_list|,
literal|0x33333333L
argument_list|)
expr_stmt|;
name|PERM_OP
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
name|t
argument_list|,
literal|16
argument_list|,
literal|0x0000ffffL
argument_list|)
expr_stmt|;
name|PERM_OP
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
name|t
argument_list|,
literal|4
argument_list|,
literal|0x0f0f0f0fL
argument_list|)
expr_stmt|;
operator|*
name|out0
operator|=
name|l
expr_stmt|;
operator|*
name|out1
operator|=
name|r
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

end_unit

