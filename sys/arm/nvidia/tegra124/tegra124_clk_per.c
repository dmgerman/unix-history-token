begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2016 Michal Meloun<mmel@FreeBSD.org>  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<sys/systm.h>
end_include

begin_include
include|#
directive|include
file|<sys/bus.h>
end_include

begin_include
include|#
directive|include
file|<sys/lock.h>
end_include

begin_include
include|#
directive|include
file|<sys/mutex.h>
end_include

begin_include
include|#
directive|include
file|<sys/rman.h>
end_include

begin_include
include|#
directive|include
file|<machine/bus.h>
end_include

begin_include
include|#
directive|include
file|<dev/extres/clk/clk.h>
end_include

begin_include
include|#
directive|include
file|<gnu/dts/include/dt-bindings/clock/tegra124-car.h>
end_include

begin_include
include|#
directive|include
file|"tegra124_car.h"
end_include

begin_comment
comment|/* The TEGRA124_CLK_XUSB_GATE is missing in current  * DT bindings, define it localy  */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|TEGRA124_CLK_XUSB_GATE
end_ifdef

begin_error
error|#
directive|error
literal|"TEGRA124_CLK_XUSB_GATE is now defined, revisit XUSB code!"
end_error

begin_else
else|#
directive|else
end_else

begin_define
define|#
directive|define
name|TEGRA124_CLK_XUSB_GATE
value|143
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* Bits in base register. */
end_comment

begin_define
define|#
directive|define
name|PERLCK_AMUX_MASK
value|0x0F
end_define

begin_define
define|#
directive|define
name|PERLCK_AMUX_SHIFT
value|16
end_define

begin_define
define|#
directive|define
name|PERLCK_AMUX_DIS
value|(1<< 20)
end_define

begin_define
define|#
directive|define
name|PERLCK_UDIV_DIS
value|(1<< 24)
end_define

begin_define
define|#
directive|define
name|PERLCK_ENA_MASK
value|(1<< 28)
end_define

begin_define
define|#
directive|define
name|PERLCK_MUX_SHIFT
value|29
end_define

begin_define
define|#
directive|define
name|PERLCK_MUX_MASK
value|0x07
end_define

begin_struct
struct|struct
name|periph_def
block|{
name|struct
name|clknode_init_def
name|clkdef
decl_stmt|;
name|uint32_t
name|base_reg
decl_stmt|;
name|uint32_t
name|div_width
decl_stmt|;
name|uint32_t
name|div_mask
decl_stmt|;
name|uint32_t
name|div_f_width
decl_stmt|;
name|uint32_t
name|div_f_mask
decl_stmt|;
name|uint32_t
name|flags
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|pgate_def
block|{
name|struct
name|clknode_init_def
name|clkdef
decl_stmt|;
name|uint32_t
name|idx
decl_stmt|;
name|uint32_t
name|flags
decl_stmt|;
block|}
struct|;
end_struct

begin_define
define|#
directive|define
name|PLIST
parameter_list|(
name|x
parameter_list|)
value|static const char *x[]
end_define

begin_define
define|#
directive|define
name|GATE
parameter_list|(
name|_id
parameter_list|,
name|cname
parameter_list|,
name|plist
parameter_list|,
name|_idx
parameter_list|)
define|\
value|{									\ 	.clkdef.id = TEGRA124_CLK_##_id,				\ 	.clkdef.name = cname,						\ 	.clkdef.parent_names = (const char *[]){plist},			\ 	.clkdef.parent_cnt = 1,						\ 	.clkdef.flags = CLK_NODE_STATIC_STRINGS,			\ 	.idx = _idx,							\ 	.flags = 0,							\ }
end_define

begin_comment
comment|/* Sources for multiplexors. */
end_comment

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_a_N_audio_N_p_N_clkm
argument_list|)
operator|=
block|{
literal|"pllA_out0"
block|,
name|NULL
block|,
literal|"audio"
block|,
name|NULL
block|,
literal|"pllP_out0"
block|,
name|NULL
block|,
literal|"clk_m"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_a_N_audio0_N_p_N_clkm
argument_list|)
operator|=
block|{
literal|"pllA_out0"
block|,
name|NULL
block|,
literal|"audio0"
block|,
name|NULL
block|,
literal|"pllP_out0"
block|,
name|NULL
block|,
literal|"clk_m"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_a_N_audio1_N_p_N_clkm
argument_list|)
operator|=
block|{
literal|"pllA_out0"
block|,
name|NULL
block|,
literal|"audio1"
block|,
name|NULL
block|,
literal|"pllP_out0"
block|,
name|NULL
block|,
literal|"clk_m"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_a_N_audio2_N_p_N_clkm
argument_list|)
operator|=
block|{
literal|"pllA_out0"
block|,
name|NULL
block|,
literal|"audio2"
block|,
name|NULL
block|,
literal|"pllP_out0"
block|,
name|NULL
block|,
literal|"clk_m"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_a_N_audio3_N_p_N_clkm
argument_list|)
operator|=
block|{
literal|"pllA_out0"
block|,
name|NULL
block|,
literal|"audio3"
block|,
name|NULL
block|,
literal|"pllP_out0"
block|,
name|NULL
block|,
literal|"clk_m"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_a_N_audio4_N_p_N_clkm
argument_list|)
operator|=
block|{
literal|"pllA_out0"
block|,
name|NULL
block|,
literal|"audio4"
block|,
name|NULL
block|,
literal|"pllP_out0"
block|,
name|NULL
block|,
literal|"clk_m"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_a_clks_p_clkm_e
argument_list|)
operator|=
block|{
literal|"pllA_out0"
block|,
literal|"clk_s"
block|,
literal|"pllP_out0"
block|,
literal|"clk_m"
block|,
literal|"pllE_out0"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_a_c2_c_c3_p_N_clkm
argument_list|)
operator|=
block|{
literal|"pllA_out0"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllC3_out0"
block|,
literal|"pllP_out0"
block|,
name|NULL
block|,
literal|"clk_m"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_m_c_p_a_c2_c3
argument_list|)
operator|=
block|{
literal|"pllM_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllP_out0"
block|,
literal|"pllA_out0"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC3_out0"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_m_c_p_a_c2_c3_clkm
argument_list|)
operator|=
block|{
literal|"pllM_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllP_out0"
block|,
literal|"pllA_out0"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC3_out0"
block|,
literal|"clk_m"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_m_c_p_a_c2_c3_clkm_c4
argument_list|)
operator|=
block|{
literal|"pllM_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllP_out0"
block|,
literal|"pllA_out0"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC3_out0"
block|,
literal|"clk_m"
block|,
literal|"pllC4_out0"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_m_c_p_clkm_mud_c2_c3
argument_list|)
operator|=
block|{
literal|"pllM_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllP_out0"
block|,
literal|"clk_m"
block|,
literal|"pllM_UD"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC3_out0"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_m_c_p_clkm_mud_c2_c3_cud
argument_list|)
operator|=
block|{
literal|"pllM_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllP_out0"
block|,
literal|"clk_m"
block|,
literal|"pllM_UD"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC3_out0"
block|,
literal|"pllC_UD"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_m_c2_c_c3_p_N_a
argument_list|)
operator|=
block|{
literal|"pllM_out0"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllC3_out0"
block|,
literal|"pllP_out0"
block|,
name|NULL
block|,
literal|"pllA_out0"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_m_c2_c_c3_p_N_a_c4
argument_list|)
operator|=
block|{
literal|"pllM_out0"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllC3_out0"
block|,
name|NULL
block|,
literal|"pllA_out0"
block|,
literal|"pllC4_out0"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_p_N_c_N_N_N_clkm
argument_list|)
operator|=
block|{
literal|"pllP_out0"
block|,
name|NULL
block|,
literal|"pllC_out0"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
literal|"clk_m"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_p_N_c_N_m_N_clkm
argument_list|)
operator|=
block|{
literal|"pllP_out0"
block|,
name|NULL
block|,
literal|"pllC_out0"
block|,
name|NULL
block|,
literal|"pllM_out0"
block|,
name|NULL
block|,
literal|"clk_m"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_p_c_c2_clkm
argument_list|)
operator|=
block|{
literal|"pllP_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllC2_out0"
block|,
literal|"clk_m"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_p_c2_c_c3_m
argument_list|)
operator|=
block|{
literal|"pllP_out0"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllC3_out0"
block|,
literal|"pllM_out0"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_p_c2_c_c3_m_N_clkm
argument_list|)
operator|=
block|{
literal|"pllP_out0"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllC3_out0"
block|,
literal|"pllM_out0"
block|,
name|NULL
block|,
literal|"clk_m"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_p_c2_c_c3_m_e_clkm
argument_list|)
operator|=
block|{
literal|"pllP_out0"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllC3_out0"
block|,
literal|"pllM_out0"
block|,
literal|"pllE_out0"
block|,
literal|"clk_m"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_p_c2_c_c3_m_a_clkm
argument_list|)
operator|=
block|{
literal|"pllP_out0"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllC3_out0"
block|,
literal|"pllM_out0"
block|,
literal|"pllA_out0"
block|,
literal|"clk_m"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_p_c2_c_c3_m_clks_clkm
argument_list|)
operator|=
block|{
literal|"pllP_out0"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllC3_out0"
block|,
literal|"pllM_out0"
block|,
literal|"clk_s"
block|,
literal|"clk_m"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_p_c2_c_c3_clks_N_clkm
argument_list|)
operator|=
block|{
literal|"pllP_out0"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllC3_out0"
block|,
literal|"clk_s"
block|,
name|NULL
block|,
literal|"clk_m"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_p_c2_c_c3_clkm_N_clks
argument_list|)
operator|=
block|{
literal|"pllP_out0"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllC3_out0"
block|,
literal|"clk_m"
block|,
name|NULL
block|,
literal|"clk_s"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_p_clkm_clks_E
argument_list|)
operator|=
block|{
literal|"pllP_out0"
block|,
literal|"clk_m"
block|,
literal|"clk_s"
block|,
literal|"pllE_out0"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_p_m_d_a_c_d2_clkm
argument_list|)
operator|=
block|{
literal|"pllP_out0"
block|,
literal|"pllM_out0"
block|,
literal|"pllD_out0"
block|,
literal|"pllA_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllD2_out0"
block|,
literal|"clk_m"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_clkm_N_u48_N_p_N_u480
argument_list|)
operator|=
block|{
literal|"clk_m"
block|,
name|NULL
block|,
literal|"pllU_48"
block|,
name|NULL
block|,
literal|"pllP_out0"
block|,
name|NULL
block|,
literal|"pllU_480"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_clkm_p_c2_c_c3_refre
argument_list|)
operator|=
block|{
literal|"clk_m"
block|,
literal|"pllP_out0"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllC3_out0"
block|,
literal|"pllREFE_out"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_clkm_refe_clks_u480_c_c2_c3_oscdiv
argument_list|)
operator|=
block|{
literal|"clk_m"
block|,
literal|"pllREFE_out"
block|,
literal|"clk_s"
block|,
literal|"pllU_480"
block|,
literal|"pllC_out0"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC3_out0"
block|,
literal|"osc_div_clk"
block|}
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PLIST
argument_list|(
name|mux_sep_audio
argument_list|)
operator|=
block|{
literal|"pllA_out0"
block|,
literal|"pllC2_out0"
block|,
literal|"pllC_out0"
block|,
literal|"pllC3_out0"
block|,
literal|"pllP_out0"
block|,
name|NULL
block|,
literal|"clk_m"
block|,
name|NULL
block|,
literal|"spdif_in"
block|,
literal|"i2s0"
block|,
literal|"i2s1"
block|,
literal|"i2s2"
block|,
literal|"i2s4"
block|,
literal|"pllA_out0"
block|,
literal|"ext_vimclk"
block|}
expr_stmt|;
end_expr_stmt

begin_decl_stmt
specifier|static
name|uint32_t
name|clk_enable_reg
index|[]
init|=
block|{
name|CLK_OUT_ENB_L
block|,
name|CLK_OUT_ENB_H
block|,
name|CLK_OUT_ENB_U
block|,
name|CLK_OUT_ENB_V
block|,
name|CLK_OUT_ENB_W
block|,
name|CLK_OUT_ENB_X
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|uint32_t
name|clk_reset_reg
index|[]
init|=
block|{
name|RST_DEVICES_L
block|,
name|RST_DEVICES_H
block|,
name|RST_DEVICES_U
block|,
name|RST_DEVICES_V
block|,
name|RST_DEVICES_W
block|,
name|RST_DEVICES_X
block|, }
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|L
parameter_list|(
name|n
parameter_list|)
value|((0 * 32) + (n))
end_define

begin_define
define|#
directive|define
name|H
parameter_list|(
name|n
parameter_list|)
value|((1 * 32) + (n))
end_define

begin_define
define|#
directive|define
name|U
parameter_list|(
name|n
parameter_list|)
value|((2 * 32) + (n))
end_define

begin_define
define|#
directive|define
name|V
parameter_list|(
name|n
parameter_list|)
value|((3 * 32) + (n))
end_define

begin_define
define|#
directive|define
name|W
parameter_list|(
name|n
parameter_list|)
value|((4 * 32) + (n))
end_define

begin_define
define|#
directive|define
name|X
parameter_list|(
name|n
parameter_list|)
value|((5 * 32) + (n))
end_define

begin_decl_stmt
specifier|static
name|struct
name|pgate_def
name|pgate_def
index|[]
init|=
block|{
comment|/* bank L ->  0-31 */
comment|/* GATE(CPU, "cpu", "clk_m", L(0)), */
name|GATE
argument_list|(
name|ISPB
argument_list|,
literal|"ispb"
argument_list|,
literal|"clk_m"
argument_list|,
name|L
argument_list|(
literal|3
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|RTC
argument_list|,
literal|"rtc"
argument_list|,
literal|"clk_s"
argument_list|,
name|L
argument_list|(
literal|4
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|TIMER
argument_list|,
literal|"timer"
argument_list|,
literal|"clk_m"
argument_list|,
name|L
argument_list|(
literal|5
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|UARTA
argument_list|,
literal|"uarta"
argument_list|,
literal|"pc_uarta"
argument_list|,
name|L
argument_list|(
literal|6
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|UARTB
argument_list|,
literal|"uartb"
argument_list|,
literal|"pc_uartb"
argument_list|,
name|L
argument_list|(
literal|7
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|VFIR
argument_list|,
literal|"vfir"
argument_list|,
literal|"pc_vfir"
argument_list|,
name|L
argument_list|(
literal|7
argument_list|)
argument_list|)
block|,
comment|/* GATE(GPIO, "gpio", "clk_m", L(8)), */
name|GATE
argument_list|(
name|SDMMC2
argument_list|,
literal|"sdmmc2"
argument_list|,
literal|"pc_sdmmc2"
argument_list|,
name|L
argument_list|(
literal|9
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|SPDIF_OUT
argument_list|,
literal|"spdif_out"
argument_list|,
literal|"pc_spdif_out"
argument_list|,
name|L
argument_list|(
literal|10
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|SPDIF_IN
argument_list|,
literal|"spdif_in"
argument_list|,
literal|"pc_spdif_in"
argument_list|,
name|L
argument_list|(
literal|10
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|I2S1
argument_list|,
literal|"i2s1"
argument_list|,
literal|"pc_i2s1"
argument_list|,
name|L
argument_list|(
literal|11
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|I2C1
argument_list|,
literal|"i2c1"
argument_list|,
literal|"pc_i2c1"
argument_list|,
name|L
argument_list|(
literal|12
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|SDMMC1
argument_list|,
literal|"sdmmc1"
argument_list|,
literal|"pc_sdmmc1"
argument_list|,
name|L
argument_list|(
literal|14
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|SDMMC4
argument_list|,
literal|"sdmmc4"
argument_list|,
literal|"pc_sdmmc4"
argument_list|,
name|L
argument_list|(
literal|15
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|PWM
argument_list|,
literal|"pwm"
argument_list|,
literal|"pc_pwm"
argument_list|,
name|L
argument_list|(
literal|17
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|I2S2
argument_list|,
literal|"i2s2"
argument_list|,
literal|"pc_i2s2"
argument_list|,
name|L
argument_list|(
literal|18
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|VI
argument_list|,
literal|"vi"
argument_list|,
literal|"pc_vi"
argument_list|,
name|L
argument_list|(
literal|20
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|USBD
argument_list|,
literal|"usbd"
argument_list|,
literal|"clk_m"
argument_list|,
name|L
argument_list|(
literal|22
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|ISP
argument_list|,
literal|"isp"
argument_list|,
literal|"pc_isp"
argument_list|,
name|L
argument_list|(
literal|23
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|DISP2
argument_list|,
literal|"disp2"
argument_list|,
literal|"pc_disp2"
argument_list|,
name|L
argument_list|(
literal|26
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|DISP1
argument_list|,
literal|"disp1"
argument_list|,
literal|"pc_disp1"
argument_list|,
name|L
argument_list|(
literal|27
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|HOST1X
argument_list|,
literal|"host1x"
argument_list|,
literal|"pc_host1x"
argument_list|,
name|L
argument_list|(
literal|28
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|VCP
argument_list|,
literal|"vcp"
argument_list|,
literal|"clk_m"
argument_list|,
name|L
argument_list|(
literal|29
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|I2S0
argument_list|,
literal|"i2s0"
argument_list|,
literal|"pc_i2s0"
argument_list|,
name|L
argument_list|(
literal|30
argument_list|)
argument_list|)
block|,
comment|/* GATE(CACHE2, "ccache2", "clk_m", L(31)), */
comment|/* bank H -> 32-63 */
name|GATE
argument_list|(
name|MC
argument_list|,
literal|"mem"
argument_list|,
literal|"clk_m"
argument_list|,
name|H
argument_list|(
literal|0
argument_list|)
argument_list|)
block|,
comment|/* GATE(AHBDMA, "ahbdma", "clk_m", H(1)), */
name|GATE
argument_list|(
name|APBDMA
argument_list|,
literal|"apbdma"
argument_list|,
literal|"clk_m"
argument_list|,
name|H
argument_list|(
literal|2
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|KBC
argument_list|,
literal|"kbc"
argument_list|,
literal|"clk_s"
argument_list|,
name|H
argument_list|(
literal|4
argument_list|)
argument_list|)
block|,
comment|/* GATE(STAT_MON, "stat_mon", "clk_s", H(5)), */
comment|/* GATE(PMC, "pmc", "clk_s", H(6)), */
name|GATE
argument_list|(
name|FUSE
argument_list|,
literal|"fuse"
argument_list|,
literal|"clk_m"
argument_list|,
name|H
argument_list|(
literal|7
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|KFUSE
argument_list|,
literal|"kfuse"
argument_list|,
literal|"clk_m"
argument_list|,
name|H
argument_list|(
literal|8
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|SBC1
argument_list|,
literal|"spi1"
argument_list|,
literal|"pc_spi1"
argument_list|,
name|H
argument_list|(
literal|9
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|NOR
argument_list|,
literal|"snor"
argument_list|,
literal|"pc_snor"
argument_list|,
name|H
argument_list|(
literal|10
argument_list|)
argument_list|)
block|,
comment|/* GATE(JTAG2TBC, "jtag2tbc", "clk_m", H(11)), */
name|GATE
argument_list|(
name|SBC2
argument_list|,
literal|"spi2"
argument_list|,
literal|"pc_spi2"
argument_list|,
name|H
argument_list|(
literal|12
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|SBC3
argument_list|,
literal|"spi3"
argument_list|,
literal|"pc_spi3"
argument_list|,
name|H
argument_list|(
literal|14
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|I2C5
argument_list|,
literal|"i2c5"
argument_list|,
literal|"pc_i2c5"
argument_list|,
name|H
argument_list|(
literal|15
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|DSIA
argument_list|,
literal|"dsia"
argument_list|,
literal|"dsia_mux"
argument_list|,
name|H
argument_list|(
literal|16
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|MIPI
argument_list|,
literal|"hsi"
argument_list|,
literal|"pc_hsi"
argument_list|,
name|H
argument_list|(
literal|18
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|HDMI
argument_list|,
literal|"hdmi"
argument_list|,
literal|"pc_hdmi"
argument_list|,
name|H
argument_list|(
literal|19
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|CSI
argument_list|,
literal|"csi"
argument_list|,
literal|"pllP_out3"
argument_list|,
name|H
argument_list|(
literal|20
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|I2C2
argument_list|,
literal|"i2c2"
argument_list|,
literal|"pc_i2c2"
argument_list|,
name|H
argument_list|(
literal|22
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|UARTC
argument_list|,
literal|"uartc"
argument_list|,
literal|"pc_uartc"
argument_list|,
name|H
argument_list|(
literal|23
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|MIPI_CAL
argument_list|,
literal|"mipi_cal"
argument_list|,
literal|"clk_m"
argument_list|,
name|H
argument_list|(
literal|24
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|EMC
argument_list|,
literal|"emc"
argument_list|,
literal|"pc_emc_2x"
argument_list|,
name|H
argument_list|(
literal|25
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|USB2
argument_list|,
literal|"usb2"
argument_list|,
literal|"clk_m"
argument_list|,
name|H
argument_list|(
literal|26
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|USB3
argument_list|,
literal|"usb3"
argument_list|,
literal|"clk_m"
argument_list|,
name|H
argument_list|(
literal|27
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|VDE
argument_list|,
literal|"vde"
argument_list|,
literal|"pc_vde"
argument_list|,
name|H
argument_list|(
literal|29
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|BSEA
argument_list|,
literal|"bsea"
argument_list|,
literal|"clk_m"
argument_list|,
name|H
argument_list|(
literal|30
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|BSEV
argument_list|,
literal|"bsev"
argument_list|,
literal|"clk_m"
argument_list|,
name|H
argument_list|(
literal|31
argument_list|)
argument_list|)
block|,
comment|/* bank U  -> 64-95 */
name|GATE
argument_list|(
name|UARTD
argument_list|,
literal|"uartd"
argument_list|,
literal|"pc_uartd"
argument_list|,
name|U
argument_list|(
literal|1
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|I2C3
argument_list|,
literal|"i2c3"
argument_list|,
literal|"pc_i2c3"
argument_list|,
name|U
argument_list|(
literal|3
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|SBC4
argument_list|,
literal|"spi4"
argument_list|,
literal|"pc_spi4"
argument_list|,
name|U
argument_list|(
literal|4
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|SDMMC3
argument_list|,
literal|"sdmmc3"
argument_list|,
literal|"pc_sdmmc3"
argument_list|,
name|U
argument_list|(
literal|5
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|PCIE
argument_list|,
literal|"pcie"
argument_list|,
literal|"clk_m"
argument_list|,
name|U
argument_list|(
literal|6
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|OWR
argument_list|,
literal|"owr"
argument_list|,
literal|"pc_owr"
argument_list|,
name|U
argument_list|(
literal|7
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|AFI
argument_list|,
literal|"afi"
argument_list|,
literal|"clk_m"
argument_list|,
name|U
argument_list|(
literal|8
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|CSITE
argument_list|,
literal|"csite"
argument_list|,
literal|"pc_csite"
argument_list|,
name|U
argument_list|(
literal|9
argument_list|)
argument_list|)
block|,
comment|/* GATE(AVPUCQ, "avpucq", clk_m, U(11)), */
name|GATE
argument_list|(
name|TRACE
argument_list|,
literal|"traceclkin"
argument_list|,
literal|"pc_traceclkin"
argument_list|,
name|U
argument_list|(
literal|13
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|SOC_THERM
argument_list|,
literal|"soc_therm"
argument_list|,
literal|"pc_soc_therm"
argument_list|,
name|U
argument_list|(
literal|14
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|DTV
argument_list|,
literal|"dtv"
argument_list|,
literal|"clk_m"
argument_list|,
name|U
argument_list|(
literal|15
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|I2CSLOW
argument_list|,
literal|"i2c_slow"
argument_list|,
literal|"pc_i2c_slow"
argument_list|,
name|U
argument_list|(
literal|17
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|DSIB
argument_list|,
literal|"dsib"
argument_list|,
literal|"dsib_mux"
argument_list|,
name|U
argument_list|(
literal|18
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|TSEC
argument_list|,
literal|"tsec"
argument_list|,
literal|"pc_tsec"
argument_list|,
name|U
argument_list|(
literal|19
argument_list|)
argument_list|)
block|,
comment|/* GATE(IRAMA, "irama", "clk_m", U(20)), */
comment|/* GATE(IRAMB, "iramb", "clk_m", U(21)), */
comment|/* GATE(IRAMC, "iramc", "clk_m", U(22)), */
comment|/* GATE(IRAMD, "iramd", "clk_m", U(23)), */
comment|/* GATE(CRAM2, "cram2", "clk_m", U(24)), */
name|GATE
argument_list|(
name|XUSB_HOST
argument_list|,
literal|"xusb_core_host"
argument_list|,
literal|"pc_xusb_core_host"
argument_list|,
name|U
argument_list|(
literal|25
argument_list|)
argument_list|)
block|,
comment|/* GATE(M_DOUBLER, "m_doubler", "clk_m", U(26)), */
name|GATE
argument_list|(
name|MSENC
argument_list|,
literal|"msenc"
argument_list|,
literal|"pc_msenc"
argument_list|,
name|U
argument_list|(
literal|27
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|CSUS
argument_list|,
literal|"sus_out"
argument_list|,
literal|"clk_m"
argument_list|,
name|U
argument_list|(
literal|28
argument_list|)
argument_list|)
block|,
comment|/* GATE(DEVD2_OUT, "devd2_out", "clk_m", U(29)), */
comment|/* GATE(DEVD1_OUT, "devd1_out", "clk_m", U(30)), */
name|GATE
argument_list|(
name|XUSB_DEV
argument_list|,
literal|"xusb_core_dev"
argument_list|,
literal|"pc_xusb_core_dev"
argument_list|,
name|U
argument_list|(
literal|31
argument_list|)
argument_list|)
block|,
comment|/* bank V  -> 96-127 */
comment|/* GATE(CPUG, "cpug", "clk_m", V(0)), */
comment|/* GATE(CPULP, "cpuLP", "clk_m", V(1)), */
name|GATE
argument_list|(
name|MSELECT
argument_list|,
literal|"mselect"
argument_list|,
literal|"pc_mselect"
argument_list|,
name|V
argument_list|(
literal|3
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|TSENSOR
argument_list|,
literal|"tsensor"
argument_list|,
literal|"pc_tsensor"
argument_list|,
name|V
argument_list|(
literal|4
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|I2S3
argument_list|,
literal|"i2s3"
argument_list|,
literal|"pc_i2s3"
argument_list|,
name|V
argument_list|(
literal|5
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|I2S4
argument_list|,
literal|"i2s4"
argument_list|,
literal|"pc_i2s4"
argument_list|,
name|V
argument_list|(
literal|6
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|I2C4
argument_list|,
literal|"i2c4"
argument_list|,
literal|"pc_i2c4"
argument_list|,
name|V
argument_list|(
literal|7
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|SBC5
argument_list|,
literal|"spi5"
argument_list|,
literal|"pc_spi5"
argument_list|,
name|V
argument_list|(
literal|8
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|SBC6
argument_list|,
literal|"spi6"
argument_list|,
literal|"pc_spi6"
argument_list|,
name|V
argument_list|(
literal|9
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|D_AUDIO
argument_list|,
literal|"audio"
argument_list|,
literal|"pc_audio"
argument_list|,
name|V
argument_list|(
literal|10
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|APBIF
argument_list|,
literal|"apbif"
argument_list|,
literal|"clk_m"
argument_list|,
name|V
argument_list|(
literal|11
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|DAM0
argument_list|,
literal|"dam0"
argument_list|,
literal|"pc_dam0"
argument_list|,
name|V
argument_list|(
literal|12
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|DAM1
argument_list|,
literal|"dam1"
argument_list|,
literal|"pc_dam1"
argument_list|,
name|V
argument_list|(
literal|13
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|DAM2
argument_list|,
literal|"dam2"
argument_list|,
literal|"pc_dam2"
argument_list|,
name|V
argument_list|(
literal|14
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|HDA2CODEC_2X
argument_list|,
literal|"hda2codec_2x"
argument_list|,
literal|"pc_hda2codec_2x"
argument_list|,
name|V
argument_list|(
literal|15
argument_list|)
argument_list|)
block|,
comment|/* GATE(ATOMICS, "atomics", "clk_m", V(16)), */
comment|/* GATE(SPDIF_DOUBLER, "spdif_doubler", "clk_m", V(22)), */
name|GATE
argument_list|(
name|ACTMON
argument_list|,
literal|"actmon"
argument_list|,
literal|"pc_actmon"
argument_list|,
name|V
argument_list|(
literal|23
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|EXTERN1
argument_list|,
literal|"extperiph1"
argument_list|,
literal|"pc_extperiph1"
argument_list|,
name|V
argument_list|(
literal|24
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|EXTERN2
argument_list|,
literal|"extperiph2"
argument_list|,
literal|"pc_extperiph2"
argument_list|,
name|V
argument_list|(
literal|25
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|EXTERN3
argument_list|,
literal|"extperiph3"
argument_list|,
literal|"pc_extperiph3"
argument_list|,
name|V
argument_list|(
literal|26
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|SATA_OOB
argument_list|,
literal|"sata_oob"
argument_list|,
literal|"pc_sata_oob"
argument_list|,
name|V
argument_list|(
literal|27
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|SATA
argument_list|,
literal|"sata"
argument_list|,
literal|"pc_sata"
argument_list|,
name|V
argument_list|(
literal|28
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|HDA
argument_list|,
literal|"hda"
argument_list|,
literal|"pc_hda"
argument_list|,
name|V
argument_list|(
literal|29
argument_list|)
argument_list|)
block|,
comment|/* bank W   -> 128-159*/
name|GATE
argument_list|(
name|HDA2HDMI
argument_list|,
literal|"hda2hdmi"
argument_list|,
literal|"clk_m"
argument_list|,
name|W
argument_list|(
literal|0
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|SATA_COLD
argument_list|,
literal|"sata_cold"
argument_list|,
literal|"clk_m"
argument_list|,
name|W
argument_list|(
literal|1
argument_list|)
argument_list|)
block|,
comment|/* Reset only */
comment|/* GATE(PCIERX0, "pcierx0", "clk_m", W(2)), */
comment|/* GATE(PCIERX1, "pcierx1", "clk_m", W(3)), */
comment|/* GATE(PCIERX2, "pcierx2", "clk_m", W(4)), */
comment|/* GATE(PCIERX3, "pcierx3", "clk_m", W(5)), */
comment|/* GATE(PCIERX4, "pcierx4", "clk_m", W(6)), */
comment|/* GATE(PCIERX5, "pcierx5", "clk_m", W(7)), */
comment|/* GATE(CEC, "cec", "clk_m", W(8)), */
comment|/* GATE(PCIE2_IOBIST, "pcie2_iobist", "clk_m", W(9)), */
comment|/* GATE(EMC_IOBIST, "emc_iobist", "clk_m", W(10)), */
comment|/* GATE(HDMI_IOBIST, "hdmi_iobist", "clk_m", W(11)), */
comment|/* GATE(SATA_IOBIST, "sata_iobist", "clk_m", W(12)), */
comment|/* GATE(MIPI_IOBIST, "mipi_iobist", "clk_m", W(13)), */
name|GATE
argument_list|(
name|XUSB_GATE
argument_list|,
literal|"xusb_gate"
argument_list|,
literal|"clk_m"
argument_list|,
name|W
argument_list|(
literal|15
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|CILAB
argument_list|,
literal|"cilab"
argument_list|,
literal|"pc_cilab"
argument_list|,
name|W
argument_list|(
literal|16
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|CILCD
argument_list|,
literal|"cilcd"
argument_list|,
literal|"pc_cilcd"
argument_list|,
name|W
argument_list|(
literal|17
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|CILE
argument_list|,
literal|"cile"
argument_list|,
literal|"pc_cile"
argument_list|,
name|W
argument_list|(
literal|18
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|DSIALP
argument_list|,
literal|"dsia_lp"
argument_list|,
literal|"pc_dsia_lp"
argument_list|,
name|W
argument_list|(
literal|19
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|DSIBLP
argument_list|,
literal|"dsib_lp"
argument_list|,
literal|"pc_dsib_lp"
argument_list|,
name|W
argument_list|(
literal|20
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|ENTROPY
argument_list|,
literal|"entropy"
argument_list|,
literal|"pc_entropy"
argument_list|,
name|W
argument_list|(
literal|21
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|AMX
argument_list|,
literal|"amx"
argument_list|,
literal|"pc_amx"
argument_list|,
name|W
argument_list|(
literal|25
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|ADX
argument_list|,
literal|"adx"
argument_list|,
literal|"pc_adx"
argument_list|,
name|W
argument_list|(
literal|26
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|DFLL_REF
argument_list|,
literal|"dvfs_ref"
argument_list|,
literal|"pc_dvfs_ref"
argument_list|,
name|W
argument_list|(
literal|27
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|DFLL_SOC
argument_list|,
literal|"dvfs_soc"
argument_list|,
literal|"pc_dvfs_soc"
argument_list|,
name|W
argument_list|(
literal|27
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|XUSB_SS
argument_list|,
literal|"xusb_ss"
argument_list|,
literal|"xusb_ss_mux"
argument_list|,
name|W
argument_list|(
literal|28
argument_list|)
argument_list|)
block|,
comment|/* GATE(EMC_LATENCY, "emc_latency", "pc_emc_latency", W(29)), */
comment|/* bank X -> 160-191*/
comment|/* GATE(SPARE, "spare", "clk_m", X(0)), */
comment|/* GATE(CAM_MCLK, "CAM_MCLK", "clk_m", X(4)), */
comment|/* GATE(CAM_MCLK2, "CAM_MCLK2", "clk_m", X(5)), */
name|GATE
argument_list|(
name|I2C6
argument_list|,
literal|"i2c6"
argument_list|,
literal|"pc_i2c6"
argument_list|,
name|X
argument_list|(
literal|6
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|VIM2_CLK
argument_list|,
literal|"vim2_clk"
argument_list|,
literal|"clk_m"
argument_list|,
name|X
argument_list|(
literal|11
argument_list|)
argument_list|)
block|,
comment|/* GATE(EMC_DLL, "emc_dll", "pc_emc_dll", X(14)), */
name|GATE
argument_list|(
name|HDMI_AUDIO
argument_list|,
literal|"hdmi_audio"
argument_list|,
literal|"pc_hdmi_audio"
argument_list|,
name|X
argument_list|(
literal|16
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|CLK72MHZ
argument_list|,
literal|"clk72mhz"
argument_list|,
literal|"pc_clk72mhz"
argument_list|,
name|X
argument_list|(
literal|17
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|VIC03
argument_list|,
literal|"vic"
argument_list|,
literal|"pc_vic"
argument_list|,
name|X
argument_list|(
literal|18
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|ADX1
argument_list|,
literal|"adx1"
argument_list|,
literal|"pc_adx1"
argument_list|,
name|X
argument_list|(
literal|20
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|DPAUX
argument_list|,
literal|"dpaux"
argument_list|,
literal|"clk_m"
argument_list|,
name|X
argument_list|(
literal|21
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|SOR0_LVDS
argument_list|,
literal|"sor0"
argument_list|,
literal|"pc_sor0"
argument_list|,
name|X
argument_list|(
literal|22
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|GPU
argument_list|,
literal|"gpu"
argument_list|,
literal|"osc_div_clk"
argument_list|,
name|X
argument_list|(
literal|24
argument_list|)
argument_list|)
block|,
name|GATE
argument_list|(
name|AMX1
argument_list|,
literal|"amx1"
argument_list|,
literal|"pc_amx1"
argument_list|,
name|X
argument_list|(
literal|26
argument_list|)
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Peripheral clock clock */
end_comment

begin_define
define|#
directive|define
name|DCF_HAVE_MUX
value|0x0100
end_define

begin_comment
comment|/* Block with multipexor */
end_comment

begin_define
define|#
directive|define
name|DCF_HAVE_ENA
value|0x0200
end_define

begin_comment
comment|/* Block with enable bit */
end_comment

begin_define
define|#
directive|define
name|DCF_HAVE_DIV
value|0x0400
end_define

begin_comment
comment|/* Block with divider */
end_comment

begin_comment
comment|/* Mark block with additional bits / functionality. */
end_comment

begin_define
define|#
directive|define
name|DCF_IS_MASK
value|0x00FF
end_define

begin_define
define|#
directive|define
name|DCF_IS_UART
value|0x0001
end_define

begin_define
define|#
directive|define
name|DCF_IS_VI
value|0x0002
end_define

begin_define
define|#
directive|define
name|DCF_IS_HOST1X
value|0x0003
end_define

begin_define
define|#
directive|define
name|DCF_IS_XUSB_SS
value|0x0004
end_define

begin_define
define|#
directive|define
name|DCF_IS_EMC_DLL
value|0x0005
end_define

begin_define
define|#
directive|define
name|DCF_IS_SATA
value|0x0006
end_define

begin_define
define|#
directive|define
name|DCF_IS_VIC
value|0x0007
end_define

begin_define
define|#
directive|define
name|DCF_IS_AUDIO
value|0x0008
end_define

begin_define
define|#
directive|define
name|DCF_IS_SOR0
value|0x0009
end_define

begin_define
define|#
directive|define
name|DCF_IS_EMC
value|0x000A
end_define

begin_comment
comment|/* Basic pheripheral clock */
end_comment

begin_define
define|#
directive|define
name|PER_CLK
parameter_list|(
name|_id
parameter_list|,
name|cn
parameter_list|,
name|pl
parameter_list|,
name|r
parameter_list|,
name|diw
parameter_list|,
name|fiw
parameter_list|,
name|f
parameter_list|)
define|\
value|{									\ 	.clkdef.id = _id,						\ 	.clkdef.name = cn,						\ 	.clkdef.parent_names = pl,					\ 	.clkdef.parent_cnt = nitems(pl),				\ 	.clkdef.flags = CLK_NODE_STATIC_STRINGS,			\ 	.base_reg = r,							\ 	.div_width = diw,						\ 	.div_f_width = fiw,						\ 	.flags = f,							\ }
end_define

begin_comment
comment|/* Mux with fractional 8.1 divider. */
end_comment

begin_define
define|#
directive|define
name|CLK_8_1
parameter_list|(
name|id
parameter_list|,
name|cn
parameter_list|,
name|pl
parameter_list|,
name|r
parameter_list|,
name|f
parameter_list|)
define|\
value|PER_CLK(id, cn, pl, r,  8, 1, (f) | DCF_HAVE_MUX | DCF_HAVE_DIV)
end_define

begin_comment
comment|/* Mux with fractional 16.1 divider. */
end_comment

begin_define
define|#
directive|define
name|CLK16_1
parameter_list|(
name|id
parameter_list|,
name|cn
parameter_list|,
name|pl
parameter_list|,
name|r
parameter_list|,
name|f
parameter_list|)
define|\
value|PER_CLK(id, cn, pl, r,  16, 1, (f) | DCF_HAVE_MUX | DCF_HAVE_DIV)
end_define

begin_comment
comment|/* Mux with integer 16bits divider. */
end_comment

begin_define
define|#
directive|define
name|CLK16_0
parameter_list|(
name|id
parameter_list|,
name|cn
parameter_list|,
name|pl
parameter_list|,
name|r
parameter_list|,
name|f
parameter_list|)
define|\
value|PER_CLK(id, cn, pl, r,  16, 0, (f) | DCF_HAVE_MUX | DCF_HAVE_DIV)
end_define

begin_comment
comment|/* Mux wihout divider. */
end_comment

begin_define
define|#
directive|define
name|CLK_0_0
parameter_list|(
name|id
parameter_list|,
name|cn
parameter_list|,
name|pl
parameter_list|,
name|r
parameter_list|,
name|f
parameter_list|)
define|\
value|PER_CLK(id, cn, pl, r,  0, 0, (f) | DCF_HAVE_MUX)
end_define

begin_decl_stmt
specifier|static
name|struct
name|periph_def
name|periph_def
index|[]
init|=
block|{
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_i2s1"
argument_list|,
name|mux_a_N_audio1_N_p_N_clkm
argument_list|,
name|CLK_SOURCE_I2S1
argument_list|,
name|DCF_HAVE_ENA
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_i2s2"
argument_list|,
name|mux_a_N_audio2_N_p_N_clkm
argument_list|,
name|CLK_SOURCE_I2S2
argument_list|,
name|DCF_HAVE_ENA
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_spdif_out"
argument_list|,
name|mux_a_N_audio_N_p_N_clkm
argument_list|,
name|CLK_SOURCE_SPDIF_OUT
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_spdif_in"
argument_list|,
name|mux_p_c2_c_c3_m
argument_list|,
name|CLK_SOURCE_SPDIF_IN
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_pwm"
argument_list|,
name|mux_p_c2_c_c3_clks_N_clkm
argument_list|,
name|CLK_SOURCE_PWM
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_spi2"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_SPI2
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_spi3"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_SPI3
argument_list|,
literal|0
argument_list|)
block|,
name|CLK16_0
argument_list|(
literal|0
argument_list|,
literal|"pc_i2c5"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_I2C5
argument_list|,
literal|0
argument_list|)
block|,
name|CLK16_0
argument_list|(
literal|0
argument_list|,
literal|"pc_i2c1"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_I2C1
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_spi1"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_SPI1
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_0_0
argument_list|(
literal|0
argument_list|,
literal|"pc_disp1"
argument_list|,
name|mux_p_m_d_a_c_d2_clkm
argument_list|,
name|CLK_SOURCE_DISP1
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_0_0
argument_list|(
literal|0
argument_list|,
literal|"pc_disp2"
argument_list|,
name|mux_p_m_d_a_c_d2_clkm
argument_list|,
name|CLK_SOURCE_DISP2
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_isp"
argument_list|,
name|mux_m_c_p_a_c2_c3_clkm_c4
argument_list|,
name|CLK_SOURCE_ISP
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_vi"
argument_list|,
name|mux_m_c2_c_c3_p_N_a_c4
argument_list|,
name|CLK_SOURCE_VI
argument_list|,
name|DCF_IS_VI
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_sdmmc1"
argument_list|,
name|mux_p_c2_c_c3_m_e_clkm
argument_list|,
name|CLK_SOURCE_SDMMC1
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_sdmmc2"
argument_list|,
name|mux_p_c2_c_c3_m_e_clkm
argument_list|,
name|CLK_SOURCE_SDMMC2
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_sdmmc4"
argument_list|,
name|mux_p_c2_c_c3_m_e_clkm
argument_list|,
name|CLK_SOURCE_SDMMC4
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_vfir"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_VFIR
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_hsi"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_HSI
argument_list|,
literal|0
argument_list|)
block|,
name|CLK16_1
argument_list|(
literal|0
argument_list|,
literal|"pc_uarta"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_UARTA
argument_list|,
name|DCF_IS_UART
argument_list|)
block|,
name|CLK16_1
argument_list|(
literal|0
argument_list|,
literal|"pc_uartb"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_UARTB
argument_list|,
name|DCF_IS_UART
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_host1x"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_HOST1X
argument_list|,
name|DCF_IS_HOST1X
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_hdmi"
argument_list|,
name|mux_p_m_d_a_c_d2_clkm
argument_list|,
name|CLK_SOURCE_HDMI
argument_list|,
literal|0
argument_list|)
block|,
name|CLK16_0
argument_list|(
literal|0
argument_list|,
literal|"pc_i2c2"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_I2C2
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_emc_2x"
argument_list|,
name|mux_m_c_p_clkm_mud_c2_c3_cud
argument_list|,
name|CLK_SOURCE_EMC
argument_list|,
name|DCF_IS_EMC
argument_list|)
block|,
name|CLK16_1
argument_list|(
literal|0
argument_list|,
literal|"pc_uartc"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_UARTC
argument_list|,
name|DCF_IS_UART
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_vi_sensor"
argument_list|,
name|mux_m_c2_c_c3_p_N_a
argument_list|,
name|CLK_SOURCE_VI_SENSOR
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_spi4"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_SPI4
argument_list|,
literal|0
argument_list|)
block|,
name|CLK16_0
argument_list|(
literal|0
argument_list|,
literal|"pc_i2c3"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_I2C3
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_sdmmc3"
argument_list|,
name|mux_p_c2_c_c3_m_e_clkm
argument_list|,
name|CLK_SOURCE_SDMMC3
argument_list|,
literal|0
argument_list|)
block|,
name|CLK16_1
argument_list|(
literal|0
argument_list|,
literal|"pc_uartd"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_UARTD
argument_list|,
name|DCF_IS_UART
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_vde"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_VDE
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_owr"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_OWR
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_snor"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_NOR
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_csite"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_CSITE
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_i2s0"
argument_list|,
name|mux_a_N_audio0_N_p_N_clkm
argument_list|,
name|CLK_SOURCE_I2S0
argument_list|,
literal|0
argument_list|)
block|,
comment|/* DTV xxx */
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_msenc"
argument_list|,
name|mux_m_c2_c_c3_p_N_a
argument_list|,
name|CLK_SOURCE_MSENC
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_tsec"
argument_list|,
name|mux_p_c2_c_c3_m_a_clkm
argument_list|,
name|CLK_SOURCE_TSEC
argument_list|,
literal|0
argument_list|)
block|,
comment|/* SPARE2 */
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_mselect"
argument_list|,
name|mux_p_c2_c_c3_m_clks_clkm
argument_list|,
name|CLK_SOURCE_MSELECT
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_tsensor"
argument_list|,
name|mux_p_c2_c_c3_clkm_N_clks
argument_list|,
name|CLK_SOURCE_TSENSOR
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_i2s3"
argument_list|,
name|mux_a_N_audio3_N_p_N_clkm
argument_list|,
name|CLK_SOURCE_I2S3
argument_list|,
name|DCF_HAVE_ENA
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_i2s4"
argument_list|,
name|mux_a_N_audio4_N_p_N_clkm
argument_list|,
name|CLK_SOURCE_I2S4
argument_list|,
name|DCF_HAVE_ENA
argument_list|)
block|,
name|CLK16_0
argument_list|(
literal|0
argument_list|,
literal|"pc_i2c4"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_I2C4
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_spi5"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_SPI5
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_spi6"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_SPI6
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_audio"
argument_list|,
name|mux_sep_audio
argument_list|,
name|CLK_SOURCE_AUDIO
argument_list|,
name|DCF_IS_AUDIO
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_dam0"
argument_list|,
name|mux_sep_audio
argument_list|,
name|CLK_SOURCE_DAM0
argument_list|,
name|DCF_IS_AUDIO
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_dam1"
argument_list|,
name|mux_sep_audio
argument_list|,
name|CLK_SOURCE_DAM1
argument_list|,
name|DCF_IS_AUDIO
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_dam2"
argument_list|,
name|mux_sep_audio
argument_list|,
name|CLK_SOURCE_DAM2
argument_list|,
name|DCF_IS_AUDIO
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_hda2codec_2x"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_HDA2CODEC_2X
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_actmon"
argument_list|,
name|mux_p_c2_c_c3_clks_N_clkm
argument_list|,
name|CLK_SOURCE_ACTMON
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_extperiph1"
argument_list|,
name|mux_a_clks_p_clkm_e
argument_list|,
name|CLK_SOURCE_EXTPERIPH1
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_extperiph2"
argument_list|,
name|mux_a_clks_p_clkm_e
argument_list|,
name|CLK_SOURCE_EXTPERIPH2
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_extperiph3"
argument_list|,
name|mux_a_clks_p_clkm_e
argument_list|,
name|CLK_SOURCE_EXTPERIPH3
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_i2c_slow"
argument_list|,
name|mux_p_c2_c_c3_clks_N_clkm
argument_list|,
name|CLK_SOURCE_I2C_SLOW
argument_list|,
literal|0
argument_list|)
block|,
comment|/* SYS */
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_sor0"
argument_list|,
name|mux_p_m_d_a_c_d2_clkm
argument_list|,
name|CLK_SOURCE_SOR0
argument_list|,
name|DCF_IS_SOR0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_sata_oob"
argument_list|,
name|mux_p_N_c_N_m_N_clkm
argument_list|,
name|CLK_SOURCE_SATA_OOB
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_sata"
argument_list|,
name|mux_p_N_c_N_m_N_clkm
argument_list|,
name|CLK_SOURCE_SATA
argument_list|,
name|DCF_IS_SATA
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_hda"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_HDA
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
name|TEGRA124_CLK_XUSB_HOST_SRC
argument_list|,
literal|"pc_xusb_core_host"
argument_list|,
name|mux_clkm_p_c2_c_c3_refre
argument_list|,
name|CLK_SOURCE_XUSB_CORE_HOST
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
name|TEGRA124_CLK_XUSB_FALCON_SRC
argument_list|,
literal|"pc_xusb_falcon"
argument_list|,
name|mux_clkm_p_c2_c_c3_refre
argument_list|,
name|CLK_SOURCE_XUSB_FALCON
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
name|TEGRA124_CLK_XUSB_FS_SRC
argument_list|,
literal|"pc_xusb_fs"
argument_list|,
name|mux_clkm_N_u48_N_p_N_u480
argument_list|,
name|CLK_SOURCE_XUSB_FS
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
name|TEGRA124_CLK_XUSB_DEV_SRC
argument_list|,
literal|"pc_xusb_core_dev"
argument_list|,
name|mux_clkm_p_c2_c_c3_refre
argument_list|,
name|CLK_SOURCE_XUSB_CORE_DEV
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
name|TEGRA124_CLK_XUSB_SS_SRC
argument_list|,
literal|"pc_xusb_ss"
argument_list|,
name|mux_clkm_refe_clks_u480_c_c2_c3_oscdiv
argument_list|,
name|CLK_SOURCE_XUSB_SS
argument_list|,
name|DCF_IS_XUSB_SS
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_cilab"
argument_list|,
name|mux_p_N_c_N_N_N_clkm
argument_list|,
name|CLK_SOURCE_CILAB
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_cilcd"
argument_list|,
name|mux_p_N_c_N_N_N_clkm
argument_list|,
name|CLK_SOURCE_CILCD
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_cile"
argument_list|,
name|mux_p_N_c_N_N_N_clkm
argument_list|,
name|CLK_SOURCE_CILE
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_dsia_lp"
argument_list|,
name|mux_p_N_c_N_N_N_clkm
argument_list|,
name|CLK_SOURCE_DSIA_LP
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_dsib_lp"
argument_list|,
name|mux_p_N_c_N_N_N_clkm
argument_list|,
name|CLK_SOURCE_DSIB_LP
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_entropy"
argument_list|,
name|mux_p_clkm_clks_E
argument_list|,
name|CLK_SOURCE_ENTROPY
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_dvfs_ref"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_DVFS_REF
argument_list|,
name|DCF_HAVE_ENA
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_dvfs_soc"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_DVFS_SOC
argument_list|,
name|DCF_HAVE_ENA
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_traceclkin"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_TRACECLKIN
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_adx"
argument_list|,
name|mux_a_c2_c_c3_p_N_clkm
argument_list|,
name|CLK_SOURCE_ADX
argument_list|,
name|DCF_HAVE_ENA
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_amx"
argument_list|,
name|mux_a_c2_c_c3_p_N_clkm
argument_list|,
name|CLK_SOURCE_AMX
argument_list|,
name|DCF_HAVE_ENA
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_emc_latency"
argument_list|,
name|mux_m_c_p_clkm_mud_c2_c3
argument_list|,
name|CLK_SOURCE_EMC_LATENCY
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_soc_therm"
argument_list|,
name|mux_m_c_p_a_c2_c3
argument_list|,
name|CLK_SOURCE_SOC_THERM
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_vi_sensor2"
argument_list|,
name|mux_m_c2_c_c3_p_N_a
argument_list|,
name|CLK_SOURCE_VI_SENSOR2
argument_list|,
literal|0
argument_list|)
block|,
name|CLK16_0
argument_list|(
literal|0
argument_list|,
literal|"pc_i2c6"
argument_list|,
name|mux_p_c2_c_c3_m_N_clkm
argument_list|,
name|CLK_SOURCE_I2C6
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_emc_dll"
argument_list|,
name|mux_m_c_p_clkm_mud_c2_c3
argument_list|,
name|CLK_SOURCE_EMC_DLL
argument_list|,
name|DCF_IS_EMC_DLL
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_hdmi_audio"
argument_list|,
name|mux_p_c_c2_clkm
argument_list|,
name|CLK_SOURCE_HDMI_AUDIO
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_clk72mhz"
argument_list|,
name|mux_p_c_c2_clkm
argument_list|,
name|CLK_SOURCE_CLK72MHZ
argument_list|,
literal|0
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_adx1"
argument_list|,
name|mux_a_c2_c_c3_p_N_clkm
argument_list|,
name|CLK_SOURCE_ADX1
argument_list|,
name|DCF_HAVE_ENA
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_amx1"
argument_list|,
name|mux_a_c2_c_c3_p_N_clkm
argument_list|,
name|CLK_SOURCE_AMX1
argument_list|,
name|DCF_HAVE_ENA
argument_list|)
block|,
name|CLK_8_1
argument_list|(
literal|0
argument_list|,
literal|"pc_vic"
argument_list|,
name|mux_m_c_p_a_c2_c3_clkm
argument_list|,
name|CLK_SOURCE_VIC
argument_list|,
name|DCF_IS_VIC
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_function_decl
specifier|static
name|int
name|periph_init
parameter_list|(
name|struct
name|clknode
modifier|*
name|clk
parameter_list|,
name|device_t
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|periph_recalc
parameter_list|(
name|struct
name|clknode
modifier|*
name|clk
parameter_list|,
name|uint64_t
modifier|*
name|freq
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|periph_set_freq
parameter_list|(
name|struct
name|clknode
modifier|*
name|clk
parameter_list|,
name|uint64_t
name|fin
parameter_list|,
name|uint64_t
modifier|*
name|fout
parameter_list|,
name|int
name|flags
parameter_list|,
name|int
modifier|*
name|stop
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|periph_set_mux
parameter_list|(
name|struct
name|clknode
modifier|*
name|clk
parameter_list|,
name|int
name|idx
parameter_list|)
function_decl|;
end_function_decl

begin_struct
struct|struct
name|periph_sc
block|{
name|device_t
name|clkdev
decl_stmt|;
name|uint32_t
name|base_reg
decl_stmt|;
name|uint32_t
name|div_shift
decl_stmt|;
name|uint32_t
name|div_width
decl_stmt|;
name|uint32_t
name|div_mask
decl_stmt|;
name|uint32_t
name|div_f_width
decl_stmt|;
name|uint32_t
name|div_f_mask
decl_stmt|;
name|uint32_t
name|flags
decl_stmt|;
name|uint32_t
name|divider
decl_stmt|;
name|int
name|mux
decl_stmt|;
block|}
struct|;
end_struct

begin_decl_stmt
specifier|static
name|clknode_method_t
name|periph_methods
index|[]
init|=
block|{
comment|/* Device interface */
name|CLKNODEMETHOD
argument_list|(
name|clknode_init
argument_list|,
name|periph_init
argument_list|)
block|,
name|CLKNODEMETHOD
argument_list|(
name|clknode_recalc_freq
argument_list|,
name|periph_recalc
argument_list|)
block|,
name|CLKNODEMETHOD
argument_list|(
name|clknode_set_freq
argument_list|,
name|periph_set_freq
argument_list|)
block|,
name|CLKNODEMETHOD
argument_list|(
name|clknode_set_mux
argument_list|,
name|periph_set_mux
argument_list|)
block|,
name|CLKNODEMETHOD_END
block|}
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|DEFINE_CLASS_1
argument_list|(
name|tegra124_periph
argument_list|,
name|tegra124_periph_class
argument_list|,
name|periph_methods
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|periph_sc
argument_list|)
argument_list|,
name|clknode_class
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
specifier|static
name|int
name|periph_init
parameter_list|(
name|struct
name|clknode
modifier|*
name|clk
parameter_list|,
name|device_t
name|dev
parameter_list|)
block|{
name|struct
name|periph_sc
modifier|*
name|sc
decl_stmt|;
name|uint32_t
name|reg
decl_stmt|;
name|sc
operator|=
name|clknode_get_softc
argument_list|(
name|clk
argument_list|)
expr_stmt|;
name|DEVICE_LOCK
argument_list|(
name|sc
argument_list|)
expr_stmt|;
if|if
condition|(
name|sc
operator|->
name|flags
operator|&
name|DCF_HAVE_ENA
condition|)
name|MD4
argument_list|(
name|sc
argument_list|,
name|sc
operator|->
name|base_reg
argument_list|,
name|PERLCK_ENA_MASK
argument_list|,
name|PERLCK_ENA_MASK
argument_list|)
expr_stmt|;
name|RD4
argument_list|(
name|sc
argument_list|,
name|sc
operator|->
name|base_reg
argument_list|,
operator|&
name|reg
argument_list|)
expr_stmt|;
name|DEVICE_UNLOCK
argument_list|(
name|sc
argument_list|)
expr_stmt|;
comment|/* Stnadard mux. */
if|if
condition|(
name|sc
operator|->
name|flags
operator|&
name|DCF_HAVE_MUX
condition|)
name|sc
operator|->
name|mux
operator|=
operator|(
name|reg
operator|>>
name|PERLCK_MUX_SHIFT
operator|)
operator|&
name|PERLCK_MUX_MASK
expr_stmt|;
else|else
name|sc
operator|->
name|mux
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|sc
operator|->
name|flags
operator|&
name|DCF_HAVE_DIV
condition|)
name|sc
operator|->
name|divider
operator|=
operator|(
name|reg
operator|&
name|sc
operator|->
name|div_mask
operator|)
operator|+
literal|2
expr_stmt|;
else|else
name|sc
operator|->
name|divider
operator|=
literal|1
expr_stmt|;
if|if
condition|(
operator|(
name|sc
operator|->
name|flags
operator|&
name|DCF_IS_MASK
operator|)
operator|==
name|DCF_IS_UART
condition|)
block|{
if|if
condition|(
operator|!
operator|(
name|reg
operator|&
name|PERLCK_UDIV_DIS
operator|)
condition|)
name|sc
operator|->
name|divider
operator|=
literal|2
expr_stmt|;
block|}
comment|/* AUDIO MUX */
if|if
condition|(
operator|(
name|sc
operator|->
name|flags
operator|&
name|DCF_IS_MASK
operator|)
operator|==
name|DCF_IS_AUDIO
condition|)
block|{
if|if
condition|(
operator|!
operator|(
name|reg
operator|&
name|PERLCK_AMUX_DIS
operator|)
operator|&&
operator|(
name|sc
operator|->
name|mux
operator|==
literal|7
operator|)
condition|)
block|{
name|sc
operator|->
name|mux
operator|=
literal|8
operator|+
operator|(
operator|(
name|reg
operator|>>
name|PERLCK_AMUX_SHIFT
operator|)
operator|&
name|PERLCK_MUX_MASK
operator|)
expr_stmt|;
block|}
block|}
name|clknode_init_parent_idx
argument_list|(
name|clk
argument_list|,
name|sc
operator|->
name|mux
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|periph_set_mux
parameter_list|(
name|struct
name|clknode
modifier|*
name|clk
parameter_list|,
name|int
name|idx
parameter_list|)
block|{
name|struct
name|periph_sc
modifier|*
name|sc
decl_stmt|;
name|uint32_t
name|reg
decl_stmt|;
name|sc
operator|=
name|clknode_get_softc
argument_list|(
name|clk
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|sc
operator|->
name|flags
operator|&
name|DCF_HAVE_MUX
operator|)
condition|)
return|return
operator|(
name|ENXIO
operator|)
return|;
name|sc
operator|->
name|mux
operator|=
name|idx
expr_stmt|;
name|DEVICE_LOCK
argument_list|(
name|sc
argument_list|)
expr_stmt|;
name|RD4
argument_list|(
name|sc
argument_list|,
name|sc
operator|->
name|base_reg
argument_list|,
operator|&
name|reg
argument_list|)
expr_stmt|;
name|reg
operator|&=
operator|~
operator|(
name|PERLCK_MUX_MASK
operator|<<
name|PERLCK_MUX_SHIFT
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|sc
operator|->
name|flags
operator|&
name|DCF_IS_MASK
operator|)
operator|==
name|DCF_IS_AUDIO
condition|)
block|{
name|reg
operator|&=
operator|~
name|PERLCK_AMUX_DIS
expr_stmt|;
name|reg
operator|&=
operator|~
operator|(
name|PERLCK_MUX_MASK
operator|<<
name|PERLCK_AMUX_SHIFT
operator|)
expr_stmt|;
if|if
condition|(
name|idx
operator|<=
literal|7
condition|)
block|{
name|reg
operator||=
name|idx
operator|<<
name|PERLCK_MUX_SHIFT
expr_stmt|;
block|}
else|else
block|{
name|reg
operator||=
literal|7
operator|<<
name|PERLCK_MUX_SHIFT
expr_stmt|;
name|reg
operator||=
operator|(
name|idx
operator|-
literal|8
operator|)
operator|<<
name|PERLCK_AMUX_SHIFT
expr_stmt|;
block|}
block|}
else|else
block|{
name|reg
operator||=
name|idx
operator|<<
name|PERLCK_MUX_SHIFT
expr_stmt|;
block|}
name|WR4
argument_list|(
name|sc
argument_list|,
name|sc
operator|->
name|base_reg
argument_list|,
name|reg
argument_list|)
expr_stmt|;
name|DEVICE_UNLOCK
argument_list|(
name|sc
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|periph_recalc
parameter_list|(
name|struct
name|clknode
modifier|*
name|clk
parameter_list|,
name|uint64_t
modifier|*
name|freq
parameter_list|)
block|{
name|struct
name|periph_sc
modifier|*
name|sc
decl_stmt|;
name|uint32_t
name|reg
decl_stmt|;
name|sc
operator|=
name|clknode_get_softc
argument_list|(
name|clk
argument_list|)
expr_stmt|;
if|if
condition|(
name|sc
operator|->
name|flags
operator|&
name|DCF_HAVE_DIV
condition|)
block|{
name|DEVICE_LOCK
argument_list|(
name|sc
argument_list|)
expr_stmt|;
name|RD4
argument_list|(
name|sc
argument_list|,
name|sc
operator|->
name|base_reg
argument_list|,
operator|&
name|reg
argument_list|)
expr_stmt|;
name|DEVICE_UNLOCK
argument_list|(
name|sc
argument_list|)
expr_stmt|;
operator|*
name|freq
operator|=
operator|(
operator|*
name|freq
operator|<<
name|sc
operator|->
name|div_f_width
operator|)
operator|/
name|sc
operator|->
name|divider
expr_stmt|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|periph_set_freq
parameter_list|(
name|struct
name|clknode
modifier|*
name|clk
parameter_list|,
name|uint64_t
name|fin
parameter_list|,
name|uint64_t
modifier|*
name|fout
parameter_list|,
name|int
name|flags
parameter_list|,
name|int
modifier|*
name|stop
parameter_list|)
block|{
name|struct
name|periph_sc
modifier|*
name|sc
decl_stmt|;
name|uint64_t
name|tmp
decl_stmt|,
name|divider
decl_stmt|;
name|sc
operator|=
name|clknode_get_softc
argument_list|(
name|clk
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|sc
operator|->
name|flags
operator|&
name|DCF_HAVE_DIV
operator|)
condition|)
block|{
operator|*
name|stop
operator|=
literal|0
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
name|tmp
operator|=
name|fin
operator|<<
name|sc
operator|->
name|div_f_width
expr_stmt|;
name|divider
operator|=
name|tmp
operator|/
operator|*
name|fout
expr_stmt|;
if|if
condition|(
operator|(
name|tmp
operator|%
operator|*
name|fout
operator|)
operator|!=
literal|0
condition|)
name|divider
operator|++
expr_stmt|;
if|if
condition|(
name|divider
operator|<
operator|(
literal|1
operator|<<
name|sc
operator|->
name|div_f_width
operator|)
condition|)
name|divider
operator|=
literal|1
operator|<<
operator|(
name|sc
operator|->
name|div_f_width
operator|-
literal|1
operator|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|CLK_SET_DRYRUN
condition|)
block|{
if|if
condition|(
operator|(
operator|(
name|flags
operator|&
operator|(
name|CLK_SET_ROUND_UP
operator||
name|CLK_SET_ROUND_DOWN
operator|)
operator|)
operator|==
literal|0
operator|)
operator|&&
operator|(
operator|*
name|fout
operator|!=
operator|(
name|tmp
operator|/
name|divider
operator|)
operator|)
condition|)
return|return
operator|(
name|ERANGE
operator|)
return|;
block|}
else|else
block|{
name|DEVICE_LOCK
argument_list|(
name|sc
argument_list|)
expr_stmt|;
name|MD4
argument_list|(
name|sc
argument_list|,
name|sc
operator|->
name|base_reg
argument_list|,
name|sc
operator|->
name|div_mask
argument_list|,
operator|(
name|divider
operator|-
operator|(
literal|1
operator|<<
name|sc
operator|->
name|div_f_width
operator|)
operator|)
argument_list|)
expr_stmt|;
name|DEVICE_UNLOCK
argument_list|(
name|sc
argument_list|)
expr_stmt|;
name|sc
operator|->
name|divider
operator|=
name|divider
expr_stmt|;
block|}
operator|*
name|fout
operator|=
name|tmp
operator|/
name|divider
expr_stmt|;
operator|*
name|stop
operator|=
literal|1
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|periph_register
parameter_list|(
name|struct
name|clkdom
modifier|*
name|clkdom
parameter_list|,
name|struct
name|periph_def
modifier|*
name|clkdef
parameter_list|)
block|{
name|struct
name|clknode
modifier|*
name|clk
decl_stmt|;
name|struct
name|periph_sc
modifier|*
name|sc
decl_stmt|;
name|clk
operator|=
name|clknode_create
argument_list|(
name|clkdom
argument_list|,
operator|&
name|tegra124_periph_class
argument_list|,
operator|&
name|clkdef
operator|->
name|clkdef
argument_list|)
expr_stmt|;
if|if
condition|(
name|clk
operator|==
name|NULL
condition|)
return|return
operator|(
literal|1
operator|)
return|;
name|sc
operator|=
name|clknode_get_softc
argument_list|(
name|clk
argument_list|)
expr_stmt|;
name|sc
operator|->
name|clkdev
operator|=
name|clknode_get_device
argument_list|(
name|clk
argument_list|)
expr_stmt|;
name|sc
operator|->
name|base_reg
operator|=
name|clkdef
operator|->
name|base_reg
expr_stmt|;
name|sc
operator|->
name|div_width
operator|=
name|clkdef
operator|->
name|div_width
expr_stmt|;
name|sc
operator|->
name|div_mask
operator|=
operator|(
literal|1
operator|<<
name|clkdef
operator|->
name|div_width
operator|)
operator|-
literal|1
expr_stmt|;
name|sc
operator|->
name|div_f_width
operator|=
name|clkdef
operator|->
name|div_f_width
expr_stmt|;
name|sc
operator|->
name|div_f_mask
operator|=
operator|(
literal|1
operator|<<
name|clkdef
operator|->
name|div_f_width
operator|)
operator|-
literal|1
expr_stmt|;
name|sc
operator|->
name|flags
operator|=
name|clkdef
operator|->
name|flags
expr_stmt|;
name|clknode_register
argument_list|(
name|clkdom
argument_list|,
name|clk
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/* -------------------------------------------------------------------------- */
end_comment

begin_function_decl
specifier|static
name|int
name|pgate_init
parameter_list|(
name|struct
name|clknode
modifier|*
name|clk
parameter_list|,
name|device_t
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|pgate_set_gate
parameter_list|(
name|struct
name|clknode
modifier|*
name|clk
parameter_list|,
name|bool
name|enable
parameter_list|)
function_decl|;
end_function_decl

begin_struct
struct|struct
name|pgate_sc
block|{
name|device_t
name|clkdev
decl_stmt|;
name|uint32_t
name|idx
decl_stmt|;
name|uint32_t
name|flags
decl_stmt|;
name|uint32_t
name|enabled
decl_stmt|;
block|}
struct|;
end_struct

begin_decl_stmt
specifier|static
name|clknode_method_t
name|pgate_methods
index|[]
init|=
block|{
comment|/* Device interface */
name|CLKNODEMETHOD
argument_list|(
name|clknode_init
argument_list|,
name|pgate_init
argument_list|)
block|,
name|CLKNODEMETHOD
argument_list|(
name|clknode_set_gate
argument_list|,
name|pgate_set_gate
argument_list|)
block|,
name|CLKNODEMETHOD_END
block|}
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|DEFINE_CLASS_1
argument_list|(
name|tegra124_pgate
argument_list|,
name|tegra124_pgate_class
argument_list|,
name|pgate_methods
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|pgate_sc
argument_list|)
argument_list|,
name|clknode_class
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
specifier|static
name|uint32_t
name|get_enable_reg
parameter_list|(
name|int
name|idx
parameter_list|)
block|{
name|KASSERT
argument_list|(
name|idx
operator|/
literal|32
operator|<
name|nitems
argument_list|(
name|clk_enable_reg
argument_list|)
argument_list|,
operator|(
literal|"Invalid clock index for enable: %d"
operator|,
name|idx
operator|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|clk_enable_reg
index|[
name|idx
operator|/
literal|32
index|]
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|uint32_t
name|get_reset_reg
parameter_list|(
name|int
name|idx
parameter_list|)
block|{
name|KASSERT
argument_list|(
name|idx
operator|/
literal|32
operator|<
name|nitems
argument_list|(
name|clk_reset_reg
argument_list|)
argument_list|,
operator|(
literal|"Invalid clock index for reset: %d"
operator|,
name|idx
operator|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|clk_reset_reg
index|[
name|idx
operator|/
literal|32
index|]
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|pgate_init
parameter_list|(
name|struct
name|clknode
modifier|*
name|clk
parameter_list|,
name|device_t
name|dev
parameter_list|)
block|{
name|struct
name|pgate_sc
modifier|*
name|sc
decl_stmt|;
name|uint32_t
name|ena_reg
decl_stmt|,
name|rst_reg
decl_stmt|,
name|mask
decl_stmt|;
name|sc
operator|=
name|clknode_get_softc
argument_list|(
name|clk
argument_list|)
expr_stmt|;
name|mask
operator|=
literal|1
operator|<<
operator|(
name|sc
operator|->
name|idx
operator|%
literal|32
operator|)
expr_stmt|;
name|DEVICE_LOCK
argument_list|(
name|sc
argument_list|)
expr_stmt|;
name|RD4
argument_list|(
name|sc
argument_list|,
name|get_enable_reg
argument_list|(
name|sc
operator|->
name|idx
argument_list|)
argument_list|,
operator|&
name|ena_reg
argument_list|)
expr_stmt|;
name|RD4
argument_list|(
name|sc
argument_list|,
name|get_reset_reg
argument_list|(
name|sc
operator|->
name|idx
argument_list|)
argument_list|,
operator|&
name|rst_reg
argument_list|)
expr_stmt|;
name|DEVICE_UNLOCK
argument_list|(
name|sc
argument_list|)
expr_stmt|;
name|sc
operator|->
name|enabled
operator|=
name|ena_reg
operator|&
name|mask
condition|?
literal|1
else|:
literal|0
expr_stmt|;
name|clknode_init_parent_idx
argument_list|(
name|clk
argument_list|,
literal|0
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|pgate_set_gate
parameter_list|(
name|struct
name|clknode
modifier|*
name|clk
parameter_list|,
name|bool
name|enable
parameter_list|)
block|{
name|struct
name|pgate_sc
modifier|*
name|sc
decl_stmt|;
name|uint32_t
name|reg
decl_stmt|,
name|mask
decl_stmt|,
name|base_reg
decl_stmt|;
name|sc
operator|=
name|clknode_get_softc
argument_list|(
name|clk
argument_list|)
expr_stmt|;
name|mask
operator|=
literal|1
operator|<<
operator|(
name|sc
operator|->
name|idx
operator|%
literal|32
operator|)
expr_stmt|;
name|sc
operator|->
name|enabled
operator|=
name|enable
expr_stmt|;
name|base_reg
operator|=
name|get_enable_reg
argument_list|(
name|sc
operator|->
name|idx
argument_list|)
expr_stmt|;
name|DEVICE_LOCK
argument_list|(
name|sc
argument_list|)
expr_stmt|;
name|MD4
argument_list|(
name|sc
argument_list|,
name|base_reg
argument_list|,
name|mask
argument_list|,
name|enable
condition|?
name|mask
else|:
literal|0
argument_list|)
expr_stmt|;
name|RD4
argument_list|(
name|sc
argument_list|,
name|base_reg
argument_list|,
operator|&
name|reg
argument_list|)
expr_stmt|;
name|DEVICE_UNLOCK
argument_list|(
name|sc
argument_list|)
expr_stmt|;
name|DELAY
argument_list|(
literal|2
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
name|int
name|tegra124_hwreset_by_idx
parameter_list|(
name|struct
name|tegra124_car_softc
modifier|*
name|sc
parameter_list|,
name|intptr_t
name|idx
parameter_list|,
name|bool
name|reset
parameter_list|)
block|{
name|uint32_t
name|reg
decl_stmt|,
name|mask
decl_stmt|,
name|reset_reg
decl_stmt|;
name|mask
operator|=
literal|1
operator|<<
operator|(
name|idx
operator|%
literal|32
operator|)
expr_stmt|;
name|reset_reg
operator|=
name|get_reset_reg
argument_list|(
name|idx
argument_list|)
expr_stmt|;
name|CLKDEV_DEVICE_LOCK
argument_list|(
name|sc
operator|->
name|dev
argument_list|)
expr_stmt|;
name|CLKDEV_MODIFY_4
argument_list|(
name|sc
operator|->
name|dev
argument_list|,
name|reset_reg
argument_list|,
name|mask
argument_list|,
name|reset
condition|?
name|mask
else|:
literal|0
argument_list|)
expr_stmt|;
name|CLKDEV_READ_4
argument_list|(
name|sc
operator|->
name|dev
argument_list|,
name|reset_reg
argument_list|,
operator|&
name|reg
argument_list|)
expr_stmt|;
name|CLKDEV_DEVICE_UNLOCK
argument_list|(
name|sc
operator|->
name|dev
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|pgate_register
parameter_list|(
name|struct
name|clkdom
modifier|*
name|clkdom
parameter_list|,
name|struct
name|pgate_def
modifier|*
name|clkdef
parameter_list|)
block|{
name|struct
name|clknode
modifier|*
name|clk
decl_stmt|;
name|struct
name|pgate_sc
modifier|*
name|sc
decl_stmt|;
name|clk
operator|=
name|clknode_create
argument_list|(
name|clkdom
argument_list|,
operator|&
name|tegra124_pgate_class
argument_list|,
operator|&
name|clkdef
operator|->
name|clkdef
argument_list|)
expr_stmt|;
if|if
condition|(
name|clk
operator|==
name|NULL
condition|)
return|return
operator|(
literal|1
operator|)
return|;
name|sc
operator|=
name|clknode_get_softc
argument_list|(
name|clk
argument_list|)
expr_stmt|;
name|sc
operator|->
name|clkdev
operator|=
name|clknode_get_device
argument_list|(
name|clk
argument_list|)
expr_stmt|;
name|sc
operator|->
name|idx
operator|=
name|clkdef
operator|->
name|idx
expr_stmt|;
name|sc
operator|->
name|flags
operator|=
name|clkdef
operator|->
name|flags
expr_stmt|;
name|clknode_register
argument_list|(
name|clkdom
argument_list|,
name|clk
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
name|void
name|tegra124_periph_clock
parameter_list|(
name|struct
name|tegra124_car_softc
modifier|*
name|sc
parameter_list|)
block|{
name|int
name|i
decl_stmt|,
name|rv
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nitems
argument_list|(
name|periph_def
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
name|rv
operator|=
name|periph_register
argument_list|(
name|sc
operator|->
name|clkdom
argument_list|,
operator|&
name|periph_def
index|[
name|i
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|rv
operator|!=
literal|0
condition|)
name|panic
argument_list|(
literal|"tegra124_periph_register failed"
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nitems
argument_list|(
name|pgate_def
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
name|rv
operator|=
name|pgate_register
argument_list|(
name|sc
operator|->
name|clkdom
argument_list|,
operator|&
name|pgate_def
index|[
name|i
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|rv
operator|!=
literal|0
condition|)
name|panic
argument_list|(
literal|"tegra124_pgate_register failed"
argument_list|)
expr_stmt|;
block|}
block|}
end_function

end_unit

