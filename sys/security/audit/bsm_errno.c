begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2008 Apple Inc.  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1.  Redistributions of source code must retain the above copyright  *     notice, this list of conditions and the following disclaimer.  * 2.  Redistributions in binary form must reproduce the above copyright  *     notice, this list of conditions and the following disclaimer in the  *     documentation and/or other materials provided with the distribution.  * 3.  Neither the name of Apple Inc. ("Apple") nor the names of  *     its contributors may be used to endorse or promote products derived  *     from this software without specific prior written permission.  *  * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS "AS IS" AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR  * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING  * IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE  * POSSIBILITY OF SUCH DAMAGE.   */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<security/audit/audit.h>
end_include

begin_include
include|#
directive|include
file|<bsm/audit_errno.h>
end_include

begin_include
include|#
directive|include
file|<bsm/audit_record.h>
end_include

begin_include
include|#
directive|include
file|<sys/errno.h>
end_include

begin_comment
comment|/*  * Different operating systems use different numeric constants for different  * error numbers, and sometimes error numbers don't exist in more than one  * operating system.  These routines convert between BSM and local error  * number spaces, subject to the above realities.  BSM error numbers are  * stored in a single 8-bit character, so don't have a byte order.  *  * Don't include string definitions when this code is compiled into a kernel.  */
end_comment

begin_struct
struct|struct
name|bsm_errno
block|{
name|int
name|be_bsm_errno
decl_stmt|;
name|int
name|be_local_errno
decl_stmt|;
if|#
directive|if
operator|!
name|defined
argument_list|(
name|KERNEL
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|_KERNEL
argument_list|)
specifier|const
name|char
modifier|*
name|be_strerror
decl_stmt|;
endif|#
directive|endif
block|}
struct|;
end_struct

begin_define
define|#
directive|define
name|ERRNO_NO_LOCAL_MAPPING
value|-600
end_define

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|KERNEL
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|_KERNEL
argument_list|)
end_if

begin_define
define|#
directive|define
name|ES
parameter_list|(
name|x
parameter_list|)
value|x
end_define

begin_else
else|#
directive|else
end_else

begin_define
define|#
directive|define
name|ES
parameter_list|(
name|x
parameter_list|)
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/*  * Mapping table -- please maintain in numeric sorted order with respect to  * the BSM constant.  Today we do a linear lookup, but could switch to a  * binary search if it makes sense.  We only ifdef errors that aren't  * generally available, but it does make the table a lot more ugly.  *  * XXXRW: It would be nice to have a similar ordered table mapping to BSM  * constant from local constant, but the order of local constants varies by  * OS.  Really we need to build that table at compile-time but don't do that  * yet.  *  * XXXRW: We currently embed English-language error strings here, but should  * support catalogues; these are only used if the OS doesn't have an error  * string using strerror(3).  */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|bsm_errno
name|bsm_errnos
index|[]
init|=
block|{
block|{
name|BSM_ERRNO_ESUCCESS
block|,
literal|0
block|,
name|ES
argument_list|(
literal|"Success"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EPERM
block|,
name|EPERM
block|,
name|ES
argument_list|(
literal|"Operation not permitted"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOENT
block|,
name|ENOENT
block|,
name|ES
argument_list|(
literal|"No such file or directory"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ESRCH
block|,
name|ESRCH
block|,
name|ES
argument_list|(
literal|"No such process"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EINTR
block|,
name|EINTR
block|,
name|ES
argument_list|(
literal|"Interrupted system call"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EIO
block|,
name|EIO
block|,
name|ES
argument_list|(
literal|"Input/output error"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENXIO
block|,
name|ENXIO
block|,
name|ES
argument_list|(
literal|"Device not configured"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_E2BIG
block|,
name|E2BIG
block|,
name|ES
argument_list|(
literal|"Argument list too long"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOEXEC
block|,
name|ENOEXEC
block|,
name|ES
argument_list|(
literal|"Exec format error"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EBADF
block|,
name|EBADF
block|,
name|ES
argument_list|(
literal|"Bad file descriptor"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ECHILD
block|,
name|ECHILD
block|,
name|ES
argument_list|(
literal|"No child processes"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EAGAIN
block|,
name|EAGAIN
block|,
name|ES
argument_list|(
literal|"Resource temporarily unavailable"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOMEM
block|,
name|ENOMEM
block|,
name|ES
argument_list|(
literal|"Cannot allocate memory"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EACCES
block|,
name|EACCES
block|,
name|ES
argument_list|(
literal|"Permission denied"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EFAULT
block|,
name|EFAULT
block|,
name|ES
argument_list|(
literal|"Bad address"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOTBLK
block|,
name|ENOTBLK
block|,
name|ES
argument_list|(
literal|"Block device required"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EBUSY
block|,
name|EBUSY
block|,
name|ES
argument_list|(
literal|"Device busy"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EEXIST
block|,
name|EEXIST
block|,
name|ES
argument_list|(
literal|"File exists"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EXDEV
block|,
name|EXDEV
block|,
name|ES
argument_list|(
literal|"Cross-device link"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENODEV
block|,
name|ENODEV
block|,
name|ES
argument_list|(
literal|"Operation not supported by device"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOTDIR
block|,
name|ENOTDIR
block|,
name|ES
argument_list|(
literal|"Not a directory"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EISDIR
block|,
name|EISDIR
block|,
name|ES
argument_list|(
literal|"Is a directory"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EINVAL
block|,
name|EINVAL
block|,
name|ES
argument_list|(
literal|"Invalid argument"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENFILE
block|,
name|ENFILE
block|,
name|ES
argument_list|(
literal|"Too many open files in system"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EMFILE
block|,
name|EMFILE
block|,
name|ES
argument_list|(
literal|"Too many open files"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOTTY
block|,
name|ENOTTY
block|,
name|ES
argument_list|(
literal|"Inappropriate ioctl for device"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ETXTBSY
block|,
name|ETXTBSY
block|,
name|ES
argument_list|(
literal|"Text file busy"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EFBIG
block|,
name|EFBIG
block|,
name|ES
argument_list|(
literal|"File too large"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOSPC
block|,
name|ENOSPC
block|,
name|ES
argument_list|(
literal|"No space left on device"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ESPIPE
block|,
name|ESPIPE
block|,
name|ES
argument_list|(
literal|"Illegal seek"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EROFS
block|,
name|EROFS
block|,
name|ES
argument_list|(
literal|"Read-only file system"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EMLINK
block|,
name|EMLINK
block|,
name|ES
argument_list|(
literal|"Too many links"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EPIPE
block|,
name|EPIPE
block|,
name|ES
argument_list|(
literal|"Broken pipe"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EDOM
block|,
name|EDOM
block|,
name|ES
argument_list|(
literal|"Numerical argument out of domain"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ERANGE
block|,
name|ERANGE
block|,
name|ES
argument_list|(
literal|"Result too large"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOMSG
block|,
name|ENOMSG
block|,
name|ES
argument_list|(
literal|"No message of desired type"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EIDRM
block|,
name|EIDRM
block|,
name|ES
argument_list|(
literal|"Identifier removed"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ECHRNG
block|,
ifdef|#
directive|ifdef
name|ECHRNG
name|ECHRNG
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Channel number out of range"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EL2NSYNC
block|,
ifdef|#
directive|ifdef
name|EL2NSYNC
name|EL2NSYNC
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Level 2 not synchronized"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EL3HLT
block|,
ifdef|#
directive|ifdef
name|EL3HLT
name|EL3HLT
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Level 3 halted"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EL3RST
block|,
ifdef|#
directive|ifdef
name|EL3RST
name|EL3RST
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Level 3 reset"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ELNRNG
block|,
ifdef|#
directive|ifdef
name|ELNRNG
name|ELNRNG
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Link number out of range"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EUNATCH
block|,
ifdef|#
directive|ifdef
name|EUNATCH
name|EUNATCH
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Protocol driver not attached"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOCSI
block|,
ifdef|#
directive|ifdef
name|ENOCSI
name|ENOCSI
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"No CSI structure available"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EL2HLT
block|,
ifdef|#
directive|ifdef
name|EL2HLT
name|EL2HLT
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Level 2 halted"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EDEADLK
block|,
name|EDEADLK
block|,
name|ES
argument_list|(
literal|"Resource deadlock avoided"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOLCK
block|,
name|ENOLCK
block|,
name|ES
argument_list|(
literal|"No locks available"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ECANCELED
block|,
name|ECANCELED
block|,
name|ES
argument_list|(
literal|"Operation canceled"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOTSUP
block|,
name|ENOTSUP
block|,
name|ES
argument_list|(
literal|"Operation not supported"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EDQUOT
block|,
name|EDQUOT
block|,
name|ES
argument_list|(
literal|"Disc quota exceeded"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EBADE
block|,
ifdef|#
directive|ifdef
name|EBADE
name|EBADE
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Invalid exchange"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EBADR
block|,
ifdef|#
directive|ifdef
name|EBADR
name|EBADR
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Invalid request descriptor"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EXFULL
block|,
ifdef|#
directive|ifdef
name|EXFULL
name|EXFULL
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Exchange full"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOANO
block|,
ifdef|#
directive|ifdef
name|ENOANO
name|ENOANO
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"No anode"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EBADRQC
block|,
ifdef|#
directive|ifdef
name|EBADRQC
name|EBADRQC
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Invalid request descriptor"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EBADSLT
block|,
ifdef|#
directive|ifdef
name|EBADSLT
name|EBADSLT
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Invalid slot"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EDEADLOCK
block|,
ifdef|#
directive|ifdef
name|EDEADLOCK
name|EDEADLOCK
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Resource deadlock avoided"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EBFONT
block|,
ifdef|#
directive|ifdef
name|EBFONT
name|EBFONT
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Bad font file format"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EOWNERDEAD
block|,
ifdef|#
directive|ifdef
name|EOWNERDEAD
name|EOWNERDEAD
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Process died with the lock"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOTRECOVERABLE
block|,
ifdef|#
directive|ifdef
name|ENOTRECOVERABLE
name|ENOTRECOVERABLE
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Lock is not recoverable"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOSTR
block|,
ifdef|#
directive|ifdef
name|ENOSTR
name|ENOSTR
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Device not a stream"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENONET
block|,
ifdef|#
directive|ifdef
name|ENONET
name|ENONET
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Machine is not on the network"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOPKG
block|,
ifdef|#
directive|ifdef
name|ENOPKG
name|ENOPKG
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Package not installed"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EREMOTE
block|,
name|EREMOTE
block|,
name|ES
argument_list|(
literal|"Too many levels of remote in path"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOLINK
block|,
ifdef|#
directive|ifdef
name|ENOLINK
name|ENOLINK
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Link has been severed"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EADV
block|,
ifdef|#
directive|ifdef
name|EADV
name|EADV
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Advertise error"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ESRMNT
block|,
ifdef|#
directive|ifdef
name|ESRMNT
name|ESRMNT
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"srmount error"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ECOMM
block|,
ifdef|#
directive|ifdef
name|ECOMM
name|ECOMM
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Communication error on send"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EPROTO
block|,
ifdef|#
directive|ifdef
name|EPROTO
name|EPROTO
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Protocol error"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ELOCKUNMAPPED
block|,
ifdef|#
directive|ifdef
name|ELOCKUNMAPPED
name|ELOCKUNMAPPED
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Locked lock was unmapped"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOTACTIVE
block|,
ifdef|#
directive|ifdef
name|ENOTACTIVE
name|ENOTACTIVE
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Facility is not active"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EMULTIHOP
block|,
ifdef|#
directive|ifdef
name|EMULTIHOP
name|EMULTIHOP
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Multihop attempted"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EBADMSG
block|,
ifdef|#
directive|ifdef
name|EBADMSG
name|EBADMSG
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Bad message"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENAMETOOLONG
block|,
name|ENAMETOOLONG
block|,
name|ES
argument_list|(
literal|"File name too long"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EOVERFLOW
block|,
name|EOVERFLOW
block|,
name|ES
argument_list|(
literal|"Value too large to be stored in data type"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOTUNIQ
block|,
ifdef|#
directive|ifdef
name|ENOTUNIQ
name|ENOTUNIQ
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Given log name not unique"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EBADFD
block|,
ifdef|#
directive|ifdef
name|EBADFD
name|EBADFD
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Given f.d. invalid for this operation"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EREMCHG
block|,
ifdef|#
directive|ifdef
name|EREMCHG
name|EREMCHG
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Remote address changed"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ELIBACC
block|,
ifdef|#
directive|ifdef
name|ELIBACC
name|ELIBACC
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Can't access a needed shared lib"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ELIBBAD
block|,
ifdef|#
directive|ifdef
name|ELIBBAD
name|ELIBBAD
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Accessing a corrupted shared lib"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ELIBSCN
block|,
ifdef|#
directive|ifdef
name|ELIBSCN
name|ELIBSCN
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|".lib section in a.out corrupted"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ELIBMAX
block|,
ifdef|#
directive|ifdef
name|ELIBMAX
name|ELIBMAX
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Attempting to link in too many libs"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ELIBEXEC
block|,
ifdef|#
directive|ifdef
name|ELIBEXEC
name|ELIBEXEC
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Attempting to exec a shared library"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EILSEQ
block|,
name|EILSEQ
block|,
name|ES
argument_list|(
literal|"Illegal byte sequence"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOSYS
block|,
name|ENOSYS
block|,
name|ES
argument_list|(
literal|"Function not implemented"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ELOOP
block|,
name|ELOOP
block|,
name|ES
argument_list|(
literal|"Too many levels of symbolic links"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ERESTART
block|,
ifdef|#
directive|ifdef
name|ERESTART
name|ERESTART
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Restart syscall"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ESTRPIPE
block|,
ifdef|#
directive|ifdef
name|ESTRPIPE
name|ESTRPIPE
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"If pipe/FIFO, don't sleep in stream head"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOTEMPTY
block|,
name|ENOTEMPTY
block|,
name|ES
argument_list|(
literal|"Directory not empty"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EUSERS
block|,
name|EUSERS
block|,
name|ES
argument_list|(
literal|"Too many users"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOTSOCK
block|,
name|ENOTSOCK
block|,
name|ES
argument_list|(
literal|"Socket operation on non-socket"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EDESTADDRREQ
block|,
name|EDESTADDRREQ
block|,
name|ES
argument_list|(
literal|"Destination address required"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EMSGSIZE
block|,
name|EMSGSIZE
block|,
name|ES
argument_list|(
literal|"Message too long"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EPROTOTYPE
block|,
name|EPROTOTYPE
block|,
name|ES
argument_list|(
literal|"Protocol wrong type for socket"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOPROTOOPT
block|,
name|ENOPROTOOPT
block|,
name|ES
argument_list|(
literal|"Protocol not available"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EPROTONOSUPPORT
block|,
name|EPROTONOSUPPORT
block|,
name|ES
argument_list|(
literal|"Protocol not supported"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ESOCKTNOSUPPORT
block|,
name|ESOCKTNOSUPPORT
block|,
name|ES
argument_list|(
literal|"Socket type not supported"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EOPNOTSUPP
block|,
name|EOPNOTSUPP
block|,
name|ES
argument_list|(
literal|"Operation not supported"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EPFNOSUPPORT
block|,
name|EPFNOSUPPORT
block|,
name|ES
argument_list|(
literal|"Protocol family not supported"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EAFNOSUPPORT
block|,
name|EAFNOSUPPORT
block|,
name|ES
argument_list|(
literal|"Address family not supported by protocol family"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EADDRINUSE
block|,
name|EADDRINUSE
block|,
name|ES
argument_list|(
literal|"Address already in use"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EADDRNOTAVAIL
block|,
name|EADDRNOTAVAIL
block|,
name|ES
argument_list|(
literal|"Can't assign requested address"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENETDOWN
block|,
name|ENETDOWN
block|,
name|ES
argument_list|(
literal|"Network is down"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENETRESET
block|,
name|ENETRESET
block|,
name|ES
argument_list|(
literal|"Network dropped connection on reset"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ECONNABORTED
block|,
name|ECONNABORTED
block|,
name|ES
argument_list|(
literal|"Software caused connection abort"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ECONNRESET
block|,
name|ECONNRESET
block|,
name|ES
argument_list|(
literal|"Connection reset by peer"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOBUFS
block|,
name|ENOBUFS
block|,
name|ES
argument_list|(
literal|"No buffer space available"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EISCONN
block|,
name|EISCONN
block|,
name|ES
argument_list|(
literal|"Socket is already connected"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOTCONN
block|,
name|ENOTCONN
block|,
name|ES
argument_list|(
literal|"Socket is not connected"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ESHUTDOWN
block|,
name|ESHUTDOWN
block|,
name|ES
argument_list|(
literal|"Can't send after socket shutdown"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ETOOMANYREFS
block|,
name|ETOOMANYREFS
block|,
name|ES
argument_list|(
literal|"Too many references: can't splice"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ETIMEDOUT
block|,
name|ETIMEDOUT
block|,
name|ES
argument_list|(
literal|"Operation timed out"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ECONNREFUSED
block|,
name|ECONNREFUSED
block|,
name|ES
argument_list|(
literal|"Connection refused"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EHOSTDOWN
block|,
name|EHOSTDOWN
block|,
name|ES
argument_list|(
literal|"Host is down"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EHOSTUNREACH
block|,
name|EHOSTUNREACH
block|,
name|ES
argument_list|(
literal|"No route to host"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EALREADY
block|,
name|EALREADY
block|,
name|ES
argument_list|(
literal|"Operation already in progress"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EINPROGRESS
block|,
name|EINPROGRESS
block|,
name|ES
argument_list|(
literal|"Operation now in progress"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ESTALE
block|,
name|ESTALE
block|,
name|ES
argument_list|(
literal|"Stale NFS file handle"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EPROCLIM
block|,
ifdef|#
directive|ifdef
name|EPROCLIM
name|EPROCLIM
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Too many processes"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EBADRPC
block|,
ifdef|#
directive|ifdef
name|EBADRPC
name|EBADRPC
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"RPC struct is bad"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ERPCMISMATCH
block|,
ifdef|#
directive|ifdef
name|ERPCMISMATCH
name|ERPCMISMATCH
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"RPC version wrong"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EPROGUNAVAIL
block|,
ifdef|#
directive|ifdef
name|EPROGUNAVAIL
name|EPROGUNAVAIL
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"RPC prog. not avail"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EPROGMISMATCH
block|,
ifdef|#
directive|ifdef
name|EPROGMISMATCH
name|EPROGMISMATCH
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"RPC version wrong"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EPROCUNAVAIL
block|,
ifdef|#
directive|ifdef
name|EPROCUNAVAIL
name|EPROCUNAVAIL
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Bad procedure for program"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EFTYPE
block|,
ifdef|#
directive|ifdef
name|EFTYPE
name|EFTYPE
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Inappropriate file type or format"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EAUTH
block|,
ifdef|#
directive|ifdef
name|EAUTH
name|EAUTH
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Authenticateion error"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENEEDAUTH
block|,
ifdef|#
directive|ifdef
name|ENEEDAUTH
name|ENEEDAUTH
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Need authenticator"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOATTR
block|,
ifdef|#
directive|ifdef
name|ENOATTR
name|ENOATTR
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Attribute not found"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EDOOFUS
block|,
ifdef|#
directive|ifdef
name|EDOOFUS
name|EDOOFUS
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Programming error"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EJUSTRETURN
block|,
ifdef|#
directive|ifdef
name|EJUSTRETURN
name|EJUSTRETURN
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Just return"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOIOCTL
block|,
ifdef|#
directive|ifdef
name|ENOIOCTL
name|ENOIOCTL
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"ioctl not handled by this layer"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EDIRIOCTL
block|,
ifdef|#
directive|ifdef
name|EDIRIOCTL
name|EDIRIOCTL
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"do direct ioctl in GEOM"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EPWROFF
block|,
ifdef|#
directive|ifdef
name|EPWROFF
name|EPWROFF
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Device power is off"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EDEVERR
block|,
ifdef|#
directive|ifdef
name|EDEVERR
name|EDEVERR
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Device error"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EBADEXEC
block|,
ifdef|#
directive|ifdef
name|EBADEXEC
name|EBADEXEC
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Bad executable"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EBADARCH
block|,
ifdef|#
directive|ifdef
name|EBADARCH
name|EBADARCH
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Bad CPU type in executable"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ESHLIBVERS
block|,
ifdef|#
directive|ifdef
name|ESHLIBVERS
name|ESHLIBVERS
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Shared library version mismatch"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EBADMACHO
block|,
ifdef|#
directive|ifdef
name|EBADMACHO
name|EBADMACHO
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Malformed Macho file"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EPOLICY
block|,
ifdef|#
directive|ifdef
name|EPOLICY
name|EPOLICY
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Operation failed by policy"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EDOTDOT
block|,
ifdef|#
directive|ifdef
name|EDOTDOT
name|EDOTDOT
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"RFS specific error"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EUCLEAN
block|,
ifdef|#
directive|ifdef
name|EUCLEAN
name|EUCLEAN
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Structure needs cleaning"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOTNAM
block|,
ifdef|#
directive|ifdef
name|ENOTNAM
name|ENOTNAM
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Not a XENIX named type file"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENAVAIL
block|,
ifdef|#
directive|ifdef
name|ENAVAIL
name|ENAVAIL
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"No XENIX semaphores available"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EISNAM
block|,
ifdef|#
directive|ifdef
name|EISNAM
name|EISNAM
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Is a named type file"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EREMOTEIO
block|,
ifdef|#
directive|ifdef
name|EREMOTEIO
name|EREMOTEIO
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Remote I/O error"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOMEDIUM
block|,
ifdef|#
directive|ifdef
name|ENOMEDIUM
name|ENOMEDIUM
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"No medium found"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EMEDIUMTYPE
block|,
ifdef|#
directive|ifdef
name|EMEDIUMTYPE
name|EMEDIUMTYPE
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Wrong medium type"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOKEY
block|,
ifdef|#
directive|ifdef
name|ENOKEY
name|ENOKEY
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Required key not available"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EKEYEXPIRED
block|,
ifdef|#
directive|ifdef
name|EKEYEXPIRED
name|EKEYEXPIRED
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Key has expired"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EKEYREVOKED
block|,
ifdef|#
directive|ifdef
name|EKEYREVOKED
name|EKEYREVOKED
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Key has been revoked"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_EKEYREJECTED
block|,
ifdef|#
directive|ifdef
name|EKEYREJECTED
name|EKEYREJECTED
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Key was rejected by service"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ENOTCAPABLE
block|,
ifdef|#
directive|ifdef
name|ENOTCAPABLE
name|ENOTCAPABLE
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Capabilities insufficient"
argument_list|)
block|}
block|,
block|{
name|BSM_ERRNO_ECAPMODE
block|,
ifdef|#
directive|ifdef
name|ECAPMODE
name|ECAPMODE
block|,
else|#
directive|else
name|ERRNO_NO_LOCAL_MAPPING
block|,
endif|#
directive|endif
name|ES
argument_list|(
literal|"Not permitted in capability mode"
argument_list|)
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|int
name|bsm_errnos_count
init|=
sizeof|sizeof
argument_list|(
name|bsm_errnos
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|bsm_errnos
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
specifier|const
name|struct
name|bsm_errno
modifier|*
name|bsm_lookup_errno_local
parameter_list|(
name|int
name|local_errno
parameter_list|)
block|{
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|bsm_errnos_count
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|bsm_errnos
index|[
name|i
index|]
operator|.
name|be_local_errno
operator|==
name|local_errno
condition|)
return|return
operator|(
operator|&
name|bsm_errnos
index|[
name|i
index|]
operator|)
return|;
block|}
return|return
operator|(
name|NULL
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Conversion to the BSM errno space isn't allowed to fail; we simply map to  * BSM_ERRNO_UNKNOWN and let the remote endpoint deal with it.  */
end_comment

begin_function
name|u_char
name|au_errno_to_bsm
parameter_list|(
name|int
name|local_errno
parameter_list|)
block|{
specifier|const
name|struct
name|bsm_errno
modifier|*
name|bsme
decl_stmt|;
name|bsme
operator|=
name|bsm_lookup_errno_local
argument_list|(
name|local_errno
argument_list|)
expr_stmt|;
if|if
condition|(
name|bsme
operator|==
name|NULL
condition|)
return|return
operator|(
name|BSM_ERRNO_UNKNOWN
operator|)
return|;
return|return
operator|(
name|bsme
operator|->
name|be_bsm_errno
operator|)
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|struct
name|bsm_errno
modifier|*
name|bsm_lookup_errno_bsm
parameter_list|(
name|u_char
name|bsm_errno
parameter_list|)
block|{
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|bsm_errnos_count
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|bsm_errnos
index|[
name|i
index|]
operator|.
name|be_bsm_errno
operator|==
name|bsm_errno
condition|)
return|return
operator|(
operator|&
name|bsm_errnos
index|[
name|i
index|]
operator|)
return|;
block|}
return|return
operator|(
name|NULL
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Converstion from a BSM error to a local error number may fail if either  * OpenBSM doesn't recognize the error on the wire, or because there is no  * appropriate local mapping.  */
end_comment

begin_function
name|int
name|au_bsm_to_errno
parameter_list|(
name|u_char
name|bsm_errno
parameter_list|,
name|int
modifier|*
name|errorp
parameter_list|)
block|{
specifier|const
name|struct
name|bsm_errno
modifier|*
name|bsme
decl_stmt|;
name|bsme
operator|=
name|bsm_lookup_errno_bsm
argument_list|(
name|bsm_errno
argument_list|)
expr_stmt|;
if|if
condition|(
name|bsme
operator|==
name|NULL
operator|||
name|bsme
operator|->
name|be_local_errno
operator|==
name|ERRNO_NO_LOCAL_MAPPING
condition|)
return|return
operator|(
operator|-
literal|1
operator|)
return|;
operator|*
name|errorp
operator|=
name|bsme
operator|->
name|be_local_errno
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|KERNEL
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|_KERNEL
argument_list|)
end_if

begin_function
specifier|const
name|char
modifier|*
name|au_strerror
parameter_list|(
name|u_char
name|bsm_errno
parameter_list|)
block|{
specifier|const
name|struct
name|bsm_errno
modifier|*
name|bsme
decl_stmt|;
name|bsme
operator|=
name|bsm_lookup_errno_bsm
argument_list|(
name|bsm_errno
argument_list|)
expr_stmt|;
if|if
condition|(
name|bsme
operator|==
name|NULL
condition|)
return|return
operator|(
literal|"Unrecognized BSM error"
operator|)
return|;
if|if
condition|(
name|bsme
operator|->
name|be_local_errno
operator|!=
name|ERRNO_NO_LOCAL_MAPPING
condition|)
return|return
operator|(
name|strerror
argument_list|(
name|bsme
operator|->
name|be_local_errno
argument_list|)
operator|)
return|;
return|return
operator|(
name|bsme
operator|->
name|be_strerror
operator|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

end_unit

