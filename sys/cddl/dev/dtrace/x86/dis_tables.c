begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  *  * CDDL HEADER START  *  * The contents of this file are subject to the terms of the  * Common Development and Distribution License (the "License").  * You may not use this file except in compliance with the License.  *  * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE  * or http://www.opensolaris.org/os/licensing.  * See the License for the specific language governing permissions  * and limitations under the License.  *  * When distributing Covered Code, include this CDDL HEADER in each  * file and include the License file at usr/src/OPENSOLARIS.LICENSE.  * If applicable, add the following below this CDDL HEADER, with the  * fields enclosed by brackets "[]" replaced with your own identifying  * information: Portions Copyright [yyyy] [name of copyright owner]  *  * CDDL HEADER END  */
end_comment

begin_comment
comment|/*  * Copyright (c) 2003, 2010, Oracle and/or its affiliates. All rights reserved.  * Copyright (c) 2012, Joyent, Inc. All rights reserved.  */
end_comment

begin_comment
comment|/*  * Copyright (c) 2010, Intel Corporation.  * All rights reserved.  */
end_comment

begin_comment
comment|/*	Copyright (c) 1988 AT&T	*/
end_comment

begin_comment
comment|/*	  All Rights Reserved  	*/
end_comment

begin_comment
comment|/*  * $FreeBSD$  */
end_comment

begin_include
include|#
directive|include
file|"dis_tables.h"
end_include

begin_comment
comment|/* BEGIN CSTYLED */
end_comment

begin_comment
comment|/*  * Disassembly begins in dis_distable, which is equivalent to the One-byte  * Opcode Map in the Intel IA32 ISA Reference (page A-6 in my copy).  The  * decoding loops then traverse out through the other tables as necessary to  * decode a given instruction.  *  * The behavior of this file can be controlled by one of the following flags:  *  * 	DIS_TEXT	Include text for disassembly  * 	DIS_MEM		Include memory-size calculations  *  * Either or both of these can be defined.  *  * This file is not, and will never be, cstyled.  If anything, the tables should  * be taken out another tab stop or two so nothing overlaps.  */
end_comment

begin_comment
comment|/*  * These functions must be provided for the consumer to do disassembly.  */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|DIS_TEXT
end_ifdef

begin_function_decl
specifier|extern
name|char
modifier|*
name|strncpy
parameter_list|(
name|char
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|size_t
name|strlen
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|int
name|strcmp
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|int
name|strncmp
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|size_t
name|strlcat
parameter_list|(
name|char
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_define
define|#
directive|define
name|TERM
value|0
end_define

begin_comment
comment|/* used to indicate that the 'indirect' */
end_comment

begin_comment
comment|/* field terminates - no pointer.	*/
end_comment

begin_comment
comment|/* Used to decode instructions. */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|instable
block|{
name|struct
name|instable
modifier|*
name|it_indirect
decl_stmt|;
comment|/* for decode op codes */
name|uchar_t
name|it_adrmode
decl_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
name|char
name|it_name
index|[
name|NCPS
index|]
decl_stmt|;
name|uint_t
name|it_suffix
range|:
literal|1
decl_stmt|;
comment|/* mnem + "w", "l", or "d" */
endif|#
directive|endif
ifdef|#
directive|ifdef
name|DIS_MEM
name|uint_t
name|it_size
range|:
literal|16
decl_stmt|;
endif|#
directive|endif
name|uint_t
name|it_invalid64
range|:
literal|1
decl_stmt|;
comment|/* opcode invalid in amd64 */
name|uint_t
name|it_always64
range|:
literal|1
decl_stmt|;
comment|/* 64 bit when in 64 bit mode */
name|uint_t
name|it_invalid32
range|:
literal|1
decl_stmt|;
comment|/* invalid in IA32 */
name|uint_t
name|it_stackop
range|:
literal|1
decl_stmt|;
comment|/* push/pop stack operation */
block|}
name|instable_t
typedef|;
end_typedef

begin_comment
comment|/*  * Instruction formats.  */
end_comment

begin_enum
enum|enum
block|{
name|UNKNOWN
block|,
name|MRw
block|,
name|IMlw
block|,
name|IMw
block|,
name|IR
block|,
name|OA
block|,
name|AO
block|,
name|MS
block|,
name|SM
block|,
name|Mv
block|,
name|Mw
block|,
name|M
block|,
comment|/* register or memory */
name|MG9
block|,
comment|/* register or memory in group 9 (prefix optional) */
name|Mb
block|,
comment|/* register or memory, always byte sized */
name|MO
block|,
comment|/* memory only (no registers) */
name|PREF
block|,
name|SWAPGS_RDTSCP
block|,
name|MONITOR_MWAIT
block|,
name|R
block|,
name|RA
block|,
name|SEG
block|,
name|MR
block|,
name|RM
block|,
name|RM_66r
block|,
comment|/* RM, but with a required 0x66 prefix */
name|IA
block|,
name|MA
block|,
name|SD
block|,
name|AD
block|,
name|SA
block|,
name|D
block|,
name|INM
block|,
name|SO
block|,
name|BD
block|,
name|I
block|,
name|P
block|,
name|V
block|,
name|DSHIFT
block|,
comment|/* for double shift that has an 8-bit immediate */
name|U
block|,
name|OVERRIDE
block|,
name|NORM
block|,
comment|/* instructions w/o ModR/M byte, no memory access */
name|IMPLMEM
block|,
comment|/* instructions w/o ModR/M byte, implicit mem access */
name|O
block|,
comment|/* for call	*/
name|JTAB
block|,
comment|/* jump table 	*/
name|IMUL
block|,
comment|/* for 186 iimul instr  */
name|CBW
block|,
comment|/* so data16 can be evaluated for cbw and variants */
name|MvI
block|,
comment|/* for 186 logicals */
name|ENTER
block|,
comment|/* for 186 enter instr  */
name|RMw
block|,
comment|/* for 286 arpl instr */
name|Ib
block|,
comment|/* for push immediate byte */
name|F
block|,
comment|/* for 287 instructions */
name|FF
block|,
comment|/* for 287 instructions */
name|FFC
block|,
comment|/* for 287 instructions */
name|DM
block|,
comment|/* 16-bit data */
name|AM
block|,
comment|/* 16-bit addr */
name|LSEG
block|,
comment|/* for 3-bit seg reg encoding */
name|MIb
block|,
comment|/* for 386 logicals */
name|SREG
block|,
comment|/* for 386 special registers */
name|PREFIX
block|,
comment|/* a REP instruction prefix */
name|LOCK
block|,
comment|/* a LOCK instruction prefix */
name|INT3
block|,
comment|/* The int 3 instruction, which has a fake operand */
name|INTx
block|,
comment|/* The normal int instruction, with explicit int num */
name|DSHIFTcl
block|,
comment|/* for double shift that implicitly uses %cl */
name|CWD
block|,
comment|/* so data16 can be evaluated for cwd and variants */
name|RET
block|,
comment|/* single immediate 16-bit operand */
name|MOVZ
block|,
comment|/* for movs and movz, with different size operands */
name|CRC32
block|,
comment|/* for crc32, with different size operands */
name|XADDB
block|,
comment|/* for xaddb */
name|MOVSXZ
block|,
comment|/* AMD64 mov sign extend 32 to 64 bit instruction */
name|MOVBE
block|,
comment|/* movbe instruction */
comment|/*  * MMX/SIMD addressing modes.  */
name|MMO
block|,
comment|/* Prefixable MMX/SIMD-Int	mm/mem	-> mm */
name|MMOIMPL
block|,
comment|/* Prefixable MMX/SIMD-Int	mm	-> mm (mem) */
name|MMO3P
block|,
comment|/* Prefixable MMX/SIMD-Int	mm	-> r32,imm8 */
name|MMOM3
block|,
comment|/* Prefixable MMX/SIMD-Int	mm	-> r32 	*/
name|MMOS
block|,
comment|/* Prefixable MMX/SIMD-Int	mm	-> mm/mem */
name|MMOMS
block|,
comment|/* Prefixable MMX/SIMD-Int	mm	-> mem */
name|MMOPM
block|,
comment|/* MMX/SIMD-Int			mm/mem	-> mm,imm8 */
name|MMOPM_66o
block|,
comment|/* MMX/SIMD-Int 0x66 optional	mm/mem	-> mm,imm8 */
name|MMOPRM
block|,
comment|/* Prefixable MMX/SIMD-Int	r32/mem	-> mm,imm8 */
name|MMOSH
block|,
comment|/* Prefixable MMX		mm,imm8	*/
name|MM
block|,
comment|/* MMX/SIMD-Int			mm/mem	-> mm	*/
name|MMS
block|,
comment|/* MMX/SIMD-Int			mm	-> mm/mem */
name|MMSH
block|,
comment|/* MMX				mm,imm8 */
name|XMMO
block|,
comment|/* Prefixable SIMD		xmm/mem	-> xmm */
name|XMMOS
block|,
comment|/* Prefixable SIMD		xmm	-> xmm/mem */
name|XMMOPM
block|,
comment|/* Prefixable SIMD		xmm/mem	w/to xmm,imm8 */
name|XMMOMX
block|,
comment|/* Prefixable SIMD		mm/mem	-> xmm */
name|XMMOX3
block|,
comment|/* Prefixable SIMD		xmm	-> r32 */
name|XMMOXMM
block|,
comment|/* Prefixable SIMD		xmm/mem	-> mm	*/
name|XMMOM
block|,
comment|/* Prefixable SIMD		xmm	-> mem */
name|XMMOMS
block|,
comment|/* Prefixable SIMD		mem	-> xmm */
name|XMM
block|,
comment|/* SIMD 			xmm/mem	-> xmm */
name|XMM_66r
block|,
comment|/* SIMD 0x66 prefix required	xmm/mem	-> xmm */
name|XMM_66o
block|,
comment|/* SIMD 0x66 prefix optional 	xmm/mem	-> xmm */
name|XMMXIMPL
block|,
comment|/* SIMD				xmm	-> xmm (mem) */
name|XMM3P
block|,
comment|/* SIMD				xmm	-> r32,imm8 */
name|XMM3PM_66r
block|,
comment|/* SIMD 0x66 prefix required	xmm	-> r32/mem,imm8 */
name|XMMP
block|,
comment|/* SIMD 			xmm/mem w/to xmm,imm8 */
name|XMMP_66o
block|,
comment|/* SIMD 0x66 prefix optional	xmm/mem w/to xmm,imm8 */
name|XMMP_66r
block|,
comment|/* SIMD 0x66 prefix required	xmm/mem w/to xmm,imm8 */
name|XMMPRM
block|,
comment|/* SIMD 			r32/mem -> xmm,imm8 */
name|XMMPRM_66r
block|,
comment|/* SIMD 0x66 prefix required	r32/mem -> xmm,imm8 */
name|XMMS
block|,
comment|/* SIMD				xmm	-> xmm/mem */
name|XMMM
block|,
comment|/* SIMD 			mem	-> xmm */
name|XMMM_66r
block|,
comment|/* SIMD	0x66 prefix required	mem	-> xmm */
name|XMMMS
block|,
comment|/* SIMD				xmm	-> mem */
name|XMM3MX
block|,
comment|/* SIMD 			r32/mem -> xmm */
name|XMM3MXS
block|,
comment|/* SIMD 			xmm	-> r32/mem */
name|XMMSH
block|,
comment|/* SIMD 			xmm,imm8 */
name|XMMXM3
block|,
comment|/* SIMD 			xmm/mem -> r32 */
name|XMMX3
block|,
comment|/* SIMD 			xmm	-> r32 */
name|XMMXMM
block|,
comment|/* SIMD 			xmm/mem	-> mm */
name|XMMMX
block|,
comment|/* SIMD 			mm	-> xmm */
name|XMMXM
block|,
comment|/* SIMD 			xmm	-> mm */
name|XMMX2I
block|,
comment|/* SIMD				xmm -> xmm, imm, imm */
name|XMM2I
block|,
comment|/* SIMD				xmm, imm, imm */
name|XMMFENCE
block|,
comment|/* SIMD lfence or mfence */
name|XMMSFNC
block|,
comment|/* SIMD sfence (none or mem) */
name|XGETBV_XSETBV
block|,
name|VEX_NONE
block|,
comment|/* VEX  no operand */
name|VEX_MO
block|,
comment|/* VEX	mod_rm		               -> implicit reg */
name|VEX_RMrX
block|,
comment|/* VEX  VEX.vvvv, mod_rm               -> mod_reg */
name|VEX_RRX
block|,
comment|/* VEX  VEX.vvvv, mod_reg              -> mod_rm */
name|VEX_RMRX
block|,
comment|/* VEX  VEX.vvvv, mod_rm, imm8[7:4]    -> mod_reg */
name|VEX_MX
block|,
comment|/* VEX  mod_rm                         -> mod_reg */
name|VEX_MXI
block|,
comment|/* VEX  mod_rm, imm8                   -> mod_reg */
name|VEX_XXI
block|,
comment|/* VEX  mod_rm, imm8                   -> VEX.vvvv */
name|VEX_MR
block|,
comment|/* VEX  mod_rm                         -> mod_reg */
name|VEX_RRI
block|,
comment|/* VEX  mod_reg, mod_rm                -> implicit(eflags/r32) */
name|VEX_RX
block|,
comment|/* VEX  mod_reg                        -> mod_rm */
name|VEX_RR
block|,
comment|/* VEX  mod_rm                         -> mod_reg */
name|VEX_RRi
block|,
comment|/* VEX  mod_rm, imm8                   -> mod_reg */
name|VEX_RM
block|,
comment|/* VEX  mod_reg                        -> mod_rm */
name|VEX_RRM
block|,
comment|/* VEX  VEX.vvvv, mod_reg              -> mod_rm */
name|VEX_RMX
block|,
comment|/* VEX  VEX.vvvv, mod_rm               -> mod_reg */
name|VMx
block|,
comment|/* vmcall/vmlaunch/vmresume/vmxoff */
name|VMxo
block|,
comment|/* VMx instruction with optional prefix */
name|SVM
comment|/* AMD SVM instructions */
block|}
enum|;
end_enum

begin_comment
comment|/*  * VEX prefixes  */
end_comment

begin_define
define|#
directive|define
name|VEX_2bytes
value|0xC5
end_define

begin_comment
comment|/* the first byte of two-byte form */
end_comment

begin_define
define|#
directive|define
name|VEX_3bytes
value|0xC4
end_define

begin_comment
comment|/* the first byte of three-byte form */
end_comment

begin_define
define|#
directive|define
name|FILL
value|0x90
end_define

begin_comment
comment|/* Fill byte used for alignment (nop)	*/
end_comment

begin_comment
comment|/* ** Register numbers for the i386 */
end_comment

begin_define
define|#
directive|define
name|EAX_REGNO
value|0
end_define

begin_define
define|#
directive|define
name|ECX_REGNO
value|1
end_define

begin_define
define|#
directive|define
name|EDX_REGNO
value|2
end_define

begin_define
define|#
directive|define
name|EBX_REGNO
value|3
end_define

begin_define
define|#
directive|define
name|ESP_REGNO
value|4
end_define

begin_define
define|#
directive|define
name|EBP_REGNO
value|5
end_define

begin_define
define|#
directive|define
name|ESI_REGNO
value|6
end_define

begin_define
define|#
directive|define
name|EDI_REGNO
value|7
end_define

begin_comment
comment|/*  * modes for immediate values  */
end_comment

begin_define
define|#
directive|define
name|MODE_NONE
value|0
end_define

begin_define
define|#
directive|define
name|MODE_IPREL
value|1
end_define

begin_comment
comment|/* signed IP relative value */
end_comment

begin_define
define|#
directive|define
name|MODE_SIGNED
value|2
end_define

begin_comment
comment|/* sign extended immediate */
end_comment

begin_define
define|#
directive|define
name|MODE_IMPLIED
value|3
end_define

begin_comment
comment|/* constant value implied from opcode */
end_comment

begin_define
define|#
directive|define
name|MODE_OFFSET
value|4
end_define

begin_comment
comment|/* offset part of an address */
end_comment

begin_define
define|#
directive|define
name|MODE_RIPREL
value|5
end_define

begin_comment
comment|/* like IPREL, but from %rip (amd64) */
end_comment

begin_comment
comment|/*  * The letters used in these macros are:  *   IND - indirect to another to another table  *   "T" - means to Terminate indirections (this is the final opcode)  *   "S" - means "operand length suffix required"  *   "NS" - means "no suffix" which is the operand length suffix of the opcode  *   "Z" - means instruction size arg required  *   "u" - means the opcode is invalid in IA32 but valid in amd64  *   "x" - means the opcode is invalid in amd64, but not IA32  *   "y" - means the operand size is always 64 bits in 64 bit mode  *   "p" - means push/pop stack operation  */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|DIS_TEXT
argument_list|)
operator|&&
name|defined
argument_list|(
name|DIS_MEM
argument_list|)
end_if

begin_define
define|#
directive|define
name|IND
parameter_list|(
name|table
parameter_list|)
value|{(instable_t *)table, 0, "", 0, 0, 0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|INDx
parameter_list|(
name|table
parameter_list|)
value|{(instable_t *)table, 0, "", 0, 0, 1, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNS
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 0, 0, 0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNSu
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 0, 0, 0, 0, 1, 0}
end_define

begin_define
define|#
directive|define
name|TNSx
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 0, 0, 1, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNSy
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 0, 0, 0, 1, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNSyp
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 0, 0, 0, 1, 0, 1}
end_define

begin_define
define|#
directive|define
name|TNSZ
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode, name, 0, sz, 0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNSZy
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode, name, 0, sz, 0, 1, 0, 0}
end_define

begin_define
define|#
directive|define
name|TS
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 1, 0, 0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSx
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 1, 0, 1, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSy
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 1, 0, 0, 1, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSp
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 1, 0, 0, 0, 0, 1}
end_define

begin_define
define|#
directive|define
name|TSZ
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode, name, 1, sz, 0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSZx
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode, name, 1, sz, 1, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSZy
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode, name, 1, sz, 0, 1, 0, 0}
end_define

begin_define
define|#
directive|define
name|INVALID
value|{TERM, UNKNOWN, "", 0, 0, 0, 0, 0}
end_define

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|DIS_TEXT
argument_list|)
end_elif

begin_define
define|#
directive|define
name|IND
parameter_list|(
name|table
parameter_list|)
value|{(instable_t *)table, 0, "", 0, 0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|INDx
parameter_list|(
name|table
parameter_list|)
value|{(instable_t *)table, 0, "", 0, 1, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNS
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 0, 0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNSu
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 0, 0, 0, 1, 0}
end_define

begin_define
define|#
directive|define
name|TNSx
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 0, 1, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNSy
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 0, 0, 1, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNSyp
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 0, 0, 1, 0, 1}
end_define

begin_define
define|#
directive|define
name|TNSZ
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode, name, 0, 0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNSZy
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode, name, 0, 0, 1, 0, 0}
end_define

begin_define
define|#
directive|define
name|TS
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 1, 0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSx
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 1, 1, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSy
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 1, 0, 1, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSp
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode, name, 1, 0, 0, 0, 1}
end_define

begin_define
define|#
directive|define
name|TSZ
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode, name, 1, 0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSZx
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode, name, 1, 1, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSZy
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode, name, 1, 0, 1, 0, 0}
end_define

begin_define
define|#
directive|define
name|INVALID
value|{TERM, UNKNOWN, "", 0, 0, 0, 0, 0}
end_define

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|DIS_MEM
argument_list|)
end_elif

begin_define
define|#
directive|define
name|IND
parameter_list|(
name|table
parameter_list|)
value|{(instable_t *)table, 0, 0, 0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|INDx
parameter_list|(
name|table
parameter_list|)
value|{(instable_t *)table, 0, 0, 1, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNS
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  0, 0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNSu
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  0, 0, 0, 1, 0}
end_define

begin_define
define|#
directive|define
name|TNSy
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  0, 0, 1, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNSyp
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  0, 0, 1, 0, 1}
end_define

begin_define
define|#
directive|define
name|TNSx
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  0, 1, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNSZ
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode, sz, 0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNSZy
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode, sz, 0, 1, 0, 0}
end_define

begin_define
define|#
directive|define
name|TS
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  0, 0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSx
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  0, 1, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSy
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  0, 0, 1, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSp
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  0, 0, 0, 0, 1}
end_define

begin_define
define|#
directive|define
name|TSZ
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode, sz, 0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSZx
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode, sz, 1, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSZy
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode, sz, 0, 1, 0, 0}
end_define

begin_define
define|#
directive|define
name|INVALID
value|{TERM, UNKNOWN, 0, 0, 0, 0, 0}
end_define

begin_else
else|#
directive|else
end_else

begin_define
define|#
directive|define
name|IND
parameter_list|(
name|table
parameter_list|)
value|{(instable_t *)table, 0, 0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|INDx
parameter_list|(
name|table
parameter_list|)
value|{(instable_t *)table, 0, 1, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNS
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNSu
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  0, 0, 1, 0}
end_define

begin_define
define|#
directive|define
name|TNSy
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  0, 1, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNSyp
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  0, 1, 0, 1}
end_define

begin_define
define|#
directive|define
name|TNSx
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  1, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNSZ
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode,  0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TNSZy
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode,  0, 1, 0, 0}
end_define

begin_define
define|#
directive|define
name|TS
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSx
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  1, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSy
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  0, 1, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSp
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|)
value|{TERM, amode,  0, 0, 0, 1}
end_define

begin_define
define|#
directive|define
name|TSZ
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode,  0, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSZx
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode,  1, 0, 0, 0}
end_define

begin_define
define|#
directive|define
name|TSZy
parameter_list|(
name|name
parameter_list|,
name|amode
parameter_list|,
name|sz
parameter_list|)
value|{TERM, amode,  0, 1, 0, 0}
end_define

begin_define
define|#
directive|define
name|INVALID
value|{TERM, UNKNOWN, 0, 0, 0, 0}
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_ifdef
ifdef|#
directive|ifdef
name|DIS_TEXT
end_ifdef

begin_comment
comment|/*  * this decodes the r_m field for mode's 0, 1, 2 in 16 bit mode  */
end_comment

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_addr16
index|[
literal|3
index|]
index|[
literal|8
index|]
init|=
block|{
literal|"(%bx,%si)"
block|,
literal|"(%bx,%di)"
block|,
literal|"(%bp,%si)"
block|,
literal|"(%bp,%di)"
block|,
literal|"(%si)"
block|,
literal|"(%di)"
block|,
literal|""
block|,
literal|"(%bx)"
block|,
literal|"(%bx,%si)"
block|,
literal|"(%bx,%di)"
block|,
literal|"(%bp,%si)"
block|,
literal|"(%bp,%di)"
block|,
literal|"(%si)"
block|,
literal|"(%di"
block|,
literal|"(%bp)"
block|,
literal|"(%bx)"
block|,
literal|"(%bx,%si)"
block|,
literal|"(%bx,%di)"
block|,
literal|"(%bp,%si)"
block|,
literal|"(%bp,%di)"
block|,
literal|"(%si)"
block|,
literal|"(%di)"
block|,
literal|"(%bp)"
block|,
literal|"(%bx)"
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * This decodes 32 bit addressing mode r_m field for modes 0, 1, 2  */
end_comment

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_addr32_mode0
index|[
literal|16
index|]
init|=
block|{
literal|"(%eax)"
block|,
literal|"(%ecx)"
block|,
literal|"(%edx)"
block|,
literal|"(%ebx)"
block|,
literal|""
block|,
literal|""
block|,
literal|"(%esi)"
block|,
literal|"(%edi)"
block|,
literal|"(%r8d)"
block|,
literal|"(%r9d)"
block|,
literal|"(%r10d)"
block|,
literal|"(%r11d)"
block|,
literal|""
block|,
literal|""
block|,
literal|"(%r14d)"
block|,
literal|"(%r15d)"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_addr32_mode12
index|[
literal|16
index|]
init|=
block|{
literal|"(%eax)"
block|,
literal|"(%ecx)"
block|,
literal|"(%edx)"
block|,
literal|"(%ebx)"
block|,
literal|""
block|,
literal|"(%ebp)"
block|,
literal|"(%esi)"
block|,
literal|"(%edi)"
block|,
literal|"(%r8d)"
block|,
literal|"(%r9d)"
block|,
literal|"(%r10d)"
block|,
literal|"(%r11d)"
block|,
literal|""
block|,
literal|"(%r13d)"
block|,
literal|"(%r14d)"
block|,
literal|"(%r15d)"
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * This decodes 64 bit addressing mode r_m field for modes 0, 1, 2  */
end_comment

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_addr64_mode0
index|[
literal|16
index|]
init|=
block|{
literal|"(%rax)"
block|,
literal|"(%rcx)"
block|,
literal|"(%rdx)"
block|,
literal|"(%rbx)"
block|,
literal|""
block|,
literal|"(%rip)"
block|,
literal|"(%rsi)"
block|,
literal|"(%rdi)"
block|,
literal|"(%r8)"
block|,
literal|"(%r9)"
block|,
literal|"(%r10)"
block|,
literal|"(%r11)"
block|,
literal|"(%r12)"
block|,
literal|"(%rip)"
block|,
literal|"(%r14)"
block|,
literal|"(%r15)"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_addr64_mode12
index|[
literal|16
index|]
init|=
block|{
literal|"(%rax)"
block|,
literal|"(%rcx)"
block|,
literal|"(%rdx)"
block|,
literal|"(%rbx)"
block|,
literal|""
block|,
literal|"(%rbp)"
block|,
literal|"(%rsi)"
block|,
literal|"(%rdi)"
block|,
literal|"(%r8)"
block|,
literal|"(%r9)"
block|,
literal|"(%r10)"
block|,
literal|"(%r11)"
block|,
literal|"(%r12)"
block|,
literal|"(%r13)"
block|,
literal|"(%r14)"
block|,
literal|"(%r15)"
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * decode for scale from SIB byte  */
end_comment

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_scale_factor
index|[
literal|4
index|]
init|=
block|{
literal|")"
block|,
literal|",2)"
block|,
literal|",4)"
block|,
literal|",8)"
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * register decoding for normal references to registers (ie. not addressing)  */
end_comment

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_REG8
index|[
literal|16
index|]
init|=
block|{
literal|"%al"
block|,
literal|"%cl"
block|,
literal|"%dl"
block|,
literal|"%bl"
block|,
literal|"%ah"
block|,
literal|"%ch"
block|,
literal|"%dh"
block|,
literal|"%bh"
block|,
literal|"%r8b"
block|,
literal|"%r9b"
block|,
literal|"%r10b"
block|,
literal|"%r11b"
block|,
literal|"%r12b"
block|,
literal|"%r13b"
block|,
literal|"%r14b"
block|,
literal|"%r15b"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_REG8_REX
index|[
literal|16
index|]
init|=
block|{
literal|"%al"
block|,
literal|"%cl"
block|,
literal|"%dl"
block|,
literal|"%bl"
block|,
literal|"%spl"
block|,
literal|"%bpl"
block|,
literal|"%sil"
block|,
literal|"%dil"
block|,
literal|"%r8b"
block|,
literal|"%r9b"
block|,
literal|"%r10b"
block|,
literal|"%r11b"
block|,
literal|"%r12b"
block|,
literal|"%r13b"
block|,
literal|"%r14b"
block|,
literal|"%r15b"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_REG16
index|[
literal|16
index|]
init|=
block|{
literal|"%ax"
block|,
literal|"%cx"
block|,
literal|"%dx"
block|,
literal|"%bx"
block|,
literal|"%sp"
block|,
literal|"%bp"
block|,
literal|"%si"
block|,
literal|"%di"
block|,
literal|"%r8w"
block|,
literal|"%r9w"
block|,
literal|"%r10w"
block|,
literal|"%r11w"
block|,
literal|"%r12w"
block|,
literal|"%r13w"
block|,
literal|"%r14w"
block|,
literal|"%r15w"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_REG32
index|[
literal|16
index|]
init|=
block|{
literal|"%eax"
block|,
literal|"%ecx"
block|,
literal|"%edx"
block|,
literal|"%ebx"
block|,
literal|"%esp"
block|,
literal|"%ebp"
block|,
literal|"%esi"
block|,
literal|"%edi"
block|,
literal|"%r8d"
block|,
literal|"%r9d"
block|,
literal|"%r10d"
block|,
literal|"%r11d"
block|,
literal|"%r12d"
block|,
literal|"%r13d"
block|,
literal|"%r14d"
block|,
literal|"%r15d"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_REG64
index|[
literal|16
index|]
init|=
block|{
literal|"%rax"
block|,
literal|"%rcx"
block|,
literal|"%rdx"
block|,
literal|"%rbx"
block|,
literal|"%rsp"
block|,
literal|"%rbp"
block|,
literal|"%rsi"
block|,
literal|"%rdi"
block|,
literal|"%r8"
block|,
literal|"%r9"
block|,
literal|"%r10"
block|,
literal|"%r11"
block|,
literal|"%r12"
block|,
literal|"%r13"
block|,
literal|"%r14"
block|,
literal|"%r15"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_DEBUGREG
index|[
literal|16
index|]
init|=
block|{
literal|"%db0"
block|,
literal|"%db1"
block|,
literal|"%db2"
block|,
literal|"%db3"
block|,
literal|"%db4"
block|,
literal|"%db5"
block|,
literal|"%db6"
block|,
literal|"%db7"
block|,
literal|"%db8"
block|,
literal|"%db9"
block|,
literal|"%db10"
block|,
literal|"%db11"
block|,
literal|"%db12"
block|,
literal|"%db13"
block|,
literal|"%db14"
block|,
literal|"%db15"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_CONTROLREG
index|[
literal|16
index|]
init|=
block|{
literal|"%cr0"
block|,
literal|"%cr1"
block|,
literal|"%cr2"
block|,
literal|"%cr3"
block|,
literal|"%cr4"
block|,
literal|"%cr5?"
block|,
literal|"%cr6?"
block|,
literal|"%cr7?"
block|,
literal|"%cr8"
block|,
literal|"%cr9?"
block|,
literal|"%cr10?"
block|,
literal|"%cr11?"
block|,
literal|"%cr12?"
block|,
literal|"%cr13?"
block|,
literal|"%cr14?"
block|,
literal|"%cr15?"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_TESTREG
index|[
literal|16
index|]
init|=
block|{
literal|"%tr0?"
block|,
literal|"%tr1?"
block|,
literal|"%tr2?"
block|,
literal|"%tr3"
block|,
literal|"%tr4"
block|,
literal|"%tr5"
block|,
literal|"%tr6"
block|,
literal|"%tr7"
block|,
literal|"%tr0?"
block|,
literal|"%tr1?"
block|,
literal|"%tr2?"
block|,
literal|"%tr3"
block|,
literal|"%tr4"
block|,
literal|"%tr5"
block|,
literal|"%tr6"
block|,
literal|"%tr7"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_MMREG
index|[
literal|16
index|]
init|=
block|{
literal|"%mm0"
block|,
literal|"%mm1"
block|,
literal|"%mm2"
block|,
literal|"%mm3"
block|,
literal|"%mm4"
block|,
literal|"%mm5"
block|,
literal|"%mm6"
block|,
literal|"%mm7"
block|,
literal|"%mm0"
block|,
literal|"%mm1"
block|,
literal|"%mm2"
block|,
literal|"%mm3"
block|,
literal|"%mm4"
block|,
literal|"%mm5"
block|,
literal|"%mm6"
block|,
literal|"%mm7"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_XMMREG
index|[
literal|16
index|]
init|=
block|{
literal|"%xmm0"
block|,
literal|"%xmm1"
block|,
literal|"%xmm2"
block|,
literal|"%xmm3"
block|,
literal|"%xmm4"
block|,
literal|"%xmm5"
block|,
literal|"%xmm6"
block|,
literal|"%xmm7"
block|,
literal|"%xmm8"
block|,
literal|"%xmm9"
block|,
literal|"%xmm10"
block|,
literal|"%xmm11"
block|,
literal|"%xmm12"
block|,
literal|"%xmm13"
block|,
literal|"%xmm14"
block|,
literal|"%xmm15"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_YMMREG
index|[
literal|16
index|]
init|=
block|{
literal|"%ymm0"
block|,
literal|"%ymm1"
block|,
literal|"%ymm2"
block|,
literal|"%ymm3"
block|,
literal|"%ymm4"
block|,
literal|"%ymm5"
block|,
literal|"%ymm6"
block|,
literal|"%ymm7"
block|,
literal|"%ymm8"
block|,
literal|"%ymm9"
block|,
literal|"%ymm10"
block|,
literal|"%ymm11"
block|,
literal|"%ymm12"
block|,
literal|"%ymm13"
block|,
literal|"%ymm14"
block|,
literal|"%ymm15"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_SEGREG
index|[
literal|16
index|]
init|=
block|{
literal|"%es"
block|,
literal|"%cs"
block|,
literal|"%ss"
block|,
literal|"%ds"
block|,
literal|"%fs"
block|,
literal|"%gs"
block|,
literal|"<reserved>"
block|,
literal|"<reserved>"
block|,
literal|"%es"
block|,
literal|"%cs"
block|,
literal|"%ss"
block|,
literal|"%ds"
block|,
literal|"%fs"
block|,
literal|"%gs"
block|,
literal|"<reserved>"
block|,
literal|"<reserved>"
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * SIMD predicate suffixes  */
end_comment

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_PREDSUFFIX
index|[
literal|8
index|]
init|=
block|{
literal|"eq"
block|,
literal|"lt"
block|,
literal|"le"
block|,
literal|"unord"
block|,
literal|"neq"
block|,
literal|"nlt"
block|,
literal|"nle"
block|,
literal|"ord"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
specifier|const
name|dis_AVXvgrp7
index|[
literal|3
index|]
index|[
literal|8
index|]
init|=
block|{
comment|/*0	1	2		3		4		5	6		7*/
comment|/*71*/
block|{
literal|""
block|,
literal|""
block|,
literal|"vpsrlw"
block|,
literal|""
block|,
literal|"vpsraw"
block|,
literal|""
block|,
literal|"vpsllw"
block|,
literal|""
block|}
block|,
comment|/*72*/
block|{
literal|""
block|,
literal|""
block|,
literal|"vpsrld"
block|,
literal|""
block|,
literal|"vpsrad"
block|,
literal|""
block|,
literal|"vpslld"
block|,
literal|""
block|}
block|,
comment|/*73*/
block|{
literal|""
block|,
literal|""
block|,
literal|"vpsrlq"
block|,
literal|"vpsrldq"
block|,
literal|""
block|,
literal|""
block|,
literal|"vpsllq"
block|,
literal|"vpslldq"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* DIS_TEXT */
end_comment

begin_comment
comment|/*  *	"decode table" for 64 bit mode MOVSXD instruction (opcode 0x63)  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opMOVSLD
init|=
name|TNS
argument_list|(
literal|"movslq"
argument_list|,
name|MOVSXZ
argument_list|)
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	"decode table" for pause and clflush instructions  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opPause
init|=
name|TNS
argument_list|(
literal|"pause"
argument_list|,
name|NORM
argument_list|)
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0x0F00 opcodes  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op0F00
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TNS
argument_list|(
literal|"sldt"
argument_list|,
name|M
argument_list|)
block|,
name|TNS
argument_list|(
literal|"str"
argument_list|,
name|M
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"lldt"
argument_list|,
name|M
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"ltr"
argument_list|,
name|M
argument_list|)
block|,
comment|/*  [4]  */
name|TNSZ
argument_list|(
literal|"verr"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"verw"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0x0F01 opcodes  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op0F01
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TNSZ
argument_list|(
literal|"sgdt"
argument_list|,
name|VMx
argument_list|,
literal|6
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"sidt"
argument_list|,
name|MONITOR_MWAIT
argument_list|,
literal|6
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"lgdt"
argument_list|,
name|XGETBV_XSETBV
argument_list|,
literal|6
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"lidt"
argument_list|,
name|SVM
argument_list|,
literal|6
argument_list|)
block|,
comment|/*  [4]  */
name|TNSZ
argument_list|(
literal|"smsw"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"lmsw"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|,
name|TNS
argument_list|(
literal|"invlpg"
argument_list|,
name|SWAPGS_RDTSCP
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0x0F18 opcodes -- SIMD prefetch  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op0F18
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TNS
argument_list|(
literal|"prefetchnta"
argument_list|,
name|PREF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"prefetcht0"
argument_list|,
name|PREF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"prefetcht1"
argument_list|,
name|PREF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"prefetcht2"
argument_list|,
name|PREF
argument_list|)
block|,
comment|/*  [4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * 	Decode table for 0x0FAE opcodes -- SIMD state save/restore  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op0FAE
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TNSZ
argument_list|(
literal|"fxsave"
argument_list|,
name|M
argument_list|,
literal|512
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fxrstor"
argument_list|,
name|M
argument_list|,
literal|512
argument_list|)
block|,
name|TNS
argument_list|(
literal|"ldmxcsr"
argument_list|,
name|M
argument_list|)
block|,
name|TNS
argument_list|(
literal|"stmxcsr"
argument_list|,
name|M
argument_list|)
block|,
comment|/*  [4]  */
name|TNSZ
argument_list|(
literal|"xsave"
argument_list|,
name|M
argument_list|,
literal|512
argument_list|)
block|,
name|TNS
argument_list|(
literal|"lfence"
argument_list|,
name|XMMFENCE
argument_list|)
block|,
name|TNS
argument_list|(
literal|"mfence"
argument_list|,
name|XMMFENCE
argument_list|)
block|,
name|TNS
argument_list|(
literal|"sfence"
argument_list|,
name|XMMSFNC
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0x0FBA opcodes  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op0FBA
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [4]  */
name|TS
argument_list|(
literal|"bt"
argument_list|,
name|MIb
argument_list|)
block|,
name|TS
argument_list|(
literal|"bts"
argument_list|,
name|MIb
argument_list|)
block|,
name|TS
argument_list|(
literal|"btr"
argument_list|,
name|MIb
argument_list|)
block|,
name|TS
argument_list|(
literal|"btc"
argument_list|,
name|MIb
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * 	Decode table for 0x0FC7 opcode (group 9)  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op0FC7
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|INVALID
block|,
name|TNS
argument_list|(
literal|"cmpxchg8b"
argument_list|,
name|M
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [4]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"vmptrld"
argument_list|,
name|MG9
argument_list|)
block|,
name|TNS
argument_list|(
literal|"vmptrst"
argument_list|,
name|MG9
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * 	Decode table for 0x0FC7 opcode (group 9) mode 3  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op0FC7m3
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [4]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"rdrand"
argument_list|,
name|MG9
argument_list|)
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * 	Decode table for 0x0FC7 opcode with 0x66 prefix  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op660FC7
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [4]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"vmclear"
argument_list|,
name|M
argument_list|)
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * 	Decode table for 0x0FC7 opcode with 0xF3 prefix  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opF30FC7
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [4]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"vmxon"
argument_list|,
name|M
argument_list|)
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0x0FC8 opcode -- 486 bswap instruction  *  *bit pattern: 0000 1111 1100 1reg  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op0FC8
index|[
literal|4
index|]
init|=
block|{
comment|/*  [0]  */
name|TNS
argument_list|(
literal|"bswap"
argument_list|,
name|R
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0x0F71, 0x0F72, and 0x0F73 opcodes -- MMX instructions  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op0F7123
index|[
literal|4
index|]
index|[
literal|8
index|]
init|=
block|{
block|{
comment|/*  [70].0 */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*      .4 */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [71].0 */
name|INVALID
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"psrlw"
argument_list|,
name|MMOSH
argument_list|)
block|,
name|INVALID
block|,
comment|/*      .4 */
name|TNS
argument_list|(
literal|"psraw"
argument_list|,
name|MMOSH
argument_list|)
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"psllw"
argument_list|,
name|MMOSH
argument_list|)
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [72].0 */
name|INVALID
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"psrld"
argument_list|,
name|MMOSH
argument_list|)
block|,
name|INVALID
block|,
comment|/*      .4 */
name|TNS
argument_list|(
literal|"psrad"
argument_list|,
name|MMOSH
argument_list|)
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"pslld"
argument_list|,
name|MMOSH
argument_list|)
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [73].0 */
name|INVALID
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"psrlq"
argument_list|,
name|MMOSH
argument_list|)
block|,
name|TNS
argument_list|(
literal|"INVALID"
argument_list|,
name|MMOSH
argument_list|)
block|,
comment|/*      .4 */
name|INVALID
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"psllq"
argument_list|,
name|MMOSH
argument_list|)
block|,
name|TNS
argument_list|(
literal|"INVALID"
argument_list|,
name|MMOSH
argument_list|)
block|, }
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for SIMD extensions to above 0x0F71-0x0F73 opcodes.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opSIMD7123
index|[
literal|32
index|]
init|=
block|{
comment|/* [70].0 */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*     .4 */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/* [71].0 */
name|INVALID
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"psrlw"
argument_list|,
name|XMMSH
argument_list|)
block|,
name|INVALID
block|,
comment|/*     .4 */
name|TNS
argument_list|(
literal|"psraw"
argument_list|,
name|XMMSH
argument_list|)
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"psllw"
argument_list|,
name|XMMSH
argument_list|)
block|,
name|INVALID
block|,
comment|/* [72].0 */
name|INVALID
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"psrld"
argument_list|,
name|XMMSH
argument_list|)
block|,
name|INVALID
block|,
comment|/*     .4 */
name|TNS
argument_list|(
literal|"psrad"
argument_list|,
name|XMMSH
argument_list|)
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"pslld"
argument_list|,
name|XMMSH
argument_list|)
block|,
name|INVALID
block|,
comment|/* [73].0 */
name|INVALID
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"psrlq"
argument_list|,
name|XMMSH
argument_list|)
block|,
name|TNS
argument_list|(
literal|"psrldq"
argument_list|,
name|XMMSH
argument_list|)
block|,
comment|/*     .4 */
name|INVALID
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"psllq"
argument_list|,
name|XMMSH
argument_list|)
block|,
name|TNS
argument_list|(
literal|"pslldq"
argument_list|,
name|XMMSH
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	SIMD instructions have been wedged into the existing IA32 instruction  *	set through the use of prefixes.  That is, while 0xf0 0x58 may be  *	addps, 0xf3 0xf0 0x58 (literally, repz addps) is a completely different  *	instruction - addss.  At present, three prefixes have been coopted in  *	this manner - address size (0x66), repnz (0xf2) and repz (0xf3).  The  *	following tables are used to provide the prefixed instruction names.  *	The arrays are sparse, but they're fast.  */
end_comment

begin_comment
comment|/*  *	Decode table for SIMD instructions with the address size (0x66) prefix.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opSIMDdata16
index|[
literal|256
index|]
init|=
block|{
comment|/*  [00]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [04]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [08]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [0C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [10]  */
name|TNSZ
argument_list|(
literal|"movupd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movupd"
argument_list|,
name|XMMS
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movlpd"
argument_list|,
name|XMMM
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movlpd"
argument_list|,
name|XMMMS
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [14]  */
name|TNSZ
argument_list|(
literal|"unpcklpd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"unpckhpd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movhpd"
argument_list|,
name|XMMM
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movhpd"
argument_list|,
name|XMMMS
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [18]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [1C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [20]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [24]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [28]  */
name|TNSZ
argument_list|(
literal|"movapd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movapd"
argument_list|,
name|XMMS
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"cvtpi2pd"
argument_list|,
name|XMMOMX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movntpd"
argument_list|,
name|XMMOMS
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [2C]  */
name|TNSZ
argument_list|(
literal|"cvttpd2pi"
argument_list|,
name|XMMXMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"cvtpd2pi"
argument_list|,
name|XMMXMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"ucomisd"
argument_list|,
name|XMM
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"comisd"
argument_list|,
name|XMM
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [30]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [34]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [38]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [3C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [40]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [44]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [48]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [4C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [50]  */
name|TNS
argument_list|(
literal|"movmskpd"
argument_list|,
name|XMMOX3
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"sqrtpd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [54]  */
name|TNSZ
argument_list|(
literal|"andpd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"andnpd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"orpd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"xorpd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [58]  */
name|TNSZ
argument_list|(
literal|"addpd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"mulpd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"cvtpd2ps"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"cvtps2dq"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [5C]  */
name|TNSZ
argument_list|(
literal|"subpd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"minpd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"divpd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"maxpd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [60]  */
name|TNSZ
argument_list|(
literal|"punpcklbw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"punpcklwd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"punpckldq"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"packsswb"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [64]  */
name|TNSZ
argument_list|(
literal|"pcmpgtb"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pcmpgtw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pcmpgtd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"packuswb"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [68]  */
name|TNSZ
argument_list|(
literal|"punpckhbw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"punpckhwd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"punpckhdq"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"packssdw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [6C]  */
name|TNSZ
argument_list|(
literal|"punpcklqdq"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"punpckhqdq"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movd"
argument_list|,
name|XMM3MX
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movdqa"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [70]  */
name|TNSZ
argument_list|(
literal|"pshufd"
argument_list|,
name|XMMP
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [74]  */
name|TNSZ
argument_list|(
literal|"pcmpeqb"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pcmpeqw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pcmpeqd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [78]  */
name|TNSZ
argument_list|(
literal|"extrq"
argument_list|,
name|XMM2I
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"extrq"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [7C]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"movd"
argument_list|,
name|XMM3MXS
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movdqa"
argument_list|,
name|XMMS
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [80]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [84]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [88]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [8C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [90]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [94]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [98]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [9C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [AC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [BC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C0]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"cmppd"
argument_list|,
name|XMMP
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [C4]  */
name|TNSZ
argument_list|(
literal|"pinsrw"
argument_list|,
name|XMMPRM
argument_list|,
literal|2
argument_list|)
block|,
name|TNS
argument_list|(
literal|"pextrw"
argument_list|,
name|XMM3P
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"shufpd"
argument_list|,
name|XMMP
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [C8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [CC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D0]  */
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"psrlw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psrld"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psrlq"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [D4]  */
name|TNSZ
argument_list|(
literal|"paddq"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmullw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movq"
argument_list|,
name|XMMS
argument_list|,
literal|8
argument_list|)
block|,
name|TNS
argument_list|(
literal|"pmovmskb"
argument_list|,
name|XMMX3
argument_list|)
block|,
comment|/*  [D8]  */
name|TNSZ
argument_list|(
literal|"psubusb"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psubusw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pminub"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pand"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [DC]  */
name|TNSZ
argument_list|(
literal|"paddusb"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"paddusw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmaxub"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pandn"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [E0]  */
name|TNSZ
argument_list|(
literal|"pavgb"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psraw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psrad"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pavgw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [E4]  */
name|TNSZ
argument_list|(
literal|"pmulhuw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmulhw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"cvttpd2dq"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movntdq"
argument_list|,
name|XMMS
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [E8]  */
name|TNSZ
argument_list|(
literal|"psubsb"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psubsw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pminsw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"por"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [EC]  */
name|TNSZ
argument_list|(
literal|"paddsb"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"paddsw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmaxsw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pxor"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [F0]  */
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"psllw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pslld"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psllq"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [F4]  */
name|TNSZ
argument_list|(
literal|"pmuludq"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmaddwd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psadbw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"maskmovdqu"
argument_list|,
name|XMMXIMPL
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [F8]  */
name|TNSZ
argument_list|(
literal|"psubb"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psubw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psubd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psubq"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [FC]  */
name|TNSZ
argument_list|(
literal|"paddb"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"paddw"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"paddd"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opAVX660F
index|[
literal|256
index|]
init|=
block|{
comment|/*  [00]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [04]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [08]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [0C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [10]  */
name|TNSZ
argument_list|(
literal|"vmovupd"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovupd"
argument_list|,
name|VEX_RX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovlpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovlpd"
argument_list|,
name|VEX_RM
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [14]  */
name|TNSZ
argument_list|(
literal|"vunpcklpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vunpckhpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovhpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovhpd"
argument_list|,
name|VEX_RM
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [18]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [1C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [20]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [24]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [28]  */
name|TNSZ
argument_list|(
literal|"vmovapd"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovapd"
argument_list|,
name|VEX_RX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vmovntpd"
argument_list|,
name|VEX_RM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [2C]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vucomisd"
argument_list|,
name|VEX_MX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vcomisd"
argument_list|,
name|VEX_MX
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [30]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [34]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [38]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [3C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [40]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [44]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [48]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [4C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [50]  */
name|TNS
argument_list|(
literal|"vmovmskpd"
argument_list|,
name|VEX_MR
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vsqrtpd"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [54]  */
name|TNSZ
argument_list|(
literal|"vandpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vandnpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vorpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vxorpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [58]  */
name|TNSZ
argument_list|(
literal|"vaddpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmulpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vcvtpd2ps"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vcvtps2dq"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [5C]  */
name|TNSZ
argument_list|(
literal|"vsubpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vminpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vdivpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmaxpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [60]  */
name|TNSZ
argument_list|(
literal|"vpunpcklbw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpunpcklwd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpunpckldq"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpacksswb"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [64]  */
name|TNSZ
argument_list|(
literal|"vpcmpgtb"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpcmpgtw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpcmpgtd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpackuswb"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [68]  */
name|TNSZ
argument_list|(
literal|"vpunpckhbw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpunpckhwd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpunpckhdq"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpackssdw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [6C]  */
name|TNSZ
argument_list|(
literal|"vpunpcklqdq"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpunpckhqdq"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovd"
argument_list|,
name|VEX_MX
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovdqa"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [70]  */
name|TNSZ
argument_list|(
literal|"vpshufd"
argument_list|,
name|VEX_MXI
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vgrp71"
argument_list|,
name|VEX_XXI
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vgrp72"
argument_list|,
name|VEX_XXI
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vgrp73"
argument_list|,
name|VEX_XXI
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [74]  */
name|TNSZ
argument_list|(
literal|"vpcmpeqb"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpcmpeqw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpcmpeqd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [78]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [7C]  */
name|TNSZ
argument_list|(
literal|"vhaddpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vhsubpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovd"
argument_list|,
name|VEX_RR
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovdqa"
argument_list|,
name|VEX_RX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [80]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [84]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [88]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [8C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [90]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [94]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [98]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [9C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [AC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [BC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C0]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vcmppd"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [C4]  */
name|TNSZ
argument_list|(
literal|"vpinsrw"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|2
argument_list|)
block|,
name|TNS
argument_list|(
literal|"vpextrw"
argument_list|,
name|VEX_MR
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vshufpd"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [C8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [CC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D0]  */
name|TNSZ
argument_list|(
literal|"vaddsubpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpsrlw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpsrld"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpsrlq"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [D4]  */
name|TNSZ
argument_list|(
literal|"vpaddq"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpmullw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovq"
argument_list|,
name|VEX_RX
argument_list|,
literal|8
argument_list|)
block|,
name|TNS
argument_list|(
literal|"vpmovmskb"
argument_list|,
name|VEX_MR
argument_list|)
block|,
comment|/*  [D8]  */
name|TNSZ
argument_list|(
literal|"vpsubusb"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpsubusw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpminub"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpand"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [DC]  */
name|TNSZ
argument_list|(
literal|"vpaddusb"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpaddusw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpmaxub"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpandn"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [E0]  */
name|TNSZ
argument_list|(
literal|"vpavgb"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpsraw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpsrad"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpavgw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [E4]  */
name|TNSZ
argument_list|(
literal|"vpmulhuw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpmulhw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vcvttpd2dq"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovntdq"
argument_list|,
name|VEX_RM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [E8]  */
name|TNSZ
argument_list|(
literal|"vpsubsb"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpsubsw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpminsw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpor"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [EC]  */
name|TNSZ
argument_list|(
literal|"vpaddsb"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpaddsw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpmaxsw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpxor"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [F0]  */
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vpsllw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpslld"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpsllq"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [F4]  */
name|TNSZ
argument_list|(
literal|"vpmuludq"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpmaddwd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpsadbw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNS
argument_list|(
literal|"vmaskmovdqu"
argument_list|,
name|VEX_MX
argument_list|)
block|,
comment|/*  [F8]  */
name|TNSZ
argument_list|(
literal|"vpsubb"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpsubw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpsubd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpsubq"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [FC]  */
name|TNSZ
argument_list|(
literal|"vpaddb"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpaddw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpaddd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for SIMD instructions with the repnz (0xf2) prefix.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opSIMDrepnz
index|[
literal|256
index|]
init|=
block|{
comment|/*  [00]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [04]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [08]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [0C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [10]  */
name|TNSZ
argument_list|(
literal|"movsd"
argument_list|,
name|XMM
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movsd"
argument_list|,
name|XMMS
argument_list|,
literal|8
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [14]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [18]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [1C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [20]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [24]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [28]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"cvtsi2sd"
argument_list|,
name|XMM3MX
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movntsd"
argument_list|,
name|XMMMS
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [2C]  */
name|TNSZ
argument_list|(
literal|"cvttsd2si"
argument_list|,
name|XMMXM3
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"cvtsd2si"
argument_list|,
name|XMMXM3
argument_list|,
literal|8
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [30]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [34]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [38]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [3C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [40]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [44]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [48]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [4C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [50]  */
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"sqrtsd"
argument_list|,
name|XMM
argument_list|,
literal|8
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [54]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [58]  */
name|TNSZ
argument_list|(
literal|"addsd"
argument_list|,
name|XMM
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"mulsd"
argument_list|,
name|XMM
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"cvtsd2ss"
argument_list|,
name|XMM
argument_list|,
literal|8
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [5C]  */
name|TNSZ
argument_list|(
literal|"subsd"
argument_list|,
name|XMM
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"minsd"
argument_list|,
name|XMM
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"divsd"
argument_list|,
name|XMM
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"maxsd"
argument_list|,
name|XMM
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [60]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [64]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [68]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [6C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [70]  */
name|TNSZ
argument_list|(
literal|"pshuflw"
argument_list|,
name|XMMP
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [74]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [78]  */
name|TNSZ
argument_list|(
literal|"insertq"
argument_list|,
name|XMMX2I
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"insertq"
argument_list|,
name|XMM
argument_list|,
literal|8
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [7C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [80]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [84]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [88]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [0C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [90]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [94]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [98]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [9C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [AC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [BC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C0]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"cmpsd"
argument_list|,
name|XMMP
argument_list|,
literal|8
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [C4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [CC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D4]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"movdq2q"
argument_list|,
name|XMMXM
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [D8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [DC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E4]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"cvtpd2dq"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [E8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [EC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [FC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opAVXF20F
index|[
literal|256
index|]
init|=
block|{
comment|/*  [00]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [04]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [08]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [0C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [10]  */
name|TNSZ
argument_list|(
literal|"vmovsd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovsd"
argument_list|,
name|VEX_RRX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovddup"
argument_list|,
name|VEX_MX
argument_list|,
literal|8
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [14]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [18]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [1C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [20]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [24]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [28]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vcvtsi2sd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|4
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [2C]  */
name|TNSZ
argument_list|(
literal|"vcvttsd2si"
argument_list|,
name|VEX_MR
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vcvtsd2si"
argument_list|,
name|VEX_MR
argument_list|,
literal|8
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [30]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [34]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [38]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [3C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [40]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [44]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [48]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [4C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [50]  */
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vsqrtsd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [54]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [58]  */
name|TNSZ
argument_list|(
literal|"vaddsd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmulsd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vcvtsd2ss"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [5C]  */
name|TNSZ
argument_list|(
literal|"vsubsd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vminsd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vdivsd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmaxsd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [60]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [64]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [68]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [6C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [70]  */
name|TNSZ
argument_list|(
literal|"vpshuflw"
argument_list|,
name|VEX_MXI
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [74]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [78]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [7C]  */
name|TNSZ
argument_list|(
literal|"vhaddps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vhsubps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [80]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [84]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [88]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [0C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [90]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [94]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [98]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [9C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [AC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [BC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C0]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vcmpsd"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|8
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [C4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [CC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D0]  */
name|TNSZ
argument_list|(
literal|"vaddsubps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [DC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E4]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vcvtpd2dq"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [E8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [EC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F0]  */
name|TNSZ
argument_list|(
literal|"vlddqu"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [FC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for SIMD instructions with the repz (0xf3) prefix.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opSIMDrepz
index|[
literal|256
index|]
init|=
block|{
comment|/*  [00]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [04]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [08]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [0C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [10]  */
name|TNSZ
argument_list|(
literal|"movss"
argument_list|,
name|XMM
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movss"
argument_list|,
name|XMMS
argument_list|,
literal|4
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [14]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [18]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [1C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [20]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [24]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [28]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"cvtsi2ss"
argument_list|,
name|XMM3MX
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movntss"
argument_list|,
name|XMMMS
argument_list|,
literal|4
argument_list|)
block|,
comment|/*  [2C]  */
name|TNSZ
argument_list|(
literal|"cvttss2si"
argument_list|,
name|XMMXM3
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"cvtss2si"
argument_list|,
name|XMMXM3
argument_list|,
literal|4
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [30]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [34]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [38]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [3C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [40]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [44]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [48]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [4C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [50]  */
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"sqrtss"
argument_list|,
name|XMM
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"rsqrtss"
argument_list|,
name|XMM
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"rcpss"
argument_list|,
name|XMM
argument_list|,
literal|4
argument_list|)
block|,
comment|/*  [54]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [58]  */
name|TNSZ
argument_list|(
literal|"addss"
argument_list|,
name|XMM
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"mulss"
argument_list|,
name|XMM
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"cvtss2sd"
argument_list|,
name|XMM
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"cvttps2dq"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [5C]  */
name|TNSZ
argument_list|(
literal|"subss"
argument_list|,
name|XMM
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"minss"
argument_list|,
name|XMM
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"divss"
argument_list|,
name|XMM
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"maxss"
argument_list|,
name|XMM
argument_list|,
literal|4
argument_list|)
block|,
comment|/*  [60]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [64]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [68]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [6C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"movdqu"
argument_list|,
name|XMM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [70]  */
name|TNSZ
argument_list|(
literal|"pshufhw"
argument_list|,
name|XMMP
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [74]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [78]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [7C]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"movq"
argument_list|,
name|XMM
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movdqu"
argument_list|,
name|XMMS
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [80]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [84]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [88]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [0C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [90]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [94]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [98]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [9C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [AC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B8]  */
name|TS
argument_list|(
literal|"popcnt"
argument_list|,
name|MRw
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [BC]  */
name|INVALID
block|,
name|TS
argument_list|(
literal|"lzcnt"
argument_list|,
name|MRw
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C0]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"cmpss"
argument_list|,
name|XMMP
argument_list|,
literal|4
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [C4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [CC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D4]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"movq2dq"
argument_list|,
name|XMMMX
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [D8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [DC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E4]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"cvtdq2pd"
argument_list|,
name|XMM
argument_list|,
literal|8
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [E8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [EC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [FC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opAVXF30F
index|[
literal|256
index|]
init|=
block|{
comment|/*  [00]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [04]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [08]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [0C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [10]  */
name|TNSZ
argument_list|(
literal|"vmovss"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovss"
argument_list|,
name|VEX_RRX
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovsldup"
argument_list|,
name|VEX_MX
argument_list|,
literal|4
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [14]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vmovshdup"
argument_list|,
name|VEX_MX
argument_list|,
literal|4
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [18]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [1C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [20]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [24]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [28]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vcvtsi2ss"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|4
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [2C]  */
name|TNSZ
argument_list|(
literal|"vcvttss2si"
argument_list|,
name|VEX_MR
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vcvtss2si"
argument_list|,
name|VEX_MR
argument_list|,
literal|4
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [30]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [34]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [38]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [3C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [40]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [44]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [48]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [4C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [50]  */
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vsqrtss"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vrsqrtss"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vrcpss"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|4
argument_list|)
block|,
comment|/*  [54]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [58]  */
name|TNSZ
argument_list|(
literal|"vaddss"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmulss"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vcvtss2sd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vcvttps2dq"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [5C]  */
name|TNSZ
argument_list|(
literal|"vsubss"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vminss"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vdivss"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmaxss"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|4
argument_list|)
block|,
comment|/*  [60]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [64]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [68]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [6C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vmovdqu"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [70]  */
name|TNSZ
argument_list|(
literal|"vpshufhw"
argument_list|,
name|VEX_MXI
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [74]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [78]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [7C]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vmovq"
argument_list|,
name|VEX_MX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovdqu"
argument_list|,
name|VEX_RX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [80]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [84]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [88]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [0C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [90]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [94]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [98]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [9C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [AC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [BC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C0]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vcmpss"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|4
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [C4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [CC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [DC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E4]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vcvtdq2pd"
argument_list|,
name|VEX_MX
argument_list|,
literal|8
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [E8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [EC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [FC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * The following two tables are used to encode crc32 and movbe  * since they share the same opcodes.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op0F38F0
index|[
literal|2
index|]
init|=
block|{
comment|/*  [00]  */
name|TNS
argument_list|(
literal|"crc32b"
argument_list|,
name|CRC32
argument_list|)
block|,
name|TS
argument_list|(
literal|"movbe"
argument_list|,
name|MOVBE
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op0F38F1
index|[
literal|2
index|]
init|=
block|{
comment|/*  [00]  */
name|TS
argument_list|(
literal|"crc32"
argument_list|,
name|CRC32
argument_list|)
block|,
name|TS
argument_list|(
literal|"movbe"
argument_list|,
name|MOVBE
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op0F38
index|[
literal|256
index|]
init|=
block|{
comment|/*  [00]  */
name|TNSZ
argument_list|(
literal|"pshufb"
argument_list|,
name|XMM_66o
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"phaddw"
argument_list|,
name|XMM_66o
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"phaddd"
argument_list|,
name|XMM_66o
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"phaddsw"
argument_list|,
name|XMM_66o
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [04]  */
name|TNSZ
argument_list|(
literal|"pmaddubsw"
argument_list|,
name|XMM_66o
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"phsubw"
argument_list|,
name|XMM_66o
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"phsubd"
argument_list|,
name|XMM_66o
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"phsubsw"
argument_list|,
name|XMM_66o
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [08]  */
name|TNSZ
argument_list|(
literal|"psignb"
argument_list|,
name|XMM_66o
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psignw"
argument_list|,
name|XMM_66o
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psignd"
argument_list|,
name|XMM_66o
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmulhrsw"
argument_list|,
name|XMM_66o
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [0C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [10]  */
name|TNSZ
argument_list|(
literal|"pblendvb"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [14]  */
name|TNSZ
argument_list|(
literal|"blendvps"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"blendvpd"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"ptest"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [18]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [1C]  */
name|TNSZ
argument_list|(
literal|"pabsb"
argument_list|,
name|XMM_66o
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pabsw"
argument_list|,
name|XMM_66o
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pabsd"
argument_list|,
name|XMM_66o
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [20]  */
name|TNSZ
argument_list|(
literal|"pmovsxbw"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmovsxbd"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmovsxbq"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmovsxwd"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [24]  */
name|TNSZ
argument_list|(
literal|"pmovsxwq"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmovsxdq"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [28]  */
name|TNSZ
argument_list|(
literal|"pmuldq"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pcmpeqq"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movntdqa"
argument_list|,
name|XMMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"packusdw"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [2C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [30]  */
name|TNSZ
argument_list|(
literal|"pmovzxbw"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmovzxbd"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmovzxbq"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmovzxwd"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [34]  */
name|TNSZ
argument_list|(
literal|"pmovzxwq"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmovzxdq"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"pcmpgtq"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [38]  */
name|TNSZ
argument_list|(
literal|"pminsb"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pminsd"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pminuw"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pminud"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [3C]  */
name|TNSZ
argument_list|(
literal|"pmaxsb"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmaxsd"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmaxuw"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmaxud"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [40]  */
name|TNSZ
argument_list|(
literal|"pmulld"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"phminposuw"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [44]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [48]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [4C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [50]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [54]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [58]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [5C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [60]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [64]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [68]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [6C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [70]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [74]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [78]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [7C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [80]  */
name|TNSy
argument_list|(
literal|"invept"
argument_list|,
name|RM_66r
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"invvpid"
argument_list|,
name|RM_66r
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"invpcid"
argument_list|,
name|RM_66r
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [84]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [88]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [8C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [90]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [94]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [98]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [9C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [AC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [BC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [CC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"aesimc"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [DC]  */
name|TNSZ
argument_list|(
literal|"aesenc"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"aesenclast"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"aesdec"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"aesdeclast"
argument_list|,
name|XMM_66r
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [E0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [EC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F0]  */
name|IND
argument_list|(
name|dis_op0F38F0
argument_list|)
block|,
name|IND
argument_list|(
name|dis_op0F38F1
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [FC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opAVX660F38
index|[
literal|256
index|]
init|=
block|{
comment|/*  [00]  */
name|TNSZ
argument_list|(
literal|"vpshufb"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vphaddw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vphaddd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vphaddsw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [04]  */
name|TNSZ
argument_list|(
literal|"vpmaddubsw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vphsubw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vphsubd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vphsubsw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [08]  */
name|TNSZ
argument_list|(
literal|"vpsignb"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpsignw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpsignd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpmulhrsw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [0C]  */
name|TNSZ
argument_list|(
literal|"vpermilps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpermilpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vtestps"
argument_list|,
name|VEX_RRI
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vtestpd"
argument_list|,
name|VEX_RRI
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [10]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vcvtph2ps"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [14]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vptest"
argument_list|,
name|VEX_RRI
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [18]  */
name|TNSZ
argument_list|(
literal|"vbroadcastss"
argument_list|,
name|VEX_MX
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vbroadcastsd"
argument_list|,
name|VEX_MX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vbroadcastf128"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [1C]  */
name|TNSZ
argument_list|(
literal|"vpabsb"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpabsw"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpabsd"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [20]  */
name|TNSZ
argument_list|(
literal|"vpmovsxbw"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpmovsxbd"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpmovsxbq"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpmovsxwd"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [24]  */
name|TNSZ
argument_list|(
literal|"vpmovsxwq"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpmovsxdq"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [28]  */
name|TNSZ
argument_list|(
literal|"vpmuldq"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpcmpeqq"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovntdqa"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpackusdw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [2C]  */
name|TNSZ
argument_list|(
literal|"vmaskmovps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmaskmovpd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmaskmovps"
argument_list|,
name|VEX_RRM
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmaskmovpd"
argument_list|,
name|VEX_RRM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [30]  */
name|TNSZ
argument_list|(
literal|"vpmovzxbw"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpmovzxbd"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpmovzxbq"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpmovzxwd"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [34]  */
name|TNSZ
argument_list|(
literal|"vpmovzxwq"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpmovzxdq"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vpcmpgtq"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [38]  */
name|TNSZ
argument_list|(
literal|"vpminsb"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpminsd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpminuw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpminud"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [3C]  */
name|TNSZ
argument_list|(
literal|"vpmaxsb"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpmaxsd"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpmaxuw"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpmaxud"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [40]  */
name|TNSZ
argument_list|(
literal|"vpmulld"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vphminposuw"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [44]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [48]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [4C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [50]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [54]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [58]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [5C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [60]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [64]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [68]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [6C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [70]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [74]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [78]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [7C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [80]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [84]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [88]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [8C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [90]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [94]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [98]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [9C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [AC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [BC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [CC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vaesimc"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [DC]  */
name|TNSZ
argument_list|(
literal|"vaesenc"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vaesenclast"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vaesdec"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vaesdeclast"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [E0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [EC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F0]  */
name|IND
argument_list|(
name|dis_op0F38F0
argument_list|)
block|,
name|IND
argument_list|(
name|dis_op0F38F1
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [FC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op0F3A
index|[
literal|256
index|]
init|=
block|{
comment|/*  [00]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [04]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [08]  */
name|TNSZ
argument_list|(
literal|"roundps"
argument_list|,
name|XMMP_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"roundpd"
argument_list|,
name|XMMP_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"roundss"
argument_list|,
name|XMMP_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"roundsd"
argument_list|,
name|XMMP_66r
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [0C]  */
name|TNSZ
argument_list|(
literal|"blendps"
argument_list|,
name|XMMP_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"blendpd"
argument_list|,
name|XMMP_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pblendw"
argument_list|,
name|XMMP_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"palignr"
argument_list|,
name|XMMP_66o
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [10]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [14]  */
name|TNSZ
argument_list|(
literal|"pextrb"
argument_list|,
name|XMM3PM_66r
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pextrw"
argument_list|,
name|XMM3PM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TSZ
argument_list|(
literal|"pextr"
argument_list|,
name|XMM3PM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"extractps"
argument_list|,
name|XMM3PM_66r
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [18]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [1C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [20]  */
name|TNSZ
argument_list|(
literal|"pinsrb"
argument_list|,
name|XMMPRM_66r
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"insertps"
argument_list|,
name|XMMP_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TSZ
argument_list|(
literal|"pinsr"
argument_list|,
name|XMMPRM_66r
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [24]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [28]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [2C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [30]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [34]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [38]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [3C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [40]  */
name|TNSZ
argument_list|(
literal|"dpps"
argument_list|,
name|XMMP_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"dppd"
argument_list|,
name|XMMP_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"mpsadbw"
argument_list|,
name|XMMP_66r
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [44]  */
name|TNSZ
argument_list|(
literal|"pclmulqdq"
argument_list|,
name|XMMP_66r
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [48]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [4C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [50]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [54]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [58]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [5C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [60]  */
name|TNSZ
argument_list|(
literal|"pcmpestrm"
argument_list|,
name|XMMP_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pcmpestri"
argument_list|,
name|XMMP_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pcmpistrm"
argument_list|,
name|XMMP_66r
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pcmpistri"
argument_list|,
name|XMMP_66r
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [64]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [68]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [6C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [70]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [74]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [78]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [7C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [80]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [84]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [88]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [8C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [90]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [94]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [98]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [9C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [AC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [BC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [CC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [DC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"aeskeygenassist"
argument_list|,
name|XMMP_66r
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [E0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [EC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [FC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opAVX660F3A
index|[
literal|256
index|]
init|=
block|{
comment|/*  [00]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [04]  */
name|TNSZ
argument_list|(
literal|"vpermilps"
argument_list|,
name|VEX_MXI
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpermilpd"
argument_list|,
name|VEX_MXI
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vperm2f128"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [08]  */
name|TNSZ
argument_list|(
literal|"vroundps"
argument_list|,
name|VEX_MXI
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vroundpd"
argument_list|,
name|VEX_MXI
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vroundss"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vroundsd"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [0C]  */
name|TNSZ
argument_list|(
literal|"vblendps"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vblendpd"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpblendw"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpalignr"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [10]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [14]  */
name|TNSZ
argument_list|(
literal|"vpextrb"
argument_list|,
name|VEX_RRi
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpextrw"
argument_list|,
name|VEX_RRi
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpextrd"
argument_list|,
name|VEX_RRi
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vextractps"
argument_list|,
name|VEX_RM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [18]  */
name|TNSZ
argument_list|(
literal|"vinsertf128"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vextractf128"
argument_list|,
name|VEX_RX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [1C]  */
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vcvtps2ph"
argument_list|,
name|VEX_RX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [20]  */
name|TNSZ
argument_list|(
literal|"vpinsrb"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vinsertps"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpinsrd"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [24]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [28]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [2C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [30]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [34]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [38]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [3C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [40]  */
name|TNSZ
argument_list|(
literal|"vdpps"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vdppd"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmpsadbw"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [44]  */
name|TNSZ
argument_list|(
literal|"vpclmulqdq"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [48]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vblendvps"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vblendvpd"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [4C]  */
name|TNSZ
argument_list|(
literal|"vpblendvb"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [50]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [54]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [58]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [5C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [60]  */
name|TNSZ
argument_list|(
literal|"vpcmpestrm"
argument_list|,
name|VEX_MXI
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpcmpestri"
argument_list|,
name|VEX_MXI
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpcmpistrm"
argument_list|,
name|VEX_MXI
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vpcmpistri"
argument_list|,
name|VEX_MXI
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [64]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [68]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [6C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [70]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [74]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [78]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [7C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [80]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [84]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [88]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [8C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [90]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [94]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [98]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [9C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [AC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [BC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [C8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [CC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [DC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vaeskeygenassist"
argument_list|,
name|VEX_MXI
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [E0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [EC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [FC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0x0F opcodes  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op0F
index|[
literal|16
index|]
index|[
literal|16
index|]
init|=
block|{
block|{
comment|/*  [00]  */
name|IND
argument_list|(
name|dis_op0F00
argument_list|)
block|,
name|IND
argument_list|(
name|dis_op0F01
argument_list|)
block|,
name|TNS
argument_list|(
literal|"lar"
argument_list|,
name|MR
argument_list|)
block|,
name|TNS
argument_list|(
literal|"lsl"
argument_list|,
name|MR
argument_list|)
block|,
comment|/*  [04]  */
name|INVALID
block|,
name|TNS
argument_list|(
literal|"syscall"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"clts"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"sysret"
argument_list|,
name|NORM
argument_list|)
block|,
comment|/*  [08]  */
name|TNS
argument_list|(
literal|"invd"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"wbinvd"
argument_list|,
name|NORM
argument_list|)
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"ud2"
argument_list|,
name|NORM
argument_list|)
block|,
comment|/*  [0C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [10]  */
name|TNSZ
argument_list|(
literal|"movups"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movups"
argument_list|,
name|XMMOS
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movlps"
argument_list|,
name|XMMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movlps"
argument_list|,
name|XMMOS
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [14]  */
name|TNSZ
argument_list|(
literal|"unpcklps"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"unpckhps"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movhps"
argument_list|,
name|XMMOM
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movhps"
argument_list|,
name|XMMOMS
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [18]  */
name|IND
argument_list|(
name|dis_op0F18
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [1C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|TS
argument_list|(
literal|"nop"
argument_list|,
name|Mw
argument_list|)
block|, }
block|,
block|{
comment|/*  [20]  */
name|TSy
argument_list|(
literal|"mov"
argument_list|,
name|SREG
argument_list|)
block|,
name|TSy
argument_list|(
literal|"mov"
argument_list|,
name|SREG
argument_list|)
block|,
name|TSy
argument_list|(
literal|"mov"
argument_list|,
name|SREG
argument_list|)
block|,
name|TSy
argument_list|(
literal|"mov"
argument_list|,
name|SREG
argument_list|)
block|,
comment|/*  [24]  */
name|TSx
argument_list|(
literal|"mov"
argument_list|,
name|SREG
argument_list|)
block|,
name|INVALID
block|,
name|TSx
argument_list|(
literal|"mov"
argument_list|,
name|SREG
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [28]  */
name|TNSZ
argument_list|(
literal|"movaps"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movaps"
argument_list|,
name|XMMOS
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"cvtpi2ps"
argument_list|,
name|XMMOMX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movntps"
argument_list|,
name|XMMOS
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [2C]  */
name|TNSZ
argument_list|(
literal|"cvttps2pi"
argument_list|,
name|XMMOXMM
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"cvtps2pi"
argument_list|,
name|XMMOXMM
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"ucomiss"
argument_list|,
name|XMMO
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"comiss"
argument_list|,
name|XMMO
argument_list|,
literal|4
argument_list|)
block|, }
block|,
block|{
comment|/*  [30]  */
name|TNS
argument_list|(
literal|"wrmsr"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"rdtsc"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"rdmsr"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"rdpmc"
argument_list|,
name|NORM
argument_list|)
block|,
comment|/*  [34]  */
name|TNSx
argument_list|(
literal|"sysenter"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"sysexit"
argument_list|,
name|NORM
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [38]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [3C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [40]  */
name|TS
argument_list|(
literal|"cmovx.o"
argument_list|,
name|MR
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmovx.no"
argument_list|,
name|MR
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmovx.b"
argument_list|,
name|MR
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmovx.ae"
argument_list|,
name|MR
argument_list|)
block|,
comment|/*  [44]  */
name|TS
argument_list|(
literal|"cmovx.e"
argument_list|,
name|MR
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmovx.ne"
argument_list|,
name|MR
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmovx.be"
argument_list|,
name|MR
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmovx.a"
argument_list|,
name|MR
argument_list|)
block|,
comment|/*  [48]  */
name|TS
argument_list|(
literal|"cmovx.s"
argument_list|,
name|MR
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmovx.ns"
argument_list|,
name|MR
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmovx.pe"
argument_list|,
name|MR
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmovx.po"
argument_list|,
name|MR
argument_list|)
block|,
comment|/*  [4C]  */
name|TS
argument_list|(
literal|"cmovx.l"
argument_list|,
name|MR
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmovx.ge"
argument_list|,
name|MR
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmovx.le"
argument_list|,
name|MR
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmovx.g"
argument_list|,
name|MR
argument_list|)
block|, }
block|,
block|{
comment|/*  [50]  */
name|TNS
argument_list|(
literal|"movmskps"
argument_list|,
name|XMMOX3
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"sqrtps"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"rsqrtps"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"rcpps"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [54]  */
name|TNSZ
argument_list|(
literal|"andps"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"andnps"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"orps"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"xorps"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [58]  */
name|TNSZ
argument_list|(
literal|"addps"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"mulps"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"cvtps2pd"
argument_list|,
name|XMMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"cvtdq2ps"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [5C]  */
name|TNSZ
argument_list|(
literal|"subps"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"minps"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"divps"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"maxps"
argument_list|,
name|XMMO
argument_list|,
literal|16
argument_list|)
block|, }
block|,
block|{
comment|/*  [60]  */
name|TNSZ
argument_list|(
literal|"punpcklbw"
argument_list|,
name|MMO
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"punpcklwd"
argument_list|,
name|MMO
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"punpckldq"
argument_list|,
name|MMO
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"packsswb"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [64]  */
name|TNSZ
argument_list|(
literal|"pcmpgtb"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pcmpgtw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pcmpgtd"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"packuswb"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [68]  */
name|TNSZ
argument_list|(
literal|"punpckhbw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"punpckhwd"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"punpckhdq"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"packssdw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [6C]  */
name|TNSZ
argument_list|(
literal|"INVALID"
argument_list|,
name|MMO
argument_list|,
literal|0
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"INVALID"
argument_list|,
name|MMO
argument_list|,
literal|0
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movd"
argument_list|,
name|MMO
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movq"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|, }
block|,
block|{
comment|/*  [70]  */
name|TNSZ
argument_list|(
literal|"pshufw"
argument_list|,
name|MMOPM
argument_list|,
literal|8
argument_list|)
block|,
name|TNS
argument_list|(
literal|"psrXXX"
argument_list|,
name|MR
argument_list|)
block|,
name|TNS
argument_list|(
literal|"psrXXX"
argument_list|,
name|MR
argument_list|)
block|,
name|TNS
argument_list|(
literal|"psrXXX"
argument_list|,
name|MR
argument_list|)
block|,
comment|/*  [74]  */
name|TNSZ
argument_list|(
literal|"pcmpeqb"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pcmpeqw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pcmpeqd"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNS
argument_list|(
literal|"emms"
argument_list|,
name|NORM
argument_list|)
block|,
comment|/*  [78]  */
name|TNSy
argument_list|(
literal|"vmread"
argument_list|,
name|RM
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"vmwrite"
argument_list|,
name|MR
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [7C]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"movd"
argument_list|,
name|MMOS
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movq"
argument_list|,
name|MMOS
argument_list|,
literal|8
argument_list|)
block|, }
block|,
block|{
comment|/*  [80]  */
name|TNS
argument_list|(
literal|"jo"
argument_list|,
name|D
argument_list|)
block|,
name|TNS
argument_list|(
literal|"jno"
argument_list|,
name|D
argument_list|)
block|,
name|TNS
argument_list|(
literal|"jb"
argument_list|,
name|D
argument_list|)
block|,
name|TNS
argument_list|(
literal|"jae"
argument_list|,
name|D
argument_list|)
block|,
comment|/*  [84]  */
name|TNS
argument_list|(
literal|"je"
argument_list|,
name|D
argument_list|)
block|,
name|TNS
argument_list|(
literal|"jne"
argument_list|,
name|D
argument_list|)
block|,
name|TNS
argument_list|(
literal|"jbe"
argument_list|,
name|D
argument_list|)
block|,
name|TNS
argument_list|(
literal|"ja"
argument_list|,
name|D
argument_list|)
block|,
comment|/*  [88]  */
name|TNS
argument_list|(
literal|"js"
argument_list|,
name|D
argument_list|)
block|,
name|TNS
argument_list|(
literal|"jns"
argument_list|,
name|D
argument_list|)
block|,
name|TNS
argument_list|(
literal|"jp"
argument_list|,
name|D
argument_list|)
block|,
name|TNS
argument_list|(
literal|"jnp"
argument_list|,
name|D
argument_list|)
block|,
comment|/*  [8C]  */
name|TNS
argument_list|(
literal|"jl"
argument_list|,
name|D
argument_list|)
block|,
name|TNS
argument_list|(
literal|"jge"
argument_list|,
name|D
argument_list|)
block|,
name|TNS
argument_list|(
literal|"jle"
argument_list|,
name|D
argument_list|)
block|,
name|TNS
argument_list|(
literal|"jg"
argument_list|,
name|D
argument_list|)
block|, }
block|,
block|{
comment|/*  [90]  */
name|TNS
argument_list|(
literal|"seto"
argument_list|,
name|Mb
argument_list|)
block|,
name|TNS
argument_list|(
literal|"setno"
argument_list|,
name|Mb
argument_list|)
block|,
name|TNS
argument_list|(
literal|"setb"
argument_list|,
name|Mb
argument_list|)
block|,
name|TNS
argument_list|(
literal|"setae"
argument_list|,
name|Mb
argument_list|)
block|,
comment|/*  [94]  */
name|TNS
argument_list|(
literal|"sete"
argument_list|,
name|Mb
argument_list|)
block|,
name|TNS
argument_list|(
literal|"setne"
argument_list|,
name|Mb
argument_list|)
block|,
name|TNS
argument_list|(
literal|"setbe"
argument_list|,
name|Mb
argument_list|)
block|,
name|TNS
argument_list|(
literal|"seta"
argument_list|,
name|Mb
argument_list|)
block|,
comment|/*  [98]  */
name|TNS
argument_list|(
literal|"sets"
argument_list|,
name|Mb
argument_list|)
block|,
name|TNS
argument_list|(
literal|"setns"
argument_list|,
name|Mb
argument_list|)
block|,
name|TNS
argument_list|(
literal|"setp"
argument_list|,
name|Mb
argument_list|)
block|,
name|TNS
argument_list|(
literal|"setnp"
argument_list|,
name|Mb
argument_list|)
block|,
comment|/*  [9C]  */
name|TNS
argument_list|(
literal|"setl"
argument_list|,
name|Mb
argument_list|)
block|,
name|TNS
argument_list|(
literal|"setge"
argument_list|,
name|Mb
argument_list|)
block|,
name|TNS
argument_list|(
literal|"setle"
argument_list|,
name|Mb
argument_list|)
block|,
name|TNS
argument_list|(
literal|"setg"
argument_list|,
name|Mb
argument_list|)
block|, }
block|,
block|{
comment|/*  [A0]  */
name|TSp
argument_list|(
literal|"push"
argument_list|,
name|LSEG
argument_list|)
block|,
name|TSp
argument_list|(
literal|"pop"
argument_list|,
name|LSEG
argument_list|)
block|,
name|TNS
argument_list|(
literal|"cpuid"
argument_list|,
name|NORM
argument_list|)
block|,
name|TS
argument_list|(
literal|"bt"
argument_list|,
name|RMw
argument_list|)
block|,
comment|/*  [A4]  */
name|TS
argument_list|(
literal|"shld"
argument_list|,
name|DSHIFT
argument_list|)
block|,
name|TS
argument_list|(
literal|"shld"
argument_list|,
name|DSHIFTcl
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A8]  */
name|TSp
argument_list|(
literal|"push"
argument_list|,
name|LSEG
argument_list|)
block|,
name|TSp
argument_list|(
literal|"pop"
argument_list|,
name|LSEG
argument_list|)
block|,
name|TNS
argument_list|(
literal|"rsm"
argument_list|,
name|NORM
argument_list|)
block|,
name|TS
argument_list|(
literal|"bts"
argument_list|,
name|RMw
argument_list|)
block|,
comment|/*  [AC]  */
name|TS
argument_list|(
literal|"shrd"
argument_list|,
name|DSHIFT
argument_list|)
block|,
name|TS
argument_list|(
literal|"shrd"
argument_list|,
name|DSHIFTcl
argument_list|)
block|,
name|IND
argument_list|(
name|dis_op0FAE
argument_list|)
block|,
name|TS
argument_list|(
literal|"imul"
argument_list|,
name|MRw
argument_list|)
block|, }
block|,
block|{
comment|/*  [B0]  */
name|TNS
argument_list|(
literal|"cmpxchgb"
argument_list|,
name|RMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmpxchg"
argument_list|,
name|RMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"lss"
argument_list|,
name|MR
argument_list|)
block|,
name|TS
argument_list|(
literal|"btr"
argument_list|,
name|RMw
argument_list|)
block|,
comment|/*  [B4]  */
name|TS
argument_list|(
literal|"lfs"
argument_list|,
name|MR
argument_list|)
block|,
name|TS
argument_list|(
literal|"lgs"
argument_list|,
name|MR
argument_list|)
block|,
name|TS
argument_list|(
literal|"movzb"
argument_list|,
name|MOVZ
argument_list|)
block|,
name|TNS
argument_list|(
literal|"movzwl"
argument_list|,
name|MOVZ
argument_list|)
block|,
comment|/*  [B8]  */
name|TNS
argument_list|(
literal|"INVALID"
argument_list|,
name|MRw
argument_list|)
block|,
name|INVALID
block|,
name|IND
argument_list|(
name|dis_op0FBA
argument_list|)
block|,
name|TS
argument_list|(
literal|"btc"
argument_list|,
name|RMw
argument_list|)
block|,
comment|/*  [BC]  */
name|TS
argument_list|(
literal|"bsf"
argument_list|,
name|MRw
argument_list|)
block|,
name|TS
argument_list|(
literal|"bsr"
argument_list|,
name|MRw
argument_list|)
block|,
name|TS
argument_list|(
literal|"movsb"
argument_list|,
name|MOVZ
argument_list|)
block|,
name|TNS
argument_list|(
literal|"movswl"
argument_list|,
name|MOVZ
argument_list|)
block|, }
block|,
block|{
comment|/*  [C0]  */
name|TNS
argument_list|(
literal|"xaddb"
argument_list|,
name|XADDB
argument_list|)
block|,
name|TS
argument_list|(
literal|"xadd"
argument_list|,
name|RMw
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"cmpps"
argument_list|,
name|XMMOPM
argument_list|,
literal|16
argument_list|)
block|,
name|TNS
argument_list|(
literal|"movnti"
argument_list|,
name|RM
argument_list|)
block|,
comment|/*  [C4]  */
name|TNSZ
argument_list|(
literal|"pinsrw"
argument_list|,
name|MMOPRM
argument_list|,
literal|2
argument_list|)
block|,
name|TNS
argument_list|(
literal|"pextrw"
argument_list|,
name|MMO3P
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"shufps"
argument_list|,
name|XMMOPM
argument_list|,
literal|16
argument_list|)
block|,
name|IND
argument_list|(
name|dis_op0FC7
argument_list|)
block|,
comment|/*  [C8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [CC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [D0]  */
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"psrlw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psrld"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psrlq"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [D4]  */
name|TNSZ
argument_list|(
literal|"paddq"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmullw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"INVALID"
argument_list|,
name|MMO
argument_list|,
literal|0
argument_list|)
block|,
name|TNS
argument_list|(
literal|"pmovmskb"
argument_list|,
name|MMOM3
argument_list|)
block|,
comment|/*  [D8]  */
name|TNSZ
argument_list|(
literal|"psubusb"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psubusw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pminub"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pand"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [DC]  */
name|TNSZ
argument_list|(
literal|"paddusb"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"paddusw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmaxub"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pandn"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|, }
block|,
block|{
comment|/*  [E0]  */
name|TNSZ
argument_list|(
literal|"pavgb"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psraw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psrad"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pavgw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [E4]  */
name|TNSZ
argument_list|(
literal|"pmulhuw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmulhw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNS
argument_list|(
literal|"INVALID"
argument_list|,
name|XMMO
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"movntq"
argument_list|,
name|MMOMS
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [E8]  */
name|TNSZ
argument_list|(
literal|"psubsb"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psubsw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pminsw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"por"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [EC]  */
name|TNSZ
argument_list|(
literal|"paddsb"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"paddsw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmaxsw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pxor"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|, }
block|,
block|{
comment|/*  [F0]  */
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"psllw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pslld"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psllq"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [F4]  */
name|TNSZ
argument_list|(
literal|"pmuludq"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"pmaddwd"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psadbw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"maskmovq"
argument_list|,
name|MMOIMPL
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [F8]  */
name|TNSZ
argument_list|(
literal|"psubb"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psubw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psubd"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"psubq"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [FC]  */
name|TNSZ
argument_list|(
literal|"paddb"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"paddw"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"paddd"
argument_list|,
name|MMO
argument_list|,
literal|8
argument_list|)
block|,
name|INVALID
block|, }
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opAVX0F
index|[
literal|16
index|]
index|[
literal|16
index|]
init|=
block|{
block|{
comment|/*  [00]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [04]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [08]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [0C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [10]  */
name|TNSZ
argument_list|(
literal|"vmovups"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovups"
argument_list|,
name|VEX_RM
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovlps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovlps"
argument_list|,
name|VEX_RM
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [14]  */
name|TNSZ
argument_list|(
literal|"vunpcklps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vunpckhps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovhps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovhps"
argument_list|,
name|VEX_RM
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [18]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [1C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [20]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [24]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [28]  */
name|TNSZ
argument_list|(
literal|"vmovaps"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmovaps"
argument_list|,
name|VEX_RX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vmovntps"
argument_list|,
name|VEX_RM
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [2C]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vucomiss"
argument_list|,
name|VEX_MX
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vcomiss"
argument_list|,
name|VEX_MX
argument_list|,
literal|4
argument_list|)
block|, }
block|,
block|{
comment|/*  [30]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [34]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [38]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [3C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [40]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [44]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [48]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [4C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [50]  */
name|TNS
argument_list|(
literal|"vmovmskps"
argument_list|,
name|VEX_MR
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vsqrtps"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vrsqrtps"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vrcpps"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [54]  */
name|TNSZ
argument_list|(
literal|"vandps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vandnps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vorps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vxorps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [58]  */
name|TNSZ
argument_list|(
literal|"vaddps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmulps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vcvtps2pd"
argument_list|,
name|VEX_MX
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vcvtdq2ps"
argument_list|,
name|VEX_MX
argument_list|,
literal|16
argument_list|)
block|,
comment|/*  [5C]  */
name|TNSZ
argument_list|(
literal|"vsubps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vminps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vdivps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"vmaxps"
argument_list|,
name|VEX_RMrX
argument_list|,
literal|16
argument_list|)
block|, }
block|,
block|{
comment|/*  [60]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [64]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [68]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [6C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [70]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [74]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"vzeroupper"
argument_list|,
name|VEX_NONE
argument_list|)
block|,
comment|/*  [78]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [7C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [80]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [84]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [88]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [8C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [90]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [94]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [98]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [9C]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [A0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [A8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [AC]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vldmxcsr"
argument_list|,
name|VEX_MO
argument_list|,
literal|2
argument_list|)
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [B0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [B8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [BC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [C0]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vcmpps"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [C4]  */
name|INVALID
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"vshufps"
argument_list|,
name|VEX_RMRX
argument_list|,
literal|16
argument_list|)
block|,
name|INVALID
block|,
comment|/*  [C8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [CC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [D0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [D8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [DC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [E0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [E8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [EC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [F0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [F8]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [FC]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0x80 opcodes  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op80
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TNS
argument_list|(
literal|"addb"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"orb"
argument_list|,
name|IMw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"adcb"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"sbbb"
argument_list|,
name|IMlw
argument_list|)
block|,
comment|/*  [4]  */
name|TNS
argument_list|(
literal|"andb"
argument_list|,
name|IMw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"subb"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"xorb"
argument_list|,
name|IMw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"cmpb"
argument_list|,
name|IMlw
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0x81 opcodes.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op81
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TS
argument_list|(
literal|"add"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TS
argument_list|(
literal|"or"
argument_list|,
name|IMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"adc"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TS
argument_list|(
literal|"sbb"
argument_list|,
name|IMlw
argument_list|)
block|,
comment|/*  [4]  */
name|TS
argument_list|(
literal|"and"
argument_list|,
name|IMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"sub"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TS
argument_list|(
literal|"xor"
argument_list|,
name|IMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmp"
argument_list|,
name|IMlw
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0x82 opcodes.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op82
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TNSx
argument_list|(
literal|"addb"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"orb"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"adcb"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"sbbb"
argument_list|,
name|IMlw
argument_list|)
block|,
comment|/*  [4]  */
name|TNSx
argument_list|(
literal|"andb"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"subb"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"xorb"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"cmpb"
argument_list|,
name|IMlw
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0x83 opcodes.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_op83
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TS
argument_list|(
literal|"add"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TS
argument_list|(
literal|"or"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TS
argument_list|(
literal|"adc"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TS
argument_list|(
literal|"sbb"
argument_list|,
name|IMlw
argument_list|)
block|,
comment|/*  [4]  */
name|TS
argument_list|(
literal|"and"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TS
argument_list|(
literal|"sub"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TS
argument_list|(
literal|"xor"
argument_list|,
name|IMlw
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmp"
argument_list|,
name|IMlw
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0xC0 opcodes.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opC0
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TNS
argument_list|(
literal|"rolb"
argument_list|,
name|MvI
argument_list|)
block|,
name|TNS
argument_list|(
literal|"rorb"
argument_list|,
name|MvI
argument_list|)
block|,
name|TNS
argument_list|(
literal|"rclb"
argument_list|,
name|MvI
argument_list|)
block|,
name|TNS
argument_list|(
literal|"rcrb"
argument_list|,
name|MvI
argument_list|)
block|,
comment|/*  [4]  */
name|TNS
argument_list|(
literal|"shlb"
argument_list|,
name|MvI
argument_list|)
block|,
name|TNS
argument_list|(
literal|"shrb"
argument_list|,
name|MvI
argument_list|)
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"sarb"
argument_list|,
name|MvI
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0xD0 opcodes.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opD0
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TNS
argument_list|(
literal|"rolb"
argument_list|,
name|Mv
argument_list|)
block|,
name|TNS
argument_list|(
literal|"rorb"
argument_list|,
name|Mv
argument_list|)
block|,
name|TNS
argument_list|(
literal|"rclb"
argument_list|,
name|Mv
argument_list|)
block|,
name|TNS
argument_list|(
literal|"rcrb"
argument_list|,
name|Mv
argument_list|)
block|,
comment|/*  [4]  */
name|TNS
argument_list|(
literal|"shlb"
argument_list|,
name|Mv
argument_list|)
block|,
name|TNS
argument_list|(
literal|"shrb"
argument_list|,
name|Mv
argument_list|)
block|,
name|TNS
argument_list|(
literal|"salb"
argument_list|,
name|Mv
argument_list|)
block|,
name|TNS
argument_list|(
literal|"sarb"
argument_list|,
name|Mv
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0xC1 opcodes.  *	186 instruction set  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opC1
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TS
argument_list|(
literal|"rol"
argument_list|,
name|MvI
argument_list|)
block|,
name|TS
argument_list|(
literal|"ror"
argument_list|,
name|MvI
argument_list|)
block|,
name|TS
argument_list|(
literal|"rcl"
argument_list|,
name|MvI
argument_list|)
block|,
name|TS
argument_list|(
literal|"rcr"
argument_list|,
name|MvI
argument_list|)
block|,
comment|/*  [4]  */
name|TS
argument_list|(
literal|"shl"
argument_list|,
name|MvI
argument_list|)
block|,
name|TS
argument_list|(
literal|"shr"
argument_list|,
name|MvI
argument_list|)
block|,
name|TS
argument_list|(
literal|"sal"
argument_list|,
name|MvI
argument_list|)
block|,
name|TS
argument_list|(
literal|"sar"
argument_list|,
name|MvI
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0xD1 opcodes.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opD1
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TS
argument_list|(
literal|"rol"
argument_list|,
name|Mv
argument_list|)
block|,
name|TS
argument_list|(
literal|"ror"
argument_list|,
name|Mv
argument_list|)
block|,
name|TS
argument_list|(
literal|"rcl"
argument_list|,
name|Mv
argument_list|)
block|,
name|TS
argument_list|(
literal|"rcr"
argument_list|,
name|Mv
argument_list|)
block|,
comment|/*  [4]  */
name|TS
argument_list|(
literal|"shl"
argument_list|,
name|Mv
argument_list|)
block|,
name|TS
argument_list|(
literal|"shr"
argument_list|,
name|Mv
argument_list|)
block|,
name|TS
argument_list|(
literal|"sal"
argument_list|,
name|Mv
argument_list|)
block|,
name|TS
argument_list|(
literal|"sar"
argument_list|,
name|Mv
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0xD2 opcodes.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opD2
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TNS
argument_list|(
literal|"rolb"
argument_list|,
name|Mv
argument_list|)
block|,
name|TNS
argument_list|(
literal|"rorb"
argument_list|,
name|Mv
argument_list|)
block|,
name|TNS
argument_list|(
literal|"rclb"
argument_list|,
name|Mv
argument_list|)
block|,
name|TNS
argument_list|(
literal|"rcrb"
argument_list|,
name|Mv
argument_list|)
block|,
comment|/*  [4]  */
name|TNS
argument_list|(
literal|"shlb"
argument_list|,
name|Mv
argument_list|)
block|,
name|TNS
argument_list|(
literal|"shrb"
argument_list|,
name|Mv
argument_list|)
block|,
name|TNS
argument_list|(
literal|"salb"
argument_list|,
name|Mv
argument_list|)
block|,
name|TNS
argument_list|(
literal|"sarb"
argument_list|,
name|Mv
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0xD3 opcodes.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opD3
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TS
argument_list|(
literal|"rol"
argument_list|,
name|Mv
argument_list|)
block|,
name|TS
argument_list|(
literal|"ror"
argument_list|,
name|Mv
argument_list|)
block|,
name|TS
argument_list|(
literal|"rcl"
argument_list|,
name|Mv
argument_list|)
block|,
name|TS
argument_list|(
literal|"rcr"
argument_list|,
name|Mv
argument_list|)
block|,
comment|/*  [4]  */
name|TS
argument_list|(
literal|"shl"
argument_list|,
name|Mv
argument_list|)
block|,
name|TS
argument_list|(
literal|"shr"
argument_list|,
name|Mv
argument_list|)
block|,
name|TS
argument_list|(
literal|"salb"
argument_list|,
name|Mv
argument_list|)
block|,
name|TS
argument_list|(
literal|"sar"
argument_list|,
name|Mv
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0xF6 opcodes.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opF6
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TNS
argument_list|(
literal|"testb"
argument_list|,
name|IMw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"testb"
argument_list|,
name|IMw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"notb"
argument_list|,
name|Mw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"negb"
argument_list|,
name|Mw
argument_list|)
block|,
comment|/*  [4]  */
name|TNS
argument_list|(
literal|"mulb"
argument_list|,
name|MA
argument_list|)
block|,
name|TNS
argument_list|(
literal|"imulb"
argument_list|,
name|MA
argument_list|)
block|,
name|TNS
argument_list|(
literal|"divb"
argument_list|,
name|MA
argument_list|)
block|,
name|TNS
argument_list|(
literal|"idivb"
argument_list|,
name|MA
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0xF7 opcodes.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opF7
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TS
argument_list|(
literal|"test"
argument_list|,
name|IMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"test"
argument_list|,
name|IMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"not"
argument_list|,
name|Mw
argument_list|)
block|,
name|TS
argument_list|(
literal|"neg"
argument_list|,
name|Mw
argument_list|)
block|,
comment|/*  [4]  */
name|TS
argument_list|(
literal|"mul"
argument_list|,
name|MA
argument_list|)
block|,
name|TS
argument_list|(
literal|"imul"
argument_list|,
name|MA
argument_list|)
block|,
name|TS
argument_list|(
literal|"div"
argument_list|,
name|MA
argument_list|)
block|,
name|TS
argument_list|(
literal|"idiv"
argument_list|,
name|MA
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0xFE opcodes.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opFE
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TNS
argument_list|(
literal|"incb"
argument_list|,
name|Mw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"decb"
argument_list|,
name|Mw
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Decode table for 0xFF opcodes.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opFF
index|[
literal|8
index|]
init|=
block|{
comment|/*  [0]  */
name|TS
argument_list|(
literal|"inc"
argument_list|,
name|Mw
argument_list|)
block|,
name|TS
argument_list|(
literal|"dec"
argument_list|,
name|Mw
argument_list|)
block|,
name|TNSyp
argument_list|(
literal|"call"
argument_list|,
name|INM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"lcall"
argument_list|,
name|INM
argument_list|)
block|,
comment|/*  [4]  */
name|TNSy
argument_list|(
literal|"jmp"
argument_list|,
name|INM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"ljmp"
argument_list|,
name|INM
argument_list|)
block|,
name|TSp
argument_list|(
literal|"push"
argument_list|,
name|M
argument_list|)
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* for 287 instructions, which are a mess to decode */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opFP1n2
index|[
literal|8
index|]
index|[
literal|8
index|]
init|=
block|{
block|{
comment|/* bit pattern:	1101 1xxx MODxx xR/M */
comment|/*  [0,0] */
name|TNS
argument_list|(
literal|"fadds"
argument_list|,
name|M
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fmuls"
argument_list|,
name|M
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fcoms"
argument_list|,
name|M
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fcomps"
argument_list|,
name|M
argument_list|)
block|,
comment|/*  [0,4] */
name|TNS
argument_list|(
literal|"fsubs"
argument_list|,
name|M
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fsubrs"
argument_list|,
name|M
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fdivs"
argument_list|,
name|M
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fdivrs"
argument_list|,
name|M
argument_list|)
block|, }
block|,
block|{
comment|/*  [1,0]  */
name|TNS
argument_list|(
literal|"flds"
argument_list|,
name|M
argument_list|)
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"fsts"
argument_list|,
name|M
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fstps"
argument_list|,
name|M
argument_list|)
block|,
comment|/*  [1,4]  */
name|TNSZ
argument_list|(
literal|"fldenv"
argument_list|,
name|M
argument_list|,
literal|28
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fldcw"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fnstenv"
argument_list|,
name|M
argument_list|,
literal|28
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fnstcw"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|, }
block|,
block|{
comment|/*  [2,0]  */
name|TNS
argument_list|(
literal|"fiaddl"
argument_list|,
name|M
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fimull"
argument_list|,
name|M
argument_list|)
block|,
name|TNS
argument_list|(
literal|"ficoml"
argument_list|,
name|M
argument_list|)
block|,
name|TNS
argument_list|(
literal|"ficompl"
argument_list|,
name|M
argument_list|)
block|,
comment|/*  [2,4]  */
name|TNS
argument_list|(
literal|"fisubl"
argument_list|,
name|M
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fisubrl"
argument_list|,
name|M
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fidivl"
argument_list|,
name|M
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fidivrl"
argument_list|,
name|M
argument_list|)
block|, }
block|,
block|{
comment|/*  [3,0]  */
name|TNS
argument_list|(
literal|"fildl"
argument_list|,
name|M
argument_list|)
block|,
name|INVALID
block|,
name|TNS
argument_list|(
literal|"fistl"
argument_list|,
name|M
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fistpl"
argument_list|,
name|M
argument_list|)
block|,
comment|/*  [3,4]  */
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"fldt"
argument_list|,
name|M
argument_list|,
literal|10
argument_list|)
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"fstpt"
argument_list|,
name|M
argument_list|,
literal|10
argument_list|)
block|, }
block|,
block|{
comment|/*  [4,0]  */
name|TNSZ
argument_list|(
literal|"faddl"
argument_list|,
name|M
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fmull"
argument_list|,
name|M
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fcoml"
argument_list|,
name|M
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fcompl"
argument_list|,
name|M
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [4,1]  */
name|TNSZ
argument_list|(
literal|"fsubl"
argument_list|,
name|M
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fsubrl"
argument_list|,
name|M
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fdivl"
argument_list|,
name|M
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fdivrl"
argument_list|,
name|M
argument_list|,
literal|8
argument_list|)
block|, }
block|,
block|{
comment|/*  [5,0]  */
name|TNSZ
argument_list|(
literal|"fldl"
argument_list|,
name|M
argument_list|,
literal|8
argument_list|)
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"fstl"
argument_list|,
name|M
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fstpl"
argument_list|,
name|M
argument_list|,
literal|8
argument_list|)
block|,
comment|/*  [5,4]  */
name|TNSZ
argument_list|(
literal|"frstor"
argument_list|,
name|M
argument_list|,
literal|108
argument_list|)
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"fnsave"
argument_list|,
name|M
argument_list|,
literal|108
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fnstsw"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|, }
block|,
block|{
comment|/*  [6,0]  */
name|TNSZ
argument_list|(
literal|"fiadd"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fimul"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"ficom"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"ficomp"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|,
comment|/*  [6,4]  */
name|TNSZ
argument_list|(
literal|"fisub"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fisubr"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fidiv"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fidivr"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|, }
block|,
block|{
comment|/*  [7,0]  */
name|TNSZ
argument_list|(
literal|"fild"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|,
name|INVALID
block|,
name|TNSZ
argument_list|(
literal|"fist"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fistp"
argument_list|,
name|M
argument_list|,
literal|2
argument_list|)
block|,
comment|/*  [7,4]  */
name|TNSZ
argument_list|(
literal|"fbld"
argument_list|,
name|M
argument_list|,
literal|10
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fildll"
argument_list|,
name|M
argument_list|,
literal|8
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fbstp"
argument_list|,
name|M
argument_list|,
literal|10
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"fistpll"
argument_list|,
name|M
argument_list|,
literal|8
argument_list|)
block|, }
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opFP3
index|[
literal|8
index|]
index|[
literal|8
index|]
init|=
block|{
block|{
comment|/* bit  pattern:	1101 1xxx 11xx xREG */
comment|/*  [0,0]  */
name|TNS
argument_list|(
literal|"fadd"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fmul"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fcom"
argument_list|,
name|F
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fcomp"
argument_list|,
name|F
argument_list|)
block|,
comment|/*  [0,4]  */
name|TNS
argument_list|(
literal|"fsub"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fsubr"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fdiv"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fdivr"
argument_list|,
name|FF
argument_list|)
block|, }
block|,
block|{
comment|/*  [1,0]  */
name|TNS
argument_list|(
literal|"fld"
argument_list|,
name|F
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fxch"
argument_list|,
name|F
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fnop"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fstp"
argument_list|,
name|F
argument_list|)
block|,
comment|/*  [1,4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [2,0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [2,4]  */
name|INVALID
block|,
name|TNS
argument_list|(
literal|"fucompp"
argument_list|,
name|NORM
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [3,0]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [3,4]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [4,0]  */
name|TNS
argument_list|(
literal|"fadd"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fmul"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fcom"
argument_list|,
name|F
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fcomp"
argument_list|,
name|F
argument_list|)
block|,
comment|/*  [4,4]  */
name|TNS
argument_list|(
literal|"fsub"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fsubr"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fdiv"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fdivr"
argument_list|,
name|FF
argument_list|)
block|, }
block|,
block|{
comment|/*  [5,0]  */
name|TNS
argument_list|(
literal|"ffree"
argument_list|,
name|F
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fxch"
argument_list|,
name|F
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fst"
argument_list|,
name|F
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fstp"
argument_list|,
name|F
argument_list|)
block|,
comment|/*  [5,4]  */
name|TNS
argument_list|(
literal|"fucom"
argument_list|,
name|F
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fucomp"
argument_list|,
name|F
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [6,0]  */
name|TNS
argument_list|(
literal|"faddp"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fmulp"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fcomp"
argument_list|,
name|F
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fcompp"
argument_list|,
name|NORM
argument_list|)
block|,
comment|/*  [6,4]  */
name|TNS
argument_list|(
literal|"fsubp"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fsubrp"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fdivp"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fdivrp"
argument_list|,
name|FF
argument_list|)
block|, }
block|,
block|{
comment|/*  [7,0]  */
name|TNS
argument_list|(
literal|"ffreep"
argument_list|,
name|F
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fxch"
argument_list|,
name|F
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fstp"
argument_list|,
name|F
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fstp"
argument_list|,
name|F
argument_list|)
block|,
comment|/*  [7,4]  */
name|TNS
argument_list|(
literal|"fnstsw"
argument_list|,
name|M
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fucomip"
argument_list|,
name|FFC
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fcomip"
argument_list|,
name|FFC
argument_list|)
block|,
name|INVALID
block|, }
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opFP4
index|[
literal|4
index|]
index|[
literal|8
index|]
init|=
block|{
block|{
comment|/* bit pattern:	1101 1001 111x xxxx */
comment|/*  [0,0]  */
name|TNS
argument_list|(
literal|"fchs"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fabs"
argument_list|,
name|NORM
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|,
comment|/*  [0,4]  */
name|TNS
argument_list|(
literal|"ftst"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fxam"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"ftstp"
argument_list|,
name|NORM
argument_list|)
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [1,0]  */
name|TNS
argument_list|(
literal|"fld1"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fldl2t"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fldl2e"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fldpi"
argument_list|,
name|NORM
argument_list|)
block|,
comment|/*  [1,4]  */
name|TNS
argument_list|(
literal|"fldlg2"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fldln2"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fldz"
argument_list|,
name|NORM
argument_list|)
block|,
name|INVALID
block|, }
block|,
block|{
comment|/*  [2,0]  */
name|TNS
argument_list|(
literal|"f2xm1"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fyl2x"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fptan"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fpatan"
argument_list|,
name|NORM
argument_list|)
block|,
comment|/*  [2,4]  */
name|TNS
argument_list|(
literal|"fxtract"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fprem1"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fdecstp"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fincstp"
argument_list|,
name|NORM
argument_list|)
block|, }
block|,
block|{
comment|/*  [3,0]  */
name|TNS
argument_list|(
literal|"fprem"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fyl2xp1"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fsqrt"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fsincos"
argument_list|,
name|NORM
argument_list|)
block|,
comment|/*  [3,4]  */
name|TNS
argument_list|(
literal|"frndint"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fscale"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fsin"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fcos"
argument_list|,
name|NORM
argument_list|)
block|, }
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opFP5
index|[
literal|8
index|]
init|=
block|{
comment|/* bit pattern:	1101 1011 111x xxxx */
comment|/*  [0]  */
name|TNS
argument_list|(
literal|"feni"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fdisi"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fnclex"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fninit"
argument_list|,
name|NORM
argument_list|)
block|,
comment|/*  [4]  */
name|TNS
argument_list|(
literal|"fsetpm"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"frstpm"
argument_list|,
name|NORM
argument_list|)
block|,
name|INVALID
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opFP6
index|[
literal|8
index|]
init|=
block|{
comment|/* bit pattern:	1101 1011 11yy yxxx */
comment|/*  [00]  */
name|TNS
argument_list|(
literal|"fcmov.nb"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fcmov.ne"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fcmov.nbe"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fcmov.nu"
argument_list|,
name|FF
argument_list|)
block|,
comment|/*  [04]  */
name|INVALID
block|,
name|TNS
argument_list|(
literal|"fucomi"
argument_list|,
name|F
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fcomi"
argument_list|,
name|F
argument_list|)
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|instable_t
name|dis_opFP7
index|[
literal|8
index|]
init|=
block|{
comment|/* bit pattern:	1101 1010 11yy yxxx */
comment|/*  [00]  */
name|TNS
argument_list|(
literal|"fcmov.b"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fcmov.e"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fcmov.be"
argument_list|,
name|FF
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fcmov.u"
argument_list|,
name|FF
argument_list|)
block|,
comment|/*  [04]  */
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|,
name|INVALID
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Main decode table for the op codes.  The first two nibbles  *	will be used as an index into the table.  If there is a  *	a need to further decode an instruction, the array to be  *	referenced is indicated with the other two entries being  *	empty.  */
end_comment

begin_decl_stmt
specifier|const
name|instable_t
name|dis_distable
index|[
literal|16
index|]
index|[
literal|16
index|]
init|=
block|{
block|{
comment|/* [0,0] */
name|TNS
argument_list|(
literal|"addb"
argument_list|,
name|RMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"add"
argument_list|,
name|RMw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"addb"
argument_list|,
name|MRw
argument_list|)
block|,
name|TS
argument_list|(
literal|"add"
argument_list|,
name|MRw
argument_list|)
block|,
comment|/* [0,4] */
name|TNS
argument_list|(
literal|"addb"
argument_list|,
name|IA
argument_list|)
block|,
name|TS
argument_list|(
literal|"add"
argument_list|,
name|IA
argument_list|)
block|,
name|TSx
argument_list|(
literal|"push"
argument_list|,
name|SEG
argument_list|)
block|,
name|TSx
argument_list|(
literal|"pop"
argument_list|,
name|SEG
argument_list|)
block|,
comment|/* [0,8] */
name|TNS
argument_list|(
literal|"orb"
argument_list|,
name|RMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"or"
argument_list|,
name|RMw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"orb"
argument_list|,
name|MRw
argument_list|)
block|,
name|TS
argument_list|(
literal|"or"
argument_list|,
name|MRw
argument_list|)
block|,
comment|/* [0,C] */
name|TNS
argument_list|(
literal|"orb"
argument_list|,
name|IA
argument_list|)
block|,
name|TS
argument_list|(
literal|"or"
argument_list|,
name|IA
argument_list|)
block|,
name|TSx
argument_list|(
literal|"push"
argument_list|,
name|SEG
argument_list|)
block|,
name|IND
argument_list|(
name|dis_op0F
argument_list|)
block|, }
block|,
block|{
comment|/* [1,0] */
name|TNS
argument_list|(
literal|"adcb"
argument_list|,
name|RMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"adc"
argument_list|,
name|RMw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"adcb"
argument_list|,
name|MRw
argument_list|)
block|,
name|TS
argument_list|(
literal|"adc"
argument_list|,
name|MRw
argument_list|)
block|,
comment|/* [1,4] */
name|TNS
argument_list|(
literal|"adcb"
argument_list|,
name|IA
argument_list|)
block|,
name|TS
argument_list|(
literal|"adc"
argument_list|,
name|IA
argument_list|)
block|,
name|TSx
argument_list|(
literal|"push"
argument_list|,
name|SEG
argument_list|)
block|,
name|TSx
argument_list|(
literal|"pop"
argument_list|,
name|SEG
argument_list|)
block|,
comment|/* [1,8] */
name|TNS
argument_list|(
literal|"sbbb"
argument_list|,
name|RMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"sbb"
argument_list|,
name|RMw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"sbbb"
argument_list|,
name|MRw
argument_list|)
block|,
name|TS
argument_list|(
literal|"sbb"
argument_list|,
name|MRw
argument_list|)
block|,
comment|/* [1,C] */
name|TNS
argument_list|(
literal|"sbbb"
argument_list|,
name|IA
argument_list|)
block|,
name|TS
argument_list|(
literal|"sbb"
argument_list|,
name|IA
argument_list|)
block|,
name|TSx
argument_list|(
literal|"push"
argument_list|,
name|SEG
argument_list|)
block|,
name|TSx
argument_list|(
literal|"pop"
argument_list|,
name|SEG
argument_list|)
block|, }
block|,
block|{
comment|/* [2,0] */
name|TNS
argument_list|(
literal|"andb"
argument_list|,
name|RMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"and"
argument_list|,
name|RMw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"andb"
argument_list|,
name|MRw
argument_list|)
block|,
name|TS
argument_list|(
literal|"and"
argument_list|,
name|MRw
argument_list|)
block|,
comment|/* [2,4] */
name|TNS
argument_list|(
literal|"andb"
argument_list|,
name|IA
argument_list|)
block|,
name|TS
argument_list|(
literal|"and"
argument_list|,
name|IA
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"%es:"
argument_list|,
name|OVERRIDE
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"daa"
argument_list|,
name|NORM
argument_list|)
block|,
comment|/* [2,8] */
name|TNS
argument_list|(
literal|"subb"
argument_list|,
name|RMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"sub"
argument_list|,
name|RMw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"subb"
argument_list|,
name|MRw
argument_list|)
block|,
name|TS
argument_list|(
literal|"sub"
argument_list|,
name|MRw
argument_list|)
block|,
comment|/* [2,C] */
name|TNS
argument_list|(
literal|"subb"
argument_list|,
name|IA
argument_list|)
block|,
name|TS
argument_list|(
literal|"sub"
argument_list|,
name|IA
argument_list|)
block|,
name|TNS
argument_list|(
literal|"%cs:"
argument_list|,
name|OVERRIDE
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"das"
argument_list|,
name|NORM
argument_list|)
block|, }
block|,
block|{
comment|/* [3,0] */
name|TNS
argument_list|(
literal|"xorb"
argument_list|,
name|RMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"xor"
argument_list|,
name|RMw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"xorb"
argument_list|,
name|MRw
argument_list|)
block|,
name|TS
argument_list|(
literal|"xor"
argument_list|,
name|MRw
argument_list|)
block|,
comment|/* [3,4] */
name|TNS
argument_list|(
literal|"xorb"
argument_list|,
name|IA
argument_list|)
block|,
name|TS
argument_list|(
literal|"xor"
argument_list|,
name|IA
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"%ss:"
argument_list|,
name|OVERRIDE
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"aaa"
argument_list|,
name|NORM
argument_list|)
block|,
comment|/* [3,8] */
name|TNS
argument_list|(
literal|"cmpb"
argument_list|,
name|RMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmp"
argument_list|,
name|RMw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"cmpb"
argument_list|,
name|MRw
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmp"
argument_list|,
name|MRw
argument_list|)
block|,
comment|/* [3,C] */
name|TNS
argument_list|(
literal|"cmpb"
argument_list|,
name|IA
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmp"
argument_list|,
name|IA
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"%ds:"
argument_list|,
name|OVERRIDE
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"aas"
argument_list|,
name|NORM
argument_list|)
block|, }
block|,
block|{
comment|/* [4,0] */
name|TSx
argument_list|(
literal|"inc"
argument_list|,
name|R
argument_list|)
block|,
name|TSx
argument_list|(
literal|"inc"
argument_list|,
name|R
argument_list|)
block|,
name|TSx
argument_list|(
literal|"inc"
argument_list|,
name|R
argument_list|)
block|,
name|TSx
argument_list|(
literal|"inc"
argument_list|,
name|R
argument_list|)
block|,
comment|/* [4,4] */
name|TSx
argument_list|(
literal|"inc"
argument_list|,
name|R
argument_list|)
block|,
name|TSx
argument_list|(
literal|"inc"
argument_list|,
name|R
argument_list|)
block|,
name|TSx
argument_list|(
literal|"inc"
argument_list|,
name|R
argument_list|)
block|,
name|TSx
argument_list|(
literal|"inc"
argument_list|,
name|R
argument_list|)
block|,
comment|/* [4,8] */
name|TSx
argument_list|(
literal|"dec"
argument_list|,
name|R
argument_list|)
block|,
name|TSx
argument_list|(
literal|"dec"
argument_list|,
name|R
argument_list|)
block|,
name|TSx
argument_list|(
literal|"dec"
argument_list|,
name|R
argument_list|)
block|,
name|TSx
argument_list|(
literal|"dec"
argument_list|,
name|R
argument_list|)
block|,
comment|/* [4,C] */
name|TSx
argument_list|(
literal|"dec"
argument_list|,
name|R
argument_list|)
block|,
name|TSx
argument_list|(
literal|"dec"
argument_list|,
name|R
argument_list|)
block|,
name|TSx
argument_list|(
literal|"dec"
argument_list|,
name|R
argument_list|)
block|,
name|TSx
argument_list|(
literal|"dec"
argument_list|,
name|R
argument_list|)
block|, }
block|,
block|{
comment|/* [5,0] */
name|TSp
argument_list|(
literal|"push"
argument_list|,
name|R
argument_list|)
block|,
name|TSp
argument_list|(
literal|"push"
argument_list|,
name|R
argument_list|)
block|,
name|TSp
argument_list|(
literal|"push"
argument_list|,
name|R
argument_list|)
block|,
name|TSp
argument_list|(
literal|"push"
argument_list|,
name|R
argument_list|)
block|,
comment|/* [5,4] */
name|TSp
argument_list|(
literal|"push"
argument_list|,
name|R
argument_list|)
block|,
name|TSp
argument_list|(
literal|"push"
argument_list|,
name|R
argument_list|)
block|,
name|TSp
argument_list|(
literal|"push"
argument_list|,
name|R
argument_list|)
block|,
name|TSp
argument_list|(
literal|"push"
argument_list|,
name|R
argument_list|)
block|,
comment|/* [5,8] */
name|TSp
argument_list|(
literal|"pop"
argument_list|,
name|R
argument_list|)
block|,
name|TSp
argument_list|(
literal|"pop"
argument_list|,
name|R
argument_list|)
block|,
name|TSp
argument_list|(
literal|"pop"
argument_list|,
name|R
argument_list|)
block|,
name|TSp
argument_list|(
literal|"pop"
argument_list|,
name|R
argument_list|)
block|,
comment|/* [5,C] */
name|TSp
argument_list|(
literal|"pop"
argument_list|,
name|R
argument_list|)
block|,
name|TSp
argument_list|(
literal|"pop"
argument_list|,
name|R
argument_list|)
block|,
name|TSp
argument_list|(
literal|"pop"
argument_list|,
name|R
argument_list|)
block|,
name|TSp
argument_list|(
literal|"pop"
argument_list|,
name|R
argument_list|)
block|, }
block|,
block|{
comment|/* [6,0] */
name|TSZx
argument_list|(
literal|"pusha"
argument_list|,
name|IMPLMEM
argument_list|,
literal|28
argument_list|)
block|,
name|TSZx
argument_list|(
literal|"popa"
argument_list|,
name|IMPLMEM
argument_list|,
literal|28
argument_list|)
block|,
name|TSx
argument_list|(
literal|"bound"
argument_list|,
name|MR
argument_list|)
block|,
name|TNS
argument_list|(
literal|"arpl"
argument_list|,
name|RMw
argument_list|)
block|,
comment|/* [6,4] */
name|TNS
argument_list|(
literal|"%fs:"
argument_list|,
name|OVERRIDE
argument_list|)
block|,
name|TNS
argument_list|(
literal|"%gs:"
argument_list|,
name|OVERRIDE
argument_list|)
block|,
name|TNS
argument_list|(
literal|"data16"
argument_list|,
name|DM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"addr16"
argument_list|,
name|AM
argument_list|)
block|,
comment|/* [6,8] */
name|TSp
argument_list|(
literal|"push"
argument_list|,
name|I
argument_list|)
block|,
name|TS
argument_list|(
literal|"imul"
argument_list|,
name|IMUL
argument_list|)
block|,
name|TSp
argument_list|(
literal|"push"
argument_list|,
name|Ib
argument_list|)
block|,
name|TS
argument_list|(
literal|"imul"
argument_list|,
name|IMUL
argument_list|)
block|,
comment|/* [6,C] */
name|TNSZ
argument_list|(
literal|"insb"
argument_list|,
name|IMPLMEM
argument_list|,
literal|1
argument_list|)
block|,
name|TSZ
argument_list|(
literal|"ins"
argument_list|,
name|IMPLMEM
argument_list|,
literal|4
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"outsb"
argument_list|,
name|IMPLMEM
argument_list|,
literal|1
argument_list|)
block|,
name|TSZ
argument_list|(
literal|"outs"
argument_list|,
name|IMPLMEM
argument_list|,
literal|4
argument_list|)
block|, }
block|,
block|{
comment|/* [7,0] */
name|TNSy
argument_list|(
literal|"jo"
argument_list|,
name|BD
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"jno"
argument_list|,
name|BD
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"jb"
argument_list|,
name|BD
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"jae"
argument_list|,
name|BD
argument_list|)
block|,
comment|/* [7,4] */
name|TNSy
argument_list|(
literal|"je"
argument_list|,
name|BD
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"jne"
argument_list|,
name|BD
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"jbe"
argument_list|,
name|BD
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"ja"
argument_list|,
name|BD
argument_list|)
block|,
comment|/* [7,8] */
name|TNSy
argument_list|(
literal|"js"
argument_list|,
name|BD
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"jns"
argument_list|,
name|BD
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"jp"
argument_list|,
name|BD
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"jnp"
argument_list|,
name|BD
argument_list|)
block|,
comment|/* [7,C] */
name|TNSy
argument_list|(
literal|"jl"
argument_list|,
name|BD
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"jge"
argument_list|,
name|BD
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"jle"
argument_list|,
name|BD
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"jg"
argument_list|,
name|BD
argument_list|)
block|, }
block|,
block|{
comment|/* [8,0] */
name|IND
argument_list|(
name|dis_op80
argument_list|)
block|,
name|IND
argument_list|(
name|dis_op81
argument_list|)
block|,
name|INDx
argument_list|(
name|dis_op82
argument_list|)
block|,
name|IND
argument_list|(
name|dis_op83
argument_list|)
block|,
comment|/* [8,4] */
name|TNS
argument_list|(
literal|"testb"
argument_list|,
name|RMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"test"
argument_list|,
name|RMw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"xchgb"
argument_list|,
name|RMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"xchg"
argument_list|,
name|RMw
argument_list|)
block|,
comment|/* [8,8] */
name|TNS
argument_list|(
literal|"movb"
argument_list|,
name|RMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"mov"
argument_list|,
name|RMw
argument_list|)
block|,
name|TNS
argument_list|(
literal|"movb"
argument_list|,
name|MRw
argument_list|)
block|,
name|TS
argument_list|(
literal|"mov"
argument_list|,
name|MRw
argument_list|)
block|,
comment|/* [8,C] */
name|TNS
argument_list|(
literal|"movw"
argument_list|,
name|SM
argument_list|)
block|,
name|TS
argument_list|(
literal|"lea"
argument_list|,
name|MR
argument_list|)
block|,
name|TNS
argument_list|(
literal|"movw"
argument_list|,
name|MS
argument_list|)
block|,
name|TSp
argument_list|(
literal|"pop"
argument_list|,
name|M
argument_list|)
block|, }
block|,
block|{
comment|/* [9,0] */
name|TNS
argument_list|(
literal|"nop"
argument_list|,
name|NORM
argument_list|)
block|,
name|TS
argument_list|(
literal|"xchg"
argument_list|,
name|RA
argument_list|)
block|,
name|TS
argument_list|(
literal|"xchg"
argument_list|,
name|RA
argument_list|)
block|,
name|TS
argument_list|(
literal|"xchg"
argument_list|,
name|RA
argument_list|)
block|,
comment|/* [9,4] */
name|TS
argument_list|(
literal|"xchg"
argument_list|,
name|RA
argument_list|)
block|,
name|TS
argument_list|(
literal|"xchg"
argument_list|,
name|RA
argument_list|)
block|,
name|TS
argument_list|(
literal|"xchg"
argument_list|,
name|RA
argument_list|)
block|,
name|TS
argument_list|(
literal|"xchg"
argument_list|,
name|RA
argument_list|)
block|,
comment|/* [9,8] */
name|TNS
argument_list|(
literal|"cXtX"
argument_list|,
name|CBW
argument_list|)
block|,
name|TNS
argument_list|(
literal|"cXtX"
argument_list|,
name|CWD
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"lcall"
argument_list|,
name|SO
argument_list|)
block|,
name|TNS
argument_list|(
literal|"fwait"
argument_list|,
name|NORM
argument_list|)
block|,
comment|/* [9,C] */
name|TSZy
argument_list|(
literal|"pushf"
argument_list|,
name|IMPLMEM
argument_list|,
literal|4
argument_list|)
block|,
name|TSZy
argument_list|(
literal|"popf"
argument_list|,
name|IMPLMEM
argument_list|,
literal|4
argument_list|)
block|,
name|TNS
argument_list|(
literal|"sahf"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"lahf"
argument_list|,
name|NORM
argument_list|)
block|, }
block|,
block|{
comment|/* [A,0] */
name|TNS
argument_list|(
literal|"movb"
argument_list|,
name|OA
argument_list|)
block|,
name|TS
argument_list|(
literal|"mov"
argument_list|,
name|OA
argument_list|)
block|,
name|TNS
argument_list|(
literal|"movb"
argument_list|,
name|AO
argument_list|)
block|,
name|TS
argument_list|(
literal|"mov"
argument_list|,
name|AO
argument_list|)
block|,
comment|/* [A,4] */
name|TNSZ
argument_list|(
literal|"movsb"
argument_list|,
name|SD
argument_list|,
literal|1
argument_list|)
block|,
name|TS
argument_list|(
literal|"movs"
argument_list|,
name|SD
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"cmpsb"
argument_list|,
name|SD
argument_list|,
literal|1
argument_list|)
block|,
name|TS
argument_list|(
literal|"cmps"
argument_list|,
name|SD
argument_list|)
block|,
comment|/* [A,8] */
name|TNS
argument_list|(
literal|"testb"
argument_list|,
name|IA
argument_list|)
block|,
name|TS
argument_list|(
literal|"test"
argument_list|,
name|IA
argument_list|)
block|,
name|TNS
argument_list|(
literal|"stosb"
argument_list|,
name|AD
argument_list|)
block|,
name|TS
argument_list|(
literal|"stos"
argument_list|,
name|AD
argument_list|)
block|,
comment|/* [A,C] */
name|TNS
argument_list|(
literal|"lodsb"
argument_list|,
name|SA
argument_list|)
block|,
name|TS
argument_list|(
literal|"lods"
argument_list|,
name|SA
argument_list|)
block|,
name|TNS
argument_list|(
literal|"scasb"
argument_list|,
name|AD
argument_list|)
block|,
name|TS
argument_list|(
literal|"scas"
argument_list|,
name|AD
argument_list|)
block|, }
block|,
block|{
comment|/* [B,0] */
name|TNS
argument_list|(
literal|"movb"
argument_list|,
name|IR
argument_list|)
block|,
name|TNS
argument_list|(
literal|"movb"
argument_list|,
name|IR
argument_list|)
block|,
name|TNS
argument_list|(
literal|"movb"
argument_list|,
name|IR
argument_list|)
block|,
name|TNS
argument_list|(
literal|"movb"
argument_list|,
name|IR
argument_list|)
block|,
comment|/* [B,4] */
name|TNS
argument_list|(
literal|"movb"
argument_list|,
name|IR
argument_list|)
block|,
name|TNS
argument_list|(
literal|"movb"
argument_list|,
name|IR
argument_list|)
block|,
name|TNS
argument_list|(
literal|"movb"
argument_list|,
name|IR
argument_list|)
block|,
name|TNS
argument_list|(
literal|"movb"
argument_list|,
name|IR
argument_list|)
block|,
comment|/* [B,8] */
name|TS
argument_list|(
literal|"mov"
argument_list|,
name|IR
argument_list|)
block|,
name|TS
argument_list|(
literal|"mov"
argument_list|,
name|IR
argument_list|)
block|,
name|TS
argument_list|(
literal|"mov"
argument_list|,
name|IR
argument_list|)
block|,
name|TS
argument_list|(
literal|"mov"
argument_list|,
name|IR
argument_list|)
block|,
comment|/* [B,C] */
name|TS
argument_list|(
literal|"mov"
argument_list|,
name|IR
argument_list|)
block|,
name|TS
argument_list|(
literal|"mov"
argument_list|,
name|IR
argument_list|)
block|,
name|TS
argument_list|(
literal|"mov"
argument_list|,
name|IR
argument_list|)
block|,
name|TS
argument_list|(
literal|"mov"
argument_list|,
name|IR
argument_list|)
block|, }
block|,
block|{
comment|/* [C,0] */
name|IND
argument_list|(
name|dis_opC0
argument_list|)
block|,
name|IND
argument_list|(
name|dis_opC1
argument_list|)
block|,
name|TNSyp
argument_list|(
literal|"ret"
argument_list|,
name|RET
argument_list|)
block|,
name|TNSyp
argument_list|(
literal|"ret"
argument_list|,
name|NORM
argument_list|)
block|,
comment|/* [C,4] */
name|TNSx
argument_list|(
literal|"les"
argument_list|,
name|MR
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"lds"
argument_list|,
name|MR
argument_list|)
block|,
name|TNS
argument_list|(
literal|"movb"
argument_list|,
name|IMw
argument_list|)
block|,
name|TS
argument_list|(
literal|"mov"
argument_list|,
name|IMw
argument_list|)
block|,
comment|/* [C,8] */
name|TNSyp
argument_list|(
literal|"enter"
argument_list|,
name|ENTER
argument_list|)
block|,
name|TNSyp
argument_list|(
literal|"leave"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"lret"
argument_list|,
name|RET
argument_list|)
block|,
name|TNS
argument_list|(
literal|"lret"
argument_list|,
name|NORM
argument_list|)
block|,
comment|/* [C,C] */
name|TNS
argument_list|(
literal|"int"
argument_list|,
name|INT3
argument_list|)
block|,
name|TNS
argument_list|(
literal|"int"
argument_list|,
name|INTx
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"into"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"iret"
argument_list|,
name|NORM
argument_list|)
block|, }
block|,
block|{
comment|/* [D,0] */
name|IND
argument_list|(
name|dis_opD0
argument_list|)
block|,
name|IND
argument_list|(
name|dis_opD1
argument_list|)
block|,
name|IND
argument_list|(
name|dis_opD2
argument_list|)
block|,
name|IND
argument_list|(
name|dis_opD3
argument_list|)
block|,
comment|/* [D,4] */
name|TNSx
argument_list|(
literal|"aam"
argument_list|,
name|U
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"aad"
argument_list|,
name|U
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"falc"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNSZ
argument_list|(
literal|"xlat"
argument_list|,
name|IMPLMEM
argument_list|,
literal|1
argument_list|)
block|,
comment|/* 287 instructions.  Note that although the indirect field		*/
comment|/* indicates opFP1n2 for further decoding, this is not necessarily	*/
comment|/* the case since the opFP arrays are not partitioned according to key1	*/
comment|/* and key2.  opFP1n2 is given only to indicate that we haven't		*/
comment|/* finished decoding the instruction.					*/
comment|/* [D,8] */
name|IND
argument_list|(
name|dis_opFP1n2
argument_list|)
block|,
name|IND
argument_list|(
name|dis_opFP1n2
argument_list|)
block|,
name|IND
argument_list|(
name|dis_opFP1n2
argument_list|)
block|,
name|IND
argument_list|(
name|dis_opFP1n2
argument_list|)
block|,
comment|/* [D,C] */
name|IND
argument_list|(
name|dis_opFP1n2
argument_list|)
block|,
name|IND
argument_list|(
name|dis_opFP1n2
argument_list|)
block|,
name|IND
argument_list|(
name|dis_opFP1n2
argument_list|)
block|,
name|IND
argument_list|(
name|dis_opFP1n2
argument_list|)
block|, }
block|,
block|{
comment|/* [E,0] */
name|TNSy
argument_list|(
literal|"loopnz"
argument_list|,
name|BD
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"loopz"
argument_list|,
name|BD
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"loop"
argument_list|,
name|BD
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"jcxz"
argument_list|,
name|BD
argument_list|)
block|,
comment|/* [E,4] */
name|TNS
argument_list|(
literal|"inb"
argument_list|,
name|P
argument_list|)
block|,
name|TS
argument_list|(
literal|"in"
argument_list|,
name|P
argument_list|)
block|,
name|TNS
argument_list|(
literal|"outb"
argument_list|,
name|P
argument_list|)
block|,
name|TS
argument_list|(
literal|"out"
argument_list|,
name|P
argument_list|)
block|,
comment|/* [E,8] */
name|TNSyp
argument_list|(
literal|"call"
argument_list|,
name|D
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"jmp"
argument_list|,
name|D
argument_list|)
block|,
name|TNSx
argument_list|(
literal|"ljmp"
argument_list|,
name|SO
argument_list|)
block|,
name|TNSy
argument_list|(
literal|"jmp"
argument_list|,
name|BD
argument_list|)
block|,
comment|/* [E,C] */
name|TNS
argument_list|(
literal|"inb"
argument_list|,
name|V
argument_list|)
block|,
name|TS
argument_list|(
literal|"in"
argument_list|,
name|V
argument_list|)
block|,
name|TNS
argument_list|(
literal|"outb"
argument_list|,
name|V
argument_list|)
block|,
name|TS
argument_list|(
literal|"out"
argument_list|,
name|V
argument_list|)
block|, }
block|,
block|{
comment|/* [F,0] */
name|TNS
argument_list|(
literal|"lock"
argument_list|,
name|LOCK
argument_list|)
block|,
name|TNS
argument_list|(
literal|"icebp"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"repnz"
argument_list|,
name|PREFIX
argument_list|)
block|,
name|TNS
argument_list|(
literal|"repz"
argument_list|,
name|PREFIX
argument_list|)
block|,
comment|/* [F,4] */
name|TNS
argument_list|(
literal|"hlt"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"cmc"
argument_list|,
name|NORM
argument_list|)
block|,
name|IND
argument_list|(
name|dis_opF6
argument_list|)
block|,
name|IND
argument_list|(
name|dis_opF7
argument_list|)
block|,
comment|/* [F,8] */
name|TNS
argument_list|(
literal|"clc"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"stc"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"cli"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"sti"
argument_list|,
name|NORM
argument_list|)
block|,
comment|/* [F,C] */
name|TNS
argument_list|(
literal|"cld"
argument_list|,
name|NORM
argument_list|)
block|,
name|TNS
argument_list|(
literal|"std"
argument_list|,
name|NORM
argument_list|)
block|,
name|IND
argument_list|(
name|dis_opFE
argument_list|)
block|,
name|IND
argument_list|(
name|dis_opFF
argument_list|)
block|, }
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* END CSTYLED */
end_comment

begin_comment
comment|/*  * common functions to decode and disassemble an x86 or amd64 instruction  */
end_comment

begin_comment
comment|/*  * These are the individual fields of a REX prefix. Note that a REX  * prefix with none of these set is still needed to:  *	- use the MOVSXD (sign extend 32 to 64 bits) instruction  *	- access the %sil, %dil, %bpl, %spl registers  */
end_comment

begin_define
define|#
directive|define
name|REX_W
value|0x08
end_define

begin_comment
comment|/* 64 bit operand size when set */
end_comment

begin_define
define|#
directive|define
name|REX_R
value|0x04
end_define

begin_comment
comment|/* high order bit extension of ModRM reg field */
end_comment

begin_define
define|#
directive|define
name|REX_X
value|0x02
end_define

begin_comment
comment|/* high order bit extension of SIB index field */
end_comment

begin_define
define|#
directive|define
name|REX_B
value|0x01
end_define

begin_comment
comment|/* extends ModRM r_m, SIB base, or opcode reg */
end_comment

begin_comment
comment|/*  * These are the individual fields of a VEX prefix.  */
end_comment

begin_define
define|#
directive|define
name|VEX_R
value|0x08
end_define

begin_comment
comment|/* REX.R in 1's complement form */
end_comment

begin_define
define|#
directive|define
name|VEX_X
value|0x04
end_define

begin_comment
comment|/* REX.X in 1's complement form */
end_comment

begin_define
define|#
directive|define
name|VEX_B
value|0x02
end_define

begin_comment
comment|/* REX.B in 1's complement form */
end_comment

begin_comment
comment|/* Vector Length, 0: scalar or 128-bit vector, 1: 256-bit vector */
end_comment

begin_define
define|#
directive|define
name|VEX_L
value|0x04
end_define

begin_define
define|#
directive|define
name|VEX_W
value|0x08
end_define

begin_comment
comment|/* opcode specific, use like REX.W */
end_comment

begin_define
define|#
directive|define
name|VEX_m
value|0x1F
end_define

begin_comment
comment|/* VEX m-mmmm field */
end_comment

begin_define
define|#
directive|define
name|VEX_v
value|0x78
end_define

begin_comment
comment|/* VEX register specifier */
end_comment

begin_define
define|#
directive|define
name|VEX_p
value|0x03
end_define

begin_comment
comment|/* VEX pp field, opcode extension */
end_comment

begin_comment
comment|/* VEX m-mmmm field, only used by three bytes prefix */
end_comment

begin_define
define|#
directive|define
name|VEX_m_0F
value|0x01
end_define

begin_comment
comment|/* implied 0F leading opcode byte */
end_comment

begin_define
define|#
directive|define
name|VEX_m_0F38
value|0x02
end_define

begin_comment
comment|/* implied 0F 38 leading opcode byte */
end_comment

begin_define
define|#
directive|define
name|VEX_m_0F3A
value|0x03
end_define

begin_comment
comment|/* implied 0F 3A leading opcode byte */
end_comment

begin_comment
comment|/* VEX pp field, providing equivalent functionality of a SIMD prefix */
end_comment

begin_define
define|#
directive|define
name|VEX_p_66
value|0x01
end_define

begin_define
define|#
directive|define
name|VEX_p_F3
value|0x02
end_define

begin_define
define|#
directive|define
name|VEX_p_F2
value|0x03
end_define

begin_comment
comment|/*  * Even in 64 bit mode, usually only 4 byte immediate operands are supported.  */
end_comment

begin_decl_stmt
specifier|static
name|int
name|isize
index|[]
init|=
block|{
literal|1
block|,
literal|2
block|,
literal|4
block|,
literal|4
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|isize64
index|[]
init|=
block|{
literal|1
block|,
literal|2
block|,
literal|4
block|,
literal|8
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Just a bunch of useful macros.  */
end_comment

begin_define
define|#
directive|define
name|WBIT
parameter_list|(
name|x
parameter_list|)
value|(x& 0x1)
end_define

begin_comment
comment|/* to get w bit	*/
end_comment

begin_define
define|#
directive|define
name|REGNO
parameter_list|(
name|x
parameter_list|)
value|(x& 0x7)
end_define

begin_comment
comment|/* to get 3 bit register */
end_comment

begin_define
define|#
directive|define
name|VBIT
parameter_list|(
name|x
parameter_list|)
value|((x)>>1& 0x1)
end_define

begin_comment
comment|/* to get 'v' bit */
end_comment

begin_define
define|#
directive|define
name|OPSIZE
parameter_list|(
name|osize
parameter_list|,
name|wbit
parameter_list|)
value|((wbit) ? isize[osize] : 1)
end_define

begin_define
define|#
directive|define
name|OPSIZE64
parameter_list|(
name|osize
parameter_list|,
name|wbit
parameter_list|)
value|((wbit) ? isize64[osize] : 1)
end_define

begin_define
define|#
directive|define
name|REG_ONLY
value|3
end_define

begin_comment
comment|/* mode to indicate a register operand (not memory) */
end_comment

begin_define
define|#
directive|define
name|BYTE_OPND
value|0
end_define

begin_comment
comment|/* w-bit value indicating byte register */
end_comment

begin_define
define|#
directive|define
name|LONG_OPND
value|1
end_define

begin_comment
comment|/* w-bit value indicating opnd_size register */
end_comment

begin_define
define|#
directive|define
name|MM_OPND
value|2
end_define

begin_comment
comment|/* "value" used to indicate a mmx reg */
end_comment

begin_define
define|#
directive|define
name|XMM_OPND
value|3
end_define

begin_comment
comment|/* "value" used to indicate a xmm reg */
end_comment

begin_define
define|#
directive|define
name|SEG_OPND
value|4
end_define

begin_comment
comment|/* "value" used to indicate a segment reg */
end_comment

begin_define
define|#
directive|define
name|CONTROL_OPND
value|5
end_define

begin_comment
comment|/* "value" used to indicate a control reg */
end_comment

begin_define
define|#
directive|define
name|DEBUG_OPND
value|6
end_define

begin_comment
comment|/* "value" used to indicate a debug reg */
end_comment

begin_define
define|#
directive|define
name|TEST_OPND
value|7
end_define

begin_comment
comment|/* "value" used to indicate a test reg */
end_comment

begin_define
define|#
directive|define
name|WORD_OPND
value|8
end_define

begin_comment
comment|/* w-bit value indicating word size reg */
end_comment

begin_define
define|#
directive|define
name|YMM_OPND
value|9
end_define

begin_comment
comment|/* "value" used to indicate a ymm reg */
end_comment

begin_comment
comment|/*  * Get the next byte and separate the op code into the high and low nibbles.  */
end_comment

begin_function
specifier|static
name|int
name|dtrace_get_opcode
parameter_list|(
name|dis86_t
modifier|*
name|x
parameter_list|,
name|uint_t
modifier|*
name|high
parameter_list|,
name|uint_t
modifier|*
name|low
parameter_list|)
block|{
name|int
name|byte
decl_stmt|;
comment|/* 	 * x86 instructions have a maximum length of 15 bytes.  Bail out if 	 * we try to read more. 	 */
if|if
condition|(
name|x
operator|->
name|d86_len
operator|>=
literal|15
condition|)
return|return
operator|(
name|x
operator|->
name|d86_error
operator|=
literal|1
operator|)
return|;
if|if
condition|(
name|x
operator|->
name|d86_error
condition|)
return|return
operator|(
literal|1
operator|)
return|;
name|byte
operator|=
name|x
operator|->
name|d86_get_byte
argument_list|(
name|x
operator|->
name|d86_data
argument_list|)
expr_stmt|;
if|if
condition|(
name|byte
operator|<
literal|0
condition|)
return|return
operator|(
name|x
operator|->
name|d86_error
operator|=
literal|1
operator|)
return|;
name|x
operator|->
name|d86_bytes
index|[
name|x
operator|->
name|d86_len
operator|++
index|]
operator|=
name|byte
expr_stmt|;
operator|*
name|low
operator|=
name|byte
operator|&
literal|0xf
expr_stmt|;
comment|/* ----xxxx low 4 bits */
operator|*
name|high
operator|=
name|byte
operator|>>
literal|4
operator|&
literal|0xf
expr_stmt|;
comment|/* xxxx---- bits 7 to 4 */
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Get and decode an SIB (scaled index base) byte  */
end_comment

begin_function
specifier|static
name|void
name|dtrace_get_SIB
parameter_list|(
name|dis86_t
modifier|*
name|x
parameter_list|,
name|uint_t
modifier|*
name|ss
parameter_list|,
name|uint_t
modifier|*
name|index
parameter_list|,
name|uint_t
modifier|*
name|base
parameter_list|)
block|{
name|int
name|byte
decl_stmt|;
if|if
condition|(
name|x
operator|->
name|d86_error
condition|)
return|return;
name|byte
operator|=
name|x
operator|->
name|d86_get_byte
argument_list|(
name|x
operator|->
name|d86_data
argument_list|)
expr_stmt|;
if|if
condition|(
name|byte
operator|<
literal|0
condition|)
block|{
name|x
operator|->
name|d86_error
operator|=
literal|1
expr_stmt|;
return|return;
block|}
name|x
operator|->
name|d86_bytes
index|[
name|x
operator|->
name|d86_len
operator|++
index|]
operator|=
name|byte
expr_stmt|;
operator|*
name|base
operator|=
name|byte
operator|&
literal|0x7
expr_stmt|;
operator|*
name|index
operator|=
operator|(
name|byte
operator|>>
literal|3
operator|)
operator|&
literal|0x7
expr_stmt|;
operator|*
name|ss
operator|=
operator|(
name|byte
operator|>>
literal|6
operator|)
operator|&
literal|0x3
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Get the byte following the op code and separate it into the  * mode, register, and r/m fields.  */
end_comment

begin_function
specifier|static
name|void
name|dtrace_get_modrm
parameter_list|(
name|dis86_t
modifier|*
name|x
parameter_list|,
name|uint_t
modifier|*
name|mode
parameter_list|,
name|uint_t
modifier|*
name|reg
parameter_list|,
name|uint_t
modifier|*
name|r_m
parameter_list|)
block|{
if|if
condition|(
name|x
operator|->
name|d86_got_modrm
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|x
operator|->
name|d86_rmindex
operator|==
operator|-
literal|1
condition|)
name|x
operator|->
name|d86_rmindex
operator|=
name|x
operator|->
name|d86_len
expr_stmt|;
name|dtrace_get_SIB
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|)
expr_stmt|;
name|x
operator|->
name|d86_got_modrm
operator|=
literal|1
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*  * Adjust register selection based on any REX prefix bits present.  */
end_comment

begin_comment
comment|/*ARGSUSED*/
end_comment

begin_function
specifier|static
name|void
name|dtrace_rex_adjust
parameter_list|(
name|uint_t
name|rex_prefix
parameter_list|,
name|uint_t
name|mode
parameter_list|,
name|uint_t
modifier|*
name|reg
parameter_list|,
name|uint_t
modifier|*
name|r_m
parameter_list|)
block|{
if|if
condition|(
name|reg
operator|!=
name|NULL
operator|&&
name|r_m
operator|==
name|NULL
condition|)
block|{
if|if
condition|(
name|rex_prefix
operator|&
name|REX_B
condition|)
operator|*
name|reg
operator|+=
literal|8
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|reg
operator|!=
name|NULL
operator|&&
operator|(
name|REX_R
operator|&
name|rex_prefix
operator|)
operator|!=
literal|0
condition|)
operator|*
name|reg
operator|+=
literal|8
expr_stmt|;
if|if
condition|(
name|r_m
operator|!=
name|NULL
operator|&&
operator|(
name|REX_B
operator|&
name|rex_prefix
operator|)
operator|!=
literal|0
condition|)
operator|*
name|r_m
operator|+=
literal|8
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*  * Adjust register selection based on any VEX prefix bits present.  * Notes: VEX.R, VEX.X and VEX.B use the inverted form compared with REX prefix  */
end_comment

begin_comment
comment|/*ARGSUSED*/
end_comment

begin_function
specifier|static
name|void
name|dtrace_vex_adjust
parameter_list|(
name|uint_t
name|vex_byte1
parameter_list|,
name|uint_t
name|mode
parameter_list|,
name|uint_t
modifier|*
name|reg
parameter_list|,
name|uint_t
modifier|*
name|r_m
parameter_list|)
block|{
if|if
condition|(
name|reg
operator|!=
name|NULL
operator|&&
name|r_m
operator|==
name|NULL
condition|)
block|{
if|if
condition|(
operator|!
operator|(
name|vex_byte1
operator|&
name|VEX_B
operator|)
condition|)
operator|*
name|reg
operator|+=
literal|8
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|reg
operator|!=
name|NULL
operator|&&
operator|(
operator|(
name|VEX_R
operator|&
name|vex_byte1
operator|)
operator|==
literal|0
operator|)
condition|)
operator|*
name|reg
operator|+=
literal|8
expr_stmt|;
if|if
condition|(
name|r_m
operator|!=
name|NULL
operator|&&
operator|(
operator|(
name|VEX_B
operator|&
name|vex_byte1
operator|)
operator|==
literal|0
operator|)
condition|)
operator|*
name|r_m
operator|+=
literal|8
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*  * Get an immediate operand of the given size, with sign extension.  */
end_comment

begin_function
specifier|static
name|void
name|dtrace_imm_opnd
parameter_list|(
name|dis86_t
modifier|*
name|x
parameter_list|,
name|int
name|wbit
parameter_list|,
name|int
name|size
parameter_list|,
name|int
name|opindex
parameter_list|)
block|{
name|int
name|i
decl_stmt|;
name|int
name|byte
decl_stmt|;
name|int
name|valsize
decl_stmt|;
if|if
condition|(
name|x
operator|->
name|d86_numopnds
operator|<
name|opindex
operator|+
literal|1
condition|)
name|x
operator|->
name|d86_numopnds
operator|=
name|opindex
operator|+
literal|1
expr_stmt|;
switch|switch
condition|(
name|wbit
condition|)
block|{
case|case
name|BYTE_OPND
case|:
name|valsize
operator|=
literal|1
expr_stmt|;
break|break;
case|case
name|LONG_OPND
case|:
if|if
condition|(
name|x
operator|->
name|d86_opnd_size
operator|==
name|SIZE16
condition|)
name|valsize
operator|=
literal|2
expr_stmt|;
elseif|else
if|if
condition|(
name|x
operator|->
name|d86_opnd_size
operator|==
name|SIZE32
condition|)
name|valsize
operator|=
literal|4
expr_stmt|;
else|else
name|valsize
operator|=
literal|8
expr_stmt|;
break|break;
case|case
name|MM_OPND
case|:
case|case
name|XMM_OPND
case|:
case|case
name|YMM_OPND
case|:
case|case
name|SEG_OPND
case|:
case|case
name|CONTROL_OPND
case|:
case|case
name|DEBUG_OPND
case|:
case|case
name|TEST_OPND
case|:
name|valsize
operator|=
name|size
expr_stmt|;
break|break;
case|case
name|WORD_OPND
case|:
name|valsize
operator|=
literal|2
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|valsize
operator|<
name|size
condition|)
name|valsize
operator|=
name|size
expr_stmt|;
if|if
condition|(
name|x
operator|->
name|d86_error
condition|)
return|return;
name|x
operator|->
name|d86_opnd
index|[
name|opindex
index|]
operator|.
name|d86_value
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|size
condition|;
operator|++
name|i
control|)
block|{
name|byte
operator|=
name|x
operator|->
name|d86_get_byte
argument_list|(
name|x
operator|->
name|d86_data
argument_list|)
expr_stmt|;
if|if
condition|(
name|byte
operator|<
literal|0
condition|)
block|{
name|x
operator|->
name|d86_error
operator|=
literal|1
expr_stmt|;
return|return;
block|}
name|x
operator|->
name|d86_bytes
index|[
name|x
operator|->
name|d86_len
operator|++
index|]
operator|=
name|byte
expr_stmt|;
name|x
operator|->
name|d86_opnd
index|[
name|opindex
index|]
operator|.
name|d86_value
operator||=
operator|(
name|uint64_t
operator|)
name|byte
operator|<<
operator|(
name|i
operator|*
literal|8
operator|)
expr_stmt|;
block|}
comment|/* Do sign extension */
if|if
condition|(
name|x
operator|->
name|d86_bytes
index|[
name|x
operator|->
name|d86_len
operator|-
literal|1
index|]
operator|&
literal|0x80
condition|)
block|{
for|for
control|(
init|;
name|i
operator|<
sizeof|sizeof
argument_list|(
name|uint64_t
argument_list|)
condition|;
name|i
operator|++
control|)
name|x
operator|->
name|d86_opnd
index|[
name|opindex
index|]
operator|.
name|d86_value
operator||=
operator|(
name|uint64_t
operator|)
literal|0xff
operator|<<
operator|(
name|i
operator|*
literal|8
operator|)
expr_stmt|;
block|}
ifdef|#
directive|ifdef
name|DIS_TEXT
name|x
operator|->
name|d86_opnd
index|[
name|opindex
index|]
operator|.
name|d86_mode
operator|=
name|MODE_SIGNED
expr_stmt|;
name|x
operator|->
name|d86_opnd
index|[
name|opindex
index|]
operator|.
name|d86_value_size
operator|=
name|valsize
expr_stmt|;
name|x
operator|->
name|d86_imm_bytes
operator|+=
name|size
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_comment
comment|/*  * Get an ip relative operand of the given size, with sign extension.  */
end_comment

begin_function
specifier|static
name|void
name|dtrace_disp_opnd
parameter_list|(
name|dis86_t
modifier|*
name|x
parameter_list|,
name|int
name|wbit
parameter_list|,
name|int
name|size
parameter_list|,
name|int
name|opindex
parameter_list|)
block|{
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
name|size
argument_list|,
name|opindex
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
name|x
operator|->
name|d86_opnd
index|[
name|opindex
index|]
operator|.
name|d86_mode
operator|=
name|MODE_IPREL
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_comment
comment|/*  * Check to see if there is a segment override prefix pending.  * If so, print it in the current 'operand' location and set  * the override flag back to false.  */
end_comment

begin_comment
comment|/*ARGSUSED*/
end_comment

begin_function
specifier|static
name|void
name|dtrace_check_override
parameter_list|(
name|dis86_t
modifier|*
name|x
parameter_list|,
name|int
name|opindex
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
name|x
operator|->
name|d86_seg_prefix
condition|)
block|{
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
name|opindex
index|]
operator|.
name|d86_prefix
argument_list|,
name|x
operator|->
name|d86_seg_prefix
argument_list|,
name|PFIXLEN
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
name|x
operator|->
name|d86_seg_prefix
operator|=
name|NULL
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Process a single instruction Register or Memory operand.  *  * mode = addressing mode from ModRM byte  * r_m = r_m (or reg if mode == 3) field from ModRM byte  * wbit = indicates which register (8bit, 16bit, ... MMX, etc.) set to use.  * o = index of operand that we are processing (0, 1 or 2)  *  * the value of reg or r_m must have already been adjusted for any REX prefix.  */
end_comment

begin_comment
comment|/*ARGSUSED*/
end_comment

begin_function
specifier|static
name|void
name|dtrace_get_operand
parameter_list|(
name|dis86_t
modifier|*
name|x
parameter_list|,
name|uint_t
name|mode
parameter_list|,
name|uint_t
name|r_m
parameter_list|,
name|int
name|wbit
parameter_list|,
name|int
name|opindex
parameter_list|)
block|{
name|int
name|have_SIB
init|=
literal|0
decl_stmt|;
comment|/* flag presence of scale-index-byte */
name|uint_t
name|ss
decl_stmt|;
comment|/* scale-factor from opcode */
name|uint_t
name|index
decl_stmt|;
comment|/* index register number */
name|uint_t
name|base
decl_stmt|;
comment|/* base register number */
name|int
name|dispsize
decl_stmt|;
comment|/* size of displacement in bytes */
ifdef|#
directive|ifdef
name|DIS_TEXT
name|char
modifier|*
name|opnd
init|=
name|x
operator|->
name|d86_opnd
index|[
name|opindex
index|]
operator|.
name|d86_opnd
decl_stmt|;
endif|#
directive|endif
if|if
condition|(
name|x
operator|->
name|d86_numopnds
operator|<
name|opindex
operator|+
literal|1
condition|)
name|x
operator|->
name|d86_numopnds
operator|=
name|opindex
operator|+
literal|1
expr_stmt|;
if|if
condition|(
name|x
operator|->
name|d86_error
condition|)
return|return;
comment|/* 	 * first handle a simple register 	 */
if|if
condition|(
name|mode
operator|==
name|REG_ONLY
condition|)
block|{
ifdef|#
directive|ifdef
name|DIS_TEXT
switch|switch
condition|(
name|wbit
condition|)
block|{
case|case
name|MM_OPND
case|:
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_MMREG
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
break|break;
case|case
name|XMM_OPND
case|:
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_XMMREG
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
break|break;
case|case
name|YMM_OPND
case|:
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_YMMREG
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
break|break;
case|case
name|SEG_OPND
case|:
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_SEGREG
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
break|break;
case|case
name|CONTROL_OPND
case|:
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_CONTROLREG
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
break|break;
case|case
name|DEBUG_OPND
case|:
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_DEBUGREG
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
break|break;
case|case
name|TEST_OPND
case|:
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_TESTREG
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
break|break;
case|case
name|BYTE_OPND
case|:
if|if
condition|(
name|x
operator|->
name|d86_rex_prefix
operator|==
literal|0
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_REG8
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
else|else
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_REG8_REX
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
break|break;
case|case
name|WORD_OPND
case|:
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_REG16
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
break|break;
case|case
name|LONG_OPND
case|:
if|if
condition|(
name|x
operator|->
name|d86_opnd_size
operator|==
name|SIZE16
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_REG16
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|x
operator|->
name|d86_opnd_size
operator|==
name|SIZE32
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_REG32
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
else|else
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_REG64
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
break|break;
block|}
endif|#
directive|endif
comment|/* DIS_TEXT */
return|return;
block|}
comment|/* 	 * if symbolic representation, skip override prefix, if any 	 */
name|dtrace_check_override
argument_list|(
name|x
argument_list|,
name|opindex
argument_list|)
expr_stmt|;
comment|/* 	 * Handle 16 bit memory references first, since they decode 	 * the mode values more simply. 	 * mode 1 is r_m + 8 bit displacement 	 * mode 2 is r_m + 16 bit displacement 	 * mode 0 is just r_m, unless r_m is 6 which is 16 bit disp 	 */
if|if
condition|(
name|x
operator|->
name|d86_addr_size
operator|==
name|SIZE16
condition|)
block|{
if|if
condition|(
operator|(
name|mode
operator|==
literal|0
operator|&&
name|r_m
operator|==
literal|6
operator|)
operator|||
name|mode
operator|==
literal|2
condition|)
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|WORD_OPND
argument_list|,
literal|2
argument_list|,
name|opindex
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|mode
operator|==
literal|1
condition|)
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|BYTE_OPND
argument_list|,
literal|1
argument_list|,
name|opindex
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
name|mode
operator|==
literal|0
operator|&&
name|r_m
operator|==
literal|6
condition|)
name|x
operator|->
name|d86_opnd
index|[
name|opindex
index|]
operator|.
name|d86_mode
operator|=
name|MODE_SIGNED
expr_stmt|;
elseif|else
if|if
condition|(
name|mode
operator|==
literal|0
condition|)
name|x
operator|->
name|d86_opnd
index|[
name|opindex
index|]
operator|.
name|d86_mode
operator|=
name|MODE_NONE
expr_stmt|;
else|else
name|x
operator|->
name|d86_opnd
index|[
name|opindex
index|]
operator|.
name|d86_mode
operator|=
name|MODE_OFFSET
expr_stmt|;
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_addr16
index|[
name|mode
index|]
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
return|return;
block|}
comment|/* 	 * 32 and 64 bit addressing modes are more complex since they 	 * can involve an SIB (scaled index and base) byte to decode. 	 */
if|if
condition|(
name|r_m
operator|==
name|ESP_REGNO
operator|||
name|r_m
operator|==
name|ESP_REGNO
operator|+
literal|8
condition|)
block|{
name|have_SIB
operator|=
literal|1
expr_stmt|;
name|dtrace_get_SIB
argument_list|(
name|x
argument_list|,
operator|&
name|ss
argument_list|,
operator|&
name|index
argument_list|,
operator|&
name|base
argument_list|)
expr_stmt|;
if|if
condition|(
name|x
operator|->
name|d86_error
condition|)
return|return;
if|if
condition|(
name|base
operator|!=
literal|5
operator|||
name|mode
operator|!=
literal|0
condition|)
if|if
condition|(
name|x
operator|->
name|d86_rex_prefix
operator|&
name|REX_B
condition|)
name|base
operator|+=
literal|8
expr_stmt|;
if|if
condition|(
name|x
operator|->
name|d86_rex_prefix
operator|&
name|REX_X
condition|)
name|index
operator|+=
literal|8
expr_stmt|;
block|}
else|else
block|{
name|base
operator|=
name|r_m
expr_stmt|;
block|}
comment|/* 	 * Compute the displacement size and get its bytes 	 */
name|dispsize
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|mode
operator|==
literal|1
condition|)
name|dispsize
operator|=
literal|1
expr_stmt|;
elseif|else
if|if
condition|(
name|mode
operator|==
literal|2
condition|)
name|dispsize
operator|=
literal|4
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|r_m
operator|&
literal|7
operator|)
operator|==
name|EBP_REGNO
operator|||
operator|(
name|have_SIB
operator|&&
operator|(
name|base
operator|&
literal|7
operator|)
operator|==
name|EBP_REGNO
operator|)
condition|)
name|dispsize
operator|=
literal|4
expr_stmt|;
if|if
condition|(
name|dispsize
operator|>
literal|0
condition|)
block|{
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|dispsize
operator|==
literal|4
condition|?
name|LONG_OPND
else|:
name|BYTE_OPND
argument_list|,
name|dispsize
argument_list|,
name|opindex
argument_list|)
expr_stmt|;
if|if
condition|(
name|x
operator|->
name|d86_error
condition|)
return|return;
block|}
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
name|dispsize
operator|>
literal|0
condition|)
name|x
operator|->
name|d86_opnd
index|[
name|opindex
index|]
operator|.
name|d86_mode
operator|=
name|MODE_OFFSET
expr_stmt|;
if|if
condition|(
name|have_SIB
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|x
operator|->
name|d86_mode
operator|==
name|SIZE32
condition|)
block|{
if|if
condition|(
name|mode
operator|==
literal|0
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_addr32_mode0
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
else|else
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_addr32_mode12
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|mode
operator|==
literal|0
condition|)
block|{
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_addr64_mode0
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
if|if
condition|(
name|r_m
operator|==
literal|5
condition|)
block|{
name|x
operator|->
name|d86_opnd
index|[
name|opindex
index|]
operator|.
name|d86_mode
operator|=
name|MODE_RIPREL
expr_stmt|;
block|}
block|}
else|else
block|{
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_addr64_mode12
index|[
name|r_m
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
block|}
block|}
block|}
else|else
block|{
name|uint_t
name|need_paren
init|=
literal|0
decl_stmt|;
name|char
modifier|*
modifier|*
name|regs
decl_stmt|;
if|if
condition|(
name|x
operator|->
name|d86_mode
operator|==
name|SIZE32
condition|)
comment|/* NOTE this is not addr_size! */
name|regs
operator|=
operator|(
name|char
operator|*
operator|*
operator|)
name|dis_REG32
expr_stmt|;
else|else
name|regs
operator|=
operator|(
name|char
operator|*
operator|*
operator|)
name|dis_REG64
expr_stmt|;
comment|/* 		 * print the base (if any) 		 */
if|if
condition|(
name|base
operator|==
name|EBP_REGNO
operator|&&
name|mode
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|index
operator|!=
name|ESP_REGNO
condition|)
block|{
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
literal|"("
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
name|need_paren
operator|=
literal|1
expr_stmt|;
block|}
block|}
else|else
block|{
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
literal|"("
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|regs
index|[
name|base
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
name|need_paren
operator|=
literal|1
expr_stmt|;
block|}
comment|/* 		 * print the index (if any) 		 */
if|if
condition|(
name|index
operator|!=
name|ESP_REGNO
condition|)
block|{
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
literal|","
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|regs
index|[
name|index
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
name|dis_scale_factor
index|[
name|ss
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|need_paren
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|opnd
argument_list|,
literal|")"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
block|}
end_function

begin_comment
comment|/*  * Operand sequence for standard instruction involving one register  * and one register/memory operand.  * wbit indicates a byte(0) or opnd_size(1) operation  * vbit indicates direction (0 for "opcode r,r_m") or (1 for "opcode r_m, r")  */
end_comment

begin_define
define|#
directive|define
name|STANDARD_MODRM
parameter_list|(
name|x
parameter_list|,
name|mode
parameter_list|,
name|reg
parameter_list|,
name|r_m
parameter_list|,
name|rex_prefix
parameter_list|,
name|wbit
parameter_list|,
name|vbit
parameter_list|)
value|{	\ 		dtrace_get_modrm(x,&mode,&reg,&r_m);			\ 		dtrace_rex_adjust(rex_prefix, mode,&reg,&r_m);	\ 		dtrace_get_operand(x, mode, r_m, wbit, vbit);		\ 		dtrace_get_operand(x, REG_ONLY, reg, wbit, 1 - vbit);	\ }
end_define

begin_comment
comment|/*  * Similar to above, but allows for the two operands to be of different  * classes (ie. wbit).  *	wbit is for the r_m operand  *	w2 is for the reg operand  */
end_comment

begin_define
define|#
directive|define
name|MIXED_MM
parameter_list|(
name|x
parameter_list|,
name|mode
parameter_list|,
name|reg
parameter_list|,
name|r_m
parameter_list|,
name|rex_prefix
parameter_list|,
name|wbit
parameter_list|,
name|w2
parameter_list|,
name|vbit
parameter_list|)
value|{	\ 		dtrace_get_modrm(x,&mode,&reg,&r_m);			\ 		dtrace_rex_adjust(rex_prefix, mode,&reg,&r_m);	\ 		dtrace_get_operand(x, mode, r_m, wbit, vbit);		\ 		dtrace_get_operand(x, REG_ONLY, reg, w2, 1 - vbit);	\ }
end_define

begin_comment
comment|/*  * Similar, but for 2 operands plus an immediate.  * vbit indicates direction  * 	0 for "opcode imm, r, r_m" or  *	1 for "opcode imm, r_m, r"  */
end_comment

begin_define
define|#
directive|define
name|THREEOPERAND
parameter_list|(
name|x
parameter_list|,
name|mode
parameter_list|,
name|reg
parameter_list|,
name|r_m
parameter_list|,
name|rex_prefix
parameter_list|,
name|wbit
parameter_list|,
name|w2
parameter_list|,
name|immsize
parameter_list|,
name|vbit
parameter_list|)
value|{ \ 		dtrace_get_modrm(x,&mode,&reg,&r_m);			\ 		dtrace_rex_adjust(rex_prefix, mode,&reg,&r_m);	\ 		dtrace_get_operand(x, mode, r_m, wbit, 2-vbit);		\ 		dtrace_get_operand(x, REG_ONLY, reg, w2, 1+vbit);	\ 		dtrace_imm_opnd(x, wbit, immsize, 0);			\ }
end_define

begin_comment
comment|/*  * Similar, but for 2 operands plus two immediates.  */
end_comment

begin_define
define|#
directive|define
name|FOUROPERAND
parameter_list|(
name|x
parameter_list|,
name|mode
parameter_list|,
name|reg
parameter_list|,
name|r_m
parameter_list|,
name|rex_prefix
parameter_list|,
name|wbit
parameter_list|,
name|w2
parameter_list|,
name|immsize
parameter_list|)
value|{ \ 		dtrace_get_modrm(x,&mode,&reg,&r_m);			\ 		dtrace_rex_adjust(rex_prefix, mode,&reg,&r_m);	\ 		dtrace_get_operand(x, mode, r_m, wbit, 2);		\ 		dtrace_get_operand(x, REG_ONLY, reg, w2, 3);		\ 		dtrace_imm_opnd(x, wbit, immsize, 1);			\ 		dtrace_imm_opnd(x, wbit, immsize, 0);			\ }
end_define

begin_comment
comment|/*  * 1 operands plus two immediates.  */
end_comment

begin_define
define|#
directive|define
name|ONEOPERAND_TWOIMM
parameter_list|(
name|x
parameter_list|,
name|mode
parameter_list|,
name|reg
parameter_list|,
name|r_m
parameter_list|,
name|rex_prefix
parameter_list|,
name|wbit
parameter_list|,
name|immsize
parameter_list|)
value|{ \ 		dtrace_get_modrm(x,&mode,&reg,&r_m);			\ 		dtrace_rex_adjust(rex_prefix, mode,&reg,&r_m);	\ 		dtrace_get_operand(x, mode, r_m, wbit, 2);		\ 		dtrace_imm_opnd(x, wbit, immsize, 1);			\ 		dtrace_imm_opnd(x, wbit, immsize, 0);			\ }
end_define

begin_comment
comment|/*  * Dissassemble a single x86 or amd64 instruction.  *  * Mode determines the default operating mode (SIZE16, SIZE32 or SIZE64)  * for interpreting instructions.  *  * returns non-zero for bad opcode  */
end_comment

begin_function
name|int
name|dtrace_disx86
parameter_list|(
name|dis86_t
modifier|*
name|x
parameter_list|,
name|uint_t
name|cpu_mode
parameter_list|)
block|{
name|instable_t
modifier|*
name|dp
decl_stmt|;
comment|/* decode table being used */
ifdef|#
directive|ifdef
name|DIS_TEXT
name|uint_t
name|i
decl_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|DIS_MEM
name|uint_t
name|nomem
init|=
literal|0
decl_stmt|;
define|#
directive|define
name|NOMEM
value|(nomem = 1)
else|#
directive|else
define|#
directive|define
name|NOMEM
comment|/* nothing */
endif|#
directive|endif
name|uint_t
name|opnd_size
decl_stmt|;
comment|/* SIZE16, SIZE32 or SIZE64 */
name|uint_t
name|addr_size
decl_stmt|;
comment|/* SIZE16, SIZE32 or SIZE64 */
name|uint_t
name|wbit
decl_stmt|;
comment|/* opcode wbit, 0 is 8 bit, !0 for opnd_size */
name|uint_t
name|w2
decl_stmt|;
comment|/* wbit value for second operand */
name|uint_t
name|vbit
decl_stmt|;
name|uint_t
name|mode
init|=
literal|0
decl_stmt|;
comment|/* mode value from ModRM byte */
name|uint_t
name|reg
decl_stmt|;
comment|/* reg value from ModRM byte */
name|uint_t
name|r_m
decl_stmt|;
comment|/* r_m value from ModRM byte */
name|uint_t
name|opcode1
decl_stmt|;
comment|/* high nibble of 1st byte */
name|uint_t
name|opcode2
decl_stmt|;
comment|/* low nibble of 1st byte */
name|uint_t
name|opcode3
decl_stmt|;
comment|/* extra opcode bits usually from ModRM byte */
name|uint_t
name|opcode4
decl_stmt|;
comment|/* high nibble of 2nd byte */
name|uint_t
name|opcode5
decl_stmt|;
comment|/* low nibble of 2nd byte */
name|uint_t
name|opcode6
decl_stmt|;
comment|/* high nibble of 3rd byte */
name|uint_t
name|opcode7
decl_stmt|;
comment|/* low nibble of 3rd byte */
name|uint_t
name|opcode_bytes
init|=
literal|1
decl_stmt|;
comment|/* 	 * legacy prefixes come in 5 flavors, you should have only one of each 	 */
name|uint_t
name|opnd_size_prefix
init|=
literal|0
decl_stmt|;
name|uint_t
name|addr_size_prefix
init|=
literal|0
decl_stmt|;
name|uint_t
name|segment_prefix
init|=
literal|0
decl_stmt|;
name|uint_t
name|lock_prefix
init|=
literal|0
decl_stmt|;
name|uint_t
name|rep_prefix
init|=
literal|0
decl_stmt|;
name|uint_t
name|rex_prefix
init|=
literal|0
decl_stmt|;
comment|/* amd64 register extension prefix */
comment|/* 	 * Intel VEX instruction encoding prefix and fields 	 */
comment|/* 0xC4 means 3 bytes prefix, 0xC5 means 2 bytes prefix */
name|uint_t
name|vex_prefix
init|=
literal|0
decl_stmt|;
comment|/* 	 * VEX prefix byte 1, includes vex.r, vex.x and vex.b 	 * (for 3 bytes prefix) 	 */
name|uint_t
name|vex_byte1
init|=
literal|0
decl_stmt|;
comment|/* 	 * For 32-bit mode, it should prefetch the next byte to 	 * distinguish between AVX and les/lds 	 */
name|uint_t
name|vex_prefetch
init|=
literal|0
decl_stmt|;
name|uint_t
name|vex_m
init|=
literal|0
decl_stmt|;
name|uint_t
name|vex_v
init|=
literal|0
decl_stmt|;
name|uint_t
name|vex_p
init|=
literal|0
decl_stmt|;
name|uint_t
name|vex_R
init|=
literal|1
decl_stmt|;
name|uint_t
name|vex_X
init|=
literal|1
decl_stmt|;
name|uint_t
name|vex_B
init|=
literal|1
decl_stmt|;
name|uint_t
name|vex_W
init|=
literal|0
decl_stmt|;
name|uint_t
name|vex_L
decl_stmt|;
name|size_t
name|off
decl_stmt|;
name|instable_t
name|dp_mmx
decl_stmt|;
name|x
operator|->
name|d86_len
operator|=
literal|0
expr_stmt|;
name|x
operator|->
name|d86_rmindex
operator|=
operator|-
literal|1
expr_stmt|;
name|x
operator|->
name|d86_error
operator|=
literal|0
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
name|x
operator|->
name|d86_numopnds
operator|=
literal|0
expr_stmt|;
name|x
operator|->
name|d86_seg_prefix
operator|=
name|NULL
expr_stmt|;
name|x
operator|->
name|d86_mnem
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|4
condition|;
operator|++
name|i
control|)
block|{
name|x
operator|->
name|d86_opnd
index|[
name|i
index|]
operator|.
name|d86_opnd
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|x
operator|->
name|d86_opnd
index|[
name|i
index|]
operator|.
name|d86_prefix
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|x
operator|->
name|d86_opnd
index|[
name|i
index|]
operator|.
name|d86_value_size
operator|=
literal|0
expr_stmt|;
name|x
operator|->
name|d86_opnd
index|[
name|i
index|]
operator|.
name|d86_value
operator|=
literal|0
expr_stmt|;
name|x
operator|->
name|d86_opnd
index|[
name|i
index|]
operator|.
name|d86_mode
operator|=
name|MODE_NONE
expr_stmt|;
block|}
endif|#
directive|endif
name|x
operator|->
name|d86_rex_prefix
operator|=
literal|0
expr_stmt|;
name|x
operator|->
name|d86_got_modrm
operator|=
literal|0
expr_stmt|;
name|x
operator|->
name|d86_memsize
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|cpu_mode
operator|==
name|SIZE16
condition|)
block|{
name|opnd_size
operator|=
name|SIZE16
expr_stmt|;
name|addr_size
operator|=
name|SIZE16
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|cpu_mode
operator|==
name|SIZE32
condition|)
block|{
name|opnd_size
operator|=
name|SIZE32
expr_stmt|;
name|addr_size
operator|=
name|SIZE32
expr_stmt|;
block|}
else|else
block|{
name|opnd_size
operator|=
name|SIZE32
expr_stmt|;
name|addr_size
operator|=
name|SIZE64
expr_stmt|;
block|}
comment|/* 	 * Get one opcode byte and check for zero padding that follows 	 * jump tables. 	 */
if|if
condition|(
name|dtrace_get_opcode
argument_list|(
name|x
argument_list|,
operator|&
name|opcode1
argument_list|,
operator|&
name|opcode2
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|error
goto|;
if|if
condition|(
name|opcode1
operator|==
literal|0
operator|&&
name|opcode2
operator|==
literal|0
operator|&&
name|x
operator|->
name|d86_check_func
operator|!=
name|NULL
operator|&&
name|x
operator|->
name|d86_check_func
argument_list|(
name|x
operator|->
name|d86_data
argument_list|)
condition|)
block|{
ifdef|#
directive|ifdef
name|DIS_TEXT
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|".byte\t0"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
goto|goto
name|done
goto|;
block|}
comment|/* 	 * Gather up legacy x86 prefix bytes. 	 */
for|for
control|(
init|;
condition|;
control|)
block|{
name|uint_t
modifier|*
name|which_prefix
init|=
name|NULL
decl_stmt|;
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_distable
index|[
name|opcode1
index|]
index|[
name|opcode2
index|]
expr_stmt|;
switch|switch
condition|(
name|dp
operator|->
name|it_adrmode
condition|)
block|{
case|case
name|PREFIX
case|:
name|which_prefix
operator|=
operator|&
name|rep_prefix
expr_stmt|;
break|break;
case|case
name|LOCK
case|:
name|which_prefix
operator|=
operator|&
name|lock_prefix
expr_stmt|;
break|break;
case|case
name|OVERRIDE
case|:
name|which_prefix
operator|=
operator|&
name|segment_prefix
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
name|x
operator|->
name|d86_seg_prefix
operator|=
operator|(
name|char
operator|*
operator|)
name|dp
operator|->
name|it_name
expr_stmt|;
endif|#
directive|endif
if|if
condition|(
name|dp
operator|->
name|it_invalid64
operator|&&
name|cpu_mode
operator|==
name|SIZE64
condition|)
goto|goto
name|error
goto|;
break|break;
case|case
name|AM
case|:
name|which_prefix
operator|=
operator|&
name|addr_size_prefix
expr_stmt|;
break|break;
case|case
name|DM
case|:
name|which_prefix
operator|=
operator|&
name|opnd_size_prefix
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|which_prefix
operator|==
name|NULL
condition|)
break|break;
operator|*
name|which_prefix
operator|=
operator|(
name|opcode1
operator|<<
literal|4
operator|)
operator||
name|opcode2
expr_stmt|;
if|if
condition|(
name|dtrace_get_opcode
argument_list|(
name|x
argument_list|,
operator|&
name|opcode1
argument_list|,
operator|&
name|opcode2
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|error
goto|;
block|}
comment|/* 	 * Handle amd64 mode PREFIX values. 	 * Some of the segment prefixes are no-ops. (only FS/GS actually work) 	 * We might have a REX prefix (opcodes 0x40-0x4f) 	 */
if|if
condition|(
name|cpu_mode
operator|==
name|SIZE64
condition|)
block|{
if|if
condition|(
name|segment_prefix
operator|!=
literal|0x64
operator|&&
name|segment_prefix
operator|!=
literal|0x65
condition|)
name|segment_prefix
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|opcode1
operator|==
literal|0x4
condition|)
block|{
name|rex_prefix
operator|=
operator|(
name|opcode1
operator|<<
literal|4
operator|)
operator||
name|opcode2
expr_stmt|;
if|if
condition|(
name|dtrace_get_opcode
argument_list|(
name|x
argument_list|,
operator|&
name|opcode1
argument_list|,
operator|&
name|opcode2
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|error
goto|;
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_distable
index|[
name|opcode1
index|]
index|[
name|opcode2
index|]
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|opcode1
operator|==
literal|0xC
operator|&&
operator|(
name|opcode2
operator|==
literal|0x4
operator|||
name|opcode2
operator|==
literal|0x5
operator|)
condition|)
block|{
comment|/* AVX instructions */
name|vex_prefix
operator|=
operator|(
name|opcode1
operator|<<
literal|4
operator|)
operator||
name|opcode2
expr_stmt|;
name|x
operator|->
name|d86_rex_prefix
operator|=
literal|0x40
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|opcode1
operator|==
literal|0xC
operator|&&
operator|(
name|opcode2
operator|==
literal|0x4
operator|||
name|opcode2
operator|==
literal|0x5
operator|)
condition|)
block|{
comment|/* LDS, LES or AVX */
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|vex_prefetch
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|mode
operator|==
name|REG_ONLY
condition|)
block|{
comment|/* AVX */
name|vex_prefix
operator|=
operator|(
name|opcode1
operator|<<
literal|4
operator|)
operator||
name|opcode2
expr_stmt|;
name|x
operator|->
name|d86_rex_prefix
operator|=
literal|0x40
expr_stmt|;
name|opcode3
operator|=
operator|(
operator|(
operator|(
name|mode
operator|<<
literal|3
operator|)
operator||
name|reg
operator|)
operator|>>
literal|1
operator|)
operator|&
literal|0x0F
expr_stmt|;
name|opcode4
operator|=
operator|(
operator|(
name|reg
operator|<<
literal|3
operator|)
operator||
name|r_m
operator|)
operator|&
literal|0x0F
expr_stmt|;
block|}
block|}
if|if
condition|(
name|vex_prefix
operator|==
name|VEX_2bytes
condition|)
block|{
if|if
condition|(
operator|!
name|vex_prefetch
condition|)
block|{
if|if
condition|(
name|dtrace_get_opcode
argument_list|(
name|x
argument_list|,
operator|&
name|opcode3
argument_list|,
operator|&
name|opcode4
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|error
goto|;
block|}
name|vex_R
operator|=
operator|(
operator|(
name|opcode3
operator|&
name|VEX_R
operator|)
operator|&
literal|0x0F
operator|)
operator|>>
literal|3
expr_stmt|;
name|vex_L
operator|=
operator|(
operator|(
name|opcode4
operator|&
name|VEX_L
operator|)
operator|&
literal|0x0F
operator|)
operator|>>
literal|2
expr_stmt|;
name|vex_v
operator|=
operator|(
operator|(
operator|(
name|opcode3
operator|<<
literal|4
operator|)
operator||
name|opcode4
operator|)
operator|&
name|VEX_v
operator|)
operator|>>
literal|3
expr_stmt|;
name|vex_p
operator|=
name|opcode4
operator|&
name|VEX_p
expr_stmt|;
comment|/* 		 * The vex.x and vex.b bits are not defined in two bytes 		 * mode vex prefix, their default values are 1 		 */
name|vex_byte1
operator|=
operator|(
name|opcode3
operator|&
name|VEX_R
operator|)
operator||
name|VEX_X
operator||
name|VEX_B
expr_stmt|;
if|if
condition|(
name|vex_R
operator|==
literal|0
condition|)
name|x
operator|->
name|d86_rex_prefix
operator||=
name|REX_R
expr_stmt|;
if|if
condition|(
name|dtrace_get_opcode
argument_list|(
name|x
argument_list|,
operator|&
name|opcode1
argument_list|,
operator|&
name|opcode2
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|error
goto|;
switch|switch
condition|(
name|vex_p
condition|)
block|{
case|case
name|VEX_p_66
case|:
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opAVX660F
index|[
operator|(
name|opcode1
operator|<<
literal|4
operator|)
operator||
name|opcode2
index|]
expr_stmt|;
break|break;
case|case
name|VEX_p_F3
case|:
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opAVXF30F
index|[
operator|(
name|opcode1
operator|<<
literal|4
operator|)
operator||
name|opcode2
index|]
expr_stmt|;
break|break;
case|case
name|VEX_p_F2
case|:
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opAVXF20F
index|[
operator|(
name|opcode1
operator|<<
literal|4
operator|)
operator||
name|opcode2
index|]
expr_stmt|;
break|break;
default|default:
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opAVX0F
index|[
name|opcode1
index|]
index|[
name|opcode2
index|]
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|vex_prefix
operator|==
name|VEX_3bytes
condition|)
block|{
if|if
condition|(
operator|!
name|vex_prefetch
condition|)
block|{
if|if
condition|(
name|dtrace_get_opcode
argument_list|(
name|x
argument_list|,
operator|&
name|opcode3
argument_list|,
operator|&
name|opcode4
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|error
goto|;
block|}
name|vex_R
operator|=
operator|(
name|opcode3
operator|&
name|VEX_R
operator|)
operator|>>
literal|3
expr_stmt|;
name|vex_X
operator|=
operator|(
name|opcode3
operator|&
name|VEX_X
operator|)
operator|>>
literal|2
expr_stmt|;
name|vex_B
operator|=
operator|(
name|opcode3
operator|&
name|VEX_B
operator|)
operator|>>
literal|1
expr_stmt|;
name|vex_m
operator|=
operator|(
operator|(
operator|(
name|opcode3
operator|<<
literal|4
operator|)
operator||
name|opcode4
operator|)
operator|&
name|VEX_m
operator|)
expr_stmt|;
name|vex_byte1
operator|=
name|opcode3
operator|&
operator|(
name|VEX_R
operator||
name|VEX_X
operator||
name|VEX_B
operator|)
expr_stmt|;
if|if
condition|(
name|vex_R
operator|==
literal|0
condition|)
name|x
operator|->
name|d86_rex_prefix
operator||=
name|REX_R
expr_stmt|;
if|if
condition|(
name|vex_X
operator|==
literal|0
condition|)
name|x
operator|->
name|d86_rex_prefix
operator||=
name|REX_X
expr_stmt|;
if|if
condition|(
name|vex_B
operator|==
literal|0
condition|)
name|x
operator|->
name|d86_rex_prefix
operator||=
name|REX_B
expr_stmt|;
if|if
condition|(
name|dtrace_get_opcode
argument_list|(
name|x
argument_list|,
operator|&
name|opcode5
argument_list|,
operator|&
name|opcode6
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|error
goto|;
name|vex_W
operator|=
operator|(
name|opcode5
operator|&
name|VEX_W
operator|)
operator|>>
literal|3
expr_stmt|;
name|vex_L
operator|=
operator|(
name|opcode6
operator|&
name|VEX_L
operator|)
operator|>>
literal|2
expr_stmt|;
name|vex_v
operator|=
operator|(
operator|(
operator|(
name|opcode5
operator|<<
literal|4
operator|)
operator||
name|opcode6
operator|)
operator|&
name|VEX_v
operator|)
operator|>>
literal|3
expr_stmt|;
name|vex_p
operator|=
name|opcode6
operator|&
name|VEX_p
expr_stmt|;
if|if
condition|(
name|vex_W
condition|)
name|x
operator|->
name|d86_rex_prefix
operator||=
name|REX_W
expr_stmt|;
comment|/* Only these three vex_m values valid; others are reserved */
if|if
condition|(
operator|(
name|vex_m
operator|!=
name|VEX_m_0F
operator|)
operator|&&
operator|(
name|vex_m
operator|!=
name|VEX_m_0F38
operator|)
operator|&&
operator|(
name|vex_m
operator|!=
name|VEX_m_0F3A
operator|)
condition|)
goto|goto
name|error
goto|;
if|if
condition|(
name|dtrace_get_opcode
argument_list|(
name|x
argument_list|,
operator|&
name|opcode1
argument_list|,
operator|&
name|opcode2
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|error
goto|;
switch|switch
condition|(
name|vex_p
condition|)
block|{
case|case
name|VEX_p_66
case|:
if|if
condition|(
name|vex_m
operator|==
name|VEX_m_0F
condition|)
block|{
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opAVX660F
index|[
operator|(
name|opcode1
operator|<<
literal|4
operator|)
operator||
name|opcode2
index|]
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|vex_m
operator|==
name|VEX_m_0F38
condition|)
block|{
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opAVX660F38
index|[
operator|(
name|opcode1
operator|<<
literal|4
operator|)
operator||
name|opcode2
index|]
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|vex_m
operator|==
name|VEX_m_0F3A
condition|)
block|{
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opAVX660F3A
index|[
operator|(
name|opcode1
operator|<<
literal|4
operator|)
operator||
name|opcode2
index|]
expr_stmt|;
block|}
else|else
block|{
goto|goto
name|error
goto|;
block|}
break|break;
case|case
name|VEX_p_F3
case|:
if|if
condition|(
name|vex_m
operator|==
name|VEX_m_0F
condition|)
block|{
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opAVXF30F
index|[
operator|(
name|opcode1
operator|<<
literal|4
operator|)
operator||
name|opcode2
index|]
expr_stmt|;
block|}
else|else
block|{
goto|goto
name|error
goto|;
block|}
break|break;
case|case
name|VEX_p_F2
case|:
if|if
condition|(
name|vex_m
operator|==
name|VEX_m_0F
condition|)
block|{
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opAVXF20F
index|[
operator|(
name|opcode1
operator|<<
literal|4
operator|)
operator||
name|opcode2
index|]
expr_stmt|;
block|}
else|else
block|{
goto|goto
name|error
goto|;
block|}
break|break;
default|default:
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opAVX0F
index|[
name|opcode1
index|]
index|[
name|opcode2
index|]
expr_stmt|;
block|}
block|}
if|if
condition|(
name|vex_prefix
condition|)
block|{
if|if
condition|(
name|vex_L
condition|)
name|wbit
operator|=
name|YMM_OPND
expr_stmt|;
else|else
name|wbit
operator|=
name|XMM_OPND
expr_stmt|;
block|}
comment|/* 	 * Deal with selection of operand and address size now. 	 * Note that the REX.W bit being set causes opnd_size_prefix to be 	 * ignored. 	 */
if|if
condition|(
name|cpu_mode
operator|==
name|SIZE64
condition|)
block|{
if|if
condition|(
operator|(
name|rex_prefix
operator|&
name|REX_W
operator|)
operator|||
name|vex_W
condition|)
name|opnd_size
operator|=
name|SIZE64
expr_stmt|;
elseif|else
if|if
condition|(
name|opnd_size_prefix
condition|)
name|opnd_size
operator|=
name|SIZE16
expr_stmt|;
if|if
condition|(
name|addr_size_prefix
condition|)
name|addr_size
operator|=
name|SIZE32
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|cpu_mode
operator|==
name|SIZE32
condition|)
block|{
if|if
condition|(
name|opnd_size_prefix
condition|)
name|opnd_size
operator|=
name|SIZE16
expr_stmt|;
if|if
condition|(
name|addr_size_prefix
condition|)
name|addr_size
operator|=
name|SIZE16
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|opnd_size_prefix
condition|)
name|opnd_size
operator|=
name|SIZE32
expr_stmt|;
if|if
condition|(
name|addr_size_prefix
condition|)
name|addr_size
operator|=
name|SIZE32
expr_stmt|;
block|}
comment|/* 	 * The pause instruction - a repz'd nop.  This doesn't fit 	 * with any of the other prefix goop added for SSE, so we'll 	 * special-case it here. 	 */
if|if
condition|(
name|rep_prefix
operator|==
literal|0xf3
operator|&&
name|opcode1
operator|==
literal|0x9
operator|&&
name|opcode2
operator|==
literal|0x0
condition|)
block|{
name|rep_prefix
operator|=
literal|0
expr_stmt|;
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opPause
expr_stmt|;
block|}
comment|/* 	 * Some 386 instructions have 2 bytes of opcode before the mod_r/m 	 * byte so we may need to perform a table indirection. 	 */
if|if
condition|(
name|dp
operator|->
name|it_indirect
operator|==
operator|(
name|instable_t
operator|*
operator|)
name|dis_op0F
condition|)
block|{
if|if
condition|(
name|dtrace_get_opcode
argument_list|(
name|x
argument_list|,
operator|&
name|opcode4
argument_list|,
operator|&
name|opcode5
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|error
goto|;
name|opcode_bytes
operator|=
literal|2
expr_stmt|;
if|if
condition|(
name|opcode4
operator|==
literal|0x7
operator|&&
name|opcode5
operator|>=
literal|0x1
operator|&&
name|opcode5
operator|<=
literal|0x3
condition|)
block|{
name|uint_t
name|subcode
decl_stmt|;
if|if
condition|(
name|dtrace_get_opcode
argument_list|(
name|x
argument_list|,
operator|&
name|opcode6
argument_list|,
operator|&
name|opcode7
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|error
goto|;
name|opcode_bytes
operator|=
literal|3
expr_stmt|;
name|subcode
operator|=
operator|(
operator|(
name|opcode6
operator|&
literal|0x3
operator|)
operator|<<
literal|1
operator|)
operator||
operator|(
operator|(
name|opcode7
operator|&
literal|0x8
operator|)
operator|>>
literal|3
operator|)
expr_stmt|;
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_op0F7123
index|[
name|opcode5
index|]
index|[
name|subcode
index|]
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|(
name|opcode4
operator|==
literal|0xc
operator|)
operator|&&
operator|(
name|opcode5
operator|>=
literal|0x8
operator|)
condition|)
block|{
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_op0FC8
index|[
literal|0
index|]
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|(
name|opcode4
operator|==
literal|0x3
operator|)
operator|&&
operator|(
name|opcode5
operator|==
literal|0xA
operator|)
condition|)
block|{
name|opcode_bytes
operator|=
literal|3
expr_stmt|;
if|if
condition|(
name|dtrace_get_opcode
argument_list|(
name|x
argument_list|,
operator|&
name|opcode6
argument_list|,
operator|&
name|opcode7
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|error
goto|;
if|if
condition|(
name|opnd_size
operator|==
name|SIZE16
condition|)
name|opnd_size
operator|=
name|SIZE32
expr_stmt|;
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_op0F3A
index|[
operator|(
name|opcode6
operator|<<
literal|4
operator|)
operator||
name|opcode7
index|]
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
name|strcmp
argument_list|(
name|dp
operator|->
name|it_name
argument_list|,
literal|"INVALID"
argument_list|)
operator|==
literal|0
condition|)
goto|goto
name|error
goto|;
endif|#
directive|endif
switch|switch
condition|(
name|dp
operator|->
name|it_adrmode
condition|)
block|{
case|case
name|XMMP_66r
case|:
case|case
name|XMMPRM_66r
case|:
case|case
name|XMM3PM_66r
case|:
if|if
condition|(
name|opnd_size_prefix
operator|==
literal|0
condition|)
block|{
goto|goto
name|error
goto|;
block|}
break|break;
case|case
name|XMMP_66o
case|:
if|if
condition|(
name|opnd_size_prefix
operator|==
literal|0
condition|)
block|{
comment|/* SSSE3 MMX instructions */
name|dp_mmx
operator|=
operator|*
name|dp
expr_stmt|;
name|dp
operator|=
operator|&
name|dp_mmx
expr_stmt|;
name|dp
operator|->
name|it_adrmode
operator|=
name|MMOPM_66o
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_MEM
name|dp
operator|->
name|it_size
operator|=
literal|8
expr_stmt|;
endif|#
directive|endif
block|}
break|break;
default|default:
goto|goto
name|error
goto|;
block|}
block|}
elseif|else
if|if
condition|(
operator|(
name|opcode4
operator|==
literal|0x3
operator|)
operator|&&
operator|(
name|opcode5
operator|==
literal|0x8
operator|)
condition|)
block|{
name|opcode_bytes
operator|=
literal|3
expr_stmt|;
if|if
condition|(
name|dtrace_get_opcode
argument_list|(
name|x
argument_list|,
operator|&
name|opcode6
argument_list|,
operator|&
name|opcode7
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|error
goto|;
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_op0F38
index|[
operator|(
name|opcode6
operator|<<
literal|4
operator|)
operator||
name|opcode7
index|]
expr_stmt|;
comment|/* 			 * Both crc32 and movbe have the same 3rd opcode 			 * byte of either 0xF0 or 0xF1, so we use another 			 * indirection to distinguish between the two. 			 */
if|if
condition|(
name|dp
operator|->
name|it_indirect
operator|==
operator|(
name|instable_t
operator|*
operator|)
name|dis_op0F38F0
operator|||
name|dp
operator|->
name|it_indirect
operator|==
operator|(
name|instable_t
operator|*
operator|)
name|dis_op0F38F1
condition|)
block|{
name|dp
operator|=
name|dp
operator|->
name|it_indirect
expr_stmt|;
if|if
condition|(
name|rep_prefix
operator|!=
literal|0xF2
condition|)
block|{
comment|/* It is movbe */
name|dp
operator|++
expr_stmt|;
block|}
block|}
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
name|strcmp
argument_list|(
name|dp
operator|->
name|it_name
argument_list|,
literal|"INVALID"
argument_list|)
operator|==
literal|0
condition|)
goto|goto
name|error
goto|;
endif|#
directive|endif
switch|switch
condition|(
name|dp
operator|->
name|it_adrmode
condition|)
block|{
case|case
name|RM_66r
case|:
case|case
name|XMM_66r
case|:
case|case
name|XMMM_66r
case|:
if|if
condition|(
name|opnd_size_prefix
operator|==
literal|0
condition|)
block|{
goto|goto
name|error
goto|;
block|}
break|break;
case|case
name|XMM_66o
case|:
if|if
condition|(
name|opnd_size_prefix
operator|==
literal|0
condition|)
block|{
comment|/* SSSE3 MMX instructions */
name|dp_mmx
operator|=
operator|*
name|dp
expr_stmt|;
name|dp
operator|=
operator|&
name|dp_mmx
expr_stmt|;
name|dp
operator|->
name|it_adrmode
operator|=
name|MM
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_MEM
name|dp
operator|->
name|it_size
operator|=
literal|8
expr_stmt|;
endif|#
directive|endif
block|}
break|break;
case|case
name|CRC32
case|:
if|if
condition|(
name|rep_prefix
operator|!=
literal|0xF2
condition|)
block|{
goto|goto
name|error
goto|;
block|}
name|rep_prefix
operator|=
literal|0
expr_stmt|;
break|break;
case|case
name|MOVBE
case|:
if|if
condition|(
name|rep_prefix
operator|!=
literal|0x0
condition|)
block|{
goto|goto
name|error
goto|;
block|}
break|break;
default|default:
goto|goto
name|error
goto|;
block|}
block|}
else|else
block|{
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_op0F
index|[
name|opcode4
index|]
index|[
name|opcode5
index|]
expr_stmt|;
block|}
block|}
comment|/* 	 * If still not at a TERM decode entry, then a ModRM byte 	 * exists and its fields further decode the instruction. 	 */
name|x
operator|->
name|d86_got_modrm
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|it_indirect
operator|!=
name|TERM
condition|)
block|{
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|opcode3
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
if|if
condition|(
name|x
operator|->
name|d86_error
condition|)
goto|goto
name|error
goto|;
name|reg
operator|=
name|opcode3
expr_stmt|;
comment|/* 		 * decode 287 instructions (D8-DF) from opcodeN 		 */
if|if
condition|(
name|opcode1
operator|==
literal|0xD
operator|&&
name|opcode2
operator|>=
literal|0x8
condition|)
block|{
if|if
condition|(
name|opcode2
operator|==
literal|0xB
operator|&&
name|mode
operator|==
literal|0x3
operator|&&
name|opcode3
operator|==
literal|4
condition|)
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opFP5
index|[
name|r_m
index|]
expr_stmt|;
elseif|else
if|if
condition|(
name|opcode2
operator|==
literal|0xA
operator|&&
name|mode
operator|==
literal|0x3
operator|&&
name|opcode3
operator|<
literal|4
condition|)
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opFP7
index|[
name|opcode3
index|]
expr_stmt|;
elseif|else
if|if
condition|(
name|opcode2
operator|==
literal|0xB
operator|&&
name|mode
operator|==
literal|0x3
condition|)
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opFP6
index|[
name|opcode3
index|]
expr_stmt|;
elseif|else
if|if
condition|(
name|opcode2
operator|==
literal|0x9
operator|&&
name|mode
operator|==
literal|0x3
operator|&&
name|opcode3
operator|>=
literal|4
condition|)
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opFP4
index|[
name|opcode3
operator|-
literal|4
index|]
index|[
name|r_m
index|]
expr_stmt|;
elseif|else
if|if
condition|(
name|mode
operator|==
literal|0x3
condition|)
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opFP3
index|[
name|opcode2
operator|-
literal|8
index|]
index|[
name|opcode3
index|]
expr_stmt|;
else|else
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opFP1n2
index|[
name|opcode2
operator|-
literal|8
index|]
index|[
name|opcode3
index|]
expr_stmt|;
block|}
else|else
block|{
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
name|dp
operator|->
name|it_indirect
operator|+
name|opcode3
expr_stmt|;
block|}
block|}
comment|/* 	 * In amd64 bit mode, ARPL opcode is changed to MOVSXD 	 * (sign extend 32bit to 64 bit) 	 */
if|if
condition|(
operator|(
name|vex_prefix
operator|==
literal|0
operator|)
operator|&&
name|cpu_mode
operator|==
name|SIZE64
operator|&&
name|opcode1
operator|==
literal|0x6
operator|&&
name|opcode2
operator|==
literal|0x3
condition|)
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opMOVSLD
expr_stmt|;
comment|/* 	 * at this point we should have a correct (or invalid) opcode 	 */
if|if
condition|(
name|cpu_mode
operator|==
name|SIZE64
operator|&&
name|dp
operator|->
name|it_invalid64
operator|||
name|cpu_mode
operator|!=
name|SIZE64
operator|&&
name|dp
operator|->
name|it_invalid32
condition|)
goto|goto
name|error
goto|;
if|if
condition|(
name|dp
operator|->
name|it_indirect
operator|!=
name|TERM
condition|)
goto|goto
name|error
goto|;
comment|/* 	 * deal with MMX/SSE opcodes which are changed by prefixes 	 */
switch|switch
condition|(
name|dp
operator|->
name|it_adrmode
condition|)
block|{
case|case
name|MMO
case|:
case|case
name|MMOIMPL
case|:
case|case
name|MMO3P
case|:
case|case
name|MMOM3
case|:
case|case
name|MMOMS
case|:
case|case
name|MMOPM
case|:
case|case
name|MMOPRM
case|:
case|case
name|MMOS
case|:
case|case
name|XMMO
case|:
case|case
name|XMMOM
case|:
case|case
name|XMMOMS
case|:
case|case
name|XMMOPM
case|:
case|case
name|XMMOS
case|:
case|case
name|XMMOMX
case|:
case|case
name|XMMOX3
case|:
case|case
name|XMMOXMM
case|:
comment|/* 		 * This is horrible.  Some SIMD instructions take the 		 * form 0x0F 0x?? ..., which is easily decoded using the 		 * existing tables.  Other SIMD instructions use various 		 * prefix bytes to overload existing instructions.  For 		 * Example, addps is F0, 58, whereas addss is F3 (repz), 		 * F0, 58.  Presumably someone got a raise for this. 		 * 		 * If we see one of the instructions which can be 		 * modified in this way (if we've got one of the SIMDO* 		 * address modes), we'll check to see if the last prefix 		 * was a repz.  If it was, we strip the prefix from the 		 * mnemonic, and we indirect using the dis_opSIMDrepz 		 * table. 		 */
comment|/* 		 * Calculate our offset in dis_op0F 		 */
if|if
condition|(
operator|(
name|uintptr_t
operator|)
name|dp
operator|-
operator|(
name|uintptr_t
operator|)
name|dis_op0F
operator|>
sizeof|sizeof
argument_list|(
name|dis_op0F
argument_list|)
condition|)
goto|goto
name|error
goto|;
name|off
operator|=
operator|(
operator|(
name|uintptr_t
operator|)
name|dp
operator|-
operator|(
name|uintptr_t
operator|)
name|dis_op0F
operator|)
operator|/
sizeof|sizeof
argument_list|(
name|instable_t
argument_list|)
expr_stmt|;
comment|/* 		 * Rewrite if this instruction used one of the magic prefixes. 		 */
if|if
condition|(
name|rep_prefix
condition|)
block|{
if|if
condition|(
name|rep_prefix
operator|==
literal|0xf2
condition|)
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opSIMDrepnz
index|[
name|off
index|]
expr_stmt|;
else|else
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opSIMDrepz
index|[
name|off
index|]
expr_stmt|;
name|rep_prefix
operator|=
literal|0
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|opnd_size_prefix
condition|)
block|{
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opSIMDdata16
index|[
name|off
index|]
expr_stmt|;
name|opnd_size_prefix
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|opnd_size
operator|==
name|SIZE16
condition|)
name|opnd_size
operator|=
name|SIZE32
expr_stmt|;
block|}
break|break;
case|case
name|MG9
case|:
comment|/* 		 * More horribleness: the group 9 (0xF0 0xC7) instructions are 		 * allowed an optional prefix of 0x66 or 0xF3.  This is similar 		 * to the SIMD business described above, but with a different 		 * addressing mode (and an indirect table), so we deal with it 		 * separately (if similarly). 		 * 		 * Intel further complicated this with the release of Ivy Bridge 		 * where they overloaded these instructions based on the ModR/M 		 * bytes. The VMX instructions have a mode of 0 since they are 		 * memory instructions but rdrand instructions have a mode of 		 * 0b11 (REG_ONLY) because they only operate on registers. While 		 * there are different prefix formats, for now it is sufficient 		 * to use a single different table. 		 */
comment|/* 		 * Calculate our offset in dis_op0FC7 (the group 9 table) 		 */
if|if
condition|(
operator|(
name|uintptr_t
operator|)
name|dp
operator|-
operator|(
name|uintptr_t
operator|)
name|dis_op0FC7
operator|>
sizeof|sizeof
argument_list|(
name|dis_op0FC7
argument_list|)
condition|)
goto|goto
name|error
goto|;
name|off
operator|=
operator|(
operator|(
name|uintptr_t
operator|)
name|dp
operator|-
operator|(
name|uintptr_t
operator|)
name|dis_op0FC7
operator|)
operator|/
sizeof|sizeof
argument_list|(
name|instable_t
argument_list|)
expr_stmt|;
comment|/* 		 * If we have a mode of 0b11 then we have to rewrite this. 		 */
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
if|if
condition|(
name|mode
operator|==
name|REG_ONLY
condition|)
block|{
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_op0FC7m3
index|[
name|off
index|]
expr_stmt|;
break|break;
block|}
comment|/* 		 * Rewrite if this instruction used one of the magic prefixes. 		 */
if|if
condition|(
name|rep_prefix
condition|)
block|{
if|if
condition|(
name|rep_prefix
operator|==
literal|0xf3
condition|)
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opF30FC7
index|[
name|off
index|]
expr_stmt|;
else|else
goto|goto
name|error
goto|;
name|rep_prefix
operator|=
literal|0
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|opnd_size_prefix
condition|)
block|{
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_op660FC7
index|[
name|off
index|]
expr_stmt|;
name|opnd_size_prefix
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|opnd_size
operator|==
name|SIZE16
condition|)
name|opnd_size
operator|=
name|SIZE32
expr_stmt|;
block|}
break|break;
case|case
name|MMOSH
case|:
comment|/* 		 * As with the "normal" SIMD instructions, the MMX 		 * shuffle instructions are overloaded.  These 		 * instructions, however, are special in that they use 		 * an extra byte, and thus an extra table.  As of this 		 * writing, they only use the opnd_size prefix. 		 */
comment|/* 		 * Calculate our offset in dis_op0F7123 		 */
if|if
condition|(
operator|(
name|uintptr_t
operator|)
name|dp
operator|-
operator|(
name|uintptr_t
operator|)
name|dis_op0F7123
operator|>
sizeof|sizeof
argument_list|(
name|dis_op0F7123
argument_list|)
condition|)
goto|goto
name|error
goto|;
if|if
condition|(
name|opnd_size_prefix
condition|)
block|{
name|off
operator|=
operator|(
operator|(
name|uintptr_t
operator|)
name|dp
operator|-
operator|(
name|uintptr_t
operator|)
name|dis_op0F7123
operator|)
operator|/
sizeof|sizeof
argument_list|(
name|instable_t
argument_list|)
expr_stmt|;
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opSIMD7123
index|[
name|off
index|]
expr_stmt|;
name|opnd_size_prefix
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|opnd_size
operator|==
name|SIZE16
condition|)
name|opnd_size
operator|=
name|SIZE32
expr_stmt|;
block|}
break|break;
case|case
name|MRw
case|:
if|if
condition|(
name|rep_prefix
condition|)
block|{
if|if
condition|(
name|rep_prefix
operator|==
literal|0xf3
condition|)
block|{
comment|/* 				 * Calculate our offset in dis_op0F 				 */
if|if
condition|(
operator|(
name|uintptr_t
operator|)
name|dp
operator|-
operator|(
name|uintptr_t
operator|)
name|dis_op0F
operator|>
sizeof|sizeof
argument_list|(
name|dis_op0F
argument_list|)
condition|)
goto|goto
name|error
goto|;
name|off
operator|=
operator|(
operator|(
name|uintptr_t
operator|)
name|dp
operator|-
operator|(
name|uintptr_t
operator|)
name|dis_op0F
operator|)
operator|/
sizeof|sizeof
argument_list|(
name|instable_t
argument_list|)
expr_stmt|;
name|dp
operator|=
operator|(
name|instable_t
operator|*
operator|)
operator|&
name|dis_opSIMDrepz
index|[
name|off
index|]
expr_stmt|;
name|rep_prefix
operator|=
literal|0
expr_stmt|;
block|}
else|else
block|{
goto|goto
name|error
goto|;
block|}
block|}
break|break;
block|}
comment|/* 	 * In 64 bit mode, some opcodes automatically use opnd_size == SIZE64. 	 */
if|if
condition|(
name|cpu_mode
operator|==
name|SIZE64
condition|)
if|if
condition|(
name|dp
operator|->
name|it_always64
operator|||
operator|(
name|opnd_size
operator|==
name|SIZE32
operator|&&
name|dp
operator|->
name|it_stackop
operator|)
condition|)
name|opnd_size
operator|=
name|SIZE64
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
comment|/* 	 * At this point most instructions can format the opcode mnemonic 	 * including the prefixes. 	 */
if|if
condition|(
name|lock_prefix
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"lock "
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
if|if
condition|(
name|rep_prefix
operator|==
literal|0xf2
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"repnz "
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|rep_prefix
operator|==
literal|0xf3
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"repz "
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
if|if
condition|(
name|cpu_mode
operator|==
name|SIZE64
operator|&&
name|addr_size_prefix
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"addr32 "
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|it_adrmode
operator|!=
name|CBW
operator|&&
name|dp
operator|->
name|it_adrmode
operator|!=
name|CWD
operator|&&
name|dp
operator|->
name|it_adrmode
operator|!=
name|XMMSFNC
condition|)
block|{
if|if
condition|(
name|strcmp
argument_list|(
name|dp
operator|->
name|it_name
argument_list|,
literal|"INVALID"
argument_list|)
operator|==
literal|0
condition|)
goto|goto
name|error
goto|;
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
name|dp
operator|->
name|it_name
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|it_suffix
condition|)
block|{
name|char
modifier|*
name|types
index|[]
init|=
block|{
literal|""
block|,
literal|"w"
block|,
literal|"l"
block|,
literal|"q"
block|}
decl_stmt|;
if|if
condition|(
name|opcode_bytes
operator|==
literal|2
operator|&&
name|opcode4
operator|==
literal|4
condition|)
block|{
comment|/* It's a cmovx.yy. Replace the suffix x */
for|for
control|(
name|i
operator|=
literal|5
init|;
name|i
operator|<
name|OPLEN
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|x
operator|->
name|d86_mnem
index|[
name|i
index|]
operator|==
literal|'.'
condition|)
break|break;
block|}
name|x
operator|->
name|d86_mnem
index|[
name|i
operator|-
literal|1
index|]
operator|=
operator|*
name|types
index|[
name|opnd_size
index|]
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|(
name|opnd_size
operator|==
literal|2
operator|)
operator|&&
operator|(
name|opcode_bytes
operator|==
literal|3
operator|)
operator|&&
operator|(
operator|(
name|opcode6
operator|==
literal|1
operator|&&
name|opcode7
operator|==
literal|6
operator|)
operator|||
operator|(
name|opcode6
operator|==
literal|2
operator|&&
name|opcode7
operator|==
literal|2
operator|)
operator|)
condition|)
block|{
comment|/* 				 * To handle PINSRD and PEXTRD 				 */
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"d"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
block|}
else|else
block|{
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
name|types
index|[
name|opnd_size
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
block|}
block|}
block|}
endif|#
directive|endif
comment|/* 	 * Process operands based on the addressing modes. 	 */
name|x
operator|->
name|d86_mode
operator|=
name|cpu_mode
expr_stmt|;
comment|/* 	 * In vex mode the rex_prefix has no meaning 	 */
if|if
condition|(
operator|!
name|vex_prefix
condition|)
name|x
operator|->
name|d86_rex_prefix
operator|=
name|rex_prefix
expr_stmt|;
name|x
operator|->
name|d86_opnd_size
operator|=
name|opnd_size
expr_stmt|;
name|x
operator|->
name|d86_addr_size
operator|=
name|addr_size
expr_stmt|;
name|vbit
operator|=
literal|0
expr_stmt|;
comment|/* initialize for mem/reg -> reg */
switch|switch
condition|(
name|dp
operator|->
name|it_adrmode
condition|)
block|{
comment|/* 		 * amd64 instruction to sign extend 32 bit reg/mem operands 		 * into 64 bit register values 		 */
case|case
name|MOVSXZ
case|:
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
name|rex_prefix
operator|==
literal|0
condition|)
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"movzld"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|x
operator|->
name|d86_opnd_size
operator|=
name|SIZE64
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|LONG_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|x
operator|->
name|d86_opnd_size
operator|=
name|opnd_size
operator|=
name|SIZE32
expr_stmt|;
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* 		 * movsbl movsbw movsbq (0x0FBE) or movswl movswq (0x0FBF) 		 * movzbl movzbw movzbq (0x0FB6) or movzwl movzwq (0x0FB7) 		 * wbit lives in 2nd byte, note that operands 		 * are different sized 		 */
case|case
name|MOVZ
case|:
if|if
condition|(
name|rex_prefix
operator|&
name|REX_W
condition|)
block|{
comment|/* target register size = 64 bit */
name|x
operator|->
name|d86_mnem
index|[
literal|5
index|]
operator|=
literal|'q'
expr_stmt|;
block|}
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|LONG_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|x
operator|->
name|d86_opnd_size
operator|=
name|opnd_size
operator|=
name|SIZE16
expr_stmt|;
name|wbit
operator|=
name|WBIT
argument_list|(
name|opcode5
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|CRC32
case|:
name|opnd_size
operator|=
name|SIZE32
expr_stmt|;
if|if
condition|(
name|rex_prefix
operator|&
name|REX_W
condition|)
name|opnd_size
operator|=
name|SIZE64
expr_stmt|;
name|x
operator|->
name|d86_opnd_size
operator|=
name|opnd_size
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|LONG_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|wbit
operator|=
name|WBIT
argument_list|(
name|opcode7
argument_list|)
expr_stmt|;
if|if
condition|(
name|opnd_size_prefix
condition|)
name|x
operator|->
name|d86_opnd_size
operator|=
name|opnd_size
operator|=
name|SIZE16
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|MOVBE
case|:
name|opnd_size
operator|=
name|SIZE32
expr_stmt|;
if|if
condition|(
name|rex_prefix
operator|&
name|REX_W
condition|)
name|opnd_size
operator|=
name|SIZE64
expr_stmt|;
name|x
operator|->
name|d86_opnd_size
operator|=
name|opnd_size
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|wbit
operator|=
name|WBIT
argument_list|(
name|opcode7
argument_list|)
expr_stmt|;
if|if
condition|(
name|opnd_size_prefix
condition|)
name|x
operator|->
name|d86_opnd_size
operator|=
name|opnd_size
operator|=
name|SIZE16
expr_stmt|;
if|if
condition|(
name|wbit
condition|)
block|{
comment|/* reg -> mem */
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|LONG_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|/* mem -> reg */
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|LONG_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
break|break;
comment|/* 	 * imul instruction, with either 8-bit or longer immediate 	 * opcode 0x6B for byte, sign-extended displacement, 0x69 for word(s) 	 */
case|case
name|IMUL
case|:
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|THREEOPERAND
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
name|LONG_OPND
argument_list|,
name|OPSIZE
argument_list|(
name|opnd_size
argument_list|,
name|opcode2
operator|==
literal|0x9
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
break|break;
comment|/* memory or register operand to register, with 'w' bit	*/
case|case
name|MRw
case|:
name|wbit
operator|=
name|WBIT
argument_list|(
name|opcode2
argument_list|)
expr_stmt|;
name|STANDARD_MODRM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* register to memory or register operand, with 'w' bit	*/
comment|/* arpl happens to fit here also because it is odd */
case|case
name|RMw
case|:
if|if
condition|(
name|opcode_bytes
operator|==
literal|2
condition|)
name|wbit
operator|=
name|WBIT
argument_list|(
name|opcode5
argument_list|)
expr_stmt|;
else|else
name|wbit
operator|=
name|WBIT
argument_list|(
name|opcode2
argument_list|)
expr_stmt|;
name|STANDARD_MODRM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
break|break;
comment|/* xaddb instruction */
case|case
name|XADDB
case|:
name|wbit
operator|=
literal|0
expr_stmt|;
name|STANDARD_MODRM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
break|break;
comment|/* MMX register to memory or register operand		*/
case|case
name|MMS
case|:
case|case
name|MMOS
case|:
ifdef|#
directive|ifdef
name|DIS_TEXT
name|wbit
operator|=
name|strcmp
argument_list|(
name|dp
operator|->
name|it_name
argument_list|,
literal|"movd"
argument_list|)
condition|?
name|MM_OPND
else|:
name|LONG_OPND
expr_stmt|;
else|#
directive|else
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
endif|#
directive|endif
name|MIXED_MM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
name|MM_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
break|break;
comment|/* MMX register to memory */
case|case
name|MMOMS
case|:
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
if|if
condition|(
name|mode
operator|==
name|REG_ONLY
condition|)
goto|goto
name|error
goto|;
name|wbit
operator|=
name|MM_OPND
expr_stmt|;
name|MIXED_MM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
name|MM_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
break|break;
comment|/* Double shift. Has immediate operand specifying the shift. */
case|case
name|DSHIFT
case|:
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|LONG_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* 	 * Double shift. With no immediate operand, specifies using %cl. 	 */
case|case
name|DSHIFTcl
case|:
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|STANDARD_MODRM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
break|break;
comment|/* immediate to memory or register operand */
case|case
name|IMlw
case|:
name|wbit
operator|=
name|WBIT
argument_list|(
name|opcode2
argument_list|)
expr_stmt|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
name|NULL
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|/* 		 * Have long immediate for opcode 0x81, but not 0x80 nor 0x83 		 */
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
name|OPSIZE
argument_list|(
name|opnd_size
argument_list|,
name|opcode2
operator|==
literal|1
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* immediate to memory or register operand with the	*/
comment|/* 'w' bit present					*/
case|case
name|IMw
case|:
name|wbit
operator|=
name|WBIT
argument_list|(
name|opcode2
argument_list|)
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
name|NULL
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
name|OPSIZE
argument_list|(
name|opnd_size
argument_list|,
name|wbit
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* immediate to register with register in low 3 bits	*/
comment|/* of op code						*/
case|case
name|IR
case|:
comment|/* w-bit here (with regs) is bit 3 */
name|wbit
operator|=
name|opcode2
operator|>>
literal|3
operator|&
literal|0x1
expr_stmt|;
name|reg
operator|=
name|REGNO
argument_list|(
name|opcode2
argument_list|)
expr_stmt|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|mode
operator|=
name|REG_ONLY
expr_stmt|;
name|r_m
operator|=
name|reg
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
name|OPSIZE64
argument_list|(
name|opnd_size
argument_list|,
name|wbit
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* MMX immediate shift of register */
case|case
name|MMSH
case|:
case|case
name|MMOSH
case|:
name|wbit
operator|=
name|MM_OPND
expr_stmt|;
goto|goto
name|mm_shift
goto|;
comment|/* in next case */
comment|/* SIMD immediate shift of register */
case|case
name|XMMSH
case|:
name|wbit
operator|=
name|XMM_OPND
expr_stmt|;
name|mm_shift
label|:
name|reg
operator|=
name|REGNO
argument_list|(
name|opcode7
argument_list|)
expr_stmt|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|NOMEM
expr_stmt|;
break|break;
comment|/* accumulator to memory operand */
case|case
name|AO
case|:
name|vbit
operator|=
literal|1
expr_stmt|;
comment|/*FALLTHROUGH*/
comment|/* memory operand to accumulator */
case|case
name|OA
case|:
name|wbit
operator|=
name|WBIT
argument_list|(
name|opcode2
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|EAX_REGNO
argument_list|,
name|wbit
argument_list|,
literal|1
operator|-
name|vbit
argument_list|)
expr_stmt|;
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
name|OPSIZE64
argument_list|(
name|addr_size
argument_list|,
name|LONG_OPND
argument_list|)
argument_list|,
name|vbit
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
name|x
operator|->
name|d86_opnd
index|[
name|vbit
index|]
operator|.
name|d86_mode
operator|=
name|MODE_OFFSET
expr_stmt|;
endif|#
directive|endif
break|break;
comment|/* segment register to memory or register operand */
case|case
name|SM
case|:
name|vbit
operator|=
literal|1
expr_stmt|;
comment|/*FALLTHROUGH*/
comment|/* memory or register operand to segment register */
case|case
name|MS
case|:
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
name|NULL
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|LONG_OPND
argument_list|,
name|vbit
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|SEG_OPND
argument_list|,
literal|1
operator|-
name|vbit
argument_list|)
expr_stmt|;
break|break;
comment|/* 	 * rotate or shift instructions, which may shift by 1 or 	 * consult the cl register, depending on the 'v' bit 	 */
case|case
name|Mv
case|:
name|vbit
operator|=
name|VBIT
argument_list|(
name|opcode2
argument_list|)
expr_stmt|;
name|wbit
operator|=
name|WBIT
argument_list|(
name|opcode2
argument_list|)
expr_stmt|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
name|NULL
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
name|vbit
condition|)
block|{
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_opnd
argument_list|,
literal|"%cl"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_mode
operator|=
name|MODE_SIGNED
expr_stmt|;
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_value_size
operator|=
literal|1
expr_stmt|;
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_value
operator|=
literal|1
expr_stmt|;
block|}
endif|#
directive|endif
break|break;
comment|/* 	 * immediate rotate or shift instructions 	 */
case|case
name|MvI
case|:
name|wbit
operator|=
name|WBIT
argument_list|(
name|opcode2
argument_list|)
expr_stmt|;
name|normal_imm_mem
label|:
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
name|NULL
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* bit test instructions */
case|case
name|MIb
case|:
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
goto|goto
name|normal_imm_mem
goto|;
comment|/* single memory or register operand with 'w' bit present */
case|case
name|Mw
case|:
name|wbit
operator|=
name|WBIT
argument_list|(
name|opcode2
argument_list|)
expr_stmt|;
name|just_mem
label|:
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
name|NULL
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|SWAPGS_RDTSCP
case|:
if|if
condition|(
name|cpu_mode
operator|==
name|SIZE64
operator|&&
name|mode
operator|==
literal|3
operator|&&
name|r_m
operator|==
literal|0
condition|)
block|{
ifdef|#
directive|ifdef
name|DIS_TEXT
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"swapgs"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|NOMEM
expr_stmt|;
break|break;
block|}
elseif|else
if|if
condition|(
name|mode
operator|==
literal|3
operator|&&
name|r_m
operator|==
literal|1
condition|)
block|{
ifdef|#
directive|ifdef
name|DIS_TEXT
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"rdtscp"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|NOMEM
expr_stmt|;
break|break;
block|}
comment|/*FALLTHROUGH*/
comment|/* prefetch instruction - memory operand, but no memory acess */
case|case
name|PREF
case|:
name|NOMEM
expr_stmt|;
comment|/*FALLTHROUGH*/
comment|/* single memory or register operand */
case|case
name|M
case|:
case|case
name|MG9
case|:
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
goto|goto
name|just_mem
goto|;
comment|/* single memory or register byte operand */
case|case
name|Mb
case|:
name|wbit
operator|=
name|BYTE_OPND
expr_stmt|;
goto|goto
name|just_mem
goto|;
case|case
name|VMx
case|:
if|if
condition|(
name|mode
operator|==
literal|3
condition|)
block|{
ifdef|#
directive|ifdef
name|DIS_TEXT
name|char
modifier|*
name|vminstr
decl_stmt|;
switch|switch
condition|(
name|r_m
condition|)
block|{
case|case
literal|1
case|:
name|vminstr
operator|=
literal|"vmcall"
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|vminstr
operator|=
literal|"vmlaunch"
expr_stmt|;
break|break;
case|case
literal|3
case|:
name|vminstr
operator|=
literal|"vmresume"
expr_stmt|;
break|break;
case|case
literal|4
case|:
name|vminstr
operator|=
literal|"vmxoff"
expr_stmt|;
break|break;
default|default:
goto|goto
name|error
goto|;
block|}
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
name|vminstr
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
else|#
directive|else
if|if
condition|(
name|r_m
operator|<
literal|1
operator|||
name|r_m
operator|>
literal|4
condition|)
goto|goto
name|error
goto|;
endif|#
directive|endif
name|NOMEM
expr_stmt|;
break|break;
block|}
comment|/*FALLTHROUGH*/
case|case
name|SVM
case|:
if|if
condition|(
name|mode
operator|==
literal|3
condition|)
block|{
ifdef|#
directive|ifdef
name|DIS_TEXT
name|char
modifier|*
name|vinstr
decl_stmt|;
switch|switch
condition|(
name|r_m
condition|)
block|{
case|case
literal|0
case|:
name|vinstr
operator|=
literal|"vmrun"
expr_stmt|;
break|break;
case|case
literal|1
case|:
name|vinstr
operator|=
literal|"vmmcall"
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|vinstr
operator|=
literal|"vmload"
expr_stmt|;
break|break;
case|case
literal|3
case|:
name|vinstr
operator|=
literal|"vmsave"
expr_stmt|;
break|break;
case|case
literal|4
case|:
name|vinstr
operator|=
literal|"stgi"
expr_stmt|;
break|break;
case|case
literal|5
case|:
name|vinstr
operator|=
literal|"clgi"
expr_stmt|;
break|break;
case|case
literal|6
case|:
name|vinstr
operator|=
literal|"skinit"
expr_stmt|;
break|break;
case|case
literal|7
case|:
name|vinstr
operator|=
literal|"invlpga"
expr_stmt|;
break|break;
block|}
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
name|vinstr
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|NOMEM
expr_stmt|;
break|break;
block|}
comment|/*FALLTHROUGH*/
case|case
name|MONITOR_MWAIT
case|:
if|if
condition|(
name|mode
operator|==
literal|3
condition|)
block|{
if|if
condition|(
name|r_m
operator|==
literal|0
condition|)
block|{
ifdef|#
directive|ifdef
name|DIS_TEXT
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"monitor"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|NOMEM
expr_stmt|;
break|break;
block|}
elseif|else
if|if
condition|(
name|r_m
operator|==
literal|1
condition|)
block|{
ifdef|#
directive|ifdef
name|DIS_TEXT
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"mwait"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|NOMEM
expr_stmt|;
break|break;
block|}
else|else
block|{
goto|goto
name|error
goto|;
block|}
block|}
comment|/*FALLTHROUGH*/
case|case
name|XGETBV_XSETBV
case|:
if|if
condition|(
name|mode
operator|==
literal|3
condition|)
block|{
if|if
condition|(
name|r_m
operator|==
literal|0
condition|)
block|{
ifdef|#
directive|ifdef
name|DIS_TEXT
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"xgetbv"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|NOMEM
expr_stmt|;
break|break;
block|}
elseif|else
if|if
condition|(
name|r_m
operator|==
literal|1
condition|)
block|{
ifdef|#
directive|ifdef
name|DIS_TEXT
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"xsetbv"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|NOMEM
expr_stmt|;
break|break;
block|}
else|else
block|{
goto|goto
name|error
goto|;
block|}
block|}
comment|/*FALLTHROUGH*/
case|case
name|MO
case|:
comment|/* Similar to M, but only memory (no direct registers) */
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
if|if
condition|(
name|mode
operator|==
literal|3
condition|)
goto|goto
name|error
goto|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
name|NULL
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* move special register to register or reverse if vbit */
case|case
name|SREG
case|:
switch|switch
condition|(
name|opcode5
condition|)
block|{
case|case
literal|2
case|:
name|vbit
operator|=
literal|1
expr_stmt|;
comment|/*FALLTHROUGH*/
case|case
literal|0
case|:
name|wbit
operator|=
name|CONTROL_OPND
expr_stmt|;
break|break;
case|case
literal|3
case|:
name|vbit
operator|=
literal|1
expr_stmt|;
comment|/*FALLTHROUGH*/
case|case
literal|1
case|:
name|wbit
operator|=
name|DEBUG_OPND
expr_stmt|;
break|break;
case|case
literal|6
case|:
name|vbit
operator|=
literal|1
expr_stmt|;
comment|/*FALLTHROUGH*/
case|case
literal|4
case|:
name|wbit
operator|=
name|TEST_OPND
expr_stmt|;
break|break;
block|}
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
name|vbit
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|r_m
argument_list|,
name|LONG_OPND
argument_list|,
literal|1
operator|-
name|vbit
argument_list|)
expr_stmt|;
name|NOMEM
expr_stmt|;
break|break;
comment|/* 	 * single register operand with register in the low 3 	 * bits of op code 	 */
case|case
name|R
case|:
if|if
condition|(
name|opcode_bytes
operator|==
literal|2
condition|)
name|reg
operator|=
name|REGNO
argument_list|(
name|opcode5
argument_list|)
expr_stmt|;
else|else
name|reg
operator|=
name|REGNO
argument_list|(
name|opcode2
argument_list|)
expr_stmt|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|LONG_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|NOMEM
expr_stmt|;
break|break;
comment|/* 	 * register to accumulator with register in the low 3 	 * bits of op code, xchg instructions 	 */
case|case
name|RA
case|:
name|NOMEM
expr_stmt|;
name|reg
operator|=
name|REGNO
argument_list|(
name|opcode2
argument_list|)
expr_stmt|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|LONG_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|EAX_REGNO
argument_list|,
name|LONG_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
break|break;
comment|/* 	 * single segment register operand, with register in 	 * bits 3-4 of op code byte 	 */
case|case
name|SEG
case|:
name|NOMEM
expr_stmt|;
name|reg
operator|=
operator|(
name|x
operator|->
name|d86_bytes
index|[
name|x
operator|->
name|d86_len
operator|-
literal|1
index|]
operator|>>
literal|3
operator|)
operator|&
literal|0x3
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|SEG_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* 	 * single segment register operand, with register in 	 * bits 3-5 of op code 	 */
case|case
name|LSEG
case|:
name|NOMEM
expr_stmt|;
comment|/* long seg reg from opcode */
name|reg
operator|=
operator|(
name|x
operator|->
name|d86_bytes
index|[
name|x
operator|->
name|d86_len
operator|-
literal|1
index|]
operator|>>
literal|3
operator|)
operator|&
literal|0x7
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|SEG_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* memory or register operand to register */
case|case
name|MR
case|:
if|if
condition|(
name|vex_prefetch
condition|)
name|x
operator|->
name|d86_got_modrm
operator|=
literal|1
expr_stmt|;
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|STANDARD_MODRM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|RM
case|:
case|case
name|RM_66r
case|:
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|STANDARD_MODRM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
break|break;
comment|/* MMX/SIMD-Int memory or mm reg to mm reg		*/
case|case
name|MM
case|:
case|case
name|MMO
case|:
ifdef|#
directive|ifdef
name|DIS_TEXT
name|wbit
operator|=
name|strcmp
argument_list|(
name|dp
operator|->
name|it_name
argument_list|,
literal|"movd"
argument_list|)
condition|?
name|MM_OPND
else|:
name|LONG_OPND
expr_stmt|;
else|#
directive|else
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
endif|#
directive|endif
name|MIXED_MM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
name|MM_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|MMOIMPL
case|:
ifdef|#
directive|ifdef
name|DIS_TEXT
name|wbit
operator|=
name|strcmp
argument_list|(
name|dp
operator|->
name|it_name
argument_list|,
literal|"movd"
argument_list|)
condition|?
name|MM_OPND
else|:
name|LONG_OPND
expr_stmt|;
else|#
directive|else
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
endif|#
directive|endif
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
if|if
condition|(
name|mode
operator|!=
name|REG_ONLY
condition|)
goto|goto
name|error
goto|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|MM_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|mode
operator|=
literal|0
expr_stmt|;
comment|/* change for memory access size... */
break|break;
comment|/* MMX/SIMD-Int and SIMD-FP predicated mm reg to r32 */
case|case
name|MMO3P
case|:
name|wbit
operator|=
name|MM_OPND
expr_stmt|;
goto|goto
name|xmm3p
goto|;
case|case
name|XMM3P
case|:
name|wbit
operator|=
name|XMM_OPND
expr_stmt|;
name|xmm3p
label|:
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
if|if
condition|(
name|mode
operator|!=
name|REG_ONLY
condition|)
goto|goto
name|error
goto|;
name|THREEOPERAND
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
name|LONG_OPND
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|NOMEM
expr_stmt|;
break|break;
case|case
name|XMM3PM_66r
case|:
name|THREEOPERAND
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|LONG_OPND
argument_list|,
name|XMM_OPND
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* MMX/SIMD-Int predicated r32/mem to mm reg */
case|case
name|MMOPRM
case|:
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|w2
operator|=
name|MM_OPND
expr_stmt|;
goto|goto
name|xmmprm
goto|;
case|case
name|XMMPRM
case|:
case|case
name|XMMPRM_66r
case|:
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|w2
operator|=
name|XMM_OPND
expr_stmt|;
name|xmmprm
label|:
name|THREEOPERAND
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
name|w2
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
break|break;
comment|/* MMX/SIMD-Int predicated mm/mem to mm reg */
case|case
name|MMOPM
case|:
case|case
name|MMOPM_66o
case|:
name|wbit
operator|=
name|w2
operator|=
name|MM_OPND
expr_stmt|;
goto|goto
name|xmmprm
goto|;
comment|/* MMX/SIMD-Int mm reg to r32 */
case|case
name|MMOM3
case|:
name|NOMEM
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
if|if
condition|(
name|mode
operator|!=
name|REG_ONLY
condition|)
goto|goto
name|error
goto|;
name|wbit
operator|=
name|MM_OPND
expr_stmt|;
name|MIXED_MM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
name|LONG_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* SIMD memory or xmm reg operand to xmm reg		*/
case|case
name|XMM
case|:
case|case
name|XMM_66o
case|:
case|case
name|XMM_66r
case|:
case|case
name|XMMO
case|:
case|case
name|XMMXIMPL
case|:
name|wbit
operator|=
name|XMM_OPND
expr_stmt|;
name|STANDARD_MODRM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|it_adrmode
operator|==
name|XMMXIMPL
operator|&&
name|mode
operator|!=
name|REG_ONLY
condition|)
goto|goto
name|error
goto|;
ifdef|#
directive|ifdef
name|DIS_TEXT
comment|/* 		 * movlps and movhlps share opcodes.  They differ in the 		 * addressing modes allowed for their operands. 		 * movhps and movlhps behave similarly. 		 */
if|if
condition|(
name|mode
operator|==
name|REG_ONLY
condition|)
block|{
if|if
condition|(
name|strcmp
argument_list|(
name|dp
operator|->
name|it_name
argument_list|,
literal|"movlps"
argument_list|)
operator|==
literal|0
condition|)
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"movhlps"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
name|dp
operator|->
name|it_name
argument_list|,
literal|"movhps"
argument_list|)
operator|==
literal|0
condition|)
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"movlhps"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
if|if
condition|(
name|dp
operator|->
name|it_adrmode
operator|==
name|XMMXIMPL
condition|)
name|mode
operator|=
literal|0
expr_stmt|;
comment|/* change for memory access size... */
break|break;
comment|/* SIMD xmm reg to memory or xmm reg */
case|case
name|XMMS
case|:
case|case
name|XMMOS
case|:
case|case
name|XMMMS
case|:
case|case
name|XMMOMS
case|:
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
operator|(
name|strcmp
argument_list|(
name|dp
operator|->
name|it_name
argument_list|,
literal|"movlps"
argument_list|)
operator|==
literal|0
operator|||
name|strcmp
argument_list|(
name|dp
operator|->
name|it_name
argument_list|,
literal|"movhps"
argument_list|)
operator|==
literal|0
operator|||
name|strcmp
argument_list|(
name|dp
operator|->
name|it_name
argument_list|,
literal|"movntps"
argument_list|)
operator|==
literal|0
operator|)
operator|&&
name|mode
operator|==
name|REG_ONLY
condition|)
goto|goto
name|error
goto|;
endif|#
directive|endif
name|wbit
operator|=
name|XMM_OPND
expr_stmt|;
name|MIXED_MM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
name|XMM_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
break|break;
comment|/* SIMD memory to xmm reg */
case|case
name|XMMM
case|:
case|case
name|XMMM_66r
case|:
case|case
name|XMMOM
case|:
name|wbit
operator|=
name|XMM_OPND
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
name|mode
operator|==
name|REG_ONLY
condition|)
block|{
if|if
condition|(
name|strcmp
argument_list|(
name|dp
operator|->
name|it_name
argument_list|,
literal|"movhps"
argument_list|)
operator|==
literal|0
condition|)
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"movlhps"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
else|else
goto|goto
name|error
goto|;
block|}
endif|#
directive|endif
name|MIXED_MM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
name|XMM_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* SIMD memory or r32 to xmm reg			*/
case|case
name|XMM3MX
case|:
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|MIXED_MM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
name|XMM_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|XMM3MXS
case|:
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|MIXED_MM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
name|XMM_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
break|break;
comment|/* SIMD memory or mm reg to xmm reg			*/
case|case
name|XMMOMX
case|:
comment|/* SIMD mm to xmm */
case|case
name|XMMMX
case|:
name|wbit
operator|=
name|MM_OPND
expr_stmt|;
name|MIXED_MM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
name|XMM_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* SIMD memory or xmm reg to mm reg			*/
case|case
name|XMMXMM
case|:
case|case
name|XMMOXMM
case|:
case|case
name|XMMXM
case|:
name|wbit
operator|=
name|XMM_OPND
expr_stmt|;
name|MIXED_MM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
name|MM_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* SIMD memory or xmm reg to r32			*/
case|case
name|XMMXM3
case|:
name|wbit
operator|=
name|XMM_OPND
expr_stmt|;
name|MIXED_MM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
name|LONG_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* SIMD xmm to r32					*/
case|case
name|XMMX3
case|:
case|case
name|XMMOX3
case|:
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
if|if
condition|(
name|mode
operator|!=
name|REG_ONLY
condition|)
goto|goto
name|error
goto|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|XMM_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|LONG_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|NOMEM
expr_stmt|;
break|break;
comment|/* SIMD predicated memory or xmm reg with/to xmm reg */
case|case
name|XMMP
case|:
case|case
name|XMMP_66r
case|:
case|case
name|XMMP_66o
case|:
case|case
name|XMMOPM
case|:
name|wbit
operator|=
name|XMM_OPND
expr_stmt|;
name|THREEOPERAND
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|wbit
argument_list|,
name|XMM_OPND
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
comment|/* 		 * cmpps and cmpss vary their instruction name based 		 * on the value of imm8.  Other XMMP instructions, 		 * such as shufps, require explicit specification of 		 * the predicate. 		 */
if|if
condition|(
name|dp
operator|->
name|it_name
index|[
literal|0
index|]
operator|==
literal|'c'
operator|&&
name|dp
operator|->
name|it_name
index|[
literal|1
index|]
operator|==
literal|'m'
operator|&&
name|dp
operator|->
name|it_name
index|[
literal|2
index|]
operator|==
literal|'p'
operator|&&
name|strlen
argument_list|(
name|dp
operator|->
name|it_name
argument_list|)
operator|==
literal|5
condition|)
block|{
name|uchar_t
name|pred
init|=
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_value
operator|&
literal|0xff
decl_stmt|;
if|if
condition|(
name|pred
operator|>=
operator|(
sizeof|sizeof
argument_list|(
name|dis_PREDSUFFIX
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|char
operator|*
argument_list|)
operator|)
condition|)
goto|goto
name|error
goto|;
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"cmp"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
name|dis_PREDSUFFIX
index|[
name|pred
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
name|dp
operator|->
name|it_name
operator|+
name|strlen
argument_list|(
name|dp
operator|->
name|it_name
argument_list|)
operator|-
literal|2
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|=
name|x
operator|->
name|d86_opnd
index|[
literal|1
index|]
expr_stmt|;
name|x
operator|->
name|d86_opnd
index|[
literal|1
index|]
operator|=
name|x
operator|->
name|d86_opnd
index|[
literal|2
index|]
expr_stmt|;
name|x
operator|->
name|d86_numopnds
operator|=
literal|2
expr_stmt|;
block|}
endif|#
directive|endif
break|break;
case|case
name|XMMX2I
case|:
name|FOUROPERAND
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|XMM_OPND
argument_list|,
name|XMM_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|NOMEM
expr_stmt|;
break|break;
case|case
name|XMM2I
case|:
name|ONEOPERAND_TWOIMM
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|reg
argument_list|,
name|r_m
argument_list|,
name|rex_prefix
argument_list|,
name|XMM_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|NOMEM
expr_stmt|;
break|break;
comment|/* immediate operand to accumulator */
case|case
name|IA
case|:
name|wbit
operator|=
name|WBIT
argument_list|(
name|opcode2
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|EAX_REGNO
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
name|OPSIZE
argument_list|(
name|opnd_size
argument_list|,
name|wbit
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|NOMEM
expr_stmt|;
break|break;
comment|/* memory or register operand to accumulator */
case|case
name|MA
case|:
name|wbit
operator|=
name|WBIT
argument_list|(
name|opcode2
argument_list|)
expr_stmt|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
name|NULL
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* si register to di register used to reference memory		*/
case|case
name|SD
case|:
ifdef|#
directive|ifdef
name|DIS_TEXT
name|dtrace_check_override
argument_list|(
name|x
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|x
operator|->
name|d86_numopnds
operator|=
literal|2
expr_stmt|;
if|if
condition|(
name|addr_size
operator|==
name|SIZE64
condition|)
block|{
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_opnd
argument_list|,
literal|"(%rsi)"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|1
index|]
operator|.
name|d86_opnd
argument_list|,
literal|"(%rdi)"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|addr_size
operator|==
name|SIZE32
condition|)
block|{
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_opnd
argument_list|,
literal|"(%esi)"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|1
index|]
operator|.
name|d86_opnd
argument_list|,
literal|"(%edi)"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
block|}
else|else
block|{
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_opnd
argument_list|,
literal|"(%si)"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|1
index|]
operator|.
name|d86_opnd
argument_list|,
literal|"(%di)"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
break|break;
comment|/* accumulator to di register				*/
case|case
name|AD
case|:
name|wbit
operator|=
name|WBIT
argument_list|(
name|opcode2
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
name|dtrace_check_override
argument_list|(
name|x
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|x
operator|->
name|d86_numopnds
operator|=
literal|2
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|EAX_REGNO
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|addr_size
operator|==
name|SIZE64
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|1
index|]
operator|.
name|d86_opnd
argument_list|,
literal|"(%rdi)"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|addr_size
operator|==
name|SIZE32
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|1
index|]
operator|.
name|d86_opnd
argument_list|,
literal|"(%edi)"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
else|else
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|1
index|]
operator|.
name|d86_opnd
argument_list|,
literal|"(%di)"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
break|break;
comment|/* si register to accumulator				*/
case|case
name|SA
case|:
name|wbit
operator|=
name|WBIT
argument_list|(
name|opcode2
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
name|dtrace_check_override
argument_list|(
name|x
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|x
operator|->
name|d86_numopnds
operator|=
literal|2
expr_stmt|;
if|if
condition|(
name|addr_size
operator|==
name|SIZE64
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_opnd
argument_list|,
literal|"(%rsi)"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|addr_size
operator|==
name|SIZE32
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_opnd
argument_list|,
literal|"(%esi)"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
else|else
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_opnd
argument_list|,
literal|"(%si)"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|EAX_REGNO
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
endif|#
directive|endif
break|break;
comment|/* 	 * single operand, a 16/32 bit displacement 	 */
case|case
name|D
case|:
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|dtrace_disp_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
name|OPSIZE
argument_list|(
name|opnd_size
argument_list|,
name|LONG_OPND
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|NOMEM
expr_stmt|;
break|break;
comment|/* jmp/call indirect to memory or register operand		*/
case|case
name|INM
case|:
ifdef|#
directive|ifdef
name|DIS_TEXT
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_prefix
argument_list|,
literal|"*"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
name|NULL
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|LONG_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
break|break;
comment|/* 	 * for long jumps and long calls -- a new code segment 	 * register and an offset in IP -- stored in object 	 * code in reverse order. Note - not valid in amd64 	 */
case|case
name|SO
case|:
name|dtrace_check_override
argument_list|(
name|x
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
name|OPSIZE
argument_list|(
name|opnd_size
argument_list|,
name|LONG_OPND
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
name|x
operator|->
name|d86_opnd
index|[
literal|1
index|]
operator|.
name|d86_mode
operator|=
name|MODE_SIGNED
expr_stmt|;
endif|#
directive|endif
comment|/* will now get segment operand */
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* 	 * jmp/call. single operand, 8 bit displacement. 	 * added to current EIP in 'compofff' 	 */
case|case
name|BD
case|:
name|dtrace_disp_opnd
argument_list|(
name|x
argument_list|,
name|BYTE_OPND
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|NOMEM
expr_stmt|;
break|break;
comment|/* single 32/16 bit immediate operand			*/
case|case
name|I
case|:
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
name|OPSIZE
argument_list|(
name|opnd_size
argument_list|,
name|LONG_OPND
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* single 8 bit immediate operand			*/
case|case
name|Ib
case|:
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|ENTER
case|:
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|opnd_size
condition|)
block|{
case|case
name|SIZE64
case|:
name|x
operator|->
name|d86_memsize
operator|=
operator|(
name|x
operator|->
name|d86_opnd
index|[
literal|1
index|]
operator|.
name|d86_value
operator|+
literal|1
operator|)
operator|*
literal|8
expr_stmt|;
break|break;
case|case
name|SIZE32
case|:
name|x
operator|->
name|d86_memsize
operator|=
operator|(
name|x
operator|->
name|d86_opnd
index|[
literal|1
index|]
operator|.
name|d86_value
operator|+
literal|1
operator|)
operator|*
literal|4
expr_stmt|;
break|break;
case|case
name|SIZE16
case|:
name|x
operator|->
name|d86_memsize
operator|=
operator|(
name|x
operator|->
name|d86_opnd
index|[
literal|1
index|]
operator|.
name|d86_value
operator|+
literal|1
operator|)
operator|*
literal|2
expr_stmt|;
break|break;
block|}
break|break;
comment|/* 16-bit immediate operand */
case|case
name|RET
case|:
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
comment|/* single 8 bit port operand				*/
case|case
name|P
case|:
name|dtrace_check_override
argument_list|(
name|x
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|BYTE_OPND
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|NOMEM
expr_stmt|;
break|break;
comment|/* single operand, dx register (variable port instruction) */
case|case
name|V
case|:
name|x
operator|->
name|d86_numopnds
operator|=
literal|1
expr_stmt|;
name|dtrace_check_override
argument_list|(
name|x
argument_list|,
literal|0
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_opnd
argument_list|,
literal|"(%dx)"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|NOMEM
expr_stmt|;
break|break;
comment|/* 	 * The int instruction, which has two forms: 	 * int 3 (breakpoint) or 	 * int n, where n is indicated in the subsequent 	 * byte (format Ib).  The int 3 instruction (opcode 0xCC), 	 * where, although the 3 looks  like an operand, 	 * it is implied by the opcode. It must be converted 	 * to the correct base and output. 	 */
case|case
name|INT3
case|:
ifdef|#
directive|ifdef
name|DIS_TEXT
name|x
operator|->
name|d86_numopnds
operator|=
literal|1
expr_stmt|;
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_mode
operator|=
name|MODE_SIGNED
expr_stmt|;
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_value_size
operator|=
literal|1
expr_stmt|;
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_value
operator|=
literal|3
expr_stmt|;
endif|#
directive|endif
name|NOMEM
expr_stmt|;
break|break;
comment|/* single 8 bit immediate operand			*/
case|case
name|INTx
case|:
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|BYTE_OPND
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|NOMEM
expr_stmt|;
break|break;
comment|/* an unused byte must be discarded */
case|case
name|U
case|:
if|if
condition|(
name|x
operator|->
name|d86_get_byte
argument_list|(
name|x
operator|->
name|d86_data
argument_list|)
operator|<
literal|0
condition|)
goto|goto
name|error
goto|;
name|x
operator|->
name|d86_len
operator|++
expr_stmt|;
name|NOMEM
expr_stmt|;
break|break;
case|case
name|CBW
case|:
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
name|opnd_size
operator|==
name|SIZE16
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"cbtw"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|opnd_size
operator|==
name|SIZE32
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"cwtl"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
else|else
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"cltq"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|NOMEM
expr_stmt|;
break|break;
case|case
name|CWD
case|:
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
name|opnd_size
operator|==
name|SIZE16
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"cwtd"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|opnd_size
operator|==
name|SIZE32
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"cltd"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
else|else
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"cqtd"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
name|NOMEM
expr_stmt|;
break|break;
case|case
name|XMMSFNC
case|:
comment|/* 		 * sfence is sfence if mode is REG_ONLY.  If mode isn't 		 * REG_ONLY, mnemonic should be 'clflush'. 		 */
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
comment|/* sfence doesn't take operands */
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
name|mode
operator|==
name|REG_ONLY
condition|)
block|{
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"sfence"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
block|}
else|else
block|{
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"clflush"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|BYTE_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|NOMEM
expr_stmt|;
block|}
else|#
directive|else
if|if
condition|(
name|mode
operator|!=
name|REG_ONLY
condition|)
block|{
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|LONG_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|NOMEM
expr_stmt|;
block|}
endif|#
directive|endif
break|break;
comment|/* 	 * no disassembly, the mnemonic was all there was so go on 	 */
case|case
name|NORM
case|:
if|if
condition|(
name|dp
operator|->
name|it_invalid32
operator|&&
name|cpu_mode
operator|!=
name|SIZE64
condition|)
goto|goto
name|error
goto|;
name|NOMEM
expr_stmt|;
comment|/*FALLTHROUGH*/
case|case
name|IMPLMEM
case|:
break|break;
case|case
name|XMMFENCE
case|:
comment|/* 		 * XRSTOR and LFENCE share the same opcode but differ in mode 		 */
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
if|if
condition|(
name|mode
operator|==
name|REG_ONLY
condition|)
block|{
comment|/* 			 * Only the following exact byte sequences are allowed: 			 * 			 * 	0f ae e8	lfence 			 * 	0f ae f0	mfence 			 */
if|if
condition|(
operator|(
name|uint8_t
operator|)
name|x
operator|->
name|d86_bytes
index|[
name|x
operator|->
name|d86_len
operator|-
literal|1
index|]
operator|!=
literal|0xe8
operator|&&
operator|(
name|uint8_t
operator|)
name|x
operator|->
name|d86_bytes
index|[
name|x
operator|->
name|d86_len
operator|-
literal|1
index|]
operator|!=
literal|0xf0
condition|)
goto|goto
name|error
goto|;
block|}
else|else
block|{
ifdef|#
directive|ifdef
name|DIS_TEXT
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"xrstor"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|dtrace_rex_adjust
argument_list|(
name|rex_prefix
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|BYTE_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
break|break;
comment|/* float reg */
case|case
name|F
case|:
ifdef|#
directive|ifdef
name|DIS_TEXT
name|x
operator|->
name|d86_numopnds
operator|=
literal|1
expr_stmt|;
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_opnd
argument_list|,
literal|"%st(X)"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_opnd
index|[
literal|4
index|]
operator|=
name|r_m
operator|+
literal|'0'
expr_stmt|;
endif|#
directive|endif
name|NOMEM
expr_stmt|;
break|break;
comment|/* float reg to float reg, with ret bit present */
case|case
name|FF
case|:
name|vbit
operator|=
name|opcode2
operator|>>
literal|2
operator|&
literal|0x1
expr_stmt|;
comment|/* vbit = 1: st -> st(i) */
comment|/*FALLTHROUGH*/
case|case
name|FFC
case|:
comment|/* case for vbit always = 0 */
ifdef|#
directive|ifdef
name|DIS_TEXT
name|x
operator|->
name|d86_numopnds
operator|=
literal|2
expr_stmt|;
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|1
operator|-
name|vbit
index|]
operator|.
name|d86_opnd
argument_list|,
literal|"%st"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
name|vbit
index|]
operator|.
name|d86_opnd
argument_list|,
literal|"%st(X)"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
name|x
operator|->
name|d86_opnd
index|[
name|vbit
index|]
operator|.
name|d86_opnd
index|[
literal|4
index|]
operator|=
name|r_m
operator|+
literal|'0'
expr_stmt|;
endif|#
directive|endif
name|NOMEM
expr_stmt|;
break|break;
comment|/* AVX instructions */
case|case
name|VEX_MO
case|:
comment|/* op(ModR/M.r/m) */
name|x
operator|->
name|d86_numopnds
operator|=
literal|1
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
operator|(
name|dp
operator|==
operator|&
name|dis_opAVX0F
index|[
literal|0xA
index|]
index|[
literal|0xE
index|]
operator|)
operator|&&
operator|(
name|reg
operator|==
literal|3
operator|)
condition|)
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"vstmxcsr"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|dtrace_vex_adjust
argument_list|(
name|vex_byte1
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|VEX_RMrX
case|:
comment|/* ModR/M.reg := op(VEX.vvvv, ModR/M.r/m) */
name|x
operator|->
name|d86_numopnds
operator|=
literal|3
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_vex_adjust
argument_list|(
name|vex_byte1
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
if|if
condition|(
name|mode
operator|!=
name|REG_ONLY
condition|)
block|{
if|if
condition|(
operator|(
name|dp
operator|==
operator|&
name|dis_opAVXF20F
index|[
literal|0x10
index|]
operator|)
operator|||
operator|(
name|dp
operator|==
operator|&
name|dis_opAVXF30F
index|[
literal|0x10
index|]
operator|)
condition|)
block|{
comment|/* vmovsd<m64>,<xmm> */
comment|/* or vmovss<m64>,<xmm> */
name|x
operator|->
name|d86_numopnds
operator|=
literal|2
expr_stmt|;
goto|goto
name|L_VEX_MX
goto|;
block|}
block|}
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
literal|2
argument_list|)
expr_stmt|;
comment|/* 		 * VEX prefix uses the 1's complement form to encode the 		 * XMM/YMM regs 		 */
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
operator|(
literal|0xF
operator|-
name|vex_v
operator|)
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|dp
operator|==
operator|&
name|dis_opAVXF20F
index|[
literal|0x2A
index|]
operator|)
operator|||
operator|(
name|dp
operator|==
operator|&
name|dis_opAVXF30F
index|[
literal|0x2A
index|]
operator|)
condition|)
block|{
comment|/* 			 * vcvtsi2si</r,m>,<xmm>,<xmm> or vcvtsi2ss</r,m>, 			 *<xmm>,<xmm> 			 */
name|wbit
operator|=
name|LONG_OPND
expr_stmt|;
block|}
ifdef|#
directive|ifdef
name|DIS_TEXT
elseif|else
if|if
condition|(
operator|(
name|mode
operator|==
name|REG_ONLY
operator|)
operator|&&
operator|(
name|dp
operator|==
operator|&
name|dis_opAVX0F
index|[
literal|0x1
index|]
index|[
literal|0x6
index|]
operator|)
condition|)
block|{
comment|/* vmovlhps */
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"vmovlhps"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|(
name|mode
operator|==
name|REG_ONLY
operator|)
operator|&&
operator|(
name|dp
operator|==
operator|&
name|dis_opAVX0F
index|[
literal|0x1
index|]
index|[
literal|0x2
index|]
operator|)
condition|)
block|{
comment|/* vmovhlps */
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"vmovhlps"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|VEX_RRX
case|:
comment|/* ModR/M.rm := op(VEX.vvvv, ModR/M.reg) */
name|x
operator|->
name|d86_numopnds
operator|=
literal|3
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_vex_adjust
argument_list|(
name|vex_byte1
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
if|if
condition|(
name|mode
operator|!=
name|REG_ONLY
condition|)
block|{
if|if
condition|(
operator|(
name|dp
operator|==
operator|&
name|dis_opAVXF20F
index|[
literal|0x11
index|]
operator|)
operator|||
operator|(
name|dp
operator|==
operator|&
name|dis_opAVXF30F
index|[
literal|0x11
index|]
operator|)
condition|)
block|{
comment|/* vmovsd<xmm>,<m64> */
comment|/* or vmovss<xmm>,<m64> */
name|x
operator|->
name|d86_numopnds
operator|=
literal|2
expr_stmt|;
goto|goto
name|L_VEX_RM
goto|;
block|}
block|}
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
operator|(
literal|0xF
operator|-
name|vex_v
operator|)
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|VEX_RMRX
case|:
comment|/* ModR/M.reg := op(VEX.vvvv, ModR/M.r_m, imm8[7:4]) */
name|x
operator|->
name|d86_numopnds
operator|=
literal|4
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_vex_adjust
argument_list|(
name|vex_byte1
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
operator|(
literal|0xF
operator|-
name|vex_v
operator|)
argument_list|,
name|wbit
argument_list|,
literal|2
argument_list|)
expr_stmt|;
if|if
condition|(
name|dp
operator|==
operator|&
name|dis_opAVX660F3A
index|[
literal|0x18
index|]
condition|)
block|{
comment|/* vinsertf128<imm8>,<xmm>,<ymm>,<ymm> */
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|XMM_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|(
name|dp
operator|==
operator|&
name|dis_opAVX660F3A
index|[
literal|0x20
index|]
operator|)
operator|||
operator|(
name|dp
operator|==
operator|&
name|dis_opAVX660F
index|[
literal|0xC4
index|]
operator|)
condition|)
block|{
comment|/* vpinsrb<imm8>,<reg/mm>,<xmm>,<xmm> */
comment|/* or vpinsrw<imm8>,<reg/mm>,<xmm>,<xmm> */
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|LONG_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|dp
operator|==
operator|&
name|dis_opAVX660F3A
index|[
literal|0x22
index|]
condition|)
block|{
comment|/* vpinsrd/q<imm8>,<reg/mm>,<xmm>,<xmm> */
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
name|vex_W
condition|)
name|x
operator|->
name|d86_mnem
index|[
literal|6
index|]
operator|=
literal|'q'
expr_stmt|;
endif|#
directive|endif
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|LONG_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
comment|/* one byte immediate number */
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|/* vblendvpd, vblendvps, vblendvb use the imm encode the regs */
if|if
condition|(
operator|(
name|dp
operator|==
operator|&
name|dis_opAVX660F3A
index|[
literal|0x4A
index|]
operator|)
operator|||
operator|(
name|dp
operator|==
operator|&
name|dis_opAVX660F3A
index|[
literal|0x4B
index|]
operator|)
operator|||
operator|(
name|dp
operator|==
operator|&
name|dis_opAVX660F3A
index|[
literal|0x4C
index|]
operator|)
condition|)
block|{
ifdef|#
directive|ifdef
name|DIS_TEXT
name|int
name|regnum
init|=
operator|(
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_value
operator|&
literal|0xF0
operator|)
operator|>>
literal|4
decl_stmt|;
endif|#
directive|endif
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_mode
operator|=
name|MODE_NONE
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
name|vex_L
condition|)
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_opnd
argument_list|,
name|dis_YMMREG
index|[
name|regnum
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
else|else
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_opnd
index|[
literal|0
index|]
operator|.
name|d86_opnd
argument_list|,
name|dis_XMMREG
index|[
name|regnum
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
break|break;
case|case
name|VEX_MX
case|:
comment|/* ModR/M.reg := op(ModR/M.rm) */
name|x
operator|->
name|d86_numopnds
operator|=
literal|2
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_vex_adjust
argument_list|(
name|vex_byte1
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|L_VEX_MX
label|:
if|if
condition|(
operator|(
name|dp
operator|==
operator|&
name|dis_opAVXF20F
index|[
literal|0xE6
index|]
operator|)
operator|||
operator|(
name|dp
operator|==
operator|&
name|dis_opAVX660F
index|[
literal|0x5A
index|]
operator|)
operator|||
operator|(
name|dp
operator|==
operator|&
name|dis_opAVX660F
index|[
literal|0xE6
index|]
operator|)
condition|)
block|{
comment|/* vcvtpd2dq<ymm>,<xmm> */
comment|/* or vcvtpd2ps<ymm>,<xmm> */
comment|/* or vcvttpd2dq<ymm>,<xmm> */
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|XMM_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|(
name|dp
operator|==
operator|&
name|dis_opAVXF30F
index|[
literal|0xE6
index|]
operator|)
operator|||
operator|(
name|dp
operator|==
operator|&
name|dis_opAVX0F
index|[
literal|0x5
index|]
index|[
literal|0xA
index|]
operator|)
operator|||
operator|(
name|dp
operator|==
operator|&
name|dis_opAVX660F38
index|[
literal|0x13
index|]
operator|)
condition|)
block|{
comment|/* vcvtdq2pd<xmm>,<ymm> */
comment|/* or vcvtps2pd<xmm>,<ymm> */
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|XMM_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|dp
operator|==
operator|&
name|dis_opAVX660F
index|[
literal|0x6E
index|]
condition|)
block|{
comment|/* vmovd/q<reg/mem 32/64>,<xmm> */
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
name|vex_W
condition|)
name|x
operator|->
name|d86_mnem
index|[
literal|4
index|]
operator|=
literal|'q'
expr_stmt|;
endif|#
directive|endif
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|LONG_OPND
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|VEX_MXI
case|:
comment|/* ModR/M.reg := op(ModR/M.rm, imm8) */
name|x
operator|->
name|d86_numopnds
operator|=
literal|3
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_vex_adjust
argument_list|(
name|vex_byte1
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|/* one byte immediate number */
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|VEX_XXI
case|:
comment|/* VEX.vvvv := op(ModR/M.rm, imm8) */
name|x
operator|->
name|d86_numopnds
operator|=
literal|3
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
name|dis_AVXvgrp7
index|[
name|opcode2
operator|-
literal|1
index|]
index|[
name|reg
index|]
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|dtrace_vex_adjust
argument_list|(
name|vex_byte1
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
operator|(
literal|0xF
operator|-
name|vex_v
operator|)
argument_list|,
name|wbit
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|/* one byte immediate number */
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|VEX_MR
case|:
comment|/* ModR/M.reg (reg32/64) := op(ModR/M.rm) */
if|if
condition|(
name|dp
operator|==
operator|&
name|dis_opAVX660F
index|[
literal|0xC5
index|]
condition|)
block|{
comment|/* vpextrw<imm8>,<xmm>,<reg> */
name|x
operator|->
name|d86_numopnds
operator|=
literal|2
expr_stmt|;
name|vbit
operator|=
literal|2
expr_stmt|;
block|}
else|else
block|{
name|x
operator|->
name|d86_numopnds
operator|=
literal|2
expr_stmt|;
name|vbit
operator|=
literal|1
expr_stmt|;
block|}
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_vex_adjust
argument_list|(
name|vex_byte1
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|LONG_OPND
argument_list|,
name|vbit
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
name|vbit
operator|-
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|vbit
operator|==
literal|2
condition|)
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|VEX_RRI
case|:
comment|/* implicit(eflags/r32) := op(ModR/M.reg, ModR/M.rm) */
name|x
operator|->
name|d86_numopnds
operator|=
literal|2
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_vex_adjust
argument_list|(
name|vex_byte1
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|VEX_RX
case|:
comment|/* ModR/M.rm := op(ModR/M.reg) */
comment|/* vextractf128 || vcvtps2ph */
if|if
condition|(
name|dp
operator|==
operator|&
name|dis_opAVX660F3A
index|[
literal|0x19
index|]
operator|||
name|dp
operator|==
operator|&
name|dis_opAVX660F3A
index|[
literal|0x1d
index|]
condition|)
block|{
name|x
operator|->
name|d86_numopnds
operator|=
literal|3
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_vex_adjust
argument_list|(
name|vex_byte1
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|XMM_OPND
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|/* one byte immediate number */
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
block|}
name|x
operator|->
name|d86_numopnds
operator|=
literal|2
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_vex_adjust
argument_list|(
name|vex_byte1
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|VEX_RR
case|:
comment|/* ModR/M.rm := op(ModR/M.reg) */
name|x
operator|->
name|d86_numopnds
operator|=
literal|2
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_vex_adjust
argument_list|(
name|vex_byte1
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
if|if
condition|(
name|dp
operator|==
operator|&
name|dis_opAVX660F
index|[
literal|0x7E
index|]
condition|)
block|{
comment|/* vmovd/q<reg/mem 32/64>,<xmm> */
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
name|vex_W
condition|)
name|x
operator|->
name|d86_mnem
index|[
literal|4
index|]
operator|=
literal|'q'
expr_stmt|;
endif|#
directive|endif
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|LONG_OPND
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|VEX_RRi
case|:
comment|/* ModR/M.rm := op(ModR/M.reg, imm) */
name|x
operator|->
name|d86_numopnds
operator|=
literal|3
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_vex_adjust
argument_list|(
name|vex_byte1
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
name|dp
operator|==
operator|&
name|dis_opAVX660F3A
index|[
literal|0x16
index|]
condition|)
block|{
comment|/* vpextrd/q<imm>,<xmm>,<reg/mem 32/64> */
if|if
condition|(
name|vex_W
condition|)
name|x
operator|->
name|d86_mnem
index|[
literal|6
index|]
operator|=
literal|'q'
expr_stmt|;
block|}
endif|#
directive|endif
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|LONG_OPND
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|/* one byte immediate number */
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|VEX_RM
case|:
comment|/* ModR/M.rm := op(ModR/M.reg) */
if|if
condition|(
name|dp
operator|==
operator|&
name|dis_opAVX660F3A
index|[
literal|0x17
index|]
condition|)
block|{
comment|/* vextractps */
name|x
operator|->
name|d86_numopnds
operator|=
literal|3
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_vex_adjust
argument_list|(
name|vex_byte1
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|LONG_OPND
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|/* one byte immediate number */
name|dtrace_imm_opnd
argument_list|(
name|x
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
block|}
name|x
operator|->
name|d86_numopnds
operator|=
literal|2
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_vex_adjust
argument_list|(
name|vex_byte1
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|L_VEX_RM
label|:
name|vbit
operator|=
literal|1
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
name|vbit
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
name|vbit
operator|-
literal|1
argument_list|)
expr_stmt|;
break|break;
case|case
name|VEX_RRM
case|:
comment|/* ModR/M.rm := op(VEX.vvvv, ModR/M.reg) */
name|x
operator|->
name|d86_numopnds
operator|=
literal|3
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_vex_adjust
argument_list|(
name|vex_byte1
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|mode
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|2
argument_list|)
expr_stmt|;
comment|/* VEX use the 1's complement form encode the XMM/YMM regs */
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
operator|(
literal|0xF
operator|-
name|vex_v
operator|)
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|VEX_RMX
case|:
comment|/* ModR/M.reg := op(VEX.vvvv, ModR/M.rm) */
name|x
operator|->
name|d86_numopnds
operator|=
literal|3
expr_stmt|;
name|dtrace_get_modrm
argument_list|(
name|x
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_vex_adjust
argument_list|(
name|vex_byte1
argument_list|,
name|mode
argument_list|,
operator|&
name|reg
argument_list|,
operator|&
name|r_m
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|reg
argument_list|,
name|wbit
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
operator|(
literal|0xF
operator|-
name|vex_v
operator|)
argument_list|,
name|wbit
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dtrace_get_operand
argument_list|(
name|x
argument_list|,
name|REG_ONLY
argument_list|,
name|r_m
argument_list|,
name|wbit
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|VEX_NONE
case|:
ifdef|#
directive|ifdef
name|DIS_TEXT
if|if
condition|(
name|vex_L
condition|)
operator|(
name|void
operator|)
name|strncpy
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"vzeroall"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
break|break;
comment|/* an invalid op code */
case|case
name|AM
case|:
case|case
name|DM
case|:
case|case
name|OVERRIDE
case|:
case|case
name|PREFIX
case|:
case|case
name|UNKNOWN
case|:
name|NOMEM
expr_stmt|;
default|default:
goto|goto
name|error
goto|;
block|}
comment|/* end switch */
if|if
condition|(
name|x
operator|->
name|d86_error
condition|)
goto|goto
name|error
goto|;
name|done
label|:
ifdef|#
directive|ifdef
name|DIS_MEM
comment|/* 	 * compute the size of any memory accessed by the instruction 	 */
if|if
condition|(
name|x
operator|->
name|d86_memsize
operator|!=
literal|0
condition|)
block|{
return|return
operator|(
literal|0
operator|)
return|;
block|}
elseif|else
if|if
condition|(
name|dp
operator|->
name|it_stackop
condition|)
block|{
switch|switch
condition|(
name|opnd_size
condition|)
block|{
case|case
name|SIZE16
case|:
name|x
operator|->
name|d86_memsize
operator|=
literal|2
expr_stmt|;
break|break;
case|case
name|SIZE32
case|:
name|x
operator|->
name|d86_memsize
operator|=
literal|4
expr_stmt|;
break|break;
case|case
name|SIZE64
case|:
name|x
operator|->
name|d86_memsize
operator|=
literal|8
expr_stmt|;
break|break;
block|}
block|}
elseif|else
if|if
condition|(
name|nomem
operator|||
name|mode
operator|==
name|REG_ONLY
condition|)
block|{
name|x
operator|->
name|d86_memsize
operator|=
literal|0
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|dp
operator|->
name|it_size
operator|!=
literal|0
condition|)
block|{
comment|/* 		 * In 64 bit mode descriptor table entries 		 * go up to 10 bytes and popf/pushf are always 8 bytes 		 */
if|if
condition|(
name|x
operator|->
name|d86_mode
operator|==
name|SIZE64
operator|&&
name|dp
operator|->
name|it_size
operator|==
literal|6
condition|)
name|x
operator|->
name|d86_memsize
operator|=
literal|10
expr_stmt|;
elseif|else
if|if
condition|(
name|x
operator|->
name|d86_mode
operator|==
name|SIZE64
operator|&&
name|opcode1
operator|==
literal|0x9
operator|&&
operator|(
name|opcode2
operator|==
literal|0xc
operator|||
name|opcode2
operator|==
literal|0xd
operator|)
condition|)
name|x
operator|->
name|d86_memsize
operator|=
literal|8
expr_stmt|;
else|else
name|x
operator|->
name|d86_memsize
operator|=
name|dp
operator|->
name|it_size
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|wbit
operator|==
literal|0
condition|)
block|{
name|x
operator|->
name|d86_memsize
operator|=
literal|1
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|wbit
operator|==
name|LONG_OPND
condition|)
block|{
if|if
condition|(
name|opnd_size
operator|==
name|SIZE64
condition|)
name|x
operator|->
name|d86_memsize
operator|=
literal|8
expr_stmt|;
elseif|else
if|if
condition|(
name|opnd_size
operator|==
name|SIZE32
condition|)
name|x
operator|->
name|d86_memsize
operator|=
literal|4
expr_stmt|;
else|else
name|x
operator|->
name|d86_memsize
operator|=
literal|2
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|wbit
operator|==
name|SEG_OPND
condition|)
block|{
name|x
operator|->
name|d86_memsize
operator|=
literal|4
expr_stmt|;
block|}
else|else
block|{
name|x
operator|->
name|d86_memsize
operator|=
literal|8
expr_stmt|;
block|}
endif|#
directive|endif
return|return
operator|(
literal|0
operator|)
return|;
name|error
label|:
ifdef|#
directive|ifdef
name|DIS_TEXT
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|x
operator|->
name|d86_mnem
argument_list|,
literal|"undef"
argument_list|,
name|OPLEN
argument_list|)
expr_stmt|;
endif|#
directive|endif
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|DIS_TEXT
end_ifdef

begin_comment
comment|/*  * Some instructions should have immediate operands printed  * as unsigned integers. We compare against this table.  */
end_comment

begin_decl_stmt
specifier|static
name|char
modifier|*
name|unsigned_ops
index|[]
init|=
block|{
literal|"or"
block|,
literal|"and"
block|,
literal|"xor"
block|,
literal|"test"
block|,
literal|"in"
block|,
literal|"out"
block|,
literal|"lcall"
block|,
literal|"ljmp"
block|,
literal|"rcr"
block|,
literal|"rcl"
block|,
literal|"ror"
block|,
literal|"rol"
block|,
literal|"shl"
block|,
literal|"shr"
block|,
literal|"sal"
block|,
literal|"psr"
block|,
literal|"psl"
block|,
literal|0
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|int
name|isunsigned_op
parameter_list|(
name|char
modifier|*
name|opcode
parameter_list|)
block|{
name|char
modifier|*
name|where
decl_stmt|;
name|int
name|i
decl_stmt|;
name|int
name|is_unsigned
init|=
literal|0
decl_stmt|;
comment|/* 	 * Work back to start of last mnemonic, since we may have 	 * prefixes on some opcodes. 	 */
name|where
operator|=
name|opcode
operator|+
name|strlen
argument_list|(
name|opcode
argument_list|)
operator|-
literal|1
expr_stmt|;
while|while
condition|(
name|where
operator|>
name|opcode
operator|&&
operator|*
name|where
operator|!=
literal|' '
condition|)
operator|--
name|where
expr_stmt|;
if|if
condition|(
operator|*
name|where
operator|==
literal|' '
condition|)
operator|++
name|where
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|unsigned_ops
index|[
name|i
index|]
condition|;
operator|++
name|i
control|)
block|{
if|if
condition|(
name|strncmp
argument_list|(
name|where
argument_list|,
name|unsigned_ops
index|[
name|i
index|]
argument_list|,
name|strlen
argument_list|(
name|unsigned_ops
index|[
name|i
index|]
argument_list|)
argument_list|)
condition|)
continue|continue;
name|is_unsigned
operator|=
literal|1
expr_stmt|;
break|break;
block|}
return|return
operator|(
name|is_unsigned
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Print a numeric immediate into end of buf, maximum length buflen.  * The immediate may be an address or a displacement.  Mask is set  * for address size.  If the immediate is a "small negative", or  * if it's a negative displacement of any magnitude, print as -<absval>.  * Respect the "octal" flag.  "Small negative" is defined as "in the  * interval [NEG_LIMIT, 0)".  *  * Also, "isunsigned_op()" instructions never print negatives.  *  * Return whether we decided to print a negative value or not.  */
end_comment

begin_define
define|#
directive|define
name|NEG_LIMIT
value|-255
end_define

begin_enum
enum|enum
block|{
name|IMM
block|,
name|DISP
block|}
enum|;
end_enum

begin_enum
enum|enum
block|{
name|POS
block|,
name|TRY_NEG
block|}
enum|;
end_enum

begin_function
specifier|static
name|int
name|print_imm
parameter_list|(
name|dis86_t
modifier|*
name|dis
parameter_list|,
name|uint64_t
name|usv
parameter_list|,
name|uint64_t
name|mask
parameter_list|,
name|char
modifier|*
name|buf
parameter_list|,
name|size_t
name|buflen
parameter_list|,
name|int
name|disp
parameter_list|,
name|int
name|try_neg
parameter_list|)
block|{
name|int
name|curlen
decl_stmt|;
name|int64_t
name|sv
init|=
operator|(
name|int64_t
operator|)
name|usv
decl_stmt|;
name|int
name|octal
init|=
name|dis
operator|->
name|d86_flags
operator|&
name|DIS_F_OCTAL
decl_stmt|;
name|curlen
operator|=
name|strlen
argument_list|(
name|buf
argument_list|)
expr_stmt|;
if|if
condition|(
name|try_neg
operator|==
name|TRY_NEG
operator|&&
name|sv
operator|<
literal|0
operator|&&
operator|(
name|disp
operator|||
name|sv
operator|>=
name|NEG_LIMIT
operator|)
operator|&&
operator|!
name|isunsigned_op
argument_list|(
name|dis
operator|->
name|d86_mnem
argument_list|)
condition|)
block|{
name|dis
operator|->
name|d86_sprintf_func
argument_list|(
name|buf
operator|+
name|curlen
argument_list|,
name|buflen
operator|-
name|curlen
argument_list|,
name|octal
condition|?
literal|"-0%llo"
else|:
literal|"-0x%llx"
argument_list|,
operator|(
operator|-
name|sv
operator|)
operator|&
name|mask
argument_list|)
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
else|else
block|{
if|if
condition|(
name|disp
operator|==
name|DISP
condition|)
name|dis
operator|->
name|d86_sprintf_func
argument_list|(
name|buf
operator|+
name|curlen
argument_list|,
name|buflen
operator|-
name|curlen
argument_list|,
name|octal
condition|?
literal|"+0%llo"
else|:
literal|"+0x%llx"
argument_list|,
name|usv
operator|&
name|mask
argument_list|)
expr_stmt|;
else|else
name|dis
operator|->
name|d86_sprintf_func
argument_list|(
name|buf
operator|+
name|curlen
argument_list|,
name|buflen
operator|-
name|curlen
argument_list|,
name|octal
condition|?
literal|"0%llo"
else|:
literal|"0x%llx"
argument_list|,
name|usv
operator|&
name|mask
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
block|}
end_function

begin_function
specifier|static
name|int
name|log2
parameter_list|(
name|int
name|size
parameter_list|)
block|{
switch|switch
condition|(
name|size
condition|)
block|{
case|case
literal|1
case|:
return|return
operator|(
literal|0
operator|)
return|;
case|case
literal|2
case|:
return|return
operator|(
literal|1
operator|)
return|;
case|case
literal|4
case|:
return|return
operator|(
literal|2
operator|)
return|;
case|case
literal|8
case|:
return|return
operator|(
literal|3
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/* ARGSUSED */
end_comment

begin_function
name|void
name|dtrace_disx86_str
parameter_list|(
name|dis86_t
modifier|*
name|dis
parameter_list|,
name|uint_t
name|mode
parameter_list|,
name|uint64_t
name|pc
parameter_list|,
name|char
modifier|*
name|buf
parameter_list|,
name|size_t
name|buflen
parameter_list|)
block|{
name|uint64_t
name|reltgt
init|=
literal|0
decl_stmt|;
name|uint64_t
name|tgt
init|=
literal|0
decl_stmt|;
name|int
name|curlen
decl_stmt|;
name|int
function_decl|(
modifier|*
name|lookup
function_decl|)
parameter_list|(
name|void
modifier|*
parameter_list|,
name|uint64_t
parameter_list|,
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
name|int
name|i
decl_stmt|;
name|int64_t
name|sv
decl_stmt|;
name|uint64_t
name|usv
decl_stmt|,
name|mask
decl_stmt|,
name|save_mask
decl_stmt|,
name|save_usv
decl_stmt|;
specifier|static
name|uint64_t
name|masks
index|[]
init|=
block|{
literal|0xffU
block|,
literal|0xffffU
block|,
literal|0xffffffffU
block|,
literal|0xffffffffffffffffULL
block|}
decl_stmt|;
name|save_usv
operator|=
literal|0
expr_stmt|;
name|dis
operator|->
name|d86_sprintf_func
argument_list|(
name|buf
argument_list|,
name|buflen
argument_list|,
literal|"%-6s "
argument_list|,
name|dis
operator|->
name|d86_mnem
argument_list|)
expr_stmt|;
comment|/* 	 * For PC-relative jumps, the pc is really the next pc after executing 	 * this instruction, so increment it appropriately. 	 */
name|pc
operator|+=
name|dis
operator|->
name|d86_len
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|dis
operator|->
name|d86_numopnds
condition|;
name|i
operator|++
control|)
block|{
name|d86opnd_t
modifier|*
name|op
init|=
operator|&
name|dis
operator|->
name|d86_opnd
index|[
name|i
index|]
decl_stmt|;
if|if
condition|(
name|i
operator|!=
literal|0
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|buf
argument_list|,
literal|","
argument_list|,
name|buflen
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|buf
argument_list|,
name|op
operator|->
name|d86_prefix
argument_list|,
name|buflen
argument_list|)
expr_stmt|;
comment|/* 		 * sv is for the signed, possibly-truncated immediate or 		 * displacement; usv retains the original size and 		 * unsignedness for symbol lookup. 		 */
name|sv
operator|=
name|usv
operator|=
name|op
operator|->
name|d86_value
expr_stmt|;
comment|/* 		 * About masks: for immediates that represent 		 * addresses, the appropriate display size is 		 * the effective address size of the instruction. 		 * This includes MODE_OFFSET, MODE_IPREL, and 		 * MODE_RIPREL.  Immediates that are simply 		 * immediate values should display in the operand's 		 * size, however, since they don't represent addresses. 		 */
comment|/* d86_addr_size is SIZEnn, which is log2(real size) */
name|mask
operator|=
name|masks
index|[
name|dis
operator|->
name|d86_addr_size
index|]
expr_stmt|;
comment|/* d86_value_size and d86_imm_bytes are in bytes */
if|if
condition|(
name|op
operator|->
name|d86_mode
operator|==
name|MODE_SIGNED
operator|||
name|op
operator|->
name|d86_mode
operator|==
name|MODE_IMPLIED
condition|)
name|mask
operator|=
name|masks
index|[
name|log2
argument_list|(
name|op
operator|->
name|d86_value_size
argument_list|)
index|]
expr_stmt|;
switch|switch
condition|(
name|op
operator|->
name|d86_mode
condition|)
block|{
case|case
name|MODE_NONE
case|:
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|buf
argument_list|,
name|op
operator|->
name|d86_opnd
argument_list|,
name|buflen
argument_list|)
expr_stmt|;
break|break;
case|case
name|MODE_SIGNED
case|:
case|case
name|MODE_IMPLIED
case|:
case|case
name|MODE_OFFSET
case|:
name|tgt
operator|=
name|usv
expr_stmt|;
if|if
condition|(
name|dis
operator|->
name|d86_seg_prefix
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|buf
argument_list|,
name|dis
operator|->
name|d86_seg_prefix
argument_list|,
name|buflen
argument_list|)
expr_stmt|;
if|if
condition|(
name|op
operator|->
name|d86_mode
operator|==
name|MODE_SIGNED
operator|||
name|op
operator|->
name|d86_mode
operator|==
name|MODE_IMPLIED
condition|)
block|{
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|buf
argument_list|,
literal|"$"
argument_list|,
name|buflen
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|print_imm
argument_list|(
name|dis
argument_list|,
name|usv
argument_list|,
name|mask
argument_list|,
name|buf
argument_list|,
name|buflen
argument_list|,
name|IMM
argument_list|,
name|TRY_NEG
argument_list|)
operator|&&
operator|(
name|op
operator|->
name|d86_mode
operator|==
name|MODE_SIGNED
operator|||
name|op
operator|->
name|d86_mode
operator|==
name|MODE_IMPLIED
operator|)
condition|)
block|{
comment|/* 				 * We printed a negative value for an 				 * immediate that wasn't a 				 * displacement.  Note that fact so we can 				 * print the positive value as an 				 * annotation. 				 */
name|save_usv
operator|=
name|usv
expr_stmt|;
name|save_mask
operator|=
name|mask
expr_stmt|;
block|}
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|buf
argument_list|,
name|op
operator|->
name|d86_opnd
argument_list|,
name|buflen
argument_list|)
expr_stmt|;
break|break;
case|case
name|MODE_IPREL
case|:
case|case
name|MODE_RIPREL
case|:
name|reltgt
operator|=
name|pc
operator|+
name|sv
expr_stmt|;
switch|switch
condition|(
name|mode
condition|)
block|{
case|case
name|SIZE16
case|:
name|reltgt
operator|=
operator|(
name|uint16_t
operator|)
name|reltgt
expr_stmt|;
break|break;
case|case
name|SIZE32
case|:
name|reltgt
operator|=
operator|(
name|uint32_t
operator|)
name|reltgt
expr_stmt|;
break|break;
block|}
operator|(
name|void
operator|)
name|print_imm
argument_list|(
name|dis
argument_list|,
name|usv
argument_list|,
name|mask
argument_list|,
name|buf
argument_list|,
name|buflen
argument_list|,
name|DISP
argument_list|,
name|TRY_NEG
argument_list|)
expr_stmt|;
if|if
condition|(
name|op
operator|->
name|d86_mode
operator|==
name|MODE_RIPREL
condition|)
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|buf
argument_list|,
literal|"(%rip)"
argument_list|,
name|buflen
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
comment|/* 	 * The symbol lookups may result in false positives, 	 * particularly on object files, where small numbers may match 	 * the 0-relative non-relocated addresses of symbols. 	 */
name|lookup
operator|=
name|dis
operator|->
name|d86_sym_lookup
expr_stmt|;
if|if
condition|(
name|tgt
operator|!=
literal|0
condition|)
block|{
if|if
condition|(
operator|(
name|dis
operator|->
name|d86_flags
operator|&
name|DIS_F_NOIMMSYM
operator|)
operator|==
literal|0
operator|&&
name|lookup
argument_list|(
name|dis
operator|->
name|d86_data
argument_list|,
name|tgt
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|buf
argument_list|,
literal|"\t<"
argument_list|,
name|buflen
argument_list|)
expr_stmt|;
name|curlen
operator|=
name|strlen
argument_list|(
name|buf
argument_list|)
expr_stmt|;
name|lookup
argument_list|(
name|dis
operator|->
name|d86_data
argument_list|,
name|tgt
argument_list|,
name|buf
operator|+
name|curlen
argument_list|,
name|buflen
operator|-
name|curlen
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|buf
argument_list|,
literal|">"
argument_list|,
name|buflen
argument_list|)
expr_stmt|;
block|}
comment|/* 		 * If we printed a negative immediate above, print the 		 * positive in case our heuristic was unhelpful 		 */
if|if
condition|(
name|save_usv
condition|)
block|{
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|buf
argument_list|,
literal|"\t<"
argument_list|,
name|buflen
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|print_imm
argument_list|(
name|dis
argument_list|,
name|save_usv
argument_list|,
name|save_mask
argument_list|,
name|buf
argument_list|,
name|buflen
argument_list|,
name|IMM
argument_list|,
name|POS
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|buf
argument_list|,
literal|">"
argument_list|,
name|buflen
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|reltgt
operator|!=
literal|0
condition|)
block|{
comment|/* Print symbol or effective address for reltgt */
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|buf
argument_list|,
literal|"\t<"
argument_list|,
name|buflen
argument_list|)
expr_stmt|;
name|curlen
operator|=
name|strlen
argument_list|(
name|buf
argument_list|)
expr_stmt|;
name|lookup
argument_list|(
name|dis
operator|->
name|d86_data
argument_list|,
name|reltgt
argument_list|,
name|buf
operator|+
name|curlen
argument_list|,
name|buflen
operator|-
name|curlen
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strlcat
argument_list|(
name|buf
argument_list|,
literal|">"
argument_list|,
name|buflen
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* DIS_TEXT */
end_comment

end_unit

