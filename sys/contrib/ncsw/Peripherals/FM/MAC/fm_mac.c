begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* Copyright (c) 2008-2011 Freescale Semiconductor, Inc.  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions are met:  *     * Redistributions of source code must retain the above copyright  *       notice, this list of conditions and the following disclaimer.  *     * Redistributions in binary form must reproduce the above copyright  *       notice, this list of conditions and the following disclaimer in the  *       documentation and/or other materials provided with the distribution.  *     * Neither the name of Freescale Semiconductor nor the  *       names of its contributors may be used to endorse or promote products  *       derived from this software without specific prior written permission.  *  *  * ALTERNATIVELY, this software may be distributed under the terms of the  * GNU General Public License ("GPL") as published by the Free Software  * Foundation, either version 2 of that License or (at your option) any  * later version.  *  * THIS SOFTWARE IS PROVIDED BY Freescale Semiconductor ``AS IS'' AND ANY  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED  * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE  * DISCLAIMED. IN NO EVENT SHALL Freescale Semiconductor BE LIABLE FOR ANY  * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES  * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND  * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS  * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  */
end_comment

begin_comment
comment|/******************************************************************************  @File          fm_mac.c   @Description   FM MAC ... */
end_comment

begin_comment
comment|/***************************************************************************/
end_comment

begin_include
include|#
directive|include
file|"std_ext.h"
end_include

begin_include
include|#
directive|include
file|"string_ext.h"
end_include

begin_include
include|#
directive|include
file|"sprint_ext.h"
end_include

begin_include
include|#
directive|include
file|"error_ext.h"
end_include

begin_include
include|#
directive|include
file|"fm_ext.h"
end_include

begin_include
include|#
directive|include
file|"fm_common.h"
end_include

begin_include
include|#
directive|include
file|"fm_mac.h"
end_include

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Handle
name|FM_MAC_Config
parameter_list|(
name|t_FmMacParams
modifier|*
name|p_FmMacParam
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
decl_stmt|;
name|SANITY_CHECK_RETURN_VALUE
argument_list|(
name|p_FmMacParam
argument_list|,
name|E_INVALID_HANDLE
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
if|if
condition|(
name|ENET_SPEED_FROM_MODE
argument_list|(
name|p_FmMacParam
operator|->
name|enetMode
argument_list|)
operator|<
name|e_ENET_SPEED_10000
condition|)
name|p_FmMacControllerDriver
operator|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|DTSEC_Config
argument_list|(
name|p_FmMacParam
argument_list|)
expr_stmt|;
else|else
name|p_FmMacControllerDriver
operator|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|TGEC_Config
argument_list|(
name|p_FmMacParam
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|p_FmMacControllerDriver
condition|)
return|return
name|NULL
return|;
name|p_FmMacControllerDriver
operator|->
name|h_Fm
operator|=
name|p_FmMacParam
operator|->
name|h_Fm
expr_stmt|;
name|p_FmMacControllerDriver
operator|->
name|enetMode
operator|=
name|p_FmMacParam
operator|->
name|enetMode
expr_stmt|;
name|p_FmMacControllerDriver
operator|->
name|macId
operator|=
name|p_FmMacParam
operator|->
name|macId
expr_stmt|;
name|p_FmMacControllerDriver
operator|->
name|resetOnInit
operator|=
name|DEFAULT_resetOnInit
expr_stmt|;
return|return
operator|(
name|t_Handle
operator|)
name|p_FmMacControllerDriver
return|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_Init
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|resetOnInit
operator|&&
operator|(
name|FmResetMac
argument_list|(
name|p_FmMacControllerDriver
operator|->
name|h_Fm
argument_list|,
operator|(
operator|(
name|ENET_INTERFACE_FROM_MODE
argument_list|(
name|p_FmMacControllerDriver
operator|->
name|enetMode
argument_list|)
operator|==
name|e_ENET_IF_XGMII
operator|)
condition|?
name|e_FM_MAC_10G
else|:
name|e_FM_MAC_1G
operator|)
argument_list|,
name|p_FmMacControllerDriver
operator|->
name|macId
argument_list|)
operator|!=
name|E_OK
operator|)
condition|)
name|RETURN_ERROR
argument_list|(
name|MAJOR
argument_list|,
name|E_INVALID_STATE
argument_list|,
operator|(
literal|"Can't reset MAC!"
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|p_FmMacControllerDriver
operator|->
name|clkFreq
operator|=
name|FmGetClockFreq
argument_list|(
name|p_FmMacControllerDriver
operator|->
name|h_Fm
argument_list|)
operator|)
operator|==
literal|0
condition|)
name|RETURN_ERROR
argument_list|(
name|MAJOR
argument_list|,
name|E_INVALID_STATE
argument_list|,
operator|(
literal|"Can't get clock for MAC!"
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_Init
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_Init
argument_list|(
name|h_FmMac
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_Free
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_Free
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_Free
argument_list|(
name|h_FmMac
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_ConfigResetOnInit
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|bool
name|enable
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|p_FmMacControllerDriver
operator|->
name|resetOnInit
operator|=
name|enable
expr_stmt|;
return|return
name|E_OK
return|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_ConfigLoopback
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|bool
name|newVal
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ConfigLoopback
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ConfigLoopback
argument_list|(
name|h_FmMac
argument_list|,
name|newVal
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_ConfigMaxFrameLength
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|uint16_t
name|newVal
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ConfigMaxFrameLength
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ConfigMaxFrameLength
argument_list|(
name|h_FmMac
argument_list|,
name|newVal
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_ConfigWan
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|bool
name|flag
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ConfigWan
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ConfigWan
argument_list|(
name|h_FmMac
argument_list|,
name|flag
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_ConfigPadAndCrc
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|bool
name|newVal
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ConfigPadAndCrc
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ConfigPadAndCrc
argument_list|(
name|h_FmMac
argument_list|,
name|newVal
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_ConfigHalfDuplex
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|bool
name|newVal
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ConfigHalfDuplex
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ConfigHalfDuplex
argument_list|(
name|h_FmMac
argument_list|,
name|newVal
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_ConfigLengthCheck
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|bool
name|newVal
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ConfigLengthCheck
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ConfigLengthCheck
argument_list|(
name|h_FmMac
argument_list|,
name|newVal
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_ConfigException
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|e_FmMacExceptions
name|ex
parameter_list|,
name|bool
name|enable
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ConfigException
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ConfigException
argument_list|(
name|h_FmMac
argument_list|,
name|ex
argument_list|,
name|enable
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|FM_TX_ECC_FRMS_ERRATA_10GMAC_A004
end_ifdef

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_ConfigSkipFman11Workaround
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ConfigSkipFman11Workaround
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ConfigSkipFman11Workaround
argument_list|(
name|h_FmMac
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* FM_TX_ECC_FRMS_ERRATA_10GMAC_A004 */
end_comment

begin_comment
comment|/*****************************************************************************/
end_comment

begin_comment
comment|/* Run Time Control                                                          */
end_comment

begin_comment
comment|/*****************************************************************************/
end_comment

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_Enable
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|e_CommMode
name|mode
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_Enable
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_Enable
argument_list|(
name|h_FmMac
argument_list|,
name|mode
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_Disable
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|e_CommMode
name|mode
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_Disable
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_Disable
argument_list|(
name|h_FmMac
argument_list|,
name|mode
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_Enable1588TimeStamp
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_Enable1588TimeStamp
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_Enable1588TimeStamp
argument_list|(
name|h_FmMac
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_Disable1588TimeStamp
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_Disable1588TimeStamp
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_Disable1588TimeStamp
argument_list|(
name|h_FmMac
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_SetTxAutoPauseFrames
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|uint16_t
name|pauseTime
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_SetTxAutoPauseFrames
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_SetTxAutoPauseFrames
argument_list|(
name|h_FmMac
argument_list|,
name|pauseTime
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_SetRxIgnorePauseFrames
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|bool
name|en
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_SetRxIgnorePauseFrames
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_SetRxIgnorePauseFrames
argument_list|(
name|h_FmMac
argument_list|,
name|en
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_ResetCounters
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ResetCounters
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ResetCounters
argument_list|(
name|h_FmMac
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_SetException
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|e_FmMacExceptions
name|ex
parameter_list|,
name|bool
name|enable
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_SetException
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_SetException
argument_list|(
name|h_FmMac
argument_list|,
name|ex
argument_list|,
name|enable
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_SetStatistics
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|e_FmMacStatisticsLevel
name|statisticsLevel
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_SetStatistics
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_SetStatistics
argument_list|(
name|h_FmMac
argument_list|,
name|statisticsLevel
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_GetStatistics
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|t_FmMacStatistics
modifier|*
name|p_Statistics
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_GetStatistics
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_GetStatistics
argument_list|(
name|h_FmMac
argument_list|,
name|p_Statistics
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_ModifyMacAddr
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|t_EnetAddr
modifier|*
name|p_EnetAddr
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ModifyMacAddr
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_ModifyMacAddr
argument_list|(
name|h_FmMac
argument_list|,
name|p_EnetAddr
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_AddHashMacAddr
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|t_EnetAddr
modifier|*
name|p_EnetAddr
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_AddHashMacAddr
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_AddHashMacAddr
argument_list|(
name|h_FmMac
argument_list|,
name|p_EnetAddr
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_RemoveHashMacAddr
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|t_EnetAddr
modifier|*
name|p_EnetAddr
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_RemoveHashMacAddr
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_RemoveHashMacAddr
argument_list|(
name|h_FmMac
argument_list|,
name|p_EnetAddr
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_AddExactMatchMacAddr
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|t_EnetAddr
modifier|*
name|p_EnetAddr
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_AddExactMatchMacAddr
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_AddExactMatchMacAddr
argument_list|(
name|h_FmMac
argument_list|,
name|p_EnetAddr
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_RemovelExactMatchMacAddr
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|t_EnetAddr
modifier|*
name|p_EnetAddr
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_RemovelExactMatchMacAddr
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_RemovelExactMatchMacAddr
argument_list|(
name|h_FmMac
argument_list|,
name|p_EnetAddr
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_GetVesrion
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|uint32_t
modifier|*
name|macVresion
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_GetVersion
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_GetVersion
argument_list|(
name|h_FmMac
argument_list|,
name|macVresion
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_GetId
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|uint32_t
modifier|*
name|macId
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_GetId
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_GetId
argument_list|(
name|h_FmMac
argument_list|,
name|macId
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_SetPromiscuous
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|bool
name|newVal
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_SetPromiscuous
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_SetPromiscuous
argument_list|(
name|h_FmMac
argument_list|,
name|newVal
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_AdjustLink
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|e_EnetSpeed
name|speed
parameter_list|,
name|bool
name|fullDuplex
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_AdjustLink
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_AdjustLink
argument_list|(
name|h_FmMac
argument_list|,
name|speed
argument_list|,
name|fullDuplex
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_MII_WritePhyReg
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|uint8_t
name|phyAddr
parameter_list|,
name|uint8_t
name|reg
parameter_list|,
name|uint16_t
name|data
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_MII_WritePhyReg
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_MII_WritePhyReg
argument_list|(
name|h_FmMac
argument_list|,
name|phyAddr
argument_list|,
name|reg
argument_list|,
name|data
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|t_Error
name|FM_MAC_MII_ReadPhyReg
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|,
name|uint8_t
name|phyAddr
parameter_list|,
name|uint8_t
name|reg
parameter_list|,
name|uint16_t
modifier|*
name|p_Data
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_MII_ReadPhyReg
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_MII_ReadPhyReg
argument_list|(
name|h_FmMac
argument_list|,
name|phyAddr
argument_list|,
name|reg
argument_list|,
name|p_Data
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ........................................................................... */
end_comment

begin_function
name|uint16_t
name|FM_MAC_GetMaxFrameLength
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_VALUE
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_GetMaxFrameLength
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_GetMaxFrameLength
argument_list|(
name|h_FmMac
argument_list|)
return|;
name|REPORT_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_if
if|#
directive|if
operator|(
name|defined
argument_list|(
name|DEBUG_ERRORS
argument_list|)
operator|&&
operator|(
name|DEBUG_ERRORS
operator|>
literal|0
operator|)
operator|)
end_if

begin_comment
comment|/*****************************************************************************/
end_comment

begin_function
name|t_Error
name|FM_MAC_DumpRegs
parameter_list|(
name|t_Handle
name|h_FmMac
parameter_list|)
block|{
name|t_FmMacControllerDriver
modifier|*
name|p_FmMacControllerDriver
init|=
operator|(
name|t_FmMacControllerDriver
operator|*
operator|)
name|h_FmMac
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacControllerDriver
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_DumpRegs
condition|)
return|return
name|p_FmMacControllerDriver
operator|->
name|f_FM_MAC_DumpRegs
argument_list|(
name|h_FmMac
argument_list|)
return|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* (defined(DEBUG_ERRORS)&& ... */
end_comment

end_unit

