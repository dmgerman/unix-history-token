begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright 2008-2015 Freescale Semiconductor Inc.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions are met:  *     * Redistributions of source code must retain the above copyright  *       notice, this list of conditions and the following disclaimer.  *     * Redistributions in binary form must reproduce the above copyright  *       notice, this list of conditions and the following disclaimer in the  *       documentation and/or other materials provided with the distribution.  *     * Neither the name of Freescale Semiconductor nor the  *       names of its contributors may be used to endorse or promote products  *       derived from this software without specific prior written permission.  *  *  * ALTERNATIVELY, this software may be distributed under the terms of the  * GNU General Public License ("GPL") as published by the Free Software  * Foundation, either version 2 of that License or (at your option) any  * later version.  *  * THIS SOFTWARE IS PROVIDED BY Freescale Semiconductor ``AS IS'' AND ANY  * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED  * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE  * DISCLAIMED. IN NO EVENT SHALL Freescale Semiconductor BE LIABLE FOR ANY  * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES  * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND  * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS  * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  */
end_comment

begin_comment
comment|/******************************************************************************  @File          fm_macsec_secy.c   @Description   FM MACSEC SECY driver routines implementation. */
end_comment

begin_comment
comment|/***************************************************************************/
end_comment

begin_include
include|#
directive|include
file|"std_ext.h"
end_include

begin_include
include|#
directive|include
file|"error_ext.h"
end_include

begin_include
include|#
directive|include
file|"xx_ext.h"
end_include

begin_include
include|#
directive|include
file|"string_ext.h"
end_include

begin_include
include|#
directive|include
file|"sprint_ext.h"
end_include

begin_include
include|#
directive|include
file|"fm_macsec_secy.h"
end_include

begin_comment
comment|/****************************************/
end_comment

begin_comment
comment|/*       static functions               */
end_comment

begin_comment
comment|/****************************************/
end_comment

begin_function
specifier|static
name|void
name|FmMacsecSecYExceptionsIsr
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|uint32_t
name|id
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|UNUSED
argument_list|(
name|id
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacsecSecY
operator|->
name|exceptions
operator|&
name|FM_MACSEC_SECY_EX_FRAME_DISCARDED
condition|)
name|p_FmMacsecSecY
operator|->
name|f_Exception
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_App
argument_list|,
name|e_FM_MACSEC_SECY_EX_FRAME_DISCARDED
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|FmMacsecSecYEventsIsr
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|uint32_t
name|id
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|UNUSED
argument_list|(
name|id
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacsecSecY
operator|->
name|events
operator|&
name|FM_MACSEC_SECY_EV_NEXT_PN
condition|)
name|p_FmMacsecSecY
operator|->
name|f_Event
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_App
argument_list|,
name|e_FM_MACSEC_SECY_EV_NEXT_PN
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|t_Error
name|CheckFmMacsecSecYParameters
parameter_list|(
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
parameter_list|)
block|{
if|if
condition|(
operator|!
name|p_FmMacsecSecY
operator|->
name|f_Exception
condition|)
name|RETURN_ERROR
argument_list|(
name|MAJOR
argument_list|,
name|E_INVALID_VALUE
argument_list|,
operator|(
literal|"Exceptions callback not provided"
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|p_FmMacsecSecY
operator|->
name|f_Event
condition|)
name|RETURN_ERROR
argument_list|(
name|MAJOR
argument_list|,
name|E_INVALID_VALUE
argument_list|,
operator|(
literal|"Events callback not provided"
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|p_FmMacsecSecY
operator|->
name|numOfRxSc
condition|)
name|RETURN_ERROR
argument_list|(
name|MAJOR
argument_list|,
name|E_INVALID_VALUE
argument_list|,
operator|(
literal|"Num of Rx Scs must be greater than '0'"
operator|)
argument_list|)
expr_stmt|;
return|return
name|E_OK
return|;
block|}
end_function

begin_function
specifier|static
name|t_Handle
name|FmMacsecSecYCreateSc
parameter_list|(
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
parameter_list|,
name|macsecSCI_t
name|sci
parameter_list|,
name|e_FmMacsecSecYCipherSuite
name|cipherSuite
parameter_list|,
name|e_ScType
name|type
parameter_list|)
block|{
name|t_SecYSc
modifier|*
name|p_ScTable
decl_stmt|;
name|void
modifier|*
name|p_Params
decl_stmt|;
name|uint32_t
name|numOfSc
decl_stmt|,
name|i
decl_stmt|;
name|t_Error
name|err
init|=
name|E_OK
decl_stmt|;
name|t_RxScParams
name|rxScParams
decl_stmt|;
name|t_TxScParams
name|txScParams
decl_stmt|;
name|ASSERT_COND
argument_list|(
name|p_FmMacsecSecY
argument_list|)
expr_stmt|;
name|ASSERT_COND
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|)
expr_stmt|;
if|if
condition|(
name|type
operator|==
name|e_SC_RX
condition|)
block|{
name|memset
argument_list|(
operator|&
name|rxScParams
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|rxScParams
argument_list|)
argument_list|)
expr_stmt|;
name|i
operator|=
operator|(
name|NUM_OF_RX_SC
operator|-
literal|1
operator|)
expr_stmt|;
name|p_ScTable
operator|=
name|p_FmMacsecSecY
operator|->
name|p_RxSc
expr_stmt|;
name|numOfSc
operator|=
name|p_FmMacsecSecY
operator|->
name|numOfRxSc
expr_stmt|;
name|rxScParams
operator|.
name|confidentialityOffset
operator|=
name|p_FmMacsecSecY
operator|->
name|confidentialityOffset
expr_stmt|;
name|rxScParams
operator|.
name|replayProtect
operator|=
name|p_FmMacsecSecY
operator|->
name|replayProtect
expr_stmt|;
name|rxScParams
operator|.
name|replayWindow
operator|=
name|p_FmMacsecSecY
operator|->
name|replayWindow
expr_stmt|;
name|rxScParams
operator|.
name|validateFrames
operator|=
name|p_FmMacsecSecY
operator|->
name|validateFrames
expr_stmt|;
name|rxScParams
operator|.
name|cipherSuite
operator|=
name|cipherSuite
expr_stmt|;
name|p_Params
operator|=
operator|&
name|rxScParams
expr_stmt|;
block|}
else|else
block|{
name|memset
argument_list|(
operator|&
name|txScParams
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|txScParams
argument_list|)
argument_list|)
expr_stmt|;
name|i
operator|=
operator|(
name|NUM_OF_TX_SC
operator|-
literal|1
operator|)
expr_stmt|;
name|p_ScTable
operator|=
name|p_FmMacsecSecY
operator|->
name|p_TxSc
expr_stmt|;
name|numOfSc
operator|=
name|p_FmMacsecSecY
operator|->
name|numOfTxSc
expr_stmt|;
name|txScParams
operator|.
name|sciInsertionMode
operator|=
name|p_FmMacsecSecY
operator|->
name|sciInsertionMode
expr_stmt|;
name|txScParams
operator|.
name|protectFrames
operator|=
name|p_FmMacsecSecY
operator|->
name|protectFrames
expr_stmt|;
name|txScParams
operator|.
name|confidentialityEnable
operator|=
name|p_FmMacsecSecY
operator|->
name|confidentialityEnable
expr_stmt|;
name|txScParams
operator|.
name|confidentialityOffset
operator|=
name|p_FmMacsecSecY
operator|->
name|confidentialityOffset
expr_stmt|;
name|txScParams
operator|.
name|cipherSuite
operator|=
name|cipherSuite
expr_stmt|;
name|p_Params
operator|=
operator|&
name|txScParams
expr_stmt|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|numOfSc
condition|;
name|i
operator|++
control|)
if|if
condition|(
operator|!
name|p_ScTable
index|[
name|i
index|]
operator|.
name|inUse
condition|)
break|break;
if|if
condition|(
name|i
operator|==
name|numOfSc
condition|)
block|{
name|REPORT_ERROR
argument_list|(
name|MAJOR
argument_list|,
name|E_FULL
argument_list|,
operator|(
literal|"FM MACSEC SECY SC"
operator|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
name|type
operator|==
name|e_SC_RX
condition|)
block|{
operator|(
operator|(
name|t_RxScParams
operator|*
operator|)
name|p_Params
operator|)
operator|->
name|scId
operator|=
name|p_ScTable
index|[
name|i
index|]
operator|.
name|scId
expr_stmt|;
operator|(
operator|(
name|t_RxScParams
operator|*
operator|)
name|p_Params
operator|)
operator|->
name|sci
operator|=
name|sci
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecCreateRxSc
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
operator|(
name|t_RxScParams
operator|*
operator|)
name|p_Params
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
block|{
name|REPORT_ERROR
argument_list|(
name|MAJOR
argument_list|,
name|E_NO_MEMORY
argument_list|,
operator|(
literal|"FM MACSEC SECY RX SC"
operator|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
block|}
else|else
block|{
operator|(
operator|(
name|t_TxScParams
operator|*
operator|)
name|p_Params
operator|)
operator|->
name|scId
operator|=
name|p_ScTable
index|[
name|i
index|]
operator|.
name|scId
expr_stmt|;
operator|(
operator|(
name|t_TxScParams
operator|*
operator|)
name|p_Params
operator|)
operator|->
name|sci
operator|=
name|sci
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecCreateTxSc
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
operator|(
name|t_TxScParams
operator|*
operator|)
name|p_Params
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
block|{
name|REPORT_ERROR
argument_list|(
name|MAJOR
argument_list|,
name|E_NO_MEMORY
argument_list|,
operator|(
literal|"FM MACSEC SECY TX SC"
operator|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
block|}
name|p_ScTable
index|[
name|i
index|]
operator|.
name|inUse
operator|=
name|TRUE
expr_stmt|;
return|return
operator|&
name|p_ScTable
index|[
name|i
index|]
return|;
block|}
end_function

begin_function
specifier|static
name|t_Error
name|FmMacsecSecYDeleteSc
parameter_list|(
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
parameter_list|,
name|t_SecYSc
modifier|*
name|p_FmSecYSc
parameter_list|,
name|e_ScType
name|type
parameter_list|)
block|{
name|t_Error
name|err
init|=
name|E_OK
decl_stmt|;
name|ASSERT_COND
argument_list|(
name|p_FmMacsecSecY
argument_list|)
expr_stmt|;
name|ASSERT_COND
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|)
expr_stmt|;
name|ASSERT_COND
argument_list|(
name|p_FmSecYSc
argument_list|)
expr_stmt|;
if|if
condition|(
name|type
operator|==
name|e_SC_RX
condition|)
block|{
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecDeleteRxSc
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecDeleteTxSc
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
name|p_FmSecYSc
operator|->
name|inUse
operator|=
name|FALSE
expr_stmt|;
return|return
name|err
return|;
block|}
end_function

begin_comment
comment|/****************************************/
end_comment

begin_comment
comment|/*       API Init unit functions        */
end_comment

begin_comment
comment|/****************************************/
end_comment

begin_function
name|t_Handle
name|FM_MACSEC_SECY_Config
parameter_list|(
name|t_FmMacsecSecYParams
modifier|*
name|p_FmMacsecSecYParam
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
decl_stmt|;
comment|/* Allocate FM MACSEC structure */
name|p_FmMacsecSecY
operator|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|XX_Malloc
argument_list|(
sizeof|sizeof
argument_list|(
name|t_FmMacsecSecY
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|p_FmMacsecSecY
condition|)
block|{
name|REPORT_ERROR
argument_list|(
name|MAJOR
argument_list|,
name|E_NO_MEMORY
argument_list|,
operator|(
literal|"FM MACSEC SECY driver structure"
operator|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|memset
argument_list|(
name|p_FmMacsecSecY
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|t_FmMacsecSecY
argument_list|)
argument_list|)
expr_stmt|;
comment|/* Allocate the FM MACSEC driver's parameters structure */
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
operator|=
operator|(
name|t_FmMacsecSecYDriverParam
operator|*
operator|)
name|XX_Malloc
argument_list|(
sizeof|sizeof
argument_list|(
name|t_FmMacsecSecYDriverParam
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
condition|)
block|{
name|XX_Free
argument_list|(
name|p_FmMacsecSecY
argument_list|)
expr_stmt|;
name|REPORT_ERROR
argument_list|(
name|MAJOR
argument_list|,
name|E_NO_MEMORY
argument_list|,
operator|(
literal|"FM MACSEC SECY driver parameters"
operator|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|memset
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|t_FmMacsecSecYDriverParam
argument_list|)
argument_list|)
expr_stmt|;
comment|/* Initialize FM MACSEC SECY parameters which will be kept by the driver */
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
operator|=
name|p_FmMacsecSecYParam
operator|->
name|h_FmMacsec
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|f_Event
operator|=
name|p_FmMacsecSecYParam
operator|->
name|f_Event
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|f_Exception
operator|=
name|p_FmMacsecSecYParam
operator|->
name|f_Exception
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|h_App
operator|=
name|p_FmMacsecSecYParam
operator|->
name|h_App
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|confidentialityEnable
operator|=
name|DEFAULT_confidentialityEnable
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|confidentialityOffset
operator|=
name|DEFAULT_confidentialityOffset
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|validateFrames
operator|=
name|DEFAULT_validateFrames
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|replayProtect
operator|=
name|DEFAULT_replayEnable
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|replayWindow
operator|=
name|DEFAULT_replayWindow
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|protectFrames
operator|=
name|DEFAULT_protectFrames
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|sciInsertionMode
operator|=
name|DEFAULT_sciInsertionMode
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|isPointToPoint
operator|=
name|DEFAULT_ptp
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|numOfRxSc
operator|=
name|p_FmMacsecSecYParam
operator|->
name|numReceiveChannels
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|numOfTxSc
operator|=
name|DEFAULT_numOfTxSc
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|exceptions
operator|=
name|DEFAULT_exceptions
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|events
operator|=
name|DEFAULT_events
expr_stmt|;
name|memcpy
argument_list|(
operator|&
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
operator|->
name|txScParams
argument_list|,
operator|&
name|p_FmMacsecSecYParam
operator|->
name|txScParams
argument_list|,
sizeof|sizeof
argument_list|(
name|t_FmMacsecSecYSCParams
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|p_FmMacsecSecY
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_Init
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|t_FmMacsecSecYDriverParam
modifier|*
name|p_FmMacsecSecYDriverParam
init|=
name|NULL
decl_stmt|;
name|uint32_t
name|rxScIds
index|[
name|NUM_OF_RX_SC
index|]
decl_stmt|,
name|txScIds
index|[
name|NUM_OF_TX_SC
index|]
decl_stmt|,
name|i
decl_stmt|,
name|j
decl_stmt|;
name|t_Error
name|err
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|CHECK_INIT_PARAMETERS
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|CheckFmMacsecSecYParameters
argument_list|)
expr_stmt|;
name|p_FmMacsecSecYDriverParam
operator|=
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
expr_stmt|;
if|if
condition|(
operator|(
name|p_FmMacsecSecY
operator|->
name|isPointToPoint
operator|)
operator|&&
operator|(
operator|(
name|err
operator|=
name|FmMacsecSetPTP
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|TRUE
argument_list|)
operator|)
operator|!=
name|E_OK
operator|)
condition|)
name|RETURN_ERROR
argument_list|(
name|MAJOR
argument_list|,
name|err
argument_list|,
operator|(
literal|"Can't set Poin-to-Point"
operator|)
argument_list|)
expr_stmt|;
comment|/* Rx Sc Allocation */
name|p_FmMacsecSecY
operator|->
name|p_RxSc
operator|=
operator|(
name|t_SecYSc
operator|*
operator|)
name|XX_Malloc
argument_list|(
sizeof|sizeof
argument_list|(
name|t_SecYSc
argument_list|)
operator|*
name|p_FmMacsecSecY
operator|->
name|numOfRxSc
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_RxSc
condition|)
name|RETURN_ERROR
argument_list|(
name|MAJOR
argument_list|,
name|E_NO_MEMORY
argument_list|,
operator|(
literal|"FM MACSEC SECY RX SC"
operator|)
argument_list|)
expr_stmt|;
name|memset
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_RxSc
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|t_SecYSc
argument_list|)
operator|*
name|p_FmMacsecSecY
operator|->
name|numOfRxSc
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecAllocScs
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|e_SC_RX
argument_list|,
name|p_FmMacsecSecY
operator|->
name|isPointToPoint
argument_list|,
name|p_FmMacsecSecY
operator|->
name|numOfRxSc
argument_list|,
name|rxScIds
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
block|{
if|if
condition|(
name|p_FmMacsecSecY
operator|->
name|p_TxSc
condition|)
name|XX_Free
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_TxSc
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacsecSecY
operator|->
name|p_RxSc
condition|)
name|XX_Free
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_RxSc
argument_list|)
expr_stmt|;
return|return
name|ERROR_CODE
argument_list|(
name|err
argument_list|)
return|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|p_FmMacsecSecY
operator|->
name|numOfRxSc
condition|;
name|i
operator|++
control|)
block|{
name|p_FmMacsecSecY
operator|->
name|p_RxSc
index|[
name|i
index|]
operator|.
name|scId
operator|=
name|rxScIds
index|[
name|i
index|]
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|p_RxSc
index|[
name|i
index|]
operator|.
name|type
operator|=
name|e_SC_RX
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|MAX_NUM_OF_SA_PER_SC
condition|;
name|j
operator|++
control|)
name|p_FmMacsecSecY
operator|->
name|p_RxSc
index|[
name|i
index|]
operator|.
name|sa
index|[
name|j
index|]
operator|.
name|saId
operator|=
operator|(
name|e_ScSaId
operator|)
name|SECY_AN_FREE_VALUE
expr_stmt|;
block|}
comment|/* Tx Sc Allocation */
name|p_FmMacsecSecY
operator|->
name|p_TxSc
operator|=
operator|(
name|t_SecYSc
operator|*
operator|)
name|XX_Malloc
argument_list|(
sizeof|sizeof
argument_list|(
name|t_SecYSc
argument_list|)
operator|*
name|p_FmMacsecSecY
operator|->
name|numOfTxSc
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_TxSc
condition|)
name|RETURN_ERROR
argument_list|(
name|MAJOR
argument_list|,
name|E_NO_MEMORY
argument_list|,
operator|(
literal|"FM MACSEC SECY TX SC"
operator|)
argument_list|)
expr_stmt|;
name|memset
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_TxSc
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|t_SecYSc
argument_list|)
operator|*
name|p_FmMacsecSecY
operator|->
name|numOfTxSc
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecAllocScs
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|e_SC_TX
argument_list|,
name|p_FmMacsecSecY
operator|->
name|isPointToPoint
argument_list|,
name|p_FmMacsecSecY
operator|->
name|numOfTxSc
argument_list|,
name|txScIds
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
block|{
if|if
condition|(
name|p_FmMacsecSecY
operator|->
name|p_TxSc
condition|)
name|XX_Free
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_TxSc
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacsecSecY
operator|->
name|p_RxSc
condition|)
name|XX_Free
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_RxSc
argument_list|)
expr_stmt|;
return|return
name|ERROR_CODE
argument_list|(
name|err
argument_list|)
return|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|p_FmMacsecSecY
operator|->
name|numOfTxSc
condition|;
name|i
operator|++
control|)
block|{
name|p_FmMacsecSecY
operator|->
name|p_TxSc
index|[
name|i
index|]
operator|.
name|scId
operator|=
name|txScIds
index|[
name|i
index|]
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|p_TxSc
index|[
name|i
index|]
operator|.
name|type
operator|=
name|e_SC_TX
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|MAX_NUM_OF_SA_PER_SC
condition|;
name|j
operator|++
control|)
name|p_FmMacsecSecY
operator|->
name|p_TxSc
index|[
name|i
index|]
operator|.
name|sa
index|[
name|j
index|]
operator|.
name|saId
operator|=
operator|(
name|e_ScSaId
operator|)
name|SECY_AN_FREE_VALUE
expr_stmt|;
name|FmMacsecRegisterIntr
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|e_FM_MACSEC_MOD_SC_TX
argument_list|,
operator|(
name|uint8_t
operator|)
name|txScIds
index|[
name|i
index|]
argument_list|,
name|e_FM_INTR_TYPE_ERR
argument_list|,
name|FmMacsecSecYExceptionsIsr
argument_list|,
name|p_FmMacsecSecY
argument_list|)
expr_stmt|;
name|FmMacsecRegisterIntr
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|e_FM_MACSEC_MOD_SC_TX
argument_list|,
operator|(
name|uint8_t
operator|)
name|txScIds
index|[
name|i
index|]
argument_list|,
name|e_FM_INTR_TYPE_NORMAL
argument_list|,
name|FmMacsecSecYEventsIsr
argument_list|,
name|p_FmMacsecSecY
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacsecSecY
operator|->
name|exceptions
operator|&
name|FM_MACSEC_SECY_EX_FRAME_DISCARDED
condition|)
name|FmMacsecSetException
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|e_FM_MACSEC_EX_TX_SC
argument_list|,
name|txScIds
index|[
name|i
index|]
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacsecSecY
operator|->
name|events
operator|&
name|FM_MACSEC_SECY_EV_NEXT_PN
condition|)
name|FmMacsecSetEvent
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|e_FM_MACSEC_EV_TX_SC_NEXT_PN
argument_list|,
name|txScIds
index|[
name|i
index|]
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
block|}
name|FmMacsecSecYCreateSc
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|p_FmMacsecSecYDriverParam
operator|->
name|txScParams
operator|.
name|sci
argument_list|,
name|p_FmMacsecSecYDriverParam
operator|->
name|txScParams
operator|.
name|cipherSuite
argument_list|,
name|e_SC_TX
argument_list|)
expr_stmt|;
name|XX_Free
argument_list|(
name|p_FmMacsecSecYDriverParam
argument_list|)
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
operator|=
name|NULL
expr_stmt|;
return|return
name|E_OK
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_Free
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|t_Error
name|err
init|=
name|E_OK
decl_stmt|;
name|uint32_t
name|rxScIds
index|[
name|NUM_OF_RX_SC
index|]
decl_stmt|,
name|txScIds
index|[
name|NUM_OF_TX_SC
index|]
decl_stmt|,
name|i
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacsecSecY
operator|->
name|isPointToPoint
condition|)
name|FmMacsecSetPTP
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacsecSecY
operator|->
name|p_RxSc
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|p_FmMacsecSecY
operator|->
name|numOfRxSc
condition|;
name|i
operator|++
control|)
name|rxScIds
index|[
name|i
index|]
operator|=
name|p_FmMacsecSecY
operator|->
name|p_RxSc
index|[
name|i
index|]
operator|.
name|scId
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecFreeScs
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|e_SC_RX
argument_list|,
name|p_FmMacsecSecY
operator|->
name|numOfRxSc
argument_list|,
name|rxScIds
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
return|return
name|ERROR_CODE
argument_list|(
name|err
argument_list|)
return|;
name|XX_Free
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_RxSc
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|p_FmMacsecSecY
operator|->
name|p_TxSc
condition|)
block|{
name|FmMacsecSecYDeleteSc
argument_list|(
name|p_FmMacsecSecY
argument_list|,
operator|&
name|p_FmMacsecSecY
operator|->
name|p_TxSc
index|[
literal|0
index|]
argument_list|,
name|e_SC_TX
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|p_FmMacsecSecY
operator|->
name|numOfTxSc
condition|;
name|i
operator|++
control|)
block|{
name|txScIds
index|[
name|i
index|]
operator|=
name|p_FmMacsecSecY
operator|->
name|p_TxSc
index|[
name|i
index|]
operator|.
name|scId
expr_stmt|;
name|FmMacsecUnregisterIntr
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|e_FM_MACSEC_MOD_SC_TX
argument_list|,
operator|(
name|uint8_t
operator|)
name|txScIds
index|[
name|i
index|]
argument_list|,
name|e_FM_INTR_TYPE_ERR
argument_list|)
expr_stmt|;
name|FmMacsecUnregisterIntr
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|e_FM_MACSEC_MOD_SC_TX
argument_list|,
operator|(
name|uint8_t
operator|)
name|txScIds
index|[
name|i
index|]
argument_list|,
name|e_FM_INTR_TYPE_NORMAL
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacsecSecY
operator|->
name|exceptions
operator|&
name|FM_MACSEC_SECY_EX_FRAME_DISCARDED
condition|)
name|FmMacsecSetException
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|e_FM_MACSEC_EX_TX_SC
argument_list|,
name|txScIds
index|[
name|i
index|]
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmMacsecSecY
operator|->
name|events
operator|&
name|FM_MACSEC_SECY_EV_NEXT_PN
condition|)
name|FmMacsecSetEvent
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|e_FM_MACSEC_EV_TX_SC_NEXT_PN
argument_list|,
name|txScIds
index|[
name|i
index|]
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecFreeScs
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|e_SC_TX
argument_list|,
name|p_FmMacsecSecY
operator|->
name|numOfTxSc
argument_list|,
name|txScIds
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
return|return
name|ERROR_CODE
argument_list|(
name|err
argument_list|)
return|;
name|XX_Free
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_TxSc
argument_list|)
expr_stmt|;
block|}
name|XX_Free
argument_list|(
name|p_FmMacsecSecY
argument_list|)
expr_stmt|;
return|return
name|err
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_ConfigSciInsertionMode
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|e_FmMacsecSciInsertionMode
name|sciInsertionMode
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|sciInsertionMode
operator|=
name|sciInsertionMode
expr_stmt|;
return|return
name|E_OK
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_ConfigProtectFrames
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|bool
name|protectFrames
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|protectFrames
operator|=
name|protectFrames
expr_stmt|;
return|return
name|E_OK
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_ConfigReplayWindow
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|bool
name|replayProtect
parameter_list|,
name|uint32_t
name|replayWindow
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|replayProtect
operator|=
name|replayProtect
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|replayWindow
operator|=
name|replayWindow
expr_stmt|;
return|return
name|E_OK
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_ConfigValidationMode
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|e_FmMacsecValidFrameBehavior
name|validateFrames
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|validateFrames
operator|=
name|validateFrames
expr_stmt|;
return|return
name|E_OK
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_ConfigConfidentiality
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|bool
name|confidentialityEnable
parameter_list|,
name|uint16_t
name|confidentialityOffset
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|confidentialityEnable
operator|=
name|confidentialityEnable
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|confidentialityOffset
operator|=
name|confidentialityOffset
expr_stmt|;
return|return
name|E_OK
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_ConfigPointToPoint
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|numOfRxSc
operator|=
literal|1
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|isPointToPoint
operator|=
name|TRUE
expr_stmt|;
name|p_FmMacsecSecY
operator|->
name|sciInsertionMode
operator|=
name|e_FM_MACSEC_SCI_INSERTION_MODE_IMPLICT_PTP
expr_stmt|;
return|return
name|E_OK
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_ConfigException
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|e_FmMacsecSecYExceptions
name|exception
parameter_list|,
name|bool
name|enable
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|uint32_t
name|bitMask
init|=
literal|0
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|GET_EXCEPTION_FLAG
argument_list|(
name|bitMask
argument_list|,
name|exception
argument_list|)
expr_stmt|;
if|if
condition|(
name|bitMask
condition|)
block|{
if|if
condition|(
name|enable
condition|)
name|p_FmMacsecSecY
operator|->
name|exceptions
operator||=
name|bitMask
expr_stmt|;
else|else
name|p_FmMacsecSecY
operator|->
name|exceptions
operator|&=
operator|~
name|bitMask
expr_stmt|;
block|}
else|else
name|RETURN_ERROR
argument_list|(
name|MAJOR
argument_list|,
name|E_INVALID_VALUE
argument_list|,
operator|(
literal|"Undefined exception"
operator|)
argument_list|)
expr_stmt|;
return|return
name|E_OK
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_ConfigEvent
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|e_FmMacsecSecYEvents
name|event
parameter_list|,
name|bool
name|enable
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|uint32_t
name|bitMask
init|=
literal|0
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|GET_EVENT_FLAG
argument_list|(
name|bitMask
argument_list|,
name|event
argument_list|)
expr_stmt|;
if|if
condition|(
name|bitMask
condition|)
block|{
if|if
condition|(
name|enable
condition|)
name|p_FmMacsecSecY
operator|->
name|events
operator||=
name|bitMask
expr_stmt|;
else|else
name|p_FmMacsecSecY
operator|->
name|events
operator|&=
operator|~
name|bitMask
expr_stmt|;
block|}
else|else
name|RETURN_ERROR
argument_list|(
name|MAJOR
argument_list|,
name|E_INVALID_VALUE
argument_list|,
operator|(
literal|"Undefined event"
operator|)
argument_list|)
expr_stmt|;
return|return
name|E_OK
return|;
block|}
end_function

begin_function
name|t_Handle
name|FM_MACSEC_SECY_CreateRxSc
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|t_FmMacsecSecYSCParams
modifier|*
name|p_ScParams
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|SANITY_CHECK_RETURN_VALUE
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_VALUE
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|E_INVALID_HANDLE
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_VALUE
argument_list|(
name|p_ScParams
argument_list|,
name|E_NULL_POINTER
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_VALUE
argument_list|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
return|return
name|FmMacsecSecYCreateSc
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|p_ScParams
operator|->
name|sci
argument_list|,
name|p_ScParams
operator|->
name|cipherSuite
argument_list|,
name|e_SC_RX
argument_list|)
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_DeleteRxSc
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|t_Handle
name|h_Sc
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|t_SecYSc
modifier|*
name|p_FmSecYSc
init|=
operator|(
name|t_SecYSc
operator|*
operator|)
name|h_Sc
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmSecYSc
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
return|return
name|FmMacsecSecYDeleteSc
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|p_FmSecYSc
argument_list|,
name|e_SC_RX
argument_list|)
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_CreateRxSa
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|t_Handle
name|h_Sc
parameter_list|,
name|macsecAN_t
name|an
parameter_list|,
name|uint32_t
name|lowestPn
parameter_list|,
name|macsecSAKey_t
name|key
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|t_SecYSc
modifier|*
name|p_FmSecYSc
init|=
operator|(
name|t_SecYSc
operator|*
operator|)
name|h_Sc
decl_stmt|;
name|t_Error
name|err
init|=
name|E_OK
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmSecYSc
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|an
operator|<
name|MAX_NUM_OF_SA_PER_SC
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
operator|!=
name|SECY_AN_FREE_VALUE
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_INVALID_STATE
argument_list|,
operator|(
literal|"An %d is already assigned"
operator|,
name|an
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecCreateRxSa
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|,
operator|(
name|e_ScSaId
operator|)
name|p_FmSecYSc
operator|->
name|numOfSa
argument_list|,
name|an
argument_list|,
name|lowestPn
argument_list|,
name|key
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
operator|=
operator|(
name|e_ScSaId
operator|)
name|p_FmSecYSc
operator|->
name|numOfSa
operator|++
expr_stmt|;
return|return
name|err
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_DeleteRxSa
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|t_Handle
name|h_Sc
parameter_list|,
name|macsecAN_t
name|an
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|t_SecYSc
modifier|*
name|p_FmSecYSc
init|=
operator|(
name|t_SecYSc
operator|*
operator|)
name|h_Sc
decl_stmt|;
name|t_Error
name|err
init|=
name|E_OK
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmSecYSc
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|an
operator|<
name|MAX_NUM_OF_SA_PER_SC
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
operator|==
name|SECY_AN_FREE_VALUE
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_INVALID_STATE
argument_list|,
operator|(
literal|"An %d is already deleted"
operator|,
name|an
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecDeleteRxSa
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|,
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
name|p_FmSecYSc
operator|->
name|numOfSa
operator|--
expr_stmt|;
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
operator|=
operator|(
name|e_ScSaId
operator|)
name|SECY_AN_FREE_VALUE
expr_stmt|;
comment|/* TODO - check if statistics need to be read*/
return|return
name|err
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_RxSaEnableReceive
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|t_Handle
name|h_Sc
parameter_list|,
name|macsecAN_t
name|an
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|t_SecYSc
modifier|*
name|p_FmSecYSc
init|=
operator|(
name|t_SecYSc
operator|*
operator|)
name|h_Sc
decl_stmt|;
name|t_Error
name|err
init|=
name|E_OK
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmSecYSc
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|an
operator|<
name|MAX_NUM_OF_SA_PER_SC
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
operator|==
name|SECY_AN_FREE_VALUE
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_INVALID_STATE
argument_list|,
operator|(
literal|"An %d is not configured"
operator|,
name|an
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecRxSaSetReceive
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|,
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
argument_list|,
name|TRUE
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|active
operator|=
name|TRUE
expr_stmt|;
return|return
name|err
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_RxSaDisableReceive
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|t_Handle
name|h_Sc
parameter_list|,
name|macsecAN_t
name|an
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|t_SecYSc
modifier|*
name|p_FmSecYSc
init|=
operator|(
name|t_SecYSc
operator|*
operator|)
name|h_Sc
decl_stmt|;
name|t_Error
name|err
init|=
name|E_OK
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmSecYSc
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|an
operator|<
name|MAX_NUM_OF_SA_PER_SC
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
operator|==
name|SECY_AN_FREE_VALUE
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_INVALID_STATE
argument_list|,
operator|(
literal|"An %d is not configured"
operator|,
name|an
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecRxSaSetReceive
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|,
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
argument_list|,
name|FALSE
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|active
operator|=
name|FALSE
expr_stmt|;
return|return
name|err
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_RxSaUpdateNextPn
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|t_Handle
name|h_Sc
parameter_list|,
name|macsecAN_t
name|an
parameter_list|,
name|uint32_t
name|updtNextPN
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|t_SecYSc
modifier|*
name|p_FmSecYSc
init|=
operator|(
name|t_SecYSc
operator|*
operator|)
name|h_Sc
decl_stmt|;
name|t_Error
name|err
init|=
name|E_OK
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmSecYSc
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|an
operator|<
name|MAX_NUM_OF_SA_PER_SC
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
operator|==
name|SECY_AN_FREE_VALUE
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_INVALID_STATE
argument_list|,
operator|(
literal|"An %d is not configured"
operator|,
name|an
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecRxSaUpdateNextPn
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|,
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
argument_list|,
name|updtNextPN
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
return|return
name|err
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_RxSaUpdateLowestPn
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|t_Handle
name|h_Sc
parameter_list|,
name|macsecAN_t
name|an
parameter_list|,
name|uint32_t
name|updtLowestPN
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|t_SecYSc
modifier|*
name|p_FmSecYSc
init|=
operator|(
name|t_SecYSc
operator|*
operator|)
name|h_Sc
decl_stmt|;
name|t_Error
name|err
init|=
name|E_OK
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmSecYSc
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|an
operator|<
name|MAX_NUM_OF_SA_PER_SC
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
operator|==
name|SECY_AN_FREE_VALUE
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_INVALID_STATE
argument_list|,
operator|(
literal|"An %d is not configured"
operator|,
name|an
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecRxSaUpdateLowestPn
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|,
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
argument_list|,
name|updtLowestPN
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
return|return
name|err
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_RxSaModifyKey
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|t_Handle
name|h_Sc
parameter_list|,
name|macsecAN_t
name|an
parameter_list|,
name|macsecSAKey_t
name|key
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|t_SecYSc
modifier|*
name|p_FmSecYSc
init|=
operator|(
name|t_SecYSc
operator|*
operator|)
name|h_Sc
decl_stmt|;
name|t_Error
name|err
init|=
name|E_OK
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmSecYSc
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|an
operator|<
name|MAX_NUM_OF_SA_PER_SC
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
operator|==
name|SECY_AN_FREE_VALUE
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_INVALID_STATE
argument_list|,
operator|(
literal|"An %d is not configured"
operator|,
name|an
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|active
condition|)
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecRxSaSetReceive
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|,
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
argument_list|,
name|FALSE
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
comment|/* TODO - statistics should be read */
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecCreateRxSa
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|,
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
argument_list|,
name|an
argument_list|,
literal|1
argument_list|,
name|key
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|active
condition|)
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecRxSaSetReceive
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|,
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
argument_list|,
name|TRUE
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
return|return
name|err
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_CreateTxSa
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|macsecAN_t
name|an
parameter_list|,
name|macsecSAKey_t
name|key
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|t_SecYSc
modifier|*
name|p_FmSecYSc
decl_stmt|;
name|t_Error
name|err
init|=
name|E_OK
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|p_FmSecYSc
operator|=
operator|&
name|p_FmMacsecSecY
operator|->
name|p_TxSc
index|[
literal|0
index|]
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmSecYSc
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|an
operator|<
name|MAX_NUM_OF_SA_PER_SC
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
operator|!=
name|SECY_AN_FREE_VALUE
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
operator|(
literal|"An %d is already assigned"
operator|,
name|an
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecCreateTxSa
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|,
operator|(
name|e_ScSaId
operator|)
name|p_FmSecYSc
operator|->
name|numOfSa
argument_list|,
name|key
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
operator|=
operator|(
name|e_ScSaId
operator|)
name|p_FmSecYSc
operator|->
name|numOfSa
operator|++
expr_stmt|;
return|return
name|err
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_DeleteTxSa
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|macsecAN_t
name|an
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|t_SecYSc
modifier|*
name|p_FmSecYSc
decl_stmt|;
name|t_Error
name|err
init|=
name|E_OK
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|p_FmSecYSc
operator|=
operator|&
name|p_FmMacsecSecY
operator|->
name|p_TxSc
index|[
literal|0
index|]
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmSecYSc
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|an
operator|<
name|MAX_NUM_OF_SA_PER_SC
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
operator|==
name|SECY_AN_FREE_VALUE
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_INVALID_STATE
argument_list|,
operator|(
literal|"An %d is already deleted"
operator|,
name|an
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecDeleteTxSa
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|,
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
name|p_FmSecYSc
operator|->
name|numOfSa
operator|--
expr_stmt|;
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
operator|=
operator|(
name|e_ScSaId
operator|)
name|SECY_AN_FREE_VALUE
expr_stmt|;
comment|/* TODO - check if statistics need to be read*/
return|return
name|err
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_TxSaModifyKey
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|macsecAN_t
name|nextActiveAn
parameter_list|,
name|macsecSAKey_t
name|key
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|t_SecYSc
modifier|*
name|p_FmSecYSc
decl_stmt|;
name|macsecAN_t
name|currentAn
decl_stmt|;
name|t_Error
name|err
init|=
name|E_OK
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|p_FmSecYSc
operator|=
operator|&
name|p_FmMacsecSecY
operator|->
name|p_TxSc
index|[
literal|0
index|]
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmSecYSc
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|nextActiveAn
operator|<
name|MAX_NUM_OF_SA_PER_SC
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecTxSaGetActive
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|,
operator|&
name|currentAn
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecTxSaSetActive
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|,
name|p_FmSecYSc
operator|->
name|sa
index|[
name|nextActiveAn
index|]
operator|.
name|saId
argument_list|,
name|nextActiveAn
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
comment|/* TODO - statistics should be read */
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecCreateTxSa
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|,
name|p_FmSecYSc
operator|->
name|sa
index|[
name|currentAn
index|]
operator|.
name|saId
argument_list|,
name|key
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
return|return
name|err
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_TxSaSetActive
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|macsecAN_t
name|an
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|t_SecYSc
modifier|*
name|p_FmSecYSc
decl_stmt|;
name|t_Error
name|err
init|=
name|E_OK
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|p_FmSecYSc
operator|=
operator|&
name|p_FmMacsecSecY
operator|->
name|p_TxSc
index|[
literal|0
index|]
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmSecYSc
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|an
operator|<
name|MAX_NUM_OF_SA_PER_SC
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
operator|==
name|SECY_AN_FREE_VALUE
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_INVALID_STATE
argument_list|,
operator|(
literal|"An %d is not configured"
operator|,
name|an
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecTxSaSetActive
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|,
name|p_FmSecYSc
operator|->
name|sa
index|[
name|an
index|]
operator|.
name|saId
argument_list|,
name|an
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
return|return
name|err
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_TxSaGetActive
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|macsecAN_t
modifier|*
name|p_An
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|t_SecYSc
modifier|*
name|p_FmSecYSc
decl_stmt|;
name|t_Error
name|err
init|=
name|E_OK
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|p_FmSecYSc
operator|=
operator|&
name|p_FmMacsecSecY
operator|->
name|p_TxSc
index|[
literal|0
index|]
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmSecYSc
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_An
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|FmMacsecTxSaGetActive
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|p_FmSecYSc
operator|->
name|scId
argument_list|,
name|p_An
argument_list|)
operator|)
operator|!=
name|E_OK
condition|)
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|err
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
return|return
name|err
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_GetRxScPhysId
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|t_Handle
name|h_Sc
parameter_list|,
name|uint32_t
modifier|*
name|p_ScPhysId
parameter_list|)
block|{
name|t_SecYSc
modifier|*
name|p_FmSecYSc
init|=
operator|(
name|t_SecYSc
operator|*
operator|)
name|h_Sc
decl_stmt|;
name|t_Error
name|err
init|=
name|E_OK
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|h_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
operator|(
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
operator|)
operator|->
name|h_FmMacsec
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
operator|!
operator|(
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
operator|)
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmSecYSc
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DISABLE_SANITY_CHECKS
name|UNUSED
argument_list|(
name|h_FmMacsecSecY
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* DISABLE_SANITY_CHECKS */
operator|*
name|p_ScPhysId
operator|=
name|p_FmSecYSc
operator|->
name|scId
expr_stmt|;
return|return
name|err
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_GetTxScPhysId
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|uint32_t
modifier|*
name|p_ScPhysId
parameter_list|)
block|{
name|t_FmMacsecSecY
modifier|*
name|p_FmMacsecSecY
init|=
operator|(
name|t_FmMacsecSecY
operator|*
operator|)
name|h_FmMacsecSecY
decl_stmt|;
name|t_SecYSc
modifier|*
name|p_FmSecYSc
decl_stmt|;
name|t_Error
name|err
init|=
name|E_OK
decl_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmMacsecSecY
operator|->
name|h_FmMacsec
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
operator|!
name|p_FmMacsecSecY
operator|->
name|p_FmMacsecSecYDriverParam
argument_list|,
name|E_INVALID_STATE
argument_list|)
expr_stmt|;
name|p_FmSecYSc
operator|=
operator|&
name|p_FmMacsecSecY
operator|->
name|p_TxSc
index|[
literal|0
index|]
expr_stmt|;
name|SANITY_CHECK_RETURN_ERROR
argument_list|(
name|p_FmSecYSc
argument_list|,
name|E_INVALID_HANDLE
argument_list|)
expr_stmt|;
operator|*
name|p_ScPhysId
operator|=
name|p_FmSecYSc
operator|->
name|scId
expr_stmt|;
return|return
name|err
return|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_SetException
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|e_FmMacsecExceptions
name|exception
parameter_list|,
name|bool
name|enable
parameter_list|)
block|{
name|UNUSED
argument_list|(
name|h_FmMacsecSecY
argument_list|)
expr_stmt|;
name|UNUSED
argument_list|(
name|exception
argument_list|)
expr_stmt|;
name|UNUSED
argument_list|(
name|enable
argument_list|)
expr_stmt|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_SetEvent
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|e_FmMacsecSecYEvents
name|event
parameter_list|,
name|bool
name|enable
parameter_list|)
block|{
name|UNUSED
argument_list|(
name|h_FmMacsecSecY
argument_list|)
expr_stmt|;
name|UNUSED
argument_list|(
name|event
argument_list|)
expr_stmt|;
name|UNUSED
argument_list|(
name|enable
argument_list|)
expr_stmt|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_GetStatistics
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|t_FmMacsecSecYStatistics
modifier|*
name|p_Statistics
parameter_list|)
block|{
name|UNUSED
argument_list|(
name|h_FmMacsecSecY
argument_list|)
expr_stmt|;
name|UNUSED
argument_list|(
name|p_Statistics
argument_list|)
expr_stmt|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_RxScGetStatistics
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|t_Handle
name|h_Sc
parameter_list|,
name|t_FmMacsecSecYRxScStatistics
modifier|*
name|p_Statistics
parameter_list|)
block|{
name|UNUSED
argument_list|(
name|h_FmMacsecSecY
argument_list|)
expr_stmt|;
name|UNUSED
argument_list|(
name|h_Sc
argument_list|)
expr_stmt|;
name|UNUSED
argument_list|(
name|p_Statistics
argument_list|)
expr_stmt|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_RxSaGetStatistics
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|t_Handle
name|h_Sc
parameter_list|,
name|macsecAN_t
name|an
parameter_list|,
name|t_FmMacsecSecYRxSaStatistics
modifier|*
name|p_Statistics
parameter_list|)
block|{
name|UNUSED
argument_list|(
name|h_FmMacsecSecY
argument_list|)
expr_stmt|;
name|UNUSED
argument_list|(
name|h_Sc
argument_list|)
expr_stmt|;
name|UNUSED
argument_list|(
name|an
argument_list|)
expr_stmt|;
name|UNUSED
argument_list|(
name|p_Statistics
argument_list|)
expr_stmt|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_TxScGetStatistics
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|t_FmMacsecSecYTxScStatistics
modifier|*
name|p_Statistics
parameter_list|)
block|{
name|UNUSED
argument_list|(
name|h_FmMacsecSecY
argument_list|)
expr_stmt|;
name|UNUSED
argument_list|(
name|p_Statistics
argument_list|)
expr_stmt|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|t_Error
name|FM_MACSEC_SECY_TxSaGetStatistics
parameter_list|(
name|t_Handle
name|h_FmMacsecSecY
parameter_list|,
name|macsecAN_t
name|an
parameter_list|,
name|t_FmMacsecSecYTxSaStatistics
modifier|*
name|p_Statistics
parameter_list|)
block|{
name|UNUSED
argument_list|(
name|h_FmMacsecSecY
argument_list|)
expr_stmt|;
name|UNUSED
argument_list|(
name|an
argument_list|)
expr_stmt|;
name|UNUSED
argument_list|(
name|p_Statistics
argument_list|)
expr_stmt|;
name|RETURN_ERROR
argument_list|(
name|MINOR
argument_list|,
name|E_NOT_SUPPORTED
argument_list|,
name|NO_MSG
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

