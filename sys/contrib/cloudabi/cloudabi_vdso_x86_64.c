begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|// Copyright (c) 2016 Nuxi (https://nuxi.nl/) and contributors.
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// Redistribution and use in source and binary forms, with or without
end_comment

begin_comment
comment|// modification, are permitted provided that the following conditions
end_comment

begin_comment
comment|// are met:
end_comment

begin_comment
comment|// 1. Redistributions of source code must retain the above copyright
end_comment

begin_comment
comment|//    notice, this list of conditions and the following disclaimer.
end_comment

begin_comment
comment|// 2. Redistributions in binary form must reproduce the above copyright
end_comment

begin_comment
comment|//    notice, this list of conditions and the following disclaimer in the
end_comment

begin_comment
comment|//    documentation and/or other materials provided with the distribution.
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
end_comment

begin_comment
comment|// ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
end_comment

begin_comment
comment|// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
end_comment

begin_comment
comment|// ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
end_comment

begin_comment
comment|// FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
end_comment

begin_comment
comment|// DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
end_comment

begin_comment
comment|// OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
end_comment

begin_comment
comment|// HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
end_comment

begin_comment
comment|// LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
end_comment

begin_comment
comment|// OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
end_comment

begin_comment
comment|// SUCH DAMAGE.
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// This file is automatically generated. Do not edit.
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// Source: https://github.com/NuxiNL/cloudabi
end_comment

begin_include
include|#
directive|include
file|<cloudabi_types.h>
end_include

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_clock_res_get
parameter_list|(
name|cloudabi_clockid_t
name|clock_id
parameter_list|,
name|cloudabi_timestamp_t
modifier|*
name|resolution
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|0
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|clock_id
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|resolution
operator|=
operator|(
name|cloudabi_timestamp_t
operator|)
name|reg_rax
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_clock_time_get
parameter_list|(
name|cloudabi_clockid_t
name|clock_id
parameter_list|,
name|cloudabi_timestamp_t
name|precision
parameter_list|,
name|cloudabi_timestamp_t
modifier|*
name|time
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|1
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|clock_id
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|precision
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|time
operator|=
operator|(
name|cloudabi_timestamp_t
operator|)
name|reg_rax
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_condvar_signal
parameter_list|(
atomic|_Atomic
argument_list|(
name|cloudabi_condvar_t
argument_list|)
modifier|*
name|condvar
parameter_list|,
name|cloudabi_scope_t
name|scope
parameter_list|,
name|cloudabi_nthreads_t
name|nwaiters
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|2
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|condvar
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|scope
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|nwaiters
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_fd_close
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|3
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_fd_create1
parameter_list|(
name|cloudabi_filetype_t
name|type
parameter_list|,
name|cloudabi_fd_t
modifier|*
name|fd
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|4
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|type
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|fd
operator|=
operator|(
name|cloudabi_fd_t
operator|)
name|reg_rax
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_fd_create2
parameter_list|(
name|cloudabi_filetype_t
name|type
parameter_list|,
name|cloudabi_fd_t
modifier|*
name|fd1
parameter_list|,
name|cloudabi_fd_t
modifier|*
name|fd2
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|5
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|type
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		, "=r"(reg_rdx) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|fd1
operator|=
operator|(
name|cloudabi_fd_t
operator|)
name|reg_rax
expr_stmt|;
operator|*
name|fd2
operator|=
operator|(
name|cloudabi_fd_t
operator|)
name|reg_rdx
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_fd_datasync
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|6
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_fd_dup
parameter_list|(
name|cloudabi_fd_t
name|from
parameter_list|,
name|cloudabi_fd_t
modifier|*
name|fd
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|7
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|from
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|fd
operator|=
operator|(
name|cloudabi_fd_t
operator|)
name|reg_rax
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_fd_pread
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|,
specifier|const
name|cloudabi_iovec_t
modifier|*
name|iov
parameter_list|,
name|size_t
name|iovcnt
parameter_list|,
name|cloudabi_filesize_t
name|offset
parameter_list|,
name|size_t
modifier|*
name|nread
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|8
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|iov
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|iovcnt
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|offset
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|nread
operator|=
operator|(
name|size_t
operator|)
name|reg_rax
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_fd_pwrite
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|,
specifier|const
name|cloudabi_ciovec_t
modifier|*
name|iov
parameter_list|,
name|size_t
name|iovcnt
parameter_list|,
name|cloudabi_filesize_t
name|offset
parameter_list|,
name|size_t
modifier|*
name|nwritten
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|9
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|iov
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|iovcnt
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|offset
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|nwritten
operator|=
operator|(
name|size_t
operator|)
name|reg_rax
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_fd_read
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|,
specifier|const
name|cloudabi_iovec_t
modifier|*
name|iov
parameter_list|,
name|size_t
name|iovcnt
parameter_list|,
name|size_t
modifier|*
name|nread
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|10
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|iov
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|iovcnt
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|nread
operator|=
operator|(
name|size_t
operator|)
name|reg_rax
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_fd_replace
parameter_list|(
name|cloudabi_fd_t
name|from
parameter_list|,
name|cloudabi_fd_t
name|to
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|11
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|from
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|to
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_fd_seek
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|,
name|cloudabi_filedelta_t
name|offset
parameter_list|,
name|cloudabi_whence_t
name|whence
parameter_list|,
name|cloudabi_filesize_t
modifier|*
name|newoffset
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|12
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|offset
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|whence
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|newoffset
operator|=
operator|(
name|cloudabi_filesize_t
operator|)
name|reg_rax
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_fd_stat_get
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|,
name|cloudabi_fdstat_t
modifier|*
name|buf
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|13
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|buf
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_fd_stat_put
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|,
specifier|const
name|cloudabi_fdstat_t
modifier|*
name|buf
parameter_list|,
name|cloudabi_fdsflags_t
name|flags
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|14
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|buf
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|flags
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_fd_sync
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|15
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_fd_write
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|,
specifier|const
name|cloudabi_ciovec_t
modifier|*
name|iov
parameter_list|,
name|size_t
name|iovcnt
parameter_list|,
name|size_t
modifier|*
name|nwritten
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|16
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|iov
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|iovcnt
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|nwritten
operator|=
operator|(
name|size_t
operator|)
name|reg_rax
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_file_advise
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|,
name|cloudabi_filesize_t
name|offset
parameter_list|,
name|cloudabi_filesize_t
name|len
parameter_list|,
name|cloudabi_advice_t
name|advice
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|17
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|offset
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|len
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|advice
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_file_allocate
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|,
name|cloudabi_filesize_t
name|offset
parameter_list|,
name|cloudabi_filesize_t
name|len
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|18
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|offset
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|len
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_file_create
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|,
specifier|const
name|char
modifier|*
name|path
parameter_list|,
name|size_t
name|pathlen
parameter_list|,
name|cloudabi_filetype_t
name|type
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|19
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|path
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|pathlen
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|type
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_file_link
parameter_list|(
name|cloudabi_lookup_t
name|fd1
parameter_list|,
specifier|const
name|char
modifier|*
name|path1
parameter_list|,
name|size_t
name|path1len
parameter_list|,
name|cloudabi_fd_t
name|fd2
parameter_list|,
specifier|const
name|char
modifier|*
name|path2
parameter_list|,
name|size_t
name|path2len
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|20
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|*
operator|(
name|uint64_t
operator|*
operator|)
operator|&
name|fd1
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|path1
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|path1len
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd2
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r8
name|asm
argument_list|(
literal|"r8"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|path2
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r9
name|asm
argument_list|(
literal|"r9"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|path2len
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		, "r"(reg_r8) 		, "r"(reg_r9) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_file_open
parameter_list|(
name|cloudabi_lookup_t
name|dirfd
parameter_list|,
specifier|const
name|char
modifier|*
name|path
parameter_list|,
name|size_t
name|pathlen
parameter_list|,
name|cloudabi_oflags_t
name|oflags
parameter_list|,
specifier|const
name|cloudabi_fdstat_t
modifier|*
name|fds
parameter_list|,
name|cloudabi_fd_t
modifier|*
name|fd
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|21
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|*
operator|(
name|uint64_t
operator|*
operator|)
operator|&
name|dirfd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|path
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|pathlen
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|oflags
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r8
name|asm
argument_list|(
literal|"r8"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fds
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		, "r"(reg_r8) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|fd
operator|=
operator|(
name|cloudabi_fd_t
operator|)
name|reg_rax
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_file_readdir
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|,
name|void
modifier|*
name|buf
parameter_list|,
name|size_t
name|nbyte
parameter_list|,
name|cloudabi_dircookie_t
name|cookie
parameter_list|,
name|size_t
modifier|*
name|bufused
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|22
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|buf
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|nbyte
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|cookie
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|bufused
operator|=
operator|(
name|size_t
operator|)
name|reg_rax
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_file_readlink
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|,
specifier|const
name|char
modifier|*
name|path
parameter_list|,
name|size_t
name|pathlen
parameter_list|,
name|char
modifier|*
name|buf
parameter_list|,
name|size_t
name|bufsize
parameter_list|,
name|size_t
modifier|*
name|bufused
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|23
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|path
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|pathlen
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|buf
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r8
name|asm
argument_list|(
literal|"r8"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|bufsize
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		, "r"(reg_r8) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|bufused
operator|=
operator|(
name|size_t
operator|)
name|reg_rax
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_file_rename
parameter_list|(
name|cloudabi_fd_t
name|oldfd
parameter_list|,
specifier|const
name|char
modifier|*
name|old
parameter_list|,
name|size_t
name|oldlen
parameter_list|,
name|cloudabi_fd_t
name|newfd
parameter_list|,
specifier|const
name|char
modifier|*
name|new
parameter_list|,
name|size_t
name|newlen
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|24
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|oldfd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|old
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|oldlen
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|newfd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r8
name|asm
argument_list|(
literal|"r8"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|new
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r9
name|asm
argument_list|(
literal|"r9"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|newlen
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		, "r"(reg_r8) 		, "r"(reg_r9) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_file_stat_fget
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|,
name|cloudabi_filestat_t
modifier|*
name|buf
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|25
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|buf
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_file_stat_fput
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|,
specifier|const
name|cloudabi_filestat_t
modifier|*
name|buf
parameter_list|,
name|cloudabi_fsflags_t
name|flags
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|26
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|buf
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|flags
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_file_stat_get
parameter_list|(
name|cloudabi_lookup_t
name|fd
parameter_list|,
specifier|const
name|char
modifier|*
name|path
parameter_list|,
name|size_t
name|pathlen
parameter_list|,
name|cloudabi_filestat_t
modifier|*
name|buf
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|27
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|*
operator|(
name|uint64_t
operator|*
operator|)
operator|&
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|path
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|pathlen
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|buf
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_file_stat_put
parameter_list|(
name|cloudabi_lookup_t
name|fd
parameter_list|,
specifier|const
name|char
modifier|*
name|path
parameter_list|,
name|size_t
name|pathlen
parameter_list|,
specifier|const
name|cloudabi_filestat_t
modifier|*
name|buf
parameter_list|,
name|cloudabi_fsflags_t
name|flags
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|28
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|*
operator|(
name|uint64_t
operator|*
operator|)
operator|&
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|path
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|pathlen
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|buf
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r8
name|asm
argument_list|(
literal|"r8"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|flags
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		, "r"(reg_r8) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_file_symlink
parameter_list|(
specifier|const
name|char
modifier|*
name|path1
parameter_list|,
name|size_t
name|path1len
parameter_list|,
name|cloudabi_fd_t
name|fd
parameter_list|,
specifier|const
name|char
modifier|*
name|path2
parameter_list|,
name|size_t
name|path2len
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|29
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|path1
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|path1len
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|path2
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r8
name|asm
argument_list|(
literal|"r8"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|path2len
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		, "r"(reg_r8) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_file_unlink
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|,
specifier|const
name|char
modifier|*
name|path
parameter_list|,
name|size_t
name|pathlen
parameter_list|,
name|cloudabi_ulflags_t
name|flags
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|30
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|path
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|pathlen
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|flags
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_lock_unlock
parameter_list|(
atomic|_Atomic
argument_list|(
name|cloudabi_lock_t
argument_list|)
modifier|*
name|lock
parameter_list|,
name|cloudabi_scope_t
name|scope
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|31
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|lock
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|scope
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_mem_advise
parameter_list|(
name|void
modifier|*
name|addr
parameter_list|,
name|size_t
name|len
parameter_list|,
name|cloudabi_advice_t
name|advice
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|32
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|addr
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|len
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|advice
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_mem_lock
parameter_list|(
specifier|const
name|void
modifier|*
name|addr
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|33
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|addr
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|len
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_mem_map
parameter_list|(
name|void
modifier|*
name|addr
parameter_list|,
name|size_t
name|len
parameter_list|,
name|cloudabi_mprot_t
name|prot
parameter_list|,
name|cloudabi_mflags_t
name|flags
parameter_list|,
name|cloudabi_fd_t
name|fd
parameter_list|,
name|cloudabi_filesize_t
name|off
parameter_list|,
name|void
modifier|*
modifier|*
name|mem
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|34
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|addr
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|len
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|prot
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|flags
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r8
name|asm
argument_list|(
literal|"r8"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r9
name|asm
argument_list|(
literal|"r9"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|off
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		, "r"(reg_r8) 		, "r"(reg_r9) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|mem
operator|=
operator|(
name|void
operator|*
operator|)
name|reg_rax
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_mem_protect
parameter_list|(
name|void
modifier|*
name|addr
parameter_list|,
name|size_t
name|len
parameter_list|,
name|cloudabi_mprot_t
name|prot
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|35
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|addr
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|len
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|prot
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_mem_sync
parameter_list|(
name|void
modifier|*
name|addr
parameter_list|,
name|size_t
name|len
parameter_list|,
name|cloudabi_msflags_t
name|flags
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|36
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|addr
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|len
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|flags
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_mem_unlock
parameter_list|(
specifier|const
name|void
modifier|*
name|addr
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|37
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|addr
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|len
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_mem_unmap
parameter_list|(
name|void
modifier|*
name|addr
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|38
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|addr
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|len
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_poll
parameter_list|(
specifier|const
name|cloudabi_subscription_t
modifier|*
name|in
parameter_list|,
name|cloudabi_event_t
modifier|*
name|out
parameter_list|,
name|size_t
name|nsubscriptions
parameter_list|,
name|size_t
modifier|*
name|nevents
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|39
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|in
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|out
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|nsubscriptions
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|nevents
operator|=
operator|(
name|size_t
operator|)
name|reg_rax
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_poll_fd
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|,
specifier|const
name|cloudabi_subscription_t
modifier|*
name|in
parameter_list|,
name|size_t
name|nin
parameter_list|,
name|cloudabi_event_t
modifier|*
name|out
parameter_list|,
name|size_t
name|nout
parameter_list|,
specifier|const
name|cloudabi_subscription_t
modifier|*
name|timeout
parameter_list|,
name|size_t
modifier|*
name|nevents
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|57
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|in
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|nin
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|out
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r8
name|asm
argument_list|(
literal|"r8"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|nout
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r9
name|asm
argument_list|(
literal|"r9"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|timeout
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		, "r"(reg_r8) 		, "r"(reg_r9) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|nevents
operator|=
operator|(
name|size_t
operator|)
name|reg_rax
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_proc_exec
parameter_list|(
name|cloudabi_fd_t
name|fd
parameter_list|,
specifier|const
name|void
modifier|*
name|data
parameter_list|,
name|size_t
name|datalen
parameter_list|,
specifier|const
name|cloudabi_fd_t
modifier|*
name|fds
parameter_list|,
name|size_t
name|fdslen
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|40
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|data
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|datalen
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fds
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r8
name|asm
argument_list|(
literal|"r8"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fdslen
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		, "r"(reg_r8) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
specifier|_Noreturn
name|void
name|cloudabi_sys_proc_exit
parameter_list|(
name|cloudabi_exitcode_t
name|rval
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|41
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|rval
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: 		: "r"(reg_rax) 		, "r"(reg_rdi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
for|for
control|(
init|;
condition|;
control|)
empty_stmt|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_proc_fork
parameter_list|(
name|cloudabi_fd_t
modifier|*
name|fd
parameter_list|,
name|cloudabi_tid_t
modifier|*
name|tid
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|42
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		, "=r"(reg_rdx) 		: "r"(reg_rax) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|fd
operator|=
operator|(
name|cloudabi_fd_t
operator|)
name|reg_rax
expr_stmt|;
operator|*
name|tid
operator|=
operator|(
name|cloudabi_tid_t
operator|)
name|reg_rdx
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_proc_raise
parameter_list|(
name|cloudabi_signal_t
name|sig
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|43
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|sig
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_random_get
parameter_list|(
name|void
modifier|*
name|buf
parameter_list|,
name|size_t
name|nbyte
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|44
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|buf
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|nbyte
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_sock_accept
parameter_list|(
name|cloudabi_fd_t
name|sock
parameter_list|,
name|cloudabi_sockstat_t
modifier|*
name|buf
parameter_list|,
name|cloudabi_fd_t
modifier|*
name|conn
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|45
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|sock
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|buf
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|conn
operator|=
operator|(
name|cloudabi_fd_t
operator|)
name|reg_rax
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_sock_bind
parameter_list|(
name|cloudabi_fd_t
name|sock
parameter_list|,
name|cloudabi_fd_t
name|fd
parameter_list|,
specifier|const
name|char
modifier|*
name|path
parameter_list|,
name|size_t
name|pathlen
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|46
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|sock
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|path
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|pathlen
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_sock_connect
parameter_list|(
name|cloudabi_fd_t
name|sock
parameter_list|,
name|cloudabi_fd_t
name|fd
parameter_list|,
specifier|const
name|char
modifier|*
name|path
parameter_list|,
name|size_t
name|pathlen
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|47
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|sock
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|fd
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|path
decl_stmt|;
specifier|register
name|uint64_t
name|reg_r10
name|asm
argument_list|(
literal|"r10"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|pathlen
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		, "r"(reg_r10) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_sock_listen
parameter_list|(
name|cloudabi_fd_t
name|sock
parameter_list|,
name|cloudabi_backlog_t
name|backlog
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|48
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|sock
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|backlog
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_sock_recv
parameter_list|(
name|cloudabi_fd_t
name|sock
parameter_list|,
specifier|const
name|cloudabi_recv_in_t
modifier|*
name|in
parameter_list|,
name|cloudabi_recv_out_t
modifier|*
name|out
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|49
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|sock
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|in
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|out
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_sock_send
parameter_list|(
name|cloudabi_fd_t
name|sock
parameter_list|,
specifier|const
name|cloudabi_send_in_t
modifier|*
name|in
parameter_list|,
name|cloudabi_send_out_t
modifier|*
name|out
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|50
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|sock
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|in
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|out
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_sock_shutdown
parameter_list|(
name|cloudabi_fd_t
name|sock
parameter_list|,
name|cloudabi_sdflags_t
name|how
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|51
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|sock
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|how
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_sock_stat_get
parameter_list|(
name|cloudabi_fd_t
name|sock
parameter_list|,
name|cloudabi_sockstat_t
modifier|*
name|buf
parameter_list|,
name|cloudabi_ssflags_t
name|flags
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|52
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|sock
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|buf
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdx
name|asm
argument_list|(
literal|"rdx"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|flags
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		, "r"(reg_rdx) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_thread_create
parameter_list|(
name|cloudabi_threadattr_t
modifier|*
name|attr
parameter_list|,
name|cloudabi_tid_t
modifier|*
name|tid
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|53
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|attr
decl_stmt|;
specifier|register
name|char
name|okay
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		"\tsetnc %0\n" 		: "=r"(okay) 		, "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
if|if
condition|(
name|okay
condition|)
block|{
operator|*
name|tid
operator|=
operator|(
name|cloudabi_tid_t
operator|)
name|reg_rax
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
specifier|_Noreturn
name|void
name|cloudabi_sys_thread_exit
parameter_list|(
atomic|_Atomic
argument_list|(
name|cloudabi_lock_t
argument_list|)
modifier|*
name|lock
parameter_list|,
name|cloudabi_scope_t
name|scope
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|54
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|lock
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rsi
name|asm
argument_list|(
literal|"rsi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|scope
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: 		: "r"(reg_rax) 		, "r"(reg_rdi) 		, "r"(reg_rsi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
for|for
control|(
init|;
condition|;
control|)
empty_stmt|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_thread_tcb_set
parameter_list|(
name|void
modifier|*
name|tcb
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|55
decl_stmt|;
specifier|register
name|uint64_t
name|reg_rdi
name|asm
argument_list|(
literal|"rdi"
argument_list|)
init|=
operator|(
name|uint64_t
operator|)
name|tcb
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		, "r"(reg_rdi) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

begin_function
name|cloudabi_errno_t
name|cloudabi_sys_thread_yield
parameter_list|(
name|void
parameter_list|)
block|{
specifier|register
name|uint64_t
name|reg_rax
name|asm
argument_list|(
literal|"rax"
argument_list|)
init|=
literal|56
decl_stmt|;
asm|asm
specifier|volatile
asm|( 		"\tsyscall\n" 		: "=r"(reg_rax) 		: "r"(reg_rax) 		: "memory", "rcx", "rdx", "r8", "r9", "r10", "r11");
return|return
name|reg_rax
return|;
block|}
end_function

end_unit

