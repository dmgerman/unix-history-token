begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/******************************************************************************  *  * Module Name: dmtable - Support for ACPI tables that contain no AML code  *  *****************************************************************************/
end_comment

begin_comment
comment|/*  * Copyright (C) 2000 - 2012, Intel Corp.  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions, and the following disclaimer,  *    without modification.  * 2. Redistributions in binary form must reproduce at minimum a disclaimer  *    substantially similar to the "NO WARRANTY" disclaimer below  *    ("Disclaimer") and any redistribution must be conditioned upon  *    including a substantially similar Disclaimer requirement for further  *    binary redistribution.  * 3. Neither the names of the above-listed copyright holders nor the names  *    of any contributors may be used to endorse or promote products derived  *    from this software without specific prior written permission.  *  * Alternatively, this software may be distributed under the terms of the  * GNU General Public License ("GPL") version 2 as published by the Free  * Software Foundation.  *  * NO WARRANTY  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS  * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT  * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR  * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT  * HOLDERS OR CONTRIBUTORS BE LIABLE FOR SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING  * IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE  * POSSIBILITY OF SUCH DAMAGES.  */
end_comment

begin_include
include|#
directive|include
file|<contrib/dev/acpica/include/acpi.h>
end_include

begin_include
include|#
directive|include
file|<contrib/dev/acpica/include/accommon.h>
end_include

begin_include
include|#
directive|include
file|<contrib/dev/acpica/include/acdisasm.h>
end_include

begin_include
include|#
directive|include
file|<contrib/dev/acpica/include/actables.h>
end_include

begin_include
include|#
directive|include
file|<contrib/dev/acpica/compiler/aslcompiler.h>
end_include

begin_include
include|#
directive|include
file|<contrib/dev/acpica/compiler/dtcompiler.h>
end_include

begin_comment
comment|/* This module used for application-level code only */
end_comment

begin_define
define|#
directive|define
name|_COMPONENT
value|ACPI_CA_DISASSEMBLER
end_define

begin_macro
name|ACPI_MODULE_NAME
argument_list|(
literal|"dmtable"
argument_list|)
end_macro

begin_comment
comment|/* Local Prototypes */
end_comment

begin_function_decl
specifier|static
name|void
name|AcpiDmCheckAscii
parameter_list|(
name|UINT8
modifier|*
name|Target
parameter_list|,
name|char
modifier|*
name|RepairedName
parameter_list|,
name|UINT32
name|Count
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* Common format strings for commented values */
end_comment

begin_define
define|#
directive|define
name|UINT8_FORMAT
value|"%2.2X [%s]\n"
end_define

begin_define
define|#
directive|define
name|UINT16_FORMAT
value|"%4.4X [%s]\n"
end_define

begin_define
define|#
directive|define
name|UINT32_FORMAT
value|"%8.8X [%s]\n"
end_define

begin_define
define|#
directive|define
name|STRING_FORMAT
value|"[%s]\n"
end_define

begin_comment
comment|/* These tables map a subtable type to a description string */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|AcpiDmAsfSubnames
index|[]
init|=
block|{
literal|"ASF Information"
block|,
literal|"ASF Alerts"
block|,
literal|"ASF Remote Control"
block|,
literal|"ASF RMCP Boot Options"
block|,
literal|"ASF Address"
block|,
literal|"Unknown SubTable Type"
comment|/* Reserved */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|AcpiDmDmarSubnames
index|[]
init|=
block|{
literal|"Hardware Unit Definition"
block|,
literal|"Reserved Memory Region"
block|,
literal|"Root Port ATS Capability"
block|,
literal|"Remapping Hardware Static Affinity"
block|,
literal|"Unknown SubTable Type"
comment|/* Reserved */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|AcpiDmEinjActions
index|[]
init|=
block|{
literal|"Begin Operation"
block|,
literal|"Get Trigger Table"
block|,
literal|"Set Error Type"
block|,
literal|"Get Error Type"
block|,
literal|"End Operation"
block|,
literal|"Execute Operation"
block|,
literal|"Check Busy Status"
block|,
literal|"Get Command Status"
block|,
literal|"Unknown Action"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|AcpiDmEinjInstructions
index|[]
init|=
block|{
literal|"Read Register"
block|,
literal|"Read Register Value"
block|,
literal|"Write Register"
block|,
literal|"Write Register Value"
block|,
literal|"Noop"
block|,
literal|"Unknown Instruction"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|AcpiDmErstActions
index|[]
init|=
block|{
literal|"Begin Write Operation"
block|,
literal|"Begin Read Operation"
block|,
literal|"Begin Clear Operation"
block|,
literal|"End Operation"
block|,
literal|"Set Record Offset"
block|,
literal|"Execute Operation"
block|,
literal|"Check Busy Status"
block|,
literal|"Get Command Status"
block|,
literal|"Get Record Identifier"
block|,
literal|"Set Record Identifier"
block|,
literal|"Get Record Count"
block|,
literal|"Begin Dummy Write"
block|,
literal|"Unused/Unknown Action"
block|,
literal|"Get Error Address Range"
block|,
literal|"Get Error Address Length"
block|,
literal|"Get Error Attributes"
block|,
literal|"Unknown Action"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|AcpiDmErstInstructions
index|[]
init|=
block|{
literal|"Read Register"
block|,
literal|"Read Register Value"
block|,
literal|"Write Register"
block|,
literal|"Write Register Value"
block|,
literal|"Noop"
block|,
literal|"Load Var1"
block|,
literal|"Load Var2"
block|,
literal|"Store Var1"
block|,
literal|"Add"
block|,
literal|"Subtract"
block|,
literal|"Add Value"
block|,
literal|"Subtract Value"
block|,
literal|"Stall"
block|,
literal|"Stall While True"
block|,
literal|"Skip Next If True"
block|,
literal|"GoTo"
block|,
literal|"Set Source Address"
block|,
literal|"Set Destination Address"
block|,
literal|"Move Data"
block|,
literal|"Unknown Instruction"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|AcpiDmHestSubnames
index|[]
init|=
block|{
literal|"IA-32 Machine Check Exception"
block|,
literal|"IA-32 Corrected Machine Check"
block|,
literal|"IA-32 Non-Maskable Interrupt"
block|,
literal|"Unknown SubTable Type"
block|,
comment|/* 3 - Reserved */
literal|"Unknown SubTable Type"
block|,
comment|/* 4 - Reserved */
literal|"Unknown SubTable Type"
block|,
comment|/* 5 - Reserved */
literal|"PCI Express Root Port AER"
block|,
literal|"PCI Express AER (AER Endpoint)"
block|,
literal|"PCI Express/PCI-X Bridge AER"
block|,
literal|"Generic Hardware Error Source"
block|,
literal|"Unknown SubTable Type"
comment|/* Reserved */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|AcpiDmHestNotifySubnames
index|[]
init|=
block|{
literal|"Polled"
block|,
literal|"External Interrupt"
block|,
literal|"Local Interrupt"
block|,
literal|"SCI"
block|,
literal|"NMI"
block|,
literal|"Unknown Notify Type"
comment|/* Reserved */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|AcpiDmMadtSubnames
index|[]
init|=
block|{
literal|"Processor Local APIC"
block|,
comment|/* ACPI_MADT_TYPE_LOCAL_APIC */
literal|"I/O APIC"
block|,
comment|/* ACPI_MADT_TYPE_IO_APIC */
literal|"Interrupt Source Override"
block|,
comment|/* ACPI_MADT_TYPE_INTERRUPT_OVERRIDE */
literal|"NMI Source"
block|,
comment|/* ACPI_MADT_TYPE_NMI_SOURCE */
literal|"Local APIC NMI"
block|,
comment|/* ACPI_MADT_TYPE_LOCAL_APIC_NMI */
literal|"Local APIC Address Override"
block|,
comment|/* ACPI_MADT_TYPE_LOCAL_APIC_OVERRIDE */
literal|"I/O SAPIC"
block|,
comment|/* ACPI_MADT_TYPE_IO_SAPIC */
literal|"Local SAPIC"
block|,
comment|/* ACPI_MADT_TYPE_LOCAL_SAPIC */
literal|"Platform Interrupt Sources"
block|,
comment|/* ACPI_MADT_TYPE_INTERRUPT_SOURCE */
literal|"Processor Local x2APIC"
block|,
comment|/* ACPI_MADT_TYPE_LOCAL_X2APIC */
literal|"Local x2APIC NMI"
block|,
comment|/* ACPI_MADT_TYPE_LOCAL_X2APIC_NMI */
literal|"Generic Interrupt Controller"
block|,
comment|/* ACPI_MADT_GENERIC_INTERRUPT */
literal|"Generic Interrupt Distributor"
block|,
comment|/* ACPI_MADT_GENERIC_DISTRIBUTOR */
literal|"Unknown SubTable Type"
comment|/* Reserved */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|AcpiDmPmttSubnames
index|[]
init|=
block|{
literal|"Socket"
block|,
comment|/* ACPI_PMTT_TYPE_SOCKET */
literal|"Memory Controller"
block|,
comment|/* ACPI_PMTT_TYPE_CONTROLLER */
literal|"Physical Component (DIMM)"
block|,
comment|/* ACPI_PMTT_TYPE_DIMM  */
literal|"Unknown SubTable Type"
comment|/* Reserved */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|AcpiDmSlicSubnames
index|[]
init|=
block|{
literal|"Public Key Structure"
block|,
literal|"Windows Marker Structure"
block|,
literal|"Unknown SubTable Type"
comment|/* Reserved */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|AcpiDmSratSubnames
index|[]
init|=
block|{
literal|"Processor Local APIC/SAPIC Affinity"
block|,
literal|"Memory Affinity"
block|,
literal|"Processor Local x2APIC Affinity"
block|,
literal|"Unknown SubTable Type"
comment|/* Reserved */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|AcpiDmIvrsSubnames
index|[]
init|=
block|{
literal|"Hardware Definition Block"
block|,
literal|"Memory Definition Block"
block|,
literal|"Unknown SubTable Type"
comment|/* Reserved */
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|ACPI_FADT_PM_RESERVED
value|9
end_define

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|AcpiDmFadtProfiles
index|[]
init|=
block|{
literal|"Unspecified"
block|,
literal|"Desktop"
block|,
literal|"Mobile"
block|,
literal|"Workstation"
block|,
literal|"Enterprise Server"
block|,
literal|"SOHO Server"
block|,
literal|"Appliance PC"
block|,
literal|"Performance Server"
block|,
literal|"Tablet"
block|,
literal|"Unknown Profile Type"
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|ACPI_GAS_WIDTH_RESERVED
value|5
end_define

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|AcpiDmGasAccessWidth
index|[]
init|=
block|{
literal|"Undefined/Legacy"
block|,
literal|"Byte Access:8"
block|,
literal|"Word Access:16"
block|,
literal|"DWord Access:32"
block|,
literal|"QWord Access:64"
block|,
literal|"Unknown Width Encoding"
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*******************************************************************************  *  * ACPI Table Data, indexed by signature.  *  * Each entry contains: Signature, Table Info, Handler, DtHandler,  *  Template, Description  *  * Simple tables have only a TableInfo structure, complex tables have a  * handler. This table must be NULL terminated. RSDP and FACS are  * special-cased elsewhere.  *  ******************************************************************************/
end_comment

begin_decl_stmt
name|ACPI_DMTABLE_DATA
name|AcpiDmTableData
index|[]
init|=
block|{
block|{
name|ACPI_SIG_ASF
block|,
name|NULL
block|,
name|AcpiDmDumpAsf
block|,
name|DtCompileAsf
block|,
name|TemplateAsf
block|,
literal|"Alert Standard Format table"
block|}
block|,
block|{
name|ACPI_SIG_BERT
block|,
name|AcpiDmTableInfoBert
block|,
name|NULL
block|,
name|NULL
block|,
name|TemplateBert
block|,
literal|"Boot Error Record Table"
block|}
block|,
block|{
name|ACPI_SIG_BGRT
block|,
name|AcpiDmTableInfoBgrt
block|,
name|NULL
block|,
name|NULL
block|,
name|TemplateBgrt
block|,
literal|"Boot Graphics Resource Table"
block|}
block|,
block|{
name|ACPI_SIG_BOOT
block|,
name|AcpiDmTableInfoBoot
block|,
name|NULL
block|,
name|NULL
block|,
name|TemplateBoot
block|,
literal|"Simple Boot Flag Table"
block|}
block|,
block|{
name|ACPI_SIG_CPEP
block|,
name|NULL
block|,
name|AcpiDmDumpCpep
block|,
name|DtCompileCpep
block|,
name|TemplateCpep
block|,
literal|"Corrected Platform Error Polling table"
block|}
block|,
block|{
name|ACPI_SIG_CSRT
block|,
name|NULL
block|,
name|AcpiDmDumpCsrt
block|,
name|NULL
block|,
name|NULL
block|,
literal|"Core System Resource Table"
block|}
block|,
block|{
name|ACPI_SIG_DBG2
block|,
name|NULL
block|,
name|AcpiDmDumpDbg2
block|,
name|NULL
block|,
name|NULL
block|,
literal|"Debug Port table type 2"
block|}
block|,
block|{
name|ACPI_SIG_DBGP
block|,
name|AcpiDmTableInfoDbgp
block|,
name|NULL
block|,
name|NULL
block|,
name|TemplateDbgp
block|,
literal|"Debug Port table"
block|}
block|,
block|{
name|ACPI_SIG_DMAR
block|,
name|NULL
block|,
name|AcpiDmDumpDmar
block|,
name|DtCompileDmar
block|,
name|TemplateDmar
block|,
literal|"DMA Remapping table"
block|}
block|,
block|{
name|ACPI_SIG_ECDT
block|,
name|AcpiDmTableInfoEcdt
block|,
name|NULL
block|,
name|NULL
block|,
name|TemplateEcdt
block|,
literal|"Embedded Controller Boot Resources Table"
block|}
block|,
block|{
name|ACPI_SIG_EINJ
block|,
name|NULL
block|,
name|AcpiDmDumpEinj
block|,
name|DtCompileEinj
block|,
name|TemplateEinj
block|,
literal|"Error Injection table"
block|}
block|,
block|{
name|ACPI_SIG_ERST
block|,
name|NULL
block|,
name|AcpiDmDumpErst
block|,
name|DtCompileErst
block|,
name|TemplateErst
block|,
literal|"Error Record Serialization Table"
block|}
block|,
block|{
name|ACPI_SIG_FADT
block|,
name|NULL
block|,
name|AcpiDmDumpFadt
block|,
name|DtCompileFadt
block|,
name|TemplateFadt
block|,
literal|"Fixed ACPI Description Table (FADT)"
block|}
block|,
block|{
name|ACPI_SIG_FPDT
block|,
name|NULL
block|,
name|AcpiDmDumpFpdt
block|,
name|DtCompileFpdt
block|,
name|TemplateFpdt
block|,
literal|"Firmware Performance Data Table"
block|}
block|,
block|{
name|ACPI_SIG_GTDT
block|,
name|AcpiDmTableInfoGtdt
block|,
name|NULL
block|,
name|NULL
block|,
name|TemplateGtdt
block|,
literal|"Generic Timer Description Table"
block|}
block|,
block|{
name|ACPI_SIG_HEST
block|,
name|NULL
block|,
name|AcpiDmDumpHest
block|,
name|DtCompileHest
block|,
name|TemplateHest
block|,
literal|"Hardware Error Source Table"
block|}
block|,
block|{
name|ACPI_SIG_HPET
block|,
name|AcpiDmTableInfoHpet
block|,
name|NULL
block|,
name|NULL
block|,
name|TemplateHpet
block|,
literal|"High Precision Event Timer table"
block|}
block|,
block|{
name|ACPI_SIG_IVRS
block|,
name|NULL
block|,
name|AcpiDmDumpIvrs
block|,
name|DtCompileIvrs
block|,
name|TemplateIvrs
block|,
literal|"I/O Virtualization Reporting Structure"
block|}
block|,
block|{
name|ACPI_SIG_MADT
block|,
name|NULL
block|,
name|AcpiDmDumpMadt
block|,
name|DtCompileMadt
block|,
name|TemplateMadt
block|,
literal|"Multiple APIC Description Table (MADT)"
block|}
block|,
block|{
name|ACPI_SIG_MCFG
block|,
name|NULL
block|,
name|AcpiDmDumpMcfg
block|,
name|DtCompileMcfg
block|,
name|TemplateMcfg
block|,
literal|"Memory Mapped Configuration table"
block|}
block|,
block|{
name|ACPI_SIG_MCHI
block|,
name|AcpiDmTableInfoMchi
block|,
name|NULL
block|,
name|NULL
block|,
name|TemplateMchi
block|,
literal|"Management Controller Host Interface table"
block|}
block|,
block|{
name|ACPI_SIG_MPST
block|,
name|AcpiDmTableInfoMpst
block|,
name|AcpiDmDumpMpst
block|,
name|DtCompileMpst
block|,
name|TemplateMpst
block|,
literal|"Memory Power State Table"
block|}
block|,
block|{
name|ACPI_SIG_MSCT
block|,
name|NULL
block|,
name|AcpiDmDumpMsct
block|,
name|DtCompileMsct
block|,
name|TemplateMsct
block|,
literal|"Maximum System Characteristics Table"
block|}
block|,
block|{
name|ACPI_SIG_PCCT
block|,
name|NULL
block|,
name|AcpiDmDumpPcct
block|,
name|NULL
block|,
name|NULL
block|,
literal|"Platform Communications Channel Table"
block|}
block|,
block|{
name|ACPI_SIG_PMTT
block|,
name|NULL
block|,
name|AcpiDmDumpPmtt
block|,
name|DtCompilePmtt
block|,
name|TemplatePmtt
block|,
literal|"Platform Memory Topology Table"
block|}
block|,
block|{
name|ACPI_SIG_RSDT
block|,
name|NULL
block|,
name|AcpiDmDumpRsdt
block|,
name|DtCompileRsdt
block|,
name|TemplateRsdt
block|,
literal|"Root System Description Table"
block|}
block|,
block|{
name|ACPI_SIG_S3PT
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|TemplateS3pt
block|,
literal|"S3 Performance Table"
block|}
block|,
block|{
name|ACPI_SIG_SBST
block|,
name|AcpiDmTableInfoSbst
block|,
name|NULL
block|,
name|NULL
block|,
name|TemplateSbst
block|,
literal|"Smart Battery Specification Table"
block|}
block|,
block|{
name|ACPI_SIG_SLIC
block|,
name|NULL
block|,
name|AcpiDmDumpSlic
block|,
name|DtCompileSlic
block|,
name|TemplateSlic
block|,
literal|"Software Licensing Description Table"
block|}
block|,
block|{
name|ACPI_SIG_SLIT
block|,
name|NULL
block|,
name|AcpiDmDumpSlit
block|,
name|DtCompileSlit
block|,
name|TemplateSlit
block|,
literal|"System Locality Information Table"
block|}
block|,
block|{
name|ACPI_SIG_SPCR
block|,
name|AcpiDmTableInfoSpcr
block|,
name|NULL
block|,
name|NULL
block|,
name|TemplateSpcr
block|,
literal|"Serial Port Console Redirection table"
block|}
block|,
block|{
name|ACPI_SIG_SPMI
block|,
name|AcpiDmTableInfoSpmi
block|,
name|NULL
block|,
name|NULL
block|,
name|TemplateSpmi
block|,
literal|"Server Platform Management Interface table"
block|}
block|,
block|{
name|ACPI_SIG_SRAT
block|,
name|NULL
block|,
name|AcpiDmDumpSrat
block|,
name|DtCompileSrat
block|,
name|TemplateSrat
block|,
literal|"System Resource Affinity Table"
block|}
block|,
block|{
name|ACPI_SIG_TCPA
block|,
name|AcpiDmTableInfoTcpa
block|,
name|NULL
block|,
name|NULL
block|,
name|TemplateTcpa
block|,
literal|"Trusted Computing Platform Alliance table"
block|}
block|,
block|{
name|ACPI_SIG_UEFI
block|,
name|AcpiDmTableInfoUefi
block|,
name|NULL
block|,
name|DtCompileUefi
block|,
name|TemplateUefi
block|,
literal|"UEFI Boot Optimization Table"
block|}
block|,
block|{
name|ACPI_SIG_WAET
block|,
name|AcpiDmTableInfoWaet
block|,
name|NULL
block|,
name|NULL
block|,
name|TemplateWaet
block|,
literal|"Windows ACPI Emulated Devices Table"
block|}
block|,
block|{
name|ACPI_SIG_WDAT
block|,
name|NULL
block|,
name|AcpiDmDumpWdat
block|,
name|DtCompileWdat
block|,
name|TemplateWdat
block|,
literal|"Watchdog Action Table"
block|}
block|,
block|{
name|ACPI_SIG_WDDT
block|,
name|AcpiDmTableInfoWddt
block|,
name|NULL
block|,
name|NULL
block|,
name|TemplateWddt
block|,
literal|"Watchdog Description Table"
block|}
block|,
block|{
name|ACPI_SIG_WDRT
block|,
name|AcpiDmTableInfoWdrt
block|,
name|NULL
block|,
name|NULL
block|,
name|TemplateWdrt
block|,
literal|"Watchdog Resource Table"
block|}
block|,
block|{
name|ACPI_SIG_XSDT
block|,
name|NULL
block|,
name|AcpiDmDumpXsdt
block|,
name|DtCompileXsdt
block|,
name|TemplateXsdt
block|,
literal|"Extended System Description Table"
block|}
block|,
block|{
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmGenerateChecksum  *  * PARAMETERS:  Table               - Pointer to table to be checksummed  *              Length              - Length of the table  *              OriginalChecksum    - Value of the checksum field  *  * RETURN:      8 bit checksum of buffer  *  * DESCRIPTION: Computes an 8 bit checksum of the table.  *  ******************************************************************************/
end_comment

begin_function
name|UINT8
name|AcpiDmGenerateChecksum
parameter_list|(
name|void
modifier|*
name|Table
parameter_list|,
name|UINT32
name|Length
parameter_list|,
name|UINT8
name|OriginalChecksum
parameter_list|)
block|{
name|UINT8
name|Checksum
decl_stmt|;
comment|/* Sum the entire table as-is */
name|Checksum
operator|=
name|AcpiTbChecksum
argument_list|(
operator|(
name|UINT8
operator|*
operator|)
name|Table
argument_list|,
name|Length
argument_list|)
expr_stmt|;
comment|/* Subtract off the existing checksum value in the table */
name|Checksum
operator|=
call|(
name|UINT8
call|)
argument_list|(
name|Checksum
operator|-
name|OriginalChecksum
argument_list|)
expr_stmt|;
comment|/* Compute the final checksum */
name|Checksum
operator|=
call|(
name|UINT8
call|)
argument_list|(
literal|0
operator|-
name|Checksum
argument_list|)
expr_stmt|;
return|return
operator|(
name|Checksum
operator|)
return|;
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmGetTableData  *  * PARAMETERS:  Signature           - ACPI signature (4 chars) to match  *  * RETURN:      Pointer to a valid ACPI_DMTABLE_DATA. Null if no match found.  *  * DESCRIPTION: Find a match in the global table of supported ACPI tables  *  ******************************************************************************/
end_comment

begin_function
name|ACPI_DMTABLE_DATA
modifier|*
name|AcpiDmGetTableData
parameter_list|(
name|char
modifier|*
name|Signature
parameter_list|)
block|{
name|ACPI_DMTABLE_DATA
modifier|*
name|TableData
decl_stmt|;
for|for
control|(
name|TableData
operator|=
name|AcpiDmTableData
init|;
name|TableData
operator|->
name|Signature
condition|;
name|TableData
operator|++
control|)
block|{
if|if
condition|(
name|ACPI_COMPARE_NAME
argument_list|(
name|Signature
argument_list|,
name|TableData
operator|->
name|Signature
argument_list|)
condition|)
block|{
return|return
operator|(
name|TableData
operator|)
return|;
block|}
block|}
return|return
operator|(
name|NULL
operator|)
return|;
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpDataTable  *  * PARAMETERS:  Table               - An ACPI table  *  * RETURN:      None.  *  * DESCRIPTION: Format the contents of an ACPI data table (any table other  *              than an SSDT or DSDT that does not contain executable AML code)  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmDumpDataTable
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|ACPI_STATUS
name|Status
decl_stmt|;
name|ACPI_DMTABLE_DATA
modifier|*
name|TableData
decl_stmt|;
name|UINT32
name|Length
decl_stmt|;
comment|/* Ignore tables that contain AML */
if|if
condition|(
name|AcpiUtIsAmlTable
argument_list|(
name|Table
argument_list|)
condition|)
block|{
if|if
condition|(
name|Gbl_VerboseTemplates
condition|)
block|{
comment|/* Dump the raw table data */
name|Length
operator|=
name|Table
operator|->
name|Length
expr_stmt|;
name|AcpiOsPrintf
argument_list|(
literal|"\n/*\n%s: Length %d (0x%X)\n\n"
argument_list|,
name|ACPI_RAW_TABLE_DATA_HEADER
argument_list|,
name|Length
argument_list|,
name|Length
argument_list|)
expr_stmt|;
name|AcpiUtDumpBuffer
argument_list|(
name|ACPI_CAST_PTR
argument_list|(
name|UINT8
argument_list|,
name|Table
argument_list|)
argument_list|,
name|Length
argument_list|,
name|DB_BYTE_DISPLAY
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|AcpiOsPrintf
argument_list|(
literal|" */\n"
argument_list|)
expr_stmt|;
block|}
return|return;
block|}
comment|/*      * Handle tables that don't use the common ACPI table header structure.      * Currently, these are the FACS, RSDP, and S3PT.      */
if|if
condition|(
name|ACPI_COMPARE_NAME
argument_list|(
name|Table
operator|->
name|Signature
argument_list|,
name|ACPI_SIG_FACS
argument_list|)
condition|)
block|{
name|Length
operator|=
name|Table
operator|->
name|Length
expr_stmt|;
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoFacs
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|ACPI_COMPARE_NAME
argument_list|(
name|Table
operator|->
name|Signature
argument_list|,
name|ACPI_SIG_RSDP
argument_list|)
condition|)
block|{
name|Length
operator|=
name|AcpiDmDumpRsdp
argument_list|(
name|Table
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|ACPI_COMPARE_NAME
argument_list|(
name|Table
operator|->
name|Signature
argument_list|,
name|ACPI_SIG_S3PT
argument_list|)
condition|)
block|{
name|Length
operator|=
name|AcpiDmDumpS3pt
argument_list|(
name|Table
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|/*          * All other tables must use the common ACPI table header, dump it now          */
name|Length
operator|=
name|Table
operator|->
name|Length
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoHeader
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
comment|/* Match signature and dispatch appropriately */
name|TableData
operator|=
name|AcpiDmGetTableData
argument_list|(
name|Table
operator|->
name|Signature
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|TableData
condition|)
block|{
if|if
condition|(
operator|!
name|ACPI_STRNCMP
argument_list|(
name|Table
operator|->
name|Signature
argument_list|,
literal|"OEM"
argument_list|,
literal|3
argument_list|)
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"\n**** OEM-defined ACPI table [%4.4s], unknown contents\n\n"
argument_list|,
name|Table
operator|->
name|Signature
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|AcpiOsPrintf
argument_list|(
literal|"\n**** Unknown ACPI table type [%4.4s]\n\n"
argument_list|,
name|Table
operator|->
name|Signature
argument_list|)
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|TableData
operator|->
name|TableHandler
condition|)
block|{
comment|/* Complex table, has a handler */
name|TableData
operator|->
name|TableHandler
argument_list|(
name|Table
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|TableData
operator|->
name|TableInfo
condition|)
block|{
comment|/* Simple table, just walk the info table */
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|TableData
operator|->
name|TableInfo
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
operator|!
name|Gbl_DoTemplates
operator|||
name|Gbl_VerboseTemplates
condition|)
block|{
comment|/* Dump the raw table data */
name|AcpiOsPrintf
argument_list|(
literal|"\n%s: Length %d (0x%X)\n\n"
argument_list|,
name|ACPI_RAW_TABLE_DATA_HEADER
argument_list|,
name|Length
argument_list|,
name|Length
argument_list|)
expr_stmt|;
name|AcpiUtDumpBuffer
argument_list|(
name|ACPI_CAST_PTR
argument_list|(
name|UINT8
argument_list|,
name|Table
argument_list|)
argument_list|,
name|Length
argument_list|,
name|DB_BYTE_DISPLAY
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmLineHeader  *  * PARAMETERS:  Offset              - Current byte offset, from table start  *              ByteLength          - Length of the field in bytes, 0 for flags  *              Name                - Name of this field  *              Value               - Optional value, displayed on left of ':'  *  * RETURN:      None  *  * DESCRIPTION: Utility routines for formatting output lines. Displays the  *              current table offset in hex and decimal, the field length,  *              and the field name.  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmLineHeader
parameter_list|(
name|UINT32
name|Offset
parameter_list|,
name|UINT32
name|ByteLength
parameter_list|,
name|char
modifier|*
name|Name
parameter_list|)
block|{
comment|/* Allow a null name for fields that span multiple lines (large buffers) */
if|if
condition|(
operator|!
name|Name
condition|)
block|{
name|Name
operator|=
literal|""
expr_stmt|;
block|}
if|if
condition|(
name|Gbl_DoTemplates
operator|&&
operator|!
name|Gbl_VerboseTemplates
condition|)
comment|/* Terse template */
block|{
if|if
condition|(
name|ByteLength
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"[%.4d] %34s : "
argument_list|,
name|ByteLength
argument_list|,
name|Name
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
operator|*
name|Name
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"%41s : "
argument_list|,
name|Name
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|AcpiOsPrintf
argument_list|(
literal|"%41s   "
argument_list|,
name|Name
argument_list|)
expr_stmt|;
block|}
block|}
block|}
else|else
comment|/* Normal disassembler or verbose template */
block|{
if|if
condition|(
name|ByteLength
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"[%3.3Xh %4.4d% 4d] %28s : "
argument_list|,
name|Offset
argument_list|,
name|Offset
argument_list|,
name|ByteLength
argument_list|,
name|Name
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
operator|*
name|Name
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"%44s : "
argument_list|,
name|Name
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|AcpiOsPrintf
argument_list|(
literal|"%44s   "
argument_list|,
name|Name
argument_list|)
expr_stmt|;
block|}
block|}
block|}
block|}
end_function

begin_function
name|void
name|AcpiDmLineHeader2
parameter_list|(
name|UINT32
name|Offset
parameter_list|,
name|UINT32
name|ByteLength
parameter_list|,
name|char
modifier|*
name|Name
parameter_list|,
name|UINT32
name|Value
parameter_list|)
block|{
if|if
condition|(
name|Gbl_DoTemplates
operator|&&
operator|!
name|Gbl_VerboseTemplates
condition|)
comment|/* Terse template */
block|{
if|if
condition|(
name|ByteLength
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"[%.4d] %30s %3d : "
argument_list|,
name|ByteLength
argument_list|,
name|Name
argument_list|,
name|Value
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|AcpiOsPrintf
argument_list|(
literal|"%36s % 3d : "
argument_list|,
name|Name
argument_list|,
name|Value
argument_list|)
expr_stmt|;
block|}
block|}
else|else
comment|/* Normal disassembler or verbose template */
block|{
if|if
condition|(
name|ByteLength
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"[%3.3Xh %4.4d %3d] %24s %3d : "
argument_list|,
name|Offset
argument_list|,
name|Offset
argument_list|,
name|ByteLength
argument_list|,
name|Name
argument_list|,
name|Value
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|AcpiOsPrintf
argument_list|(
literal|"[%3.3Xh %4.4d   ] %24s %3d : "
argument_list|,
name|Offset
argument_list|,
name|Offset
argument_list|,
name|Name
argument_list|,
name|Value
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpTable  *  * PARAMETERS:  TableLength         - Length of the entire ACPI table  *              TableOffset         - Starting offset within the table for this  *                                    sub-descriptor (0 if main table)  *              Table               - The ACPI table  *              SubtableLength      - Length of this sub-descriptor  *              Info                - Info table for this ACPI table  *  * RETURN:      None  *  * DESCRIPTION: Display ACPI table contents by walking the Info table.  *  * Note: This function must remain in sync with DtGetFieldLength.  *  ******************************************************************************/
end_comment

begin_function
name|ACPI_STATUS
name|AcpiDmDumpTable
parameter_list|(
name|UINT32
name|TableLength
parameter_list|,
name|UINT32
name|TableOffset
parameter_list|,
name|void
modifier|*
name|Table
parameter_list|,
name|UINT32
name|SubtableLength
parameter_list|,
name|ACPI_DMTABLE_INFO
modifier|*
name|Info
parameter_list|)
block|{
name|UINT8
modifier|*
name|Target
decl_stmt|;
name|UINT32
name|CurrentOffset
decl_stmt|;
name|UINT32
name|ByteLength
decl_stmt|;
name|UINT8
name|Temp8
decl_stmt|;
name|UINT16
name|Temp16
decl_stmt|;
name|ACPI_DMTABLE_DATA
modifier|*
name|TableData
decl_stmt|;
specifier|const
name|char
modifier|*
name|Name
decl_stmt|;
name|BOOLEAN
name|LastOutputBlankLine
init|=
name|FALSE
decl_stmt|;
name|char
name|RepairedName
index|[
literal|8
index|]
decl_stmt|;
if|if
condition|(
operator|!
name|Info
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"Display not implemented\n"
argument_list|)
expr_stmt|;
return|return
operator|(
name|AE_NOT_IMPLEMENTED
operator|)
return|;
block|}
comment|/* Walk entire Info table; Null name terminates */
for|for
control|(
init|;
name|Info
operator|->
name|Name
condition|;
name|Info
operator|++
control|)
block|{
comment|/*          * Target points to the field within the ACPI Table. CurrentOffset is          * the offset of the field from the start of the main table.          */
name|Target
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|UINT8
argument_list|,
name|Table
argument_list|,
name|Info
operator|->
name|Offset
argument_list|)
expr_stmt|;
name|CurrentOffset
operator|=
name|TableOffset
operator|+
name|Info
operator|->
name|Offset
expr_stmt|;
comment|/* Check for beyond EOT or beyond subtable end */
if|if
condition|(
operator|(
name|CurrentOffset
operator|>=
name|TableLength
operator|)
operator|||
operator|(
name|SubtableLength
operator|&&
operator|(
name|Info
operator|->
name|Offset
operator|>=
name|SubtableLength
operator|)
operator|)
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"**** ACPI table terminates in the middle of a data structure!\n"
argument_list|)
expr_stmt|;
return|return
operator|(
name|AE_BAD_DATA
operator|)
return|;
block|}
comment|/* Generate the byte length for this field */
switch|switch
condition|(
name|Info
operator|->
name|Opcode
condition|)
block|{
case|case
name|ACPI_DMT_UINT8
case|:
case|case
name|ACPI_DMT_CHKSUM
case|:
case|case
name|ACPI_DMT_SPACEID
case|:
case|case
name|ACPI_DMT_ACCWIDTH
case|:
case|case
name|ACPI_DMT_IVRS
case|:
case|case
name|ACPI_DMT_MADT
case|:
case|case
name|ACPI_DMT_PMTT
case|:
case|case
name|ACPI_DMT_SRAT
case|:
case|case
name|ACPI_DMT_ASF
case|:
case|case
name|ACPI_DMT_HESTNTYP
case|:
case|case
name|ACPI_DMT_FADTPM
case|:
case|case
name|ACPI_DMT_EINJACT
case|:
case|case
name|ACPI_DMT_EINJINST
case|:
case|case
name|ACPI_DMT_ERSTACT
case|:
case|case
name|ACPI_DMT_ERSTINST
case|:
name|ByteLength
operator|=
literal|1
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_UINT16
case|:
case|case
name|ACPI_DMT_DMAR
case|:
case|case
name|ACPI_DMT_HEST
case|:
name|ByteLength
operator|=
literal|2
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_UINT24
case|:
name|ByteLength
operator|=
literal|3
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_UINT32
case|:
case|case
name|ACPI_DMT_NAME4
case|:
case|case
name|ACPI_DMT_SIG
case|:
case|case
name|ACPI_DMT_SLIC
case|:
name|ByteLength
operator|=
literal|4
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_UINT40
case|:
name|ByteLength
operator|=
literal|5
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_UINT48
case|:
case|case
name|ACPI_DMT_NAME6
case|:
name|ByteLength
operator|=
literal|6
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_UINT56
case|:
case|case
name|ACPI_DMT_BUF7
case|:
name|ByteLength
operator|=
literal|7
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_UINT64
case|:
case|case
name|ACPI_DMT_NAME8
case|:
name|ByteLength
operator|=
literal|8
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_BUF16
case|:
case|case
name|ACPI_DMT_UUID
case|:
name|ByteLength
operator|=
literal|16
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_BUF128
case|:
name|ByteLength
operator|=
literal|128
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_STRING
case|:
name|ByteLength
operator|=
name|ACPI_STRLEN
argument_list|(
name|ACPI_CAST_PTR
argument_list|(
name|char
argument_list|,
name|Target
argument_list|)
argument_list|)
operator|+
literal|1
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_GAS
case|:
if|if
condition|(
operator|!
name|LastOutputBlankLine
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|LastOutputBlankLine
operator|=
name|TRUE
expr_stmt|;
block|}
name|ByteLength
operator|=
sizeof|sizeof
argument_list|(
name|ACPI_GENERIC_ADDRESS
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_HESTNTFY
case|:
if|if
condition|(
operator|!
name|LastOutputBlankLine
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|LastOutputBlankLine
operator|=
name|TRUE
expr_stmt|;
block|}
name|ByteLength
operator|=
sizeof|sizeof
argument_list|(
name|ACPI_HEST_NOTIFY
argument_list|)
expr_stmt|;
break|break;
default|default:
name|ByteLength
operator|=
literal|0
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|CurrentOffset
operator|+
name|ByteLength
operator|>
name|TableLength
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"**** ACPI table terminates in the middle of a data structure!\n"
argument_list|)
expr_stmt|;
return|return
operator|(
name|AE_BAD_DATA
operator|)
return|;
block|}
if|if
condition|(
name|Info
operator|->
name|Opcode
operator|==
name|ACPI_DMT_EXTRA_TEXT
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"%s"
argument_list|,
name|Info
operator|->
name|Name
argument_list|)
expr_stmt|;
continue|continue;
block|}
comment|/* Start a new line and decode the opcode */
name|AcpiDmLineHeader
argument_list|(
name|CurrentOffset
argument_list|,
name|ByteLength
argument_list|,
name|Info
operator|->
name|Name
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|Info
operator|->
name|Opcode
condition|)
block|{
comment|/* Single-bit Flag fields. Note: Opcode is the bit position */
case|case
name|ACPI_DMT_FLAG0
case|:
case|case
name|ACPI_DMT_FLAG1
case|:
case|case
name|ACPI_DMT_FLAG2
case|:
case|case
name|ACPI_DMT_FLAG3
case|:
case|case
name|ACPI_DMT_FLAG4
case|:
case|case
name|ACPI_DMT_FLAG5
case|:
case|case
name|ACPI_DMT_FLAG6
case|:
case|case
name|ACPI_DMT_FLAG7
case|:
name|AcpiOsPrintf
argument_list|(
literal|"%1.1X\n"
argument_list|,
operator|(
operator|*
name|Target
operator|>>
name|Info
operator|->
name|Opcode
operator|)
operator|&
literal|0x01
argument_list|)
expr_stmt|;
break|break;
comment|/* 2-bit Flag fields */
case|case
name|ACPI_DMT_FLAGS0
case|:
name|AcpiOsPrintf
argument_list|(
literal|"%1.1X\n"
argument_list|,
operator|*
name|Target
operator|&
literal|0x03
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_FLAGS1
case|:
name|AcpiOsPrintf
argument_list|(
literal|"%1.1X\n"
argument_list|,
operator|(
operator|*
name|Target
operator|>>
literal|1
operator|)
operator|&
literal|0x03
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_FLAGS2
case|:
name|AcpiOsPrintf
argument_list|(
literal|"%1.1X\n"
argument_list|,
operator|(
operator|*
name|Target
operator|>>
literal|2
operator|)
operator|&
literal|0x03
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_FLAGS4
case|:
name|AcpiOsPrintf
argument_list|(
literal|"%1.1X\n"
argument_list|,
operator|(
operator|*
name|Target
operator|>>
literal|4
operator|)
operator|&
literal|0x03
argument_list|)
expr_stmt|;
break|break;
comment|/* Integer Data Types */
case|case
name|ACPI_DMT_UINT8
case|:
case|case
name|ACPI_DMT_UINT16
case|:
case|case
name|ACPI_DMT_UINT24
case|:
case|case
name|ACPI_DMT_UINT32
case|:
case|case
name|ACPI_DMT_UINT40
case|:
case|case
name|ACPI_DMT_UINT48
case|:
case|case
name|ACPI_DMT_UINT56
case|:
case|case
name|ACPI_DMT_UINT64
case|:
comment|/*              * Dump bytes - high byte first, low byte last.              * Note: All ACPI tables are little-endian.              */
for|for
control|(
name|Temp8
operator|=
operator|(
name|UINT8
operator|)
name|ByteLength
init|;
name|Temp8
operator|>
literal|0
condition|;
name|Temp8
operator|--
control|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"%2.2X"
argument_list|,
name|Target
index|[
name|Temp8
operator|-
literal|1
index|]
argument_list|)
expr_stmt|;
block|}
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_BUF7
case|:
case|case
name|ACPI_DMT_BUF16
case|:
case|case
name|ACPI_DMT_BUF128
case|:
comment|/*              * Buffer: Size depends on the opcode and was set above.              * Each hex byte is separated with a space.              * Multiple lines are separated by line continuation char.              */
for|for
control|(
name|Temp16
operator|=
literal|0
init|;
name|Temp16
operator|<
name|ByteLength
condition|;
name|Temp16
operator|++
control|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"%2.2X"
argument_list|,
name|Target
index|[
name|Temp16
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
call|(
name|UINT32
call|)
argument_list|(
name|Temp16
operator|+
literal|1
argument_list|)
operator|<
name|ByteLength
condition|)
block|{
if|if
condition|(
operator|(
name|Temp16
operator|>
literal|0
operator|)
operator|&&
operator|(
operator|!
operator|(
operator|(
name|Temp16
operator|+
literal|1
operator|)
operator|%
literal|16
operator|)
operator|)
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|" \\\n"
argument_list|)
expr_stmt|;
comment|/* Line continuation */
name|AcpiDmLineHeader
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|AcpiOsPrintf
argument_list|(
literal|" "
argument_list|)
expr_stmt|;
block|}
block|}
block|}
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_UUID
case|:
comment|/* Convert 16-byte UUID buffer to 36-byte formatted UUID string */
operator|(
name|void
operator|)
name|AuConvertUuidToString
argument_list|(
operator|(
name|char
operator|*
operator|)
name|Target
argument_list|,
name|MsgBuffer
argument_list|)
expr_stmt|;
name|AcpiOsPrintf
argument_list|(
literal|"%s\n"
argument_list|,
name|MsgBuffer
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_STRING
case|:
name|AcpiOsPrintf
argument_list|(
literal|"\"%s\"\n"
argument_list|,
name|ACPI_CAST_PTR
argument_list|(
name|char
argument_list|,
name|Target
argument_list|)
argument_list|)
expr_stmt|;
break|break;
comment|/* Fixed length ASCII name fields */
case|case
name|ACPI_DMT_SIG
case|:
name|AcpiDmCheckAscii
argument_list|(
name|Target
argument_list|,
name|RepairedName
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AcpiOsPrintf
argument_list|(
literal|"\"%.4s\"    "
argument_list|,
name|RepairedName
argument_list|)
expr_stmt|;
name|TableData
operator|=
name|AcpiDmGetTableData
argument_list|(
name|ACPI_CAST_PTR
argument_list|(
name|char
argument_list|,
name|Target
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|TableData
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
name|STRING_FORMAT
argument_list|,
name|TableData
operator|->
name|Name
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|ACPI_DMT_NAME4
case|:
name|AcpiDmCheckAscii
argument_list|(
name|Target
argument_list|,
name|RepairedName
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|AcpiOsPrintf
argument_list|(
literal|"\"%.4s\"\n"
argument_list|,
name|RepairedName
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_NAME6
case|:
name|AcpiDmCheckAscii
argument_list|(
name|Target
argument_list|,
name|RepairedName
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|AcpiOsPrintf
argument_list|(
literal|"\"%.6s\"\n"
argument_list|,
name|RepairedName
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_NAME8
case|:
name|AcpiDmCheckAscii
argument_list|(
name|Target
argument_list|,
name|RepairedName
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|AcpiOsPrintf
argument_list|(
literal|"\"%.8s\"\n"
argument_list|,
name|RepairedName
argument_list|)
expr_stmt|;
break|break;
comment|/* Special Data Types */
case|case
name|ACPI_DMT_CHKSUM
case|:
comment|/* Checksum, display and validate */
name|AcpiOsPrintf
argument_list|(
literal|"%2.2X"
argument_list|,
operator|*
name|Target
argument_list|)
expr_stmt|;
name|Temp8
operator|=
name|AcpiDmGenerateChecksum
argument_list|(
name|Table
argument_list|,
name|ACPI_CAST_PTR
argument_list|(
name|ACPI_TABLE_HEADER
argument_list|,
name|Table
argument_list|)
operator|->
name|Length
argument_list|,
name|ACPI_CAST_PTR
argument_list|(
name|ACPI_TABLE_HEADER
argument_list|,
name|Table
argument_list|)
operator|->
name|Checksum
argument_list|)
expr_stmt|;
if|if
condition|(
name|Temp8
operator|!=
name|ACPI_CAST_PTR
argument_list|(
name|ACPI_TABLE_HEADER
argument_list|,
name|Table
argument_list|)
operator|->
name|Checksum
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"     /* Incorrect checksum, should be %2.2X */"
argument_list|,
name|Temp8
argument_list|)
expr_stmt|;
block|}
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_SPACEID
case|:
comment|/* Address Space ID */
name|AcpiOsPrintf
argument_list|(
name|UINT8_FORMAT
argument_list|,
operator|*
name|Target
argument_list|,
name|AcpiUtGetRegionName
argument_list|(
operator|*
name|Target
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_ACCWIDTH
case|:
comment|/* Encoded Access Width */
name|Temp8
operator|=
operator|*
name|Target
expr_stmt|;
if|if
condition|(
name|Temp8
operator|>
name|ACPI_GAS_WIDTH_RESERVED
condition|)
block|{
name|Temp8
operator|=
name|ACPI_GAS_WIDTH_RESERVED
expr_stmt|;
block|}
name|AcpiOsPrintf
argument_list|(
name|UINT8_FORMAT
argument_list|,
name|Temp8
argument_list|,
name|AcpiDmGasAccessWidth
index|[
name|Temp8
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_GAS
case|:
comment|/* Generic Address Structure */
name|AcpiOsPrintf
argument_list|(
name|STRING_FORMAT
argument_list|,
literal|"Generic Address Structure"
argument_list|)
expr_stmt|;
name|AcpiDmDumpTable
argument_list|(
name|TableLength
argument_list|,
name|CurrentOffset
argument_list|,
name|Target
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_GENERIC_ADDRESS
argument_list|)
argument_list|,
name|AcpiDmTableInfoGas
argument_list|)
expr_stmt|;
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|LastOutputBlankLine
operator|=
name|TRUE
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_ASF
case|:
comment|/* ASF subtable types */
name|Temp16
operator|=
call|(
name|UINT16
call|)
argument_list|(
operator|(
operator|*
name|Target
operator|)
operator|&
literal|0x7F
argument_list|)
expr_stmt|;
comment|/* Top bit can be zero or one */
if|if
condition|(
name|Temp16
operator|>
name|ACPI_ASF_TYPE_RESERVED
condition|)
block|{
name|Temp16
operator|=
name|ACPI_ASF_TYPE_RESERVED
expr_stmt|;
block|}
name|AcpiOsPrintf
argument_list|(
name|UINT8_FORMAT
argument_list|,
operator|*
name|Target
argument_list|,
name|AcpiDmAsfSubnames
index|[
name|Temp16
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_DMAR
case|:
comment|/* DMAR subtable types */
name|Temp16
operator|=
name|ACPI_GET16
argument_list|(
name|Target
argument_list|)
expr_stmt|;
if|if
condition|(
name|Temp16
operator|>
name|ACPI_DMAR_TYPE_RESERVED
condition|)
block|{
name|Temp16
operator|=
name|ACPI_DMAR_TYPE_RESERVED
expr_stmt|;
block|}
name|AcpiOsPrintf
argument_list|(
name|UINT16_FORMAT
argument_list|,
name|ACPI_GET16
argument_list|(
name|Target
argument_list|)
argument_list|,
name|AcpiDmDmarSubnames
index|[
name|Temp16
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_EINJACT
case|:
comment|/* EINJ Action types */
name|Temp8
operator|=
operator|*
name|Target
expr_stmt|;
if|if
condition|(
name|Temp8
operator|>
name|ACPI_EINJ_ACTION_RESERVED
condition|)
block|{
name|Temp8
operator|=
name|ACPI_EINJ_ACTION_RESERVED
expr_stmt|;
block|}
name|AcpiOsPrintf
argument_list|(
name|UINT8_FORMAT
argument_list|,
operator|*
name|Target
argument_list|,
name|AcpiDmEinjActions
index|[
name|Temp8
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_EINJINST
case|:
comment|/* EINJ Instruction types */
name|Temp8
operator|=
operator|*
name|Target
expr_stmt|;
if|if
condition|(
name|Temp8
operator|>
name|ACPI_EINJ_INSTRUCTION_RESERVED
condition|)
block|{
name|Temp8
operator|=
name|ACPI_EINJ_INSTRUCTION_RESERVED
expr_stmt|;
block|}
name|AcpiOsPrintf
argument_list|(
name|UINT8_FORMAT
argument_list|,
operator|*
name|Target
argument_list|,
name|AcpiDmEinjInstructions
index|[
name|Temp8
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_ERSTACT
case|:
comment|/* ERST Action types */
name|Temp8
operator|=
operator|*
name|Target
expr_stmt|;
if|if
condition|(
name|Temp8
operator|>
name|ACPI_ERST_ACTION_RESERVED
condition|)
block|{
name|Temp8
operator|=
name|ACPI_ERST_ACTION_RESERVED
expr_stmt|;
block|}
name|AcpiOsPrintf
argument_list|(
name|UINT8_FORMAT
argument_list|,
operator|*
name|Target
argument_list|,
name|AcpiDmErstActions
index|[
name|Temp8
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_ERSTINST
case|:
comment|/* ERST Instruction types */
name|Temp8
operator|=
operator|*
name|Target
expr_stmt|;
if|if
condition|(
name|Temp8
operator|>
name|ACPI_ERST_INSTRUCTION_RESERVED
condition|)
block|{
name|Temp8
operator|=
name|ACPI_ERST_INSTRUCTION_RESERVED
expr_stmt|;
block|}
name|AcpiOsPrintf
argument_list|(
name|UINT8_FORMAT
argument_list|,
operator|*
name|Target
argument_list|,
name|AcpiDmErstInstructions
index|[
name|Temp8
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_HEST
case|:
comment|/* HEST subtable types */
name|Temp16
operator|=
name|ACPI_GET16
argument_list|(
name|Target
argument_list|)
expr_stmt|;
if|if
condition|(
name|Temp16
operator|>
name|ACPI_HEST_TYPE_RESERVED
condition|)
block|{
name|Temp16
operator|=
name|ACPI_HEST_TYPE_RESERVED
expr_stmt|;
block|}
name|AcpiOsPrintf
argument_list|(
name|UINT16_FORMAT
argument_list|,
name|ACPI_GET16
argument_list|(
name|Target
argument_list|)
argument_list|,
name|AcpiDmHestSubnames
index|[
name|Temp16
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_HESTNTFY
case|:
name|AcpiOsPrintf
argument_list|(
name|STRING_FORMAT
argument_list|,
literal|"Hardware Error Notification Structure"
argument_list|)
expr_stmt|;
name|AcpiDmDumpTable
argument_list|(
name|TableLength
argument_list|,
name|CurrentOffset
argument_list|,
name|Target
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_HEST_NOTIFY
argument_list|)
argument_list|,
name|AcpiDmTableInfoHestNotify
argument_list|)
expr_stmt|;
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|LastOutputBlankLine
operator|=
name|TRUE
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_HESTNTYP
case|:
comment|/* HEST Notify types */
name|Temp8
operator|=
operator|*
name|Target
expr_stmt|;
if|if
condition|(
name|Temp8
operator|>
name|ACPI_HEST_NOTIFY_RESERVED
condition|)
block|{
name|Temp8
operator|=
name|ACPI_HEST_NOTIFY_RESERVED
expr_stmt|;
block|}
name|AcpiOsPrintf
argument_list|(
name|UINT8_FORMAT
argument_list|,
operator|*
name|Target
argument_list|,
name|AcpiDmHestNotifySubnames
index|[
name|Temp8
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_MADT
case|:
comment|/* MADT subtable types */
name|Temp8
operator|=
operator|*
name|Target
expr_stmt|;
if|if
condition|(
name|Temp8
operator|>
name|ACPI_MADT_TYPE_RESERVED
condition|)
block|{
name|Temp8
operator|=
name|ACPI_MADT_TYPE_RESERVED
expr_stmt|;
block|}
name|AcpiOsPrintf
argument_list|(
name|UINT8_FORMAT
argument_list|,
operator|*
name|Target
argument_list|,
name|AcpiDmMadtSubnames
index|[
name|Temp8
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_PMTT
case|:
comment|/* PMTT subtable types */
name|Temp8
operator|=
operator|*
name|Target
expr_stmt|;
if|if
condition|(
name|Temp8
operator|>
name|ACPI_PMTT_TYPE_RESERVED
condition|)
block|{
name|Temp8
operator|=
name|ACPI_PMTT_TYPE_RESERVED
expr_stmt|;
block|}
name|AcpiOsPrintf
argument_list|(
name|UINT8_FORMAT
argument_list|,
operator|*
name|Target
argument_list|,
name|AcpiDmPmttSubnames
index|[
name|Temp8
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_SLIC
case|:
comment|/* SLIC subtable types */
name|Temp8
operator|=
operator|*
name|Target
expr_stmt|;
if|if
condition|(
name|Temp8
operator|>
name|ACPI_SLIC_TYPE_RESERVED
condition|)
block|{
name|Temp8
operator|=
name|ACPI_SLIC_TYPE_RESERVED
expr_stmt|;
block|}
name|AcpiOsPrintf
argument_list|(
name|UINT32_FORMAT
argument_list|,
operator|*
name|Target
argument_list|,
name|AcpiDmSlicSubnames
index|[
name|Temp8
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_SRAT
case|:
comment|/* SRAT subtable types */
name|Temp8
operator|=
operator|*
name|Target
expr_stmt|;
if|if
condition|(
name|Temp8
operator|>
name|ACPI_SRAT_TYPE_RESERVED
condition|)
block|{
name|Temp8
operator|=
name|ACPI_SRAT_TYPE_RESERVED
expr_stmt|;
block|}
name|AcpiOsPrintf
argument_list|(
name|UINT8_FORMAT
argument_list|,
operator|*
name|Target
argument_list|,
name|AcpiDmSratSubnames
index|[
name|Temp8
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_FADTPM
case|:
comment|/* FADT Preferred PM Profile names */
name|Temp8
operator|=
operator|*
name|Target
expr_stmt|;
if|if
condition|(
name|Temp8
operator|>
name|ACPI_FADT_PM_RESERVED
condition|)
block|{
name|Temp8
operator|=
name|ACPI_FADT_PM_RESERVED
expr_stmt|;
block|}
name|AcpiOsPrintf
argument_list|(
name|UINT8_FORMAT
argument_list|,
operator|*
name|Target
argument_list|,
name|AcpiDmFadtProfiles
index|[
name|Temp8
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_IVRS
case|:
comment|/* IVRS subtable types */
name|Temp8
operator|=
operator|*
name|Target
expr_stmt|;
switch|switch
condition|(
name|Temp8
condition|)
block|{
case|case
name|ACPI_IVRS_TYPE_HARDWARE
case|:
name|Name
operator|=
name|AcpiDmIvrsSubnames
index|[
literal|0
index|]
expr_stmt|;
break|break;
case|case
name|ACPI_IVRS_TYPE_MEMORY1
case|:
case|case
name|ACPI_IVRS_TYPE_MEMORY2
case|:
case|case
name|ACPI_IVRS_TYPE_MEMORY3
case|:
name|Name
operator|=
name|AcpiDmIvrsSubnames
index|[
literal|1
index|]
expr_stmt|;
break|break;
default|default:
name|Name
operator|=
name|AcpiDmIvrsSubnames
index|[
literal|2
index|]
expr_stmt|;
break|break;
block|}
name|AcpiOsPrintf
argument_list|(
name|UINT8_FORMAT
argument_list|,
operator|*
name|Target
argument_list|,
name|Name
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMT_EXIT
case|:
return|return
operator|(
name|AE_OK
operator|)
return|;
default|default:
name|ACPI_ERROR
argument_list|(
operator|(
name|AE_INFO
operator|,
literal|"**** Invalid table opcode [0x%X] ****\n"
operator|,
name|Info
operator|->
name|Opcode
operator|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|AE_SUPPORT
operator|)
return|;
block|}
block|}
if|if
condition|(
name|TableOffset
operator|&&
operator|!
name|SubtableLength
condition|)
block|{
comment|/* If this table is not the main table, subtable must have valid length */
name|AcpiOsPrintf
argument_list|(
literal|"Invalid zero length subtable\n"
argument_list|)
expr_stmt|;
return|return
operator|(
name|AE_BAD_DATA
operator|)
return|;
block|}
return|return
operator|(
name|AE_OK
operator|)
return|;
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmCheckAscii  *  * PARAMETERS:  Name                - Ascii string  *              Count               - Number of characters to check  *  * RETURN:      None  *  * DESCRIPTION: Ensure that the requested number of characters are printable  *              Ascii characters. Sets non-printable and null chars to<space>.  *  ******************************************************************************/
end_comment

begin_function
specifier|static
name|void
name|AcpiDmCheckAscii
parameter_list|(
name|UINT8
modifier|*
name|Name
parameter_list|,
name|char
modifier|*
name|RepairedName
parameter_list|,
name|UINT32
name|Count
parameter_list|)
block|{
name|UINT32
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|Count
condition|;
name|i
operator|++
control|)
block|{
name|RepairedName
index|[
name|i
index|]
operator|=
operator|(
name|char
operator|)
name|Name
index|[
name|i
index|]
expr_stmt|;
if|if
condition|(
operator|!
name|Name
index|[
name|i
index|]
condition|)
block|{
return|return;
block|}
if|if
condition|(
operator|!
name|isprint
argument_list|(
name|Name
index|[
name|i
index|]
argument_list|)
condition|)
block|{
name|RepairedName
index|[
name|i
index|]
operator|=
literal|' '
expr_stmt|;
block|}
block|}
block|}
end_function

end_unit

