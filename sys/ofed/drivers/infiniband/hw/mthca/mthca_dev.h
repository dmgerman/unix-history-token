begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (c) 2004, 2005 Topspin Communications.  All rights reserved.  * Copyright (c) 2005 Sun Microsystems, Inc. All rights reserved.  * Copyright (c) 2005, 2006 Cisco Systems.  All rights reserved.  * Copyright (c) 2005 Mellanox Technologies. All rights reserved.  * Copyright (c) 2004 Voltaire, Inc. All rights reserved.  *  * This software is available to you under a choice of one of two  * licenses.  You may choose to be licensed under the terms of the GNU  * General Public License (GPL) Version 2, available from the file  * COPYING in the main directory of this source tree, or the  * OpenIB.org BSD license below:  *  *     Redistribution and use in source and binary forms, with or  *     without modification, are permitted provided that the following  *     conditions are met:  *  *      - Redistributions of source code must retain the above  *        copyright notice, this list of conditions and the following  *        disclaimer.  *  *      - Redistributions in binary form must reproduce the above  *        copyright notice, this list of conditions and the following  *        disclaimer in the documentation and/or other materials  *        provided with the distribution.  *  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,  * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND  * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS  * BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN  * ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN  * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE  * SOFTWARE.  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|MTHCA_DEV_H
end_ifndef

begin_define
define|#
directive|define
name|MTHCA_DEV_H
end_define

begin_include
include|#
directive|include
file|<linux/spinlock.h>
end_include

begin_include
include|#
directive|include
file|<linux/kernel.h>
end_include

begin_include
include|#
directive|include
file|<linux/pci.h>
end_include

begin_include
include|#
directive|include
file|<linux/dma-mapping.h>
end_include

begin_include
include|#
directive|include
file|<linux/timer.h>
end_include

begin_include
include|#
directive|include
file|<linux/mutex.h>
end_include

begin_include
include|#
directive|include
file|<linux/list.h>
end_include

begin_include
include|#
directive|include
file|<linux/semaphore.h>
end_include

begin_include
include|#
directive|include
file|<linux/wait.h>
end_include

begin_include
include|#
directive|include
file|"mthca_provider.h"
end_include

begin_include
include|#
directive|include
file|"mthca_doorbell.h"
end_include

begin_define
define|#
directive|define
name|DRV_NAME
value|"ib_mthca"
end_define

begin_define
define|#
directive|define
name|PFX
value|DRV_NAME ": "
end_define

begin_define
define|#
directive|define
name|DRV_VERSION
value|"1.0-ofed1.5.2"
end_define

begin_define
define|#
directive|define
name|DRV_RELDATE
value|"August 4, 2010"
end_define

begin_enum
enum|enum
block|{
name|MTHCA_FLAG_DDR_HIDDEN
init|=
literal|1
operator|<<
literal|1
block|,
name|MTHCA_FLAG_SRQ
init|=
literal|1
operator|<<
literal|2
block|,
name|MTHCA_FLAG_MSI_X
init|=
literal|1
operator|<<
literal|3
block|,
name|MTHCA_FLAG_NO_LAM
init|=
literal|1
operator|<<
literal|4
block|,
name|MTHCA_FLAG_FMR
init|=
literal|1
operator|<<
literal|5
block|,
name|MTHCA_FLAG_MEMFREE
init|=
literal|1
operator|<<
literal|6
block|,
name|MTHCA_FLAG_PCIE
init|=
literal|1
operator|<<
literal|7
block|,
name|MTHCA_FLAG_SINAI_OPT
init|=
literal|1
operator|<<
literal|8
block|}
enum|;
end_enum

begin_enum
enum|enum
block|{
name|MTHCA_MAX_PORTS
init|=
literal|2
block|}
enum|;
end_enum

begin_enum
enum|enum
block|{
name|MTHCA_BOARD_ID_LEN
init|=
literal|64
block|}
enum|;
end_enum

begin_enum
enum|enum
block|{
name|MTHCA_EQ_CONTEXT_SIZE
init|=
literal|0x40
block|,
name|MTHCA_CQ_CONTEXT_SIZE
init|=
literal|0x40
block|,
name|MTHCA_QP_CONTEXT_SIZE
init|=
literal|0x200
block|,
name|MTHCA_RDB_ENTRY_SIZE
init|=
literal|0x20
block|,
name|MTHCA_AV_SIZE
init|=
literal|0x20
block|,
name|MTHCA_MGM_ENTRY_SIZE
init|=
literal|0x100
block|,
comment|/* Arbel FW gives us these, but we need them for Tavor */
name|MTHCA_MPT_ENTRY_SIZE
init|=
literal|0x40
block|,
name|MTHCA_MTT_SEG_SIZE
init|=
literal|0x40
block|,
name|MTHCA_QP_PER_MGM
init|=
literal|4
operator|*
operator|(
name|MTHCA_MGM_ENTRY_SIZE
operator|/
literal|16
operator|-
literal|2
operator|)
block|}
enum|;
end_enum

begin_enum
enum|enum
block|{
name|MTHCA_EQ_CMD
block|,
name|MTHCA_EQ_ASYNC
block|,
name|MTHCA_EQ_COMP
block|,
name|MTHCA_NUM_EQ
block|}
enum|;
end_enum

begin_enum
enum|enum
block|{
name|MTHCA_OPCODE_NOP
init|=
literal|0x00
block|,
name|MTHCA_OPCODE_RDMA_WRITE
init|=
literal|0x08
block|,
name|MTHCA_OPCODE_RDMA_WRITE_IMM
init|=
literal|0x09
block|,
name|MTHCA_OPCODE_SEND
init|=
literal|0x0a
block|,
name|MTHCA_OPCODE_SEND_IMM
init|=
literal|0x0b
block|,
name|MTHCA_OPCODE_RDMA_READ
init|=
literal|0x10
block|,
name|MTHCA_OPCODE_ATOMIC_CS
init|=
literal|0x11
block|,
name|MTHCA_OPCODE_ATOMIC_FA
init|=
literal|0x12
block|,
name|MTHCA_OPCODE_BIND_MW
init|=
literal|0x18
block|,
name|MTHCA_OPCODE_INVALID
init|=
literal|0xff
block|}
enum|;
end_enum

begin_enum
enum|enum
block|{
name|MTHCA_CMD_USE_EVENTS
init|=
literal|1
operator|<<
literal|0
block|,
name|MTHCA_CMD_POST_DOORBELLS
init|=
literal|1
operator|<<
literal|1
block|}
enum|;
end_enum

begin_enum
enum|enum
block|{
name|MTHCA_CMD_NUM_DBELL_DWORDS
init|=
literal|8
block|}
enum|;
end_enum

begin_struct
struct|struct
name|mthca_cmd
block|{
name|struct
name|pci_pool
modifier|*
name|pool
decl_stmt|;
name|struct
name|mutex
name|hcr_mutex
decl_stmt|;
name|struct
name|semaphore
name|poll_sem
decl_stmt|;
name|struct
name|semaphore
name|event_sem
decl_stmt|;
name|int
name|max_cmds
decl_stmt|;
name|spinlock_t
name|context_lock
decl_stmt|;
name|int
name|free_head
decl_stmt|;
name|struct
name|mthca_cmd_context
modifier|*
name|context
decl_stmt|;
name|u16
name|token_mask
decl_stmt|;
name|u32
name|flags
decl_stmt|;
name|void
name|__iomem
modifier|*
name|dbell_map
decl_stmt|;
name|u16
name|dbell_offsets
index|[
name|MTHCA_CMD_NUM_DBELL_DWORDS
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|mthca_limits
block|{
name|int
name|num_ports
decl_stmt|;
name|int
name|vl_cap
decl_stmt|;
name|int
name|mtu_cap
decl_stmt|;
name|int
name|gid_table_len
decl_stmt|;
name|int
name|pkey_table_len
decl_stmt|;
name|int
name|local_ca_ack_delay
decl_stmt|;
name|int
name|num_uars
decl_stmt|;
name|int
name|max_sg
decl_stmt|;
name|int
name|num_qps
decl_stmt|;
name|int
name|max_wqes
decl_stmt|;
name|int
name|max_desc_sz
decl_stmt|;
name|int
name|max_qp_init_rdma
decl_stmt|;
name|int
name|reserved_qps
decl_stmt|;
name|int
name|num_srqs
decl_stmt|;
name|int
name|max_srq_wqes
decl_stmt|;
name|int
name|max_srq_sge
decl_stmt|;
name|int
name|reserved_srqs
decl_stmt|;
name|int
name|num_eecs
decl_stmt|;
name|int
name|reserved_eecs
decl_stmt|;
name|int
name|num_cqs
decl_stmt|;
name|int
name|max_cqes
decl_stmt|;
name|int
name|reserved_cqs
decl_stmt|;
name|int
name|num_eqs
decl_stmt|;
name|int
name|reserved_eqs
decl_stmt|;
name|int
name|num_mpts
decl_stmt|;
name|int
name|num_mtt_segs
decl_stmt|;
name|int
name|mtt_seg_size
decl_stmt|;
name|int
name|fmr_reserved_mtts
decl_stmt|;
name|int
name|reserved_mtts
decl_stmt|;
name|int
name|reserved_mrws
decl_stmt|;
name|int
name|reserved_uars
decl_stmt|;
name|int
name|num_mgms
decl_stmt|;
name|int
name|num_amgms
decl_stmt|;
name|int
name|reserved_mcgs
decl_stmt|;
name|int
name|num_pds
decl_stmt|;
name|int
name|reserved_pds
decl_stmt|;
name|u32
name|page_size_cap
decl_stmt|;
name|u32
name|flags
decl_stmt|;
name|u16
name|stat_rate_support
decl_stmt|;
name|u8
name|port_width_cap
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|mthca_alloc
block|{
name|u32
name|last
decl_stmt|;
name|u32
name|top
decl_stmt|;
name|u32
name|max
decl_stmt|;
name|u32
name|mask
decl_stmt|;
name|spinlock_t
name|lock
decl_stmt|;
name|unsigned
name|long
modifier|*
name|table
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|mthca_array
block|{
struct|struct
block|{
name|void
modifier|*
modifier|*
name|page
decl_stmt|;
name|int
name|used
decl_stmt|;
block|}
modifier|*
name|page_list
struct|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|mthca_uar_table
block|{
name|struct
name|mthca_alloc
name|alloc
decl_stmt|;
name|u64
name|uarc_base
decl_stmt|;
name|int
name|uarc_size
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|mthca_pd_table
block|{
name|struct
name|mthca_alloc
name|alloc
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|mthca_buddy
block|{
name|unsigned
name|long
modifier|*
modifier|*
name|bits
decl_stmt|;
name|int
modifier|*
name|num_free
decl_stmt|;
name|int
name|max_order
decl_stmt|;
name|spinlock_t
name|lock
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|mthca_mr_table
block|{
name|struct
name|mthca_alloc
name|mpt_alloc
decl_stmt|;
name|struct
name|mthca_buddy
name|mtt_buddy
decl_stmt|;
name|struct
name|mthca_buddy
modifier|*
name|fmr_mtt_buddy
decl_stmt|;
name|u64
name|mtt_base
decl_stmt|;
name|u64
name|mpt_base
decl_stmt|;
name|struct
name|mthca_icm_table
modifier|*
name|mtt_table
decl_stmt|;
name|struct
name|mthca_icm_table
modifier|*
name|mpt_table
decl_stmt|;
struct|struct
block|{
name|void
name|__iomem
modifier|*
name|mpt_base
decl_stmt|;
name|void
name|__iomem
modifier|*
name|mtt_base
decl_stmt|;
name|struct
name|mthca_buddy
name|mtt_buddy
decl_stmt|;
block|}
name|tavor_fmr
struct|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|mthca_eq_table
block|{
name|struct
name|mthca_alloc
name|alloc
decl_stmt|;
name|void
name|__iomem
modifier|*
name|clr_int
decl_stmt|;
name|u32
name|clr_mask
decl_stmt|;
name|u32
name|arm_mask
decl_stmt|;
name|struct
name|mthca_eq
name|eq
index|[
name|MTHCA_NUM_EQ
index|]
decl_stmt|;
name|u64
name|icm_virt
decl_stmt|;
name|struct
name|page
modifier|*
name|icm_page
decl_stmt|;
name|dma_addr_t
name|icm_dma
decl_stmt|;
name|int
name|have_irq
decl_stmt|;
name|u8
name|inta_pin
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|mthca_cq_table
block|{
name|struct
name|mthca_alloc
name|alloc
decl_stmt|;
name|spinlock_t
name|lock
decl_stmt|;
name|struct
name|mthca_array
name|cq
decl_stmt|;
name|struct
name|mthca_icm_table
modifier|*
name|table
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|mthca_srq_table
block|{
name|struct
name|mthca_alloc
name|alloc
decl_stmt|;
name|spinlock_t
name|lock
decl_stmt|;
name|struct
name|mthca_array
name|srq
decl_stmt|;
name|struct
name|mthca_icm_table
modifier|*
name|table
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|mthca_qp_table
block|{
name|struct
name|mthca_alloc
name|alloc
decl_stmt|;
name|u32
name|rdb_base
decl_stmt|;
name|int
name|rdb_shift
decl_stmt|;
name|int
name|sqp_start
decl_stmt|;
name|spinlock_t
name|lock
decl_stmt|;
name|struct
name|mthca_array
name|qp
decl_stmt|;
name|struct
name|mthca_icm_table
modifier|*
name|qp_table
decl_stmt|;
name|struct
name|mthca_icm_table
modifier|*
name|eqp_table
decl_stmt|;
name|struct
name|mthca_icm_table
modifier|*
name|rdb_table
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|mthca_av_table
block|{
name|struct
name|pci_pool
modifier|*
name|pool
decl_stmt|;
name|int
name|num_ddr_avs
decl_stmt|;
name|u64
name|ddr_av_base
decl_stmt|;
name|void
name|__iomem
modifier|*
name|av_map
decl_stmt|;
name|struct
name|mthca_alloc
name|alloc
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|mthca_mcg_table
block|{
name|struct
name|mutex
name|mutex
decl_stmt|;
name|struct
name|mthca_alloc
name|alloc
decl_stmt|;
name|struct
name|mthca_icm_table
modifier|*
name|table
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|mthca_catas_err
block|{
name|u64
name|addr
decl_stmt|;
name|u32
name|__iomem
modifier|*
name|map
decl_stmt|;
name|u32
name|size
decl_stmt|;
name|struct
name|timer_list
name|timer
decl_stmt|;
name|struct
name|list_head
name|list
decl_stmt|;
block|}
struct|;
end_struct

begin_decl_stmt
specifier|extern
name|struct
name|mutex
name|mthca_device_mutex
decl_stmt|;
end_decl_stmt

begin_struct
struct|struct
name|mthca_dev
block|{
name|struct
name|ib_device
name|ib_dev
decl_stmt|;
name|struct
name|pci_dev
modifier|*
name|pdev
decl_stmt|;
name|int
name|hca_type
decl_stmt|;
name|unsigned
name|long
name|mthca_flags
decl_stmt|;
name|unsigned
name|long
name|device_cap_flags
decl_stmt|;
name|u32
name|rev_id
decl_stmt|;
name|char
name|board_id
index|[
name|MTHCA_BOARD_ID_LEN
index|]
decl_stmt|;
comment|/* firmware info */
name|u64
name|fw_ver
decl_stmt|;
union|union
block|{
struct|struct
block|{
name|u64
name|fw_start
decl_stmt|;
name|u64
name|fw_end
decl_stmt|;
block|}
name|tavor
struct|;
struct|struct
block|{
name|u64
name|clr_int_base
decl_stmt|;
name|u64
name|eq_arm_base
decl_stmt|;
name|u64
name|eq_set_ci_base
decl_stmt|;
name|struct
name|mthca_icm
modifier|*
name|fw_icm
decl_stmt|;
name|struct
name|mthca_icm
modifier|*
name|aux_icm
decl_stmt|;
name|u16
name|fw_pages
decl_stmt|;
block|}
name|arbel
struct|;
block|}
name|fw
union|;
name|u64
name|ddr_start
decl_stmt|;
name|u64
name|ddr_end
decl_stmt|;
name|MTHCA_DECLARE_DOORBELL_LOCK
argument_list|(
argument|doorbell_lock
argument_list|)
name|struct
name|mutex
name|cap_mask_mutex
decl_stmt|;
name|void
name|__iomem
modifier|*
name|hcr
decl_stmt|;
name|void
name|__iomem
modifier|*
name|kar
decl_stmt|;
name|void
name|__iomem
modifier|*
name|clr_base
decl_stmt|;
union|union
block|{
struct|struct
block|{
name|void
name|__iomem
modifier|*
name|ecr_base
decl_stmt|;
block|}
name|tavor
struct|;
struct|struct
block|{
name|void
name|__iomem
modifier|*
name|eq_arm
decl_stmt|;
name|void
name|__iomem
modifier|*
name|eq_set_ci_base
decl_stmt|;
block|}
name|arbel
struct|;
block|}
name|eq_regs
union|;
name|struct
name|mthca_cmd
name|cmd
decl_stmt|;
name|struct
name|mthca_limits
name|limits
decl_stmt|;
name|struct
name|mthca_uar_table
name|uar_table
decl_stmt|;
name|struct
name|mthca_pd_table
name|pd_table
decl_stmt|;
name|struct
name|mthca_mr_table
name|mr_table
decl_stmt|;
name|struct
name|mthca_eq_table
name|eq_table
decl_stmt|;
name|struct
name|mthca_cq_table
name|cq_table
decl_stmt|;
name|struct
name|mthca_srq_table
name|srq_table
decl_stmt|;
name|struct
name|mthca_qp_table
name|qp_table
decl_stmt|;
name|struct
name|mthca_av_table
name|av_table
decl_stmt|;
name|struct
name|mthca_mcg_table
name|mcg_table
decl_stmt|;
name|struct
name|mthca_catas_err
name|catas_err
decl_stmt|;
name|struct
name|mthca_uar
name|driver_uar
decl_stmt|;
name|struct
name|mthca_db_table
modifier|*
name|db_tab
decl_stmt|;
name|struct
name|mthca_pd
name|driver_pd
decl_stmt|;
name|struct
name|mthca_mr
name|driver_mr
decl_stmt|;
name|struct
name|ib_mad_agent
modifier|*
name|send_agent
index|[
name|MTHCA_MAX_PORTS
index|]
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|ib_ah
modifier|*
name|sm_ah
index|[
name|MTHCA_MAX_PORTS
index|]
decl_stmt|;
name|spinlock_t
name|sm_lock
decl_stmt|;
name|u8
name|rate
index|[
name|MTHCA_MAX_PORTS
index|]
decl_stmt|;
name|int
name|active
decl_stmt|;
block|}
struct|;
end_struct

begin_ifdef
ifdef|#
directive|ifdef
name|CONFIG_INFINIBAND_MTHCA_DEBUG
end_ifdef

begin_decl_stmt
specifier|extern
name|int
name|mthca_debug_level
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|mthca_dbg
parameter_list|(
name|mdev
parameter_list|,
name|format
parameter_list|,
name|arg
modifier|...
parameter_list|)
define|\
value|do {								\ 		if (mthca_debug_level)					\ 			dev_printk(KERN_DEBUG,&mdev->pdev->dev, format, ## arg); \ 	} while (0)
end_define

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* CONFIG_INFINIBAND_MTHCA_DEBUG */
end_comment

begin_define
define|#
directive|define
name|mthca_dbg
parameter_list|(
name|mdev
parameter_list|,
name|format
parameter_list|,
name|arg
modifier|...
parameter_list|)
value|do { (void) mdev; } while (0)
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* CONFIG_INFINIBAND_MTHCA_DEBUG */
end_comment

begin_define
define|#
directive|define
name|mthca_err
parameter_list|(
name|mdev
parameter_list|,
name|format
parameter_list|,
name|arg
modifier|...
parameter_list|)
define|\
value|dev_err(&mdev->pdev->dev, format, ## arg)
end_define

begin_define
define|#
directive|define
name|mthca_info
parameter_list|(
name|mdev
parameter_list|,
name|format
parameter_list|,
name|arg
modifier|...
parameter_list|)
define|\
value|dev_info(&mdev->pdev->dev, format, ## arg)
end_define

begin_define
define|#
directive|define
name|mthca_warn
parameter_list|(
name|mdev
parameter_list|,
name|format
parameter_list|,
name|arg
modifier|...
parameter_list|)
define|\
value|dev_warn(&mdev->pdev->dev, format, ## arg)
end_define

begin_function_decl
specifier|extern
name|void
name|__buggy_use_of_MTHCA_GET
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|void
name|__buggy_use_of_MTHCA_PUT
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_define
define|#
directive|define
name|MTHCA_GET
parameter_list|(
name|dest
parameter_list|,
name|source
parameter_list|,
name|offset
parameter_list|)
define|\
value|do {                                                          \ 		void *__p = (char *) (source) + (offset);             \ 		switch (sizeof (dest)) {                              \ 		case 1: (dest) = *(u8 *) __p;       break;	      \ 		case 2: (dest) = be16_to_cpup(__p); break;	      \ 		case 4: (dest) = be32_to_cpup(__p); break;	      \ 		case 8: (dest) = be64_to_cpup(__p); break;	      \ 		default: __buggy_use_of_MTHCA_GET();		      \ 		}                                                     \ 	} while (0)
end_define

begin_define
define|#
directive|define
name|MTHCA_PUT
parameter_list|(
name|dest
parameter_list|,
name|source
parameter_list|,
name|offset
parameter_list|)
define|\
value|do {                                                          \ 		void *__d = ((char *) (dest) + (offset));	      \ 		switch (sizeof(source)) {                             \ 		case 1: *(u8 *) __d = (source);                break; \ 		case 2:	*(__be16 *) __d = cpu_to_be16(source); break; \ 		case 4:	*(__be32 *) __d = cpu_to_be32(source); break; \ 		case 8:	*(__be64 *) __d = cpu_to_be64(source); break; \ 		default: __buggy_use_of_MTHCA_PUT();		      \ 		}                                                     \ 	} while (0)
end_define

begin_function_decl
name|int
name|mthca_reset
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|mdev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|u32
name|mthca_alloc
parameter_list|(
name|struct
name|mthca_alloc
modifier|*
name|alloc
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_free
parameter_list|(
name|struct
name|mthca_alloc
modifier|*
name|alloc
parameter_list|,
name|u32
name|obj
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_alloc_init
parameter_list|(
name|struct
name|mthca_alloc
modifier|*
name|alloc
parameter_list|,
name|u32
name|num
parameter_list|,
name|u32
name|mask
parameter_list|,
name|u32
name|reserved
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_alloc_cleanup
parameter_list|(
name|struct
name|mthca_alloc
modifier|*
name|alloc
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
modifier|*
name|mthca_array_get
parameter_list|(
name|struct
name|mthca_array
modifier|*
name|array
parameter_list|,
name|int
name|index
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_array_set
parameter_list|(
name|struct
name|mthca_array
modifier|*
name|array
parameter_list|,
name|int
name|index
parameter_list|,
name|void
modifier|*
name|value
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_array_clear
parameter_list|(
name|struct
name|mthca_array
modifier|*
name|array
parameter_list|,
name|int
name|index
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_array_init
parameter_list|(
name|struct
name|mthca_array
modifier|*
name|array
parameter_list|,
name|int
name|nent
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_array_cleanup
parameter_list|(
name|struct
name|mthca_array
modifier|*
name|array
parameter_list|,
name|int
name|nent
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_buf_alloc
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|int
name|size
parameter_list|,
name|int
name|max_direct
parameter_list|,
name|union
name|mthca_buf
modifier|*
name|buf
parameter_list|,
name|int
modifier|*
name|is_direct
parameter_list|,
name|struct
name|mthca_pd
modifier|*
name|pd
parameter_list|,
name|int
name|hca_write
parameter_list|,
name|struct
name|mthca_mr
modifier|*
name|mr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_buf_free
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|int
name|size
parameter_list|,
name|union
name|mthca_buf
modifier|*
name|buf
parameter_list|,
name|int
name|is_direct
parameter_list|,
name|struct
name|mthca_mr
modifier|*
name|mr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_init_uar_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_init_pd_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_init_mr_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_init_eq_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_init_cq_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_init_srq_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_init_qp_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_init_av_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_init_mcg_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_cleanup_uar_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_cleanup_pd_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_cleanup_mr_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_cleanup_eq_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_cleanup_cq_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_cleanup_srq_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_cleanup_qp_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_cleanup_av_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_cleanup_mcg_table
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_register_device
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_unregister_device
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_start_catas_poll
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_stop_catas_poll
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__mthca_restart_one
parameter_list|(
name|struct
name|pci_dev
modifier|*
name|pdev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_catas_init
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_catas_cleanup
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_uar_alloc
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_uar
modifier|*
name|uar
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_uar_free
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_uar
modifier|*
name|uar
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_pd_alloc
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|int
name|privileged
parameter_list|,
name|struct
name|mthca_pd
modifier|*
name|pd
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_pd_free
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_pd
modifier|*
name|pd
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_write_mtt_size
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|mthca_mtt
modifier|*
name|mthca_alloc_mtt
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|int
name|size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_free_mtt
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_mtt
modifier|*
name|mtt
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_write_mtt
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_mtt
modifier|*
name|mtt
parameter_list|,
name|int
name|start_index
parameter_list|,
name|u64
modifier|*
name|buffer_list
parameter_list|,
name|int
name|list_len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_mr_alloc
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|u32
name|pd
parameter_list|,
name|int
name|buffer_size_shift
parameter_list|,
name|u64
name|iova
parameter_list|,
name|u64
name|total_size
parameter_list|,
name|u32
name|access
parameter_list|,
name|struct
name|mthca_mr
modifier|*
name|mr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_mr_alloc_notrans
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|u32
name|pd
parameter_list|,
name|u32
name|access
parameter_list|,
name|struct
name|mthca_mr
modifier|*
name|mr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_mr_alloc_phys
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|u32
name|pd
parameter_list|,
name|u64
modifier|*
name|buffer_list
parameter_list|,
name|int
name|buffer_size_shift
parameter_list|,
name|int
name|list_len
parameter_list|,
name|u64
name|iova
parameter_list|,
name|u64
name|total_size
parameter_list|,
name|u32
name|access
parameter_list|,
name|struct
name|mthca_mr
modifier|*
name|mr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_free_mr
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_mr
modifier|*
name|mr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_fmr_alloc
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|u32
name|pd
parameter_list|,
name|u32
name|access
parameter_list|,
name|struct
name|mthca_fmr
modifier|*
name|fmr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_tavor_map_phys_fmr
parameter_list|(
name|struct
name|ib_fmr
modifier|*
name|ibfmr
parameter_list|,
name|u64
modifier|*
name|page_list
parameter_list|,
name|int
name|list_len
parameter_list|,
name|u64
name|iova
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_tavor_fmr_unmap
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_fmr
modifier|*
name|fmr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_arbel_map_phys_fmr
parameter_list|(
name|struct
name|ib_fmr
modifier|*
name|ibfmr
parameter_list|,
name|u64
modifier|*
name|page_list
parameter_list|,
name|int
name|list_len
parameter_list|,
name|u64
name|iova
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_arbel_fmr_unmap
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_fmr
modifier|*
name|fmr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_free_fmr
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_fmr
modifier|*
name|fmr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_map_eq_icm
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|u64
name|icm_virt
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_unmap_eq_icm
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_poll_cq
parameter_list|(
name|struct
name|ib_cq
modifier|*
name|ibcq
parameter_list|,
name|int
name|num_entries
parameter_list|,
name|struct
name|ib_wc
modifier|*
name|entry
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_tavor_arm_cq
parameter_list|(
name|struct
name|ib_cq
modifier|*
name|cq
parameter_list|,
name|enum
name|ib_cq_notify_flags
name|flags
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_arbel_arm_cq
parameter_list|(
name|struct
name|ib_cq
modifier|*
name|cq
parameter_list|,
name|enum
name|ib_cq_notify_flags
name|flags
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_init_cq
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|int
name|nent
parameter_list|,
name|struct
name|mthca_ucontext
modifier|*
name|ctx
parameter_list|,
name|u32
name|pdn
parameter_list|,
name|struct
name|mthca_cq
modifier|*
name|cq
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_free_cq
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_cq
modifier|*
name|cq
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_cq_completion
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|u32
name|cqn
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_cq_event
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|u32
name|cqn
parameter_list|,
name|enum
name|ib_event_type
name|event_type
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_cq_clean
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_cq
modifier|*
name|cq
parameter_list|,
name|u32
name|qpn
parameter_list|,
name|struct
name|mthca_srq
modifier|*
name|srq
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_cq_resize_copy_cqes
parameter_list|(
name|struct
name|mthca_cq
modifier|*
name|cq
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_alloc_cq_buf
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_cq_buf
modifier|*
name|buf
parameter_list|,
name|int
name|nent
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_free_cq_buf
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_cq_buf
modifier|*
name|buf
parameter_list|,
name|int
name|cqe
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_alloc_srq
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_pd
modifier|*
name|pd
parameter_list|,
name|struct
name|ib_srq_attr
modifier|*
name|attr
parameter_list|,
name|struct
name|mthca_srq
modifier|*
name|srq
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_free_srq
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_srq
modifier|*
name|srq
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_modify_srq
parameter_list|(
name|struct
name|ib_srq
modifier|*
name|ibsrq
parameter_list|,
name|struct
name|ib_srq_attr
modifier|*
name|attr
parameter_list|,
name|enum
name|ib_srq_attr_mask
name|attr_mask
parameter_list|,
name|struct
name|ib_udata
modifier|*
name|udata
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_query_srq
parameter_list|(
name|struct
name|ib_srq
modifier|*
name|srq
parameter_list|,
name|struct
name|ib_srq_attr
modifier|*
name|srq_attr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_max_srq_sge
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_srq_event
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|u32
name|srqn
parameter_list|,
name|enum
name|ib_event_type
name|event_type
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_free_srq_wqe
parameter_list|(
name|struct
name|mthca_srq
modifier|*
name|srq
parameter_list|,
name|u32
name|wqe_addr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_tavor_post_srq_recv
parameter_list|(
name|struct
name|ib_srq
modifier|*
name|srq
parameter_list|,
name|struct
name|ib_recv_wr
modifier|*
name|wr
parameter_list|,
name|struct
name|ib_recv_wr
modifier|*
modifier|*
name|bad_wr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_arbel_post_srq_recv
parameter_list|(
name|struct
name|ib_srq
modifier|*
name|srq
parameter_list|,
name|struct
name|ib_recv_wr
modifier|*
name|wr
parameter_list|,
name|struct
name|ib_recv_wr
modifier|*
modifier|*
name|bad_wr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_qp_event
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|u32
name|qpn
parameter_list|,
name|enum
name|ib_event_type
name|event_type
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_query_qp
parameter_list|(
name|struct
name|ib_qp
modifier|*
name|ibqp
parameter_list|,
name|struct
name|ib_qp_attr
modifier|*
name|qp_attr
parameter_list|,
name|int
name|qp_attr_mask
parameter_list|,
name|struct
name|ib_qp_init_attr
modifier|*
name|qp_init_attr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_modify_qp
parameter_list|(
name|struct
name|ib_qp
modifier|*
name|ibqp
parameter_list|,
name|struct
name|ib_qp_attr
modifier|*
name|attr
parameter_list|,
name|int
name|attr_mask
parameter_list|,
name|struct
name|ib_udata
modifier|*
name|udata
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_tavor_post_send
parameter_list|(
name|struct
name|ib_qp
modifier|*
name|ibqp
parameter_list|,
name|struct
name|ib_send_wr
modifier|*
name|wr
parameter_list|,
name|struct
name|ib_send_wr
modifier|*
modifier|*
name|bad_wr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_tavor_post_receive
parameter_list|(
name|struct
name|ib_qp
modifier|*
name|ibqp
parameter_list|,
name|struct
name|ib_recv_wr
modifier|*
name|wr
parameter_list|,
name|struct
name|ib_recv_wr
modifier|*
modifier|*
name|bad_wr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_arbel_post_send
parameter_list|(
name|struct
name|ib_qp
modifier|*
name|ibqp
parameter_list|,
name|struct
name|ib_send_wr
modifier|*
name|wr
parameter_list|,
name|struct
name|ib_send_wr
modifier|*
modifier|*
name|bad_wr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_arbel_post_receive
parameter_list|(
name|struct
name|ib_qp
modifier|*
name|ibqp
parameter_list|,
name|struct
name|ib_recv_wr
modifier|*
name|wr
parameter_list|,
name|struct
name|ib_recv_wr
modifier|*
modifier|*
name|bad_wr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_free_err_wqe
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_qp
modifier|*
name|qp
parameter_list|,
name|int
name|is_send
parameter_list|,
name|int
name|index
parameter_list|,
name|int
modifier|*
name|dbd
parameter_list|,
name|__be32
modifier|*
name|new_wqe
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_alloc_qp
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_pd
modifier|*
name|pd
parameter_list|,
name|struct
name|mthca_cq
modifier|*
name|send_cq
parameter_list|,
name|struct
name|mthca_cq
modifier|*
name|recv_cq
parameter_list|,
name|enum
name|ib_qp_type
name|type
parameter_list|,
name|enum
name|ib_sig_type
name|send_policy
parameter_list|,
name|struct
name|ib_qp_cap
modifier|*
name|cap
parameter_list|,
name|struct
name|mthca_qp
modifier|*
name|qp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_alloc_sqp
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_pd
modifier|*
name|pd
parameter_list|,
name|struct
name|mthca_cq
modifier|*
name|send_cq
parameter_list|,
name|struct
name|mthca_cq
modifier|*
name|recv_cq
parameter_list|,
name|enum
name|ib_sig_type
name|send_policy
parameter_list|,
name|struct
name|ib_qp_cap
modifier|*
name|cap
parameter_list|,
name|int
name|qpn
parameter_list|,
name|int
name|port
parameter_list|,
name|struct
name|mthca_sqp
modifier|*
name|sqp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_free_qp
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_qp
modifier|*
name|qp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_create_ah
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_pd
modifier|*
name|pd
parameter_list|,
name|struct
name|ib_ah_attr
modifier|*
name|ah_attr
parameter_list|,
name|struct
name|mthca_ah
modifier|*
name|ah
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_destroy_ah
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_ah
modifier|*
name|ah
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_read_ah
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|struct
name|mthca_ah
modifier|*
name|ah
parameter_list|,
name|struct
name|ib_ud_header
modifier|*
name|header
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_ah_query
parameter_list|(
name|struct
name|ib_ah
modifier|*
name|ibah
parameter_list|,
name|struct
name|ib_ah_attr
modifier|*
name|attr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_ah_grh_present
parameter_list|(
name|struct
name|mthca_ah
modifier|*
name|ah
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|u8
name|mthca_get_rate
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|int
name|static_rate
parameter_list|,
name|u8
name|port
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|enum
name|ib_rate
name|mthca_rate_to_ib
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|,
name|u8
name|mthca_rate
parameter_list|,
name|u8
name|port
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_multicast_attach
parameter_list|(
name|struct
name|ib_qp
modifier|*
name|ibqp
parameter_list|,
name|union
name|ib_gid
modifier|*
name|gid
parameter_list|,
name|u16
name|lid
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_multicast_detach
parameter_list|(
name|struct
name|ib_qp
modifier|*
name|ibqp
parameter_list|,
name|union
name|ib_gid
modifier|*
name|gid
parameter_list|,
name|u16
name|lid
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_process_mad
parameter_list|(
name|struct
name|ib_device
modifier|*
name|ibdev
parameter_list|,
name|int
name|mad_flags
parameter_list|,
name|u8
name|port_num
parameter_list|,
name|struct
name|ib_wc
modifier|*
name|in_wc
parameter_list|,
name|struct
name|ib_grh
modifier|*
name|in_grh
parameter_list|,
name|struct
name|ib_mad
modifier|*
name|in_mad
parameter_list|,
name|struct
name|ib_mad
modifier|*
name|out_mad
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|mthca_create_agents
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mthca_free_agents
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function
specifier|static
specifier|inline
name|struct
name|mthca_dev
modifier|*
name|to_mdev
parameter_list|(
name|struct
name|ib_device
modifier|*
name|ibdev
parameter_list|)
block|{
return|return
name|container_of
argument_list|(
name|ibdev
argument_list|,
expr|struct
name|mthca_dev
argument_list|,
name|ib_dev
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|mthca_is_memfree
parameter_list|(
name|struct
name|mthca_dev
modifier|*
name|dev
parameter_list|)
block|{
return|return
name|dev
operator|->
name|mthca_flags
operator|&
name|MTHCA_FLAG_MEMFREE
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* MTHCA_DEV_H */
end_comment

end_unit

