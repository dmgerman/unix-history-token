begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*   * $FreeBSD$  */
end_comment

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<sys/systm.h>
end_include

begin_include
include|#
directive|include
file|<sys/proc.h>
end_include

begin_include
include|#
directive|include
file|<netncp/ncp.h>
end_include

begin_include
include|#
directive|include
file|<netncp/ncp_subr.h>
end_include

begin_comment
comment|/*  *  Routines in this file based on work of Volker Lendecke  */
end_comment

begin_comment
comment|/*$*********************************************************    $*    $* This code has been taken from DDJ 11/93, from an     $* article by Pawel Szczerbina.    $*    $* Password encryption routines follow.    $* Converted to C from Barry Nance's Pascal    $* prog published in the March -93 issue of Byte.    $*    $* Adapted to be useable for ncpfs by     $* Volker Lendecke<lendecke@namu01.gwdg.de> in     $* October 1995.     $*    $********************************************************* */
end_comment

begin_typedef
typedef|typedef
name|unsigned
name|char
name|buf32
index|[
literal|32
index|]
typedef|;
end_typedef

begin_decl_stmt
specifier|static
name|unsigned
name|char
name|encrypttable
index|[
literal|256
index|]
init|=
block|{
literal|0x7
block|,
literal|0x8
block|,
literal|0x0
block|,
literal|0x8
block|,
literal|0x6
block|,
literal|0x4
block|,
literal|0xE
block|,
literal|0x4
block|,
literal|0x5
block|,
literal|0xC
block|,
literal|0x1
block|,
literal|0x7
block|,
literal|0xB
block|,
literal|0xF
block|,
literal|0xA
block|,
literal|0x8
block|,
literal|0xF
block|,
literal|0x8
block|,
literal|0xC
block|,
literal|0xC
block|,
literal|0x9
block|,
literal|0x4
block|,
literal|0x1
block|,
literal|0xE
block|,
literal|0x4
block|,
literal|0x6
block|,
literal|0x2
block|,
literal|0x4
block|,
literal|0x0
block|,
literal|0xA
block|,
literal|0xB
block|,
literal|0x9
block|,
literal|0x2
block|,
literal|0xF
block|,
literal|0xB
block|,
literal|0x1
block|,
literal|0xD
block|,
literal|0x2
block|,
literal|0x1
block|,
literal|0x9
block|,
literal|0x5
block|,
literal|0xE
block|,
literal|0x7
block|,
literal|0x0
block|,
literal|0x0
block|,
literal|0x2
block|,
literal|0x6
block|,
literal|0x6
block|,
literal|0x0
block|,
literal|0x7
block|,
literal|0x3
block|,
literal|0x8
block|,
literal|0x2
block|,
literal|0x9
block|,
literal|0x3
block|,
literal|0xF
block|,
literal|0x7
block|,
literal|0xF
block|,
literal|0xC
block|,
literal|0xF
block|,
literal|0x6
block|,
literal|0x4
block|,
literal|0xA
block|,
literal|0x0
block|,
literal|0x2
block|,
literal|0x3
block|,
literal|0xA
block|,
literal|0xB
block|,
literal|0xD
block|,
literal|0x8
block|,
literal|0x3
block|,
literal|0xA
block|,
literal|0x1
block|,
literal|0x7
block|,
literal|0xC
block|,
literal|0xF
block|,
literal|0x1
block|,
literal|0x8
block|,
literal|0x9
block|,
literal|0xD
block|,
literal|0x9
block|,
literal|0x1
block|,
literal|0x9
block|,
literal|0x4
block|,
literal|0xE
block|,
literal|0x4
block|,
literal|0xC
block|,
literal|0x5
block|,
literal|0x5
block|,
literal|0xC
block|,
literal|0x8
block|,
literal|0xB
block|,
literal|0x2
block|,
literal|0x3
block|,
literal|0x9
block|,
literal|0xE
block|,
literal|0x7
block|,
literal|0x7
block|,
literal|0x6
block|,
literal|0x9
block|,
literal|0xE
block|,
literal|0xF
block|,
literal|0xC
block|,
literal|0x8
block|,
literal|0xD
block|,
literal|0x1
block|,
literal|0xA
block|,
literal|0x6
block|,
literal|0xE
block|,
literal|0xD
block|,
literal|0x0
block|,
literal|0x7
block|,
literal|0x7
block|,
literal|0xA
block|,
literal|0x0
block|,
literal|0x1
block|,
literal|0xF
block|,
literal|0x5
block|,
literal|0x4
block|,
literal|0xB
block|,
literal|0x7
block|,
literal|0xB
block|,
literal|0xE
block|,
literal|0xC
block|,
literal|0x9
block|,
literal|0x5
block|,
literal|0xD
block|,
literal|0x1
block|,
literal|0xB
block|,
literal|0xD
block|,
literal|0x1
block|,
literal|0x3
block|,
literal|0x5
block|,
literal|0xD
block|,
literal|0xE
block|,
literal|0x6
block|,
literal|0x3
block|,
literal|0x0
block|,
literal|0xB
block|,
literal|0xB
block|,
literal|0xF
block|,
literal|0x3
block|,
literal|0x6
block|,
literal|0x4
block|,
literal|0x9
block|,
literal|0xD
block|,
literal|0xA
block|,
literal|0x3
block|,
literal|0x1
block|,
literal|0x4
block|,
literal|0x9
block|,
literal|0x4
block|,
literal|0x8
block|,
literal|0x3
block|,
literal|0xB
block|,
literal|0xE
block|,
literal|0x5
block|,
literal|0x0
block|,
literal|0x5
block|,
literal|0x2
block|,
literal|0xC
block|,
literal|0xB
block|,
literal|0xD
block|,
literal|0x5
block|,
literal|0xD
block|,
literal|0x5
block|,
literal|0xD
block|,
literal|0x2
block|,
literal|0xD
block|,
literal|0x9
block|,
literal|0xA
block|,
literal|0xC
block|,
literal|0xA
block|,
literal|0x0
block|,
literal|0xB
block|,
literal|0x3
block|,
literal|0x5
block|,
literal|0x3
block|,
literal|0x6
block|,
literal|0x9
block|,
literal|0x5
block|,
literal|0x1
block|,
literal|0xE
block|,
literal|0xE
block|,
literal|0x0
block|,
literal|0xE
block|,
literal|0x8
block|,
literal|0x2
block|,
literal|0xD
block|,
literal|0x2
block|,
literal|0x2
block|,
literal|0x0
block|,
literal|0x4
block|,
literal|0xF
block|,
literal|0x8
block|,
literal|0x5
block|,
literal|0x9
block|,
literal|0x6
block|,
literal|0x8
block|,
literal|0x6
block|,
literal|0xB
block|,
literal|0xA
block|,
literal|0xB
block|,
literal|0xF
block|,
literal|0x0
block|,
literal|0x7
block|,
literal|0x2
block|,
literal|0x8
block|,
literal|0xC
block|,
literal|0x7
block|,
literal|0x3
block|,
literal|0xA
block|,
literal|0x1
block|,
literal|0x4
block|,
literal|0x2
block|,
literal|0x5
block|,
literal|0xF
block|,
literal|0x7
block|,
literal|0xA
block|,
literal|0xC
block|,
literal|0xE
block|,
literal|0x5
block|,
literal|0x9
block|,
literal|0x3
block|,
literal|0xE
block|,
literal|0x7
block|,
literal|0x1
block|,
literal|0x2
block|,
literal|0xE
block|,
literal|0x1
block|,
literal|0xF
block|,
literal|0x4
block|,
literal|0xA
block|,
literal|0x6
block|,
literal|0xC
block|,
literal|0x6
block|,
literal|0xF
block|,
literal|0x4
block|,
literal|0x3
block|,
literal|0x0
block|,
literal|0xC
block|,
literal|0x0
block|,
literal|0x3
block|,
literal|0x6
block|,
literal|0xF
block|,
literal|0x8
block|,
literal|0x7
block|,
literal|0xB
block|,
literal|0x2
block|,
literal|0xD
block|,
literal|0xC
block|,
literal|0x6
block|,
literal|0xA
block|,
literal|0xA
block|,
literal|0x8
block|,
literal|0xD
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|buf32
name|encryptkeys
init|=
block|{
literal|0x48
block|,
literal|0x93
block|,
literal|0x46
block|,
literal|0x67
block|,
literal|0x98
block|,
literal|0x3D
block|,
literal|0xE6
block|,
literal|0x8D
block|,
literal|0xB7
block|,
literal|0x10
block|,
literal|0x7A
block|,
literal|0x26
block|,
literal|0x5A
block|,
literal|0xB9
block|,
literal|0xB1
block|,
literal|0x35
block|,
literal|0x6B
block|,
literal|0x0F
block|,
literal|0xD5
block|,
literal|0x70
block|,
literal|0xAE
block|,
literal|0xFB
block|,
literal|0xAD
block|,
literal|0x11
block|,
literal|0xF4
block|,
literal|0x47
block|,
literal|0xDC
block|,
literal|0xA7
block|,
literal|0xEC
block|,
literal|0xCF
block|,
literal|0x50
block|,
literal|0xC0
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Create table-based 16-bytes hash from a 32-bytes array  */
end_comment

begin_function
specifier|static
name|void
name|nw_hash
parameter_list|(
name|buf32
name|temp
parameter_list|,
name|unsigned
name|char
modifier|*
name|target
parameter_list|)
block|{
name|short
name|sum
decl_stmt|;
name|unsigned
name|char
name|b3
decl_stmt|;
name|int
name|s
decl_stmt|,
name|b2
decl_stmt|,
name|i
decl_stmt|;
name|sum
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|b2
operator|=
literal|0
init|;
name|b2
operator|<=
literal|1
condition|;
operator|++
name|b2
control|)
block|{
for|for
control|(
name|s
operator|=
literal|0
init|;
name|s
operator|<=
literal|31
condition|;
operator|++
name|s
control|)
block|{
name|b3
operator|=
operator|(
name|temp
index|[
name|s
index|]
operator|+
name|sum
operator|)
operator|^
operator|(
name|temp
index|[
operator|(
name|s
operator|+
name|sum
operator|)
operator|&
literal|31
index|]
operator|-
name|encryptkeys
index|[
name|s
index|]
operator|)
expr_stmt|;
name|sum
operator|+=
name|b3
expr_stmt|;
name|temp
index|[
name|s
index|]
operator|=
name|b3
expr_stmt|;
block|}
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<=
literal|15
condition|;
operator|++
name|i
control|)
block|{
name|target
index|[
name|i
index|]
operator|=
name|encrypttable
index|[
name|temp
index|[
literal|2
operator|*
name|i
index|]
index|]
operator||
operator|(
name|encrypttable
index|[
name|temp
index|[
literal|2
operator|*
name|i
operator|+
literal|1
index|]
index|]
operator|<<
literal|4
operator|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*  * Create a 16-bytes pattern from given buffer based on a four bytes key  */
end_comment

begin_function
name|void
name|nw_keyhash
parameter_list|(
specifier|const
name|u_char
modifier|*
name|key
parameter_list|,
specifier|const
name|u_char
modifier|*
name|buf
parameter_list|,
name|int
name|buflen
parameter_list|,
name|u_char
modifier|*
name|target
parameter_list|)
block|{
name|int
name|b2
decl_stmt|,
name|d
decl_stmt|,
name|s
decl_stmt|;
name|buf32
name|temp
decl_stmt|;
while|while
condition|(
name|buflen
operator|>
literal|0
operator|&&
name|buf
index|[
name|buflen
operator|-
literal|1
index|]
operator|==
literal|0
condition|)
name|buflen
operator|--
expr_stmt|;
name|bzero
argument_list|(
name|temp
argument_list|,
sizeof|sizeof
argument_list|(
name|temp
argument_list|)
argument_list|)
expr_stmt|;
name|d
operator|=
literal|0
expr_stmt|;
while|while
condition|(
name|buflen
operator|>=
literal|32
condition|)
block|{
for|for
control|(
name|s
operator|=
literal|0
init|;
name|s
operator|<=
literal|31
condition|;
operator|++
name|s
control|)
name|temp
index|[
name|s
index|]
operator|^=
name|buf
index|[
name|d
operator|++
index|]
expr_stmt|;
name|buflen
operator|-=
literal|32
expr_stmt|;
block|}
name|b2
operator|=
name|d
expr_stmt|;
if|if
condition|(
name|buflen
operator|>
literal|0
condition|)
block|{
for|for
control|(
name|s
operator|=
literal|0
init|;
name|s
operator|<=
literal|31
condition|;
operator|++
name|s
control|)
block|{
if|if
condition|(
name|d
operator|+
name|buflen
operator|==
name|b2
condition|)
block|{
name|temp
index|[
name|s
index|]
operator|^=
name|encryptkeys
index|[
name|s
index|]
expr_stmt|;
name|b2
operator|=
name|d
expr_stmt|;
block|}
else|else
name|temp
index|[
name|s
index|]
operator|^=
name|buf
index|[
name|b2
operator|++
index|]
expr_stmt|;
block|}
block|}
for|for
control|(
name|s
operator|=
literal|0
init|;
name|s
operator|<=
literal|31
condition|;
operator|++
name|s
control|)
name|temp
index|[
name|s
index|]
operator|^=
name|key
index|[
name|s
operator|&
literal|3
index|]
expr_stmt|;
name|nw_hash
argument_list|(
name|temp
argument_list|,
name|target
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Create an 8-bytes pattern from an 8-bytes key and 16-bytes of data  */
end_comment

begin_function
name|void
name|nw_encrypt
parameter_list|(
specifier|const
name|u_char
modifier|*
name|fra
parameter_list|,
specifier|const
name|u_char
modifier|*
name|buf
parameter_list|,
name|u_char
modifier|*
name|target
parameter_list|)
block|{
name|buf32
name|k
decl_stmt|;
name|int
name|s
decl_stmt|;
name|nw_keyhash
argument_list|(
name|fra
argument_list|,
name|buf
argument_list|,
literal|16
argument_list|,
name|k
argument_list|)
expr_stmt|;
name|nw_keyhash
argument_list|(
name|fra
operator|+
literal|4
argument_list|,
name|buf
argument_list|,
literal|16
argument_list|,
name|k
operator|+
literal|16
argument_list|)
expr_stmt|;
for|for
control|(
name|s
operator|=
literal|0
init|;
name|s
operator|<
literal|16
condition|;
name|s
operator|++
control|)
name|k
index|[
name|s
index|]
operator|^=
name|k
index|[
literal|31
operator|-
name|s
index|]
expr_stmt|;
for|for
control|(
name|s
operator|=
literal|0
init|;
name|s
operator|<
literal|8
condition|;
name|s
operator|++
control|)
operator|*
name|target
operator|++
operator|=
name|k
index|[
name|s
index|]
operator|^
name|k
index|[
literal|15
operator|-
name|s
index|]
expr_stmt|;
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|KERNEL
end_ifdef

begin_comment
comment|/*  * MD4 routine taken from libmd sources  */
end_comment

begin_typedef
typedef|typedef
name|u_int32_t
name|UINT4
typedef|;
end_typedef

begin_typedef
typedef|typedef
name|unsigned
name|char
modifier|*
name|POINTER
typedef|;
end_typedef

begin_define
define|#
directive|define
name|PROTO_LIST
parameter_list|(
name|list
parameter_list|)
value|list
end_define

begin_decl_stmt
specifier|static
name|void
name|Decode
name|PROTO_LIST
argument_list|(
operator|(
name|UINT4
operator|*
operator|,
specifier|const
name|unsigned
name|char
operator|*
operator|,
name|unsigned
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Constants for MD4Transform routine.  */
end_comment

begin_define
define|#
directive|define
name|S11
value|3
end_define

begin_define
define|#
directive|define
name|S12
value|7
end_define

begin_define
define|#
directive|define
name|S13
value|11
end_define

begin_define
define|#
directive|define
name|S14
value|19
end_define

begin_define
define|#
directive|define
name|S21
value|3
end_define

begin_define
define|#
directive|define
name|S22
value|5
end_define

begin_define
define|#
directive|define
name|S23
value|9
end_define

begin_define
define|#
directive|define
name|S24
value|13
end_define

begin_define
define|#
directive|define
name|S31
value|3
end_define

begin_define
define|#
directive|define
name|S32
value|9
end_define

begin_define
define|#
directive|define
name|S33
value|11
end_define

begin_define
define|#
directive|define
name|S34
value|15
end_define

begin_comment
comment|/* F, G and H are basic MD4 functions.  */
end_comment

begin_define
define|#
directive|define
name|F
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|,
name|z
parameter_list|)
value|(((x)& (y)) | ((~x)& (z)))
end_define

begin_define
define|#
directive|define
name|G
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|,
name|z
parameter_list|)
value|(((x)& (y)) | ((x)& (z)) | ((y)& (z)))
end_define

begin_define
define|#
directive|define
name|H
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|,
name|z
parameter_list|)
value|((x) ^ (y) ^ (z))
end_define

begin_comment
comment|/* ROTATE_LEFT rotates x left n bits.  */
end_comment

begin_define
define|#
directive|define
name|ROTATE_LEFT
parameter_list|(
name|x
parameter_list|,
name|n
parameter_list|)
value|(((x)<< (n)) | ((x)>> (32-(n))))
end_define

begin_comment
comment|/* FF, GG and HH are transformations for rounds 1, 2 and 3 */
end_comment

begin_comment
comment|/* Rotation is separate from addition to prevent recomputation */
end_comment

begin_define
define|#
directive|define
name|FF
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|c
parameter_list|,
name|d
parameter_list|,
name|x
parameter_list|,
name|s
parameter_list|)
value|{ \     (a) += F ((b), (c), (d)) + (x); \     (a) = ROTATE_LEFT ((a), (s)); \   }
end_define

begin_define
define|#
directive|define
name|GG
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|c
parameter_list|,
name|d
parameter_list|,
name|x
parameter_list|,
name|s
parameter_list|)
value|{ \     (a) += G ((b), (c), (d)) + (x) + (UINT4)0x5a827999; \     (a) = ROTATE_LEFT ((a), (s)); \   }
end_define

begin_define
define|#
directive|define
name|HH
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|c
parameter_list|,
name|d
parameter_list|,
name|x
parameter_list|,
name|s
parameter_list|)
value|{ \     (a) += H ((b), (c), (d)) + (x) + (UINT4)0x6ed9eba1; \     (a) = ROTATE_LEFT ((a), (s)); \   }
end_define

begin_function
name|void
name|ncp_sign
parameter_list|(
specifier|const
name|u_int32_t
modifier|*
name|state
parameter_list|,
specifier|const
name|char
modifier|*
name|block
parameter_list|,
name|u_int32_t
modifier|*
name|ostate
parameter_list|)
block|{
name|UINT4
name|a
decl_stmt|,
name|b
decl_stmt|,
name|c
decl_stmt|,
name|d
decl_stmt|,
name|x
index|[
literal|16
index|]
decl_stmt|;
name|Decode
argument_list|(
name|x
argument_list|,
name|block
argument_list|,
literal|64
argument_list|)
expr_stmt|;
name|a
operator|=
name|state
index|[
literal|0
index|]
expr_stmt|;
name|b
operator|=
name|state
index|[
literal|1
index|]
expr_stmt|;
name|c
operator|=
name|state
index|[
literal|2
index|]
expr_stmt|;
name|d
operator|=
name|state
index|[
literal|3
index|]
expr_stmt|;
comment|/* Round 1 */
name|FF
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|0
index|]
argument_list|,
name|S11
argument_list|)
expr_stmt|;
comment|/* 1 */
name|FF
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|1
index|]
argument_list|,
name|S12
argument_list|)
expr_stmt|;
comment|/* 2 */
name|FF
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|2
index|]
argument_list|,
name|S13
argument_list|)
expr_stmt|;
comment|/* 3 */
name|FF
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|3
index|]
argument_list|,
name|S14
argument_list|)
expr_stmt|;
comment|/* 4 */
name|FF
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|4
index|]
argument_list|,
name|S11
argument_list|)
expr_stmt|;
comment|/* 5 */
name|FF
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|5
index|]
argument_list|,
name|S12
argument_list|)
expr_stmt|;
comment|/* 6 */
name|FF
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|6
index|]
argument_list|,
name|S13
argument_list|)
expr_stmt|;
comment|/* 7 */
name|FF
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|7
index|]
argument_list|,
name|S14
argument_list|)
expr_stmt|;
comment|/* 8 */
name|FF
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|8
index|]
argument_list|,
name|S11
argument_list|)
expr_stmt|;
comment|/* 9 */
name|FF
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|9
index|]
argument_list|,
name|S12
argument_list|)
expr_stmt|;
comment|/* 10 */
name|FF
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|10
index|]
argument_list|,
name|S13
argument_list|)
expr_stmt|;
comment|/* 11 */
name|FF
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|11
index|]
argument_list|,
name|S14
argument_list|)
expr_stmt|;
comment|/* 12 */
name|FF
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|12
index|]
argument_list|,
name|S11
argument_list|)
expr_stmt|;
comment|/* 13 */
name|FF
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|13
index|]
argument_list|,
name|S12
argument_list|)
expr_stmt|;
comment|/* 14 */
name|FF
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|14
index|]
argument_list|,
name|S13
argument_list|)
expr_stmt|;
comment|/* 15 */
name|FF
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|15
index|]
argument_list|,
name|S14
argument_list|)
expr_stmt|;
comment|/* 16 */
comment|/* Round 2 */
name|GG
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|0
index|]
argument_list|,
name|S21
argument_list|)
expr_stmt|;
comment|/* 17 */
name|GG
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|4
index|]
argument_list|,
name|S22
argument_list|)
expr_stmt|;
comment|/* 18 */
name|GG
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|8
index|]
argument_list|,
name|S23
argument_list|)
expr_stmt|;
comment|/* 19 */
name|GG
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|12
index|]
argument_list|,
name|S24
argument_list|)
expr_stmt|;
comment|/* 20 */
name|GG
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|1
index|]
argument_list|,
name|S21
argument_list|)
expr_stmt|;
comment|/* 21 */
name|GG
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|5
index|]
argument_list|,
name|S22
argument_list|)
expr_stmt|;
comment|/* 22 */
name|GG
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|9
index|]
argument_list|,
name|S23
argument_list|)
expr_stmt|;
comment|/* 23 */
name|GG
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|13
index|]
argument_list|,
name|S24
argument_list|)
expr_stmt|;
comment|/* 24 */
name|GG
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|2
index|]
argument_list|,
name|S21
argument_list|)
expr_stmt|;
comment|/* 25 */
name|GG
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|6
index|]
argument_list|,
name|S22
argument_list|)
expr_stmt|;
comment|/* 26 */
name|GG
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|10
index|]
argument_list|,
name|S23
argument_list|)
expr_stmt|;
comment|/* 27 */
name|GG
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|14
index|]
argument_list|,
name|S24
argument_list|)
expr_stmt|;
comment|/* 28 */
name|GG
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|3
index|]
argument_list|,
name|S21
argument_list|)
expr_stmt|;
comment|/* 29 */
name|GG
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|7
index|]
argument_list|,
name|S22
argument_list|)
expr_stmt|;
comment|/* 30 */
name|GG
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|11
index|]
argument_list|,
name|S23
argument_list|)
expr_stmt|;
comment|/* 31 */
name|GG
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|15
index|]
argument_list|,
name|S24
argument_list|)
expr_stmt|;
comment|/* 32 */
comment|/* Round 3 */
name|HH
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|0
index|]
argument_list|,
name|S31
argument_list|)
expr_stmt|;
comment|/* 33 */
name|HH
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|8
index|]
argument_list|,
name|S32
argument_list|)
expr_stmt|;
comment|/* 34 */
name|HH
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|4
index|]
argument_list|,
name|S33
argument_list|)
expr_stmt|;
comment|/* 35 */
name|HH
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|12
index|]
argument_list|,
name|S34
argument_list|)
expr_stmt|;
comment|/* 36 */
name|HH
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|2
index|]
argument_list|,
name|S31
argument_list|)
expr_stmt|;
comment|/* 37 */
name|HH
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|10
index|]
argument_list|,
name|S32
argument_list|)
expr_stmt|;
comment|/* 38 */
name|HH
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|6
index|]
argument_list|,
name|S33
argument_list|)
expr_stmt|;
comment|/* 39 */
name|HH
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|14
index|]
argument_list|,
name|S34
argument_list|)
expr_stmt|;
comment|/* 40 */
name|HH
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|1
index|]
argument_list|,
name|S31
argument_list|)
expr_stmt|;
comment|/* 41 */
name|HH
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|9
index|]
argument_list|,
name|S32
argument_list|)
expr_stmt|;
comment|/* 42 */
name|HH
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|5
index|]
argument_list|,
name|S33
argument_list|)
expr_stmt|;
comment|/* 43 */
name|HH
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|13
index|]
argument_list|,
name|S34
argument_list|)
expr_stmt|;
comment|/* 44 */
name|HH
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|3
index|]
argument_list|,
name|S31
argument_list|)
expr_stmt|;
comment|/* 45 */
name|HH
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|11
index|]
argument_list|,
name|S32
argument_list|)
expr_stmt|;
comment|/* 46 */
name|HH
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|7
index|]
argument_list|,
name|S33
argument_list|)
expr_stmt|;
comment|/* 47 */
name|HH
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|15
index|]
argument_list|,
name|S34
argument_list|)
expr_stmt|;
comment|/* 48 */
name|ostate
index|[
literal|0
index|]
operator|=
name|state
index|[
literal|0
index|]
operator|+
name|a
expr_stmt|;
name|ostate
index|[
literal|1
index|]
operator|=
name|state
index|[
literal|1
index|]
operator|+
name|b
expr_stmt|;
name|ostate
index|[
literal|2
index|]
operator|=
name|state
index|[
literal|2
index|]
operator|+
name|c
expr_stmt|;
name|ostate
index|[
literal|3
index|]
operator|=
name|state
index|[
literal|3
index|]
operator|+
name|d
expr_stmt|;
block|}
end_function

begin_comment
comment|/* Decodes input (unsigned char) into output (UINT4). Assumes len is      a multiple of 4.  */
end_comment

begin_function
specifier|static
name|void
name|Decode
parameter_list|(
name|output
parameter_list|,
name|input
parameter_list|,
name|len
parameter_list|)
name|UINT4
modifier|*
name|output
decl_stmt|;
specifier|const
name|unsigned
name|char
modifier|*
name|input
decl_stmt|;
name|unsigned
name|int
name|len
decl_stmt|;
block|{
name|unsigned
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|len
condition|;
name|i
operator|++
operator|,
name|j
operator|+=
literal|4
control|)
name|output
index|[
name|i
index|]
operator|=
operator|(
operator|(
name|UINT4
operator|)
name|input
index|[
name|j
index|]
operator|)
operator||
operator|(
operator|(
operator|(
name|UINT4
operator|)
name|input
index|[
name|j
operator|+
literal|1
index|]
operator|)
operator|<<
literal|8
operator|)
operator||
operator|(
operator|(
operator|(
name|UINT4
operator|)
name|input
index|[
name|j
operator|+
literal|2
index|]
operator|)
operator|<<
literal|16
operator|)
operator||
operator|(
operator|(
operator|(
name|UINT4
operator|)
name|input
index|[
name|j
operator|+
literal|3
index|]
operator|)
operator|<<
literal|24
operator|)
expr_stmt|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* KERNEL */
end_comment

end_unit

