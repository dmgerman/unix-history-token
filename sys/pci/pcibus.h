begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/************************************************************************** ** **  $Id: pcibus.h,v 1.4 1996/01/30 22:59:55 mpp Exp $ ** **  Declarations for pci bus driver. ** **  FreeBSD ** **------------------------------------------------------------------------- ** ** Copyright (c) 1995 Wolfgang Stanglmeier.  All rights reserved. ** ** Redistribution and use in source and binary forms, with or without ** modification, are permitted provided that the following conditions ** are met: ** 1. Redistributions of source code must retain the above copyright **    notice, this list of conditions and the following disclaimer. ** 2. Redistributions in binary form must reproduce the above copyright **    notice, this list of conditions and the following disclaimer in the **    documentation and/or other materials provided with the distribution. ** 3. The name of the author may not be used to endorse or promote products **    derived from this software without specific prior written permission. ** ** THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR ** IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES ** OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. ** IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, ** INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT ** NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, ** DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY ** THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT ** (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF ** THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. ** *************************************************************************** */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|__PCI_BUS_H__
end_ifndef

begin_define
define|#
directive|define
name|__PCI_BUS_H__
value|"pl1 95/03/13"
end_define

begin_comment
comment|/*----------------------------------------------------------------- ** **	The following functions are provided by the pci bios. **	They are used only by the pci configuration. ** **	pcibus_setup(): **		Probes for a pci system. **		Sets pci_maxdevice and pci_mechanism. ** **	pcibus_tag(): **		Creates a handle for pci configuration space access. **		This handle is given to the read/write functions. ** **	pcibus_ftag(): **		Creates a modified handle. ** **	pcibus_read(): **		Read a long word from the pci configuration space. **		Requires a tag (from pcitag) and the register **		number (should be a long word alligned one). ** **	pcibus_write(): **		Writes a long word to the pci configuration space. **		Requires a tag (from pcitag), the register number **		(should be a long word alligned one), and a value. ** **	pcibus_regirq(): **		Register an interrupt handler for a pci device. **		Requires a tag (from pcitag), the register number **		(should be a long word alligned one), and a value. ** **----------------------------------------------------------------- */
end_comment

begin_struct
struct|struct
name|pcibus
block|{
name|char
modifier|*
name|pb_name
decl_stmt|;
name|void
function_decl|(
modifier|*
name|pb_setup
function_decl|)
parameter_list|(
name|void
parameter_list|)
function_decl|;
name|pcici_t
function_decl|(
modifier|*
name|pb_tag
function_decl|)
parameter_list|(
name|u_char
name|bus
parameter_list|,
name|u_char
name|device
parameter_list|,
name|u_char
name|func
parameter_list|)
function_decl|;
name|pcici_t
function_decl|(
modifier|*
name|pb_ftag
function_decl|)
parameter_list|(
name|pcici_t
name|tag
parameter_list|,
name|u_char
name|func
parameter_list|)
function_decl|;
name|u_long
function_decl|(
modifier|*
name|pb_read
function_decl|)
parameter_list|(
name|pcici_t
name|tag
parameter_list|,
name|u_long
name|reg
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|pb_write
function_decl|)
parameter_list|(
name|pcici_t
name|tag
parameter_list|,
name|u_long
name|reg
parameter_list|,
name|u_long
name|data
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|pb_iattach
function_decl|)
parameter_list|(
name|int
name|irq
parameter_list|,
name|inthand2_t
modifier|*
name|func
parameter_list|,
name|int
name|arg
parameter_list|,
name|unsigned
modifier|*
name|maskptr
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|pb_idetach
function_decl|)
parameter_list|(
name|int
name|irq
parameter_list|,
name|inthand2_t
modifier|*
name|func
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|pb_imaskinc
function_decl|)
parameter_list|(
name|int
name|irq
parameter_list|,
name|unsigned
modifier|*
name|maskptr
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|pb_imaskexc
function_decl|)
parameter_list|(
name|int
name|irq
parameter_list|,
name|unsigned
modifier|*
name|maskptr
parameter_list|)
function_decl|;
block|}
struct|;
end_struct

begin_define
define|#
directive|define
name|PCI_MAX_IRQ
value|(16)
end_define

begin_comment
comment|/* **	The following structure should be generated by the driver */
end_comment

begin_decl_stmt
specifier|extern
name|struct
name|linker_set
name|pcibus_set
decl_stmt|;
end_decl_stmt

begin_function_decl
name|int
name|pci_register_lkm
parameter_list|(
name|struct
name|pci_device
modifier|*
name|dvp
parameter_list|,
name|int
name|if_revision
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

end_unit

