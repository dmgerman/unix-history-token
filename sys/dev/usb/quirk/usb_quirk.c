begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* $FreeBSD$ */
end_comment

begin_comment
comment|/*-  * Copyright (c) 1998 The NetBSD Foundation, Inc. All rights reserved.  * Copyright (c) 1998 Lennart Augustsson. All rights reserved.  * Copyright (c) 2008 Hans Petter Selasky. All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  */
end_comment

begin_include
include|#
directive|include
file|<sys/stdint.h>
end_include

begin_include
include|#
directive|include
file|<sys/stddef.h>
end_include

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<sys/queue.h>
end_include

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|<sys/systm.h>
end_include

begin_include
include|#
directive|include
file|<sys/kernel.h>
end_include

begin_include
include|#
directive|include
file|<sys/bus.h>
end_include

begin_include
include|#
directive|include
file|<sys/linker_set.h>
end_include

begin_include
include|#
directive|include
file|<sys/module.h>
end_include

begin_include
include|#
directive|include
file|<sys/lock.h>
end_include

begin_include
include|#
directive|include
file|<sys/mutex.h>
end_include

begin_include
include|#
directive|include
file|<sys/condvar.h>
end_include

begin_include
include|#
directive|include
file|<sys/sysctl.h>
end_include

begin_include
include|#
directive|include
file|<sys/sx.h>
end_include

begin_include
include|#
directive|include
file|<sys/unistd.h>
end_include

begin_include
include|#
directive|include
file|<sys/callout.h>
end_include

begin_include
include|#
directive|include
file|<sys/malloc.h>
end_include

begin_include
include|#
directive|include
file|<sys/priv.h>
end_include

begin_include
include|#
directive|include
file|<dev/usb/usb.h>
end_include

begin_include
include|#
directive|include
file|<dev/usb/usb_ioctl.h>
end_include

begin_include
include|#
directive|include
file|<dev/usb/usbdi.h>
end_include

begin_include
include|#
directive|include
file|"usbdevs.h"
end_include

begin_define
define|#
directive|define
name|USB_DEBUG_VAR
value|usb_debug
end_define

begin_include
include|#
directive|include
file|<dev/usb/usb_debug.h>
end_include

begin_include
include|#
directive|include
file|<dev/usb/usb_dynamic.h>
end_include

begin_include
include|#
directive|include
file|<dev/usb/quirk/usb_quirk.h>
end_include

begin_expr_stmt
name|MODULE_DEPEND
argument_list|(
name|usb_quirk
argument_list|,
name|usb
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|MODULE_VERSION
argument_list|(
name|usb_quirk
argument_list|,
literal|1
argument_list|)
expr_stmt|;
end_expr_stmt

begin_define
define|#
directive|define
name|USB_DEV_QUIRKS_MAX
value|256
end_define

begin_define
define|#
directive|define
name|USB_SUB_QUIRKS_MAX
value|8
end_define

begin_struct
struct|struct
name|usb_quirk_entry
block|{
name|uint16_t
name|vid
decl_stmt|;
name|uint16_t
name|pid
decl_stmt|;
name|uint16_t
name|lo_rev
decl_stmt|;
name|uint16_t
name|hi_rev
decl_stmt|;
name|uint16_t
name|quirks
index|[
name|USB_SUB_QUIRKS_MAX
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_decl_stmt
specifier|static
name|struct
name|mtx
name|usb_quirk_mtx
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|USB_QUIRK_VP
parameter_list|(
name|v
parameter_list|,
name|p
parameter_list|,
name|l
parameter_list|,
name|h
parameter_list|,
modifier|...
parameter_list|)
define|\
value|{ .vid = (v), .pid = (p), .lo_rev = (l), .hi_rev = (h), \     .quirks = { __VA_ARGS__ } }
end_define

begin_define
define|#
directive|define
name|USB_QUIRK
parameter_list|(
name|v
parameter_list|,
name|p
parameter_list|,
name|l
parameter_list|,
name|h
parameter_list|,
modifier|...
parameter_list|)
define|\
value|USB_QUIRK_VP(USB_VENDOR_##v, USB_PRODUCT_##v##_##p, l, h, __VA_ARGS__)
end_define

begin_decl_stmt
specifier|static
name|struct
name|usb_quirk_entry
name|usb_quirks
index|[
name|USB_DEV_QUIRKS_MAX
index|]
init|=
block|{
name|USB_QUIRK
argument_list|(
name|ASUS
argument_list|,
name|LCM
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_HID_IGNORE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|INSIDEOUT
argument_list|,
name|EDGEPORT4
argument_list|,
literal|0x094
argument_list|,
literal|0x094
argument_list|,
name|UQ_SWAP_UNICODE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|DALLAS
argument_list|,
name|J6502
argument_list|,
literal|0x0a2
argument_list|,
literal|0x0a2
argument_list|,
name|UQ_BAD_ADC
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|DALLAS
argument_list|,
name|J6502
argument_list|,
literal|0x0a2
argument_list|,
literal|0x0a2
argument_list|,
name|UQ_AU_NO_XU
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ALTEC
argument_list|,
name|ADA70
argument_list|,
literal|0x103
argument_list|,
literal|0x103
argument_list|,
name|UQ_BAD_ADC
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ALTEC
argument_list|,
name|ASC495
argument_list|,
literal|0x000
argument_list|,
literal|0x000
argument_list|,
name|UQ_BAD_AUDIO
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|QTRONIX
argument_list|,
literal|980N
argument_list|,
literal|0x110
argument_list|,
literal|0x110
argument_list|,
name|UQ_SPUR_BUT_UP
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ALCOR2
argument_list|,
name|KBD_HUB
argument_list|,
literal|0x001
argument_list|,
literal|0x001
argument_list|,
name|UQ_SPUR_BUT_UP
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MCT
argument_list|,
name|HUB0100
argument_list|,
literal|0x102
argument_list|,
literal|0x102
argument_list|,
name|UQ_BUS_POWERED
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MCT
argument_list|,
name|USB232
argument_list|,
literal|0x102
argument_list|,
literal|0x102
argument_list|,
name|UQ_BUS_POWERED
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|TI
argument_list|,
name|UTUSB41
argument_list|,
literal|0x110
argument_list|,
literal|0x110
argument_list|,
name|UQ_POWER_CLAIM
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|TELEX
argument_list|,
name|MIC1
argument_list|,
literal|0x009
argument_list|,
literal|0x009
argument_list|,
name|UQ_AU_NO_FRAC
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SILICONPORTALS
argument_list|,
name|YAPPHONE
argument_list|,
literal|0x100
argument_list|,
literal|0x100
argument_list|,
name|UQ_AU_INP_ASYNC
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|LOGITECH
argument_list|,
name|UN53B
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_NO_STRINGS
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ELSA
argument_list|,
name|MODEM1
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_CFG_INDEX_1
argument_list|)
block|,
comment|/* 	 * XXX The following quirks should have a more specific revision 	 * number: 	 */
name|USB_QUIRK
argument_list|(
name|HP
argument_list|,
literal|895C
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_BROKEN_BIDIR
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|HP
argument_list|,
literal|880C
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_BROKEN_BIDIR
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|HP
argument_list|,
literal|815C
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_BROKEN_BIDIR
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|HP
argument_list|,
literal|810C
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_BROKEN_BIDIR
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|HP
argument_list|,
literal|830C
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_BROKEN_BIDIR
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|HP
argument_list|,
literal|1220C
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_BROKEN_BIDIR
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|XEROX
argument_list|,
name|WCM15
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_BROKEN_BIDIR
argument_list|)
block|,
comment|/* Devices which should be ignored by uhid */
name|USB_QUIRK
argument_list|(
name|APC
argument_list|,
name|UPS
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_HID_IGNORE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|BELKIN
argument_list|,
name|F6C550AVR
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_HID_IGNORE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|CYBERPOWER
argument_list|,
literal|1500CAVRLCD
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_HID_IGNORE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|DELORME
argument_list|,
name|EARTHMATE
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_HID_IGNORE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ITUNERNET
argument_list|,
name|USBLCD2X20
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_HID_IGNORE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ITUNERNET
argument_list|,
name|USBLCD4X20
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_HID_IGNORE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MGE
argument_list|,
name|UPS1
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_HID_IGNORE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MGE
argument_list|,
name|UPS2
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_HID_IGNORE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|APPLE
argument_list|,
name|IPHONE
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_HID_IGNORE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|APPLE
argument_list|,
name|IPHONE_3G
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_HID_IGNORE
argument_list|)
block|,
comment|/* Devices which should be ignored by both ukbd and uhid */
name|USB_QUIRK
argument_list|(
name|CYPRESS
argument_list|,
name|WISPY1A
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_KBD_IGNORE
argument_list|,
name|UQ_HID_IGNORE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|METAGEEK
argument_list|,
name|WISPY1B
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_KBD_IGNORE
argument_list|,
name|UQ_HID_IGNORE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|TENX
argument_list|,
name|UAUDIO0
argument_list|,
literal|0x0101
argument_list|,
literal|0x0101
argument_list|,
name|UQ_AUDIO_SWAP_LR
argument_list|)
block|,
comment|/* MS keyboards do weird things */
name|USB_QUIRK
argument_list|(
name|MICROSOFT
argument_list|,
name|WLINTELLIMOUSE
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MS_LEADING_BYTE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|METAGEEK
argument_list|,
name|WISPY24X
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_KBD_IGNORE
argument_list|,
name|UQ_HID_IGNORE
argument_list|)
block|,
comment|/* umodem(4) device quirks */
name|USB_QUIRK
argument_list|(
name|METRICOM
argument_list|,
name|RICOCHET_GS
argument_list|,
literal|0x100
argument_list|,
literal|0x100
argument_list|,
name|UQ_ASSUME_CM_OVER_DATA
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SANYO
argument_list|,
name|SCP4900
argument_list|,
literal|0x000
argument_list|,
literal|0x000
argument_list|,
name|UQ_ASSUME_CM_OVER_DATA
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MOTOROLA2
argument_list|,
name|T720C
argument_list|,
literal|0x001
argument_list|,
literal|0x001
argument_list|,
name|UQ_ASSUME_CM_OVER_DATA
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|EICON
argument_list|,
name|DIVA852
argument_list|,
literal|0x100
argument_list|,
literal|0x100
argument_list|,
name|UQ_ASSUME_CM_OVER_DATA
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SIEMENS2
argument_list|,
name|ES75
argument_list|,
literal|0x000
argument_list|,
literal|0x000
argument_list|,
name|UQ_ASSUME_CM_OVER_DATA
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|QUALCOMM
argument_list|,
name|CDMA_MSM
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_ASSUME_CM_OVER_DATA
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|QUALCOMM2
argument_list|,
name|CDMA_MSM
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_ASSUME_CM_OVER_DATA
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|CURITEL
argument_list|,
name|UM175
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_ASSUME_CM_OVER_DATA
argument_list|)
block|,
comment|/* USB Mass Storage Class Quirks */
name|USB_QUIRK_VP
argument_list|(
name|USB_VENDOR_ASAHIOPTICAL
argument_list|,
literal|0
argument_list|,
name|UQ_MSC_NO_RS_CLEAR_UA
argument_list|,
name|UQ_MATCH_VENDOR_ONLY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ADDON
argument_list|,
name|ATTACHE
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ADDON
argument_list|,
name|A256MB
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ADDON
argument_list|,
name|DISKPRO512
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ADDONICS2
argument_list|,
name|CABLE_205
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|AIPTEK
argument_list|,
name|POCKETCAM3M
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|AIPTEK2
argument_list|,
name|SUNPLUS_TECH
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ALCOR
argument_list|,
name|SDCR_6335
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_NO_TEST_UNIT_READY
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ALCOR
argument_list|,
name|AU6390
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ALCOR
argument_list|,
name|UMCR_9361
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ALCOR
argument_list|,
name|TRANSCEND
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ASAHIOPTICAL
argument_list|,
name|OPTIO230
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ASAHIOPTICAL
argument_list|,
name|OPTIO330
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|BELKIN
argument_list|,
name|USB2SCSI
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|CASIO
argument_list|,
name|QV_DIGICAM
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|CCYU
argument_list|,
name|ED1064
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|CENTURY
argument_list|,
name|EX35QUAT
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_FORCE_SHORT_INQ
argument_list|,
name|UQ_MSC_NO_START_STOP
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|CENTURY
argument_list|,
name|EX35SW4_SB4
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|CYPRESS
argument_list|,
name|XX6830XX
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|DESKNOTE
argument_list|,
name|UCR_61S2B
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|DMI
argument_list|,
name|CFSM_RW
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|DMI
argument_list|,
name|DISK
argument_list|,
literal|0x000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|EPSON
argument_list|,
name|STYLUS_875DC
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|EPSON
argument_list|,
name|STYLUS_895
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|FEIYA
argument_list|,
literal|5IN1
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|FREECOM
argument_list|,
name|DVD
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|FUJIPHOTO
argument_list|,
name|MASS0100
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI_I
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|,
name|UQ_MSC_NO_RS_CLEAR_UA
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|GENESYS
argument_list|,
name|GL641USB2IDE
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_FORCE_SHORT_INQ
argument_list|,
name|UQ_MSC_NO_START_STOP
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|GENESYS
argument_list|,
name|GL641USB2IDE_2
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|,
name|UQ_MSC_FORCE_SHORT_INQ
argument_list|,
name|UQ_MSC_NO_START_STOP
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|GENESYS
argument_list|,
name|GL641USB
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_FORCE_SHORT_INQ
argument_list|,
name|UQ_MSC_NO_START_STOP
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|GENESYS
argument_list|,
name|GL641USB_2
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_WRONG_CSWSIG
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|HAGIWARA
argument_list|,
name|FG
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|HAGIWARA
argument_list|,
name|FGSM
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|HITACHI
argument_list|,
name|DVDCAM_DZ_MV100A
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|HITACHI
argument_list|,
name|DVDCAM_USB
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI_I
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|HP
argument_list|,
name|CDW4E
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|HP
argument_list|,
name|CDW8200
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI_I
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|,
name|UQ_MSC_NO_TEST_UNIT_READY
argument_list|,
name|UQ_MSC_NO_START_STOP
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|IMAGINATION
argument_list|,
name|DBX1
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_WRONG_CSWSIG
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|INSYSTEM
argument_list|,
name|USBCABLE
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|,
name|UQ_MSC_NO_TEST_UNIT_READY
argument_list|,
name|UQ_MSC_NO_START_STOP
argument_list|,
name|UQ_MSC_ALT_IFACE_1
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|INSYSTEM
argument_list|,
name|ATAPI
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_RBC
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|INSYSTEM
argument_list|,
name|STORAGE_V2
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_RBC
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|IODATA
argument_list|,
name|IU_CD2
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|IODATA
argument_list|,
name|DVR_UEH8
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|IOMEGA
argument_list|,
name|ZIP100
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_TEST_UNIT_READY
argument_list|)
block|,
comment|/* XXX ZIP drives can also use ATAPI */
name|USB_QUIRK
argument_list|(
name|JMICRON
argument_list|,
name|JM20337
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|KYOCERA
argument_list|,
name|FINECAM_L3
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|KYOCERA
argument_list|,
name|FINECAM_S3X
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|KYOCERA
argument_list|,
name|FINECAM_S4
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|KYOCERA
argument_list|,
name|FINECAM_S5
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|LACIE
argument_list|,
name|HD
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_RBC
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|LEXAR
argument_list|,
name|CF_READER
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|LEXAR
argument_list|,
name|JUMPSHOT
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|LOGITEC
argument_list|,
name|LDR_H443SU2
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|LOGITEC
argument_list|,
name|LDR_H443U2
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,)
block|,
name|USB_QUIRK
argument_list|(
name|MELCO
argument_list|,
name|DUBPXXG
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_FORCE_SHORT_INQ
argument_list|,
name|UQ_MSC_NO_START_STOP
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MICROTECH
argument_list|,
name|DPCM
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_TEST_UNIT_READY
argument_list|,
name|UQ_MSC_NO_START_STOP
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MICROTECH
argument_list|,
name|SCSIDB25
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MICROTECH
argument_list|,
name|SCSIHD50
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MINOLTA
argument_list|,
name|E223
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MINOLTA
argument_list|,
name|F300
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MITSUMI
argument_list|,
name|CDRRW
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
operator||
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MOTOROLA2
argument_list|,
name|E398
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_FORCE_SHORT_INQ
argument_list|,
name|UQ_MSC_NO_INQUIRY_EVPD
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK_VP
argument_list|(
name|USB_VENDOR_MPMAN
argument_list|,
literal|0
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|,
name|UQ_MATCH_VENDOR_ONLY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MSYSTEMS
argument_list|,
name|DISKONKEY
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|,
name|UQ_MSC_NO_RS_CLEAR_UA
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MSYSTEMS
argument_list|,
name|DISKONKEY2
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MYSON
argument_list|,
name|HEDEN
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MYSON
argument_list|,
name|HEDEN_8813
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MYSON
argument_list|,
name|STARREADER
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|NEODIO
argument_list|,
name|ND3260
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_FORCE_SHORT_INQ
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|NETAC
argument_list|,
name|CF_CARD
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|NETAC
argument_list|,
name|ONLYDISK
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|NETCHIP
argument_list|,
name|CLIK_40
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|NIKON
argument_list|,
name|D300
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|OLYMPUS
argument_list|,
name|C1
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_WRONG_CSWSIG
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|OLYMPUS
argument_list|,
name|C700
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ONSPEC
argument_list|,
name|SDS_HOTFIND_D
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ONSPEC
argument_list|,
name|CFMS_RW
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ONSPEC
argument_list|,
name|CFSM_COMBO
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ONSPEC
argument_list|,
name|CFSM_READER
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ONSPEC
argument_list|,
name|CFSM_READER2
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ONSPEC
argument_list|,
name|MDCFE_B_CF_READER
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ONSPEC
argument_list|,
name|MDSM_B_READER
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ONSPEC
argument_list|,
name|READER
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ONSPEC
argument_list|,
name|UCF100
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|,
name|UQ_MSC_NO_INQUIRY
operator||
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ONSPEC2
argument_list|,
name|IMAGEMATE_SDDR55
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|PANASONIC
argument_list|,
name|KXL840AN
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|PANASONIC
argument_list|,
name|KXLCB20AN
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|PANASONIC
argument_list|,
name|KXLCB35AN
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|PANASONIC
argument_list|,
name|LS120CAM
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_UFI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|PHILIPS
argument_list|,
name|SPE3030CC
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|PLEXTOR
argument_list|,
literal|40_12_40U
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_TEST_UNIT_READY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|PNY
argument_list|,
name|ATTACHE2
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|,
name|UQ_MSC_NO_START_STOP
argument_list|)
block|,
name|USB_QUIRK_VP
argument_list|(
name|USB_VENDOR_SAMSUNG_TECHWIN
argument_list|,
name|USB_PRODUCT_SAMSUNG_TECHWIN_DIGIMAX_410
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SANDISK
argument_list|,
name|SDDR05A
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_READ_CAP_OFFBY1
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SANDISK
argument_list|,
name|SDDR09
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_READ_CAP_OFFBY1
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SANDISK
argument_list|,
name|SDDR12
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_READ_CAP_OFFBY1
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SANDISK
argument_list|,
name|SDCZ2_256
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SANDISK
argument_list|,
name|SDCZ4_128
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SANDISK
argument_list|,
name|SDCZ4_256
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SANDISK
argument_list|,
name|SDDR31
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_READ_CAP_OFFBY1
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SCANLOGIC
argument_list|,
name|SL11R
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SHUTTLE
argument_list|,
name|EUSB
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI_I
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|,
name|UQ_MSC_NO_TEST_UNIT_READY
argument_list|,
name|UQ_MSC_NO_START_STOP
argument_list|,
name|UQ_MSC_SHUTTLE_INIT
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SHUTTLE
argument_list|,
name|CDRW
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SHUTTLE
argument_list|,
name|CF
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SHUTTLE
argument_list|,
name|EUSBATAPI
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SHUTTLE
argument_list|,
name|EUSBCFSM
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SHUTTLE
argument_list|,
name|EUSCSI
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SHUTTLE
argument_list|,
name|HIFD
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SHUTTLE
argument_list|,
name|SDDR09
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SHUTTLE
argument_list|,
name|ZIOMMC
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SIGMATEL
argument_list|,
name|I_BEAD100
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_SHUTTLE_INIT
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SIIG
argument_list|,
name|WINTERREADER
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SKANHEX
argument_list|,
name|MD_7425
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SKANHEX
argument_list|,
name|SX_520Z
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SONY
argument_list|,
name|HANDYCAM
argument_list|,
literal|0x0500
argument_list|,
literal|0x0500
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_RBC
argument_list|,
name|UQ_MSC_RBC_PAD_TO_12
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SONY
argument_list|,
name|CLIE_40_MS
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SONY
argument_list|,
name|DSC
argument_list|,
literal|0x0500
argument_list|,
literal|0x0500
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_RBC
argument_list|,
name|UQ_MSC_RBC_PAD_TO_12
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SONY
argument_list|,
name|DSC
argument_list|,
literal|0x0600
argument_list|,
literal|0x0600
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_RBC
argument_list|,
name|UQ_MSC_RBC_PAD_TO_12
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SONY
argument_list|,
name|DSC
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_RBC
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SONY
argument_list|,
name|HANDYCAM
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_RBC
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SONY
argument_list|,
name|MSC
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_RBC
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SONY
argument_list|,
name|MS_MSC_U03
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_UFI
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SONY
argument_list|,
name|MS_NW_MS7
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SONY
argument_list|,
name|MS_PEG_N760C
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SONY
argument_list|,
name|MSACUS1
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SONY
argument_list|,
name|PORTABLE_HDD_V2
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|SUPERTOP
argument_list|,
name|IDE
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|TAUGA
argument_list|,
name|CAMERAMATE
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|TEAC
argument_list|,
name|FD05PUB
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_UFI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|TECLAST
argument_list|,
name|TLC300
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_NO_TEST_UNIT_READY
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|TREK
argument_list|,
name|MEMKEY
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|TREK
argument_list|,
name|THUMBDRIVE_8MB
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|TRUMPION
argument_list|,
name|C3310
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_UFI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|TRUMPION
argument_list|,
name|MP3
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_RBC
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|TRUMPION
argument_list|,
name|T33520
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|TWINMOS
argument_list|,
name|MDIV
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|VIA
argument_list|,
name|USB2IDEBRIDGE
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|VIVITAR
argument_list|,
literal|35XX
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|WESTERN
argument_list|,
name|COMBO
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_FORCE_SHORT_INQ
argument_list|,
name|UQ_MSC_NO_START_STOP
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|WESTERN
argument_list|,
name|EXTHDD
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_FORCE_SHORT_INQ
argument_list|,
name|UQ_MSC_NO_START_STOP
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|WESTERN
argument_list|,
name|MYBOOK
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY_EVPD
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|WESTERN
argument_list|,
name|MYPASSWORD
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_SHORT_INQ
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|WINMAXGROUP
argument_list|,
name|FLASH64MC
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|YANO
argument_list|,
name|FW800HD
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_FORCE_SHORT_INQ
argument_list|,
name|UQ_MSC_NO_START_STOP
argument_list|,
name|UQ_MSC_IGNORE_RESIDUE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|YANO
argument_list|,
name|U640MO
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI_I
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|,
name|UQ_MSC_FORCE_SHORT_INQ
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|YEDATA
argument_list|,
name|FLASHBUSTERU
argument_list|,
literal|0x0000
argument_list|,
literal|0x007F
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_UFI
argument_list|,
name|UQ_MSC_NO_RS_CLEAR_UA
argument_list|,
name|UQ_MSC_FLOPPY_SPEED
argument_list|,
name|UQ_MSC_NO_TEST_UNIT_READY
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|YEDATA
argument_list|,
name|FLASHBUSTERU
argument_list|,
literal|0x0080
argument_list|,
literal|0x0080
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI_I
argument_list|,
name|UQ_MSC_FORCE_PROTO_UFI
argument_list|,
name|UQ_MSC_NO_RS_CLEAR_UA
argument_list|,
name|UQ_MSC_FLOPPY_SPEED
argument_list|,
name|UQ_MSC_NO_TEST_UNIT_READY
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|YEDATA
argument_list|,
name|FLASHBUSTERU
argument_list|,
literal|0x0081
argument_list|,
literal|0xFFFF
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI_I
argument_list|,
name|UQ_MSC_FORCE_PROTO_UFI
argument_list|,
name|UQ_MSC_NO_RS_CLEAR_UA
argument_list|,
name|UQ_MSC_FLOPPY_SPEED
argument_list|,
name|UQ_MSC_NO_GETMAXLUN
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ZORAN
argument_list|,
name|EX20DSC
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_CBI
argument_list|,
name|UQ_MSC_FORCE_PROTO_ATAPI
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|MEIZU
argument_list|,
name|M6_SL
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_INQUIRY
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ACTIONS
argument_list|,
name|MP4
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_FORCE_WIRE_BBB
argument_list|,
name|UQ_MSC_FORCE_PROTO_SCSI
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|,
name|USB_QUIRK
argument_list|(
name|ASUS
argument_list|,
name|GMSC
argument_list|,
literal|0x0000
argument_list|,
literal|0xffff
argument_list|,
name|UQ_MSC_NO_SYNC_CACHE
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_undef
undef|#
directive|undef
name|USB_QUIRK_VP
end_undef

begin_undef
undef|#
directive|undef
name|USB_QUIRK
end_undef

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|usb_quirk_str
index|[
name|USB_QUIRK_MAX
index|]
init|=
block|{
index|[
name|UQ_NONE
index|]
operator|=
literal|"UQ_NONE"
block|,
index|[
name|UQ_MATCH_VENDOR_ONLY
index|]
operator|=
literal|"UQ_MATCH_VENDOR_ONLY"
block|,
index|[
name|UQ_AUDIO_SWAP_LR
index|]
operator|=
literal|"UQ_AUDIO_SWAP_LR"
block|,
index|[
name|UQ_AU_INP_ASYNC
index|]
operator|=
literal|"UQ_AU_INP_ASYNC"
block|,
index|[
name|UQ_AU_NO_FRAC
index|]
operator|=
literal|"UQ_AU_NO_FRAC"
block|,
index|[
name|UQ_AU_NO_XU
index|]
operator|=
literal|"UQ_AU_NO_XU"
block|,
index|[
name|UQ_BAD_ADC
index|]
operator|=
literal|"UQ_BAD_ADC"
block|,
index|[
name|UQ_BAD_AUDIO
index|]
operator|=
literal|"UQ_BAD_AUDIO"
block|,
index|[
name|UQ_BROKEN_BIDIR
index|]
operator|=
literal|"UQ_BROKEN_BIDIR"
block|,
index|[
name|UQ_BUS_POWERED
index|]
operator|=
literal|"UQ_BUS_POWERED"
block|,
index|[
name|UQ_HID_IGNORE
index|]
operator|=
literal|"UQ_HID_IGNORE"
block|,
index|[
name|UQ_KBD_IGNORE
index|]
operator|=
literal|"UQ_KBD_IGNORE"
block|,
index|[
name|UQ_MS_BAD_CLASS
index|]
operator|=
literal|"UQ_MS_BAD_CLASS"
block|,
index|[
name|UQ_MS_LEADING_BYTE
index|]
operator|=
literal|"UQ_MS_LEADING_BYTE"
block|,
index|[
name|UQ_MS_REVZ
index|]
operator|=
literal|"UQ_MS_REVZ"
block|,
index|[
name|UQ_NO_STRINGS
index|]
operator|=
literal|"UQ_NO_STRINGS"
block|,
index|[
name|UQ_OPEN_CLEARSTALL
index|]
operator|=
literal|"UQ_OPEN_CLEARSTALL"
block|,
index|[
name|UQ_POWER_CLAIM
index|]
operator|=
literal|"UQ_POWER_CLAIM"
block|,
index|[
name|UQ_SPUR_BUT_UP
index|]
operator|=
literal|"UQ_SPUR_BUT_UP"
block|,
index|[
name|UQ_SWAP_UNICODE
index|]
operator|=
literal|"UQ_SWAP_UNICODE"
block|,
index|[
name|UQ_CFG_INDEX_1
index|]
operator|=
literal|"UQ_CFG_INDEX_1"
block|,
index|[
name|UQ_CFG_INDEX_2
index|]
operator|=
literal|"UQ_CFG_INDEX_2"
block|,
index|[
name|UQ_CFG_INDEX_3
index|]
operator|=
literal|"UQ_CFG_INDEX_3"
block|,
index|[
name|UQ_CFG_INDEX_4
index|]
operator|=
literal|"UQ_CFG_INDEX_4"
block|,
index|[
name|UQ_CFG_INDEX_0
index|]
operator|=
literal|"UQ_CFG_INDEX_0"
block|,
index|[
name|UQ_ASSUME_CM_OVER_DATA
index|]
operator|=
literal|"UQ_ASSUME_CM_OVER_DATA"
block|,
index|[
name|UQ_MSC_NO_TEST_UNIT_READY
index|]
operator|=
literal|"UQ_MSC_NO_TEST_UNIT_READY"
block|,
index|[
name|UQ_MSC_NO_RS_CLEAR_UA
index|]
operator|=
literal|"UQ_MSC_NO_RS_CLEAR_UA"
block|,
index|[
name|UQ_MSC_NO_START_STOP
index|]
operator|=
literal|"UQ_MSC_NO_START_STOP"
block|,
index|[
name|UQ_MSC_NO_GETMAXLUN
index|]
operator|=
literal|"UQ_MSC_NO_GETMAXLUN"
block|,
index|[
name|UQ_MSC_NO_INQUIRY
index|]
operator|=
literal|"UQ_MSC_NO_INQUIRY"
block|,
index|[
name|UQ_MSC_NO_INQUIRY_EVPD
index|]
operator|=
literal|"UQ_MSC_NO_INQUIRY_EVPD"
block|,
index|[
name|UQ_MSC_NO_SYNC_CACHE
index|]
operator|=
literal|"UQ_MSC_NO_SYNC_CACHE"
block|,
index|[
name|UQ_MSC_SHUTTLE_INIT
index|]
operator|=
literal|"UQ_MSC_SHUTTLE_INIT"
block|,
index|[
name|UQ_MSC_ALT_IFACE_1
index|]
operator|=
literal|"UQ_MSC_ALT_IFACE_1"
block|,
index|[
name|UQ_MSC_FLOPPY_SPEED
index|]
operator|=
literal|"UQ_MSC_FLOPPY_SPEED"
block|,
index|[
name|UQ_MSC_IGNORE_RESIDUE
index|]
operator|=
literal|"UQ_MSC_IGNORE_RESIDUE"
block|,
index|[
name|UQ_MSC_WRONG_CSWSIG
index|]
operator|=
literal|"UQ_MSC_WRONG_CSWSIG"
block|,
index|[
name|UQ_MSC_RBC_PAD_TO_12
index|]
operator|=
literal|"UQ_MSC_RBC_PAD_TO_12"
block|,
index|[
name|UQ_MSC_READ_CAP_OFFBY1
index|]
operator|=
literal|"UQ_MSC_READ_CAP_OFFBY1"
block|,
index|[
name|UQ_MSC_FORCE_SHORT_INQ
index|]
operator|=
literal|"UQ_MSC_FORCE_SHORT_INQ"
block|,
index|[
name|UQ_MSC_FORCE_WIRE_BBB
index|]
operator|=
literal|"UQ_MSC_FORCE_WIRE_BBB"
block|,
index|[
name|UQ_MSC_FORCE_WIRE_CBI
index|]
operator|=
literal|"UQ_MSC_FORCE_WIRE_CBI"
block|,
index|[
name|UQ_MSC_FORCE_WIRE_CBI_I
index|]
operator|=
literal|"UQ_MSC_FORCE_WIRE_CBI_I"
block|,
index|[
name|UQ_MSC_FORCE_PROTO_SCSI
index|]
operator|=
literal|"UQ_MSC_FORCE_PROTO_SCSI"
block|,
index|[
name|UQ_MSC_FORCE_PROTO_ATAPI
index|]
operator|=
literal|"UQ_MSC_FORCE_PROTO_ATAPI"
block|,
index|[
name|UQ_MSC_FORCE_PROTO_UFI
index|]
operator|=
literal|"UQ_MSC_FORCE_PROTO_UFI"
block|,
index|[
name|UQ_MSC_FORCE_PROTO_RBC
index|]
operator|=
literal|"UQ_MSC_FORCE_PROTO_RBC"
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*------------------------------------------------------------------------*  *	usb_quirkstr  *  * This function converts an USB quirk code into a string.  *------------------------------------------------------------------------*/
end_comment

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|usb_quirkstr
parameter_list|(
name|uint16_t
name|quirk
parameter_list|)
block|{
return|return
operator|(
operator|(
name|quirk
operator|<
name|USB_QUIRK_MAX
operator|)
condition|?
name|usb_quirk_str
index|[
name|quirk
index|]
else|:
literal|"USB_QUIRK_UNKNOWN"
operator|)
return|;
block|}
end_function

begin_comment
comment|/*------------------------------------------------------------------------*  *	usb_test_quirk_by_info  *  * Returns:  * 0: Quirk not found  * Else: Quirk found  *------------------------------------------------------------------------*/
end_comment

begin_function
specifier|static
name|uint8_t
name|usb_test_quirk_by_info
parameter_list|(
specifier|const
name|struct
name|usbd_lookup_info
modifier|*
name|info
parameter_list|,
name|uint16_t
name|quirk
parameter_list|)
block|{
name|uint16_t
name|x
decl_stmt|;
name|uint16_t
name|y
decl_stmt|;
if|if
condition|(
name|quirk
operator|==
name|UQ_NONE
condition|)
block|{
return|return
operator|(
literal|0
operator|)
return|;
block|}
name|mtx_lock
argument_list|(
operator|&
name|usb_quirk_mtx
argument_list|)
expr_stmt|;
for|for
control|(
name|x
operator|=
literal|0
init|;
name|x
operator|!=
name|USB_DEV_QUIRKS_MAX
condition|;
name|x
operator|++
control|)
block|{
comment|/* see if quirk information does not match */
if|if
condition|(
operator|(
name|usb_quirks
index|[
name|x
index|]
operator|.
name|vid
operator|!=
name|info
operator|->
name|idVendor
operator|)
operator|||
operator|(
name|usb_quirks
index|[
name|x
index|]
operator|.
name|lo_rev
operator|>
name|info
operator|->
name|bcdDevice
operator|)
operator|||
operator|(
name|usb_quirks
index|[
name|x
index|]
operator|.
name|hi_rev
operator|<
name|info
operator|->
name|bcdDevice
operator|)
condition|)
block|{
continue|continue;
block|}
comment|/* see if quirk only should match vendor ID */
if|if
condition|(
name|usb_quirks
index|[
name|x
index|]
operator|.
name|pid
operator|!=
name|info
operator|->
name|idProduct
condition|)
block|{
if|if
condition|(
name|usb_quirks
index|[
name|x
index|]
operator|.
name|pid
operator|!=
literal|0
condition|)
continue|continue;
for|for
control|(
name|y
operator|=
literal|0
init|;
name|y
operator|!=
name|USB_SUB_QUIRKS_MAX
condition|;
name|y
operator|++
control|)
block|{
if|if
condition|(
name|usb_quirks
index|[
name|x
index|]
operator|.
name|quirks
index|[
name|y
index|]
operator|==
name|UQ_MATCH_VENDOR_ONLY
condition|)
break|break;
block|}
if|if
condition|(
name|y
operator|==
name|USB_SUB_QUIRKS_MAX
condition|)
continue|continue;
block|}
comment|/* lookup quirk */
for|for
control|(
name|y
operator|=
literal|0
init|;
name|y
operator|!=
name|USB_SUB_QUIRKS_MAX
condition|;
name|y
operator|++
control|)
block|{
if|if
condition|(
name|usb_quirks
index|[
name|x
index|]
operator|.
name|quirks
index|[
name|y
index|]
operator|==
name|quirk
condition|)
block|{
name|mtx_unlock
argument_list|(
operator|&
name|usb_quirk_mtx
argument_list|)
expr_stmt|;
name|DPRINTF
argument_list|(
literal|"Found quirk '%s'.\n"
argument_list|,
name|usb_quirkstr
argument_list|(
name|quirk
argument_list|)
argument_list|)
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
block|}
comment|/* no quirk found */
break|break;
block|}
name|mtx_unlock
argument_list|(
operator|&
name|usb_quirk_mtx
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|struct
name|usb_quirk_entry
modifier|*
name|usb_quirk_get_entry
parameter_list|(
name|uint16_t
name|vid
parameter_list|,
name|uint16_t
name|pid
parameter_list|,
name|uint16_t
name|lo_rev
parameter_list|,
name|uint16_t
name|hi_rev
parameter_list|,
name|uint8_t
name|do_alloc
parameter_list|)
block|{
name|uint16_t
name|x
decl_stmt|;
name|mtx_assert
argument_list|(
operator|&
name|usb_quirk_mtx
argument_list|,
name|MA_OWNED
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|vid
operator||
name|pid
operator||
name|lo_rev
operator||
name|hi_rev
operator|)
operator|==
literal|0
condition|)
block|{
comment|/* all zero - special case */
return|return
operator|(
name|usb_quirks
operator|+
name|USB_DEV_QUIRKS_MAX
operator|-
literal|1
operator|)
return|;
block|}
comment|/* search for an existing entry */
for|for
control|(
name|x
operator|=
literal|0
init|;
name|x
operator|!=
name|USB_DEV_QUIRKS_MAX
condition|;
name|x
operator|++
control|)
block|{
comment|/* see if quirk information does not match */
if|if
condition|(
operator|(
name|usb_quirks
index|[
name|x
index|]
operator|.
name|vid
operator|!=
name|vid
operator|)
operator|||
operator|(
name|usb_quirks
index|[
name|x
index|]
operator|.
name|pid
operator|!=
name|pid
operator|)
operator|||
operator|(
name|usb_quirks
index|[
name|x
index|]
operator|.
name|lo_rev
operator|!=
name|lo_rev
operator|)
operator|||
operator|(
name|usb_quirks
index|[
name|x
index|]
operator|.
name|hi_rev
operator|!=
name|hi_rev
operator|)
condition|)
block|{
continue|continue;
block|}
return|return
operator|(
name|usb_quirks
operator|+
name|x
operator|)
return|;
block|}
if|if
condition|(
name|do_alloc
operator|==
literal|0
condition|)
block|{
comment|/* no match */
return|return
operator|(
name|NULL
operator|)
return|;
block|}
comment|/* search for a free entry */
for|for
control|(
name|x
operator|=
literal|0
init|;
name|x
operator|!=
name|USB_DEV_QUIRKS_MAX
condition|;
name|x
operator|++
control|)
block|{
comment|/* see if quirk information does not match */
if|if
condition|(
operator|(
name|usb_quirks
index|[
name|x
index|]
operator|.
name|vid
operator||
name|usb_quirks
index|[
name|x
index|]
operator|.
name|pid
operator||
name|usb_quirks
index|[
name|x
index|]
operator|.
name|lo_rev
operator||
name|usb_quirks
index|[
name|x
index|]
operator|.
name|hi_rev
operator|)
operator|!=
literal|0
condition|)
block|{
continue|continue;
block|}
name|usb_quirks
index|[
name|x
index|]
operator|.
name|vid
operator|=
name|vid
expr_stmt|;
name|usb_quirks
index|[
name|x
index|]
operator|.
name|pid
operator|=
name|pid
expr_stmt|;
name|usb_quirks
index|[
name|x
index|]
operator|.
name|lo_rev
operator|=
name|lo_rev
expr_stmt|;
name|usb_quirks
index|[
name|x
index|]
operator|.
name|hi_rev
operator|=
name|hi_rev
expr_stmt|;
return|return
operator|(
name|usb_quirks
operator|+
name|x
operator|)
return|;
block|}
comment|/* no entry found */
return|return
operator|(
name|NULL
operator|)
return|;
block|}
end_function

begin_comment
comment|/*------------------------------------------------------------------------*  *	usb_quirk_ioctl - handle quirk IOCTLs  *  * Returns:  * 0: Success  * Else: Failure  *------------------------------------------------------------------------*/
end_comment

begin_function
specifier|static
name|int
name|usb_quirk_ioctl
parameter_list|(
name|unsigned
name|long
name|cmd
parameter_list|,
name|caddr_t
name|data
parameter_list|,
name|int
name|fflag
parameter_list|,
name|struct
name|thread
modifier|*
name|td
parameter_list|)
block|{
name|struct
name|usb_gen_quirk
modifier|*
name|pgq
decl_stmt|;
name|struct
name|usb_quirk_entry
modifier|*
name|pqe
decl_stmt|;
name|uint32_t
name|x
decl_stmt|;
name|uint32_t
name|y
decl_stmt|;
name|int
name|err
decl_stmt|;
switch|switch
condition|(
name|cmd
condition|)
block|{
case|case
name|USB_DEV_QUIRK_GET
case|:
name|pgq
operator|=
operator|(
name|void
operator|*
operator|)
name|data
expr_stmt|;
name|x
operator|=
name|pgq
operator|->
name|index
operator|%
name|USB_SUB_QUIRKS_MAX
expr_stmt|;
name|y
operator|=
name|pgq
operator|->
name|index
operator|/
name|USB_SUB_QUIRKS_MAX
expr_stmt|;
if|if
condition|(
name|y
operator|>=
name|USB_DEV_QUIRKS_MAX
condition|)
block|{
return|return
operator|(
name|EINVAL
operator|)
return|;
block|}
name|mtx_lock
argument_list|(
operator|&
name|usb_quirk_mtx
argument_list|)
expr_stmt|;
comment|/* copy out data */
name|pgq
operator|->
name|vid
operator|=
name|usb_quirks
index|[
name|y
index|]
operator|.
name|vid
expr_stmt|;
name|pgq
operator|->
name|pid
operator|=
name|usb_quirks
index|[
name|y
index|]
operator|.
name|pid
expr_stmt|;
name|pgq
operator|->
name|bcdDeviceLow
operator|=
name|usb_quirks
index|[
name|y
index|]
operator|.
name|lo_rev
expr_stmt|;
name|pgq
operator|->
name|bcdDeviceHigh
operator|=
name|usb_quirks
index|[
name|y
index|]
operator|.
name|hi_rev
expr_stmt|;
name|strlcpy
argument_list|(
name|pgq
operator|->
name|quirkname
argument_list|,
name|usb_quirkstr
argument_list|(
name|usb_quirks
index|[
name|y
index|]
operator|.
name|quirks
index|[
name|x
index|]
argument_list|)
argument_list|,
sizeof|sizeof
argument_list|(
name|pgq
operator|->
name|quirkname
argument_list|)
argument_list|)
expr_stmt|;
name|mtx_unlock
argument_list|(
operator|&
name|usb_quirk_mtx
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
comment|/* success */
case|case
name|USB_QUIRK_NAME_GET
case|:
name|pgq
operator|=
operator|(
name|void
operator|*
operator|)
name|data
expr_stmt|;
name|x
operator|=
name|pgq
operator|->
name|index
expr_stmt|;
if|if
condition|(
name|x
operator|>=
name|USB_QUIRK_MAX
condition|)
block|{
return|return
operator|(
name|EINVAL
operator|)
return|;
block|}
name|strlcpy
argument_list|(
name|pgq
operator|->
name|quirkname
argument_list|,
name|usb_quirkstr
argument_list|(
name|x
argument_list|)
argument_list|,
sizeof|sizeof
argument_list|(
name|pgq
operator|->
name|quirkname
argument_list|)
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
comment|/* success */
case|case
name|USB_DEV_QUIRK_ADD
case|:
name|pgq
operator|=
operator|(
name|void
operator|*
operator|)
name|data
expr_stmt|;
comment|/* check privileges */
name|err
operator|=
name|priv_check
argument_list|(
name|curthread
argument_list|,
name|PRIV_DRIVER
argument_list|)
expr_stmt|;
if|if
condition|(
name|err
condition|)
block|{
return|return
operator|(
name|err
operator|)
return|;
block|}
comment|/* convert quirk string into numerical */
for|for
control|(
name|y
operator|=
literal|0
init|;
name|y
operator|!=
name|USB_DEV_QUIRKS_MAX
condition|;
name|y
operator|++
control|)
block|{
if|if
condition|(
name|strcmp
argument_list|(
name|pgq
operator|->
name|quirkname
argument_list|,
name|usb_quirkstr
argument_list|(
name|y
argument_list|)
argument_list|)
operator|==
literal|0
condition|)
block|{
break|break;
block|}
block|}
if|if
condition|(
name|y
operator|==
name|USB_DEV_QUIRKS_MAX
condition|)
block|{
return|return
operator|(
name|EINVAL
operator|)
return|;
block|}
if|if
condition|(
name|y
operator|==
name|UQ_NONE
condition|)
block|{
return|return
operator|(
name|EINVAL
operator|)
return|;
block|}
name|mtx_lock
argument_list|(
operator|&
name|usb_quirk_mtx
argument_list|)
expr_stmt|;
name|pqe
operator|=
name|usb_quirk_get_entry
argument_list|(
name|pgq
operator|->
name|vid
argument_list|,
name|pgq
operator|->
name|pid
argument_list|,
name|pgq
operator|->
name|bcdDeviceLow
argument_list|,
name|pgq
operator|->
name|bcdDeviceHigh
argument_list|,
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|pqe
operator|==
name|NULL
condition|)
block|{
name|mtx_unlock
argument_list|(
operator|&
name|usb_quirk_mtx
argument_list|)
expr_stmt|;
return|return
operator|(
name|EINVAL
operator|)
return|;
block|}
for|for
control|(
name|x
operator|=
literal|0
init|;
name|x
operator|!=
name|USB_SUB_QUIRKS_MAX
condition|;
name|x
operator|++
control|)
block|{
if|if
condition|(
name|pqe
operator|->
name|quirks
index|[
name|x
index|]
operator|==
name|UQ_NONE
condition|)
block|{
name|pqe
operator|->
name|quirks
index|[
name|x
index|]
operator|=
name|y
expr_stmt|;
break|break;
block|}
block|}
name|mtx_unlock
argument_list|(
operator|&
name|usb_quirk_mtx
argument_list|)
expr_stmt|;
if|if
condition|(
name|x
operator|==
name|USB_SUB_QUIRKS_MAX
condition|)
block|{
return|return
operator|(
name|ENOMEM
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
comment|/* success */
case|case
name|USB_DEV_QUIRK_REMOVE
case|:
name|pgq
operator|=
operator|(
name|void
operator|*
operator|)
name|data
expr_stmt|;
comment|/* check privileges */
name|err
operator|=
name|priv_check
argument_list|(
name|curthread
argument_list|,
name|PRIV_DRIVER
argument_list|)
expr_stmt|;
if|if
condition|(
name|err
condition|)
block|{
return|return
operator|(
name|err
operator|)
return|;
block|}
comment|/* convert quirk string into numerical */
for|for
control|(
name|y
operator|=
literal|0
init|;
name|y
operator|!=
name|USB_DEV_QUIRKS_MAX
condition|;
name|y
operator|++
control|)
block|{
if|if
condition|(
name|strcmp
argument_list|(
name|pgq
operator|->
name|quirkname
argument_list|,
name|usb_quirkstr
argument_list|(
name|y
argument_list|)
argument_list|)
operator|==
literal|0
condition|)
block|{
break|break;
block|}
block|}
if|if
condition|(
name|y
operator|==
name|USB_DEV_QUIRKS_MAX
condition|)
block|{
return|return
operator|(
name|EINVAL
operator|)
return|;
block|}
if|if
condition|(
name|y
operator|==
name|UQ_NONE
condition|)
block|{
return|return
operator|(
name|EINVAL
operator|)
return|;
block|}
name|mtx_lock
argument_list|(
operator|&
name|usb_quirk_mtx
argument_list|)
expr_stmt|;
name|pqe
operator|=
name|usb_quirk_get_entry
argument_list|(
name|pgq
operator|->
name|vid
argument_list|,
name|pgq
operator|->
name|pid
argument_list|,
name|pgq
operator|->
name|bcdDeviceLow
argument_list|,
name|pgq
operator|->
name|bcdDeviceHigh
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|pqe
operator|==
name|NULL
condition|)
block|{
name|mtx_unlock
argument_list|(
operator|&
name|usb_quirk_mtx
argument_list|)
expr_stmt|;
return|return
operator|(
name|EINVAL
operator|)
return|;
block|}
for|for
control|(
name|x
operator|=
literal|0
init|;
name|x
operator|!=
name|USB_SUB_QUIRKS_MAX
condition|;
name|x
operator|++
control|)
block|{
if|if
condition|(
name|pqe
operator|->
name|quirks
index|[
name|x
index|]
operator|==
name|y
condition|)
block|{
name|pqe
operator|->
name|quirks
index|[
name|x
index|]
operator|=
name|UQ_NONE
expr_stmt|;
break|break;
block|}
block|}
if|if
condition|(
name|x
operator|==
name|USB_SUB_QUIRKS_MAX
condition|)
block|{
name|mtx_unlock
argument_list|(
operator|&
name|usb_quirk_mtx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ENOMEM
operator|)
return|;
block|}
for|for
control|(
name|x
operator|=
literal|0
init|;
name|x
operator|!=
name|USB_SUB_QUIRKS_MAX
condition|;
name|x
operator|++
control|)
block|{
if|if
condition|(
name|pqe
operator|->
name|quirks
index|[
name|x
index|]
operator|!=
name|UQ_NONE
condition|)
block|{
break|break;
block|}
block|}
if|if
condition|(
name|x
operator|==
name|USB_SUB_QUIRKS_MAX
condition|)
block|{
comment|/* all quirk entries are unused - release */
name|memset
argument_list|(
name|pqe
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|pqe
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|mtx_unlock
argument_list|(
operator|&
name|usb_quirk_mtx
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
comment|/* success */
default|default:
break|break;
block|}
return|return
operator|(
name|ENOIOCTL
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|usb_quirk_init
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
block|{
comment|/* initialize mutex */
name|mtx_init
argument_list|(
operator|&
name|usb_quirk_mtx
argument_list|,
literal|"USB quirk"
argument_list|,
name|NULL
argument_list|,
name|MTX_DEF
argument_list|)
expr_stmt|;
comment|/* register our function */
name|usb_test_quirk_p
operator|=
operator|&
name|usb_test_quirk_by_info
expr_stmt|;
name|usb_quirk_ioctl_p
operator|=
operator|&
name|usb_quirk_ioctl
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|usb_quirk_uninit
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
block|{
name|usb_quirk_unload
argument_list|(
name|arg
argument_list|)
expr_stmt|;
comment|/* destroy mutex */
name|mtx_destroy
argument_list|(
operator|&
name|usb_quirk_mtx
argument_list|)
expr_stmt|;
block|}
end_function

begin_expr_stmt
name|SYSINIT
argument_list|(
name|usb_quirk_init
argument_list|,
name|SI_SUB_LOCK
argument_list|,
name|SI_ORDER_FIRST
argument_list|,
name|usb_quirk_init
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSUNINIT
argument_list|(
name|usb_quirk_uninit
argument_list|,
name|SI_SUB_LOCK
argument_list|,
name|SI_ORDER_ANY
argument_list|,
name|usb_quirk_uninit
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
end_expr_stmt

end_unit

