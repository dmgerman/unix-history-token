begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/******************************************************************************* *Copyright (c) 2014 PMC-Sierra, Inc.  All rights reserved.  * *Redistribution and use in source and binary forms, with or without modification, are permitted provided  *that the following conditions are met:  *1. Redistributions of source code must retain the above copyright notice, this list of conditions and the *following disclaimer.  *2. Redistributions in binary form must reproduce the above copyright notice,  *this list of conditions and the following disclaimer in the documentation and/or other materials provided *with the distribution.  * *THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND ANY EXPRESS OR IMPLIED  *WARRANTIES,INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS *FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE *FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT  *NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR  *BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  *LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS  *SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE  ********************************************************************************/
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_include
include|#
directive|include
file|<dev/pms/config.h>
end_include

begin_include
include|#
directive|include
file|<dev/pms/freebsd/driver/common/osenv.h>
end_include

begin_include
include|#
directive|include
file|<dev/pms/freebsd/driver/common/ostypes.h>
end_include

begin_include
include|#
directive|include
file|<dev/pms/freebsd/driver/common/osdebug.h>
end_include

begin_include
include|#
directive|include
file|<dev/pms/RefTisa/tisa/api/titypes.h>
end_include

begin_include
include|#
directive|include
file|<dev/pms/RefTisa/sallsdk/api/sa.h>
end_include

begin_include
include|#
directive|include
file|<dev/pms/RefTisa/sallsdk/api/saapi.h>
end_include

begin_include
include|#
directive|include
file|<dev/pms/RefTisa/sallsdk/api/saosapi.h>
end_include

begin_include
include|#
directive|include
file|<dev/pms/RefTisa/sat/api/sm.h>
end_include

begin_include
include|#
directive|include
file|<dev/pms/RefTisa/sat/api/smapi.h>
end_include

begin_include
include|#
directive|include
file|<dev/pms/RefTisa/sat/api/tdsmapi.h>
end_include

begin_include
include|#
directive|include
file|<dev/pms/RefTisa/sat/src/smdefs.h>
end_include

begin_include
include|#
directive|include
file|<dev/pms/RefTisa/sat/src/smproto.h>
end_include

begin_include
include|#
directive|include
file|<dev/pms/RefTisa/sat/src/smtypes.h>
end_include

begin_function
name|FORCEINLINE
name|void
modifier|*
name|sm_memset
parameter_list|(
name|void
modifier|*
name|s
parameter_list|,
name|int
name|c
parameter_list|,
name|bit32
name|n
parameter_list|)
block|{
comment|/*  bit32   i;    char *dst = (char *)s;   for (i=0; i< n; i++)   {     dst[i] = (char) c;   }   return (void *)(&dst[i-n]); */
return|return
name|memset
argument_list|(
name|s
argument_list|,
name|c
argument_list|,
name|n
argument_list|)
return|;
block|}
end_function

begin_function
name|FORCEINLINE
name|void
modifier|*
name|sm_memcpy
parameter_list|(
name|void
modifier|*
name|dst
parameter_list|,
specifier|const
name|void
modifier|*
name|src
parameter_list|,
name|bit32
name|count
parameter_list|)
block|{
comment|/*   bit32 x;   unsigned char *dst1 = (unsigned char *)dst;   unsigned char *src1 = (unsigned char *)src;    for (x=0; x< count; x++)     dst1[x] = src1[x];    return dst; */
return|return
name|memcpy
argument_list|(
name|dst
argument_list|,
name|src
argument_list|,
name|count
argument_list|)
return|;
block|}
end_function

begin_function
name|osGLOBAL
name|char
modifier|*
name|sm_strncpy
parameter_list|(
name|char
modifier|*
name|dst
parameter_list|,
specifier|const
name|char
modifier|*
name|src
parameter_list|,
name|bit32
name|len
parameter_list|)
block|{
comment|/*  char *ret = dst;     do {         if (!len--)             return ret;     } while ((*dst++ = *src++));     while (len--)         *dst++ = 0;     return ret;   */
return|return
name|strncpy
argument_list|(
name|dst
argument_list|,
name|src
argument_list|,
name|len
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/** hexidecimal dump */
end_comment

begin_function
name|osGLOBAL
name|void
name|smhexdump
parameter_list|(
specifier|const
name|char
modifier|*
name|ptitle
parameter_list|,
name|bit8
modifier|*
name|pbuf
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
name|size_t
name|i
decl_stmt|;
name|SM_DBG1
argument_list|(
operator|(
literal|"%s - smhexdump(len=%d):\n"
operator|,
name|ptitle
operator|,
operator|(
name|int
operator|)
name|len
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|pbuf
condition|)
block|{
name|SM_DBG1
argument_list|(
operator|(
literal|"pbuf is NULL\n"
operator|)
argument_list|)
expr_stmt|;
return|return;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
control|)
block|{
if|if
condition|(
name|len
operator|-
name|i
operator|>
literal|4
condition|)
block|{
name|SM_DBG1
argument_list|(
operator|(
literal|" 0x%02x, 0x%02x, 0x%02x, 0x%02x,\n"
operator|,
name|pbuf
index|[
name|i
index|]
operator|,
name|pbuf
index|[
name|i
operator|+
literal|1
index|]
operator|,
name|pbuf
index|[
name|i
operator|+
literal|2
index|]
operator|,
name|pbuf
index|[
name|i
operator|+
literal|3
index|]
operator|)
argument_list|)
expr_stmt|;
name|i
operator|+=
literal|4
expr_stmt|;
block|}
else|else
block|{
name|SM_DBG1
argument_list|(
operator|(
literal|" 0x%02x,"
operator|,
name|pbuf
index|[
name|i
index|]
operator|)
argument_list|)
expr_stmt|;
name|i
operator|++
expr_stmt|;
block|}
block|}
name|SM_DBG1
argument_list|(
operator|(
literal|"\n"
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

