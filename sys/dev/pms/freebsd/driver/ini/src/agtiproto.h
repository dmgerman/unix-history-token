begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/******************************************************************************* **Copyright (c) 2014 PMC-Sierra, Inc.  All rights reserved.   * *Redistribution and use in source and binary forms, with or without modification, are permitted provided  *that the following conditions are met:  *1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.  *2. Redistributions in binary form must reproduce the above copyright notice,  *this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.  * *THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, * *INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  *ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,  *SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  *OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, *WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF *THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE ** * $FreeBSD$ ** *******************************************************************************/
end_comment

begin_comment
comment|//void agtiapi_cam_init(struct agtiapi_softc *sc);
end_comment

begin_comment
comment|//void agtiapi_cam_poll( struct cam_sim *asim );
end_comment

begin_function_decl
name|int
name|agtiapi_QueueCmnd_
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
parameter_list|,
name|union
name|ccb
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|agtiapi_alloc_ostimem
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|agtiapi_alloc_requests
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|agtiapi_PrepareSGList
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
parameter_list|,
name|ccb_t
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|agtiapi_PrepareSGListCB
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|,
name|bus_dma_segment_t
modifier|*
name|dm_segs
parameter_list|,
name|int
name|nseg
parameter_list|,
name|int
name|error
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|agtiapi_PrepareSMPSGList
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmcsc
parameter_list|,
name|ccb_t
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|agtiapi_PrepareSMPSGListCB
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|,
name|bus_dma_segment_t
modifier|*
name|dm_segs
parameter_list|,
name|int
name|nsegs
parameter_list|,
name|int
name|error
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|agtiapi_eh_HostReset
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmcsc
parameter_list|,
name|union
name|ccb
modifier|*
name|cmnd
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|agtiapi_FreeCCB
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmcsc
parameter_list|,
name|pccb_t
name|pccb
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|agtiapi_FreeSMPCCB
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmcsc
parameter_list|,
name|pccb_t
name|pccb
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|agtiapi_FreeTMCCB
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmcsc
parameter_list|,
name|pccb_t
name|pccb
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|pccb_t
name|agtiapi_GetCCB
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmcsc
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_SetLunField
parameter_list|(
name|ccb_t
modifier|*
name|pccb
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|agtiapi_QueueCCB
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmcsc
parameter_list|,
name|pccb_t
modifier|*
name|phead
parameter_list|,
name|pccb_t
modifier|*
name|ptail
parameter_list|,
ifdef|#
directive|ifdef
name|AGTIAPI_LOCAL_LOCK
name|struct
name|mtx
modifier|*
name|mutex
parameter_list|,
endif|#
directive|endif
name|ccb_t
modifier|*
name|pccb
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|agtiapi_QueueSMP
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
parameter_list|,
name|union
name|ccb
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|agtiapi_StartIO
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmcsc
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|agtiapi_StartSMP
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmcsc
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|agtiapi_DumpCCB
parameter_list|(
name|ccb_t
modifier|*
name|pccb
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|agtiapi_Done
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmcsc
parameter_list|,
name|ccb_t
modifier|*
name|pccb
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|agtiapi_SMPDone
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmcsc
parameter_list|,
name|ccb_t
modifier|*
name|pccb
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|// void agtiapi_LogEvent(ag_card_t *, U16, U16, U32 *, U08, S08 *, ...);
end_comment

begin_function_decl
name|STATIC
name|U32
name|agtiapi_CheckError
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmcsc
parameter_list|,
name|ccb_t
modifier|*
name|pccb
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|U32
name|agtiapi_CheckSMPError
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmcsc
parameter_list|,
name|ccb_t
modifier|*
name|pccb
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|agtiapi_Retry
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmcsc
parameter_list|,
name|ccb_t
modifier|*
name|pccb
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|agtiapi_scan
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmcsc
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|int
name|agtiapi_FindWWNListNext
parameter_list|(
name|ag_tgt_map_t
modifier|*
name|pWWNList
parameter_list|,
name|int
name|lstMax
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|U32
name|agtiapi_GetDevHandle
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmcsc
parameter_list|,
name|ag_portal_info_t
modifier|*
name|pPortalInfo
parameter_list|,
name|U32
name|eType
parameter_list|,
name|U32
name|eStatus
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|agtiapi_StartTM
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pCard
parameter_list|,
name|ccb_t
modifier|*
name|pccb
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|wwnprintk
parameter_list|(
name|unsigned
name|char
modifier|*
name|name
parameter_list|,
name|int
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|int
name|wwncpy
parameter_list|(
name|ag_device_t
modifier|*
name|pDevice
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|agtiapi_DiscoverTgt
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pCard
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|agBOOLEAN
name|agtiapi_CheckCB
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pCard
parameter_list|,
name|U32
name|milisec
parameter_list|,
name|U32
name|flag
parameter_list|,
specifier|volatile
name|U32
modifier|*
name|pStatus
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|agBOOLEAN
name|agtiapi_DeQueueCCB
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
parameter_list|,
name|pccb_t
modifier|*
parameter_list|,
name|pccb_t
modifier|*
parameter_list|,
ifdef|#
directive|ifdef
name|AGTIAPI_LOCAL_LOCK
name|struct
name|mtx
modifier|*
parameter_list|,
endif|#
directive|endif
name|ccb_t
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_CheckAllVectors
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pCard
parameter_list|,
name|bit32
name|context
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|U32
name|agtiapi_InitCCBs
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pCard
parameter_list|,
name|int
name|tgtCount
parameter_list|,
name|int
name|tid
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|agtiapi_PrepCCBs
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pCard
parameter_list|,
name|ccb_hdr_t
modifier|*
name|hdr
parameter_list|,
name|U32
name|size
parameter_list|,
name|U32
name|max_ccb
parameter_list|,
name|int
name|tid
parameter_list|)
function_decl|;
end_function_decl

begin_ifdef
ifdef|#
directive|ifdef
name|LINUX_PERBI_SUPPORT
end_ifdef

begin_function_decl
name|void
name|agtiapi_GetWWNMappings
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
parameter_list|,
name|ag_mapping_t
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|//#ifndef HOTPLUG_SUPPORT
end_comment

begin_function_decl
name|STATIC
name|void
name|agtiapi_MapWWNList
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pCard
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|//#endif
end_comment

begin_endif
endif|#
directive|endif
end_endif

begin_function_decl
name|STATIC
name|void
name|agtiapi_ReleaseCCBs
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pCard
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|agtiapi_clrRmScan
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pCard
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|agtiapi_TITimer
parameter_list|(
name|void
modifier|*
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|agtiapi_devRmCheck
parameter_list|(
name|void
modifier|*
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|agtiapi_ReleaseHBA
parameter_list|(
name|device_t
name|dev
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_IntrHandler0
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_IntrHandler1
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_IntrHandler2
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_IntrHandler3
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_IntrHandler4
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_IntrHandler5
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_IntrHandler6
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_IntrHandler7
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_IntrHandler8
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_IntrHandler9
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_IntrHandler10
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_IntrHandler11
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_IntrHandler12
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_IntrHandler13
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_IntrHandler14
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_IntrHandler15
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_IntrHandlerx_
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|,
name|int
name|index
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|agBOOLEAN
name|agtiapi_InitCardSW
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmsc
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|agBOOLEAN
name|agtiapi_InitCardHW
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmsc
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|agtiapi_DumpCDB
parameter_list|(
specifier|const
name|char
modifier|*
name|ptitle
parameter_list|,
name|ccb_t
modifier|*
name|pccb
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|agtiapi_hexdump
parameter_list|(
specifier|const
name|char
modifier|*
name|ptitle
parameter_list|,
name|bit8
modifier|*
name|pbuf
parameter_list|,
name|int
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|agtiapi_SglMemoryCB
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|,
name|bus_dma_segment_t
modifier|*
name|dm_segs
parameter_list|,
name|int
name|nseg
parameter_list|,
name|int
name|error
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|agtiapi_MemoryCB
parameter_list|(
name|void
modifier|*
name|arg
parameter_list|,
name|bus_dma_segment_t
modifier|*
name|dm_segs
parameter_list|,
name|int
name|nseg
parameter_list|,
name|int
name|error
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|U32
name|agtiapi_ResetCard
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pCard
parameter_list|,
name|unsigned
name|long
modifier|*
name|flags
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|agtiapi_DoSoftReset
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pmcsc
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|STATIC
name|void
name|agtiapi_FlushCCBs
parameter_list|(
name|struct
name|agtiapi_softc
modifier|*
name|pCard
parameter_list|,
name|U32
name|flag
parameter_list|)
function_decl|;
end_function_decl

end_unit

