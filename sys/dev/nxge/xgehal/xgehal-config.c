begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2002-2007 Neterion, Inc.  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  *  * $FreeBSD$  */
end_comment

begin_include
include|#
directive|include
file|<dev/nxge/include/xgehal-config.h>
end_include

begin_include
include|#
directive|include
file|<dev/nxge/include/xge-debug.h>
end_include

begin_comment
comment|/*  * __hal_tti_config_check - Check tti configuration  * @new_config: tti configuration information  *  * Returns: XGE_HAL_OK - success,  * otherwise one of the xge_hal_status_e{} enumerated error codes.  */
end_comment

begin_function
specifier|static
name|xge_hal_status_e
name|__hal_tti_config_check
parameter_list|(
name|xge_hal_tti_config_t
modifier|*
name|new_config
parameter_list|)
block|{
if|if
condition|(
operator|(
name|new_config
operator|->
name|urange_a
operator|<
name|XGE_HAL_MIN_TX_URANGE_A
operator|)
operator|||
operator|(
name|new_config
operator|->
name|urange_a
operator|>
name|XGE_HAL_MAX_TX_URANGE_A
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_TX_URANGE_A
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|ufc_a
operator|<
name|XGE_HAL_MIN_TX_UFC_A
operator|)
operator|||
operator|(
name|new_config
operator|->
name|ufc_a
operator|>
name|XGE_HAL_MAX_TX_UFC_A
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_TX_UFC_A
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|urange_b
operator|<
name|XGE_HAL_MIN_TX_URANGE_B
operator|)
operator|||
operator|(
name|new_config
operator|->
name|urange_b
operator|>
name|XGE_HAL_MAX_TX_URANGE_B
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_TX_URANGE_B
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|ufc_b
operator|<
name|XGE_HAL_MIN_TX_UFC_B
operator|)
operator|||
operator|(
name|new_config
operator|->
name|ufc_b
operator|>
name|XGE_HAL_MAX_TX_UFC_B
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_TX_UFC_B
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|urange_c
operator|<
name|XGE_HAL_MIN_TX_URANGE_C
operator|)
operator|||
operator|(
name|new_config
operator|->
name|urange_c
operator|>
name|XGE_HAL_MAX_TX_URANGE_C
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_TX_URANGE_C
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|ufc_c
operator|<
name|XGE_HAL_MIN_TX_UFC_C
operator|)
operator|||
operator|(
name|new_config
operator|->
name|ufc_c
operator|>
name|XGE_HAL_MAX_TX_UFC_C
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_TX_UFC_C
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|ufc_d
operator|<
name|XGE_HAL_MIN_TX_UFC_D
operator|)
operator|||
operator|(
name|new_config
operator|->
name|ufc_d
operator|>
name|XGE_HAL_MAX_TX_UFC_D
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_TX_UFC_D
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|timer_val_us
operator|<
name|XGE_HAL_MIN_TX_TIMER_VAL
operator|)
operator|||
operator|(
name|new_config
operator|->
name|timer_val_us
operator|>
name|XGE_HAL_MAX_TX_TIMER_VAL
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_TX_TIMER_VAL
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|timer_ci_en
operator|<
name|XGE_HAL_MIN_TX_TIMER_CI_EN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|timer_ci_en
operator|>
name|XGE_HAL_MAX_TX_TIMER_CI_EN
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_TX_TIMER_CI_EN
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|timer_ac_en
operator|<
name|XGE_HAL_MIN_TX_TIMER_AC_EN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|timer_ac_en
operator|>
name|XGE_HAL_MAX_TX_TIMER_AC_EN
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_TX_TIMER_AC_EN
return|;
block|}
return|return
name|XGE_HAL_OK
return|;
block|}
end_function

begin_comment
comment|/*  * __hal_rti_config_check - Check rti configuration  * @new_config: rti configuration information  *  * Returns: XGE_HAL_OK - success,  * otherwise one of the xge_hal_status_e{} enumerated error codes.  */
end_comment

begin_function
specifier|static
name|xge_hal_status_e
name|__hal_rti_config_check
parameter_list|(
name|xge_hal_rti_config_t
modifier|*
name|new_config
parameter_list|)
block|{
if|if
condition|(
operator|(
name|new_config
operator|->
name|urange_a
operator|<
name|XGE_HAL_MIN_RX_URANGE_A
operator|)
operator|||
operator|(
name|new_config
operator|->
name|urange_a
operator|>
name|XGE_HAL_MAX_RX_URANGE_A
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RX_URANGE_A
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|ufc_a
operator|<
name|XGE_HAL_MIN_RX_UFC_A
operator|)
operator|||
operator|(
name|new_config
operator|->
name|ufc_a
operator|>
name|XGE_HAL_MAX_RX_UFC_A
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RX_UFC_A
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|urange_b
operator|<
name|XGE_HAL_MIN_RX_URANGE_B
operator|)
operator|||
operator|(
name|new_config
operator|->
name|urange_b
operator|>
name|XGE_HAL_MAX_RX_URANGE_B
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RX_URANGE_B
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|ufc_b
operator|<
name|XGE_HAL_MIN_RX_UFC_B
operator|)
operator|||
operator|(
name|new_config
operator|->
name|ufc_b
operator|>
name|XGE_HAL_MAX_RX_UFC_B
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RX_UFC_B
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|urange_c
operator|<
name|XGE_HAL_MIN_RX_URANGE_C
operator|)
operator|||
operator|(
name|new_config
operator|->
name|urange_c
operator|>
name|XGE_HAL_MAX_RX_URANGE_C
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RX_URANGE_C
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|ufc_c
operator|<
name|XGE_HAL_MIN_RX_UFC_C
operator|)
operator|||
operator|(
name|new_config
operator|->
name|ufc_c
operator|>
name|XGE_HAL_MAX_RX_UFC_C
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RX_UFC_C
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|ufc_d
operator|<
name|XGE_HAL_MIN_RX_UFC_D
operator|)
operator|||
operator|(
name|new_config
operator|->
name|ufc_d
operator|>
name|XGE_HAL_MAX_RX_UFC_D
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RX_UFC_D
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|timer_val_us
operator|<
name|XGE_HAL_MIN_RX_TIMER_VAL
operator|)
operator|||
operator|(
name|new_config
operator|->
name|timer_val_us
operator|>
name|XGE_HAL_MAX_RX_TIMER_VAL
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RX_TIMER_VAL
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|timer_ac_en
operator|<
name|XGE_HAL_MIN_RX_TIMER_AC_EN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|timer_ac_en
operator|>
name|XGE_HAL_MAX_RX_TIMER_AC_EN
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RX_TIMER_AC_EN
return|;
block|}
return|return
name|XGE_HAL_OK
return|;
block|}
end_function

begin_comment
comment|/*  * __hal_fifo_queue_check - Check fifo queue configuration  * @new_config: fifo queue configuration information  *  * Returns: XGE_HAL_OK - success,  * otherwise one of the xge_hal_status_e{} enumerated error codes.  */
end_comment

begin_function
specifier|static
name|xge_hal_status_e
name|__hal_fifo_queue_check
parameter_list|(
name|xge_hal_fifo_config_t
modifier|*
name|new_config
parameter_list|,
name|xge_hal_fifo_queue_t
modifier|*
name|new_queue
parameter_list|)
block|{
name|int
name|i
decl_stmt|;
if|if
condition|(
operator|(
name|new_queue
operator|->
name|initial
operator|<
name|XGE_HAL_MIN_FIFO_QUEUE_LENGTH
operator|)
operator|||
operator|(
name|new_queue
operator|->
name|initial
operator|>
name|XGE_HAL_MAX_FIFO_QUEUE_LENGTH
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_FIFO_QUEUE_INITIAL_LENGTH
return|;
block|}
comment|/* FIXME: queue "grow" feature is not supported. 	 *        Use "initial" queue size as the "maximum"; 	 *        Remove the next line when fixed. */
name|new_queue
operator|->
name|max
operator|=
name|new_queue
operator|->
name|initial
expr_stmt|;
if|if
condition|(
operator|(
name|new_queue
operator|->
name|max
operator|<
name|XGE_HAL_MIN_FIFO_QUEUE_LENGTH
operator|)
operator|||
operator|(
name|new_queue
operator|->
name|max
operator|>
name|XGE_HAL_MAX_FIFO_QUEUE_LENGTH
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_FIFO_QUEUE_MAX_LENGTH
return|;
block|}
if|if
condition|(
name|new_queue
operator|->
name|max
operator|<
name|new_config
operator|->
name|reserve_threshold
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_FIFO_RESERVE_THRESHOLD
return|;
block|}
if|if
condition|(
operator|(
name|new_queue
operator|->
name|intr
operator|<
name|XGE_HAL_MIN_FIFO_QUEUE_INTR
operator|)
operator|||
operator|(
name|new_queue
operator|->
name|intr
operator|>
name|XGE_HAL_MAX_FIFO_QUEUE_INTR
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_FIFO_QUEUE_INTR
return|;
block|}
if|if
condition|(
operator|(
name|new_queue
operator|->
name|intr_vector
operator|<
name|XGE_HAL_MIN_FIFO_QUEUE_INTR_VECTOR
operator|)
operator|||
operator|(
name|new_queue
operator|->
name|intr_vector
operator|>
name|XGE_HAL_MAX_FIFO_QUEUE_INTR_VECTOR
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_FIFO_QUEUE_INTR_VECTOR
return|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|XGE_HAL_MAX_FIFO_TTI_NUM
condition|;
name|i
operator|++
control|)
block|{
comment|/* 	     * Validate the tti configuration parameters only if 	     * the TTI feature is enabled. 	     */
if|if
condition|(
name|new_queue
operator|->
name|tti
index|[
name|i
index|]
operator|.
name|enabled
condition|)
block|{
name|xge_hal_status_e
name|status
decl_stmt|;
if|if
condition|(
operator|(
name|status
operator|=
name|__hal_tti_config_check
argument_list|(
operator|&
name|new_queue
operator|->
name|tti
index|[
name|i
index|]
argument_list|)
operator|)
operator|!=
name|XGE_HAL_OK
condition|)
block|{
return|return
name|status
return|;
block|}
block|}
block|}
return|return
name|XGE_HAL_OK
return|;
block|}
end_function

begin_comment
comment|/*  * __hal_ring_queue_check - Check ring queue configuration  * @new_config: ring queue configuration information  *  * Returns: XGE_HAL_OK - success,  * otherwise one of the xge_hal_status_e{} enumerated error codes.  */
end_comment

begin_function
specifier|static
name|xge_hal_status_e
name|__hal_ring_queue_check
parameter_list|(
name|xge_hal_ring_queue_t
modifier|*
name|new_config
parameter_list|)
block|{
if|if
condition|(
operator|(
name|new_config
operator|->
name|initial
operator|<
name|XGE_HAL_MIN_RING_QUEUE_BLOCKS
operator|)
operator|||
operator|(
name|new_config
operator|->
name|initial
operator|>
name|XGE_HAL_MAX_RING_QUEUE_BLOCKS
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RING_QUEUE_INITIAL_BLOCKS
return|;
block|}
comment|/* FIXME: queue "grow" feature is not supported. 	 *        Use "initial" queue size as the "maximum"; 	 *        Remove the next line when fixed. */
name|new_config
operator|->
name|max
operator|=
name|new_config
operator|->
name|initial
expr_stmt|;
if|if
condition|(
operator|(
name|new_config
operator|->
name|max
operator|<
name|XGE_HAL_MIN_RING_QUEUE_BLOCKS
operator|)
operator|||
operator|(
name|new_config
operator|->
name|max
operator|>
name|XGE_HAL_MAX_RING_QUEUE_BLOCKS
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RING_QUEUE_MAX_BLOCKS
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|buffer_mode
operator|!=
name|XGE_HAL_RING_QUEUE_BUFFER_MODE_1
operator|)
operator|&&
operator|(
name|new_config
operator|->
name|buffer_mode
operator|!=
name|XGE_HAL_RING_QUEUE_BUFFER_MODE_3
operator|)
operator|&&
operator|(
name|new_config
operator|->
name|buffer_mode
operator|!=
name|XGE_HAL_RING_QUEUE_BUFFER_MODE_5
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RING_QUEUE_BUFFER_MODE
return|;
block|}
comment|/* 	 * Herc has less DRAM; the check is done later inside 	 * device_initialize() 	 */
if|if
condition|(
operator|(
operator|(
name|new_config
operator|->
name|dram_size_mb
operator|<
name|XGE_HAL_MIN_RING_QUEUE_SIZE
operator|)
operator|||
operator|(
name|new_config
operator|->
name|dram_size_mb
operator|>
name|XGE_HAL_MAX_RING_QUEUE_SIZE_XENA
operator|)
operator|)
operator|&&
name|new_config
operator|->
name|dram_size_mb
operator|!=
name|XGE_HAL_DEFAULT_USE_HARDCODE
condition|)
return|return
name|XGE_HAL_BADCFG_RING_QUEUE_SIZE
return|;
if|if
condition|(
operator|(
name|new_config
operator|->
name|backoff_interval_us
operator|<
name|XGE_HAL_MIN_BACKOFF_INTERVAL_US
operator|)
operator|||
operator|(
name|new_config
operator|->
name|backoff_interval_us
operator|>
name|XGE_HAL_MAX_BACKOFF_INTERVAL_US
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_BACKOFF_INTERVAL_US
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|max_frm_len
operator|<
name|XGE_HAL_MIN_MAX_FRM_LEN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|max_frm_len
operator|>
name|XGE_HAL_MAX_MAX_FRM_LEN
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_MAX_FRM_LEN
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|priority
operator|<
name|XGE_HAL_MIN_RING_PRIORITY
operator|)
operator|||
operator|(
name|new_config
operator|->
name|priority
operator|>
name|XGE_HAL_MAX_RING_PRIORITY
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RING_PRIORITY
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|rth_en
operator|<
name|XGE_HAL_MIN_RING_RTH_EN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|rth_en
operator|>
name|XGE_HAL_MAX_RING_RTH_EN
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RING_RTH_EN
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|rts_mac_en
operator|<
name|XGE_HAL_MIN_RING_RTS_MAC_EN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|rts_mac_en
operator|>
name|XGE_HAL_MAX_RING_RTS_MAC_EN
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RING_RTS_MAC_EN
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|rts_mac_en
operator|<
name|XGE_HAL_MIN_RING_RTS_PORT_EN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|rts_mac_en
operator|>
name|XGE_HAL_MAX_RING_RTS_PORT_EN
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RING_RTS_PORT_EN
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|intr_vector
operator|<
name|XGE_HAL_MIN_RING_QUEUE_INTR_VECTOR
operator|)
operator|||
operator|(
name|new_config
operator|->
name|intr_vector
operator|>
name|XGE_HAL_MAX_RING_QUEUE_INTR_VECTOR
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RING_QUEUE_INTR_VECTOR
return|;
block|}
if|if
condition|(
name|new_config
operator|->
name|indicate_max_pkts
operator|<
name|XGE_HAL_MIN_RING_INDICATE_MAX_PKTS
operator|||
name|new_config
operator|->
name|indicate_max_pkts
operator|>
name|XGE_HAL_MAX_RING_INDICATE_MAX_PKTS
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RING_INDICATE_MAX_PKTS
return|;
block|}
return|return
name|__hal_rti_config_check
argument_list|(
operator|&
name|new_config
operator|->
name|rti
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/*  * __hal_mac_config_check - Check mac configuration  * @new_config: mac configuration information  *  * Returns: XGE_HAL_OK - success,  * otherwise one of the xge_hal_status_e{} enumerated error codes.  */
end_comment

begin_function
specifier|static
name|xge_hal_status_e
name|__hal_mac_config_check
parameter_list|(
name|xge_hal_mac_config_t
modifier|*
name|new_config
parameter_list|)
block|{
if|if
condition|(
operator|(
name|new_config
operator|->
name|tmac_util_period
operator|<
name|XGE_HAL_MIN_TMAC_UTIL_PERIOD
operator|)
operator|||
operator|(
name|new_config
operator|->
name|tmac_util_period
operator|>
name|XGE_HAL_MAX_TMAC_UTIL_PERIOD
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_TMAC_UTIL_PERIOD
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|rmac_util_period
operator|<
name|XGE_HAL_MIN_RMAC_UTIL_PERIOD
operator|)
operator|||
operator|(
name|new_config
operator|->
name|rmac_util_period
operator|>
name|XGE_HAL_MAX_RMAC_UTIL_PERIOD
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RMAC_UTIL_PERIOD
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|rmac_bcast_en
operator|<
name|XGE_HAL_MIN_RMAC_BCAST_EN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|rmac_bcast_en
operator|>
name|XGE_HAL_MAX_RMAC_BCAST_EN
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RMAC_BCAST_EN
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|rmac_pause_gen_en
operator|<
name|XGE_HAL_MIN_RMAC_PAUSE_GEN_EN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|rmac_pause_gen_en
operator|>
name|XGE_HAL_MAX_RMAC_PAUSE_GEN_EN
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RMAC_PAUSE_GEN_EN
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|rmac_pause_rcv_en
operator|<
name|XGE_HAL_MIN_RMAC_PAUSE_RCV_EN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|rmac_pause_rcv_en
operator|>
name|XGE_HAL_MAX_RMAC_PAUSE_RCV_EN
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RMAC_PAUSE_RCV_EN
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|rmac_pause_time
operator|<
name|XGE_HAL_MIN_RMAC_HIGH_PTIME
operator|)
operator|||
operator|(
name|new_config
operator|->
name|rmac_pause_time
operator|>
name|XGE_HAL_MAX_RMAC_HIGH_PTIME
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RMAC_HIGH_PTIME
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|media
operator|<
name|XGE_HAL_MIN_MEDIA
operator|)
operator|||
operator|(
name|new_config
operator|->
name|media
operator|>
name|XGE_HAL_MAX_MEDIA
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_MEDIA
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|mc_pause_threshold_q0q3
operator|<
name|XGE_HAL_MIN_MC_PAUSE_THRESHOLD_Q0Q3
operator|)
operator|||
operator|(
name|new_config
operator|->
name|mc_pause_threshold_q0q3
operator|>
name|XGE_HAL_MAX_MC_PAUSE_THRESHOLD_Q0Q3
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_MC_PAUSE_THRESHOLD_Q0Q3
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|mc_pause_threshold_q4q7
operator|<
name|XGE_HAL_MIN_MC_PAUSE_THRESHOLD_Q4Q7
operator|)
operator|||
operator|(
name|new_config
operator|->
name|mc_pause_threshold_q4q7
operator|>
name|XGE_HAL_MAX_MC_PAUSE_THRESHOLD_Q4Q7
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_MC_PAUSE_THRESHOLD_Q4Q7
return|;
block|}
return|return
name|XGE_HAL_OK
return|;
block|}
end_function

begin_comment
comment|/*  * __hal_fifo_config_check - Check fifo configuration  * @new_config: fifo configuration information  *  * Returns: XGE_HAL_OK - success,  * otherwise one of the xge_hal_status_e{} enumerated error codes.  */
end_comment

begin_function
specifier|static
name|xge_hal_status_e
name|__hal_fifo_config_check
parameter_list|(
name|xge_hal_fifo_config_t
modifier|*
name|new_config
parameter_list|)
block|{
name|int
name|i
decl_stmt|;
name|int
name|total_fifo_length
init|=
literal|0
decl_stmt|;
comment|/* 	 * recompute max_frags to be multiple of 4, 	 * which means, multiple of 128 for TxDL 	 */
name|new_config
operator|->
name|max_frags
operator|=
operator|(
operator|(
name|new_config
operator|->
name|max_frags
operator|+
literal|3
operator|)
operator|>>
literal|2
operator|)
operator|<<
literal|2
expr_stmt|;
if|if
condition|(
operator|(
name|new_config
operator|->
name|max_frags
operator|<
name|XGE_HAL_MIN_FIFO_FRAGS
operator|)
operator|||
operator|(
name|new_config
operator|->
name|max_frags
operator|>
name|XGE_HAL_MAX_FIFO_FRAGS
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_FIFO_FRAGS
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|reserve_threshold
operator|<
name|XGE_HAL_MIN_FIFO_RESERVE_THRESHOLD
operator|)
operator|||
operator|(
name|new_config
operator|->
name|reserve_threshold
operator|>
name|XGE_HAL_MAX_FIFO_RESERVE_THRESHOLD
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_FIFO_RESERVE_THRESHOLD
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|memblock_size
operator|<
name|XGE_HAL_MIN_FIFO_MEMBLOCK_SIZE
operator|)
operator|||
operator|(
name|new_config
operator|->
name|memblock_size
operator|>
name|XGE_HAL_MAX_FIFO_MEMBLOCK_SIZE
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_FIFO_MEMBLOCK_SIZE
return|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|XGE_HAL_MAX_FIFO_NUM
condition|;
name|i
operator|++
control|)
block|{
name|xge_hal_status_e
name|status
decl_stmt|;
if|if
condition|(
operator|!
name|new_config
operator|->
name|queue
index|[
name|i
index|]
operator|.
name|configured
condition|)
continue|continue;
if|if
condition|(
operator|(
name|status
operator|=
name|__hal_fifo_queue_check
argument_list|(
name|new_config
argument_list|,
operator|&
name|new_config
operator|->
name|queue
index|[
name|i
index|]
argument_list|)
operator|)
operator|!=
name|XGE_HAL_OK
condition|)
block|{
return|return
name|status
return|;
block|}
name|total_fifo_length
operator|+=
name|new_config
operator|->
name|queue
index|[
name|i
index|]
operator|.
name|max
expr_stmt|;
block|}
if|if
condition|(
name|total_fifo_length
operator|>
name|XGE_HAL_MAX_FIFO_QUEUE_LENGTH
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_FIFO_QUEUE_MAX_LENGTH
return|;
block|}
return|return
name|XGE_HAL_OK
return|;
block|}
end_function

begin_comment
comment|/*  * __hal_ring_config_check - Check ring configuration  * @new_config: Ring configuration information  *  * Returns: XGE_HAL_OK - success,  * otherwise one of the xge_hal_status_e{} enumerated error codes.  */
end_comment

begin_function
specifier|static
name|xge_hal_status_e
name|__hal_ring_config_check
parameter_list|(
name|xge_hal_ring_config_t
modifier|*
name|new_config
parameter_list|)
block|{
name|int
name|i
decl_stmt|;
if|if
condition|(
operator|(
name|new_config
operator|->
name|memblock_size
operator|<
name|XGE_HAL_MIN_RING_MEMBLOCK_SIZE
operator|)
operator|||
operator|(
name|new_config
operator|->
name|memblock_size
operator|>
name|XGE_HAL_MAX_RING_MEMBLOCK_SIZE
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RING_MEMBLOCK_SIZE
return|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|XGE_HAL_MAX_RING_NUM
condition|;
name|i
operator|++
control|)
block|{
name|xge_hal_status_e
name|status
decl_stmt|;
if|if
condition|(
operator|!
name|new_config
operator|->
name|queue
index|[
name|i
index|]
operator|.
name|configured
condition|)
continue|continue;
if|if
condition|(
operator|(
name|status
operator|=
name|__hal_ring_queue_check
argument_list|(
operator|&
name|new_config
operator|->
name|queue
index|[
name|i
index|]
argument_list|)
operator|)
operator|!=
name|XGE_HAL_OK
condition|)
block|{
return|return
name|status
return|;
block|}
block|}
return|return
name|XGE_HAL_OK
return|;
block|}
end_function

begin_comment
comment|/*  * __hal_device_config_check_common - Check device configuration.  * @new_config: Device configuration information  *  * Check part of configuration that is common to  * Xframe-I and Xframe-II.  *  * Returns: XGE_HAL_OK - success,  * otherwise one of the xge_hal_status_e{} enumerated error codes.  *  * See also: __hal_device_config_check_xena().  */
end_comment

begin_function
name|xge_hal_status_e
name|__hal_device_config_check_common
parameter_list|(
name|xge_hal_device_config_t
modifier|*
name|new_config
parameter_list|)
block|{
name|xge_hal_status_e
name|status
decl_stmt|;
if|if
condition|(
operator|(
name|new_config
operator|->
name|mtu
operator|<
name|XGE_HAL_MIN_MTU
operator|)
operator|||
operator|(
name|new_config
operator|->
name|mtu
operator|>
name|XGE_HAL_MAX_MTU
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_MAX_MTU
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|bimodal_interrupts
operator|<
name|XGE_HAL_BIMODAL_INTR_MIN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|bimodal_interrupts
operator|>
name|XGE_HAL_BIMODAL_INTR_MAX
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_BIMODAL_INTR
return|;
block|}
if|if
condition|(
name|new_config
operator|->
name|bimodal_interrupts
operator|&&
operator|(
operator|(
name|new_config
operator|->
name|bimodal_timer_lo_us
operator|<
name|XGE_HAL_BIMODAL_TIMER_LO_US_MIN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|bimodal_timer_lo_us
operator|>
name|XGE_HAL_BIMODAL_TIMER_LO_US_MAX
operator|)
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_BIMODAL_TIMER_LO_US
return|;
block|}
if|if
condition|(
name|new_config
operator|->
name|bimodal_interrupts
operator|&&
operator|(
operator|(
name|new_config
operator|->
name|bimodal_timer_hi_us
operator|<
name|XGE_HAL_BIMODAL_TIMER_HI_US_MIN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|bimodal_timer_hi_us
operator|>
name|XGE_HAL_BIMODAL_TIMER_HI_US_MAX
operator|)
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_BIMODAL_TIMER_HI_US
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|no_isr_events
operator|<
name|XGE_HAL_NO_ISR_EVENTS_MIN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|no_isr_events
operator|>
name|XGE_HAL_NO_ISR_EVENTS_MAX
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_NO_ISR_EVENTS
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|isr_polling_cnt
operator|<
name|XGE_HAL_MIN_ISR_POLLING_CNT
operator|)
operator|||
operator|(
name|new_config
operator|->
name|isr_polling_cnt
operator|>
name|XGE_HAL_MAX_ISR_POLLING_CNT
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_ISR_POLLING_CNT
return|;
block|}
if|if
condition|(
name|new_config
operator|->
name|latency_timer
operator|&&
name|new_config
operator|->
name|latency_timer
operator|!=
name|XGE_HAL_USE_BIOS_DEFAULT_LATENCY
condition|)
block|{
if|if
condition|(
operator|(
name|new_config
operator|->
name|latency_timer
operator|<
name|XGE_HAL_MIN_LATENCY_TIMER
operator|)
operator|||
operator|(
name|new_config
operator|->
name|latency_timer
operator|>
name|XGE_HAL_MAX_LATENCY_TIMER
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_LATENCY_TIMER
return|;
block|}
block|}
if|if
condition|(
name|new_config
operator|->
name|max_splits_trans
operator|!=
name|XGE_HAL_USE_BIOS_DEFAULT_SPLITS
condition|)
block|{
if|if
condition|(
operator|(
name|new_config
operator|->
name|max_splits_trans
operator|<
name|XGE_HAL_ONE_SPLIT_TRANSACTION
operator|)
operator|||
operator|(
name|new_config
operator|->
name|max_splits_trans
operator|>
name|XGE_HAL_THIRTYTWO_SPLIT_TRANSACTION
operator|)
condition|)
return|return
name|XGE_HAL_BADCFG_MAX_SPLITS_TRANS
return|;
block|}
if|if
condition|(
name|new_config
operator|->
name|mmrb_count
operator|!=
name|XGE_HAL_DEFAULT_BIOS_MMRB_COUNT
condition|)
block|{
if|if
condition|(
operator|(
name|new_config
operator|->
name|mmrb_count
operator|<
name|XGE_HAL_MIN_MMRB_COUNT
operator|)
operator|||
operator|(
name|new_config
operator|->
name|mmrb_count
operator|>
name|XGE_HAL_MAX_MMRB_COUNT
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_MMRB_COUNT
return|;
block|}
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|shared_splits
operator|<
name|XGE_HAL_MIN_SHARED_SPLITS
operator|)
operator|||
operator|(
name|new_config
operator|->
name|shared_splits
operator|>
name|XGE_HAL_MAX_SHARED_SPLITS
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_SHARED_SPLITS
return|;
block|}
if|if
condition|(
name|new_config
operator|->
name|stats_refresh_time_sec
operator|!=
name|XGE_HAL_STATS_REFRESH_DISABLE
condition|)
block|{
if|if
condition|(
operator|(
name|new_config
operator|->
name|stats_refresh_time_sec
operator|<
name|XGE_HAL_MIN_STATS_REFRESH_TIME
operator|)
operator|||
operator|(
name|new_config
operator|->
name|stats_refresh_time_sec
operator|>
name|XGE_HAL_MAX_STATS_REFRESH_TIME
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_STATS_REFRESH_TIME
return|;
block|}
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|intr_mode
operator|!=
name|XGE_HAL_INTR_MODE_IRQLINE
operator|)
operator|&&
operator|(
name|new_config
operator|->
name|intr_mode
operator|!=
name|XGE_HAL_INTR_MODE_MSI
operator|)
operator|&&
operator|(
name|new_config
operator|->
name|intr_mode
operator|!=
name|XGE_HAL_INTR_MODE_MSIX
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_INTR_MODE
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|sched_timer_us
operator|<
name|XGE_HAL_SCHED_TIMER_MIN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|sched_timer_us
operator|>
name|XGE_HAL_SCHED_TIMER_MAX
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_SCHED_TIMER_US
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|sched_timer_one_shot
operator|!=
name|XGE_HAL_SCHED_TIMER_ON_SHOT_DISABLE
operator|)
operator|&&
operator|(
name|new_config
operator|->
name|sched_timer_one_shot
operator|!=
name|XGE_HAL_SCHED_TIMER_ON_SHOT_ENABLE
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_SCHED_TIMER_ON_SHOT
return|;
block|}
comment|/* 	 * Check adaptive schema parameters. Note that there are two 	 * configuration variables needs to be enabled in ULD: 	 * 	 *   a) sched_timer_us should not be zero; 	 *   b) rxufca_hi_lim should not be equal to rxufca_lo_lim. 	 * 	 * The code bellow checking for those conditions. 	 */
if|if
condition|(
name|new_config
operator|->
name|sched_timer_us
operator|&&
name|new_config
operator|->
name|rxufca_hi_lim
operator|!=
name|new_config
operator|->
name|rxufca_lo_lim
condition|)
block|{
if|if
condition|(
operator|(
name|new_config
operator|->
name|rxufca_intr_thres
operator|<
name|XGE_HAL_RXUFCA_INTR_THRES_MIN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|rxufca_intr_thres
operator|>
name|XGE_HAL_RXUFCA_INTR_THRES_MAX
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RXUFCA_INTR_THRES
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|rxufca_hi_lim
operator|<
name|XGE_HAL_RXUFCA_HI_LIM_MIN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|rxufca_hi_lim
operator|>
name|XGE_HAL_RXUFCA_HI_LIM_MAX
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RXUFCA_HI_LIM
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|rxufca_lo_lim
operator|<
name|XGE_HAL_RXUFCA_LO_LIM_MIN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|rxufca_lo_lim
operator|>
name|XGE_HAL_RXUFCA_LO_LIM_MAX
operator|)
operator|||
operator|(
name|new_config
operator|->
name|rxufca_lo_lim
operator|>
name|new_config
operator|->
name|rxufca_hi_lim
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RXUFCA_LO_LIM
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|rxufca_lbolt_period
operator|<
name|XGE_HAL_RXUFCA_LBOLT_PERIOD_MIN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|rxufca_lbolt_period
operator|>
name|XGE_HAL_RXUFCA_LBOLT_PERIOD_MAX
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RXUFCA_LBOLT_PERIOD
return|;
block|}
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|link_valid_cnt
operator|<
name|XGE_HAL_LINK_VALID_CNT_MIN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|link_valid_cnt
operator|>
name|XGE_HAL_LINK_VALID_CNT_MAX
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_LINK_VALID_CNT
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|link_retry_cnt
operator|<
name|XGE_HAL_LINK_RETRY_CNT_MIN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|link_retry_cnt
operator|>
name|XGE_HAL_LINK_RETRY_CNT_MAX
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_LINK_RETRY_CNT
return|;
block|}
if|if
condition|(
name|new_config
operator|->
name|link_valid_cnt
operator|>
name|new_config
operator|->
name|link_retry_cnt
condition|)
return|return
name|XGE_HAL_BADCFG_LINK_VALID_CNT
return|;
if|if
condition|(
name|new_config
operator|->
name|link_stability_period
operator|!=
name|XGE_HAL_DEFAULT_USE_HARDCODE
condition|)
block|{
if|if
condition|(
operator|(
name|new_config
operator|->
name|link_stability_period
operator|<
name|XGE_HAL_MIN_LINK_STABILITY_PERIOD
operator|)
operator|||
operator|(
name|new_config
operator|->
name|link_stability_period
operator|>
name|XGE_HAL_MAX_LINK_STABILITY_PERIOD
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_LINK_STABILITY_PERIOD
return|;
block|}
block|}
if|if
condition|(
name|new_config
operator|->
name|device_poll_millis
operator|!=
name|XGE_HAL_DEFAULT_USE_HARDCODE
condition|)
block|{
if|if
condition|(
operator|(
name|new_config
operator|->
name|device_poll_millis
operator|<
name|XGE_HAL_MIN_DEVICE_POLL_MILLIS
operator|)
operator|||
operator|(
name|new_config
operator|->
name|device_poll_millis
operator|>
name|XGE_HAL_MAX_DEVICE_POLL_MILLIS
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_DEVICE_POLL_MILLIS
return|;
block|}
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|rts_port_en
operator|<
name|XGE_HAL_MIN_RING_RTS_PORT_EN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|rts_port_en
operator|>
name|XGE_HAL_MAX_RING_RTS_PORT_EN
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RTS_PORT_EN
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|rts_qos_en
operator|<
name|XGE_HAL_RTS_QOS_DISABLE
operator|)
operator|||
operator|(
name|new_config
operator|->
name|rts_qos_en
operator|>
name|XGE_HAL_RTS_QOS_ENABLE
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_RTS_QOS_EN
return|;
block|}
if|#
directive|if
name|defined
argument_list|(
name|XGE_HAL_CONFIG_LRO
argument_list|)
if|if
condition|(
name|new_config
operator|->
name|lro_sg_size
operator|!=
name|XGE_HAL_DEFAULT_USE_HARDCODE
condition|)
block|{
if|if
condition|(
operator|(
name|new_config
operator|->
name|lro_sg_size
operator|<
name|XGE_HAL_LRO_MIN_SG_SIZE
operator|)
operator|||
operator|(
name|new_config
operator|->
name|lro_sg_size
operator|>
name|XGE_HAL_LRO_MAX_SG_SIZE
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_LRO_SG_SIZE
return|;
block|}
block|}
if|if
condition|(
name|new_config
operator|->
name|lro_frm_len
operator|!=
name|XGE_HAL_DEFAULT_USE_HARDCODE
condition|)
block|{
if|if
condition|(
operator|(
name|new_config
operator|->
name|lro_frm_len
operator|<
name|XGE_HAL_LRO_MIN_FRM_LEN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|lro_frm_len
operator|>
name|XGE_HAL_LRO_MAX_FRM_LEN
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_LRO_FRM_LEN
return|;
block|}
block|}
endif|#
directive|endif
if|if
condition|(
operator|(
name|status
operator|=
name|__hal_ring_config_check
argument_list|(
operator|&
name|new_config
operator|->
name|ring
argument_list|)
operator|)
operator|!=
name|XGE_HAL_OK
condition|)
block|{
return|return
name|status
return|;
block|}
if|if
condition|(
operator|(
name|status
operator|=
name|__hal_mac_config_check
argument_list|(
operator|&
name|new_config
operator|->
name|mac
argument_list|)
operator|)
operator|!=
name|XGE_HAL_OK
condition|)
block|{
return|return
name|status
return|;
block|}
if|if
condition|(
operator|(
name|status
operator|=
name|__hal_fifo_config_check
argument_list|(
operator|&
name|new_config
operator|->
name|fifo
argument_list|)
operator|)
operator|!=
name|XGE_HAL_OK
condition|)
block|{
return|return
name|status
return|;
block|}
return|return
name|XGE_HAL_OK
return|;
block|}
end_function

begin_comment
comment|/*  * __hal_device_config_check_xena - Check Xframe-I configuration  * @new_config: Device configuration.  *  * Check part of configuration that is relevant only to Xframe-I.  *  * Returns: XGE_HAL_OK - success,  * otherwise one of the xge_hal_status_e{} enumerated error codes.  *  * See also: __hal_device_config_check_common().  */
end_comment

begin_function
name|xge_hal_status_e
name|__hal_device_config_check_xena
parameter_list|(
name|xge_hal_device_config_t
modifier|*
name|new_config
parameter_list|)
block|{
if|if
condition|(
operator|(
name|new_config
operator|->
name|pci_freq_mherz
operator|!=
name|XGE_HAL_PCI_FREQ_MHERZ_33
operator|)
operator|&&
operator|(
name|new_config
operator|->
name|pci_freq_mherz
operator|!=
name|XGE_HAL_PCI_FREQ_MHERZ_66
operator|)
operator|&&
operator|(
name|new_config
operator|->
name|pci_freq_mherz
operator|!=
name|XGE_HAL_PCI_FREQ_MHERZ_100
operator|)
operator|&&
operator|(
name|new_config
operator|->
name|pci_freq_mherz
operator|!=
name|XGE_HAL_PCI_FREQ_MHERZ_133
operator|)
operator|&&
operator|(
name|new_config
operator|->
name|pci_freq_mherz
operator|!=
name|XGE_HAL_PCI_FREQ_MHERZ_266
operator|)
operator|&&
operator|(
name|new_config
operator|->
name|pci_freq_mherz
operator|!=
name|XGE_HAL_DEFAULT_USE_HARDCODE
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_PCI_FREQ_MHERZ
return|;
block|}
return|return
name|XGE_HAL_OK
return|;
block|}
end_function

begin_comment
comment|/*  * __hal_device_config_check_herc - Check device configuration  * @new_config: Device configuration.  *  * Check part of configuration that is relevant only to Xframe-II.  *  * Returns: XGE_HAL_OK - success,  * otherwise one of the xge_hal_status_e{} enumerated error codes.  *  * See also: __hal_device_config_check_common().  */
end_comment

begin_function
name|xge_hal_status_e
name|__hal_device_config_check_herc
parameter_list|(
name|xge_hal_device_config_t
modifier|*
name|new_config
parameter_list|)
block|{
return|return
name|XGE_HAL_OK
return|;
block|}
end_function

begin_comment
comment|/*  * __hal_driver_config_check - Check HAL configuration  * @new_config: Driver configuration information  *  * Returns: XGE_HAL_OK - success,  * otherwise one of the xge_hal_status_e{} enumerated error codes.  */
end_comment

begin_function
name|xge_hal_status_e
name|__hal_driver_config_check
parameter_list|(
name|xge_hal_driver_config_t
modifier|*
name|new_config
parameter_list|)
block|{
if|if
condition|(
operator|(
name|new_config
operator|->
name|queue_size_initial
operator|<
name|XGE_HAL_MIN_QUEUE_SIZE_INITIAL
operator|)
operator|||
operator|(
name|new_config
operator|->
name|queue_size_initial
operator|>
name|XGE_HAL_MAX_QUEUE_SIZE_INITIAL
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_QUEUE_SIZE_INITIAL
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|queue_size_max
operator|<
name|XGE_HAL_MIN_QUEUE_SIZE_MAX
operator|)
operator|||
operator|(
name|new_config
operator|->
name|queue_size_max
operator|>
name|XGE_HAL_MAX_QUEUE_SIZE_MAX
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_QUEUE_SIZE_MAX
return|;
block|}
ifdef|#
directive|ifdef
name|XGE_TRACE_INTO_CIRCULAR_ARR
if|if
condition|(
operator|(
name|new_config
operator|->
name|tracebuf_size
operator|<
name|XGE_HAL_MIN_CIRCULAR_ARR
operator|)
operator|||
operator|(
name|new_config
operator|->
name|tracebuf_size
operator|>
name|XGE_HAL_MAX_CIRCULAR_ARR
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_TRACEBUF_SIZE
return|;
block|}
if|if
condition|(
operator|(
name|new_config
operator|->
name|tracebuf_timestamp_en
operator|<
name|XGE_HAL_MIN_TIMESTAMP_EN
operator|)
operator|||
operator|(
name|new_config
operator|->
name|tracebuf_timestamp_en
operator|>
name|XGE_HAL_MAX_TIMESTAMP_EN
operator|)
condition|)
block|{
return|return
name|XGE_HAL_BADCFG_TRACEBUF_SIZE
return|;
block|}
endif|#
directive|endif
return|return
name|XGE_HAL_OK
return|;
block|}
end_function

end_unit

