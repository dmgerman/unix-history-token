begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2006 Stephane E. Potvin<sepotvin@videotron.ca>  * Copyright (c) 2006 Ariff Abdullah<ariff@FreeBSD.org>  * Copyright (c) 2008-2012 Alexander Motin<mav@FreeBSD.org>  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  */
end_comment

begin_comment
comment|/*  * Intel High Definition Audio (CODEC) driver for FreeBSD.  */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|HAVE_KERNEL_OPTION_HEADERS
end_ifdef

begin_include
include|#
directive|include
file|"opt_snd.h"
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<dev/sound/pcm/sound.h>
end_include

begin_include
include|#
directive|include
file|<sys/ctype.h>
end_include

begin_include
include|#
directive|include
file|<dev/sound/pci/hda/hda_reg.h>
end_include

begin_include
include|#
directive|include
file|<dev/sound/pci/hda/hdac.h>
end_include

begin_expr_stmt
name|SND_DECLARE_FILE
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_struct
struct|struct
name|hdacc_fg
block|{
name|device_t
name|dev
decl_stmt|;
name|nid_t
name|nid
decl_stmt|;
name|uint8_t
name|type
decl_stmt|;
name|uint32_t
name|subsystem_id
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|hdacc_softc
block|{
name|device_t
name|dev
decl_stmt|;
name|struct
name|mtx
modifier|*
name|lock
decl_stmt|;
name|nid_t
name|cad
decl_stmt|;
name|device_t
name|streams
index|[
literal|2
index|]
index|[
literal|16
index|]
decl_stmt|;
name|device_t
name|tags
index|[
literal|64
index|]
decl_stmt|;
name|int
name|fgcnt
decl_stmt|;
name|struct
name|hdacc_fg
modifier|*
name|fgs
decl_stmt|;
block|}
struct|;
end_struct

begin_define
define|#
directive|define
name|hdacc_lock
parameter_list|(
name|codec
parameter_list|)
value|snd_mtxlock((codec)->lock)
end_define

begin_define
define|#
directive|define
name|hdacc_unlock
parameter_list|(
name|codec
parameter_list|)
value|snd_mtxunlock((codec)->lock)
end_define

begin_define
define|#
directive|define
name|hdacc_lockassert
parameter_list|(
name|codec
parameter_list|)
value|snd_mtxassert((codec)->lock)
end_define

begin_define
define|#
directive|define
name|hdacc_lockowned
parameter_list|(
name|codec
parameter_list|)
value|mtx_owned((codec)->lock)
end_define

begin_expr_stmt
name|MALLOC_DEFINE
argument_list|(
name|M_HDACC
argument_list|,
literal|"hdacc"
argument_list|,
literal|"HDA CODEC"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* CODECs */
end_comment

begin_struct
specifier|static
specifier|const
struct|struct
block|{
name|uint32_t
name|id
decl_stmt|;
name|uint16_t
name|revid
decl_stmt|;
specifier|const
name|char
modifier|*
name|name
decl_stmt|;
block|}
name|hdacc_codecs
index|[]
init|=
block|{
block|{
name|HDA_CODEC_CS4206
block|,
literal|0
block|,
literal|"Cirrus Logic CS4206"
block|}
block|,
block|{
name|HDA_CODEC_CS4207
block|,
literal|0
block|,
literal|"Cirrus Logic CS4207"
block|}
block|,
block|{
name|HDA_CODEC_CS4210
block|,
literal|0
block|,
literal|"Cirrus Logic CS4210"
block|}
block|,
block|{
name|HDA_CODEC_ALC221
block|,
literal|0
block|,
literal|"Realtek ALC221"
block|}
block|,
block|{
name|HDA_CODEC_ALC260
block|,
literal|0
block|,
literal|"Realtek ALC260"
block|}
block|,
block|{
name|HDA_CODEC_ALC262
block|,
literal|0
block|,
literal|"Realtek ALC262"
block|}
block|,
block|{
name|HDA_CODEC_ALC267
block|,
literal|0
block|,
literal|"Realtek ALC267"
block|}
block|,
block|{
name|HDA_CODEC_ALC268
block|,
literal|0
block|,
literal|"Realtek ALC268"
block|}
block|,
block|{
name|HDA_CODEC_ALC269
block|,
literal|0
block|,
literal|"Realtek ALC269"
block|}
block|,
block|{
name|HDA_CODEC_ALC270
block|,
literal|0
block|,
literal|"Realtek ALC270"
block|}
block|,
block|{
name|HDA_CODEC_ALC272
block|,
literal|0
block|,
literal|"Realtek ALC272"
block|}
block|,
block|{
name|HDA_CODEC_ALC273
block|,
literal|0
block|,
literal|"Realtek ALC273"
block|}
block|,
block|{
name|HDA_CODEC_ALC275
block|,
literal|0
block|,
literal|"Realtek ALC275"
block|}
block|,
block|{
name|HDA_CODEC_ALC276
block|,
literal|0
block|,
literal|"Realtek ALC276"
block|}
block|,
block|{
name|HDA_CODEC_ALC292
block|,
literal|0
block|,
literal|"Realtek ALC292"
block|}
block|,
block|{
name|HDA_CODEC_ALC660
block|,
literal|0
block|,
literal|"Realtek ALC660-VD"
block|}
block|,
block|{
name|HDA_CODEC_ALC662
block|,
literal|0x0002
block|,
literal|"Realtek ALC662 rev2"
block|}
block|,
block|{
name|HDA_CODEC_ALC662
block|,
literal|0
block|,
literal|"Realtek ALC662"
block|}
block|,
block|{
name|HDA_CODEC_ALC663
block|,
literal|0
block|,
literal|"Realtek ALC663"
block|}
block|,
block|{
name|HDA_CODEC_ALC665
block|,
literal|0
block|,
literal|"Realtek ALC665"
block|}
block|,
block|{
name|HDA_CODEC_ALC670
block|,
literal|0
block|,
literal|"Realtek ALC670"
block|}
block|,
block|{
name|HDA_CODEC_ALC680
block|,
literal|0
block|,
literal|"Realtek ALC680"
block|}
block|,
block|{
name|HDA_CODEC_ALC861
block|,
literal|0x0340
block|,
literal|"Realtek ALC660"
block|}
block|,
block|{
name|HDA_CODEC_ALC861
block|,
literal|0
block|,
literal|"Realtek ALC861"
block|}
block|,
block|{
name|HDA_CODEC_ALC861VD
block|,
literal|0
block|,
literal|"Realtek ALC861-VD"
block|}
block|,
block|{
name|HDA_CODEC_ALC880
block|,
literal|0
block|,
literal|"Realtek ALC880"
block|}
block|,
block|{
name|HDA_CODEC_ALC882
block|,
literal|0
block|,
literal|"Realtek ALC882"
block|}
block|,
block|{
name|HDA_CODEC_ALC883
block|,
literal|0
block|,
literal|"Realtek ALC883"
block|}
block|,
block|{
name|HDA_CODEC_ALC885
block|,
literal|0x0101
block|,
literal|"Realtek ALC889A"
block|}
block|,
block|{
name|HDA_CODEC_ALC885
block|,
literal|0x0103
block|,
literal|"Realtek ALC889A"
block|}
block|,
block|{
name|HDA_CODEC_ALC885
block|,
literal|0
block|,
literal|"Realtek ALC885"
block|}
block|,
block|{
name|HDA_CODEC_ALC887
block|,
literal|0
block|,
literal|"Realtek ALC887"
block|}
block|,
block|{
name|HDA_CODEC_ALC888
block|,
literal|0x0101
block|,
literal|"Realtek ALC1200"
block|}
block|,
block|{
name|HDA_CODEC_ALC888
block|,
literal|0
block|,
literal|"Realtek ALC888"
block|}
block|,
block|{
name|HDA_CODEC_ALC889
block|,
literal|0
block|,
literal|"Realtek ALC889"
block|}
block|,
block|{
name|HDA_CODEC_ALC892
block|,
literal|0
block|,
literal|"Realtek ALC892"
block|}
block|,
block|{
name|HDA_CODEC_ALC899
block|,
literal|0
block|,
literal|"Realtek ALC899"
block|}
block|,
block|{
name|HDA_CODEC_AD1882
block|,
literal|0
block|,
literal|"Analog Devices AD1882"
block|}
block|,
block|{
name|HDA_CODEC_AD1882A
block|,
literal|0
block|,
literal|"Analog Devices AD1882A"
block|}
block|,
block|{
name|HDA_CODEC_AD1883
block|,
literal|0
block|,
literal|"Analog Devices AD1883"
block|}
block|,
block|{
name|HDA_CODEC_AD1884
block|,
literal|0
block|,
literal|"Analog Devices AD1884"
block|}
block|,
block|{
name|HDA_CODEC_AD1884A
block|,
literal|0
block|,
literal|"Analog Devices AD1884A"
block|}
block|,
block|{
name|HDA_CODEC_AD1981HD
block|,
literal|0
block|,
literal|"Analog Devices AD1981HD"
block|}
block|,
block|{
name|HDA_CODEC_AD1983
block|,
literal|0
block|,
literal|"Analog Devices AD1983"
block|}
block|,
block|{
name|HDA_CODEC_AD1984
block|,
literal|0
block|,
literal|"Analog Devices AD1984"
block|}
block|,
block|{
name|HDA_CODEC_AD1984A
block|,
literal|0
block|,
literal|"Analog Devices AD1984A"
block|}
block|,
block|{
name|HDA_CODEC_AD1984B
block|,
literal|0
block|,
literal|"Analog Devices AD1984B"
block|}
block|,
block|{
name|HDA_CODEC_AD1986A
block|,
literal|0
block|,
literal|"Analog Devices AD1986A"
block|}
block|,
block|{
name|HDA_CODEC_AD1987
block|,
literal|0
block|,
literal|"Analog Devices AD1987"
block|}
block|,
block|{
name|HDA_CODEC_AD1988
block|,
literal|0
block|,
literal|"Analog Devices AD1988A"
block|}
block|,
block|{
name|HDA_CODEC_AD1988B
block|,
literal|0
block|,
literal|"Analog Devices AD1988B"
block|}
block|,
block|{
name|HDA_CODEC_AD1989A
block|,
literal|0
block|,
literal|"Analog Devices AD1989A"
block|}
block|,
block|{
name|HDA_CODEC_AD1989B
block|,
literal|0
block|,
literal|"Analog Devices AD1989B"
block|}
block|,
block|{
name|HDA_CODEC_CA0110
block|,
literal|0
block|,
literal|"Creative CA0110-IBG"
block|}
block|,
block|{
name|HDA_CODEC_CA0110_2
block|,
literal|0
block|,
literal|"Creative CA0110-IBG"
block|}
block|,
block|{
name|HDA_CODEC_CA0132
block|,
literal|0
block|,
literal|"Creative CA0132"
block|}
block|,
block|{
name|HDA_CODEC_SB0880
block|,
literal|0
block|,
literal|"Creative SB0880 X-Fi"
block|}
block|,
block|{
name|HDA_CODEC_CMI9880
block|,
literal|0
block|,
literal|"CMedia CMI9880"
block|}
block|,
block|{
name|HDA_CODEC_CMI98802
block|,
literal|0
block|,
literal|"CMedia CMI9880"
block|}
block|,
block|{
name|HDA_CODEC_CXD9872RDK
block|,
literal|0
block|,
literal|"Sigmatel CXD9872RD/K"
block|}
block|,
block|{
name|HDA_CODEC_CXD9872AKD
block|,
literal|0
block|,
literal|"Sigmatel CXD9872AKD"
block|}
block|,
block|{
name|HDA_CODEC_STAC9200D
block|,
literal|0
block|,
literal|"Sigmatel STAC9200D"
block|}
block|,
block|{
name|HDA_CODEC_STAC9204X
block|,
literal|0
block|,
literal|"Sigmatel STAC9204X"
block|}
block|,
block|{
name|HDA_CODEC_STAC9204D
block|,
literal|0
block|,
literal|"Sigmatel STAC9204D"
block|}
block|,
block|{
name|HDA_CODEC_STAC9205X
block|,
literal|0
block|,
literal|"Sigmatel STAC9205X"
block|}
block|,
block|{
name|HDA_CODEC_STAC9205D
block|,
literal|0
block|,
literal|"Sigmatel STAC9205D"
block|}
block|,
block|{
name|HDA_CODEC_STAC9220
block|,
literal|0
block|,
literal|"Sigmatel STAC9220"
block|}
block|,
block|{
name|HDA_CODEC_STAC9220_A1
block|,
literal|0
block|,
literal|"Sigmatel STAC9220_A1"
block|}
block|,
block|{
name|HDA_CODEC_STAC9220_A2
block|,
literal|0
block|,
literal|"Sigmatel STAC9220_A2"
block|}
block|,
block|{
name|HDA_CODEC_STAC9221
block|,
literal|0
block|,
literal|"Sigmatel STAC9221"
block|}
block|,
block|{
name|HDA_CODEC_STAC9221_A2
block|,
literal|0
block|,
literal|"Sigmatel STAC9221_A2"
block|}
block|,
block|{
name|HDA_CODEC_STAC9221D
block|,
literal|0
block|,
literal|"Sigmatel STAC9221D"
block|}
block|,
block|{
name|HDA_CODEC_STAC922XD
block|,
literal|0
block|,
literal|"Sigmatel STAC9220D/9223D"
block|}
block|,
block|{
name|HDA_CODEC_STAC9227X
block|,
literal|0
block|,
literal|"Sigmatel STAC9227X"
block|}
block|,
block|{
name|HDA_CODEC_STAC9227D
block|,
literal|0
block|,
literal|"Sigmatel STAC9227D"
block|}
block|,
block|{
name|HDA_CODEC_STAC9228X
block|,
literal|0
block|,
literal|"Sigmatel STAC9228X"
block|}
block|,
block|{
name|HDA_CODEC_STAC9228D
block|,
literal|0
block|,
literal|"Sigmatel STAC9228D"
block|}
block|,
block|{
name|HDA_CODEC_STAC9229X
block|,
literal|0
block|,
literal|"Sigmatel STAC9229X"
block|}
block|,
block|{
name|HDA_CODEC_STAC9229D
block|,
literal|0
block|,
literal|"Sigmatel STAC9229D"
block|}
block|,
block|{
name|HDA_CODEC_STAC9230X
block|,
literal|0
block|,
literal|"Sigmatel STAC9230X"
block|}
block|,
block|{
name|HDA_CODEC_STAC9230D
block|,
literal|0
block|,
literal|"Sigmatel STAC9230D"
block|}
block|,
block|{
name|HDA_CODEC_STAC9250
block|,
literal|0
block|,
literal|"Sigmatel STAC9250"
block|}
block|,
block|{
name|HDA_CODEC_STAC9251
block|,
literal|0
block|,
literal|"Sigmatel STAC9251"
block|}
block|,
block|{
name|HDA_CODEC_STAC9255
block|,
literal|0
block|,
literal|"Sigmatel STAC9255"
block|}
block|,
block|{
name|HDA_CODEC_STAC9255D
block|,
literal|0
block|,
literal|"Sigmatel STAC9255D"
block|}
block|,
block|{
name|HDA_CODEC_STAC9254
block|,
literal|0
block|,
literal|"Sigmatel STAC9254"
block|}
block|,
block|{
name|HDA_CODEC_STAC9254D
block|,
literal|0
block|,
literal|"Sigmatel STAC9254D"
block|}
block|,
block|{
name|HDA_CODEC_STAC9271X
block|,
literal|0
block|,
literal|"Sigmatel STAC9271X"
block|}
block|,
block|{
name|HDA_CODEC_STAC9271D
block|,
literal|0
block|,
literal|"Sigmatel STAC9271D"
block|}
block|,
block|{
name|HDA_CODEC_STAC9272X
block|,
literal|0
block|,
literal|"Sigmatel STAC9272X"
block|}
block|,
block|{
name|HDA_CODEC_STAC9272D
block|,
literal|0
block|,
literal|"Sigmatel STAC9272D"
block|}
block|,
block|{
name|HDA_CODEC_STAC9273X
block|,
literal|0
block|,
literal|"Sigmatel STAC9273X"
block|}
block|,
block|{
name|HDA_CODEC_STAC9273D
block|,
literal|0
block|,
literal|"Sigmatel STAC9273D"
block|}
block|,
block|{
name|HDA_CODEC_STAC9274
block|,
literal|0
block|,
literal|"Sigmatel STAC9274"
block|}
block|,
block|{
name|HDA_CODEC_STAC9274D
block|,
literal|0
block|,
literal|"Sigmatel STAC9274D"
block|}
block|,
block|{
name|HDA_CODEC_STAC9274X5NH
block|,
literal|0
block|,
literal|"Sigmatel STAC9274X5NH"
block|}
block|,
block|{
name|HDA_CODEC_STAC9274D5NH
block|,
literal|0
block|,
literal|"Sigmatel STAC9274D5NH"
block|}
block|,
block|{
name|HDA_CODEC_STAC9872AK
block|,
literal|0
block|,
literal|"Sigmatel STAC9872AK"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD005
block|,
literal|0
block|,
literal|"IDT 92HD005"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD005D
block|,
literal|0
block|,
literal|"IDT 92HD005D"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD206X
block|,
literal|0
block|,
literal|"IDT 92HD206X"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD206D
block|,
literal|0
block|,
literal|"IDT 92HD206D"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD66B1X5
block|,
literal|0
block|,
literal|"IDT 92HD66B1X5"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD66B2X5
block|,
literal|0
block|,
literal|"IDT 92HD66B2X5"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD66B3X5
block|,
literal|0
block|,
literal|"IDT 92HD66B3X5"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD66C1X5
block|,
literal|0
block|,
literal|"IDT 92HD66C1X5"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD66C2X5
block|,
literal|0
block|,
literal|"IDT 92HD66C2X5"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD66C3X5
block|,
literal|0
block|,
literal|"IDT 92HD66C3X5"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD66B1X3
block|,
literal|0
block|,
literal|"IDT 92HD66B1X3"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD66B2X3
block|,
literal|0
block|,
literal|"IDT 92HD66B2X3"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD66B3X3
block|,
literal|0
block|,
literal|"IDT 92HD66B3X3"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD66C1X3
block|,
literal|0
block|,
literal|"IDT 92HD66C1X3"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD66C2X3
block|,
literal|0
block|,
literal|"IDT 92HD66C2X3"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD66C3_65
block|,
literal|0
block|,
literal|"IDT 92HD66C3_65"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD700X
block|,
literal|0
block|,
literal|"IDT 92HD700X"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD700D
block|,
literal|0
block|,
literal|"IDT 92HD700D"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD71B5
block|,
literal|0
block|,
literal|"IDT 92HD71B5"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD71B5_2
block|,
literal|0
block|,
literal|"IDT 92HD71B5"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD71B6
block|,
literal|0
block|,
literal|"IDT 92HD71B6"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD71B6_2
block|,
literal|0
block|,
literal|"IDT 92HD71B6"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD71B7
block|,
literal|0
block|,
literal|"IDT 92HD71B7"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD71B7_2
block|,
literal|0
block|,
literal|"IDT 92HD71B7"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD71B8
block|,
literal|0
block|,
literal|"IDT 92HD71B8"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD71B8_2
block|,
literal|0
block|,
literal|"IDT 92HD71B8"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD73C1
block|,
literal|0
block|,
literal|"IDT 92HD73C1"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD73D1
block|,
literal|0
block|,
literal|"IDT 92HD73D1"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD73E1
block|,
literal|0
block|,
literal|"IDT 92HD73E1"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD75B3
block|,
literal|0
block|,
literal|"IDT 92HD75B3"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD75BX
block|,
literal|0
block|,
literal|"IDT 92HD75BX"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD81B1C
block|,
literal|0
block|,
literal|"IDT 92HD81B1C"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD81B1X
block|,
literal|0
block|,
literal|"IDT 92HD81B1X"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD83C1C
block|,
literal|0
block|,
literal|"IDT 92HD83C1C"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD83C1X
block|,
literal|0
block|,
literal|"IDT 92HD83C1X"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD87B1_3
block|,
literal|0
block|,
literal|"IDT 92HD87B1/3"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD87B2_4
block|,
literal|0
block|,
literal|"IDT 92HD87B2/4"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD89C3
block|,
literal|0
block|,
literal|"IDT 92HD89C3"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD89C2
block|,
literal|0
block|,
literal|"IDT 92HD89C2"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD89C1
block|,
literal|0
block|,
literal|"IDT 92HD89C1"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD89B3
block|,
literal|0
block|,
literal|"IDT 92HD89B3"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD89B2
block|,
literal|0
block|,
literal|"IDT 92HD89B2"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD89B1
block|,
literal|0
block|,
literal|"IDT 92HD89B1"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD89E3
block|,
literal|0
block|,
literal|"IDT 92HD89E3"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD89E2
block|,
literal|0
block|,
literal|"IDT 92HD89E2"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD89E1
block|,
literal|0
block|,
literal|"IDT 92HD89E1"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD89D3
block|,
literal|0
block|,
literal|"IDT 92HD89D3"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD89D2
block|,
literal|0
block|,
literal|"IDT 92HD89D2"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD89D1
block|,
literal|0
block|,
literal|"IDT 92HD89D1"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD89F3
block|,
literal|0
block|,
literal|"IDT 92HD89F3"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD89F2
block|,
literal|0
block|,
literal|"IDT 92HD89F2"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD89F1
block|,
literal|0
block|,
literal|"IDT 92HD89F1"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD90BXX
block|,
literal|0
block|,
literal|"IDT 92HD90BXX"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD91BXX
block|,
literal|0
block|,
literal|"IDT 92HD91BXX"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD93BXX
block|,
literal|0
block|,
literal|"IDT 92HD93BXX"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD98BXX
block|,
literal|0
block|,
literal|"IDT 92HD98BXX"
block|}
block|,
block|{
name|HDA_CODEC_IDT92HD99BXX
block|,
literal|0
block|,
literal|"IDT 92HD99BXX"
block|}
block|,
block|{
name|HDA_CODEC_CX20549
block|,
literal|0
block|,
literal|"Conexant CX20549 (Venice)"
block|}
block|,
block|{
name|HDA_CODEC_CX20551
block|,
literal|0
block|,
literal|"Conexant CX20551 (Waikiki)"
block|}
block|,
block|{
name|HDA_CODEC_CX20561
block|,
literal|0
block|,
literal|"Conexant CX20561 (Hermosa)"
block|}
block|,
block|{
name|HDA_CODEC_CX20582
block|,
literal|0
block|,
literal|"Conexant CX20582 (Pebble)"
block|}
block|,
block|{
name|HDA_CODEC_CX20583
block|,
literal|0
block|,
literal|"Conexant CX20583 (Pebble HSF)"
block|}
block|,
block|{
name|HDA_CODEC_CX20584
block|,
literal|0
block|,
literal|"Conexant CX20584"
block|}
block|,
block|{
name|HDA_CODEC_CX20585
block|,
literal|0
block|,
literal|"Conexant CX20585"
block|}
block|,
block|{
name|HDA_CODEC_CX20588
block|,
literal|0
block|,
literal|"Conexant CX20588"
block|}
block|,
block|{
name|HDA_CODEC_CX20590
block|,
literal|0
block|,
literal|"Conexant CX20590"
block|}
block|,
block|{
name|HDA_CODEC_CX20631
block|,
literal|0
block|,
literal|"Conexant CX20631"
block|}
block|,
block|{
name|HDA_CODEC_CX20632
block|,
literal|0
block|,
literal|"Conexant CX20632"
block|}
block|,
block|{
name|HDA_CODEC_CX20641
block|,
literal|0
block|,
literal|"Conexant CX20641"
block|}
block|,
block|{
name|HDA_CODEC_CX20642
block|,
literal|0
block|,
literal|"Conexant CX20642"
block|}
block|,
block|{
name|HDA_CODEC_CX20651
block|,
literal|0
block|,
literal|"Conexant CX20651"
block|}
block|,
block|{
name|HDA_CODEC_CX20652
block|,
literal|0
block|,
literal|"Conexant CX20652"
block|}
block|,
block|{
name|HDA_CODEC_CX20664
block|,
literal|0
block|,
literal|"Conexant CX20664"
block|}
block|,
block|{
name|HDA_CODEC_CX20665
block|,
literal|0
block|,
literal|"Conexant CX20665"
block|}
block|,
block|{
name|HDA_CODEC_VT1708_8
block|,
literal|0
block|,
literal|"VIA VT1708_8"
block|}
block|,
block|{
name|HDA_CODEC_VT1708_9
block|,
literal|0
block|,
literal|"VIA VT1708_9"
block|}
block|,
block|{
name|HDA_CODEC_VT1708_A
block|,
literal|0
block|,
literal|"VIA VT1708_A"
block|}
block|,
block|{
name|HDA_CODEC_VT1708_B
block|,
literal|0
block|,
literal|"VIA VT1708_B"
block|}
block|,
block|{
name|HDA_CODEC_VT1709_0
block|,
literal|0
block|,
literal|"VIA VT1709_0"
block|}
block|,
block|{
name|HDA_CODEC_VT1709_1
block|,
literal|0
block|,
literal|"VIA VT1709_1"
block|}
block|,
block|{
name|HDA_CODEC_VT1709_2
block|,
literal|0
block|,
literal|"VIA VT1709_2"
block|}
block|,
block|{
name|HDA_CODEC_VT1709_3
block|,
literal|0
block|,
literal|"VIA VT1709_3"
block|}
block|,
block|{
name|HDA_CODEC_VT1709_4
block|,
literal|0
block|,
literal|"VIA VT1709_4"
block|}
block|,
block|{
name|HDA_CODEC_VT1709_5
block|,
literal|0
block|,
literal|"VIA VT1709_5"
block|}
block|,
block|{
name|HDA_CODEC_VT1709_6
block|,
literal|0
block|,
literal|"VIA VT1709_6"
block|}
block|,
block|{
name|HDA_CODEC_VT1709_7
block|,
literal|0
block|,
literal|"VIA VT1709_7"
block|}
block|,
block|{
name|HDA_CODEC_VT1708B_0
block|,
literal|0
block|,
literal|"VIA VT1708B_0"
block|}
block|,
block|{
name|HDA_CODEC_VT1708B_1
block|,
literal|0
block|,
literal|"VIA VT1708B_1"
block|}
block|,
block|{
name|HDA_CODEC_VT1708B_2
block|,
literal|0
block|,
literal|"VIA VT1708B_2"
block|}
block|,
block|{
name|HDA_CODEC_VT1708B_3
block|,
literal|0
block|,
literal|"VIA VT1708B_3"
block|}
block|,
block|{
name|HDA_CODEC_VT1708B_4
block|,
literal|0
block|,
literal|"VIA VT1708B_4"
block|}
block|,
block|{
name|HDA_CODEC_VT1708B_5
block|,
literal|0
block|,
literal|"VIA VT1708B_5"
block|}
block|,
block|{
name|HDA_CODEC_VT1708B_6
block|,
literal|0
block|,
literal|"VIA VT1708B_6"
block|}
block|,
block|{
name|HDA_CODEC_VT1708B_7
block|,
literal|0
block|,
literal|"VIA VT1708B_7"
block|}
block|,
block|{
name|HDA_CODEC_VT1708S_0
block|,
literal|0
block|,
literal|"VIA VT1708S_0"
block|}
block|,
block|{
name|HDA_CODEC_VT1708S_1
block|,
literal|0
block|,
literal|"VIA VT1708S_1"
block|}
block|,
block|{
name|HDA_CODEC_VT1708S_2
block|,
literal|0
block|,
literal|"VIA VT1708S_2"
block|}
block|,
block|{
name|HDA_CODEC_VT1708S_3
block|,
literal|0
block|,
literal|"VIA VT1708S_3"
block|}
block|,
block|{
name|HDA_CODEC_VT1708S_4
block|,
literal|0
block|,
literal|"VIA VT1708S_4"
block|}
block|,
block|{
name|HDA_CODEC_VT1708S_5
block|,
literal|0
block|,
literal|"VIA VT1708S_5"
block|}
block|,
block|{
name|HDA_CODEC_VT1708S_6
block|,
literal|0
block|,
literal|"VIA VT1708S_6"
block|}
block|,
block|{
name|HDA_CODEC_VT1708S_7
block|,
literal|0
block|,
literal|"VIA VT1708S_7"
block|}
block|,
block|{
name|HDA_CODEC_VT1702_0
block|,
literal|0
block|,
literal|"VIA VT1702_0"
block|}
block|,
block|{
name|HDA_CODEC_VT1702_1
block|,
literal|0
block|,
literal|"VIA VT1702_1"
block|}
block|,
block|{
name|HDA_CODEC_VT1702_2
block|,
literal|0
block|,
literal|"VIA VT1702_2"
block|}
block|,
block|{
name|HDA_CODEC_VT1702_3
block|,
literal|0
block|,
literal|"VIA VT1702_3"
block|}
block|,
block|{
name|HDA_CODEC_VT1702_4
block|,
literal|0
block|,
literal|"VIA VT1702_4"
block|}
block|,
block|{
name|HDA_CODEC_VT1702_5
block|,
literal|0
block|,
literal|"VIA VT1702_5"
block|}
block|,
block|{
name|HDA_CODEC_VT1702_6
block|,
literal|0
block|,
literal|"VIA VT1702_6"
block|}
block|,
block|{
name|HDA_CODEC_VT1702_7
block|,
literal|0
block|,
literal|"VIA VT1702_7"
block|}
block|,
block|{
name|HDA_CODEC_VT1716S_0
block|,
literal|0
block|,
literal|"VIA VT1716S_0"
block|}
block|,
block|{
name|HDA_CODEC_VT1716S_1
block|,
literal|0
block|,
literal|"VIA VT1716S_1"
block|}
block|,
block|{
name|HDA_CODEC_VT1718S_0
block|,
literal|0
block|,
literal|"VIA VT1718S_0"
block|}
block|,
block|{
name|HDA_CODEC_VT1718S_1
block|,
literal|0
block|,
literal|"VIA VT1718S_1"
block|}
block|,
block|{
name|HDA_CODEC_VT1802_0
block|,
literal|0
block|,
literal|"VIA VT1802_0"
block|}
block|,
block|{
name|HDA_CODEC_VT1802_1
block|,
literal|0
block|,
literal|"VIA VT1802_1"
block|}
block|,
block|{
name|HDA_CODEC_VT1812
block|,
literal|0
block|,
literal|"VIA VT1812"
block|}
block|,
block|{
name|HDA_CODEC_VT1818S
block|,
literal|0
block|,
literal|"VIA VT1818S"
block|}
block|,
block|{
name|HDA_CODEC_VT1828S
block|,
literal|0
block|,
literal|"VIA VT1828S"
block|}
block|,
block|{
name|HDA_CODEC_VT2002P_0
block|,
literal|0
block|,
literal|"VIA VT2002P_0"
block|}
block|,
block|{
name|HDA_CODEC_VT2002P_1
block|,
literal|0
block|,
literal|"VIA VT2002P_1"
block|}
block|,
block|{
name|HDA_CODEC_VT2020
block|,
literal|0
block|,
literal|"VIA VT2020"
block|}
block|,
block|{
name|HDA_CODEC_ATIRS600_1
block|,
literal|0
block|,
literal|"ATI RS600"
block|}
block|,
block|{
name|HDA_CODEC_ATIRS600_2
block|,
literal|0
block|,
literal|"ATI RS600"
block|}
block|,
block|{
name|HDA_CODEC_ATIRS690
block|,
literal|0
block|,
literal|"ATI RS690/780"
block|}
block|,
block|{
name|HDA_CODEC_ATIR6XX
block|,
literal|0
block|,
literal|"ATI R6xx"
block|}
block|,
block|{
name|HDA_CODEC_NVIDIAMCP67
block|,
literal|0
block|,
literal|"NVIDIA MCP67"
block|}
block|,
block|{
name|HDA_CODEC_NVIDIAMCP73
block|,
literal|0
block|,
literal|"NVIDIA MCP73"
block|}
block|,
block|{
name|HDA_CODEC_NVIDIAMCP78
block|,
literal|0
block|,
literal|"NVIDIA MCP78"
block|}
block|,
block|{
name|HDA_CODEC_NVIDIAMCP78_2
block|,
literal|0
block|,
literal|"NVIDIA MCP78"
block|}
block|,
block|{
name|HDA_CODEC_NVIDIAMCP78_3
block|,
literal|0
block|,
literal|"NVIDIA MCP78"
block|}
block|,
block|{
name|HDA_CODEC_NVIDIAMCP78_4
block|,
literal|0
block|,
literal|"NVIDIA MCP78"
block|}
block|,
block|{
name|HDA_CODEC_NVIDIAMCP7A
block|,
literal|0
block|,
literal|"NVIDIA MCP7A"
block|}
block|,
block|{
name|HDA_CODEC_NVIDIAGT220
block|,
literal|0
block|,
literal|"NVIDIA GT220"
block|}
block|,
block|{
name|HDA_CODEC_NVIDIAGT21X
block|,
literal|0
block|,
literal|"NVIDIA GT21x"
block|}
block|,
block|{
name|HDA_CODEC_NVIDIAMCP89
block|,
literal|0
block|,
literal|"NVIDIA MCP89"
block|}
block|,
block|{
name|HDA_CODEC_NVIDIAGT240
block|,
literal|0
block|,
literal|"NVIDIA GT240"
block|}
block|,
block|{
name|HDA_CODEC_NVIDIAGTS450
block|,
literal|0
block|,
literal|"NVIDIA GTS450"
block|}
block|,
block|{
name|HDA_CODEC_NVIDIAGT440
block|,
literal|0
block|,
literal|"NVIDIA GT440"
block|}
block|,
block|{
name|HDA_CODEC_NVIDIAGTX550
block|,
literal|0
block|,
literal|"NVIDIA GTX550"
block|}
block|,
block|{
name|HDA_CODEC_NVIDIAGTX570
block|,
literal|0
block|,
literal|"NVIDIA GTX570"
block|}
block|,
block|{
name|HDA_CODEC_INTELIP
block|,
literal|0
block|,
literal|"Intel Ibex Peak"
block|}
block|,
block|{
name|HDA_CODEC_INTELBL
block|,
literal|0
block|,
literal|"Intel Bearlake"
block|}
block|,
block|{
name|HDA_CODEC_INTELCA
block|,
literal|0
block|,
literal|"Intel Cantiga"
block|}
block|,
block|{
name|HDA_CODEC_INTELEL
block|,
literal|0
block|,
literal|"Intel Eaglelake"
block|}
block|,
block|{
name|HDA_CODEC_INTELIP2
block|,
literal|0
block|,
literal|"Intel Ibex Peak"
block|}
block|,
block|{
name|HDA_CODEC_INTELCPT
block|,
literal|0
block|,
literal|"Intel Cougar Point"
block|}
block|,
block|{
name|HDA_CODEC_INTELPPT
block|,
literal|0
block|,
literal|"Intel Panther Point"
block|}
block|,
block|{
name|HDA_CODEC_INTELHSW
block|,
literal|0
block|,
literal|"Intel Haswell"
block|}
block|,
block|{
name|HDA_CODEC_INTELBDW
block|,
literal|0
block|,
literal|"Intel Broadwell"
block|}
block|,
block|{
name|HDA_CODEC_INTELCL
block|,
literal|0
block|,
literal|"Intel Crestline"
block|}
block|,
block|{
name|HDA_CODEC_SII1390
block|,
literal|0
block|,
literal|"Silicon Image SiI1390"
block|}
block|,
block|{
name|HDA_CODEC_SII1392
block|,
literal|0
block|,
literal|"Silicon Image SiI1392"
block|}
block|,
comment|/* Unknown CODECs */
block|{
name|HDA_CODEC_ADXXXX
block|,
literal|0
block|,
literal|"Analog Devices"
block|}
block|,
block|{
name|HDA_CODEC_AGEREXXXX
block|,
literal|0
block|,
literal|"Lucent/Agere Systems"
block|}
block|,
block|{
name|HDA_CODEC_ALCXXXX
block|,
literal|0
block|,
literal|"Realtek"
block|}
block|,
block|{
name|HDA_CODEC_ATIXXXX
block|,
literal|0
block|,
literal|"ATI"
block|}
block|,
block|{
name|HDA_CODEC_CAXXXX
block|,
literal|0
block|,
literal|"Creative"
block|}
block|,
block|{
name|HDA_CODEC_CMIXXXX
block|,
literal|0
block|,
literal|"CMedia"
block|}
block|,
block|{
name|HDA_CODEC_CMIXXXX2
block|,
literal|0
block|,
literal|"CMedia"
block|}
block|,
block|{
name|HDA_CODEC_CSXXXX
block|,
literal|0
block|,
literal|"Cirrus Logic"
block|}
block|,
block|{
name|HDA_CODEC_CXXXXX
block|,
literal|0
block|,
literal|"Conexant"
block|}
block|,
block|{
name|HDA_CODEC_CHXXXX
block|,
literal|0
block|,
literal|"Chrontel"
block|}
block|,
block|{
name|HDA_CODEC_IDTXXXX
block|,
literal|0
block|,
literal|"IDT"
block|}
block|,
block|{
name|HDA_CODEC_INTELXXXX
block|,
literal|0
block|,
literal|"Intel"
block|}
block|,
block|{
name|HDA_CODEC_MOTOXXXX
block|,
literal|0
block|,
literal|"Motorola"
block|}
block|,
block|{
name|HDA_CODEC_NVIDIAXXXX
block|,
literal|0
block|,
literal|"NVIDIA"
block|}
block|,
block|{
name|HDA_CODEC_SIIXXXX
block|,
literal|0
block|,
literal|"Silicon Image"
block|}
block|,
block|{
name|HDA_CODEC_STACXXXX
block|,
literal|0
block|,
literal|"Sigmatel"
block|}
block|,
block|{
name|HDA_CODEC_VTXXXX
block|,
literal|0
block|,
literal|"VIA"
block|}
block|, }
struct|;
end_struct

begin_function
specifier|static
name|int
name|hdacc_suspend
parameter_list|(
name|device_t
name|dev
parameter_list|)
block|{
name|HDA_BOOTHVERBOSE
argument_list|(
argument|device_printf(dev,
literal|"Suspend...\n"
argument|);
argument_list|)
empty_stmt|;
name|bus_generic_suspend
argument_list|(
name|dev
argument_list|)
expr_stmt|;
name|HDA_BOOTHVERBOSE
argument_list|(
argument|device_printf(dev,
literal|"Suspend done\n"
argument|);
argument_list|)
empty_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|hdacc_resume
parameter_list|(
name|device_t
name|dev
parameter_list|)
block|{
name|HDA_BOOTHVERBOSE
argument_list|(
argument|device_printf(dev,
literal|"Resume...\n"
argument|);
argument_list|)
empty_stmt|;
name|bus_generic_resume
argument_list|(
name|dev
argument_list|)
expr_stmt|;
name|HDA_BOOTHVERBOSE
argument_list|(
argument|device_printf(dev,
literal|"Resume done\n"
argument|);
argument_list|)
empty_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|hdacc_probe
parameter_list|(
name|device_t
name|dev
parameter_list|)
block|{
name|uint32_t
name|id
decl_stmt|,
name|revid
decl_stmt|;
name|char
name|buf
index|[
literal|128
index|]
decl_stmt|;
name|int
name|i
decl_stmt|;
name|id
operator|=
operator|(
operator|(
name|uint32_t
operator|)
name|hda_get_vendor_id
argument_list|(
name|dev
argument_list|)
operator|<<
literal|16
operator|)
operator|+
name|hda_get_device_id
argument_list|(
name|dev
argument_list|)
expr_stmt|;
name|revid
operator|=
operator|(
operator|(
name|uint32_t
operator|)
name|hda_get_revision_id
argument_list|(
name|dev
argument_list|)
operator|<<
literal|8
operator|)
operator|+
name|hda_get_stepping_id
argument_list|(
name|dev
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nitems
argument_list|(
name|hdacc_codecs
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|HDA_DEV_MATCH
argument_list|(
name|hdacc_codecs
index|[
name|i
index|]
operator|.
name|id
argument_list|,
name|id
argument_list|)
condition|)
continue|continue;
if|if
condition|(
name|hdacc_codecs
index|[
name|i
index|]
operator|.
name|revid
operator|!=
literal|0
operator|&&
name|hdacc_codecs
index|[
name|i
index|]
operator|.
name|revid
operator|!=
name|revid
condition|)
continue|continue;
break|break;
block|}
if|if
condition|(
name|i
operator|<
name|nitems
argument_list|(
name|hdacc_codecs
argument_list|)
condition|)
block|{
if|if
condition|(
operator|(
name|hdacc_codecs
index|[
name|i
index|]
operator|.
name|id
operator|&
literal|0xffff
operator|)
operator|!=
literal|0xffff
condition|)
name|strlcpy
argument_list|(
name|buf
argument_list|,
name|hdacc_codecs
index|[
name|i
index|]
operator|.
name|name
argument_list|,
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|snprintf
argument_list|(
name|buf
argument_list|,
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|,
literal|"%s (0x%04x)"
argument_list|,
name|hdacc_codecs
index|[
name|i
index|]
operator|.
name|name
argument_list|,
name|hda_get_device_id
argument_list|(
name|dev
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
name|snprintf
argument_list|(
name|buf
argument_list|,
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|,
literal|"Generic (0x%04x)"
argument_list|,
name|id
argument_list|)
expr_stmt|;
name|strlcat
argument_list|(
name|buf
argument_list|,
literal|" HDA CODEC"
argument_list|,
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|)
expr_stmt|;
name|device_set_desc_copy
argument_list|(
name|dev
argument_list|,
name|buf
argument_list|)
expr_stmt|;
return|return
operator|(
name|BUS_PROBE_DEFAULT
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|hdacc_attach
parameter_list|(
name|device_t
name|dev
parameter_list|)
block|{
name|struct
name|hdacc_softc
modifier|*
name|codec
init|=
name|device_get_softc
argument_list|(
name|dev
argument_list|)
decl_stmt|;
name|device_t
name|child
decl_stmt|;
name|int
name|cad
init|=
operator|(
name|intptr_t
operator|)
name|device_get_ivars
argument_list|(
name|dev
argument_list|)
decl_stmt|;
name|uint32_t
name|subnode
decl_stmt|;
name|int
name|startnode
decl_stmt|;
name|int
name|endnode
decl_stmt|;
name|int
name|i
decl_stmt|,
name|n
decl_stmt|;
name|codec
operator|->
name|lock
operator|=
name|HDAC_GET_MTX
argument_list|(
name|device_get_parent
argument_list|(
name|dev
argument_list|)
argument_list|,
name|dev
argument_list|)
expr_stmt|;
name|codec
operator|->
name|dev
operator|=
name|dev
expr_stmt|;
name|codec
operator|->
name|cad
operator|=
name|cad
expr_stmt|;
name|hdacc_lock
argument_list|(
name|codec
argument_list|)
expr_stmt|;
name|subnode
operator|=
name|hda_command
argument_list|(
name|dev
argument_list|,
name|HDA_CMD_GET_PARAMETER
argument_list|(
literal|0
argument_list|,
literal|0x0
argument_list|,
name|HDA_PARAM_SUB_NODE_COUNT
argument_list|)
argument_list|)
expr_stmt|;
name|hdacc_unlock
argument_list|(
name|codec
argument_list|)
expr_stmt|;
if|if
condition|(
name|subnode
operator|==
name|HDA_INVALID
condition|)
return|return
operator|(
name|EIO
operator|)
return|;
name|codec
operator|->
name|fgcnt
operator|=
name|HDA_PARAM_SUB_NODE_COUNT_TOTAL
argument_list|(
name|subnode
argument_list|)
expr_stmt|;
name|startnode
operator|=
name|HDA_PARAM_SUB_NODE_COUNT_START
argument_list|(
name|subnode
argument_list|)
expr_stmt|;
name|endnode
operator|=
name|startnode
operator|+
name|codec
operator|->
name|fgcnt
expr_stmt|;
name|HDA_BOOTHVERBOSE
argument_list|(
argument|device_printf(dev,
literal|"Root Node at nid=0: %d subnodes %d-%d\n"
argument|, 		    HDA_PARAM_SUB_NODE_COUNT_TOTAL(subnode), 		    startnode, endnode -
literal|1
argument|);
argument_list|)
empty_stmt|;
name|codec
operator|->
name|fgs
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
expr|struct
name|hdacc_fg
argument_list|)
operator|*
name|codec
operator|->
name|fgcnt
argument_list|,
name|M_HDACC
argument_list|,
name|M_ZERO
operator||
name|M_WAITOK
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
name|startnode
operator|,
name|n
operator|=
literal|0
init|;
name|i
operator|<
name|endnode
condition|;
name|i
operator|++
operator|,
name|n
operator|++
control|)
block|{
name|codec
operator|->
name|fgs
index|[
name|n
index|]
operator|.
name|nid
operator|=
name|i
expr_stmt|;
name|hdacc_lock
argument_list|(
name|codec
argument_list|)
expr_stmt|;
name|codec
operator|->
name|fgs
index|[
name|n
index|]
operator|.
name|type
operator|=
name|HDA_PARAM_FCT_GRP_TYPE_NODE_TYPE
argument_list|(
name|hda_command
argument_list|(
name|dev
argument_list|,
name|HDA_CMD_GET_PARAMETER
argument_list|(
literal|0
argument_list|,
name|i
argument_list|,
name|HDA_PARAM_FCT_GRP_TYPE
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|codec
operator|->
name|fgs
index|[
name|n
index|]
operator|.
name|subsystem_id
operator|=
name|hda_command
argument_list|(
name|dev
argument_list|,
name|HDA_CMD_GET_SUBSYSTEM_ID
argument_list|(
literal|0
argument_list|,
name|i
argument_list|)
argument_list|)
expr_stmt|;
name|hdacc_unlock
argument_list|(
name|codec
argument_list|)
expr_stmt|;
name|codec
operator|->
name|fgs
index|[
name|n
index|]
operator|.
name|dev
operator|=
name|child
operator|=
name|device_add_child
argument_list|(
name|dev
argument_list|,
name|NULL
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|child
operator|==
name|NULL
condition|)
block|{
name|device_printf
argument_list|(
name|dev
argument_list|,
literal|"Failed to add function device\n"
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|device_set_ivars
argument_list|(
name|child
argument_list|,
operator|&
name|codec
operator|->
name|fgs
index|[
name|n
index|]
argument_list|)
expr_stmt|;
block|}
name|bus_generic_attach
argument_list|(
name|dev
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|hdacc_detach
parameter_list|(
name|device_t
name|dev
parameter_list|)
block|{
name|struct
name|hdacc_softc
modifier|*
name|codec
init|=
name|device_get_softc
argument_list|(
name|dev
argument_list|)
decl_stmt|;
name|int
name|error
decl_stmt|;
name|error
operator|=
name|device_delete_children
argument_list|(
name|dev
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|codec
operator|->
name|fgs
argument_list|,
name|M_HDACC
argument_list|)
expr_stmt|;
return|return
operator|(
name|error
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|hdacc_child_location_str
parameter_list|(
name|device_t
name|dev
parameter_list|,
name|device_t
name|child
parameter_list|,
name|char
modifier|*
name|buf
parameter_list|,
name|size_t
name|buflen
parameter_list|)
block|{
name|struct
name|hdacc_fg
modifier|*
name|fg
init|=
name|device_get_ivars
argument_list|(
name|child
argument_list|)
decl_stmt|;
name|snprintf
argument_list|(
name|buf
argument_list|,
name|buflen
argument_list|,
literal|"nid=%d"
argument_list|,
name|fg
operator|->
name|nid
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|hdacc_child_pnpinfo_str_method
parameter_list|(
name|device_t
name|dev
parameter_list|,
name|device_t
name|child
parameter_list|,
name|char
modifier|*
name|buf
parameter_list|,
name|size_t
name|buflen
parameter_list|)
block|{
name|struct
name|hdacc_fg
modifier|*
name|fg
init|=
name|device_get_ivars
argument_list|(
name|child
argument_list|)
decl_stmt|;
name|snprintf
argument_list|(
name|buf
argument_list|,
name|buflen
argument_list|,
literal|"type=0x%02x subsystem=0x%08x"
argument_list|,
name|fg
operator|->
name|type
argument_list|,
name|fg
operator|->
name|subsystem_id
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|hdacc_print_child
parameter_list|(
name|device_t
name|dev
parameter_list|,
name|device_t
name|child
parameter_list|)
block|{
name|struct
name|hdacc_fg
modifier|*
name|fg
init|=
name|device_get_ivars
argument_list|(
name|child
argument_list|)
decl_stmt|;
name|int
name|retval
decl_stmt|;
name|retval
operator|=
name|bus_print_child_header
argument_list|(
name|dev
argument_list|,
name|child
argument_list|)
expr_stmt|;
name|retval
operator|+=
name|printf
argument_list|(
literal|" at nid %d"
argument_list|,
name|fg
operator|->
name|nid
argument_list|)
expr_stmt|;
name|retval
operator|+=
name|bus_print_child_footer
argument_list|(
name|dev
argument_list|,
name|child
argument_list|)
expr_stmt|;
return|return
operator|(
name|retval
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|hdacc_probe_nomatch
parameter_list|(
name|device_t
name|dev
parameter_list|,
name|device_t
name|child
parameter_list|)
block|{
name|struct
name|hdacc_softc
modifier|*
name|codec
init|=
name|device_get_softc
argument_list|(
name|dev
argument_list|)
decl_stmt|;
name|struct
name|hdacc_fg
modifier|*
name|fg
init|=
name|device_get_ivars
argument_list|(
name|child
argument_list|)
decl_stmt|;
name|device_printf
argument_list|(
name|child
argument_list|,
literal|"<%s %s Function Group> at nid %d on %s "
literal|"(no driver attached)\n"
argument_list|,
name|device_get_desc
argument_list|(
name|dev
argument_list|)
argument_list|,
name|fg
operator|->
name|type
operator|==
name|HDA_PARAM_FCT_GRP_TYPE_NODE_TYPE_AUDIO
condition|?
literal|"Audio"
else|:
operator|(
name|fg
operator|->
name|type
operator|==
name|HDA_PARAM_FCT_GRP_TYPE_NODE_TYPE_MODEM
condition|?
literal|"Modem"
else|:
literal|"Unknown"
operator|)
argument_list|,
name|fg
operator|->
name|nid
argument_list|,
name|device_get_nameunit
argument_list|(
name|dev
argument_list|)
argument_list|)
expr_stmt|;
name|HDA_BOOTVERBOSE
argument_list|(
argument|device_printf(dev,
literal|"Subsystem ID: 0x%08x\n"
argument|, 		    hda_get_subsystem_id(dev));
argument_list|)
empty_stmt|;
name|HDA_BOOTHVERBOSE
argument_list|(
argument|device_printf(dev,
literal|"Power down FG nid=%d to the D3 state...\n"
argument|, 		    fg->nid);
argument_list|)
empty_stmt|;
name|hdacc_lock
argument_list|(
name|codec
argument_list|)
expr_stmt|;
name|hda_command
argument_list|(
name|dev
argument_list|,
name|HDA_CMD_SET_POWER_STATE
argument_list|(
literal|0
argument_list|,
name|fg
operator|->
name|nid
argument_list|,
name|HDA_CMD_POWER_STATE_D3
argument_list|)
argument_list|)
expr_stmt|;
name|hdacc_unlock
argument_list|(
name|codec
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|int
name|hdacc_read_ivar
parameter_list|(
name|device_t
name|dev
parameter_list|,
name|device_t
name|child
parameter_list|,
name|int
name|which
parameter_list|,
name|uintptr_t
modifier|*
name|result
parameter_list|)
block|{
name|struct
name|hdacc_fg
modifier|*
name|fg
init|=
name|device_get_ivars
argument_list|(
name|child
argument_list|)
decl_stmt|;
switch|switch
condition|(
name|which
condition|)
block|{
case|case
name|HDA_IVAR_NODE_ID
case|:
operator|*
name|result
operator|=
name|fg
operator|->
name|nid
expr_stmt|;
break|break;
case|case
name|HDA_IVAR_NODE_TYPE
case|:
operator|*
name|result
operator|=
name|fg
operator|->
name|type
expr_stmt|;
break|break;
case|case
name|HDA_IVAR_SUBSYSTEM_ID
case|:
operator|*
name|result
operator|=
name|fg
operator|->
name|subsystem_id
expr_stmt|;
break|break;
default|default:
return|return
operator|(
name|BUS_READ_IVAR
argument_list|(
name|device_get_parent
argument_list|(
name|dev
argument_list|)
argument_list|,
name|dev
argument_list|,
name|which
argument_list|,
name|result
argument_list|)
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|struct
name|mtx
modifier|*
name|hdacc_get_mtx
parameter_list|(
name|device_t
name|dev
parameter_list|,
name|device_t
name|child
parameter_list|)
block|{
name|struct
name|hdacc_softc
modifier|*
name|codec
init|=
name|device_get_softc
argument_list|(
name|dev
argument_list|)
decl_stmt|;
return|return
operator|(
name|codec
operator|->
name|lock
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|uint32_t
name|hdacc_codec_command
parameter_list|(
name|device_t
name|dev
parameter_list|,
name|device_t
name|child
parameter_list|,
name|uint32_t
name|verb
parameter_list|)
block|{
return|return
operator|(
name|HDAC_CODEC_COMMAND
argument_list|(
name|device_get_parent
argument_list|(
name|dev
argument_list|)
argument_list|,
name|dev
argument_list|,
name|verb
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|hdacc_stream_alloc
parameter_list|(
name|device_t
name|dev
parameter_list|,
name|device_t
name|child
parameter_list|,
name|int
name|dir
parameter_list|,
name|int
name|format
parameter_list|,
name|int
name|stripe
parameter_list|,
name|uint32_t
modifier|*
modifier|*
name|dmapos
parameter_list|)
block|{
name|struct
name|hdacc_softc
modifier|*
name|codec
init|=
name|device_get_softc
argument_list|(
name|dev
argument_list|)
decl_stmt|;
name|int
name|stream
decl_stmt|;
name|stream
operator|=
name|HDAC_STREAM_ALLOC
argument_list|(
name|device_get_parent
argument_list|(
name|dev
argument_list|)
argument_list|,
name|dev
argument_list|,
name|dir
argument_list|,
name|format
argument_list|,
name|stripe
argument_list|,
name|dmapos
argument_list|)
expr_stmt|;
if|if
condition|(
name|stream
operator|>
literal|0
condition|)
name|codec
operator|->
name|streams
index|[
name|dir
index|]
index|[
name|stream
index|]
operator|=
name|child
expr_stmt|;
return|return
operator|(
name|stream
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|hdacc_stream_free
parameter_list|(
name|device_t
name|dev
parameter_list|,
name|device_t
name|child
parameter_list|,
name|int
name|dir
parameter_list|,
name|int
name|stream
parameter_list|)
block|{
name|struct
name|hdacc_softc
modifier|*
name|codec
init|=
name|device_get_softc
argument_list|(
name|dev
argument_list|)
decl_stmt|;
name|codec
operator|->
name|streams
index|[
name|dir
index|]
index|[
name|stream
index|]
operator|=
name|NULL
expr_stmt|;
name|HDAC_STREAM_FREE
argument_list|(
name|device_get_parent
argument_list|(
name|dev
argument_list|)
argument_list|,
name|dev
argument_list|,
name|dir
argument_list|,
name|stream
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|int
name|hdacc_stream_start
parameter_list|(
name|device_t
name|dev
parameter_list|,
name|device_t
name|child
parameter_list|,
name|int
name|dir
parameter_list|,
name|int
name|stream
parameter_list|,
name|bus_addr_t
name|buf
parameter_list|,
name|int
name|blksz
parameter_list|,
name|int
name|blkcnt
parameter_list|)
block|{
return|return
operator|(
name|HDAC_STREAM_START
argument_list|(
name|device_get_parent
argument_list|(
name|dev
argument_list|)
argument_list|,
name|dev
argument_list|,
name|dir
argument_list|,
name|stream
argument_list|,
name|buf
argument_list|,
name|blksz
argument_list|,
name|blkcnt
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|hdacc_stream_stop
parameter_list|(
name|device_t
name|dev
parameter_list|,
name|device_t
name|child
parameter_list|,
name|int
name|dir
parameter_list|,
name|int
name|stream
parameter_list|)
block|{
name|HDAC_STREAM_STOP
argument_list|(
name|device_get_parent
argument_list|(
name|dev
argument_list|)
argument_list|,
name|dev
argument_list|,
name|dir
argument_list|,
name|stream
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|hdacc_stream_reset
parameter_list|(
name|device_t
name|dev
parameter_list|,
name|device_t
name|child
parameter_list|,
name|int
name|dir
parameter_list|,
name|int
name|stream
parameter_list|)
block|{
name|HDAC_STREAM_RESET
argument_list|(
name|device_get_parent
argument_list|(
name|dev
argument_list|)
argument_list|,
name|dev
argument_list|,
name|dir
argument_list|,
name|stream
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|uint32_t
name|hdacc_stream_getptr
parameter_list|(
name|device_t
name|dev
parameter_list|,
name|device_t
name|child
parameter_list|,
name|int
name|dir
parameter_list|,
name|int
name|stream
parameter_list|)
block|{
return|return
operator|(
name|HDAC_STREAM_GETPTR
argument_list|(
name|device_get_parent
argument_list|(
name|dev
argument_list|)
argument_list|,
name|dev
argument_list|,
name|dir
argument_list|,
name|stream
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|hdacc_stream_intr
parameter_list|(
name|device_t
name|dev
parameter_list|,
name|int
name|dir
parameter_list|,
name|int
name|stream
parameter_list|)
block|{
name|struct
name|hdacc_softc
modifier|*
name|codec
init|=
name|device_get_softc
argument_list|(
name|dev
argument_list|)
decl_stmt|;
name|device_t
name|child
decl_stmt|;
if|if
condition|(
operator|(
name|child
operator|=
name|codec
operator|->
name|streams
index|[
name|dir
index|]
index|[
name|stream
index|]
operator|)
operator|!=
name|NULL
condition|)
name|HDAC_STREAM_INTR
argument_list|(
name|child
argument_list|,
name|dir
argument_list|,
name|stream
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|int
name|hdacc_unsol_alloc
parameter_list|(
name|device_t
name|dev
parameter_list|,
name|device_t
name|child
parameter_list|,
name|int
name|wanted
parameter_list|)
block|{
name|struct
name|hdacc_softc
modifier|*
name|codec
init|=
name|device_get_softc
argument_list|(
name|dev
argument_list|)
decl_stmt|;
name|int
name|tag
decl_stmt|;
name|wanted
operator|&=
literal|0x3f
expr_stmt|;
name|tag
operator|=
name|wanted
expr_stmt|;
do|do
block|{
if|if
condition|(
name|codec
operator|->
name|tags
index|[
name|tag
index|]
operator|==
name|NULL
condition|)
block|{
name|codec
operator|->
name|tags
index|[
name|tag
index|]
operator|=
name|child
expr_stmt|;
name|HDAC_UNSOL_ALLOC
argument_list|(
name|device_get_parent
argument_list|(
name|dev
argument_list|)
argument_list|,
name|dev
argument_list|,
name|tag
argument_list|)
expr_stmt|;
return|return
operator|(
name|tag
operator|)
return|;
block|}
name|tag
operator|++
expr_stmt|;
name|tag
operator|&=
literal|0x3f
expr_stmt|;
block|}
do|while
condition|(
name|tag
operator|!=
name|wanted
condition|)
do|;
return|return
operator|(
operator|-
literal|1
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|hdacc_unsol_free
parameter_list|(
name|device_t
name|dev
parameter_list|,
name|device_t
name|child
parameter_list|,
name|int
name|tag
parameter_list|)
block|{
name|struct
name|hdacc_softc
modifier|*
name|codec
init|=
name|device_get_softc
argument_list|(
name|dev
argument_list|)
decl_stmt|;
name|KASSERT
argument_list|(
name|tag
operator|>=
literal|0
operator|&&
name|tag
operator|<=
literal|0x3f
argument_list|,
operator|(
literal|"Wrong tag value %d\n"
operator|,
name|tag
operator|)
argument_list|)
expr_stmt|;
name|codec
operator|->
name|tags
index|[
name|tag
index|]
operator|=
name|NULL
expr_stmt|;
name|HDAC_UNSOL_FREE
argument_list|(
name|device_get_parent
argument_list|(
name|dev
argument_list|)
argument_list|,
name|dev
argument_list|,
name|tag
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|hdacc_unsol_intr
parameter_list|(
name|device_t
name|dev
parameter_list|,
name|uint32_t
name|resp
parameter_list|)
block|{
name|struct
name|hdacc_softc
modifier|*
name|codec
init|=
name|device_get_softc
argument_list|(
name|dev
argument_list|)
decl_stmt|;
name|device_t
name|child
decl_stmt|;
name|int
name|tag
decl_stmt|;
name|tag
operator|=
name|resp
operator|>>
literal|26
expr_stmt|;
if|if
condition|(
operator|(
name|child
operator|=
name|codec
operator|->
name|tags
index|[
name|tag
index|]
operator|)
operator|!=
name|NULL
condition|)
name|HDAC_UNSOL_INTR
argument_list|(
name|child
argument_list|,
name|resp
argument_list|)
expr_stmt|;
else|else
name|device_printf
argument_list|(
name|codec
operator|->
name|dev
argument_list|,
literal|"Unexpected unsolicited "
literal|"response with tag %d: %08x\n"
argument_list|,
name|tag
argument_list|,
name|resp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|hdacc_pindump
parameter_list|(
name|device_t
name|dev
parameter_list|)
block|{
name|device_t
modifier|*
name|devlist
decl_stmt|;
name|int
name|devcount
decl_stmt|,
name|i
decl_stmt|;
if|if
condition|(
name|device_get_children
argument_list|(
name|dev
argument_list|,
operator|&
name|devlist
argument_list|,
operator|&
name|devcount
argument_list|)
operator|!=
literal|0
condition|)
return|return;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|devcount
condition|;
name|i
operator|++
control|)
name|HDAC_PINDUMP
argument_list|(
name|devlist
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|devlist
argument_list|,
name|M_TEMP
argument_list|)
expr_stmt|;
block|}
end_function

begin_decl_stmt
specifier|static
name|device_method_t
name|hdacc_methods
index|[]
init|=
block|{
comment|/* device interface */
name|DEVMETHOD
argument_list|(
name|device_probe
argument_list|,
name|hdacc_probe
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|device_attach
argument_list|,
name|hdacc_attach
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|device_detach
argument_list|,
name|hdacc_detach
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|device_suspend
argument_list|,
name|hdacc_suspend
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|device_resume
argument_list|,
name|hdacc_resume
argument_list|)
block|,
comment|/* Bus interface */
name|DEVMETHOD
argument_list|(
name|bus_child_location_str
argument_list|,
name|hdacc_child_location_str
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|bus_child_pnpinfo_str
argument_list|,
name|hdacc_child_pnpinfo_str_method
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|bus_print_child
argument_list|,
name|hdacc_print_child
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|bus_probe_nomatch
argument_list|,
name|hdacc_probe_nomatch
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|bus_read_ivar
argument_list|,
name|hdacc_read_ivar
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|hdac_get_mtx
argument_list|,
name|hdacc_get_mtx
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|hdac_codec_command
argument_list|,
name|hdacc_codec_command
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|hdac_stream_alloc
argument_list|,
name|hdacc_stream_alloc
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|hdac_stream_free
argument_list|,
name|hdacc_stream_free
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|hdac_stream_start
argument_list|,
name|hdacc_stream_start
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|hdac_stream_stop
argument_list|,
name|hdacc_stream_stop
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|hdac_stream_reset
argument_list|,
name|hdacc_stream_reset
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|hdac_stream_getptr
argument_list|,
name|hdacc_stream_getptr
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|hdac_stream_intr
argument_list|,
name|hdacc_stream_intr
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|hdac_unsol_alloc
argument_list|,
name|hdacc_unsol_alloc
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|hdac_unsol_free
argument_list|,
name|hdacc_unsol_free
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|hdac_unsol_intr
argument_list|,
name|hdacc_unsol_intr
argument_list|)
block|,
name|DEVMETHOD
argument_list|(
name|hdac_pindump
argument_list|,
name|hdacc_pindump
argument_list|)
block|,
name|DEVMETHOD_END
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|driver_t
name|hdacc_driver
init|=
block|{
literal|"hdacc"
block|,
name|hdacc_methods
block|,
sizeof|sizeof
argument_list|(
expr|struct
name|hdacc_softc
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|devclass_t
name|hdacc_devclass
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|DRIVER_MODULE
argument_list|(
name|snd_hda
argument_list|,
name|hdac
argument_list|,
name|hdacc_driver
argument_list|,
name|hdacc_devclass
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
end_expr_stmt

end_unit

