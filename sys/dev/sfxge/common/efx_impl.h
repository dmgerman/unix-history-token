begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2007-2015 Solarflare Communications Inc.  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions are met:  *  * 1. Redistributions of source code must retain the above copyright notice,  *    this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright notice,  *    this list of conditions and the following disclaimer in the documentation  *    and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"  * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,  * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR  * PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,  * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,  * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;  * OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,  * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR  * OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,  * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  *  * The views and conclusions contained in the software and documentation are  * those of the authors and should not be interpreted as representing official  * policies, either expressed or implied, of the FreeBSD Project.  *  * $FreeBSD$  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|_SYS_EFX_IMPL_H
end_ifndef

begin_define
define|#
directive|define
name|_SYS_EFX_IMPL_H
end_define

begin_include
include|#
directive|include
file|"efsys.h"
end_include

begin_include
include|#
directive|include
file|"efx.h"
end_include

begin_include
include|#
directive|include
file|"efx_regs.h"
end_include

begin_include
include|#
directive|include
file|"efx_regs_ef10.h"
end_include

begin_comment
comment|/* FIXME: Add definition for driver generated software events */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|ESE_DZ_EV_CODE_DRV_GEN_EV
end_ifndef

begin_define
define|#
directive|define
name|ESE_DZ_EV_CODE_DRV_GEN_EV
value|FSE_AZ_EV_CODE_DRV_GEN_EV
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|"efx_check.h"
end_include

begin_if
if|#
directive|if
name|EFSYS_OPT_FALCON
end_if

begin_include
include|#
directive|include
file|"falcon_impl.h"
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* EFSYS_OPT_FALCON */
end_comment

begin_if
if|#
directive|if
name|EFSYS_OPT_SIENA
end_if

begin_include
include|#
directive|include
file|"siena_impl.h"
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* EFSYS_OPT_SIENA */
end_comment

begin_if
if|#
directive|if
name|EFSYS_OPT_HUNTINGTON
end_if

begin_include
include|#
directive|include
file|"hunt_impl.h"
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* EFSYS_OPT_HUNTINGTON */
end_comment

begin_if
if|#
directive|if
name|EFSYS_OPT_MEDFORD
end_if

begin_include
include|#
directive|include
file|"medford_impl.h"
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* EFSYS_OPT_MEDFORD */
end_comment

begin_if
if|#
directive|if
operator|(
name|EFSYS_OPT_HUNTINGTON
operator|||
name|EFSYS_OPT_MEDFORD
operator|)
end_if

begin_include
include|#
directive|include
file|"ef10_impl.h"
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* (EFSYS_OPT_HUNTINGTON || EFSYS_OPT_MEDFORD) */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|__cplusplus
end_ifdef

begin_extern
extern|extern
literal|"C"
block|{
endif|#
directive|endif
define|#
directive|define
name|EFX_MOD_MCDI
value|0x00000001
define|#
directive|define
name|EFX_MOD_PROBE
value|0x00000002
define|#
directive|define
name|EFX_MOD_NVRAM
value|0x00000004
define|#
directive|define
name|EFX_MOD_VPD
value|0x00000008
define|#
directive|define
name|EFX_MOD_NIC
value|0x00000010
define|#
directive|define
name|EFX_MOD_INTR
value|0x00000020
define|#
directive|define
name|EFX_MOD_EV
value|0x00000040
define|#
directive|define
name|EFX_MOD_RX
value|0x00000080
define|#
directive|define
name|EFX_MOD_TX
value|0x00000100
define|#
directive|define
name|EFX_MOD_PORT
value|0x00000200
define|#
directive|define
name|EFX_MOD_MON
value|0x00000400
define|#
directive|define
name|EFX_MOD_WOL
value|0x00000800
define|#
directive|define
name|EFX_MOD_FILTER
value|0x00001000
define|#
directive|define
name|EFX_MOD_PKTFILTER
value|0x00002000
define|#
directive|define
name|EFX_RESET_MAC
value|0x00000001
define|#
directive|define
name|EFX_RESET_PHY
value|0x00000002
define|#
directive|define
name|EFX_RESET_RXQ_ERR
value|0x00000004
define|#
directive|define
name|EFX_RESET_TXQ_ERR
value|0x00000008
typedef|typedef
enum|enum
name|efx_mac_type_e
block|{
name|EFX_MAC_INVALID
init|=
literal|0
block|,
name|EFX_MAC_FALCON_GMAC
block|,
name|EFX_MAC_FALCON_XMAC
block|,
name|EFX_MAC_SIENA
block|,
name|EFX_MAC_HUNTINGTON
block|,
name|EFX_MAC_NTYPES
block|}
name|efx_mac_type_t
typedef|;
typedef|typedef
struct|struct
name|efx_ev_ops_s
block|{
name|efx_rc_t
function_decl|(
modifier|*
name|eevo_init
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|eevo_fini
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|eevo_qcreate
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|efsys_mem_t
modifier|*
parameter_list|,
name|size_t
parameter_list|,
name|uint32_t
parameter_list|,
name|efx_evq_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|eevo_qdestroy
function_decl|)
parameter_list|(
name|efx_evq_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|eevo_qprime
function_decl|)
parameter_list|(
name|efx_evq_t
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|eevo_qpost
function_decl|)
parameter_list|(
name|efx_evq_t
modifier|*
parameter_list|,
name|uint16_t
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|eevo_qmoderate
function_decl|)
parameter_list|(
name|efx_evq_t
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
if|#
directive|if
name|EFSYS_OPT_QSTATS
name|void
function_decl|(
modifier|*
name|eevo_qstats_update
function_decl|)
parameter_list|(
name|efx_evq_t
modifier|*
parameter_list|,
name|efsys_stat_t
modifier|*
parameter_list|)
function_decl|;
endif|#
directive|endif
block|}
name|efx_ev_ops_t
typedef|;
typedef|typedef
struct|struct
name|efx_tx_ops_s
block|{
name|efx_rc_t
function_decl|(
modifier|*
name|etxo_init
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|etxo_fini
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|etxo_qcreate
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|efsys_mem_t
modifier|*
parameter_list|,
name|size_t
parameter_list|,
name|uint32_t
parameter_list|,
name|uint16_t
parameter_list|,
name|efx_evq_t
modifier|*
parameter_list|,
name|efx_txq_t
modifier|*
parameter_list|,
name|unsigned
name|int
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|etxo_qdestroy
function_decl|)
parameter_list|(
name|efx_txq_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|etxo_qpost
function_decl|)
parameter_list|(
name|efx_txq_t
modifier|*
parameter_list|,
name|efx_buffer_t
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|unsigned
name|int
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|etxo_qpush
function_decl|)
parameter_list|(
name|efx_txq_t
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|etxo_qpace
function_decl|)
parameter_list|(
name|efx_txq_t
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|etxo_qflush
function_decl|)
parameter_list|(
name|efx_txq_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|etxo_qenable
function_decl|)
parameter_list|(
name|efx_txq_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|etxo_qpio_enable
function_decl|)
parameter_list|(
name|efx_txq_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|etxo_qpio_disable
function_decl|)
parameter_list|(
name|efx_txq_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|etxo_qpio_write
function_decl|)
parameter_list|(
name|efx_txq_t
modifier|*
parameter_list|,
name|uint8_t
modifier|*
parameter_list|,
name|size_t
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|etxo_qpio_post
function_decl|)
parameter_list|(
name|efx_txq_t
modifier|*
parameter_list|,
name|size_t
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|unsigned
name|int
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|etxo_qdesc_post
function_decl|)
parameter_list|(
name|efx_txq_t
modifier|*
parameter_list|,
name|efx_desc_t
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|unsigned
name|int
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|etxo_qdesc_dma_create
function_decl|)
parameter_list|(
name|efx_txq_t
modifier|*
parameter_list|,
name|efsys_dma_addr_t
parameter_list|,
name|size_t
parameter_list|,
name|boolean_t
parameter_list|,
name|efx_desc_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|etxo_qdesc_tso_create
function_decl|)
parameter_list|(
name|efx_txq_t
modifier|*
parameter_list|,
name|uint16_t
parameter_list|,
name|uint32_t
parameter_list|,
name|uint8_t
parameter_list|,
name|efx_desc_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|etxo_qdesc_vlantci_create
function_decl|)
parameter_list|(
name|efx_txq_t
modifier|*
parameter_list|,
name|uint16_t
parameter_list|,
name|efx_desc_t
modifier|*
parameter_list|)
function_decl|;
if|#
directive|if
name|EFSYS_OPT_QSTATS
name|void
function_decl|(
modifier|*
name|etxo_qstats_update
function_decl|)
parameter_list|(
name|efx_txq_t
modifier|*
parameter_list|,
name|efsys_stat_t
modifier|*
parameter_list|)
function_decl|;
endif|#
directive|endif
block|}
name|efx_tx_ops_t
typedef|;
typedef|typedef
struct|struct
name|efx_rx_ops_s
block|{
name|efx_rc_t
function_decl|(
modifier|*
name|erxo_init
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|erxo_fini
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
if|#
directive|if
name|EFSYS_OPT_RX_SCATTER
name|efx_rc_t
function_decl|(
modifier|*
name|erxo_scatter_enable
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
endif|#
directive|endif
if|#
directive|if
name|EFSYS_OPT_RX_SCALE
name|efx_rc_t
function_decl|(
modifier|*
name|erxo_scale_mode_set
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_rx_hash_alg_t
parameter_list|,
name|efx_rx_hash_type_t
parameter_list|,
name|boolean_t
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|erxo_scale_key_set
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|uint8_t
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|erxo_scale_tbl_set
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|unsigned
name|int
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
name|uint32_t
function_decl|(
modifier|*
name|erxo_prefix_hash
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_rx_hash_alg_t
parameter_list|,
name|uint8_t
modifier|*
parameter_list|)
function_decl|;
endif|#
directive|endif
comment|/* EFSYS_OPT_RX_SCALE */
name|efx_rc_t
function_decl|(
modifier|*
name|erxo_prefix_pktlen
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|uint8_t
modifier|*
parameter_list|,
name|uint16_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|erxo_qpost
function_decl|)
parameter_list|(
name|efx_rxq_t
modifier|*
parameter_list|,
name|efsys_dma_addr_t
modifier|*
parameter_list|,
name|size_t
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|erxo_qpush
function_decl|)
parameter_list|(
name|efx_rxq_t
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|unsigned
name|int
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|erxo_qflush
function_decl|)
parameter_list|(
name|efx_rxq_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|erxo_qenable
function_decl|)
parameter_list|(
name|efx_rxq_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|erxo_qcreate
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
name|enp
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|efx_rxq_type_t
parameter_list|,
name|efsys_mem_t
modifier|*
parameter_list|,
name|size_t
parameter_list|,
name|uint32_t
parameter_list|,
name|efx_evq_t
modifier|*
parameter_list|,
name|efx_rxq_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|erxo_qdestroy
function_decl|)
parameter_list|(
name|efx_rxq_t
modifier|*
parameter_list|)
function_decl|;
block|}
name|efx_rx_ops_t
typedef|;
typedef|typedef
struct|struct
name|efx_mac_ops_s
block|{
name|efx_rc_t
function_decl|(
modifier|*
name|emo_reset
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
comment|/* optional */
name|efx_rc_t
function_decl|(
modifier|*
name|emo_poll
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_link_mode_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|emo_up
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|boolean_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|emo_addr_set
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|emo_reconfigure
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|emo_multicast_list_set
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|emo_filter_default_rxq_set
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_rxq_t
modifier|*
parameter_list|,
name|boolean_t
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|emo_filter_default_rxq_clear
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
if|#
directive|if
name|EFSYS_OPT_LOOPBACK
name|efx_rc_t
function_decl|(
modifier|*
name|emo_loopback_set
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_link_mode_t
parameter_list|,
name|efx_loopback_type_t
parameter_list|)
function_decl|;
endif|#
directive|endif
comment|/* EFSYS_OPT_LOOPBACK */
if|#
directive|if
name|EFSYS_OPT_MAC_STATS
name|efx_rc_t
function_decl|(
modifier|*
name|emo_stats_upload
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efsys_mem_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|emo_stats_periodic
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efsys_mem_t
modifier|*
parameter_list|,
name|uint16_t
parameter_list|,
name|boolean_t
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|emo_stats_update
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efsys_mem_t
modifier|*
parameter_list|,
name|efsys_stat_t
modifier|*
parameter_list|,
name|uint32_t
modifier|*
parameter_list|)
function_decl|;
endif|#
directive|endif
comment|/* EFSYS_OPT_MAC_STATS */
block|}
name|efx_mac_ops_t
typedef|;
typedef|typedef
struct|struct
name|efx_phy_ops_s
block|{
name|efx_rc_t
function_decl|(
modifier|*
name|epo_power
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|boolean_t
parameter_list|)
function_decl|;
comment|/* optional */
name|efx_rc_t
function_decl|(
modifier|*
name|epo_reset
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|epo_reconfigure
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|epo_verify
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|epo_uplink_check
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|boolean_t
modifier|*
parameter_list|)
function_decl|;
comment|/* optional */
name|efx_rc_t
function_decl|(
modifier|*
name|epo_downlink_check
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_link_mode_t
modifier|*
parameter_list|,
name|unsigned
name|int
modifier|*
parameter_list|,
name|uint32_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|epo_oui_get
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|uint32_t
modifier|*
parameter_list|)
function_decl|;
if|#
directive|if
name|EFSYS_OPT_PHY_STATS
name|efx_rc_t
function_decl|(
modifier|*
name|epo_stats_update
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efsys_mem_t
modifier|*
parameter_list|,
name|uint32_t
modifier|*
parameter_list|)
function_decl|;
endif|#
directive|endif
comment|/* EFSYS_OPT_PHY_STATS */
if|#
directive|if
name|EFSYS_OPT_PHY_PROPS
if|#
directive|if
name|EFSYS_OPT_NAMES
specifier|const
name|char
modifier|*
function_decl|(
modifier|*
name|epo_prop_name
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
endif|#
directive|endif
comment|/* EFSYS_OPT_PHY_PROPS */
name|efx_rc_t
function_decl|(
modifier|*
name|epo_prop_get
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|uint32_t
parameter_list|,
name|uint32_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|epo_prop_set
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|uint32_t
parameter_list|)
function_decl|;
endif|#
directive|endif
comment|/* EFSYS_OPT_PHY_PROPS */
if|#
directive|if
name|EFSYS_OPT_BIST
name|efx_rc_t
function_decl|(
modifier|*
name|epo_bist_enable_offline
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|epo_bist_start
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_bist_type_t
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|epo_bist_poll
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_bist_type_t
parameter_list|,
name|efx_bist_result_t
modifier|*
parameter_list|,
name|uint32_t
modifier|*
parameter_list|,
name|unsigned
name|long
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|epo_bist_stop
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_bist_type_t
parameter_list|)
function_decl|;
endif|#
directive|endif
comment|/* EFSYS_OPT_BIST */
block|}
name|efx_phy_ops_t
typedef|;
if|#
directive|if
name|EFSYS_OPT_FILTER
typedef|typedef
struct|struct
name|efx_filter_ops_s
block|{
name|efx_rc_t
function_decl|(
modifier|*
name|efo_init
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|efo_fini
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|efo_restore
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|efo_add
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_filter_spec_t
modifier|*
parameter_list|,
name|boolean_t
name|may_replace
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|efo_delete
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_filter_spec_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|efo_supported_filters
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|uint32_t
modifier|*
parameter_list|,
name|size_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|efo_reconfigure
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|uint8_t
specifier|const
modifier|*
parameter_list|,
name|boolean_t
parameter_list|,
name|boolean_t
parameter_list|,
name|boolean_t
parameter_list|,
name|boolean_t
parameter_list|,
name|uint8_t
specifier|const
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
block|}
name|efx_filter_ops_t
typedef|;
specifier|extern
name|__checkReturn
name|efx_rc_t
name|efx_filter_reconfigure
argument_list|(
name|__in
name|efx_nic_t
operator|*
name|enp
argument_list|,
name|__in_ecount
argument_list|(
literal|6
argument_list|)
name|uint8_t
specifier|const
operator|*
name|mac_addr
argument_list|,
name|__in
name|boolean_t
name|all_unicst
argument_list|,
name|__in
name|boolean_t
name|mulcst
argument_list|,
name|__in
name|boolean_t
name|all_mulcst
argument_list|,
name|__in
name|boolean_t
name|brdcst
argument_list|,
name|__in_ecount
argument_list|(
literal|6
argument|*count
argument_list|)
name|uint8_t
specifier|const
operator|*
name|addrs
argument_list|,
name|__in
name|int
name|count
argument_list|)
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_FILTER */
typedef|typedef
struct|struct
name|efx_port_s
block|{
name|efx_mac_type_t
name|ep_mac_type
decl_stmt|;
name|uint32_t
name|ep_phy_type
decl_stmt|;
name|uint8_t
name|ep_port
decl_stmt|;
name|uint32_t
name|ep_mac_pdu
decl_stmt|;
name|uint8_t
name|ep_mac_addr
index|[
literal|6
index|]
decl_stmt|;
name|efx_link_mode_t
name|ep_link_mode
decl_stmt|;
name|boolean_t
name|ep_all_unicst
decl_stmt|;
name|boolean_t
name|ep_mulcst
decl_stmt|;
name|boolean_t
name|ep_all_mulcst
decl_stmt|;
name|boolean_t
name|ep_brdcst
decl_stmt|;
name|unsigned
name|int
name|ep_fcntl
decl_stmt|;
name|boolean_t
name|ep_fcntl_autoneg
decl_stmt|;
name|efx_oword_t
name|ep_multicst_hash
index|[
literal|2
index|]
decl_stmt|;
name|uint8_t
name|ep_mulcst_addr_list
index|[
name|EFX_MAC_ADDR_LEN
operator|*
name|EFX_MAC_MULTICAST_LIST_MAX
index|]
decl_stmt|;
name|uint32_t
name|ep_mulcst_addr_count
decl_stmt|;
if|#
directive|if
name|EFSYS_OPT_LOOPBACK
name|efx_loopback_type_t
name|ep_loopback_type
decl_stmt|;
name|efx_link_mode_t
name|ep_loopback_link_mode
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_LOOPBACK */
if|#
directive|if
name|EFSYS_OPT_PHY_FLAGS
name|uint32_t
name|ep_phy_flags
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_PHY_FLAGS */
if|#
directive|if
name|EFSYS_OPT_PHY_LED_CONTROL
name|efx_phy_led_mode_t
name|ep_phy_led_mode
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_PHY_LED_CONTROL */
name|efx_phy_media_type_t
name|ep_fixed_port_type
decl_stmt|;
name|efx_phy_media_type_t
name|ep_module_type
decl_stmt|;
name|uint32_t
name|ep_adv_cap_mask
decl_stmt|;
name|uint32_t
name|ep_lp_cap_mask
decl_stmt|;
name|uint32_t
name|ep_default_adv_cap_mask
decl_stmt|;
name|uint32_t
name|ep_phy_cap_mask
decl_stmt|;
if|#
directive|if
name|EFSYS_OPT_PHY_TXC43128
operator|||
name|EFSYS_OPT_PHY_QT2025C
union|union
block|{
struct|struct
block|{
name|unsigned
name|int
name|bug10934_count
decl_stmt|;
block|}
name|ep_txc43128
struct|;
struct|struct
block|{
name|unsigned
name|int
name|bug17190_count
decl_stmt|;
block|}
name|ep_qt2025c
struct|;
block|}
union|;
endif|#
directive|endif
name|boolean_t
name|ep_mac_poll_needed
decl_stmt|;
comment|/* falcon only */
name|boolean_t
name|ep_mac_up
decl_stmt|;
comment|/* falcon only */
name|uint32_t
name|ep_fwver
decl_stmt|;
comment|/* falcon only */
name|boolean_t
name|ep_mac_drain
decl_stmt|;
name|boolean_t
name|ep_mac_stats_pending
decl_stmt|;
if|#
directive|if
name|EFSYS_OPT_BIST
name|efx_bist_type_t
name|ep_current_bist
decl_stmt|;
endif|#
directive|endif
name|efx_mac_ops_t
modifier|*
name|ep_emop
decl_stmt|;
name|efx_phy_ops_t
modifier|*
name|ep_epop
decl_stmt|;
block|}
name|efx_port_t
typedef|;
typedef|typedef
struct|struct
name|efx_mon_ops_s
block|{
name|efx_rc_t
function_decl|(
modifier|*
name|emo_reset
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|emo_reconfigure
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
if|#
directive|if
name|EFSYS_OPT_MON_STATS
name|efx_rc_t
function_decl|(
modifier|*
name|emo_stats_update
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efsys_mem_t
modifier|*
parameter_list|,
name|efx_mon_stat_value_t
modifier|*
parameter_list|)
function_decl|;
endif|#
directive|endif
comment|/* EFSYS_OPT_MON_STATS */
block|}
name|efx_mon_ops_t
typedef|;
typedef|typedef
struct|struct
name|efx_mon_s
block|{
name|efx_mon_type_t
name|em_type
decl_stmt|;
name|efx_mon_ops_t
modifier|*
name|em_emop
decl_stmt|;
block|}
name|efx_mon_t
typedef|;
typedef|typedef
struct|struct
name|efx_intr_ops_s
block|{
name|efx_rc_t
function_decl|(
modifier|*
name|eio_init
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_intr_type_t
parameter_list|,
name|efsys_mem_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|eio_enable
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|eio_disable
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|eio_disable_unlocked
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|eio_trigger
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|eio_status_line
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|boolean_t
modifier|*
parameter_list|,
name|uint32_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|eio_status_message
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|boolean_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|eio_fatal
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|eio_fini
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
block|}
name|efx_intr_ops_t
typedef|;
typedef|typedef
struct|struct
name|efx_intr_s
block|{
name|efx_intr_ops_t
modifier|*
name|ei_eiop
decl_stmt|;
name|efsys_mem_t
modifier|*
name|ei_esmp
decl_stmt|;
name|efx_intr_type_t
name|ei_type
decl_stmt|;
name|unsigned
name|int
name|ei_level
decl_stmt|;
block|}
name|efx_intr_t
typedef|;
typedef|typedef
struct|struct
name|efx_nic_ops_s
block|{
name|efx_rc_t
function_decl|(
modifier|*
name|eno_probe
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|eno_set_drv_limits
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_drv_limits_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|eno_reset
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|eno_init
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|eno_get_vi_pool
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|uint32_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|eno_get_bar_region
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_nic_region_t
parameter_list|,
name|uint32_t
modifier|*
parameter_list|,
name|size_t
modifier|*
parameter_list|)
function_decl|;
if|#
directive|if
name|EFSYS_OPT_DIAG
name|efx_rc_t
function_decl|(
modifier|*
name|eno_sram_test
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_sram_pattern_fn_t
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|eno_register_test
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
endif|#
directive|endif
comment|/* EFSYS_OPT_DIAG */
name|void
function_decl|(
modifier|*
name|eno_fini
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|eno_unprobe
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
block|}
name|efx_nic_ops_t
typedef|;
ifndef|#
directive|ifndef
name|EFX_TXQ_LIMIT_TARGET
define|#
directive|define
name|EFX_TXQ_LIMIT_TARGET
value|259
endif|#
directive|endif
ifndef|#
directive|ifndef
name|EFX_RXQ_LIMIT_TARGET
define|#
directive|define
name|EFX_RXQ_LIMIT_TARGET
value|512
endif|#
directive|endif
ifndef|#
directive|ifndef
name|EFX_TXQ_DC_SIZE
define|#
directive|define
name|EFX_TXQ_DC_SIZE
value|1
comment|/* 16 descriptors */
endif|#
directive|endif
ifndef|#
directive|ifndef
name|EFX_RXQ_DC_SIZE
define|#
directive|define
name|EFX_RXQ_DC_SIZE
value|3
comment|/* 64 descriptors */
endif|#
directive|endif
if|#
directive|if
name|EFSYS_OPT_FILTER
typedef|typedef
struct|struct
name|falconsiena_filter_spec_s
block|{
name|uint8_t
name|fsfs_type
decl_stmt|;
name|uint32_t
name|fsfs_flags
decl_stmt|;
name|uint32_t
name|fsfs_dmaq_id
decl_stmt|;
name|uint32_t
name|fsfs_dword
index|[
literal|3
index|]
decl_stmt|;
block|}
name|falconsiena_filter_spec_t
typedef|;
typedef|typedef
enum|enum
name|falconsiena_filter_type_e
block|{
name|EFX_FS_FILTER_RX_TCP_FULL
block|,
comment|/* TCP/IPv4 4-tuple {dIP,dTCP,sIP,sTCP} */
name|EFX_FS_FILTER_RX_TCP_WILD
block|,
comment|/* TCP/IPv4 dest    {dIP,dTCP,  -,   -} */
name|EFX_FS_FILTER_RX_UDP_FULL
block|,
comment|/* UDP/IPv4 4-tuple {dIP,dUDP,sIP,sUDP} */
name|EFX_FS_FILTER_RX_UDP_WILD
block|,
comment|/* UDP/IPv4 dest    {dIP,dUDP,  -,   -} */
if|#
directive|if
name|EFSYS_OPT_SIENA
name|EFX_FS_FILTER_RX_MAC_FULL
block|,
comment|/* Ethernet {dMAC,VLAN} */
name|EFX_FS_FILTER_RX_MAC_WILD
block|,
comment|/* Ethernet {dMAC,   -} */
name|EFX_FS_FILTER_TX_TCP_FULL
block|,
comment|/* TCP/IPv4 {dIP,dTCP,sIP,sTCP} */
name|EFX_FS_FILTER_TX_TCP_WILD
block|,
comment|/* TCP/IPv4 {  -,   -,sIP,sTCP} */
name|EFX_FS_FILTER_TX_UDP_FULL
block|,
comment|/* UDP/IPv4 {dIP,dTCP,sIP,sTCP} */
name|EFX_FS_FILTER_TX_UDP_WILD
block|,
comment|/* UDP/IPv4 source (host, port) */
name|EFX_FS_FILTER_TX_MAC_FULL
block|,
comment|/* Ethernet source (MAC address, VLAN ID) */
name|EFX_FS_FILTER_TX_MAC_WILD
block|,
comment|/* Ethernet source (MAC address) */
endif|#
directive|endif
comment|/* EFSYS_OPT_SIENA */
name|EFX_FS_FILTER_NTYPES
block|}
name|falconsiena_filter_type_t
typedef|;
typedef|typedef
enum|enum
name|falconsiena_filter_tbl_id_e
block|{
name|EFX_FS_FILTER_TBL_RX_IP
init|=
literal|0
block|,
name|EFX_FS_FILTER_TBL_RX_MAC
block|,
name|EFX_FS_FILTER_TBL_TX_IP
block|,
name|EFX_FS_FILTER_TBL_TX_MAC
block|,
name|EFX_FS_FILTER_NTBLS
block|}
name|falconsiena_filter_tbl_id_t
typedef|;
typedef|typedef
struct|struct
name|falconsiena_filter_tbl_s
block|{
name|int
name|fsft_size
decl_stmt|;
comment|/* number of entries */
name|int
name|fsft_used
decl_stmt|;
comment|/* active count */
name|uint32_t
modifier|*
name|fsft_bitmap
decl_stmt|;
comment|/* active bitmap */
name|falconsiena_filter_spec_t
modifier|*
name|fsft_spec
decl_stmt|;
comment|/* array of saved specs */
block|}
name|falconsiena_filter_tbl_t
typedef|;
typedef|typedef
struct|struct
name|falconsiena_filter_s
block|{
name|falconsiena_filter_tbl_t
name|fsf_tbl
index|[
name|EFX_FS_FILTER_NTBLS
index|]
decl_stmt|;
name|unsigned
name|int
name|fsf_depth
index|[
name|EFX_FS_FILTER_NTYPES
index|]
decl_stmt|;
block|}
name|falconsiena_filter_t
typedef|;
typedef|typedef
struct|struct
name|efx_filter_s
block|{
if|#
directive|if
name|EFSYS_OPT_FALCON
operator|||
name|EFSYS_OPT_SIENA
name|falconsiena_filter_t
modifier|*
name|ef_falconsiena_filter
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_FALCON || EFSYS_OPT_SIENA */
if|#
directive|if
name|EFSYS_OPT_HUNTINGTON
operator|||
name|EFSYS_OPT_MEDFORD
name|ef10_filter_table_t
modifier|*
name|ef_ef10_filter_table
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_HUNTINGTON || EFSYS_OPT_MEDFORD */
block|}
name|efx_filter_t
typedef|;
specifier|extern
name|void
name|falconsiena_filter_tbl_clear
parameter_list|(
name|__in
name|efx_nic_t
modifier|*
name|enp
parameter_list|,
name|__in
name|falconsiena_filter_tbl_id_t
name|tbl
parameter_list|)
function_decl|;
endif|#
directive|endif
comment|/* EFSYS_OPT_FILTER */
if|#
directive|if
name|EFSYS_OPT_MCDI
typedef|typedef
struct|struct
name|efx_mcdi_ops_s
block|{
name|efx_rc_t
function_decl|(
modifier|*
name|emco_init
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
specifier|const
name|efx_mcdi_transport_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|emco_request_copyin
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_mcdi_req_t
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|boolean_t
parameter_list|,
name|boolean_t
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|emco_request_copyout
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_mcdi_req_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|emco_poll_reboot
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|boolean_t
function_decl|(
modifier|*
name|emco_poll_response
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|emco_read_response
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|void
modifier|*
parameter_list|,
name|size_t
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|emco_fini
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|emco_feature_supported
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_mcdi_feature_id_t
parameter_list|,
name|boolean_t
modifier|*
parameter_list|)
function_decl|;
block|}
name|efx_mcdi_ops_t
typedef|;
typedef|typedef
struct|struct
name|efx_mcdi_s
block|{
name|efx_mcdi_ops_t
modifier|*
name|em_emcop
decl_stmt|;
specifier|const
name|efx_mcdi_transport_t
modifier|*
name|em_emtp
decl_stmt|;
name|efx_mcdi_iface_t
name|em_emip
decl_stmt|;
block|}
name|efx_mcdi_t
typedef|;
endif|#
directive|endif
comment|/* EFSYS_OPT_MCDI */
if|#
directive|if
name|EFSYS_OPT_NVRAM
typedef|typedef
struct|struct
name|efx_nvram_ops_s
block|{
if|#
directive|if
name|EFSYS_OPT_DIAG
name|efx_rc_t
function_decl|(
modifier|*
name|envo_test
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
endif|#
directive|endif
comment|/* EFSYS_OPT_DIAG */
name|efx_rc_t
function_decl|(
modifier|*
name|envo_size
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_nvram_type_t
parameter_list|,
name|size_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|envo_get_version
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_nvram_type_t
parameter_list|,
name|uint32_t
modifier|*
parameter_list|,
name|uint16_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|envo_rw_start
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_nvram_type_t
parameter_list|,
name|size_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|envo_read_chunk
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_nvram_type_t
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|caddr_t
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|envo_erase
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_nvram_type_t
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|envo_write_chunk
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_nvram_type_t
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|caddr_t
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|envo_rw_finish
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_nvram_type_t
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|envo_set_version
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|efx_nvram_type_t
parameter_list|,
name|uint16_t
modifier|*
parameter_list|)
function_decl|;
block|}
name|efx_nvram_ops_t
typedef|;
endif|#
directive|endif
comment|/* EFSYS_OPT_NVRAM */
if|#
directive|if
name|EFSYS_OPT_VPD
typedef|typedef
struct|struct
name|efx_vpd_ops_s
block|{
name|efx_rc_t
function_decl|(
modifier|*
name|evpdo_init
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|evpdo_size
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|size_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|evpdo_read
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|caddr_t
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|evpdo_verify
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|caddr_t
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|evpdo_reinit
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|caddr_t
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|evpdo_get
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|caddr_t
parameter_list|,
name|size_t
parameter_list|,
name|efx_vpd_value_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|evpdo_set
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|caddr_t
parameter_list|,
name|size_t
parameter_list|,
name|efx_vpd_value_t
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|evpdo_next
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|caddr_t
parameter_list|,
name|size_t
parameter_list|,
name|efx_vpd_value_t
modifier|*
parameter_list|,
name|unsigned
name|int
modifier|*
parameter_list|)
function_decl|;
name|efx_rc_t
function_decl|(
modifier|*
name|evpdo_write
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|,
name|caddr_t
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|evpdo_fini
function_decl|)
parameter_list|(
name|efx_nic_t
modifier|*
parameter_list|)
function_decl|;
block|}
name|efx_vpd_ops_t
typedef|;
endif|#
directive|endif
comment|/* EFSYS_OPT_VPD */
if|#
directive|if
name|EFSYS_OPT_VPD
operator|||
name|EFSYS_OPT_NVRAM
name|__checkReturn
name|efx_rc_t
name|efx_mcdi_nvram_partitions
argument_list|(
name|__in
name|efx_nic_t
operator|*
name|enp
argument_list|,
name|__out_bcount
argument_list|(
argument|size
argument_list|)
name|caddr_t
name|data
argument_list|,
name|__in
name|size_t
name|size
argument_list|,
name|__out
name|unsigned
name|int
operator|*
name|npartnp
argument_list|)
decl_stmt|;
name|__checkReturn
name|efx_rc_t
name|efx_mcdi_nvram_metadata
argument_list|(
name|__in
name|efx_nic_t
operator|*
name|enp
argument_list|,
name|__in
name|uint32_t
name|partn
argument_list|,
name|__out
name|uint32_t
operator|*
name|subtypep
argument_list|,
name|__out_ecount
argument_list|(
literal|4
argument_list|)
name|uint16_t
name|version
index|[
literal|4
index|]
argument_list|,
name|__out_bcount_opt
argument_list|(
argument|size
argument_list|)
name|char
operator|*
name|descp
argument_list|,
name|__in
name|size_t
name|size
argument_list|)
decl_stmt|;
name|__checkReturn
name|efx_rc_t
name|efx_mcdi_nvram_info
parameter_list|(
name|__in
name|efx_nic_t
modifier|*
name|enp
parameter_list|,
name|__in
name|uint32_t
name|partn
parameter_list|,
name|__out_opt
name|size_t
modifier|*
name|sizep
parameter_list|,
name|__out_opt
name|uint32_t
modifier|*
name|addressp
parameter_list|,
name|__out_opt
name|uint32_t
modifier|*
name|erase_sizep
parameter_list|,
name|__out_opt
name|uint32_t
modifier|*
name|write_sizep
parameter_list|)
function_decl|;
name|__checkReturn
name|efx_rc_t
name|efx_mcdi_nvram_update_start
parameter_list|(
name|__in
name|efx_nic_t
modifier|*
name|enp
parameter_list|,
name|__in
name|uint32_t
name|partn
parameter_list|)
function_decl|;
name|__checkReturn
name|efx_rc_t
name|efx_mcdi_nvram_read
argument_list|(
name|__in
name|efx_nic_t
operator|*
name|enp
argument_list|,
name|__in
name|uint32_t
name|partn
argument_list|,
name|__in
name|uint32_t
name|offset
argument_list|,
name|__out_bcount
argument_list|(
argument|size
argument_list|)
name|caddr_t
name|data
argument_list|,
name|__in
name|size_t
name|size
argument_list|)
decl_stmt|;
name|__checkReturn
name|efx_rc_t
name|efx_mcdi_nvram_erase
parameter_list|(
name|__in
name|efx_nic_t
modifier|*
name|enp
parameter_list|,
name|__in
name|uint32_t
name|partn
parameter_list|,
name|__in
name|uint32_t
name|offset
parameter_list|,
name|__in
name|size_t
name|size
parameter_list|)
function_decl|;
name|__checkReturn
name|efx_rc_t
name|efx_mcdi_nvram_write
argument_list|(
name|__in
name|efx_nic_t
operator|*
name|enp
argument_list|,
name|__in
name|uint32_t
name|partn
argument_list|,
name|__in
name|uint32_t
name|offset
argument_list|,
name|__out_bcount
argument_list|(
argument|size
argument_list|)
name|caddr_t
name|data
argument_list|,
name|__in
name|size_t
name|size
argument_list|)
decl_stmt|;
name|__checkReturn
name|efx_rc_t
name|efx_mcdi_nvram_update_finish
parameter_list|(
name|__in
name|efx_nic_t
modifier|*
name|enp
parameter_list|,
name|__in
name|uint32_t
name|partn
parameter_list|,
name|__in
name|boolean_t
name|reboot
parameter_list|)
function_decl|;
if|#
directive|if
name|EFSYS_OPT_DIAG
name|__checkReturn
name|efx_rc_t
name|efx_mcdi_nvram_test
parameter_list|(
name|__in
name|efx_nic_t
modifier|*
name|enp
parameter_list|,
name|__in
name|uint32_t
name|partn
parameter_list|)
function_decl|;
endif|#
directive|endif
comment|/* EFSYS_OPT_DIAG */
endif|#
directive|endif
comment|/* EFSYS_OPT_VPD || EFSYS_OPT_NVRAM */
typedef|typedef
struct|struct
name|efx_drv_cfg_s
block|{
name|uint32_t
name|edc_min_vi_count
decl_stmt|;
name|uint32_t
name|edc_max_vi_count
decl_stmt|;
name|uint32_t
name|edc_max_piobuf_count
decl_stmt|;
name|uint32_t
name|edc_pio_alloc_size
decl_stmt|;
block|}
name|efx_drv_cfg_t
typedef|;
struct|struct
name|efx_nic_s
block|{
name|uint32_t
name|en_magic
decl_stmt|;
name|efx_family_t
name|en_family
decl_stmt|;
name|uint32_t
name|en_features
decl_stmt|;
name|efsys_identifier_t
modifier|*
name|en_esip
decl_stmt|;
name|efsys_lock_t
modifier|*
name|en_eslp
decl_stmt|;
name|efsys_bar_t
modifier|*
name|en_esbp
decl_stmt|;
name|unsigned
name|int
name|en_mod_flags
decl_stmt|;
name|unsigned
name|int
name|en_reset_flags
decl_stmt|;
name|efx_nic_cfg_t
name|en_nic_cfg
decl_stmt|;
name|efx_drv_cfg_t
name|en_drv_cfg
decl_stmt|;
name|efx_port_t
name|en_port
decl_stmt|;
name|efx_mon_t
name|en_mon
decl_stmt|;
name|efx_intr_t
name|en_intr
decl_stmt|;
name|uint32_t
name|en_ev_qcount
decl_stmt|;
name|uint32_t
name|en_rx_qcount
decl_stmt|;
name|uint32_t
name|en_tx_qcount
decl_stmt|;
name|efx_nic_ops_t
modifier|*
name|en_enop
decl_stmt|;
name|efx_ev_ops_t
modifier|*
name|en_eevop
decl_stmt|;
name|efx_tx_ops_t
modifier|*
name|en_etxop
decl_stmt|;
name|efx_rx_ops_t
modifier|*
name|en_erxop
decl_stmt|;
if|#
directive|if
name|EFSYS_OPT_FILTER
name|efx_filter_t
name|en_filter
decl_stmt|;
name|efx_filter_ops_t
modifier|*
name|en_efop
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_FILTER */
if|#
directive|if
name|EFSYS_OPT_MCDI
name|efx_mcdi_t
name|en_mcdi
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_MCDI */
if|#
directive|if
name|EFSYS_OPT_NVRAM
name|efx_nvram_type_t
name|en_nvram_locked
decl_stmt|;
name|efx_nvram_ops_t
modifier|*
name|en_envop
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_NVRAM */
if|#
directive|if
name|EFSYS_OPT_VPD
name|efx_vpd_ops_t
modifier|*
name|en_evpdop
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_VPD */
if|#
directive|if
name|EFSYS_OPT_RX_SCALE
name|efx_rx_hash_support_t
name|en_hash_support
decl_stmt|;
name|efx_rx_scale_support_t
name|en_rss_support
decl_stmt|;
name|uint32_t
name|en_rss_context
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_RX_SCALE */
name|uint32_t
name|en_vport_id
decl_stmt|;
union|union
block|{
if|#
directive|if
name|EFSYS_OPT_FALCON
struct|struct
block|{
name|falcon_spi_dev_t
name|enu_fsd
index|[
name|FALCON_SPI_NTYPES
index|]
decl_stmt|;
name|falcon_i2c_t
name|enu_fip
decl_stmt|;
name|boolean_t
name|enu_i2c_locked
decl_stmt|;
if|#
directive|if
name|EFSYS_OPT_FALCON_NIC_CFG_OVERRIDE
specifier|const
name|uint8_t
modifier|*
name|enu_forced_cfg
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_FALCON_NIC_CFG_OVERRIDE */
name|uint8_t
name|enu_mon_devid
decl_stmt|;
if|#
directive|if
name|EFSYS_OPT_PCIE_TUNE
name|unsigned
name|int
name|enu_nlanes
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_PCIE_TUNE */
name|uint16_t
name|enu_board_rev
decl_stmt|;
name|boolean_t
name|enu_internal_sram
decl_stmt|;
name|uint8_t
name|enu_sram_num_bank
decl_stmt|;
name|uint8_t
name|enu_sram_bank_size
decl_stmt|;
block|}
name|falcon
struct|;
endif|#
directive|endif
comment|/* EFSYS_OPT_FALCON */
if|#
directive|if
name|EFSYS_OPT_SIENA
struct|struct
block|{
if|#
directive|if
name|EFSYS_OPT_NVRAM
operator|||
name|EFSYS_OPT_VPD
name|unsigned
name|int
name|enu_partn_mask
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_NVRAM || EFSYS_OPT_VPD */
if|#
directive|if
name|EFSYS_OPT_VPD
name|caddr_t
name|enu_svpd
decl_stmt|;
name|size_t
name|enu_svpd_length
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_VPD */
name|int
name|enu_unused
decl_stmt|;
block|}
name|siena
struct|;
endif|#
directive|endif
comment|/* EFSYS_OPT_SIENA */
name|int
name|enu_unused
decl_stmt|;
block|}
name|en_u
union|;
if|#
directive|if
operator|(
name|EFSYS_OPT_HUNTINGTON
operator|||
name|EFSYS_OPT_MEDFORD
operator|)
union|union
name|en_arch
block|{
struct|struct
block|{
name|int
name|ena_vi_base
decl_stmt|;
name|int
name|ena_vi_count
decl_stmt|;
name|int
name|ena_vi_shift
decl_stmt|;
if|#
directive|if
name|EFSYS_OPT_VPD
name|caddr_t
name|ena_svpd
decl_stmt|;
name|size_t
name|ena_svpd_length
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_VPD */
name|efx_piobuf_handle_t
name|ena_piobuf_handle
index|[
name|EF10_MAX_PIOBUF_NBUFS
index|]
decl_stmt|;
name|uint32_t
name|ena_piobuf_count
decl_stmt|;
name|uint32_t
name|ena_pio_alloc_map
index|[
name|EF10_MAX_PIOBUF_NBUFS
index|]
decl_stmt|;
name|uint32_t
name|ena_pio_write_vi_base
decl_stmt|;
comment|/* Memory BAR mapping regions */
name|uint32_t
name|ena_uc_mem_map_offset
decl_stmt|;
name|size_t
name|ena_uc_mem_map_size
decl_stmt|;
name|uint32_t
name|ena_wc_mem_map_offset
decl_stmt|;
name|size_t
name|ena_wc_mem_map_size
decl_stmt|;
block|}
name|ef10
struct|;
block|}
name|en_arch
union|;
endif|#
directive|endif
comment|/* (EFSYS_OPT_HUNTINGTON || EFSYS_OPT_MEDFORD) */
block|}
struct|;
define|#
directive|define
name|EFX_NIC_MAGIC
value|0x02121996
typedef|typedef
name|boolean_t
function_decl|(
modifier|*
name|efx_ev_handler_t
function_decl|)
parameter_list|(
name|efx_evq_t
modifier|*
parameter_list|,
name|efx_qword_t
modifier|*
parameter_list|,
specifier|const
name|efx_ev_callbacks_t
modifier|*
parameter_list|,
name|void
modifier|*
parameter_list|)
function_decl|;
typedef|typedef
struct|struct
name|efx_evq_rxq_state_s
block|{
name|unsigned
name|int
name|eers_rx_read_ptr
decl_stmt|;
name|unsigned
name|int
name|eers_rx_mask
decl_stmt|;
block|}
name|efx_evq_rxq_state_t
typedef|;
struct|struct
name|efx_evq_s
block|{
name|uint32_t
name|ee_magic
decl_stmt|;
name|efx_nic_t
modifier|*
name|ee_enp
decl_stmt|;
name|unsigned
name|int
name|ee_index
decl_stmt|;
name|unsigned
name|int
name|ee_mask
decl_stmt|;
name|efsys_mem_t
modifier|*
name|ee_esmp
decl_stmt|;
if|#
directive|if
name|EFSYS_OPT_QSTATS
name|uint32_t
name|ee_stat
index|[
name|EV_NQSTATS
index|]
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_QSTATS */
name|efx_ev_handler_t
name|ee_rx
decl_stmt|;
name|efx_ev_handler_t
name|ee_tx
decl_stmt|;
name|efx_ev_handler_t
name|ee_driver
decl_stmt|;
name|efx_ev_handler_t
name|ee_global
decl_stmt|;
name|efx_ev_handler_t
name|ee_drv_gen
decl_stmt|;
if|#
directive|if
name|EFSYS_OPT_MCDI
name|efx_ev_handler_t
name|ee_mcdi
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_MCDI */
name|efx_evq_rxq_state_t
name|ee_rxq_state
index|[
name|EFX_EV_RX_NLABELS
index|]
decl_stmt|;
block|}
struct|;
define|#
directive|define
name|EFX_EVQ_MAGIC
value|0x08081997
define|#
directive|define
name|EFX_EVQ_FALCON_TIMER_QUANTUM_NS
value|4968
comment|/* 621 cycles */
define|#
directive|define
name|EFX_EVQ_SIENA_TIMER_QUANTUM_NS
value|6144
comment|/* 768 cycles */
struct|struct
name|efx_rxq_s
block|{
name|uint32_t
name|er_magic
decl_stmt|;
name|efx_nic_t
modifier|*
name|er_enp
decl_stmt|;
name|efx_evq_t
modifier|*
name|er_eep
decl_stmt|;
name|unsigned
name|int
name|er_index
decl_stmt|;
name|unsigned
name|int
name|er_label
decl_stmt|;
name|unsigned
name|int
name|er_mask
decl_stmt|;
name|efsys_mem_t
modifier|*
name|er_esmp
decl_stmt|;
block|}
struct|;
define|#
directive|define
name|EFX_RXQ_MAGIC
value|0x15022005
struct|struct
name|efx_txq_s
block|{
name|uint32_t
name|et_magic
decl_stmt|;
name|efx_nic_t
modifier|*
name|et_enp
decl_stmt|;
name|unsigned
name|int
name|et_index
decl_stmt|;
name|unsigned
name|int
name|et_mask
decl_stmt|;
name|efsys_mem_t
modifier|*
name|et_esmp
decl_stmt|;
if|#
directive|if
name|EFSYS_OPT_HUNTINGTON
name|uint32_t
name|et_pio_bufnum
decl_stmt|;
name|uint32_t
name|et_pio_blknum
decl_stmt|;
name|uint32_t
name|et_pio_write_offset
decl_stmt|;
name|uint32_t
name|et_pio_offset
decl_stmt|;
name|size_t
name|et_pio_size
decl_stmt|;
endif|#
directive|endif
if|#
directive|if
name|EFSYS_OPT_QSTATS
name|uint32_t
name|et_stat
index|[
name|TX_NQSTATS
index|]
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_QSTATS */
block|}
struct|;
define|#
directive|define
name|EFX_TXQ_MAGIC
value|0x05092005
define|#
directive|define
name|EFX_MAC_ADDR_COPY
parameter_list|(
name|_dst
parameter_list|,
name|_src
parameter_list|)
define|\
value|do {								\ 		(_dst)[0] = (_src)[0];					\ 		(_dst)[1] = (_src)[1];					\ 		(_dst)[2] = (_src)[2];					\ 		(_dst)[3] = (_src)[3];					\ 		(_dst)[4] = (_src)[4];					\ 		(_dst)[5] = (_src)[5];					\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
define|#
directive|define
name|EFX_MAC_BROADCAST_ADDR_SET
parameter_list|(
name|_dst
parameter_list|)
define|\
value|do {								\ 		uint16_t *_d = (uint16_t *)(_dst);			\ 		_d[0] = 0xffff;						\ 		_d[1] = 0xffff;						\ 		_d[2] = 0xffff;						\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
if|#
directive|if
name|EFSYS_OPT_CHECK_REG
define|#
directive|define
name|EFX_CHECK_REG
parameter_list|(
name|_enp
parameter_list|,
name|_reg
parameter_list|)
define|\
value|do {								\ 		const char *name = #_reg;				\ 		char min = name[4];					\ 		char max = name[5];					\ 		char rev;						\ 									\ 		switch ((_enp)->en_family) {				\ 		case EFX_FAMILY_FALCON:					\ 			rev = 'B';					\ 			break;						\ 									\ 		case EFX_FAMILY_SIENA:					\ 			rev = 'C';					\ 			break;						\ 									\ 		case EFX_FAMILY_HUNTINGTON:				\ 			rev = 'D';					\ 			break;						\ 									\ 		case EFX_FAMILY_MEDFORD:				\ 			rev = 'E';					\ 			break;						\ 									\ 		default:						\ 			rev = '?';					\ 			break;						\ 		}							\ 									\ 		EFSYS_ASSERT3S(rev,>=, min);				\ 		EFSYS_ASSERT3S(rev,<=, max);				\ 									\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
else|#
directive|else
define|#
directive|define
name|EFX_CHECK_REG
parameter_list|(
name|_enp
parameter_list|,
name|_reg
parameter_list|)
value|do {					\ 	_NOTE(CONSTANTCONDITION)					\ 	} while(B_FALSE)
endif|#
directive|endif
define|#
directive|define
name|EFX_BAR_READD
parameter_list|(
name|_enp
parameter_list|,
name|_reg
parameter_list|,
name|_edp
parameter_list|,
name|_lock
parameter_list|)
define|\
value|do {								\ 		EFX_CHECK_REG((_enp), (_reg));				\ 		EFSYS_BAR_READD((_enp)->en_esbp, _reg ## _OFST,		\ 		    (_edp), (_lock));					\ 		EFSYS_PROBE3(efx_bar_readd, const char *, #_reg,	\ 		    uint32_t, _reg ## _OFST,				\ 		    uint32_t, (_edp)->ed_u32[0]);			\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
define|#
directive|define
name|EFX_BAR_WRITED
parameter_list|(
name|_enp
parameter_list|,
name|_reg
parameter_list|,
name|_edp
parameter_list|,
name|_lock
parameter_list|)
define|\
value|do {								\ 		EFX_CHECK_REG((_enp), (_reg));				\ 		EFSYS_PROBE3(efx_bar_writed, const char *, #_reg,	\ 		    uint32_t, _reg ## _OFST,				\ 		    uint32_t, (_edp)->ed_u32[0]);			\ 		EFSYS_BAR_WRITED((_enp)->en_esbp, _reg ## _OFST,	\ 		    (_edp), (_lock));					\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
define|#
directive|define
name|EFX_BAR_READQ
parameter_list|(
name|_enp
parameter_list|,
name|_reg
parameter_list|,
name|_eqp
parameter_list|)
define|\
value|do {								\ 		EFX_CHECK_REG((_enp), (_reg));				\ 		EFSYS_BAR_READQ((_enp)->en_esbp, _reg ## _OFST,		\ 		    (_eqp));						\ 		EFSYS_PROBE4(efx_bar_readq, const char *, #_reg,	\ 		    uint32_t, _reg ## _OFST,				\ 		    uint32_t, (_eqp)->eq_u32[1],			\ 		    uint32_t, (_eqp)->eq_u32[0]);			\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
define|#
directive|define
name|EFX_BAR_WRITEQ
parameter_list|(
name|_enp
parameter_list|,
name|_reg
parameter_list|,
name|_eqp
parameter_list|)
define|\
value|do {								\ 		EFX_CHECK_REG((_enp), (_reg));				\ 		EFSYS_PROBE4(efx_bar_writeq, const char *, #_reg,	\ 		    uint32_t, _reg ## _OFST,				\ 		    uint32_t, (_eqp)->eq_u32[1],			\ 		    uint32_t, (_eqp)->eq_u32[0]);			\ 		EFSYS_BAR_WRITEQ((_enp)->en_esbp, _reg ## _OFST,	\ 		    (_eqp));						\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
define|#
directive|define
name|EFX_BAR_READO
parameter_list|(
name|_enp
parameter_list|,
name|_reg
parameter_list|,
name|_eop
parameter_list|)
define|\
value|do {								\ 		EFX_CHECK_REG((_enp), (_reg));				\ 		EFSYS_BAR_READO((_enp)->en_esbp, _reg ## _OFST,		\ 		    (_eop), B_TRUE);					\ 		EFSYS_PROBE6(efx_bar_reado, const char *, #_reg,	\ 		    uint32_t, _reg ## _OFST,				\ 		    uint32_t, (_eop)->eo_u32[3],			\ 		    uint32_t, (_eop)->eo_u32[2],			\ 		    uint32_t, (_eop)->eo_u32[1],			\ 		    uint32_t, (_eop)->eo_u32[0]);			\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
define|#
directive|define
name|EFX_BAR_WRITEO
parameter_list|(
name|_enp
parameter_list|,
name|_reg
parameter_list|,
name|_eop
parameter_list|)
define|\
value|do {								\ 		EFX_CHECK_REG((_enp), (_reg));				\ 		EFSYS_PROBE6(efx_bar_writeo, const char *, #_reg,	\ 		    uint32_t, _reg ## _OFST,				\ 		    uint32_t, (_eop)->eo_u32[3],			\ 		    uint32_t, (_eop)->eo_u32[2],			\ 		    uint32_t, (_eop)->eo_u32[1],			\ 		    uint32_t, (_eop)->eo_u32[0]);			\ 		EFSYS_BAR_WRITEO((_enp)->en_esbp, _reg ## _OFST,	\ 		    (_eop), B_TRUE);					\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
define|#
directive|define
name|EFX_BAR_TBL_READD
parameter_list|(
name|_enp
parameter_list|,
name|_reg
parameter_list|,
name|_index
parameter_list|,
name|_edp
parameter_list|,
name|_lock
parameter_list|)
define|\
value|do {								\ 		EFX_CHECK_REG((_enp), (_reg));				\ 		EFSYS_BAR_READD((_enp)->en_esbp,			\ 		    (_reg ## _OFST + ((_index) * _reg ## _STEP)),	\ 		    (_edp), (_lock));					\ 		EFSYS_PROBE4(efx_bar_tbl_readd, const char *, #_reg,	\ 		    uint32_t, (_index),					\ 		    uint32_t, _reg ## _OFST,				\ 		    uint32_t, (_edp)->ed_u32[0]);			\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
define|#
directive|define
name|EFX_BAR_TBL_WRITED
parameter_list|(
name|_enp
parameter_list|,
name|_reg
parameter_list|,
name|_index
parameter_list|,
name|_edp
parameter_list|,
name|_lock
parameter_list|)
define|\
value|do {								\ 		EFX_CHECK_REG((_enp), (_reg));				\ 		EFSYS_PROBE4(efx_bar_tbl_writed, const char *, #_reg,	\ 		    uint32_t, (_index),					\ 		    uint32_t, _reg ## _OFST,				\ 		    uint32_t, (_edp)->ed_u32[0]);			\ 		EFSYS_BAR_WRITED((_enp)->en_esbp,			\ 		    (_reg ## _OFST + ((_index) * _reg ## _STEP)),	\ 		    (_edp), (_lock));					\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
define|#
directive|define
name|EFX_BAR_TBL_WRITED2
parameter_list|(
name|_enp
parameter_list|,
name|_reg
parameter_list|,
name|_index
parameter_list|,
name|_edp
parameter_list|,
name|_lock
parameter_list|)
define|\
value|do {								\ 		EFX_CHECK_REG((_enp), (_reg));				\ 		EFSYS_PROBE4(efx_bar_tbl_writed, const char *, #_reg,	\ 		    uint32_t, (_index),					\ 		    uint32_t, _reg ## _OFST,				\ 		    uint32_t, (_edp)->ed_u32[0]);			\ 		EFSYS_BAR_WRITED((_enp)->en_esbp,			\ 		    (_reg ## _OFST +					\ 		    (2 * sizeof (efx_dword_t)) + 			\ 		    ((_index) * _reg ## _STEP)),			\ 		    (_edp), (_lock));					\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
define|#
directive|define
name|EFX_BAR_TBL_WRITED3
parameter_list|(
name|_enp
parameter_list|,
name|_reg
parameter_list|,
name|_index
parameter_list|,
name|_edp
parameter_list|,
name|_lock
parameter_list|)
define|\
value|do {								\ 		EFX_CHECK_REG((_enp), (_reg));				\ 		EFSYS_PROBE4(efx_bar_tbl_writed, const char *, #_reg,	\ 		    uint32_t, (_index),					\ 		    uint32_t, _reg ## _OFST,				\ 		    uint32_t, (_edp)->ed_u32[0]);			\ 		EFSYS_BAR_WRITED((_enp)->en_esbp,			\ 		    (_reg ## _OFST +					\ 		    (3 * sizeof (efx_dword_t)) + 			\ 		    ((_index) * _reg ## _STEP)),			\ 		    (_edp), (_lock));					\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
define|#
directive|define
name|EFX_BAR_TBL_READQ
parameter_list|(
name|_enp
parameter_list|,
name|_reg
parameter_list|,
name|_index
parameter_list|,
name|_eqp
parameter_list|)
define|\
value|do {								\ 		EFX_CHECK_REG((_enp), (_reg));				\ 		EFSYS_BAR_READQ((_enp)->en_esbp,			\ 		    (_reg ## _OFST + ((_index) * _reg ## _STEP)),	\ 		    (_eqp));						\ 		EFSYS_PROBE5(efx_bar_tbl_readq, const char *, #_reg,	\ 		    uint32_t, (_index),					\ 		    uint32_t, _reg ## _OFST,				\ 		    uint32_t, (_eqp)->eq_u32[1],			\ 		    uint32_t, (_eqp)->eq_u32[0]);			\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
define|#
directive|define
name|EFX_BAR_TBL_WRITEQ
parameter_list|(
name|_enp
parameter_list|,
name|_reg
parameter_list|,
name|_index
parameter_list|,
name|_eqp
parameter_list|)
define|\
value|do {								\ 		EFX_CHECK_REG((_enp), (_reg));				\ 		EFSYS_PROBE5(efx_bar_tbl_writeq, const char *, #_reg,	\ 		    uint32_t, (_index),					\ 		    uint32_t, _reg ## _OFST,				\ 		    uint32_t, (_eqp)->eq_u32[1],			\ 		    uint32_t, (_eqp)->eq_u32[0]);			\ 		EFSYS_BAR_WRITEQ((_enp)->en_esbp,			\ 		    (_reg ## _OFST + ((_index) * _reg ## _STEP)),	\ 		    (_eqp));						\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
define|#
directive|define
name|EFX_BAR_TBL_READO
parameter_list|(
name|_enp
parameter_list|,
name|_reg
parameter_list|,
name|_index
parameter_list|,
name|_eop
parameter_list|,
name|_lock
parameter_list|)
define|\
value|do {								\ 		EFX_CHECK_REG((_enp), (_reg));				\ 		EFSYS_BAR_READO((_enp)->en_esbp,			\ 		    (_reg ## _OFST + ((_index) * _reg ## _STEP)),	\ 		    (_eop), (_lock));					\ 		EFSYS_PROBE7(efx_bar_tbl_reado, const char *, #_reg,	\ 		    uint32_t, (_index),					\ 		    uint32_t, _reg ## _OFST,				\ 		    uint32_t, (_eop)->eo_u32[3],			\ 		    uint32_t, (_eop)->eo_u32[2],			\ 		    uint32_t, (_eop)->eo_u32[1],			\ 		    uint32_t, (_eop)->eo_u32[0]);			\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
define|#
directive|define
name|EFX_BAR_TBL_WRITEO
parameter_list|(
name|_enp
parameter_list|,
name|_reg
parameter_list|,
name|_index
parameter_list|,
name|_eop
parameter_list|,
name|_lock
parameter_list|)
define|\
value|do {								\ 		EFX_CHECK_REG((_enp), (_reg));				\ 		EFSYS_PROBE7(efx_bar_tbl_writeo, const char *, #_reg,	\ 		    uint32_t, (_index),					\ 		    uint32_t, _reg ## _OFST,				\ 		    uint32_t, (_eop)->eo_u32[3],			\ 		    uint32_t, (_eop)->eo_u32[2],			\ 		    uint32_t, (_eop)->eo_u32[1],			\ 		    uint32_t, (_eop)->eo_u32[0]);			\ 		EFSYS_BAR_WRITEO((_enp)->en_esbp,			\ 		    (_reg ## _OFST + ((_index) * _reg ## _STEP)),	\ 		    (_eop), (_lock));					\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
comment|/*  * Allow drivers to perform optimised 128-bit doorbell writes.  * The DMA descriptor pointers (RX_DESC_UPD and TX_DESC_UPD) are  * special-cased in the BIU on the Falcon/Siena and EF10 architectures to avoid  * the need for locking in the host, and are the only ones known to be safe to  * use 128-bites write with.  */
define|#
directive|define
name|EFX_BAR_TBL_DOORBELL_WRITEO
parameter_list|(
name|_enp
parameter_list|,
name|_reg
parameter_list|,
name|_index
parameter_list|,
name|_eop
parameter_list|)
define|\
value|do {								\ 		EFX_CHECK_REG((_enp), (_reg));				\ 		EFSYS_PROBE7(efx_bar_tbl_doorbell_writeo,		\ 		    const char *,					\ 		    #_reg,						\ 		    uint32_t, (_index),					\ 		    uint32_t, _reg ## _OFST,				\ 		    uint32_t, (_eop)->eo_u32[3],			\ 		    uint32_t, (_eop)->eo_u32[2],			\ 		    uint32_t, (_eop)->eo_u32[1],			\ 		    uint32_t, (_eop)->eo_u32[0]);			\ 		EFSYS_BAR_DOORBELL_WRITEO((_enp)->en_esbp,		\ 		    (_reg ## _OFST + ((_index) * _reg ## _STEP)),	\ 		    (_eop));						\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
define|#
directive|define
name|EFX_DMA_SYNC_QUEUE_FOR_DEVICE
parameter_list|(
name|_esmp
parameter_list|,
name|_entries
parameter_list|,
name|_wptr
parameter_list|,
name|_owptr
parameter_list|)
define|\
value|do {								\ 		unsigned int _new = (_wptr);				\ 		unsigned int _old = (_owptr);				\ 									\ 		if ((_new)>= (_old))					\ 			EFSYS_DMA_SYNC_FOR_DEVICE((_esmp),		\ 			    (_old) * sizeof (efx_desc_t),		\ 			    ((_new) - (_old)) * sizeof (efx_desc_t));	\ 		else							\
comment|/*						\ 			 * It is cheaper to sync entire map than sync	\ 			 * two parts especially when offset/size are	\ 			 * ignored and entire map is synced in any case.\ 			 */
value|\ 			EFSYS_DMA_SYNC_FOR_DEVICE((_esmp),		\ 			    0,						\ 			    (_entries) * sizeof (efx_desc_t));		\ 	_NOTE(CONSTANTCONDITION)					\ 	} while (B_FALSE)
specifier|extern
name|__checkReturn
name|efx_rc_t
name|efx_nic_biu_test
parameter_list|(
name|__in
name|efx_nic_t
modifier|*
name|enp
parameter_list|)
function_decl|;
specifier|extern
name|__checkReturn
name|efx_rc_t
name|efx_mac_select
parameter_list|(
name|__in
name|efx_nic_t
modifier|*
name|enp
parameter_list|)
function_decl|;
specifier|extern
name|void
name|efx_mac_multicast_hash_compute
argument_list|(
name|__in_ecount
argument_list|(
literal|6
argument|*count
argument_list|)
name|uint8_t
specifier|const
operator|*
name|addrs
argument_list|,
name|__in
name|int
name|count
argument_list|,
name|__out
name|efx_oword_t
operator|*
name|hash_low
argument_list|,
name|__out
name|efx_oword_t
operator|*
name|hash_high
argument_list|)
decl_stmt|;
specifier|extern
name|__checkReturn
name|efx_rc_t
name|efx_phy_probe
parameter_list|(
name|__in
name|efx_nic_t
modifier|*
name|enp
parameter_list|)
function_decl|;
specifier|extern
name|void
name|efx_phy_unprobe
parameter_list|(
name|__in
name|efx_nic_t
modifier|*
name|enp
parameter_list|)
function_decl|;
if|#
directive|if
name|EFSYS_OPT_VPD
comment|/* VPD utility functions */
specifier|extern
name|__checkReturn
name|efx_rc_t
name|efx_vpd_hunk_length
argument_list|(
name|__in_bcount
argument_list|(
argument|size
argument_list|)
name|caddr_t
name|data
argument_list|,
name|__in
name|size_t
name|size
argument_list|,
name|__out
name|size_t
operator|*
name|lengthp
argument_list|)
decl_stmt|;
specifier|extern
name|__checkReturn
name|efx_rc_t
name|efx_vpd_hunk_verify
argument_list|(
name|__in_bcount
argument_list|(
argument|size
argument_list|)
name|caddr_t
name|data
argument_list|,
name|__in
name|size_t
name|size
argument_list|,
name|__out_opt
name|boolean_t
operator|*
name|cksummedp
argument_list|)
decl_stmt|;
specifier|extern
name|__checkReturn
name|efx_rc_t
name|efx_vpd_hunk_reinit
argument_list|(
name|__in_bcount
argument_list|(
argument|size
argument_list|)
name|caddr_t
name|data
argument_list|,
name|__in
name|size_t
name|size
argument_list|,
name|__in
name|boolean_t
name|wantpid
argument_list|)
decl_stmt|;
specifier|extern
name|__checkReturn
name|efx_rc_t
name|efx_vpd_hunk_get
argument_list|(
name|__in_bcount
argument_list|(
argument|size
argument_list|)
name|caddr_t
name|data
argument_list|,
name|__in
name|size_t
name|size
argument_list|,
name|__in
name|efx_vpd_tag_t
name|tag
argument_list|,
name|__in
name|efx_vpd_keyword_t
name|keyword
argument_list|,
name|__out
name|unsigned
name|int
operator|*
name|payloadp
argument_list|,
name|__out
name|uint8_t
operator|*
name|paylenp
argument_list|)
decl_stmt|;
specifier|extern
name|__checkReturn
name|efx_rc_t
name|efx_vpd_hunk_next
argument_list|(
name|__in_bcount
argument_list|(
argument|size
argument_list|)
name|caddr_t
name|data
argument_list|,
name|__in
name|size_t
name|size
argument_list|,
name|__out
name|efx_vpd_tag_t
operator|*
name|tagp
argument_list|,
name|__out
name|efx_vpd_keyword_t
operator|*
name|keyword
argument_list|,
name|__out_bcount_opt
argument_list|(
argument|*paylenp
argument_list|)
name|unsigned
name|int
operator|*
name|payloadp
argument_list|,
name|__out_opt
name|uint8_t
operator|*
name|paylenp
argument_list|,
name|__inout
name|unsigned
name|int
operator|*
name|contp
argument_list|)
decl_stmt|;
specifier|extern
name|__checkReturn
name|efx_rc_t
name|efx_vpd_hunk_set
argument_list|(
name|__in_bcount
argument_list|(
argument|size
argument_list|)
name|caddr_t
name|data
argument_list|,
name|__in
name|size_t
name|size
argument_list|,
name|__in
name|efx_vpd_value_t
operator|*
name|evvp
argument_list|)
decl_stmt|;
endif|#
directive|endif
comment|/* EFSYS_OPT_VPD */
if|#
directive|if
name|EFSYS_OPT_DIAG
specifier|extern
name|efx_sram_pattern_fn_t
name|__efx_sram_pattern_fns
index|[]
decl_stmt|;
typedef|typedef
struct|struct
name|efx_register_set_s
block|{
name|unsigned
name|int
name|address
decl_stmt|;
name|unsigned
name|int
name|step
decl_stmt|;
name|unsigned
name|int
name|rows
decl_stmt|;
name|efx_oword_t
name|mask
decl_stmt|;
block|}
name|efx_register_set_t
typedef|;
specifier|extern
name|__checkReturn
name|efx_rc_t
name|efx_nic_test_registers
parameter_list|(
name|__in
name|efx_nic_t
modifier|*
name|enp
parameter_list|,
name|__in
name|efx_register_set_t
modifier|*
name|rsp
parameter_list|,
name|__in
name|size_t
name|count
parameter_list|)
function_decl|;
specifier|extern
name|__checkReturn
name|efx_rc_t
name|efx_nic_test_tables
parameter_list|(
name|__in
name|efx_nic_t
modifier|*
name|enp
parameter_list|,
name|__in
name|efx_register_set_t
modifier|*
name|rsp
parameter_list|,
name|__in
name|efx_pattern_type_t
name|pattern
parameter_list|,
name|__in
name|size_t
name|count
parameter_list|)
function_decl|;
endif|#
directive|endif
comment|/* EFSYS_OPT_DIAG */
if|#
directive|if
name|EFSYS_OPT_MCDI
specifier|extern
name|__checkReturn
name|efx_rc_t
name|efx_mcdi_set_workaround
parameter_list|(
name|__in
name|efx_nic_t
modifier|*
name|enp
parameter_list|,
name|__in
name|uint32_t
name|type
parameter_list|,
name|__in
name|boolean_t
name|enabled
parameter_list|,
name|__out_opt
name|uint32_t
modifier|*
name|flagsp
parameter_list|)
function_decl|;
specifier|extern
name|__checkReturn
name|efx_rc_t
name|efx_mcdi_get_workarounds
parameter_list|(
name|__in
name|efx_nic_t
modifier|*
name|enp
parameter_list|,
name|__out_opt
name|uint32_t
modifier|*
name|implementedp
parameter_list|,
name|__out_opt
name|uint32_t
modifier|*
name|enabledp
parameter_list|)
function_decl|;
endif|#
directive|endif
comment|/* EFSYS_OPT_MCDI */
ifdef|#
directive|ifdef
name|__cplusplus
block|}
end_extern

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* _SYS_EFX_IMPL_H */
end_comment

end_unit

