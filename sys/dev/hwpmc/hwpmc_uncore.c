begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2010 Fabien Thomas  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  */
end_comment

begin_comment
comment|/*  * Intel Uncore PMCs.  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<sys/bus.h>
end_include

begin_include
include|#
directive|include
file|<sys/pmc.h>
end_include

begin_include
include|#
directive|include
file|<sys/pmckern.h>
end_include

begin_include
include|#
directive|include
file|<sys/systm.h>
end_include

begin_include
include|#
directive|include
file|<machine/intr_machdep.h>
end_include

begin_include
include|#
directive|include
file|<x86/apicvar.h>
end_include

begin_include
include|#
directive|include
file|<machine/cpu.h>
end_include

begin_include
include|#
directive|include
file|<machine/cpufunc.h>
end_include

begin_include
include|#
directive|include
file|<machine/specialreg.h>
end_include

begin_define
define|#
directive|define
name|UCF_PMC_CAPS
define|\
value|(PMC_CAP_READ | PMC_CAP_WRITE)
end_define

begin_define
define|#
directive|define
name|UCP_PMC_CAPS
define|\
value|(PMC_CAP_EDGE | PMC_CAP_THRESHOLD | PMC_CAP_READ | PMC_CAP_WRITE | \     PMC_CAP_INVERT | PMC_CAP_QUALIFIER | PMC_CAP_PRECISE)
end_define

begin_define
define|#
directive|define
name|SELECTSEL
parameter_list|(
name|x
parameter_list|)
define|\
value|(((x) == PMC_CPU_INTEL_SANDYBRIDGE || (x) == PMC_CPU_INTEL_HASWELL) ? \ 	UCP_CB0_EVSEL0 : UCP_EVSEL0)
end_define

begin_define
define|#
directive|define
name|SELECTOFF
parameter_list|(
name|x
parameter_list|)
define|\
value|(((x) == PMC_CPU_INTEL_SANDYBRIDGE || (x) == PMC_CPU_INTEL_HASWELL) ? \ 	UCF_OFFSET_SB : UCF_OFFSET)
end_define

begin_decl_stmt
specifier|static
name|enum
name|pmc_cputype
name|uncore_cputype
decl_stmt|;
end_decl_stmt

begin_struct
struct|struct
name|uncore_cpu
block|{
specifier|volatile
name|uint32_t
name|pc_resync
decl_stmt|;
specifier|volatile
name|uint32_t
name|pc_ucfctrl
decl_stmt|;
comment|/* Fixed function control. */
specifier|volatile
name|uint64_t
name|pc_globalctrl
decl_stmt|;
comment|/* Global control register. */
name|struct
name|pmc_hw
name|pc_uncorepmcs
index|[]
decl_stmt|;
block|}
struct|;
end_struct

begin_decl_stmt
specifier|static
name|struct
name|uncore_cpu
modifier|*
modifier|*
name|uncore_pcpu
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|uint64_t
name|uncore_pmcmask
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|uncore_ucf_ri
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* relative index of fixed counters */
end_comment

begin_decl_stmt
specifier|static
name|int
name|uncore_ucf_width
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|uncore_ucf_npmc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|uncore_ucp_width
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|uncore_ucp_npmc
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|int
name|uncore_pcpu_noop
parameter_list|(
name|struct
name|pmc_mdep
modifier|*
name|md
parameter_list|,
name|int
name|cpu
parameter_list|)
block|{
operator|(
name|void
operator|)
name|md
expr_stmt|;
operator|(
name|void
operator|)
name|cpu
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|uncore_pcpu_init
parameter_list|(
name|struct
name|pmc_mdep
modifier|*
name|md
parameter_list|,
name|int
name|cpu
parameter_list|)
block|{
name|struct
name|pmc_cpu
modifier|*
name|pc
decl_stmt|;
name|struct
name|uncore_cpu
modifier|*
name|cc
decl_stmt|;
name|struct
name|pmc_hw
modifier|*
name|phw
decl_stmt|;
name|int
name|uncore_ri
decl_stmt|,
name|n
decl_stmt|,
name|npmc
decl_stmt|;
name|KASSERT
argument_list|(
name|cpu
operator|>=
literal|0
operator|&&
name|cpu
operator|<
name|pmc_cpu_max
argument_list|()
argument_list|,
operator|(
literal|"[ucf,%d] insane cpu number %d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|INI
argument_list|,
literal|1
argument_list|,
literal|"uncore-init cpu=%d"
argument_list|,
name|cpu
argument_list|)
expr_stmt|;
name|uncore_ri
operator|=
name|md
operator|->
name|pmd_classdep
index|[
name|PMC_MDEP_CLASS_INDEX_UCP
index|]
operator|.
name|pcd_ri
expr_stmt|;
name|npmc
operator|=
name|md
operator|->
name|pmd_classdep
index|[
name|PMC_MDEP_CLASS_INDEX_UCP
index|]
operator|.
name|pcd_num
expr_stmt|;
name|npmc
operator|+=
name|md
operator|->
name|pmd_classdep
index|[
name|PMC_MDEP_CLASS_INDEX_UCF
index|]
operator|.
name|pcd_num
expr_stmt|;
name|cc
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
expr|struct
name|uncore_cpu
argument_list|)
operator|+
name|npmc
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|pmc_hw
argument_list|)
argument_list|,
name|M_PMC
argument_list|,
name|M_WAITOK
operator||
name|M_ZERO
argument_list|)
expr_stmt|;
name|uncore_pcpu
index|[
name|cpu
index|]
operator|=
name|cc
expr_stmt|;
name|pc
operator|=
name|pmc_pcpu
index|[
name|cpu
index|]
expr_stmt|;
name|KASSERT
argument_list|(
name|pc
operator|!=
name|NULL
operator|&&
name|cc
operator|!=
name|NULL
argument_list|,
operator|(
literal|"[uncore,%d] NULL per-cpu structures cpu=%d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
for|for
control|(
name|n
operator|=
literal|0
operator|,
name|phw
operator|=
name|cc
operator|->
name|pc_uncorepmcs
init|;
name|n
operator|<
name|npmc
condition|;
name|n
operator|++
operator|,
name|phw
operator|++
control|)
block|{
name|phw
operator|->
name|phw_state
operator|=
name|PMC_PHW_FLAG_IS_ENABLED
operator||
name|PMC_PHW_CPU_TO_STATE
argument_list|(
name|cpu
argument_list|)
operator||
name|PMC_PHW_INDEX_TO_STATE
argument_list|(
name|n
operator|+
name|uncore_ri
argument_list|)
expr_stmt|;
name|phw
operator|->
name|phw_pmc
operator|=
name|NULL
expr_stmt|;
name|pc
operator|->
name|pc_hwpmcs
index|[
name|n
operator|+
name|uncore_ri
index|]
operator|=
name|phw
expr_stmt|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|uncore_pcpu_fini
parameter_list|(
name|struct
name|pmc_mdep
modifier|*
name|md
parameter_list|,
name|int
name|cpu
parameter_list|)
block|{
name|int
name|uncore_ri
decl_stmt|,
name|n
decl_stmt|,
name|npmc
decl_stmt|;
name|struct
name|pmc_cpu
modifier|*
name|pc
decl_stmt|;
name|struct
name|uncore_cpu
modifier|*
name|cc
decl_stmt|;
name|KASSERT
argument_list|(
name|cpu
operator|>=
literal|0
operator|&&
name|cpu
operator|<
name|pmc_cpu_max
argument_list|()
argument_list|,
operator|(
literal|"[uncore,%d] insane cpu number (%d)"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|INI
argument_list|,
literal|1
argument_list|,
literal|"uncore-pcpu-fini cpu=%d"
argument_list|,
name|cpu
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|cc
operator|=
name|uncore_pcpu
index|[
name|cpu
index|]
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|uncore_pcpu
index|[
name|cpu
index|]
operator|=
name|NULL
expr_stmt|;
name|pc
operator|=
name|pmc_pcpu
index|[
name|cpu
index|]
expr_stmt|;
name|KASSERT
argument_list|(
name|pc
operator|!=
name|NULL
argument_list|,
operator|(
literal|"[uncore,%d] NULL per-cpu %d state"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|npmc
operator|=
name|md
operator|->
name|pmd_classdep
index|[
name|PMC_MDEP_CLASS_INDEX_UCP
index|]
operator|.
name|pcd_num
expr_stmt|;
name|uncore_ri
operator|=
name|md
operator|->
name|pmd_classdep
index|[
name|PMC_MDEP_CLASS_INDEX_UCP
index|]
operator|.
name|pcd_ri
expr_stmt|;
for|for
control|(
name|n
operator|=
literal|0
init|;
name|n
operator|<
name|npmc
condition|;
name|n
operator|++
control|)
name|wrmsr
argument_list|(
name|SELECTSEL
argument_list|(
name|uncore_cputype
argument_list|)
operator|+
name|n
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|wrmsr
argument_list|(
name|UCF_CTRL
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|npmc
operator|+=
name|md
operator|->
name|pmd_classdep
index|[
name|PMC_MDEP_CLASS_INDEX_UCF
index|]
operator|.
name|pcd_num
expr_stmt|;
for|for
control|(
name|n
operator|=
literal|0
init|;
name|n
operator|<
name|npmc
condition|;
name|n
operator|++
control|)
name|pc
operator|->
name|pc_hwpmcs
index|[
name|n
operator|+
name|uncore_ri
index|]
operator|=
name|NULL
expr_stmt|;
name|free
argument_list|(
name|cc
argument_list|,
name|M_PMC
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Fixed function counters.  */
end_comment

begin_function
specifier|static
name|pmc_value_t
name|ucf_perfctr_value_to_reload_count
parameter_list|(
name|pmc_value_t
name|v
parameter_list|)
block|{
name|v
operator|&=
operator|(
literal|1ULL
operator|<<
name|uncore_ucf_width
operator|)
operator|-
literal|1
expr_stmt|;
return|return
operator|(
literal|1ULL
operator|<<
name|uncore_ucf_width
operator|)
operator|-
name|v
return|;
block|}
end_function

begin_function
specifier|static
name|pmc_value_t
name|ucf_reload_count_to_perfctr_value
parameter_list|(
name|pmc_value_t
name|rlc
parameter_list|)
block|{
return|return
operator|(
literal|1ULL
operator|<<
name|uncore_ucf_width
operator|)
operator|-
name|rlc
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucf_allocate_pmc
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|,
name|struct
name|pmc
modifier|*
name|pm
parameter_list|,
specifier|const
name|struct
name|pmc_op_pmcallocate
modifier|*
name|a
parameter_list|)
block|{
name|enum
name|pmc_event
name|ev
decl_stmt|;
name|uint32_t
name|caps
decl_stmt|,
name|flags
decl_stmt|;
name|KASSERT
argument_list|(
name|cpu
operator|>=
literal|0
operator|&&
name|cpu
operator|<
name|pmc_cpu_max
argument_list|()
argument_list|,
operator|(
literal|"[uncore,%d] illegal CPU %d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|ALL
argument_list|,
literal|1
argument_list|,
literal|"ucf-allocate ri=%d reqcaps=0x%x"
argument_list|,
name|ri
argument_list|,
name|pm
operator|->
name|pm_caps
argument_list|)
expr_stmt|;
if|if
condition|(
name|ri
operator|<
literal|0
operator|||
name|ri
operator|>
name|uncore_ucf_npmc
condition|)
return|return
operator|(
name|EINVAL
operator|)
return|;
name|caps
operator|=
name|a
operator|->
name|pm_caps
expr_stmt|;
if|if
condition|(
name|a
operator|->
name|pm_class
operator|!=
name|PMC_CLASS_UCF
operator|||
operator|(
name|caps
operator|&
name|UCF_PMC_CAPS
operator|)
operator|!=
name|caps
condition|)
return|return
operator|(
name|EINVAL
operator|)
return|;
name|ev
operator|=
name|pm
operator|->
name|pm_event
expr_stmt|;
if|if
condition|(
name|ev
operator|<
name|PMC_EV_UCF_FIRST
operator|||
name|ev
operator|>
name|PMC_EV_UCF_LAST
condition|)
return|return
operator|(
name|EINVAL
operator|)
return|;
name|flags
operator|=
name|UCF_EN
expr_stmt|;
name|pm
operator|->
name|pm_md
operator|.
name|pm_ucf
operator|.
name|pm_ucf_ctrl
operator|=
operator|(
name|flags
operator|<<
operator|(
name|ri
operator|*
literal|4
operator|)
operator|)
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|ALL
argument_list|,
literal|2
argument_list|,
literal|"ucf-allocate config=0x%jx"
argument_list|,
operator|(
name|uintmax_t
operator|)
name|pm
operator|->
name|pm_md
operator|.
name|pm_ucf
operator|.
name|pm_ucf_ctrl
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucf_config_pmc
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|,
name|struct
name|pmc
modifier|*
name|pm
parameter_list|)
block|{
name|KASSERT
argument_list|(
name|cpu
operator|>=
literal|0
operator|&&
name|cpu
operator|<
name|pmc_cpu_max
argument_list|()
argument_list|,
operator|(
literal|"[uncore,%d] illegal CPU %d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|ri
operator|>=
literal|0
operator|&&
name|ri
operator|<
name|uncore_ucf_npmc
argument_list|,
operator|(
literal|"[uncore,%d] illegal row-index %d"
operator|,
name|__LINE__
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|CFG
argument_list|,
literal|1
argument_list|,
literal|"ucf-config cpu=%d ri=%d pm=%p"
argument_list|,
name|cpu
argument_list|,
name|ri
argument_list|,
name|pm
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|uncore_pcpu
index|[
name|cpu
index|]
operator|!=
name|NULL
argument_list|,
operator|(
literal|"[uncore,%d] null per-cpu %d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|uncore_pcpu
index|[
name|cpu
index|]
operator|->
name|pc_uncorepmcs
index|[
name|ri
operator|+
name|uncore_ucf_ri
index|]
operator|.
name|phw_pmc
operator|=
name|pm
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucf_describe
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|,
name|struct
name|pmc_info
modifier|*
name|pi
parameter_list|,
name|struct
name|pmc
modifier|*
modifier|*
name|ppmc
parameter_list|)
block|{
name|int
name|error
decl_stmt|;
name|struct
name|pmc_hw
modifier|*
name|phw
decl_stmt|;
name|char
name|ucf_name
index|[
name|PMC_NAME_MAX
index|]
decl_stmt|;
name|phw
operator|=
operator|&
name|uncore_pcpu
index|[
name|cpu
index|]
operator|->
name|pc_uncorepmcs
index|[
name|ri
operator|+
name|uncore_ucf_ri
index|]
expr_stmt|;
operator|(
name|void
operator|)
name|snprintf
argument_list|(
name|ucf_name
argument_list|,
sizeof|sizeof
argument_list|(
name|ucf_name
argument_list|)
argument_list|,
literal|"UCF-%d"
argument_list|,
name|ri
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|error
operator|=
name|copystr
argument_list|(
name|ucf_name
argument_list|,
name|pi
operator|->
name|pm_name
argument_list|,
name|PMC_NAME_MAX
argument_list|,
name|NULL
argument_list|)
operator|)
operator|!=
literal|0
condition|)
return|return
operator|(
name|error
operator|)
return|;
name|pi
operator|->
name|pm_class
operator|=
name|PMC_CLASS_UCF
expr_stmt|;
if|if
condition|(
name|phw
operator|->
name|phw_state
operator|&
name|PMC_PHW_FLAG_IS_ENABLED
condition|)
block|{
name|pi
operator|->
name|pm_enabled
operator|=
name|TRUE
expr_stmt|;
operator|*
name|ppmc
operator|=
name|phw
operator|->
name|phw_pmc
expr_stmt|;
block|}
else|else
block|{
name|pi
operator|->
name|pm_enabled
operator|=
name|FALSE
expr_stmt|;
operator|*
name|ppmc
operator|=
name|NULL
expr_stmt|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucf_get_config
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|,
name|struct
name|pmc
modifier|*
modifier|*
name|ppm
parameter_list|)
block|{
operator|*
name|ppm
operator|=
name|uncore_pcpu
index|[
name|cpu
index|]
operator|->
name|pc_uncorepmcs
index|[
name|ri
operator|+
name|uncore_ucf_ri
index|]
operator|.
name|phw_pmc
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucf_read_pmc
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|,
name|pmc_value_t
modifier|*
name|v
parameter_list|)
block|{
name|struct
name|pmc
modifier|*
name|pm
decl_stmt|;
name|pmc_value_t
name|tmp
decl_stmt|;
name|KASSERT
argument_list|(
name|cpu
operator|>=
literal|0
operator|&&
name|cpu
operator|<
name|pmc_cpu_max
argument_list|()
argument_list|,
operator|(
literal|"[uncore,%d] illegal cpu value %d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|ri
operator|>=
literal|0
operator|&&
name|ri
operator|<
name|uncore_ucf_npmc
argument_list|,
operator|(
literal|"[uncore,%d] illegal row-index %d"
operator|,
name|__LINE__
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
name|pm
operator|=
name|uncore_pcpu
index|[
name|cpu
index|]
operator|->
name|pc_uncorepmcs
index|[
name|ri
operator|+
name|uncore_ucf_ri
index|]
operator|.
name|phw_pmc
expr_stmt|;
name|KASSERT
argument_list|(
name|pm
argument_list|,
operator|(
literal|"[uncore,%d] cpu %d ri %d(%d) pmc not configured"
operator|,
name|__LINE__
operator|,
name|cpu
operator|,
name|ri
operator|,
name|ri
operator|+
name|uncore_ucf_ri
operator|)
argument_list|)
expr_stmt|;
name|tmp
operator|=
name|rdmsr
argument_list|(
name|UCF_CTR0
operator|+
name|ri
argument_list|)
expr_stmt|;
if|if
condition|(
name|PMC_IS_SAMPLING_MODE
argument_list|(
name|PMC_TO_MODE
argument_list|(
name|pm
argument_list|)
argument_list|)
condition|)
operator|*
name|v
operator|=
name|ucf_perfctr_value_to_reload_count
argument_list|(
name|tmp
argument_list|)
expr_stmt|;
else|else
operator|*
name|v
operator|=
name|tmp
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|REA
argument_list|,
literal|1
argument_list|,
literal|"ucf-read cpu=%d ri=%d -> v=%jx"
argument_list|,
name|cpu
argument_list|,
name|ri
argument_list|,
operator|*
name|v
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucf_release_pmc
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|,
name|struct
name|pmc
modifier|*
name|pmc
parameter_list|)
block|{
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|REL
argument_list|,
literal|1
argument_list|,
literal|"ucf-release cpu=%d ri=%d pm=%p"
argument_list|,
name|cpu
argument_list|,
name|ri
argument_list|,
name|pmc
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|cpu
operator|>=
literal|0
operator|&&
name|cpu
operator|<
name|pmc_cpu_max
argument_list|()
argument_list|,
operator|(
literal|"[uncore,%d] illegal CPU value %d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|ri
operator|>=
literal|0
operator|&&
name|ri
operator|<
name|uncore_ucf_npmc
argument_list|,
operator|(
literal|"[uncore,%d] illegal row-index %d"
operator|,
name|__LINE__
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|uncore_pcpu
index|[
name|cpu
index|]
operator|->
name|pc_uncorepmcs
index|[
name|ri
operator|+
name|uncore_ucf_ri
index|]
operator|.
name|phw_pmc
operator|==
name|NULL
argument_list|,
operator|(
literal|"[uncore,%d] PHW pmc non-NULL"
operator|,
name|__LINE__
operator|)
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucf_start_pmc
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|)
block|{
name|struct
name|pmc
modifier|*
name|pm
decl_stmt|;
name|struct
name|uncore_cpu
modifier|*
name|ucfc
decl_stmt|;
name|KASSERT
argument_list|(
name|cpu
operator|>=
literal|0
operator|&&
name|cpu
operator|<
name|pmc_cpu_max
argument_list|()
argument_list|,
operator|(
literal|"[uncore,%d] illegal CPU value %d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|ri
operator|>=
literal|0
operator|&&
name|ri
operator|<
name|uncore_ucf_npmc
argument_list|,
operator|(
literal|"[uncore,%d] illegal row-index %d"
operator|,
name|__LINE__
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|STA
argument_list|,
literal|1
argument_list|,
literal|"ucf-start cpu=%d ri=%d"
argument_list|,
name|cpu
argument_list|,
name|ri
argument_list|)
expr_stmt|;
name|ucfc
operator|=
name|uncore_pcpu
index|[
name|cpu
index|]
expr_stmt|;
name|pm
operator|=
name|ucfc
operator|->
name|pc_uncorepmcs
index|[
name|ri
operator|+
name|uncore_ucf_ri
index|]
operator|.
name|phw_pmc
expr_stmt|;
name|ucfc
operator|->
name|pc_ucfctrl
operator||=
name|pm
operator|->
name|pm_md
operator|.
name|pm_ucf
operator|.
name|pm_ucf_ctrl
expr_stmt|;
name|wrmsr
argument_list|(
name|UCF_CTRL
argument_list|,
name|ucfc
operator|->
name|pc_ucfctrl
argument_list|)
expr_stmt|;
do|do
block|{
name|ucfc
operator|->
name|pc_resync
operator|=
literal|0
expr_stmt|;
name|ucfc
operator|->
name|pc_globalctrl
operator||=
operator|(
literal|1ULL
operator|<<
operator|(
name|ri
operator|+
name|SELECTOFF
argument_list|(
name|uncore_cputype
argument_list|)
operator|)
operator|)
expr_stmt|;
name|wrmsr
argument_list|(
name|UC_GLOBAL_CTRL
argument_list|,
name|ucfc
operator|->
name|pc_globalctrl
argument_list|)
expr_stmt|;
block|}
do|while
condition|(
name|ucfc
operator|->
name|pc_resync
operator|!=
literal|0
condition|)
do|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|STA
argument_list|,
literal|1
argument_list|,
literal|"ucfctrl=%x(%x) globalctrl=%jx(%jx)"
argument_list|,
name|ucfc
operator|->
name|pc_ucfctrl
argument_list|,
operator|(
name|uint32_t
operator|)
name|rdmsr
argument_list|(
name|UCF_CTRL
argument_list|)
argument_list|,
name|ucfc
operator|->
name|pc_globalctrl
argument_list|,
name|rdmsr
argument_list|(
name|UC_GLOBAL_CTRL
argument_list|)
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucf_stop_pmc
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|)
block|{
name|uint32_t
name|fc
decl_stmt|;
name|struct
name|uncore_cpu
modifier|*
name|ucfc
decl_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|STO
argument_list|,
literal|1
argument_list|,
literal|"ucf-stop cpu=%d ri=%d"
argument_list|,
name|cpu
argument_list|,
name|ri
argument_list|)
expr_stmt|;
name|ucfc
operator|=
name|uncore_pcpu
index|[
name|cpu
index|]
expr_stmt|;
name|KASSERT
argument_list|(
name|cpu
operator|>=
literal|0
operator|&&
name|cpu
operator|<
name|pmc_cpu_max
argument_list|()
argument_list|,
operator|(
literal|"[uncore,%d] illegal CPU value %d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|ri
operator|>=
literal|0
operator|&&
name|ri
operator|<
name|uncore_ucf_npmc
argument_list|,
operator|(
literal|"[uncore,%d] illegal row-index %d"
operator|,
name|__LINE__
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
name|fc
operator|=
operator|(
name|UCF_MASK
operator|<<
operator|(
name|ri
operator|*
literal|4
operator|)
operator|)
expr_stmt|;
name|ucfc
operator|->
name|pc_ucfctrl
operator|&=
operator|~
name|fc
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|STO
argument_list|,
literal|1
argument_list|,
literal|"ucf-stop ucfctrl=%x"
argument_list|,
name|ucfc
operator|->
name|pc_ucfctrl
argument_list|)
expr_stmt|;
name|wrmsr
argument_list|(
name|UCF_CTRL
argument_list|,
name|ucfc
operator|->
name|pc_ucfctrl
argument_list|)
expr_stmt|;
do|do
block|{
name|ucfc
operator|->
name|pc_resync
operator|=
literal|0
expr_stmt|;
name|ucfc
operator|->
name|pc_globalctrl
operator|&=
operator|~
operator|(
literal|1ULL
operator|<<
operator|(
name|ri
operator|+
name|SELECTOFF
argument_list|(
name|uncore_cputype
argument_list|)
operator|)
operator|)
expr_stmt|;
name|wrmsr
argument_list|(
name|UC_GLOBAL_CTRL
argument_list|,
name|ucfc
operator|->
name|pc_globalctrl
argument_list|)
expr_stmt|;
block|}
do|while
condition|(
name|ucfc
operator|->
name|pc_resync
operator|!=
literal|0
condition|)
do|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|STO
argument_list|,
literal|1
argument_list|,
literal|"ucfctrl=%x(%x) globalctrl=%jx(%jx)"
argument_list|,
name|ucfc
operator|->
name|pc_ucfctrl
argument_list|,
operator|(
name|uint32_t
operator|)
name|rdmsr
argument_list|(
name|UCF_CTRL
argument_list|)
argument_list|,
name|ucfc
operator|->
name|pc_globalctrl
argument_list|,
name|rdmsr
argument_list|(
name|UC_GLOBAL_CTRL
argument_list|)
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucf_write_pmc
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|,
name|pmc_value_t
name|v
parameter_list|)
block|{
name|struct
name|uncore_cpu
modifier|*
name|cc
decl_stmt|;
name|struct
name|pmc
modifier|*
name|pm
decl_stmt|;
name|KASSERT
argument_list|(
name|cpu
operator|>=
literal|0
operator|&&
name|cpu
operator|<
name|pmc_cpu_max
argument_list|()
argument_list|,
operator|(
literal|"[uncore,%d] illegal cpu value %d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|ri
operator|>=
literal|0
operator|&&
name|ri
operator|<
name|uncore_ucf_npmc
argument_list|,
operator|(
literal|"[uncore,%d] illegal row-index %d"
operator|,
name|__LINE__
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
name|cc
operator|=
name|uncore_pcpu
index|[
name|cpu
index|]
expr_stmt|;
name|pm
operator|=
name|cc
operator|->
name|pc_uncorepmcs
index|[
name|ri
operator|+
name|uncore_ucf_ri
index|]
operator|.
name|phw_pmc
expr_stmt|;
name|KASSERT
argument_list|(
name|pm
argument_list|,
operator|(
literal|"[uncore,%d] cpu %d ri %d pmc not configured"
operator|,
name|__LINE__
operator|,
name|cpu
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|PMC_IS_SAMPLING_MODE
argument_list|(
name|PMC_TO_MODE
argument_list|(
name|pm
argument_list|)
argument_list|)
condition|)
name|v
operator|=
name|ucf_reload_count_to_perfctr_value
argument_list|(
name|v
argument_list|)
expr_stmt|;
name|wrmsr
argument_list|(
name|UCF_CTRL
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|/* Turn off fixed counters */
name|wrmsr
argument_list|(
name|UCF_CTR0
operator|+
name|ri
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|wrmsr
argument_list|(
name|UCF_CTRL
argument_list|,
name|cc
operator|->
name|pc_ucfctrl
argument_list|)
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|WRI
argument_list|,
literal|1
argument_list|,
literal|"ucf-write cpu=%d ri=%d v=%jx ucfctrl=%jx "
argument_list|,
name|cpu
argument_list|,
name|ri
argument_list|,
name|v
argument_list|,
operator|(
name|uintmax_t
operator|)
name|rdmsr
argument_list|(
name|UCF_CTRL
argument_list|)
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|ucf_initialize
parameter_list|(
name|struct
name|pmc_mdep
modifier|*
name|md
parameter_list|,
name|int
name|maxcpu
parameter_list|,
name|int
name|npmc
parameter_list|,
name|int
name|pmcwidth
parameter_list|)
block|{
name|struct
name|pmc_classdep
modifier|*
name|pcd
decl_stmt|;
name|KASSERT
argument_list|(
name|md
operator|!=
name|NULL
argument_list|,
operator|(
literal|"[ucf,%d] md is NULL"
operator|,
name|__LINE__
operator|)
argument_list|)
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|INI
argument_list|,
literal|1
argument_list|,
literal|"%s"
argument_list|,
literal|"ucf-initialize"
argument_list|)
expr_stmt|;
name|pcd
operator|=
operator|&
name|md
operator|->
name|pmd_classdep
index|[
name|PMC_MDEP_CLASS_INDEX_UCF
index|]
expr_stmt|;
name|pcd
operator|->
name|pcd_caps
operator|=
name|UCF_PMC_CAPS
expr_stmt|;
name|pcd
operator|->
name|pcd_class
operator|=
name|PMC_CLASS_UCF
expr_stmt|;
name|pcd
operator|->
name|pcd_num
operator|=
name|npmc
expr_stmt|;
name|pcd
operator|->
name|pcd_ri
operator|=
name|md
operator|->
name|pmd_npmc
expr_stmt|;
name|pcd
operator|->
name|pcd_width
operator|=
name|pmcwidth
expr_stmt|;
name|pcd
operator|->
name|pcd_allocate_pmc
operator|=
name|ucf_allocate_pmc
expr_stmt|;
name|pcd
operator|->
name|pcd_config_pmc
operator|=
name|ucf_config_pmc
expr_stmt|;
name|pcd
operator|->
name|pcd_describe
operator|=
name|ucf_describe
expr_stmt|;
name|pcd
operator|->
name|pcd_get_config
operator|=
name|ucf_get_config
expr_stmt|;
name|pcd
operator|->
name|pcd_get_msr
operator|=
name|NULL
expr_stmt|;
name|pcd
operator|->
name|pcd_pcpu_fini
operator|=
name|uncore_pcpu_noop
expr_stmt|;
name|pcd
operator|->
name|pcd_pcpu_init
operator|=
name|uncore_pcpu_noop
expr_stmt|;
name|pcd
operator|->
name|pcd_read_pmc
operator|=
name|ucf_read_pmc
expr_stmt|;
name|pcd
operator|->
name|pcd_release_pmc
operator|=
name|ucf_release_pmc
expr_stmt|;
name|pcd
operator|->
name|pcd_start_pmc
operator|=
name|ucf_start_pmc
expr_stmt|;
name|pcd
operator|->
name|pcd_stop_pmc
operator|=
name|ucf_stop_pmc
expr_stmt|;
name|pcd
operator|->
name|pcd_write_pmc
operator|=
name|ucf_write_pmc
expr_stmt|;
name|md
operator|->
name|pmd_npmc
operator|+=
name|npmc
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Intel programmable PMCs.  */
end_comment

begin_comment
comment|/*  * Event descriptor tables.  *  * For each event id, we track:  *  * 1. The CPUs that the event is valid for.  *  * 2. If the event uses a fixed UMASK, the value of the umask field.  *    If the event doesn't use a fixed UMASK, a mask of legal bits  *    to check against.  */
end_comment

begin_struct
struct|struct
name|ucp_event_descr
block|{
name|enum
name|pmc_event
name|ucp_ev
decl_stmt|;
name|unsigned
name|char
name|ucp_evcode
decl_stmt|;
name|unsigned
name|char
name|ucp_umask
decl_stmt|;
name|unsigned
name|char
name|ucp_flags
decl_stmt|;
block|}
struct|;
end_struct

begin_define
define|#
directive|define
name|UCP_F_I7
value|(1<< 0)
end_define

begin_comment
comment|/* CPU: Core i7 */
end_comment

begin_define
define|#
directive|define
name|UCP_F_WM
value|(1<< 1)
end_define

begin_comment
comment|/* CPU: Westmere */
end_comment

begin_define
define|#
directive|define
name|UCP_F_SB
value|(1<< 2)
end_define

begin_comment
comment|/* CPU: Sandy Bridge */
end_comment

begin_define
define|#
directive|define
name|UCP_F_HW
value|(1<< 3)
end_define

begin_comment
comment|/* CPU: Haswell */
end_comment

begin_define
define|#
directive|define
name|UCP_F_FM
value|(1<< 4)
end_define

begin_comment
comment|/* Fixed mask */
end_comment

begin_define
define|#
directive|define
name|UCP_F_ALLCPUS
define|\
value|(UCP_F_I7 | UCP_F_WM)
end_define

begin_define
define|#
directive|define
name|UCP_F_CMASK
value|0xFF000000
end_define

begin_decl_stmt
specifier|static
name|struct
name|ucp_event_descr
name|ucp_events
index|[]
init|=
block|{
undef|#
directive|undef
name|UCPDESCR
define|#
directive|define
name|UCPDESCR
parameter_list|(
name|N
parameter_list|,
name|EV
parameter_list|,
name|UM
parameter_list|,
name|FLAGS
parameter_list|)
value|{					\ 	.ucp_ev = PMC_EV_UCP_EVENT_##N,					\ 	.ucp_evcode = (EV),						\ 	.ucp_umask = (UM),						\ 	.ucp_flags = (FLAGS)						\ 	}
name|UCPDESCR
argument_list|(
literal|00H_01H
argument_list|,
literal|0x00
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|00H_02H
argument_list|,
literal|0x00
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|00H_04H
argument_list|,
literal|0x00
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|01H_01H
argument_list|,
literal|0x01
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|01H_02H
argument_list|,
literal|0x01
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|01H_04H
argument_list|,
literal|0x01
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|02H_01H
argument_list|,
literal|0x02
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|03H_01H
argument_list|,
literal|0x03
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|03H_02H
argument_list|,
literal|0x03
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|03H_04H
argument_list|,
literal|0x03
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|03H_08H
argument_list|,
literal|0x03
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|03H_10H
argument_list|,
literal|0x03
argument_list|,
literal|0x10
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|03H_20H
argument_list|,
literal|0x03
argument_list|,
literal|0x20
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|03H_40H
argument_list|,
literal|0x03
argument_list|,
literal|0x40
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|04H_01H
argument_list|,
literal|0x04
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|04H_02H
argument_list|,
literal|0x04
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|04H_04H
argument_list|,
literal|0x04
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|04H_08H
argument_list|,
literal|0x04
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|04H_10H
argument_list|,
literal|0x04
argument_list|,
literal|0x10
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|05H_01H
argument_list|,
literal|0x05
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|05H_02H
argument_list|,
literal|0x05
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|05H_04H
argument_list|,
literal|0x05
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|06H_01H
argument_list|,
literal|0x06
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|06H_02H
argument_list|,
literal|0x06
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|06H_04H
argument_list|,
literal|0x06
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|06H_08H
argument_list|,
literal|0x06
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|06H_10H
argument_list|,
literal|0x06
argument_list|,
literal|0x10
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|06H_20H
argument_list|,
literal|0x06
argument_list|,
literal|0x20
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|07H_01H
argument_list|,
literal|0x07
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|07H_02H
argument_list|,
literal|0x07
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|07H_04H
argument_list|,
literal|0x07
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|07H_08H
argument_list|,
literal|0x07
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|07H_10H
argument_list|,
literal|0x07
argument_list|,
literal|0x10
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|07H_20H
argument_list|,
literal|0x07
argument_list|,
literal|0x20
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|07H_24H
argument_list|,
literal|0x07
argument_list|,
literal|0x24
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|08H_01H
argument_list|,
literal|0x08
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|08H_02H
argument_list|,
literal|0x08
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|08H_04H
argument_list|,
literal|0x08
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|08H_03H
argument_list|,
literal|0x08
argument_list|,
literal|0x03
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|09H_01H
argument_list|,
literal|0x09
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|09H_02H
argument_list|,
literal|0x09
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|09H_04H
argument_list|,
literal|0x09
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|09H_03H
argument_list|,
literal|0x09
argument_list|,
literal|0x03
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0AH_01H
argument_list|,
literal|0x0A
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0AH_02H
argument_list|,
literal|0x0A
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0AH_04H
argument_list|,
literal|0x0A
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0AH_08H
argument_list|,
literal|0x0A
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0AH_0FH
argument_list|,
literal|0x0A
argument_list|,
literal|0x0F
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0BH_01H
argument_list|,
literal|0x0B
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0BH_02H
argument_list|,
literal|0x0B
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0BH_04H
argument_list|,
literal|0x0B
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0BH_08H
argument_list|,
literal|0x0B
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0BH_10H
argument_list|,
literal|0x0B
argument_list|,
literal|0x10
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0BH_1FH
argument_list|,
literal|0x0B
argument_list|,
literal|0x1F
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0CH_01H
argument_list|,
literal|0x0C
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0CH_02H
argument_list|,
literal|0x0C
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0CH_04H_E
argument_list|,
literal|0x0C
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0CH_04H_F
argument_list|,
literal|0x0C
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0CH_04H_M
argument_list|,
literal|0x0C
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0CH_04H_S
argument_list|,
literal|0x0C
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0CH_08H_E
argument_list|,
literal|0x0C
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0CH_08H_F
argument_list|,
literal|0x0C
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0CH_08H_M
argument_list|,
literal|0x0C
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|0CH_08H_S
argument_list|,
literal|0x0C
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|20H_01H
argument_list|,
literal|0x20
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|20H_02H
argument_list|,
literal|0x20
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|20H_04H
argument_list|,
literal|0x20
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|20H_08H
argument_list|,
literal|0x20
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|20H_10H
argument_list|,
literal|0x20
argument_list|,
literal|0x10
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|20H_20H
argument_list|,
literal|0x20
argument_list|,
literal|0x20
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|21H_01H
argument_list|,
literal|0x21
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|21H_02H
argument_list|,
literal|0x21
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|21H_04H
argument_list|,
literal|0x21
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|22H_01H
argument_list|,
literal|0x22
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|22H_02H
argument_list|,
literal|0x22
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|22H_04H
argument_list|,
literal|0x22
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|22H_08H
argument_list|,
literal|0x22
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|22H_10H
argument_list|,
literal|0x22
argument_list|,
literal|0x10
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|22H_20H
argument_list|,
literal|0x22
argument_list|,
literal|0x20
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|22H_40H
argument_list|,
literal|0x22
argument_list|,
literal|0x40
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|22H_80H
argument_list|,
literal|0x22
argument_list|,
literal|0x80
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|23H_01H
argument_list|,
literal|0x23
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|23H_02H
argument_list|,
literal|0x23
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|23H_04H
argument_list|,
literal|0x23
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|24H_02H
argument_list|,
literal|0x24
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|24H_04H
argument_list|,
literal|0x24
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|25H_01H
argument_list|,
literal|0x25
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|25H_02H
argument_list|,
literal|0x25
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|25H_04H
argument_list|,
literal|0x25
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|26H_01H
argument_list|,
literal|0x26
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|27H_01H
argument_list|,
literal|0x27
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|27H_02H
argument_list|,
literal|0x27
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|27H_04H
argument_list|,
literal|0x27
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|27H_08H
argument_list|,
literal|0x27
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|27H_10H
argument_list|,
literal|0x27
argument_list|,
literal|0x10
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|27H_20H
argument_list|,
literal|0x27
argument_list|,
literal|0x20
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|28H_01H
argument_list|,
literal|0x28
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|28H_02H
argument_list|,
literal|0x28
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|28H_04H
argument_list|,
literal|0x28
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|28H_08H
argument_list|,
literal|0x28
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|28H_10H
argument_list|,
literal|0x28
argument_list|,
literal|0x10
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|28H_20H
argument_list|,
literal|0x28
argument_list|,
literal|0x20
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|29H_01H
argument_list|,
literal|0x29
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|29H_02H
argument_list|,
literal|0x29
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|29H_04H
argument_list|,
literal|0x29
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|29H_08H
argument_list|,
literal|0x29
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|29H_10H
argument_list|,
literal|0x29
argument_list|,
literal|0x10
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|29H_20H
argument_list|,
literal|0x29
argument_list|,
literal|0x20
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2AH_01H
argument_list|,
literal|0x2A
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2AH_02H
argument_list|,
literal|0x2A
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2AH_04H
argument_list|,
literal|0x2A
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2AH_07H
argument_list|,
literal|0x2A
argument_list|,
literal|0x07
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2BH_01H
argument_list|,
literal|0x2B
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2BH_02H
argument_list|,
literal|0x2B
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2BH_04H
argument_list|,
literal|0x2B
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2BH_07H
argument_list|,
literal|0x2B
argument_list|,
literal|0x07
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2CH_01H
argument_list|,
literal|0x2C
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2CH_02H
argument_list|,
literal|0x2C
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2CH_04H
argument_list|,
literal|0x2C
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2CH_07H
argument_list|,
literal|0x2C
argument_list|,
literal|0x07
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2DH_01H
argument_list|,
literal|0x2D
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2DH_02H
argument_list|,
literal|0x2D
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2DH_04H
argument_list|,
literal|0x2D
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2DH_07H
argument_list|,
literal|0x2D
argument_list|,
literal|0x07
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2EH_01H
argument_list|,
literal|0x2E
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2EH_02H
argument_list|,
literal|0x2E
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2EH_04H
argument_list|,
literal|0x2E
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2EH_07H
argument_list|,
literal|0x2E
argument_list|,
literal|0x07
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2FH_01H
argument_list|,
literal|0x2F
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2FH_02H
argument_list|,
literal|0x2F
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2FH_04H
argument_list|,
literal|0x2F
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2FH_07H
argument_list|,
literal|0x2F
argument_list|,
literal|0x07
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2FH_08H
argument_list|,
literal|0x2F
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2FH_10H
argument_list|,
literal|0x2F
argument_list|,
literal|0x10
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2FH_20H
argument_list|,
literal|0x2F
argument_list|,
literal|0x20
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|2FH_38H
argument_list|,
literal|0x2F
argument_list|,
literal|0x38
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|30H_01H
argument_list|,
literal|0x30
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|30H_02H
argument_list|,
literal|0x30
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|30H_04H
argument_list|,
literal|0x30
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|30H_07H
argument_list|,
literal|0x30
argument_list|,
literal|0x07
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|31H_01H
argument_list|,
literal|0x31
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|31H_02H
argument_list|,
literal|0x31
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|31H_04H
argument_list|,
literal|0x31
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|31H_07H
argument_list|,
literal|0x31
argument_list|,
literal|0x07
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|32H_01H
argument_list|,
literal|0x32
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|32H_02H
argument_list|,
literal|0x32
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|32H_04H
argument_list|,
literal|0x32
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|32H_07H
argument_list|,
literal|0x32
argument_list|,
literal|0x07
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|33H_01H
argument_list|,
literal|0x33
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|33H_02H
argument_list|,
literal|0x33
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|33H_04H
argument_list|,
literal|0x33
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|33H_07H
argument_list|,
literal|0x33
argument_list|,
literal|0x07
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|34H_01H
argument_list|,
literal|0x34
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|34H_02H
argument_list|,
literal|0x34
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
operator||
name|UCP_F_SB
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|34H_04H
argument_list|,
literal|0x34
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
operator||
name|UCP_F_SB
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|34H_06H
argument_list|,
literal|0x34
argument_list|,
literal|0x06
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|34H_08H
argument_list|,
literal|0x34
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|34H_10H
argument_list|,
literal|0x34
argument_list|,
literal|0x10
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|34H_20H
argument_list|,
literal|0x34
argument_list|,
literal|0x20
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|34H_40H
argument_list|,
literal|0x34
argument_list|,
literal|0x40
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|34H_80H
argument_list|,
literal|0x34
argument_list|,
literal|0x80
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|35H_01H
argument_list|,
literal|0x35
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|35H_02H
argument_list|,
literal|0x35
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|35H_04H
argument_list|,
literal|0x35
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|40H_01H
argument_list|,
literal|0x40
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|40H_02H
argument_list|,
literal|0x40
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|40H_04H
argument_list|,
literal|0x40
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|40H_08H
argument_list|,
literal|0x40
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|40H_10H
argument_list|,
literal|0x40
argument_list|,
literal|0x10
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|40H_20H
argument_list|,
literal|0x40
argument_list|,
literal|0x20
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|40H_07H
argument_list|,
literal|0x40
argument_list|,
literal|0x07
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|40H_38H
argument_list|,
literal|0x40
argument_list|,
literal|0x38
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|41H_01H
argument_list|,
literal|0x41
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|41H_02H
argument_list|,
literal|0x41
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|41H_04H
argument_list|,
literal|0x41
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|41H_08H
argument_list|,
literal|0x41
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|41H_10H
argument_list|,
literal|0x41
argument_list|,
literal|0x10
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|41H_20H
argument_list|,
literal|0x41
argument_list|,
literal|0x20
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|41H_07H
argument_list|,
literal|0x41
argument_list|,
literal|0x07
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|41H_38H
argument_list|,
literal|0x41
argument_list|,
literal|0x38
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|42H_01H
argument_list|,
literal|0x42
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|42H_02H
argument_list|,
literal|0x42
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|42H_04H
argument_list|,
literal|0x42
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|42H_08H
argument_list|,
literal|0x42
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|43H_01H
argument_list|,
literal|0x43
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|43H_02H
argument_list|,
literal|0x43
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|60H_01H
argument_list|,
literal|0x60
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|60H_02H
argument_list|,
literal|0x60
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|60H_04H
argument_list|,
literal|0x60
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|61H_01H
argument_list|,
literal|0x61
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|61H_02H
argument_list|,
literal|0x61
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|61H_04H
argument_list|,
literal|0x61
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|62H_01H
argument_list|,
literal|0x62
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|62H_02H
argument_list|,
literal|0x62
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|62H_04H
argument_list|,
literal|0x62
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|63H_01H
argument_list|,
literal|0x63
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|63H_02H
argument_list|,
literal|0x63
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|63H_04H
argument_list|,
literal|0x63
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|63H_08H
argument_list|,
literal|0x63
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|63H_10H
argument_list|,
literal|0x63
argument_list|,
literal|0x10
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|63H_20H
argument_list|,
literal|0x63
argument_list|,
literal|0x20
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|64H_01H
argument_list|,
literal|0x64
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|64H_02H
argument_list|,
literal|0x64
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|64H_04H
argument_list|,
literal|0x64
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|64H_08H
argument_list|,
literal|0x64
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|64H_10H
argument_list|,
literal|0x64
argument_list|,
literal|0x10
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|64H_20H
argument_list|,
literal|0x64
argument_list|,
literal|0x20
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|65H_01H
argument_list|,
literal|0x65
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|65H_02H
argument_list|,
literal|0x65
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|65H_04H
argument_list|,
literal|0x65
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|66H_01H
argument_list|,
literal|0x66
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|66H_02H
argument_list|,
literal|0x66
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|66H_04H
argument_list|,
literal|0x66
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_I7
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|67H_01H
argument_list|,
literal|0x67
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|80H_01H
argument_list|,
literal|0x80
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|80H_02H
argument_list|,
literal|0x80
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|80H_04H
argument_list|,
literal|0x80
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|80H_08H
argument_list|,
literal|0x80
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|81H_01H
argument_list|,
literal|0x81
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|81H_02H
argument_list|,
literal|0x81
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|81H_04H
argument_list|,
literal|0x81
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|81H_08H
argument_list|,
literal|0x81
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|81H_20H
argument_list|,
literal|0x81
argument_list|,
literal|0x20
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|81H_80H
argument_list|,
literal|0x81
argument_list|,
literal|0x80
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|82H_01H
argument_list|,
literal|0x82
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|83H_01H
argument_list|,
literal|0x83
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|83H_02H
argument_list|,
literal|0x83
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|83H_04H
argument_list|,
literal|0x83
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|83H_08H
argument_list|,
literal|0x83
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|84H_01H
argument_list|,
literal|0x84
argument_list|,
literal|0x01
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
operator||
name|UCP_F_SB
operator||
name|UCP_F_HW
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|84H_02H
argument_list|,
literal|0x84
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|84H_04H
argument_list|,
literal|0x84
argument_list|,
literal|0x04
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|84H_08H
argument_list|,
literal|0x84
argument_list|,
literal|0x08
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|85H_02H
argument_list|,
literal|0x85
argument_list|,
literal|0x02
argument_list|,
name|UCP_F_FM
operator||
name|UCP_F_WM
argument_list|)
block|,
name|UCPDESCR
argument_list|(
literal|86H_01H
argument_list|,
literal|0x86
argument_list|,
literal|0x01
argument_list|,
argument|UCP_F_FM | UCP_F_WM
argument_list|)
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|int
name|nucp_events
init|=
sizeof|sizeof
argument_list|(
name|ucp_events
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|ucp_events
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|pmc_value_t
name|ucp_perfctr_value_to_reload_count
parameter_list|(
name|pmc_value_t
name|v
parameter_list|)
block|{
name|v
operator|&=
operator|(
literal|1ULL
operator|<<
name|uncore_ucp_width
operator|)
operator|-
literal|1
expr_stmt|;
return|return
operator|(
literal|1ULL
operator|<<
name|uncore_ucp_width
operator|)
operator|-
name|v
return|;
block|}
end_function

begin_function
specifier|static
name|pmc_value_t
name|ucp_reload_count_to_perfctr_value
parameter_list|(
name|pmc_value_t
name|rlc
parameter_list|)
block|{
return|return
operator|(
literal|1ULL
operator|<<
name|uncore_ucp_width
operator|)
operator|-
name|rlc
return|;
block|}
end_function

begin_comment
comment|/*  * Counter specific event information for Sandybridge and Haswell  */
end_comment

begin_function
specifier|static
name|int
name|ucp_event_sb_hw_ok_on_counter
parameter_list|(
name|enum
name|pmc_event
name|pe
parameter_list|,
name|int
name|ri
parameter_list|)
block|{
name|uint32_t
name|mask
decl_stmt|;
switch|switch
condition|(
name|pe
condition|)
block|{
comment|/* 		 * Events valid only on counter 0. 		 */
case|case
name|PMC_EV_UCP_EVENT_80H_01H
case|:
case|case
name|PMC_EV_UCP_EVENT_83H_01H
case|:
name|mask
operator|=
operator|(
literal|1
operator|<<
literal|0
operator|)
expr_stmt|;
break|break;
default|default:
name|mask
operator|=
operator|~
literal|0
expr_stmt|;
comment|/* Any row index is ok. */
block|}
return|return
operator|(
name|mask
operator|&
operator|(
literal|1
operator|<<
name|ri
operator|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucp_allocate_pmc
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|,
name|struct
name|pmc
modifier|*
name|pm
parameter_list|,
specifier|const
name|struct
name|pmc_op_pmcallocate
modifier|*
name|a
parameter_list|)
block|{
name|int
name|n
decl_stmt|;
name|enum
name|pmc_event
name|ev
decl_stmt|;
name|struct
name|ucp_event_descr
modifier|*
name|ie
decl_stmt|;
name|uint32_t
name|caps
decl_stmt|,
name|config
decl_stmt|,
name|cpuflag
decl_stmt|,
name|evsel
decl_stmt|;
name|KASSERT
argument_list|(
name|cpu
operator|>=
literal|0
operator|&&
name|cpu
operator|<
name|pmc_cpu_max
argument_list|()
argument_list|,
operator|(
literal|"[uncore,%d] illegal CPU %d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|ri
operator|>=
literal|0
operator|&&
name|ri
operator|<
name|uncore_ucp_npmc
argument_list|,
operator|(
literal|"[uncore,%d] illegal row-index value %d"
operator|,
name|__LINE__
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
comment|/* check requested capabilities */
name|caps
operator|=
name|a
operator|->
name|pm_caps
expr_stmt|;
if|if
condition|(
operator|(
name|UCP_PMC_CAPS
operator|&
name|caps
operator|)
operator|!=
name|caps
condition|)
return|return
operator|(
name|EPERM
operator|)
return|;
name|ev
operator|=
name|pm
operator|->
name|pm_event
expr_stmt|;
switch|switch
condition|(
name|uncore_cputype
condition|)
block|{
case|case
name|PMC_CPU_INTEL_HASWELL
case|:
case|case
name|PMC_CPU_INTEL_SANDYBRIDGE
case|:
if|if
condition|(
name|ucp_event_sb_hw_ok_on_counter
argument_list|(
name|ev
argument_list|,
name|ri
argument_list|)
operator|==
literal|0
condition|)
return|return
operator|(
name|EINVAL
operator|)
return|;
break|break;
default|default:
break|break;
block|}
comment|/* 	 * Look for an event descriptor with matching CPU and event id 	 * fields. 	 */
switch|switch
condition|(
name|uncore_cputype
condition|)
block|{
case|case
name|PMC_CPU_INTEL_COREI7
case|:
name|cpuflag
operator|=
name|UCP_F_I7
expr_stmt|;
break|break;
case|case
name|PMC_CPU_INTEL_HASWELL
case|:
name|cpuflag
operator|=
name|UCP_F_HW
expr_stmt|;
break|break;
case|case
name|PMC_CPU_INTEL_SANDYBRIDGE
case|:
name|cpuflag
operator|=
name|UCP_F_SB
expr_stmt|;
break|break;
case|case
name|PMC_CPU_INTEL_WESTMERE
case|:
name|cpuflag
operator|=
name|UCP_F_WM
expr_stmt|;
break|break;
default|default:
return|return
operator|(
name|EINVAL
operator|)
return|;
block|}
for|for
control|(
name|n
operator|=
literal|0
operator|,
name|ie
operator|=
name|ucp_events
init|;
name|n
operator|<
name|nucp_events
condition|;
name|n
operator|++
operator|,
name|ie
operator|++
control|)
if|if
condition|(
name|ie
operator|->
name|ucp_ev
operator|==
name|ev
operator|&&
name|ie
operator|->
name|ucp_flags
operator|&
name|cpuflag
condition|)
break|break;
if|if
condition|(
name|n
operator|==
name|nucp_events
condition|)
return|return
operator|(
name|EINVAL
operator|)
return|;
comment|/* 	 * A matching event descriptor has been found, so start 	 * assembling the contents of the event select register. 	 */
name|evsel
operator|=
name|ie
operator|->
name|ucp_evcode
operator||
name|UCP_EN
expr_stmt|;
name|config
operator|=
name|a
operator|->
name|pm_md
operator|.
name|pm_ucp
operator|.
name|pm_ucp_config
operator|&
operator|~
name|UCP_F_CMASK
expr_stmt|;
comment|/* 	 * If the event uses a fixed umask value, reject any umask 	 * bits set by the user. 	 */
if|if
condition|(
name|ie
operator|->
name|ucp_flags
operator|&
name|UCP_F_FM
condition|)
block|{
if|if
condition|(
name|UCP_UMASK
argument_list|(
name|config
argument_list|)
operator|!=
literal|0
condition|)
return|return
operator|(
name|EINVAL
operator|)
return|;
name|evsel
operator||=
operator|(
name|ie
operator|->
name|ucp_umask
operator|<<
literal|8
operator|)
expr_stmt|;
block|}
else|else
return|return
operator|(
name|EINVAL
operator|)
return|;
if|if
condition|(
name|caps
operator|&
name|PMC_CAP_THRESHOLD
condition|)
name|evsel
operator||=
operator|(
name|a
operator|->
name|pm_md
operator|.
name|pm_ucp
operator|.
name|pm_ucp_config
operator|&
name|UCP_F_CMASK
operator|)
expr_stmt|;
if|if
condition|(
name|caps
operator|&
name|PMC_CAP_EDGE
condition|)
name|evsel
operator||=
name|UCP_EDGE
expr_stmt|;
if|if
condition|(
name|caps
operator|&
name|PMC_CAP_INVERT
condition|)
name|evsel
operator||=
name|UCP_INV
expr_stmt|;
name|pm
operator|->
name|pm_md
operator|.
name|pm_ucp
operator|.
name|pm_ucp_evsel
operator|=
name|evsel
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucp_config_pmc
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|,
name|struct
name|pmc
modifier|*
name|pm
parameter_list|)
block|{
name|KASSERT
argument_list|(
name|cpu
operator|>=
literal|0
operator|&&
name|cpu
operator|<
name|pmc_cpu_max
argument_list|()
argument_list|,
operator|(
literal|"[uncore,%d] illegal CPU %d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|ri
operator|>=
literal|0
operator|&&
name|ri
operator|<
name|uncore_ucp_npmc
argument_list|,
operator|(
literal|"[uncore,%d] illegal row-index %d"
operator|,
name|__LINE__
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|CFG
argument_list|,
literal|1
argument_list|,
literal|"ucp-config cpu=%d ri=%d pm=%p"
argument_list|,
name|cpu
argument_list|,
name|ri
argument_list|,
name|pm
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|uncore_pcpu
index|[
name|cpu
index|]
operator|!=
name|NULL
argument_list|,
operator|(
literal|"[uncore,%d] null per-cpu %d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|uncore_pcpu
index|[
name|cpu
index|]
operator|->
name|pc_uncorepmcs
index|[
name|ri
index|]
operator|.
name|phw_pmc
operator|=
name|pm
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucp_describe
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|,
name|struct
name|pmc_info
modifier|*
name|pi
parameter_list|,
name|struct
name|pmc
modifier|*
modifier|*
name|ppmc
parameter_list|)
block|{
name|int
name|error
decl_stmt|;
name|struct
name|pmc_hw
modifier|*
name|phw
decl_stmt|;
name|char
name|ucp_name
index|[
name|PMC_NAME_MAX
index|]
decl_stmt|;
name|phw
operator|=
operator|&
name|uncore_pcpu
index|[
name|cpu
index|]
operator|->
name|pc_uncorepmcs
index|[
name|ri
index|]
expr_stmt|;
operator|(
name|void
operator|)
name|snprintf
argument_list|(
name|ucp_name
argument_list|,
sizeof|sizeof
argument_list|(
name|ucp_name
argument_list|)
argument_list|,
literal|"UCP-%d"
argument_list|,
name|ri
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|error
operator|=
name|copystr
argument_list|(
name|ucp_name
argument_list|,
name|pi
operator|->
name|pm_name
argument_list|,
name|PMC_NAME_MAX
argument_list|,
name|NULL
argument_list|)
operator|)
operator|!=
literal|0
condition|)
return|return
operator|(
name|error
operator|)
return|;
name|pi
operator|->
name|pm_class
operator|=
name|PMC_CLASS_UCP
expr_stmt|;
if|if
condition|(
name|phw
operator|->
name|phw_state
operator|&
name|PMC_PHW_FLAG_IS_ENABLED
condition|)
block|{
name|pi
operator|->
name|pm_enabled
operator|=
name|TRUE
expr_stmt|;
operator|*
name|ppmc
operator|=
name|phw
operator|->
name|phw_pmc
expr_stmt|;
block|}
else|else
block|{
name|pi
operator|->
name|pm_enabled
operator|=
name|FALSE
expr_stmt|;
operator|*
name|ppmc
operator|=
name|NULL
expr_stmt|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucp_get_config
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|,
name|struct
name|pmc
modifier|*
modifier|*
name|ppm
parameter_list|)
block|{
operator|*
name|ppm
operator|=
name|uncore_pcpu
index|[
name|cpu
index|]
operator|->
name|pc_uncorepmcs
index|[
name|ri
index|]
operator|.
name|phw_pmc
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucp_read_pmc
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|,
name|pmc_value_t
modifier|*
name|v
parameter_list|)
block|{
name|struct
name|pmc
modifier|*
name|pm
decl_stmt|;
name|pmc_value_t
name|tmp
decl_stmt|;
name|KASSERT
argument_list|(
name|cpu
operator|>=
literal|0
operator|&&
name|cpu
operator|<
name|pmc_cpu_max
argument_list|()
argument_list|,
operator|(
literal|"[uncore,%d] illegal cpu value %d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|ri
operator|>=
literal|0
operator|&&
name|ri
operator|<
name|uncore_ucp_npmc
argument_list|,
operator|(
literal|"[uncore,%d] illegal row-index %d"
operator|,
name|__LINE__
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
name|pm
operator|=
name|uncore_pcpu
index|[
name|cpu
index|]
operator|->
name|pc_uncorepmcs
index|[
name|ri
index|]
operator|.
name|phw_pmc
expr_stmt|;
name|KASSERT
argument_list|(
name|pm
argument_list|,
operator|(
literal|"[uncore,%d] cpu %d ri %d pmc not configured"
operator|,
name|__LINE__
operator|,
name|cpu
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
name|tmp
operator|=
name|rdmsr
argument_list|(
name|UCP_PMC0
operator|+
name|ri
argument_list|)
expr_stmt|;
if|if
condition|(
name|PMC_IS_SAMPLING_MODE
argument_list|(
name|PMC_TO_MODE
argument_list|(
name|pm
argument_list|)
argument_list|)
condition|)
operator|*
name|v
operator|=
name|ucp_perfctr_value_to_reload_count
argument_list|(
name|tmp
argument_list|)
expr_stmt|;
else|else
operator|*
name|v
operator|=
name|tmp
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|REA
argument_list|,
literal|1
argument_list|,
literal|"ucp-read cpu=%d ri=%d msr=0x%x -> v=%jx"
argument_list|,
name|cpu
argument_list|,
name|ri
argument_list|,
name|ri
argument_list|,
operator|*
name|v
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucp_release_pmc
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|,
name|struct
name|pmc
modifier|*
name|pm
parameter_list|)
block|{
operator|(
name|void
operator|)
name|pm
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|REL
argument_list|,
literal|1
argument_list|,
literal|"ucp-release cpu=%d ri=%d pm=%p"
argument_list|,
name|cpu
argument_list|,
name|ri
argument_list|,
name|pm
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|cpu
operator|>=
literal|0
operator|&&
name|cpu
operator|<
name|pmc_cpu_max
argument_list|()
argument_list|,
operator|(
literal|"[uncore,%d] illegal CPU value %d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|ri
operator|>=
literal|0
operator|&&
name|ri
operator|<
name|uncore_ucp_npmc
argument_list|,
operator|(
literal|"[uncore,%d] illegal row-index %d"
operator|,
name|__LINE__
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|uncore_pcpu
index|[
name|cpu
index|]
operator|->
name|pc_uncorepmcs
index|[
name|ri
index|]
operator|.
name|phw_pmc
operator|==
name|NULL
argument_list|,
operator|(
literal|"[uncore,%d] PHW pmc non-NULL"
operator|,
name|__LINE__
operator|)
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucp_start_pmc
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|)
block|{
name|struct
name|pmc
modifier|*
name|pm
decl_stmt|;
name|uint32_t
name|evsel
decl_stmt|;
name|struct
name|uncore_cpu
modifier|*
name|cc
decl_stmt|;
name|KASSERT
argument_list|(
name|cpu
operator|>=
literal|0
operator|&&
name|cpu
operator|<
name|pmc_cpu_max
argument_list|()
argument_list|,
operator|(
literal|"[uncore,%d] illegal CPU value %d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|ri
operator|>=
literal|0
operator|&&
name|ri
operator|<
name|uncore_ucp_npmc
argument_list|,
operator|(
literal|"[uncore,%d] illegal row-index %d"
operator|,
name|__LINE__
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
name|cc
operator|=
name|uncore_pcpu
index|[
name|cpu
index|]
expr_stmt|;
name|pm
operator|=
name|cc
operator|->
name|pc_uncorepmcs
index|[
name|ri
index|]
operator|.
name|phw_pmc
expr_stmt|;
name|KASSERT
argument_list|(
name|pm
argument_list|,
operator|(
literal|"[uncore,%d] starting cpu%d,ri%d with no pmc configured"
operator|,
name|__LINE__
operator|,
name|cpu
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|STA
argument_list|,
literal|1
argument_list|,
literal|"ucp-start cpu=%d ri=%d"
argument_list|,
name|cpu
argument_list|,
name|ri
argument_list|)
expr_stmt|;
name|evsel
operator|=
name|pm
operator|->
name|pm_md
operator|.
name|pm_ucp
operator|.
name|pm_ucp_evsel
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|STA
argument_list|,
literal|2
argument_list|,
literal|"ucp-start/2 cpu=%d ri=%d evselmsr=0x%x evsel=0x%x"
argument_list|,
name|cpu
argument_list|,
name|ri
argument_list|,
name|SELECTSEL
argument_list|(
name|uncore_cputype
argument_list|)
operator|+
name|ri
argument_list|,
name|evsel
argument_list|)
expr_stmt|;
comment|/* Event specific configuration. */
switch|switch
condition|(
name|pm
operator|->
name|pm_event
condition|)
block|{
case|case
name|PMC_EV_UCP_EVENT_0CH_04H_E
case|:
case|case
name|PMC_EV_UCP_EVENT_0CH_08H_E
case|:
name|wrmsr
argument_list|(
name|MSR_GQ_SNOOP_MESF
argument_list|,
literal|0x2
argument_list|)
expr_stmt|;
break|break;
case|case
name|PMC_EV_UCP_EVENT_0CH_04H_F
case|:
case|case
name|PMC_EV_UCP_EVENT_0CH_08H_F
case|:
name|wrmsr
argument_list|(
name|MSR_GQ_SNOOP_MESF
argument_list|,
literal|0x8
argument_list|)
expr_stmt|;
break|break;
case|case
name|PMC_EV_UCP_EVENT_0CH_04H_M
case|:
case|case
name|PMC_EV_UCP_EVENT_0CH_08H_M
case|:
name|wrmsr
argument_list|(
name|MSR_GQ_SNOOP_MESF
argument_list|,
literal|0x1
argument_list|)
expr_stmt|;
break|break;
case|case
name|PMC_EV_UCP_EVENT_0CH_04H_S
case|:
case|case
name|PMC_EV_UCP_EVENT_0CH_08H_S
case|:
name|wrmsr
argument_list|(
name|MSR_GQ_SNOOP_MESF
argument_list|,
literal|0x4
argument_list|)
expr_stmt|;
break|break;
default|default:
break|break;
block|}
name|wrmsr
argument_list|(
name|SELECTSEL
argument_list|(
name|uncore_cputype
argument_list|)
operator|+
name|ri
argument_list|,
name|evsel
argument_list|)
expr_stmt|;
do|do
block|{
name|cc
operator|->
name|pc_resync
operator|=
literal|0
expr_stmt|;
name|cc
operator|->
name|pc_globalctrl
operator||=
operator|(
literal|1ULL
operator|<<
name|ri
operator|)
expr_stmt|;
name|wrmsr
argument_list|(
name|UC_GLOBAL_CTRL
argument_list|,
name|cc
operator|->
name|pc_globalctrl
argument_list|)
expr_stmt|;
block|}
do|while
condition|(
name|cc
operator|->
name|pc_resync
operator|!=
literal|0
condition|)
do|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucp_stop_pmc
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|)
block|{
name|struct
name|pmc
modifier|*
name|pm
decl_stmt|;
name|struct
name|uncore_cpu
modifier|*
name|cc
decl_stmt|;
name|KASSERT
argument_list|(
name|cpu
operator|>=
literal|0
operator|&&
name|cpu
operator|<
name|pmc_cpu_max
argument_list|()
argument_list|,
operator|(
literal|"[uncore,%d] illegal cpu value %d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|ri
operator|>=
literal|0
operator|&&
name|ri
operator|<
name|uncore_ucp_npmc
argument_list|,
operator|(
literal|"[uncore,%d] illegal row index %d"
operator|,
name|__LINE__
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
name|cc
operator|=
name|uncore_pcpu
index|[
name|cpu
index|]
expr_stmt|;
name|pm
operator|=
name|cc
operator|->
name|pc_uncorepmcs
index|[
name|ri
index|]
operator|.
name|phw_pmc
expr_stmt|;
name|KASSERT
argument_list|(
name|pm
argument_list|,
operator|(
literal|"[uncore,%d] cpu%d ri%d no configured PMC to stop"
operator|,
name|__LINE__
operator|,
name|cpu
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|STO
argument_list|,
literal|1
argument_list|,
literal|"ucp-stop cpu=%d ri=%d"
argument_list|,
name|cpu
argument_list|,
name|ri
argument_list|)
expr_stmt|;
comment|/* stop hw. */
name|wrmsr
argument_list|(
name|SELECTSEL
argument_list|(
name|uncore_cputype
argument_list|)
operator|+
name|ri
argument_list|,
literal|0
argument_list|)
expr_stmt|;
do|do
block|{
name|cc
operator|->
name|pc_resync
operator|=
literal|0
expr_stmt|;
name|cc
operator|->
name|pc_globalctrl
operator|&=
operator|~
operator|(
literal|1ULL
operator|<<
name|ri
operator|)
expr_stmt|;
name|wrmsr
argument_list|(
name|UC_GLOBAL_CTRL
argument_list|,
name|cc
operator|->
name|pc_globalctrl
argument_list|)
expr_stmt|;
block|}
do|while
condition|(
name|cc
operator|->
name|pc_resync
operator|!=
literal|0
condition|)
do|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ucp_write_pmc
parameter_list|(
name|int
name|cpu
parameter_list|,
name|int
name|ri
parameter_list|,
name|pmc_value_t
name|v
parameter_list|)
block|{
name|struct
name|pmc
modifier|*
name|pm
decl_stmt|;
name|struct
name|uncore_cpu
modifier|*
name|cc
decl_stmt|;
name|KASSERT
argument_list|(
name|cpu
operator|>=
literal|0
operator|&&
name|cpu
operator|<
name|pmc_cpu_max
argument_list|()
argument_list|,
operator|(
literal|"[uncore,%d] illegal cpu value %d"
operator|,
name|__LINE__
operator|,
name|cpu
operator|)
argument_list|)
expr_stmt|;
name|KASSERT
argument_list|(
name|ri
operator|>=
literal|0
operator|&&
name|ri
operator|<
name|uncore_ucp_npmc
argument_list|,
operator|(
literal|"[uncore,%d] illegal row index %d"
operator|,
name|__LINE__
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
name|cc
operator|=
name|uncore_pcpu
index|[
name|cpu
index|]
expr_stmt|;
name|pm
operator|=
name|cc
operator|->
name|pc_uncorepmcs
index|[
name|ri
index|]
operator|.
name|phw_pmc
expr_stmt|;
name|KASSERT
argument_list|(
name|pm
argument_list|,
operator|(
literal|"[uncore,%d] cpu%d ri%d no configured PMC to stop"
operator|,
name|__LINE__
operator|,
name|cpu
operator|,
name|ri
operator|)
argument_list|)
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|WRI
argument_list|,
literal|1
argument_list|,
literal|"ucp-write cpu=%d ri=%d msr=0x%x v=%jx"
argument_list|,
name|cpu
argument_list|,
name|ri
argument_list|,
name|UCP_PMC0
operator|+
name|ri
argument_list|,
name|v
argument_list|)
expr_stmt|;
if|if
condition|(
name|PMC_IS_SAMPLING_MODE
argument_list|(
name|PMC_TO_MODE
argument_list|(
name|pm
argument_list|)
argument_list|)
condition|)
name|v
operator|=
name|ucp_reload_count_to_perfctr_value
argument_list|(
name|v
argument_list|)
expr_stmt|;
comment|/* 	 * Write the new value to the counter.  The counter will be in 	 * a stopped state when the pcd_write() entry point is called. 	 */
name|wrmsr
argument_list|(
name|UCP_PMC0
operator|+
name|ri
argument_list|,
name|v
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|ucp_initialize
parameter_list|(
name|struct
name|pmc_mdep
modifier|*
name|md
parameter_list|,
name|int
name|maxcpu
parameter_list|,
name|int
name|npmc
parameter_list|,
name|int
name|pmcwidth
parameter_list|)
block|{
name|struct
name|pmc_classdep
modifier|*
name|pcd
decl_stmt|;
name|KASSERT
argument_list|(
name|md
operator|!=
name|NULL
argument_list|,
operator|(
literal|"[ucp,%d] md is NULL"
operator|,
name|__LINE__
operator|)
argument_list|)
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|INI
argument_list|,
literal|1
argument_list|,
literal|"%s"
argument_list|,
literal|"ucp-initialize"
argument_list|)
expr_stmt|;
name|pcd
operator|=
operator|&
name|md
operator|->
name|pmd_classdep
index|[
name|PMC_MDEP_CLASS_INDEX_UCP
index|]
expr_stmt|;
name|pcd
operator|->
name|pcd_caps
operator|=
name|UCP_PMC_CAPS
expr_stmt|;
name|pcd
operator|->
name|pcd_class
operator|=
name|PMC_CLASS_UCP
expr_stmt|;
name|pcd
operator|->
name|pcd_num
operator|=
name|npmc
expr_stmt|;
name|pcd
operator|->
name|pcd_ri
operator|=
name|md
operator|->
name|pmd_npmc
expr_stmt|;
name|pcd
operator|->
name|pcd_width
operator|=
name|pmcwidth
expr_stmt|;
name|pcd
operator|->
name|pcd_allocate_pmc
operator|=
name|ucp_allocate_pmc
expr_stmt|;
name|pcd
operator|->
name|pcd_config_pmc
operator|=
name|ucp_config_pmc
expr_stmt|;
name|pcd
operator|->
name|pcd_describe
operator|=
name|ucp_describe
expr_stmt|;
name|pcd
operator|->
name|pcd_get_config
operator|=
name|ucp_get_config
expr_stmt|;
name|pcd
operator|->
name|pcd_get_msr
operator|=
name|NULL
expr_stmt|;
name|pcd
operator|->
name|pcd_pcpu_fini
operator|=
name|uncore_pcpu_fini
expr_stmt|;
name|pcd
operator|->
name|pcd_pcpu_init
operator|=
name|uncore_pcpu_init
expr_stmt|;
name|pcd
operator|->
name|pcd_read_pmc
operator|=
name|ucp_read_pmc
expr_stmt|;
name|pcd
operator|->
name|pcd_release_pmc
operator|=
name|ucp_release_pmc
expr_stmt|;
name|pcd
operator|->
name|pcd_start_pmc
operator|=
name|ucp_start_pmc
expr_stmt|;
name|pcd
operator|->
name|pcd_stop_pmc
operator|=
name|ucp_stop_pmc
expr_stmt|;
name|pcd
operator|->
name|pcd_write_pmc
operator|=
name|ucp_write_pmc
expr_stmt|;
name|md
operator|->
name|pmd_npmc
operator|+=
name|npmc
expr_stmt|;
block|}
end_function

begin_function
name|int
name|pmc_uncore_initialize
parameter_list|(
name|struct
name|pmc_mdep
modifier|*
name|md
parameter_list|,
name|int
name|maxcpu
parameter_list|)
block|{
name|uncore_cputype
operator|=
name|md
operator|->
name|pmd_cputype
expr_stmt|;
name|uncore_pmcmask
operator|=
literal|0
expr_stmt|;
comment|/* 	 * Initialize programmable counters. 	 */
name|uncore_ucp_npmc
operator|=
literal|8
expr_stmt|;
name|uncore_ucp_width
operator|=
literal|48
expr_stmt|;
name|uncore_pmcmask
operator||=
operator|(
operator|(
literal|1ULL
operator|<<
name|uncore_ucp_npmc
operator|)
operator|-
literal|1
operator|)
expr_stmt|;
name|ucp_initialize
argument_list|(
name|md
argument_list|,
name|maxcpu
argument_list|,
name|uncore_ucp_npmc
argument_list|,
name|uncore_ucp_width
argument_list|)
expr_stmt|;
comment|/* 	 * Initialize fixed function counters, if present. 	 */
name|uncore_ucf_ri
operator|=
name|uncore_ucp_npmc
expr_stmt|;
name|uncore_ucf_npmc
operator|=
literal|1
expr_stmt|;
name|uncore_ucf_width
operator|=
literal|48
expr_stmt|;
name|ucf_initialize
argument_list|(
name|md
argument_list|,
name|maxcpu
argument_list|,
name|uncore_ucf_npmc
argument_list|,
name|uncore_ucf_width
argument_list|)
expr_stmt|;
name|uncore_pmcmask
operator||=
operator|(
operator|(
literal|1ULL
operator|<<
name|uncore_ucf_npmc
operator|)
operator|-
literal|1
operator|)
operator|<<
name|SELECTOFF
argument_list|(
name|uncore_cputype
argument_list|)
expr_stmt|;
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|INI
argument_list|,
literal|1
argument_list|,
literal|"uncore-init pmcmask=0x%jx ucfri=%d"
argument_list|,
name|uncore_pmcmask
argument_list|,
name|uncore_ucf_ri
argument_list|)
expr_stmt|;
name|uncore_pcpu
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
operator|*
name|uncore_pcpu
argument_list|)
operator|*
name|maxcpu
argument_list|,
name|M_PMC
argument_list|,
name|M_ZERO
operator||
name|M_WAITOK
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
name|void
name|pmc_uncore_finalize
parameter_list|(
name|struct
name|pmc_mdep
modifier|*
name|md
parameter_list|)
block|{
name|PMCDBG
argument_list|(
name|MDP
argument_list|,
name|INI
argument_list|,
literal|1
argument_list|,
literal|"%s"
argument_list|,
literal|"uncore-finalize"
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|uncore_pcpu
argument_list|,
name|M_PMC
argument_list|)
expr_stmt|;
name|uncore_pcpu
operator|=
name|NULL
expr_stmt|;
block|}
end_function

end_unit

