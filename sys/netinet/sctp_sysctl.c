begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2007, Cisco Systems, Inc. All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions are met:  *  * a) Redistributions of source code must retain the above copyright notice,  *   this list of conditions and the following disclaimer.  *  * b) Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in  *   the documentation and/or other materials provided with the distribution.  *  * c) Neither the name of Cisco Systems, Inc. nor the names of its  *    contributors may be used to endorse or promote products derived  *    from this software without specific prior written permission.  *  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS  * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,  * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE  * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR  * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF  * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS  * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN  * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF  * THE POSSIBILITY OF SUCH DAMAGE.  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_include
include|#
directive|include
file|<netinet/sctp_os.h>
end_include

begin_include
include|#
directive|include
file|<netinet/sctp_constants.h>
end_include

begin_include
include|#
directive|include
file|<netinet/sctp_sysctl.h>
end_include

begin_include
include|#
directive|include
file|<netinet/sctp_pcb.h>
end_include

begin_include
include|#
directive|include
file|<netinet/sctputil.h>
end_include

begin_comment
comment|/*  * sysctl tunable variables  */
end_comment

begin_decl_stmt
name|uint32_t
name|sctp_sendspace
init|=
operator|(
literal|128
operator|*
literal|1024
operator|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_recvspace
init|=
literal|128
operator|*
operator|(
literal|1024
operator|+
ifdef|#
directive|ifdef
name|INET6
sizeof|sizeof
argument_list|(
expr|struct
name|sockaddr_in6
argument_list|)
else|#
directive|else
sizeof|sizeof
argument_list|(
expr|struct
name|sockaddr_in
argument_list|)
endif|#
directive|endif
operator|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_mbuf_threshold_count
init|=
name|SCTP_DEFAULT_MBUFS_IN_CHAIN
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_auto_asconf
init|=
name|SCTP_DEFAULT_AUTO_ASCONF
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_ecn_enable
init|=
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_ecn_nonce
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_strict_sacks
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_no_csum_on_loopback
init|=
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_strict_init
init|=
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_abort_if_one_2_one_hits_limit
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_strict_data_order
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_peer_chunk_oh
init|=
sizeof|sizeof
argument_list|(
expr|struct
name|mbuf
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_max_burst_default
init|=
name|SCTP_DEF_MAX_BURST
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_use_cwnd_based_maxburst
init|=
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_do_drain
init|=
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_hb_maxburst
init|=
name|SCTP_DEF_MAX_BURST
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_max_chunks_on_queue
init|=
name|SCTP_ASOC_MAX_CHUNKS_ON_QUEUE
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_delayed_sack_time_default
init|=
name|SCTP_RECV_MSEC
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_sack_freq_default
init|=
name|SCTP_DEFAULT_SACK_FREQ
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_heartbeat_interval_default
init|=
name|SCTP_HB_DEFAULT_MSEC
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_pmtu_raise_time_default
init|=
name|SCTP_DEF_PMTU_RAISE_SEC
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_shutdown_guard_time_default
init|=
name|SCTP_DEF_MAX_SHUTDOWN_SEC
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_secret_lifetime_default
init|=
name|SCTP_DEFAULT_SECRET_LIFE_SEC
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_rto_max_default
init|=
name|SCTP_RTO_UPPER_BOUND
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_rto_min_default
init|=
name|SCTP_RTO_LOWER_BOUND
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_rto_initial_default
init|=
name|SCTP_RTO_INITIAL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_init_rto_max_default
init|=
name|SCTP_RTO_UPPER_BOUND
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_valid_cookie_life_default
init|=
name|SCTP_DEFAULT_COOKIE_LIFE
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_init_rtx_max_default
init|=
name|SCTP_DEF_MAX_INIT
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_assoc_rtx_max_default
init|=
name|SCTP_DEF_MAX_SEND
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_path_rtx_max_default
init|=
name|SCTP_DEF_MAX_PATH_RTX
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_nr_outgoing_streams_default
init|=
name|SCTP_OSTREAM_INITIAL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_add_more_threshold
init|=
name|SCTP_DEFAULT_ADD_MORE
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_asoc_free_resc_limit
init|=
name|SCTP_DEF_ASOC_RESC_LIMIT
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_system_free_resc_limit
init|=
name|SCTP_DEF_SYSTEM_RESC_LIMIT
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_min_split_point
init|=
name|SCTP_DEFAULT_SPLIT_POINT_MIN
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_pcbtblsize
init|=
name|SCTP_PCBHASHSIZE
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_hashtblsize
init|=
name|SCTP_TCBHASHSIZE
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_chunkscale
init|=
name|SCTP_CHUNKQUEUE_SCALE
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_cmt_on_off
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_cmt_use_dac
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_L2_abc_variable
init|=
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_early_fr
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_early_fr_msec
init|=
name|SCTP_MINFR_MSEC_TIMER
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_use_rttvar_cc
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_says_check_for_deadlock
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_asconf_auth_nochk
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_auth_disable
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|uint32_t
name|sctp_nat_friendly
init|=
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|sctpstat
name|sctpstat
decl_stmt|;
end_decl_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|SCTP_DEBUG
end_ifdef

begin_decl_stmt
name|uint32_t
name|sctp_debug_on
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/*  * sysctl functions  */
end_comment

begin_function
specifier|static
name|int
name|sctp_assoclist
parameter_list|(
name|SYSCTL_HANDLER_ARGS
parameter_list|)
block|{
name|unsigned
name|int
name|number_of_endpoints
decl_stmt|;
name|unsigned
name|int
name|number_of_local_addresses
decl_stmt|;
name|unsigned
name|int
name|number_of_associations
decl_stmt|;
name|unsigned
name|int
name|number_of_remote_addresses
decl_stmt|;
name|unsigned
name|int
name|n
decl_stmt|;
name|int
name|error
decl_stmt|;
name|struct
name|sctp_inpcb
modifier|*
name|inp
decl_stmt|;
name|struct
name|sctp_tcb
modifier|*
name|stcb
decl_stmt|;
name|struct
name|sctp_nets
modifier|*
name|net
decl_stmt|;
name|struct
name|sctp_laddr
modifier|*
name|laddr
decl_stmt|;
name|struct
name|xsctp_inpcb
name|xinpcb
decl_stmt|;
name|struct
name|xsctp_tcb
name|xstcb
decl_stmt|;
comment|/*	struct xsctp_laddr xladdr; */
name|struct
name|xsctp_raddr
name|xraddr
decl_stmt|;
name|number_of_endpoints
operator|=
literal|0
expr_stmt|;
name|number_of_local_addresses
operator|=
literal|0
expr_stmt|;
name|number_of_associations
operator|=
literal|0
expr_stmt|;
name|number_of_remote_addresses
operator|=
literal|0
expr_stmt|;
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
if|if
condition|(
name|req
operator|->
name|oldptr
operator|==
name|USER_ADDR_NULL
condition|)
block|{
name|LIST_FOREACH
argument_list|(
argument|inp
argument_list|,
argument|&sctppcbinfo.listhead
argument_list|,
argument|sctp_list
argument_list|)
block|{
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|number_of_endpoints
operator|++
expr_stmt|;
comment|/* FIXME MT */
name|LIST_FOREACH
argument_list|(
argument|laddr
argument_list|,
argument|&inp->sctp_addr_list
argument_list|,
argument|sctp_nxt_addr
argument_list|)
block|{
name|number_of_local_addresses
operator|++
expr_stmt|;
block|}
name|LIST_FOREACH
argument_list|(
argument|stcb
argument_list|,
argument|&inp->sctp_asoc_list
argument_list|,
argument|sctp_tcblist
argument_list|)
block|{
name|number_of_associations
operator|++
expr_stmt|;
name|TAILQ_FOREACH
argument_list|(
argument|net
argument_list|,
argument|&stcb->asoc.nets
argument_list|,
argument|sctp_next
argument_list|)
block|{
name|number_of_remote_addresses
operator|++
expr_stmt|;
block|}
block|}
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
block|}
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|n
operator|=
operator|(
name|number_of_endpoints
operator|+
literal|1
operator|)
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_inpcb
argument_list|)
operator|+
name|number_of_local_addresses
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_laddr
argument_list|)
operator|+
name|number_of_associations
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_tcb
argument_list|)
operator|+
name|number_of_remote_addresses
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_raddr
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|SCTP_DEBUG
name|printf
argument_list|(
literal|"inps = %u, stcbs = %u, laddrs = %u, raddrs = %u\n"
argument_list|,
name|number_of_endpoints
argument_list|,
name|number_of_associations
argument_list|,
name|number_of_local_addresses
argument_list|,
name|number_of_remote_addresses
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* request some more memory than needed */
name|req
operator|->
name|oldidx
operator|=
operator|(
name|n
operator|+
name|n
operator|/
literal|8
operator|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
name|req
operator|->
name|newptr
operator|!=
name|USER_ADDR_NULL
condition|)
block|{
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
return|return
name|EPERM
return|;
block|}
name|LIST_FOREACH
argument_list|(
argument|inp
argument_list|,
argument|&sctppcbinfo.listhead
argument_list|,
argument|sctp_list
argument_list|)
block|{
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|number_of_local_addresses
operator|=
literal|0
expr_stmt|;
name|number_of_associations
operator|=
literal|0
expr_stmt|;
comment|/* 		 * LIST_FOREACH(laddr,&inp->sctp_addr_list, sctp_nxt_addr) 		 * { number_of_local_addresses++; } 		 */
name|LIST_FOREACH
argument_list|(
argument|stcb
argument_list|,
argument|&inp->sctp_asoc_list
argument_list|,
argument|sctp_tcblist
argument_list|)
block|{
name|number_of_associations
operator|++
expr_stmt|;
block|}
name|xinpcb
operator|.
name|last
operator|=
literal|0
expr_stmt|;
name|xinpcb
operator|.
name|local_port
operator|=
name|ntohs
argument_list|(
name|inp
operator|->
name|sctp_lport
argument_list|)
expr_stmt|;
name|xinpcb
operator|.
name|number_local_addresses
operator|=
name|number_of_local_addresses
expr_stmt|;
name|xinpcb
operator|.
name|number_associations
operator|=
name|number_of_associations
expr_stmt|;
name|xinpcb
operator|.
name|flags
operator|=
name|inp
operator|->
name|sctp_flags
expr_stmt|;
name|xinpcb
operator|.
name|features
operator|=
name|inp
operator|->
name|sctp_features
expr_stmt|;
name|xinpcb
operator|.
name|total_sends
operator|=
name|inp
operator|->
name|total_sends
expr_stmt|;
name|xinpcb
operator|.
name|total_recvs
operator|=
name|inp
operator|->
name|total_recvs
expr_stmt|;
name|xinpcb
operator|.
name|total_nospaces
operator|=
name|inp
operator|->
name|total_nospaces
expr_stmt|;
name|SCTP_INP_INCR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xinpcb
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_inpcb
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
return|return
name|error
return|;
block|}
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
comment|/* FIXME MT */
comment|/* 		 * LIST_FOREACH(laddr,&inp->sctp_addr_list, sctp_nxt_addr) 		 * { error = SYSCTL_OUT(req,&xladdr, sizeof(struct 		 * xsctp_laddr)); if (error) { #if 		 * defined(SCTP_PER_SOCKET_LOCKING) 		 * SCTP_SOCKET_UNLOCK(SCTP_INP_SO(inp), 1); 		 * SCTP_UNLOCK_SHARED(sctppcbinfo.ipi_ep_mtx); #endif 		 * SCTP_INP_RUNLOCK(inp); SCTP_INP_INFO_RUNLOCK(); return 		 * error; }			} 		 */
name|LIST_FOREACH
argument_list|(
argument|stcb
argument_list|,
argument|&inp->sctp_asoc_list
argument_list|,
argument|sctp_tcblist
argument_list|)
block|{
name|SCTP_TCB_LOCK
argument_list|(
name|stcb
argument_list|)
expr_stmt|;
name|atomic_add_int
argument_list|(
operator|&
name|stcb
operator|->
name|asoc
operator|.
name|refcnt
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|SCTP_TCB_UNLOCK
argument_list|(
name|stcb
argument_list|)
expr_stmt|;
name|number_of_local_addresses
operator|=
literal|0
expr_stmt|;
name|number_of_remote_addresses
operator|=
literal|0
expr_stmt|;
name|TAILQ_FOREACH
argument_list|(
argument|net
argument_list|,
argument|&stcb->asoc.nets
argument_list|,
argument|sctp_next
argument_list|)
block|{
name|number_of_remote_addresses
operator|++
expr_stmt|;
block|}
name|xstcb
operator|.
name|LocalPort
operator|=
name|ntohs
argument_list|(
name|inp
operator|->
name|sctp_lport
argument_list|)
expr_stmt|;
name|xstcb
operator|.
name|RemPort
operator|=
name|ntohs
argument_list|(
name|stcb
operator|->
name|rport
argument_list|)
expr_stmt|;
if|if
condition|(
name|stcb
operator|->
name|asoc
operator|.
name|primary_destination
operator|!=
name|NULL
condition|)
name|xstcb
operator|.
name|RemPrimAddr
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|primary_destination
operator|->
name|ro
operator|.
name|_l_addr
expr_stmt|;
name|xstcb
operator|.
name|HeartBeatInterval
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|heart_beat_delay
expr_stmt|;
name|xstcb
operator|.
name|State
operator|=
name|SCTP_GET_STATE
argument_list|(
operator|&
name|stcb
operator|->
name|asoc
argument_list|)
expr_stmt|;
comment|/* FIXME */
name|xstcb
operator|.
name|InStreams
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|streamincnt
expr_stmt|;
name|xstcb
operator|.
name|OutStreams
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|streamoutcnt
expr_stmt|;
name|xstcb
operator|.
name|MaxRetr
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|overall_error_count
expr_stmt|;
name|xstcb
operator|.
name|PrimProcess
operator|=
literal|0
expr_stmt|;
comment|/* not really supported yet */
name|xstcb
operator|.
name|T1expireds
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|timoinit
operator|+
name|stcb
operator|->
name|asoc
operator|.
name|timocookie
expr_stmt|;
name|xstcb
operator|.
name|T2expireds
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|timoshutdown
operator|+
name|stcb
operator|->
name|asoc
operator|.
name|timoshutdownack
expr_stmt|;
name|xstcb
operator|.
name|RtxChunks
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|marked_retrans
expr_stmt|;
name|xstcb
operator|.
name|StartTime
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|start_time
expr_stmt|;
name|xstcb
operator|.
name|DiscontinuityTime
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|discontinuity_time
expr_stmt|;
name|xstcb
operator|.
name|number_local_addresses
operator|=
name|number_of_local_addresses
expr_stmt|;
name|xstcb
operator|.
name|number_remote_addresses
operator|=
name|number_of_remote_addresses
expr_stmt|;
name|xstcb
operator|.
name|total_sends
operator|=
name|stcb
operator|->
name|total_sends
expr_stmt|;
name|xstcb
operator|.
name|total_recvs
operator|=
name|stcb
operator|->
name|total_recvs
expr_stmt|;
name|xstcb
operator|.
name|local_tag
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|my_vtag
expr_stmt|;
name|xstcb
operator|.
name|remote_tag
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|peer_vtag
expr_stmt|;
name|xstcb
operator|.
name|initial_tsn
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|init_seq_number
expr_stmt|;
name|xstcb
operator|.
name|highest_tsn
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|sending_seq
operator|-
literal|1
expr_stmt|;
name|xstcb
operator|.
name|cumulative_tsn
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|last_acked_seq
expr_stmt|;
name|xstcb
operator|.
name|cumulative_tsn_ack
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|cumulative_tsn
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xstcb
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_tcb
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
name|atomic_add_int
argument_list|(
operator|&
name|stcb
operator|->
name|asoc
operator|.
name|refcnt
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
return|return
name|error
return|;
block|}
name|TAILQ_FOREACH
argument_list|(
argument|net
argument_list|,
argument|&stcb->asoc.nets
argument_list|,
argument|sctp_next
argument_list|)
block|{
name|xraddr
operator|.
name|RemAddr
operator|=
name|net
operator|->
name|ro
operator|.
name|_l_addr
expr_stmt|;
name|xraddr
operator|.
name|RemAddrActive
operator|=
operator|(
operator|(
name|net
operator|->
name|dest_state
operator|&
name|SCTP_ADDR_REACHABLE
operator|)
operator|==
name|SCTP_ADDR_REACHABLE
operator|)
expr_stmt|;
name|xraddr
operator|.
name|RemAddrConfirmed
operator|=
operator|(
operator|(
name|net
operator|->
name|dest_state
operator|&
name|SCTP_ADDR_UNCONFIRMED
operator|)
operator|==
literal|0
operator|)
expr_stmt|;
name|xraddr
operator|.
name|RemAddrHBActive
operator|=
operator|(
operator|(
name|net
operator|->
name|dest_state
operator|&
name|SCTP_ADDR_NOHB
operator|)
operator|==
literal|0
operator|)
expr_stmt|;
name|xraddr
operator|.
name|RemAddrRTO
operator|=
name|net
operator|->
name|RTO
expr_stmt|;
name|xraddr
operator|.
name|RemAddrMaxPathRtx
operator|=
name|net
operator|->
name|failure_threshold
expr_stmt|;
name|xraddr
operator|.
name|RemAddrRtx
operator|=
name|net
operator|->
name|marked_retrans
expr_stmt|;
name|xraddr
operator|.
name|RemAddrErrorCounter
operator|=
name|net
operator|->
name|error_count
expr_stmt|;
name|xraddr
operator|.
name|RemAddrCwnd
operator|=
name|net
operator|->
name|cwnd
expr_stmt|;
name|xraddr
operator|.
name|RemAddrFlightSize
operator|=
name|net
operator|->
name|flight_size
expr_stmt|;
name|xraddr
operator|.
name|RemAddrStartTime
operator|=
name|net
operator|->
name|start_time
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xraddr
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_raddr
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
name|atomic_add_int
argument_list|(
operator|&
name|stcb
operator|->
name|asoc
operator|.
name|refcnt
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
return|return
name|error
return|;
block|}
block|}
name|atomic_add_int
argument_list|(
operator|&
name|stcb
operator|->
name|asoc
operator|.
name|refcnt
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
block|}
name|SCTP_INP_DECR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
block|}
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|xinpcb
operator|.
name|last
operator|=
literal|1
expr_stmt|;
name|xinpcb
operator|.
name|local_port
operator|=
literal|0
expr_stmt|;
name|xinpcb
operator|.
name|number_local_addresses
operator|=
literal|0
expr_stmt|;
name|xinpcb
operator|.
name|number_associations
operator|=
literal|0
expr_stmt|;
name|xinpcb
operator|.
name|flags
operator|=
literal|0
expr_stmt|;
name|xinpcb
operator|.
name|features
operator|=
literal|0
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xinpcb
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_inpcb
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|error
return|;
block|}
end_function

begin_comment
comment|/*  * sysctl definitions  */
end_comment

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|sendspace
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_sendspace
argument_list|,
literal|0
argument_list|,
literal|"Maximum outgoing SCTP buffer size"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|recvspace
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_recvspace
argument_list|,
literal|0
argument_list|,
literal|"Maximum incoming SCTP buffer size"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__FreeBSD__
argument_list|)
operator|||
name|defined
argument_list|(
name|SCTP_APPLE_AUTO_ASCONF
argument_list|)
end_if

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|auto_asconf
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_auto_asconf
argument_list|,
literal|0
argument_list|,
literal|"Enable SCTP Auto-ASCONF"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|ecn_enable
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_ecn_enable
argument_list|,
literal|0
argument_list|,
literal|"Enable SCTP ECN"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|ecn_nonce
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_ecn_nonce
argument_list|,
literal|0
argument_list|,
literal|"Enable SCTP ECN Nonce"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|strict_sacks
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_strict_sacks
argument_list|,
literal|0
argument_list|,
literal|"Enable SCTP Strict SACK checking"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|loopback_nocsum
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_no_csum_on_loopback
argument_list|,
literal|0
argument_list|,
literal|"Enable NO Csum on packets sent on loopback"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|strict_init
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_strict_init
argument_list|,
literal|0
argument_list|,
literal|"Enable strict INIT/INIT-ACK singleton enforcement"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|peer_chkoh
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_peer_chunk_oh
argument_list|,
literal|0
argument_list|,
literal|"Amount to debit peers rwnd per chunk sent"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|maxburst
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_max_burst_default
argument_list|,
literal|0
argument_list|,
literal|"Default max burst for sctp endpoints"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|maxchunks
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_max_chunks_on_queue
argument_list|,
literal|0
argument_list|,
literal|"Default max chunks on queue per asoc"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|tcbhashsize
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_hashtblsize
argument_list|,
literal|0
argument_list|,
literal|"Tuneable for Hash table sizes"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|min_split_point
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_min_split_point
argument_list|,
literal|0
argument_list|,
literal|"Minimum size when splitting a chunk"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|pcbhashsize
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_pcbtblsize
argument_list|,
literal|0
argument_list|,
literal|"Tuneable for PCB Hash table sizes"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|sys_resource
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_system_free_resc_limit
argument_list|,
literal|0
argument_list|,
literal|"Max number of cached resources in the system"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|asoc_resource
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_asoc_free_resc_limit
argument_list|,
literal|0
argument_list|,
literal|"Max number of cached resources in an asoc"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|chunkscale
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_chunkscale
argument_list|,
literal|0
argument_list|,
literal|"Tuneable for Scaling of number of chunks and messages"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|delayed_sack_time
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_delayed_sack_time_default
argument_list|,
literal|0
argument_list|,
literal|"Default delayed SACK timer in msec"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|sack_freq
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_sack_freq_default
argument_list|,
literal|0
argument_list|,
literal|"Default SACK frequency"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|heartbeat_interval
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_heartbeat_interval_default
argument_list|,
literal|0
argument_list|,
literal|"Default heartbeat interval in msec"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|pmtu_raise_time
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_pmtu_raise_time_default
argument_list|,
literal|0
argument_list|,
literal|"Default PMTU raise timer in sec"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|shutdown_guard_time
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_shutdown_guard_time_default
argument_list|,
literal|0
argument_list|,
literal|"Default shutdown guard timer in sec"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|secret_lifetime
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_secret_lifetime_default
argument_list|,
literal|0
argument_list|,
literal|"Default secret lifetime in sec"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|rto_max
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_rto_max_default
argument_list|,
literal|0
argument_list|,
literal|"Default maximum retransmission timeout in msec"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|rto_min
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_rto_min_default
argument_list|,
literal|0
argument_list|,
literal|"Default minimum retransmission timeout in msec"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|rto_initial
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_rto_initial_default
argument_list|,
literal|0
argument_list|,
literal|"Default initial retransmission timeout in msec"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|init_rto_max
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_init_rto_max_default
argument_list|,
literal|0
argument_list|,
literal|"Default maximum retransmission timeout during association setup in msec"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|valid_cookie_life
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_valid_cookie_life_default
argument_list|,
literal|0
argument_list|,
literal|"Default cookie lifetime in sec"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|init_rtx_max
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_init_rtx_max_default
argument_list|,
literal|0
argument_list|,
literal|"Default maximum number of retransmission for INIT chunks"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|assoc_rtx_max
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_assoc_rtx_max_default
argument_list|,
literal|0
argument_list|,
literal|"Default maximum number of retransmissions per association"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|path_rtx_max
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_path_rtx_max_default
argument_list|,
literal|0
argument_list|,
literal|"Default maximum of retransmissions per path"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|add_more_on_output
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_add_more_threshold
argument_list|,
literal|0
argument_list|,
literal|"When space wise is it worthwhile to try to add more to a socket send buffer"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|outgoing_streams
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_nr_outgoing_streams_default
argument_list|,
literal|0
argument_list|,
literal|"Default number of outgoing streams"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|cmt_on_off
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_cmt_on_off
argument_list|,
literal|0
argument_list|,
literal|"CMT ON/OFF flag"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|cwnd_maxburst
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_use_cwnd_based_maxburst
argument_list|,
literal|0
argument_list|,
literal|"Use a CWND adjusting maxburst"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|early_fast_retran
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_early_fr
argument_list|,
literal|0
argument_list|,
literal|"Early Fast Retransmit with timer"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|use_rttvar_congctrl
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_use_rttvar_cc
argument_list|,
literal|0
argument_list|,
literal|"Use congestion control via rtt variation"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|deadlock_detect
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_says_check_for_deadlock
argument_list|,
literal|0
argument_list|,
literal|"SMP Deadlock detection on/off"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|early_fast_retran_msec
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_early_fr_msec
argument_list|,
literal|0
argument_list|,
literal|"Early Fast Retransmit minimum timer value"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|asconf_auth_nochk
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_asconf_auth_nochk
argument_list|,
literal|0
argument_list|,
literal|"Disable SCTP ASCONF AUTH requirement"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|auth_disable
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_auth_disable
argument_list|,
literal|0
argument_list|,
literal|"Disable SCTP AUTH function"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|nat_friendly
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_nat_friendly
argument_list|,
literal|0
argument_list|,
literal|"SCTP NAT friendly operation"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|abc_l_var
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_L2_abc_variable
argument_list|,
literal|0
argument_list|,
literal|"SCTP ABC max increase per SACK (L)"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|max_chained_mbufs
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_mbuf_threshold_count
argument_list|,
literal|0
argument_list|,
literal|"Default max number of small mbufs on a chain"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_UINT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|cmt_use_dac
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_cmt_use_dac
argument_list|,
literal|0
argument_list|,
literal|"CMT DAC ON/OFF flag"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|do_sctp_drain
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_do_drain
argument_list|,
literal|0
argument_list|,
literal|"Should SCTP respond to the drain calls"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|hb_max_burst
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_hb_maxburst
argument_list|,
literal|0
argument_list|,
literal|"Confirmation Heartbeat max burst?"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|abort_at_limit
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_abort_if_one_2_one_hits_limit
argument_list|,
literal|0
argument_list|,
literal|"When one-2-one hits qlimit abort"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|strict_data_order
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_strict_data_order
argument_list|,
literal|0
argument_list|,
literal|"Enforce strict data ordering, abort if control inside data"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_STRUCT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|stats
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctpstat
argument_list|,
name|sctpstat
argument_list|,
literal|"SCTP statistics (struct sctps_stat, netinet/sctp.h"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|assoclist
argument_list|,
name|CTLFLAG_RD
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|sctp_assoclist
argument_list|,
literal|"S,xassoc"
argument_list|,
literal|"List of active SCTP associations"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|SCTP_DEBUG
end_ifdef

begin_expr_stmt
name|SYSCTL_INT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|debug
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|sctp_debug_on
argument_list|,
literal|0
argument_list|,
literal|"Configure debug output"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* SCTP_DEBUG */
end_comment

end_unit

