begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2007, by Cisco Systems, Inc. All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions are met:  *  * a) Redistributions of source code must retain the above copyright notice,  *   this list of conditions and the following disclaimer.  *  * b) Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in  *   the documentation and/or other materials provided with the distribution.  *  * c) Neither the name of Cisco Systems, Inc. nor the names of its  *    contributors may be used to endorse or promote products derived  *    from this software without specific prior written permission.  *  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS  * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,  * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE  * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR  * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF  * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS  * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN  * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF  * THE POSSIBILITY OF SUCH DAMAGE.  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_include
include|#
directive|include
file|<netinet/sctp_os.h>
end_include

begin_include
include|#
directive|include
file|<netinet/sctp.h>
end_include

begin_include
include|#
directive|include
file|<netinet/sctp_constants.h>
end_include

begin_include
include|#
directive|include
file|<netinet/sctp_sysctl.h>
end_include

begin_include
include|#
directive|include
file|<netinet/sctp_pcb.h>
end_include

begin_include
include|#
directive|include
file|<netinet/sctputil.h>
end_include

begin_include
include|#
directive|include
file|<netinet/sctp_output.h>
end_include

begin_comment
comment|/*  * sysctl tunable variables  */
end_comment

begin_function
name|void
name|sctp_init_sysctls
parameter_list|()
block|{
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_sendspace
argument_list|)
operator|=
name|SCTPCTL_MAXDGRAM_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_recvspace
argument_list|)
operator|=
name|SCTPCTL_RECVSPACE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auto_asconf
argument_list|)
operator|=
name|SCTPCTL_AUTOASCONF_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_multiple_asconfs
argument_list|)
operator|=
name|SCTPCTL_MULTIPLEASCONFS_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_ecn_enable
argument_list|)
operator|=
name|SCTPCTL_ECN_ENABLE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_ecn_nonce
argument_list|)
operator|=
name|SCTPCTL_ECN_NONCE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_strict_sacks
argument_list|)
operator|=
name|SCTPCTL_STRICT_SACKS_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_no_csum_on_loopback
argument_list|)
operator|=
name|SCTPCTL_LOOPBACK_NOCSUM_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_strict_init
argument_list|)
operator|=
name|SCTPCTL_STRICT_INIT_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_peer_chunk_oh
argument_list|)
operator|=
name|SCTPCTL_PEER_CHKOH_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_burst_default
argument_list|)
operator|=
name|SCTPCTL_MAXBURST_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_chunks_on_queue
argument_list|)
operator|=
name|SCTPCTL_MAXCHUNKS_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_hashtblsize
argument_list|)
operator|=
name|SCTPCTL_TCBHASHSIZE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pcbtblsize
argument_list|)
operator|=
name|SCTPCTL_PCBHASHSIZE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_min_split_point
argument_list|)
operator|=
name|SCTPCTL_MIN_SPLIT_POINT_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_chunkscale
argument_list|)
operator|=
name|SCTPCTL_CHUNKSCALE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_delayed_sack_time_default
argument_list|)
operator|=
name|SCTPCTL_DELAYED_SACK_TIME_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_sack_freq_default
argument_list|)
operator|=
name|SCTPCTL_SACK_FREQ_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_system_free_resc_limit
argument_list|)
operator|=
name|SCTPCTL_SYS_RESOURCE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asoc_free_resc_limit
argument_list|)
operator|=
name|SCTPCTL_ASOC_RESOURCE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_heartbeat_interval_default
argument_list|)
operator|=
name|SCTPCTL_HEARTBEAT_INTERVAL_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pmtu_raise_time_default
argument_list|)
operator|=
name|SCTPCTL_PMTU_RAISE_TIME_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_shutdown_guard_time_default
argument_list|)
operator|=
name|SCTPCTL_SHUTDOWN_GUARD_TIME_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_secret_lifetime_default
argument_list|)
operator|=
name|SCTPCTL_SECRET_LIFETIME_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_max_default
argument_list|)
operator|=
name|SCTPCTL_RTO_MAX_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_min_default
argument_list|)
operator|=
name|SCTPCTL_RTO_MIN_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_initial_default
argument_list|)
operator|=
name|SCTPCTL_RTO_INITIAL_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_init_rto_max_default
argument_list|)
operator|=
name|SCTPCTL_INIT_RTO_MAX_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_valid_cookie_life_default
argument_list|)
operator|=
name|SCTPCTL_VALID_COOKIE_LIFE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_init_rtx_max_default
argument_list|)
operator|=
name|SCTPCTL_INIT_RTX_MAX_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_assoc_rtx_max_default
argument_list|)
operator|=
name|SCTPCTL_ASSOC_RTX_MAX_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_path_rtx_max_default
argument_list|)
operator|=
name|SCTPCTL_PATH_RTX_MAX_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_add_more_threshold
argument_list|)
operator|=
name|SCTPCTL_ADD_MORE_ON_OUTPUT_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nr_outgoing_streams_default
argument_list|)
operator|=
name|SCTPCTL_OUTGOING_STREAMS_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_cmt_on_off
argument_list|)
operator|=
name|SCTPCTL_CMT_ON_OFF_DEFAULT
expr_stmt|;
comment|/* EY */
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nr_sack_on_off
argument_list|)
operator|=
name|SCTPCTL_NR_SACK_ON_OFF_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_cmt_use_dac
argument_list|)
operator|=
name|SCTPCTL_CMT_USE_DAC_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_cmt_pf
argument_list|)
operator|=
name|SCTPCTL_CMT_PF_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_use_cwnd_based_maxburst
argument_list|)
operator|=
name|SCTPCTL_CWND_MAXBURST_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_early_fr
argument_list|)
operator|=
name|SCTPCTL_EARLY_FAST_RETRAN_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_early_fr_msec
argument_list|)
operator|=
name|SCTPCTL_EARLY_FAST_RETRAN_MSEC_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asconf_auth_nochk
argument_list|)
operator|=
name|SCTPCTL_ASCONF_AUTH_NOCHK_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auth_disable
argument_list|)
operator|=
name|SCTPCTL_AUTH_DISABLE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nat_friendly
argument_list|)
operator|=
name|SCTPCTL_NAT_FRIENDLY_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_L2_abc_variable
argument_list|)
operator|=
name|SCTPCTL_ABC_L_VAR_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mbuf_threshold_count
argument_list|)
operator|=
name|SCTPCTL_MAX_CHAINED_MBUFS_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_do_drain
argument_list|)
operator|=
name|SCTPCTL_DO_SCTP_DRAIN_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_hb_maxburst
argument_list|)
operator|=
name|SCTPCTL_HB_MAX_BURST_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_abort_if_one_2_one_hits_limit
argument_list|)
operator|=
name|SCTPCTL_ABORT_AT_LIMIT_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_strict_data_order
argument_list|)
operator|=
name|SCTPCTL_STRICT_DATA_ORDER_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_min_residual
argument_list|)
operator|=
name|SCTPCTL_MIN_RESIDUAL_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_retran_chunk
argument_list|)
operator|=
name|SCTPCTL_MAX_RETRAN_CHUNK_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_logging_level
argument_list|)
operator|=
name|SCTPCTL_LOGGING_LEVEL_DEFAULT
expr_stmt|;
comment|/* JRS - Variable for default congestion control module */
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_default_cc_module
argument_list|)
operator|=
name|SCTPCTL_DEFAULT_CC_MODULE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_default_frag_interleave
argument_list|)
operator|=
name|SCTPCTL_DEFAULT_FRAG_INTERLEAVE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mobility_base
argument_list|)
operator|=
name|SCTPCTL_MOBILITY_BASE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mobility_fasthandoff
argument_list|)
operator|=
name|SCTPCTL_MOBILITY_FASTHANDOFF_DEFAULT
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|SCTP_LOCAL_TRACE_BUF
argument_list|)
name|memset
argument_list|(
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_log
argument_list|)
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|sctp_log
argument_list|)
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_udp_tunneling_for_client_enable
argument_list|)
operator|=
name|SCTPCTL_UDP_TUNNELING_FOR_CLIENT_ENABLE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_udp_tunneling_port
argument_list|)
operator|=
name|SCTPCTL_UDP_TUNNELING_PORT_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_enable_sack_immediately
argument_list|)
operator|=
name|SCTPCTL_SACK_IMMEDIATELY_ENABLE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_inits_include_nat_friendly
argument_list|)
operator|=
name|SCTPCTL_NAT_FRIENDLY_DEFAULT
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|SCTP_DEBUG
argument_list|)
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_debug_on
argument_list|)
operator|=
name|SCTPCTL_DEBUG_DEFAULT
expr_stmt|;
endif|#
directive|endif
if|#
directive|if
name|defined
argument_list|(
name|__APPLE__
argument_list|)
operator|||
name|defined
argument_list|(
name|SCTP_SO_LOCK_TESTING
argument_list|)
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_output_unlocked
argument_list|)
operator|=
name|SCTPCTL_OUTPUT_UNLOCKED_DEFAULT
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_comment
comment|/* It returns an upper limit. No filtering is done here */
end_comment

begin_function
specifier|static
name|unsigned
name|int
name|number_of_addresses
parameter_list|(
name|struct
name|sctp_inpcb
modifier|*
name|inp
parameter_list|)
block|{
name|int
name|cnt
decl_stmt|;
name|struct
name|sctp_vrf
modifier|*
name|vrf
decl_stmt|;
name|struct
name|sctp_ifn
modifier|*
name|sctp_ifn
decl_stmt|;
name|struct
name|sctp_ifa
modifier|*
name|sctp_ifa
decl_stmt|;
name|struct
name|sctp_laddr
modifier|*
name|laddr
decl_stmt|;
name|cnt
operator|=
literal|0
expr_stmt|;
comment|/* neither Mac OS X nor FreeBSD support mulitple routing functions */
if|if
condition|(
operator|(
name|vrf
operator|=
name|sctp_find_vrf
argument_list|(
name|inp
operator|->
name|def_vrf_id
argument_list|)
operator|)
operator|==
name|NULL
condition|)
block|{
return|return
operator|(
literal|0
operator|)
return|;
block|}
if|if
condition|(
name|inp
operator|->
name|sctp_flags
operator|&
name|SCTP_PCB_FLAGS_BOUNDALL
condition|)
block|{
name|LIST_FOREACH
argument_list|(
argument|sctp_ifn
argument_list|,
argument|&vrf->ifnlist
argument_list|,
argument|next_ifn
argument_list|)
block|{
name|LIST_FOREACH
argument_list|(
argument|sctp_ifa
argument_list|,
argument|&sctp_ifn->ifalist
argument_list|,
argument|next_ifa
argument_list|)
block|{
if|if
condition|(
operator|(
name|sctp_ifa
operator|->
name|address
operator|.
name|sa
operator|.
name|sa_family
operator|==
name|AF_INET
operator|)
operator|||
operator|(
name|sctp_ifa
operator|->
name|address
operator|.
name|sa
operator|.
name|sa_family
operator|==
name|AF_INET6
operator|)
condition|)
block|{
name|cnt
operator|++
expr_stmt|;
block|}
block|}
block|}
block|}
else|else
block|{
name|LIST_FOREACH
argument_list|(
argument|laddr
argument_list|,
argument|&inp->sctp_addr_list
argument_list|,
argument|sctp_nxt_addr
argument_list|)
block|{
if|if
condition|(
operator|(
name|laddr
operator|->
name|ifa
operator|->
name|address
operator|.
name|sa
operator|.
name|sa_family
operator|==
name|AF_INET
operator|)
operator|||
operator|(
name|laddr
operator|->
name|ifa
operator|->
name|address
operator|.
name|sa
operator|.
name|sa_family
operator|==
name|AF_INET6
operator|)
condition|)
block|{
name|cnt
operator|++
expr_stmt|;
block|}
block|}
block|}
return|return
operator|(
name|cnt
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|copy_out_local_addresses
parameter_list|(
name|struct
name|sctp_inpcb
modifier|*
name|inp
parameter_list|,
name|struct
name|sctp_tcb
modifier|*
name|stcb
parameter_list|,
name|struct
name|sysctl_req
modifier|*
name|req
parameter_list|)
block|{
name|struct
name|sctp_ifn
modifier|*
name|sctp_ifn
decl_stmt|;
name|struct
name|sctp_ifa
modifier|*
name|sctp_ifa
decl_stmt|;
name|int
name|loopback_scope
decl_stmt|,
name|ipv4_local_scope
decl_stmt|,
name|local_scope
decl_stmt|,
name|site_scope
decl_stmt|;
name|int
name|ipv4_addr_legal
decl_stmt|,
name|ipv6_addr_legal
decl_stmt|;
name|struct
name|sctp_vrf
modifier|*
name|vrf
decl_stmt|;
name|struct
name|xsctp_laddr
name|xladdr
decl_stmt|;
name|struct
name|sctp_laddr
modifier|*
name|laddr
decl_stmt|;
name|int
name|error
decl_stmt|;
comment|/* Turn on all the appropriate scope */
if|if
condition|(
name|stcb
condition|)
block|{
comment|/* use association specific values */
name|loopback_scope
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|loopback_scope
expr_stmt|;
name|ipv4_local_scope
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|ipv4_local_scope
expr_stmt|;
name|local_scope
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|local_scope
expr_stmt|;
name|site_scope
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|site_scope
expr_stmt|;
block|}
else|else
block|{
comment|/* use generic values for endpoints */
name|loopback_scope
operator|=
literal|1
expr_stmt|;
name|ipv4_local_scope
operator|=
literal|1
expr_stmt|;
name|local_scope
operator|=
literal|1
expr_stmt|;
name|site_scope
operator|=
literal|1
expr_stmt|;
block|}
comment|/* use only address families of interest */
if|if
condition|(
name|inp
operator|->
name|sctp_flags
operator|&
name|SCTP_PCB_FLAGS_BOUND_V6
condition|)
block|{
name|ipv6_addr_legal
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|SCTP_IPV6_V6ONLY
argument_list|(
name|inp
argument_list|)
condition|)
block|{
name|ipv4_addr_legal
operator|=
literal|0
expr_stmt|;
block|}
else|else
block|{
name|ipv4_addr_legal
operator|=
literal|1
expr_stmt|;
block|}
block|}
else|else
block|{
name|ipv4_addr_legal
operator|=
literal|1
expr_stmt|;
name|ipv6_addr_legal
operator|=
literal|0
expr_stmt|;
block|}
name|error
operator|=
literal|0
expr_stmt|;
comment|/* neither Mac OS X nor FreeBSD support mulitple routing functions */
if|if
condition|(
operator|(
name|vrf
operator|=
name|sctp_find_vrf
argument_list|(
name|inp
operator|->
name|def_vrf_id
argument_list|)
operator|)
operator|==
name|NULL
condition|)
block|{
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
return|return
operator|(
operator|-
literal|1
operator|)
return|;
block|}
if|if
condition|(
name|inp
operator|->
name|sctp_flags
operator|&
name|SCTP_PCB_FLAGS_BOUNDALL
condition|)
block|{
name|LIST_FOREACH
argument_list|(
argument|sctp_ifn
argument_list|,
argument|&vrf->ifnlist
argument_list|,
argument|next_ifn
argument_list|)
block|{
if|if
condition|(
operator|(
name|loopback_scope
operator|==
literal|0
operator|)
operator|&&
name|SCTP_IFN_IS_IFT_LOOP
argument_list|(
name|sctp_ifn
argument_list|)
condition|)
comment|/* Skip loopback if loopback_scope not set */
continue|continue;
name|LIST_FOREACH
argument_list|(
argument|sctp_ifa
argument_list|,
argument|&sctp_ifn->ifalist
argument_list|,
argument|next_ifa
argument_list|)
block|{
if|if
condition|(
name|stcb
condition|)
block|{
comment|/* 					 * ignore if blacklisted at 					 * association level 					 */
if|if
condition|(
name|sctp_is_addr_restricted
argument_list|(
name|stcb
argument_list|,
name|sctp_ifa
argument_list|)
condition|)
continue|continue;
block|}
switch|switch
condition|(
name|sctp_ifa
operator|->
name|address
operator|.
name|sa
operator|.
name|sa_family
condition|)
block|{
case|case
name|AF_INET
case|:
if|if
condition|(
name|ipv4_addr_legal
condition|)
block|{
name|struct
name|sockaddr_in
modifier|*
name|sin
decl_stmt|;
name|sin
operator|=
operator|(
expr|struct
name|sockaddr_in
operator|*
operator|)
operator|&
name|sctp_ifa
operator|->
name|address
operator|.
name|sa
expr_stmt|;
if|if
condition|(
name|sin
operator|->
name|sin_addr
operator|.
name|s_addr
operator|==
literal|0
condition|)
continue|continue;
if|if
condition|(
operator|(
name|ipv4_local_scope
operator|==
literal|0
operator|)
operator|&&
operator|(
name|IN4_ISPRIVATE_ADDRESS
argument_list|(
operator|&
name|sin
operator|->
name|sin_addr
argument_list|)
operator|)
condition|)
continue|continue;
block|}
else|else
block|{
continue|continue;
block|}
break|break;
ifdef|#
directive|ifdef
name|INET6
case|case
name|AF_INET6
case|:
if|if
condition|(
name|ipv6_addr_legal
condition|)
block|{
name|struct
name|sockaddr_in6
modifier|*
name|sin6
decl_stmt|;
name|sin6
operator|=
operator|(
expr|struct
name|sockaddr_in6
operator|*
operator|)
operator|&
name|sctp_ifa
operator|->
name|address
operator|.
name|sa
expr_stmt|;
if|if
condition|(
name|IN6_IS_ADDR_UNSPECIFIED
argument_list|(
operator|&
name|sin6
operator|->
name|sin6_addr
argument_list|)
condition|)
continue|continue;
if|if
condition|(
name|IN6_IS_ADDR_LINKLOCAL
argument_list|(
operator|&
name|sin6
operator|->
name|sin6_addr
argument_list|)
condition|)
block|{
if|if
condition|(
name|local_scope
operator|==
literal|0
condition|)
continue|continue;
if|if
condition|(
name|sin6
operator|->
name|sin6_scope_id
operator|==
literal|0
condition|)
block|{
comment|/* 								 * bad link 								 * local 								 * address 								 */
if|if
condition|(
name|sa6_recoverscope
argument_list|(
name|sin6
argument_list|)
operator|!=
literal|0
condition|)
continue|continue;
block|}
block|}
if|if
condition|(
operator|(
name|site_scope
operator|==
literal|0
operator|)
operator|&&
operator|(
name|IN6_IS_ADDR_SITELOCAL
argument_list|(
operator|&
name|sin6
operator|->
name|sin6_addr
argument_list|)
operator|)
condition|)
continue|continue;
block|}
else|else
block|{
continue|continue;
block|}
break|break;
endif|#
directive|endif
default|default:
continue|continue;
block|}
name|memset
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|xladdr
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_laddr
argument_list|)
argument_list|)
expr_stmt|;
name|memcpy
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|xladdr
operator|.
name|address
argument_list|,
operator|(
specifier|const
name|void
operator|*
operator|)
operator|&
name|sctp_ifa
operator|->
name|address
argument_list|,
sizeof|sizeof
argument_list|(
expr|union
name|sctp_sockstore
argument_list|)
argument_list|)
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xladdr
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_laddr
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
return|return
operator|(
name|error
operator|)
return|;
block|}
else|else
block|{
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
block|}
block|}
block|}
block|}
else|else
block|{
name|LIST_FOREACH
argument_list|(
argument|laddr
argument_list|,
argument|&inp->sctp_addr_list
argument_list|,
argument|sctp_nxt_addr
argument_list|)
block|{
comment|/* ignore if blacklisted at association level */
if|if
condition|(
name|stcb
operator|&&
name|sctp_is_addr_restricted
argument_list|(
name|stcb
argument_list|,
name|laddr
operator|->
name|ifa
argument_list|)
condition|)
continue|continue;
name|memset
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|xladdr
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_laddr
argument_list|)
argument_list|)
expr_stmt|;
name|memcpy
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|xladdr
operator|.
name|address
argument_list|,
operator|(
specifier|const
name|void
operator|*
operator|)
operator|&
name|laddr
operator|->
name|ifa
operator|->
name|address
argument_list|,
sizeof|sizeof
argument_list|(
expr|union
name|sctp_sockstore
argument_list|)
argument_list|)
expr_stmt|;
name|xladdr
operator|.
name|start_time
operator|.
name|tv_sec
operator|=
operator|(
name|uint32_t
operator|)
name|laddr
operator|->
name|start_time
operator|.
name|tv_sec
expr_stmt|;
name|xladdr
operator|.
name|start_time
operator|.
name|tv_usec
operator|=
operator|(
name|uint32_t
operator|)
name|laddr
operator|->
name|start_time
operator|.
name|tv_usec
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xladdr
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_laddr
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
return|return
operator|(
name|error
operator|)
return|;
block|}
else|else
block|{
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
block|}
block|}
block|}
name|memset
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|xladdr
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_laddr
argument_list|)
argument_list|)
expr_stmt|;
name|xladdr
operator|.
name|last
operator|=
literal|1
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xladdr
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_laddr
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
return|return
operator|(
name|error
operator|)
return|;
block|}
else|else
block|{
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
block|}
end_function

begin_comment
comment|/*  * sysctl functions  */
end_comment

begin_function
specifier|static
name|int
name|sctp_assoclist
parameter_list|(
name|SYSCTL_HANDLER_ARGS
parameter_list|)
block|{
name|unsigned
name|int
name|number_of_endpoints
decl_stmt|;
name|unsigned
name|int
name|number_of_local_addresses
decl_stmt|;
name|unsigned
name|int
name|number_of_associations
decl_stmt|;
name|unsigned
name|int
name|number_of_remote_addresses
decl_stmt|;
name|unsigned
name|int
name|n
decl_stmt|;
name|int
name|error
decl_stmt|;
name|struct
name|sctp_inpcb
modifier|*
name|inp
decl_stmt|;
name|struct
name|sctp_tcb
modifier|*
name|stcb
decl_stmt|;
name|struct
name|sctp_nets
modifier|*
name|net
decl_stmt|;
name|struct
name|xsctp_inpcb
name|xinpcb
decl_stmt|;
name|struct
name|xsctp_tcb
name|xstcb
decl_stmt|;
name|struct
name|xsctp_raddr
name|xraddr
decl_stmt|;
name|number_of_endpoints
operator|=
literal|0
expr_stmt|;
name|number_of_local_addresses
operator|=
literal|0
expr_stmt|;
name|number_of_associations
operator|=
literal|0
expr_stmt|;
name|number_of_remote_addresses
operator|=
literal|0
expr_stmt|;
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
if|if
condition|(
name|req
operator|->
name|oldptr
operator|==
name|USER_ADDR_NULL
condition|)
block|{
name|LIST_FOREACH
argument_list|(
argument|inp
argument_list|,
argument|&SCTP_BASE_INFO(listhead)
argument_list|,
argument|sctp_list
argument_list|)
block|{
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|number_of_endpoints
operator|++
expr_stmt|;
name|number_of_local_addresses
operator|+=
name|number_of_addresses
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|LIST_FOREACH
argument_list|(
argument|stcb
argument_list|,
argument|&inp->sctp_asoc_list
argument_list|,
argument|sctp_tcblist
argument_list|)
block|{
name|number_of_associations
operator|++
expr_stmt|;
name|number_of_local_addresses
operator|+=
name|number_of_addresses
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|TAILQ_FOREACH
argument_list|(
argument|net
argument_list|,
argument|&stcb->asoc.nets
argument_list|,
argument|sctp_next
argument_list|)
block|{
name|number_of_remote_addresses
operator|++
expr_stmt|;
block|}
block|}
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
block|}
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|n
operator|=
operator|(
name|number_of_endpoints
operator|+
literal|1
operator|)
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_inpcb
argument_list|)
operator|+
operator|(
name|number_of_local_addresses
operator|+
name|number_of_endpoints
operator|+
name|number_of_associations
operator|)
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_laddr
argument_list|)
operator|+
operator|(
name|number_of_associations
operator|+
name|number_of_endpoints
operator|)
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_tcb
argument_list|)
operator|+
operator|(
name|number_of_remote_addresses
operator|+
name|number_of_associations
operator|)
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_raddr
argument_list|)
expr_stmt|;
comment|/* request some more memory than needed */
name|req
operator|->
name|oldidx
operator|=
operator|(
name|n
operator|+
name|n
operator|/
literal|8
operator|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
name|req
operator|->
name|newptr
operator|!=
name|USER_ADDR_NULL
condition|)
block|{
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|SCTP_LTRACE_ERR_RET
argument_list|(
name|NULL
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|SCTP_FROM_SCTP_SYSCTL
argument_list|,
name|EPERM
argument_list|)
expr_stmt|;
return|return
name|EPERM
return|;
block|}
name|LIST_FOREACH
argument_list|(
argument|inp
argument_list|,
argument|&SCTP_BASE_INFO(listhead)
argument_list|,
argument|sctp_list
argument_list|)
block|{
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|xinpcb
operator|.
name|last
operator|=
literal|0
expr_stmt|;
name|xinpcb
operator|.
name|local_port
operator|=
name|ntohs
argument_list|(
name|inp
operator|->
name|sctp_lport
argument_list|)
expr_stmt|;
name|xinpcb
operator|.
name|flags
operator|=
name|inp
operator|->
name|sctp_flags
expr_stmt|;
name|xinpcb
operator|.
name|features
operator|=
name|inp
operator|->
name|sctp_features
expr_stmt|;
name|xinpcb
operator|.
name|total_sends
operator|=
name|inp
operator|->
name|total_sends
expr_stmt|;
name|xinpcb
operator|.
name|total_recvs
operator|=
name|inp
operator|->
name|total_recvs
expr_stmt|;
name|xinpcb
operator|.
name|total_nospaces
operator|=
name|inp
operator|->
name|total_nospaces
expr_stmt|;
name|xinpcb
operator|.
name|fragmentation_point
operator|=
name|inp
operator|->
name|sctp_frag_point
expr_stmt|;
if|if
condition|(
operator|(
name|inp
operator|->
name|sctp_flags
operator|&
name|SCTP_PCB_FLAGS_SOCKET_ALLGONE
operator|)
operator|||
operator|(
name|inp
operator|->
name|sctp_flags
operator|&
name|SCTP_PCB_FLAGS_SOCKET_GONE
operator|)
condition|)
block|{
name|xinpcb
operator|.
name|qlen
operator|=
literal|0
expr_stmt|;
name|xinpcb
operator|.
name|maxqlen
operator|=
literal|0
expr_stmt|;
block|}
else|else
block|{
name|xinpcb
operator|.
name|qlen
operator|=
name|inp
operator|->
name|sctp_socket
operator|->
name|so_qlen
expr_stmt|;
name|xinpcb
operator|.
name|maxqlen
operator|=
name|inp
operator|->
name|sctp_socket
operator|->
name|so_qlimit
expr_stmt|;
block|}
name|SCTP_INP_INCR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xinpcb
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_inpcb
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
name|SCTP_INP_DECR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
return|return
name|error
return|;
block|}
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|error
operator|=
name|copy_out_local_addresses
argument_list|(
name|inp
argument_list|,
name|NULL
argument_list|,
name|req
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
name|SCTP_INP_DECR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
return|return
name|error
return|;
block|}
name|LIST_FOREACH
argument_list|(
argument|stcb
argument_list|,
argument|&inp->sctp_asoc_list
argument_list|,
argument|sctp_tcblist
argument_list|)
block|{
name|SCTP_TCB_LOCK
argument_list|(
name|stcb
argument_list|)
expr_stmt|;
name|atomic_add_int
argument_list|(
operator|&
name|stcb
operator|->
name|asoc
operator|.
name|refcnt
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|SCTP_TCB_UNLOCK
argument_list|(
name|stcb
argument_list|)
expr_stmt|;
name|xstcb
operator|.
name|last
operator|=
literal|0
expr_stmt|;
name|xstcb
operator|.
name|local_port
operator|=
name|ntohs
argument_list|(
name|inp
operator|->
name|sctp_lport
argument_list|)
expr_stmt|;
name|xstcb
operator|.
name|remote_port
operator|=
name|ntohs
argument_list|(
name|stcb
operator|->
name|rport
argument_list|)
expr_stmt|;
if|if
condition|(
name|stcb
operator|->
name|asoc
operator|.
name|primary_destination
operator|!=
name|NULL
condition|)
name|xstcb
operator|.
name|primary_addr
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|primary_destination
operator|->
name|ro
operator|.
name|_l_addr
expr_stmt|;
name|xstcb
operator|.
name|heartbeat_interval
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|heart_beat_delay
expr_stmt|;
name|xstcb
operator|.
name|state
operator|=
name|SCTP_GET_STATE
argument_list|(
operator|&
name|stcb
operator|->
name|asoc
argument_list|)
expr_stmt|;
comment|/* FIXME */
comment|/* 7.0 does not support these */
name|xstcb
operator|.
name|assoc_id
operator|=
name|sctp_get_associd
argument_list|(
name|stcb
argument_list|)
expr_stmt|;
name|xstcb
operator|.
name|peers_rwnd
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|peers_rwnd
expr_stmt|;
name|xstcb
operator|.
name|in_streams
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|streamincnt
expr_stmt|;
name|xstcb
operator|.
name|out_streams
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|streamoutcnt
expr_stmt|;
name|xstcb
operator|.
name|max_nr_retrans
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|overall_error_count
expr_stmt|;
name|xstcb
operator|.
name|primary_process
operator|=
literal|0
expr_stmt|;
comment|/* not really supported 							 * yet */
name|xstcb
operator|.
name|T1_expireries
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|timoinit
operator|+
name|stcb
operator|->
name|asoc
operator|.
name|timocookie
expr_stmt|;
name|xstcb
operator|.
name|T2_expireries
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|timoshutdown
operator|+
name|stcb
operator|->
name|asoc
operator|.
name|timoshutdownack
expr_stmt|;
name|xstcb
operator|.
name|retransmitted_tsns
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|marked_retrans
expr_stmt|;
name|xstcb
operator|.
name|start_time
operator|.
name|tv_sec
operator|=
operator|(
name|uint32_t
operator|)
name|stcb
operator|->
name|asoc
operator|.
name|start_time
operator|.
name|tv_sec
expr_stmt|;
name|xstcb
operator|.
name|start_time
operator|.
name|tv_usec
operator|=
operator|(
name|uint32_t
operator|)
name|stcb
operator|->
name|asoc
operator|.
name|start_time
operator|.
name|tv_usec
expr_stmt|;
name|xstcb
operator|.
name|discontinuity_time
operator|.
name|tv_sec
operator|=
operator|(
name|uint32_t
operator|)
name|stcb
operator|->
name|asoc
operator|.
name|discontinuity_time
operator|.
name|tv_sec
expr_stmt|;
name|xstcb
operator|.
name|discontinuity_time
operator|.
name|tv_usec
operator|=
operator|(
name|uint32_t
operator|)
name|stcb
operator|->
name|asoc
operator|.
name|discontinuity_time
operator|.
name|tv_usec
expr_stmt|;
name|xstcb
operator|.
name|total_sends
operator|=
name|stcb
operator|->
name|total_sends
expr_stmt|;
name|xstcb
operator|.
name|total_recvs
operator|=
name|stcb
operator|->
name|total_recvs
expr_stmt|;
name|xstcb
operator|.
name|local_tag
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|my_vtag
expr_stmt|;
name|xstcb
operator|.
name|remote_tag
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|peer_vtag
expr_stmt|;
name|xstcb
operator|.
name|initial_tsn
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|init_seq_number
expr_stmt|;
name|xstcb
operator|.
name|highest_tsn
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|sending_seq
operator|-
literal|1
expr_stmt|;
name|xstcb
operator|.
name|cumulative_tsn
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|last_acked_seq
expr_stmt|;
name|xstcb
operator|.
name|cumulative_tsn_ack
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|cumulative_tsn
expr_stmt|;
name|xstcb
operator|.
name|mtu
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|smallest_mtu
expr_stmt|;
name|xstcb
operator|.
name|refcnt
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|refcnt
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xstcb
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_tcb
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
name|SCTP_INP_DECR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|atomic_subtract_int
argument_list|(
operator|&
name|stcb
operator|->
name|asoc
operator|.
name|refcnt
argument_list|,
literal|1
argument_list|)
expr_stmt|;
return|return
name|error
return|;
block|}
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|error
operator|=
name|copy_out_local_addresses
argument_list|(
name|inp
argument_list|,
name|stcb
argument_list|,
name|req
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
name|SCTP_INP_DECR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|atomic_subtract_int
argument_list|(
operator|&
name|stcb
operator|->
name|asoc
operator|.
name|refcnt
argument_list|,
literal|1
argument_list|)
expr_stmt|;
return|return
name|error
return|;
block|}
name|TAILQ_FOREACH
argument_list|(
argument|net
argument_list|,
argument|&stcb->asoc.nets
argument_list|,
argument|sctp_next
argument_list|)
block|{
name|xraddr
operator|.
name|last
operator|=
literal|0
expr_stmt|;
name|xraddr
operator|.
name|address
operator|=
name|net
operator|->
name|ro
operator|.
name|_l_addr
expr_stmt|;
name|xraddr
operator|.
name|active
operator|=
operator|(
operator|(
name|net
operator|->
name|dest_state
operator|&
name|SCTP_ADDR_REACHABLE
operator|)
operator|==
name|SCTP_ADDR_REACHABLE
operator|)
expr_stmt|;
name|xraddr
operator|.
name|confirmed
operator|=
operator|(
operator|(
name|net
operator|->
name|dest_state
operator|&
name|SCTP_ADDR_UNCONFIRMED
operator|)
operator|==
literal|0
operator|)
expr_stmt|;
name|xraddr
operator|.
name|heartbeat_enabled
operator|=
operator|(
operator|(
name|net
operator|->
name|dest_state
operator|&
name|SCTP_ADDR_NOHB
operator|)
operator|==
literal|0
operator|)
expr_stmt|;
name|xraddr
operator|.
name|rto
operator|=
name|net
operator|->
name|RTO
expr_stmt|;
name|xraddr
operator|.
name|max_path_rtx
operator|=
name|net
operator|->
name|failure_threshold
expr_stmt|;
name|xraddr
operator|.
name|rtx
operator|=
name|net
operator|->
name|marked_retrans
expr_stmt|;
name|xraddr
operator|.
name|error_counter
operator|=
name|net
operator|->
name|error_count
expr_stmt|;
name|xraddr
operator|.
name|cwnd
operator|=
name|net
operator|->
name|cwnd
expr_stmt|;
name|xraddr
operator|.
name|flight_size
operator|=
name|net
operator|->
name|flight_size
expr_stmt|;
name|xraddr
operator|.
name|mtu
operator|=
name|net
operator|->
name|mtu
expr_stmt|;
name|xraddr
operator|.
name|rtt
operator|=
name|net
operator|->
name|rtt
expr_stmt|;
name|xraddr
operator|.
name|start_time
operator|.
name|tv_sec
operator|=
operator|(
name|uint32_t
operator|)
name|net
operator|->
name|start_time
operator|.
name|tv_sec
expr_stmt|;
name|xraddr
operator|.
name|start_time
operator|.
name|tv_usec
operator|=
operator|(
name|uint32_t
operator|)
name|net
operator|->
name|start_time
operator|.
name|tv_usec
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xraddr
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_raddr
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
name|SCTP_INP_DECR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|atomic_subtract_int
argument_list|(
operator|&
name|stcb
operator|->
name|asoc
operator|.
name|refcnt
argument_list|,
literal|1
argument_list|)
expr_stmt|;
return|return
name|error
return|;
block|}
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
block|}
name|atomic_subtract_int
argument_list|(
operator|&
name|stcb
operator|->
name|asoc
operator|.
name|refcnt
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|memset
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|xraddr
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_raddr
argument_list|)
argument_list|)
expr_stmt|;
name|xraddr
operator|.
name|last
operator|=
literal|1
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xraddr
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_raddr
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
name|SCTP_INP_DECR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
return|return
name|error
return|;
block|}
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
block|}
name|SCTP_INP_DECR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|memset
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|xstcb
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_tcb
argument_list|)
argument_list|)
expr_stmt|;
name|xstcb
operator|.
name|last
operator|=
literal|1
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xstcb
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_tcb
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
return|return
name|error
return|;
block|}
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
block|}
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|memset
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|xinpcb
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_inpcb
argument_list|)
argument_list|)
expr_stmt|;
name|xinpcb
operator|.
name|last
operator|=
literal|1
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xinpcb
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_inpcb
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|error
return|;
block|}
end_function

begin_define
define|#
directive|define
name|RANGECHK
parameter_list|(
name|var
parameter_list|,
name|min
parameter_list|,
name|max
parameter_list|)
define|\
value|if ((var)< (min)) { (var) = (min); } \ 	else if ((var)> (max)) { (var) = (max); }
end_define

begin_function
specifier|static
name|int
name|sysctl_sctp_udp_tunneling_check
parameter_list|(
name|SYSCTL_HANDLER_ARGS
parameter_list|)
block|{
name|int
name|error
decl_stmt|;
name|uint32_t
name|old_sctp_udp_tunneling_port
decl_stmt|;
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|old_sctp_udp_tunneling_port
operator|=
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_udp_tunneling_port
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|sysctl_handle_int
argument_list|(
name|oidp
argument_list|,
name|oidp
operator|->
name|oid_arg1
argument_list|,
name|oidp
operator|->
name|oid_arg2
argument_list|,
name|req
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_udp_tunneling_port
argument_list|)
argument_list|,
name|SCTPCTL_UDP_TUNNELING_PORT_MIN
argument_list|,
name|SCTPCTL_UDP_TUNNELING_PORT_MAX
argument_list|)
expr_stmt|;
if|if
condition|(
name|old_sctp_udp_tunneling_port
operator|==
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_udp_tunneling_port
argument_list|)
condition|)
block|{
name|error
operator|=
literal|0
expr_stmt|;
goto|goto
name|out
goto|;
block|}
name|SCTP_INP_INFO_WLOCK
argument_list|()
expr_stmt|;
if|if
condition|(
name|old_sctp_udp_tunneling_port
condition|)
block|{
name|sctp_over_udp_stop
argument_list|()
expr_stmt|;
block|}
if|if
condition|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_udp_tunneling_port
argument_list|)
condition|)
block|{
if|if
condition|(
name|sctp_over_udp_start
argument_list|()
condition|)
block|{
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_udp_tunneling_port
argument_list|)
operator|=
literal|0
expr_stmt|;
block|}
block|}
name|SCTP_INP_INFO_WUNLOCK
argument_list|()
expr_stmt|;
block|}
name|out
label|:
return|return
operator|(
name|error
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|sysctl_sctp_check
parameter_list|(
name|SYSCTL_HANDLER_ARGS
parameter_list|)
block|{
name|int
name|error
decl_stmt|;
name|error
operator|=
name|sysctl_handle_int
argument_list|(
name|oidp
argument_list|,
name|oidp
operator|->
name|oid_arg1
argument_list|,
name|oidp
operator|->
name|oid_arg2
argument_list|,
name|req
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_sendspace
argument_list|)
argument_list|,
name|SCTPCTL_MAXDGRAM_MIN
argument_list|,
name|SCTPCTL_MAXDGRAM_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_recvspace
argument_list|)
argument_list|,
name|SCTPCTL_RECVSPACE_MIN
argument_list|,
name|SCTPCTL_RECVSPACE_MAX
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|__FreeBSD__
argument_list|)
operator|||
name|defined
argument_list|(
name|SCTP_APPLE_AUTO_ASCONF
argument_list|)
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auto_asconf
argument_list|)
argument_list|,
name|SCTPCTL_AUTOASCONF_MIN
argument_list|,
name|SCTPCTL_AUTOASCONF_MAX
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_ecn_enable
argument_list|)
argument_list|,
name|SCTPCTL_ECN_ENABLE_MIN
argument_list|,
name|SCTPCTL_ECN_ENABLE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_ecn_nonce
argument_list|)
argument_list|,
name|SCTPCTL_ECN_NONCE_MIN
argument_list|,
name|SCTPCTL_ECN_NONCE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_strict_sacks
argument_list|)
argument_list|,
name|SCTPCTL_STRICT_SACKS_MIN
argument_list|,
name|SCTPCTL_STRICT_SACKS_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_no_csum_on_loopback
argument_list|)
argument_list|,
name|SCTPCTL_LOOPBACK_NOCSUM_MIN
argument_list|,
name|SCTPCTL_LOOPBACK_NOCSUM_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_strict_init
argument_list|)
argument_list|,
name|SCTPCTL_STRICT_INIT_MIN
argument_list|,
name|SCTPCTL_STRICT_INIT_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_peer_chunk_oh
argument_list|)
argument_list|,
name|SCTPCTL_PEER_CHKOH_MIN
argument_list|,
name|SCTPCTL_PEER_CHKOH_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_burst_default
argument_list|)
argument_list|,
name|SCTPCTL_MAXBURST_MIN
argument_list|,
name|SCTPCTL_MAXBURST_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_chunks_on_queue
argument_list|)
argument_list|,
name|SCTPCTL_MAXCHUNKS_MIN
argument_list|,
name|SCTPCTL_MAXCHUNKS_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_hashtblsize
argument_list|)
argument_list|,
name|SCTPCTL_TCBHASHSIZE_MIN
argument_list|,
name|SCTPCTL_TCBHASHSIZE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pcbtblsize
argument_list|)
argument_list|,
name|SCTPCTL_PCBHASHSIZE_MIN
argument_list|,
name|SCTPCTL_PCBHASHSIZE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_min_split_point
argument_list|)
argument_list|,
name|SCTPCTL_MIN_SPLIT_POINT_MIN
argument_list|,
name|SCTPCTL_MIN_SPLIT_POINT_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_chunkscale
argument_list|)
argument_list|,
name|SCTPCTL_CHUNKSCALE_MIN
argument_list|,
name|SCTPCTL_CHUNKSCALE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_delayed_sack_time_default
argument_list|)
argument_list|,
name|SCTPCTL_DELAYED_SACK_TIME_MIN
argument_list|,
name|SCTPCTL_DELAYED_SACK_TIME_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_sack_freq_default
argument_list|)
argument_list|,
name|SCTPCTL_SACK_FREQ_MIN
argument_list|,
name|SCTPCTL_SACK_FREQ_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_system_free_resc_limit
argument_list|)
argument_list|,
name|SCTPCTL_SYS_RESOURCE_MIN
argument_list|,
name|SCTPCTL_SYS_RESOURCE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asoc_free_resc_limit
argument_list|)
argument_list|,
name|SCTPCTL_ASOC_RESOURCE_MIN
argument_list|,
name|SCTPCTL_ASOC_RESOURCE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_heartbeat_interval_default
argument_list|)
argument_list|,
name|SCTPCTL_HEARTBEAT_INTERVAL_MIN
argument_list|,
name|SCTPCTL_HEARTBEAT_INTERVAL_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pmtu_raise_time_default
argument_list|)
argument_list|,
name|SCTPCTL_PMTU_RAISE_TIME_MIN
argument_list|,
name|SCTPCTL_PMTU_RAISE_TIME_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_shutdown_guard_time_default
argument_list|)
argument_list|,
name|SCTPCTL_SHUTDOWN_GUARD_TIME_MIN
argument_list|,
name|SCTPCTL_SHUTDOWN_GUARD_TIME_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_secret_lifetime_default
argument_list|)
argument_list|,
name|SCTPCTL_SECRET_LIFETIME_MIN
argument_list|,
name|SCTPCTL_SECRET_LIFETIME_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_max_default
argument_list|)
argument_list|,
name|SCTPCTL_RTO_MAX_MIN
argument_list|,
name|SCTPCTL_RTO_MAX_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_min_default
argument_list|)
argument_list|,
name|SCTPCTL_RTO_MIN_MIN
argument_list|,
name|SCTPCTL_RTO_MIN_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_initial_default
argument_list|)
argument_list|,
name|SCTPCTL_RTO_INITIAL_MIN
argument_list|,
name|SCTPCTL_RTO_INITIAL_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_init_rto_max_default
argument_list|)
argument_list|,
name|SCTPCTL_INIT_RTO_MAX_MIN
argument_list|,
name|SCTPCTL_INIT_RTO_MAX_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_valid_cookie_life_default
argument_list|)
argument_list|,
name|SCTPCTL_VALID_COOKIE_LIFE_MIN
argument_list|,
name|SCTPCTL_VALID_COOKIE_LIFE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_init_rtx_max_default
argument_list|)
argument_list|,
name|SCTPCTL_INIT_RTX_MAX_MIN
argument_list|,
name|SCTPCTL_INIT_RTX_MAX_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_assoc_rtx_max_default
argument_list|)
argument_list|,
name|SCTPCTL_ASSOC_RTX_MAX_MIN
argument_list|,
name|SCTPCTL_ASSOC_RTX_MAX_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_path_rtx_max_default
argument_list|)
argument_list|,
name|SCTPCTL_PATH_RTX_MAX_MIN
argument_list|,
name|SCTPCTL_PATH_RTX_MAX_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_add_more_threshold
argument_list|)
argument_list|,
name|SCTPCTL_ADD_MORE_ON_OUTPUT_MIN
argument_list|,
name|SCTPCTL_ADD_MORE_ON_OUTPUT_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nr_outgoing_streams_default
argument_list|)
argument_list|,
name|SCTPCTL_OUTGOING_STREAMS_MIN
argument_list|,
name|SCTPCTL_OUTGOING_STREAMS_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_cmt_on_off
argument_list|)
argument_list|,
name|SCTPCTL_CMT_ON_OFF_MIN
argument_list|,
name|SCTPCTL_CMT_ON_OFF_MAX
argument_list|)
expr_stmt|;
comment|/* EY */
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nr_sack_on_off
argument_list|)
argument_list|,
name|SCTPCTL_NR_SACK_ON_OFF_MIN
argument_list|,
name|SCTPCTL_NR_SACK_ON_OFF_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_cmt_use_dac
argument_list|)
argument_list|,
name|SCTPCTL_CMT_USE_DAC_MIN
argument_list|,
name|SCTPCTL_CMT_USE_DAC_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_cmt_pf
argument_list|)
argument_list|,
name|SCTPCTL_CMT_PF_MIN
argument_list|,
name|SCTPCTL_CMT_PF_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_use_cwnd_based_maxburst
argument_list|)
argument_list|,
name|SCTPCTL_CWND_MAXBURST_MIN
argument_list|,
name|SCTPCTL_CWND_MAXBURST_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_early_fr
argument_list|)
argument_list|,
name|SCTPCTL_EARLY_FAST_RETRAN_MIN
argument_list|,
name|SCTPCTL_EARLY_FAST_RETRAN_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_early_fr_msec
argument_list|)
argument_list|,
name|SCTPCTL_EARLY_FAST_RETRAN_MSEC_MIN
argument_list|,
name|SCTPCTL_EARLY_FAST_RETRAN_MSEC_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asconf_auth_nochk
argument_list|)
argument_list|,
name|SCTPCTL_ASCONF_AUTH_NOCHK_MIN
argument_list|,
name|SCTPCTL_ASCONF_AUTH_NOCHK_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auth_disable
argument_list|)
argument_list|,
name|SCTPCTL_AUTH_DISABLE_MIN
argument_list|,
name|SCTPCTL_AUTH_DISABLE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nat_friendly
argument_list|)
argument_list|,
name|SCTPCTL_NAT_FRIENDLY_MIN
argument_list|,
name|SCTPCTL_NAT_FRIENDLY_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_L2_abc_variable
argument_list|)
argument_list|,
name|SCTPCTL_ABC_L_VAR_MIN
argument_list|,
name|SCTPCTL_ABC_L_VAR_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mbuf_threshold_count
argument_list|)
argument_list|,
name|SCTPCTL_MAX_CHAINED_MBUFS_MIN
argument_list|,
name|SCTPCTL_MAX_CHAINED_MBUFS_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_do_drain
argument_list|)
argument_list|,
name|SCTPCTL_DO_SCTP_DRAIN_MIN
argument_list|,
name|SCTPCTL_DO_SCTP_DRAIN_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_hb_maxburst
argument_list|)
argument_list|,
name|SCTPCTL_HB_MAX_BURST_MIN
argument_list|,
name|SCTPCTL_HB_MAX_BURST_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_abort_if_one_2_one_hits_limit
argument_list|)
argument_list|,
name|SCTPCTL_ABORT_AT_LIMIT_MIN
argument_list|,
name|SCTPCTL_ABORT_AT_LIMIT_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_strict_data_order
argument_list|)
argument_list|,
name|SCTPCTL_STRICT_DATA_ORDER_MIN
argument_list|,
name|SCTPCTL_STRICT_DATA_ORDER_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_min_residual
argument_list|)
argument_list|,
name|SCTPCTL_MIN_RESIDUAL_MIN
argument_list|,
name|SCTPCTL_MIN_RESIDUAL_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_retran_chunk
argument_list|)
argument_list|,
name|SCTPCTL_MAX_RETRAN_CHUNK_MIN
argument_list|,
name|SCTPCTL_MAX_RETRAN_CHUNK_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_logging_level
argument_list|)
argument_list|,
name|SCTPCTL_LOGGING_LEVEL_MIN
argument_list|,
name|SCTPCTL_LOGGING_LEVEL_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_default_cc_module
argument_list|)
argument_list|,
name|SCTPCTL_DEFAULT_CC_MODULE_MIN
argument_list|,
name|SCTPCTL_DEFAULT_CC_MODULE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_default_frag_interleave
argument_list|)
argument_list|,
name|SCTPCTL_DEFAULT_FRAG_INTERLEAVE_MIN
argument_list|,
name|SCTPCTL_DEFAULT_FRAG_INTERLEAVE_MAX
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|__FreeBSD__
argument_list|)
operator|||
name|defined
argument_list|(
name|SCTP_APPLE_MOBILITY_BASE
argument_list|)
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mobility_base
argument_list|)
argument_list|,
name|SCTPCTL_MOBILITY_BASE_MIN
argument_list|,
name|SCTPCTL_MOBILITY_BASE_MAX
argument_list|)
expr_stmt|;
endif|#
directive|endif
if|#
directive|if
name|defined
argument_list|(
name|__FreeBSD__
argument_list|)
operator|||
name|defined
argument_list|(
name|SCTP_APPLE_MOBILITY_FASTHANDOFF
argument_list|)
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mobility_fasthandoff
argument_list|)
argument_list|,
name|SCTPCTL_MOBILITY_FASTHANDOFF_MIN
argument_list|,
name|SCTPCTL_MOBILITY_FASTHANDOFF_MAX
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_udp_tunneling_for_client_enable
argument_list|)
argument_list|,
name|SCTPCTL_UDP_TUNNELING_FOR_CLIENT_ENABLE_MIN
argument_list|,
name|SCTPCTL_UDP_TUNNELING_FOR_CLIENT_ENABLE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_enable_sack_immediately
argument_list|)
argument_list|,
name|SCTPCTL_SACK_IMMEDIATELY_ENABLE_MIN
argument_list|,
name|SCTPCTL_SACK_IMMEDIATELY_ENABLE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_inits_include_nat_friendly
argument_list|)
argument_list|,
name|SCTPCTL_NAT_FRIENDLY_MIN
argument_list|,
name|SCTPCTL_NAT_FRIENDLY_MAX
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|SCTP_DEBUG
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_debug_on
argument_list|)
argument_list|,
name|SCTPCTL_DEBUG_MIN
argument_list|,
name|SCTPCTL_DEBUG_MAX
argument_list|)
expr_stmt|;
endif|#
directive|endif
if|#
directive|if
name|defined
argument_list|(
name|__APPLE__
argument_list|)
operator|||
name|defined
argument_list|(
name|SCTP_SO_LOCK_TESTING
argument_list|)
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_output_unlocked
argument_list|)
argument_list|,
name|SCTPCTL_OUTPUT_UNLOCKED_MIN
argument_list|,
name|SCTPCTL_OUTPUT_UNLOCKED_MAX
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
return|return
operator|(
name|error
operator|)
return|;
block|}
end_function

begin_if
if|#
directive|if
name|defined
argument_list|(
name|SCTP_LOCAL_TRACE_BUF
argument_list|)
end_if

begin_function
specifier|static
name|int
name|sysctl_sctp_cleartrace
parameter_list|(
name|SYSCTL_HANDLER_ARGS
parameter_list|)
block|{
name|int
name|error
init|=
literal|0
decl_stmt|;
name|memset
argument_list|(
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_log
argument_list|)
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|sctp_log
argument_list|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|error
operator|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/*  * sysctl definitions  */
end_comment

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|sendspace
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_sendspace
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MAXDGRAM_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|recvspace
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_recvspace
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_RECVSPACE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__FreeBSD__
argument_list|)
operator|||
name|defined
argument_list|(
name|SCTP_APPLE_AUTO_ASCONF
argument_list|)
end_if

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|auto_asconf
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auto_asconf
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_AUTOASCONF_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|ecn_enable
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_ecn_enable
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_ECN_ENABLE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|ecn_nonce
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_ecn_nonce
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_ECN_NONCE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|strict_sacks
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_strict_sacks
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_STRICT_SACKS_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|loopback_nocsum
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_no_csum_on_loopback
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_LOOPBACK_NOCSUM_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|strict_init
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_strict_init
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_STRICT_INIT_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|peer_chkoh
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_peer_chunk_oh
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_PEER_CHKOH_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|maxburst
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_burst_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MAXBURST_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|maxchunks
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_chunks_on_queue
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MAXCHUNKS_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|tcbhashsize
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_hashtblsize
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_TCBHASHSIZE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|pcbhashsize
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pcbtblsize
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_PCBHASHSIZE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|min_split_point
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_min_split_point
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MIN_SPLIT_POINT_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|chunkscale
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_chunkscale
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_CHUNKSCALE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|delayed_sack_time
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_delayed_sack_time_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_DELAYED_SACK_TIME_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|sack_freq
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_sack_freq_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_SACK_FREQ_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|sys_resource
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_system_free_resc_limit
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_SYS_RESOURCE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|asoc_resource
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asoc_free_resc_limit
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_ASOC_RESOURCE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|heartbeat_interval
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_heartbeat_interval_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_HEARTBEAT_INTERVAL_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|pmtu_raise_time
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pmtu_raise_time_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_PMTU_RAISE_TIME_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|shutdown_guard_time
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_shutdown_guard_time_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_SHUTDOWN_GUARD_TIME_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|secret_lifetime
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_secret_lifetime_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_SECRET_LIFETIME_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|rto_max
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_max_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_RTO_MAX_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|rto_min
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_min_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_RTO_MIN_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|rto_initial
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_initial_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_RTO_INITIAL_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|init_rto_max
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_init_rto_max_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_INIT_RTO_MAX_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|valid_cookie_life
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_valid_cookie_life_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_VALID_COOKIE_LIFE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|init_rtx_max
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_init_rtx_max_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_INIT_RTX_MAX_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|assoc_rtx_max
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_assoc_rtx_max_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_ASSOC_RTX_MAX_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|path_rtx_max
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_path_rtx_max_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_PATH_RTX_MAX_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|add_more_on_output
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_add_more_threshold
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_ADD_MORE_ON_OUTPUT_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|outgoing_streams
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nr_outgoing_streams_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_OUTGOING_STREAMS_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|cmt_on_off
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_cmt_on_off
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_CMT_ON_OFF_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* EY */
end_comment

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|nr_sack_on_off
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nr_sack_on_off
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_NR_SACK_ON_OFF_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|cmt_use_dac
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_cmt_use_dac
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_CMT_USE_DAC_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|cmt_pf
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_cmt_pf
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_CMT_PF_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|cwnd_maxburst
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_use_cwnd_based_maxburst
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_CWND_MAXBURST_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|early_fast_retran
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_early_fr
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_EARLY_FAST_RETRAN_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|early_fast_retran_msec
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_early_fr_msec
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_EARLY_FAST_RETRAN_MSEC_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|asconf_auth_nochk
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asconf_auth_nochk
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_ASCONF_AUTH_NOCHK_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|auth_disable
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auth_disable
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_AUTH_DISABLE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|nat_friendly
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nat_friendly
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_NAT_FRIENDLY_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|abc_l_var
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_L2_abc_variable
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_ABC_L_VAR_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|max_chained_mbufs
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mbuf_threshold_count
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MAX_CHAINED_MBUFS_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|do_sctp_drain
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_do_drain
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_DO_SCTP_DRAIN_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|hb_max_burst
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_hb_maxburst
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_HB_MAX_BURST_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|abort_at_limit
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_abort_if_one_2_one_hits_limit
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_ABORT_AT_LIMIT_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|strict_data_order
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_strict_data_order
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_STRICT_DATA_ORDER_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|min_residual
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_min_residual
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MIN_RESIDUAL_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|max_retran_chunk
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_retran_chunk
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MAX_RETRAN_CHUNK_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|log_level
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_logging_level
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_LOGGING_LEVEL_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|default_cc_module
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_default_cc_module
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_DEFAULT_CC_MODULE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|default_frag_interleave
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_default_frag_interleave
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_DEFAULT_FRAG_INTERLEAVE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__FreeBSD__
argument_list|)
operator|||
name|defined
argument_list|(
name|SCTP_APPLE_MOBILITY_BASE
argument_list|)
end_if

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|mobility_base
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mobility_base
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MOBILITY_BASE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__FreeBSD__
argument_list|)
operator|||
name|defined
argument_list|(
name|SCTP_APPLE_MOBILITY_FASTHANDOFF
argument_list|)
end_if

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|mobility_fasthandoff
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mobility_fasthandoff
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MOBILITY_FASTHANDOFF_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
name|defined
argument_list|(
name|SCTP_LOCAL_TRACE_BUF
argument_list|)
end_if

begin_expr_stmt
name|SYSCTL_STRUCT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|log
argument_list|,
name|CTLFLAG_RD
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_log
argument_list|)
argument_list|,
name|sctp_log
argument_list|,
literal|"SCTP logging (struct sctp_log)"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|clear_trace
argument_list|,
name|CTLTYPE_OPAQUE
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_log
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_cleartrace
argument_list|,
literal|"IU"
argument_list|,
literal|"Clear SCTP Logging buffer"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|udp_tunneling_for_client_enable
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_udp_tunneling_for_client_enable
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_UDP_TUNNELING_FOR_CLIENT_ENABLE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|udp_tunneling_port
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_udp_tunneling_port
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_udp_tunneling_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_UDP_TUNNELING_PORT_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|enable_sack_immediately
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_enable_sack_immediately
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_SACK_IMMEDIATELY_ENABLE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|nat_friendly_init
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_inits_include_nat_friendly
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_NAT_FRIENDLY_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|SCTP_DEBUG
end_ifdef

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|debug
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_debug_on
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_DEBUG_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* SCTP_DEBUG */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__APPLE__
argument_list|)
operator|||
name|defined
argument_list|(
name|SCTP_SO_LOCK_TESTING
argument_list|)
end_if

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|output_unlocked
argument_list|,
name|CTLTYPE_INT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_output_unlocked
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_OUTPUT_UNLOCKED_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_expr_stmt
name|SYSCTL_STRUCT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|stats
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_STATS
argument_list|,
name|sctpstat
argument_list|,
literal|"SCTP statistics (struct sctp_stat)"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|assoclist
argument_list|,
name|CTLFLAG_RD
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|sctp_assoclist
argument_list|,
literal|"S,xassoc"
argument_list|,
literal|"List of active SCTP associations"
argument_list|)
expr_stmt|;
end_expr_stmt

end_unit

