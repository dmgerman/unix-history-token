begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2007, by Cisco Systems, Inc. All rights reserved.  * Copyright (c) 2008-2012, by Randall Stewart. All rights reserved.  * Copyright (c) 2008-2012, by Michael Tuexen. All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions are met:  *  * a) Redistributions of source code must retain the above copyright notice,  *    this list of conditions and the following disclaimer.  *  * b) Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in  *    the documentation and/or other materials provided with the distribution.  *  * c) Neither the name of Cisco Systems, Inc. nor the names of its  *    contributors may be used to endorse or promote products derived  *    from this software without specific prior written permission.  *  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS  * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,  * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE  * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR  * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF  * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS  * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN  * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF  * THE POSSIBILITY OF SUCH DAMAGE.  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_include
include|#
directive|include
file|<netinet/sctp_os.h>
end_include

begin_include
include|#
directive|include
file|<netinet/sctp.h>
end_include

begin_include
include|#
directive|include
file|<netinet/sctp_constants.h>
end_include

begin_include
include|#
directive|include
file|<netinet/sctp_sysctl.h>
end_include

begin_include
include|#
directive|include
file|<netinet/sctp_pcb.h>
end_include

begin_include
include|#
directive|include
file|<netinet/sctputil.h>
end_include

begin_include
include|#
directive|include
file|<netinet/sctp_output.h>
end_include

begin_include
include|#
directive|include
file|<sys/smp.h>
end_include

begin_comment
comment|/*  * sysctl tunable variables  */
end_comment

begin_function
name|void
name|sctp_init_sysctls
parameter_list|()
block|{
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_sendspace
argument_list|)
operator|=
name|SCTPCTL_MAXDGRAM_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_recvspace
argument_list|)
operator|=
name|SCTPCTL_RECVSPACE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auto_asconf
argument_list|)
operator|=
name|SCTPCTL_AUTOASCONF_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_multiple_asconfs
argument_list|)
operator|=
name|SCTPCTL_MULTIPLEASCONFS_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_ecn_enable
argument_list|)
operator|=
name|SCTPCTL_ECN_ENABLE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pr_enable
argument_list|)
operator|=
name|SCTPCTL_PR_ENABLE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auth_disable
argument_list|)
operator|=
name|SCTPCTL_AUTH_DISABLE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asconf_enable
argument_list|)
operator|=
name|SCTPCTL_ASCONF_ENABLE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_reconfig_enable
argument_list|)
operator|=
name|SCTPCTL_RECONFIG_ENABLE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nrsack_enable
argument_list|)
operator|=
name|SCTPCTL_NRSACK_ENABLE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pktdrop_enable
argument_list|)
operator|=
name|SCTPCTL_PKTDROP_ENABLE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_strict_sacks
argument_list|)
operator|=
name|SCTPCTL_STRICT_SACKS_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_peer_chunk_oh
argument_list|)
operator|=
name|SCTPCTL_PEER_CHKOH_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_burst_default
argument_list|)
operator|=
name|SCTPCTL_MAXBURST_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_fr_max_burst_default
argument_list|)
operator|=
name|SCTPCTL_FRMAXBURST_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_chunks_on_queue
argument_list|)
operator|=
name|SCTPCTL_MAXCHUNKS_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_hashtblsize
argument_list|)
operator|=
name|SCTPCTL_TCBHASHSIZE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pcbtblsize
argument_list|)
operator|=
name|SCTPCTL_PCBHASHSIZE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_min_split_point
argument_list|)
operator|=
name|SCTPCTL_MIN_SPLIT_POINT_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_chunkscale
argument_list|)
operator|=
name|SCTPCTL_CHUNKSCALE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_delayed_sack_time_default
argument_list|)
operator|=
name|SCTPCTL_DELAYED_SACK_TIME_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_sack_freq_default
argument_list|)
operator|=
name|SCTPCTL_SACK_FREQ_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_system_free_resc_limit
argument_list|)
operator|=
name|SCTPCTL_SYS_RESOURCE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asoc_free_resc_limit
argument_list|)
operator|=
name|SCTPCTL_ASOC_RESOURCE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_heartbeat_interval_default
argument_list|)
operator|=
name|SCTPCTL_HEARTBEAT_INTERVAL_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pmtu_raise_time_default
argument_list|)
operator|=
name|SCTPCTL_PMTU_RAISE_TIME_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_shutdown_guard_time_default
argument_list|)
operator|=
name|SCTPCTL_SHUTDOWN_GUARD_TIME_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_secret_lifetime_default
argument_list|)
operator|=
name|SCTPCTL_SECRET_LIFETIME_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_max_default
argument_list|)
operator|=
name|SCTPCTL_RTO_MAX_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_min_default
argument_list|)
operator|=
name|SCTPCTL_RTO_MIN_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_initial_default
argument_list|)
operator|=
name|SCTPCTL_RTO_INITIAL_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_init_rto_max_default
argument_list|)
operator|=
name|SCTPCTL_INIT_RTO_MAX_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_valid_cookie_life_default
argument_list|)
operator|=
name|SCTPCTL_VALID_COOKIE_LIFE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_init_rtx_max_default
argument_list|)
operator|=
name|SCTPCTL_INIT_RTX_MAX_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_assoc_rtx_max_default
argument_list|)
operator|=
name|SCTPCTL_ASSOC_RTX_MAX_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_path_rtx_max_default
argument_list|)
operator|=
name|SCTPCTL_PATH_RTX_MAX_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_path_pf_threshold
argument_list|)
operator|=
name|SCTPCTL_PATH_PF_THRESHOLD_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_add_more_threshold
argument_list|)
operator|=
name|SCTPCTL_ADD_MORE_ON_OUTPUT_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nr_incoming_streams_default
argument_list|)
operator|=
name|SCTPCTL_INCOMING_STREAMS_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nr_outgoing_streams_default
argument_list|)
operator|=
name|SCTPCTL_OUTGOING_STREAMS_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_cmt_on_off
argument_list|)
operator|=
name|SCTPCTL_CMT_ON_OFF_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_cmt_use_dac
argument_list|)
operator|=
name|SCTPCTL_CMT_USE_DAC_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_use_cwnd_based_maxburst
argument_list|)
operator|=
name|SCTPCTL_CWND_MAXBURST_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nat_friendly
argument_list|)
operator|=
name|SCTPCTL_NAT_FRIENDLY_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_L2_abc_variable
argument_list|)
operator|=
name|SCTPCTL_ABC_L_VAR_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mbuf_threshold_count
argument_list|)
operator|=
name|SCTPCTL_MAX_CHAINED_MBUFS_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_do_drain
argument_list|)
operator|=
name|SCTPCTL_DO_SCTP_DRAIN_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_hb_maxburst
argument_list|)
operator|=
name|SCTPCTL_HB_MAX_BURST_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_abort_if_one_2_one_hits_limit
argument_list|)
operator|=
name|SCTPCTL_ABORT_AT_LIMIT_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_strict_data_order
argument_list|)
operator|=
name|SCTPCTL_STRICT_DATA_ORDER_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_min_residual
argument_list|)
operator|=
name|SCTPCTL_MIN_RESIDUAL_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_retran_chunk
argument_list|)
operator|=
name|SCTPCTL_MAX_RETRAN_CHUNK_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_logging_level
argument_list|)
operator|=
name|SCTPCTL_LOGGING_LEVEL_DEFAULT
expr_stmt|;
comment|/* JRS - Variable for default congestion control module */
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_default_cc_module
argument_list|)
operator|=
name|SCTPCTL_DEFAULT_CC_MODULE_DEFAULT
expr_stmt|;
comment|/* RS - Variable for default stream scheduling module */
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_default_ss_module
argument_list|)
operator|=
name|SCTPCTL_DEFAULT_SS_MODULE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_default_frag_interleave
argument_list|)
operator|=
name|SCTPCTL_DEFAULT_FRAG_INTERLEAVE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mobility_base
argument_list|)
operator|=
name|SCTPCTL_MOBILITY_BASE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mobility_fasthandoff
argument_list|)
operator|=
name|SCTPCTL_MOBILITY_FASTHANDOFF_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_vtag_time_wait
argument_list|)
operator|=
name|SCTPCTL_TIME_WAIT_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_buffer_splitting
argument_list|)
operator|=
name|SCTPCTL_BUFFER_SPLITTING_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_initial_cwnd
argument_list|)
operator|=
name|SCTPCTL_INITIAL_CWND_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rttvar_bw
argument_list|)
operator|=
name|SCTPCTL_RTTVAR_BW_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rttvar_rtt
argument_list|)
operator|=
name|SCTPCTL_RTTVAR_RTT_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rttvar_eqret
argument_list|)
operator|=
name|SCTPCTL_RTTVAR_EQRET_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_steady_step
argument_list|)
operator|=
name|SCTPCTL_RTTVAR_STEADYS_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_use_dccc_ecn
argument_list|)
operator|=
name|SCTPCTL_RTTVAR_DCCCECN_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_blackhole
argument_list|)
operator|=
name|SCTPCTL_BLACKHOLE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_diag_info_code
argument_list|)
operator|=
name|SCTPCTL_DIAG_INFO_CODE_DEFAULT
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|SCTP_LOCAL_TRACE_BUF
argument_list|)
name|memset
argument_list|(
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_log
argument_list|)
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|sctp_log
argument_list|)
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_udp_tunneling_port
argument_list|)
operator|=
name|SCTPCTL_UDP_TUNNELING_PORT_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_enable_sack_immediately
argument_list|)
operator|=
name|SCTPCTL_SACK_IMMEDIATELY_ENABLE_DEFAULT
expr_stmt|;
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_inits_include_nat_friendly
argument_list|)
operator|=
name|SCTPCTL_NAT_FRIENDLY_INITS_DEFAULT
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|SCTP_DEBUG
argument_list|)
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_debug_on
argument_list|)
operator|=
name|SCTPCTL_DEBUG_DEFAULT
expr_stmt|;
endif|#
directive|endif
if|#
directive|if
name|defined
argument_list|(
name|__APPLE__
argument_list|)
operator|||
name|defined
argument_list|(
name|SCTP_SO_LOCK_TESTING
argument_list|)
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_output_unlocked
argument_list|)
operator|=
name|SCTPCTL_OUTPUT_UNLOCKED_DEFAULT
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_comment
comment|/* It returns an upper limit. No filtering is done here */
end_comment

begin_function
specifier|static
name|unsigned
name|int
name|number_of_addresses
parameter_list|(
name|struct
name|sctp_inpcb
modifier|*
name|inp
parameter_list|)
block|{
name|unsigned
name|int
name|cnt
decl_stmt|;
name|struct
name|sctp_vrf
modifier|*
name|vrf
decl_stmt|;
name|struct
name|sctp_ifn
modifier|*
name|sctp_ifn
decl_stmt|;
name|struct
name|sctp_ifa
modifier|*
name|sctp_ifa
decl_stmt|;
name|struct
name|sctp_laddr
modifier|*
name|laddr
decl_stmt|;
name|cnt
operator|=
literal|0
expr_stmt|;
comment|/* neither Mac OS X nor FreeBSD support mulitple routing functions */
if|if
condition|(
operator|(
name|vrf
operator|=
name|sctp_find_vrf
argument_list|(
name|inp
operator|->
name|def_vrf_id
argument_list|)
operator|)
operator|==
name|NULL
condition|)
block|{
return|return
operator|(
literal|0
operator|)
return|;
block|}
if|if
condition|(
name|inp
operator|->
name|sctp_flags
operator|&
name|SCTP_PCB_FLAGS_BOUNDALL
condition|)
block|{
name|LIST_FOREACH
argument_list|(
argument|sctp_ifn
argument_list|,
argument|&vrf->ifnlist
argument_list|,
argument|next_ifn
argument_list|)
block|{
name|LIST_FOREACH
argument_list|(
argument|sctp_ifa
argument_list|,
argument|&sctp_ifn->ifalist
argument_list|,
argument|next_ifa
argument_list|)
block|{
switch|switch
condition|(
name|sctp_ifa
operator|->
name|address
operator|.
name|sa
operator|.
name|sa_family
condition|)
block|{
ifdef|#
directive|ifdef
name|INET
case|case
name|AF_INET
case|:
endif|#
directive|endif
ifdef|#
directive|ifdef
name|INET6
case|case
name|AF_INET6
case|:
endif|#
directive|endif
name|cnt
operator|++
expr_stmt|;
break|break;
default|default:
break|break;
block|}
block|}
block|}
block|}
else|else
block|{
name|LIST_FOREACH
argument_list|(
argument|laddr
argument_list|,
argument|&inp->sctp_addr_list
argument_list|,
argument|sctp_nxt_addr
argument_list|)
block|{
switch|switch
condition|(
name|laddr
operator|->
name|ifa
operator|->
name|address
operator|.
name|sa
operator|.
name|sa_family
condition|)
block|{
ifdef|#
directive|ifdef
name|INET
case|case
name|AF_INET
case|:
endif|#
directive|endif
ifdef|#
directive|ifdef
name|INET6
case|case
name|AF_INET6
case|:
endif|#
directive|endif
name|cnt
operator|++
expr_stmt|;
break|break;
default|default:
break|break;
block|}
block|}
block|}
return|return
operator|(
name|cnt
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|copy_out_local_addresses
parameter_list|(
name|struct
name|sctp_inpcb
modifier|*
name|inp
parameter_list|,
name|struct
name|sctp_tcb
modifier|*
name|stcb
parameter_list|,
name|struct
name|sysctl_req
modifier|*
name|req
parameter_list|)
block|{
name|struct
name|sctp_ifn
modifier|*
name|sctp_ifn
decl_stmt|;
name|struct
name|sctp_ifa
modifier|*
name|sctp_ifa
decl_stmt|;
name|int
name|loopback_scope
decl_stmt|,
name|ipv4_local_scope
decl_stmt|,
name|local_scope
decl_stmt|,
name|site_scope
decl_stmt|;
name|int
name|ipv4_addr_legal
decl_stmt|,
name|ipv6_addr_legal
decl_stmt|;
name|struct
name|sctp_vrf
modifier|*
name|vrf
decl_stmt|;
name|struct
name|xsctp_laddr
name|xladdr
decl_stmt|;
name|struct
name|sctp_laddr
modifier|*
name|laddr
decl_stmt|;
name|int
name|error
decl_stmt|;
comment|/* Turn on all the appropriate scope */
if|if
condition|(
name|stcb
condition|)
block|{
comment|/* use association specific values */
name|loopback_scope
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|scope
operator|.
name|loopback_scope
expr_stmt|;
name|ipv4_local_scope
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|scope
operator|.
name|ipv4_local_scope
expr_stmt|;
name|local_scope
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|scope
operator|.
name|local_scope
expr_stmt|;
name|site_scope
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|scope
operator|.
name|site_scope
expr_stmt|;
name|ipv4_addr_legal
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|scope
operator|.
name|ipv4_addr_legal
expr_stmt|;
name|ipv6_addr_legal
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|scope
operator|.
name|ipv6_addr_legal
expr_stmt|;
block|}
else|else
block|{
comment|/* Use generic values for endpoints. */
name|loopback_scope
operator|=
literal|1
expr_stmt|;
name|ipv4_local_scope
operator|=
literal|1
expr_stmt|;
name|local_scope
operator|=
literal|1
expr_stmt|;
name|site_scope
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|inp
operator|->
name|sctp_flags
operator|&
name|SCTP_PCB_FLAGS_BOUND_V6
condition|)
block|{
name|ipv6_addr_legal
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|SCTP_IPV6_V6ONLY
argument_list|(
name|inp
argument_list|)
condition|)
block|{
name|ipv4_addr_legal
operator|=
literal|0
expr_stmt|;
block|}
else|else
block|{
name|ipv4_addr_legal
operator|=
literal|1
expr_stmt|;
block|}
block|}
else|else
block|{
name|ipv6_addr_legal
operator|=
literal|0
expr_stmt|;
name|ipv4_addr_legal
operator|=
literal|1
expr_stmt|;
block|}
block|}
comment|/* neither Mac OS X nor FreeBSD support mulitple routing functions */
if|if
condition|(
operator|(
name|vrf
operator|=
name|sctp_find_vrf
argument_list|(
name|inp
operator|->
name|def_vrf_id
argument_list|)
operator|)
operator|==
name|NULL
condition|)
block|{
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
return|return
operator|(
operator|-
literal|1
operator|)
return|;
block|}
if|if
condition|(
name|inp
operator|->
name|sctp_flags
operator|&
name|SCTP_PCB_FLAGS_BOUNDALL
condition|)
block|{
name|LIST_FOREACH
argument_list|(
argument|sctp_ifn
argument_list|,
argument|&vrf->ifnlist
argument_list|,
argument|next_ifn
argument_list|)
block|{
if|if
condition|(
operator|(
name|loopback_scope
operator|==
literal|0
operator|)
operator|&&
name|SCTP_IFN_IS_IFT_LOOP
argument_list|(
name|sctp_ifn
argument_list|)
condition|)
comment|/* Skip loopback if loopback_scope not set */
continue|continue;
name|LIST_FOREACH
argument_list|(
argument|sctp_ifa
argument_list|,
argument|&sctp_ifn->ifalist
argument_list|,
argument|next_ifa
argument_list|)
block|{
if|if
condition|(
name|stcb
condition|)
block|{
comment|/* 					 * ignore if blacklisted at 					 * association level 					 */
if|if
condition|(
name|sctp_is_addr_restricted
argument_list|(
name|stcb
argument_list|,
name|sctp_ifa
argument_list|)
condition|)
continue|continue;
block|}
switch|switch
condition|(
name|sctp_ifa
operator|->
name|address
operator|.
name|sa
operator|.
name|sa_family
condition|)
block|{
ifdef|#
directive|ifdef
name|INET
case|case
name|AF_INET
case|:
if|if
condition|(
name|ipv4_addr_legal
condition|)
block|{
name|struct
name|sockaddr_in
modifier|*
name|sin
decl_stmt|;
name|sin
operator|=
operator|(
expr|struct
name|sockaddr_in
operator|*
operator|)
operator|&
name|sctp_ifa
operator|->
name|address
operator|.
name|sa
expr_stmt|;
if|if
condition|(
name|sin
operator|->
name|sin_addr
operator|.
name|s_addr
operator|==
literal|0
condition|)
continue|continue;
if|if
condition|(
name|prison_check_ip4
argument_list|(
name|inp
operator|->
name|ip_inp
operator|.
name|inp
operator|.
name|inp_cred
argument_list|,
operator|&
name|sin
operator|->
name|sin_addr
argument_list|)
operator|!=
literal|0
condition|)
block|{
continue|continue;
block|}
if|if
condition|(
operator|(
name|ipv4_local_scope
operator|==
literal|0
operator|)
operator|&&
operator|(
name|IN4_ISPRIVATE_ADDRESS
argument_list|(
operator|&
name|sin
operator|->
name|sin_addr
argument_list|)
operator|)
condition|)
continue|continue;
block|}
else|else
block|{
continue|continue;
block|}
break|break;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|INET6
case|case
name|AF_INET6
case|:
if|if
condition|(
name|ipv6_addr_legal
condition|)
block|{
name|struct
name|sockaddr_in6
modifier|*
name|sin6
decl_stmt|;
name|sin6
operator|=
operator|(
expr|struct
name|sockaddr_in6
operator|*
operator|)
operator|&
name|sctp_ifa
operator|->
name|address
operator|.
name|sa
expr_stmt|;
if|if
condition|(
name|IN6_IS_ADDR_UNSPECIFIED
argument_list|(
operator|&
name|sin6
operator|->
name|sin6_addr
argument_list|)
condition|)
continue|continue;
if|if
condition|(
name|prison_check_ip6
argument_list|(
name|inp
operator|->
name|ip_inp
operator|.
name|inp
operator|.
name|inp_cred
argument_list|,
operator|&
name|sin6
operator|->
name|sin6_addr
argument_list|)
operator|!=
literal|0
condition|)
block|{
continue|continue;
block|}
if|if
condition|(
name|IN6_IS_ADDR_LINKLOCAL
argument_list|(
operator|&
name|sin6
operator|->
name|sin6_addr
argument_list|)
condition|)
block|{
if|if
condition|(
name|local_scope
operator|==
literal|0
condition|)
continue|continue;
if|if
condition|(
name|sin6
operator|->
name|sin6_scope_id
operator|==
literal|0
condition|)
block|{
comment|/* 								 * bad link 								 * local 								 * address 								 */
if|if
condition|(
name|sa6_recoverscope
argument_list|(
name|sin6
argument_list|)
operator|!=
literal|0
condition|)
continue|continue;
block|}
block|}
if|if
condition|(
operator|(
name|site_scope
operator|==
literal|0
operator|)
operator|&&
operator|(
name|IN6_IS_ADDR_SITELOCAL
argument_list|(
operator|&
name|sin6
operator|->
name|sin6_addr
argument_list|)
operator|)
condition|)
continue|continue;
block|}
else|else
block|{
continue|continue;
block|}
break|break;
endif|#
directive|endif
default|default:
continue|continue;
block|}
name|memset
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|xladdr
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_laddr
argument_list|)
argument_list|)
expr_stmt|;
name|memcpy
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|xladdr
operator|.
name|address
argument_list|,
operator|(
specifier|const
name|void
operator|*
operator|)
operator|&
name|sctp_ifa
operator|->
name|address
argument_list|,
sizeof|sizeof
argument_list|(
expr|union
name|sctp_sockstore
argument_list|)
argument_list|)
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xladdr
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_laddr
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
return|return
operator|(
name|error
operator|)
return|;
block|}
else|else
block|{
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
block|}
block|}
block|}
block|}
else|else
block|{
name|LIST_FOREACH
argument_list|(
argument|laddr
argument_list|,
argument|&inp->sctp_addr_list
argument_list|,
argument|sctp_nxt_addr
argument_list|)
block|{
comment|/* ignore if blacklisted at association level */
if|if
condition|(
name|stcb
operator|&&
name|sctp_is_addr_restricted
argument_list|(
name|stcb
argument_list|,
name|laddr
operator|->
name|ifa
argument_list|)
condition|)
continue|continue;
name|memset
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|xladdr
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_laddr
argument_list|)
argument_list|)
expr_stmt|;
name|memcpy
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|xladdr
operator|.
name|address
argument_list|,
operator|(
specifier|const
name|void
operator|*
operator|)
operator|&
name|laddr
operator|->
name|ifa
operator|->
name|address
argument_list|,
sizeof|sizeof
argument_list|(
expr|union
name|sctp_sockstore
argument_list|)
argument_list|)
expr_stmt|;
name|xladdr
operator|.
name|start_time
operator|.
name|tv_sec
operator|=
operator|(
name|uint32_t
operator|)
name|laddr
operator|->
name|start_time
operator|.
name|tv_sec
expr_stmt|;
name|xladdr
operator|.
name|start_time
operator|.
name|tv_usec
operator|=
operator|(
name|uint32_t
operator|)
name|laddr
operator|->
name|start_time
operator|.
name|tv_usec
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xladdr
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_laddr
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
return|return
operator|(
name|error
operator|)
return|;
block|}
else|else
block|{
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
block|}
block|}
block|}
name|memset
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|xladdr
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_laddr
argument_list|)
argument_list|)
expr_stmt|;
name|xladdr
operator|.
name|last
operator|=
literal|1
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xladdr
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_laddr
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
return|return
operator|(
name|error
operator|)
return|;
block|}
else|else
block|{
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
block|}
end_function

begin_comment
comment|/*  * sysctl functions  */
end_comment

begin_function
specifier|static
name|int
name|sctp_assoclist
parameter_list|(
name|SYSCTL_HANDLER_ARGS
parameter_list|)
block|{
name|unsigned
name|int
name|number_of_endpoints
decl_stmt|;
name|unsigned
name|int
name|number_of_local_addresses
decl_stmt|;
name|unsigned
name|int
name|number_of_associations
decl_stmt|;
name|unsigned
name|int
name|number_of_remote_addresses
decl_stmt|;
name|unsigned
name|int
name|n
decl_stmt|;
name|int
name|error
decl_stmt|;
name|struct
name|sctp_inpcb
modifier|*
name|inp
decl_stmt|;
name|struct
name|sctp_tcb
modifier|*
name|stcb
decl_stmt|;
name|struct
name|sctp_nets
modifier|*
name|net
decl_stmt|;
name|struct
name|xsctp_inpcb
name|xinpcb
decl_stmt|;
name|struct
name|xsctp_tcb
name|xstcb
decl_stmt|;
name|struct
name|xsctp_raddr
name|xraddr
decl_stmt|;
name|struct
name|socket
modifier|*
name|so
decl_stmt|;
name|number_of_endpoints
operator|=
literal|0
expr_stmt|;
name|number_of_local_addresses
operator|=
literal|0
expr_stmt|;
name|number_of_associations
operator|=
literal|0
expr_stmt|;
name|number_of_remote_addresses
operator|=
literal|0
expr_stmt|;
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
if|if
condition|(
name|req
operator|->
name|oldptr
operator|==
name|USER_ADDR_NULL
condition|)
block|{
name|LIST_FOREACH
argument_list|(
argument|inp
argument_list|,
argument|&SCTP_BASE_INFO(listhead)
argument_list|,
argument|sctp_list
argument_list|)
block|{
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|number_of_endpoints
operator|++
expr_stmt|;
name|number_of_local_addresses
operator|+=
name|number_of_addresses
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|LIST_FOREACH
argument_list|(
argument|stcb
argument_list|,
argument|&inp->sctp_asoc_list
argument_list|,
argument|sctp_tcblist
argument_list|)
block|{
name|number_of_associations
operator|++
expr_stmt|;
name|number_of_local_addresses
operator|+=
name|number_of_addresses
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|TAILQ_FOREACH
argument_list|(
argument|net
argument_list|,
argument|&stcb->asoc.nets
argument_list|,
argument|sctp_next
argument_list|)
block|{
name|number_of_remote_addresses
operator|++
expr_stmt|;
block|}
block|}
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
block|}
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|n
operator|=
operator|(
name|number_of_endpoints
operator|+
literal|1
operator|)
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_inpcb
argument_list|)
operator|+
operator|(
name|number_of_local_addresses
operator|+
name|number_of_endpoints
operator|+
name|number_of_associations
operator|)
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_laddr
argument_list|)
operator|+
operator|(
name|number_of_associations
operator|+
name|number_of_endpoints
operator|)
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_tcb
argument_list|)
operator|+
operator|(
name|number_of_remote_addresses
operator|+
name|number_of_associations
operator|)
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_raddr
argument_list|)
expr_stmt|;
comment|/* request some more memory than needed */
name|req
operator|->
name|oldidx
operator|=
operator|(
name|n
operator|+
name|n
operator|/
literal|8
operator|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
if|if
condition|(
name|req
operator|->
name|newptr
operator|!=
name|USER_ADDR_NULL
condition|)
block|{
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|SCTP_LTRACE_ERR_RET
argument_list|(
name|NULL
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|SCTP_FROM_SCTP_SYSCTL
argument_list|,
name|EPERM
argument_list|)
expr_stmt|;
return|return
operator|(
name|EPERM
operator|)
return|;
block|}
name|LIST_FOREACH
argument_list|(
argument|inp
argument_list|,
argument|&SCTP_BASE_INFO(listhead)
argument_list|,
argument|sctp_list
argument_list|)
block|{
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
if|if
condition|(
name|inp
operator|->
name|sctp_flags
operator|&
name|SCTP_PCB_FLAGS_SOCKET_ALLGONE
condition|)
block|{
comment|/* if its allgone it is being freed - skip it  */
goto|goto
name|skip
goto|;
block|}
name|xinpcb
operator|.
name|last
operator|=
literal|0
expr_stmt|;
name|xinpcb
operator|.
name|local_port
operator|=
name|ntohs
argument_list|(
name|inp
operator|->
name|sctp_lport
argument_list|)
expr_stmt|;
name|xinpcb
operator|.
name|flags
operator|=
name|inp
operator|->
name|sctp_flags
expr_stmt|;
name|xinpcb
operator|.
name|features
operator|=
name|inp
operator|->
name|sctp_features
expr_stmt|;
name|xinpcb
operator|.
name|total_sends
operator|=
name|inp
operator|->
name|total_sends
expr_stmt|;
name|xinpcb
operator|.
name|total_recvs
operator|=
name|inp
operator|->
name|total_recvs
expr_stmt|;
name|xinpcb
operator|.
name|total_nospaces
operator|=
name|inp
operator|->
name|total_nospaces
expr_stmt|;
name|xinpcb
operator|.
name|fragmentation_point
operator|=
name|inp
operator|->
name|sctp_frag_point
expr_stmt|;
name|so
operator|=
name|inp
operator|->
name|sctp_socket
expr_stmt|;
if|if
condition|(
operator|(
name|so
operator|==
name|NULL
operator|)
operator|||
operator|(
name|inp
operator|->
name|sctp_flags
operator|&
name|SCTP_PCB_FLAGS_SOCKET_GONE
operator|)
condition|)
block|{
name|xinpcb
operator|.
name|qlen
operator|=
literal|0
expr_stmt|;
name|xinpcb
operator|.
name|maxqlen
operator|=
literal|0
expr_stmt|;
block|}
else|else
block|{
name|xinpcb
operator|.
name|qlen
operator|=
name|so
operator|->
name|so_qlen
expr_stmt|;
name|xinpcb
operator|.
name|maxqlen
operator|=
name|so
operator|->
name|so_qlimit
expr_stmt|;
block|}
name|SCTP_INP_INCR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xinpcb
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_inpcb
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
name|SCTP_INP_DECR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
return|return
operator|(
name|error
operator|)
return|;
block|}
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|error
operator|=
name|copy_out_local_addresses
argument_list|(
name|inp
argument_list|,
name|NULL
argument_list|,
name|req
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
name|SCTP_INP_DECR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
return|return
operator|(
name|error
operator|)
return|;
block|}
name|LIST_FOREACH
argument_list|(
argument|stcb
argument_list|,
argument|&inp->sctp_asoc_list
argument_list|,
argument|sctp_tcblist
argument_list|)
block|{
name|SCTP_TCB_LOCK
argument_list|(
name|stcb
argument_list|)
expr_stmt|;
name|atomic_add_int
argument_list|(
operator|&
name|stcb
operator|->
name|asoc
operator|.
name|refcnt
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|SCTP_TCB_UNLOCK
argument_list|(
name|stcb
argument_list|)
expr_stmt|;
name|xstcb
operator|.
name|last
operator|=
literal|0
expr_stmt|;
name|xstcb
operator|.
name|local_port
operator|=
name|ntohs
argument_list|(
name|inp
operator|->
name|sctp_lport
argument_list|)
expr_stmt|;
name|xstcb
operator|.
name|remote_port
operator|=
name|ntohs
argument_list|(
name|stcb
operator|->
name|rport
argument_list|)
expr_stmt|;
if|if
condition|(
name|stcb
operator|->
name|asoc
operator|.
name|primary_destination
operator|!=
name|NULL
condition|)
name|xstcb
operator|.
name|primary_addr
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|primary_destination
operator|->
name|ro
operator|.
name|_l_addr
expr_stmt|;
name|xstcb
operator|.
name|heartbeat_interval
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|heart_beat_delay
expr_stmt|;
name|xstcb
operator|.
name|state
operator|=
name|SCTP_GET_STATE
argument_list|(
operator|&
name|stcb
operator|->
name|asoc
argument_list|)
expr_stmt|;
comment|/* FIXME */
comment|/* 7.0 does not support these */
name|xstcb
operator|.
name|assoc_id
operator|=
name|sctp_get_associd
argument_list|(
name|stcb
argument_list|)
expr_stmt|;
name|xstcb
operator|.
name|peers_rwnd
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|peers_rwnd
expr_stmt|;
name|xstcb
operator|.
name|in_streams
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|streamincnt
expr_stmt|;
name|xstcb
operator|.
name|out_streams
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|streamoutcnt
expr_stmt|;
name|xstcb
operator|.
name|max_nr_retrans
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|overall_error_count
expr_stmt|;
name|xstcb
operator|.
name|primary_process
operator|=
literal|0
expr_stmt|;
comment|/* not really supported 							 * yet */
name|xstcb
operator|.
name|T1_expireries
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|timoinit
operator|+
name|stcb
operator|->
name|asoc
operator|.
name|timocookie
expr_stmt|;
name|xstcb
operator|.
name|T2_expireries
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|timoshutdown
operator|+
name|stcb
operator|->
name|asoc
operator|.
name|timoshutdownack
expr_stmt|;
name|xstcb
operator|.
name|retransmitted_tsns
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|marked_retrans
expr_stmt|;
name|xstcb
operator|.
name|start_time
operator|.
name|tv_sec
operator|=
operator|(
name|uint32_t
operator|)
name|stcb
operator|->
name|asoc
operator|.
name|start_time
operator|.
name|tv_sec
expr_stmt|;
name|xstcb
operator|.
name|start_time
operator|.
name|tv_usec
operator|=
operator|(
name|uint32_t
operator|)
name|stcb
operator|->
name|asoc
operator|.
name|start_time
operator|.
name|tv_usec
expr_stmt|;
name|xstcb
operator|.
name|discontinuity_time
operator|.
name|tv_sec
operator|=
operator|(
name|uint32_t
operator|)
name|stcb
operator|->
name|asoc
operator|.
name|discontinuity_time
operator|.
name|tv_sec
expr_stmt|;
name|xstcb
operator|.
name|discontinuity_time
operator|.
name|tv_usec
operator|=
operator|(
name|uint32_t
operator|)
name|stcb
operator|->
name|asoc
operator|.
name|discontinuity_time
operator|.
name|tv_usec
expr_stmt|;
name|xstcb
operator|.
name|total_sends
operator|=
name|stcb
operator|->
name|total_sends
expr_stmt|;
name|xstcb
operator|.
name|total_recvs
operator|=
name|stcb
operator|->
name|total_recvs
expr_stmt|;
name|xstcb
operator|.
name|local_tag
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|my_vtag
expr_stmt|;
name|xstcb
operator|.
name|remote_tag
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|peer_vtag
expr_stmt|;
name|xstcb
operator|.
name|initial_tsn
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|init_seq_number
expr_stmt|;
name|xstcb
operator|.
name|highest_tsn
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|sending_seq
operator|-
literal|1
expr_stmt|;
name|xstcb
operator|.
name|cumulative_tsn
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|last_acked_seq
expr_stmt|;
name|xstcb
operator|.
name|cumulative_tsn_ack
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|cumulative_tsn
expr_stmt|;
name|xstcb
operator|.
name|mtu
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|smallest_mtu
expr_stmt|;
name|xstcb
operator|.
name|refcnt
operator|=
name|stcb
operator|->
name|asoc
operator|.
name|refcnt
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xstcb
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_tcb
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
name|SCTP_INP_DECR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|atomic_subtract_int
argument_list|(
operator|&
name|stcb
operator|->
name|asoc
operator|.
name|refcnt
argument_list|,
literal|1
argument_list|)
expr_stmt|;
return|return
operator|(
name|error
operator|)
return|;
block|}
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|error
operator|=
name|copy_out_local_addresses
argument_list|(
name|inp
argument_list|,
name|stcb
argument_list|,
name|req
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
name|SCTP_INP_DECR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|atomic_subtract_int
argument_list|(
operator|&
name|stcb
operator|->
name|asoc
operator|.
name|refcnt
argument_list|,
literal|1
argument_list|)
expr_stmt|;
return|return
operator|(
name|error
operator|)
return|;
block|}
name|TAILQ_FOREACH
argument_list|(
argument|net
argument_list|,
argument|&stcb->asoc.nets
argument_list|,
argument|sctp_next
argument_list|)
block|{
name|xraddr
operator|.
name|last
operator|=
literal|0
expr_stmt|;
name|xraddr
operator|.
name|address
operator|=
name|net
operator|->
name|ro
operator|.
name|_l_addr
expr_stmt|;
name|xraddr
operator|.
name|active
operator|=
operator|(
operator|(
name|net
operator|->
name|dest_state
operator|&
name|SCTP_ADDR_REACHABLE
operator|)
operator|==
name|SCTP_ADDR_REACHABLE
operator|)
expr_stmt|;
name|xraddr
operator|.
name|confirmed
operator|=
operator|(
operator|(
name|net
operator|->
name|dest_state
operator|&
name|SCTP_ADDR_UNCONFIRMED
operator|)
operator|==
literal|0
operator|)
expr_stmt|;
name|xraddr
operator|.
name|heartbeat_enabled
operator|=
operator|(
operator|(
name|net
operator|->
name|dest_state
operator|&
name|SCTP_ADDR_NOHB
operator|)
operator|==
literal|0
operator|)
expr_stmt|;
name|xraddr
operator|.
name|potentially_failed
operator|=
operator|(
operator|(
name|net
operator|->
name|dest_state
operator|&
name|SCTP_ADDR_PF
operator|)
operator|==
name|SCTP_ADDR_PF
operator|)
expr_stmt|;
name|xraddr
operator|.
name|rto
operator|=
name|net
operator|->
name|RTO
expr_stmt|;
name|xraddr
operator|.
name|max_path_rtx
operator|=
name|net
operator|->
name|failure_threshold
expr_stmt|;
name|xraddr
operator|.
name|rtx
operator|=
name|net
operator|->
name|marked_retrans
expr_stmt|;
name|xraddr
operator|.
name|error_counter
operator|=
name|net
operator|->
name|error_count
expr_stmt|;
name|xraddr
operator|.
name|cwnd
operator|=
name|net
operator|->
name|cwnd
expr_stmt|;
name|xraddr
operator|.
name|flight_size
operator|=
name|net
operator|->
name|flight_size
expr_stmt|;
name|xraddr
operator|.
name|mtu
operator|=
name|net
operator|->
name|mtu
expr_stmt|;
name|xraddr
operator|.
name|rtt
operator|=
name|net
operator|->
name|rtt
operator|/
literal|1000
expr_stmt|;
name|xraddr
operator|.
name|heartbeat_interval
operator|=
name|net
operator|->
name|heart_beat_delay
expr_stmt|;
name|xraddr
operator|.
name|start_time
operator|.
name|tv_sec
operator|=
operator|(
name|uint32_t
operator|)
name|net
operator|->
name|start_time
operator|.
name|tv_sec
expr_stmt|;
name|xraddr
operator|.
name|start_time
operator|.
name|tv_usec
operator|=
operator|(
name|uint32_t
operator|)
name|net
operator|->
name|start_time
operator|.
name|tv_usec
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xraddr
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_raddr
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
name|SCTP_INP_DECR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|atomic_subtract_int
argument_list|(
operator|&
name|stcb
operator|->
name|asoc
operator|.
name|refcnt
argument_list|,
literal|1
argument_list|)
expr_stmt|;
return|return
operator|(
name|error
operator|)
return|;
block|}
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
block|}
name|atomic_subtract_int
argument_list|(
operator|&
name|stcb
operator|->
name|asoc
operator|.
name|refcnt
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|memset
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|xraddr
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_raddr
argument_list|)
argument_list|)
expr_stmt|;
name|xraddr
operator|.
name|last
operator|=
literal|1
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xraddr
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_raddr
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
name|SCTP_INP_DECR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
return|return
operator|(
name|error
operator|)
return|;
block|}
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|SCTP_INP_RLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
block|}
name|SCTP_INP_DECR_REF
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_RUNLOCK
argument_list|(
name|inp
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|memset
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|xstcb
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_tcb
argument_list|)
argument_list|)
expr_stmt|;
name|xstcb
operator|.
name|last
operator|=
literal|1
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xstcb
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_tcb
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
condition|)
block|{
return|return
operator|(
name|error
operator|)
return|;
block|}
name|skip
label|:
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
block|}
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|memset
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|xinpcb
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_inpcb
argument_list|)
argument_list|)
expr_stmt|;
name|xinpcb
operator|.
name|last
operator|=
literal|1
expr_stmt|;
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|xinpcb
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|xsctp_inpcb
argument_list|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|error
operator|)
return|;
block|}
end_function

begin_define
define|#
directive|define
name|RANGECHK
parameter_list|(
name|var
parameter_list|,
name|min
parameter_list|,
name|max
parameter_list|)
define|\
value|if ((var)< (min)) { (var) = (min); } \ 	else if ((var)> (max)) { (var) = (max); }
end_define

begin_function
specifier|static
name|int
name|sysctl_sctp_udp_tunneling_check
parameter_list|(
name|SYSCTL_HANDLER_ARGS
parameter_list|)
block|{
name|int
name|error
decl_stmt|;
name|uint32_t
name|old_sctp_udp_tunneling_port
decl_stmt|;
name|SCTP_INP_INFO_RLOCK
argument_list|()
expr_stmt|;
name|old_sctp_udp_tunneling_port
operator|=
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_udp_tunneling_port
argument_list|)
expr_stmt|;
name|SCTP_INP_INFO_RUNLOCK
argument_list|()
expr_stmt|;
name|error
operator|=
name|sysctl_handle_int
argument_list|(
name|oidp
argument_list|,
name|oidp
operator|->
name|oid_arg1
argument_list|,
name|oidp
operator|->
name|oid_arg2
argument_list|,
name|req
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_udp_tunneling_port
argument_list|)
argument_list|,
name|SCTPCTL_UDP_TUNNELING_PORT_MIN
argument_list|,
name|SCTPCTL_UDP_TUNNELING_PORT_MAX
argument_list|)
expr_stmt|;
if|if
condition|(
name|old_sctp_udp_tunneling_port
operator|==
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_udp_tunneling_port
argument_list|)
condition|)
block|{
name|error
operator|=
literal|0
expr_stmt|;
goto|goto
name|out
goto|;
block|}
name|SCTP_INP_INFO_WLOCK
argument_list|()
expr_stmt|;
if|if
condition|(
name|old_sctp_udp_tunneling_port
condition|)
block|{
name|sctp_over_udp_stop
argument_list|()
expr_stmt|;
block|}
if|if
condition|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_udp_tunneling_port
argument_list|)
condition|)
block|{
if|if
condition|(
name|sctp_over_udp_start
argument_list|()
condition|)
block|{
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_udp_tunneling_port
argument_list|)
operator|=
literal|0
expr_stmt|;
block|}
block|}
name|SCTP_INP_INFO_WUNLOCK
argument_list|()
expr_stmt|;
block|}
name|out
label|:
return|return
operator|(
name|error
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|sysctl_sctp_check
parameter_list|(
name|SYSCTL_HANDLER_ARGS
parameter_list|)
block|{
name|int
name|error
decl_stmt|;
name|error
operator|=
name|sysctl_handle_int
argument_list|(
name|oidp
argument_list|,
name|oidp
operator|->
name|oid_arg1
argument_list|,
name|oidp
operator|->
name|oid_arg2
argument_list|,
name|req
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_sendspace
argument_list|)
argument_list|,
name|SCTPCTL_MAXDGRAM_MIN
argument_list|,
name|SCTPCTL_MAXDGRAM_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_recvspace
argument_list|)
argument_list|,
name|SCTPCTL_RECVSPACE_MIN
argument_list|,
name|SCTPCTL_RECVSPACE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auto_asconf
argument_list|)
argument_list|,
name|SCTPCTL_AUTOASCONF_MIN
argument_list|,
name|SCTPCTL_AUTOASCONF_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_ecn_enable
argument_list|)
argument_list|,
name|SCTPCTL_ECN_ENABLE_MIN
argument_list|,
name|SCTPCTL_ECN_ENABLE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pr_enable
argument_list|)
argument_list|,
name|SCTPCTL_PR_ENABLE_MIN
argument_list|,
name|SCTPCTL_PR_ENABLE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_reconfig_enable
argument_list|)
argument_list|,
name|SCTPCTL_RECONFIG_ENABLE_MIN
argument_list|,
name|SCTPCTL_RECONFIG_ENABLE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nrsack_enable
argument_list|)
argument_list|,
name|SCTPCTL_NRSACK_ENABLE_MIN
argument_list|,
name|SCTPCTL_NRSACK_ENABLE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pktdrop_enable
argument_list|)
argument_list|,
name|SCTPCTL_PKTDROP_ENABLE_MIN
argument_list|,
name|SCTPCTL_PKTDROP_ENABLE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_strict_sacks
argument_list|)
argument_list|,
name|SCTPCTL_STRICT_SACKS_MIN
argument_list|,
name|SCTPCTL_STRICT_SACKS_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_peer_chunk_oh
argument_list|)
argument_list|,
name|SCTPCTL_PEER_CHKOH_MIN
argument_list|,
name|SCTPCTL_PEER_CHKOH_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_burst_default
argument_list|)
argument_list|,
name|SCTPCTL_MAXBURST_MIN
argument_list|,
name|SCTPCTL_MAXBURST_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_fr_max_burst_default
argument_list|)
argument_list|,
name|SCTPCTL_FRMAXBURST_MIN
argument_list|,
name|SCTPCTL_FRMAXBURST_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_chunks_on_queue
argument_list|)
argument_list|,
name|SCTPCTL_MAXCHUNKS_MIN
argument_list|,
name|SCTPCTL_MAXCHUNKS_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_hashtblsize
argument_list|)
argument_list|,
name|SCTPCTL_TCBHASHSIZE_MIN
argument_list|,
name|SCTPCTL_TCBHASHSIZE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pcbtblsize
argument_list|)
argument_list|,
name|SCTPCTL_PCBHASHSIZE_MIN
argument_list|,
name|SCTPCTL_PCBHASHSIZE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_min_split_point
argument_list|)
argument_list|,
name|SCTPCTL_MIN_SPLIT_POINT_MIN
argument_list|,
name|SCTPCTL_MIN_SPLIT_POINT_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_chunkscale
argument_list|)
argument_list|,
name|SCTPCTL_CHUNKSCALE_MIN
argument_list|,
name|SCTPCTL_CHUNKSCALE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_delayed_sack_time_default
argument_list|)
argument_list|,
name|SCTPCTL_DELAYED_SACK_TIME_MIN
argument_list|,
name|SCTPCTL_DELAYED_SACK_TIME_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_sack_freq_default
argument_list|)
argument_list|,
name|SCTPCTL_SACK_FREQ_MIN
argument_list|,
name|SCTPCTL_SACK_FREQ_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_system_free_resc_limit
argument_list|)
argument_list|,
name|SCTPCTL_SYS_RESOURCE_MIN
argument_list|,
name|SCTPCTL_SYS_RESOURCE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asoc_free_resc_limit
argument_list|)
argument_list|,
name|SCTPCTL_ASOC_RESOURCE_MIN
argument_list|,
name|SCTPCTL_ASOC_RESOURCE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_heartbeat_interval_default
argument_list|)
argument_list|,
name|SCTPCTL_HEARTBEAT_INTERVAL_MIN
argument_list|,
name|SCTPCTL_HEARTBEAT_INTERVAL_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pmtu_raise_time_default
argument_list|)
argument_list|,
name|SCTPCTL_PMTU_RAISE_TIME_MIN
argument_list|,
name|SCTPCTL_PMTU_RAISE_TIME_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_shutdown_guard_time_default
argument_list|)
argument_list|,
name|SCTPCTL_SHUTDOWN_GUARD_TIME_MIN
argument_list|,
name|SCTPCTL_SHUTDOWN_GUARD_TIME_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_secret_lifetime_default
argument_list|)
argument_list|,
name|SCTPCTL_SECRET_LIFETIME_MIN
argument_list|,
name|SCTPCTL_SECRET_LIFETIME_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_max_default
argument_list|)
argument_list|,
name|SCTPCTL_RTO_MAX_MIN
argument_list|,
name|SCTPCTL_RTO_MAX_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_min_default
argument_list|)
argument_list|,
name|SCTPCTL_RTO_MIN_MIN
argument_list|,
name|SCTPCTL_RTO_MIN_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_initial_default
argument_list|)
argument_list|,
name|SCTPCTL_RTO_INITIAL_MIN
argument_list|,
name|SCTPCTL_RTO_INITIAL_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_init_rto_max_default
argument_list|)
argument_list|,
name|SCTPCTL_INIT_RTO_MAX_MIN
argument_list|,
name|SCTPCTL_INIT_RTO_MAX_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_valid_cookie_life_default
argument_list|)
argument_list|,
name|SCTPCTL_VALID_COOKIE_LIFE_MIN
argument_list|,
name|SCTPCTL_VALID_COOKIE_LIFE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_init_rtx_max_default
argument_list|)
argument_list|,
name|SCTPCTL_INIT_RTX_MAX_MIN
argument_list|,
name|SCTPCTL_INIT_RTX_MAX_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_assoc_rtx_max_default
argument_list|)
argument_list|,
name|SCTPCTL_ASSOC_RTX_MAX_MIN
argument_list|,
name|SCTPCTL_ASSOC_RTX_MAX_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_path_rtx_max_default
argument_list|)
argument_list|,
name|SCTPCTL_PATH_RTX_MAX_MIN
argument_list|,
name|SCTPCTL_PATH_RTX_MAX_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_path_pf_threshold
argument_list|)
argument_list|,
name|SCTPCTL_PATH_PF_THRESHOLD_MIN
argument_list|,
name|SCTPCTL_PATH_PF_THRESHOLD_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_add_more_threshold
argument_list|)
argument_list|,
name|SCTPCTL_ADD_MORE_ON_OUTPUT_MIN
argument_list|,
name|SCTPCTL_ADD_MORE_ON_OUTPUT_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nr_incoming_streams_default
argument_list|)
argument_list|,
name|SCTPCTL_INCOMING_STREAMS_MIN
argument_list|,
name|SCTPCTL_INCOMING_STREAMS_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nr_outgoing_streams_default
argument_list|)
argument_list|,
name|SCTPCTL_OUTGOING_STREAMS_MIN
argument_list|,
name|SCTPCTL_OUTGOING_STREAMS_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_cmt_on_off
argument_list|)
argument_list|,
name|SCTPCTL_CMT_ON_OFF_MIN
argument_list|,
name|SCTPCTL_CMT_ON_OFF_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_cmt_use_dac
argument_list|)
argument_list|,
name|SCTPCTL_CMT_USE_DAC_MIN
argument_list|,
name|SCTPCTL_CMT_USE_DAC_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_use_cwnd_based_maxburst
argument_list|)
argument_list|,
name|SCTPCTL_CWND_MAXBURST_MIN
argument_list|,
name|SCTPCTL_CWND_MAXBURST_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nat_friendly
argument_list|)
argument_list|,
name|SCTPCTL_NAT_FRIENDLY_MIN
argument_list|,
name|SCTPCTL_NAT_FRIENDLY_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_L2_abc_variable
argument_list|)
argument_list|,
name|SCTPCTL_ABC_L_VAR_MIN
argument_list|,
name|SCTPCTL_ABC_L_VAR_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mbuf_threshold_count
argument_list|)
argument_list|,
name|SCTPCTL_MAX_CHAINED_MBUFS_MIN
argument_list|,
name|SCTPCTL_MAX_CHAINED_MBUFS_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_do_drain
argument_list|)
argument_list|,
name|SCTPCTL_DO_SCTP_DRAIN_MIN
argument_list|,
name|SCTPCTL_DO_SCTP_DRAIN_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_hb_maxburst
argument_list|)
argument_list|,
name|SCTPCTL_HB_MAX_BURST_MIN
argument_list|,
name|SCTPCTL_HB_MAX_BURST_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_abort_if_one_2_one_hits_limit
argument_list|)
argument_list|,
name|SCTPCTL_ABORT_AT_LIMIT_MIN
argument_list|,
name|SCTPCTL_ABORT_AT_LIMIT_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_strict_data_order
argument_list|)
argument_list|,
name|SCTPCTL_STRICT_DATA_ORDER_MIN
argument_list|,
name|SCTPCTL_STRICT_DATA_ORDER_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_min_residual
argument_list|)
argument_list|,
name|SCTPCTL_MIN_RESIDUAL_MIN
argument_list|,
name|SCTPCTL_MIN_RESIDUAL_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_retran_chunk
argument_list|)
argument_list|,
name|SCTPCTL_MAX_RETRAN_CHUNK_MIN
argument_list|,
name|SCTPCTL_MAX_RETRAN_CHUNK_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_logging_level
argument_list|)
argument_list|,
name|SCTPCTL_LOGGING_LEVEL_MIN
argument_list|,
name|SCTPCTL_LOGGING_LEVEL_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_default_cc_module
argument_list|)
argument_list|,
name|SCTPCTL_DEFAULT_CC_MODULE_MIN
argument_list|,
name|SCTPCTL_DEFAULT_CC_MODULE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_default_ss_module
argument_list|)
argument_list|,
name|SCTPCTL_DEFAULT_SS_MODULE_MIN
argument_list|,
name|SCTPCTL_DEFAULT_SS_MODULE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_default_frag_interleave
argument_list|)
argument_list|,
name|SCTPCTL_DEFAULT_FRAG_INTERLEAVE_MIN
argument_list|,
name|SCTPCTL_DEFAULT_FRAG_INTERLEAVE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_vtag_time_wait
argument_list|)
argument_list|,
name|SCTPCTL_TIME_WAIT_MIN
argument_list|,
name|SCTPCTL_TIME_WAIT_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_buffer_splitting
argument_list|)
argument_list|,
name|SCTPCTL_BUFFER_SPLITTING_MIN
argument_list|,
name|SCTPCTL_BUFFER_SPLITTING_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_initial_cwnd
argument_list|)
argument_list|,
name|SCTPCTL_INITIAL_CWND_MIN
argument_list|,
name|SCTPCTL_INITIAL_CWND_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rttvar_bw
argument_list|)
argument_list|,
name|SCTPCTL_RTTVAR_BW_MIN
argument_list|,
name|SCTPCTL_RTTVAR_BW_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rttvar_rtt
argument_list|)
argument_list|,
name|SCTPCTL_RTTVAR_RTT_MIN
argument_list|,
name|SCTPCTL_RTTVAR_RTT_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rttvar_eqret
argument_list|)
argument_list|,
name|SCTPCTL_RTTVAR_EQRET_MIN
argument_list|,
name|SCTPCTL_RTTVAR_EQRET_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_steady_step
argument_list|)
argument_list|,
name|SCTPCTL_RTTVAR_STEADYS_MIN
argument_list|,
name|SCTPCTL_RTTVAR_STEADYS_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_use_dccc_ecn
argument_list|)
argument_list|,
name|SCTPCTL_RTTVAR_DCCCECN_MIN
argument_list|,
name|SCTPCTL_RTTVAR_DCCCECN_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mobility_base
argument_list|)
argument_list|,
name|SCTPCTL_MOBILITY_BASE_MIN
argument_list|,
name|SCTPCTL_MOBILITY_BASE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mobility_fasthandoff
argument_list|)
argument_list|,
name|SCTPCTL_MOBILITY_FASTHANDOFF_MIN
argument_list|,
name|SCTPCTL_MOBILITY_FASTHANDOFF_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_enable_sack_immediately
argument_list|)
argument_list|,
name|SCTPCTL_SACK_IMMEDIATELY_ENABLE_MIN
argument_list|,
name|SCTPCTL_SACK_IMMEDIATELY_ENABLE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_inits_include_nat_friendly
argument_list|)
argument_list|,
name|SCTPCTL_NAT_FRIENDLY_INITS_MIN
argument_list|,
name|SCTPCTL_NAT_FRIENDLY_INITS_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_blackhole
argument_list|)
argument_list|,
name|SCTPCTL_BLACKHOLE_MIN
argument_list|,
name|SCTPCTL_BLACKHOLE_MAX
argument_list|)
expr_stmt|;
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_diag_info_code
argument_list|)
argument_list|,
name|SCTPCTL_DIAG_INFO_CODE_MIN
argument_list|,
name|SCTPCTL_DIAG_INFO_CODE_MAX
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|SCTP_DEBUG
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_debug_on
argument_list|)
argument_list|,
name|SCTPCTL_DEBUG_MIN
argument_list|,
name|SCTPCTL_DEBUG_MAX
argument_list|)
expr_stmt|;
endif|#
directive|endif
if|#
directive|if
name|defined
argument_list|(
name|__APPLE__
argument_list|)
operator|||
name|defined
argument_list|(
name|SCTP_SO_LOCK_TESTING
argument_list|)
name|RANGECHK
argument_list|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_output_unlocked
argument_list|)
argument_list|,
name|SCTPCTL_OUTPUT_UNLOCKED_MIN
argument_list|,
name|SCTPCTL_OUTPUT_UNLOCKED_MAX
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
return|return
operator|(
name|error
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|sysctl_sctp_auth_check
parameter_list|(
name|SYSCTL_HANDLER_ARGS
parameter_list|)
block|{
name|int
name|error
decl_stmt|;
name|error
operator|=
name|sysctl_handle_int
argument_list|(
name|oidp
argument_list|,
name|oidp
operator|->
name|oid_arg1
argument_list|,
name|oidp
operator|->
name|oid_arg2
argument_list|,
name|req
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auth_disable
argument_list|)
operator|<
name|SCTPCTL_AUTH_DISABLE_MIN
condition|)
block|{
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auth_disable
argument_list|)
operator|=
name|SCTPCTL_AUTH_DISABLE_MIN
expr_stmt|;
block|}
if|if
condition|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auth_disable
argument_list|)
operator|>
name|SCTPCTL_AUTH_DISABLE_MAX
condition|)
block|{
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auth_disable
argument_list|)
operator|=
name|SCTPCTL_AUTH_DISABLE_MAX
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auth_disable
argument_list|)
operator|==
literal|1
operator|)
operator|&&
operator|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asconf_enable
argument_list|)
operator|==
literal|1
operator|)
condition|)
block|{
comment|/* 			 * You can't disable AUTH with disabling ASCONF 			 * first 			 */
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auth_disable
argument_list|)
operator|=
literal|0
expr_stmt|;
block|}
block|}
return|return
operator|(
name|error
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|sysctl_sctp_asconf_check
parameter_list|(
name|SYSCTL_HANDLER_ARGS
parameter_list|)
block|{
name|int
name|error
decl_stmt|;
name|error
operator|=
name|sysctl_handle_int
argument_list|(
name|oidp
argument_list|,
name|oidp
operator|->
name|oid_arg1
argument_list|,
name|oidp
operator|->
name|oid_arg2
argument_list|,
name|req
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asconf_enable
argument_list|)
operator|<
name|SCTPCTL_ASCONF_ENABLE_MIN
condition|)
block|{
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asconf_enable
argument_list|)
operator|=
name|SCTPCTL_ASCONF_ENABLE_MIN
expr_stmt|;
block|}
if|if
condition|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asconf_enable
argument_list|)
operator|>
name|SCTPCTL_ASCONF_ENABLE_MAX
condition|)
block|{
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asconf_enable
argument_list|)
operator|=
name|SCTPCTL_ASCONF_ENABLE_MAX
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asconf_enable
argument_list|)
operator|==
literal|1
operator|)
operator|&&
operator|(
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auth_disable
argument_list|)
operator|==
literal|1
operator|)
condition|)
block|{
comment|/* 			 * You can't enable ASCONF without enabling AUTH 			 * first 			 */
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asconf_enable
argument_list|)
operator|=
literal|0
expr_stmt|;
block|}
block|}
return|return
operator|(
name|error
operator|)
return|;
block|}
end_function

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__FreeBSD__
argument_list|)
operator|&&
name|defined
argument_list|(
name|SMP
argument_list|)
operator|&&
name|defined
argument_list|(
name|SCTP_USE_PERCPU_STAT
argument_list|)
end_if

begin_function
specifier|static
name|int
name|sysctl_stat_get
parameter_list|(
name|SYSCTL_HANDLER_ARGS
parameter_list|)
block|{
name|int
name|cpu
decl_stmt|,
name|error
decl_stmt|;
name|struct
name|sctpstat
name|sb
decl_stmt|,
modifier|*
name|sarry
decl_stmt|,
modifier|*
name|cpin
init|=
name|NULL
decl_stmt|;
if|if
condition|(
operator|(
name|req
operator|->
name|newptr
operator|)
operator|&&
operator|(
name|req
operator|->
name|newlen
operator|==
sizeof|sizeof
argument_list|(
expr|struct
name|sctpstat
argument_list|)
operator|)
condition|)
block|{
comment|/* 		 * User wants us to clear or at least reset the counters to 		 * the specified values. 		 */
name|cpin
operator|=
operator|(
expr|struct
name|sctpstat
operator|*
operator|)
name|req
operator|->
name|newptr
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|req
operator|->
name|newptr
condition|)
block|{
comment|/* Must be a stat structure */
return|return
operator|(
name|EINVAL
operator|)
return|;
block|}
name|memset
argument_list|(
operator|&
name|sb
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|sb
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|cpu
operator|=
literal|0
init|;
name|cpu
operator|<
name|mp_maxid
condition|;
name|cpu
operator|++
control|)
block|{
name|sarry
operator|=
operator|&
name|SCTP_BASE_STATS
index|[
name|cpu
index|]
expr_stmt|;
if|if
condition|(
name|sarry
operator|->
name|sctps_discontinuitytime
operator|.
name|tv_sec
operator|>
name|sb
operator|.
name|sctps_discontinuitytime
operator|.
name|tv_sec
condition|)
block|{
name|sb
operator|.
name|sctps_discontinuitytime
operator|.
name|tv_sec
operator|=
name|sarry
operator|->
name|sctps_discontinuitytime
operator|.
name|tv_sec
expr_stmt|;
name|sb
operator|.
name|sctps_discontinuitytime
operator|.
name|tv_usec
operator|=
name|sarry
operator|->
name|sctps_discontinuitytime
operator|.
name|tv_usec
expr_stmt|;
block|}
name|sb
operator|.
name|sctps_currestab
operator|+=
name|sarry
operator|->
name|sctps_currestab
expr_stmt|;
name|sb
operator|.
name|sctps_activeestab
operator|+=
name|sarry
operator|->
name|sctps_activeestab
expr_stmt|;
name|sb
operator|.
name|sctps_restartestab
operator|+=
name|sarry
operator|->
name|sctps_restartestab
expr_stmt|;
name|sb
operator|.
name|sctps_collisionestab
operator|+=
name|sarry
operator|->
name|sctps_collisionestab
expr_stmt|;
name|sb
operator|.
name|sctps_passiveestab
operator|+=
name|sarry
operator|->
name|sctps_passiveestab
expr_stmt|;
name|sb
operator|.
name|sctps_aborted
operator|+=
name|sarry
operator|->
name|sctps_aborted
expr_stmt|;
name|sb
operator|.
name|sctps_shutdown
operator|+=
name|sarry
operator|->
name|sctps_shutdown
expr_stmt|;
name|sb
operator|.
name|sctps_outoftheblue
operator|+=
name|sarry
operator|->
name|sctps_outoftheblue
expr_stmt|;
name|sb
operator|.
name|sctps_checksumerrors
operator|+=
name|sarry
operator|->
name|sctps_checksumerrors
expr_stmt|;
name|sb
operator|.
name|sctps_outcontrolchunks
operator|+=
name|sarry
operator|->
name|sctps_outcontrolchunks
expr_stmt|;
name|sb
operator|.
name|sctps_outorderchunks
operator|+=
name|sarry
operator|->
name|sctps_outorderchunks
expr_stmt|;
name|sb
operator|.
name|sctps_outunorderchunks
operator|+=
name|sarry
operator|->
name|sctps_outunorderchunks
expr_stmt|;
name|sb
operator|.
name|sctps_incontrolchunks
operator|+=
name|sarry
operator|->
name|sctps_incontrolchunks
expr_stmt|;
name|sb
operator|.
name|sctps_inorderchunks
operator|+=
name|sarry
operator|->
name|sctps_inorderchunks
expr_stmt|;
name|sb
operator|.
name|sctps_inunorderchunks
operator|+=
name|sarry
operator|->
name|sctps_inunorderchunks
expr_stmt|;
name|sb
operator|.
name|sctps_fragusrmsgs
operator|+=
name|sarry
operator|->
name|sctps_fragusrmsgs
expr_stmt|;
name|sb
operator|.
name|sctps_reasmusrmsgs
operator|+=
name|sarry
operator|->
name|sctps_reasmusrmsgs
expr_stmt|;
name|sb
operator|.
name|sctps_outpackets
operator|+=
name|sarry
operator|->
name|sctps_outpackets
expr_stmt|;
name|sb
operator|.
name|sctps_inpackets
operator|+=
name|sarry
operator|->
name|sctps_inpackets
expr_stmt|;
name|sb
operator|.
name|sctps_recvpackets
operator|+=
name|sarry
operator|->
name|sctps_recvpackets
expr_stmt|;
name|sb
operator|.
name|sctps_recvdatagrams
operator|+=
name|sarry
operator|->
name|sctps_recvdatagrams
expr_stmt|;
name|sb
operator|.
name|sctps_recvpktwithdata
operator|+=
name|sarry
operator|->
name|sctps_recvpktwithdata
expr_stmt|;
name|sb
operator|.
name|sctps_recvsacks
operator|+=
name|sarry
operator|->
name|sctps_recvsacks
expr_stmt|;
name|sb
operator|.
name|sctps_recvdata
operator|+=
name|sarry
operator|->
name|sctps_recvdata
expr_stmt|;
name|sb
operator|.
name|sctps_recvdupdata
operator|+=
name|sarry
operator|->
name|sctps_recvdupdata
expr_stmt|;
name|sb
operator|.
name|sctps_recvheartbeat
operator|+=
name|sarry
operator|->
name|sctps_recvheartbeat
expr_stmt|;
name|sb
operator|.
name|sctps_recvheartbeatack
operator|+=
name|sarry
operator|->
name|sctps_recvheartbeatack
expr_stmt|;
name|sb
operator|.
name|sctps_recvecne
operator|+=
name|sarry
operator|->
name|sctps_recvecne
expr_stmt|;
name|sb
operator|.
name|sctps_recvauth
operator|+=
name|sarry
operator|->
name|sctps_recvauth
expr_stmt|;
name|sb
operator|.
name|sctps_recvauthmissing
operator|+=
name|sarry
operator|->
name|sctps_recvauthmissing
expr_stmt|;
name|sb
operator|.
name|sctps_recvivalhmacid
operator|+=
name|sarry
operator|->
name|sctps_recvivalhmacid
expr_stmt|;
name|sb
operator|.
name|sctps_recvivalkeyid
operator|+=
name|sarry
operator|->
name|sctps_recvivalkeyid
expr_stmt|;
name|sb
operator|.
name|sctps_recvauthfailed
operator|+=
name|sarry
operator|->
name|sctps_recvauthfailed
expr_stmt|;
name|sb
operator|.
name|sctps_recvexpress
operator|+=
name|sarry
operator|->
name|sctps_recvexpress
expr_stmt|;
name|sb
operator|.
name|sctps_recvexpressm
operator|+=
name|sarry
operator|->
name|sctps_recvexpressm
expr_stmt|;
name|sb
operator|.
name|sctps_recvnocrc
operator|+=
name|sarry
operator|->
name|sctps_recvnocrc
expr_stmt|;
name|sb
operator|.
name|sctps_recvswcrc
operator|+=
name|sarry
operator|->
name|sctps_recvswcrc
expr_stmt|;
name|sb
operator|.
name|sctps_recvhwcrc
operator|+=
name|sarry
operator|->
name|sctps_recvhwcrc
expr_stmt|;
name|sb
operator|.
name|sctps_sendpackets
operator|+=
name|sarry
operator|->
name|sctps_sendpackets
expr_stmt|;
name|sb
operator|.
name|sctps_sendsacks
operator|+=
name|sarry
operator|->
name|sctps_sendsacks
expr_stmt|;
name|sb
operator|.
name|sctps_senddata
operator|+=
name|sarry
operator|->
name|sctps_senddata
expr_stmt|;
name|sb
operator|.
name|sctps_sendretransdata
operator|+=
name|sarry
operator|->
name|sctps_sendretransdata
expr_stmt|;
name|sb
operator|.
name|sctps_sendfastretrans
operator|+=
name|sarry
operator|->
name|sctps_sendfastretrans
expr_stmt|;
name|sb
operator|.
name|sctps_sendmultfastretrans
operator|+=
name|sarry
operator|->
name|sctps_sendmultfastretrans
expr_stmt|;
name|sb
operator|.
name|sctps_sendheartbeat
operator|+=
name|sarry
operator|->
name|sctps_sendheartbeat
expr_stmt|;
name|sb
operator|.
name|sctps_sendecne
operator|+=
name|sarry
operator|->
name|sctps_sendecne
expr_stmt|;
name|sb
operator|.
name|sctps_sendauth
operator|+=
name|sarry
operator|->
name|sctps_sendauth
expr_stmt|;
name|sb
operator|.
name|sctps_senderrors
operator|+=
name|sarry
operator|->
name|sctps_senderrors
expr_stmt|;
name|sb
operator|.
name|sctps_sendnocrc
operator|+=
name|sarry
operator|->
name|sctps_sendnocrc
expr_stmt|;
name|sb
operator|.
name|sctps_sendswcrc
operator|+=
name|sarry
operator|->
name|sctps_sendswcrc
expr_stmt|;
name|sb
operator|.
name|sctps_sendhwcrc
operator|+=
name|sarry
operator|->
name|sctps_sendhwcrc
expr_stmt|;
name|sb
operator|.
name|sctps_pdrpfmbox
operator|+=
name|sarry
operator|->
name|sctps_pdrpfmbox
expr_stmt|;
name|sb
operator|.
name|sctps_pdrpfehos
operator|+=
name|sarry
operator|->
name|sctps_pdrpfehos
expr_stmt|;
name|sb
operator|.
name|sctps_pdrpmbda
operator|+=
name|sarry
operator|->
name|sctps_pdrpmbda
expr_stmt|;
name|sb
operator|.
name|sctps_pdrpmbct
operator|+=
name|sarry
operator|->
name|sctps_pdrpmbct
expr_stmt|;
name|sb
operator|.
name|sctps_pdrpbwrpt
operator|+=
name|sarry
operator|->
name|sctps_pdrpbwrpt
expr_stmt|;
name|sb
operator|.
name|sctps_pdrpcrupt
operator|+=
name|sarry
operator|->
name|sctps_pdrpcrupt
expr_stmt|;
name|sb
operator|.
name|sctps_pdrpnedat
operator|+=
name|sarry
operator|->
name|sctps_pdrpnedat
expr_stmt|;
name|sb
operator|.
name|sctps_pdrppdbrk
operator|+=
name|sarry
operator|->
name|sctps_pdrppdbrk
expr_stmt|;
name|sb
operator|.
name|sctps_pdrptsnnf
operator|+=
name|sarry
operator|->
name|sctps_pdrptsnnf
expr_stmt|;
name|sb
operator|.
name|sctps_pdrpdnfnd
operator|+=
name|sarry
operator|->
name|sctps_pdrpdnfnd
expr_stmt|;
name|sb
operator|.
name|sctps_pdrpdiwnp
operator|+=
name|sarry
operator|->
name|sctps_pdrpdiwnp
expr_stmt|;
name|sb
operator|.
name|sctps_pdrpdizrw
operator|+=
name|sarry
operator|->
name|sctps_pdrpdizrw
expr_stmt|;
name|sb
operator|.
name|sctps_pdrpbadd
operator|+=
name|sarry
operator|->
name|sctps_pdrpbadd
expr_stmt|;
name|sb
operator|.
name|sctps_pdrpmark
operator|+=
name|sarry
operator|->
name|sctps_pdrpmark
expr_stmt|;
name|sb
operator|.
name|sctps_timoiterator
operator|+=
name|sarry
operator|->
name|sctps_timoiterator
expr_stmt|;
name|sb
operator|.
name|sctps_timodata
operator|+=
name|sarry
operator|->
name|sctps_timodata
expr_stmt|;
name|sb
operator|.
name|sctps_timowindowprobe
operator|+=
name|sarry
operator|->
name|sctps_timowindowprobe
expr_stmt|;
name|sb
operator|.
name|sctps_timoinit
operator|+=
name|sarry
operator|->
name|sctps_timoinit
expr_stmt|;
name|sb
operator|.
name|sctps_timosack
operator|+=
name|sarry
operator|->
name|sctps_timosack
expr_stmt|;
name|sb
operator|.
name|sctps_timoshutdown
operator|+=
name|sarry
operator|->
name|sctps_timoshutdown
expr_stmt|;
name|sb
operator|.
name|sctps_timoheartbeat
operator|+=
name|sarry
operator|->
name|sctps_timoheartbeat
expr_stmt|;
name|sb
operator|.
name|sctps_timocookie
operator|+=
name|sarry
operator|->
name|sctps_timocookie
expr_stmt|;
name|sb
operator|.
name|sctps_timosecret
operator|+=
name|sarry
operator|->
name|sctps_timosecret
expr_stmt|;
name|sb
operator|.
name|sctps_timopathmtu
operator|+=
name|sarry
operator|->
name|sctps_timopathmtu
expr_stmt|;
name|sb
operator|.
name|sctps_timoshutdownack
operator|+=
name|sarry
operator|->
name|sctps_timoshutdownack
expr_stmt|;
name|sb
operator|.
name|sctps_timoshutdownguard
operator|+=
name|sarry
operator|->
name|sctps_timoshutdownguard
expr_stmt|;
name|sb
operator|.
name|sctps_timostrmrst
operator|+=
name|sarry
operator|->
name|sctps_timostrmrst
expr_stmt|;
name|sb
operator|.
name|sctps_timoearlyfr
operator|+=
name|sarry
operator|->
name|sctps_timoearlyfr
expr_stmt|;
name|sb
operator|.
name|sctps_timoasconf
operator|+=
name|sarry
operator|->
name|sctps_timoasconf
expr_stmt|;
name|sb
operator|.
name|sctps_timodelprim
operator|+=
name|sarry
operator|->
name|sctps_timodelprim
expr_stmt|;
name|sb
operator|.
name|sctps_timoautoclose
operator|+=
name|sarry
operator|->
name|sctps_timoautoclose
expr_stmt|;
name|sb
operator|.
name|sctps_timoassockill
operator|+=
name|sarry
operator|->
name|sctps_timoassockill
expr_stmt|;
name|sb
operator|.
name|sctps_timoinpkill
operator|+=
name|sarry
operator|->
name|sctps_timoinpkill
expr_stmt|;
name|sb
operator|.
name|sctps_hdrops
operator|+=
name|sarry
operator|->
name|sctps_hdrops
expr_stmt|;
name|sb
operator|.
name|sctps_badsum
operator|+=
name|sarry
operator|->
name|sctps_badsum
expr_stmt|;
name|sb
operator|.
name|sctps_noport
operator|+=
name|sarry
operator|->
name|sctps_noport
expr_stmt|;
name|sb
operator|.
name|sctps_badvtag
operator|+=
name|sarry
operator|->
name|sctps_badvtag
expr_stmt|;
name|sb
operator|.
name|sctps_badsid
operator|+=
name|sarry
operator|->
name|sctps_badsid
expr_stmt|;
name|sb
operator|.
name|sctps_nomem
operator|+=
name|sarry
operator|->
name|sctps_nomem
expr_stmt|;
name|sb
operator|.
name|sctps_fastretransinrtt
operator|+=
name|sarry
operator|->
name|sctps_fastretransinrtt
expr_stmt|;
name|sb
operator|.
name|sctps_markedretrans
operator|+=
name|sarry
operator|->
name|sctps_markedretrans
expr_stmt|;
name|sb
operator|.
name|sctps_naglesent
operator|+=
name|sarry
operator|->
name|sctps_naglesent
expr_stmt|;
name|sb
operator|.
name|sctps_naglequeued
operator|+=
name|sarry
operator|->
name|sctps_naglequeued
expr_stmt|;
name|sb
operator|.
name|sctps_maxburstqueued
operator|+=
name|sarry
operator|->
name|sctps_maxburstqueued
expr_stmt|;
name|sb
operator|.
name|sctps_ifnomemqueued
operator|+=
name|sarry
operator|->
name|sctps_ifnomemqueued
expr_stmt|;
name|sb
operator|.
name|sctps_windowprobed
operator|+=
name|sarry
operator|->
name|sctps_windowprobed
expr_stmt|;
name|sb
operator|.
name|sctps_lowlevelerr
operator|+=
name|sarry
operator|->
name|sctps_lowlevelerr
expr_stmt|;
name|sb
operator|.
name|sctps_lowlevelerrusr
operator|+=
name|sarry
operator|->
name|sctps_lowlevelerrusr
expr_stmt|;
name|sb
operator|.
name|sctps_datadropchklmt
operator|+=
name|sarry
operator|->
name|sctps_datadropchklmt
expr_stmt|;
name|sb
operator|.
name|sctps_datadroprwnd
operator|+=
name|sarry
operator|->
name|sctps_datadroprwnd
expr_stmt|;
name|sb
operator|.
name|sctps_ecnereducedcwnd
operator|+=
name|sarry
operator|->
name|sctps_ecnereducedcwnd
expr_stmt|;
name|sb
operator|.
name|sctps_vtagexpress
operator|+=
name|sarry
operator|->
name|sctps_vtagexpress
expr_stmt|;
name|sb
operator|.
name|sctps_vtagbogus
operator|+=
name|sarry
operator|->
name|sctps_vtagbogus
expr_stmt|;
name|sb
operator|.
name|sctps_primary_randry
operator|+=
name|sarry
operator|->
name|sctps_primary_randry
expr_stmt|;
name|sb
operator|.
name|sctps_cmt_randry
operator|+=
name|sarry
operator|->
name|sctps_cmt_randry
expr_stmt|;
name|sb
operator|.
name|sctps_slowpath_sack
operator|+=
name|sarry
operator|->
name|sctps_slowpath_sack
expr_stmt|;
name|sb
operator|.
name|sctps_wu_sacks_sent
operator|+=
name|sarry
operator|->
name|sctps_wu_sacks_sent
expr_stmt|;
name|sb
operator|.
name|sctps_sends_with_flags
operator|+=
name|sarry
operator|->
name|sctps_sends_with_flags
expr_stmt|;
name|sb
operator|.
name|sctps_sends_with_unord
operator|+=
name|sarry
operator|->
name|sctps_sends_with_unord
expr_stmt|;
name|sb
operator|.
name|sctps_sends_with_eof
operator|+=
name|sarry
operator|->
name|sctps_sends_with_eof
expr_stmt|;
name|sb
operator|.
name|sctps_sends_with_abort
operator|+=
name|sarry
operator|->
name|sctps_sends_with_abort
expr_stmt|;
name|sb
operator|.
name|sctps_protocol_drain_calls
operator|+=
name|sarry
operator|->
name|sctps_protocol_drain_calls
expr_stmt|;
name|sb
operator|.
name|sctps_protocol_drains_done
operator|+=
name|sarry
operator|->
name|sctps_protocol_drains_done
expr_stmt|;
name|sb
operator|.
name|sctps_read_peeks
operator|+=
name|sarry
operator|->
name|sctps_read_peeks
expr_stmt|;
name|sb
operator|.
name|sctps_cached_chk
operator|+=
name|sarry
operator|->
name|sctps_cached_chk
expr_stmt|;
name|sb
operator|.
name|sctps_cached_strmoq
operator|+=
name|sarry
operator|->
name|sctps_cached_strmoq
expr_stmt|;
name|sb
operator|.
name|sctps_left_abandon
operator|+=
name|sarry
operator|->
name|sctps_left_abandon
expr_stmt|;
name|sb
operator|.
name|sctps_send_burst_avoid
operator|+=
name|sarry
operator|->
name|sctps_send_burst_avoid
expr_stmt|;
name|sb
operator|.
name|sctps_send_cwnd_avoid
operator|+=
name|sarry
operator|->
name|sctps_send_cwnd_avoid
expr_stmt|;
name|sb
operator|.
name|sctps_fwdtsn_map_over
operator|+=
name|sarry
operator|->
name|sctps_fwdtsn_map_over
expr_stmt|;
if|if
condition|(
name|cpin
condition|)
block|{
name|memcpy
argument_list|(
name|sarry
argument_list|,
name|cpin
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|sctpstat
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
name|error
operator|=
name|SYSCTL_OUT
argument_list|(
name|req
argument_list|,
operator|&
name|sb
argument_list|,
sizeof|sizeof
argument_list|(
name|sb
argument_list|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|error
operator|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
name|defined
argument_list|(
name|SCTP_LOCAL_TRACE_BUF
argument_list|)
end_if

begin_function
specifier|static
name|int
name|sysctl_sctp_cleartrace
parameter_list|(
name|SYSCTL_HANDLER_ARGS
parameter_list|)
block|{
name|int
name|error
init|=
literal|0
decl_stmt|;
name|memset
argument_list|(
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_log
argument_list|)
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|sctp_log
argument_list|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|error
operator|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/*  * sysctl definitions  */
end_comment

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|sendspace
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_sendspace
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MAXDGRAM_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|recvspace
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_recvspace
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_RECVSPACE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|auto_asconf
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auto_asconf
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_AUTOASCONF_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|ecn_enable
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_ecn_enable
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_ECN_ENABLE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|pr_enable
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pr_enable
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_PR_ENABLE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|auth_disable
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_auth_disable
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_auth_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_AUTH_DISABLE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|asconf_enable
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asconf_enable
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_asconf_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_ASCONF_ENABLE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|reconfig_enable
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_reconfig_enable
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_RECONFIG_ENABLE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|nrsack_enable
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nrsack_enable
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_NRSACK_ENABLE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|pktdrop_enable
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pktdrop_enable
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_PKTDROP_ENABLE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|strict_sacks
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_strict_sacks
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_STRICT_SACKS_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|peer_chkoh
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_peer_chunk_oh
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_PEER_CHKOH_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|maxburst
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_burst_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MAXBURST_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|fr_maxburst
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_fr_max_burst_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_FRMAXBURST_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|maxchunks
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_chunks_on_queue
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MAXCHUNKS_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|tcbhashsize
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_hashtblsize
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_TCBHASHSIZE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|pcbhashsize
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pcbtblsize
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_PCBHASHSIZE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|min_split_point
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_min_split_point
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MIN_SPLIT_POINT_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|chunkscale
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_chunkscale
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_CHUNKSCALE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|delayed_sack_time
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_delayed_sack_time_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_DELAYED_SACK_TIME_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|sack_freq
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_sack_freq_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_SACK_FREQ_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|sys_resource
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_system_free_resc_limit
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_SYS_RESOURCE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|asoc_resource
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_asoc_free_resc_limit
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_ASOC_RESOURCE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|heartbeat_interval
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_heartbeat_interval_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_HEARTBEAT_INTERVAL_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|pmtu_raise_time
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_pmtu_raise_time_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_PMTU_RAISE_TIME_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|shutdown_guard_time
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_shutdown_guard_time_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_SHUTDOWN_GUARD_TIME_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|secret_lifetime
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_secret_lifetime_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_SECRET_LIFETIME_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|rto_max
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_max_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_RTO_MAX_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|rto_min
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_min_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_RTO_MIN_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|rto_initial
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rto_initial_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_RTO_INITIAL_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|init_rto_max
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_init_rto_max_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_INIT_RTO_MAX_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|valid_cookie_life
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_valid_cookie_life_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_VALID_COOKIE_LIFE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|init_rtx_max
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_init_rtx_max_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_INIT_RTX_MAX_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|assoc_rtx_max
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_assoc_rtx_max_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_ASSOC_RTX_MAX_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|path_rtx_max
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_path_rtx_max_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_PATH_RTX_MAX_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|path_pf_threshold
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_path_pf_threshold
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_PATH_PF_THRESHOLD_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|add_more_on_output
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_add_more_threshold
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_ADD_MORE_ON_OUTPUT_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|incoming_streams
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nr_incoming_streams_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_INCOMING_STREAMS_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|outgoing_streams
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nr_outgoing_streams_default
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_OUTGOING_STREAMS_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|cmt_on_off
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_cmt_on_off
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_CMT_ON_OFF_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|cmt_use_dac
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_cmt_use_dac
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_CMT_USE_DAC_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|cwnd_maxburst
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_use_cwnd_based_maxburst
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_CWND_MAXBURST_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|nat_friendly
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_nat_friendly
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_NAT_FRIENDLY_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|abc_l_var
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_L2_abc_variable
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_ABC_L_VAR_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|max_chained_mbufs
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mbuf_threshold_count
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MAX_CHAINED_MBUFS_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|do_sctp_drain
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_do_drain
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_DO_SCTP_DRAIN_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|hb_max_burst
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_hb_maxburst
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_HB_MAX_BURST_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|abort_at_limit
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_abort_if_one_2_one_hits_limit
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_ABORT_AT_LIMIT_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|strict_data_order
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_strict_data_order
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_STRICT_DATA_ORDER_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|min_residual
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_min_residual
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MIN_RESIDUAL_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|max_retran_chunk
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_max_retran_chunk
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MAX_RETRAN_CHUNK_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|log_level
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_logging_level
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_LOGGING_LEVEL_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|default_cc_module
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_default_cc_module
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_DEFAULT_CC_MODULE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|default_ss_module
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_default_ss_module
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_DEFAULT_SS_MODULE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|default_frag_interleave
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_default_frag_interleave
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_DEFAULT_FRAG_INTERLEAVE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|mobility_base
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mobility_base
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MOBILITY_BASE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|mobility_fasthandoff
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_mobility_fasthandoff
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_MOBILITY_FASTHANDOFF_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_if
if|#
directive|if
name|defined
argument_list|(
name|SCTP_LOCAL_TRACE_BUF
argument_list|)
end_if

begin_expr_stmt
name|SYSCTL_VNET_STRUCT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|log
argument_list|,
name|CTLFLAG_RD
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_log
argument_list|)
argument_list|,
name|sctp_log
argument_list|,
literal|"SCTP logging (struct sctp_log)"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|clear_trace
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_log
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_cleartrace
argument_list|,
literal|"IU"
argument_list|,
literal|"Clear SCTP Logging buffer"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|udp_tunneling_port
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_udp_tunneling_port
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_udp_tunneling_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_UDP_TUNNELING_PORT_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|enable_sack_immediately
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_enable_sack_immediately
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_SACK_IMMEDIATELY_ENABLE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|nat_friendly_init
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_inits_include_nat_friendly
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_NAT_FRIENDLY_INITS_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|vtag_time_wait
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_vtag_time_wait
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_TIME_WAIT_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|buffer_splitting
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_buffer_splitting
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_BUFFER_SPLITTING_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|initial_cwnd
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_initial_cwnd
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_INITIAL_CWND_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|rttvar_bw
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rttvar_bw
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_RTTVAR_BW_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|rttvar_rtt
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rttvar_rtt
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_RTTVAR_RTT_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|rttvar_eqret
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_rttvar_eqret
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_RTTVAR_EQRET_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|rttvar_steady_step
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_steady_step
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_RTTVAR_STEADYS_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|use_dcccecn
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_use_dccc_ecn
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_RTTVAR_DCCCECN_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|blackhole
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_blackhole
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_BLACKHOLE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|diag_info_code
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_diag_info_code
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_DIAG_INFO_CODE_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|SCTP_DEBUG
end_ifdef

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|debug
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_debug_on
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_DEBUG_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__APPLE__
argument_list|)
operator|||
name|defined
argument_list|(
name|SCTP_SO_LOCK_TESTING
argument_list|)
end_if

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|output_unlocked
argument_list|,
name|CTLTYPE_UINT
operator||
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_SYSCTL
argument_list|(
name|sctp_output_unlocked
argument_list|)
argument_list|,
literal|0
argument_list|,
name|sysctl_sctp_check
argument_list|,
literal|"IU"
argument_list|,
name|SCTPCTL_OUTPUT_UNLOCKED_DESC
argument_list|)
expr_stmt|;
end_expr_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__FreeBSD__
argument_list|)
operator|&&
name|defined
argument_list|(
name|SMP
argument_list|)
operator|&&
name|defined
argument_list|(
name|SCTP_USE_PERCPU_STAT
argument_list|)
end_if

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|stats
argument_list|,
name|CTLTYPE_STRUCT
operator||
name|CTLFLAG_RW
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|sysctl_stat_get
argument_list|,
literal|"S,sctpstat"
argument_list|,
literal|"SCTP statistics (struct sctp_stat)"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_else
else|#
directive|else
end_else

begin_expr_stmt
name|SYSCTL_VNET_STRUCT
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|stats
argument_list|,
name|CTLFLAG_RW
argument_list|,
operator|&
name|SCTP_BASE_STATS_SYSCTL
argument_list|,
name|sctpstat
argument_list|,
literal|"SCTP statistics (struct sctp_stat)"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_expr_stmt
name|SYSCTL_VNET_PROC
argument_list|(
name|_net_inet_sctp
argument_list|,
name|OID_AUTO
argument_list|,
name|assoclist
argument_list|,
name|CTLTYPE_OPAQUE
operator||
name|CTLFLAG_RD
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|sctp_assoclist
argument_list|,
literal|"S,xassoc"
argument_list|,
literal|"List of active SCTP associations"
argument_list|)
expr_stmt|;
end_expr_stmt

end_unit

