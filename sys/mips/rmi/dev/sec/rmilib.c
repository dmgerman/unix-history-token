begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2003-2009 RMI Corporation  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  * 3. Neither the name of RMI Corporation, nor the names of its contributors,  *    may be used to endorse or promote products derived from this software  *    without specific prior written permission.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  *  * RMI_BSD */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|<sys/systm.h>
end_include

begin_include
include|#
directive|include
file|<sys/kernel.h>
end_include

begin_include
include|#
directive|include
file|<sys/module.h>
end_include

begin_include
include|#
directive|include
file|<sys/malloc.h>
end_include

begin_include
include|#
directive|include
file|<sys/bus.h>
end_include

begin_include
include|#
directive|include
file|<machine/bus.h>
end_include

begin_include
include|#
directive|include
file|<machine/md_var.h>
end_include

begin_include
include|#
directive|include
file|<machine/mips-exts.h>
end_include

begin_include
include|#
directive|include
file|<machine/cpuregs.h>
end_include

begin_include
include|#
directive|include
file|<vm/vm.h>
end_include

begin_include
include|#
directive|include
file|<vm/pmap.h>
end_include

begin_include
include|#
directive|include
file|<opencrypto/cryptodev.h>
end_include

begin_include
include|#
directive|include
file|<mips/xlr/iomap.h>
end_include

begin_include
include|#
directive|include
file|<mips/xlr/pic.h>
end_include

begin_include
include|#
directive|include
file|<mips/xlr/shared_structs.h>
end_include

begin_include
include|#
directive|include
file|<mips/xlr/iomap.h>
end_include

begin_include
include|#
directive|include
file|<mips/xlr/msgring.h>
end_include

begin_include
include|#
directive|include
file|<mips/xlr/board.h>
end_include

begin_include
include|#
directive|include
file|<dev/rmi/sec/rmilib.h>
end_include

begin_include
include|#
directive|include
file|<dev/rmi/sec/desc.h>
end_include

begin_comment
comment|// static int msgrng_stnid_pk0 = MSGRNG_STNID_PK0;
end_comment

begin_comment
comment|/*#define RMI_SEC_DEBUG */
end_comment

begin_define
define|#
directive|define
name|SMP_CACHE_BYTES
value|XLR_CACHELINE_SIZE
end_define

begin_define
define|#
directive|define
name|NUM_CHUNKS
parameter_list|(
name|size
parameter_list|,
name|bits
parameter_list|)
value|( ((size)>>(bits)) + (((size)&((1<<(bits))-1))?1:0) )
end_define

begin_decl_stmt
specifier|static
specifier|const
name|char
name|nib2hex
index|[]
init|=
literal|"0123456789ABCDEF"
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|symkey_desc_pt
name|g_desc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|xlr_sec_command
modifier|*
name|g_cmd
decl_stmt|;
end_decl_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|XLR_SEC_CMD_DEBUG
end_ifdef

begin_function_decl
specifier|static
name|void
name|decode_symkey_desc
parameter_list|(
name|symkey_desc_pt
name|desc
parameter_list|,
name|uint32_t
name|cfg_vector
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_function_decl
name|void
name|print_buf
parameter_list|(
name|char
modifier|*
name|desc
parameter_list|,
name|void
modifier|*
name|data
parameter_list|,
name|int
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|xlr_sec_cipher_hash_command
parameter_list|(
name|xlr_sec_io_pt
name|op
parameter_list|,
name|symkey_desc_pt
name|desc
parameter_list|,
name|uint8_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|xlr_sec_error_t
name|xlr_sec_setup_descriptor
parameter_list|(
name|xlr_sec_io_pt
name|op
parameter_list|,
name|unsigned
name|int
name|flags
parameter_list|,
name|symkey_desc_pt
name|desc
parameter_list|,
name|uint32_t
modifier|*
name|cfg_vector
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|xlr_sec_error_t
name|xlr_sec_setup_packet
parameter_list|(
name|xlr_sec_io_pt
name|op
parameter_list|,
name|symkey_desc_pt
name|desc
parameter_list|,
name|unsigned
name|int
name|flags
parameter_list|,
name|uint64_t
modifier|*
name|data
parameter_list|,
name|PacketDescriptor_pt
name|pkt_desc
parameter_list|,
name|ControlDescriptor_pt
name|ctl_desc
parameter_list|,
name|uint32_t
name|vector
parameter_list|,
name|PacketDescriptor_pt
name|next_pkt_desc
parameter_list|,
name|uint8_t
name|multi_frag_flag
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|xlr_sec_submit_message
parameter_list|(
name|symkey_desc_pt
name|desc
parameter_list|,
name|uint32_t
name|cfg_vector
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|xlr_sec_error_t
name|xlr_sec_setup_cipher
parameter_list|(
name|xlr_sec_io_pt
name|op
parameter_list|,
name|ControlDescriptor_pt
name|ctl_desc
parameter_list|,
name|uint32_t
modifier|*
name|vector
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|xlr_sec_error_t
name|xlr_sec_setup_digest
parameter_list|(
name|xlr_sec_io_pt
name|op
parameter_list|,
name|ControlDescriptor_pt
name|ctl_desc
parameter_list|,
name|uint32_t
modifier|*
name|vector
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|xlr_sec_error_t
name|xlr_sec_setup_cksum
parameter_list|(
name|xlr_sec_io_pt
name|op
parameter_list|,
name|ControlDescriptor_pt
name|ctl_desc
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|xlr_sec_error_t
name|xlr_sec_control_setup
parameter_list|(
name|xlr_sec_io_pt
name|op
parameter_list|,
name|unsigned
name|int
name|flags
parameter_list|,
name|uint64_t
modifier|*
name|control
parameter_list|,
name|ControlDescriptor_pt
name|ctl_desc
parameter_list|,
name|xlr_sec_drv_user_t
modifier|*
name|user
parameter_list|,
name|uint32_t
name|vector
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|xlr_sec_error_t
name|xlr_sec_submit_op
parameter_list|(
name|symkey_desc_pt
name|desc
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|xlr_sec_free_desc
parameter_list|(
name|symkey_desc_pt
name|desc
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|xlr_sec_msgring_handler
parameter_list|(
name|int
name|bucket
parameter_list|,
name|int
name|size
parameter_list|,
name|int
name|code
parameter_list|,
name|int
name|stid
parameter_list|,
name|struct
name|msgrng_msg
modifier|*
name|msg
parameter_list|,
name|void
modifier|*
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|void
name|xlr_sec_init
parameter_list|(
name|struct
name|xlr_sec_softc
modifier|*
name|sc
parameter_list|)
block|{
name|unsigned
name|int
name|i
decl_stmt|;
name|xlr_reg_t
modifier|*
name|mmio
decl_stmt|;
name|mmio
operator|=
name|sc
operator|->
name|mmio
operator|=
name|xlr_io_mmio
argument_list|(
name|XLR_IO_SECURITY_OFFSET
argument_list|)
expr_stmt|;
name|xlr_write_reg
argument_list|(
name|mmio
argument_list|,
name|SEC_DMA_CREDIT
argument_list|,
name|SEC_DMA_CREDIT_CONFIG
argument_list|)
expr_stmt|;
name|xlr_write_reg
argument_list|(
name|mmio
argument_list|,
name|SEC_CONFIG2
argument_list|,
name|SEC_CFG2_ROUND_ROBIN_ON
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|8
condition|;
name|i
operator|++
control|)
name|xlr_write_reg
argument_list|(
name|mmio
argument_list|,
name|SEC_MSG_BUCKET0_SIZE
operator|+
name|i
argument_list|,
name|xlr_is_xls
argument_list|()
condition|?
name|xls_bucket_sizes
operator|.
name|bucket
index|[
name|MSGRNG_STNID_SEC
operator|+
name|i
index|]
else|:
name|bucket_sizes
operator|.
name|bucket
index|[
name|MSGRNG_STNID_SEC
operator|+
name|i
index|]
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|128
condition|;
name|i
operator|++
control|)
name|xlr_write_reg
argument_list|(
name|mmio
argument_list|,
name|SEC_CC_CPU0_0
operator|+
name|i
argument_list|,
name|xlr_is_xls
argument_list|()
condition|?
name|xls_cc_table_sec
operator|.
name|counters
index|[
name|i
operator|>>
literal|3
index|]
index|[
name|i
operator|&
literal|0x07
index|]
else|:
name|cc_table_sec
operator|.
name|counters
index|[
name|i
operator|>>
literal|3
index|]
index|[
name|i
operator|&
literal|0x07
index|]
argument_list|)
expr_stmt|;
comment|/* 	 * Register a bucket handler with the phoenix messaging subsystem 	 * For now, register handler for bucket 0->5 in msg stn 0 	 */
if|if
condition|(
name|register_msgring_handler
argument_list|(
name|TX_STN_SAE
argument_list|,
name|xlr_sec_msgring_handler
argument_list|,
name|NULL
argument_list|)
condition|)
block|{
name|panic
argument_list|(
literal|"Couldn't register msgring handler 0\n"
argument_list|)
expr_stmt|;
block|}
return|return;
block|}
end_function

begin_function
name|int
name|xlr_sec_setup
parameter_list|(
name|struct
name|xlr_sec_session
modifier|*
name|ses
parameter_list|,
name|struct
name|xlr_sec_command
modifier|*
name|cmd
parameter_list|,
name|symkey_desc_pt
name|desc
parameter_list|)
block|{
name|xlr_sec_io_pt
name|op
decl_stmt|;
name|int
name|size
decl_stmt|,
name|ret_val
decl_stmt|;
name|int
name|iv_len
decl_stmt|;
name|desc
operator|->
name|ses
operator|=
name|ses
expr_stmt|;
name|op
operator|=
operator|&
name|cmd
operator|->
name|op
expr_stmt|;
if|if
condition|(
name|op
operator|==
name|NULL
condition|)
return|return
operator|(
operator|-
name|ENOMEM
operator|)
return|;
name|desc
operator|->
name|ctl_desc
operator|.
name|instruction
operator|=
literal|0
expr_stmt|;
name|memset
argument_list|(
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|CipherHashInfo_t
argument_list|)
argument_list|)
expr_stmt|;
name|desc
operator|->
name|control
operator|=
literal|0
expr_stmt|;
name|desc
operator|->
name|pkt_desc
index|[
literal|0
index|]
operator|.
name|srcLengthIVOffUseIVNext
operator|=
literal|0
expr_stmt|;
name|desc
operator|->
name|pkt_desc
index|[
literal|0
index|]
operator|.
name|dstDataSettings
operator|=
literal|0
expr_stmt|;
name|desc
operator|->
name|pkt_desc
index|[
literal|0
index|]
operator|.
name|authDstNonceLow
operator|=
literal|0
expr_stmt|;
name|desc
operator|->
name|pkt_desc
index|[
literal|0
index|]
operator|.
name|ckSumDstNonceHiCFBMaskLLWMask
operator|=
literal|0
expr_stmt|;
name|desc
operator|->
name|pkt_desc
index|[
literal|1
index|]
operator|.
name|srcLengthIVOffUseIVNext
operator|=
literal|0
expr_stmt|;
name|desc
operator|->
name|pkt_desc
index|[
literal|1
index|]
operator|.
name|dstDataSettings
operator|=
literal|0
expr_stmt|;
name|desc
operator|->
name|pkt_desc
index|[
literal|1
index|]
operator|.
name|authDstNonceLow
operator|=
literal|0
expr_stmt|;
name|desc
operator|->
name|pkt_desc
index|[
literal|1
index|]
operator|.
name|ckSumDstNonceHiCFBMaskLLWMask
operator|=
literal|0
expr_stmt|;
name|desc
operator|->
name|data
operator|=
literal|0
expr_stmt|;
name|desc
operator|->
name|ctl_result
operator|=
literal|0
expr_stmt|;
name|desc
operator|->
name|data_result
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|op
operator|->
name|flags
operator|&
name|XLR_SEC_FLAGS_HIGH_PRIORITY
condition|)
if|if
condition|(
operator|!
name|xlr_is_xls
argument_list|()
condition|)
name|desc
operator|->
name|op_ctl
operator|.
name|stn_id
operator|++
expr_stmt|;
name|desc
operator|->
name|user
operator|.
name|user_src
operator|=
operator|(
name|uint8_t
operator|*
operator|)
operator|(
name|unsigned
name|long
operator|)
name|op
operator|->
name|source_buf
expr_stmt|;
name|desc
operator|->
name|user
operator|.
name|user_dest
operator|=
operator|(
name|uint8_t
operator|*
operator|)
operator|(
name|unsigned
name|long
operator|)
name|op
operator|->
name|dest_buf
expr_stmt|;
name|desc
operator|->
name|user
operator|.
name|user_auth
operator|=
operator|(
name|uint8_t
operator|*
operator|)
operator|(
name|unsigned
name|long
operator|)
name|op
operator|->
name|auth_dest
expr_stmt|;
if|if
condition|(
operator|(
name|op
operator|->
name|cipher_type
operator|==
name|XLR_SEC_CIPHER_TYPE_ARC4
operator|)
operator|&&
operator|(
operator|!
name|op
operator|->
name|rc4_state
operator|&&
operator|(
name|op
operator|->
name|rc4_loadstate
operator|||
name|op
operator|->
name|rc4_savestate
operator|)
operator|)
condition|)
block|{
name|printf
argument_list|(
literal|" ** Load/Save State and no State **"
argument_list|)
expr_stmt|;
name|xlr_sec_free_desc
argument_list|(
name|desc
argument_list|)
expr_stmt|;
return|return
operator|(
operator|-
name|EINVAL
operator|)
return|;
block|}
name|desc
operator|->
name|user
operator|.
name|user_state
operator|=
operator|(
name|uint8_t
operator|*
operator|)
operator|(
name|unsigned
name|long
operator|)
name|op
operator|->
name|rc4_state
expr_stmt|;
switch|switch
condition|(
name|op
operator|->
name|cipher_type
condition|)
block|{
case|case
name|XLR_SEC_CIPHER_TYPE_NONE
case|:
name|iv_len
operator|=
literal|0
expr_stmt|;
break|break;
case|case
name|XLR_SEC_CIPHER_TYPE_DES
case|:
case|case
name|XLR_SEC_CIPHER_TYPE_3DES
case|:
name|iv_len
operator|=
name|XLR_SEC_DES_IV_LENGTH
expr_stmt|;
break|break;
case|case
name|XLR_SEC_CIPHER_TYPE_AES128
case|:
case|case
name|XLR_SEC_CIPHER_TYPE_AES192
case|:
case|case
name|XLR_SEC_CIPHER_TYPE_AES256
case|:
name|iv_len
operator|=
name|XLR_SEC_AES_IV_LENGTH
expr_stmt|;
break|break;
case|case
name|XLR_SEC_CIPHER_TYPE_ARC4
case|:
name|iv_len
operator|=
name|XLR_SEC_ARC4_IV_LENGTH
expr_stmt|;
break|break;
case|case
name|XLR_SEC_CIPHER_TYPE_KASUMI_F8
case|:
name|iv_len
operator|=
name|XLR_SEC_KASUMI_F8_IV_LENGTH
expr_stmt|;
break|break;
default|default:
name|printf
argument_list|(
literal|" ** Undefined Cipher Type **"
argument_list|)
expr_stmt|;
name|xlr_sec_free_desc
argument_list|(
name|desc
argument_list|)
expr_stmt|;
return|return
operator|(
operator|-
name|EINVAL
operator|)
return|;
block|}
name|size
operator|=
name|op
operator|->
name|source_buf_size
operator|+
name|iv_len
expr_stmt|;
comment|/* 	 * make sure that there are enough bytes for aes based stream 	 * ciphers 	 */
if|if
condition|(
name|op
operator|->
name|cipher_mode
operator|==
name|XLR_SEC_CIPHER_MODE_F8
operator|||
name|op
operator|->
name|cipher_mode
operator|==
name|XLR_SEC_CIPHER_MODE_CTR
condition|)
name|size
operator|+=
name|XLR_SEC_AES_BLOCK_SIZE
operator|-
literal|1
expr_stmt|;
if|if
condition|(
name|op
operator|->
name|cipher_type
operator|==
name|XLR_SEC_CIPHER_TYPE_NONE
condition|)
block|{
if|if
condition|(
name|op
operator|->
name|source_buf_size
operator|!=
literal|0
condition|)
block|{
name|memcpy
argument_list|(
name|desc
operator|->
name|user
operator|.
name|aligned_src
argument_list|,
operator|(
name|uint8_t
operator|*
operator|)
operator|(
name|unsigned
name|long
operator|)
name|op
operator|->
name|source_buf
argument_list|,
name|op
operator|->
name|source_buf_size
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
if|if
condition|(
name|ses
operator|->
name|multi_frag_flag
condition|)
block|{
comment|/* copy IV into temporary kernel source buffer */
name|memcpy
argument_list|(
name|desc
operator|->
name|user
operator|.
name|aligned_src
argument_list|,
operator|&
name|op
operator|->
name|initial_vector
index|[
literal|0
index|]
argument_list|,
name|iv_len
argument_list|)
expr_stmt|;
comment|/* copy input data to temporary kernel source buffer */
name|memcpy
argument_list|(
operator|(
name|uint8_t
operator|*
operator|)
operator|(
name|desc
operator|->
name|user
operator|.
name|aligned_src
operator|+
name|iv_len
operator|)
argument_list|,
operator|(
name|uint8_t
operator|*
operator|)
operator|(
name|unsigned
name|long
operator|)
name|op
operator|->
name|source_buf
argument_list|,
name|SEC_MAX_FRAG_LEN
argument_list|)
expr_stmt|;
name|desc
operator|->
name|next_src_len
operator|=
name|op
operator|->
name|source_buf_size
operator|-
name|SEC_MAX_FRAG_LEN
expr_stmt|;
name|memcpy
argument_list|(
operator|(
name|uint8_t
operator|*
operator|)
operator|(
name|desc
operator|->
name|next_src_buf
operator|)
argument_list|,
operator|(
name|uint8_t
operator|*
operator|)
call|(
name|unsigned
name|long
call|)
argument_list|(
name|op
operator|->
name|source_buf
operator|+
name|SEC_MAX_FRAG_LEN
argument_list|)
argument_list|,
name|desc
operator|->
name|next_src_len
argument_list|)
expr_stmt|;
name|op
operator|->
name|source_buf_size
operator|=
name|SEC_MAX_FRAG_LEN
expr_stmt|;
name|op
operator|->
name|source_buf_size
operator|+=
name|iv_len
expr_stmt|;
block|}
else|else
block|{
comment|/* copy IV into temporary kernel source buffer */
name|memcpy
argument_list|(
name|desc
operator|->
name|user
operator|.
name|aligned_src
argument_list|,
operator|&
name|op
operator|->
name|initial_vector
index|[
literal|0
index|]
argument_list|,
name|iv_len
argument_list|)
expr_stmt|;
comment|/* copy input data to temporary kernel source buffer */
name|memcpy
argument_list|(
operator|(
name|uint8_t
operator|*
operator|)
operator|(
name|desc
operator|->
name|user
operator|.
name|aligned_src
operator|+
name|iv_len
operator|)
argument_list|,
operator|(
name|uint8_t
operator|*
operator|)
operator|(
name|unsigned
name|long
operator|)
name|op
operator|->
name|source_buf
argument_list|,
name|op
operator|->
name|source_buf_size
argument_list|)
expr_stmt|;
name|op
operator|->
name|source_buf_size
operator|+=
name|iv_len
expr_stmt|;
block|}
block|}
comment|/* Set source to new kernel space */
name|op
operator|->
name|source_buf
operator|=
operator|(
name|uint64_t
operator|)
operator|(
name|unsigned
name|long
operator|)
name|desc
operator|->
name|user
operator|.
name|aligned_src
expr_stmt|;
comment|/* 	 * Build new dest buffer, for Cipher output only 	 */
if|if
condition|(
name|op
operator|->
name|cipher_type
operator|==
name|XLR_SEC_CIPHER_TYPE_NONE
condition|)
block|{
comment|/* 		 * Digest Engine *NEEDS* this, otherwise it will write at 		 * 0[x] 		 */
name|op
operator|->
name|dest_buf
operator|=
operator|(
name|uint64_t
operator|)
operator|(
name|unsigned
name|long
operator|)
name|desc
operator|->
name|user
operator|.
name|aligned_src
expr_stmt|;
block|}
else|else
block|{
comment|/* DEBUG -dpk */
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"dest_buf_size = %d \n"
argument_list|,
name|op
operator|->
name|dest_buf_size
argument_list|)
expr_stmt|;
name|size
operator|=
name|op
operator|->
name|dest_buf_size
operator|+
name|iv_len
expr_stmt|;
comment|/* 		 * make sure that there are enough bytes for aes based 		 * stream ciphers 		 */
if|if
condition|(
name|op
operator|->
name|cipher_mode
operator|==
name|XLR_SEC_CIPHER_MODE_F8
operator|||
name|op
operator|->
name|cipher_mode
operator|==
name|XLR_SEC_CIPHER_MODE_CTR
condition|)
name|size
operator|+=
name|XLR_SEC_AES_BLOCK_SIZE
operator|-
literal|1
expr_stmt|;
name|op
operator|->
name|dest_buf
operator|=
operator|(
name|uint64_t
operator|)
operator|(
name|unsigned
name|long
operator|)
name|desc
operator|->
name|user
operator|.
name|aligned_dest
expr_stmt|;
block|}
name|ret_val
operator|=
name|xlr_sec_cipher_hash_command
argument_list|(
name|op
argument_list|,
name|desc
argument_list|,
name|ses
operator|->
name|multi_frag_flag
argument_list|)
expr_stmt|;
return|return
operator|(
name|ret_val
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|xlr_sec_cipher_hash_command
parameter_list|(
name|xlr_sec_io_pt
name|op
parameter_list|,
name|symkey_desc_pt
name|desc
parameter_list|,
name|uint8_t
name|multi_frag_flag
parameter_list|)
block|{
name|xlr_sec_error_t
name|err
decl_stmt|;
name|uint32_t
name|cfg_vector
decl_stmt|;
name|unsigned
name|int
name|setup_flags
init|=
literal|0
decl_stmt|;
name|err
operator|=
name|XLR_SEC_ERR_NONE
expr_stmt|;
name|cfg_vector
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|(
name|op
operator|->
name|digest_type
operator|==
name|XLR_SEC_DIGEST_TYPE_NONE
operator|)
operator|&&
operator|(
name|op
operator|->
name|cipher_type
operator|!=
name|XLR_SEC_CIPHER_TYPE_ARC4
operator|)
operator|&&
operator|(
name|op
operator|->
name|cipher_mode
operator|!=
name|XLR_SEC_CIPHER_MODE_F8
operator|)
operator|&&
operator|(
name|op
operator|->
name|cipher_type
operator|!=
name|XLR_SEC_CIPHER_TYPE_KASUMI_F8
operator|)
operator|&&
operator|(
name|op
operator|->
name|source_buf_size
operator|&
literal|0x7
operator|)
condition|)
block|{
name|printf
argument_list|(
literal|"Invalid Cipher Block Size, data len=%d\n"
argument_list|,
name|op
operator|->
name|source_buf_size
argument_list|)
expr_stmt|;
return|return
operator|(
operator|-
name|EINVAL
operator|)
return|;
block|}
do|do
block|{
if|if
condition|(
operator|(
name|op
operator|->
name|cipher_type
operator|==
name|XLR_SEC_CIPHER_TYPE_3DES
operator|)
operator|&&
operator|(
name|op
operator|->
name|cipher_op
operator|==
name|XLR_SEC_CIPHER_OP_DECRYPT
operator|)
condition|)
name|setup_flags
operator|=
name|XLR_SEC_SETUP_OP_FLIP_3DES_KEY
expr_stmt|;
name|err
operator|=
name|xlr_sec_setup_descriptor
argument_list|(
name|op
argument_list|,
name|setup_flags
argument_list|,
name|desc
argument_list|,
operator|&
name|cfg_vector
argument_list|)
expr_stmt|;
if|if
condition|(
name|err
operator|!=
name|XLR_SEC_ERR_NONE
condition|)
break|break;
name|err
operator|=
name|xlr_sec_setup_packet
argument_list|(
name|op
argument_list|,
name|desc
argument_list|,
name|op
operator|->
name|digest_type
operator|!=
name|XLR_SEC_DIGEST_TYPE_NONE
condition|?
name|XLR_SEC_SETUP_OP_CIPHER_HMAC
else|:
literal|0
argument_list|,
operator|&
name|desc
operator|->
name|data
argument_list|,
operator|&
name|desc
operator|->
name|pkt_desc
index|[
literal|0
index|]
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
argument_list|,
name|cfg_vector
argument_list|,
operator|&
name|desc
operator|->
name|pkt_desc
index|[
literal|1
index|]
argument_list|,
name|multi_frag_flag
argument_list|)
expr_stmt|;
if|if
condition|(
name|err
operator|!=
name|XLR_SEC_ERR_NONE
condition|)
break|break;
block|}
do|while
condition|(
literal|0
condition|)
do|;
if|if
condition|(
name|err
operator|!=
name|XLR_SEC_ERR_NONE
condition|)
block|{
return|return
operator|(
name|EINVAL
operator|)
return|;
block|}
name|err
operator|=
name|xlr_sec_submit_message
argument_list|(
name|desc
argument_list|,
name|cfg_vector
argument_list|)
expr_stmt|;
return|return
name|err
return|;
block|}
end_function

begin_function
specifier|static
name|xlr_sec_error_t
name|xlr_sec_setup_descriptor
parameter_list|(
name|xlr_sec_io_pt
name|op
parameter_list|,
name|unsigned
name|int
name|flags
parameter_list|,
name|symkey_desc_pt
name|desc
parameter_list|,
name|uint32_t
modifier|*
name|cfg_vector
parameter_list|)
block|{
name|xlr_sec_error_t
name|err
decl_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_descriptor: ENTER\n"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|err
operator|=
name|xlr_sec_setup_cipher
argument_list|(
name|op
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
argument_list|,
name|cfg_vector
argument_list|)
operator|)
operator|!=
name|XLR_SEC_ERR_NONE
condition|)
block|{
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_descriptor: xlr_sec_setup_cipher done err %d\n"
argument_list|,
operator|(
name|int
operator|)
name|err
argument_list|)
expr_stmt|;
return|return
name|err
return|;
block|}
if|if
condition|(
name|op
operator|->
name|digest_type
operator|!=
name|XLR_SEC_DIGEST_TYPE_NONE
condition|)
block|{
if|if
condition|(
operator|(
name|err
operator|=
name|xlr_sec_setup_digest
argument_list|(
name|op
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
argument_list|,
name|cfg_vector
argument_list|)
operator|)
operator|!=
name|XLR_SEC_ERR_NONE
condition|)
block|{
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_descriptor: xlr_sec_setup_digest done err %d\n"
argument_list|,
operator|(
name|int
operator|)
name|err
argument_list|)
expr_stmt|;
return|return
name|err
return|;
block|}
block|}
if|if
condition|(
operator|(
name|err
operator|=
name|xlr_sec_setup_cksum
argument_list|(
name|op
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
argument_list|)
operator|)
operator|!=
name|XLR_SEC_ERR_NONE
condition|)
block|{
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_descriptor: xlr_sec_setup_cksum done err %d\n"
argument_list|,
operator|(
name|int
operator|)
name|err
argument_list|)
expr_stmt|;
return|return
name|err
return|;
block|}
if|if
condition|(
operator|(
name|err
operator|=
name|xlr_sec_control_setup
argument_list|(
name|op
argument_list|,
name|flags
argument_list|,
operator|&
name|desc
operator|->
name|control
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
argument_list|,
operator|&
name|desc
operator|->
name|user
argument_list|,
operator|*
name|cfg_vector
argument_list|)
operator|)
operator|!=
name|XLR_SEC_ERR_NONE
condition|)
block|{
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_descriptor: xlr_sec_control_setup done err %d\n"
argument_list|,
operator|(
name|int
operator|)
name|err
argument_list|)
expr_stmt|;
return|return
name|err
return|;
block|}
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_descriptor: DONE\n"
argument_list|)
expr_stmt|;
return|return
name|err
return|;
block|}
end_function

begin_function
specifier|static
name|xlr_sec_error_t
name|xlr_sec_setup_packet
parameter_list|(
name|xlr_sec_io_pt
name|op
parameter_list|,
name|symkey_desc_pt
name|desc
parameter_list|,
name|unsigned
name|int
name|flags
parameter_list|,
name|uint64_t
modifier|*
name|data
parameter_list|,
name|PacketDescriptor_pt
name|pkt_desc
parameter_list|,
name|ControlDescriptor_pt
name|ctl_desc
parameter_list|,
name|uint32_t
name|vector
parameter_list|,
name|PacketDescriptor_pt
name|next_pkt_desc
parameter_list|,
name|uint8_t
name|multi_frag_flag
parameter_list|)
block|{
name|uint32_t
name|len
decl_stmt|,
name|next_len
init|=
literal|0
decl_stmt|,
name|len_dwords
decl_stmt|,
name|last_u64_bytes
decl_stmt|;
name|uint64_t
name|addr
decl_stmt|;
name|uint64_t
name|seg_addr
decl_stmt|,
name|next_seg_addr
init|=
literal|0
decl_stmt|;
name|uint64_t
name|byte_offset
decl_stmt|,
name|global_offset
decl_stmt|;
name|uint32_t
name|cipher_offset_dwords
decl_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_packet: ENTER  vector = %04x\n"
argument_list|,
name|vector
argument_list|)
expr_stmt|;
comment|/* physical address of the source buffer */
name|addr
operator|=
operator|(
name|uint64_t
operator|)
name|vtophys
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|(
name|unsigned
name|long
operator|)
name|op
operator|->
name|source_buf
argument_list|)
expr_stmt|;
comment|/* cache-aligned base of the source buffer */
name|seg_addr
operator|=
operator|(
name|addr
operator|&
operator|~
operator|(
name|SMP_CACHE_BYTES
operator|-
literal|1
operator|)
operator|)
expr_stmt|;
comment|/* offset in bytes to the source buffer start from the segment base */
name|byte_offset
operator|=
name|addr
operator|-
name|seg_addr
expr_stmt|;
comment|/* global offset: 0-7 bytes */
name|global_offset
operator|=
name|byte_offset
operator|&
literal|0x7
expr_stmt|;
comment|/* 	 * op->source_buf_size is expected to be the Nb double words to 	 * stream in (Including Segment address->CP/IV/Auth/CkSum offsets) 	 */
comment|/* 	 * adjusted length of the whole thing, accounting for the added 	 * head, sans global_offset (per Paul S.) 	 */
name|len
operator|=
name|op
operator|->
name|source_buf_size
operator|+
name|byte_offset
operator|-
name|global_offset
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|next_seg_addr
operator|=
operator|(
name|uint64_t
operator|)
name|vtophys
argument_list|(
operator|(
name|void
operator|*
operator|)
call|(
name|unsigned
name|long
call|)
argument_list|(
name|desc
operator|->
name|next_src_buf
argument_list|)
argument_list|)
expr_stmt|;
name|next_seg_addr
operator|=
operator|(
name|next_seg_addr
operator|&
operator|~
operator|(
name|SMP_CACHE_BYTES
operator|-
literal|1
operator|)
operator|)
expr_stmt|;
name|next_len
operator|=
name|desc
operator|->
name|next_src_len
expr_stmt|;
block|}
comment|/* length of the whole thing in dwords */
name|len_dwords
operator|=
name|NUM_CHUNKS
argument_list|(
name|len
argument_list|,
literal|3
argument_list|)
expr_stmt|;
comment|/* number of bytes in the last chunk (len % 8) */
name|last_u64_bytes
operator|=
name|len
operator|&
literal|0x07
expr_stmt|;
if|if
condition|(
name|op
operator|->
name|cipher_offset
operator|&
literal|0x7
condition|)
block|{
name|printf
argument_list|(
literal|"** cipher_offset(%d) fails 64-bit word alignment **"
argument_list|,
name|op
operator|->
name|cipher_offset
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_CIPHER_MODE
return|;
comment|/* ! fix ! */
block|}
comment|/* 	 * global_offset is only three bits, so work the number of the whole 	 * 8-byte words into the global offset. both offset and 	 * cipher_offset are byte counts 	 */
name|cipher_offset_dwords
operator|=
operator|(
name|op
operator|->
name|iv_offset
operator|+
name|byte_offset
operator|)
operator|>>
literal|3
expr_stmt|;
if|if
condition|(
name|op
operator|->
name|cipher_mode
operator|==
name|XLR_SEC_CIPHER_MODE_F8
operator|||
name|op
operator|->
name|cipher_mode
operator|==
name|XLR_SEC_CIPHER_MODE_CTR
condition|)
block|{
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|int
name|nlhmac
init|=
operator|(
operator|(
name|op
operator|->
name|source_buf_size
operator|+
name|global_offset
operator|+
literal|7
operator|-
name|op
operator|->
name|cipher_offset
operator|)
operator|>>
literal|3
operator|)
operator|&
literal|1
decl_stmt|;
name|pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
operator|=
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_HASHBYTES
argument_list|,
name|len
operator|&
literal|7
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_IVOFF
argument_list|,
name|cipher_offset_dwords
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_PKTLEN
argument_list|,
name|nlhmac
operator|+
operator|(
operator|(
name|len
operator|+
literal|7
operator|)
operator|>>
literal|3
operator|)
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_NLHMAC
argument_list|,
name|nlhmac
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_BREAK
argument_list|,
literal|0
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_WAIT
argument_list|,
literal|1
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_NEXT
argument_list|,
literal|1
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_SEGADDR
argument_list|,
name|seg_addr
operator|>>
operator|(
name|PKT_DSC_SEGADDR_LSB
operator|)
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_SEGOFFSET
argument_list|,
name|global_offset
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|int
name|nlhmac
init|=
operator|(
operator|(
name|op
operator|->
name|source_buf_size
operator|+
name|global_offset
operator|+
literal|7
operator|-
name|op
operator|->
name|cipher_offset
operator|)
operator|>>
literal|3
operator|)
operator|&
literal|1
decl_stmt|;
name|pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
operator|=
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_HASHBYTES
argument_list|,
name|len
operator|&
literal|7
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_IVOFF
argument_list|,
name|cipher_offset_dwords
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_PKTLEN
argument_list|,
name|nlhmac
operator|+
operator|(
operator|(
name|len
operator|+
literal|7
operator|)
operator|>>
literal|3
operator|)
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_NLHMAC
argument_list|,
name|nlhmac
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_BREAK
argument_list|,
literal|0
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_WAIT
argument_list|,
literal|0
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_SEGADDR
argument_list|,
name|seg_addr
operator|>>
operator|(
name|PKT_DSC_SEGADDR_LSB
operator|)
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_SEGOFFSET
argument_list|,
name|global_offset
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
operator|=
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_HASHBYTES
argument_list|,
name|len
operator|&
literal|7
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_IVOFF
argument_list|,
name|cipher_offset_dwords
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_PKTLEN
argument_list|,
operator|(
name|len
operator|+
literal|7
operator|)
operator|>>
literal|3
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_BREAK
argument_list|,
literal|0
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_WAIT
argument_list|,
literal|0
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_NEXT
argument_list|,
literal|1
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_SEGADDR
argument_list|,
name|seg_addr
operator|>>
operator|(
name|PKT_DSC_SEGADDR_LSB
operator|)
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_SEGOFFSET
argument_list|,
name|global_offset
argument_list|)
expr_stmt|;
name|next_pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
operator|=
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_HASHBYTES
argument_list|,
operator|(
name|next_len
operator|&
literal|7
operator|)
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_IVOFF
argument_list|,
literal|0
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_PKTLEN
argument_list|,
operator|(
name|next_len
operator|+
literal|7
operator|)
operator|>>
literal|3
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_BREAK
argument_list|,
literal|0
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_WAIT
argument_list|,
literal|0
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_NEXT
argument_list|,
literal|0
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_SEGADDR
argument_list|,
name|next_seg_addr
operator|>>
operator|(
name|PKT_DSC_SEGADDR_LSB
operator|)
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_SEGOFFSET
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
operator|=
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_HASHBYTES
argument_list|,
name|len
operator|&
literal|7
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_IVOFF
argument_list|,
name|cipher_offset_dwords
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_PKTLEN
argument_list|,
operator|(
name|len
operator|+
literal|7
operator|)
operator|>>
literal|3
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_BREAK
argument_list|,
literal|0
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_WAIT
argument_list|,
literal|0
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_SEGADDR
argument_list|,
name|seg_addr
operator|>>
operator|(
name|PKT_DSC_SEGADDR_LSB
operator|)
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_SEGOFFSET
argument_list|,
name|global_offset
argument_list|)
expr_stmt|;
block|}
block|}
switch|switch
condition|(
name|op
operator|->
name|pkt_hmac
condition|)
block|{
case|case
name|XLR_SEC_LOADHMACKEY_MODE_OLD
case|:
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
argument_list|,
name|PKT_DSC_LOADHMACKEY
argument_list|,
name|PKT_DSC_LOADHMACKEY_OLD
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
argument_list|,
name|PKT_DSC_LOADHMACKEY
argument_list|,
name|PKT_DSC_LOADHMACKEY_OLD
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|XLR_SEC_LOADHMACKEY_MODE_LOAD
case|:
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
argument_list|,
name|PKT_DSC_LOADHMACKEY
argument_list|,
name|PKT_DSC_LOADHMACKEY_LOAD
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
argument_list|,
name|PKT_DSC_LOADHMACKEY
argument_list|,
name|PKT_DSC_LOADHMACKEY_LOAD
argument_list|)
expr_stmt|;
block|}
break|break;
default|default:
if|if
condition|(
name|vector
operator|&
operator|(
name|XLR_SEC_VECTOR_HMAC
operator||
name|XLR_SEC_VECTOR_HMAC2
operator||
name|XLR_SEC_VECTOR_GCM
operator||
name|XLR_SEC_VECTOR_F9
operator|)
condition|)
block|{
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_packet:  ERR_LOADHMACKEY_MODE EXIT\n"
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_LOADHMACKEY_MODE
return|;
block|}
break|break;
block|}
switch|switch
condition|(
name|op
operator|->
name|pkt_hash
condition|)
block|{
case|case
name|XLR_SEC_PADHASH_PADDED
case|:
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
argument_list|,
name|PKT_DSC_PADHASH
argument_list|,
name|PKT_DSC_PADHASH_PADDED
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
argument_list|,
name|PKT_DSC_PADHASH
argument_list|,
name|PKT_DSC_PADHASH_PADDED
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|XLR_SEC_PADHASH_PAD
case|:
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
argument_list|,
name|PKT_DSC_PADHASH
argument_list|,
name|PKT_DSC_PADHASH_PAD
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
argument_list|,
name|PKT_DSC_PADHASH
argument_list|,
name|PKT_DSC_PADHASH_PAD
argument_list|)
expr_stmt|;
block|}
break|break;
default|default:
if|if
condition|(
name|vector
operator|&
operator|(
name|XLR_SEC_VECTOR_MAC
operator||
name|XLR_SEC_VECTOR_HMAC
operator||
name|XLR_SEC_VECTOR_HMAC2
operator|)
condition|)
block|{
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_packet:  ERR_PADHASH_MODE EXIT\n"
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_PADHASH_MODE
return|;
block|}
break|break;
block|}
switch|switch
condition|(
name|op
operator|->
name|pkt_iv
condition|)
block|{
case|case
name|XLR_SEC_PKT_IV_OLD
case|:
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
argument_list|,
name|PKT_DSC_IV
argument_list|,
name|PKT_DSC_IV_OLD
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
argument_list|,
name|PKT_DSC_IV
argument_list|,
name|PKT_DSC_IV_OLD
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|XLR_SEC_PKT_IV_NEW
case|:
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
argument_list|,
name|PKT_DSC_IV
argument_list|,
name|PKT_DSC_IV_NEW
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
argument_list|,
name|PKT_DSC_IV
argument_list|,
name|PKT_DSC_IV_NEW
argument_list|)
expr_stmt|;
block|}
break|break;
default|default:
if|if
condition|(
name|vector
operator|&
name|XLR_SEC_VECTOR_CIPHER
condition|)
block|{
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_packet:  ERR_PKT_IV_MODE EXIT\n"
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_PKT_IV_MODE
return|;
block|}
break|break;
block|}
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_packet:  src_buf=%llx  phys_src_buf=%llx \n"
argument_list|,
operator|(
name|unsigned
name|long
name|long
operator|)
name|op
operator|->
name|source_buf
argument_list|,
operator|(
name|unsigned
name|long
name|long
operator|)
name|addr
argument_list|)
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_packet:  seg_addr=%llx  offset=%lld\n"
argument_list|,
operator|(
name|unsigned
name|long
name|long
operator|)
name|seg_addr
argument_list|,
operator|(
name|unsigned
name|long
name|long
operator|)
name|byte_offset
argument_list|)
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_packet: global src offset: %d, iv_offset=%d\n"
argument_list|,
name|cipher_offset_dwords
argument_list|,
name|op
operator|->
name|iv_offset
argument_list|)
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_packet: src_buf_sz=%d  PKT_LEN=%d\n"
argument_list|,
name|op
operator|->
name|source_buf_size
argument_list|,
name|len_dwords
argument_list|)
expr_stmt|;
comment|/* 	 * same operation with the destination. cipher offset affects this, 	 * as well 	 */
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|next_seg_addr
operator|=
operator|(
name|uint64_t
operator|)
name|vtophys
argument_list|(
operator|(
name|void
operator|*
operator|)
call|(
name|unsigned
name|long
call|)
argument_list|(
name|desc
operator|->
name|next_dest_buf
argument_list|)
argument_list|)
expr_stmt|;
name|next_seg_addr
operator|=
operator|(
name|next_seg_addr
operator|&
operator|~
operator|(
name|SMP_CACHE_BYTES
operator|-
literal|1
operator|)
operator|)
expr_stmt|;
block|}
name|addr
operator|=
operator|(
name|uint64_t
operator|)
name|vtophys
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|(
name|unsigned
name|long
operator|)
name|op
operator|->
name|dest_buf
argument_list|)
expr_stmt|;
name|seg_addr
operator|=
operator|(
name|addr
operator|&
operator|~
operator|(
name|SMP_CACHE_BYTES
operator|-
literal|1
operator|)
operator|)
expr_stmt|;
name|byte_offset
operator|=
name|addr
operator|-
name|seg_addr
expr_stmt|;
name|global_offset
operator|=
name|byte_offset
operator|&
literal|0x7
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_packet:  dest_buf=%llx  phys_dest_buf=%llx \n"
argument_list|,
operator|(
name|unsigned
name|long
name|long
operator|)
name|op
operator|->
name|dest_buf
argument_list|,
operator|(
name|unsigned
name|long
name|long
operator|)
name|addr
argument_list|)
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_packet:  seg_addr=%llx  offset=%lld\n"
argument_list|,
operator|(
name|unsigned
name|long
name|long
operator|)
name|seg_addr
argument_list|,
operator|(
name|unsigned
name|long
name|long
operator|)
name|byte_offset
argument_list|)
expr_stmt|;
comment|/* 	 * Dest Address = (Cipher Dest Address) + (Cipher Offset) + (Global 	 * Dest Data Offset) 	 *  	 * Cipher Dest Address - Cache-line  (0xffffffffe0) Cipher Offset - 	 * Which (64-bit) Word in Cacheline  (0-3) Global Dest Data Offset - 	 * Number of Bytes in (64-bit) Word before data 	 *  	 * It must be set for Digest-only Ops, since the Digest engine will 	 * write data to this address. 	 */
name|cipher_offset_dwords
operator|=
operator|(
name|op
operator|->
name|cipher_offset
operator|+
name|byte_offset
operator|)
operator|>>
literal|3
expr_stmt|;
name|pkt_desc
operator|->
name|dstDataSettings
operator|=
comment|/* SYM_OP, HASHSRC */
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_CPHROFF
argument_list|,
name|cipher_offset_dwords
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_HASHOFF
argument_list|,
operator|(
name|op
operator|->
name|digest_offset
operator|+
name|byte_offset
operator|)
operator|>>
literal|3
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_CPHR_DST_ADDR
argument_list|,
name|seg_addr
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_CPHR_DST_DWOFFSET
argument_list|,
literal|0
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_CPHR_DST_OFFSET
argument_list|,
name|global_offset
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|next_pkt_desc
operator|->
name|dstDataSettings
operator|=
comment|/* SYM_OP, HASHSRC */
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_CPHROFF
argument_list|,
name|cipher_offset_dwords
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_HASHOFF
argument_list|,
operator|(
name|op
operator|->
name|digest_offset
operator|+
name|byte_offset
operator|)
operator|>>
literal|3
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_CPHR_DST_ADDR
argument_list|,
name|next_seg_addr
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_CPHR_DST_DWOFFSET
argument_list|,
literal|0
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_CPHR_DST_OFFSET
argument_list|,
name|global_offset
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|op
operator|->
name|cipher_type
operator|==
name|XLR_SEC_CIPHER_TYPE_ARC4
condition|)
name|pkt_desc
operator|->
name|dstDataSettings
operator||=
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_ARC4BYTECOUNT
argument_list|,
name|last_u64_bytes
argument_list|)
expr_stmt|;
if|if
condition|(
name|op
operator|->
name|cipher_type
operator|!=
name|XLR_SEC_CIPHER_TYPE_NONE
condition|)
block|{
switch|switch
condition|(
name|op
operator|->
name|cipher_op
condition|)
block|{
case|case
name|XLR_SEC_CIPHER_OP_ENCRYPT
case|:
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|dstDataSettings
argument_list|,
name|PKT_DSC_SYM_OP
argument_list|,
name|PKT_DSC_SYM_OP_ENCRYPT
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|dstDataSettings
argument_list|,
name|PKT_DSC_SYM_OP
argument_list|,
name|PKT_DSC_SYM_OP_ENCRYPT
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|XLR_SEC_CIPHER_OP_DECRYPT
case|:
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|dstDataSettings
argument_list|,
name|PKT_DSC_SYM_OP
argument_list|,
name|PKT_DSC_SYM_OP_DECRYPT
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|dstDataSettings
argument_list|,
name|PKT_DSC_SYM_OP
argument_list|,
name|PKT_DSC_SYM_OP_DECRYPT
argument_list|)
expr_stmt|;
block|}
break|break;
default|default:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_packet:  ERR_CIPHER_OP EXIT\n"
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_CIPHER_OP
return|;
block|}
block|}
if|if
condition|(
name|flags
operator|&
name|XLR_SEC_SETUP_OP_HMAC
condition|)
block|{
switch|switch
condition|(
name|op
operator|->
name|digest_src
condition|)
block|{
case|case
name|XLR_SEC_DIGEST_SRC_DMA
case|:
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|dstDataSettings
argument_list|,
name|PKT_DSC_HASHSRC
argument_list|,
name|PKT_DSC_HASHSRC_DMA
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|dstDataSettings
argument_list|,
name|PKT_DSC_HASHSRC
argument_list|,
name|PKT_DSC_HASHSRC_DMA
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|XLR_SEC_DIGEST_SRC_CPHR
case|:
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|dstDataSettings
argument_list|,
name|PKT_DSC_HASHSRC
argument_list|,
name|PKT_DSC_HASHSRC_CIPHER
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|dstDataSettings
argument_list|,
name|PKT_DSC_HASHSRC
argument_list|,
name|PKT_DSC_HASHSRC_CIPHER
argument_list|)
expr_stmt|;
block|}
break|break;
default|default:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_packet:  ERR_DIGEST_SRC EXIT\n"
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_DIGEST_SRC
return|;
block|}
block|}
if|if
condition|(
name|op
operator|->
name|cksum_type
operator|!=
name|XLR_SEC_CKSUM_TYPE_NOP
condition|)
block|{
switch|switch
condition|(
name|op
operator|->
name|cksum_src
condition|)
block|{
case|case
name|XLR_SEC_CKSUM_SRC_DMA
case|:
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|dstDataSettings
argument_list|,
name|PKT_DSC_CKSUMSRC
argument_list|,
name|PKT_DSC_CKSUMSRC_DMA
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|dstDataSettings
argument_list|,
name|PKT_DSC_CKSUMSRC
argument_list|,
name|PKT_DSC_CKSUMSRC_DMA
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|XLR_SEC_CKSUM_SRC_CIPHER
case|:
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|dstDataSettings
argument_list|,
name|PKT_DSC_CKSUMSRC
argument_list|,
name|PKT_DSC_CKSUMSRC_CIPHER
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|dstDataSettings
argument_list|,
name|PKT_DSC_CKSUMSRC
argument_list|,
name|PKT_DSC_CKSUMSRC_CIPHER
argument_list|)
expr_stmt|;
block|}
break|break;
default|default:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_packet:  ERR_CKSUM_SRC EXIT\n"
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_CKSUM_SRC
return|;
block|}
block|}
name|pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
operator|=
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_HASH_BYTE_OFF
argument_list|,
operator|(
name|op
operator|->
name|digest_offset
operator|&
literal|0x7
operator|)
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_PKTLEN_BYTES
argument_list|,
literal|0
argument_list|)
operator||
comment|/* NONCE_HI, PKT_DSC_LASTWORD, CFB_MASK, CKSUM_DST_ADDR */
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_IV_OFF_HI
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|next_pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
operator|=
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_HASH_BYTE_OFF
argument_list|,
operator|(
name|op
operator|->
name|digest_offset
operator|&
literal|0x7
operator|)
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_PKTLEN_BYTES
argument_list|,
literal|0
argument_list|)
operator||
comment|/* NONCE_HI, PKT_DSC_LASTWORD, CFB_MASK, CKSUM_DST_ADDR */
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_IV_OFF_HI
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
switch|switch
condition|(
name|op
operator|->
name|pkt_lastword
condition|)
block|{
case|case
name|XLR_SEC_LASTWORD_128
case|:
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
argument_list|,
name|PKT_DSC_LASTWORD
argument_list|,
name|PKT_DSC_LASTWORD_128
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
argument_list|,
name|PKT_DSC_LASTWORD
argument_list|,
name|PKT_DSC_LASTWORD_128
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|XLR_SEC_LASTWORD_96MASK
case|:
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
argument_list|,
name|PKT_DSC_LASTWORD
argument_list|,
name|PKT_DSC_LASTWORD_96MASK
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
argument_list|,
name|PKT_DSC_LASTWORD
argument_list|,
name|PKT_DSC_LASTWORD_96MASK
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|XLR_SEC_LASTWORD_64MASK
case|:
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
argument_list|,
name|PKT_DSC_LASTWORD
argument_list|,
name|PKT_DSC_LASTWORD_64MASK
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
argument_list|,
name|PKT_DSC_LASTWORD
argument_list|,
name|PKT_DSC_LASTWORD_64MASK
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|XLR_SEC_LASTWORD_32MASK
case|:
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
argument_list|,
name|PKT_DSC_LASTWORD
argument_list|,
name|PKT_DSC_LASTWORD_32MASK
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
argument_list|,
name|PKT_DSC_LASTWORD
argument_list|,
name|PKT_DSC_LASTWORD_32MASK
argument_list|)
expr_stmt|;
block|}
break|break;
default|default:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_packet:  ERR_LASTWORD_MODE EXIT\n"
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_LASTWORD_MODE
return|;
block|}
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
argument_list|,
name|PKT_DSC_CFB_MASK
argument_list|,
name|op
operator|->
name|cfb_mask
argument_list|)
expr_stmt|;
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
argument_list|,
name|PKT_DSC_NONCE_HI
argument_list|,
name|htonl
argument_list|(
name|op
operator|->
name|nonce
argument_list|)
operator|>>
literal|24
argument_list|)
expr_stmt|;
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|authDstNonceLow
argument_list|,
name|PKT_DSC_NONCE_LOW
argument_list|,
name|htonl
argument_list|(
name|op
operator|->
name|nonce
argument_list|)
operator|&
literal|0xffffff
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
argument_list|,
name|PKT_DSC_CFB_MASK
argument_list|,
name|op
operator|->
name|cfb_mask
argument_list|)
expr_stmt|;
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
argument_list|,
name|PKT_DSC_NONCE_HI
argument_list|,
name|htonl
argument_list|(
name|op
operator|->
name|nonce
argument_list|)
operator|>>
literal|24
argument_list|)
expr_stmt|;
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|authDstNonceLow
argument_list|,
name|PKT_DSC_NONCE_LOW
argument_list|,
name|htonl
argument_list|(
name|op
operator|->
name|nonce
argument_list|)
operator|&
literal|0xffffff
argument_list|)
expr_stmt|;
block|}
comment|/* Auth Dest Address must be Cacheline aligned on input */
if|if
condition|(
name|vector
operator|&
operator|(
name|XLR_SEC_VECTOR_MAC
operator||
name|XLR_SEC_VECTOR_HMAC
operator||
name|XLR_SEC_VECTOR_HMAC2
operator||
name|XLR_SEC_VECTOR_GCM
operator||
name|XLR_SEC_VECTOR_F9
operator|)
condition|)
block|{
name|pkt_desc
operator|->
name|authDstNonceLow
operator||=
comment|/* NONCE_LOW */
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_AUTH_DST_ADDR
argument_list|,
operator|(
name|uint64_t
operator|)
name|vtophys
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|(
name|unsigned
name|long
operator|)
name|op
operator|->
name|auth_dest
argument_list|)
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_CIPH_OFF_HI
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|next_pkt_desc
operator|->
name|authDstNonceLow
operator||=
comment|/* NONCE_LOW */
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_AUTH_DST_ADDR
argument_list|,
operator|(
name|uint64_t
operator|)
name|vtophys
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|(
name|unsigned
name|long
operator|)
name|desc
operator|->
name|next_auth_dest
argument_list|)
argument_list|)
operator||
name|FIELD_VALUE
argument_list|(
name|PKT_DSC_CIPH_OFF_HI
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
block|}
comment|/* CkSum Dest Address must be Cacheline aligned on input */
if|if
condition|(
name|op
operator|->
name|cksum_type
operator|==
name|XLR_SEC_CKSUM_TYPE_IP
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
argument_list|,
name|PKT_DSC_CKSUM_DST_ADDR
argument_list|,
operator|(
name|uint64_t
operator|)
name|vtophys
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|(
name|unsigned
name|long
operator|)
name|op
operator|->
name|cksum_dest
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|CLEAR_SET_FIELD
argument_list|(
name|next_pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
argument_list|,
name|PKT_DSC_CKSUM_DST_ADDR
argument_list|,
operator|(
name|uint64_t
operator|)
name|vtophys
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|(
name|unsigned
name|long
operator|)
name|desc
operator|->
name|next_cksum_dest
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
comment|/* 	 * XLR_SEC_CMD_DIAG (" xlr_sec_setup_packet():  pkt_desc=%llx 	 * phys_pkt_desc=%llx \n", (unsigned long long)pkt_desc, (unsigned 	 * long long)virt_to_phys(pkt_desc)); (unsigned long long)pkt_desc, 	 * (unsigned long long)vtophys(pkt_desc)); 	 */
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|" xlr_sec_setup_packet():  pkt_desc=%p   phys_pkt_desc=%llx \n"
argument_list|,
name|pkt_desc
argument_list|,
operator|(
name|unsigned
name|long
name|long
operator|)
name|vtophys
argument_list|(
name|pkt_desc
argument_list|)
argument_list|)
expr_stmt|;
name|CLEAR_SET_FIELD
argument_list|(
operator|*
name|data
argument_list|,
name|MSG_CMD_DATA_ADDR
argument_list|,
operator|(
operator|(
name|uint64_t
operator|)
name|vtophys
argument_list|(
name|pkt_desc
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|CLEAR_SET_FIELD
argument_list|(
operator|*
name|data
argument_list|,
name|MSG_CMD_DATA_CTL
argument_list|,
name|SEC_EOP
argument_list|)
expr_stmt|;
name|CLEAR_SET_FIELD
argument_list|(
operator|*
name|data
argument_list|,
name|MSG_CMD_DATA_LEN
argument_list|,
name|MSG_CMD_DATA_LEN_LOAD
argument_list|)
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_packet:  DONE\n"
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|RMI_SEC_DEBUG
block|{
name|printf
argument_list|(
literal|"data desc\n"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"srcLengthIVOffUseIVNext = 0x%llx\n"
argument_list|,
name|pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"dstDataSettings = 0x%llx\n"
argument_list|,
name|pkt_desc
operator|->
name|dstDataSettings
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"authDstNonceLow = 0x%llx\n"
argument_list|,
name|pkt_desc
operator|->
name|authDstNonceLow
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"ckSumDstNonceHiCFBMaskLLWMask = 0x%llx\n"
argument_list|,
name|pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|multi_frag_flag
condition|)
block|{
name|printf
argument_list|(
literal|"next data desc\n"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"srcLengthIVOffUseIVNext = 0x%llx\n"
argument_list|,
name|next_pkt_desc
operator|->
name|srcLengthIVOffUseIVNext
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"dstDataSettings = 0x%llx\n"
argument_list|,
name|next_pkt_desc
operator|->
name|dstDataSettings
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"authDstNonceLow = 0x%llx\n"
argument_list|,
name|next_pkt_desc
operator|->
name|authDstNonceLow
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"ckSumDstNonceHiCFBMaskLLWMask = 0x%llx\n"
argument_list|,
name|next_pkt_desc
operator|->
name|ckSumDstNonceHiCFBMaskLLWMask
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
ifdef|#
directive|ifdef
name|SYMBOL
if|if
condition|(
name|op
operator|->
name|cipher_type
operator|==
name|XLR_SEC_CIPHER_TYPE_ARC4
condition|)
block|{
name|op
operator|->
name|source_buf
operator|-=
literal|0
expr_stmt|;
name|op
operator|->
name|source_buf_size
operator|+=
literal|0
expr_stmt|;
name|op
operator|->
name|dest_buf
operator|-=
literal|0
expr_stmt|;
block|}
endif|#
directive|endif
return|return
name|XLR_SEC_ERR_NONE
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|identify_symkey_ctl_error
parameter_list|(
name|uint32_t
name|code
parameter_list|,
name|xlr_sec_error_t
name|err
parameter_list|)
block|{
name|int
name|ret_val
init|=
name|EINVAL
decl_stmt|;
switch|switch
condition|(
name|code
condition|)
block|{
case|case
name|CTL_ERR_NONE
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: CTL Error:  No Error\n"
argument_list|)
expr_stmt|;
name|ret_val
operator|=
literal|0
expr_stmt|;
break|break;
case|case
name|CTL_ERR_CIPHER_OP
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: CTL Error(CTL_ERR_CIPHER_OP) - Unknown Cipher Op \n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|CTL_ERR_MODE
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: CTL Error(CTL_ERR_MODE) - "
literal|"Unknown or Not Allowed Mode \n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|CTL_ERR_CHKSUM_SRC
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: CTL Error(CTL_ERR_CHKSUM_SRC) - Unknown CkSum Src\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|CTL_ERR_CFB_MASK
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: CTL Error(CTL_ERR_CFB_MASK) - Forbidden CFB Mask \n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|CTL_ERR_OP
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: CTL Error(CTL_ERR_OP) - Unknown Ctrl Op \n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|CTL_ERR_DATA_READ
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: CTL Error(CTL_ERR_DATA_READ) - Data Read Error\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|CTL_ERR_DESC_CTRL
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: CTL Error(CTL_ERR_DESC_CTRL) - "
literal|"Descriptor Ctrl Field Error  \n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|CTL_ERR_UNDEF1
case|:
case|case
name|CTL_ERR_UNDEF2
case|:
default|default:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: CTL Error:  UNKNOWN CODE=%d \n"
argument_list|,
name|code
argument_list|)
expr_stmt|;
break|break;
block|}
return|return
name|ret_val
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|identify_symkey_data_error
parameter_list|(
name|uint32_t
name|code
parameter_list|,
name|xlr_sec_error_t
name|err
parameter_list|)
block|{
name|int
name|ret_val
init|=
operator|-
name|EINVAL
decl_stmt|;
switch|switch
condition|(
name|code
condition|)
block|{
case|case
name|DATA_ERR_NONE
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: DATA Error  No Error\n"
argument_list|)
expr_stmt|;
name|ret_val
operator|=
literal|0
expr_stmt|;
break|break;
case|case
name|DATA_ERR_LEN_CIPHER
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: DATA Error() - Not Enough Data To Cipher\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|DATA_ERR_IV_ADDR
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: DATA Error() - Illegal IV Loacation\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|DATA_ERR_WD_LEN_AES
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: DATA Error() - Illegal Nb Words To AES\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|DATA_ERR_BYTE_COUNT
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: DATA Error() - Illegal Pad And ByteCount Spec\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|DATA_ERR_LEN_CKSUM
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: DATA Error() - Not Enough Data To CkSum\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|DATA_ERR_OP
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: DATA Error() - Unknown Data Op \n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|DATA_ERR_READ
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: DATA Error() - Data Read Error \n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|DATA_ERR_WRITE
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: DATA Error() - Data Write Error \n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|DATA_ERR_UNDEF1
case|:
default|default:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_SEC: DATA Error - UNKNOWN CODE=%d \n"
argument_list|,
name|code
argument_list|)
expr_stmt|;
break|break;
block|}
return|return
name|ret_val
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|xlr_sec_submit_message
parameter_list|(
name|symkey_desc_pt
name|desc
parameter_list|,
name|uint32_t
name|cfg_vector
parameter_list|)
block|{
name|xlr_sec_error_t
name|err
decl_stmt|;
name|uint32_t
name|ctl_error
decl_stmt|,
name|data_error
decl_stmt|;
name|int
name|ret_val
init|=
literal|0
decl_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_submit_message:  ENTER\n"
argument_list|)
expr_stmt|;
name|err
operator|=
name|XLR_SEC_ERR_NONE
expr_stmt|;
name|XLR_SEC_CMD_DIAG_SYM_DESC
argument_list|(
name|desc
argument_list|,
name|cfg_vector
argument_list|)
expr_stmt|;
do|do
block|{
comment|/* For now, send message and wait for response */
name|err
operator|=
name|xlr_sec_submit_op
argument_list|(
name|desc
argument_list|)
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_submit_message:  err = %d \n"
argument_list|,
operator|(
name|uint32_t
operator|)
name|err
argument_list|)
expr_stmt|;
if|if
condition|(
name|err
operator|!=
name|XLR_SEC_ERR_NONE
condition|)
block|{
name|ret_val
operator|=
operator|(
name|EINVAL
operator|)
expr_stmt|;
break|break;
block|}
name|ctl_error
operator|=
name|desc
operator|->
name|ctl_result
expr_stmt|;
name|data_error
operator|=
name|desc
operator|->
name|data_result
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_submit_message: ctl_error = %x   data_error = %x\n"
argument_list|,
name|ctl_error
argument_list|,
name|data_error
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|ret_val
operator|=
name|identify_symkey_ctl_error
argument_list|(
name|ctl_error
argument_list|,
name|err
argument_list|)
operator|)
operator|==
literal|0
condition|)
name|ret_val
operator|=
name|identify_symkey_data_error
argument_list|(
name|data_error
argument_list|,
name|err
argument_list|)
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_submit_message: identify error = %d \n"
argument_list|,
name|ret_val
argument_list|)
expr_stmt|;
block|}
do|while
condition|(
literal|0
condition|)
do|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_submit_message:  DONE\n"
argument_list|)
expr_stmt|;
return|return
operator|(
name|ret_val
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|xlr_sec_error_t
name|xlr_sec_setup_cipher
parameter_list|(
name|xlr_sec_io_pt
name|op
parameter_list|,
name|ControlDescriptor_pt
name|ctl_desc
parameter_list|,
name|uint32_t
modifier|*
name|vector
parameter_list|)
block|{
name|uint32_t
name|aes_flag
init|=
literal|0
decl_stmt|;
name|uint32_t
name|cipher_vector
init|=
literal|0
decl_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_cipher:  ENTER  vector = %04x\n"
argument_list|,
operator|*
name|vector
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|op
operator|->
name|cipher_type
condition|)
block|{
case|case
name|XLR_SEC_CIPHER_TYPE_NONE
case|:
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_CPHR
argument_list|,
name|CTL_DSC_CPHR_BYPASS
argument_list|)
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_cipher:  CIPHER_TYPE_NONE EXIT\n"
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_NONE
return|;
case|case
name|XLR_SEC_CIPHER_TYPE_DES
case|:
name|cipher_vector
operator||=
name|XLR_SEC_VECTOR_CIPHER_DES
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_CPHR
argument_list|,
name|CTL_DSC_CPHR_DES
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_CIPHER_TYPE_3DES
case|:
name|cipher_vector
operator||=
name|XLR_SEC_VECTOR_CIPHER_3DES
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_CPHR
argument_list|,
name|CTL_DSC_CPHR_3DES
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_CIPHER_TYPE_AES128
case|:
name|aes_flag
operator|=
literal|1
expr_stmt|;
name|cipher_vector
operator||=
name|XLR_SEC_VECTOR_CIPHER_AES128
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_CPHR
argument_list|,
name|CTL_DSC_CPHR_AES128
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_CIPHER_TYPE_AES192
case|:
name|aes_flag
operator|=
literal|1
expr_stmt|;
name|cipher_vector
operator||=
name|XLR_SEC_VECTOR_CIPHER_AES192
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_CPHR
argument_list|,
name|CTL_DSC_CPHR_AES192
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_CIPHER_TYPE_AES256
case|:
name|aes_flag
operator|=
literal|1
expr_stmt|;
name|cipher_vector
operator||=
name|XLR_SEC_VECTOR_CIPHER_AES256
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_CPHR
argument_list|,
name|CTL_DSC_CPHR_AES256
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_CIPHER_TYPE_ARC4
case|:
name|cipher_vector
operator||=
name|XLR_SEC_VECTOR_CIPHER_ARC4
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_CPHR
argument_list|,
name|CTL_DSC_CPHR_ARC4
argument_list|)
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_ARC4_KEYLEN
argument_list|,
name|op
operator|->
name|rc4_key_len
argument_list|)
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_ARC4_LOADSTATE
argument_list|,
name|op
operator|->
name|rc4_loadstate
argument_list|)
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_ARC4_SAVESTATE
argument_list|,
name|op
operator|->
name|rc4_savestate
argument_list|)
expr_stmt|;
if|if
condition|(
name|op
operator|->
name|rc4_loadstate
operator|||
name|op
operator|->
name|rc4_savestate
condition|)
name|cipher_vector
operator||=
name|XLR_SEC_VECTOR_STATE
expr_stmt|;
break|break;
case|case
name|XLR_SEC_CIPHER_TYPE_KASUMI_F8
case|:
name|aes_flag
operator|=
literal|1
expr_stmt|;
name|cipher_vector
operator||=
name|XLR_SEC_VECTOR_CIPHER_KASUMI_F8
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_CPHR
argument_list|,
name|CTL_DSC_CPHR_KASUMI_F8
argument_list|)
expr_stmt|;
break|break;
default|default:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_cipher:  ERR_CIPHER_TYPE EXIT\n"
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_CIPHER_TYPE
return|;
block|}
switch|switch
condition|(
name|op
operator|->
name|cipher_mode
condition|)
block|{
case|case
name|XLR_SEC_CIPHER_MODE_ECB
case|:
if|if
condition|(
name|aes_flag
operator|==
literal|1
condition|)
name|cipher_vector
operator||=
name|XLR_SEC_VECTOR_MODE_ECB_CBC_OFB
expr_stmt|;
else|else
name|cipher_vector
operator||=
name|XLR_SEC_VECTOR_MODE_ECB_CBC
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_MODE
argument_list|,
name|CTL_DSC_MODE_ECB
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_CIPHER_MODE_CBC
case|:
if|if
condition|(
name|aes_flag
operator|==
literal|1
condition|)
name|cipher_vector
operator||=
name|XLR_SEC_VECTOR_MODE_ECB_CBC_OFB
expr_stmt|;
else|else
name|cipher_vector
operator||=
name|XLR_SEC_VECTOR_MODE_ECB_CBC
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_MODE
argument_list|,
name|CTL_DSC_MODE_CBC
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_CIPHER_MODE_OFB
case|:
if|if
condition|(
name|aes_flag
operator|==
literal|0
condition|)
block|{
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_cipher:  ERR_CIPHER_MODE EXIT\n"
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_CIPHER_MODE
return|;
block|}
name|cipher_vector
operator||=
name|XLR_SEC_VECTOR_MODE_ECB_CBC_OFB
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_MODE
argument_list|,
name|CTL_DSC_MODE_OFB
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_CIPHER_MODE_CTR
case|:
if|if
condition|(
name|aes_flag
operator|==
literal|0
condition|)
block|{
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_cipher:  ERR_CIPHER_MODE EXIT\n"
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_CIPHER_MODE
return|;
block|}
name|cipher_vector
operator||=
name|XLR_SEC_VECTOR_MODE_CTR_CFB
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_MODE
argument_list|,
name|CTL_DSC_MODE_CTR
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_CIPHER_MODE_CFB
case|:
if|if
condition|(
name|aes_flag
operator|==
literal|0
condition|)
block|{
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_cipher:  ERR_CIPHER_MODE EXIT\n"
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_CIPHER_MODE
return|;
block|}
name|cipher_vector
operator||=
name|XLR_SEC_VECTOR_MODE_CTR_CFB
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_MODE
argument_list|,
name|CTL_DSC_MODE_CFB
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_CIPHER_MODE_F8
case|:
if|if
condition|(
name|aes_flag
operator|==
literal|0
condition|)
block|{
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_cipher:  ERR_CIPHER_MODE EXIT\n"
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_CIPHER_MODE
return|;
block|}
name|cipher_vector
operator||=
name|XLR_SEC_VECTOR_MODE_F8
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_MODE
argument_list|,
name|CTL_DSC_MODE_F8
argument_list|)
expr_stmt|;
break|break;
default|default:
if|if
condition|(
operator|!
operator|(
name|cipher_vector
operator|&
operator|(
name|XLR_SEC_VECTOR_CIPHER_ARC4
operator||
name|XLR_SEC_VECTOR_CIPHER_KASUMI_F8
operator|)
operator|)
condition|)
block|{
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_cipher:  ERR_CIPHER_MODE EXIT\n"
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_CIPHER_MODE
return|;
block|}
block|}
switch|switch
condition|(
name|op
operator|->
name|cipher_init
condition|)
block|{
case|case
name|XLR_SEC_CIPHER_INIT_OK
case|:
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_ICPHR
argument_list|,
name|CTL_DSC_ICPHR_OKY
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_CIPHER_INIT_NK
case|:
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_ICPHR
argument_list|,
name|CTL_DSC_ICPHR_NKY
argument_list|)
expr_stmt|;
break|break;
default|default:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_cipher:  ERR_CIPHER_INIT EXIT\n"
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_CIPHER_INIT
return|;
block|}
operator|*
name|vector
operator||=
name|cipher_vector
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_cipher:  EXIT  vector = %04x\n"
argument_list|,
operator|*
name|vector
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_NONE
return|;
block|}
end_function

begin_function
specifier|static
name|xlr_sec_error_t
name|xlr_sec_setup_digest
parameter_list|(
name|xlr_sec_io_pt
name|op
parameter_list|,
name|ControlDescriptor_pt
name|ctl_desc
parameter_list|,
name|uint32_t
modifier|*
name|vector
parameter_list|)
block|{
name|uint32_t
name|hash_flag
init|=
literal|0
decl_stmt|;
name|uint32_t
name|hmac_flag
init|=
literal|0
decl_stmt|;
name|uint32_t
name|digest_vector
init|=
literal|0
decl_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_digest:  ENTER  vector = %04x\n"
argument_list|,
operator|*
name|vector
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|op
operator|->
name|digest_type
condition|)
block|{
case|case
name|XLR_SEC_DIGEST_TYPE_MD5
case|:
name|digest_vector
operator||=
name|XLR_SEC_VECTOR_MAC
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASH
argument_list|,
name|CTL_DSC_HASH_MD5
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_TYPE_SHA1
case|:
name|digest_vector
operator||=
name|XLR_SEC_VECTOR_MAC
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASH
argument_list|,
name|CTL_DSC_HASH_SHA1
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_TYPE_SHA256
case|:
name|digest_vector
operator||=
name|XLR_SEC_VECTOR_MAC
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASH
argument_list|,
name|CTL_DSC_HASH_SHA256
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_TYPE_SHA384
case|:
name|digest_vector
operator||=
name|XLR_SEC_VECTOR_MAC
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASHHI
argument_list|,
name|CTL_DSC_HASH_SHA384
operator|>>
literal|2
argument_list|)
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASH
argument_list|,
name|CTL_DSC_HASH_SHA384
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_TYPE_SHA512
case|:
name|digest_vector
operator||=
name|XLR_SEC_VECTOR_MAC
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASHHI
argument_list|,
name|CTL_DSC_HASH_SHA512
operator|>>
literal|2
argument_list|)
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASH
argument_list|,
name|CTL_DSC_HASH_SHA512
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_TYPE_GCM
case|:
name|hash_flag
operator|=
literal|1
expr_stmt|;
name|digest_vector
operator||=
name|XLR_SEC_VECTOR_GCM
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASHHI
argument_list|,
name|CTL_DSC_HASH_GCM
operator|>>
literal|2
argument_list|)
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASH
argument_list|,
name|CTL_DSC_HASH_GCM
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_TYPE_KASUMI_F9
case|:
name|hash_flag
operator|=
literal|1
expr_stmt|;
name|digest_vector
operator||=
name|XLR_SEC_VECTOR_F9
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASHHI
argument_list|,
name|CTL_DSC_HASH_KASUMI_F9
operator|>>
literal|2
argument_list|)
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASH
argument_list|,
name|CTL_DSC_HASH_KASUMI_F9
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_TYPE_HMAC_MD5
case|:
name|hmac_flag
operator|=
literal|1
expr_stmt|;
name|digest_vector
operator||=
name|XLR_SEC_VECTOR_HMAC
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASH
argument_list|,
name|CTL_DSC_HASH_MD5
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_TYPE_HMAC_SHA1
case|:
name|hmac_flag
operator|=
literal|1
expr_stmt|;
name|digest_vector
operator||=
name|XLR_SEC_VECTOR_HMAC
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASH
argument_list|,
name|CTL_DSC_HASH_SHA1
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_TYPE_HMAC_SHA256
case|:
name|hmac_flag
operator|=
literal|1
expr_stmt|;
name|digest_vector
operator||=
name|XLR_SEC_VECTOR_HMAC
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASH
argument_list|,
name|CTL_DSC_HASH_SHA256
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_TYPE_HMAC_SHA384
case|:
name|hmac_flag
operator|=
literal|1
expr_stmt|;
name|digest_vector
operator||=
name|XLR_SEC_VECTOR_HMAC2
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASHHI
argument_list|,
name|CTL_DSC_HASH_SHA384
operator|>>
literal|2
argument_list|)
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASH
argument_list|,
name|CTL_DSC_HASH_SHA384
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_TYPE_HMAC_SHA512
case|:
name|hmac_flag
operator|=
literal|1
expr_stmt|;
name|digest_vector
operator||=
name|XLR_SEC_VECTOR_HMAC2
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASHHI
argument_list|,
name|CTL_DSC_HASH_SHA512
operator|>>
literal|2
argument_list|)
expr_stmt|;
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HASH
argument_list|,
name|CTL_DSC_HASH_SHA512
argument_list|)
expr_stmt|;
break|break;
default|default:
return|return
name|XLR_SEC_ERR_DIGEST_TYPE
return|;
block|}
if|if
condition|(
name|hmac_flag
operator|==
literal|1
condition|)
block|{
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_HMAC
argument_list|,
name|CTL_DSC_HMAC_ON
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|hmac_flag
operator|||
name|hash_flag
condition|)
block|{
switch|switch
condition|(
name|op
operator|->
name|digest_init
condition|)
block|{
case|case
name|XLR_SEC_DIGEST_INIT_OLDKEY
case|:
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_IHASH
argument_list|,
name|CTL_DSC_IHASH_OLD
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_INIT_NEWKEY
case|:
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_IHASH
argument_list|,
name|CTL_DSC_IHASH_NEW
argument_list|)
expr_stmt|;
break|break;
default|default:
return|return
name|XLR_SEC_ERR_DIGEST_INIT
return|;
block|}
block|}
comment|/* hmac_flag */
operator|*
name|vector
operator||=
name|digest_vector
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"xlr_sec_setup_digest: EXIT  vector = %04x\n"
argument_list|,
operator|*
name|vector
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_NONE
return|;
block|}
end_function

begin_function
specifier|static
name|xlr_sec_error_t
name|xlr_sec_setup_cksum
parameter_list|(
name|xlr_sec_io_pt
name|op
parameter_list|,
name|ControlDescriptor_pt
name|ctl_desc
parameter_list|)
block|{
switch|switch
condition|(
name|op
operator|->
name|cksum_type
condition|)
block|{
case|case
name|XLR_SEC_CKSUM_TYPE_NOP
case|:
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_CKSUM
argument_list|,
name|CTL_DSC_CKSUM_NOP
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_NONE
return|;
case|case
name|XLR_SEC_CKSUM_TYPE_IP
case|:
name|SET_FIELD
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|,
name|CTL_DSC_CKSUM
argument_list|,
name|CTL_DSC_CKSUM_IP
argument_list|)
expr_stmt|;
break|break;
default|default:
return|return
name|XLR_SEC_ERR_CKSUM_TYPE
return|;
block|}
return|return
name|XLR_SEC_ERR_NONE
return|;
block|}
end_function

begin_function
specifier|static
name|xlr_sec_error_t
name|xlr_sec_control_setup
parameter_list|(
name|xlr_sec_io_pt
name|op
parameter_list|,
name|unsigned
name|int
name|flags
parameter_list|,
name|uint64_t
modifier|*
name|control
parameter_list|,
name|ControlDescriptor_pt
name|ctl_desc
parameter_list|,
name|xlr_sec_drv_user_t
modifier|*
name|user
parameter_list|,
name|uint32_t
name|vector
parameter_list|)
block|{
name|uint64_t
modifier|*
name|hmac_key
init|=
name|NULL
decl_stmt|;
name|uint64_t
modifier|*
name|cipher_key
init|=
name|NULL
decl_stmt|;
name|uint64_t
modifier|*
name|cipher_state
init|=
name|NULL
decl_stmt|;
name|uint32_t
name|ctl_size
init|=
literal|0
decl_stmt|;
name|uint64_t
name|ctl_addr
init|=
literal|0
decl_stmt|;
name|uint32_t
name|cipher_keylen
init|=
literal|0
decl_stmt|;
name|uint32_t
name|hmac_keylen
init|=
literal|0
decl_stmt|;
name|uint32_t
name|ctl_len
decl_stmt|;
ifdef|#
directive|ifdef
name|SYM_DEBUG
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|" ENTER  vector = %04x\n"
argument_list|,
name|vector
argument_list|)
expr_stmt|;
endif|#
directive|endif
switch|switch
condition|(
name|vector
condition|)
block|{
case|case
name|XLR_SEC_VECTOR_MAC
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|" XLR_SEC_VECTOR_MAC \n"
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_HMAC
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_HMAC  \n"
argument_list|)
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoHMAC
operator|.
name|hmacKey0
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_ARC4\n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|op
operator|->
name|rc4_key_len
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|ARC4_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__HMAC
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_ARC4__HMAC\n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4HMAC
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4HMAC
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|op
operator|->
name|rc4_key_len
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|ARC4HMAC_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__STATE
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_ARC4__STATE\n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4State
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_state
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4State
operator|.
name|Arc4SboxData0
expr_stmt|;
name|cipher_keylen
operator|=
name|op
operator|->
name|rc4_key_len
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|ARC4State_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__HMAC__STATE
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_ARC4__HMAC__STATE\n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4StateHMAC
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_state
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4StateHMAC
operator|.
name|Arc4SboxData0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4StateHMAC
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|op
operator|->
name|rc4_key_len
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|ARC4StateHMAC_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_KASUMI_F8
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_KASUMI_F8\n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoKASUMIF8
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_KASUMI_F8_KEY_LENGTH
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|KASUMIF8_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_KASUMI_F8__HMAC
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_KASUMI_F8__HMAC\n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoKASUMIF8HMAC
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_KASUMI_F8_KEY_LENGTH
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoKASUMIF8HMAC
operator|.
name|hmacKey0
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|KASUMIF8HMAC_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_KASUMI_F8__HMAC2
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_KASUMI_F8__HMAC2\n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoKASUMIF8HMAC2
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_KASUMI_F8_KEY_LENGTH
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoKASUMIF8HMAC2
operator|.
name|hmacKey0
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|KASUMIF8HMAC2_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_KASUMI_F8__GCM
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_KASUMI_F8__GCM\n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoKASUMIF8GCM
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_KASUMI_F8_KEY_LENGTH
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoKASUMIF8GCM
operator|.
name|GCMH0
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|KASUMIF8GCM_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_KASUMI_F8__F9
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_KASUMI_F8__F9\n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoKASUMIF8F9
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_KASUMI_F8_KEY_LENGTH
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoKASUMIF8F9
operator|.
name|authKey0
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|KASUMIF8F9_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_DES__HMAC__MODE_ECB_CBC
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|" XLR_SEC_VECTOR__CIPHER_DES__HMAC__MODE_ECB_CBC  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoDESHMAC
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoDESHMAC
operator|.
name|hmacKey0
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_DES_KEY_LENGTH
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|DESHMAC_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_DES__MODE_ECB_CBC
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_DES__MODE_ECB_CBC  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoDES
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_DES_KEY_LENGTH
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|DES_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_3DES__HMAC__MODE_ECB_CBC
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_3DES__HMAC__MODE_ECB_CBC  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|info3DESHMAC
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|info3DESHMAC
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_3DES_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|DES3HMAC_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_3DES__MODE_ECB_CBC
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_3DES__MODE_ECB_CBC  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|info3DES
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_3DES_KEY_LENGTH
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|DES3_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__HMAC__MODE_CTR_CFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES128__HMAC__MODE_CTR_CFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128HMAC
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128HMAC
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES128_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES128HMAC_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__MODE_CTR_CFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES128__MODE_CTR_CFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES128_KEY_LENGTH
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES128_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__HMAC__MODE_ECB_CBC_OFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|" XLR_SEC_VECTOR__CIPHER_AES128__HMAC__MODE_ECB_CBC_OFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128HMAC
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128HMAC
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES128_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES128HMAC_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__MODE_ECB_CBC_OFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES128__MODE_ECB_CBC_OFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES128_KEY_LENGTH
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES128_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__HMAC__MODE_F8
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES128__HMAC__MODE_F8  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128F8HMAC
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128F8HMAC
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES128F8_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES128F8HMAC_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__MODE_F8
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES128__MODE_F8  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128F8
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES128F8_KEY_LENGTH
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES128F8_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__HMAC__MODE_CTR_CFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES192__HMAC__MODE_CTR_CFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192HMAC
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192HMAC
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES192_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES192HMAC_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__MODE_CTR_CFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES192__MODE_CTR_CFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES192_KEY_LENGTH
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES192_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__HMAC__MODE_ECB_CBC_OFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES192__HMAC__MODE_ECB_CBC_OFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192HMAC
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192HMAC
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES192_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES192HMAC_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__MODE_ECB_CBC_OFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES192__MODE_ECB_CBC_OFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES192_KEY_LENGTH
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES192_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__HMAC__MODE_F8
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES192__HMAC__MODE_F8  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192F8HMAC
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192F8HMAC
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES192F8_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES192F8HMAC_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__MODE_F8
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES192__MODE_F8  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192F8
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES192F8_KEY_LENGTH
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES192F8_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__HMAC__MODE_CTR_CFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES256__HMAC__MODE_CTR_CFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256HMAC
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256HMAC
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES256_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES256HMAC_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__MODE_CTR_CFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES256__MODE_CTR_CFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES256_KEY_LENGTH
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES256_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__HMAC__MODE_ECB_CBC_OFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES256__HMAC__MODE_ECB_CBC_OFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256HMAC
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256HMAC
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES256_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES256HMAC_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__MODE_ECB_CBC_OFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES256__MODE_ECB_CBC_OFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES256_KEY_LENGTH
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES256_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__HMAC__MODE_F8
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES256__HMAC__MODE_F8  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256F8HMAC
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256F8HMAC
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES256F8_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES256F8HMAC_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__MODE_F8
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES256__MODE_F8  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256F8
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES256F8_KEY_LENGTH
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES256F8_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_HMAC2
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_HMAC2  \n"
argument_list|)
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoHMAC2
operator|.
name|hmacKey0
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__HMAC2
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_ARC4__HMAC2\n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4HMAC2
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4HMAC2
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|op
operator|->
name|rc4_key_len
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|ARC4HMAC2_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__HMAC2__STATE
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_ARC4__HMAC2__STATE\n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4StateHMAC2
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_state
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4StateHMAC2
operator|.
name|Arc4SboxData0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4StateHMAC2
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|op
operator|->
name|rc4_key_len
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|ARC4StateHMAC2_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_DES__HMAC2__MODE_ECB_CBC
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|" XLR_SEC_VECTOR__CIPHER_DES__HMAC2__MODE_ECB_CBC  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoDESHMAC2
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoDESHMAC2
operator|.
name|hmacKey0
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_DES_KEY_LENGTH
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|DESHMAC2_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_3DES__HMAC2__MODE_ECB_CBC
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_3DES__HMAC2__MODE_ECB_CBC  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|info3DESHMAC2
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|info3DESHMAC2
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_3DES_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|DES3HMAC2_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__HMAC2__MODE_CTR_CFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES128__HMAC2__MODE_CTR_CFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128HMAC2
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128HMAC2
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES128_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES128HMAC2_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__HMAC2__MODE_ECB_CBC_OFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|" XLR_SEC_VECTOR__CIPHER_AES128__HMAC2__MODE_ECB_CBC_OFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128HMAC2
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128HMAC2
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES128_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES128HMAC2_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__HMAC2__MODE_F8
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES128__HMAC2__MODE_F8  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128F8HMAC2
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128F8HMAC2
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES128F8_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES128F8HMAC2_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__HMAC2__MODE_CTR_CFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES192__HMAC2__MODE_CTR_CFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192HMAC2
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192HMAC2
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES192_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES192HMAC2_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__HMAC2__MODE_ECB_CBC_OFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES192__HMAC2__MODE_ECB_CBC_OFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192HMAC2
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192HMAC2
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES192_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES192HMAC2_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__HMAC2__MODE_F8
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES192__HMAC2__MODE_F8  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192F8HMAC2
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192F8HMAC2
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES192F8_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES192F8HMAC2_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__HMAC2__MODE_CTR_CFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES256__HMAC2__MODE_CTR_CFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256HMAC2
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256HMAC2
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES256_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES256HMAC2_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__HMAC2__MODE_ECB_CBC_OFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES256__HMAC2__MODE_ECB_CBC_OFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256HMAC2
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256HMAC2
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES256_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES256HMAC2_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__HMAC2__MODE_F8
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES256__HMAC2__MODE_F8  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256F8HMAC2
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256F8HMAC2
operator|.
name|hmacKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES256F8_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES256F8HMAC2_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_GCM
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_GCM  \n"
argument_list|)
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoGCM
operator|.
name|GCMH0
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__GCM
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_ARC4__GCM\n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4GCM
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4GCM
operator|.
name|GCMH0
expr_stmt|;
name|cipher_keylen
operator|=
name|op
operator|->
name|rc4_key_len
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|ARC4GCM_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__GCM__STATE
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_ARC4__GCM__STATE\n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4StateGCM
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_state
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4StateGCM
operator|.
name|Arc4SboxData0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4StateGCM
operator|.
name|GCMH0
expr_stmt|;
name|cipher_keylen
operator|=
name|op
operator|->
name|rc4_key_len
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|ARC4StateGCM_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_DES__GCM__MODE_ECB_CBC
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|" XLR_SEC_VECTOR__CIPHER_DES__GCM__MODE_ECB_CBC  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoDESGCM
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoDESGCM
operator|.
name|GCMH0
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_DES_KEY_LENGTH
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|DESGCM_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_3DES__GCM__MODE_ECB_CBC
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_3DES__GCM__MODE_ECB_CBC  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|info3DESGCM
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|info3DESGCM
operator|.
name|GCMH0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_3DES_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|DES3GCM_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__GCM__MODE_CTR_CFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES128__GCM__MODE_CTR_CFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128GCM
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128GCM
operator|.
name|GCMH0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES128_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES128GCM_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__GCM__MODE_ECB_CBC_OFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|" XLR_SEC_VECTOR__CIPHER_AES128__GCM__MODE_ECB_CBC_OFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128GCM
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128GCM
operator|.
name|GCMH0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES128_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES128GCM_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__GCM__MODE_F8
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES128__GCM__MODE_F8  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128F8GCM
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128F8GCM
operator|.
name|GCMH0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES128F8_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES128F8GCM_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__GCM__MODE_CTR_CFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES192__GCM__MODE_CTR_CFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192GCM
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192GCM
operator|.
name|GCMH0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES192_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES192GCM_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__GCM__MODE_ECB_CBC_OFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES192__GCM__MODE_ECB_CBC_OFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192GCM
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192GCM
operator|.
name|GCMH0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES192_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES192GCM_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__GCM__MODE_F8
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES192__GCM__MODE_F8  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192F8GCM
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192F8GCM
operator|.
name|GCMH0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES192F8_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES192F8GCM_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__GCM__MODE_CTR_CFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES256__GCM__MODE_CTR_CFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256GCM
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256GCM
operator|.
name|GCMH0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES256_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES256GCM_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__GCM__MODE_ECB_CBC_OFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES256__GCM__MODE_ECB_CBC_OFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256GCM
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256GCM
operator|.
name|GCMH0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES256_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES256GCM_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__GCM__MODE_F8
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES256__GCM__MODE_F8  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256F8GCM
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256F8GCM
operator|.
name|GCMH0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES256F8_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES256F8GCM_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_F9
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_F9  \n"
argument_list|)
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoF9
operator|.
name|authKey0
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__F9
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_ARC4__F9\n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4F9
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4F9
operator|.
name|authKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|op
operator|->
name|rc4_key_len
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|ARC4F9_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__F9__STATE
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_ARC4__F9__STATE\n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4StateF9
operator|.
name|cipherKey0
expr_stmt|;
name|cipher_state
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4StateF9
operator|.
name|Arc4SboxData0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoARC4StateF9
operator|.
name|authKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|op
operator|->
name|rc4_key_len
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|ARC4StateF9_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_DES__F9__MODE_ECB_CBC
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|" XLR_SEC_VECTOR__CIPHER_DES__F9__MODE_ECB_CBC  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoDESF9
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoDESF9
operator|.
name|authKey0
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_DES_KEY_LENGTH
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|DESF9_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_3DES__F9__MODE_ECB_CBC
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_3DES__F9__MODE_ECB_CBC  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|info3DESF9
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|info3DESF9
operator|.
name|authKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_3DES_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|DES3F9_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__F9__MODE_CTR_CFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES128__F9__MODE_CTR_CFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128F9
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128F9
operator|.
name|authKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES128_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES128F9_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__F9__MODE_ECB_CBC_OFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|" XLR_SEC_VECTOR__CIPHER_AES128__F9__MODE_ECB_CBC_OFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128F9
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128F9
operator|.
name|authKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES128_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES128F9_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__F9__MODE_F8
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES128__F9__MODE_F8  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128F8F9
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES128F8F9
operator|.
name|authKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES128F8_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES128F8F9_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__F9__MODE_CTR_CFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES192__F9__MODE_CTR_CFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192F9
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192F9
operator|.
name|authKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES192_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES192F9_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__F9__MODE_ECB_CBC_OFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES192__F9__MODE_ECB_CBC_OFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192F9
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192F9
operator|.
name|authKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES192_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES192F9_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__F9__MODE_F8
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES192__F9__MODE_F8  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192F8F9
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES192F8F9
operator|.
name|authKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES192F8_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES192F8F9_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__F9__MODE_CTR_CFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES256__F9__MODE_CTR_CFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256F9
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256F9
operator|.
name|authKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES256_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES256F9_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__F9__MODE_ECB_CBC_OFB
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES256__F9__MODE_ECB_CBC_OFB  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256F9
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256F9
operator|.
name|authKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES256_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES256F9_t
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__F9__MODE_F8
case|:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"XLR_SEC_VECTOR__CIPHER_AES256__F9__MODE_F8  \n"
argument_list|)
expr_stmt|;
name|cipher_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256F8F9
operator|.
name|cipherKey0
expr_stmt|;
name|hmac_key
operator|=
operator|&
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|infoAES256F8F9
operator|.
name|authKey0
expr_stmt|;
name|cipher_keylen
operator|=
name|XLR_SEC_AES256F8_KEY_LENGTH
expr_stmt|;
name|hmac_keylen
operator|=
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
expr_stmt|;
name|ctl_size
operator|=
sizeof|sizeof
argument_list|(
name|AES256F8F9_t
argument_list|)
expr_stmt|;
break|break;
default|default:
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"default  \n"
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_CONTROL_VECTOR
return|;
block|}
if|if
condition|(
operator|(
name|cipher_key
operator|!=
name|NULL
operator|)
operator|&&
operator|!
operator|(
name|flags
operator|&
name|XLR_SEC_SETUP_OP_PRESERVE_CIPHER_KEY
operator|)
condition|)
name|memcpy
argument_list|(
name|cipher_key
argument_list|,
operator|&
name|op
operator|->
name|crypt_key
index|[
literal|0
index|]
argument_list|,
name|cipher_keylen
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|hmac_key
operator|!=
name|NULL
operator|)
operator|&&
operator|!
operator|(
name|flags
operator|&
name|XLR_SEC_SETUP_OP_PRESERVE_HMAC_KEY
operator|)
condition|)
name|memcpy
argument_list|(
name|hmac_key
argument_list|,
operator|&
name|op
operator|->
name|mac_key
index|[
literal|0
index|]
argument_list|,
name|hmac_keylen
argument_list|)
expr_stmt|;
if|if
condition|(
name|cipher_state
condition|)
block|{
if|if
condition|(
name|op
operator|->
name|rc4_loadstate
condition|)
name|memcpy
argument_list|(
name|cipher_state
argument_list|,
operator|(
name|void
operator|*
operator|)
operator|(
name|unsigned
name|long
operator|)
name|op
operator|->
name|rc4_state
argument_list|,
name|XLR_SEC_MAX_RC4_STATE_SIZE
argument_list|)
expr_stmt|;
if|if
condition|(
name|op
operator|->
name|rc4_savestate
condition|)
name|user
operator|->
name|aligned_state
operator|=
operator|(
name|char
operator|*
operator|)
name|cipher_state
expr_stmt|;
block|}
if|if
condition|(
name|flags
operator|&
name|XLR_SEC_SETUP_OP_FLIP_3DES_KEY
condition|)
block|{
name|uint64_t
name|temp
decl_stmt|;
name|temp
operator|=
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|info3DES
operator|.
name|cipherKey0
expr_stmt|;
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|info3DES
operator|.
name|cipherKey0
operator|=
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|info3DES
operator|.
name|cipherKey2
expr_stmt|;
name|ctl_desc
operator|->
name|cipherHashInfo
operator|.
name|info3DES
operator|.
name|cipherKey2
operator|=
name|temp
expr_stmt|;
block|}
comment|/* 	 * Control length is the number of control cachelines to be read so 	 * user needs to round up the control length to closest integer 	 * multiple of 32 bytes. 	 */
name|ctl_size
operator|+=
sizeof|sizeof
argument_list|(
name|ctl_desc
operator|->
name|instruction
argument_list|)
expr_stmt|;
name|ctl_len
operator|=
name|NUM_CHUNKS
argument_list|(
name|ctl_size
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"ctl_size in bytes: %u, in cachelines: %u\n"
argument_list|,
name|ctl_size
argument_list|,
name|ctl_len
argument_list|)
expr_stmt|;
name|CLEAR_SET_FIELD
argument_list|(
operator|*
name|control
argument_list|,
name|MSG_CMD_CTL_LEN
argument_list|,
name|ctl_len
argument_list|)
expr_stmt|;
name|ctl_addr
operator|=
operator|(
name|uint64_t
operator|)
name|vtophys
argument_list|(
name|ctl_desc
argument_list|)
expr_stmt|;
name|CLEAR_SET_FIELD
argument_list|(
operator|*
name|control
argument_list|,
name|MSG_CMD_CTL_ADDR
argument_list|,
name|ctl_addr
argument_list|)
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|" xlr_sec_control_setup():  ctl_desc=%p   ctl_addr=%llx \n"
argument_list|,
name|ctl_desc
argument_list|,
operator|(
name|unsigned
name|long
name|long
operator|)
name|ctl_addr
argument_list|)
expr_stmt|;
name|CLEAR_SET_FIELD
argument_list|(
operator|*
name|control
argument_list|,
name|MSG_CMD_CTL_CTL
argument_list|,
name|SEC_SOP
argument_list|)
expr_stmt|;
return|return
name|XLR_SEC_ERR_NONE
return|;
block|}
end_function

begin_function
name|xlr_sec_error_t
name|xlr_sec_submit_op
parameter_list|(
name|symkey_desc_pt
name|desc
parameter_list|)
block|{
name|struct
name|msgrng_msg
name|send_msg
decl_stmt|;
name|int
name|rsp_dest_id
decl_stmt|,
name|cpu
decl_stmt|,
name|hard_cpu
decl_stmt|,
name|hard_thread
decl_stmt|;
name|int
name|code
decl_stmt|,
name|retries
decl_stmt|;
name|unsigned
name|long
name|msgrng_flags
init|=
literal|0
decl_stmt|;
comment|/* threads (0-3) are orthogonal to buckets 0-3 */
name|cpu
operator|=
name|xlr_cpu_id
argument_list|()
expr_stmt|;
name|hard_cpu
operator|=
name|cpu
operator|>>
literal|2
expr_stmt|;
name|hard_thread
operator|=
name|cpu
operator|&
literal|0x3
expr_stmt|;
comment|/* thread id */
name|rsp_dest_id
operator|=
operator|(
name|hard_cpu
operator|<<
literal|3
operator|)
operator|+
name|hard_thread
expr_stmt|;
name|desc
operator|->
name|op_ctl
operator|.
name|cpu
operator|=
name|hard_cpu
expr_stmt|;
name|desc
operator|->
name|op_ctl
operator|.
name|flags
operator|=
literal|0
expr_stmt|;
comment|/* called from kernel thread */
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"[%s]:%d:  cpu=0x%x  hard_cpu=0x%x  hard_thrd=0x%x  id=0x%x \n"
argument_list|,
name|__FUNCTION__
argument_list|,
name|__LINE__
argument_list|,
name|cpu
argument_list|,
name|hard_cpu
argument_list|,
name|hard_thread
argument_list|,
name|rsp_dest_id
argument_list|)
expr_stmt|;
comment|/* 	 * Set DestId in Message Control Word. This tells the Security 	 * Engine which bucket to send the reply to for this CPU 	 */
name|CLEAR_SET_FIELD
argument_list|(
name|desc
operator|->
name|control
argument_list|,
name|MSG_CMD_CTL_ID
argument_list|,
name|rsp_dest_id
argument_list|)
expr_stmt|;
name|CLEAR_SET_FIELD
argument_list|(
name|desc
operator|->
name|data
argument_list|,
name|MSG_CMD_CTL_ID
argument_list|,
name|rsp_dest_id
argument_list|)
expr_stmt|;
name|CLEAR_SET_FIELD
argument_list|(
name|desc
operator|->
name|control
argument_list|,
name|MSG_CTL_OP_TYPE
argument_list|,
name|MSG0_CTL_OP_ENGINE_SYMKEY
argument_list|)
expr_stmt|;
name|CLEAR_SET_FIELD
argument_list|(
name|desc
operator|->
name|data
argument_list|,
name|MSG_CTL_OP_TYPE
argument_list|,
name|MSG1_CTL_OP_SYMKEY_PIPE0
argument_list|)
expr_stmt|;
name|send_msg
operator|.
name|msg0
operator|=
name|desc
operator|->
name|control
operator||
operator|(
literal|1ULL
operator|<<
literal|53
operator|)
expr_stmt|;
name|send_msg
operator|.
name|msg1
operator|=
name|desc
operator|->
name|data
operator||
operator|(
literal|1ULL
operator|<<
literal|53
operator|)
operator||
operator|(
literal|1ULL
operator|<<
literal|52
operator|)
expr_stmt|;
name|send_msg
operator|.
name|msg2
operator|=
name|send_msg
operator|.
name|msg3
operator|=
literal|0
expr_stmt|;
name|desc
operator|->
name|op_ctl
operator|.
name|flags
operator|=
literal|1
expr_stmt|;
comment|//in_interrupt();	/* ipsec softirq ? */
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"[%s]: IN_IRQ=%d  msg0=0x%llx  msg1=0x%llx \n"
argument_list|,
name|__FUNCTION__
argument_list|,
name|desc
operator|->
name|op_ctl
operator|.
name|flags
argument_list|,
name|send_msg
operator|.
name|msg0
argument_list|,
name|send_msg
operator|.
name|msg1
argument_list|)
expr_stmt|;
name|retries
operator|=
literal|100
expr_stmt|;
while|while
condition|(
name|retries
operator|--
condition|)
block|{
name|msgrng_flags_save
argument_list|(
name|msgrng_flags
argument_list|)
expr_stmt|;
name|code
operator|=
name|message_send_retry
argument_list|(
name|SEC_MSGRING_WORDSIZE
argument_list|,
name|MSGRNG_CODE_SEC
argument_list|,
name|desc
operator|->
name|op_ctl
operator|.
name|stn_id
argument_list|,
operator|&
name|send_msg
argument_list|)
expr_stmt|;
name|msgrng_flags_restore
argument_list|(
name|msgrng_flags
argument_list|)
expr_stmt|;
if|if
condition|(
name|code
operator|==
literal|0
condition|)
break|break;
block|}
return|return
operator|(
name|XLR_SEC_ERR_NONE
operator|)
return|;
block|}
end_function

begin_function
name|symkey_desc_pt
name|xlr_sec_allocate_desc
parameter_list|(
name|void
modifier|*
name|session_ptr
parameter_list|)
block|{
name|uint64_t
name|addr
decl_stmt|;
name|symkey_desc_pt
name|aligned
decl_stmt|,
name|new
decl_stmt|;
name|new
operator|=
operator|(
name|symkey_desc_pt
operator|)
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
name|symkey_desc_t
argument_list|)
argument_list|,
name|M_DEVBUF
argument_list|,
name|M_NOWAIT
operator||
name|M_ZERO
argument_list|)
expr_stmt|;
if|if
condition|(
name|new
operator|==
name|NULL
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
name|new
operator|->
name|ses
operator|=
name|session_ptr
expr_stmt|;
name|new
operator|->
name|user
operator|.
name|kern_src
operator|=
name|new
operator|->
name|user
operator|.
name|aligned_src
operator|=
operator|(
name|uint8_t
operator|*
operator|)
name|contigmalloc
argument_list|(
literal|256
operator|*
literal|1024
operator|+
literal|1024
argument_list|,
name|M_DEVBUF
argument_list|,
name|M_NOWAIT
operator||
name|M_ZERO
argument_list|,
literal|0
argument_list|,
literal|0xffffffff
argument_list|,
name|XLR_CACHELINE_SIZE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|new
operator|->
name|user
operator|.
name|kern_src
operator|==
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"ERROR - malloc failed for user.kern_src\n"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|new
operator|->
name|user
operator|.
name|aligned_dest
operator|=
name|new
operator|->
name|user
operator|.
name|kern_dest
operator|=
operator|(
name|uint8_t
operator|*
operator|)
name|contigmalloc
argument_list|(
literal|257
operator|*
literal|1024
argument_list|,
name|M_DEVBUF
argument_list|,
name|M_NOWAIT
operator||
name|M_ZERO
argument_list|,
literal|0
argument_list|,
literal|0xffffffff
argument_list|,
name|XLR_CACHELINE_SIZE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|new
operator|->
name|user
operator|.
name|aligned_dest
operator|==
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"ERROR - malloc failed for user.aligned_dest\n"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|new
operator|->
name|next_src_buf
operator|=
operator|(
name|uint8_t
operator|*
operator|)
name|contigmalloc
argument_list|(
literal|256
operator|*
literal|1024
operator|+
literal|1024
argument_list|,
name|M_DEVBUF
argument_list|,
name|M_NOWAIT
operator||
name|M_ZERO
argument_list|,
literal|0
argument_list|,
literal|0xffffffff
argument_list|,
name|XLR_CACHELINE_SIZE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|new
operator|->
name|next_src_buf
operator|==
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"ERROR - malloc failed for next_src_buf\n"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|new
operator|->
name|next_dest_buf
operator|=
operator|(
name|uint8_t
operator|*
operator|)
name|contigmalloc
argument_list|(
literal|257
operator|*
literal|1024
argument_list|,
name|M_DEVBUF
argument_list|,
name|M_NOWAIT
operator||
name|M_ZERO
argument_list|,
literal|0
argument_list|,
literal|0xffffffff
argument_list|,
name|XLR_CACHELINE_SIZE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|new
operator|->
name|next_dest_buf
operator|==
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"ERROR - malloc failed for next_dest_buf\n"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|new
operator|->
name|user
operator|.
name|kern_auth
operator|=
name|new
operator|->
name|user
operator|.
name|user_auth
operator|=
name|NULL
expr_stmt|;
name|new
operator|->
name|user
operator|.
name|aligned_auth
operator|=
name|new
operator|->
name|user
operator|.
name|user_auth
operator|=
name|NULL
expr_stmt|;
comment|/* find cacheline alignment */
name|aligned
operator|=
name|new
expr_stmt|;
name|addr
operator|=
operator|(
name|uint64_t
operator|)
name|vtophys
argument_list|(
name|new
argument_list|)
expr_stmt|;
comment|/* save for free */
name|aligned
operator|->
name|alloc
operator|=
name|new
expr_stmt|;
comment|/* setup common control info */
name|aligned
operator|->
name|op_ctl
operator|.
name|phys_self
operator|=
name|addr
expr_stmt|;
name|aligned
operator|->
name|op_ctl
operator|.
name|stn_id
operator|=
name|MSGRNG_STNID_SEC0
expr_stmt|;
return|return
operator|(
name|aligned
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|xlr_sec_free_desc
parameter_list|(
name|symkey_desc_pt
name|desc
parameter_list|)
block|{
if|if
condition|(
operator|(
name|desc
operator|==
name|NULL
operator|)
operator|||
operator|(
name|desc
operator|->
name|alloc
operator|==
name|NULL
operator|)
condition|)
block|{
name|printf
argument_list|(
literal|"%s:  NULL descriptor \n"
argument_list|,
name|__FUNCTION__
argument_list|)
expr_stmt|;
return|return;
block|}
name|contigfree
argument_list|(
name|desc
argument_list|,
sizeof|sizeof
argument_list|(
name|symkey_desc_t
argument_list|)
argument_list|,
name|M_DEVBUF
argument_list|)
expr_stmt|;
return|return;
block|}
end_function

begin_function
name|void
name|print_buf
parameter_list|(
name|char
modifier|*
name|desc
parameter_list|,
name|void
modifier|*
name|data
parameter_list|,
name|int
name|len
parameter_list|)
block|{
name|uint8_t
modifier|*
name|dp
decl_stmt|;
name|int
name|i
decl_stmt|;
name|DPRINT
argument_list|(
literal|"%s: "
argument_list|,
name|desc
argument_list|)
expr_stmt|;
comment|/* newline done in for-loop */
name|dp
operator|=
name|data
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
name|i
operator|++
operator|,
name|dp
operator|++
control|)
block|{
if|if
condition|(
operator|(
name|i
operator|%
literal|16
operator|)
operator|==
literal|0
condition|)
name|DPRINT
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|" %c%c"
argument_list|,
name|nib2hex
index|[
operator|(
operator|(
operator|(
operator|*
name|dp
operator|)
operator|&
literal|0xf0
operator|)
operator|>>
literal|4
operator|)
index|]
argument_list|,
name|nib2hex
index|[
operator|(
operator|(
operator|*
name|dp
operator|)
operator|&
literal|0x0f
operator|)
index|]
argument_list|)
expr_stmt|;
block|}
name|DPRINT
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|XLR_SEC_CMD_DEBUG
end_ifdef

begin_function
specifier|static
name|void
name|decode_symkey_desc
parameter_list|(
name|symkey_desc_pt
name|desc
parameter_list|,
name|uint32_t
name|cfg_vector
parameter_list|)
block|{
name|unsigned
name|long
name|long
name|word
decl_stmt|;
comment|/* uint8_t   *info; */
comment|/* int i; */
name|DPRINT
argument_list|(
literal|"MSG - CTL: \n"
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t CTRL      = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|desc
operator|->
name|control
argument_list|,
name|MSG_CMD_CTL_CTL
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t CTRL LEN  = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|desc
operator|->
name|control
argument_list|,
name|MSG_CMD_CTL_LEN
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t CTRL ADDR = %llx \n\n"
argument_list|,
name|GET_FIELD
argument_list|(
name|desc
operator|->
name|control
argument_list|,
name|MSG_CMD_CTL_ADDR
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"MSG - DATA: \n"
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t CTRL      = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|desc
operator|->
name|data
argument_list|,
name|MSG_CMD_DATA_CTL
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t DATA LEN  = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|desc
operator|->
name|data
argument_list|,
name|MSG_CMD_DATA_LEN
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t DATA ADDR = %llx \n\n"
argument_list|,
name|GET_FIELD
argument_list|(
name|desc
operator|->
name|data
argument_list|,
name|MSG_CMD_DATA_ADDR
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"CONTROL DESCRIPTOR: \n"
argument_list|)
expr_stmt|;
name|word
operator|=
name|desc
operator|->
name|ctl_desc
operator|.
name|instruction
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\tINSTRUCTION:   %llx\n"
argument_list|,
name|word
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tOVERRIDE CIPH = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_OVERRIDECIPHER
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tARC4 WAIT     = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_ARC4_WAIT4SAVE
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tARC4 SAVE     = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_ARC4_SAVESTATE
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tARC4 LOAD     = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_ARC4_LOADSTATE
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tARC4 KEYLEN   = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_ARC4_KEYLEN
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tCIPHER        = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_CPHR
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tCIPHER MODE   = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_MODE
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tINIT CIPHER   = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_ICPHR
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tHMAC          = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_HMAC
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tHASH ALG      = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_HASH
argument_list|)
operator||
operator|(
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_HASHHI
argument_list|)
operator|<<
literal|2
operator|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tINIT HASH     = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_IHASH
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tCHKSUM        = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_CKSUM
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\tCIPHER HASH INFO: \n"
argument_list|)
expr_stmt|;
if|#
directive|if
literal|0
block|info = (uint8_t *)& desc->ctl_desc->cipherHashInfo; 	for (i = 0; i< sizeof(CipherHashInfo_t); i++, info++) { 		DPRINT(" %02x", *info); 		if (i&& (i % 16) == 0) 			DPRINT("\n"); 	} 	DPRINT("\n\n");
endif|#
directive|endif
switch|switch
condition|(
name|cfg_vector
condition|)
block|{
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR_CIPHER_ARC4 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"ARC4 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4
operator|.
name|cipherKey0
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_ARC4_KEYLEN
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__HMAC
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR_CIPHER_ARC4__HMAC \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"ARC4 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4HMAC
operator|.
name|cipherKey0
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_ARC4_KEYLEN
argument_list|)
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4HMAC
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__STATE
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR_CIPHER_ARC4__STATE \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"ARC4 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4State
operator|.
name|cipherKey0
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_ARC4_KEYLEN
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__HMAC__STATE
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR_CIPHER_ARC4__HMAC__STATE \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"ARC4 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4StateHMAC
operator|.
name|cipherKey0
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_ARC4_KEYLEN
argument_list|)
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4StateHMAC
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_KASUMI_F8
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR_CIPHER_KASUMI_F8 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"KASUMI_F8 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoKASUMIF8
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_KASUMI_F8_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_KASUMI_F8__HMAC
case|:
name|DPRINT
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_KASUMI_F8__HMAC\n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"KASUMI_F8 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoKASUMIF8HMAC
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_KASUMI_F8_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoKASUMIF8HMAC
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_KASUMI_F8__HMAC2
case|:
name|DPRINT
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_KASUMI_F8__HMAC2\n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"KASUMI_F8 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoKASUMIF8HMAC2
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_KASUMI_F8_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC2 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoKASUMIF8HMAC2
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_KASUMI_F8__GCM
case|:
name|DPRINT
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_KASUMI_F8__GCM\n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"KASUMI_F8 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoKASUMIF8GCM
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_KASUMI_F8_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"GCM Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoKASUMIF8GCM
operator|.
name|GCMH0
argument_list|,
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_KASUMI_F8__F9
case|:
name|DPRINT
argument_list|(
literal|"XLR_SEC_VECTOR_CIPHER_KASUMI_F8__F9\n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"KASUMI_F8 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoKASUMIF8F9
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_KASUMI_F8_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"F9 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoKASUMIF8F9
operator|.
name|authKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_MAC
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR_MAC \n"
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"MAC-ONLY - No Info\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_HMAC
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR_HMAC \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoHMAC
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_DES__HMAC__MODE_ECB_CBC
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_DES__HMAC__MODE_ECB_CBC \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoDESHMAC
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_DES_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoDESHMAC
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_DES__MODE_ECB_CBC
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_DES__MODE_ECB_CBC \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoDES
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_DES_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_3DES__HMAC__MODE_ECB_CBC
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_3DES__HMAC__MODE_ECB_CBC \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|info3DESHMAC
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_3DES_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|info3DESHMAC
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_3DES__MODE_ECB_CBC
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_3DES__MODE_ECB_CBC \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|info3DES
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_3DES_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__HMAC__MODE_CTR_CFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES128__HMAC__MODE_CTR_CFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128HMAC
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES128_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128HMAC
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__MODE_CTR_CFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES128__MODE_CTR_CFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES128_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__HMAC__MODE_ECB_CBC_OFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES128__HMAC__MODE_ECB_CBC_OFB\n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128HMAC
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES128_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128HMAC
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__MODE_ECB_CBC_OFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES128__MODE_ECB_CBC_OFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES128_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__HMAC__MODE_CTR_CFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES192__HMAC__MODE_CTR_CFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192HMAC
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES192_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192HMAC
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__MODE_CTR_CFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES192__MODE_CTR_CFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES192_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__HMAC__MODE_ECB_CBC_OFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES192__HMAC__MODE_ECB_CBC_OFB\n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192HMAC
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES192_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192HMAC
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__MODE_ECB_CBC_OFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES192__MODE_ECB_CBC_OFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES192_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__HMAC__MODE_CTR_CFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES256__HMAC__MODE_CTR_CFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256HMAC
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES256_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256HMAC
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__MODE_CTR_CFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES256__MODE_CTR_CFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES256_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__HMAC__MODE_ECB_CBC_OFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES256__HMAC__MODE_ECB_CBC_OFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256HMAC
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES256_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256HMAC
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__MODE_ECB_CBC_OFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES256__MODE_ECB_CBC_OFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES256_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__HMAC2
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR_CIPHER_ARC4__HMAC2 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"ARC4 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4HMAC2
operator|.
name|cipherKey0
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_ARC4_KEYLEN
argument_list|)
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC2 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4HMAC2
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__HMAC2__STATE
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR_CIPHER_ARC4__HMAC2__STATE \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"ARC4 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4StateHMAC2
operator|.
name|cipherKey0
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_ARC4_KEYLEN
argument_list|)
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC2 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4StateHMAC2
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_HMAC2
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR_HMAC2 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC2 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoHMAC2
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_DES__HMAC2__MODE_ECB_CBC
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_DES__HMAC2__MODE_ECB_CBC \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoDESHMAC2
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_DES_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC2 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoDESHMAC2
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_3DES__HMAC2__MODE_ECB_CBC
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_3DES__HMAC2__MODE_ECB_CBC \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|info3DESHMAC2
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_3DES_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC2 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|info3DESHMAC2
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__HMAC2__MODE_CTR_CFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES128__HMAC2__MODE_CTR_CFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128HMAC2
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES128_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC2 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128HMAC2
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__HMAC2__MODE_ECB_CBC_OFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES128__HMAC2__MODE_ECB_CBC_OFB\n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128HMAC2
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES128_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC2 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128HMAC2
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__HMAC2__MODE_CTR_CFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES192__HMAC2__MODE_CTR_CFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192HMAC2
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES192_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC2 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192HMAC2
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__HMAC2__MODE_ECB_CBC_OFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES192__HMAC2__MODE_ECB_CBC_OFB\n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192HMAC2
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES192_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC2 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192HMAC2
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__HMAC2__MODE_CTR_CFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES256__HMAC2__MODE_CTR_CFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256HMAC2
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES256_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC2 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256HMAC2
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__HMAC2__MODE_ECB_CBC_OFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES256__HMAC2__MODE_ECB_CBC_OFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256HMAC2
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES256_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC2 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256HMAC2
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__GCM
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR_CIPHER_ARC4__GCM \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"ARC4 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4GCM
operator|.
name|cipherKey0
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_ARC4_KEYLEN
argument_list|)
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"GCM Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4GCM
operator|.
name|GCMH0
argument_list|,
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__GCM__STATE
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR_CIPHER_ARC4__GCM__STATE \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"ARC4 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4StateGCM
operator|.
name|cipherKey0
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_ARC4_KEYLEN
argument_list|)
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"GCM Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4StateGCM
operator|.
name|GCMH0
argument_list|,
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_GCM
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR_GCM \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"GCM Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoGCM
operator|.
name|GCMH0
argument_list|,
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_DES__GCM__MODE_ECB_CBC
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_DES__GCM__MODE_ECB_CBC \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoDESGCM
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_DES_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"GCM Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoDESGCM
operator|.
name|GCMH0
argument_list|,
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_3DES__GCM__MODE_ECB_CBC
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_3DES__GCM__MODE_ECB_CBC \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|info3DESGCM
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_3DES_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"GCM Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|info3DESGCM
operator|.
name|GCMH0
argument_list|,
sizeof|sizeof
argument_list|(
name|GCM_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__GCM__MODE_CTR_CFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES128__GCM__MODE_CTR_CFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128GCM
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES128_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"GCM Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128GCM
operator|.
name|GCMH0
argument_list|,
name|XLR_SEC_AES128_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__GCM__MODE_ECB_CBC_OFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES128__GCM__MODE_ECB_CBC_OFB\n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128GCM
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES128_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"GCM Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128GCM
operator|.
name|GCMH0
argument_list|,
name|XLR_SEC_AES128_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__GCM__MODE_CTR_CFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES192__GCM__MODE_CTR_CFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192GCM
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES192_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"GCM Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192GCM
operator|.
name|GCMH0
argument_list|,
name|XLR_SEC_AES192_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__GCM__MODE_ECB_CBC_OFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES192__GCM__MODE_ECB_CBC_OFB\n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192GCM
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES192_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"GCM Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192GCM
operator|.
name|GCMH0
argument_list|,
name|XLR_SEC_AES192_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__GCM__MODE_CTR_CFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES256__GCM__MODE_CTR_CFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256GCM
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES256_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"GCM Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256GCM
operator|.
name|GCMH0
argument_list|,
name|XLR_SEC_AES256_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__GCM__MODE_ECB_CBC_OFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES256__GCM__MODE_ECB_CBC_OFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256GCM
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES256_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"GCM Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256GCM
operator|.
name|GCMH0
argument_list|,
name|XLR_SEC_AES256_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__F9
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR_CIPHER_ARC4__F9 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"ARC4 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4F9
operator|.
name|cipherKey0
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_ARC4_KEYLEN
argument_list|)
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"F9 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4F9
operator|.
name|authKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_CIPHER_ARC4__F9__STATE
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR_CIPHER_ARC4__F9__STATE \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"ARC4 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4StateF9
operator|.
name|cipherKey0
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|CTL_DSC_ARC4_KEYLEN
argument_list|)
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"F9 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoARC4StateF9
operator|.
name|authKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR_F9
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR_F9 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"F9 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoF9
operator|.
name|authKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_DES__F9__MODE_ECB_CBC
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_DES__F9__MODE_ECB_CBC \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoDESF9
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_DES_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"F9 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoDESF9
operator|.
name|authKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_3DES__F9__MODE_ECB_CBC
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_3DES__F9__MODE_ECB_CBC \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|info3DESF9
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_3DES_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"F9 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|info3DESF9
operator|.
name|authKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__F9__MODE_CTR_CFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES128__F9__MODE_CTR_CFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128F9
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES128_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"F9 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128F9
operator|.
name|authKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__F9__MODE_ECB_CBC_OFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES128__F9__MODE_ECB_CBC_OFB\n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128F9
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES128_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"F9 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128F9
operator|.
name|authKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__F9__MODE_CTR_CFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES192__F9__MODE_CTR_CFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192F9
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES192_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"F9 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192F9
operator|.
name|authKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__F9__MODE_ECB_CBC_OFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES192__F9__MODE_ECB_CBC_OFB\n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192F9
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES192_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"F9 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192F9
operator|.
name|authKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__F9__MODE_CTR_CFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES256__F9__MODE_CTR_CFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256F9
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES256_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"F9 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256F9
operator|.
name|authKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__F9__MODE_ECB_CBC_OFB
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES256__F9__MODE_ECB_CBC_OFB \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256F9
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES256_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"F9 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256F9
operator|.
name|authKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__HMAC__MODE_F8
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES128__HMAC__MODE_F8 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128F8HMAC
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES128F8_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128F8HMAC
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__MODE_F8
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES128__MODE_F8 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128F8
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES128F8_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__HMAC__MODE_F8
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES192__HMAC__MODE_F8 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192F8HMAC
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES192F8_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192F8HMAC
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__MODE_F8
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES192__MODE_F8 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192F8
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES192F8_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__HMAC__MODE_F8
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES256__HMAC__MODE_F8 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256F8HMAC
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES256F8_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256HMAC
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__MODE_F8
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES256__MODE_F8 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256F8
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES256F8_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__HMAC2__MODE_F8
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES128__HMAC2__MODE_F8 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128F8HMAC2
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES128F8_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC2 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128F8HMAC2
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__HMAC2__MODE_F8
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES192__HMAC2__MODE_F8 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192F8HMAC2
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES192F8_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC2 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192F8HMAC2
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__HMAC2__MODE_F8
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES256__HMAC2__MODE_F8 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256F8HMAC2
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES256F8_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"HMAC2 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256F8HMAC2
operator|.
name|hmacKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|HMAC2_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__GCM__MODE_F8
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES128__GCM__MODE_F8 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128F8GCM
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES128F8_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"GCM Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128GCM
operator|.
name|GCMH0
argument_list|,
name|XLR_SEC_AES128_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__GCM__MODE_F8
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES192__GCM__MODE_F8 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192F8GCM
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES192_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"GCM Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192F8GCM
operator|.
name|GCMH0
argument_list|,
name|XLR_SEC_AES192_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__GCM__MODE_F8
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES256__GCM__MODE_F8 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256F8GCM
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES256F8_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"GCM Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256F8GCM
operator|.
name|GCMH0
argument_list|,
name|XLR_SEC_AES256_KEY_LENGTH
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES128__F9__MODE_F8
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES128__F9__MODE_F8 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128F8F9
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES128F8_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"F9 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES128F8F9
operator|.
name|authKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES192__F9__MODE_F8
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES192__F9__MODE_F8 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192F8F9
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES192F8_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"F9 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES192F8F9
operator|.
name|authKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|XLR_SEC_VECTOR__CIPHER_AES256__F9__MODE_F8
case|:
name|DPRINT
argument_list|(
literal|"VECTOR:  XLR_SEC_VECTOR__CIPHER_AES256__F9__MODE_F8 \n"
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"CIPHER Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256F8F9
operator|.
name|cipherKey0
argument_list|,
name|XLR_SEC_AES256F8_KEY_LENGTH
argument_list|)
expr_stmt|;
name|print_buf
argument_list|(
literal|"F9 Key"
argument_list|,
operator|&
name|desc
operator|->
name|ctl_desc
operator|.
name|cipherHashInfo
operator|.
name|infoAES256F8F9
operator|.
name|authKey0
argument_list|,
sizeof|sizeof
argument_list|(
name|F9_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
default|default:
name|DPRINT
argument_list|(
literal|"VECTOR:  ???? \n"
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|">>>  WHAT THE HECK !!!<<< \n"
argument_list|)
expr_stmt|;
break|break;
block|}
name|DPRINT
argument_list|(
literal|"PACKET DESCRIPTOR: \n"
argument_list|)
expr_stmt|;
name|word
operator|=
name|desc
operator|->
name|pkt_desc
operator|.
name|srcLengthIVOffUseIVNext
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\tSrcLengthIVOffsetIVNext:   %llx\n"
argument_list|,
name|word
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tLoad HMAC         = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_LOADHMACKEY
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tPad Hash          = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_PADHASH
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tHash Byte Count   = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_HASHBYTES
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tNext              = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_NEXT
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tUse IV            = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_IV
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tIV Offset         = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_IVOFF
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tPacket Length     = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_PKTLEN
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tNLHMAC            = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_NLHMAC
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tBreak             = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_BREAK
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tWait              = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_WAIT
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tSegment Src Addr  = %llx \n"
argument_list|,
operator|(
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_SEGADDR
argument_list|)
operator|<<
literal|5
operator|)
operator|&
literal|0xffffffffffULL
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tSRTCP             = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_SRTCP
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tGlobal Src Offset = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_SEGOFFSET
argument_list|)
argument_list|)
expr_stmt|;
name|word
operator|=
name|desc
operator|->
name|pkt_desc
operator|.
name|dstDataSettings
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\tdstDataSettings:  %llx \n"
argument_list|,
name|word
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tArc4 Byte Count   = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_ARC4BYTECOUNT
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tSym Operation     = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_SYM_OP
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tCipher Offset     = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_CPHROFF
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tHash Offset       = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_HASHOFF
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tHash Source       = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_HASHSRC
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tChecksum Offset   = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_CKSUMOFF
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tChecksum Source   = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_CKSUMSRC
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tCipher Dest Addr  = %llx \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_CPHR_DST_ADDR
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tCipher Dest Dword = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_CPHR_DST_DWOFFSET
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tCipher Dest Offset= %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_CPHR_DST_OFFSET
argument_list|)
argument_list|)
expr_stmt|;
name|word
operator|=
name|desc
operator|->
name|pkt_desc
operator|.
name|authDstNonceLow
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\tauthDstNonceLow:  %llx \n"
argument_list|,
name|word
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tNonce Low 24      = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_NONCE_LOW
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tauthDst           = %llx \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_AUTH_DST_ADDR
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tCipher Offset High= %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_CIPH_OFF_HI
argument_list|)
argument_list|)
expr_stmt|;
name|word
operator|=
name|desc
operator|->
name|pkt_desc
operator|.
name|ckSumDstNonceHiCFBMaskLLWMask
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\tckSumDstNonceHiCFBMaskLLWMask:  %llx \n"
argument_list|,
name|word
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tHash Byte off     = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_HASH_BYTE_OFF
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tPacket Len bytes  = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_PKTLEN_BYTES
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tLast Long Word Mask = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_LASTWORD
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tCipher Dst Address  = %llx \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_CPHR_DST_ADDR
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\t\tGlobal Dst Offset  = %lld \n"
argument_list|,
name|GET_FIELD
argument_list|(
name|word
argument_list|,
name|PKT_DSC_CPHR_DST_OFFSET
argument_list|)
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"CFG_VECTOR = %04x\n"
argument_list|,
name|cfg_vector
argument_list|)
expr_stmt|;
name|DPRINT
argument_list|(
literal|"\n\n"
argument_list|)
expr_stmt|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* This function is called from an interrupt handler */
end_comment

begin_function
name|void
name|xlr_sec_msgring_handler
parameter_list|(
name|int
name|bucket
parameter_list|,
name|int
name|size
parameter_list|,
name|int
name|code
parameter_list|,
name|int
name|stid
parameter_list|,
name|struct
name|msgrng_msg
modifier|*
name|msg
parameter_list|,
name|void
modifier|*
name|data
parameter_list|)
block|{
name|uint64_t
name|error
decl_stmt|;
name|uint64_t
name|addr
decl_stmt|,
name|sec_eng
decl_stmt|,
name|sec_pipe
decl_stmt|;
name|xlr_sec_io_pt
name|op
init|=
name|NULL
decl_stmt|;
name|symkey_desc_pt
name|desc
init|=
name|NULL
decl_stmt|;
name|struct
name|xlr_sec_session
modifier|*
name|ses
init|=
name|NULL
decl_stmt|;
name|struct
name|xlr_sec_command
modifier|*
name|cmd
init|=
name|NULL
decl_stmt|;
if|if
condition|(
name|code
operator|!=
name|MSGRNG_CODE_SEC
condition|)
block|{
name|panic
argument_list|(
literal|"xlr_sec_msgring_handler: bad code = %d,"
literal|" expected code = %d\n"
argument_list|,
name|code
argument_list|,
name|MSGRNG_CODE_SEC
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|stid
operator|<
name|MSGRNG_STNID_SEC0
operator|)
operator|||
operator|(
name|stid
operator|>
name|MSGRNG_STNID_PK0
operator|)
condition|)
block|{
name|panic
argument_list|(
literal|"xlr_sec_msgring_handler: bad stn id = %d, expect %d - %d\n"
argument_list|,
name|stid
argument_list|,
name|MSGRNG_STNID_SEC0
argument_list|,
name|MSGRNG_STNID_PK0
argument_list|)
expr_stmt|;
block|}
comment|/* 	 * The Submit() operation encodes the engine and pipe in these two 	 * separate fields.  This allows use to verify the result type with 	 * the submitted operation type. 	 */
name|sec_eng
operator|=
name|GET_FIELD
argument_list|(
name|msg
operator|->
name|msg0
argument_list|,
name|MSG_CTL_OP_TYPE
argument_list|)
expr_stmt|;
name|sec_pipe
operator|=
name|GET_FIELD
argument_list|(
name|msg
operator|->
name|msg1
argument_list|,
name|MSG_CTL_OP_TYPE
argument_list|)
expr_stmt|;
name|error
operator|=
name|msg
operator|->
name|msg0
operator|>>
literal|40
operator|&
literal|0x1ff
expr_stmt|;
if|if
condition|(
name|error
condition|)
name|printf
argument_list|(
literal|"ctrl error = 0x%llx\n"
argument_list|,
name|error
argument_list|)
expr_stmt|;
name|error
operator|=
name|msg
operator|->
name|msg1
operator|>>
literal|40
operator|&
literal|0x1ff
expr_stmt|;
if|if
condition|(
name|error
condition|)
name|printf
argument_list|(
literal|"data error = 0x%llx\n"
argument_list|,
name|error
argument_list|)
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"[%s]:  eng=%lld  pipe=%lld\n"
argument_list|,
name|__FUNCTION__
argument_list|,
name|sec_eng
argument_list|,
name|sec_pipe
argument_list|)
expr_stmt|;
comment|/* Symmetric Key Operation ? */
if|if
condition|(
name|sec_eng
operator|==
name|MSG0_CTL_OP_ENGINE_SYMKEY
condition|)
block|{
comment|/* 		 * The data descriptor address allows us to associate the 		 * response with the submitted operation. Address is 40-bit 		 * cacheline aligned address. We need to zero bit 0-4 since 		 * they are used for the engine and pipe Id. 		 */
name|addr
operator|=
name|GET_FIELD
argument_list|(
name|msg
operator|->
name|msg1
argument_list|,
name|MSG_RSLT_DATA_DSC_ADDR
argument_list|)
expr_stmt|;
name|addr
operator|=
name|addr
operator|&
operator|~
operator|(
operator|(
literal|1
operator|<<
literal|5
operator|)
operator|-
literal|1
operator|)
expr_stmt|;
if|if
condition|(
operator|!
name|addr
condition|)
block|{
name|panic
argument_list|(
literal|"[%s:STNID_SEC]:  NULL symkey addr!\n"
argument_list|,
name|__FUNCTION__
argument_list|)
expr_stmt|;
block|}
comment|/* 		 * The adddress points to the data descriptor. The operation 		 * descriptor is defined with the 32-byte cacheline size in 		 * mind.  It allows the code to use this address to 		 * reference the symkey descriptor.   (ref:  xlr_sec_desc.h) 		 */
name|addr
operator|=
name|addr
operator|-
sizeof|sizeof
argument_list|(
name|OperationDescriptor_t
argument_list|)
expr_stmt|;
name|desc
operator|=
operator|(
name|symkey_desc_pt
operator|)
name|MIPS_PHYS_TO_KSEG0
argument_list|(
name|addr
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|desc
condition|)
block|{
name|printf
argument_list|(
literal|"\nerror : not getting desc back correctly \n"
argument_list|)
expr_stmt|;
name|panic
argument_list|(
literal|"[%s:STNID_SEC]:  NULL symkey data descriptor!\n"
argument_list|,
name|__FUNCTION__
argument_list|)
expr_stmt|;
block|}
name|ses
operator|=
operator|(
expr|struct
name|xlr_sec_session
operator|*
operator|)
name|desc
operator|->
name|ses
expr_stmt|;
if|if
condition|(
operator|!
name|ses
condition|)
block|{
name|printf
argument_list|(
literal|"\n error : not getting ses back correctly \n"
argument_list|)
expr_stmt|;
name|panic
argument_list|(
literal|"[%s:STNID_SEC]:  NULL symkey data descriptor!\n"
argument_list|,
name|__FUNCTION__
argument_list|)
expr_stmt|;
block|}
name|cmd
operator|=
operator|&
name|ses
operator|->
name|cmd
expr_stmt|;
if|if
condition|(
operator|!
name|cmd
condition|)
block|{
name|printf
argument_list|(
literal|"\n error : not getting cmd back correctly \n"
argument_list|)
expr_stmt|;
name|panic
argument_list|(
literal|"[%s:STNID_SEC]:  NULL symkey data descriptor!\n"
argument_list|,
name|__FUNCTION__
argument_list|)
expr_stmt|;
block|}
name|op
operator|=
operator|&
name|cmd
operator|->
name|op
expr_stmt|;
if|if
condition|(
operator|!
name|op
condition|)
block|{
name|printf
argument_list|(
literal|"\n error : not getting op back correctly \n"
argument_list|)
expr_stmt|;
name|panic
argument_list|(
literal|"[%s:STNID_SEC]:  NULL symkey data descriptor!\n"
argument_list|,
name|__FUNCTION__
argument_list|)
expr_stmt|;
block|}
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"[%s:STNID_SEC]:  addr=0x%llx  desc=%p  alloc=%p \n"
argument_list|,
name|__FUNCTION__
argument_list|,
name|addr
argument_list|,
name|desc
argument_list|,
name|desc
operator|->
name|alloc
argument_list|)
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"[%s:STNID_SEC]:  op_ctl=%p  phys_self=%llx  stn_id=%d \n"
argument_list|,
name|__FUNCTION__
argument_list|,
operator|&
name|desc
operator|->
name|op_ctl
argument_list|,
name|desc
operator|->
name|op_ctl
operator|.
name|phys_self
argument_list|,
name|desc
operator|->
name|op_ctl
operator|.
name|stn_id
argument_list|)
expr_stmt|;
if|if
condition|(
name|addr
operator|!=
name|desc
operator|->
name|op_ctl
operator|.
name|phys_self
condition|)
block|{
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"[%s:STNID_SEC]:  Control Descriptor fails Self-Verify !\n"
argument_list|,
name|__FUNCTION__
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"[%s:STNID_SEC]:  Control Descriptor fails Self-Verify !\n"
argument_list|,
name|__FUNCTION__
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"[%s:STNID_SEC]:  addr=0x%llx  desc=%p  alloc=%p \n"
argument_list|,
name|__FUNCTION__
argument_list|,
operator|(
name|unsigned
name|long
name|long
operator|)
name|addr
argument_list|,
name|desc
argument_list|,
name|desc
operator|->
name|alloc
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"[%s:STNID_SEC]:  op_ctl=%p  phys_self=%llx  stn_id=%d \n"
argument_list|,
name|__FUNCTION__
argument_list|,
operator|&
name|desc
operator|->
name|op_ctl
argument_list|,
operator|(
name|unsigned
name|long
name|long
operator|)
name|desc
operator|->
name|op_ctl
operator|.
name|phys_self
argument_list|,
name|desc
operator|->
name|op_ctl
operator|.
name|stn_id
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|desc
operator|->
name|op_ctl
operator|.
name|stn_id
operator|!=
name|MSGRNG_STNID_SEC0
operator|&&
name|desc
operator|->
name|op_ctl
operator|.
name|stn_id
operator|!=
name|MSGRNG_STNID_SEC1
condition|)
block|{
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"[%s:STNID_SEC]:  Operation Type Mismatch !\n"
argument_list|,
name|__FUNCTION__
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"[%s:STNID_SEC]:  Operation Type Mismatch !\n"
argument_list|,
name|__FUNCTION__
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"[%s:STNID_SEC]:  addr=0x%llx  desc=%p  alloc=%p \n"
argument_list|,
name|__FUNCTION__
argument_list|,
operator|(
name|unsigned
name|long
name|long
operator|)
name|addr
argument_list|,
name|desc
argument_list|,
name|desc
operator|->
name|alloc
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"[%s:STNID_SEC]:  op_ctl=%p  phys_self=%llx  stn_id=%d \n"
argument_list|,
name|__FUNCTION__
argument_list|,
operator|&
name|desc
operator|->
name|op_ctl
argument_list|,
operator|(
name|unsigned
name|long
name|long
operator|)
name|desc
operator|->
name|op_ctl
operator|.
name|phys_self
argument_list|,
name|desc
operator|->
name|op_ctl
operator|.
name|stn_id
argument_list|)
expr_stmt|;
block|}
name|desc
operator|->
name|ctl_result
operator|=
name|GET_FIELD
argument_list|(
name|msg
operator|->
name|msg0
argument_list|,
name|MSG_RSLT_CTL_INST_ERR
argument_list|)
expr_stmt|;
name|desc
operator|->
name|data_result
operator|=
name|GET_FIELD
argument_list|(
name|msg
operator|->
name|msg1
argument_list|,
name|MSG_RSLT_DATA_INST_ERR
argument_list|)
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"[%s:STNID_SEC]:  cpu=%d  ctl_result=0x%llx  data_result=%llx\n"
argument_list|,
name|__FUNCTION__
argument_list|,
name|desc
operator|->
name|op_ctl
operator|.
name|cpu
argument_list|,
name|desc
operator|->
name|ctl_result
argument_list|,
name|desc
operator|->
name|data_result
argument_list|)
expr_stmt|;
block|}
if|#
directive|if
literal|0
if|else if (sec_eng == MSG0_CTL_OP_ENGINE_PUBKEY) { 		pubkey_desc_pt desc;  		if (sec_pipe != MSG1_CTL_OP_PUBKEY_PIPE0) {
comment|/* response to uc load */
comment|/* 			 * XLR_SEC_CMD_DIAG("[%s:STNID_SEC]: ecc cpu=%d 			 * ctl_result=0x%llx  data_result=%llx\n", 			 * __FUNCTION__, desc->op_ctl.cpu, desc->ctl_result, 			 * desc->data_result); 			 */
if|return; 		}
comment|/* 		 * The data descriptor address allows us to associate the 		 * response with the submitted operation. Address is 40-bit 		 * cacheline aligned address. We need to zero bit 0-4 since 		 * they are used for the engine and pipe Id. 		 */
if|addr = GET_FIELD(msg->msg0, PUBKEY_RSLT_CTL_SRCADDR); 		addr = addr& ~((1<< 5) - 1); 		if (!addr) { 			panic("[%s:STNID_SEC]:  NULL pubkey ctrl desc!\n", __FUNCTION__); 		}
comment|/* 		 * The adddress points to the data descriptor. The operation 		 * descriptor is defined with the 32-byte cacheline size in 		 * mind.  It allows the code to use this address to 		 * reference the symkey descriptor.   (ref:  xlr_sec_desc.h) 		 */
if|addr = addr - sizeof(OperationDescriptor_t);
comment|/* Get pointer to pubkey Descriptor */
if|desc = (pubkey_desc_pt) (unsigned long)addr; 		if (!desc) { 			panic("[%s:STNID_SEC]:  NULL pubkey data descriptor!\n", __FUNCTION__); 		} 		XLR_SEC_CMD_DIAG("[%s:STNID_PK0]:  addr=0x%llx  desc=%p  alloc=%p \n", 		    __FUNCTION__, addr, desc, desc->alloc);  		XLR_SEC_CMD_DIAG("[%s:STNID_PK0]:  op_ctl=%p  phys_self=%llx  stn_id=%d \n", 		    __FUNCTION__,&desc->op_ctl, desc->op_ctl.phys_self, 		    desc->op_ctl.stn_id);  		if (addr != desc->op_ctl.phys_self) { 			XLR_SEC_CMD_DIAG("[%s:STNID_PK0]:  Control Descriptor fails Self-Verify !\n", 			    __FUNCTION__); 		} 		if (desc->op_ctl.stn_id != msgrng_stnid_pk0) { 			XLR_SEC_CMD_DIAG("[%s:STNID_PK0]:  Operation Type Mismatch ! \n", 			    __FUNCTION__); 		} 		desc->ctl_result = GET_FIELD(msg->msg0, PUBKEY_RSLT_CTL_ERROR); 		desc->data_result = GET_FIELD(msg->msg1, PUBKEY_RSLT_DATA_ERROR);  		XLR_SEC_CMD_DIAG("[%s:STNID_PK0]:  ctl_result=0x%llx  data_result=%llx\n", 		    __FUNCTION__, desc->ctl_result, desc->data_result);  	}
endif|#
directive|endif
else|else
block|{
name|printf
argument_list|(
literal|"[%s]: HANDLER  bad id = %d\n"
argument_list|,
name|__FUNCTION__
argument_list|,
name|stid
argument_list|)
expr_stmt|;
block|}
ifdef|#
directive|ifdef
name|RMI_SEC_DEBUG
if|if
condition|(
name|ses
operator|->
name|multi_frag_flag
condition|)
block|{
name|int
name|i
decl_stmt|;
name|char
modifier|*
name|ptr
decl_stmt|;
name|printf
argument_list|(
literal|"\n RETURNED DATA:  \n"
argument_list|)
expr_stmt|;
name|ptr
operator|=
operator|(
name|char
operator|*
operator|)
call|(
name|unsigned
name|long
call|)
argument_list|(
name|desc
operator|->
name|user
operator|.
name|aligned_dest
operator|+
name|cmd
operator|->
name|op
operator|.
name|cipher_offset
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|SEC_MAX_FRAG_LEN
condition|;
name|i
operator|++
control|)
block|{
name|printf
argument_list|(
literal|"%c  "
argument_list|,
operator|(
name|char
operator|)
operator|*
name|ptr
operator|++
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|i
operator|%
literal|10
operator|)
operator|==
literal|0
condition|)
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
name|printf
argument_list|(
literal|"second desc\n"
argument_list|)
expr_stmt|;
name|ptr
operator|=
operator|(
name|char
operator|*
operator|)
call|(
name|unsigned
name|long
call|)
argument_list|(
name|desc
operator|->
name|next_dest_buf
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|desc
operator|->
name|next_src_len
condition|;
name|i
operator|++
control|)
block|{
name|printf
argument_list|(
literal|"%c  "
argument_list|,
operator|(
name|char
operator|)
operator|*
name|ptr
operator|++
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|i
operator|%
literal|10
operator|)
operator|==
literal|0
condition|)
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
endif|#
directive|endif
comment|/* Copy cipher-data to User-space */
if|if
condition|(
name|op
operator|->
name|cipher_type
operator|!=
name|XLR_SEC_CIPHER_TYPE_NONE
condition|)
block|{
name|size
operator|=
name|op
operator|->
name|dest_buf_size
expr_stmt|;
comment|/* DEBUG -dpk */
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"cipher: to_addr=%p  from_addr=%p  size=%d \n"
argument_list|,
name|desc
operator|->
name|user
operator|.
name|user_dest
argument_list|,
name|desc
operator|->
name|user
operator|.
name|aligned_dest
argument_list|,
name|size
argument_list|)
expr_stmt|;
if|if
condition|(
name|ses
operator|->
name|multi_frag_flag
condition|)
block|{
name|crypto_copyback
argument_list|(
name|cmd
operator|->
name|crp
operator|->
name|crp_flags
argument_list|,
name|cmd
operator|->
name|crp
operator|->
name|crp_buf
argument_list|,
literal|0
argument_list|,
name|SEC_MAX_FRAG_LEN
argument_list|,
operator|(
name|caddr_t
operator|)
operator|(
name|long
operator|)
name|desc
operator|->
name|user
operator|.
name|aligned_dest
operator|+
name|op
operator|->
name|cipher_offset
argument_list|)
expr_stmt|;
name|crypto_copyback
argument_list|(
name|cmd
operator|->
name|crp
operator|->
name|crp_flags
argument_list|,
name|cmd
operator|->
name|crp
operator|->
name|crp_buf
operator|+
name|SEC_MAX_FRAG_LEN
argument_list|,
literal|0
argument_list|,
name|desc
operator|->
name|next_src_len
argument_list|,
operator|(
name|caddr_t
operator|)
operator|(
name|long
operator|)
name|desc
operator|->
name|next_dest_buf
argument_list|)
expr_stmt|;
name|crypto_done
argument_list|(
name|cmd
operator|->
name|crp
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|crypto_copyback
argument_list|(
name|cmd
operator|->
name|crp
operator|->
name|crp_flags
argument_list|,
name|cmd
operator|->
name|crp
operator|->
name|crp_buf
argument_list|,
literal|0
argument_list|,
name|cmd
operator|->
name|op
operator|.
name|dest_buf_size
argument_list|,
operator|(
name|caddr_t
operator|)
operator|(
name|long
operator|)
name|desc
operator|->
name|user
operator|.
name|aligned_dest
operator|+
name|op
operator|->
name|cipher_offset
argument_list|)
expr_stmt|;
name|crypto_done
argument_list|(
name|cmd
operator|->
name|crp
argument_list|)
expr_stmt|;
block|}
block|}
comment|/* Copy digest to User-space */
if|if
condition|(
name|op
operator|->
name|digest_type
operator|!=
name|XLR_SEC_DIGEST_TYPE_NONE
condition|)
block|{
name|int
name|offset
init|=
literal|0
decl_stmt|;
switch|switch
condition|(
name|op
operator|->
name|digest_type
condition|)
block|{
case|case
name|XLR_SEC_DIGEST_TYPE_MD5
case|:
name|size
operator|=
name|XLR_SEC_MD5_LENGTH
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_TYPE_SHA1
case|:
name|size
operator|=
name|XLR_SEC_SHA1_LENGTH
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_TYPE_SHA256
case|:
name|size
operator|=
name|XLR_SEC_SHA256_LENGTH
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_TYPE_SHA384
case|:
name|size
operator|=
name|XLR_SEC_SHA384_LENGTH
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_TYPE_SHA512
case|:
name|size
operator|=
name|XLR_SEC_SHA512_LENGTH
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_TYPE_GCM
case|:
name|size
operator|=
name|XLR_SEC_GCM_LENGTH
expr_stmt|;
break|break;
case|case
name|XLR_SEC_DIGEST_TYPE_KASUMI_F9
case|:
name|offset
operator|=
literal|4
expr_stmt|;
name|size
operator|=
name|XLR_SEC_KASUMI_F9_RESULT_LENGTH
expr_stmt|;
break|break;
default|default:
name|size
operator|=
literal|0
expr_stmt|;
block|}
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"digest:  to_addr=%p  from_addr=%p  size=%d \n"
argument_list|,
name|desc
operator|->
name|user
operator|.
name|user_auth
argument_list|,
name|desc
operator|->
name|user
operator|.
name|aligned_auth
argument_list|,
name|size
argument_list|)
expr_stmt|;
name|memcpy
argument_list|(
name|desc
operator|->
name|user
operator|.
name|user_auth
argument_list|,
name|desc
operator|->
name|user
operator|.
name|aligned_auth
operator|+
name|offset
argument_list|,
name|size
argument_list|)
expr_stmt|;
name|op
operator|->
name|auth_dest
operator|=
operator|(
name|uint64_t
operator|)
operator|(
name|unsigned
name|long
operator|)
name|desc
operator|->
name|user
operator|.
name|user_auth
expr_stmt|;
block|}
if|if
condition|(
name|op
operator|->
name|cipher_type
operator|==
name|XLR_SEC_CIPHER_TYPE_ARC4
operator|&&
name|op
operator|->
name|rc4_savestate
condition|)
block|{
name|size
operator|=
name|XLR_SEC_MAX_RC4_STATE_SIZE
expr_stmt|;
name|XLR_SEC_CMD_DIAG
argument_list|(
literal|"state:  to_addr=%p  from_addr=%p  size=%d \n"
argument_list|,
name|desc
operator|->
name|user
operator|.
name|user_state
argument_list|,
name|desc
operator|->
name|user
operator|.
name|aligned_state
argument_list|,
name|size
argument_list|)
expr_stmt|;
name|op
operator|->
name|rc4_state
operator|=
operator|(
name|uint64_t
operator|)
operator|(
name|unsigned
name|long
operator|)
name|desc
operator|->
name|user
operator|.
name|user_state
expr_stmt|;
block|}
return|return;
block|}
end_function

end_unit

