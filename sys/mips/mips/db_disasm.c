begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*	$OpenBSD: db_disasm.c,v 1.1 1998/03/16 09:03:24 pefo Exp $	*/
end_comment

begin_comment
comment|/*-  * SPDX-License-Identifier: BSD-4-Clause  *  * Copyright (c) 1991, 1993  *	The Regents of the University of California.  All rights reserved.  *  * This code is derived from software contributed to Berkeley by  * Ralph Campbell.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  * 3. All advertising materials mentioning features or use of this software  *    must display the following acknowledgement:  *	This product includes software developed by the University of  *	California, Berkeley and its contributors.  * 4. Neither the name of the University nor the names of its contributors  *    may be used to endorse or promote products derived from this software  *    without specific prior written permission.  *  * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  *  *	from: @(#)kadb.c	8.1 (Berkeley) 6/10/93  *	Id: db_disasm.c,v 1.1 1998/03/16 09:03:24 pefo Exp  *	JNPR: db_disasm.c,v 1.1 2006/08/07 05:38:57 katta  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<vm/vm_param.h>
end_include

begin_include
include|#
directive|include
file|<vm/vm.h>
end_include

begin_include
include|#
directive|include
file|<vm/pmap.h>
end_include

begin_include
include|#
directive|include
file|<sys/systm.h>
end_include

begin_include
include|#
directive|include
file|<machine/mips_opcode.h>
end_include

begin_include
include|#
directive|include
file|<machine/db_machdep.h>
end_include

begin_include
include|#
directive|include
file|<ddb/ddb.h>
end_include

begin_include
include|#
directive|include
file|<ddb/db_output.h>
end_include

begin_decl_stmt
specifier|static
name|char
modifier|*
name|op_name
index|[
literal|64
index|]
init|=
block|{
comment|/* 0 */
literal|"spec"
block|,
literal|"bcond"
block|,
literal|"j"
block|,
literal|"jal"
block|,
literal|"beq"
block|,
literal|"bne"
block|,
literal|"blez"
block|,
literal|"bgtz"
block|,
comment|/* 8 */
literal|"addi"
block|,
literal|"addiu"
block|,
literal|"slti"
block|,
literal|"sltiu"
block|,
literal|"andi"
block|,
literal|"ori"
block|,
literal|"xori"
block|,
literal|"lui"
block|,
comment|/*16 */
literal|"cop0"
block|,
literal|"cop1"
block|,
literal|"cop2"
block|,
literal|"cop3"
block|,
literal|"beql"
block|,
literal|"bnel"
block|,
literal|"blezl"
block|,
literal|"bgtzl"
block|,
comment|/*24 */
literal|"daddi"
block|,
literal|"daddiu"
block|,
literal|"ldl"
block|,
literal|"ldr"
block|,
literal|"op34"
block|,
literal|"op35"
block|,
literal|"op36"
block|,
literal|"op37"
block|,
comment|/*32 */
literal|"lb"
block|,
literal|"lh"
block|,
literal|"lwl"
block|,
literal|"lw"
block|,
literal|"lbu"
block|,
literal|"lhu"
block|,
literal|"lwr"
block|,
literal|"lwu"
block|,
comment|/*40 */
literal|"sb"
block|,
literal|"sh"
block|,
literal|"swl"
block|,
literal|"sw"
block|,
literal|"sdl"
block|,
literal|"sdr"
block|,
literal|"swr"
block|,
literal|"cache"
block|,
comment|/*48 */
literal|"ll"
block|,
literal|"lwc1"
block|,
literal|"lwc2"
block|,
literal|"lwc3"
block|,
literal|"lld"
block|,
literal|"ldc1"
block|,
literal|"ldc2"
block|,
literal|"ld"
block|,
comment|/*56 */
literal|"sc"
block|,
literal|"swc1"
block|,
literal|"swc2"
block|,
literal|"swc3"
block|,
literal|"scd"
block|,
literal|"sdc1"
block|,
literal|"sdc2"
block|,
literal|"sd"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|spec_name
index|[
literal|64
index|]
init|=
block|{
comment|/* 0 */
literal|"sll"
block|,
literal|"spec01"
block|,
literal|"srl"
block|,
literal|"sra"
block|,
literal|"sllv"
block|,
literal|"spec05"
block|,
literal|"srlv"
block|,
literal|"srav"
block|,
comment|/* 8 */
literal|"jr"
block|,
literal|"jalr"
block|,
literal|"spec12"
block|,
literal|"spec13"
block|,
literal|"syscall"
block|,
literal|"break"
block|,
literal|"spec16"
block|,
literal|"sync"
block|,
comment|/*16 */
literal|"mfhi"
block|,
literal|"mthi"
block|,
literal|"mflo"
block|,
literal|"mtlo"
block|,
literal|"dsllv"
block|,
literal|"spec25"
block|,
literal|"dsrlv"
block|,
literal|"dsrav"
block|,
comment|/*24 */
literal|"mult"
block|,
literal|"multu"
block|,
literal|"div"
block|,
literal|"divu"
block|,
literal|"dmult"
block|,
literal|"dmultu"
block|,
literal|"ddiv"
block|,
literal|"ddivu"
block|,
comment|/*32 */
literal|"add"
block|,
literal|"addu"
block|,
literal|"sub"
block|,
literal|"subu"
block|,
literal|"and"
block|,
literal|"or"
block|,
literal|"xor"
block|,
literal|"nor"
block|,
comment|/*40 */
literal|"spec50"
block|,
literal|"spec51"
block|,
literal|"slt"
block|,
literal|"sltu"
block|,
literal|"dadd"
block|,
literal|"daddu"
block|,
literal|"dsub"
block|,
literal|"dsubu"
block|,
comment|/*48 */
literal|"tge"
block|,
literal|"tgeu"
block|,
literal|"tlt"
block|,
literal|"tltu"
block|,
literal|"teq"
block|,
literal|"spec65"
block|,
literal|"tne"
block|,
literal|"spec67"
block|,
comment|/*56 */
literal|"dsll"
block|,
literal|"spec71"
block|,
literal|"dsrl"
block|,
literal|"dsra"
block|,
literal|"dsll32"
block|,
literal|"spec75"
block|,
literal|"dsrl32"
block|,
literal|"dsra32"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|bcond_name
index|[
literal|32
index|]
init|=
block|{
comment|/* 0 */
literal|"bltz"
block|,
literal|"bgez"
block|,
literal|"bltzl"
block|,
literal|"bgezl"
block|,
literal|"?"
block|,
literal|"?"
block|,
literal|"?"
block|,
literal|"?"
block|,
comment|/* 8 */
literal|"tgei"
block|,
literal|"tgeiu"
block|,
literal|"tlti"
block|,
literal|"tltiu"
block|,
literal|"teqi"
block|,
literal|"?"
block|,
literal|"tnei"
block|,
literal|"?"
block|,
comment|/*16 */
literal|"bltzal"
block|,
literal|"bgezal"
block|,
literal|"bltzall"
block|,
literal|"bgezall"
block|,
literal|"?"
block|,
literal|"?"
block|,
literal|"?"
block|,
literal|"?"
block|,
comment|/*24 */
literal|"?"
block|,
literal|"?"
block|,
literal|"?"
block|,
literal|"?"
block|,
literal|"?"
block|,
literal|"?"
block|,
literal|"?"
block|,
literal|"?"
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|cop1_name
index|[
literal|64
index|]
init|=
block|{
comment|/* 0 */
literal|"fadd"
block|,
literal|"fsub"
block|,
literal|"fmpy"
block|,
literal|"fdiv"
block|,
literal|"fsqrt"
block|,
literal|"fabs"
block|,
literal|"fmov"
block|,
literal|"fneg"
block|,
comment|/* 8 */
literal|"fop08"
block|,
literal|"fop09"
block|,
literal|"fop0a"
block|,
literal|"fop0b"
block|,
literal|"fop0c"
block|,
literal|"fop0d"
block|,
literal|"fop0e"
block|,
literal|"fop0f"
block|,
comment|/*16 */
literal|"fop10"
block|,
literal|"fop11"
block|,
literal|"fop12"
block|,
literal|"fop13"
block|,
literal|"fop14"
block|,
literal|"fop15"
block|,
literal|"fop16"
block|,
literal|"fop17"
block|,
comment|/*24 */
literal|"fop18"
block|,
literal|"fop19"
block|,
literal|"fop1a"
block|,
literal|"fop1b"
block|,
literal|"fop1c"
block|,
literal|"fop1d"
block|,
literal|"fop1e"
block|,
literal|"fop1f"
block|,
comment|/*32 */
literal|"fcvts"
block|,
literal|"fcvtd"
block|,
literal|"fcvte"
block|,
literal|"fop23"
block|,
literal|"fcvtw"
block|,
literal|"fop25"
block|,
literal|"fop26"
block|,
literal|"fop27"
block|,
comment|/*40 */
literal|"fop28"
block|,
literal|"fop29"
block|,
literal|"fop2a"
block|,
literal|"fop2b"
block|,
literal|"fop2c"
block|,
literal|"fop2d"
block|,
literal|"fop2e"
block|,
literal|"fop2f"
block|,
comment|/*48 */
literal|"fcmp.f"
block|,
literal|"fcmp.un"
block|,
literal|"fcmp.eq"
block|,
literal|"fcmp.ueq"
block|,
literal|"fcmp.olt"
block|,
literal|"fcmp.ult"
block|,
literal|"fcmp.ole"
block|,
literal|"fcmp.ule"
block|,
comment|/*56 */
literal|"fcmp.sf"
block|,
literal|"fcmp.ngle"
block|,
literal|"fcmp.seq"
block|,
literal|"fcmp.ngl"
block|,
literal|"fcmp.lt"
block|,
literal|"fcmp.nge"
block|,
literal|"fcmp.le"
block|,
literal|"fcmp.ngt"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|fmt_name
index|[
literal|16
index|]
init|=
block|{
literal|"s"
block|,
literal|"d"
block|,
literal|"e"
block|,
literal|"fmt3"
block|,
literal|"w"
block|,
literal|"fmt5"
block|,
literal|"fmt6"
block|,
literal|"fmt7"
block|,
literal|"fmt8"
block|,
literal|"fmt9"
block|,
literal|"fmta"
block|,
literal|"fmtb"
block|,
literal|"fmtc"
block|,
literal|"fmtd"
block|,
literal|"fmte"
block|,
literal|"fmtf"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|reg_name
index|[
literal|32
index|]
init|=
block|{
literal|"zero"
block|,
literal|"at"
block|,
literal|"v0"
block|,
literal|"v1"
block|,
literal|"a0"
block|,
literal|"a1"
block|,
literal|"a2"
block|,
literal|"a3"
block|,
if|#
directive|if
name|defined
argument_list|(
name|__mips_n32
argument_list|)
operator|||
name|defined
argument_list|(
name|__mips_n64
argument_list|)
literal|"a4"
block|,
literal|"a5"
block|,
literal|"a6"
block|,
literal|"a7"
block|,
literal|"t0"
block|,
literal|"t1"
block|,
literal|"t2"
block|,
literal|"t3"
block|,
else|#
directive|else
literal|"t0"
block|,
literal|"t1"
block|,
literal|"t2"
block|,
literal|"t3"
block|,
literal|"t4"
block|,
literal|"t5"
block|,
literal|"t6"
block|,
literal|"t7"
block|,
endif|#
directive|endif
literal|"s0"
block|,
literal|"s1"
block|,
literal|"s2"
block|,
literal|"s3"
block|,
literal|"s4"
block|,
literal|"s5"
block|,
literal|"s6"
block|,
literal|"s7"
block|,
literal|"t8"
block|,
literal|"t9"
block|,
literal|"k0"
block|,
literal|"k1"
block|,
literal|"gp"
block|,
literal|"sp"
block|,
literal|"s8"
block|,
literal|"ra"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|c0_opname
index|[
literal|64
index|]
init|=
block|{
literal|"c0op00"
block|,
literal|"tlbr"
block|,
literal|"tlbwi"
block|,
literal|"c0op03"
block|,
literal|"c0op04"
block|,
literal|"c0op05"
block|,
literal|"tlbwr"
block|,
literal|"c0op07"
block|,
literal|"tlbp"
block|,
literal|"c0op11"
block|,
literal|"c0op12"
block|,
literal|"c0op13"
block|,
literal|"c0op14"
block|,
literal|"c0op15"
block|,
literal|"c0op16"
block|,
literal|"c0op17"
block|,
literal|"rfe"
block|,
literal|"c0op21"
block|,
literal|"c0op22"
block|,
literal|"c0op23"
block|,
literal|"c0op24"
block|,
literal|"c0op25"
block|,
literal|"c0op26"
block|,
literal|"c0op27"
block|,
literal|"eret"
block|,
literal|"c0op31"
block|,
literal|"c0op32"
block|,
literal|"c0op33"
block|,
literal|"c0op34"
block|,
literal|"c0op35"
block|,
literal|"c0op36"
block|,
literal|"c0op37"
block|,
literal|"c0op40"
block|,
literal|"c0op41"
block|,
literal|"c0op42"
block|,
literal|"c0op43"
block|,
literal|"c0op44"
block|,
literal|"c0op45"
block|,
literal|"c0op46"
block|,
literal|"c0op47"
block|,
literal|"c0op50"
block|,
literal|"c0op51"
block|,
literal|"c0op52"
block|,
literal|"c0op53"
block|,
literal|"c0op54"
block|,
literal|"c0op55"
block|,
literal|"c0op56"
block|,
literal|"c0op57"
block|,
literal|"c0op60"
block|,
literal|"c0op61"
block|,
literal|"c0op62"
block|,
literal|"c0op63"
block|,
literal|"c0op64"
block|,
literal|"c0op65"
block|,
literal|"c0op66"
block|,
literal|"c0op67"
block|,
literal|"c0op70"
block|,
literal|"c0op71"
block|,
literal|"c0op72"
block|,
literal|"c0op73"
block|,
literal|"c0op74"
block|,
literal|"c0op75"
block|,
literal|"c0op77"
block|,
literal|"c0op77"
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|c0_reg
index|[
literal|32
index|]
init|=
block|{
literal|"index"
block|,
literal|"random"
block|,
literal|"tlblo0"
block|,
literal|"tlblo1"
block|,
literal|"context"
block|,
literal|"tlbmask"
block|,
literal|"wired"
block|,
literal|"c0r7"
block|,
literal|"badvaddr"
block|,
literal|"count"
block|,
literal|"tlbhi"
block|,
literal|"c0r11"
block|,
literal|"sr"
block|,
literal|"cause"
block|,
literal|"epc"
block|,
literal|"prid"
block|,
literal|"config"
block|,
literal|"lladr"
block|,
literal|"watchlo"
block|,
literal|"watchhi"
block|,
literal|"xcontext"
block|,
literal|"c0r21"
block|,
literal|"c0r22"
block|,
literal|"c0r23"
block|,
literal|"c0r24"
block|,
literal|"c0r25"
block|,
literal|"ecc"
block|,
literal|"cacheerr"
block|,
literal|"taglo"
block|,
literal|"taghi"
block|,
literal|"errepc"
block|,
literal|"c0r31"
block|}
decl_stmt|;
end_decl_stmt

begin_function_decl
specifier|static
name|int
name|md_printins
parameter_list|(
name|int
name|ins
parameter_list|,
name|int
name|mdbdot
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|db_addr_t
name|db_disasm
parameter_list|(
name|db_addr_t
name|loc
parameter_list|,
name|bool
name|altfmt
parameter_list|)
block|{
name|int
name|ins
decl_stmt|;
if|if
condition|(
name|vtophys
argument_list|(
operator|(
name|vm_offset_t
operator|)
name|loc
argument_list|)
condition|)
block|{
name|db_read_bytes
argument_list|(
operator|(
name|vm_offset_t
operator|)
name|loc
argument_list|,
operator|(
name|size_t
operator|)
sizeof|sizeof
argument_list|(
name|int
argument_list|)
argument_list|,
operator|(
name|char
operator|*
operator|)
operator|&
name|ins
argument_list|)
expr_stmt|;
name|md_printins
argument_list|(
name|ins
argument_list|,
name|loc
argument_list|)
expr_stmt|;
block|}
return|return
operator|(
name|loc
operator|+
sizeof|sizeof
argument_list|(
name|int
argument_list|)
operator|)
return|;
block|}
end_function

begin_comment
comment|/* ARGSUSED */
end_comment

begin_function
specifier|static
name|int
name|md_printins
parameter_list|(
name|int
name|ins
parameter_list|,
name|int
name|mdbdot
parameter_list|)
block|{
name|InstFmt
name|i
decl_stmt|;
name|int
name|delay
init|=
literal|0
decl_stmt|;
name|i
operator|.
name|word
operator|=
name|ins
expr_stmt|;
switch|switch
condition|(
name|i
operator|.
name|JType
operator|.
name|op
condition|)
block|{
case|case
name|OP_SPECIAL
case|:
if|if
condition|(
name|i
operator|.
name|word
operator|==
literal|0
condition|)
block|{
name|db_printf
argument_list|(
literal|"nop"
argument_list|)
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|i
operator|.
name|RType
operator|.
name|func
operator|==
name|OP_ADDU
operator|&&
name|i
operator|.
name|RType
operator|.
name|rt
operator|==
literal|0
condition|)
block|{
name|db_printf
argument_list|(
literal|"move\t%s,%s"
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rd
index|]
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rs
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
name|db_printf
argument_list|(
literal|"%s"
argument_list|,
name|spec_name
index|[
name|i
operator|.
name|RType
operator|.
name|func
index|]
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|i
operator|.
name|RType
operator|.
name|func
condition|)
block|{
case|case
name|OP_SLL
case|:
case|case
name|OP_SRL
case|:
case|case
name|OP_SRA
case|:
case|case
name|OP_DSLL
case|:
case|case
name|OP_DSRL
case|:
case|case
name|OP_DSRA
case|:
case|case
name|OP_DSLL32
case|:
case|case
name|OP_DSRL32
case|:
case|case
name|OP_DSRA32
case|:
name|db_printf
argument_list|(
literal|"\t%s,%s,%d"
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rd
index|]
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rt
index|]
argument_list|,
name|i
operator|.
name|RType
operator|.
name|shamt
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_SLLV
case|:
case|case
name|OP_SRLV
case|:
case|case
name|OP_SRAV
case|:
case|case
name|OP_DSLLV
case|:
case|case
name|OP_DSRLV
case|:
case|case
name|OP_DSRAV
case|:
name|db_printf
argument_list|(
literal|"\t%s,%s,%s"
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rd
index|]
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rt
index|]
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rs
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_MFHI
case|:
case|case
name|OP_MFLO
case|:
name|db_printf
argument_list|(
literal|"\t%s"
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rd
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_JR
case|:
case|case
name|OP_JALR
case|:
name|delay
operator|=
literal|1
expr_stmt|;
comment|/* FALLTHROUGH */
case|case
name|OP_MTLO
case|:
case|case
name|OP_MTHI
case|:
name|db_printf
argument_list|(
literal|"\t%s"
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rs
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_MULT
case|:
case|case
name|OP_MULTU
case|:
case|case
name|OP_DMULT
case|:
case|case
name|OP_DMULTU
case|:
case|case
name|OP_DIV
case|:
case|case
name|OP_DIVU
case|:
case|case
name|OP_DDIV
case|:
case|case
name|OP_DDIVU
case|:
name|db_printf
argument_list|(
literal|"\t%s,%s"
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rs
index|]
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rt
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_SYSCALL
case|:
case|case
name|OP_SYNC
case|:
break|break;
case|case
name|OP_BREAK
case|:
name|db_printf
argument_list|(
literal|"\t%d"
argument_list|,
operator|(
name|i
operator|.
name|RType
operator|.
name|rs
operator|<<
literal|5
operator|)
operator||
name|i
operator|.
name|RType
operator|.
name|rt
argument_list|)
expr_stmt|;
break|break;
default|default:
name|db_printf
argument_list|(
literal|"\t%s,%s,%s"
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rd
index|]
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rs
index|]
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rt
index|]
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|OP_BCOND
case|:
name|db_printf
argument_list|(
literal|"%s\t%s,"
argument_list|,
name|bcond_name
index|[
name|i
operator|.
name|IType
operator|.
name|rt
index|]
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|IType
operator|.
name|rs
index|]
argument_list|)
expr_stmt|;
goto|goto
name|pr_displ
goto|;
case|case
name|OP_BLEZ
case|:
case|case
name|OP_BLEZL
case|:
case|case
name|OP_BGTZ
case|:
case|case
name|OP_BGTZL
case|:
name|db_printf
argument_list|(
literal|"%s\t%s,"
argument_list|,
name|op_name
index|[
name|i
operator|.
name|IType
operator|.
name|op
index|]
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|IType
operator|.
name|rs
index|]
argument_list|)
expr_stmt|;
goto|goto
name|pr_displ
goto|;
case|case
name|OP_BEQ
case|:
case|case
name|OP_BEQL
case|:
if|if
condition|(
name|i
operator|.
name|IType
operator|.
name|rs
operator|==
literal|0
operator|&&
name|i
operator|.
name|IType
operator|.
name|rt
operator|==
literal|0
condition|)
block|{
name|db_printf
argument_list|(
literal|"b\t"
argument_list|)
expr_stmt|;
goto|goto
name|pr_displ
goto|;
block|}
comment|/* FALLTHROUGH */
case|case
name|OP_BNE
case|:
case|case
name|OP_BNEL
case|:
name|db_printf
argument_list|(
literal|"%s\t%s,%s,"
argument_list|,
name|op_name
index|[
name|i
operator|.
name|IType
operator|.
name|op
index|]
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|IType
operator|.
name|rs
index|]
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|IType
operator|.
name|rt
index|]
argument_list|)
expr_stmt|;
name|pr_displ
label|:
name|delay
operator|=
literal|1
expr_stmt|;
name|db_printf
argument_list|(
literal|"0x%08x"
argument_list|,
name|mdbdot
operator|+
literal|4
operator|+
operator|(
operator|(
name|short
operator|)
name|i
operator|.
name|IType
operator|.
name|imm
operator|<<
literal|2
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_COP0
case|:
switch|switch
condition|(
name|i
operator|.
name|RType
operator|.
name|rs
condition|)
block|{
case|case
name|OP_BCx
case|:
case|case
name|OP_BCy
case|:
name|db_printf
argument_list|(
literal|"bc0%c\t"
argument_list|,
literal|"ft"
index|[
name|i
operator|.
name|RType
operator|.
name|rt
operator|&
name|COPz_BC_TF_MASK
index|]
argument_list|)
expr_stmt|;
goto|goto
name|pr_displ
goto|;
case|case
name|OP_MT
case|:
name|db_printf
argument_list|(
literal|"mtc0\t%s,%s"
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rt
index|]
argument_list|,
name|c0_reg
index|[
name|i
operator|.
name|RType
operator|.
name|rd
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_DMT
case|:
name|db_printf
argument_list|(
literal|"dmtc0\t%s,%s"
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rt
index|]
argument_list|,
name|c0_reg
index|[
name|i
operator|.
name|RType
operator|.
name|rd
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_MF
case|:
name|db_printf
argument_list|(
literal|"mfc0\t%s,%s"
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rt
index|]
argument_list|,
name|c0_reg
index|[
name|i
operator|.
name|RType
operator|.
name|rd
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_DMF
case|:
name|db_printf
argument_list|(
literal|"dmfc0\t%s,%s"
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rt
index|]
argument_list|,
name|c0_reg
index|[
name|i
operator|.
name|RType
operator|.
name|rd
index|]
argument_list|)
expr_stmt|;
break|break;
default|default:
name|db_printf
argument_list|(
literal|"%s"
argument_list|,
name|c0_opname
index|[
name|i
operator|.
name|FRType
operator|.
name|func
index|]
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|OP_COP1
case|:
switch|switch
condition|(
name|i
operator|.
name|RType
operator|.
name|rs
condition|)
block|{
case|case
name|OP_BCx
case|:
case|case
name|OP_BCy
case|:
name|db_printf
argument_list|(
literal|"bc1%c\t"
argument_list|,
literal|"ft"
index|[
name|i
operator|.
name|RType
operator|.
name|rt
operator|&
name|COPz_BC_TF_MASK
index|]
argument_list|)
expr_stmt|;
goto|goto
name|pr_displ
goto|;
case|case
name|OP_MT
case|:
name|db_printf
argument_list|(
literal|"mtc1\t%s,f%d"
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rt
index|]
argument_list|,
name|i
operator|.
name|RType
operator|.
name|rd
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_MF
case|:
name|db_printf
argument_list|(
literal|"mfc1\t%s,f%d"
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rt
index|]
argument_list|,
name|i
operator|.
name|RType
operator|.
name|rd
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_CT
case|:
name|db_printf
argument_list|(
literal|"ctc1\t%s,f%d"
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rt
index|]
argument_list|,
name|i
operator|.
name|RType
operator|.
name|rd
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_CF
case|:
name|db_printf
argument_list|(
literal|"cfc1\t%s,f%d"
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|RType
operator|.
name|rt
index|]
argument_list|,
name|i
operator|.
name|RType
operator|.
name|rd
argument_list|)
expr_stmt|;
break|break;
default|default:
name|db_printf
argument_list|(
literal|"%s.%s\tf%d,f%d,f%d"
argument_list|,
name|cop1_name
index|[
name|i
operator|.
name|FRType
operator|.
name|func
index|]
argument_list|,
name|fmt_name
index|[
name|i
operator|.
name|FRType
operator|.
name|fmt
index|]
argument_list|,
name|i
operator|.
name|FRType
operator|.
name|fd
argument_list|,
name|i
operator|.
name|FRType
operator|.
name|fs
argument_list|,
name|i
operator|.
name|FRType
operator|.
name|ft
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|OP_J
case|:
case|case
name|OP_JAL
case|:
name|db_printf
argument_list|(
literal|"%s\t"
argument_list|,
name|op_name
index|[
name|i
operator|.
name|JType
operator|.
name|op
index|]
argument_list|)
expr_stmt|;
name|db_printf
argument_list|(
literal|"0x%8x"
argument_list|,
operator|(
name|mdbdot
operator|&
literal|0xF0000000
operator|)
operator||
operator|(
name|i
operator|.
name|JType
operator|.
name|target
operator|<<
literal|2
operator|)
argument_list|)
expr_stmt|;
name|delay
operator|=
literal|1
expr_stmt|;
break|break;
case|case
name|OP_LWC1
case|:
case|case
name|OP_SWC1
case|:
name|db_printf
argument_list|(
literal|"%s\tf%d,"
argument_list|,
name|op_name
index|[
name|i
operator|.
name|IType
operator|.
name|op
index|]
argument_list|,
name|i
operator|.
name|IType
operator|.
name|rt
argument_list|)
expr_stmt|;
goto|goto
name|loadstore
goto|;
case|case
name|OP_LB
case|:
case|case
name|OP_LH
case|:
case|case
name|OP_LW
case|:
case|case
name|OP_LD
case|:
case|case
name|OP_LBU
case|:
case|case
name|OP_LHU
case|:
case|case
name|OP_LWU
case|:
case|case
name|OP_SB
case|:
case|case
name|OP_SH
case|:
case|case
name|OP_SW
case|:
case|case
name|OP_SD
case|:
name|db_printf
argument_list|(
literal|"%s\t%s,"
argument_list|,
name|op_name
index|[
name|i
operator|.
name|IType
operator|.
name|op
index|]
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|IType
operator|.
name|rt
index|]
argument_list|)
expr_stmt|;
name|loadstore
label|:
name|db_printf
argument_list|(
literal|"%d(%s)"
argument_list|,
operator|(
name|short
operator|)
name|i
operator|.
name|IType
operator|.
name|imm
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|IType
operator|.
name|rs
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_ORI
case|:
case|case
name|OP_XORI
case|:
if|if
condition|(
name|i
operator|.
name|IType
operator|.
name|rs
operator|==
literal|0
condition|)
block|{
name|db_printf
argument_list|(
literal|"li\t%s,0x%x"
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|IType
operator|.
name|rt
index|]
argument_list|,
name|i
operator|.
name|IType
operator|.
name|imm
argument_list|)
expr_stmt|;
break|break;
block|}
comment|/* FALLTHROUGH */
case|case
name|OP_ANDI
case|:
name|db_printf
argument_list|(
literal|"%s\t%s,%s,0x%x"
argument_list|,
name|op_name
index|[
name|i
operator|.
name|IType
operator|.
name|op
index|]
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|IType
operator|.
name|rt
index|]
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|IType
operator|.
name|rs
index|]
argument_list|,
name|i
operator|.
name|IType
operator|.
name|imm
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_LUI
case|:
name|db_printf
argument_list|(
literal|"%s\t%s,0x%x"
argument_list|,
name|op_name
index|[
name|i
operator|.
name|IType
operator|.
name|op
index|]
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|IType
operator|.
name|rt
index|]
argument_list|,
name|i
operator|.
name|IType
operator|.
name|imm
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_ADDI
case|:
case|case
name|OP_DADDI
case|:
case|case
name|OP_ADDIU
case|:
case|case
name|OP_DADDIU
case|:
if|if
condition|(
name|i
operator|.
name|IType
operator|.
name|rs
operator|==
literal|0
condition|)
block|{
name|db_printf
argument_list|(
literal|"li\t%s,%d"
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|IType
operator|.
name|rt
index|]
argument_list|,
operator|(
name|short
operator|)
name|i
operator|.
name|IType
operator|.
name|imm
argument_list|)
expr_stmt|;
break|break;
block|}
comment|/* FALLTHROUGH */
default|default:
name|db_printf
argument_list|(
literal|"%s\t%s,%s,%d"
argument_list|,
name|op_name
index|[
name|i
operator|.
name|IType
operator|.
name|op
index|]
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|IType
operator|.
name|rt
index|]
argument_list|,
name|reg_name
index|[
name|i
operator|.
name|IType
operator|.
name|rs
index|]
argument_list|,
operator|(
name|short
operator|)
name|i
operator|.
name|IType
operator|.
name|imm
argument_list|)
expr_stmt|;
block|}
name|db_printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
return|return
operator|(
name|delay
operator|)
return|;
block|}
end_function

end_unit

