begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Mach Operating System  * Copyright (c) 1991,1990 Carnegie Mellon University  * All Rights Reserved.  *  * Permission to use, copy, modify and distribute this software and its  * documentation is hereby granted, provided that both the copyright  * notice and this permission notice appear in all copies of the  * software, derivative works or modified versions, and any portions  * thereof, and that both notices appear in supporting documentation.  *  * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS  * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR  * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.  *  * Carnegie Mellon requests users of this software to return to  *  *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU  *  School of Computer Science  *  Carnegie Mellon University  *  Pittsburgh PA 15213-3890  *  * any improvements or extensions that they make and grant Carnegie the  * rights to redistribute these changes.  *  * $FreeBSD$  */
end_comment

begin_comment
comment|/*  * Instruction disassembler.  */
end_comment

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<ddb/ddb.h>
end_include

begin_include
include|#
directive|include
file|<ddb/db_access.h>
end_include

begin_include
include|#
directive|include
file|<ddb/db_sym.h>
end_include

begin_comment
comment|/*  * Size attributes  */
end_comment

begin_define
define|#
directive|define
name|BYTE
value|0
end_define

begin_define
define|#
directive|define
name|WORD
value|1
end_define

begin_define
define|#
directive|define
name|LONG
value|2
end_define

begin_define
define|#
directive|define
name|QUAD
value|3
end_define

begin_define
define|#
directive|define
name|SNGL
value|4
end_define

begin_define
define|#
directive|define
name|DBLR
value|5
end_define

begin_define
define|#
directive|define
name|EXTR
value|6
end_define

begin_define
define|#
directive|define
name|SDEP
value|7
end_define

begin_define
define|#
directive|define
name|NONE
value|8
end_define

begin_comment
comment|/*  * Addressing modes  */
end_comment

begin_define
define|#
directive|define
name|E
value|1
end_define

begin_comment
comment|/* general effective address */
end_comment

begin_define
define|#
directive|define
name|Eind
value|2
end_define

begin_comment
comment|/* indirect address (jump, call) */
end_comment

begin_define
define|#
directive|define
name|Ew
value|3
end_define

begin_comment
comment|/* address, word size */
end_comment

begin_define
define|#
directive|define
name|Eb
value|4
end_define

begin_comment
comment|/* address, byte size */
end_comment

begin_define
define|#
directive|define
name|R
value|5
end_define

begin_comment
comment|/* register, in 'reg' field */
end_comment

begin_define
define|#
directive|define
name|Rw
value|6
end_define

begin_comment
comment|/* word register, in 'reg' field */
end_comment

begin_define
define|#
directive|define
name|Ri
value|7
end_define

begin_comment
comment|/* register in instruction */
end_comment

begin_define
define|#
directive|define
name|S
value|8
end_define

begin_comment
comment|/* segment reg, in 'reg' field */
end_comment

begin_define
define|#
directive|define
name|Si
value|9
end_define

begin_comment
comment|/* segment reg, in instruction */
end_comment

begin_define
define|#
directive|define
name|A
value|10
end_define

begin_comment
comment|/* accumulator */
end_comment

begin_define
define|#
directive|define
name|BX
value|11
end_define

begin_comment
comment|/* (bx) */
end_comment

begin_define
define|#
directive|define
name|CL
value|12
end_define

begin_comment
comment|/* cl, for shifts */
end_comment

begin_define
define|#
directive|define
name|DX
value|13
end_define

begin_comment
comment|/* dx, for IO */
end_comment

begin_define
define|#
directive|define
name|SI
value|14
end_define

begin_comment
comment|/* si */
end_comment

begin_define
define|#
directive|define
name|DI
value|15
end_define

begin_comment
comment|/* di */
end_comment

begin_define
define|#
directive|define
name|CR
value|16
end_define

begin_comment
comment|/* control register */
end_comment

begin_define
define|#
directive|define
name|DR
value|17
end_define

begin_comment
comment|/* debug register */
end_comment

begin_define
define|#
directive|define
name|TR
value|18
end_define

begin_comment
comment|/* test register */
end_comment

begin_define
define|#
directive|define
name|I
value|19
end_define

begin_comment
comment|/* immediate, unsigned */
end_comment

begin_define
define|#
directive|define
name|Is
value|20
end_define

begin_comment
comment|/* immediate, signed */
end_comment

begin_define
define|#
directive|define
name|Ib
value|21
end_define

begin_comment
comment|/* byte immediate, unsigned */
end_comment

begin_define
define|#
directive|define
name|Ibs
value|22
end_define

begin_comment
comment|/* byte immediate, signed */
end_comment

begin_define
define|#
directive|define
name|Iw
value|23
end_define

begin_comment
comment|/* word immediate, unsigned */
end_comment

begin_define
define|#
directive|define
name|O
value|25
end_define

begin_comment
comment|/* direct address */
end_comment

begin_define
define|#
directive|define
name|Db
value|26
end_define

begin_comment
comment|/* byte displacement from EIP */
end_comment

begin_define
define|#
directive|define
name|Dl
value|27
end_define

begin_comment
comment|/* long displacement from EIP */
end_comment

begin_define
define|#
directive|define
name|o1
value|28
end_define

begin_comment
comment|/* constant 1 */
end_comment

begin_define
define|#
directive|define
name|o3
value|29
end_define

begin_comment
comment|/* constant 3 */
end_comment

begin_define
define|#
directive|define
name|OS
value|30
end_define

begin_comment
comment|/* immediate offset/segment */
end_comment

begin_define
define|#
directive|define
name|ST
value|31
end_define

begin_comment
comment|/* FP stack top */
end_comment

begin_define
define|#
directive|define
name|STI
value|32
end_define

begin_comment
comment|/* FP stack */
end_comment

begin_define
define|#
directive|define
name|X
value|33
end_define

begin_comment
comment|/* extended FP op */
end_comment

begin_define
define|#
directive|define
name|XA
value|34
end_define

begin_comment
comment|/* for 'fstcw %ax' */
end_comment

begin_define
define|#
directive|define
name|El
value|35
end_define

begin_comment
comment|/* address, long size */
end_comment

begin_define
define|#
directive|define
name|Ril
value|36
end_define

begin_comment
comment|/* long register in instruction */
end_comment

begin_define
define|#
directive|define
name|Iba
value|37
end_define

begin_comment
comment|/* byte immediate, don't print if 0xa */
end_comment

begin_struct
struct|struct
name|inst
block|{
specifier|const
name|char
modifier|*
name|i_name
decl_stmt|;
comment|/* name */
name|short
name|i_has_modrm
decl_stmt|;
comment|/* has regmodrm byte */
name|short
name|i_size
decl_stmt|;
comment|/* operand size */
name|int
name|i_mode
decl_stmt|;
comment|/* addressing modes */
specifier|const
name|void
modifier|*
name|i_extra
decl_stmt|;
comment|/* pointer to extra opcode table */
block|}
struct|;
end_struct

begin_define
define|#
directive|define
name|op1
parameter_list|(
name|x
parameter_list|)
value|(x)
end_define

begin_define
define|#
directive|define
name|op2
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|)
value|((x)|((y)<<8))
end_define

begin_define
define|#
directive|define
name|op3
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|,
name|z
parameter_list|)
value|((x)|((y)<<8)|((z)<<16))
end_define

begin_struct
struct|struct
name|finst
block|{
specifier|const
name|char
modifier|*
name|f_name
decl_stmt|;
comment|/* name for memory instruction */
name|int
name|f_size
decl_stmt|;
comment|/* size for memory instruction */
name|int
name|f_rrmode
decl_stmt|;
comment|/* mode for rr instruction */
specifier|const
name|void
modifier|*
name|f_rrname
decl_stmt|;
comment|/* name for rr instruction 					   (or pointer to table) */
block|}
struct|;
end_struct

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_Grp6
index|[]
init|=
block|{
literal|"sldt"
block|,
literal|"str"
block|,
literal|"lldt"
block|,
literal|"ltr"
block|,
literal|"verr"
block|,
literal|"verw"
block|,
literal|""
block|,
literal|""
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_Grp7
index|[]
init|=
block|{
literal|"sgdt"
block|,
literal|"sidt"
block|,
literal|"lgdt"
block|,
literal|"lidt"
block|,
literal|"smsw"
block|,
literal|""
block|,
literal|"lmsw"
block|,
literal|"invlpg"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_Grp8
index|[]
init|=
block|{
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|"bt"
block|,
literal|"bts"
block|,
literal|"btr"
block|,
literal|"btc"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_Grp9
index|[]
init|=
block|{
literal|""
block|,
literal|"cmpxchg8b"
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|inst
name|db_inst_0f0x
index|[]
init|=
block|{
comment|/*00*/
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Ew
argument_list|)
block|,
name|db_Grp6
block|}
block|,
comment|/*01*/
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Ew
argument_list|)
block|,
name|db_Grp7
block|}
block|,
comment|/*02*/
block|{
literal|"lar"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*03*/
block|{
literal|"lsl"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*04*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*05*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*06*/
block|{
literal|"clts"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*07*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*08*/
block|{
literal|"invd"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*09*/
block|{
literal|"wbinvd"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*0a*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*0b*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*0c*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*0d*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*0e*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*0f*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|inst
name|db_inst_0f2x
index|[]
init|=
block|{
comment|/*20*/
block|{
literal|"mov"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|CR
argument_list|,
name|El
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*21*/
block|{
literal|"mov"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|DR
argument_list|,
name|El
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*22*/
block|{
literal|"mov"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|El
argument_list|,
name|CR
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*23*/
block|{
literal|"mov"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|El
argument_list|,
name|DR
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*24*/
block|{
literal|"mov"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|TR
argument_list|,
name|El
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*25*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*26*/
block|{
literal|"mov"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|El
argument_list|,
name|TR
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*27*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*28*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*29*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*2a*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*2b*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*2c*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*2d*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*2e*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*2f*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|inst
name|db_inst_0f3x
index|[]
init|=
block|{
comment|/*30*/
block|{
literal|"wrmsr"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*31*/
block|{
literal|"rdtsc"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*32*/
block|{
literal|"rdmsr"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*33*/
block|{
literal|"rdpmc"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*34*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*35*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*36*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*37*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*38*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*39*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*3a*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*3b*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*3c*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*3d*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*3e*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*3f*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|inst
name|db_inst_0f8x
index|[]
init|=
block|{
comment|/*80*/
block|{
literal|"jo"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*81*/
block|{
literal|"jno"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*82*/
block|{
literal|"jb"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*83*/
block|{
literal|"jnb"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*84*/
block|{
literal|"jz"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*85*/
block|{
literal|"jnz"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*86*/
block|{
literal|"jbe"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*87*/
block|{
literal|"jnbe"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*88*/
block|{
literal|"js"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*89*/
block|{
literal|"jns"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*8a*/
block|{
literal|"jp"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*8b*/
block|{
literal|"jnp"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*8c*/
block|{
literal|"jl"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*8d*/
block|{
literal|"jnl"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*8e*/
block|{
literal|"jle"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*8f*/
block|{
literal|"jnle"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|inst
name|db_inst_0f9x
index|[]
init|=
block|{
comment|/*90*/
block|{
literal|"seto"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Eb
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*91*/
block|{
literal|"setno"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Eb
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*92*/
block|{
literal|"setb"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Eb
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*93*/
block|{
literal|"setnb"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Eb
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*94*/
block|{
literal|"setz"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Eb
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*95*/
block|{
literal|"setnz"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Eb
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*96*/
block|{
literal|"setbe"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Eb
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*97*/
block|{
literal|"setnbe"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Eb
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*98*/
block|{
literal|"sets"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Eb
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*99*/
block|{
literal|"setns"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Eb
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*9a*/
block|{
literal|"setp"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Eb
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*9b*/
block|{
literal|"setnp"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Eb
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*9c*/
block|{
literal|"setl"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Eb
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*9d*/
block|{
literal|"setnl"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Eb
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*9e*/
block|{
literal|"setle"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Eb
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*9f*/
block|{
literal|"setnle"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Eb
argument_list|)
block|,
literal|0
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|inst
name|db_inst_0fax
index|[]
init|=
block|{
comment|/*a0*/
block|{
literal|"push"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Si
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*a1*/
block|{
literal|"pop"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Si
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*a2*/
block|{
literal|"cpuid"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*a3*/
block|{
literal|"bt"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*a4*/
block|{
literal|"shld"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op3
argument_list|(
name|Ib
argument_list|,
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*a5*/
block|{
literal|"shld"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op3
argument_list|(
name|CL
argument_list|,
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*a6*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*a7*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*a8*/
block|{
literal|"push"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Si
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*a9*/
block|{
literal|"pop"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Si
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*aa*/
block|{
literal|"rsm"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*ab*/
block|{
literal|"bts"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*ac*/
block|{
literal|"shrd"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op3
argument_list|(
name|Ib
argument_list|,
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*ad*/
block|{
literal|"shrd"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op3
argument_list|(
name|CL
argument_list|,
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*a6*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*a7*/
block|{
literal|"imul"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|inst
name|db_inst_0fbx
index|[]
init|=
block|{
comment|/*b0*/
block|{
literal|"cmpxchg"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b0*/
block|{
literal|"cmpxchg"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b2*/
block|{
literal|"lss"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b3*/
block|{
literal|"btr"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b4*/
block|{
literal|"lfs"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b5*/
block|{
literal|"lgs"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b6*/
block|{
literal|"movzb"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|Eb
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b7*/
block|{
literal|"movzw"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|Ew
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b8*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*b9*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*ba*/
block|{
literal|""
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|Ib
argument_list|,
name|E
argument_list|)
block|,
name|db_Grp8
block|}
block|,
comment|/*bb*/
block|{
literal|"btc"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*bc*/
block|{
literal|"bsf"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*bd*/
block|{
literal|"bsr"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*be*/
block|{
literal|"movsb"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|Eb
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*bf*/
block|{
literal|"movsw"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|Ew
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|inst
name|db_inst_0fcx
index|[]
init|=
block|{
comment|/*c0*/
block|{
literal|"xadd"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*c1*/
block|{
literal|"xadd"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*c2*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*c3*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*c4*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*c5*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*c6*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*c7*/
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|E
argument_list|)
block|,
name|db_Grp9
block|}
block|,
comment|/*c8*/
block|{
literal|"bswap"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ril
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*c9*/
block|{
literal|"bswap"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ril
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*ca*/
block|{
literal|"bswap"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ril
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*cb*/
block|{
literal|"bswap"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ril
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*cc*/
block|{
literal|"bswap"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ril
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*cd*/
block|{
literal|"bswap"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ril
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*ce*/
block|{
literal|"bswap"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ril
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*cf*/
block|{
literal|"bswap"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ril
argument_list|)
block|,
literal|0
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|inst
modifier|*
specifier|const
name|db_inst_0f
index|[]
init|=
block|{
name|db_inst_0f0x
block|,
literal|0
block|,
name|db_inst_0f2x
block|,
name|db_inst_0f3x
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
name|db_inst_0f8x
block|,
name|db_inst_0f9x
block|,
name|db_inst_0fax
block|,
name|db_inst_0fbx
block|,
name|db_inst_0fcx
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_Esc92
index|[]
init|=
block|{
literal|"fnop"
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_Esc94
index|[]
init|=
block|{
literal|"fchs"
block|,
literal|"fabs"
block|,
literal|""
block|,
literal|""
block|,
literal|"ftst"
block|,
literal|"fxam"
block|,
literal|""
block|,
literal|""
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_Esc95
index|[]
init|=
block|{
literal|"fld1"
block|,
literal|"fldl2t"
block|,
literal|"fldl2e"
block|,
literal|"fldpi"
block|,
literal|"fldlg2"
block|,
literal|"fldln2"
block|,
literal|"fldz"
block|,
literal|""
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_Esc96
index|[]
init|=
block|{
literal|"f2xm1"
block|,
literal|"fyl2x"
block|,
literal|"fptan"
block|,
literal|"fpatan"
block|,
literal|"fxtract"
block|,
literal|"fprem1"
block|,
literal|"fdecstp"
block|,
literal|"fincstp"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_Esc97
index|[]
init|=
block|{
literal|"fprem"
block|,
literal|"fyl2xp1"
block|,
literal|"fsqrt"
block|,
literal|"fsincos"
block|,
literal|"frndint"
block|,
literal|"fscale"
block|,
literal|"fsin"
block|,
literal|"fcos"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_Esca5
index|[]
init|=
block|{
literal|""
block|,
literal|"fucompp"
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_Escb4
index|[]
init|=
block|{
literal|"fneni"
block|,
literal|"fndisi"
block|,
literal|"fnclex"
block|,
literal|"fninit"
block|,
literal|"fsetpm"
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_Esce3
index|[]
init|=
block|{
literal|""
block|,
literal|"fcompp"
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_Escf4
index|[]
init|=
block|{
literal|"fnstsw"
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|finst
name|db_Esc8
index|[]
init|=
block|{
comment|/*0*/
block|{
literal|"fadd"
block|,
name|SNGL
block|,
name|op2
argument_list|(
name|STI
argument_list|,
name|ST
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*1*/
block|{
literal|"fmul"
block|,
name|SNGL
block|,
name|op2
argument_list|(
name|STI
argument_list|,
name|ST
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*2*/
block|{
literal|"fcom"
block|,
name|SNGL
block|,
name|op2
argument_list|(
name|STI
argument_list|,
name|ST
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*3*/
block|{
literal|"fcomp"
block|,
name|SNGL
block|,
name|op2
argument_list|(
name|STI
argument_list|,
name|ST
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*4*/
block|{
literal|"fsub"
block|,
name|SNGL
block|,
name|op2
argument_list|(
name|STI
argument_list|,
name|ST
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*5*/
block|{
literal|"fsubr"
block|,
name|SNGL
block|,
name|op2
argument_list|(
name|STI
argument_list|,
name|ST
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*6*/
block|{
literal|"fdiv"
block|,
name|SNGL
block|,
name|op2
argument_list|(
name|STI
argument_list|,
name|ST
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*7*/
block|{
literal|"fdivr"
block|,
name|SNGL
block|,
name|op2
argument_list|(
name|STI
argument_list|,
name|ST
argument_list|)
block|,
literal|0
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|finst
name|db_Esc9
index|[]
init|=
block|{
comment|/*0*/
block|{
literal|"fld"
block|,
name|SNGL
block|,
name|op1
argument_list|(
name|STI
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*1*/
block|{
literal|""
block|,
name|NONE
block|,
name|op1
argument_list|(
name|STI
argument_list|)
block|,
literal|"fxch"
block|}
block|,
comment|/*2*/
block|{
literal|"fst"
block|,
name|SNGL
block|,
name|op1
argument_list|(
name|X
argument_list|)
block|,
name|db_Esc92
block|}
block|,
comment|/*3*/
block|{
literal|"fstp"
block|,
name|SNGL
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*4*/
block|{
literal|"fldenv"
block|,
name|NONE
block|,
name|op1
argument_list|(
name|X
argument_list|)
block|,
name|db_Esc94
block|}
block|,
comment|/*5*/
block|{
literal|"fldcw"
block|,
name|NONE
block|,
name|op1
argument_list|(
name|X
argument_list|)
block|,
name|db_Esc95
block|}
block|,
comment|/*6*/
block|{
literal|"fnstenv"
block|,
name|NONE
block|,
name|op1
argument_list|(
name|X
argument_list|)
block|,
name|db_Esc96
block|}
block|,
comment|/*7*/
block|{
literal|"fnstcw"
block|,
name|NONE
block|,
name|op1
argument_list|(
name|X
argument_list|)
block|,
name|db_Esc97
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|finst
name|db_Esca
index|[]
init|=
block|{
comment|/*0*/
block|{
literal|"fiadd"
block|,
name|LONG
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*1*/
block|{
literal|"fimul"
block|,
name|LONG
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*2*/
block|{
literal|"ficom"
block|,
name|LONG
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*3*/
block|{
literal|"ficomp"
block|,
name|LONG
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*4*/
block|{
literal|"fisub"
block|,
name|LONG
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*5*/
block|{
literal|"fisubr"
block|,
name|LONG
block|,
name|op1
argument_list|(
name|X
argument_list|)
block|,
name|db_Esca5
block|}
block|,
comment|/*6*/
block|{
literal|"fidiv"
block|,
name|LONG
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*7*/
block|{
literal|"fidivr"
block|,
name|LONG
block|,
literal|0
block|,
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|finst
name|db_Escb
index|[]
init|=
block|{
comment|/*0*/
block|{
literal|"fild"
block|,
name|LONG
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*1*/
block|{
literal|""
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*2*/
block|{
literal|"fist"
block|,
name|LONG
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*3*/
block|{
literal|"fistp"
block|,
name|LONG
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*4*/
block|{
literal|""
block|,
name|WORD
block|,
name|op1
argument_list|(
name|X
argument_list|)
block|,
name|db_Escb4
block|}
block|,
comment|/*5*/
block|{
literal|"fld"
block|,
name|EXTR
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*6*/
block|{
literal|""
block|,
name|WORD
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*7*/
block|{
literal|"fstp"
block|,
name|EXTR
block|,
literal|0
block|,
literal|0
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|finst
name|db_Escc
index|[]
init|=
block|{
comment|/*0*/
block|{
literal|"fadd"
block|,
name|DBLR
block|,
name|op2
argument_list|(
name|ST
argument_list|,
name|STI
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*1*/
block|{
literal|"fmul"
block|,
name|DBLR
block|,
name|op2
argument_list|(
name|ST
argument_list|,
name|STI
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*2*/
block|{
literal|"fcom"
block|,
name|DBLR
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*3*/
block|{
literal|"fcomp"
block|,
name|DBLR
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*4*/
block|{
literal|"fsub"
block|,
name|DBLR
block|,
name|op2
argument_list|(
name|ST
argument_list|,
name|STI
argument_list|)
block|,
literal|"fsubr"
block|}
block|,
comment|/*5*/
block|{
literal|"fsubr"
block|,
name|DBLR
block|,
name|op2
argument_list|(
name|ST
argument_list|,
name|STI
argument_list|)
block|,
literal|"fsub"
block|}
block|,
comment|/*6*/
block|{
literal|"fdiv"
block|,
name|DBLR
block|,
name|op2
argument_list|(
name|ST
argument_list|,
name|STI
argument_list|)
block|,
literal|"fdivr"
block|}
block|,
comment|/*7*/
block|{
literal|"fdivr"
block|,
name|DBLR
block|,
name|op2
argument_list|(
name|ST
argument_list|,
name|STI
argument_list|)
block|,
literal|"fdiv"
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|finst
name|db_Escd
index|[]
init|=
block|{
comment|/*0*/
block|{
literal|"fld"
block|,
name|DBLR
block|,
name|op1
argument_list|(
name|STI
argument_list|)
block|,
literal|"ffree"
block|}
block|,
comment|/*1*/
block|{
literal|""
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*2*/
block|{
literal|"fst"
block|,
name|DBLR
block|,
name|op1
argument_list|(
name|STI
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*3*/
block|{
literal|"fstp"
block|,
name|DBLR
block|,
name|op1
argument_list|(
name|STI
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*4*/
block|{
literal|"frstor"
block|,
name|NONE
block|,
name|op1
argument_list|(
name|STI
argument_list|)
block|,
literal|"fucom"
block|}
block|,
comment|/*5*/
block|{
literal|""
block|,
name|NONE
block|,
name|op1
argument_list|(
name|STI
argument_list|)
block|,
literal|"fucomp"
block|}
block|,
comment|/*6*/
block|{
literal|"fnsave"
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*7*/
block|{
literal|"fnstsw"
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|finst
name|db_Esce
index|[]
init|=
block|{
comment|/*0*/
block|{
literal|"fiadd"
block|,
name|WORD
block|,
name|op2
argument_list|(
name|ST
argument_list|,
name|STI
argument_list|)
block|,
literal|"faddp"
block|}
block|,
comment|/*1*/
block|{
literal|"fimul"
block|,
name|WORD
block|,
name|op2
argument_list|(
name|ST
argument_list|,
name|STI
argument_list|)
block|,
literal|"fmulp"
block|}
block|,
comment|/*2*/
block|{
literal|"ficom"
block|,
name|WORD
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*3*/
block|{
literal|"ficomp"
block|,
name|WORD
block|,
name|op1
argument_list|(
name|X
argument_list|)
block|,
name|db_Esce3
block|}
block|,
comment|/*4*/
block|{
literal|"fisub"
block|,
name|WORD
block|,
name|op2
argument_list|(
name|ST
argument_list|,
name|STI
argument_list|)
block|,
literal|"fsubrp"
block|}
block|,
comment|/*5*/
block|{
literal|"fisubr"
block|,
name|WORD
block|,
name|op2
argument_list|(
name|ST
argument_list|,
name|STI
argument_list|)
block|,
literal|"fsubp"
block|}
block|,
comment|/*6*/
block|{
literal|"fidiv"
block|,
name|WORD
block|,
name|op2
argument_list|(
name|ST
argument_list|,
name|STI
argument_list|)
block|,
literal|"fdivrp"
block|}
block|,
comment|/*7*/
block|{
literal|"fidivr"
block|,
name|WORD
block|,
name|op2
argument_list|(
name|ST
argument_list|,
name|STI
argument_list|)
block|,
literal|"fdivp"
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|finst
name|db_Escf
index|[]
init|=
block|{
comment|/*0*/
block|{
literal|"fild"
block|,
name|WORD
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*1*/
block|{
literal|""
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*2*/
block|{
literal|"fist"
block|,
name|WORD
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*3*/
block|{
literal|"fistp"
block|,
name|WORD
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*4*/
block|{
literal|"fbld"
block|,
name|NONE
block|,
name|op1
argument_list|(
name|XA
argument_list|)
block|,
name|db_Escf4
block|}
block|,
comment|/*5*/
block|{
literal|"fild"
block|,
name|QUAD
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*6*/
block|{
literal|"fbstp"
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*7*/
block|{
literal|"fistp"
block|,
name|QUAD
block|,
literal|0
block|,
literal|0
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|finst
modifier|*
specifier|const
name|db_Esc_inst
index|[]
init|=
block|{
name|db_Esc8
block|,
name|db_Esc9
block|,
name|db_Esca
block|,
name|db_Escb
block|,
name|db_Escc
block|,
name|db_Escd
block|,
name|db_Esce
block|,
name|db_Escf
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_Grp1
index|[]
init|=
block|{
literal|"add"
block|,
literal|"or"
block|,
literal|"adc"
block|,
literal|"sbb"
block|,
literal|"and"
block|,
literal|"sub"
block|,
literal|"xor"
block|,
literal|"cmp"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_Grp2
index|[]
init|=
block|{
literal|"rol"
block|,
literal|"ror"
block|,
literal|"rcl"
block|,
literal|"rcr"
block|,
literal|"shl"
block|,
literal|"shr"
block|,
literal|"shl"
block|,
literal|"sar"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|inst
name|db_Grp3
index|[]
init|=
block|{
block|{
literal|"test"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
block|{
literal|"test"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
block|{
literal|"not"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|E
argument_list|)
block|,
literal|0
block|}
block|,
block|{
literal|"neg"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|E
argument_list|)
block|,
literal|0
block|}
block|,
block|{
literal|"mul"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
block|{
literal|"imul"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
block|{
literal|"div"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
block|{
literal|"idiv"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|inst
name|db_Grp4
index|[]
init|=
block|{
block|{
literal|"inc"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op1
argument_list|(
name|E
argument_list|)
block|,
literal|0
block|}
block|,
block|{
literal|"dec"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op1
argument_list|(
name|E
argument_list|)
block|,
literal|0
block|}
block|,
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|inst
name|db_Grp5
index|[]
init|=
block|{
block|{
literal|"inc"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|E
argument_list|)
block|,
literal|0
block|}
block|,
block|{
literal|"dec"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|E
argument_list|)
block|,
literal|0
block|}
block|,
block|{
literal|"call"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Eind
argument_list|)
block|,
literal|0
block|}
block|,
block|{
literal|"lcall"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Eind
argument_list|)
block|,
literal|0
block|}
block|,
block|{
literal|"jmp"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Eind
argument_list|)
block|,
literal|0
block|}
block|,
block|{
literal|"ljmp"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Eind
argument_list|)
block|,
literal|0
block|}
block|,
block|{
literal|"push"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|E
argument_list|)
block|,
literal|0
block|}
block|,
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|inst
name|db_inst_table
index|[
literal|256
index|]
init|=
block|{
comment|/*00*/
block|{
literal|"add"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*01*/
block|{
literal|"add"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*02*/
block|{
literal|"add"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*03*/
block|{
literal|"add"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*04*/
block|{
literal|"add"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*05*/
block|{
literal|"add"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|Is
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*06*/
block|{
literal|"push"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Si
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*07*/
block|{
literal|"pop"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Si
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*08*/
block|{
literal|"or"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*09*/
block|{
literal|"or"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*0a*/
block|{
literal|"or"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*0b*/
block|{
literal|"or"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*0c*/
block|{
literal|"or"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*0d*/
block|{
literal|"or"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*0e*/
block|{
literal|"push"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Si
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*0f*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*10*/
block|{
literal|"adc"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*11*/
block|{
literal|"adc"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*12*/
block|{
literal|"adc"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*13*/
block|{
literal|"adc"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*14*/
block|{
literal|"adc"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*15*/
block|{
literal|"adc"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|Is
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*16*/
block|{
literal|"push"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Si
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*17*/
block|{
literal|"pop"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Si
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*18*/
block|{
literal|"sbb"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*19*/
block|{
literal|"sbb"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*1a*/
block|{
literal|"sbb"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*1b*/
block|{
literal|"sbb"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*1c*/
block|{
literal|"sbb"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*1d*/
block|{
literal|"sbb"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|Is
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*1e*/
block|{
literal|"push"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Si
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*1f*/
block|{
literal|"pop"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Si
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*20*/
block|{
literal|"and"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*21*/
block|{
literal|"and"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*22*/
block|{
literal|"and"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*23*/
block|{
literal|"and"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*24*/
block|{
literal|"and"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*25*/
block|{
literal|"and"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*26*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*27*/
block|{
literal|"daa"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*28*/
block|{
literal|"sub"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*29*/
block|{
literal|"sub"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*2a*/
block|{
literal|"sub"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*2b*/
block|{
literal|"sub"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*2c*/
block|{
literal|"sub"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*2d*/
block|{
literal|"sub"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|Is
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*2e*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*2f*/
block|{
literal|"das"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*30*/
block|{
literal|"xor"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*31*/
block|{
literal|"xor"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*32*/
block|{
literal|"xor"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*33*/
block|{
literal|"xor"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*34*/
block|{
literal|"xor"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*35*/
block|{
literal|"xor"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*36*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*37*/
block|{
literal|"aaa"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*38*/
block|{
literal|"cmp"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*39*/
block|{
literal|"cmp"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*3a*/
block|{
literal|"cmp"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*3b*/
block|{
literal|"cmp"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*3c*/
block|{
literal|"cmp"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*3d*/
block|{
literal|"cmp"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|Is
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*3e*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*3f*/
block|{
literal|"aas"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*40*/
block|{
literal|"inc"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*41*/
block|{
literal|"inc"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*42*/
block|{
literal|"inc"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*43*/
block|{
literal|"inc"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*44*/
block|{
literal|"inc"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*45*/
block|{
literal|"inc"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*46*/
block|{
literal|"inc"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*47*/
block|{
literal|"inc"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*48*/
block|{
literal|"dec"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*49*/
block|{
literal|"dec"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*4a*/
block|{
literal|"dec"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*4b*/
block|{
literal|"dec"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*4c*/
block|{
literal|"dec"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*4d*/
block|{
literal|"dec"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*4e*/
block|{
literal|"dec"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*4f*/
block|{
literal|"dec"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*50*/
block|{
literal|"push"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*51*/
block|{
literal|"push"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*52*/
block|{
literal|"push"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*53*/
block|{
literal|"push"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*54*/
block|{
literal|"push"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*55*/
block|{
literal|"push"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*56*/
block|{
literal|"push"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*57*/
block|{
literal|"push"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*58*/
block|{
literal|"pop"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*59*/
block|{
literal|"pop"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*5a*/
block|{
literal|"pop"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*5b*/
block|{
literal|"pop"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*5c*/
block|{
literal|"pop"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*5d*/
block|{
literal|"pop"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*5e*/
block|{
literal|"pop"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*5f*/
block|{
literal|"pop"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*60*/
block|{
literal|"pusha"
block|,
name|FALSE
block|,
name|LONG
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*61*/
block|{
literal|"popa"
block|,
name|FALSE
block|,
name|LONG
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*62*/
block|{
literal|"bound"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*63*/
block|{
literal|"arpl"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op2
argument_list|(
name|Rw
argument_list|,
name|Ew
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*64*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*65*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*66*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*67*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*68*/
block|{
literal|"push"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|I
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*69*/
block|{
literal|"imul"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op3
argument_list|(
name|I
argument_list|,
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*6a*/
block|{
literal|"push"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|Ibs
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*6b*/
block|{
literal|"imul"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op3
argument_list|(
name|Ibs
argument_list|,
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*6c*/
block|{
literal|"ins"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|DX
argument_list|,
name|DI
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*6d*/
block|{
literal|"ins"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|DX
argument_list|,
name|DI
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*6e*/
block|{
literal|"outs"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|SI
argument_list|,
name|DX
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*6f*/
block|{
literal|"outs"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|SI
argument_list|,
name|DX
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*70*/
block|{
literal|"jo"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*71*/
block|{
literal|"jno"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*72*/
block|{
literal|"jb"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*73*/
block|{
literal|"jnb"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*74*/
block|{
literal|"jz"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*75*/
block|{
literal|"jnz"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*76*/
block|{
literal|"jbe"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*77*/
block|{
literal|"jnbe"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*78*/
block|{
literal|"js"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*79*/
block|{
literal|"jns"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*7a*/
block|{
literal|"jp"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*7b*/
block|{
literal|"jnp"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*7c*/
block|{
literal|"jl"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*7d*/
block|{
literal|"jnl"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*7e*/
block|{
literal|"jle"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*7f*/
block|{
literal|"jnle"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*80*/
block|{
literal|""
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|E
argument_list|)
block|,
name|db_Grp1
block|}
block|,
comment|/*81*/
block|{
literal|""
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|E
argument_list|)
block|,
name|db_Grp1
block|}
block|,
comment|/*82*/
block|{
literal|""
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|E
argument_list|)
block|,
name|db_Grp1
block|}
block|,
comment|/*83*/
block|{
literal|""
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|Ibs
argument_list|,
name|E
argument_list|)
block|,
name|db_Grp1
block|}
block|,
comment|/*84*/
block|{
literal|"test"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*85*/
block|{
literal|"test"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*86*/
block|{
literal|"xchg"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*87*/
block|{
literal|"xchg"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*88*/
block|{
literal|"mov"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*89*/
block|{
literal|"mov"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|R
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*8a*/
block|{
literal|"mov"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*8b*/
block|{
literal|"mov"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*8c*/
block|{
literal|"mov"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op2
argument_list|(
name|S
argument_list|,
name|Ew
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*8d*/
block|{
literal|"lea"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*8e*/
block|{
literal|"mov"
block|,
name|TRUE
block|,
name|NONE
block|,
name|op2
argument_list|(
name|Ew
argument_list|,
name|S
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*8f*/
block|{
literal|"pop"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*90*/
block|{
literal|"nop"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*91*/
block|{
literal|"xchg"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|A
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*92*/
block|{
literal|"xchg"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|A
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*93*/
block|{
literal|"xchg"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|A
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*94*/
block|{
literal|"xchg"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|A
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*95*/
block|{
literal|"xchg"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|A
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*96*/
block|{
literal|"xchg"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|A
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*97*/
block|{
literal|"xchg"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|A
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*98*/
block|{
literal|"cbw"
block|,
name|FALSE
block|,
name|SDEP
block|,
literal|0
block|,
literal|"cwde"
block|}
block|,
comment|/* cbw/cwde */
comment|/*99*/
block|{
literal|"cwd"
block|,
name|FALSE
block|,
name|SDEP
block|,
literal|0
block|,
literal|"cdq"
block|}
block|,
comment|/* cwd/cdq */
comment|/*9a*/
block|{
literal|"lcall"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|OS
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*9b*/
block|{
literal|"wait"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*9c*/
block|{
literal|"pushf"
block|,
name|FALSE
block|,
name|LONG
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*9d*/
block|{
literal|"popf"
block|,
name|FALSE
block|,
name|LONG
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*9e*/
block|{
literal|"sahf"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*9f*/
block|{
literal|"lahf"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*a0*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|O
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*a1*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|O
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*a2*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|A
argument_list|,
name|O
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*a3*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|A
argument_list|,
name|O
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*a4*/
block|{
literal|"movs"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|SI
argument_list|,
name|DI
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*a5*/
block|{
literal|"movs"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|SI
argument_list|,
name|DI
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*a6*/
block|{
literal|"cmps"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|SI
argument_list|,
name|DI
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*a7*/
block|{
literal|"cmps"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|SI
argument_list|,
name|DI
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*a8*/
block|{
literal|"test"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*a9*/
block|{
literal|"test"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*aa*/
block|{
literal|"stos"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op1
argument_list|(
name|DI
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*ab*/
block|{
literal|"stos"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|DI
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*ac*/
block|{
literal|"lods"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op1
argument_list|(
name|SI
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*ad*/
block|{
literal|"lods"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|SI
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*ae*/
block|{
literal|"scas"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op1
argument_list|(
name|SI
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*af*/
block|{
literal|"scas"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op1
argument_list|(
name|SI
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b0*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b1*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b2*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b3*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b4*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b5*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b6*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b7*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b8*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*b9*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*ba*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*bb*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*bc*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*bd*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*be*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*bf*/
block|{
literal|"mov"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|Ri
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*c0*/
block|{
literal|""
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|Ib
argument_list|,
name|E
argument_list|)
block|,
name|db_Grp2
block|}
block|,
comment|/*c1*/
block|{
literal|""
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|Ib
argument_list|,
name|E
argument_list|)
block|,
name|db_Grp2
block|}
block|,
comment|/*c2*/
block|{
literal|"ret"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Iw
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*c3*/
block|{
literal|"ret"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*c4*/
block|{
literal|"les"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*c5*/
block|{
literal|"lds"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|E
argument_list|,
name|R
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*c6*/
block|{
literal|"mov"
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*c7*/
block|{
literal|"mov"
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|I
argument_list|,
name|E
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*c8*/
block|{
literal|"enter"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op2
argument_list|(
name|Iw
argument_list|,
name|Ib
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*c9*/
block|{
literal|"leave"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*ca*/
block|{
literal|"lret"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Iw
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*cb*/
block|{
literal|"lret"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*cc*/
block|{
literal|"int"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|o3
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*cd*/
block|{
literal|"int"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Ib
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*ce*/
block|{
literal|"into"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*cf*/
block|{
literal|"iret"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*d0*/
block|{
literal|""
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|o1
argument_list|,
name|E
argument_list|)
block|,
name|db_Grp2
block|}
block|,
comment|/*d1*/
block|{
literal|""
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|o1
argument_list|,
name|E
argument_list|)
block|,
name|db_Grp2
block|}
block|,
comment|/*d2*/
block|{
literal|""
block|,
name|TRUE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|CL
argument_list|,
name|E
argument_list|)
block|,
name|db_Grp2
block|}
block|,
comment|/*d3*/
block|{
literal|""
block|,
name|TRUE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|CL
argument_list|,
name|E
argument_list|)
block|,
name|db_Grp2
block|}
block|,
comment|/*d4*/
block|{
literal|"aam"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Iba
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*d5*/
block|{
literal|"aad"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Iba
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*d6*/
block|{
literal|".byte\t0xd6"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*d7*/
block|{
literal|"xlat"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op1
argument_list|(
name|BX
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*d8*/
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
literal|0
block|,
name|db_Esc8
block|}
block|,
comment|/*d9*/
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
literal|0
block|,
name|db_Esc9
block|}
block|,
comment|/*da*/
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
literal|0
block|,
name|db_Esca
block|}
block|,
comment|/*db*/
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
literal|0
block|,
name|db_Escb
block|}
block|,
comment|/*dc*/
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
literal|0
block|,
name|db_Escc
block|}
block|,
comment|/*dd*/
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
literal|0
block|,
name|db_Escd
block|}
block|,
comment|/*de*/
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
literal|0
block|,
name|db_Esce
block|}
block|,
comment|/*df*/
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
literal|0
block|,
name|db_Escf
block|}
block|,
comment|/*e0*/
block|{
literal|"loopne"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*e1*/
block|{
literal|"loope"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*e2*/
block|{
literal|"loop"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*e3*/
block|{
literal|"jcxz"
block|,
name|FALSE
block|,
name|SDEP
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|"jecxz"
block|}
block|,
comment|/*e4*/
block|{
literal|"in"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|Ib
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*e5*/
block|{
literal|"in"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|Ib
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*e6*/
block|{
literal|"out"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|A
argument_list|,
name|Ib
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*e7*/
block|{
literal|"out"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|A
argument_list|,
name|Ib
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*e8*/
block|{
literal|"call"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*e9*/
block|{
literal|"jmp"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Dl
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*ea*/
block|{
literal|"ljmp"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|OS
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*eb*/
block|{
literal|"jmp"
block|,
name|FALSE
block|,
name|NONE
block|,
name|op1
argument_list|(
name|Db
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*ec*/
block|{
literal|"in"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|DX
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*ed*/
block|{
literal|"in"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|DX
argument_list|,
name|A
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*ee*/
block|{
literal|"out"
block|,
name|FALSE
block|,
name|BYTE
block|,
name|op2
argument_list|(
name|A
argument_list|,
name|DX
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*ef*/
block|{
literal|"out"
block|,
name|FALSE
block|,
name|LONG
block|,
name|op2
argument_list|(
name|A
argument_list|,
name|DX
argument_list|)
block|,
literal|0
block|}
block|,
comment|/*f0*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*f1*/
block|{
literal|".byte\t0xf1"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*f2*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*f3*/
block|{
literal|""
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*f4*/
block|{
literal|"hlt"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*f5*/
block|{
literal|"cmc"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*f6*/
block|{
literal|""
block|,
name|TRUE
block|,
name|BYTE
block|,
literal|0
block|,
name|db_Grp3
block|}
block|,
comment|/*f7*/
block|{
literal|""
block|,
name|TRUE
block|,
name|LONG
block|,
literal|0
block|,
name|db_Grp3
block|}
block|,
comment|/*f8*/
block|{
literal|"clc"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*f9*/
block|{
literal|"stc"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*fa*/
block|{
literal|"cli"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*fb*/
block|{
literal|"sti"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*fc*/
block|{
literal|"cld"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*fd*/
block|{
literal|"std"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/*fe*/
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
literal|0
block|,
name|db_Grp4
block|}
block|,
comment|/*ff*/
block|{
literal|""
block|,
name|TRUE
block|,
name|NONE
block|,
literal|0
block|,
name|db_Grp5
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|inst
name|db_bad_inst
init|=
block|{
literal|"???"
block|,
name|FALSE
block|,
name|NONE
block|,
literal|0
block|,
literal|0
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|f_mod
parameter_list|(
name|byte
parameter_list|)
value|((byte)>>6)
end_define

begin_define
define|#
directive|define
name|f_reg
parameter_list|(
name|byte
parameter_list|)
value|(((byte)>>3)&0x7)
end_define

begin_define
define|#
directive|define
name|f_rm
parameter_list|(
name|byte
parameter_list|)
value|((byte)&0x7)
end_define

begin_define
define|#
directive|define
name|sib_ss
parameter_list|(
name|byte
parameter_list|)
value|((byte)>>6)
end_define

begin_define
define|#
directive|define
name|sib_index
parameter_list|(
name|byte
parameter_list|)
value|(((byte)>>3)&0x7)
end_define

begin_define
define|#
directive|define
name|sib_base
parameter_list|(
name|byte
parameter_list|)
value|((byte)&0x7)
end_define

begin_struct
struct|struct
name|i_addr
block|{
name|int
name|is_reg
decl_stmt|;
comment|/* if reg, reg number is in 'disp' */
name|int
name|disp
decl_stmt|;
specifier|const
name|char
modifier|*
name|base
decl_stmt|;
specifier|const
name|char
modifier|*
name|index
decl_stmt|;
name|int
name|ss
decl_stmt|;
block|}
struct|;
end_struct

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_index_reg_16
index|[
literal|8
index|]
init|=
block|{
literal|"%bx,%si"
block|,
literal|"%bx,%di"
block|,
literal|"%bp,%si"
block|,
literal|"%bp,%di"
block|,
literal|"%si"
block|,
literal|"%di"
block|,
literal|"%bp"
block|,
literal|"%bx"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_reg
index|[
literal|3
index|]
index|[
literal|8
index|]
init|=
block|{
block|{
literal|"%al"
block|,
literal|"%cl"
block|,
literal|"%dl"
block|,
literal|"%bl"
block|,
literal|"%ah"
block|,
literal|"%ch"
block|,
literal|"%dh"
block|,
literal|"%bh"
block|}
block|,
block|{
literal|"%ax"
block|,
literal|"%cx"
block|,
literal|"%dx"
block|,
literal|"%bx"
block|,
literal|"%sp"
block|,
literal|"%bp"
block|,
literal|"%si"
block|,
literal|"%di"
block|}
block|,
block|{
literal|"%eax"
block|,
literal|"%ecx"
block|,
literal|"%edx"
block|,
literal|"%ebx"
block|,
literal|"%esp"
block|,
literal|"%ebp"
block|,
literal|"%esi"
block|,
literal|"%edi"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|db_seg_reg
index|[
literal|8
index|]
init|=
block|{
literal|"%es"
block|,
literal|"%cs"
block|,
literal|"%ss"
block|,
literal|"%ds"
block|,
literal|"%fs"
block|,
literal|"%gs"
block|,
literal|""
block|,
literal|""
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * lengths for size attributes  */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|int
name|db_lengths
index|[]
init|=
block|{
literal|1
block|,
comment|/* BYTE */
literal|2
block|,
comment|/* WORD */
literal|4
block|,
comment|/* LONG */
literal|8
block|,
comment|/* QUAD */
literal|4
block|,
comment|/* SNGL */
literal|8
block|,
comment|/* DBLR */
literal|10
block|,
comment|/* EXTR */
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|get_value_inc
parameter_list|(
name|result
parameter_list|,
name|loc
parameter_list|,
name|size
parameter_list|,
name|is_signed
parameter_list|)
define|\
value|result = db_get_value((loc), (size), (is_signed)); \ 	(loc) += (size);
end_define

begin_decl_stmt
specifier|static
name|db_addr_t
name|db_disasm_esc
name|__P
argument_list|(
operator|(
name|db_addr_t
name|loc
operator|,
name|int
name|inst
operator|,
name|int
name|short_addr
operator|,
name|int
name|size
operator|,
specifier|const
name|char
operator|*
name|seg
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|db_print_address
name|__P
argument_list|(
operator|(
specifier|const
name|char
operator|*
name|seg
operator|,
name|int
name|size
operator|,
expr|struct
name|i_addr
operator|*
name|addrp
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|db_addr_t
name|db_read_address
name|__P
argument_list|(
operator|(
name|db_addr_t
name|loc
operator|,
name|int
name|short_addr
operator|,
name|int
name|regmodrm
operator|,
expr|struct
name|i_addr
operator|*
name|addrp
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Read address at location and return updated location.  */
end_comment

begin_function
specifier|static
name|db_addr_t
name|db_read_address
parameter_list|(
name|loc
parameter_list|,
name|short_addr
parameter_list|,
name|regmodrm
parameter_list|,
name|addrp
parameter_list|)
name|db_addr_t
name|loc
decl_stmt|;
name|int
name|short_addr
decl_stmt|;
name|int
name|regmodrm
decl_stmt|;
name|struct
name|i_addr
modifier|*
name|addrp
decl_stmt|;
comment|/* out */
block|{
name|int
name|mod
decl_stmt|,
name|rm
decl_stmt|,
name|sib
decl_stmt|,
name|index
decl_stmt|,
name|disp
decl_stmt|;
name|mod
operator|=
name|f_mod
argument_list|(
name|regmodrm
argument_list|)
expr_stmt|;
name|rm
operator|=
name|f_rm
argument_list|(
name|regmodrm
argument_list|)
expr_stmt|;
if|if
condition|(
name|mod
operator|==
literal|3
condition|)
block|{
name|addrp
operator|->
name|is_reg
operator|=
name|TRUE
expr_stmt|;
name|addrp
operator|->
name|disp
operator|=
name|rm
expr_stmt|;
return|return
operator|(
name|loc
operator|)
return|;
block|}
name|addrp
operator|->
name|is_reg
operator|=
name|FALSE
expr_stmt|;
name|addrp
operator|->
name|index
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|short_addr
condition|)
block|{
name|addrp
operator|->
name|index
operator|=
literal|0
expr_stmt|;
name|addrp
operator|->
name|ss
operator|=
literal|0
expr_stmt|;
switch|switch
condition|(
name|mod
condition|)
block|{
case|case
literal|0
case|:
if|if
condition|(
name|rm
operator|==
literal|6
condition|)
block|{
name|get_value_inc
argument_list|(
name|disp
argument_list|,
name|loc
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|addrp
operator|->
name|disp
operator|=
name|disp
expr_stmt|;
name|addrp
operator|->
name|base
operator|=
literal|0
expr_stmt|;
block|}
else|else
block|{
name|addrp
operator|->
name|disp
operator|=
literal|0
expr_stmt|;
name|addrp
operator|->
name|base
operator|=
name|db_index_reg_16
index|[
name|rm
index|]
expr_stmt|;
block|}
break|break;
case|case
literal|1
case|:
name|get_value_inc
argument_list|(
name|disp
argument_list|,
name|loc
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|disp
operator|&=
literal|0xFFFF
expr_stmt|;
name|addrp
operator|->
name|disp
operator|=
name|disp
expr_stmt|;
name|addrp
operator|->
name|base
operator|=
name|db_index_reg_16
index|[
name|rm
index|]
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|get_value_inc
argument_list|(
name|disp
argument_list|,
name|loc
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|addrp
operator|->
name|disp
operator|=
name|disp
expr_stmt|;
name|addrp
operator|->
name|base
operator|=
name|db_index_reg_16
index|[
name|rm
index|]
expr_stmt|;
break|break;
block|}
block|}
else|else
block|{
if|if
condition|(
name|mod
operator|!=
literal|3
operator|&&
name|rm
operator|==
literal|4
condition|)
block|{
name|get_value_inc
argument_list|(
name|sib
argument_list|,
name|loc
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|rm
operator|=
name|sib_base
argument_list|(
name|sib
argument_list|)
expr_stmt|;
name|index
operator|=
name|sib_index
argument_list|(
name|sib
argument_list|)
expr_stmt|;
if|if
condition|(
name|index
operator|!=
literal|4
condition|)
name|addrp
operator|->
name|index
operator|=
name|db_reg
index|[
name|LONG
index|]
index|[
name|index
index|]
expr_stmt|;
name|addrp
operator|->
name|ss
operator|=
name|sib_ss
argument_list|(
name|sib
argument_list|)
expr_stmt|;
block|}
switch|switch
condition|(
name|mod
condition|)
block|{
case|case
literal|0
case|:
if|if
condition|(
name|rm
operator|==
literal|5
condition|)
block|{
name|get_value_inc
argument_list|(
name|addrp
operator|->
name|disp
argument_list|,
name|loc
argument_list|,
literal|4
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|addrp
operator|->
name|base
operator|=
literal|0
expr_stmt|;
block|}
else|else
block|{
name|addrp
operator|->
name|disp
operator|=
literal|0
expr_stmt|;
name|addrp
operator|->
name|base
operator|=
name|db_reg
index|[
name|LONG
index|]
index|[
name|rm
index|]
expr_stmt|;
block|}
break|break;
case|case
literal|1
case|:
name|get_value_inc
argument_list|(
name|disp
argument_list|,
name|loc
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|addrp
operator|->
name|disp
operator|=
name|disp
expr_stmt|;
name|addrp
operator|->
name|base
operator|=
name|db_reg
index|[
name|LONG
index|]
index|[
name|rm
index|]
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|get_value_inc
argument_list|(
name|disp
argument_list|,
name|loc
argument_list|,
literal|4
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|addrp
operator|->
name|disp
operator|=
name|disp
expr_stmt|;
name|addrp
operator|->
name|base
operator|=
name|db_reg
index|[
name|LONG
index|]
index|[
name|rm
index|]
expr_stmt|;
break|break;
block|}
block|}
return|return
operator|(
name|loc
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|db_print_address
parameter_list|(
name|seg
parameter_list|,
name|size
parameter_list|,
name|addrp
parameter_list|)
specifier|const
name|char
modifier|*
name|seg
decl_stmt|;
name|int
name|size
decl_stmt|;
name|struct
name|i_addr
modifier|*
name|addrp
decl_stmt|;
block|{
if|if
condition|(
name|addrp
operator|->
name|is_reg
condition|)
block|{
name|db_printf
argument_list|(
literal|"%s"
argument_list|,
name|db_reg
index|[
name|size
index|]
index|[
name|addrp
operator|->
name|disp
index|]
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|seg
condition|)
block|{
name|db_printf
argument_list|(
literal|"%s:"
argument_list|,
name|seg
argument_list|)
expr_stmt|;
block|}
name|db_printsym
argument_list|(
operator|(
name|db_addr_t
operator|)
name|addrp
operator|->
name|disp
argument_list|,
name|DB_STGY_ANY
argument_list|)
expr_stmt|;
if|if
condition|(
name|addrp
operator|->
name|base
operator|!=
literal|0
operator|||
name|addrp
operator|->
name|index
operator|!=
literal|0
condition|)
block|{
name|db_printf
argument_list|(
literal|"("
argument_list|)
expr_stmt|;
if|if
condition|(
name|addrp
operator|->
name|base
condition|)
name|db_printf
argument_list|(
literal|"%s"
argument_list|,
name|addrp
operator|->
name|base
argument_list|)
expr_stmt|;
if|if
condition|(
name|addrp
operator|->
name|index
condition|)
name|db_printf
argument_list|(
literal|",%s,%d"
argument_list|,
name|addrp
operator|->
name|index
argument_list|,
literal|1
operator|<<
name|addrp
operator|->
name|ss
argument_list|)
expr_stmt|;
name|db_printf
argument_list|(
literal|")"
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*  * Disassemble floating-point ("escape") instruction  * and return updated location.  */
end_comment

begin_function
specifier|static
name|db_addr_t
name|db_disasm_esc
parameter_list|(
name|loc
parameter_list|,
name|inst
parameter_list|,
name|short_addr
parameter_list|,
name|size
parameter_list|,
name|seg
parameter_list|)
name|db_addr_t
name|loc
decl_stmt|;
name|int
name|inst
decl_stmt|;
name|int
name|short_addr
decl_stmt|;
name|int
name|size
decl_stmt|;
specifier|const
name|char
modifier|*
name|seg
decl_stmt|;
block|{
name|int
name|regmodrm
decl_stmt|;
specifier|const
name|struct
name|finst
modifier|*
name|fp
decl_stmt|;
name|int
name|mod
decl_stmt|;
name|struct
name|i_addr
name|address
decl_stmt|;
specifier|const
name|char
modifier|*
name|name
decl_stmt|;
name|get_value_inc
argument_list|(
name|regmodrm
argument_list|,
name|loc
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|fp
operator|=
operator|&
name|db_Esc_inst
index|[
name|inst
operator|-
literal|0xd8
index|]
index|[
name|f_reg
argument_list|(
name|regmodrm
argument_list|)
index|]
expr_stmt|;
name|mod
operator|=
name|f_mod
argument_list|(
name|regmodrm
argument_list|)
expr_stmt|;
if|if
condition|(
name|mod
operator|!=
literal|3
condition|)
block|{
if|if
condition|(
operator|*
name|fp
operator|->
name|f_name
operator|==
literal|'\0'
condition|)
block|{
name|db_printf
argument_list|(
literal|"<bad instruction>"
argument_list|)
expr_stmt|;
return|return
operator|(
name|loc
operator|)
return|;
block|}
comment|/* 	     * Normal address modes. 	     */
name|loc
operator|=
name|db_read_address
argument_list|(
name|loc
argument_list|,
name|short_addr
argument_list|,
name|regmodrm
argument_list|,
operator|&
name|address
argument_list|)
expr_stmt|;
name|db_printf
argument_list|(
literal|"%s"
argument_list|,
name|fp
operator|->
name|f_name
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|fp
operator|->
name|f_size
condition|)
block|{
case|case
name|SNGL
case|:
name|db_printf
argument_list|(
literal|"s"
argument_list|)
expr_stmt|;
break|break;
case|case
name|DBLR
case|:
name|db_printf
argument_list|(
literal|"l"
argument_list|)
expr_stmt|;
break|break;
case|case
name|EXTR
case|:
name|db_printf
argument_list|(
literal|"t"
argument_list|)
expr_stmt|;
break|break;
case|case
name|WORD
case|:
name|db_printf
argument_list|(
literal|"s"
argument_list|)
expr_stmt|;
break|break;
case|case
name|LONG
case|:
name|db_printf
argument_list|(
literal|"l"
argument_list|)
expr_stmt|;
break|break;
case|case
name|QUAD
case|:
name|db_printf
argument_list|(
literal|"q"
argument_list|)
expr_stmt|;
break|break;
default|default:
break|break;
block|}
name|db_printf
argument_list|(
literal|"\t"
argument_list|)
expr_stmt|;
name|db_print_address
argument_list|(
name|seg
argument_list|,
name|BYTE
argument_list|,
operator|&
name|address
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|/* 	     * 'reg-reg' - special formats 	     */
switch|switch
condition|(
name|fp
operator|->
name|f_rrmode
condition|)
block|{
case|case
name|op2
argument_list|(
name|ST
argument_list|,
name|STI
argument_list|)
case|:
name|name
operator|=
operator|(
name|fp
operator|->
name|f_rrname
operator|)
condition|?
name|fp
operator|->
name|f_rrname
else|:
name|fp
operator|->
name|f_name
expr_stmt|;
name|db_printf
argument_list|(
literal|"%s\t%%st,%%st(%d)"
argument_list|,
name|name
argument_list|,
name|f_rm
argument_list|(
name|regmodrm
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|op2
argument_list|(
name|STI
argument_list|,
name|ST
argument_list|)
case|:
name|name
operator|=
operator|(
name|fp
operator|->
name|f_rrname
operator|)
condition|?
name|fp
operator|->
name|f_rrname
else|:
name|fp
operator|->
name|f_name
expr_stmt|;
name|db_printf
argument_list|(
literal|"%s\t%%st(%d),%%st"
argument_list|,
name|name
argument_list|,
name|f_rm
argument_list|(
name|regmodrm
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|op1
argument_list|(
name|STI
argument_list|)
case|:
name|name
operator|=
operator|(
name|fp
operator|->
name|f_rrname
operator|)
condition|?
name|fp
operator|->
name|f_rrname
else|:
name|fp
operator|->
name|f_name
expr_stmt|;
name|db_printf
argument_list|(
literal|"%s\t%%st(%d)"
argument_list|,
name|name
argument_list|,
name|f_rm
argument_list|(
name|regmodrm
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|op1
argument_list|(
name|X
argument_list|)
case|:
name|name
operator|=
operator|(
operator|(
specifier|const
name|char
operator|*
specifier|const
operator|*
operator|)
name|fp
operator|->
name|f_rrname
operator|)
index|[
name|f_rm
argument_list|(
name|regmodrm
argument_list|)
index|]
expr_stmt|;
if|if
condition|(
operator|*
name|name
operator|==
literal|'\0'
condition|)
goto|goto
name|bad
goto|;
name|db_printf
argument_list|(
literal|"%s"
argument_list|,
name|name
argument_list|)
expr_stmt|;
break|break;
case|case
name|op1
argument_list|(
name|XA
argument_list|)
case|:
name|name
operator|=
operator|(
operator|(
specifier|const
name|char
operator|*
specifier|const
operator|*
operator|)
name|fp
operator|->
name|f_rrname
operator|)
index|[
name|f_rm
argument_list|(
name|regmodrm
argument_list|)
index|]
expr_stmt|;
if|if
condition|(
operator|*
name|name
operator|==
literal|'\0'
condition|)
goto|goto
name|bad
goto|;
name|db_printf
argument_list|(
literal|"%s\t%%ax"
argument_list|,
name|name
argument_list|)
expr_stmt|;
break|break;
default|default:
name|bad
label|:
name|db_printf
argument_list|(
literal|"<bad instruction>"
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
return|return
operator|(
name|loc
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Disassemble instruction at 'loc'.  'altfmt' specifies an  * (optional) alternate format.  Return address of start of  * next instruction.  */
end_comment

begin_function
name|db_addr_t
name|db_disasm
parameter_list|(
name|loc
parameter_list|,
name|altfmt
parameter_list|)
name|db_addr_t
name|loc
decl_stmt|;
name|boolean_t
name|altfmt
decl_stmt|;
block|{
name|int
name|inst
decl_stmt|;
name|int
name|size
decl_stmt|;
name|int
name|short_addr
decl_stmt|;
specifier|const
name|char
modifier|*
name|seg
decl_stmt|;
specifier|const
name|struct
name|inst
modifier|*
name|ip
decl_stmt|;
specifier|const
name|char
modifier|*
name|i_name
decl_stmt|;
name|int
name|i_size
decl_stmt|;
name|int
name|i_mode
decl_stmt|;
name|int
name|regmodrm
init|=
literal|0
decl_stmt|;
name|boolean_t
name|first
decl_stmt|;
name|int
name|displ
decl_stmt|;
name|int
name|prefix
decl_stmt|;
name|int
name|imm
decl_stmt|;
name|int
name|imm2
decl_stmt|;
name|int
name|len
decl_stmt|;
name|struct
name|i_addr
name|address
decl_stmt|;
name|get_value_inc
argument_list|(
name|inst
argument_list|,
name|loc
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|short_addr
operator|=
name|FALSE
expr_stmt|;
name|size
operator|=
name|LONG
expr_stmt|;
name|seg
operator|=
literal|0
expr_stmt|;
comment|/* 	 * Get prefixes 	 */
name|prefix
operator|=
name|TRUE
expr_stmt|;
do|do
block|{
switch|switch
condition|(
name|inst
condition|)
block|{
case|case
literal|0x66
case|:
comment|/* data16 */
name|size
operator|=
name|WORD
expr_stmt|;
break|break;
case|case
literal|0x67
case|:
name|short_addr
operator|=
name|TRUE
expr_stmt|;
break|break;
case|case
literal|0x26
case|:
name|seg
operator|=
literal|"%es"
expr_stmt|;
break|break;
case|case
literal|0x36
case|:
name|seg
operator|=
literal|"%ss"
expr_stmt|;
break|break;
case|case
literal|0x2e
case|:
name|seg
operator|=
literal|"%cs"
expr_stmt|;
break|break;
case|case
literal|0x3e
case|:
name|seg
operator|=
literal|"%ds"
expr_stmt|;
break|break;
case|case
literal|0x64
case|:
name|seg
operator|=
literal|"%fs"
expr_stmt|;
break|break;
case|case
literal|0x65
case|:
name|seg
operator|=
literal|"%gs"
expr_stmt|;
break|break;
case|case
literal|0xf0
case|:
name|db_printf
argument_list|(
literal|"lock "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0xf2
case|:
name|db_printf
argument_list|(
literal|"repne "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0xf3
case|:
name|db_printf
argument_list|(
literal|"repe "
argument_list|)
expr_stmt|;
comment|/* XXX repe VS rep */
break|break;
default|default:
name|prefix
operator|=
name|FALSE
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|prefix
condition|)
block|{
name|get_value_inc
argument_list|(
name|inst
argument_list|,
name|loc
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
block|}
block|}
do|while
condition|(
name|prefix
condition|)
do|;
if|if
condition|(
name|inst
operator|>=
literal|0xd8
operator|&&
name|inst
operator|<=
literal|0xdf
condition|)
block|{
name|loc
operator|=
name|db_disasm_esc
argument_list|(
name|loc
argument_list|,
name|inst
argument_list|,
name|short_addr
argument_list|,
name|size
argument_list|,
name|seg
argument_list|)
expr_stmt|;
name|db_printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
return|return
operator|(
name|loc
operator|)
return|;
block|}
if|if
condition|(
name|inst
operator|==
literal|0x0f
condition|)
block|{
name|get_value_inc
argument_list|(
name|inst
argument_list|,
name|loc
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|ip
operator|=
name|db_inst_0f
index|[
name|inst
operator|>>
literal|4
index|]
expr_stmt|;
if|if
condition|(
name|ip
operator|==
literal|0
condition|)
block|{
name|ip
operator|=
operator|&
name|db_bad_inst
expr_stmt|;
block|}
else|else
block|{
name|ip
operator|=
operator|&
name|ip
index|[
name|inst
operator|&
literal|0xf
index|]
expr_stmt|;
block|}
block|}
else|else
name|ip
operator|=
operator|&
name|db_inst_table
index|[
name|inst
index|]
expr_stmt|;
if|if
condition|(
name|ip
operator|->
name|i_has_modrm
condition|)
block|{
name|get_value_inc
argument_list|(
name|regmodrm
argument_list|,
name|loc
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|loc
operator|=
name|db_read_address
argument_list|(
name|loc
argument_list|,
name|short_addr
argument_list|,
name|regmodrm
argument_list|,
operator|&
name|address
argument_list|)
expr_stmt|;
block|}
name|i_name
operator|=
name|ip
operator|->
name|i_name
expr_stmt|;
name|i_size
operator|=
name|ip
operator|->
name|i_size
expr_stmt|;
name|i_mode
operator|=
name|ip
operator|->
name|i_mode
expr_stmt|;
if|if
condition|(
name|ip
operator|->
name|i_extra
operator|==
name|db_Grp1
operator|||
name|ip
operator|->
name|i_extra
operator|==
name|db_Grp2
operator|||
name|ip
operator|->
name|i_extra
operator|==
name|db_Grp6
operator|||
name|ip
operator|->
name|i_extra
operator|==
name|db_Grp7
operator|||
name|ip
operator|->
name|i_extra
operator|==
name|db_Grp8
operator|||
name|ip
operator|->
name|i_extra
operator|==
name|db_Grp9
condition|)
block|{
name|i_name
operator|=
operator|(
operator|(
specifier|const
name|char
operator|*
specifier|const
operator|*
operator|)
name|ip
operator|->
name|i_extra
operator|)
index|[
name|f_reg
argument_list|(
name|regmodrm
argument_list|)
index|]
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|ip
operator|->
name|i_extra
operator|==
name|db_Grp3
condition|)
block|{
name|ip
operator|=
name|ip
operator|->
name|i_extra
expr_stmt|;
name|ip
operator|=
operator|&
name|ip
index|[
name|f_reg
argument_list|(
name|regmodrm
argument_list|)
index|]
expr_stmt|;
name|i_name
operator|=
name|ip
operator|->
name|i_name
expr_stmt|;
name|i_mode
operator|=
name|ip
operator|->
name|i_mode
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|ip
operator|->
name|i_extra
operator|==
name|db_Grp4
operator|||
name|ip
operator|->
name|i_extra
operator|==
name|db_Grp5
condition|)
block|{
name|ip
operator|=
name|ip
operator|->
name|i_extra
expr_stmt|;
name|ip
operator|=
operator|&
name|ip
index|[
name|f_reg
argument_list|(
name|regmodrm
argument_list|)
index|]
expr_stmt|;
name|i_name
operator|=
name|ip
operator|->
name|i_name
expr_stmt|;
name|i_mode
operator|=
name|ip
operator|->
name|i_mode
expr_stmt|;
name|i_size
operator|=
name|ip
operator|->
name|i_size
expr_stmt|;
block|}
if|if
condition|(
name|i_size
operator|==
name|SDEP
condition|)
block|{
if|if
condition|(
name|size
operator|==
name|WORD
condition|)
name|db_printf
argument_list|(
literal|"%s"
argument_list|,
name|i_name
argument_list|)
expr_stmt|;
else|else
name|db_printf
argument_list|(
literal|"%s"
argument_list|,
operator|(
specifier|const
name|char
operator|*
operator|)
name|ip
operator|->
name|i_extra
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|db_printf
argument_list|(
literal|"%s"
argument_list|,
name|i_name
argument_list|)
expr_stmt|;
if|if
condition|(
name|i_size
operator|!=
name|NONE
condition|)
block|{
if|if
condition|(
name|i_size
operator|==
name|BYTE
condition|)
block|{
name|db_printf
argument_list|(
literal|"b"
argument_list|)
expr_stmt|;
name|size
operator|=
name|BYTE
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|i_size
operator|==
name|WORD
condition|)
block|{
name|db_printf
argument_list|(
literal|"w"
argument_list|)
expr_stmt|;
name|size
operator|=
name|WORD
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|size
operator|==
name|WORD
condition|)
name|db_printf
argument_list|(
literal|"w"
argument_list|)
expr_stmt|;
else|else
name|db_printf
argument_list|(
literal|"l"
argument_list|)
expr_stmt|;
block|}
block|}
name|db_printf
argument_list|(
literal|"\t"
argument_list|)
expr_stmt|;
for|for
control|(
name|first
operator|=
name|TRUE
init|;
name|i_mode
operator|!=
literal|0
condition|;
name|i_mode
operator|>>=
literal|8
operator|,
name|first
operator|=
name|FALSE
control|)
block|{
if|if
condition|(
operator|!
name|first
condition|)
name|db_printf
argument_list|(
literal|","
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|i_mode
operator|&
literal|0xFF
condition|)
block|{
case|case
name|E
case|:
name|db_print_address
argument_list|(
name|seg
argument_list|,
name|size
argument_list|,
operator|&
name|address
argument_list|)
expr_stmt|;
break|break;
case|case
name|Eind
case|:
name|db_printf
argument_list|(
literal|"*"
argument_list|)
expr_stmt|;
name|db_print_address
argument_list|(
name|seg
argument_list|,
name|size
argument_list|,
operator|&
name|address
argument_list|)
expr_stmt|;
break|break;
case|case
name|El
case|:
name|db_print_address
argument_list|(
name|seg
argument_list|,
name|LONG
argument_list|,
operator|&
name|address
argument_list|)
expr_stmt|;
break|break;
case|case
name|Ew
case|:
name|db_print_address
argument_list|(
name|seg
argument_list|,
name|WORD
argument_list|,
operator|&
name|address
argument_list|)
expr_stmt|;
break|break;
case|case
name|Eb
case|:
name|db_print_address
argument_list|(
name|seg
argument_list|,
name|BYTE
argument_list|,
operator|&
name|address
argument_list|)
expr_stmt|;
break|break;
case|case
name|R
case|:
name|db_printf
argument_list|(
literal|"%s"
argument_list|,
name|db_reg
index|[
name|size
index|]
index|[
name|f_reg
argument_list|(
name|regmodrm
argument_list|)
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Rw
case|:
name|db_printf
argument_list|(
literal|"%s"
argument_list|,
name|db_reg
index|[
name|WORD
index|]
index|[
name|f_reg
argument_list|(
name|regmodrm
argument_list|)
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Ri
case|:
name|db_printf
argument_list|(
literal|"%s"
argument_list|,
name|db_reg
index|[
name|size
index|]
index|[
name|f_rm
argument_list|(
name|inst
argument_list|)
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Ril
case|:
name|db_printf
argument_list|(
literal|"%s"
argument_list|,
name|db_reg
index|[
name|LONG
index|]
index|[
name|f_rm
argument_list|(
name|inst
argument_list|)
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|S
case|:
name|db_printf
argument_list|(
literal|"%s"
argument_list|,
name|db_seg_reg
index|[
name|f_reg
argument_list|(
name|regmodrm
argument_list|)
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Si
case|:
name|db_printf
argument_list|(
literal|"%s"
argument_list|,
name|db_seg_reg
index|[
name|f_reg
argument_list|(
name|inst
argument_list|)
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|A
case|:
name|db_printf
argument_list|(
literal|"%s"
argument_list|,
name|db_reg
index|[
name|size
index|]
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
comment|/* acc */
break|break;
case|case
name|BX
case|:
if|if
condition|(
name|seg
condition|)
name|db_printf
argument_list|(
literal|"%s:"
argument_list|,
name|seg
argument_list|)
expr_stmt|;
name|db_printf
argument_list|(
literal|"(%s)"
argument_list|,
name|short_addr
condition|?
literal|"%bx"
else|:
literal|"%ebx"
argument_list|)
expr_stmt|;
break|break;
case|case
name|CL
case|:
name|db_printf
argument_list|(
literal|"%%cl"
argument_list|)
expr_stmt|;
break|break;
case|case
name|DX
case|:
name|db_printf
argument_list|(
literal|"%%dx"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SI
case|:
if|if
condition|(
name|seg
condition|)
name|db_printf
argument_list|(
literal|"%s:"
argument_list|,
name|seg
argument_list|)
expr_stmt|;
name|db_printf
argument_list|(
literal|"(%s)"
argument_list|,
name|short_addr
condition|?
literal|"%si"
else|:
literal|"%esi"
argument_list|)
expr_stmt|;
break|break;
case|case
name|DI
case|:
name|db_printf
argument_list|(
literal|"%%es:(%s)"
argument_list|,
name|short_addr
condition|?
literal|"%di"
else|:
literal|"%edi"
argument_list|)
expr_stmt|;
break|break;
case|case
name|CR
case|:
name|db_printf
argument_list|(
literal|"%%cr%d"
argument_list|,
name|f_reg
argument_list|(
name|regmodrm
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|DR
case|:
name|db_printf
argument_list|(
literal|"%%dr%d"
argument_list|,
name|f_reg
argument_list|(
name|regmodrm
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|TR
case|:
name|db_printf
argument_list|(
literal|"%%tr%d"
argument_list|,
name|f_reg
argument_list|(
name|regmodrm
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|I
case|:
name|len
operator|=
name|db_lengths
index|[
name|size
index|]
expr_stmt|;
name|get_value_inc
argument_list|(
name|imm
argument_list|,
name|loc
argument_list|,
name|len
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|db_printf
argument_list|(
literal|"$%#r"
argument_list|,
name|imm
argument_list|)
expr_stmt|;
break|break;
case|case
name|Is
case|:
name|len
operator|=
name|db_lengths
index|[
name|size
index|]
expr_stmt|;
name|get_value_inc
argument_list|(
name|imm
argument_list|,
name|loc
argument_list|,
name|len
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|db_printf
argument_list|(
literal|"$%+#r"
argument_list|,
name|imm
argument_list|)
expr_stmt|;
break|break;
case|case
name|Ib
case|:
name|get_value_inc
argument_list|(
name|imm
argument_list|,
name|loc
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|db_printf
argument_list|(
literal|"$%#r"
argument_list|,
name|imm
argument_list|)
expr_stmt|;
break|break;
case|case
name|Iba
case|:
name|get_value_inc
argument_list|(
name|imm
argument_list|,
name|loc
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
if|if
condition|(
name|imm
operator|!=
literal|0x0a
condition|)
name|db_printf
argument_list|(
literal|"$%#r"
argument_list|,
name|imm
argument_list|)
expr_stmt|;
break|break;
case|case
name|Ibs
case|:
name|get_value_inc
argument_list|(
name|imm
argument_list|,
name|loc
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
if|if
condition|(
name|size
operator|==
name|WORD
condition|)
name|imm
operator|&=
literal|0xFFFF
expr_stmt|;
name|db_printf
argument_list|(
literal|"$%+#r"
argument_list|,
name|imm
argument_list|)
expr_stmt|;
break|break;
case|case
name|Iw
case|:
name|get_value_inc
argument_list|(
name|imm
argument_list|,
name|loc
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|db_printf
argument_list|(
literal|"$%#r"
argument_list|,
name|imm
argument_list|)
expr_stmt|;
break|break;
case|case
name|O
case|:
name|len
operator|=
operator|(
name|short_addr
condition|?
literal|2
else|:
literal|4
operator|)
expr_stmt|;
name|get_value_inc
argument_list|(
name|displ
argument_list|,
name|loc
argument_list|,
name|len
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
if|if
condition|(
name|seg
condition|)
name|db_printf
argument_list|(
literal|"%s:%+#r"
argument_list|,
name|seg
argument_list|,
name|displ
argument_list|)
expr_stmt|;
else|else
name|db_printsym
argument_list|(
operator|(
name|db_addr_t
operator|)
name|displ
argument_list|,
name|DB_STGY_ANY
argument_list|)
expr_stmt|;
break|break;
case|case
name|Db
case|:
name|get_value_inc
argument_list|(
name|displ
argument_list|,
name|loc
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|displ
operator|+=
name|loc
expr_stmt|;
if|if
condition|(
name|size
operator|==
name|WORD
condition|)
name|displ
operator|&=
literal|0xFFFF
expr_stmt|;
name|db_printsym
argument_list|(
operator|(
name|db_addr_t
operator|)
name|displ
argument_list|,
name|DB_STGY_XTRN
argument_list|)
expr_stmt|;
break|break;
case|case
name|Dl
case|:
name|len
operator|=
name|db_lengths
index|[
name|size
index|]
expr_stmt|;
name|get_value_inc
argument_list|(
name|displ
argument_list|,
name|loc
argument_list|,
name|len
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|displ
operator|+=
name|loc
expr_stmt|;
if|if
condition|(
name|size
operator|==
name|WORD
condition|)
name|displ
operator|&=
literal|0xFFFF
expr_stmt|;
name|db_printsym
argument_list|(
operator|(
name|db_addr_t
operator|)
name|displ
argument_list|,
name|DB_STGY_XTRN
argument_list|)
expr_stmt|;
break|break;
case|case
name|o1
case|:
name|db_printf
argument_list|(
literal|"$1"
argument_list|)
expr_stmt|;
break|break;
case|case
name|o3
case|:
name|db_printf
argument_list|(
literal|"$3"
argument_list|)
expr_stmt|;
break|break;
case|case
name|OS
case|:
name|len
operator|=
name|db_lengths
index|[
name|size
index|]
expr_stmt|;
name|get_value_inc
argument_list|(
name|imm
argument_list|,
name|loc
argument_list|,
name|len
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* offset */
name|get_value_inc
argument_list|(
name|imm2
argument_list|,
name|loc
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* segment */
name|db_printf
argument_list|(
literal|"$%#r,%#r"
argument_list|,
name|imm2
argument_list|,
name|imm
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
name|db_printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
return|return
operator|(
name|loc
operator|)
return|;
block|}
end_function

end_unit

