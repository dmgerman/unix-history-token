begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/******************************************************************************* * Copyright (c) 2013, Intel Corporation  *  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions are * met:  *  * * Redistributions of source code must retain the above copyright *   notice, this list of conditions and the following disclaimer.   *  * * Redistributions in binary form must reproduce the above copyright *   notice, this list of conditions and the following disclaimer in the *   documentation and/or other materials provided with the *   distribution.  *  * * Neither the name of the Intel Corporation nor the names of its *   contributors may be used to endorse or promote products derived from *   this software without specific prior written permission.  *  *  * THIS SOFTWARE IS PROVIDED BY INTEL CORPORATION ""AS IS"" AND ANY * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR * PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL INTEL CORPORATION OR * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. ******************************************************************************** * * Intel SHA Extensions optimized implementation of a SHA-1 update function  *  * The function takes a pointer to the current hash values, a pointer to the  * input data, and a number of 64 byte blocks to process.  Once all blocks have  * been processed, the digest pointer is  updated with the resulting hash value. * The function only processes complete blocks, there is no functionality to  * store partial blocks.  All message padding and hash value initialization must * be done outside the update function.   *  * The indented lines in the loop are instructions related to rounds processing. * The non-indented lines are instructions related to the message schedule. *  * Author: Sean Gulley<sean.m.gulley@intel.com> * Date:   July 2013 * ******************************************************************************** * * Example complier command line: * icc intel_sha_extensions_sha1_intrinsic.c * gcc -msha -msse4 intel_sha_extensions_sha1_intrinsic.c * *******************************************************************************/
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|<immintrin.h>
end_include

begin_include
include|#
directive|include
file|<crypto/aesni/sha_sse.h>
end_include

begin_function
name|void
name|intel_sha1_step
parameter_list|(
name|uint32_t
modifier|*
name|digest
parameter_list|,
specifier|const
name|char
modifier|*
name|data
parameter_list|,
name|uint32_t
name|num_blks
parameter_list|)
block|{
name|__m128i
name|abcd
decl_stmt|,
name|e0
decl_stmt|,
name|e1
decl_stmt|;
name|__m128i
name|abcd_save
decl_stmt|,
name|e_save
decl_stmt|;
name|__m128i
name|msg0
decl_stmt|,
name|msg1
decl_stmt|,
name|msg2
decl_stmt|,
name|msg3
decl_stmt|;
name|__m128i
name|shuf_mask
decl_stmt|,
name|e_mask
decl_stmt|;
if|#
directive|if
literal|0
block|e_mask    = _mm_set_epi64x(0xFFFFFFFF00000000ull, 0x0000000000000000ull);
else|#
directive|else
operator|(
name|void
operator|)
name|e_mask
expr_stmt|;
name|e0
operator|=
name|_mm_set_epi64x
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|shuf_mask
operator|=
name|_mm_set_epi64x
argument_list|(
literal|0x0001020304050607ull
argument_list|,
literal|0x08090a0b0c0d0e0full
argument_list|)
expr_stmt|;
comment|// Load initial hash values
name|abcd
operator|=
name|_mm_loadu_si128
argument_list|(
operator|(
name|__m128i
operator|*
operator|)
name|digest
argument_list|)
expr_stmt|;
name|e0
operator|=
name|_mm_insert_epi32
argument_list|(
name|e0
argument_list|,
operator|*
operator|(
name|digest
operator|+
literal|4
operator|)
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_shuffle_epi32
argument_list|(
name|abcd
argument_list|,
literal|0x1B
argument_list|)
expr_stmt|;
if|#
directive|if
literal|0
block|e0        = _mm_and_si128(e0, e_mask);
endif|#
directive|endif
while|while
condition|(
name|num_blks
operator|>
literal|0
condition|)
block|{
comment|// Save hash values for addition after rounds
name|abcd_save
operator|=
name|abcd
expr_stmt|;
name|e_save
operator|=
name|e0
expr_stmt|;
comment|// Rounds 0-3
name|msg0
operator|=
name|_mm_loadu_si128
argument_list|(
operator|(
specifier|const
name|__m128i
operator|*
operator|)
name|data
argument_list|)
expr_stmt|;
name|msg0
operator|=
name|_mm_shuffle_epi8
argument_list|(
name|msg0
argument_list|,
name|shuf_mask
argument_list|)
expr_stmt|;
name|e0
operator|=
name|_mm_add_epi32
argument_list|(
name|e0
argument_list|,
name|msg0
argument_list|)
expr_stmt|;
name|e1
operator|=
name|abcd
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|// Rounds 4-7
name|msg1
operator|=
name|_mm_loadu_si128
argument_list|(
operator|(
specifier|const
name|__m128i
operator|*
operator|)
operator|(
name|data
operator|+
literal|16
operator|)
argument_list|)
expr_stmt|;
name|msg1
operator|=
name|_mm_shuffle_epi8
argument_list|(
name|msg1
argument_list|,
name|shuf_mask
argument_list|)
expr_stmt|;
name|e1
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e1
argument_list|,
name|msg1
argument_list|)
expr_stmt|;
name|e0
operator|=
name|abcd
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|msg0
operator|=
name|_mm_sha1msg1_epu32
argument_list|(
name|msg0
argument_list|,
name|msg1
argument_list|)
expr_stmt|;
comment|// Rounds 8-11
name|msg2
operator|=
name|_mm_loadu_si128
argument_list|(
operator|(
specifier|const
name|__m128i
operator|*
operator|)
operator|(
name|data
operator|+
literal|32
operator|)
argument_list|)
expr_stmt|;
name|msg2
operator|=
name|_mm_shuffle_epi8
argument_list|(
name|msg2
argument_list|,
name|shuf_mask
argument_list|)
expr_stmt|;
name|e0
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e0
argument_list|,
name|msg2
argument_list|)
expr_stmt|;
name|e1
operator|=
name|abcd
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|msg1
operator|=
name|_mm_sha1msg1_epu32
argument_list|(
name|msg1
argument_list|,
name|msg2
argument_list|)
expr_stmt|;
name|msg0
operator|=
name|_mm_xor_si128
argument_list|(
name|msg0
argument_list|,
name|msg2
argument_list|)
expr_stmt|;
comment|// Rounds 12-15
name|msg3
operator|=
name|_mm_loadu_si128
argument_list|(
operator|(
specifier|const
name|__m128i
operator|*
operator|)
operator|(
name|data
operator|+
literal|48
operator|)
argument_list|)
expr_stmt|;
name|msg3
operator|=
name|_mm_shuffle_epi8
argument_list|(
name|msg3
argument_list|,
name|shuf_mask
argument_list|)
expr_stmt|;
name|e1
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e1
argument_list|,
name|msg3
argument_list|)
expr_stmt|;
name|e0
operator|=
name|abcd
expr_stmt|;
name|msg0
operator|=
name|_mm_sha1msg2_epu32
argument_list|(
name|msg0
argument_list|,
name|msg3
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|msg2
operator|=
name|_mm_sha1msg1_epu32
argument_list|(
name|msg2
argument_list|,
name|msg3
argument_list|)
expr_stmt|;
name|msg1
operator|=
name|_mm_xor_si128
argument_list|(
name|msg1
argument_list|,
name|msg3
argument_list|)
expr_stmt|;
comment|// Rounds 16-19
name|e0
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e0
argument_list|,
name|msg0
argument_list|)
expr_stmt|;
name|e1
operator|=
name|abcd
expr_stmt|;
name|msg1
operator|=
name|_mm_sha1msg2_epu32
argument_list|(
name|msg1
argument_list|,
name|msg0
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|msg3
operator|=
name|_mm_sha1msg1_epu32
argument_list|(
name|msg3
argument_list|,
name|msg0
argument_list|)
expr_stmt|;
name|msg2
operator|=
name|_mm_xor_si128
argument_list|(
name|msg2
argument_list|,
name|msg0
argument_list|)
expr_stmt|;
comment|// Rounds 20-23
name|e1
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e1
argument_list|,
name|msg1
argument_list|)
expr_stmt|;
name|e0
operator|=
name|abcd
expr_stmt|;
name|msg2
operator|=
name|_mm_sha1msg2_epu32
argument_list|(
name|msg2
argument_list|,
name|msg1
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|msg0
operator|=
name|_mm_sha1msg1_epu32
argument_list|(
name|msg0
argument_list|,
name|msg1
argument_list|)
expr_stmt|;
name|msg3
operator|=
name|_mm_xor_si128
argument_list|(
name|msg3
argument_list|,
name|msg1
argument_list|)
expr_stmt|;
comment|// Rounds 24-27
name|e0
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e0
argument_list|,
name|msg2
argument_list|)
expr_stmt|;
name|e1
operator|=
name|abcd
expr_stmt|;
name|msg3
operator|=
name|_mm_sha1msg2_epu32
argument_list|(
name|msg3
argument_list|,
name|msg2
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|msg1
operator|=
name|_mm_sha1msg1_epu32
argument_list|(
name|msg1
argument_list|,
name|msg2
argument_list|)
expr_stmt|;
name|msg0
operator|=
name|_mm_xor_si128
argument_list|(
name|msg0
argument_list|,
name|msg2
argument_list|)
expr_stmt|;
comment|// Rounds 28-31
name|e1
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e1
argument_list|,
name|msg3
argument_list|)
expr_stmt|;
name|e0
operator|=
name|abcd
expr_stmt|;
name|msg0
operator|=
name|_mm_sha1msg2_epu32
argument_list|(
name|msg0
argument_list|,
name|msg3
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|msg2
operator|=
name|_mm_sha1msg1_epu32
argument_list|(
name|msg2
argument_list|,
name|msg3
argument_list|)
expr_stmt|;
name|msg1
operator|=
name|_mm_xor_si128
argument_list|(
name|msg1
argument_list|,
name|msg3
argument_list|)
expr_stmt|;
comment|// Rounds 32-35
name|e0
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e0
argument_list|,
name|msg0
argument_list|)
expr_stmt|;
name|e1
operator|=
name|abcd
expr_stmt|;
name|msg1
operator|=
name|_mm_sha1msg2_epu32
argument_list|(
name|msg1
argument_list|,
name|msg0
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|msg3
operator|=
name|_mm_sha1msg1_epu32
argument_list|(
name|msg3
argument_list|,
name|msg0
argument_list|)
expr_stmt|;
name|msg2
operator|=
name|_mm_xor_si128
argument_list|(
name|msg2
argument_list|,
name|msg0
argument_list|)
expr_stmt|;
comment|// Rounds 36-39
name|e1
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e1
argument_list|,
name|msg1
argument_list|)
expr_stmt|;
name|e0
operator|=
name|abcd
expr_stmt|;
name|msg2
operator|=
name|_mm_sha1msg2_epu32
argument_list|(
name|msg2
argument_list|,
name|msg1
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|msg0
operator|=
name|_mm_sha1msg1_epu32
argument_list|(
name|msg0
argument_list|,
name|msg1
argument_list|)
expr_stmt|;
name|msg3
operator|=
name|_mm_xor_si128
argument_list|(
name|msg3
argument_list|,
name|msg1
argument_list|)
expr_stmt|;
comment|// Rounds 40-43
name|e0
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e0
argument_list|,
name|msg2
argument_list|)
expr_stmt|;
name|e1
operator|=
name|abcd
expr_stmt|;
name|msg3
operator|=
name|_mm_sha1msg2_epu32
argument_list|(
name|msg3
argument_list|,
name|msg2
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|msg1
operator|=
name|_mm_sha1msg1_epu32
argument_list|(
name|msg1
argument_list|,
name|msg2
argument_list|)
expr_stmt|;
name|msg0
operator|=
name|_mm_xor_si128
argument_list|(
name|msg0
argument_list|,
name|msg2
argument_list|)
expr_stmt|;
comment|// Rounds 44-47
name|e1
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e1
argument_list|,
name|msg3
argument_list|)
expr_stmt|;
name|e0
operator|=
name|abcd
expr_stmt|;
name|msg0
operator|=
name|_mm_sha1msg2_epu32
argument_list|(
name|msg0
argument_list|,
name|msg3
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|msg2
operator|=
name|_mm_sha1msg1_epu32
argument_list|(
name|msg2
argument_list|,
name|msg3
argument_list|)
expr_stmt|;
name|msg1
operator|=
name|_mm_xor_si128
argument_list|(
name|msg1
argument_list|,
name|msg3
argument_list|)
expr_stmt|;
comment|// Rounds 48-51
name|e0
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e0
argument_list|,
name|msg0
argument_list|)
expr_stmt|;
name|e1
operator|=
name|abcd
expr_stmt|;
name|msg1
operator|=
name|_mm_sha1msg2_epu32
argument_list|(
name|msg1
argument_list|,
name|msg0
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|msg3
operator|=
name|_mm_sha1msg1_epu32
argument_list|(
name|msg3
argument_list|,
name|msg0
argument_list|)
expr_stmt|;
name|msg2
operator|=
name|_mm_xor_si128
argument_list|(
name|msg2
argument_list|,
name|msg0
argument_list|)
expr_stmt|;
comment|// Rounds 52-55
name|e1
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e1
argument_list|,
name|msg1
argument_list|)
expr_stmt|;
name|e0
operator|=
name|abcd
expr_stmt|;
name|msg2
operator|=
name|_mm_sha1msg2_epu32
argument_list|(
name|msg2
argument_list|,
name|msg1
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|msg0
operator|=
name|_mm_sha1msg1_epu32
argument_list|(
name|msg0
argument_list|,
name|msg1
argument_list|)
expr_stmt|;
name|msg3
operator|=
name|_mm_xor_si128
argument_list|(
name|msg3
argument_list|,
name|msg1
argument_list|)
expr_stmt|;
comment|// Rounds 56-59
name|e0
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e0
argument_list|,
name|msg2
argument_list|)
expr_stmt|;
name|e1
operator|=
name|abcd
expr_stmt|;
name|msg3
operator|=
name|_mm_sha1msg2_epu32
argument_list|(
name|msg3
argument_list|,
name|msg2
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|msg1
operator|=
name|_mm_sha1msg1_epu32
argument_list|(
name|msg1
argument_list|,
name|msg2
argument_list|)
expr_stmt|;
name|msg0
operator|=
name|_mm_xor_si128
argument_list|(
name|msg0
argument_list|,
name|msg2
argument_list|)
expr_stmt|;
comment|// Rounds 60-63
name|e1
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e1
argument_list|,
name|msg3
argument_list|)
expr_stmt|;
name|e0
operator|=
name|abcd
expr_stmt|;
name|msg0
operator|=
name|_mm_sha1msg2_epu32
argument_list|(
name|msg0
argument_list|,
name|msg3
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e1
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|msg2
operator|=
name|_mm_sha1msg1_epu32
argument_list|(
name|msg2
argument_list|,
name|msg3
argument_list|)
expr_stmt|;
name|msg1
operator|=
name|_mm_xor_si128
argument_list|(
name|msg1
argument_list|,
name|msg3
argument_list|)
expr_stmt|;
comment|// Rounds 64-67
name|e0
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e0
argument_list|,
name|msg0
argument_list|)
expr_stmt|;
name|e1
operator|=
name|abcd
expr_stmt|;
name|msg1
operator|=
name|_mm_sha1msg2_epu32
argument_list|(
name|msg1
argument_list|,
name|msg0
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|msg3
operator|=
name|_mm_sha1msg1_epu32
argument_list|(
name|msg3
argument_list|,
name|msg0
argument_list|)
expr_stmt|;
name|msg2
operator|=
name|_mm_xor_si128
argument_list|(
name|msg2
argument_list|,
name|msg0
argument_list|)
expr_stmt|;
comment|// Rounds 68-71
name|e1
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e1
argument_list|,
name|msg1
argument_list|)
expr_stmt|;
name|e0
operator|=
name|abcd
expr_stmt|;
name|msg2
operator|=
name|_mm_sha1msg2_epu32
argument_list|(
name|msg2
argument_list|,
name|msg1
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e1
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|msg3
operator|=
name|_mm_xor_si128
argument_list|(
name|msg3
argument_list|,
name|msg1
argument_list|)
expr_stmt|;
comment|// Rounds 72-75
name|e0
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e0
argument_list|,
name|msg2
argument_list|)
expr_stmt|;
name|e1
operator|=
name|abcd
expr_stmt|;
name|msg3
operator|=
name|_mm_sha1msg2_epu32
argument_list|(
name|msg3
argument_list|,
name|msg2
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
comment|// Rounds 76-79
name|e1
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e1
argument_list|,
name|msg3
argument_list|)
expr_stmt|;
name|e0
operator|=
name|abcd
expr_stmt|;
name|abcd
operator|=
name|_mm_sha1rnds4_epu32
argument_list|(
name|abcd
argument_list|,
name|e1
argument_list|,
literal|3
argument_list|)
expr_stmt|;
comment|// Add current hash values with previously saved
name|e0
operator|=
name|_mm_sha1nexte_epu32
argument_list|(
name|e0
argument_list|,
name|e_save
argument_list|)
expr_stmt|;
name|abcd
operator|=
name|_mm_add_epi32
argument_list|(
name|abcd
argument_list|,
name|abcd_save
argument_list|)
expr_stmt|;
name|data
operator|+=
literal|64
expr_stmt|;
name|num_blks
operator|--
expr_stmt|;
block|}
name|abcd
operator|=
name|_mm_shuffle_epi32
argument_list|(
name|abcd
argument_list|,
literal|0x1B
argument_list|)
expr_stmt|;
name|_mm_store_si128
argument_list|(
operator|(
name|__m128i
operator|*
operator|)
name|digest
argument_list|,
name|abcd
argument_list|)
expr_stmt|;
operator|*
operator|(
name|digest
operator|+
literal|4
operator|)
operator|=
name|_mm_extract_epi32
argument_list|(
name|e0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

