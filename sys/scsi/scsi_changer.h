begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * HISTORY  *  * PATCHES MAGIC                LEVEL   PATCH THAT GOT US HERE  * --------------------         -----   ----------------------  * CURRENT PATCH LEVEL:         1       00098  * --------------------         -----   ----------------------  *  * 16 Feb 93	Julian Elischer		ADDED for SCSI system  *   */
end_comment

begin_comment
comment|/*  * SCSI changer interface description  */
end_comment

begin_comment
comment|/*  * Written by Stefan Grefen   (grefen@goofy.zdv.uni-mainz.de soon grefen@convex.com)  * based on the SCSI System by written Julian Elischer (julian@tfs.com)  * for TRW Financial Systems.  *  * TRW Financial Systems, in accordance with their agreement with Carnegie  * Mellon University, makes this software available to CMU to distribute  * or use in any manner that they see fit as long as this message is kept with   * the software. For this reason TFS also grants any other persons or  * organisations permission to use or modify this software.  *  * TFS supplies this software to be publicly redistributed  * on the understanding that TFS is not responsible for the correct  * functioning of this software in any circumstances.  *  */
end_comment

begin_comment
comment|/*  * Ported to run under 386BSD by Julian Elischer (julian@tfs.com) Sept 1992  */
end_comment

begin_comment
comment|/*  * SCSI command format  */
end_comment

begin_struct
struct|struct
name|scsi_read_element_status
block|{
name|u_char
name|op_code
decl_stmt|;
name|u_char
name|element_type_code
range|:
literal|4
decl_stmt|;
name|u_char
name|voltag
range|:
literal|1
decl_stmt|;
name|u_char
name|lun
range|:
literal|3
decl_stmt|;
name|u_char
name|starting_element_addr
index|[
literal|2
index|]
decl_stmt|;
name|u_char
name|number_of_elements
index|[
literal|2
index|]
decl_stmt|;
name|u_char
name|resv1
decl_stmt|;
name|u_char
name|allocation_length
index|[
literal|3
index|]
decl_stmt|;
name|u_char
name|resv2
decl_stmt|;
name|u_char
name|link
range|:
literal|1
decl_stmt|;
name|u_char
name|flag
range|:
literal|1
decl_stmt|;
name|u_char
label|:
literal|6
expr_stmt|;
block|}
struct|;
end_struct

begin_define
define|#
directive|define
name|RE_ALL_ELEMENTS
value|0
end_define

begin_define
define|#
directive|define
name|RE_MEDIUM_TRANSPORT_ELEMENT
value|1
end_define

begin_define
define|#
directive|define
name|RE_STORAGE_ELEMENT
value|2
end_define

begin_define
define|#
directive|define
name|RE_IMPORT_EXPORT
value|3
end_define

begin_define
define|#
directive|define
name|RE_DATA_TRANSFER_ELEMENT
value|4
end_define

begin_struct
struct|struct
name|scsi_move_medium
block|{
name|u_char
name|op_code
decl_stmt|;
name|u_char
label|:
literal|5
expr_stmt|;
name|u_char
name|lun
range|:
literal|3
decl_stmt|;
name|u_char
name|transport_element_address
index|[
literal|2
index|]
decl_stmt|;
name|u_char
name|source_address
index|[
literal|2
index|]
decl_stmt|;
name|u_char
name|destination_address
index|[
literal|2
index|]
decl_stmt|;
name|u_char
name|rsvd
index|[
literal|2
index|]
decl_stmt|;
name|u_char
name|invert
range|:
literal|1
decl_stmt|;
name|u_char
label|:
literal|7
expr_stmt|;
name|u_char
name|link
range|:
literal|1
decl_stmt|;
name|u_char
name|flag
range|:
literal|1
decl_stmt|;
name|u_char
label|:
literal|6
expr_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|scsi_position_to_element
block|{
name|u_char
name|op_code
decl_stmt|;
name|u_char
label|:
literal|5
expr_stmt|;
name|u_char
name|lun
range|:
literal|3
decl_stmt|;
name|u_char
name|transport_element_address
index|[
literal|2
index|]
decl_stmt|;
name|u_char
name|source_address
index|[
literal|2
index|]
decl_stmt|;
name|u_char
name|rsvd
index|[
literal|2
index|]
decl_stmt|;
name|u_char
name|invert
range|:
literal|1
decl_stmt|;
name|u_char
label|:
literal|7
expr_stmt|;
name|u_char
name|link
range|:
literal|1
decl_stmt|;
name|u_char
name|flag
range|:
literal|1
decl_stmt|;
name|u_char
label|:
literal|6
expr_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/*  * Opcodes  */
end_comment

begin_define
define|#
directive|define
name|POSITION_TO_ELEMENT
value|0x2b
end_define

begin_define
define|#
directive|define
name|MOVE_MEDIUM
value|0xa5
end_define

begin_define
define|#
directive|define
name|READ_ELEMENT_STATUS
value|0xb8
end_define

begin_struct
struct|struct
name|scsi_element_status_data
block|{
name|u_char
name|first_element_reported
index|[
literal|2
index|]
decl_stmt|;
name|u_char
name|number_of_elements_reported
index|[
literal|2
index|]
decl_stmt|;
name|u_char
name|rsvd
decl_stmt|;
name|u_char
name|byte_count_of_report
index|[
literal|3
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|element_status_page
block|{
name|u_char
name|element_type_code
decl_stmt|;
name|u_char
label|:
literal|5
expr_stmt|;
name|u_char
name|avoltag
range|:
literal|1
decl_stmt|;
name|u_char
name|pvoltag
range|:
literal|1
decl_stmt|;
name|u_char
name|element_descriptor_length
index|[
literal|2
index|]
decl_stmt|;
name|u_char
name|rsvd
decl_stmt|;
name|u_char
name|byte_count_of_descriptor_data
index|[
literal|3
index|]
decl_stmt|;
block|}
struct|;
end_struct

end_unit

