begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2006 Alexander Motin<mav@alkar.net>  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice unmodified, this list of conditions, and the following  *    disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  *  * $FreeBSD$  */
end_comment

begin_comment
comment|/*  * Predictor-1 PPP compression netgraph node type.  */
end_comment

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<sys/systm.h>
end_include

begin_include
include|#
directive|include
file|<sys/kernel.h>
end_include

begin_include
include|#
directive|include
file|<sys/mbuf.h>
end_include

begin_include
include|#
directive|include
file|<sys/malloc.h>
end_include

begin_include
include|#
directive|include
file|<sys/errno.h>
end_include

begin_include
include|#
directive|include
file|<sys/syslog.h>
end_include

begin_include
include|#
directive|include
file|<netgraph/ng_message.h>
end_include

begin_include
include|#
directive|include
file|<netgraph/netgraph.h>
end_include

begin_include
include|#
directive|include
file|<netgraph/ng_parse.h>
end_include

begin_include
include|#
directive|include
file|<netgraph/ng_pred1.h>
end_include

begin_include
include|#
directive|include
file|"opt_netgraph.h"
end_include

begin_expr_stmt
name|MALLOC_DEFINE
argument_list|(
name|M_NETGRAPH_PRED1
argument_list|,
literal|"netgraph_pred1"
argument_list|,
literal|"netgraph pred1 node "
argument_list|)
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* PRED1 header length */
end_comment

begin_define
define|#
directive|define
name|PRED1_HDRLEN
value|2
end_define

begin_define
define|#
directive|define
name|PRED1_TABLE_SIZE
value|0x10000
end_define

begin_define
define|#
directive|define
name|PRED1_BUF_SIZE
value|4096
end_define

begin_define
define|#
directive|define
name|PPP_INITFCS
value|0xffff
end_define

begin_comment
comment|/* Initial FCS value */
end_comment

begin_define
define|#
directive|define
name|PPP_GOODFCS
value|0xf0b8
end_define

begin_comment
comment|/* Good final FCS value */
end_comment

begin_comment
comment|/*  * The following hash code is the heart of the algorithm:  * it builds a sliding hash sum of the previous 3-and-a-bit  * characters which will be used to index the guess table.  * A better hash function would result in additional compression,  * at the expense of time.  */
end_comment

begin_define
define|#
directive|define
name|HASH
parameter_list|(
name|x
parameter_list|)
value|priv->Hash = (priv->Hash<< 4) ^ (x)
end_define

begin_comment
comment|/* Node private data */
end_comment

begin_struct
struct|struct
name|ng_pred1_private
block|{
name|struct
name|ng_pred1_config
name|cfg
decl_stmt|;
comment|/* configuration */
name|u_char
name|GuessTable
index|[
name|PRED1_TABLE_SIZE
index|]
decl_stmt|;
comment|/* dictionary */
name|u_char
name|inbuf
index|[
name|PRED1_BUF_SIZE
index|]
decl_stmt|;
comment|/* input buffer */
name|u_char
name|outbuf
index|[
name|PRED1_BUF_SIZE
index|]
decl_stmt|;
comment|/* output buffer */
name|struct
name|ng_pred1_stats
name|stats
decl_stmt|;
comment|/* statistics */
name|uint16_t
name|Hash
decl_stmt|;
name|ng_ID_t
name|ctrlnode
decl_stmt|;
comment|/* path to controlling node */
name|uint16_t
name|seqnum
decl_stmt|;
comment|/* sequence number */
name|u_char
name|compress
decl_stmt|;
comment|/* compress/decompress flag */
block|}
struct|;
end_struct

begin_typedef
typedef|typedef
name|struct
name|ng_pred1_private
modifier|*
name|priv_p
typedef|;
end_typedef

begin_comment
comment|/* Netgraph node methods */
end_comment

begin_decl_stmt
specifier|static
name|ng_constructor_t
name|ng_pred1_constructor
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|ng_rcvmsg_t
name|ng_pred1_rcvmsg
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|ng_shutdown_t
name|ng_pred1_shutdown
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|ng_newhook_t
name|ng_pred1_newhook
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|ng_rcvdata_t
name|ng_pred1_rcvdata
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|ng_disconnect_t
name|ng_pred1_disconnect
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Helper functions */
end_comment

begin_function_decl
specifier|static
name|int
name|ng_pred1_compress
parameter_list|(
name|node_p
name|node
parameter_list|,
name|struct
name|mbuf
modifier|*
name|m
parameter_list|,
name|struct
name|mbuf
modifier|*
modifier|*
name|resultp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|ng_pred1_decompress
parameter_list|(
name|node_p
name|node
parameter_list|,
name|struct
name|mbuf
modifier|*
name|m
parameter_list|,
name|struct
name|mbuf
modifier|*
modifier|*
name|resultp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|Pred1Init
parameter_list|(
name|node_p
name|node
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|Pred1Compress
parameter_list|(
name|node_p
name|node
parameter_list|,
name|u_char
modifier|*
name|source
parameter_list|,
name|u_char
modifier|*
name|dest
parameter_list|,
name|int
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|Pred1Decompress
parameter_list|(
name|node_p
name|node
parameter_list|,
name|u_char
modifier|*
name|source
parameter_list|,
name|u_char
modifier|*
name|dest
parameter_list|,
name|int
name|slen
parameter_list|,
name|int
name|dlen
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|Pred1SyncTable
parameter_list|(
name|node_p
name|node
parameter_list|,
name|u_char
modifier|*
name|source
parameter_list|,
name|int
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|uint16_t
name|Crc16
parameter_list|(
name|uint16_t
name|fcs
parameter_list|,
name|u_char
modifier|*
name|cp
parameter_list|,
name|int
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_decl_stmt
specifier|static
specifier|const
name|uint16_t
name|Crc16Table
index|[]
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Parse type for struct ng_pred1_config. */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|ng_parse_struct_field
name|ng_pred1_config_type_fields
index|[]
init|=
name|NG_PRED1_CONFIG_INFO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|ng_parse_type
name|ng_pred1_config_type
init|=
block|{
operator|&
name|ng_parse_struct_type
block|,
name|ng_pred1_config_type_fields
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Parse type for struct ng_pred1_stat. */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|ng_parse_struct_field
name|ng_pred1_stats_type_fields
index|[]
init|=
name|NG_PRED1_STATS_INFO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|ng_parse_type
name|ng_pred1_stat_type
init|=
block|{
operator|&
name|ng_parse_struct_type
block|,
name|ng_pred1_stats_type_fields
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* List of commands and how to convert arguments to/from ASCII. */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|ng_cmdlist
name|ng_pred1_cmds
index|[]
init|=
block|{
block|{
name|NGM_PRED1_COOKIE
block|,
name|NGM_PRED1_CONFIG
block|,
literal|"config"
block|,
operator|&
name|ng_pred1_config_type
block|,
name|NULL
block|}
block|,
block|{
name|NGM_PRED1_COOKIE
block|,
name|NGM_PRED1_RESETREQ
block|,
literal|"resetreq"
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
name|NGM_PRED1_COOKIE
block|,
name|NGM_PRED1_GET_STATS
block|,
literal|"getstats"
block|,
name|NULL
block|,
operator|&
name|ng_pred1_stat_type
block|}
block|,
block|{
name|NGM_PRED1_COOKIE
block|,
name|NGM_PRED1_CLR_STATS
block|,
literal|"clrstats"
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
name|NGM_PRED1_COOKIE
block|,
name|NGM_PRED1_GETCLR_STATS
block|,
literal|"getclrstats"
block|,
name|NULL
block|,
operator|&
name|ng_pred1_stat_type
block|}
block|,
block|{
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Node type descriptor */
end_comment

begin_decl_stmt
specifier|static
name|struct
name|ng_type
name|ng_pred1_typestruct
init|=
block|{
operator|.
name|version
operator|=
name|NG_ABI_VERSION
block|,
operator|.
name|name
operator|=
name|NG_PRED1_NODE_TYPE
block|,
operator|.
name|constructor
operator|=
name|ng_pred1_constructor
block|,
operator|.
name|rcvmsg
operator|=
name|ng_pred1_rcvmsg
block|,
operator|.
name|shutdown
operator|=
name|ng_pred1_shutdown
block|,
operator|.
name|newhook
operator|=
name|ng_pred1_newhook
block|,
operator|.
name|rcvdata
operator|=
name|ng_pred1_rcvdata
block|,
operator|.
name|disconnect
operator|=
name|ng_pred1_disconnect
block|,
operator|.
name|cmdlist
operator|=
name|ng_pred1_cmds
block|, }
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|NETGRAPH_INIT
argument_list|(
name|pred1
argument_list|,
operator|&
name|ng_pred1_typestruct
argument_list|)
expr_stmt|;
end_expr_stmt

begin_define
define|#
directive|define
name|ERROUT
parameter_list|(
name|x
parameter_list|)
value|do { error = (x); goto done; } while (0)
end_define

begin_comment
comment|/************************************************************************ 			NETGRAPH NODE STUFF  ************************************************************************/
end_comment

begin_comment
comment|/*  * Node type constructor  */
end_comment

begin_function
specifier|static
name|int
name|ng_pred1_constructor
parameter_list|(
name|node_p
name|node
parameter_list|)
block|{
name|priv_p
name|priv
decl_stmt|;
comment|/* Allocate private structure. */
name|priv
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
operator|*
name|priv
argument_list|)
argument_list|,
name|M_NETGRAPH_PRED1
argument_list|,
name|M_WAITOK
operator||
name|M_ZERO
argument_list|)
expr_stmt|;
name|NG_NODE_SET_PRIVATE
argument_list|(
name|node
argument_list|,
name|priv
argument_list|)
expr_stmt|;
comment|/* This node is not thread safe. */
name|NG_NODE_FORCE_WRITER
argument_list|(
name|node
argument_list|)
expr_stmt|;
comment|/* Done */
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Give our OK for a hook to be added.  */
end_comment

begin_function
specifier|static
name|int
name|ng_pred1_newhook
parameter_list|(
name|node_p
name|node
parameter_list|,
name|hook_p
name|hook
parameter_list|,
specifier|const
name|char
modifier|*
name|name
parameter_list|)
block|{
specifier|const
name|priv_p
name|priv
init|=
name|NG_NODE_PRIVATE
argument_list|(
name|node
argument_list|)
decl_stmt|;
if|if
condition|(
name|NG_NODE_NUMHOOKS
argument_list|(
name|node
argument_list|)
operator|>
literal|0
condition|)
return|return
operator|(
name|EINVAL
operator|)
return|;
if|if
condition|(
name|strcmp
argument_list|(
name|name
argument_list|,
name|NG_PRED1_HOOK_COMP
argument_list|)
operator|==
literal|0
condition|)
name|priv
operator|->
name|compress
operator|=
literal|1
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
name|name
argument_list|,
name|NG_PRED1_HOOK_DECOMP
argument_list|)
operator|==
literal|0
condition|)
name|priv
operator|->
name|compress
operator|=
literal|0
expr_stmt|;
else|else
return|return
operator|(
name|EINVAL
operator|)
return|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Receive a control message.  */
end_comment

begin_function
specifier|static
name|int
name|ng_pred1_rcvmsg
parameter_list|(
name|node_p
name|node
parameter_list|,
name|item_p
name|item
parameter_list|,
name|hook_p
name|lasthook
parameter_list|)
block|{
specifier|const
name|priv_p
name|priv
init|=
name|NG_NODE_PRIVATE
argument_list|(
name|node
argument_list|)
decl_stmt|;
name|struct
name|ng_mesg
modifier|*
name|resp
init|=
name|NULL
decl_stmt|;
name|int
name|error
init|=
literal|0
decl_stmt|;
name|struct
name|ng_mesg
modifier|*
name|msg
decl_stmt|;
name|NGI_GET_MSG
argument_list|(
name|item
argument_list|,
name|msg
argument_list|)
expr_stmt|;
if|if
condition|(
name|msg
operator|->
name|header
operator|.
name|typecookie
operator|!=
name|NGM_PRED1_COOKIE
condition|)
name|ERROUT
argument_list|(
name|EINVAL
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|msg
operator|->
name|header
operator|.
name|cmd
condition|)
block|{
case|case
name|NGM_PRED1_CONFIG
case|:
block|{
name|struct
name|ng_pred1_config
modifier|*
specifier|const
name|cfg
init|=
operator|(
expr|struct
name|ng_pred1_config
operator|*
operator|)
name|msg
operator|->
name|data
decl_stmt|;
comment|/* Check configuration. */
if|if
condition|(
name|msg
operator|->
name|header
operator|.
name|arglen
operator|!=
sizeof|sizeof
argument_list|(
operator|*
name|cfg
argument_list|)
condition|)
name|ERROUT
argument_list|(
name|EINVAL
argument_list|)
expr_stmt|;
comment|/* Configuration is OK, reset to it. */
name|priv
operator|->
name|cfg
operator|=
operator|*
name|cfg
expr_stmt|;
comment|/* Save return address so we can send reset-req's. */
name|priv
operator|->
name|ctrlnode
operator|=
name|NGI_RETADDR
argument_list|(
name|item
argument_list|)
expr_stmt|;
comment|/* Clear our state. */
name|Pred1Init
argument_list|(
name|node
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|NGM_PRED1_RESETREQ
case|:
name|Pred1Init
argument_list|(
name|node
argument_list|)
expr_stmt|;
break|break;
case|case
name|NGM_PRED1_GET_STATS
case|:
case|case
name|NGM_PRED1_CLR_STATS
case|:
case|case
name|NGM_PRED1_GETCLR_STATS
case|:
block|{
comment|/* Create response. */
if|if
condition|(
name|msg
operator|->
name|header
operator|.
name|cmd
operator|!=
name|NGM_PRED1_CLR_STATS
condition|)
block|{
name|NG_MKRESPONSE
argument_list|(
name|resp
argument_list|,
name|msg
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|ng_pred1_stats
argument_list|)
argument_list|,
name|M_NOWAIT
argument_list|)
expr_stmt|;
if|if
condition|(
name|resp
operator|==
name|NULL
condition|)
name|ERROUT
argument_list|(
name|ENOMEM
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|priv
operator|->
name|stats
argument_list|,
name|resp
operator|->
name|data
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|ng_pred1_stats
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|msg
operator|->
name|header
operator|.
name|cmd
operator|!=
name|NGM_PRED1_GET_STATS
condition|)
name|bzero
argument_list|(
operator|&
name|priv
operator|->
name|stats
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|ng_pred1_stats
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
default|default:
name|error
operator|=
name|EINVAL
expr_stmt|;
break|break;
block|}
name|done
label|:
name|NG_RESPOND_MSG
argument_list|(
name|error
argument_list|,
name|node
argument_list|,
name|item
argument_list|,
name|resp
argument_list|)
expr_stmt|;
name|NG_FREE_MSG
argument_list|(
name|msg
argument_list|)
expr_stmt|;
return|return
operator|(
name|error
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Receive incoming data on our hook.  */
end_comment

begin_function
specifier|static
name|int
name|ng_pred1_rcvdata
parameter_list|(
name|hook_p
name|hook
parameter_list|,
name|item_p
name|item
parameter_list|)
block|{
specifier|const
name|node_p
name|node
init|=
name|NG_HOOK_NODE
argument_list|(
name|hook
argument_list|)
decl_stmt|;
specifier|const
name|priv_p
name|priv
init|=
name|NG_NODE_PRIVATE
argument_list|(
name|node
argument_list|)
decl_stmt|;
name|struct
name|mbuf
modifier|*
name|m
decl_stmt|,
modifier|*
name|out
decl_stmt|;
name|int
name|error
decl_stmt|;
if|if
condition|(
operator|!
name|priv
operator|->
name|cfg
operator|.
name|enable
condition|)
block|{
name|NG_FREE_ITEM
argument_list|(
name|item
argument_list|)
expr_stmt|;
return|return
operator|(
name|ENXIO
operator|)
return|;
block|}
name|NGI_GET_M
argument_list|(
name|item
argument_list|,
name|m
argument_list|)
expr_stmt|;
comment|/* Compress. */
if|if
condition|(
name|priv
operator|->
name|compress
condition|)
block|{
if|if
condition|(
operator|(
name|error
operator|=
name|ng_pred1_compress
argument_list|(
name|node
argument_list|,
name|m
argument_list|,
operator|&
name|out
argument_list|)
operator|)
operator|!=
literal|0
condition|)
block|{
name|NG_FREE_ITEM
argument_list|(
name|item
argument_list|)
expr_stmt|;
name|log
argument_list|(
name|LOG_NOTICE
argument_list|,
literal|"%s: error: %d\n"
argument_list|,
name|__func__
argument_list|,
name|error
argument_list|)
expr_stmt|;
return|return
operator|(
name|error
operator|)
return|;
block|}
block|}
else|else
block|{
comment|/* Decompress. */
if|if
condition|(
operator|(
name|error
operator|=
name|ng_pred1_decompress
argument_list|(
name|node
argument_list|,
name|m
argument_list|,
operator|&
name|out
argument_list|)
operator|)
operator|!=
literal|0
condition|)
block|{
name|NG_FREE_ITEM
argument_list|(
name|item
argument_list|)
expr_stmt|;
name|log
argument_list|(
name|LOG_NOTICE
argument_list|,
literal|"%s: error: %d\n"
argument_list|,
name|__func__
argument_list|,
name|error
argument_list|)
expr_stmt|;
if|if
condition|(
name|priv
operator|->
name|ctrlnode
operator|!=
literal|0
condition|)
block|{
name|struct
name|ng_mesg
modifier|*
name|msg
decl_stmt|;
comment|/* Need to send a reset-request. */
name|NG_MKMESSAGE
argument_list|(
name|msg
argument_list|,
name|NGM_PRED1_COOKIE
argument_list|,
name|NGM_PRED1_RESETREQ
argument_list|,
literal|0
argument_list|,
name|M_NOWAIT
argument_list|)
expr_stmt|;
if|if
condition|(
name|msg
operator|==
name|NULL
condition|)
return|return
operator|(
name|error
operator|)
return|;
name|NG_SEND_MSG_ID
argument_list|(
name|error
argument_list|,
name|node
argument_list|,
name|msg
argument_list|,
name|priv
operator|->
name|ctrlnode
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
return|return
operator|(
name|error
operator|)
return|;
block|}
block|}
name|NG_FWD_NEW_DATA
argument_list|(
name|error
argument_list|,
name|item
argument_list|,
name|hook
argument_list|,
name|out
argument_list|)
expr_stmt|;
return|return
operator|(
name|error
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Destroy node.  */
end_comment

begin_function
specifier|static
name|int
name|ng_pred1_shutdown
parameter_list|(
name|node_p
name|node
parameter_list|)
block|{
specifier|const
name|priv_p
name|priv
init|=
name|NG_NODE_PRIVATE
argument_list|(
name|node
argument_list|)
decl_stmt|;
name|free
argument_list|(
name|priv
argument_list|,
name|M_NETGRAPH_PRED1
argument_list|)
expr_stmt|;
name|NG_NODE_SET_PRIVATE
argument_list|(
name|node
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|NG_NODE_UNREF
argument_list|(
name|node
argument_list|)
expr_stmt|;
comment|/* Let the node escape. */
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Hook disconnection  */
end_comment

begin_function
specifier|static
name|int
name|ng_pred1_disconnect
parameter_list|(
name|hook_p
name|hook
parameter_list|)
block|{
specifier|const
name|node_p
name|node
init|=
name|NG_HOOK_NODE
argument_list|(
name|hook
argument_list|)
decl_stmt|;
name|Pred1Init
argument_list|(
name|node
argument_list|)
expr_stmt|;
comment|/* Go away if no longer connected. */
if|if
condition|(
operator|(
name|NG_NODE_NUMHOOKS
argument_list|(
name|node
argument_list|)
operator|==
literal|0
operator|)
operator|&&
name|NG_NODE_IS_VALID
argument_list|(
name|node
argument_list|)
condition|)
name|ng_rmnode_self
argument_list|(
name|node
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/************************************************************************ 			HELPER STUFF  ************************************************************************/
end_comment

begin_comment
comment|/*  * Compress/encrypt a packet and put the result in a new mbuf at *resultp.  * The original mbuf is not free'd.  */
end_comment

begin_function
specifier|static
name|int
name|ng_pred1_compress
parameter_list|(
name|node_p
name|node
parameter_list|,
name|struct
name|mbuf
modifier|*
name|m
parameter_list|,
name|struct
name|mbuf
modifier|*
modifier|*
name|resultp
parameter_list|)
block|{
specifier|const
name|priv_p
name|priv
init|=
name|NG_NODE_PRIVATE
argument_list|(
name|node
argument_list|)
decl_stmt|;
name|int
name|outlen
decl_stmt|,
name|inlen
decl_stmt|;
name|u_char
modifier|*
name|out
decl_stmt|;
name|uint16_t
name|fcs
decl_stmt|,
name|lenn
decl_stmt|;
name|int
name|len
decl_stmt|;
comment|/* Initialize. */
operator|*
name|resultp
operator|=
name|NULL
expr_stmt|;
name|inlen
operator|=
name|m
operator|->
name|m_pkthdr
operator|.
name|len
expr_stmt|;
name|priv
operator|->
name|stats
operator|.
name|FramesPlain
operator|++
expr_stmt|;
name|priv
operator|->
name|stats
operator|.
name|InOctets
operator|+=
name|inlen
expr_stmt|;
comment|/* Reserve space for expansion. */
if|if
condition|(
name|inlen
operator|>
operator|(
name|PRED1_BUF_SIZE
operator|*
literal|8
operator|/
literal|9
operator|+
literal|1
operator|+
literal|4
operator|)
condition|)
block|{
name|priv
operator|->
name|stats
operator|.
name|Errors
operator|++
expr_stmt|;
name|NG_FREE_M
argument_list|(
name|m
argument_list|)
expr_stmt|;
return|return
operator|(
name|ENOMEM
operator|)
return|;
block|}
comment|/* We must own the mbuf chain exclusively to modify it. */
name|m
operator|=
name|m_unshare
argument_list|(
name|m
argument_list|,
name|M_DONTWAIT
argument_list|)
expr_stmt|;
if|if
condition|(
name|m
operator|==
name|NULL
condition|)
block|{
name|priv
operator|->
name|stats
operator|.
name|Errors
operator|++
expr_stmt|;
return|return
operator|(
name|ENOMEM
operator|)
return|;
block|}
comment|/* Work with contiguous regions of memory. */
name|m_copydata
argument_list|(
name|m
argument_list|,
literal|0
argument_list|,
name|inlen
argument_list|,
call|(
name|caddr_t
call|)
argument_list|(
name|priv
operator|->
name|inbuf
operator|+
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|lenn
operator|=
name|htons
argument_list|(
name|inlen
operator|&
literal|0x7FFF
argument_list|)
expr_stmt|;
comment|/* Compute FCS. */
name|fcs
operator|=
name|Crc16
argument_list|(
name|PPP_INITFCS
argument_list|,
operator|(
name|u_char
operator|*
operator|)
operator|&
name|lenn
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|fcs
operator|=
name|Crc16
argument_list|(
name|fcs
argument_list|,
name|priv
operator|->
name|inbuf
operator|+
literal|2
argument_list|,
name|inlen
argument_list|)
expr_stmt|;
name|fcs
operator|=
operator|~
name|fcs
expr_stmt|;
comment|/* Compress data. */
name|len
operator|=
name|Pred1Compress
argument_list|(
name|node
argument_list|,
name|priv
operator|->
name|inbuf
operator|+
literal|2
argument_list|,
name|priv
operator|->
name|outbuf
operator|+
literal|2
argument_list|,
name|inlen
argument_list|)
expr_stmt|;
comment|/* What happened? */
if|if
condition|(
name|len
operator|<
name|inlen
condition|)
block|{
name|out
operator|=
name|priv
operator|->
name|outbuf
expr_stmt|;
name|outlen
operator|=
literal|2
operator|+
name|len
expr_stmt|;
operator|*
operator|(
name|uint16_t
operator|*
operator|)
name|out
operator|=
name|lenn
expr_stmt|;
operator|*
name|out
operator||=
literal|0x80
expr_stmt|;
name|priv
operator|->
name|stats
operator|.
name|FramesComp
operator|++
expr_stmt|;
block|}
else|else
block|{
name|out
operator|=
name|priv
operator|->
name|inbuf
expr_stmt|;
name|outlen
operator|=
literal|2
operator|+
name|inlen
expr_stmt|;
operator|*
operator|(
name|uint16_t
operator|*
operator|)
name|out
operator|=
name|lenn
expr_stmt|;
name|priv
operator|->
name|stats
operator|.
name|FramesUncomp
operator|++
expr_stmt|;
block|}
comment|/* Add FCS. */
operator|(
name|out
operator|+
name|outlen
operator|)
index|[
literal|0
index|]
operator|=
name|fcs
operator|&
literal|0xFF
expr_stmt|;
operator|(
name|out
operator|+
name|outlen
operator|)
index|[
literal|1
index|]
operator|=
name|fcs
operator|>>
literal|8
expr_stmt|;
comment|/* Calculate resulting size. */
name|outlen
operator|+=
literal|2
expr_stmt|;
comment|/* Return packet in an mbuf. */
name|m_copyback
argument_list|(
name|m
argument_list|,
literal|0
argument_list|,
name|outlen
argument_list|,
operator|(
name|caddr_t
operator|)
name|out
argument_list|)
expr_stmt|;
if|if
condition|(
name|m
operator|->
name|m_pkthdr
operator|.
name|len
operator|<
name|outlen
condition|)
block|{
name|m_freem
argument_list|(
name|m
argument_list|)
expr_stmt|;
name|priv
operator|->
name|stats
operator|.
name|Errors
operator|++
expr_stmt|;
return|return
operator|(
name|ENOMEM
operator|)
return|;
block|}
elseif|else
if|if
condition|(
name|outlen
operator|<
name|m
operator|->
name|m_pkthdr
operator|.
name|len
condition|)
name|m_adj
argument_list|(
name|m
argument_list|,
name|outlen
operator|-
name|m
operator|->
name|m_pkthdr
operator|.
name|len
argument_list|)
expr_stmt|;
operator|*
name|resultp
operator|=
name|m
expr_stmt|;
name|priv
operator|->
name|stats
operator|.
name|OutOctets
operator|+=
name|outlen
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Decompress/decrypt packet and put the result in a new mbuf at *resultp.  * The original mbuf is not free'd.  */
end_comment

begin_function
specifier|static
name|int
name|ng_pred1_decompress
parameter_list|(
name|node_p
name|node
parameter_list|,
name|struct
name|mbuf
modifier|*
name|m
parameter_list|,
name|struct
name|mbuf
modifier|*
modifier|*
name|resultp
parameter_list|)
block|{
specifier|const
name|priv_p
name|priv
init|=
name|NG_NODE_PRIVATE
argument_list|(
name|node
argument_list|)
decl_stmt|;
name|int
name|inlen
decl_stmt|;
name|uint16_t
name|len
decl_stmt|,
name|len1
decl_stmt|,
name|cf
decl_stmt|,
name|lenn
decl_stmt|;
name|uint16_t
name|fcs
decl_stmt|;
comment|/* Initialize. */
operator|*
name|resultp
operator|=
name|NULL
expr_stmt|;
name|inlen
operator|=
name|m
operator|->
name|m_pkthdr
operator|.
name|len
expr_stmt|;
if|if
condition|(
name|inlen
operator|>
name|PRED1_BUF_SIZE
condition|)
block|{
name|priv
operator|->
name|stats
operator|.
name|Errors
operator|++
expr_stmt|;
name|NG_FREE_M
argument_list|(
name|m
argument_list|)
expr_stmt|;
return|return
operator|(
name|ENOMEM
operator|)
return|;
block|}
comment|/* We must own the mbuf chain exclusively to modify it. */
name|m
operator|=
name|m_unshare
argument_list|(
name|m
argument_list|,
name|M_DONTWAIT
argument_list|)
expr_stmt|;
if|if
condition|(
name|m
operator|==
name|NULL
condition|)
block|{
name|priv
operator|->
name|stats
operator|.
name|Errors
operator|++
expr_stmt|;
return|return
operator|(
name|ENOMEM
operator|)
return|;
block|}
comment|/* Work with contiguous regions of memory. */
name|m_copydata
argument_list|(
name|m
argument_list|,
literal|0
argument_list|,
name|inlen
argument_list|,
operator|(
name|caddr_t
operator|)
name|priv
operator|->
name|inbuf
argument_list|)
expr_stmt|;
name|priv
operator|->
name|stats
operator|.
name|InOctets
operator|+=
name|inlen
expr_stmt|;
comment|/* Get initial length value. */
name|len
operator|=
name|priv
operator|->
name|inbuf
index|[
literal|0
index|]
operator|<<
literal|8
expr_stmt|;
name|len
operator|+=
name|priv
operator|->
name|inbuf
index|[
literal|1
index|]
expr_stmt|;
name|cf
operator|=
operator|(
name|len
operator|&
literal|0x8000
operator|)
expr_stmt|;
name|len
operator|&=
literal|0x7fff
expr_stmt|;
comment|/* Is data compressed or not really? */
if|if
condition|(
name|cf
condition|)
block|{
name|priv
operator|->
name|stats
operator|.
name|FramesComp
operator|++
expr_stmt|;
name|len1
operator|=
name|Pred1Decompress
argument_list|(
name|node
argument_list|,
name|priv
operator|->
name|inbuf
operator|+
literal|2
argument_list|,
name|priv
operator|->
name|outbuf
argument_list|,
name|inlen
operator|-
literal|4
argument_list|,
name|PRED1_BUF_SIZE
argument_list|)
expr_stmt|;
if|if
condition|(
name|len
operator|!=
name|len1
condition|)
block|{
comment|/* Error is detected. Send reset request */
name|m_freem
argument_list|(
name|m
argument_list|)
expr_stmt|;
name|priv
operator|->
name|stats
operator|.
name|Errors
operator|++
expr_stmt|;
name|log
argument_list|(
name|LOG_NOTICE
argument_list|,
literal|"ng_pred1: Comp length error (%d) "
literal|"--> len (%d)\n"
argument_list|,
name|len
argument_list|,
name|len1
argument_list|)
expr_stmt|;
return|return
operator|(
name|EIO
operator|)
return|;
block|}
comment|/* 		 * CRC check on receive is defined in RFC. It is surely required 		 * for compressed frames to signal dictionary corruption, 		 * but it is actually useless for uncompressed frames because 		 * the same check has already done by HDLC and/or other layer. 		 */
name|lenn
operator|=
name|htons
argument_list|(
name|len
argument_list|)
expr_stmt|;
name|fcs
operator|=
name|Crc16
argument_list|(
name|PPP_INITFCS
argument_list|,
operator|(
name|u_char
operator|*
operator|)
operator|&
name|lenn
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|fcs
operator|=
name|Crc16
argument_list|(
name|fcs
argument_list|,
name|priv
operator|->
name|outbuf
argument_list|,
name|len
argument_list|)
expr_stmt|;
name|fcs
operator|=
name|Crc16
argument_list|(
name|fcs
argument_list|,
name|priv
operator|->
name|inbuf
operator|+
name|inlen
operator|-
literal|2
argument_list|,
literal|2
argument_list|)
expr_stmt|;
if|if
condition|(
name|fcs
operator|!=
name|PPP_GOODFCS
condition|)
block|{
name|m_freem
argument_list|(
name|m
argument_list|)
expr_stmt|;
name|priv
operator|->
name|stats
operator|.
name|Errors
operator|++
expr_stmt|;
name|log
argument_list|(
name|LOG_NOTICE
argument_list|,
literal|"ng_pred1: Pred1: Bad CRC-16\n"
argument_list|)
expr_stmt|;
return|return
operator|(
name|EIO
operator|)
return|;
block|}
comment|/* Return packet in an mbuf. */
name|m_copyback
argument_list|(
name|m
argument_list|,
literal|0
argument_list|,
name|len
argument_list|,
operator|(
name|caddr_t
operator|)
name|priv
operator|->
name|outbuf
argument_list|)
expr_stmt|;
if|if
condition|(
name|m
operator|->
name|m_pkthdr
operator|.
name|len
operator|<
name|len
condition|)
block|{
name|m_freem
argument_list|(
name|m
argument_list|)
expr_stmt|;
name|priv
operator|->
name|stats
operator|.
name|Errors
operator|++
expr_stmt|;
return|return
operator|(
name|ENOMEM
operator|)
return|;
block|}
elseif|else
if|if
condition|(
name|len
operator|<
name|m
operator|->
name|m_pkthdr
operator|.
name|len
condition|)
name|m_adj
argument_list|(
name|m
argument_list|,
name|len
operator|-
name|m
operator|->
name|m_pkthdr
operator|.
name|len
argument_list|)
expr_stmt|;
operator|*
name|resultp
operator|=
name|m
expr_stmt|;
block|}
else|else
block|{
name|priv
operator|->
name|stats
operator|.
name|FramesUncomp
operator|++
expr_stmt|;
if|if
condition|(
name|len
operator|!=
operator|(
name|inlen
operator|-
literal|4
operator|)
condition|)
block|{
comment|/* Wrong length. Send reset request */
name|priv
operator|->
name|stats
operator|.
name|Errors
operator|++
expr_stmt|;
name|log
argument_list|(
name|LOG_NOTICE
argument_list|,
literal|"ng_pred1: Uncomp length error (%d) "
literal|"--> len (%d)\n"
argument_list|,
name|len
argument_list|,
name|inlen
operator|-
literal|4
argument_list|)
expr_stmt|;
name|NG_FREE_M
argument_list|(
name|m
argument_list|)
expr_stmt|;
return|return
operator|(
name|EIO
operator|)
return|;
block|}
name|Pred1SyncTable
argument_list|(
name|node
argument_list|,
name|priv
operator|->
name|inbuf
operator|+
literal|2
argument_list|,
name|len
argument_list|)
expr_stmt|;
name|m_adj
argument_list|(
name|m
argument_list|,
literal|2
argument_list|)
expr_stmt|;
comment|/* Strip length. */
name|m_adj
argument_list|(
name|m
argument_list|,
operator|-
literal|2
argument_list|)
expr_stmt|;
comment|/* Strip fcs. */
operator|*
name|resultp
operator|=
name|m
expr_stmt|;
block|}
name|priv
operator|->
name|stats
operator|.
name|FramesPlain
operator|++
expr_stmt|;
name|priv
operator|->
name|stats
operator|.
name|OutOctets
operator|+=
name|len
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Pred1Init()  */
end_comment

begin_function
specifier|static
name|void
name|Pred1Init
parameter_list|(
name|node_p
name|node
parameter_list|)
block|{
specifier|const
name|priv_p
name|priv
init|=
name|NG_NODE_PRIVATE
argument_list|(
name|node
argument_list|)
decl_stmt|;
name|priv
operator|->
name|Hash
operator|=
literal|0
expr_stmt|;
name|memset
argument_list|(
name|priv
operator|->
name|GuessTable
argument_list|,
literal|0
argument_list|,
name|PRED1_TABLE_SIZE
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Pred1Compress()  */
end_comment

begin_function
specifier|static
name|int
name|Pred1Compress
parameter_list|(
name|node_p
name|node
parameter_list|,
name|u_char
modifier|*
name|source
parameter_list|,
name|u_char
modifier|*
name|dest
parameter_list|,
name|int
name|len
parameter_list|)
block|{
specifier|const
name|priv_p
name|priv
init|=
name|NG_NODE_PRIVATE
argument_list|(
name|node
argument_list|)
decl_stmt|;
name|int
name|i
decl_stmt|,
name|bitmask
decl_stmt|;
name|u_char
name|flags
decl_stmt|;
name|u_char
modifier|*
name|flagdest
decl_stmt|,
modifier|*
name|orgdest
decl_stmt|;
name|orgdest
operator|=
name|dest
expr_stmt|;
while|while
condition|(
name|len
condition|)
block|{
name|flagdest
operator|=
name|dest
operator|++
expr_stmt|;
name|flags
operator|=
literal|0
expr_stmt|;
comment|/* All guesses are wrong initially. */
for|for
control|(
name|bitmask
operator|=
literal|1
operator|,
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|8
operator|&&
name|len
condition|;
name|i
operator|++
operator|,
name|bitmask
operator|<<=
literal|1
control|)
block|{
if|if
condition|(
name|priv
operator|->
name|GuessTable
index|[
name|priv
operator|->
name|Hash
index|]
operator|==
operator|*
name|source
condition|)
comment|/* Guess was right - don't output. */
name|flags
operator||=
name|bitmask
expr_stmt|;
else|else
block|{
comment|/* Guess wrong, output char. */
name|priv
operator|->
name|GuessTable
index|[
name|priv
operator|->
name|Hash
index|]
operator|=
operator|*
name|source
expr_stmt|;
operator|*
name|dest
operator|++
operator|=
operator|*
name|source
expr_stmt|;
block|}
name|HASH
argument_list|(
operator|*
name|source
operator|++
argument_list|)
expr_stmt|;
name|len
operator|--
expr_stmt|;
block|}
operator|*
name|flagdest
operator|=
name|flags
expr_stmt|;
block|}
return|return
operator|(
name|dest
operator|-
name|orgdest
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Pred1Decompress()  *  * Returns decompressed size, or -1 if we ran out of space.  */
end_comment

begin_function
specifier|static
name|int
name|Pred1Decompress
parameter_list|(
name|node_p
name|node
parameter_list|,
name|u_char
modifier|*
name|source
parameter_list|,
name|u_char
modifier|*
name|dest
parameter_list|,
name|int
name|slen
parameter_list|,
name|int
name|dlen
parameter_list|)
block|{
specifier|const
name|priv_p
name|priv
init|=
name|NG_NODE_PRIVATE
argument_list|(
name|node
argument_list|)
decl_stmt|;
name|int
name|i
decl_stmt|,
name|bitmask
decl_stmt|;
name|u_char
name|flags
decl_stmt|,
modifier|*
name|orgdest
decl_stmt|;
name|orgdest
operator|=
name|dest
expr_stmt|;
while|while
condition|(
name|slen
condition|)
block|{
name|flags
operator|=
operator|*
name|source
operator|++
expr_stmt|;
name|slen
operator|--
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|bitmask
operator|=
literal|1
init|;
name|i
operator|<
literal|8
condition|;
name|i
operator|++
operator|,
name|bitmask
operator|<<=
literal|1
control|)
block|{
if|if
condition|(
name|dlen
operator|<=
literal|0
condition|)
return|return
operator|(
operator|-
literal|1
operator|)
return|;
if|if
condition|(
name|flags
operator|&
name|bitmask
condition|)
comment|/* Guess correct */
operator|*
name|dest
operator|=
name|priv
operator|->
name|GuessTable
index|[
name|priv
operator|->
name|Hash
index|]
expr_stmt|;
else|else
block|{
if|if
condition|(
operator|!
name|slen
condition|)
comment|/* We seem to be really done -- cabo. */
break|break;
comment|/* Guess wrong. */
name|priv
operator|->
name|GuessTable
index|[
name|priv
operator|->
name|Hash
index|]
operator|=
operator|*
name|source
expr_stmt|;
comment|/* Read from source. */
operator|*
name|dest
operator|=
operator|*
name|source
operator|++
expr_stmt|;
name|slen
operator|--
expr_stmt|;
block|}
name|HASH
argument_list|(
operator|*
name|dest
operator|++
argument_list|)
expr_stmt|;
name|dlen
operator|--
expr_stmt|;
block|}
block|}
return|return
operator|(
name|dest
operator|-
name|orgdest
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Pred1SyncTable()  */
end_comment

begin_function
specifier|static
name|void
name|Pred1SyncTable
parameter_list|(
name|node_p
name|node
parameter_list|,
name|u_char
modifier|*
name|source
parameter_list|,
name|int
name|len
parameter_list|)
block|{
specifier|const
name|priv_p
name|priv
init|=
name|NG_NODE_PRIVATE
argument_list|(
name|node
argument_list|)
decl_stmt|;
while|while
condition|(
name|len
operator|--
condition|)
block|{
name|priv
operator|->
name|GuessTable
index|[
name|priv
operator|->
name|Hash
index|]
operator|=
operator|*
name|source
expr_stmt|;
name|HASH
argument_list|(
operator|*
name|source
operator|++
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*  * Crc16()  *  * Compute the 16 bit frame check value, per RFC 1171 Appendix B,  * on an array of bytes.  */
end_comment

begin_function
specifier|static
name|uint16_t
name|Crc16
parameter_list|(
name|uint16_t
name|crc
parameter_list|,
name|u_char
modifier|*
name|cp
parameter_list|,
name|int
name|len
parameter_list|)
block|{
while|while
condition|(
name|len
operator|--
condition|)
name|crc
operator|=
operator|(
name|crc
operator|>>
literal|8
operator|)
operator|^
name|Crc16Table
index|[
operator|(
name|crc
operator|^
operator|*
name|cp
operator|++
operator|)
operator|&
literal|0xff
index|]
expr_stmt|;
return|return
operator|(
name|crc
operator|)
return|;
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|uint16_t
name|Crc16Table
index|[
literal|256
index|]
init|=
block|{
comment|/* 00 */
literal|0x0000
block|,
literal|0x1189
block|,
literal|0x2312
block|,
literal|0x329b
block|,
literal|0x4624
block|,
literal|0x57ad
block|,
literal|0x6536
block|,
literal|0x74bf
block|,
comment|/* 08 */
literal|0x8c48
block|,
literal|0x9dc1
block|,
literal|0xaf5a
block|,
literal|0xbed3
block|,
literal|0xca6c
block|,
literal|0xdbe5
block|,
literal|0xe97e
block|,
literal|0xf8f7
block|,
comment|/* 10 */
literal|0x1081
block|,
literal|0x0108
block|,
literal|0x3393
block|,
literal|0x221a
block|,
literal|0x56a5
block|,
literal|0x472c
block|,
literal|0x75b7
block|,
literal|0x643e
block|,
comment|/* 18 */
literal|0x9cc9
block|,
literal|0x8d40
block|,
literal|0xbfdb
block|,
literal|0xae52
block|,
literal|0xdaed
block|,
literal|0xcb64
block|,
literal|0xf9ff
block|,
literal|0xe876
block|,
comment|/* 20 */
literal|0x2102
block|,
literal|0x308b
block|,
literal|0x0210
block|,
literal|0x1399
block|,
literal|0x6726
block|,
literal|0x76af
block|,
literal|0x4434
block|,
literal|0x55bd
block|,
comment|/* 28 */
literal|0xad4a
block|,
literal|0xbcc3
block|,
literal|0x8e58
block|,
literal|0x9fd1
block|,
literal|0xeb6e
block|,
literal|0xfae7
block|,
literal|0xc87c
block|,
literal|0xd9f5
block|,
comment|/* 30 */
literal|0x3183
block|,
literal|0x200a
block|,
literal|0x1291
block|,
literal|0x0318
block|,
literal|0x77a7
block|,
literal|0x662e
block|,
literal|0x54b5
block|,
literal|0x453c
block|,
comment|/* 38 */
literal|0xbdcb
block|,
literal|0xac42
block|,
literal|0x9ed9
block|,
literal|0x8f50
block|,
literal|0xfbef
block|,
literal|0xea66
block|,
literal|0xd8fd
block|,
literal|0xc974
block|,
comment|/* 40 */
literal|0x4204
block|,
literal|0x538d
block|,
literal|0x6116
block|,
literal|0x709f
block|,
literal|0x0420
block|,
literal|0x15a9
block|,
literal|0x2732
block|,
literal|0x36bb
block|,
comment|/* 48 */
literal|0xce4c
block|,
literal|0xdfc5
block|,
literal|0xed5e
block|,
literal|0xfcd7
block|,
literal|0x8868
block|,
literal|0x99e1
block|,
literal|0xab7a
block|,
literal|0xbaf3
block|,
comment|/* 50 */
literal|0x5285
block|,
literal|0x430c
block|,
literal|0x7197
block|,
literal|0x601e
block|,
literal|0x14a1
block|,
literal|0x0528
block|,
literal|0x37b3
block|,
literal|0x263a
block|,
comment|/* 58 */
literal|0xdecd
block|,
literal|0xcf44
block|,
literal|0xfddf
block|,
literal|0xec56
block|,
literal|0x98e9
block|,
literal|0x8960
block|,
literal|0xbbfb
block|,
literal|0xaa72
block|,
comment|/* 60 */
literal|0x6306
block|,
literal|0x728f
block|,
literal|0x4014
block|,
literal|0x519d
block|,
literal|0x2522
block|,
literal|0x34ab
block|,
literal|0x0630
block|,
literal|0x17b9
block|,
comment|/* 68 */
literal|0xef4e
block|,
literal|0xfec7
block|,
literal|0xcc5c
block|,
literal|0xddd5
block|,
literal|0xa96a
block|,
literal|0xb8e3
block|,
literal|0x8a78
block|,
literal|0x9bf1
block|,
comment|/* 70 */
literal|0x7387
block|,
literal|0x620e
block|,
literal|0x5095
block|,
literal|0x411c
block|,
literal|0x35a3
block|,
literal|0x242a
block|,
literal|0x16b1
block|,
literal|0x0738
block|,
comment|/* 78 */
literal|0xffcf
block|,
literal|0xee46
block|,
literal|0xdcdd
block|,
literal|0xcd54
block|,
literal|0xb9eb
block|,
literal|0xa862
block|,
literal|0x9af9
block|,
literal|0x8b70
block|,
comment|/* 80 */
literal|0x8408
block|,
literal|0x9581
block|,
literal|0xa71a
block|,
literal|0xb693
block|,
literal|0xc22c
block|,
literal|0xd3a5
block|,
literal|0xe13e
block|,
literal|0xf0b7
block|,
comment|/* 88 */
literal|0x0840
block|,
literal|0x19c9
block|,
literal|0x2b52
block|,
literal|0x3adb
block|,
literal|0x4e64
block|,
literal|0x5fed
block|,
literal|0x6d76
block|,
literal|0x7cff
block|,
comment|/* 90 */
literal|0x9489
block|,
literal|0x8500
block|,
literal|0xb79b
block|,
literal|0xa612
block|,
literal|0xd2ad
block|,
literal|0xc324
block|,
literal|0xf1bf
block|,
literal|0xe036
block|,
comment|/* 98 */
literal|0x18c1
block|,
literal|0x0948
block|,
literal|0x3bd3
block|,
literal|0x2a5a
block|,
literal|0x5ee5
block|,
literal|0x4f6c
block|,
literal|0x7df7
block|,
literal|0x6c7e
block|,
comment|/* a0 */
literal|0xa50a
block|,
literal|0xb483
block|,
literal|0x8618
block|,
literal|0x9791
block|,
literal|0xe32e
block|,
literal|0xf2a7
block|,
literal|0xc03c
block|,
literal|0xd1b5
block|,
comment|/* a8 */
literal|0x2942
block|,
literal|0x38cb
block|,
literal|0x0a50
block|,
literal|0x1bd9
block|,
literal|0x6f66
block|,
literal|0x7eef
block|,
literal|0x4c74
block|,
literal|0x5dfd
block|,
comment|/* b0 */
literal|0xb58b
block|,
literal|0xa402
block|,
literal|0x9699
block|,
literal|0x8710
block|,
literal|0xf3af
block|,
literal|0xe226
block|,
literal|0xd0bd
block|,
literal|0xc134
block|,
comment|/* b8 */
literal|0x39c3
block|,
literal|0x284a
block|,
literal|0x1ad1
block|,
literal|0x0b58
block|,
literal|0x7fe7
block|,
literal|0x6e6e
block|,
literal|0x5cf5
block|,
literal|0x4d7c
block|,
comment|/* c0 */
literal|0xc60c
block|,
literal|0xd785
block|,
literal|0xe51e
block|,
literal|0xf497
block|,
literal|0x8028
block|,
literal|0x91a1
block|,
literal|0xa33a
block|,
literal|0xb2b3
block|,
comment|/* c8 */
literal|0x4a44
block|,
literal|0x5bcd
block|,
literal|0x6956
block|,
literal|0x78df
block|,
literal|0x0c60
block|,
literal|0x1de9
block|,
literal|0x2f72
block|,
literal|0x3efb
block|,
comment|/* d0 */
literal|0xd68d
block|,
literal|0xc704
block|,
literal|0xf59f
block|,
literal|0xe416
block|,
literal|0x90a9
block|,
literal|0x8120
block|,
literal|0xb3bb
block|,
literal|0xa232
block|,
comment|/* d8 */
literal|0x5ac5
block|,
literal|0x4b4c
block|,
literal|0x79d7
block|,
literal|0x685e
block|,
literal|0x1ce1
block|,
literal|0x0d68
block|,
literal|0x3ff3
block|,
literal|0x2e7a
block|,
comment|/* e0 */
literal|0xe70e
block|,
literal|0xf687
block|,
literal|0xc41c
block|,
literal|0xd595
block|,
literal|0xa12a
block|,
literal|0xb0a3
block|,
literal|0x8238
block|,
literal|0x93b1
block|,
comment|/* e8 */
literal|0x6b46
block|,
literal|0x7acf
block|,
literal|0x4854
block|,
literal|0x59dd
block|,
literal|0x2d62
block|,
literal|0x3ceb
block|,
literal|0x0e70
block|,
literal|0x1ff9
block|,
comment|/* f0 */
literal|0xf78f
block|,
literal|0xe606
block|,
literal|0xd49d
block|,
literal|0xc514
block|,
literal|0xb1ab
block|,
literal|0xa022
block|,
literal|0x92b9
block|,
literal|0x8330
block|,
comment|/* f8 */
literal|0x7bc7
block|,
literal|0x6a4e
block|,
literal|0x58d5
block|,
literal|0x495c
block|,
literal|0x3de3
block|,
literal|0x2c6a
block|,
literal|0x1ef1
block|,
literal|0x0f78
block|}
decl_stmt|;
end_decl_stmt

end_unit

