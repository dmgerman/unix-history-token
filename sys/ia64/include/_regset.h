begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (c) 2002, 2003 Marcel Moolenaar  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  *  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR  * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES  * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,  * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT  * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,  * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY  * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF  * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  *  * $FreeBSD$  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|_MACHINE_REGSET_H_
end_ifndef

begin_define
define|#
directive|define
name|_MACHINE_REGSET_H_
end_define

begin_comment
comment|/*  * Create register sets, based on the runtime specification. This allows  * us to better reuse code and to copy sets around more efficiently.  * Contexts are defined in terms of these sets. These include trapframe,  * sigframe, pcb, mcontext, reg and fpreg. Other candidates are unwind  * and coredump related contexts.  *  * Notes:  * o  Constant registers (r0, f0 and f1) are not accounted for,  * o  The stacked registers (r32-r127) are not accounted for,  * o  Predicates are not split across sets.  */
end_comment

begin_comment
comment|/* A single FP register. */
end_comment

begin_union
union|union
name|_ia64_fpreg
block|{
name|unsigned
name|char
name|fpr_bits
index|[
literal|16
index|]
decl_stmt|;
name|long
name|double
name|fpr_flt
decl_stmt|;
block|}
union|;
end_union

begin_comment
comment|/*  * Special registers.  */
end_comment

begin_struct
struct|struct
name|_special
block|{
name|unsigned
name|long
name|sp
decl_stmt|;
name|unsigned
name|long
name|unat
decl_stmt|;
comment|/* NaT before spilling */
name|unsigned
name|long
name|rp
decl_stmt|;
name|unsigned
name|long
name|pr
decl_stmt|;
name|unsigned
name|long
name|pfs
decl_stmt|;
name|unsigned
name|long
name|bspstore
decl_stmt|;
name|unsigned
name|long
name|rnat
decl_stmt|;
name|unsigned
name|long
name|__spare
decl_stmt|;
comment|/* Userland context and syscalls */
name|unsigned
name|long
name|tp
decl_stmt|;
name|unsigned
name|long
name|rsc
decl_stmt|;
name|unsigned
name|long
name|fpsr
decl_stmt|;
name|unsigned
name|long
name|psr
decl_stmt|;
comment|/* ASYNC: Interrupt specific */
name|unsigned
name|long
name|gp
decl_stmt|;
name|unsigned
name|long
name|ndirty
decl_stmt|;
name|unsigned
name|long
name|cfm
decl_stmt|;
name|unsigned
name|long
name|iip
decl_stmt|;
name|unsigned
name|long
name|ifa
decl_stmt|;
name|unsigned
name|long
name|isr
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|_high_fp
block|{
name|union
name|_ia64_fpreg
name|fr32
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr33
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr34
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr35
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr36
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr37
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr38
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr39
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr40
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr41
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr42
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr43
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr44
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr45
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr46
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr47
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr48
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr49
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr50
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr51
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr52
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr53
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr54
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr55
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr56
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr57
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr58
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr59
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr60
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr61
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr62
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr63
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr64
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr65
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr66
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr67
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr68
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr69
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr70
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr71
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr72
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr73
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr74
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr75
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr76
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr77
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr78
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr79
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr80
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr81
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr82
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr83
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr84
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr85
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr86
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr87
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr88
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr89
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr90
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr91
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr92
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr93
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr94
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr95
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr96
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr97
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr98
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr99
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr100
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr101
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr102
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr103
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr104
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr105
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr106
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr107
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr108
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr109
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr110
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr111
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr112
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr113
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr114
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr115
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr116
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr117
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr118
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr119
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr120
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr121
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr122
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr123
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr124
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr125
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr126
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr127
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/*  * Preserved registers.  */
end_comment

begin_struct
struct|struct
name|_callee_saved
block|{
name|unsigned
name|long
name|unat
decl_stmt|;
comment|/* NaT after spilling. */
name|unsigned
name|long
name|gr4
decl_stmt|;
name|unsigned
name|long
name|gr5
decl_stmt|;
name|unsigned
name|long
name|gr6
decl_stmt|;
name|unsigned
name|long
name|gr7
decl_stmt|;
name|unsigned
name|long
name|br1
decl_stmt|;
name|unsigned
name|long
name|br2
decl_stmt|;
name|unsigned
name|long
name|br3
decl_stmt|;
name|unsigned
name|long
name|br4
decl_stmt|;
name|unsigned
name|long
name|br5
decl_stmt|;
name|unsigned
name|long
name|lc
decl_stmt|;
name|unsigned
name|long
name|__spare
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|_callee_saved_fp
block|{
name|union
name|_ia64_fpreg
name|fr2
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr3
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr4
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr5
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr16
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr17
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr18
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr19
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr20
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr21
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr22
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr23
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr24
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr25
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr26
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr27
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr28
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr29
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr30
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr31
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/*  * Scratch registers.  */
end_comment

begin_struct
struct|struct
name|_caller_saved
block|{
name|unsigned
name|long
name|unat
decl_stmt|;
comment|/* NaT after spilling. */
name|unsigned
name|long
name|gr2
decl_stmt|;
name|unsigned
name|long
name|gr3
decl_stmt|;
name|unsigned
name|long
name|gr8
decl_stmt|;
name|unsigned
name|long
name|gr9
decl_stmt|;
name|unsigned
name|long
name|gr10
decl_stmt|;
name|unsigned
name|long
name|gr11
decl_stmt|;
name|unsigned
name|long
name|gr14
decl_stmt|;
name|unsigned
name|long
name|gr15
decl_stmt|;
name|unsigned
name|long
name|gr16
decl_stmt|;
name|unsigned
name|long
name|gr17
decl_stmt|;
name|unsigned
name|long
name|gr18
decl_stmt|;
name|unsigned
name|long
name|gr19
decl_stmt|;
name|unsigned
name|long
name|gr20
decl_stmt|;
name|unsigned
name|long
name|gr21
decl_stmt|;
name|unsigned
name|long
name|gr22
decl_stmt|;
name|unsigned
name|long
name|gr23
decl_stmt|;
name|unsigned
name|long
name|gr24
decl_stmt|;
name|unsigned
name|long
name|gr25
decl_stmt|;
name|unsigned
name|long
name|gr26
decl_stmt|;
name|unsigned
name|long
name|gr27
decl_stmt|;
name|unsigned
name|long
name|gr28
decl_stmt|;
name|unsigned
name|long
name|gr29
decl_stmt|;
name|unsigned
name|long
name|gr30
decl_stmt|;
name|unsigned
name|long
name|gr31
decl_stmt|;
name|unsigned
name|long
name|br6
decl_stmt|;
name|unsigned
name|long
name|br7
decl_stmt|;
name|unsigned
name|long
name|ccv
decl_stmt|;
name|unsigned
name|long
name|csd
decl_stmt|;
name|unsigned
name|long
name|ssd
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|_caller_saved_fp
block|{
name|union
name|_ia64_fpreg
name|fr6
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr7
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr8
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr9
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr10
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr11
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr12
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr13
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr14
decl_stmt|;
name|union
name|_ia64_fpreg
name|fr15
decl_stmt|;
block|}
struct|;
end_struct

begin_ifdef
ifdef|#
directive|ifdef
name|_KERNEL
end_ifdef

begin_function_decl
name|void
name|restore_callee_saved
parameter_list|(
specifier|const
name|struct
name|_callee_saved
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|restore_callee_saved_fp
parameter_list|(
specifier|const
name|struct
name|_callee_saved_fp
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|restore_high_fp
parameter_list|(
specifier|const
name|struct
name|_high_fp
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|save_callee_saved
parameter_list|(
name|struct
name|_callee_saved
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|save_callee_saved_fp
parameter_list|(
name|struct
name|_callee_saved_fp
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|save_high_fp
parameter_list|(
name|struct
name|_high_fp
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* _MACHINE_REGSET_H_ */
end_comment

end_unit

