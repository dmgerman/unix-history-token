begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * @(#)menu.c	1.2  %G%  *  * Menu subwindow routines for the SUN Gremlin picture editor.  *  * Mark Opperman (opcode@monet.BERKELEY)  *  */
end_comment

begin_include
include|#
directive|include
file|<suntool/tool_hs.h>
end_include

begin_include
include|#
directive|include
file|<suntool/menu.h>
end_include

begin_include
include|#
directive|include
file|<errno.h>
end_include

begin_include
include|#
directive|include
file|"gremlin.h"
end_include

begin_include
include|#
directive|include
file|"icondata.h"
end_include

begin_comment
comment|/* imports from graphics.c */
end_comment

begin_extern
extern|extern GRCurrentSetOn(
end_extern

begin_empty_stmt
unit|)
empty_stmt|;
end_empty_stmt

begin_comment
comment|/*  imports from short.c */
end_comment

begin_decl_stmt
specifier|extern
name|int
name|adj
index|[]
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* imports from text.c */
end_comment

begin_extern
extern|extern TxMsgOK(
end_extern

begin_empty_stmt
unit|)
empty_stmt|;
end_empty_stmt

begin_comment
comment|/* imports from sun.c */
end_comment

begin_extern
extern|extern pw_box(
end_extern

begin_empty_stmt
unit|)
empty_stmt|;
end_empty_stmt

begin_comment
comment|/* imports from main.c */
end_comment

begin_extern
extern|extern Artmode;
end_extern

begin_comment
comment|/* type of point layed down */
end_comment

begin_extern
extern|extern Adjustment;
end_extern

begin_extern
extern|extern Alignment;
end_extern

begin_extern
extern|extern GravityOn;
end_extern

begin_extern
extern|extern menu_fd;
end_extern

begin_decl_stmt
specifier|extern
name|struct
name|pixfont
modifier|*
name|text_pf
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|struct
name|rect
name|menu_size
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|ELT
modifier|*
name|MEN
index|[]
decl_stmt|;
end_decl_stmt

begin_extern
extern|extern SymbolicLines;
end_extern

begin_extern
extern|extern FLASH_READY;
end_extern

begin_function_decl
specifier|extern
function_decl|(
modifier|*
name|lastcommand
function_decl|)
parameter_list|()
function_decl|;
end_function_decl

begin_comment
comment|/* previous command */
end_comment

begin_extern
extern|extern lasttext;
end_extern

begin_comment
comment|/* TRUE if previous cmd uses text input */
end_comment

begin_comment
comment|/* forward references */
end_comment

begin_extern
extern|extern align_up(
end_extern

begin_empty_stmt
unit|)
empty_stmt|;
end_empty_stmt

begin_extern
extern|extern align_down(
end_extern

begin_empty_stmt
unit|)
empty_stmt|;
end_empty_stmt

begin_define
define|#
directive|define
name|M_CLEAR_POINTS
value|(caddr_t) 1
end_define

begin_define
define|#
directive|define
name|M_SHOW_POINTS
value|(caddr_t) 2
end_define

begin_define
define|#
directive|define
name|M_GRIPE
value|(caddr_t) 3
end_define

begin_define
define|#
directive|define
name|M_POINT
value|(caddr_t) 4
end_define

begin_decl_stmt
name|struct
name|menuitem
name|misc_items
index|[]
init|=
block|{
block|{
name|MENU_IMAGESTRING
block|,
literal|"Clear Points"
block|,
name|M_CLEAR_POINTS
block|}
block|,
block|{
name|MENU_IMAGESTRING
block|,
literal|"Show Points"
block|,
name|M_SHOW_POINTS
block|}
block|,
block|{
name|MENU_IMAGESTRING
block|,
literal|"Gripe"
block|,
name|M_GRIPE
block|}
block|,
block|{
name|MENU_IMAGESTRING
block|,
literal|"Point"
block|,
name|M_POINT
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|menu
name|misc_menu
init|=
block|{
name|MENU_IMAGESTRING
block|,
literal|"Misc"
block|,
sizeof|sizeof
argument_list|(
name|misc_items
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
expr|struct
name|menuitem
argument_list|)
block|,
name|misc_items
block|,
literal|0
block|,
literal|0
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|menu
modifier|*
name|misc_menu_stack
init|=
operator|&
name|misc_menu
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|M_EDIT
value|(caddr_t) 1
end_define

begin_define
define|#
directive|define
name|M_PATH
value|(caddr_t) 2
end_define

begin_define
define|#
directive|define
name|M_READ
value|(caddr_t) 3
end_define

begin_define
define|#
directive|define
name|M_SAVE_SET
value|(caddr_t) 4
end_define

begin_define
define|#
directive|define
name|M_WRITE
value|(caddr_t) 5
end_define

begin_decl_stmt
name|struct
name|menuitem
name|file_items
index|[]
init|=
block|{
block|{
name|MENU_IMAGESTRING
block|,
literal|"Edit"
block|,
name|M_EDIT
block|}
block|,
block|{
name|MENU_IMAGESTRING
block|,
literal|"Path"
block|,
name|M_PATH
block|}
block|,
block|{
name|MENU_IMAGESTRING
block|,
literal|"Read"
block|,
name|M_READ
block|}
block|,
block|{
name|MENU_IMAGESTRING
block|,
literal|"Save Set"
block|,
name|M_SAVE_SET
block|}
block|,
block|{
name|MENU_IMAGESTRING
block|,
literal|"Write"
block|,
name|M_WRITE
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|menu
name|file_menu
init|=
block|{
name|MENU_IMAGESTRING
block|,
literal|"File"
block|,
sizeof|sizeof
argument_list|(
name|file_items
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
expr|struct
name|menuitem
argument_list|)
block|,
name|file_items
block|,
literal|0
block|,
literal|0
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|menu
modifier|*
name|file_menu_stack
init|=
operator|&
name|file_menu
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|icon_x
decl_stmt|,
name|icon_y
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* location of currently selected menu icon */
end_comment

begin_decl_stmt
name|int
name|icon_last
init|=
operator|-
literal|1
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* menu index of currently selected menu icon */
end_comment

begin_decl_stmt
name|int
name|just_x
decl_stmt|,
name|just_y
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* location of justify marker within justify icon */
end_comment

begin_decl_stmt
name|int
name|just_last
init|=
operator|-
literal|1
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* justify index of currently selected mode */
end_comment

begin_decl_stmt
name|struct
name|pixrect
modifier|*
name|save_just_pr
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|MNReverseJustify
parameter_list|()
value|pw_write(menu_pw, just_x + 1, just_y, 5, 5, \ 		     PIX_SRC ^ PIX_DST,&dot_pr, 0, 0)
end_define

begin_comment
comment|/* imports from main.c */
end_comment

begin_decl_stmt
specifier|extern
name|struct
name|pixwin
modifier|*
name|menu_pw
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|struct
name|toolsw
modifier|*
name|menu_sw
decl_stmt|;
end_decl_stmt

begin_extern
extern|extern CFONT;
end_extern

begin_extern
extern|extern CSIZE;
end_extern

begin_extern
extern|extern CJUST;
end_extern

begin_extern
extern|extern CBRUSH;
end_extern

begin_extern
extern|extern CSTIPPLE;
end_extern

begin_comment
comment|/* imports from help.c */
end_comment

begin_extern
extern|extern justify_help(
end_extern

begin_operator
unit|)
operator|,
end_operator

begin_expr_stmt
name|help
argument_list|()
operator|,
name|horizontal_help
argument_list|()
operator|,
name|vertical_help
argument_list|()
operator|,
name|size1_help
argument_list|()
operator|,
name|size2_help
argument_list|()
operator|,
name|size3_help
argument_list|()
operator|,
name|size4_help
argument_list|()
operator|,
name|roman_help
argument_list|()
operator|,
name|italics_help
argument_list|()
operator|,
name|bold_help
argument_list|()
operator|,
name|special_help
argument_list|()
operator|,
name|scale_help
argument_list|()
operator|,
name|move_help
argument_list|()
operator|,
name|hmirror_help
argument_list|()
operator|,
name|vmirror_help
argument_list|()
operator|,
name|include_help
argument_list|()
operator|,
name|linestyle_help
argument_list|()
operator|,
name|align_help
argument_list|()
operator|,
name|pan_help
argument_list|()
operator|,
name|polygon_help
argument_list|()
operator|,
name|bpolygon_help
argument_list|()
operator|,
name|get1_help
argument_list|()
operator|,
name|get2_help
argument_list|()
operator|,
name|get3_help
argument_list|()
operator|,
name|get4_help
argument_list|()
operator|,
name|put1_help
argument_list|()
operator|,
name|put2_help
argument_list|()
operator|,
name|put3_help
argument_list|()
operator|,
name|put4_help
argument_list|()
operator|,
name|brush1_help
argument_list|()
operator|,
name|brush2_help
argument_list|()
operator|,
name|brush3_help
argument_list|()
operator|,
name|brush4_help
argument_list|()
operator|,
name|brush5_help
argument_list|()
operator|,
name|brush6_help
argument_list|()
operator|,
name|stipple1_help
argument_list|()
operator|,
name|stipple2_help
argument_list|()
operator|,
name|stipple3_help
argument_list|()
operator|,
name|stipple4_help
argument_list|()
operator|,
name|stipple5_help
argument_list|()
operator|,
name|stipple6_help
argument_list|()
operator|,
name|stipple7_help
argument_list|()
operator|,
name|stipple8_help
argument_list|()
operator|,
name|copy_help
argument_list|()
operator|,
name|arrow_help
argument_list|()
operator|,
name|text_help
argument_list|()
operator|,
name|misc_help
argument_list|()
operator|,
name|undo_help
argument_list|()
operator|,
name|erase_help
argument_list|()
operator|,
name|movepoint_help
argument_list|()
operator|,
name|rotate_help
argument_list|()
operator|,
name|filecabinet_help
argument_list|()
operator|,
name|boxinc_help
argument_list|()
operator|,
name|manhattan_help
argument_list|()
operator|,
name|gravity_help
argument_list|()
operator|,
name|arc_help
argument_list|()
operator|,
name|curve_help
argument_list|()
operator|,
name|vector_help
argument_list|()
operator|,
name|box_help
argument_list|()
operator|,
name|grid_help
argument_list|()
operator|,
name|littlepoint_help
argument_list|()
operator|,
name|menusw_help
argument_list|()
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* imports from sunlong.c */
end_comment

begin_extern
extern|extern LGBrush1(
end_extern

begin_operator
unit|)
operator|,
end_operator

begin_expr_stmt
name|LGBrush2
argument_list|()
operator|,
name|LGBrush3
argument_list|()
operator|,
name|LGBrush4
argument_list|()
operator|,
name|LGBrush5
argument_list|()
operator|,
name|LGBrush6
argument_list|()
operator|,
name|LGClearPoints
argument_list|()
operator|,
name|LGPath
argument_list|()
operator|,
name|LGEdit
argument_list|()
operator|,
name|LGFont1
argument_list|()
operator|,
name|LGFont2
argument_list|()
operator|,
name|LGFont3
argument_list|()
operator|,
name|LGFont4
argument_list|()
operator|,
name|LGGet1
argument_list|()
operator|,
name|LGGet2
argument_list|()
operator|,
name|LGGet3
argument_list|()
operator|,
name|LGGet4
argument_list|()
operator|,
name|LGGripe
argument_list|()
operator|,
name|LGHMirror
argument_list|()
operator|,
name|LGHAdjust
argument_list|()
operator|,
name|LGIncludeSet
argument_list|()
operator|,
name|LGLineStyle
argument_list|()
operator|,
name|LGLittlePoint
argument_list|()
operator|,
name|LGMBrush1
argument_list|()
operator|,
name|LGMBrush2
argument_list|()
operator|,
name|LGMBrush3
argument_list|()
operator|,
name|LGMBrush4
argument_list|()
operator|,
name|LGMBrush5
argument_list|()
operator|,
name|LGMBrush6
argument_list|()
operator|,
name|LGMCurve
argument_list|()
operator|,
name|LGMFont1
argument_list|()
operator|,
name|LGMFont2
argument_list|()
operator|,
name|LGMFont3
argument_list|()
operator|,
name|LGMFont4
argument_list|()
operator|,
name|LGMJustify
argument_list|()
operator|,
name|LGMPan
argument_list|()
operator|,
name|LGMSize1
argument_list|()
operator|,
name|LGMSize2
argument_list|()
operator|,
name|LGMSize3
argument_list|()
operator|,
name|LGMSize4
argument_list|()
operator|,
name|LGMStipple1
argument_list|()
operator|,
name|LGMStipple2
argument_list|()
operator|,
name|LGMStipple3
argument_list|()
operator|,
name|LGMStipple4
argument_list|()
operator|,
name|LGMStipple5
argument_list|()
operator|,
name|LGMStipple6
argument_list|()
operator|,
name|LGMStipple7
argument_list|()
operator|,
name|LGMStipple8
argument_list|()
operator|,
name|LGMText
argument_list|()
operator|,
name|LGMPoint
argument_list|()
operator|,
name|LGMVector
argument_list|()
operator|,
name|nop
argument_list|()
operator|,
name|LGPan
argument_list|()
operator|,
name|LGPolygon
argument_list|()
operator|,
name|LGBPolygon
argument_list|()
operator|,
name|LGMPolygon
argument_list|()
operator|,
name|LGMBPolygon
argument_list|()
operator|,
name|LGOPoint
argument_list|()
operator|,
name|LGRead
argument_list|()
operator|,
name|LGSave
argument_list|()
operator|,
name|LGShowPoints
argument_list|()
operator|,
name|LGSize1
argument_list|()
operator|,
name|LGSize2
argument_list|()
operator|,
name|LGSize3
argument_list|()
operator|,
name|LGSize4
argument_list|()
operator|,
name|LGStipple1
argument_list|()
operator|,
name|LGStipple2
argument_list|()
operator|,
name|LGStipple3
argument_list|()
operator|,
name|LGStipple4
argument_list|()
operator|,
name|LGStipple5
argument_list|()
operator|,
name|LGStipple6
argument_list|()
operator|,
name|LGStipple7
argument_list|()
operator|,
name|LGStipple8
argument_list|()
operator|,
name|LGText
argument_list|()
operator|,
name|LGUndo
argument_list|()
operator|,
name|LGVAdjust
argument_list|()
operator|,
name|LGVMirror
argument_list|()
operator|,
name|LGWrite
argument_list|()
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* imports from short.c */
end_comment

begin_extern
extern|extern SHArrow(
end_extern

begin_operator
unit|)
operator|,
end_operator

begin_expr_stmt
name|SHBox
argument_list|()
operator|,
name|SHCopy
argument_list|()
operator|,
name|SHDefineSet
argument_list|()
operator|,
name|SHDrawArc
argument_list|()
operator|,
name|SHDrawCurve
argument_list|()
operator|,
name|SHDrawVector
argument_list|()
operator|,
name|SHErase
argument_list|()
operator|,
name|SHGravity
argument_list|()
operator|,
name|SHGrid
argument_list|()
operator|,
name|SHMAdjust
argument_list|()
operator|,
name|SHSave1
argument_list|()
operator|,
name|SHSave2
argument_list|()
operator|,
name|SHSave3
argument_list|()
operator|,
name|SHSave4
argument_list|()
operator|,
name|SHRotate
argument_list|()
operator|,
name|SHScale
argument_list|()
operator|,
name|SHSetArea
argument_list|()
operator|,
name|SHMSetArea
argument_list|()
operator|,
name|SHTranslate
argument_list|()
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* imports from suntools */
end_comment

begin_function_decl
specifier|extern
name|struct
name|menuitem
modifier|*
name|menu_display
parameter_list|()
function_decl|;
end_function_decl

begin_comment
comment|/* justify_mark marks the text handle positions for the JUSTIFY icon    relative to the icon's upper left corner */
end_comment

begin_decl_stmt
name|struct
name|pr_pos
name|justify_mark
index|[
literal|9
index|]
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* just_to_indx maps the justification values (TOPLEFT, ..., BOTRIGHT)    to the corresponding index in the justify_mark array */
end_comment

begin_decl_stmt
name|int
name|just_to_indx
index|[]
init|=
block|{
literal|6
block|,
literal|8
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|2
block|,
literal|3
block|,
literal|5
block|,
literal|7
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* indx_to_just maps the internal justification values (0, ..., 8)    to the gremlin justification values (TOPLEFT, ..., BOTRIGHT) */
end_comment

begin_decl_stmt
name|int
name|indx_to_just
index|[]
init|=
block|{
name|TOPLEFT
block|,
name|TOPCENT
block|,
name|TOPRIGHT
block|,
name|CENTLEFT
block|,
name|CENTCENT
block|,
name|CENTRIGHT
block|,
name|BOTLEFT
block|,
name|BOTCENT
block|,
name|BOTRIGHT
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|_menu
name|menu
index|[]
init|=
block|{
define|#
directive|define
name|M_SIZE1
value|0
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|0
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|1
block|,
operator|&
name|size1_pr
block|,
name|LGSize1
block|,
name|LGMSize1
block|,
name|size1_help
block|}
block|,
define|#
directive|define
name|M_ROMAN
value|(M_SIZE1+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|2
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|2
block|,
operator|&
name|roman_pr
block|,
name|LGFont1
block|,
name|LGMFont1
block|,
name|roman_help
block|}
block|,
define|#
directive|define
name|M_JUSTIFY
value|(M_ROMAN+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|2
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|1
block|,
operator|&
name|justify_pr
block|,
name|nop
block|,
name|nop
block|,
name|nop
block|}
block|,
define|#
directive|define
name|M_SCALE
value|(M_JUSTIFY+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|0
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|9
block|,
operator|&
name|scale_pr
block|,
name|SHScale
block|,
name|nop
block|,
name|scale_help
block|}
block|,
define|#
directive|define
name|M_TRANSLATE
value|(M_SCALE+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|0
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|8
block|,
operator|&
name|move_pr
block|,
name|SHTranslate
block|,
name|nop
block|,
name|move_help
block|}
block|,
define|#
directive|define
name|M_HMIRROR
value|(M_TRANSLATE+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|0
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|11
block|,
operator|&
name|hmirror_pr
block|,
name|LGHMirror
block|,
name|nop
block|,
name|hmirror_help
block|}
block|,
define|#
directive|define
name|M_VMIRROR
value|(M_HMIRROR+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|1
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|11
block|,
operator|&
name|vmirror_pr
block|,
name|LGVMirror
block|,
name|nop
block|,
name|vmirror_help
block|}
block|,
define|#
directive|define
name|M_DEFINE_SET
value|(M_VMIRROR+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|2
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|14
block|,
operator|&
name|include_pr
block|,
name|SHDefineSet
block|,
name|LGIncludeSet
block|,
name|include_help
block|}
block|,
define|#
directive|define
name|M_PUT1
value|(M_DEFINE_SET+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|0
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|15
block|,
operator|&
name|put1_pr
block|,
name|SHSave1
block|,
name|nop
block|,
name|put1_help
block|}
block|,
define|#
directive|define
name|M_PUT3
value|(M_PUT1+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|0
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|16
block|,
operator|&
name|put3_pr
block|,
name|SHSave3
block|,
name|nop
block|,
name|put3_help
block|}
block|,
define|#
directive|define
name|M_HORZ_ADJUST
value|(M_PUT3+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|0
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|17
block|,
operator|&
name|horizontal_pr
block|,
name|LGHAdjust
block|,
name|nop
block|,
name|horizontal_help
block|}
block|,
define|#
directive|define
name|M_VERT_ADJUST
value|(M_HORZ_ADJUST+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|0
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|18
block|,
operator|&
name|vertical_pr
block|,
name|LGVAdjust
block|,
name|nop
block|,
name|vertical_help
block|}
block|,
define|#
directive|define
name|M_STIPPLE1
value|(M_VERT_ADJUST+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|0
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|3
block|,
operator|&
name|white_pr
block|,
name|LGStipple1
block|,
name|LGMStipple1
block|,
name|stipple1_help
block|}
block|,
define|#
directive|define
name|M_STIPPLE5
value|(M_STIPPLE1+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|1
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|3
block|,
operator|&
name|stipple5_pr
block|,
name|LGStipple5
block|,
name|LGMStipple5
block|,
name|stipple5_help
block|}
block|,
define|#
directive|define
name|M_SIZE2
value|(M_STIPPLE5+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|1
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|1
block|,
operator|&
name|size2_pr
block|,
name|LGSize2
block|,
name|LGMSize2
block|,
name|size2_help
block|}
block|,
define|#
directive|define
name|M_ITALICS
value|(M_SIZE2+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|3
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|2
block|,
operator|&
name|italics_pr
block|,
name|LGFont2
block|,
name|LGMFont2
block|,
name|italics_help
block|}
block|,
define|#
directive|define
name|M_COPY
value|(M_ITALICS+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|1
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|8
block|,
operator|&
name|copy_pr
block|,
name|SHCopy
block|,
name|nop
block|,
name|copy_help
block|}
block|,
define|#
directive|define
name|M_ERASE
value|(M_COPY+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|1
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|9
block|,
operator|&
name|erase_pr
block|,
name|SHErase
block|,
name|nop
block|,
name|erase_help
block|}
block|,
define|#
directive|define
name|M_MOVE_POINT
value|(M_ERASE+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|1
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|10
block|,
operator|&
name|movepoint_pr
block|,
name|LGMPoint
block|,
name|nop
block|,
name|movepoint_help
block|}
block|,
define|#
directive|define
name|M_ROTATE
value|(M_MOVE_POINT+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|0
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|10
block|,
operator|&
name|rotate_pr
block|,
name|SHRotate
block|,
name|nop
block|,
name|rotate_help
block|}
block|,
define|#
directive|define
name|M_FILE
value|(M_ROTATE+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|2
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|13
block|,
operator|&
name|filecabinet_pr
block|,
name|nop
block|,
name|nop
block|,
name|filecabinet_help
block|}
block|,
define|#
directive|define
name|M_PAN
value|(M_FILE+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|1
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|14
block|,
operator|&
name|pan_pr
block|,
name|LGPan
block|,
name|LGMPan
block|,
name|pan_help
block|}
block|,
define|#
directive|define
name|M_SET_AREA
value|(M_PAN+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|3
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|14
block|,
operator|&
name|boxinc_pr
block|,
name|SHSetArea
block|,
name|SHMSetArea
block|,
name|boxinc_help
block|}
block|,
define|#
directive|define
name|M_PUT2
value|(M_SET_AREA+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|1
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|15
block|,
operator|&
name|put2_pr
block|,
name|SHSave2
block|,
name|nop
block|,
name|put2_help
block|}
block|,
define|#
directive|define
name|M_PUT4
value|(M_PUT2+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|1
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|16
block|,
operator|&
name|put4_pr
block|,
name|SHSave4
block|,
name|nop
block|,
name|put4_help
block|}
block|,
define|#
directive|define
name|M_MANHATTAN_ADJUST
value|(M_PUT4+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|1
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|17
block|,
operator|&
name|horvert_pr
block|,
name|SHMAdjust
block|,
name|nop
block|,
name|manhattan_help
block|}
block|,
define|#
directive|define
name|M_GRAVITY
value|(M_MANHATTAN_ADJUST+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|1
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|18
block|,
operator|&
name|gravity_pr
block|,
name|SHGravity
block|,
name|nop
block|,
name|gravity_help
block|}
block|,
define|#
directive|define
name|M_STIPPLE6
value|(M_GRAVITY+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|1
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|4
block|,
operator|&
name|stipple6_pr
block|,
name|LGStipple6
block|,
name|LGMStipple6
block|,
name|stipple6_help
block|}
block|,
define|#
directive|define
name|M_STIPPLE2
value|(M_STIPPLE6+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|0
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|4
block|,
operator|&
name|gray_pr
block|,
name|LGStipple2
block|,
name|LGMStipple2
block|,
name|stipple2_help
block|}
block|,
define|#
directive|define
name|M_SIZE3
value|(M_STIPPLE2+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|0
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|2
block|,
operator|&
name|size3_pr
block|,
name|LGSize3
block|,
name|LGMSize3
block|,
name|size3_help
block|}
block|,
define|#
directive|define
name|M_BOLD
value|(M_SIZE3+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|2
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|3
block|,
operator|&
name|bold_pr
block|,
name|LGFont3
block|,
name|LGMFont3
block|,
name|bold_help
block|}
block|,
define|#
directive|define
name|M_BRUSH1
value|(M_BOLD+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|3
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|4
block|,
operator|&
name|dotted_pr
block|,
name|LGBrush1
block|,
name|LGMBrush1
block|,
name|brush1_help
block|}
block|,
define|#
directive|define
name|M_BRUSH2
value|(M_BRUSH1+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|3
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|6
block|,
operator|&
name|broken_pr
block|,
name|LGBrush2
block|,
name|LGMBrush2
block|,
name|brush2_help
block|}
block|,
define|#
directive|define
name|M_BRUSH3
value|(M_BRUSH2+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|2
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|6
block|,
operator|&
name|thick_pr
block|,
name|LGBrush3
block|,
name|LGMBrush3
block|,
name|brush3_help
block|}
block|,
define|#
directive|define
name|M_TEXT
value|(M_BRUSH3+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|2
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|8
block|,
operator|&
name|text_pr
block|,
name|LGText
block|,
name|LGMText
block|,
name|text_help
block|}
block|,
define|#
directive|define
name|M_BPOLYGON
value|(M_TEXT+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|2
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|9
block|,
operator|&
name|bpolygon_pr
block|,
name|LGBPolygon
block|,
name|LGMBPolygon
block|,
name|bpolygon_help
block|}
block|,
define|#
directive|define
name|M_POLYGON
value|(M_BPOLYGON+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|2
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|10
block|,
operator|&
name|polygon_pr
block|,
name|LGPolygon
block|,
name|LGMPolygon
block|,
name|polygon_help
block|}
block|,
define|#
directive|define
name|M_ARROW
value|(M_POLYGON+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|2
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|11
block|,
operator|&
name|arrow_pr
block|,
name|SHArrow
block|,
name|nop
block|,
name|arrow_help
block|}
block|,
define|#
directive|define
name|M_HELP
value|(M_ARROW+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|1
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|13
block|,
operator|&
name|question_pr
block|,
name|help
block|,
name|help
block|,
name|help
block|}
block|,
define|#
directive|define
name|M_MISC
value|(M_HELP+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|0
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|14
block|,
operator|&
name|misc_pr
block|,
name|nop
block|,
name|nop
block|,
name|misc_help
block|}
block|,
define|#
directive|define
name|M_GET1
value|(M_MISC+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|2
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|15
block|,
operator|&
name|get1_pr
block|,
name|LGGet1
block|,
name|nop
block|,
name|get1_help
block|}
block|,
define|#
directive|define
name|M_GET3
value|(M_GET1+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|2
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|16
block|,
operator|&
name|get3_pr
block|,
name|LGGet3
block|,
name|nop
block|,
name|get3_help
block|}
block|,
define|#
directive|define
name|M_LINESTYLE
value|(M_GET3+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|0
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|13
block|,
operator|&
name|linestyle_pr
block|,
name|LGLineStyle
block|,
name|nop
block|,
name|linestyle_help
block|}
block|,
define|#
directive|define
name|M_ALIGN
value|(M_LINESTYLE+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|2
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|17
block|,
operator|&
name|align_pr
block|,
name|nop
block|,
name|nop
block|,
name|align_help
block|}
block|,
define|#
directive|define
name|M_STIPPLE3
value|(M_ALIGN+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|0
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|5
block|,
operator|&
name|_50_pr
block|,
name|LGStipple3
block|,
name|LGMStipple3
block|,
name|stipple3_help
block|}
block|,
define|#
directive|define
name|M_STIPPLE7
value|(M_STIPPLE3+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|1
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|5
block|,
operator|&
name|stipple7_pr
block|,
name|LGStipple7
block|,
name|LGMStipple7
block|,
name|stipple7_help
block|}
block|,
define|#
directive|define
name|M_STIPPLE8
value|(M_STIPPLE7+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|1
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|6
block|,
operator|&
name|stipple8_pr
block|,
name|LGStipple8
block|,
name|LGMStipple8
block|,
name|stipple8_help
block|}
block|,
define|#
directive|define
name|M_STIPPLE4
value|(M_STIPPLE8+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|0
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|6
block|,
operator|&
name|black_pr
block|,
name|LGStipple4
block|,
name|LGMStipple4
block|,
name|stipple4_help
block|}
block|,
define|#
directive|define
name|M_SIZE4
value|(M_STIPPLE4+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|1
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|2
block|,
operator|&
name|size4_pr
block|,
name|LGSize4
block|,
name|LGMSize4
block|,
name|size4_help
block|}
block|,
define|#
directive|define
name|M_SPECIAL
value|(M_SIZE4+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|3
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|3
block|,
operator|&
name|special_pr
block|,
name|LGFont4
block|,
name|LGMFont4
block|,
name|special_help
block|}
block|,
define|#
directive|define
name|M_BRUSH4
value|(M_SPECIAL+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|3
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|5
block|,
operator|&
name|dashed_pr
block|,
name|LGBrush4
block|,
name|LGMBrush4
block|,
name|brush4_help
block|}
block|,
define|#
directive|define
name|M_BRUSH5
value|(M_BRUSH4+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|2
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|4
block|,
operator|&
name|narrow_pr
block|,
name|LGBrush5
block|,
name|LGMBrush5
block|,
name|brush5_help
block|}
block|,
define|#
directive|define
name|M_BRUSH6
value|(M_BRUSH5+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|2
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|5
block|,
operator|&
name|medium_pr
block|,
name|LGBrush6
block|,
name|LGMBrush6
block|,
name|brush6_help
block|}
block|,
define|#
directive|define
name|M_DRAW_ARC
value|(M_BRUSH6+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|3
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|8
block|,
operator|&
name|arc_pr
block|,
name|SHDrawArc
block|,
name|nop
block|,
name|arc_help
block|}
block|,
define|#
directive|define
name|M_DRAW_CURVE
value|(M_DRAW_ARC+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|3
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|9
block|,
operator|&
name|curve_pr
block|,
name|SHDrawCurve
block|,
name|LGMCurve
block|,
name|curve_help
block|}
block|,
define|#
directive|define
name|M_DRAW_VECTOR
value|(M_DRAW_CURVE+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|3
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|10
block|,
operator|&
name|vector_pr
block|,
name|SHDrawVector
block|,
name|LGMVector
block|,
name|vector_help
block|}
block|,
define|#
directive|define
name|M_BOX
value|(M_DRAW_VECTOR+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|3
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|11
block|,
operator|&
name|box_pr
block|,
name|SHBox
block|,
name|nop
block|,
name|box_help
block|}
block|,
define|#
directive|define
name|M_UNDO
value|(M_BOX+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|3
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|13
block|,
operator|&
name|undo_pr
block|,
name|LGUndo
block|,
name|nop
block|,
name|undo_help
block|}
block|,
define|#
directive|define
name|M_GET2
value|(M_UNDO+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|3
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|15
block|,
operator|&
name|get2_pr
block|,
name|LGGet2
block|,
name|nop
block|,
name|get2_help
block|}
block|,
define|#
directive|define
name|M_GET4
value|(M_GET2+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|3
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|16
block|,
operator|&
name|get4_pr
block|,
name|LGGet4
block|,
name|nop
block|,
name|get4_help
block|}
block|,
define|#
directive|define
name|M_GRID
value|(M_GET4+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|3
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|18
block|,
operator|&
name|grid_pr
block|,
name|SHGrid
block|,
name|nop
block|,
name|grid_help
block|}
block|,
define|#
directive|define
name|M_LITTLE_POINT
value|(M_GRID+1)
block|{
name|MENU_LEFT
operator|+
name|ICON_BORDER
operator|+
name|MENU_X
operator|*
literal|2
block|,
name|MENU_TOP
operator|+
name|ICON_BORDER
operator|+
name|MENU_Y
operator|*
literal|18
block|,
operator|&
name|littlepoint_pr
block|,
name|LGLittlePoint
block|,
name|nop
block|,
name|littlepoint_help
block|}
block|,
block|{
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|(
expr|struct
name|pixrect
operator|*
operator|)
literal|0
block|,
operator|(
name|int
argument_list|(
operator|*
argument_list|)
argument_list|()
operator|)
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*   * Following is a map of brushes and mode made available to the  * outside world for selection of these items for highlighting.  * The numbers indicate the items location in the menu.  */
end_comment

begin_decl_stmt
name|int
name|HiBuffer
index|[]
init|=
block|{
name|M_PUT1
block|,
name|M_PUT2
block|,
name|M_PUT3
block|,
name|M_PUT4
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* user symbols */
end_comment

begin_decl_stmt
name|int
name|HiFont
index|[]
init|=
block|{
name|M_ROMAN
block|,
name|M_ITALICS
block|,
name|M_BOLD
block|,
name|M_SPECIAL
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|HiSize
index|[]
init|=
block|{
name|M_SIZE1
block|,
name|M_SIZE2
block|,
name|M_SIZE3
block|,
name|M_SIZE4
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|HiBrush
index|[]
init|=
block|{
name|M_BRUSH1
block|,
name|M_BRUSH2
block|,
name|M_BRUSH3
block|,
name|M_BRUSH4
block|,
name|M_BRUSH5
block|,
name|M_BRUSH6
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* brushes */
end_comment

begin_decl_stmt
name|int
name|HiMode
index|[]
init|=
block|{
name|M_HORZ_ADJUST
block|,
name|M_VERT_ADJUST
block|,
name|M_MANHATTAN_ADJUST
block|,
name|M_GRAVITY
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* horz, vert, man, grav. */
end_comment

begin_decl_stmt
name|int
name|HiStipple
index|[]
init|=
block|{
name|M_STIPPLE1
block|,
name|M_STIPPLE2
block|,
name|M_STIPPLE3
block|,
name|M_STIPPLE4
block|,
name|M_STIPPLE5
block|,
name|M_STIPPLE6
block|,
name|M_STIPPLE7
block|,
name|M_STIPPLE8
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|HiArtMode
init|=
name|M_LITTLE_POINT
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|HiLineStyle
init|=
name|M_LINESTYLE
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * This routine initializatizes the positioning of menu items -  * currently only necessary for the justify icon.  */
end_comment

begin_macro
name|MNInitMenu
argument_list|()
end_macro

begin_block
block|{
name|int
name|justify_x
decl_stmt|,
name|justify_y
decl_stmt|;
name|int
name|i
decl_stmt|;
name|justify_x
operator|=
name|menu
index|[
name|M_JUSTIFY
index|]
operator|.
name|menu_x
expr_stmt|;
name|justify_y
operator|=
name|menu
index|[
name|M_JUSTIFY
index|]
operator|.
name|menu_y
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|9
condition|;
name|i
operator|++
control|)
block|{
switch|switch
condition|(
name|i
operator|%
literal|3
condition|)
block|{
case|case
literal|0
case|:
comment|/* left */
name|justify_mark
index|[
name|i
index|]
operator|.
name|x
operator|=
name|justify_x
operator|-
literal|1
expr_stmt|;
break|break;
case|case
literal|1
case|:
comment|/* center */
name|justify_mark
index|[
name|i
index|]
operator|.
name|x
operator|=
name|justify_x
operator|+
literal|18
expr_stmt|;
break|break;
case|case
literal|2
case|:
comment|/* right */
name|justify_mark
index|[
name|i
index|]
operator|.
name|x
operator|=
name|justify_x
operator|+
literal|35
expr_stmt|;
break|break;
block|}
switch|switch
condition|(
name|i
operator|/
literal|3
condition|)
block|{
case|case
literal|0
case|:
comment|/* top */
name|justify_mark
index|[
name|i
index|]
operator|.
name|y
operator|=
name|justify_y
operator|-
literal|2
expr_stmt|;
break|break;
case|case
literal|1
case|:
comment|/* center */
name|justify_mark
index|[
name|i
index|]
operator|.
name|y
operator|=
name|justify_y
operator|+
literal|5
expr_stmt|;
break|break;
case|case
literal|2
case|:
comment|/* bottom */
name|justify_mark
index|[
name|i
index|]
operator|.
name|y
operator|=
name|justify_y
operator|+
literal|12
expr_stmt|;
break|break;
block|}
block|}
if|if
condition|(
operator|(
name|save_just_pr
operator|=
name|mem_create
argument_list|(
literal|6
argument_list|,
literal|6
argument_list|,
literal|1
argument_list|)
operator|)
operator|==
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"cannot create save_just_pr.\n"
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
block|}
end_block

begin_comment
comment|/* end MNInitMenu */
end_comment

begin_comment
comment|/*  * This routine displays the menu defined by initmenu  */
end_comment

begin_macro
name|MNDisplayMenu
argument_list|()
end_macro

begin_block
block|{
specifier|register
name|i
expr_stmt|;
specifier|register
name|struct
name|_menu
modifier|*
name|m
decl_stmt|;
name|char
name|buf
index|[
literal|4
index|]
decl_stmt|;
name|pw_text
argument_list|(
name|menu_pw
argument_list|,
literal|28
argument_list|,
name|menu
index|[
name|M_SIZE1
index|]
operator|.
name|menu_y
operator|-
name|MENU_Y
operator|+
name|TEXT_BASELINE
argument_list|,
name|PIX_SRC
operator||
name|PIX_DST
argument_list|,
name|text_pf
argument_list|,
literal|"styles"
argument_list|)
expr_stmt|;
name|pw_text
argument_list|(
name|menu_pw
argument_list|,
literal|24
argument_list|,
name|menu
index|[
name|M_DRAW_ARC
index|]
operator|.
name|menu_y
operator|-
name|MENU_Y
operator|+
name|TEXT_BASELINE
argument_list|,
name|PIX_SRC
operator||
name|PIX_DST
argument_list|,
name|text_pf
argument_list|,
literal|"drawing"
argument_list|)
expr_stmt|;
name|pw_text
argument_list|(
name|menu_pw
argument_list|,
literal|32
argument_list|,
name|menu
index|[
name|M_FILE
index|]
operator|.
name|menu_y
operator|-
name|MENU_Y
operator|+
name|TEXT_BASELINE
argument_list|,
name|PIX_SRC
operator||
name|PIX_DST
argument_list|,
name|text_pf
argument_list|,
literal|"other"
argument_list|)
expr_stmt|;
name|pw_box
argument_list|(
name|menu_pw
argument_list|,
literal|2
argument_list|,
literal|2
argument_list|,
name|MENUSW_WIDTH
operator|-
literal|3
argument_list|,
name|menu
index|[
name|M_BRUSH2
index|]
operator|.
name|menu_y
operator|+
name|ICON_SIZE
operator|+
literal|3
argument_list|,
name|PIX_SRC
operator||
name|PIX_DST
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|pw_box
argument_list|(
name|menu_pw
argument_list|,
literal|2
argument_list|,
name|menu
index|[
name|M_DRAW_ARC
index|]
operator|.
name|menu_y
operator|-
name|MENU_Y
operator|-
literal|2
argument_list|,
name|MENUSW_WIDTH
operator|-
literal|3
argument_list|,
name|menu
index|[
name|M_BOX
index|]
operator|.
name|menu_y
operator|+
name|ICON_SIZE
operator|+
literal|3
argument_list|,
name|PIX_SRC
operator||
name|PIX_DST
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|pw_box
argument_list|(
name|menu_pw
argument_list|,
literal|2
argument_list|,
name|menu
index|[
name|M_FILE
index|]
operator|.
name|menu_y
operator|-
name|MENU_Y
operator|-
literal|2
argument_list|,
name|MENUSW_WIDTH
operator|-
literal|3
argument_list|,
literal|509
comment|/*menu[M_LITTLE_POINT].menu_y + ICON_SIZE + 3*/
argument_list|,
name|PIX_SRC
operator||
name|PIX_DST
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|i
operator|=
literal|0
expr_stmt|;
do|do
block|{
name|m
operator|=
operator|&
name|menu
index|[
name|i
index|]
expr_stmt|;
name|pw_write
argument_list|(
name|menu_pw
argument_list|,
name|m
operator|->
name|menu_x
argument_list|,
name|m
operator|->
name|menu_y
argument_list|,
name|m
operator|->
name|menu_icon
operator|->
name|pr_width
argument_list|,
name|m
operator|->
name|menu_icon
operator|->
name|pr_height
argument_list|,
name|PIX_SRC
argument_list|,
name|m
operator|->
name|menu_icon
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|is_stipple
argument_list|(
name|m
operator|->
name|menu_icon
argument_list|)
condition|)
block|{
name|pw_write
argument_list|(
name|menu_pw
argument_list|,
name|m
operator|->
name|menu_x
argument_list|,
name|m
operator|->
name|menu_y
argument_list|,
name|openbox_pr
operator|.
name|pr_width
argument_list|,
name|openbox_pr
operator|.
name|pr_height
argument_list|,
name|PIX_SRC
operator||
name|PIX_DST
argument_list|,
operator|&
name|openbox_pr
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
block|}
do|while
condition|(
name|menu
index|[
operator|++
name|i
index|]
operator|.
name|menu_x
operator|!=
operator|-
literal|1
condition|)
do|;
if|if
condition|(
name|Adjustment
operator|!=
name|NOADJ
condition|)
name|MNHighLt
argument_list|(
name|HiMode
index|[
name|adj
index|[
name|Adjustment
index|]
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|GravityOn
condition|)
name|MNHighLt
argument_list|(
name|HiMode
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|SymbolicLines
condition|)
name|MNHighLt
argument_list|(
name|HiLineStyle
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|Artmode
condition|)
name|MNHighLt
argument_list|(
name|HiArtMode
argument_list|)
expr_stmt|;
name|MNHighLt
argument_list|(
name|HiFont
index|[
name|CFONT
operator|-
literal|1
index|]
argument_list|)
expr_stmt|;
name|MNHighLt
argument_list|(
name|HiSize
index|[
name|CSIZE
operator|-
literal|1
index|]
argument_list|)
expr_stmt|;
name|MNHighLt
argument_list|(
name|HiBrush
index|[
name|CBRUSH
operator|-
literal|1
index|]
argument_list|)
expr_stmt|;
name|MNHighLt
argument_list|(
name|HiStipple
index|[
name|CSTIPPLE
operator|-
literal|1
index|]
argument_list|)
expr_stmt|;
name|pw_read
argument_list|(
name|save_just_pr
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|6
argument_list|,
literal|6
argument_list|,
name|PIX_SRC
argument_list|,
name|menu_pw
argument_list|,
name|justify_mark
index|[
name|just_to_indx
index|[
name|CJUST
index|]
index|]
operator|.
name|x
argument_list|,
name|justify_mark
index|[
name|just_to_indx
index|[
name|CJUST
index|]
index|]
operator|.
name|y
argument_list|)
expr_stmt|;
name|pw_write
argument_list|(
name|menu_pw
argument_list|,
name|justify_mark
index|[
name|just_to_indx
index|[
name|CJUST
index|]
index|]
operator|.
name|x
operator|+
literal|1
argument_list|,
name|justify_mark
index|[
name|just_to_indx
index|[
name|CJUST
index|]
index|]
operator|.
name|y
argument_list|,
literal|5
argument_list|,
literal|5
argument_list|,
name|PIX_SRC
argument_list|,
operator|&
name|dot_pr
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|NUSER
condition|;
operator|++
name|i
control|)
block|{
if|if
condition|(
operator|!
name|DBNullelt
argument_list|(
name|MEN
index|[
name|i
index|]
argument_list|)
condition|)
name|MNHighLt
argument_list|(
name|HiBuffer
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"%3d"
argument_list|,
name|Alignment
argument_list|)
expr_stmt|;
name|pw_text
argument_list|(
name|menu_pw
argument_list|,
name|menu
index|[
name|M_ALIGN
index|]
operator|.
name|menu_x
operator|+
literal|16
argument_list|,
name|menu
index|[
name|M_ALIGN
index|]
operator|.
name|menu_y
operator|+
literal|12
argument_list|,
name|PIX_SRC
operator|^
name|PIX_DST
argument_list|,
name|text_pf
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
end_block

begin_expr_stmt
name|menu_left
argument_list|(
name|ie
argument_list|)
specifier|register
expr|struct
name|inputevent
operator|*
name|ie
expr_stmt|;
end_expr_stmt

begin_block
block|{
specifier|register
name|index
expr_stmt|;
name|TxMsgOK
argument_list|()
expr_stmt|;
name|lasttext
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
operator|(
name|index
operator|=
name|icon_last
operator|)
operator|>=
literal|0
condition|)
block|{
if|if
condition|(
name|index
operator|==
name|M_ALIGN
condition|)
block|{
name|lastcommand
operator|=
name|align_up
expr_stmt|;
name|align_up
argument_list|()
expr_stmt|;
return|return;
block|}
comment|/* current set on, un-highlight icon */
name|GRCurrentSetOn
argument_list|()
expr_stmt|;
name|MNReverse
argument_list|(
name|index
argument_list|)
expr_stmt|;
name|icon_last
operator|=
operator|-
literal|1
expr_stmt|;
if|if
condition|(
name|index
operator|==
name|M_FILE
condition|)
block|{
name|menu_filer
argument_list|(
name|ie
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|index
operator|==
name|M_MISC
condition|)
block|{
name|menu_misc
argument_list|(
name|ie
argument_list|)
expr_stmt|;
return|return;
block|}
name|lastcommand
operator|=
name|menu
index|[
name|index
index|]
operator|.
name|menu_function
expr_stmt|;
if|if
condition|(
name|index
operator|==
name|M_TEXT
condition|)
name|lasttext
operator|=
name|TRUE
expr_stmt|;
call|(
modifier|*
name|lastcommand
call|)
argument_list|()
expr_stmt|;
comment|/* (*(menu[index].menu_function))(); */
name|FLASH_READY
operator|=
literal|0
expr_stmt|;
comment|/* don't flash; it may have taken a while */
return|return;
block|}
if|if
condition|(
name|just_last
operator|>=
literal|0
condition|)
block|{
comment|/* in JUSTIFY icon */
comment|/* un-highlight */
name|MNReverseJustify
argument_list|()
expr_stmt|;
comment|/* update justification mode */
name|pw_write
argument_list|(
name|menu_pw
argument_list|,
name|justify_mark
index|[
name|just_to_indx
index|[
name|CJUST
index|]
index|]
operator|.
name|x
argument_list|,
name|justify_mark
index|[
name|just_to_indx
index|[
name|CJUST
index|]
index|]
operator|.
name|y
argument_list|,
literal|6
argument_list|,
literal|6
argument_list|,
name|PIX_SRC
argument_list|,
name|save_just_pr
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|CJUST
operator|=
name|indx_to_just
index|[
name|just_last
index|]
expr_stmt|;
name|pw_read
argument_list|(
name|save_just_pr
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|6
argument_list|,
literal|6
argument_list|,
name|PIX_SRC
argument_list|,
name|menu_pw
argument_list|,
name|justify_mark
index|[
name|just_to_indx
index|[
name|CJUST
index|]
index|]
operator|.
name|x
argument_list|,
name|justify_mark
index|[
name|just_to_indx
index|[
name|CJUST
index|]
index|]
operator|.
name|y
argument_list|)
expr_stmt|;
name|pw_write
argument_list|(
name|menu_pw
argument_list|,
name|justify_mark
index|[
name|just_to_indx
index|[
name|CJUST
index|]
index|]
operator|.
name|x
operator|+
literal|1
argument_list|,
name|justify_mark
index|[
name|just_to_indx
index|[
name|CJUST
index|]
index|]
operator|.
name|y
argument_list|,
literal|5
argument_list|,
literal|5
argument_list|,
name|PIX_SRC
argument_list|,
operator|&
name|dot_pr
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|just_last
operator|=
operator|-
literal|1
expr_stmt|;
block|}
block|}
end_block

begin_expr_stmt
name|menu_middle
argument_list|(
name|ie
argument_list|)
specifier|register
expr|struct
name|inputevent
operator|*
name|ie
expr_stmt|;
end_expr_stmt

begin_block
block|{
specifier|register
name|index
expr_stmt|;
name|TxMsgOK
argument_list|()
expr_stmt|;
name|lasttext
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
operator|(
name|index
operator|=
name|icon_last
operator|)
operator|>=
literal|0
condition|)
block|{
if|if
condition|(
name|index
operator|==
name|M_ALIGN
condition|)
block|{
name|lastcommand
operator|=
name|align_down
expr_stmt|;
name|align_down
argument_list|()
expr_stmt|;
return|return;
block|}
comment|/* current set on, un-highlight icon */
name|GRCurrentSetOn
argument_list|()
expr_stmt|;
name|MNReverse
argument_list|(
name|index
argument_list|)
expr_stmt|;
name|icon_last
operator|=
operator|-
literal|1
expr_stmt|;
name|lastcommand
operator|=
name|menu
index|[
name|index
index|]
operator|.
name|menu_modify
expr_stmt|;
call|(
modifier|*
name|lastcommand
call|)
argument_list|()
expr_stmt|;
if|if
condition|(
name|index
operator|==
name|M_TEXT
condition|)
name|lasttext
operator|=
name|TRUE
expr_stmt|;
comment|/* (*(menu[index].menu_modify))(); */
name|FLASH_READY
operator|=
literal|0
expr_stmt|;
comment|/* don't flash; it may have taken a while */
return|return;
block|}
if|if
condition|(
operator|(
name|index
operator|=
name|just_last
operator|)
operator|>=
literal|0
condition|)
block|{
name|just_last
operator|=
operator|-
literal|1
expr_stmt|;
comment|/* current set on, un-highlight icon */
name|GRCurrentSetOn
argument_list|()
expr_stmt|;
name|MNReverseJustify
argument_list|()
expr_stmt|;
name|LGMJustify
argument_list|(
name|indx_to_just
index|[
name|index
index|]
argument_list|)
expr_stmt|;
block|}
block|}
end_block

begin_expr_stmt
name|menu_right
argument_list|(
name|ie
argument_list|)
specifier|register
expr|struct
name|inputevent
operator|*
name|ie
expr_stmt|;
end_expr_stmt

begin_block
block|{
specifier|register
name|index
expr_stmt|;
name|TxMsgOK
argument_list|()
expr_stmt|;
if|if
condition|(
operator|(
name|index
operator|=
name|icon_last
operator|)
operator|>=
literal|0
condition|)
block|{
name|icon_last
operator|=
operator|-
literal|1
expr_stmt|;
comment|/* un-highlight icon */
name|MNReverse
argument_list|(
name|index
argument_list|)
expr_stmt|;
operator|(
operator|*
operator|(
name|menu
index|[
name|index
index|]
operator|.
name|menu_help
operator|)
operator|)
operator|(
operator|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
operator|(
name|index
operator|=
name|just_last
operator|)
operator|>=
literal|0
condition|)
block|{
name|just_last
operator|=
operator|-
literal|1
expr_stmt|;
comment|/* un-highlight icon */
name|MNReverseJustify
argument_list|()
expr_stmt|;
name|justify_help
argument_list|()
expr_stmt|;
return|return;
block|}
name|menusw_help
argument_list|()
expr_stmt|;
block|}
end_block

begin_expr_stmt
name|menu_winexit
argument_list|(
name|ie
argument_list|)
specifier|register
expr|struct
name|inputevent
operator|*
name|ie
expr_stmt|;
end_expr_stmt

begin_block
block|{
if|if
condition|(
name|icon_last
operator|>=
literal|0
condition|)
block|{
name|MNReverse
argument_list|(
name|icon_last
argument_list|)
expr_stmt|;
name|icon_last
operator|=
operator|-
literal|1
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|just_last
operator|>=
literal|0
condition|)
block|{
name|MNReverseJustify
argument_list|()
expr_stmt|;
name|just_last
operator|=
operator|-
literal|1
expr_stmt|;
block|}
comment|/* check if leaving left or bottom edge of menu subwindow */
if|if
condition|(
operator|(
name|ie
operator|->
name|ie_locx
operator|<
literal|0
operator|)
operator|||
operator|(
name|ie
operator|->
name|ie_locy
operator|>=
name|menu_size
operator|.
name|r_height
operator|)
condition|)
name|GRCurrentSetOn
argument_list|()
expr_stmt|;
block|}
end_block

begin_comment
comment|/*  * Move align to next higher value.  */
end_comment

begin_macro
name|align_up
argument_list|()
end_macro

begin_block
block|{
name|menu_align
argument_list|(
name|TRUE
argument_list|)
expr_stmt|;
block|}
end_block

begin_comment
comment|/*  * Move align to next lower value.  */
end_comment

begin_macro
name|align_down
argument_list|()
end_macro

begin_block
block|{
name|menu_align
argument_list|(
name|FALSE
argument_list|)
expr_stmt|;
block|}
end_block

begin_define
define|#
directive|define
name|ALIGNMAX
value|512
end_define

begin_macro
name|menu_align
argument_list|(
argument|up
argument_list|)
end_macro

begin_decl_stmt
name|int
name|up
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|char
name|buf
index|[
literal|4
index|]
decl_stmt|;
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"%3d"
argument_list|,
name|Alignment
argument_list|)
expr_stmt|;
name|pw_text
argument_list|(
name|menu_pw
argument_list|,
name|menu
index|[
name|M_ALIGN
index|]
operator|.
name|menu_x
operator|+
literal|16
argument_list|,
name|menu
index|[
name|M_ALIGN
index|]
operator|.
name|menu_y
operator|+
literal|12
argument_list|,
name|PIX_SRC
operator|^
name|PIX_DST
argument_list|,
name|text_pf
argument_list|,
name|buf
argument_list|)
expr_stmt|;
if|if
condition|(
name|up
condition|)
block|{
if|if
condition|(
operator|(
name|Alignment
operator|<<=
literal|1
operator|)
operator|>
name|ALIGNMAX
condition|)
name|Alignment
operator|=
literal|1
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
operator|(
name|Alignment
operator|>>=
literal|1
operator|)
operator|==
literal|0
condition|)
name|Alignment
operator|=
name|ALIGNMAX
expr_stmt|;
block|}
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"%3d"
argument_list|,
name|Alignment
argument_list|)
expr_stmt|;
name|pw_text
argument_list|(
name|menu_pw
argument_list|,
name|menu
index|[
name|M_ALIGN
index|]
operator|.
name|menu_x
operator|+
literal|16
argument_list|,
name|menu
index|[
name|M_ALIGN
index|]
operator|.
name|menu_y
operator|+
literal|12
argument_list|,
name|PIX_SRC
operator|^
name|PIX_DST
argument_list|,
name|text_pf
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
end_block

begin_expr_stmt
name|menu_filer
argument_list|(
name|ie
argument_list|)
specifier|register
expr|struct
name|inputevent
operator|*
name|ie
expr_stmt|;
end_expr_stmt

begin_block
block|{
specifier|register
name|struct
name|menuitem
modifier|*
name|item
decl_stmt|;
name|item
operator|=
name|menu_display
argument_list|(
operator|&
name|file_menu_stack
argument_list|,
name|ie
argument_list|,
name|menu_fd
argument_list|)
expr_stmt|;
if|if
condition|(
name|item
operator|==
operator|(
expr|struct
name|menuitem
operator|*
operator|)
name|NULL
condition|)
return|return;
switch|switch
condition|(
name|item
operator|->
name|mi_data
condition|)
block|{
case|case
name|M_EDIT
case|:
name|lastcommand
operator|=
name|LGEdit
expr_stmt|;
break|break;
case|case
name|M_PATH
case|:
name|lastcommand
operator|=
name|LGPath
expr_stmt|;
break|break;
case|case
name|M_READ
case|:
name|lastcommand
operator|=
name|LGRead
expr_stmt|;
break|break;
case|case
name|M_SAVE_SET
case|:
name|lastcommand
operator|=
name|LGSave
expr_stmt|;
break|break;
case|case
name|M_WRITE
case|:
name|lastcommand
operator|=
name|LGWrite
expr_stmt|;
break|break;
default|default:
return|return;
block|}
call|(
modifier|*
name|lastcommand
call|)
argument_list|()
expr_stmt|;
name|lasttext
operator|=
name|TRUE
expr_stmt|;
block|}
end_block

begin_expr_stmt
name|menu_misc
argument_list|(
name|ie
argument_list|)
specifier|register
expr|struct
name|inputevent
operator|*
name|ie
expr_stmt|;
end_expr_stmt

begin_block
block|{
specifier|register
name|struct
name|menuitem
modifier|*
name|item
decl_stmt|;
name|item
operator|=
name|menu_display
argument_list|(
operator|&
name|misc_menu_stack
argument_list|,
name|ie
argument_list|,
name|menu_fd
argument_list|)
expr_stmt|;
if|if
condition|(
name|item
operator|==
operator|(
expr|struct
name|menuitem
operator|*
operator|)
name|NULL
condition|)
return|return;
switch|switch
condition|(
name|item
operator|->
name|mi_data
condition|)
block|{
case|case
name|M_CLEAR_POINTS
case|:
name|lastcommand
operator|=
name|LGClearPoints
expr_stmt|;
break|break;
case|case
name|M_SHOW_POINTS
case|:
name|lastcommand
operator|=
name|LGShowPoints
expr_stmt|;
break|break;
case|case
name|M_GRIPE
case|:
name|lastcommand
operator|=
name|LGGripe
expr_stmt|;
break|break;
case|case
name|M_POINT
case|:
name|lastcommand
operator|=
name|LGOPoint
expr_stmt|;
name|lasttext
operator|=
name|TRUE
expr_stmt|;
break|break;
default|default:
return|return;
block|}
call|(
modifier|*
name|lastcommand
call|)
argument_list|()
expr_stmt|;
block|}
end_block

begin_comment
comment|/*   *  find justification mode determined by (x, y) screen position   *  return -1 if not in justify icon  */
end_comment

begin_expr_stmt
name|just_index
argument_list|(
name|x
argument_list|,
name|y
argument_list|)
specifier|register
name|x
expr_stmt|;
end_expr_stmt

begin_expr_stmt
specifier|register
name|y
expr_stmt|;
end_expr_stmt

begin_block
block|{
name|x
operator|-=
name|menu
index|[
name|M_JUSTIFY
index|]
operator|.
name|menu_x
operator|-
literal|1
expr_stmt|;
name|y
operator|-=
name|menu
index|[
name|M_JUSTIFY
index|]
operator|.
name|menu_y
operator|-
literal|2
expr_stmt|;
if|if
condition|(
operator|(
name|x
operator|>
literal|41
operator|)
operator|||
operator|(
name|x
operator|<
literal|0
operator|)
operator|||
operator|(
name|y
operator|>
literal|19
operator|)
operator|||
operator|(
name|y
operator|<
literal|0
operator|)
condition|)
return|return
operator|(
operator|-
literal|1
operator|)
return|;
else|else
return|return
operator|(
operator|(
name|y
operator|/
literal|7
operator|)
operator|*
literal|3
operator|+
operator|(
name|x
operator|/
literal|14
operator|)
operator|)
return|;
block|}
end_block

begin_expr_stmt
name|mouse_move
argument_list|(
name|ie
argument_list|)
specifier|register
expr|struct
name|inputevent
operator|*
name|ie
expr_stmt|;
end_expr_stmt

begin_block
block|{
specifier|register
name|index
operator|,
name|in_icon
operator|,
name|in_xy
expr_stmt|;
comment|/* handle justify icon as a special case */
if|if
condition|(
operator|(
name|index
operator|=
name|just_index
argument_list|(
name|ie
operator|->
name|ie_locx
argument_list|,
name|ie
operator|->
name|ie_locy
argument_list|)
operator|)
operator|>=
literal|0
condition|)
block|{
if|if
condition|(
name|icon_last
operator|>=
literal|0
condition|)
block|{
comment|/* erase last highlighted icon */
name|MNReverse
argument_list|(
name|icon_last
argument_list|)
expr_stmt|;
name|icon_last
operator|=
operator|-
literal|1
expr_stmt|;
block|}
if|if
condition|(
name|just_last
operator|>=
literal|0
condition|)
comment|/* erase current justification marker */
name|MNReverseJustify
argument_list|()
expr_stmt|;
name|just_x
operator|=
name|justify_mark
index|[
name|index
index|]
operator|.
name|x
expr_stmt|;
name|just_y
operator|=
name|justify_mark
index|[
name|index
index|]
operator|.
name|y
expr_stmt|;
name|just_last
operator|=
name|index
expr_stmt|;
name|MNReverseJustify
argument_list|()
expr_stmt|;
return|return;
block|}
comment|/* ... not currently in justify icon */
if|if
condition|(
name|just_last
operator|>=
literal|0
condition|)
block|{
comment|/* previously in justify icon */
name|MNReverseJustify
argument_list|()
expr_stmt|;
name|just_last
operator|=
operator|-
literal|1
expr_stmt|;
block|}
name|in_xy
operator|=
operator|(
operator|(
name|index
operator|=
name|MNFindMenuItem
argument_list|(
name|ie
operator|->
name|ie_locx
argument_list|,
name|ie
operator|->
name|ie_locy
argument_list|)
operator|)
operator|>=
literal|0
operator|)
expr_stmt|;
name|in_icon
operator|=
operator|(
name|icon_last
operator|>=
literal|0
operator|)
expr_stmt|;
switch|switch
condition|(
operator|(
name|in_xy
operator|<<
literal|1
operator|)
operator||
name|in_icon
condition|)
block|{
case|case
literal|0
case|:
comment|/* was outside still outside */
break|break;
case|case
literal|1
case|:
comment|/* was inside now outside */
name|MNReverse
argument_list|(
name|icon_last
argument_list|)
expr_stmt|;
name|icon_last
operator|=
operator|-
literal|1
expr_stmt|;
break|break;
case|case
literal|2
case|:
comment|/* was outside now inside */
name|icon_x
operator|=
name|menu
index|[
name|index
index|]
operator|.
name|menu_x
expr_stmt|;
name|icon_y
operator|=
name|menu
index|[
name|index
index|]
operator|.
name|menu_y
expr_stmt|;
name|MNReverse
argument_list|(
name|icon_last
operator|=
name|index
argument_list|)
expr_stmt|;
break|break;
case|case
literal|3
case|:
comment|/* was inside still inside */
if|if
condition|(
operator|(
name|icon_y
operator|!=
name|menu
index|[
name|index
index|]
operator|.
name|menu_y
operator|)
operator|||
operator|(
name|icon_x
operator|!=
name|menu
index|[
name|index
index|]
operator|.
name|menu_x
operator|)
condition|)
block|{
name|MNReverse
argument_list|(
name|icon_last
argument_list|)
expr_stmt|;
name|icon_x
operator|=
name|menu
index|[
name|index
index|]
operator|.
name|menu_x
expr_stmt|;
name|icon_y
operator|=
name|menu
index|[
name|index
index|]
operator|.
name|menu_y
expr_stmt|;
name|MNReverse
argument_list|(
name|icon_last
operator|=
name|index
argument_list|)
expr_stmt|;
block|}
break|break;
block|}
block|}
end_block

begin_comment
comment|/*  *  return index into menu[] for icon at (x, y)  */
end_comment

begin_macro
name|MNFindMenuItem
argument_list|(
argument|x
argument_list|,
argument|y
argument_list|)
end_macro

begin_decl_stmt
name|int
name|x
decl_stmt|,
name|y
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|struct
name|_menu
modifier|*
name|m
decl_stmt|;
specifier|register
name|mleft
operator|,
name|mright
operator|,
name|mtop
operator|,
name|mbottom
expr_stmt|;
name|int
name|i
decl_stmt|;
name|i
operator|=
literal|0
expr_stmt|;
do|do
block|{
name|m
operator|=
operator|&
name|menu
index|[
name|i
index|]
expr_stmt|;
name|mleft
operator|=
name|m
operator|->
name|menu_x
expr_stmt|;
name|mtop
operator|=
name|m
operator|->
name|menu_y
expr_stmt|;
name|mright
operator|=
name|mleft
operator|+
name|m
operator|->
name|menu_icon
operator|->
name|pr_width
operator|-
literal|1
expr_stmt|;
name|mbottom
operator|=
name|mtop
operator|+
name|m
operator|->
name|menu_icon
operator|->
name|pr_height
operator|-
literal|1
expr_stmt|;
if|if
condition|(
operator|(
name|x
operator|<=
name|mright
operator|)
operator|&&
operator|(
name|y
operator|<=
name|mbottom
operator|)
operator|&&
operator|(
name|x
operator|>=
name|mleft
operator|)
operator|&&
operator|(
name|y
operator|>=
name|mtop
operator|)
condition|)
return|return
operator|(
name|i
operator|)
return|;
block|}
do|while
condition|(
name|menu
index|[
operator|++
name|i
index|]
operator|.
name|menu_x
operator|!=
operator|-
literal|1
condition|)
do|;
return|return
operator|(
operator|-
literal|1
operator|)
return|;
comment|/* not found */
block|}
end_block

begin_comment
comment|/* end MNFindMenuItem */
end_comment

begin_comment
comment|/*  *  Highlight menu item specified by menu array index.  */
end_comment

begin_macro
name|MNHighLt
argument_list|(
argument|index
argument_list|)
end_macro

begin_decl_stmt
name|int
name|index
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|pw_write
argument_list|(
name|menu_pw
argument_list|,
name|menu
index|[
name|index
index|]
operator|.
name|menu_x
operator|-
literal|2
argument_list|,
name|menu
index|[
name|index
index|]
operator|.
name|menu_y
operator|-
literal|2
argument_list|,
name|bigopenbox_pr
operator|.
name|pr_width
argument_list|,
name|bigopenbox_pr
operator|.
name|pr_height
argument_list|,
name|PIX_SRC
operator||
name|PIX_DST
argument_list|,
operator|&
name|bigopenbox_pr
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_block

begin_comment
comment|/*  *  Un-highlight menu item specified by menu array index.  */
end_comment

begin_macro
name|MNUnHighLt
argument_list|(
argument|index
argument_list|)
end_macro

begin_decl_stmt
name|int
name|index
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|pw_write
argument_list|(
name|menu_pw
argument_list|,
name|menu
index|[
name|index
index|]
operator|.
name|menu_x
operator|-
literal|2
argument_list|,
name|menu
index|[
name|index
index|]
operator|.
name|menu_y
operator|-
literal|2
argument_list|,
name|bigopenbox_pr
operator|.
name|pr_width
argument_list|,
name|bigopenbox_pr
operator|.
name|pr_height
argument_list|,
name|PIX_NOT
argument_list|(
name|PIX_SRC
argument_list|)
operator|&
name|PIX_DST
argument_list|,
operator|&
name|bigopenbox_pr
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_block

begin_comment
comment|/*  *  Reverse video menu item specified by menu array index.  */
end_comment

begin_macro
name|MNReverse
argument_list|(
argument|index
argument_list|)
end_macro

begin_decl_stmt
name|int
name|index
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|pw_write
argument_list|(
name|menu_pw
argument_list|,
name|menu
index|[
name|index
index|]
operator|.
name|menu_x
operator|-
literal|2
argument_list|,
name|menu
index|[
name|index
index|]
operator|.
name|menu_y
operator|-
literal|2
argument_list|,
name|menu
index|[
name|index
index|]
operator|.
name|menu_icon
operator|->
name|pr_width
operator|+
literal|4
argument_list|,
name|menu
index|[
name|index
index|]
operator|.
name|menu_icon
operator|->
name|pr_height
operator|+
literal|4
argument_list|,
name|PIX_SRC
operator|^
name|PIX_DST
argument_list|,
operator|&
name|bigblack_pr
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_block

end_unit

