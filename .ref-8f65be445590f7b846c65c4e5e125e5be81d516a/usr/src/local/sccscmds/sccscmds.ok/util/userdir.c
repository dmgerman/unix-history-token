begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_decl_stmt
specifier|static
name|char
name|Sccsid
index|[]
init|=
literal|"@(#)userdir.c	1.2	%G%"
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* 	Gets user's login directory. 	The argument must be an integer. 	Note the assumption about position of directory field in 	password file (no group id in password file). 	Returns pointer to login directory on success, 	0 on failure.         Remembers user ID and login directory for subsequent calls. */
end_comment

begin_expr_stmt
name|userdir
argument_list|(
name|uid
argument_list|)
specifier|register
name|int
name|uid
expr_stmt|;
end_expr_stmt

begin_block
block|{
name|char
name|pw
index|[
literal|200
index|]
decl_stmt|;
specifier|static
name|int
name|ouid
decl_stmt|;
specifier|static
name|char
name|ldir
index|[
literal|33
index|]
decl_stmt|;
specifier|register
name|int
name|i
decl_stmt|;
specifier|register
name|char
modifier|*
name|cp
decl_stmt|;
if|if
condition|(
name|ouid
operator|!=
name|uid
operator|||
name|ouid
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|getpw
argument_list|(
name|uid
argument_list|,
name|pw
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|cp
operator|=
name|pw
expr_stmt|;
while|while
condition|(
operator|*
name|cp
operator|++
operator|!=
literal|':'
condition|)
empty_stmt|;
comment|/* login name */
while|while
condition|(
operator|*
name|cp
operator|++
operator|!=
literal|':'
condition|)
empty_stmt|;
comment|/* passwd */
while|while
condition|(
operator|*
name|cp
operator|++
operator|!=
literal|':'
condition|)
empty_stmt|;
comment|/* user ID */
while|while
condition|(
operator|*
name|cp
operator|++
operator|!=
literal|':'
condition|)
empty_stmt|;
comment|/* comment */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|32
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
operator|(
name|ldir
index|[
name|i
index|]
operator|=
operator|*
name|cp
operator|)
operator|==
literal|'\0'
operator|||
operator|*
name|cp
operator|==
literal|':'
condition|)
break|break;
name|cp
operator|++
expr_stmt|;
block|}
name|ldir
index|[
name|i
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
return|return
operator|(
name|ldir
operator|)
return|;
block|}
end_block

end_unit

