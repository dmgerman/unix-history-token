begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/** @file   I/O Library.   The implementation of I/O operation for this library instance    are based on EFI_CPU_IO_PROTOCOL.      Copyright (c) 2009 - 2010, Intel Corporation. All rights reserved.<BR>   Copyright (c) 2017, AMD Incorporated. All rights reserved.<BR>    This program and the accompanying materials   are licensed and made available under the terms and conditions of the BSD License   which accompanies this distribution.  The full text of the license may be found at   http://opensource.org/licenses/bsd-license.php.    THE PROGRAM IS DISTRIBUTED UNDER THE BSD LICENSE ON AN "AS IS" BASIS,   WITHOUT WARRANTIES OR REPRESENTATIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED.  **/
end_comment

begin_include
include|#
directive|include
file|"SmmCpuIoLibInternal.h"
end_include

begin_comment
comment|/**   Reads registers in the EFI CPU I/O space.    Reads the I/O port specified by Port with registers width specified by Width.   The read value is returned. If such operations are not supported, then ASSERT().   This function must guarantee that all I/O read and write operations are serialized.    @param  Port          The base address of the I/O operation.                         The caller is responsible for aligning the Address if required.   @param  Width         The width of the I/O operation.    @return Data read from registers in the EFI CPU I/O space.  **/
end_comment

begin_function
name|UINT64
name|EFIAPI
name|IoReadWorker
parameter_list|(
name|IN
name|UINTN
name|Port
parameter_list|,
name|IN
name|EFI_SMM_IO_WIDTH
name|Width
parameter_list|)
block|{
name|EFI_STATUS
name|Status
decl_stmt|;
name|UINT64
name|Data
decl_stmt|;
name|Status
operator|=
name|gSmst
operator|->
name|SmmIo
operator|.
name|Io
operator|.
name|Read
argument_list|(
operator|&
name|gSmst
operator|->
name|SmmIo
argument_list|,
name|Width
argument_list|,
name|Port
argument_list|,
literal|1
argument_list|,
operator|&
name|Data
argument_list|)
expr_stmt|;
name|ASSERT_EFI_ERROR
argument_list|(
name|Status
argument_list|)
expr_stmt|;
return|return
name|Data
return|;
block|}
end_function

begin_comment
comment|/**   Writes registers in the EFI CPU I/O space.    Writes the I/O port specified by Port with registers width and value specified by Width   and Data respectively.  Data is returned. If such operations are not supported, then ASSERT().   This function must guarantee that all I/O read and write operations are serialized.    @param  Port          The base address of the I/O operation.                         The caller is responsible for aligning the Address if required.   @param  Width         The width of the I/O operation.   @param  Data          The value to write to the I/O port.    @return The parameter of Data.  **/
end_comment

begin_function
name|UINT64
name|EFIAPI
name|IoWriteWorker
parameter_list|(
name|IN
name|UINTN
name|Port
parameter_list|,
name|IN
name|EFI_SMM_IO_WIDTH
name|Width
parameter_list|,
name|IN
name|UINT64
name|Data
parameter_list|)
block|{
name|EFI_STATUS
name|Status
decl_stmt|;
name|Status
operator|=
name|gSmst
operator|->
name|SmmIo
operator|.
name|Io
operator|.
name|Write
argument_list|(
operator|&
name|gSmst
operator|->
name|SmmIo
argument_list|,
name|Width
argument_list|,
name|Port
argument_list|,
literal|1
argument_list|,
operator|&
name|Data
argument_list|)
expr_stmt|;
name|ASSERT_EFI_ERROR
argument_list|(
name|Status
argument_list|)
expr_stmt|;
return|return
name|Data
return|;
block|}
end_function

begin_comment
comment|/**   Reads memory-mapped registers in the EFI system memory space.    Reads the MMIO registers specified by Address with registers width specified by Width.   The read value is returned. If such operations are not supported, then ASSERT().   This function must guarantee that all MMIO read and write operations are serialized.    @param  Address       The MMIO register to read.                         The caller is responsible for aligning the Address if required.   @param  Width         The width of the I/O operation.    @return Data read from registers in the EFI system memory space.  **/
end_comment

begin_function
name|UINT64
name|EFIAPI
name|MmioReadWorker
parameter_list|(
name|IN
name|UINTN
name|Address
parameter_list|,
name|IN
name|EFI_SMM_IO_WIDTH
name|Width
parameter_list|)
block|{
name|EFI_STATUS
name|Status
decl_stmt|;
name|UINT64
name|Data
decl_stmt|;
name|Status
operator|=
name|gSmst
operator|->
name|SmmIo
operator|.
name|Mem
operator|.
name|Read
argument_list|(
operator|&
name|gSmst
operator|->
name|SmmIo
argument_list|,
name|Width
argument_list|,
name|Address
argument_list|,
literal|1
argument_list|,
operator|&
name|Data
argument_list|)
expr_stmt|;
name|ASSERT_EFI_ERROR
argument_list|(
name|Status
argument_list|)
expr_stmt|;
return|return
name|Data
return|;
block|}
end_function

begin_comment
comment|/**   Writes memory-mapped registers in the EFI system memory space.    Writes the MMIO registers specified by Address with registers width and value specified by Width   and Data respectively. Data is returned. If such operations are not supported, then ASSERT().   This function must guarantee that all MMIO read and write operations are serialized.    @param  Address       The MMIO register to read.                         The caller is responsible for aligning the Address if required.   @param  Width         The width of the I/O operation.   @param  Data          The value to write to the I/O port.      @return Data read from registers in the EFI system memory space.  **/
end_comment

begin_function
name|UINT64
name|EFIAPI
name|MmioWriteWorker
parameter_list|(
name|IN
name|UINTN
name|Address
parameter_list|,
name|IN
name|EFI_SMM_IO_WIDTH
name|Width
parameter_list|,
name|IN
name|UINT64
name|Data
parameter_list|)
block|{
name|EFI_STATUS
name|Status
decl_stmt|;
name|Status
operator|=
name|gSmst
operator|->
name|SmmIo
operator|.
name|Mem
operator|.
name|Write
argument_list|(
operator|&
name|gSmst
operator|->
name|SmmIo
argument_list|,
name|Width
argument_list|,
name|Address
argument_list|,
literal|1
argument_list|,
operator|&
name|Data
argument_list|)
expr_stmt|;
name|ASSERT_EFI_ERROR
argument_list|(
name|Status
argument_list|)
expr_stmt|;
return|return
name|Data
return|;
block|}
end_function

begin_comment
comment|/**   Reads an 8-bit I/O port.    Reads the 8-bit I/O port specified by Port. The 8-bit read value is returned.   This function must guarantee that all I/O read and write operations are   serialized.    If 8-bit I/O port operations are not supported, then ASSERT().    @param  Port  The I/O port to read.    @return The value read.  **/
end_comment

begin_function
name|UINT8
name|EFIAPI
name|IoRead8
parameter_list|(
name|IN
name|UINTN
name|Port
parameter_list|)
block|{
return|return
operator|(
name|UINT8
operator|)
name|IoReadWorker
argument_list|(
name|Port
argument_list|,
name|SMM_IO_UINT8
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Writes an 8-bit I/O port.    Writes the 8-bit I/O port specified by Port with the value specified by Value   and returns Value. This function must guarantee that all I/O read and write   operations are serialized.    If 8-bit I/O port operations are not supported, then ASSERT().    @param  Port  The I/O port to write.   @param  Value The value to write to the I/O port.    @return The value written the I/O port.  **/
end_comment

begin_function
name|UINT8
name|EFIAPI
name|IoWrite8
parameter_list|(
name|IN
name|UINTN
name|Port
parameter_list|,
name|IN
name|UINT8
name|Value
parameter_list|)
block|{
return|return
operator|(
name|UINT8
operator|)
name|IoWriteWorker
argument_list|(
name|Port
argument_list|,
name|SMM_IO_UINT8
argument_list|,
name|Value
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Reads a 16-bit I/O port.    Reads the 16-bit I/O port specified by Port. The 16-bit read value is returned.   This function must guarantee that all I/O read and write operations are   serialized.    If Port is not aligned on a 16-bit boundary, then ASSERT().     If 16-bit I/O port operations are not supported, then ASSERT().    @param  Port  The I/O port to read.    @return The value read.  **/
end_comment

begin_function
name|UINT16
name|EFIAPI
name|IoRead16
parameter_list|(
name|IN
name|UINTN
name|Port
parameter_list|)
block|{
comment|//
comment|// Make sure Port is aligned on a 16-bit boundary.
comment|//
name|ASSERT
argument_list|(
operator|(
name|Port
operator|&
literal|1
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
return|return
operator|(
name|UINT16
operator|)
name|IoReadWorker
argument_list|(
name|Port
argument_list|,
name|SMM_IO_UINT16
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Writes a 16-bit I/O port.    Writes the 16-bit I/O port specified by Port with the value specified by Value   and returns Value. This function must guarantee that all I/O read and write   operations are serialized.    If Port is not aligned on a 16-bit boundary, then ASSERT().    If 16-bit I/O port operations are not supported, then ASSERT().    @param  Port  The I/O port to write.   @param  Value The value to write to the I/O port.    @return The value written the I/O port.  **/
end_comment

begin_function
name|UINT16
name|EFIAPI
name|IoWrite16
parameter_list|(
name|IN
name|UINTN
name|Port
parameter_list|,
name|IN
name|UINT16
name|Value
parameter_list|)
block|{
comment|//
comment|// Make sure Port is aligned on a 16-bit boundary.
comment|//
name|ASSERT
argument_list|(
operator|(
name|Port
operator|&
literal|1
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
return|return
operator|(
name|UINT16
operator|)
name|IoWriteWorker
argument_list|(
name|Port
argument_list|,
name|SMM_IO_UINT16
argument_list|,
name|Value
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Reads a 32-bit I/O port.    Reads the 32-bit I/O port specified by Port. The 32-bit read value is returned.   This function must guarantee that all I/O read and write operations are   serialized.     If Port is not aligned on a 32-bit boundary, then ASSERT().    If 32-bit I/O port operations are not supported, then ASSERT().    @param  Port  The I/O port to read.    @return The value read.  **/
end_comment

begin_function
name|UINT32
name|EFIAPI
name|IoRead32
parameter_list|(
name|IN
name|UINTN
name|Port
parameter_list|)
block|{
comment|//
comment|// Make sure Port is aligned on a 32-bit boundary.
comment|//
name|ASSERT
argument_list|(
operator|(
name|Port
operator|&
literal|3
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
return|return
operator|(
name|UINT32
operator|)
name|IoReadWorker
argument_list|(
name|Port
argument_list|,
name|SMM_IO_UINT32
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Writes a 32-bit I/O port.    Writes the 32-bit I/O port specified by Port with the value specified by Value   and returns Value. This function must guarantee that all I/O read and write   operations are serialized.    If Port is not aligned on a 32-bit boundary, then ASSERT().    If 32-bit I/O port operations are not supported, then ASSERT().    @param  Port  The I/O port to write.   @param  Value The value to write to the I/O port.    @return The value written the I/O port.  **/
end_comment

begin_function
name|UINT32
name|EFIAPI
name|IoWrite32
parameter_list|(
name|IN
name|UINTN
name|Port
parameter_list|,
name|IN
name|UINT32
name|Value
parameter_list|)
block|{
comment|//
comment|// Make sure Port is aligned on a 32-bit boundary.
comment|//
name|ASSERT
argument_list|(
operator|(
name|Port
operator|&
literal|3
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
return|return
operator|(
name|UINT32
operator|)
name|IoWriteWorker
argument_list|(
name|Port
argument_list|,
name|SMM_IO_UINT32
argument_list|,
name|Value
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Reads a 64-bit I/O port.    Reads the 64-bit I/O port specified by Port. The 64-bit read value is returned.   This function must guarantee that all I/O read and write operations are   serialized.    If Port is not aligned on a 64-bit boundary, then ASSERT().    If 64-bit I/O port operations are not supported, then ASSERT().    @param  Port  The I/O port to read.    @return The value read.  **/
end_comment

begin_function
name|UINT64
name|EFIAPI
name|IoRead64
parameter_list|(
name|IN
name|UINTN
name|Port
parameter_list|)
block|{
comment|//
comment|// Make sure Port is aligned on a 64-bit boundary.
comment|//
name|ASSERT
argument_list|(
operator|(
name|Port
operator|&
literal|7
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
return|return
name|IoReadWorker
argument_list|(
name|Port
argument_list|,
name|SMM_IO_UINT64
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Writes a 64-bit I/O port.    Writes the 64-bit I/O port specified by Port with the value specified by Value   and returns Value. This function must guarantee that all I/O read and write   operations are serialized.    If Port is not aligned on a 64-bit boundary, then ASSERT().     If 64-bit I/O port operations are not supported, then ASSERT().    @param  Port  The I/O port to write.   @param  Value The value to write to the I/O port.    @return The value written the I/O port.  **/
end_comment

begin_function
name|UINT64
name|EFIAPI
name|IoWrite64
parameter_list|(
name|IN
name|UINTN
name|Port
parameter_list|,
name|IN
name|UINT64
name|Value
parameter_list|)
block|{
comment|//
comment|// Make sure Port is aligned on a 64-bit boundary.
comment|//
name|ASSERT
argument_list|(
operator|(
name|Port
operator|&
literal|7
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
return|return
name|IoWriteWorker
argument_list|(
name|Port
argument_list|,
name|SMM_IO_UINT64
argument_list|,
name|Value
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Reads an 8-bit I/O port fifo into a block of memory.    Reads the 8-bit I/O fifo port specified by Port.   The port is read Count times, and the read data is   stored in the provided Buffer.    This function must guarantee that all I/O read and write operations are   serialized.    If 8-bit I/O port operations are not supported, then ASSERT().    @param  Port    The I/O port to read.   @param  Count   The number of times to read I/O port.   @param  Buffer  The buffer to store the read data into.  **/
end_comment

begin_function
name|VOID
name|EFIAPI
name|IoReadFifo8
parameter_list|(
name|IN
name|UINTN
name|Port
parameter_list|,
name|IN
name|UINTN
name|Count
parameter_list|,
name|OUT
name|VOID
modifier|*
name|Buffer
parameter_list|)
block|{
name|UINT8
modifier|*
name|Buffer8
decl_stmt|;
name|Buffer8
operator|=
operator|(
name|UINT8
operator|*
operator|)
name|Buffer
expr_stmt|;
while|while
condition|(
name|Count
operator|--
operator|>
literal|0
condition|)
block|{
operator|*
name|Buffer8
operator|++
operator|=
name|IoRead8
argument_list|(
name|Port
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/**   Writes a block of memory into an 8-bit I/O port fifo.    Writes the 8-bit I/O fifo port specified by Port.   The port is written Count times, and the write data is   retrieved from the provided Buffer.    This function must guarantee that all I/O write and write operations are   serialized.    If 8-bit I/O port operations are not supported, then ASSERT().    @param  Port    The I/O port to write.   @param  Count   The number of times to write I/O port.   @param  Buffer  The buffer to retrieve the write data from.  **/
end_comment

begin_function
name|VOID
name|EFIAPI
name|IoWriteFifo8
parameter_list|(
name|IN
name|UINTN
name|Port
parameter_list|,
name|IN
name|UINTN
name|Count
parameter_list|,
name|IN
name|VOID
modifier|*
name|Buffer
parameter_list|)
block|{
name|UINT8
modifier|*
name|Buffer8
decl_stmt|;
name|Buffer8
operator|=
operator|(
name|UINT8
operator|*
operator|)
name|Buffer
expr_stmt|;
while|while
condition|(
name|Count
operator|--
operator|>
literal|0
condition|)
block|{
name|IoWrite8
argument_list|(
name|Port
argument_list|,
operator|*
name|Buffer8
operator|++
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/**   Reads a 16-bit I/O port fifo into a block of memory.    Reads the 16-bit I/O fifo port specified by Port.   The port is read Count times, and the read data is   stored in the provided Buffer.    This function must guarantee that all I/O read and write operations are   serialized.    If 16-bit I/O port operations are not supported, then ASSERT().    @param  Port    The I/O port to read.   @param  Count   The number of times to read I/O port.   @param  Buffer  The buffer to store the read data into.  **/
end_comment

begin_function
name|VOID
name|EFIAPI
name|IoReadFifo16
parameter_list|(
name|IN
name|UINTN
name|Port
parameter_list|,
name|IN
name|UINTN
name|Count
parameter_list|,
name|OUT
name|VOID
modifier|*
name|Buffer
parameter_list|)
block|{
name|UINT16
modifier|*
name|Buffer16
decl_stmt|;
comment|//
comment|// Make sure Port is aligned on a 16-bit boundary.
comment|//
name|ASSERT
argument_list|(
operator|(
name|Port
operator|&
literal|1
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|Buffer16
operator|=
operator|(
name|UINT16
operator|*
operator|)
name|Buffer
expr_stmt|;
while|while
condition|(
name|Count
operator|--
operator|>
literal|0
condition|)
block|{
operator|*
name|Buffer16
operator|++
operator|=
name|IoRead16
argument_list|(
name|Port
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/**   Writes a block of memory into a 16-bit I/O port fifo.    Writes the 16-bit I/O fifo port specified by Port.   The port is written Count times, and the write data is   retrieved from the provided Buffer.    This function must guarantee that all I/O write and write operations are   serialized.    If 16-bit I/O port operations are not supported, then ASSERT().    @param  Port    The I/O port to write.   @param  Count   The number of times to write I/O port.   @param  Buffer  The buffer to retrieve the write data from.  **/
end_comment

begin_function
name|VOID
name|EFIAPI
name|IoWriteFifo16
parameter_list|(
name|IN
name|UINTN
name|Port
parameter_list|,
name|IN
name|UINTN
name|Count
parameter_list|,
name|IN
name|VOID
modifier|*
name|Buffer
parameter_list|)
block|{
name|UINT16
modifier|*
name|Buffer16
decl_stmt|;
comment|//
comment|// Make sure Port is aligned on a 16-bit boundary.
comment|//
name|ASSERT
argument_list|(
operator|(
name|Port
operator|&
literal|1
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|Buffer16
operator|=
operator|(
name|UINT16
operator|*
operator|)
name|Buffer
expr_stmt|;
while|while
condition|(
name|Count
operator|--
operator|>
literal|0
condition|)
block|{
name|IoWrite16
argument_list|(
name|Port
argument_list|,
operator|*
name|Buffer16
operator|++
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/**   Reads a 32-bit I/O port fifo into a block of memory.    Reads the 32-bit I/O fifo port specified by Port.   The port is read Count times, and the read data is   stored in the provided Buffer.    This function must guarantee that all I/O read and write operations are   serialized.    If 32-bit I/O port operations are not supported, then ASSERT().    @param  Port    The I/O port to read.   @param  Count   The number of times to read I/O port.   @param  Buffer  The buffer to store the read data into.  **/
end_comment

begin_function
name|VOID
name|EFIAPI
name|IoReadFifo32
parameter_list|(
name|IN
name|UINTN
name|Port
parameter_list|,
name|IN
name|UINTN
name|Count
parameter_list|,
name|OUT
name|VOID
modifier|*
name|Buffer
parameter_list|)
block|{
name|UINT32
modifier|*
name|Buffer32
decl_stmt|;
comment|//
comment|// Make sure Port is aligned on a 32-bit boundary.
comment|//
name|ASSERT
argument_list|(
operator|(
name|Port
operator|&
literal|3
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|Buffer32
operator|=
operator|(
name|UINT32
operator|*
operator|)
name|Buffer
expr_stmt|;
while|while
condition|(
name|Count
operator|--
operator|>
literal|0
condition|)
block|{
operator|*
name|Buffer32
operator|++
operator|=
name|IoRead32
argument_list|(
name|Port
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/**   Writes a block of memory into a 32-bit I/O port fifo.    Writes the 32-bit I/O fifo port specified by Port.   The port is written Count times, and the write data is   retrieved from the provided Buffer.    This function must guarantee that all I/O write and write operations are   serialized.    If 32-bit I/O port operations are not supported, then ASSERT().    @param  Port    The I/O port to write.   @param  Count   The number of times to write I/O port.   @param  Buffer  The buffer to retrieve the write data from.  **/
end_comment

begin_function
name|VOID
name|EFIAPI
name|IoWriteFifo32
parameter_list|(
name|IN
name|UINTN
name|Port
parameter_list|,
name|IN
name|UINTN
name|Count
parameter_list|,
name|IN
name|VOID
modifier|*
name|Buffer
parameter_list|)
block|{
name|UINT32
modifier|*
name|Buffer32
decl_stmt|;
comment|//
comment|// Make sure Port is aligned on a 32-bit boundary.
comment|//
name|ASSERT
argument_list|(
operator|(
name|Port
operator|&
literal|3
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|Buffer32
operator|=
operator|(
name|UINT32
operator|*
operator|)
name|Buffer
expr_stmt|;
while|while
condition|(
name|Count
operator|--
operator|>
literal|0
condition|)
block|{
name|IoWrite32
argument_list|(
name|Port
argument_list|,
operator|*
name|Buffer32
operator|++
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/**   Reads an 8-bit MMIO register.    Reads the 8-bit MMIO register specified by Address. The 8-bit read value is   returned. This function must guarantee that all MMIO read and write   operations are serialized.    If 8-bit MMIO register operations are not supported, then ASSERT().    @param  Address The MMIO register to read.    @return The value read.  **/
end_comment

begin_function
name|UINT8
name|EFIAPI
name|MmioRead8
parameter_list|(
name|IN
name|UINTN
name|Address
parameter_list|)
block|{
return|return
operator|(
name|UINT8
operator|)
name|MmioReadWorker
argument_list|(
name|Address
argument_list|,
name|SMM_IO_UINT8
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Writes an 8-bit MMIO register.    Writes the 8-bit MMIO register specified by Address with the value specified   by Value and returns Value. This function must guarantee that all MMIO read   and write operations are serialized.    If 8-bit MMIO register operations are not supported, then ASSERT().    @param  Address The MMIO register to write.   @param  Value   The value to write to the MMIO register.  **/
end_comment

begin_function
name|UINT8
name|EFIAPI
name|MmioWrite8
parameter_list|(
name|IN
name|UINTN
name|Address
parameter_list|,
name|IN
name|UINT8
name|Value
parameter_list|)
block|{
return|return
operator|(
name|UINT8
operator|)
name|MmioWriteWorker
argument_list|(
name|Address
argument_list|,
name|SMM_IO_UINT8
argument_list|,
name|Value
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Reads a 16-bit MMIO register.    Reads the 16-bit MMIO register specified by Address. The 16-bit read value is   returned. This function must guarantee that all MMIO read and write   operations are serialized.    If Address is not aligned on a 16-bit boundary, then ASSERT().     If 16-bit MMIO register operations are not supported, then ASSERT().    @param  Address The MMIO register to read.    @return The value read.  **/
end_comment

begin_function
name|UINT16
name|EFIAPI
name|MmioRead16
parameter_list|(
name|IN
name|UINTN
name|Address
parameter_list|)
block|{
comment|//
comment|// Make sure Address is aligned on a 16-bit boundary.
comment|//
name|ASSERT
argument_list|(
operator|(
name|Address
operator|&
literal|1
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
return|return
operator|(
name|UINT16
operator|)
name|MmioReadWorker
argument_list|(
name|Address
argument_list|,
name|SMM_IO_UINT16
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Writes a 16-bit MMIO register.    Writes the 16-bit MMIO register specified by Address with the value specified   by Value and returns Value. This function must guarantee that all MMIO read   and write operations are serialized.    If Address is not aligned on a 16-bit boundary, then ASSERT().     If 16-bit MMIO register operations are not supported, then ASSERT().    @param  Address The MMIO register to write.   @param  Value   The value to write to the MMIO register.  **/
end_comment

begin_function
name|UINT16
name|EFIAPI
name|MmioWrite16
parameter_list|(
name|IN
name|UINTN
name|Address
parameter_list|,
name|IN
name|UINT16
name|Value
parameter_list|)
block|{
comment|//
comment|// Make sure Address is aligned on a 16-bit boundary.
comment|//
name|ASSERT
argument_list|(
operator|(
name|Address
operator|&
literal|1
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
return|return
operator|(
name|UINT16
operator|)
name|MmioWriteWorker
argument_list|(
name|Address
argument_list|,
name|SMM_IO_UINT16
argument_list|,
name|Value
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Reads a 32-bit MMIO register.    Reads the 32-bit MMIO register specified by Address. The 32-bit read value is   returned. This function must guarantee that all MMIO read and write   operations are serialized.    If Address is not aligned on a 32-bit boundary, then ASSERT().      If 32-bit MMIO register operations are not supported, then ASSERT().    @param  Address The MMIO register to read.    @return The value read.  **/
end_comment

begin_function
name|UINT32
name|EFIAPI
name|MmioRead32
parameter_list|(
name|IN
name|UINTN
name|Address
parameter_list|)
block|{
comment|//
comment|// Make sure Address is aligned on a 32-bit boundary.
comment|//
name|ASSERT
argument_list|(
operator|(
name|Address
operator|&
literal|3
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
return|return
operator|(
name|UINT32
operator|)
name|MmioReadWorker
argument_list|(
name|Address
argument_list|,
name|SMM_IO_UINT32
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Writes a 32-bit MMIO register.    Writes the 32-bit MMIO register specified by Address with the value specified   by Value and returns Value. This function must guarantee that all MMIO read   and write operations are serialized.    If Address is not aligned on a 32-bit boundary, then ASSERT().     If 32-bit MMIO register operations are not supported, then ASSERT().    @param  Address The MMIO register to write.   @param  Value   The value to write to the MMIO register.  **/
end_comment

begin_function
name|UINT32
name|EFIAPI
name|MmioWrite32
parameter_list|(
name|IN
name|UINTN
name|Address
parameter_list|,
name|IN
name|UINT32
name|Value
parameter_list|)
block|{
comment|//
comment|// Make sure Address is aligned on a 32-bit boundary.
comment|//
name|ASSERT
argument_list|(
operator|(
name|Address
operator|&
literal|3
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
return|return
operator|(
name|UINT32
operator|)
name|MmioWriteWorker
argument_list|(
name|Address
argument_list|,
name|SMM_IO_UINT32
argument_list|,
name|Value
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Reads a 64-bit MMIO register.    Reads the 64-bit MMIO register specified by Address. The 64-bit read value is   returned. This function must guarantee that all MMIO read and write   operations are serialized.    If Address is not aligned on a 64-bit boundary, then ASSERT().     If 64-bit MMIO register operations are not supported, then ASSERT().    @param  Address The MMIO register to read.    @return The value read.  **/
end_comment

begin_function
name|UINT64
name|EFIAPI
name|MmioRead64
parameter_list|(
name|IN
name|UINTN
name|Address
parameter_list|)
block|{
comment|//
comment|// Make sure Address is aligned on a 64-bit boundary.
comment|//
name|ASSERT
argument_list|(
operator|(
name|Address
operator|&
literal|7
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
return|return
operator|(
name|UINT64
operator|)
name|MmioReadWorker
argument_list|(
name|Address
argument_list|,
name|SMM_IO_UINT64
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Writes a 64-bit MMIO register.    Writes the 64-bit MMIO register specified by Address with the value specified   by Value and returns Value. This function must guarantee that all MMIO read   and write operations are serialized.    If Address is not aligned on a 64-bit boundary, then ASSERT().     If 64-bit MMIO register operations are not supported, then ASSERT().    @param  Address The MMIO register to write.   @param  Value   The value to write to the MMIO register.  **/
end_comment

begin_function
name|UINT64
name|EFIAPI
name|MmioWrite64
parameter_list|(
name|IN
name|UINTN
name|Address
parameter_list|,
name|IN
name|UINT64
name|Value
parameter_list|)
block|{
comment|//
comment|// Make sure Address is aligned on a 64-bit boundary.
comment|//
name|ASSERT
argument_list|(
operator|(
name|Address
operator|&
literal|7
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
return|return
operator|(
name|UINT64
operator|)
name|MmioWriteWorker
argument_list|(
name|Address
argument_list|,
name|SMM_IO_UINT64
argument_list|,
name|Value
argument_list|)
return|;
block|}
end_function

end_unit

