begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/** @file   Unicode and ASCII string primitives.    Copyright (c) 2006 - 2017, Intel Corporation. All rights reserved.<BR>   This program and the accompanying materials   are licensed and made available under the terms and conditions of the BSD License   which accompanies this distribution.  The full text of the license may be found at   http://opensource.org/licenses/bsd-license.php.    THE PROGRAM IS DISTRIBUTED UNDER THE BSD LICENSE ON AN "AS IS" BASIS,   WITHOUT WARRANTIES OR REPRESENTATIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED.  **/
end_comment

begin_include
include|#
directive|include
file|"BaseLibInternals.h"
end_include

begin_ifndef
ifndef|#
directive|ifndef
name|DISABLE_NEW_DEPRECATED_INTERFACES
end_ifndef

begin_comment
comment|/**   [ATTENTION] This function will be deprecated for security reason.    Copies one Null-terminated Unicode string to another Null-terminated Unicode   string and returns the new Unicode string.    This function copies the contents of the Unicode string Source to the Unicode   string Destination, and returns Destination. If Source and Destination   overlap, then the results are undefined.    If Destination is NULL, then ASSERT().   If Destination is not aligned on a 16-bit boundary, then ASSERT().   If Source is NULL, then ASSERT().   If Source is not aligned on a 16-bit boundary, then ASSERT().   If Source and Destination overlap, then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and Source contains more than   PcdMaximumUnicodeStringLength Unicode characters, not including the   Null-terminator, then ASSERT().    @param  Destination A pointer to a Null-terminated Unicode string.   @param  Source      A pointer to a Null-terminated Unicode string.    @return Destination.  **/
end_comment

begin_function
name|CHAR16
modifier|*
name|EFIAPI
name|StrCpy
parameter_list|(
name|OUT
name|CHAR16
modifier|*
name|Destination
parameter_list|,
name|IN
name|CONST
name|CHAR16
modifier|*
name|Source
parameter_list|)
block|{
name|CHAR16
modifier|*
name|ReturnValue
decl_stmt|;
comment|//
comment|// Destination cannot be NULL
comment|//
name|ASSERT
argument_list|(
name|Destination
operator|!=
name|NULL
argument_list|)
expr_stmt|;
name|ASSERT
argument_list|(
operator|(
operator|(
name|UINTN
operator|)
name|Destination
operator|&
name|BIT0
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
comment|//
comment|// Destination and source cannot overlap
comment|//
name|ASSERT
argument_list|(
call|(
name|UINTN
call|)
argument_list|(
name|Destination
operator|-
name|Source
argument_list|)
operator|>
name|StrLen
argument_list|(
name|Source
argument_list|)
argument_list|)
expr_stmt|;
name|ASSERT
argument_list|(
call|(
name|UINTN
call|)
argument_list|(
name|Source
operator|-
name|Destination
argument_list|)
operator|>
name|StrLen
argument_list|(
name|Source
argument_list|)
argument_list|)
expr_stmt|;
name|ReturnValue
operator|=
name|Destination
expr_stmt|;
while|while
condition|(
operator|*
name|Source
operator|!=
literal|0
condition|)
block|{
operator|*
operator|(
name|Destination
operator|++
operator|)
operator|=
operator|*
operator|(
name|Source
operator|++
operator|)
expr_stmt|;
block|}
operator|*
name|Destination
operator|=
literal|0
expr_stmt|;
return|return
name|ReturnValue
return|;
block|}
end_function

begin_comment
comment|/**   [ATTENTION] This function will be deprecated for security reason.    Copies up to a specified length from one Null-terminated Unicode string  to    another Null-terminated Unicode string and returns the new Unicode string.    This function copies the contents of the Unicode string Source to the Unicode   string Destination, and returns Destination. At most, Length Unicode   characters are copied from Source to Destination. If Length is 0, then   Destination is returned unmodified. If Length is greater that the number of   Unicode characters in Source, then Destination is padded with Null Unicode   characters. If Source and Destination overlap, then the results are   undefined.    If Length> 0 and Destination is NULL, then ASSERT().   If Length> 0 and Destination is not aligned on a 16-bit boundary, then ASSERT().   If Length> 0 and Source is NULL, then ASSERT().   If Length> 0 and Source is not aligned on a 16-bit boundary, then ASSERT().   If Source and Destination overlap, then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and Length is greater than    PcdMaximumUnicodeStringLength, then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and Source contains more than   PcdMaximumUnicodeStringLength Unicode characters, not including the Null-terminator,   then ASSERT().    @param  Destination A pointer to a Null-terminated Unicode string.   @param  Source      A pointer to a Null-terminated Unicode string.   @param  Length      The maximum number of Unicode characters to copy.    @return Destination.  **/
end_comment

begin_function
name|CHAR16
modifier|*
name|EFIAPI
name|StrnCpy
parameter_list|(
name|OUT
name|CHAR16
modifier|*
name|Destination
parameter_list|,
name|IN
name|CONST
name|CHAR16
modifier|*
name|Source
parameter_list|,
name|IN
name|UINTN
name|Length
parameter_list|)
block|{
name|CHAR16
modifier|*
name|ReturnValue
decl_stmt|;
if|if
condition|(
name|Length
operator|==
literal|0
condition|)
block|{
return|return
name|Destination
return|;
block|}
comment|//
comment|// Destination cannot be NULL if Length is not zero
comment|//
name|ASSERT
argument_list|(
name|Destination
operator|!=
name|NULL
argument_list|)
expr_stmt|;
name|ASSERT
argument_list|(
operator|(
operator|(
name|UINTN
operator|)
name|Destination
operator|&
name|BIT0
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
comment|//
comment|// Destination and source cannot overlap
comment|//
name|ASSERT
argument_list|(
call|(
name|UINTN
call|)
argument_list|(
name|Destination
operator|-
name|Source
argument_list|)
operator|>
name|StrLen
argument_list|(
name|Source
argument_list|)
argument_list|)
expr_stmt|;
name|ASSERT
argument_list|(
call|(
name|UINTN
call|)
argument_list|(
name|Source
operator|-
name|Destination
argument_list|)
operator|>=
name|Length
argument_list|)
expr_stmt|;
if|if
condition|(
name|PcdGet32
argument_list|(
name|PcdMaximumUnicodeStringLength
argument_list|)
operator|!=
literal|0
condition|)
block|{
name|ASSERT
argument_list|(
name|Length
operator|<=
name|PcdGet32
argument_list|(
name|PcdMaximumUnicodeStringLength
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|ReturnValue
operator|=
name|Destination
expr_stmt|;
while|while
condition|(
operator|(
operator|*
name|Source
operator|!=
literal|L'
expr|\0'
operator|)
operator|&&
operator|(
name|Length
operator|>
literal|0
operator|)
condition|)
block|{
operator|*
operator|(
name|Destination
operator|++
operator|)
operator|=
operator|*
operator|(
name|Source
operator|++
operator|)
expr_stmt|;
name|Length
operator|--
expr_stmt|;
block|}
name|ZeroMem
argument_list|(
name|Destination
argument_list|,
name|Length
operator|*
sizeof|sizeof
argument_list|(
operator|*
name|Destination
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|ReturnValue
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/**   Returns the length of a Null-terminated Unicode string.    This function returns the number of Unicode characters in the Null-terminated   Unicode string specified by String.    If String is NULL, then ASSERT().   If String is not aligned on a 16-bit boundary, then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and String contains more than   PcdMaximumUnicodeStringLength Unicode characters, not including the   Null-terminator, then ASSERT().    @param  String  A pointer to a Null-terminated Unicode string.    @return The length of String.  **/
end_comment

begin_function
name|UINTN
name|EFIAPI
name|StrLen
parameter_list|(
name|IN
name|CONST
name|CHAR16
modifier|*
name|String
parameter_list|)
block|{
name|UINTN
name|Length
decl_stmt|;
name|ASSERT
argument_list|(
name|String
operator|!=
name|NULL
argument_list|)
expr_stmt|;
name|ASSERT
argument_list|(
operator|(
operator|(
name|UINTN
operator|)
name|String
operator|&
name|BIT0
operator|)
operator|==
literal|0
argument_list|)
expr_stmt|;
for|for
control|(
name|Length
operator|=
literal|0
init|;
operator|*
name|String
operator|!=
literal|L'
expr|\0'
condition|;
name|String
operator|++
operator|,
name|Length
operator|++
control|)
block|{
comment|//
comment|// If PcdMaximumUnicodeStringLength is not zero,
comment|// length should not more than PcdMaximumUnicodeStringLength
comment|//
if|if
condition|(
name|PcdGet32
argument_list|(
name|PcdMaximumUnicodeStringLength
argument_list|)
operator|!=
literal|0
condition|)
block|{
name|ASSERT
argument_list|(
name|Length
operator|<
name|PcdGet32
argument_list|(
name|PcdMaximumUnicodeStringLength
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
return|return
name|Length
return|;
block|}
end_function

begin_comment
comment|/**   Returns the size of a Null-terminated Unicode string in bytes, including the   Null terminator.    This function returns the size, in bytes, of the Null-terminated Unicode string    specified by String.    If String is NULL, then ASSERT().   If String is not aligned on a 16-bit boundary, then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and String contains more than   PcdMaximumUnicodeStringLength Unicode characters, not including the   Null-terminator, then ASSERT().    @param  String  A pointer to a Null-terminated Unicode string.    @return The size of String.  **/
end_comment

begin_function
name|UINTN
name|EFIAPI
name|StrSize
parameter_list|(
name|IN
name|CONST
name|CHAR16
modifier|*
name|String
parameter_list|)
block|{
return|return
operator|(
name|StrLen
argument_list|(
name|String
argument_list|)
operator|+
literal|1
operator|)
operator|*
sizeof|sizeof
argument_list|(
operator|*
name|String
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Compares two Null-terminated Unicode strings, and returns the difference   between the first mismatched Unicode characters.    This function compares the Null-terminated Unicode string FirstString to the   Null-terminated Unicode string SecondString. If FirstString is identical to   SecondString, then 0 is returned. Otherwise, the value returned is the first   mismatched Unicode character in SecondString subtracted from the first   mismatched Unicode character in FirstString.    If FirstString is NULL, then ASSERT().   If FirstString is not aligned on a 16-bit boundary, then ASSERT().   If SecondString is NULL, then ASSERT().   If SecondString is not aligned on a 16-bit boundary, then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and FirstString contains more   than PcdMaximumUnicodeStringLength Unicode characters, not including the   Null-terminator, then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and SecondString contains more   than PcdMaximumUnicodeStringLength Unicode characters, not including the   Null-terminator, then ASSERT().    @param  FirstString   A pointer to a Null-terminated Unicode string.   @param  SecondString  A pointer to a Null-terminated Unicode string.    @retval 0      FirstString is identical to SecondString.   @return others FirstString is not identical to SecondString.  **/
end_comment

begin_function
name|INTN
name|EFIAPI
name|StrCmp
parameter_list|(
name|IN
name|CONST
name|CHAR16
modifier|*
name|FirstString
parameter_list|,
name|IN
name|CONST
name|CHAR16
modifier|*
name|SecondString
parameter_list|)
block|{
comment|//
comment|// ASSERT both strings are less long than PcdMaximumUnicodeStringLength
comment|//
name|ASSERT
argument_list|(
name|StrSize
argument_list|(
name|FirstString
argument_list|)
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|ASSERT
argument_list|(
name|StrSize
argument_list|(
name|SecondString
argument_list|)
operator|!=
literal|0
argument_list|)
expr_stmt|;
while|while
condition|(
operator|(
operator|*
name|FirstString
operator|!=
literal|L'
expr|\0'
operator|)
operator|&&
operator|(
operator|*
name|FirstString
operator|==
operator|*
name|SecondString
operator|)
condition|)
block|{
name|FirstString
operator|++
expr_stmt|;
name|SecondString
operator|++
expr_stmt|;
block|}
return|return
operator|*
name|FirstString
operator|-
operator|*
name|SecondString
return|;
block|}
end_function

begin_comment
comment|/**   Compares up to a specified length the contents of two Null-terminated Unicode strings,   and returns the difference between the first mismatched Unicode characters.      This function compares the Null-terminated Unicode string FirstString to the   Null-terminated Unicode string SecondString. At most, Length Unicode   characters will be compared. If Length is 0, then 0 is returned. If   FirstString is identical to SecondString, then 0 is returned. Otherwise, the   value returned is the first mismatched Unicode character in SecondString   subtracted from the first mismatched Unicode character in FirstString.    If Length> 0 and FirstString is NULL, then ASSERT().   If Length> 0 and FirstString is not aligned on a 16-bit boundary, then ASSERT().   If Length> 0 and SecondString is NULL, then ASSERT().   If Length> 0 and SecondString is not aligned on a 16-bit boundary, then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and Length is greater than   PcdMaximumUnicodeStringLength, then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and FirstString contains more than   PcdMaximumUnicodeStringLength Unicode characters, not including the Null-terminator,   then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and SecondString contains more than   PcdMaximumUnicodeStringLength Unicode characters, not including the Null-terminator,   then ASSERT().    @param  FirstString   A pointer to a Null-terminated Unicode string.   @param  SecondString  A pointer to a Null-terminated Unicode string.   @param  Length        The maximum number of Unicode characters to compare.    @retval 0      FirstString is identical to SecondString.   @return others FirstString is not identical to SecondString.  **/
end_comment

begin_function
name|INTN
name|EFIAPI
name|StrnCmp
parameter_list|(
name|IN
name|CONST
name|CHAR16
modifier|*
name|FirstString
parameter_list|,
name|IN
name|CONST
name|CHAR16
modifier|*
name|SecondString
parameter_list|,
name|IN
name|UINTN
name|Length
parameter_list|)
block|{
if|if
condition|(
name|Length
operator|==
literal|0
condition|)
block|{
return|return
literal|0
return|;
block|}
comment|//
comment|// ASSERT both strings are less long than PcdMaximumUnicodeStringLength.
comment|// Length tests are performed inside StrLen().
comment|//
name|ASSERT
argument_list|(
name|StrSize
argument_list|(
name|FirstString
argument_list|)
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|ASSERT
argument_list|(
name|StrSize
argument_list|(
name|SecondString
argument_list|)
operator|!=
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|PcdGet32
argument_list|(
name|PcdMaximumUnicodeStringLength
argument_list|)
operator|!=
literal|0
condition|)
block|{
name|ASSERT
argument_list|(
name|Length
operator|<=
name|PcdGet32
argument_list|(
name|PcdMaximumUnicodeStringLength
argument_list|)
argument_list|)
expr_stmt|;
block|}
while|while
condition|(
operator|(
operator|*
name|FirstString
operator|!=
literal|L'
expr|\0'
operator|)
operator|&&
operator|(
operator|*
name|SecondString
operator|!=
literal|L'
expr|\0'
operator|)
operator|&&
operator|(
operator|*
name|FirstString
operator|==
operator|*
name|SecondString
operator|)
operator|&&
operator|(
name|Length
operator|>
literal|1
operator|)
condition|)
block|{
name|FirstString
operator|++
expr_stmt|;
name|SecondString
operator|++
expr_stmt|;
name|Length
operator|--
expr_stmt|;
block|}
return|return
operator|*
name|FirstString
operator|-
operator|*
name|SecondString
return|;
block|}
end_function

begin_ifndef
ifndef|#
directive|ifndef
name|DISABLE_NEW_DEPRECATED_INTERFACES
end_ifndef

begin_comment
comment|/**   [ATTENTION] This function will be deprecated for security reason.    Concatenates one Null-terminated Unicode string to another Null-terminated   Unicode string, and returns the concatenated Unicode string.    This function concatenates two Null-terminated Unicode strings. The contents   of Null-terminated Unicode string Source are concatenated to the end of   Null-terminated Unicode string Destination. The Null-terminated concatenated   Unicode String is returned. If Source and Destination overlap, then the   results are undefined.    If Destination is NULL, then ASSERT().   If Destination is not aligned on a 16-bit boundary, then ASSERT().   If Source is NULL, then ASSERT().   If Source is not aligned on a 16-bit boundary, then ASSERT().   If Source and Destination overlap, then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and Destination contains more   than PcdMaximumUnicodeStringLength Unicode characters, not including the   Null-terminator, then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and Source contains more than   PcdMaximumUnicodeStringLength Unicode characters, not including the   Null-terminator, then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and concatenating Destination   and Source results in a Unicode string with more than   PcdMaximumUnicodeStringLength Unicode characters, not including the   Null-terminator, then ASSERT().    @param  Destination A pointer to a Null-terminated Unicode string.   @param  Source      A pointer to a Null-terminated Unicode string.    @return Destination.  **/
end_comment

begin_function
name|CHAR16
modifier|*
name|EFIAPI
name|StrCat
parameter_list|(
name|IN
name|OUT
name|CHAR16
modifier|*
name|Destination
parameter_list|,
name|IN
name|CONST
name|CHAR16
modifier|*
name|Source
parameter_list|)
block|{
name|StrCpy
argument_list|(
name|Destination
operator|+
name|StrLen
argument_list|(
name|Destination
argument_list|)
argument_list|,
name|Source
argument_list|)
expr_stmt|;
comment|//
comment|// Size of the resulting string should never be zero.
comment|// PcdMaximumUnicodeStringLength is tested inside StrLen().
comment|//
name|ASSERT
argument_list|(
name|StrSize
argument_list|(
name|Destination
argument_list|)
operator|!=
literal|0
argument_list|)
expr_stmt|;
return|return
name|Destination
return|;
block|}
end_function

begin_comment
comment|/**   [ATTENTION] This function will be deprecated for security reason.    Concatenates up to a specified length one Null-terminated Unicode to the end    of another Null-terminated Unicode string, and returns the concatenated    Unicode string.    This function concatenates two Null-terminated Unicode strings. The contents   of Null-terminated Unicode string Source are concatenated to the end of   Null-terminated Unicode string Destination, and Destination is returned. At   most, Length Unicode characters are concatenated from Source to the end of   Destination, and Destination is always Null-terminated. If Length is 0, then   Destination is returned unmodified. If Source and Destination overlap, then   the results are undefined.    If Destination is NULL, then ASSERT().   If Length> 0 and Destination is not aligned on a 16-bit boundary, then ASSERT().   If Length> 0 and Source is NULL, then ASSERT().   If Length> 0 and Source is not aligned on a 16-bit boundary, then ASSERT().   If Source and Destination overlap, then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and Length is greater than    PcdMaximumUnicodeStringLength, then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and Destination contains more   than PcdMaximumUnicodeStringLength Unicode characters, not including the   Null-terminator, then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and Source contains more than   PcdMaximumUnicodeStringLength Unicode characters, not including the   Null-terminator, then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and concatenating Destination   and Source results in a Unicode string with more than PcdMaximumUnicodeStringLength   Unicode characters, not including the Null-terminator, then ASSERT().    @param  Destination A pointer to a Null-terminated Unicode string.   @param  Source      A pointer to a Null-terminated Unicode string.   @param  Length      The maximum number of Unicode characters to concatenate from                       Source.    @return Destination.  **/
end_comment

begin_function
name|CHAR16
modifier|*
name|EFIAPI
name|StrnCat
parameter_list|(
name|IN
name|OUT
name|CHAR16
modifier|*
name|Destination
parameter_list|,
name|IN
name|CONST
name|CHAR16
modifier|*
name|Source
parameter_list|,
name|IN
name|UINTN
name|Length
parameter_list|)
block|{
name|UINTN
name|DestinationLen
decl_stmt|;
name|DestinationLen
operator|=
name|StrLen
argument_list|(
name|Destination
argument_list|)
expr_stmt|;
name|StrnCpy
argument_list|(
name|Destination
operator|+
name|DestinationLen
argument_list|,
name|Source
argument_list|,
name|Length
argument_list|)
expr_stmt|;
name|Destination
index|[
name|DestinationLen
operator|+
name|Length
index|]
operator|=
literal|L'
expr|\0'
expr_stmt|;
comment|//
comment|// Size of the resulting string should never be zero.
comment|// PcdMaximumUnicodeStringLength is tested inside StrLen().
comment|//
name|ASSERT
argument_list|(
name|StrSize
argument_list|(
name|Destination
argument_list|)
operator|!=
literal|0
argument_list|)
expr_stmt|;
return|return
name|Destination
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/**   Returns the first occurrence of a Null-terminated Unicode sub-string   in a Null-terminated Unicode string.    This function scans the contents of the Null-terminated Unicode string   specified by String and returns the first occurrence of SearchString.   If SearchString is not found in String, then NULL is returned.  If   the length of SearchString is zero, then String is   returned.    If String is NULL, then ASSERT().   If String is not aligned on a 16-bit boundary, then ASSERT().   If SearchString is NULL, then ASSERT().   If SearchString is not aligned on a 16-bit boundary, then ASSERT().    If PcdMaximumUnicodeStringLength is not zero, and SearchString   or String contains more than PcdMaximumUnicodeStringLength Unicode   characters, not including the Null-terminator, then ASSERT().    @param  String          A pointer to a Null-terminated Unicode string.   @param  SearchString    A pointer to a Null-terminated Unicode string to search for.    @retval NULL            If the SearchString does not appear in String.   @return others          If there is a match.  **/
end_comment

begin_function
name|CHAR16
modifier|*
name|EFIAPI
name|StrStr
parameter_list|(
name|IN
name|CONST
name|CHAR16
modifier|*
name|String
parameter_list|,
name|IN
name|CONST
name|CHAR16
modifier|*
name|SearchString
parameter_list|)
block|{
name|CONST
name|CHAR16
modifier|*
name|FirstMatch
decl_stmt|;
name|CONST
name|CHAR16
modifier|*
name|SearchStringTmp
decl_stmt|;
comment|//
comment|// ASSERT both strings are less long than PcdMaximumUnicodeStringLength.
comment|// Length tests are performed inside StrLen().
comment|//
name|ASSERT
argument_list|(
name|StrSize
argument_list|(
name|String
argument_list|)
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|ASSERT
argument_list|(
name|StrSize
argument_list|(
name|SearchString
argument_list|)
operator|!=
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
name|SearchString
operator|==
literal|L'
expr|\0'
condition|)
block|{
return|return
operator|(
name|CHAR16
operator|*
operator|)
name|String
return|;
block|}
while|while
condition|(
operator|*
name|String
operator|!=
literal|L'
expr|\0'
condition|)
block|{
name|SearchStringTmp
operator|=
name|SearchString
expr_stmt|;
name|FirstMatch
operator|=
name|String
expr_stmt|;
while|while
condition|(
operator|(
operator|*
name|String
operator|==
operator|*
name|SearchStringTmp
operator|)
operator|&&
operator|(
operator|*
name|String
operator|!=
literal|L'
expr|\0'
operator|)
condition|)
block|{
name|String
operator|++
expr_stmt|;
name|SearchStringTmp
operator|++
expr_stmt|;
block|}
if|if
condition|(
operator|*
name|SearchStringTmp
operator|==
literal|L'
expr|\0'
condition|)
block|{
return|return
operator|(
name|CHAR16
operator|*
operator|)
name|FirstMatch
return|;
block|}
if|if
condition|(
operator|*
name|String
operator|==
literal|L'
expr|\0'
condition|)
block|{
return|return
name|NULL
return|;
block|}
name|String
operator|=
name|FirstMatch
operator|+
literal|1
expr_stmt|;
block|}
return|return
name|NULL
return|;
block|}
end_function

begin_comment
comment|/**   Check if a Unicode character is a decimal character.    This internal function checks if a Unicode character is a    decimal character. The valid decimal character is from   L'0' to L'9'.    @param  Char  The character to check against.    @retval TRUE  If the Char is a decmial character.   @retval FALSE If the Char is not a decmial character.  **/
end_comment

begin_function
name|BOOLEAN
name|EFIAPI
name|InternalIsDecimalDigitCharacter
parameter_list|(
name|IN
name|CHAR16
name|Char
parameter_list|)
block|{
return|return
call|(
name|BOOLEAN
call|)
argument_list|(
name|Char
operator|>=
literal|L'
expr|0'
operator|&&
name|Char
operator|<=
literal|L'
expr|9'
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Convert a Unicode character to upper case only if    it maps to a valid small-case ASCII character.    This internal function only deal with Unicode character   which maps to a valid small-case ASCII character, i.e.   L'a' to L'z'. For other Unicode character, the input character   is returned directly.    @param  Char  The character to convert.    @retval LowerCharacter   If the Char is with range L'a' to L'z'.   @retval Unchanged        Otherwise.  **/
end_comment

begin_function
name|CHAR16
name|EFIAPI
name|InternalCharToUpper
parameter_list|(
name|IN
name|CHAR16
name|Char
parameter_list|)
block|{
if|if
condition|(
name|Char
operator|>=
literal|L'
expr|a'
operator|&&
name|Char
operator|<=
literal|L'
expr|z'
condition|)
block|{
return|return
call|(
name|CHAR16
call|)
argument_list|(
name|Char
operator|-
operator|(
literal|L'
expr|a'
operator|-
literal|L'
expr|A'
operator|)
argument_list|)
return|;
block|}
return|return
name|Char
return|;
block|}
end_function

begin_comment
comment|/**   Convert a Unicode character to numerical value.    This internal function only deal with Unicode character   which maps to a valid hexadecimal ASII character, i.e.   L'0' to L'9', L'a' to L'f' or L'A' to L'F'. For other    Unicode character, the value returned does not make sense.    @param  Char  The character to convert.    @return The numerical value converted.  **/
end_comment

begin_function
name|UINTN
name|EFIAPI
name|InternalHexCharToUintn
parameter_list|(
name|IN
name|CHAR16
name|Char
parameter_list|)
block|{
if|if
condition|(
name|InternalIsDecimalDigitCharacter
argument_list|(
name|Char
argument_list|)
condition|)
block|{
return|return
name|Char
operator|-
literal|L'
expr|0'
return|;
block|}
return|return
operator|(
literal|10
operator|+
name|InternalCharToUpper
argument_list|(
name|Char
argument_list|)
operator|-
literal|L'
expr|A'
operator|)
return|;
block|}
end_function

begin_comment
comment|/**   Check if a Unicode character is a hexadecimal character.    This internal function checks if a Unicode character is a    decimal character.  The valid hexadecimal character is    L'0' to L'9', L'a' to L'f', or L'A' to L'F'.     @param  Char  The character to check against.    @retval TRUE  If the Char is a hexadecmial character.   @retval FALSE If the Char is not a hexadecmial character.  **/
end_comment

begin_function
name|BOOLEAN
name|EFIAPI
name|InternalIsHexaDecimalDigitCharacter
parameter_list|(
name|IN
name|CHAR16
name|Char
parameter_list|)
block|{
return|return
call|(
name|BOOLEAN
call|)
argument_list|(
name|InternalIsDecimalDigitCharacter
argument_list|(
name|Char
argument_list|)
operator|||
operator|(
name|Char
operator|>=
literal|L'
expr|A'
operator|&&
name|Char
operator|<=
literal|L'
expr|F'
operator|)
operator|||
operator|(
name|Char
operator|>=
literal|L'
expr|a'
operator|&&
name|Char
operator|<=
literal|L'
expr|f'
operator|)
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Convert a Null-terminated Unicode decimal string to a value of   type UINTN.    This function returns a value of type UINTN by interpreting the contents   of the Unicode string specified by String as a decimal number. The format   of the input Unicode string String is:                    [spaces] [decimal digits].    The valid decimal digit character is in the range [0-9]. The   function will ignore the pad space, which includes spaces or   tab characters, before [decimal digits]. The running zero in the   beginning of [decimal digits] will be ignored. Then, the function   stops at the first character that is a not a valid decimal character   or a Null-terminator, whichever one comes first.    If String is NULL, then ASSERT().   If String is not aligned in a 16-bit boundary, then ASSERT().   If String has only pad spaces, then 0 is returned.   If String has no pad spaces or valid decimal digits,   then 0 is returned.   If the number represented by String overflows according   to the range defined by UINTN, then MAX_UINTN is returned.    If PcdMaximumUnicodeStringLength is not zero, and String contains   more than PcdMaximumUnicodeStringLength Unicode characters, not including   the Null-terminator, then ASSERT().    @param  String      A pointer to a Null-terminated Unicode string.    @retval Value translated from String.  **/
end_comment

begin_function
name|UINTN
name|EFIAPI
name|StrDecimalToUintn
parameter_list|(
name|IN
name|CONST
name|CHAR16
modifier|*
name|String
parameter_list|)
block|{
name|UINTN
name|Result
decl_stmt|;
name|StrDecimalToUintnS
argument_list|(
name|String
argument_list|,
operator|(
name|CHAR16
operator|*
operator|*
operator|)
name|NULL
argument_list|,
operator|&
name|Result
argument_list|)
expr_stmt|;
return|return
name|Result
return|;
block|}
end_function

begin_comment
comment|/**   Convert a Null-terminated Unicode decimal string to a value of   type UINT64.    This function returns a value of type UINT64 by interpreting the contents   of the Unicode string specified by String as a decimal number. The format   of the input Unicode string String is:                    [spaces] [decimal digits].    The valid decimal digit character is in the range [0-9]. The   function will ignore the pad space, which includes spaces or   tab characters, before [decimal digits]. The running zero in the   beginning of [decimal digits] will be ignored. Then, the function   stops at the first character that is a not a valid decimal character   or a Null-terminator, whichever one comes first.    If String is NULL, then ASSERT().   If String is not aligned in a 16-bit boundary, then ASSERT().   If String has only pad spaces, then 0 is returned.   If String has no pad spaces or valid decimal digits,   then 0 is returned.   If the number represented by String overflows according   to the range defined by UINT64, then MAX_UINT64 is returned.    If PcdMaximumUnicodeStringLength is not zero, and String contains   more than PcdMaximumUnicodeStringLength Unicode characters, not including   the Null-terminator, then ASSERT().    @param  String          A pointer to a Null-terminated Unicode string.    @retval Value translated from String.  **/
end_comment

begin_function
name|UINT64
name|EFIAPI
name|StrDecimalToUint64
parameter_list|(
name|IN
name|CONST
name|CHAR16
modifier|*
name|String
parameter_list|)
block|{
name|UINT64
name|Result
decl_stmt|;
name|StrDecimalToUint64S
argument_list|(
name|String
argument_list|,
operator|(
name|CHAR16
operator|*
operator|*
operator|)
name|NULL
argument_list|,
operator|&
name|Result
argument_list|)
expr_stmt|;
return|return
name|Result
return|;
block|}
end_function

begin_comment
comment|/**   Convert a Null-terminated Unicode hexadecimal string to a value of type UINTN.    This function returns a value of type UINTN by interpreting the contents   of the Unicode string specified by String as a hexadecimal number.   The format of the input Unicode string String is:                    [spaces][zeros][x][hexadecimal digits].    The valid hexadecimal digit character is in the range [0-9], [a-f] and [A-F].   The prefix "0x" is optional. Both "x" and "X" is allowed in "0x" prefix.   If "x" appears in the input string, it must be prefixed with at least one 0.   The function will ignore the pad space, which includes spaces or tab characters,   before [zeros], [x] or [hexadecimal digit]. The running zero before [x] or   [hexadecimal digit] will be ignored. Then, the decoding starts after [x] or the   first valid hexadecimal digit. Then, the function stops at the first character that is   a not a valid hexadecimal character or NULL, whichever one comes first.    If String is NULL, then ASSERT().   If String is not aligned in a 16-bit boundary, then ASSERT().   If String has only pad spaces, then zero is returned.   If String has no leading pad spaces, leading zeros or valid hexadecimal digits,   then zero is returned.   If the number represented by String overflows according to the range defined by   UINTN, then MAX_UINTN is returned.    If PcdMaximumUnicodeStringLength is not zero, and String contains more than   PcdMaximumUnicodeStringLength Unicode characters, not including the Null-terminator,   then ASSERT().    @param  String          A pointer to a Null-terminated Unicode string.    @retval Value translated from String.  **/
end_comment

begin_function
name|UINTN
name|EFIAPI
name|StrHexToUintn
parameter_list|(
name|IN
name|CONST
name|CHAR16
modifier|*
name|String
parameter_list|)
block|{
name|UINTN
name|Result
decl_stmt|;
name|StrHexToUintnS
argument_list|(
name|String
argument_list|,
operator|(
name|CHAR16
operator|*
operator|*
operator|)
name|NULL
argument_list|,
operator|&
name|Result
argument_list|)
expr_stmt|;
return|return
name|Result
return|;
block|}
end_function

begin_comment
comment|/**   Convert a Null-terminated Unicode hexadecimal string to a value of type UINT64.    This function returns a value of type UINT64 by interpreting the contents   of the Unicode string specified by String as a hexadecimal number.   The format of the input Unicode string String is                    [spaces][zeros][x][hexadecimal digits].    The valid hexadecimal digit character is in the range [0-9], [a-f] and [A-F].   The prefix "0x" is optional. Both "x" and "X" is allowed in "0x" prefix.   If "x" appears in the input string, it must be prefixed with at least one 0.   The function will ignore the pad space, which includes spaces or tab characters,   before [zeros], [x] or [hexadecimal digit]. The running zero before [x] or   [hexadecimal digit] will be ignored. Then, the decoding starts after [x] or the   first valid hexadecimal digit. Then, the function stops at the first character that is   a not a valid hexadecimal character or NULL, whichever one comes first.    If String is NULL, then ASSERT().   If String is not aligned in a 16-bit boundary, then ASSERT().   If String has only pad spaces, then zero is returned.   If String has no leading pad spaces, leading zeros or valid hexadecimal digits,   then zero is returned.   If the number represented by String overflows according to the range defined by   UINT64, then MAX_UINT64 is returned.    If PcdMaximumUnicodeStringLength is not zero, and String contains more than   PcdMaximumUnicodeStringLength Unicode characters, not including the Null-terminator,   then ASSERT().    @param  String          A pointer to a Null-terminated Unicode string.    @retval Value translated from String.  **/
end_comment

begin_function
name|UINT64
name|EFIAPI
name|StrHexToUint64
parameter_list|(
name|IN
name|CONST
name|CHAR16
modifier|*
name|String
parameter_list|)
block|{
name|UINT64
name|Result
decl_stmt|;
name|StrHexToUint64S
argument_list|(
name|String
argument_list|,
operator|(
name|CHAR16
operator|*
operator|*
operator|)
name|NULL
argument_list|,
operator|&
name|Result
argument_list|)
expr_stmt|;
return|return
name|Result
return|;
block|}
end_function

begin_comment
comment|/**   Check if a ASCII character is a decimal character.    This internal function checks if a Unicode character is a    decimal character. The valid decimal character is from   '0' to '9'.    @param  Char  The character to check against.    @retval TRUE  If the Char is a decmial character.   @retval FALSE If the Char is not a decmial character.  **/
end_comment

begin_function
name|BOOLEAN
name|EFIAPI
name|InternalAsciiIsDecimalDigitCharacter
parameter_list|(
name|IN
name|CHAR8
name|Char
parameter_list|)
block|{
return|return
call|(
name|BOOLEAN
call|)
argument_list|(
name|Char
operator|>=
literal|'0'
operator|&&
name|Char
operator|<=
literal|'9'
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Check if a ASCII character is a hexadecimal character.    This internal function checks if a ASCII character is a    decimal character.  The valid hexadecimal character is    L'0' to L'9', L'a' to L'f', or L'A' to L'F'.     @param  Char  The character to check against.    @retval TRUE  If the Char is a hexadecmial character.   @retval FALSE If the Char is not a hexadecmial character.  **/
end_comment

begin_function
name|BOOLEAN
name|EFIAPI
name|InternalAsciiIsHexaDecimalDigitCharacter
parameter_list|(
name|IN
name|CHAR8
name|Char
parameter_list|)
block|{
return|return
call|(
name|BOOLEAN
call|)
argument_list|(
name|InternalAsciiIsDecimalDigitCharacter
argument_list|(
name|Char
argument_list|)
operator|||
operator|(
name|Char
operator|>=
literal|'A'
operator|&&
name|Char
operator|<=
literal|'F'
operator|)
operator|||
operator|(
name|Char
operator|>=
literal|'a'
operator|&&
name|Char
operator|<=
literal|'f'
operator|)
argument_list|)
return|;
block|}
end_function

begin_ifndef
ifndef|#
directive|ifndef
name|DISABLE_NEW_DEPRECATED_INTERFACES
end_ifndef

begin_comment
comment|/**   [ATTENTION] This function is deprecated for security reason.    Convert a Null-terminated Unicode string to a Null-terminated   ASCII string and returns the ASCII string.    This function converts the content of the Unicode string Source   to the ASCII string Destination by copying the lower 8 bits of   each Unicode character. It returns Destination.    The caller is responsible to make sure Destination points to a buffer with size   equal or greater than ((StrLen (Source) + 1) * sizeof (CHAR8)) in bytes.    If any Unicode characters in Source contain non-zero value in   the upper 8 bits, then ASSERT().    If Destination is NULL, then ASSERT().   If Source is NULL, then ASSERT().   If Source is not aligned on a 16-bit boundary, then ASSERT().   If Source and Destination overlap, then ASSERT().    If PcdMaximumUnicodeStringLength is not zero, and Source contains   more than PcdMaximumUnicodeStringLength Unicode characters, not including   the Null-terminator, then ASSERT().    If PcdMaximumAsciiStringLength is not zero, and Source contains more   than PcdMaximumAsciiStringLength Unicode characters, not including the   Null-terminator, then ASSERT().    @param  Source        A pointer to a Null-terminated Unicode string.   @param  Destination   A pointer to a Null-terminated ASCII string.    @return Destination.  **/
end_comment

begin_function
name|CHAR8
modifier|*
name|EFIAPI
name|UnicodeStrToAsciiStr
parameter_list|(
name|IN
name|CONST
name|CHAR16
modifier|*
name|Source
parameter_list|,
name|OUT
name|CHAR8
modifier|*
name|Destination
parameter_list|)
block|{
name|CHAR8
modifier|*
name|ReturnValue
decl_stmt|;
name|ASSERT
argument_list|(
name|Destination
operator|!=
name|NULL
argument_list|)
expr_stmt|;
comment|//
comment|// ASSERT if Source is long than PcdMaximumUnicodeStringLength.
comment|// Length tests are performed inside StrLen().
comment|//
name|ASSERT
argument_list|(
name|StrSize
argument_list|(
name|Source
argument_list|)
operator|!=
literal|0
argument_list|)
expr_stmt|;
comment|//
comment|// Source and Destination should not overlap
comment|//
name|ASSERT
argument_list|(
call|(
name|UINTN
call|)
argument_list|(
name|Destination
operator|-
operator|(
name|CHAR8
operator|*
operator|)
name|Source
argument_list|)
operator|>=
name|StrSize
argument_list|(
name|Source
argument_list|)
argument_list|)
expr_stmt|;
name|ASSERT
argument_list|(
call|(
name|UINTN
call|)
argument_list|(
operator|(
name|CHAR8
operator|*
operator|)
name|Source
operator|-
name|Destination
argument_list|)
operator|>
name|StrLen
argument_list|(
name|Source
argument_list|)
argument_list|)
expr_stmt|;
name|ReturnValue
operator|=
name|Destination
expr_stmt|;
while|while
condition|(
operator|*
name|Source
operator|!=
literal|'\0'
condition|)
block|{
comment|//
comment|// If any Unicode characters in Source contain
comment|// non-zero value in the upper 8 bits, then ASSERT().
comment|//
name|ASSERT
argument_list|(
operator|*
name|Source
operator|<
literal|0x100
argument_list|)
expr_stmt|;
operator|*
operator|(
name|Destination
operator|++
operator|)
operator|=
operator|(
name|CHAR8
operator|)
operator|*
operator|(
name|Source
operator|++
operator|)
expr_stmt|;
block|}
operator|*
name|Destination
operator|=
literal|'\0'
expr_stmt|;
comment|//
comment|// ASSERT Original Destination is less long than PcdMaximumAsciiStringLength.
comment|// Length tests are performed inside AsciiStrLen().
comment|//
name|ASSERT
argument_list|(
name|AsciiStrSize
argument_list|(
name|ReturnValue
argument_list|)
operator|!=
literal|0
argument_list|)
expr_stmt|;
return|return
name|ReturnValue
return|;
block|}
end_function

begin_comment
comment|/**   [ATTENTION] This function will be deprecated for security reason.    Copies one Null-terminated ASCII string to another Null-terminated ASCII   string and returns the new ASCII string.    This function copies the contents of the ASCII string Source to the ASCII   string Destination, and returns Destination. If Source and Destination   overlap, then the results are undefined.    If Destination is NULL, then ASSERT().   If Source is NULL, then ASSERT().   If Source and Destination overlap, then ASSERT().   If PcdMaximumAsciiStringLength is not zero and Source contains more than   PcdMaximumAsciiStringLength ASCII characters, not including the Null-terminator,   then ASSERT().    @param  Destination A pointer to a Null-terminated ASCII string.   @param  Source      A pointer to a Null-terminated ASCII string.    @return Destination  **/
end_comment

begin_function
name|CHAR8
modifier|*
name|EFIAPI
name|AsciiStrCpy
parameter_list|(
name|OUT
name|CHAR8
modifier|*
name|Destination
parameter_list|,
name|IN
name|CONST
name|CHAR8
modifier|*
name|Source
parameter_list|)
block|{
name|CHAR8
modifier|*
name|ReturnValue
decl_stmt|;
comment|//
comment|// Destination cannot be NULL
comment|//
name|ASSERT
argument_list|(
name|Destination
operator|!=
name|NULL
argument_list|)
expr_stmt|;
comment|//
comment|// Destination and source cannot overlap
comment|//
name|ASSERT
argument_list|(
call|(
name|UINTN
call|)
argument_list|(
name|Destination
operator|-
name|Source
argument_list|)
operator|>
name|AsciiStrLen
argument_list|(
name|Source
argument_list|)
argument_list|)
expr_stmt|;
name|ASSERT
argument_list|(
call|(
name|UINTN
call|)
argument_list|(
name|Source
operator|-
name|Destination
argument_list|)
operator|>
name|AsciiStrLen
argument_list|(
name|Source
argument_list|)
argument_list|)
expr_stmt|;
name|ReturnValue
operator|=
name|Destination
expr_stmt|;
while|while
condition|(
operator|*
name|Source
operator|!=
literal|0
condition|)
block|{
operator|*
operator|(
name|Destination
operator|++
operator|)
operator|=
operator|*
operator|(
name|Source
operator|++
operator|)
expr_stmt|;
block|}
operator|*
name|Destination
operator|=
literal|0
expr_stmt|;
return|return
name|ReturnValue
return|;
block|}
end_function

begin_comment
comment|/**   [ATTENTION] This function will be deprecated for security reason.    Copies up to a specified length one Null-terminated ASCII string to another    Null-terminated ASCII string and returns the new ASCII string.    This function copies the contents of the ASCII string Source to the ASCII   string Destination, and returns Destination. At most, Length ASCII characters   are copied from Source to Destination. If Length is 0, then Destination is   returned unmodified. If Length is greater that the number of ASCII characters   in Source, then Destination is padded with Null ASCII characters. If Source   and Destination overlap, then the results are undefined.    If Destination is NULL, then ASSERT().   If Source is NULL, then ASSERT().   If Source and Destination overlap, then ASSERT().   If PcdMaximumAsciiStringLength is not zero, and Length is greater than    PcdMaximumAsciiStringLength, then ASSERT().   If PcdMaximumAsciiStringLength is not zero, and Source contains more than   PcdMaximumAsciiStringLength ASCII characters, not including the Null-terminator,   then ASSERT().    @param  Destination A pointer to a Null-terminated ASCII string.   @param  Source      A pointer to a Null-terminated ASCII string.   @param  Length      The maximum number of ASCII characters to copy.    @return Destination  **/
end_comment

begin_function
name|CHAR8
modifier|*
name|EFIAPI
name|AsciiStrnCpy
parameter_list|(
name|OUT
name|CHAR8
modifier|*
name|Destination
parameter_list|,
name|IN
name|CONST
name|CHAR8
modifier|*
name|Source
parameter_list|,
name|IN
name|UINTN
name|Length
parameter_list|)
block|{
name|CHAR8
modifier|*
name|ReturnValue
decl_stmt|;
if|if
condition|(
name|Length
operator|==
literal|0
condition|)
block|{
return|return
name|Destination
return|;
block|}
comment|//
comment|// Destination cannot be NULL
comment|//
name|ASSERT
argument_list|(
name|Destination
operator|!=
name|NULL
argument_list|)
expr_stmt|;
comment|//
comment|// Destination and source cannot overlap
comment|//
name|ASSERT
argument_list|(
call|(
name|UINTN
call|)
argument_list|(
name|Destination
operator|-
name|Source
argument_list|)
operator|>
name|AsciiStrLen
argument_list|(
name|Source
argument_list|)
argument_list|)
expr_stmt|;
name|ASSERT
argument_list|(
call|(
name|UINTN
call|)
argument_list|(
name|Source
operator|-
name|Destination
argument_list|)
operator|>=
name|Length
argument_list|)
expr_stmt|;
if|if
condition|(
name|PcdGet32
argument_list|(
name|PcdMaximumAsciiStringLength
argument_list|)
operator|!=
literal|0
condition|)
block|{
name|ASSERT
argument_list|(
name|Length
operator|<=
name|PcdGet32
argument_list|(
name|PcdMaximumAsciiStringLength
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|ReturnValue
operator|=
name|Destination
expr_stmt|;
while|while
condition|(
operator|*
name|Source
operator|!=
literal|0
operator|&&
name|Length
operator|>
literal|0
condition|)
block|{
operator|*
operator|(
name|Destination
operator|++
operator|)
operator|=
operator|*
operator|(
name|Source
operator|++
operator|)
expr_stmt|;
name|Length
operator|--
expr_stmt|;
block|}
name|ZeroMem
argument_list|(
name|Destination
argument_list|,
name|Length
operator|*
sizeof|sizeof
argument_list|(
operator|*
name|Destination
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|ReturnValue
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/**   Returns the length of a Null-terminated ASCII string.    This function returns the number of ASCII characters in the Null-terminated   ASCII string specified by String.    If Length> 0 and Destination is NULL, then ASSERT().   If Length> 0 and Source is NULL, then ASSERT().   If PcdMaximumAsciiStringLength is not zero and String contains more than   PcdMaximumAsciiStringLength ASCII characters, not including the Null-terminator,   then ASSERT().    @param  String  A pointer to a Null-terminated ASCII string.    @return The length of String.  **/
end_comment

begin_function
name|UINTN
name|EFIAPI
name|AsciiStrLen
parameter_list|(
name|IN
name|CONST
name|CHAR8
modifier|*
name|String
parameter_list|)
block|{
name|UINTN
name|Length
decl_stmt|;
name|ASSERT
argument_list|(
name|String
operator|!=
name|NULL
argument_list|)
expr_stmt|;
for|for
control|(
name|Length
operator|=
literal|0
init|;
operator|*
name|String
operator|!=
literal|'\0'
condition|;
name|String
operator|++
operator|,
name|Length
operator|++
control|)
block|{
comment|//
comment|// If PcdMaximumUnicodeStringLength is not zero,
comment|// length should not more than PcdMaximumUnicodeStringLength
comment|//
if|if
condition|(
name|PcdGet32
argument_list|(
name|PcdMaximumAsciiStringLength
argument_list|)
operator|!=
literal|0
condition|)
block|{
name|ASSERT
argument_list|(
name|Length
operator|<
name|PcdGet32
argument_list|(
name|PcdMaximumAsciiStringLength
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
return|return
name|Length
return|;
block|}
end_function

begin_comment
comment|/**   Returns the size of a Null-terminated ASCII string in bytes, including the   Null terminator.    This function returns the size, in bytes, of the Null-terminated ASCII string   specified by String.    If String is NULL, then ASSERT().   If PcdMaximumAsciiStringLength is not zero and String contains more than   PcdMaximumAsciiStringLength ASCII characters, not including the Null-terminator,   then ASSERT().    @param  String  A pointer to a Null-terminated ASCII string.    @return The size of String.  **/
end_comment

begin_function
name|UINTN
name|EFIAPI
name|AsciiStrSize
parameter_list|(
name|IN
name|CONST
name|CHAR8
modifier|*
name|String
parameter_list|)
block|{
return|return
operator|(
name|AsciiStrLen
argument_list|(
name|String
argument_list|)
operator|+
literal|1
operator|)
operator|*
sizeof|sizeof
argument_list|(
operator|*
name|String
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Compares two Null-terminated ASCII strings, and returns the difference   between the first mismatched ASCII characters.    This function compares the Null-terminated ASCII string FirstString to the   Null-terminated ASCII string SecondString. If FirstString is identical to   SecondString, then 0 is returned. Otherwise, the value returned is the first   mismatched ASCII character in SecondString subtracted from the first   mismatched ASCII character in FirstString.    If FirstString is NULL, then ASSERT().   If SecondString is NULL, then ASSERT().   If PcdMaximumAsciiStringLength is not zero and FirstString contains more than   PcdMaximumAsciiStringLength ASCII characters, not including the Null-terminator,   then ASSERT().   If PcdMaximumAsciiStringLength is not zero and SecondString contains more   than PcdMaximumAsciiStringLength ASCII characters, not including the   Null-terminator, then ASSERT().    @param  FirstString   A pointer to a Null-terminated ASCII string.   @param  SecondString  A pointer to a Null-terminated ASCII string.    @retval ==0      FirstString is identical to SecondString.   @retval !=0      FirstString is not identical to SecondString.  **/
end_comment

begin_function
name|INTN
name|EFIAPI
name|AsciiStrCmp
parameter_list|(
name|IN
name|CONST
name|CHAR8
modifier|*
name|FirstString
parameter_list|,
name|IN
name|CONST
name|CHAR8
modifier|*
name|SecondString
parameter_list|)
block|{
comment|//
comment|// ASSERT both strings are less long than PcdMaximumAsciiStringLength
comment|//
name|ASSERT
argument_list|(
name|AsciiStrSize
argument_list|(
name|FirstString
argument_list|)
argument_list|)
expr_stmt|;
name|ASSERT
argument_list|(
name|AsciiStrSize
argument_list|(
name|SecondString
argument_list|)
argument_list|)
expr_stmt|;
while|while
condition|(
operator|(
operator|*
name|FirstString
operator|!=
literal|'\0'
operator|)
operator|&&
operator|(
operator|*
name|FirstString
operator|==
operator|*
name|SecondString
operator|)
condition|)
block|{
name|FirstString
operator|++
expr_stmt|;
name|SecondString
operator|++
expr_stmt|;
block|}
return|return
operator|*
name|FirstString
operator|-
operator|*
name|SecondString
return|;
block|}
end_function

begin_comment
comment|/**   Converts a lowercase Ascii character to upper one.    If Chr is lowercase Ascii character, then converts it to upper one.    If Value>= 0xA0, then ASSERT().   If (Value& 0x0F)>= 0x0A, then ASSERT().    @param  Chr   one Ascii character    @return The uppercase value of Ascii character   **/
end_comment

begin_function
name|CHAR8
name|EFIAPI
name|InternalBaseLibAsciiToUpper
parameter_list|(
name|IN
name|CHAR8
name|Chr
parameter_list|)
block|{
return|return
call|(
name|UINT8
call|)
argument_list|(
operator|(
name|Chr
operator|>=
literal|'a'
operator|&&
name|Chr
operator|<=
literal|'z'
operator|)
condition|?
name|Chr
operator|-
operator|(
literal|'a'
operator|-
literal|'A'
operator|)
else|:
name|Chr
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Convert a ASCII character to numerical value.    This internal function only deal with Unicode character   which maps to a valid hexadecimal ASII character, i.e.   '0' to '9', 'a' to 'f' or 'A' to 'F'. For other    ASCII character, the value returned does not make sense.    @param  Char  The character to convert.    @return The numerical value converted.  **/
end_comment

begin_function
name|UINTN
name|EFIAPI
name|InternalAsciiHexCharToUintn
parameter_list|(
name|IN
name|CHAR8
name|Char
parameter_list|)
block|{
if|if
condition|(
name|InternalIsDecimalDigitCharacter
argument_list|(
name|Char
argument_list|)
condition|)
block|{
return|return
name|Char
operator|-
literal|'0'
return|;
block|}
return|return
operator|(
literal|10
operator|+
name|InternalBaseLibAsciiToUpper
argument_list|(
name|Char
argument_list|)
operator|-
literal|'A'
operator|)
return|;
block|}
end_function

begin_comment
comment|/**   Performs a case insensitive comparison of two Null-terminated ASCII strings,   and returns the difference between the first mismatched ASCII characters.    This function performs a case insensitive comparison of the Null-terminated   ASCII string FirstString to the Null-terminated ASCII string SecondString. If   FirstString is identical to SecondString, then 0 is returned. Otherwise, the   value returned is the first mismatched lower case ASCII character in   SecondString subtracted from the first mismatched lower case ASCII character   in FirstString.    If FirstString is NULL, then ASSERT().   If SecondString is NULL, then ASSERT().   If PcdMaximumAsciiStringLength is not zero and FirstString contains more than   PcdMaximumAsciiStringLength ASCII characters, not including the Null-terminator,   then ASSERT().   If PcdMaximumAsciiStringLength is not zero and SecondString contains more   than PcdMaximumAsciiStringLength ASCII characters, not including the   Null-terminator, then ASSERT().    @param  FirstString   A pointer to a Null-terminated ASCII string.   @param  SecondString  A pointer to a Null-terminated ASCII string.    @retval ==0    FirstString is identical to SecondString using case insensitive                  comparisons.   @retval !=0    FirstString is not identical to SecondString using case                  insensitive comparisons.  **/
end_comment

begin_function
name|INTN
name|EFIAPI
name|AsciiStriCmp
parameter_list|(
name|IN
name|CONST
name|CHAR8
modifier|*
name|FirstString
parameter_list|,
name|IN
name|CONST
name|CHAR8
modifier|*
name|SecondString
parameter_list|)
block|{
name|CHAR8
name|UpperFirstString
decl_stmt|;
name|CHAR8
name|UpperSecondString
decl_stmt|;
comment|//
comment|// ASSERT both strings are less long than PcdMaximumAsciiStringLength
comment|//
name|ASSERT
argument_list|(
name|AsciiStrSize
argument_list|(
name|FirstString
argument_list|)
argument_list|)
expr_stmt|;
name|ASSERT
argument_list|(
name|AsciiStrSize
argument_list|(
name|SecondString
argument_list|)
argument_list|)
expr_stmt|;
name|UpperFirstString
operator|=
name|InternalBaseLibAsciiToUpper
argument_list|(
operator|*
name|FirstString
argument_list|)
expr_stmt|;
name|UpperSecondString
operator|=
name|InternalBaseLibAsciiToUpper
argument_list|(
operator|*
name|SecondString
argument_list|)
expr_stmt|;
while|while
condition|(
operator|(
operator|*
name|FirstString
operator|!=
literal|'\0'
operator|)
operator|&&
operator|(
name|UpperFirstString
operator|==
name|UpperSecondString
operator|)
condition|)
block|{
name|FirstString
operator|++
expr_stmt|;
name|SecondString
operator|++
expr_stmt|;
name|UpperFirstString
operator|=
name|InternalBaseLibAsciiToUpper
argument_list|(
operator|*
name|FirstString
argument_list|)
expr_stmt|;
name|UpperSecondString
operator|=
name|InternalBaseLibAsciiToUpper
argument_list|(
operator|*
name|SecondString
argument_list|)
expr_stmt|;
block|}
return|return
name|UpperFirstString
operator|-
name|UpperSecondString
return|;
block|}
end_function

begin_comment
comment|/**   Compares two Null-terminated ASCII strings with maximum lengths, and returns   the difference between the first mismatched ASCII characters.    This function compares the Null-terminated ASCII string FirstString to the   Null-terminated ASCII  string SecondString. At most, Length ASCII characters   will be compared. If Length is 0, then 0 is returned. If FirstString is   identical to SecondString, then 0 is returned. Otherwise, the value returned   is the first mismatched ASCII character in SecondString subtracted from the   first mismatched ASCII character in FirstString.    If Length> 0 and FirstString is NULL, then ASSERT().   If Length> 0 and SecondString is NULL, then ASSERT().   If PcdMaximumAsciiStringLength is not zero, and Length is greater than    PcdMaximumAsciiStringLength, then ASSERT().   If PcdMaximumAsciiStringLength is not zero, and FirstString contains more than   PcdMaximumAsciiStringLength ASCII characters, not including the Null-terminator,   then ASSERT().   If PcdMaximumAsciiStringLength is not zero, and SecondString contains more than   PcdMaximumAsciiStringLength ASCII characters, not including the Null-terminator,   then ASSERT().    @param  FirstString   A pointer to a Null-terminated ASCII string.   @param  SecondString  A pointer to a Null-terminated ASCII string.   @param  Length        The maximum number of ASCII characters for compare.      @retval ==0       FirstString is identical to SecondString.   @retval !=0       FirstString is not identical to SecondString.  **/
end_comment

begin_function
name|INTN
name|EFIAPI
name|AsciiStrnCmp
parameter_list|(
name|IN
name|CONST
name|CHAR8
modifier|*
name|FirstString
parameter_list|,
name|IN
name|CONST
name|CHAR8
modifier|*
name|SecondString
parameter_list|,
name|IN
name|UINTN
name|Length
parameter_list|)
block|{
if|if
condition|(
name|Length
operator|==
literal|0
condition|)
block|{
return|return
literal|0
return|;
block|}
comment|//
comment|// ASSERT both strings are less long than PcdMaximumAsciiStringLength
comment|//
name|ASSERT
argument_list|(
name|AsciiStrSize
argument_list|(
name|FirstString
argument_list|)
argument_list|)
expr_stmt|;
name|ASSERT
argument_list|(
name|AsciiStrSize
argument_list|(
name|SecondString
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|PcdGet32
argument_list|(
name|PcdMaximumAsciiStringLength
argument_list|)
operator|!=
literal|0
condition|)
block|{
name|ASSERT
argument_list|(
name|Length
operator|<=
name|PcdGet32
argument_list|(
name|PcdMaximumAsciiStringLength
argument_list|)
argument_list|)
expr_stmt|;
block|}
while|while
condition|(
operator|(
operator|*
name|FirstString
operator|!=
literal|'\0'
operator|)
operator|&&
operator|(
operator|*
name|SecondString
operator|!=
literal|'\0'
operator|)
operator|&&
operator|(
operator|*
name|FirstString
operator|==
operator|*
name|SecondString
operator|)
operator|&&
operator|(
name|Length
operator|>
literal|1
operator|)
condition|)
block|{
name|FirstString
operator|++
expr_stmt|;
name|SecondString
operator|++
expr_stmt|;
name|Length
operator|--
expr_stmt|;
block|}
return|return
operator|*
name|FirstString
operator|-
operator|*
name|SecondString
return|;
block|}
end_function

begin_ifndef
ifndef|#
directive|ifndef
name|DISABLE_NEW_DEPRECATED_INTERFACES
end_ifndef

begin_comment
comment|/**   [ATTENTION] This function will be deprecated for security reason.    Concatenates one Null-terminated ASCII string to another Null-terminated   ASCII string, and returns the concatenated ASCII string.    This function concatenates two Null-terminated ASCII strings. The contents of   Null-terminated ASCII string Source are concatenated to the end of Null-   terminated ASCII string Destination. The Null-terminated concatenated ASCII   String is returned.    If Destination is NULL, then ASSERT().   If Source is NULL, then ASSERT().   If PcdMaximumAsciiStringLength is not zero and Destination contains more than   PcdMaximumAsciiStringLength ASCII characters, not including the Null-terminator,   then ASSERT().   If PcdMaximumAsciiStringLength is not zero and Source contains more than   PcdMaximumAsciiStringLength ASCII characters, not including the Null-terminator,   then ASSERT().   If PcdMaximumAsciiStringLength is not zero and concatenating Destination and   Source results in a ASCII string with more than PcdMaximumAsciiStringLength   ASCII characters, then ASSERT().    @param  Destination A pointer to a Null-terminated ASCII string.   @param  Source      A pointer to a Null-terminated ASCII string.    @return Destination  **/
end_comment

begin_function
name|CHAR8
modifier|*
name|EFIAPI
name|AsciiStrCat
parameter_list|(
name|IN
name|OUT
name|CHAR8
modifier|*
name|Destination
parameter_list|,
name|IN
name|CONST
name|CHAR8
modifier|*
name|Source
parameter_list|)
block|{
name|AsciiStrCpy
argument_list|(
name|Destination
operator|+
name|AsciiStrLen
argument_list|(
name|Destination
argument_list|)
argument_list|,
name|Source
argument_list|)
expr_stmt|;
comment|//
comment|// Size of the resulting string should never be zero.
comment|// PcdMaximumUnicodeStringLength is tested inside StrLen().
comment|//
name|ASSERT
argument_list|(
name|AsciiStrSize
argument_list|(
name|Destination
argument_list|)
operator|!=
literal|0
argument_list|)
expr_stmt|;
return|return
name|Destination
return|;
block|}
end_function

begin_comment
comment|/**   [ATTENTION] This function will be deprecated for security reason.    Concatenates up to a specified length one Null-terminated ASCII string to    the end of another Null-terminated ASCII string, and returns the    concatenated ASCII string.    This function concatenates two Null-terminated ASCII strings. The contents   of Null-terminated ASCII string Source are concatenated to the end of Null-   terminated ASCII string Destination, and Destination is returned. At most,   Length ASCII characters are concatenated from Source to the end of   Destination, and Destination is always Null-terminated. If Length is 0, then   Destination is returned unmodified. If Source and Destination overlap, then   the results are undefined.    If Length> 0 and Destination is NULL, then ASSERT().   If Length> 0 and Source is NULL, then ASSERT().   If Source and Destination overlap, then ASSERT().   If PcdMaximumAsciiStringLength is not zero, and Length is greater than   PcdMaximumAsciiStringLength, then ASSERT().   If PcdMaximumAsciiStringLength is not zero, and Destination contains more than   PcdMaximumAsciiStringLength ASCII characters, not including the Null-terminator,   then ASSERT().   If PcdMaximumAsciiStringLength is not zero, and Source contains more than   PcdMaximumAsciiStringLength ASCII characters, not including the Null-terminator,   then ASSERT().   If PcdMaximumAsciiStringLength is not zero, and concatenating Destination and   Source results in a ASCII string with more than PcdMaximumAsciiStringLength   ASCII characters, not including the Null-terminator, then ASSERT().    @param  Destination A pointer to a Null-terminated ASCII string.   @param  Source      A pointer to a Null-terminated ASCII string.   @param  Length      The maximum number of ASCII characters to concatenate from                       Source.    @return Destination  **/
end_comment

begin_function
name|CHAR8
modifier|*
name|EFIAPI
name|AsciiStrnCat
parameter_list|(
name|IN
name|OUT
name|CHAR8
modifier|*
name|Destination
parameter_list|,
name|IN
name|CONST
name|CHAR8
modifier|*
name|Source
parameter_list|,
name|IN
name|UINTN
name|Length
parameter_list|)
block|{
name|UINTN
name|DestinationLen
decl_stmt|;
name|DestinationLen
operator|=
name|AsciiStrLen
argument_list|(
name|Destination
argument_list|)
expr_stmt|;
name|AsciiStrnCpy
argument_list|(
name|Destination
operator|+
name|DestinationLen
argument_list|,
name|Source
argument_list|,
name|Length
argument_list|)
expr_stmt|;
name|Destination
index|[
name|DestinationLen
operator|+
name|Length
index|]
operator|=
literal|'\0'
expr_stmt|;
comment|//
comment|// Size of the resulting string should never be zero.
comment|// PcdMaximumUnicodeStringLength is tested inside StrLen().
comment|//
name|ASSERT
argument_list|(
name|AsciiStrSize
argument_list|(
name|Destination
argument_list|)
operator|!=
literal|0
argument_list|)
expr_stmt|;
return|return
name|Destination
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/**   Returns the first occurrence of a Null-terminated ASCII sub-string   in a Null-terminated ASCII string.    This function scans the contents of the ASCII string specified by String   and returns the first occurrence of SearchString. If SearchString is not   found in String, then NULL is returned. If the length of SearchString is zero,   then String is returned.    If String is NULL, then ASSERT().   If SearchString is NULL, then ASSERT().    If PcdMaximumAsciiStringLength is not zero, and SearchString or   String contains more than PcdMaximumAsciiStringLength Unicode characters   not including the Null-terminator, then ASSERT().    @param  String          A pointer to a Null-terminated ASCII string.   @param  SearchString    A pointer to a Null-terminated ASCII string to search for.    @retval NULL            If the SearchString does not appear in String.   @retval others          If there is a match return the first occurrence of SearchingString.                           If the length of SearchString is zero,return String.  **/
end_comment

begin_function
name|CHAR8
modifier|*
name|EFIAPI
name|AsciiStrStr
parameter_list|(
name|IN
name|CONST
name|CHAR8
modifier|*
name|String
parameter_list|,
name|IN
name|CONST
name|CHAR8
modifier|*
name|SearchString
parameter_list|)
block|{
name|CONST
name|CHAR8
modifier|*
name|FirstMatch
decl_stmt|;
name|CONST
name|CHAR8
modifier|*
name|SearchStringTmp
decl_stmt|;
comment|//
comment|// ASSERT both strings are less long than PcdMaximumAsciiStringLength
comment|//
name|ASSERT
argument_list|(
name|AsciiStrSize
argument_list|(
name|String
argument_list|)
operator|!=
literal|0
argument_list|)
expr_stmt|;
name|ASSERT
argument_list|(
name|AsciiStrSize
argument_list|(
name|SearchString
argument_list|)
operator|!=
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
name|SearchString
operator|==
literal|'\0'
condition|)
block|{
return|return
operator|(
name|CHAR8
operator|*
operator|)
name|String
return|;
block|}
while|while
condition|(
operator|*
name|String
operator|!=
literal|'\0'
condition|)
block|{
name|SearchStringTmp
operator|=
name|SearchString
expr_stmt|;
name|FirstMatch
operator|=
name|String
expr_stmt|;
while|while
condition|(
operator|(
operator|*
name|String
operator|==
operator|*
name|SearchStringTmp
operator|)
operator|&&
operator|(
operator|*
name|String
operator|!=
literal|'\0'
operator|)
condition|)
block|{
name|String
operator|++
expr_stmt|;
name|SearchStringTmp
operator|++
expr_stmt|;
block|}
if|if
condition|(
operator|*
name|SearchStringTmp
operator|==
literal|'\0'
condition|)
block|{
return|return
operator|(
name|CHAR8
operator|*
operator|)
name|FirstMatch
return|;
block|}
if|if
condition|(
operator|*
name|String
operator|==
literal|'\0'
condition|)
block|{
return|return
name|NULL
return|;
block|}
name|String
operator|=
name|FirstMatch
operator|+
literal|1
expr_stmt|;
block|}
return|return
name|NULL
return|;
block|}
end_function

begin_comment
comment|/**   Convert a Null-terminated ASCII decimal string to a value of type   UINTN.    This function returns a value of type UINTN by interpreting the contents   of the ASCII string String as a decimal number. The format of the input   ASCII string String is:                      [spaces] [decimal digits].    The valid decimal digit character is in the range [0-9]. The function will   ignore the pad space, which includes spaces or tab characters, before the digits.   The running zero in the beginning of [decimal digits] will be ignored. Then, the   function stops at the first character that is a not a valid decimal character or   Null-terminator, whichever on comes first.    If String has only pad spaces, then 0 is returned.   If String has no pad spaces or valid decimal digits, then 0 is returned.   If the number represented by String overflows according to the range defined by   UINTN, then MAX_UINTN is returned.   If String is NULL, then ASSERT().   If PcdMaximumAsciiStringLength is not zero, and String contains more than   PcdMaximumAsciiStringLength ASCII characters not including the Null-terminator,   then ASSERT().    @param  String          A pointer to a Null-terminated ASCII string.    @retval Value translated from String.  **/
end_comment

begin_function
name|UINTN
name|EFIAPI
name|AsciiStrDecimalToUintn
parameter_list|(
name|IN
name|CONST
name|CHAR8
modifier|*
name|String
parameter_list|)
block|{
name|UINTN
name|Result
decl_stmt|;
name|AsciiStrDecimalToUintnS
argument_list|(
name|String
argument_list|,
operator|(
name|CHAR8
operator|*
operator|*
operator|)
name|NULL
argument_list|,
operator|&
name|Result
argument_list|)
expr_stmt|;
return|return
name|Result
return|;
block|}
end_function

begin_comment
comment|/**   Convert a Null-terminated ASCII decimal string to a value of type   UINT64.    This function returns a value of type UINT64 by interpreting the contents   of the ASCII string String as a decimal number. The format of the input   ASCII string String is:                      [spaces] [decimal digits].    The valid decimal digit character is in the range [0-9]. The function will   ignore the pad space, which includes spaces or tab characters, before the digits.   The running zero in the beginning of [decimal digits] will be ignored. Then, the   function stops at the first character that is a not a valid decimal character or   Null-terminator, whichever on comes first.    If String has only pad spaces, then 0 is returned.   If String has no pad spaces or valid decimal digits, then 0 is returned.   If the number represented by String overflows according to the range defined by   UINT64, then MAX_UINT64 is returned.   If String is NULL, then ASSERT().   If PcdMaximumAsciiStringLength is not zero, and String contains more than   PcdMaximumAsciiStringLength ASCII characters not including the Null-terminator,   then ASSERT().    @param  String          A pointer to a Null-terminated ASCII string.    @retval Value translated from String.  **/
end_comment

begin_function
name|UINT64
name|EFIAPI
name|AsciiStrDecimalToUint64
parameter_list|(
name|IN
name|CONST
name|CHAR8
modifier|*
name|String
parameter_list|)
block|{
name|UINT64
name|Result
decl_stmt|;
name|AsciiStrDecimalToUint64S
argument_list|(
name|String
argument_list|,
operator|(
name|CHAR8
operator|*
operator|*
operator|)
name|NULL
argument_list|,
operator|&
name|Result
argument_list|)
expr_stmt|;
return|return
name|Result
return|;
block|}
end_function

begin_comment
comment|/**   Convert a Null-terminated ASCII hexadecimal string to a value of type UINTN.    This function returns a value of type UINTN by interpreting the contents of   the ASCII string String as a hexadecimal number. The format of the input ASCII   string String is:                    [spaces][zeros][x][hexadecimal digits].    The valid hexadecimal digit character is in the range [0-9], [a-f] and [A-F].   The prefix "0x" is optional. Both "x" and "X" is allowed in "0x" prefix. If "x"   appears in the input string, it must be prefixed with at least one 0. The function   will ignore the pad space, which includes spaces or tab characters, before [zeros],   [x] or [hexadecimal digits]. The running zero before [x] or [hexadecimal digits]   will be ignored. Then, the decoding starts after [x] or the first valid hexadecimal   digit. Then, the function stops at the first character that is a not a valid   hexadecimal character or Null-terminator, whichever on comes first.    If String has only pad spaces, then 0 is returned.   If String has no leading pad spaces, leading zeros or valid hexadecimal digits, then   0 is returned.    If the number represented by String overflows according to the range defined by UINTN,   then MAX_UINTN is returned.   If String is NULL, then ASSERT().   If PcdMaximumAsciiStringLength is not zero,   and String contains more than PcdMaximumAsciiStringLength ASCII characters not including   the Null-terminator, then ASSERT().    @param  String          A pointer to a Null-terminated ASCII string.    @retval Value translated from String.  **/
end_comment

begin_function
name|UINTN
name|EFIAPI
name|AsciiStrHexToUintn
parameter_list|(
name|IN
name|CONST
name|CHAR8
modifier|*
name|String
parameter_list|)
block|{
name|UINTN
name|Result
decl_stmt|;
name|AsciiStrHexToUintnS
argument_list|(
name|String
argument_list|,
operator|(
name|CHAR8
operator|*
operator|*
operator|)
name|NULL
argument_list|,
operator|&
name|Result
argument_list|)
expr_stmt|;
return|return
name|Result
return|;
block|}
end_function

begin_comment
comment|/**   Convert a Null-terminated ASCII hexadecimal string to a value of type UINT64.    This function returns a value of type UINT64 by interpreting the contents of   the ASCII string String as a hexadecimal number. The format of the input ASCII   string String is:                    [spaces][zeros][x][hexadecimal digits].    The valid hexadecimal digit character is in the range [0-9], [a-f] and [A-F].   The prefix "0x" is optional. Both "x" and "X" is allowed in "0x" prefix. If "x"   appears in the input string, it must be prefixed with at least one 0. The function   will ignore the pad space, which includes spaces or tab characters, before [zeros],   [x] or [hexadecimal digits]. The running zero before [x] or [hexadecimal digits]   will be ignored. Then, the decoding starts after [x] or the first valid hexadecimal   digit. Then, the function stops at the first character that is a not a valid   hexadecimal character or Null-terminator, whichever on comes first.    If String has only pad spaces, then 0 is returned.   If String has no leading pad spaces, leading zeros or valid hexadecimal digits, then   0 is returned.    If the number represented by String overflows according to the range defined by UINT64,   then MAX_UINT64 is returned.   If String is NULL, then ASSERT().   If PcdMaximumAsciiStringLength is not zero,   and String contains more than PcdMaximumAsciiStringLength ASCII characters not including   the Null-terminator, then ASSERT().    @param  String          A pointer to a Null-terminated ASCII string.    @retval Value translated from String.  **/
end_comment

begin_function
name|UINT64
name|EFIAPI
name|AsciiStrHexToUint64
parameter_list|(
name|IN
name|CONST
name|CHAR8
modifier|*
name|String
parameter_list|)
block|{
name|UINT64
name|Result
decl_stmt|;
name|AsciiStrHexToUint64S
argument_list|(
name|String
argument_list|,
operator|(
name|CHAR8
operator|*
operator|*
operator|)
name|NULL
argument_list|,
operator|&
name|Result
argument_list|)
expr_stmt|;
return|return
name|Result
return|;
block|}
end_function

begin_ifndef
ifndef|#
directive|ifndef
name|DISABLE_NEW_DEPRECATED_INTERFACES
end_ifndef

begin_comment
comment|/**   [ATTENTION] This function is deprecated for security reason.    Convert one Null-terminated ASCII string to a Null-terminated   Unicode string and returns the Unicode string.    This function converts the contents of the ASCII string Source to the Unicode   string Destination, and returns Destination.  The function terminates the   Unicode string Destination by appending a Null-terminator character at the end.   The caller is responsible to make sure Destination points to a buffer with size   equal or greater than ((AsciiStrLen (Source) + 1) * sizeof (CHAR16)) in bytes.    If Destination is NULL, then ASSERT().   If Destination is not aligned on a 16-bit boundary, then ASSERT().   If Source is NULL, then ASSERT().   If Source and Destination overlap, then ASSERT().   If PcdMaximumAsciiStringLength is not zero, and Source contains more than   PcdMaximumAsciiStringLength ASCII characters not including the Null-terminator,   then ASSERT().   If PcdMaximumUnicodeStringLength is not zero, and Source contains more than   PcdMaximumUnicodeStringLength ASCII characters not including the   Null-terminator, then ASSERT().    @param  Source        A pointer to a Null-terminated ASCII string.   @param  Destination   A pointer to a Null-terminated Unicode string.    @return Destination.  **/
end_comment

begin_function
name|CHAR16
modifier|*
name|EFIAPI
name|AsciiStrToUnicodeStr
parameter_list|(
name|IN
name|CONST
name|CHAR8
modifier|*
name|Source
parameter_list|,
name|OUT
name|CHAR16
modifier|*
name|Destination
parameter_list|)
block|{
name|CHAR16
modifier|*
name|ReturnValue
decl_stmt|;
name|ASSERT
argument_list|(
name|Destination
operator|!=
name|NULL
argument_list|)
expr_stmt|;
comment|//
comment|// ASSERT Source is less long than PcdMaximumAsciiStringLength
comment|//
name|ASSERT
argument_list|(
name|AsciiStrSize
argument_list|(
name|Source
argument_list|)
operator|!=
literal|0
argument_list|)
expr_stmt|;
comment|//
comment|// Source and Destination should not overlap
comment|//
name|ASSERT
argument_list|(
call|(
name|UINTN
call|)
argument_list|(
operator|(
name|CHAR8
operator|*
operator|)
name|Destination
operator|-
name|Source
argument_list|)
operator|>
name|AsciiStrLen
argument_list|(
name|Source
argument_list|)
argument_list|)
expr_stmt|;
name|ASSERT
argument_list|(
call|(
name|UINTN
call|)
argument_list|(
name|Source
operator|-
operator|(
name|CHAR8
operator|*
operator|)
name|Destination
argument_list|)
operator|>=
operator|(
name|AsciiStrSize
argument_list|(
name|Source
argument_list|)
operator|*
sizeof|sizeof
argument_list|(
name|CHAR16
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ReturnValue
operator|=
name|Destination
expr_stmt|;
while|while
condition|(
operator|*
name|Source
operator|!=
literal|'\0'
condition|)
block|{
operator|*
operator|(
name|Destination
operator|++
operator|)
operator|=
operator|(
name|CHAR16
operator|)
operator|*
operator|(
name|Source
operator|++
operator|)
expr_stmt|;
block|}
comment|//
comment|// End the Destination with a NULL.
comment|//
operator|*
name|Destination
operator|=
literal|'\0'
expr_stmt|;
comment|//
comment|// ASSERT Original Destination is less long than PcdMaximumUnicodeStringLength
comment|//
name|ASSERT
argument_list|(
name|StrSize
argument_list|(
name|ReturnValue
argument_list|)
operator|!=
literal|0
argument_list|)
expr_stmt|;
return|return
name|ReturnValue
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/**   Converts an 8-bit value to an 8-bit BCD value.    Converts the 8-bit value specified by Value to BCD. The BCD value is   returned.    If Value>= 100, then ASSERT().    @param  Value The 8-bit value to convert to BCD. Range 0..99.    @return The BCD value.  **/
end_comment

begin_function
name|UINT8
name|EFIAPI
name|DecimalToBcd8
parameter_list|(
name|IN
name|UINT8
name|Value
parameter_list|)
block|{
name|ASSERT
argument_list|(
name|Value
operator|<
literal|100
argument_list|)
expr_stmt|;
return|return
call|(
name|UINT8
call|)
argument_list|(
operator|(
operator|(
name|Value
operator|/
literal|10
operator|)
operator|<<
literal|4
operator|)
operator||
operator|(
name|Value
operator|%
literal|10
operator|)
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/**   Converts an 8-bit BCD value to an 8-bit value.    Converts the 8-bit BCD value specified by Value to an 8-bit value. The 8-bit   value is returned.    If Value>= 0xA0, then ASSERT().   If (Value& 0x0F)>= 0x0A, then ASSERT().    @param  Value The 8-bit BCD value to convert to an 8-bit value.    @return The 8-bit value is returned.  **/
end_comment

begin_function
name|UINT8
name|EFIAPI
name|BcdToDecimal8
parameter_list|(
name|IN
name|UINT8
name|Value
parameter_list|)
block|{
name|ASSERT
argument_list|(
name|Value
operator|<
literal|0xa0
argument_list|)
expr_stmt|;
name|ASSERT
argument_list|(
operator|(
name|Value
operator|&
literal|0xf
operator|)
operator|<
literal|0xa
argument_list|)
expr_stmt|;
return|return
call|(
name|UINT8
call|)
argument_list|(
operator|(
name|Value
operator|>>
literal|4
operator|)
operator|*
literal|10
operator|+
operator|(
name|Value
operator|&
literal|0xf
operator|)
argument_list|)
return|;
block|}
end_function

end_unit

