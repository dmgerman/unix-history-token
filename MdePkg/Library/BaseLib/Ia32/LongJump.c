begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/** @file   Implementation of _LongJump() on IA-32.    Copyright (c) 2006 - 2008, Intel Corporation. All rights reserved.<BR>   This program and the accompanying materials   are licensed and made available under the terms and conditions of the BSD License   which accompanies this distribution.  The full text of the license may be found at   http://opensource.org/licenses/bsd-license.php.    THE PROGRAM IS DISTRIBUTED UNDER THE BSD LICENSE ON AN "AS IS" BASIS,   WITHOUT WARRANTIES OR REPRESENTATIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED.  **/
end_comment

begin_include
include|#
directive|include
file|"BaseLibInternals.h"
end_include

begin_comment
comment|/**   Restores the CPU context that was saved with SetJump().    Restores the CPU context from the buffer specified by JumpBuffer.   This function never returns to the caller.   Instead is resumes execution based on the state of JumpBuffer.    @param  JumpBuffer    A pointer to CPU context buffer.   @param  Value         The value to return when the SetJump() context is restored.  **/
end_comment

begin_macro
name|__declspec
argument_list|(
argument|naked
argument_list|)
end_macro

begin_function
name|VOID
name|EFIAPI
name|InternalLongJump
parameter_list|(
name|IN
name|BASE_LIBRARY_JUMP_BUFFER
modifier|*
name|JumpBuffer
parameter_list|,
name|IN
name|UINTN
name|Value
parameter_list|)
block|{
name|_asm
block|{
name|pop
name|eax
decl_stmt|;
name|skip
return|return
name|address
name|pop
name|edx
return|;
name|edx
operator|<
operator|-
name|JumpBuffer
name|pop
name|eax
expr_stmt|;
name|eax
operator|<
operator|-
name|Value
name|mov
name|ebx
operator|,
index|[
name|edx
index|]
name|mov
name|esi
operator|,
index|[
name|edx
operator|+
literal|4
index|]
name|mov
name|edi
operator|,
index|[
name|edx
operator|+
literal|8
index|]
name|mov
name|ebp
operator|,
index|[
name|edx
operator|+
literal|12
index|]
name|mov
name|esp
operator|,
index|[
name|edx
operator|+
literal|16
index|]
name|jmp
name|dword
name|ptr
index|[
name|edx
operator|+
literal|20
index|]
block|}
block|}
end_function

end_unit

