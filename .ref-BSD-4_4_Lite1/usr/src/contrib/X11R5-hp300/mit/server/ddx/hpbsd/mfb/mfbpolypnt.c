begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* Combined Purdue/PurduePlus patches, level 2.0, 1/17/89 */
end_comment

begin_comment
comment|/*********************************************************** Copyright 1987 by Digital Equipment Corporation, Maynard, Massachusetts, and the Massachusetts Institute of Technology, Cambridge, Massachusetts.                          All Rights Reserved  Permission to use, copy, modify, and distribute this software and its  documentation for any purpose and without fee is hereby granted,  provided that the above copyright notice appear in all copies and that both that copyright notice and this permission notice appear in  supporting documentation, and that the names of Digital or MIT not be used in advertising or publicity pertaining to distribution of the software without specific, written prior permission.    DIGITAL DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, IN NO EVENT SHALL DIGITAL BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.  ******************************************************************/
end_comment

begin_comment
comment|/* $XConsortium: mfbpolypnt.c,v 5.3 89/09/11 10:12:05 rws Exp $ */
end_comment

begin_include
include|#
directive|include
file|"X.h"
end_include

begin_include
include|#
directive|include
file|"Xprotostr.h"
end_include

begin_include
include|#
directive|include
file|"pixmapstr.h"
end_include

begin_include
include|#
directive|include
file|"gcstruct.h"
end_include

begin_include
include|#
directive|include
file|"windowstr.h"
end_include

begin_include
include|#
directive|include
file|"miscstruct.h"
end_include

begin_include
include|#
directive|include
file|"regionstr.h"
end_include

begin_include
include|#
directive|include
file|"scrnintstr.h"
end_include

begin_include
include|#
directive|include
file|"mfb.h"
end_include

begin_include
include|#
directive|include
file|"maskbits.h"
end_include

begin_function
name|void
name|mfbPolyPoint
parameter_list|(
name|pDrawable
parameter_list|,
name|pGC
parameter_list|,
name|mode
parameter_list|,
name|npt
parameter_list|,
name|pptInit
parameter_list|)
specifier|register
name|DrawablePtr
name|pDrawable
decl_stmt|;
name|GCPtr
name|pGC
decl_stmt|;
name|int
name|mode
decl_stmt|;
comment|/* Origin or Previous */
name|int
name|npt
decl_stmt|;
name|xPoint
modifier|*
name|pptInit
decl_stmt|;
block|{
specifier|register
name|BoxPtr
name|pbox
decl_stmt|;
specifier|register
name|int
name|nbox
decl_stmt|;
specifier|register
name|int
modifier|*
name|addrl
decl_stmt|;
name|int
name|nlwidth
decl_stmt|;
name|int
name|nptTmp
decl_stmt|;
specifier|register
name|xPoint
modifier|*
name|ppt
decl_stmt|;
specifier|register
name|int
name|x
decl_stmt|;
specifier|register
name|int
name|y
decl_stmt|;
specifier|register
name|int
name|rop
decl_stmt|;
name|mfbPrivGC
modifier|*
name|pGCPriv
decl_stmt|;
if|if
condition|(
operator|!
operator|(
name|pGC
operator|->
name|planemask
operator|&
literal|1
operator|)
condition|)
return|return;
name|pGCPriv
operator|=
operator|(
name|mfbPrivGC
operator|*
operator|)
name|pGC
operator|->
name|devPrivates
index|[
name|mfbGCPrivateIndex
index|]
operator|.
name|ptr
expr_stmt|;
name|rop
operator|=
name|pGCPriv
operator|->
name|rop
expr_stmt|;
if|if
condition|(
name|pDrawable
operator|->
name|type
operator|==
name|DRAWABLE_WINDOW
condition|)
block|{
name|addrl
operator|=
operator|(
name|int
operator|*
operator|)
name|getPrivScreenPtr
argument_list|(
name|pDrawable
operator|->
name|pScreen
argument_list|)
operator|->
name|bits
expr_stmt|;
name|nlwidth
operator|=
operator|(
name|int
operator|)
name|getPrivScreenPtr
argument_list|(
name|pDrawable
operator|->
name|pScreen
argument_list|)
operator|->
name|stride
operator|>>
literal|2
expr_stmt|;
block|}
else|else
block|{
name|addrl
operator|=
operator|(
name|int
operator|*
operator|)
name|getPrivPixmapPtr
argument_list|(
name|pDrawable
argument_list|)
operator|->
name|bits
expr_stmt|;
name|nlwidth
operator|=
operator|(
name|int
operator|)
name|getPrivPixmapPtr
argument_list|(
name|pDrawable
argument_list|)
operator|->
name|stride
operator|>>
literal|2
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|mode
operator|==
name|CoordModePrevious
operator|)
operator|&&
operator|(
name|npt
operator|>
literal|1
operator|)
condition|)
block|{
for|for
control|(
name|ppt
operator|=
name|pptInit
operator|+
literal|1
operator|,
name|nptTmp
operator|=
name|npt
operator|-
literal|1
init|;
operator|--
name|nptTmp
operator|>=
literal|0
condition|;
name|ppt
operator|++
control|)
block|{
name|ppt
operator|->
name|x
operator|+=
operator|(
name|ppt
operator|-
literal|1
operator|)
operator|->
name|x
expr_stmt|;
name|ppt
operator|->
name|y
operator|+=
operator|(
name|ppt
operator|-
literal|1
operator|)
operator|->
name|y
expr_stmt|;
block|}
block|}
name|nbox
operator|=
name|REGION_NUM_RECTS
argument_list|(
name|pGCPriv
operator|->
name|pCompositeClip
argument_list|)
expr_stmt|;
name|pbox
operator|=
name|REGION_RECTS
argument_list|(
name|pGCPriv
operator|->
name|pCompositeClip
argument_list|)
expr_stmt|;
for|for
control|(
init|;
operator|--
name|nbox
operator|>=
literal|0
condition|;
name|pbox
operator|++
control|)
block|{
if|if
condition|(
name|rop
operator|==
name|RROP_BLACK
condition|)
block|{
for|for
control|(
name|ppt
operator|=
name|pptInit
operator|,
name|nptTmp
operator|=
name|npt
init|;
operator|--
name|nptTmp
operator|>=
literal|0
condition|;
name|ppt
operator|++
control|)
block|{
name|x
operator|=
name|ppt
operator|->
name|x
operator|+
name|pDrawable
operator|->
name|x
expr_stmt|;
name|y
operator|=
name|ppt
operator|->
name|y
operator|+
name|pDrawable
operator|->
name|y
expr_stmt|;
if|if
condition|(
operator|(
name|x
operator|>=
name|pbox
operator|->
name|x1
operator|)
operator|&&
operator|(
name|x
operator|<
name|pbox
operator|->
name|x2
operator|)
operator|&&
operator|(
name|y
operator|>=
name|pbox
operator|->
name|y1
operator|)
operator|&&
operator|(
name|y
operator|<
name|pbox
operator|->
name|y2
operator|)
condition|)
operator|*
operator|(
name|addrl
operator|+
operator|(
name|y
operator|*
name|nlwidth
operator|)
operator|+
operator|(
name|x
operator|>>
literal|5
operator|)
operator|)
operator|&=
name|rmask
index|[
name|x
operator|&
literal|0x1f
index|]
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|rop
operator|==
name|RROP_WHITE
condition|)
block|{
for|for
control|(
name|ppt
operator|=
name|pptInit
operator|,
name|nptTmp
operator|=
name|npt
init|;
operator|--
name|nptTmp
operator|>=
literal|0
condition|;
name|ppt
operator|++
control|)
block|{
name|x
operator|=
name|ppt
operator|->
name|x
operator|+
name|pDrawable
operator|->
name|x
expr_stmt|;
name|y
operator|=
name|ppt
operator|->
name|y
operator|+
name|pDrawable
operator|->
name|y
expr_stmt|;
if|if
condition|(
operator|(
name|x
operator|>=
name|pbox
operator|->
name|x1
operator|)
operator|&&
operator|(
name|x
operator|<
name|pbox
operator|->
name|x2
operator|)
operator|&&
operator|(
name|y
operator|>=
name|pbox
operator|->
name|y1
operator|)
operator|&&
operator|(
name|y
operator|<
name|pbox
operator|->
name|y2
operator|)
condition|)
operator|*
operator|(
name|addrl
operator|+
operator|(
name|y
operator|*
name|nlwidth
operator|)
operator|+
operator|(
name|x
operator|>>
literal|5
operator|)
operator|)
operator||=
name|mask
index|[
name|x
operator|&
literal|0x1f
index|]
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|rop
operator|==
name|RROP_INVERT
condition|)
block|{
for|for
control|(
name|ppt
operator|=
name|pptInit
operator|,
name|nptTmp
operator|=
name|npt
init|;
operator|--
name|nptTmp
operator|>=
literal|0
condition|;
name|ppt
operator|++
control|)
block|{
name|x
operator|=
name|ppt
operator|->
name|x
operator|+
name|pDrawable
operator|->
name|x
expr_stmt|;
name|y
operator|=
name|ppt
operator|->
name|y
operator|+
name|pDrawable
operator|->
name|y
expr_stmt|;
if|if
condition|(
operator|(
name|x
operator|>=
name|pbox
operator|->
name|x1
operator|)
operator|&&
operator|(
name|x
operator|<
name|pbox
operator|->
name|x2
operator|)
operator|&&
operator|(
name|y
operator|>=
name|pbox
operator|->
name|y1
operator|)
operator|&&
operator|(
name|y
operator|<
name|pbox
operator|->
name|y2
operator|)
condition|)
operator|*
operator|(
name|addrl
operator|+
operator|(
name|y
operator|*
name|nlwidth
operator|)
operator|+
operator|(
name|x
operator|>>
literal|5
operator|)
operator|)
operator|^=
name|mask
index|[
name|x
operator|&
literal|0x1f
index|]
expr_stmt|;
block|}
block|}
block|}
block|}
end_function

end_unit

