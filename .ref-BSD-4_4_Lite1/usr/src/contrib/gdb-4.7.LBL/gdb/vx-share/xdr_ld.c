begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* xdr_ld.c  - xdr routines for remote dbx interface to VxWorks  */
end_comment

begin_comment
comment|/*  Copyright 1984, 1985, 1986, 1987, 1988, 1989, 1992 Free Software Foundation, Inc.      This code was donated by Wind River Systems, Inc. */
end_comment

begin_comment
comment|/* modification history -------------------- 01a,05jun90,llk  extracted from xdr_dbx.c. */
end_comment

begin_comment
comment|/* DESCRIPTION This module contains the eXternal Data Representation (XDR) routines for object files that are downloaded to VxWorks.  They are used by remote debuggers that use RPC (such as dbxWorks and vxGdb). */
end_comment

begin_include
include|#
directive|include
file|"vxWorks.h"
end_include

begin_include
include|#
directive|include
file|"rpc/rpc.h"
end_include

begin_include
include|#
directive|include
file|"xdr_ld.h"
end_include

begin_comment
comment|/* forward declarations */
end_comment

begin_function_decl
name|bool_t
name|xdr_String
parameter_list|()
function_decl|;
end_function_decl

begin_comment
comment|/* xdr routine for argument list */
end_comment

begin_comment
comment|/******************************************************************************* * * xdr_String - xdr routine for strings. *  * Used by xdr_arg_info to handle the actual argument * strings.  normally calls xdr_string - but does something  * reasonable encode of null pointer. */
end_comment

begin_function
name|bool_t
name|xdr_String
parameter_list|(
name|xdrs
parameter_list|,
name|strp
parameter_list|)
name|XDR
modifier|*
name|xdrs
decl_stmt|;
name|char
modifier|*
modifier|*
name|strp
decl_stmt|;
block|{
if|if
condition|(
operator|(
operator|*
name|strp
operator|==
name|NULL
operator|)
operator|&
operator|(
name|xdrs
operator|->
name|x_op
operator|==
name|XDR_ENCODE
operator|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
else|else
return|return
operator|(
name|xdr_string
argument_list|(
name|xdrs
argument_list|,
name|strp
argument_list|,
name|MAXSTRLEN
argument_list|)
operator|)
return|;
block|}
end_function

begin_comment
comment|/******************************************************************************* * * xdr_ldfile - xdr routine for a single element in the load table  */
end_comment

begin_function
name|bool_t
name|xdr_ldfile
parameter_list|(
name|xdrs
parameter_list|,
name|objp
parameter_list|)
name|XDR
modifier|*
name|xdrs
decl_stmt|;
name|ldfile
modifier|*
name|objp
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|xdr_String
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|name
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|txt_addr
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|data_addr
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|bss_addr
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
return|return
operator|(
name|TRUE
operator|)
return|;
block|}
end_function

begin_comment
comment|/******************************************************************************* * * xdr_ldtabl - * * xdr routine for a list of files and load addresses loaded into VxWorks. */
end_comment

begin_function
name|bool_t
name|xdr_ldtabl
parameter_list|(
name|xdrs
parameter_list|,
name|objp
parameter_list|)
name|XDR
modifier|*
name|xdrs
decl_stmt|;
name|ldtabl
modifier|*
name|objp
decl_stmt|;
block|{
return|return
operator|(
name|xdr_array
argument_list|(
name|xdrs
argument_list|,
operator|(
name|char
operator|*
operator|)
operator|&
name|objp
operator|->
name|tbl_ent
argument_list|,
operator|(
name|UINT
operator|*
operator|)
operator|&
name|objp
operator|->
name|tbl_size
argument_list|,
name|MAXTBLSZ
argument_list|,
sizeof|sizeof
argument_list|(
name|ldfile
argument_list|)
argument_list|,
name|xdr_ldfile
argument_list|)
operator|)
return|;
block|}
end_function

end_unit

