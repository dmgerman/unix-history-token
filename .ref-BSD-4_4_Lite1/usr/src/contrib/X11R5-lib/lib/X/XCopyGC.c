begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* $XConsortium: XCopyGC.c,v 11.13 91/01/06 11:44:48 rws Exp $ */
end_comment

begin_comment
comment|/* Copyright    Massachusetts Institute of Technology    1986	*/
end_comment

begin_comment
comment|/* Permission to use, copy, modify, distribute, and sell this software and its documentation for any purpose is hereby granted without fee, provided that the above copyright notice appear in all copies and that both that copyright notice and this permission notice appear in supporting documentation, and that the name of M.I.T. not be used in advertising or publicity pertaining to distribution of the software without specific, written prior permission.  M.I.T. makes no representations about the suitability of this software for any purpose.  It is provided "as is" without express or implied warranty. */
end_comment

begin_include
include|#
directive|include
file|"Xlibint.h"
end_include

begin_expr_stmt
name|XCopyGC
argument_list|(
name|dpy
argument_list|,
name|srcGC
argument_list|,
name|mask
argument_list|,
name|destGC
argument_list|)
specifier|register
name|Display
operator|*
name|dpy
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|unsigned
name|long
name|mask
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* which ones to set initially */
end_comment

begin_decl_stmt
name|GC
name|srcGC
decl_stmt|,
name|destGC
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|XGCValues
modifier|*
name|destgv
init|=
operator|&
name|destGC
operator|->
name|values
decl_stmt|,
modifier|*
name|srcgv
init|=
operator|&
name|srcGC
operator|->
name|values
decl_stmt|;
specifier|register
name|xCopyGCReq
modifier|*
name|req
decl_stmt|;
specifier|register
name|_XExtension
modifier|*
name|ext
decl_stmt|;
name|LockDisplay
argument_list|(
name|dpy
argument_list|)
expr_stmt|;
name|mask
operator|&=
operator|(
literal|1L
operator|<<
operator|(
name|GCLastBit
operator|+
literal|1
operator|)
operator|)
operator|-
literal|1
expr_stmt|;
comment|/* if some of the source values to be copied are "dirty", flush them         out before sending the CopyGC request. */
if|if
condition|(
name|srcGC
operator|->
name|dirty
operator|&
name|mask
condition|)
name|_XFlushGCCache
argument_list|(
name|dpy
argument_list|,
name|srcGC
argument_list|)
expr_stmt|;
comment|/* mark the copied values "not dirty" in the destination. */
name|destGC
operator|->
name|dirty
operator|&=
operator|~
name|mask
expr_stmt|;
name|GetReq
argument_list|(
name|CopyGC
argument_list|,
name|req
argument_list|)
expr_stmt|;
name|req
operator|->
name|srcGC
operator|=
name|srcGC
operator|->
name|gid
expr_stmt|;
name|req
operator|->
name|dstGC
operator|=
name|destGC
operator|->
name|gid
expr_stmt|;
name|req
operator|->
name|mask
operator|=
name|mask
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCFunction
condition|)
name|destgv
operator|->
name|function
operator|=
name|srcgv
operator|->
name|function
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCPlaneMask
condition|)
name|destgv
operator|->
name|plane_mask
operator|=
name|srcgv
operator|->
name|plane_mask
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCForeground
condition|)
name|destgv
operator|->
name|foreground
operator|=
name|srcgv
operator|->
name|foreground
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCBackground
condition|)
name|destgv
operator|->
name|background
operator|=
name|srcgv
operator|->
name|background
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCLineWidth
condition|)
name|destgv
operator|->
name|line_width
operator|=
name|srcgv
operator|->
name|line_width
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCLineStyle
condition|)
name|destgv
operator|->
name|line_style
operator|=
name|srcgv
operator|->
name|line_style
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCCapStyle
condition|)
name|destgv
operator|->
name|cap_style
operator|=
name|srcgv
operator|->
name|cap_style
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCJoinStyle
condition|)
name|destgv
operator|->
name|join_style
operator|=
name|srcgv
operator|->
name|join_style
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCFillStyle
condition|)
name|destgv
operator|->
name|fill_style
operator|=
name|srcgv
operator|->
name|fill_style
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCFillRule
condition|)
name|destgv
operator|->
name|fill_rule
operator|=
name|srcgv
operator|->
name|fill_rule
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCArcMode
condition|)
name|destgv
operator|->
name|arc_mode
operator|=
name|srcgv
operator|->
name|arc_mode
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCTile
condition|)
name|destgv
operator|->
name|tile
operator|=
name|srcgv
operator|->
name|tile
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCStipple
condition|)
name|destgv
operator|->
name|stipple
operator|=
name|srcgv
operator|->
name|stipple
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCTileStipXOrigin
condition|)
name|destgv
operator|->
name|ts_x_origin
operator|=
name|srcgv
operator|->
name|ts_x_origin
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCTileStipYOrigin
condition|)
name|destgv
operator|->
name|ts_y_origin
operator|=
name|srcgv
operator|->
name|ts_y_origin
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCFont
condition|)
name|destgv
operator|->
name|font
operator|=
name|srcgv
operator|->
name|font
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCSubwindowMode
condition|)
name|destgv
operator|->
name|subwindow_mode
operator|=
name|srcgv
operator|->
name|subwindow_mode
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCGraphicsExposures
condition|)
name|destgv
operator|->
name|graphics_exposures
operator|=
name|srcgv
operator|->
name|graphics_exposures
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCClipXOrigin
condition|)
name|destgv
operator|->
name|clip_x_origin
operator|=
name|srcgv
operator|->
name|clip_x_origin
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCClipYOrigin
condition|)
name|destgv
operator|->
name|clip_y_origin
operator|=
name|srcgv
operator|->
name|clip_y_origin
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCClipMask
condition|)
block|{
name|destGC
operator|->
name|rects
operator|=
name|srcGC
operator|->
name|rects
expr_stmt|;
name|destgv
operator|->
name|clip_mask
operator|=
name|srcgv
operator|->
name|clip_mask
expr_stmt|;
block|}
if|if
condition|(
name|mask
operator|&
name|GCDashOffset
condition|)
name|destgv
operator|->
name|dash_offset
operator|=
name|srcgv
operator|->
name|dash_offset
expr_stmt|;
if|if
condition|(
name|mask
operator|&
name|GCDashList
condition|)
block|{
name|destGC
operator|->
name|dashes
operator|=
name|srcGC
operator|->
name|dashes
expr_stmt|;
name|destgv
operator|->
name|dashes
operator|=
name|srcgv
operator|->
name|dashes
expr_stmt|;
block|}
name|ext
operator|=
name|dpy
operator|->
name|ext_procs
expr_stmt|;
while|while
condition|(
name|ext
condition|)
block|{
comment|/* call out to any extensions interested */
if|if
condition|(
name|ext
operator|->
name|copy_GC
operator|!=
name|NULL
condition|)
call|(
modifier|*
name|ext
operator|->
name|copy_GC
call|)
argument_list|(
name|dpy
argument_list|,
name|destGC
argument_list|,
operator|&
name|ext
operator|->
name|codes
argument_list|)
expr_stmt|;
name|ext
operator|=
name|ext
operator|->
name|next
expr_stmt|;
block|}
name|UnlockDisplay
argument_list|(
name|dpy
argument_list|)
expr_stmt|;
name|SyncHandle
argument_list|()
expr_stmt|;
block|}
end_block

end_unit

