begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* $Header: errmsg.c,v 2.2 87/03/07 14:44:42 jqj Exp $ */
end_comment

begin_comment
comment|/* $Log:	errmsg.c,v $  * Revision 2.2  87/03/07  14:44:42  jqj  * set problem correctly.  Cardinal != Enum on most UNIX systems  *   * Revision 2.1  86/06/02  07:10:30  jqj  * print more information on unspecifiedError  *   * Revision 2.0  85/11/21  07:22:44  jqj  * 4.3BSD standard release  *   * Revision 1.1  85/11/20  14:19:04  jqj  * Initial revision  *   */
end_comment

begin_include
include|#
directive|include
file|"Filing4_defs.h"
end_include

begin_macro
name|FilingErrMsg
argument_list|(
argument|Code
argument_list|,
argument|Message
argument_list|)
end_macro

begin_decl_stmt
name|int
name|Code
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|Message
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|static
name|char
modifier|*
name|errmsgs
index|[]
init|=
block|{
literal|"AttributeTypeError"
block|,
literal|"AttributeValueError"
block|,
literal|"ControlTypeError"
block|,
literal|"ControlValueError"
block|,
literal|"ScopeTypeError"
block|,
literal|"ScopeValueError"
block|,
literal|"AccessError"
block|,
literal|"AuthenticationError"
block|,
literal|"ConnectionError"
block|,
literal|"HandleError"
block|,
literal|"InsertionError"
block|,
literal|"ServiceError"
block|,
literal|"SessionError"
block|,
literal|"SpaceError"
block|,
literal|"TransferError"
block|,
literal|"UndefinedError"
block|,
literal|"RangeError"
block|}
decl_stmt|;
specifier|static
name|char
modifier|*
name|argproblems
index|[]
init|=
block|{
literal|"illegal"
block|,
literal|"disallowed"
block|,
literal|"unreasonable"
block|,
literal|"unimplemented"
block|,
literal|"duplicated"
block|,
literal|"missing"
block|}
decl_stmt|;
specifier|static
name|char
modifier|*
name|accessproblems
index|[]
init|=
block|{
literal|"accessRightsInsufficient"
block|,
literal|"accessRightsIndeterminate"
block|,
literal|"fileChanged"
block|,
literal|"fileDamaged"
block|,
literal|"fileInUse"
block|,
literal|"fileNotFound"
block|,
literal|"fileOpen"
block|}
decl_stmt|;
specifier|static
name|char
modifier|*
name|connectionproblems
index|[]
init|=
block|{
literal|"noRoute"
block|,
literal|"noResponse"
block|,
literal|"transmissionHardware"
block|,
literal|"transportTimeout"
block|,
literal|"tooManyLocalConnections"
block|,
literal|"tooManyRemoteConnections"
block|,
literal|"missingCourier"
block|,
literal|"missingProgram"
block|,
literal|"missingProcedure"
block|,
literal|"protocolMismatch"
block|,
literal|"parameterInconsistency"
block|,
literal|"invalidMessage"
block|,
literal|"returnTimedOut"
block|,
literal|"otherCallProblem"
block|}
decl_stmt|;
specifier|static
name|char
modifier|*
name|handleproblems
index|[]
init|=
block|{
literal|"invalid"
block|,
literal|"nullDisallowed"
block|,
literal|"directoryRequired"
block|}
decl_stmt|;
specifier|static
name|char
modifier|*
name|insertionproblems
index|[]
init|=
block|{
literal|"positionUnavailable"
block|,
literal|"fileNotUnique"
block|,
literal|"loopInHierarchy"
block|}
decl_stmt|;
specifier|static
name|char
modifier|*
name|serviceproblems
index|[]
init|=
block|{
literal|"cannotAuthenticate"
block|,
literal|"serviceFull"
block|,
literal|"serviceUnavailable"
block|,
literal|"sessionInUse"
block|}
decl_stmt|;
specifier|static
name|char
modifier|*
name|sessionproblems
index|[]
init|=
block|{
literal|"tokenInvalid"
block|,
literal|"serviceAlreadySet"
block|}
decl_stmt|;
specifier|static
name|char
modifier|*
name|spaceproblems
index|[]
init|=
block|{
literal|"allocationExceeded"
block|,
literal|"attributeAreadFull"
block|,
literal|"mediumFull"
block|}
decl_stmt|;
specifier|static
name|char
modifier|*
name|transferproblems
index|[]
init|=
block|{
literal|"aborted"
block|,
literal|"checksumIncorrect"
block|,
literal|"formatIncorrect"
block|,
literal|"noRendevous"
block|,
literal|"wrongDirection"
block|}
decl_stmt|;
specifier|static
name|char
modifier|*
name|authenticationproblems
index|[]
init|=
block|{
literal|"credentialsInvalid"
block|,
literal|"verifierInvalid"
block|,
literal|"verifierExpiered"
block|,
literal|"verifierReused"
block|,
literal|"credentialsExpired"
block|,
literal|"inappropriateCredentials"
block|}
decl_stmt|;
specifier|static
name|char
modifier|*
name|rejectproblem
index|[]
init|=
block|{
literal|"noSuchProgramNumber"
block|,
literal|"noSuchVersionNumber"
block|,
literal|"noSuchProcedureValue"
block|,
literal|"invalidArgument"
block|}
decl_stmt|;
name|char
modifier|*
name|msg
decl_stmt|,
modifier|*
name|problemstr
decl_stmt|;
name|int
name|problem
decl_stmt|;
name|char
name|tempbuf
index|[
literal|40
index|]
decl_stmt|;
if|if
condition|(
name|Code
operator|<
literal|1000
condition|)
block|{
if|if
condition|(
name|Message
operator|!=
operator|(
name|char
operator|*
operator|)
literal|0
condition|)
name|printf
argument_list|(
literal|"ERROR: %s\n"
argument_list|,
name|Message
argument_list|)
expr_stmt|;
return|return;
block|}
name|msg
operator|=
literal|""
expr_stmt|;
name|problem
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|Code
operator|-
name|ERROR_OFFSET
operator|>=
literal|0
operator|&&
name|Code
operator|-
name|ERROR_OFFSET
operator|<=
literal|16
condition|)
block|{
name|msg
operator|=
name|errmsgs
index|[
name|Code
operator|-
name|ERROR_OFFSET
index|]
expr_stmt|;
block|}
switch|switch
condition|(
name|Code
condition|)
block|{
case|case
name|AttributeTypeError
case|:
case|case
name|AttributeValueError
case|:
case|case
name|ControlTypeError
case|:
case|case
name|ControlValueError
case|:
case|case
name|ScopeTypeError
case|:
case|case
name|ScopeValueError
case|:
comment|/* the following fails because "type" is defined as "Filing4_type".  Argh!! /*		problem = (int) (((ScopeTypeErrorArgs *) Message)->problem); /*		(void)sprintf(tempbuf,"problem: %s; type: %d", /*				argproblems[problem], /*				((ScopeTypeErrorArgs *) Message)->type); /*		problemstr = tempbuf; /*		break;  */
case|case
name|RangeError
case|:
name|problem
operator|=
call|(
name|int
call|)
argument_list|(
operator|(
operator|(
name|RangeErrorArgs
operator|*
operator|)
name|Message
operator|)
operator|->
name|problem
argument_list|)
expr_stmt|;
name|problemstr
operator|=
name|argproblems
index|[
name|problem
index|]
expr_stmt|;
break|break;
case|case
name|AccessError
case|:
name|problem
operator|=
call|(
name|int
call|)
argument_list|(
operator|(
operator|(
name|AccessErrorArgs
operator|*
operator|)
name|Message
operator|)
operator|->
name|problem
argument_list|)
expr_stmt|;
name|problemstr
operator|=
name|accessproblems
index|[
name|problem
index|]
expr_stmt|;
break|break;
case|case
name|AuthenticationError
case|:
name|problem
operator|=
call|(
name|int
call|)
argument_list|(
operator|(
operator|(
name|AuthenticationErrorArgs
operator|*
operator|)
name|Message
operator|)
operator|->
name|problem
argument_list|)
expr_stmt|;
name|problemstr
operator|=
name|authenticationproblems
index|[
name|problem
index|]
expr_stmt|;
break|break;
case|case
name|ConnectionError
case|:
name|problem
operator|=
call|(
name|int
call|)
argument_list|(
operator|(
operator|(
name|ConnectionErrorArgs
operator|*
operator|)
name|Message
operator|)
operator|->
name|problem
argument_list|)
expr_stmt|;
name|problemstr
operator|=
name|connectionproblems
index|[
name|problem
index|]
expr_stmt|;
break|break;
case|case
name|HandleError
case|:
name|problem
operator|=
call|(
name|int
call|)
argument_list|(
operator|(
operator|(
name|HandleErrorArgs
operator|*
operator|)
name|Message
operator|)
operator|->
name|problem
argument_list|)
expr_stmt|;
name|problemstr
operator|=
name|handleproblems
index|[
name|problem
index|]
expr_stmt|;
break|break;
case|case
name|InsertionError
case|:
name|problem
operator|=
call|(
name|int
call|)
argument_list|(
operator|(
operator|(
name|InsertionErrorArgs
operator|*
operator|)
name|Message
operator|)
operator|->
name|problem
argument_list|)
expr_stmt|;
name|problemstr
operator|=
name|insertionproblems
index|[
name|problem
index|]
expr_stmt|;
break|break;
case|case
name|ServiceError
case|:
name|problem
operator|=
call|(
name|int
call|)
argument_list|(
operator|(
operator|(
name|ServiceErrorArgs
operator|*
operator|)
name|Message
operator|)
operator|->
name|problem
argument_list|)
expr_stmt|;
name|problemstr
operator|=
name|serviceproblems
index|[
name|problem
index|]
expr_stmt|;
break|break;
case|case
name|SessionError
case|:
name|problem
operator|=
call|(
name|int
call|)
argument_list|(
operator|(
operator|(
name|SessionErrorArgs
operator|*
operator|)
name|Message
operator|)
operator|->
name|problem
argument_list|)
expr_stmt|;
name|problemstr
operator|=
name|sessionproblems
index|[
name|problem
index|]
expr_stmt|;
break|break;
case|case
name|SpaceError
case|:
name|problem
operator|=
call|(
name|int
call|)
argument_list|(
operator|(
operator|(
name|SpaceErrorArgs
operator|*
operator|)
name|Message
operator|)
operator|->
name|problem
argument_list|)
expr_stmt|;
name|problemstr
operator|=
name|spaceproblems
index|[
name|problem
index|]
expr_stmt|;
break|break;
case|case
name|TransferError
case|:
name|problem
operator|=
call|(
name|int
call|)
argument_list|(
operator|(
operator|(
name|TransferErrorArgs
operator|*
operator|)
name|Message
operator|)
operator|->
name|problem
argument_list|)
expr_stmt|;
name|problemstr
operator|=
name|transferproblems
index|[
name|problem
index|]
expr_stmt|;
break|break;
case|case
name|UndefinedError
case|:
name|problem
operator|=
call|(
name|int
call|)
argument_list|(
operator|(
operator|(
name|UndefinedErrorArgs
operator|*
operator|)
name|Message
operator|)
operator|->
name|problem
argument_list|)
expr_stmt|;
name|problemstr
operator|=
name|tempbuf
expr_stmt|;
name|sprintf
argument_list|(
name|problemstr
argument_list|,
literal|"number %d"
argument_list|,
name|problem
argument_list|)
expr_stmt|;
break|break;
case|case
name|REJECT_ERROR
case|:
name|msg
operator|=
literal|"Courier REJECT"
expr_stmt|;
name|problem
operator|=
call|(
name|int
call|)
argument_list|(
operator|(
operator|(
name|rejectionDetails
operator|*
operator|)
name|Message
operator|)
operator|->
name|designator
argument_list|)
expr_stmt|;
if|if
condition|(
name|problem
operator|<=
literal|3
condition|)
name|problemstr
operator|=
name|rejectproblem
index|[
name|problem
index|]
expr_stmt|;
else|else
block|{
name|problemstr
operator|=
name|tempbuf
expr_stmt|;
name|sprintf
argument_list|(
name|problemstr
argument_list|,
literal|"unspecifiedError (%d)"
argument_list|,
name|problem
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|PROTOCOL_VIOLATION
case|:
name|problemstr
operator|=
literal|"Courier protocol violation"
expr_stmt|;
break|break;
default|default:
name|problemstr
operator|=
name|tempbuf
expr_stmt|;
name|sprintf
argument_list|(
name|problemstr
argument_list|,
literal|"unexpected error number %d"
argument_list|,
name|Code
argument_list|)
expr_stmt|;
break|break;
block|}
name|printf
argument_list|(
literal|"ERROR: %s, %s\n"
argument_list|,
name|msg
argument_list|,
name|problemstr
argument_list|)
expr_stmt|;
block|}
end_block

end_unit

