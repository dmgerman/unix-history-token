begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*   *      Copyright (c) 1984, 1985, 1986 AT&T  *      All Rights Reserved   *      THIS IS UNPUBLISHED PROPRIETARY SOURCE   *      CODE OF AT&T.  *      The copyright notice above does not   *      evidence any actual or intended  *      publication of such source code.   */
end_comment

begin_comment
comment|/* @(#)utos.c	1.1 */
end_comment

begin_comment
comment|/*  *   UTOS.C  *  *   Programmer:  D. G. Korn  *  *         Date:  May 3, 1982  *  *  *  *   LTOS (SINT, BASE)  *  *        Return a pointer to a string denoting the value of  *        the signed long integer SINT in base BASE.  *  *   UTOS (USINT, BASE)  *  *        Return a pointer to a string denoting the value of  *        the unsigned long integer USINT in base BASE.  *  *  *  *   See Also:  arith(III)  */
end_comment

begin_define
define|#
directive|define
name|BASEMAX
value|(4+16*sizeof(int))
end_define

begin_decl_stmt
specifier|static
name|char
name|hexstr
index|[
name|BASEMAX
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|char
name|hdigits
index|[]
decl_stmt|;
end_decl_stmt

begin_function_decl
name|char
modifier|*
name|utos
parameter_list|()
function_decl|;
end_function_decl

begin_function_decl
name|char
modifier|*
name|ltos
parameter_list|()
function_decl|;
end_function_decl

begin_comment
comment|/*  *   LTOS (SINT, BASE)  *  *        long USINT;  *  *        int BASE;  *  *   Return a pointer to a string denoting the value of SINT   *   in base BASE.  The string will be stored within HEXSTR.  *   It will begin with the base followed by a single '#'.  *   A minus sign will be prepended for negative numbers  *  */
end_comment

begin_function
name|char
modifier|*
name|ltos
parameter_list|(
name|sint
parameter_list|,
name|base
parameter_list|)
name|long
name|sint
decl_stmt|;
name|int
name|base
decl_stmt|;
block|{
specifier|register
name|char
modifier|*
name|sp
decl_stmt|;
specifier|register
name|long
name|l
init|=
operator|(
name|sint
operator|>=
literal|0
condition|?
name|sint
else|:
operator|-
name|sint
operator|)
decl_stmt|;
ifdef|#
directive|ifdef
name|pdp11
name|sp
operator|=
name|utos
argument_list|(
name|l
argument_list|,
name|base
argument_list|)
expr_stmt|;
else|#
directive|else
name|sp
operator|=
name|utos
argument_list|(
operator|(
name|unsigned
name|long
operator|)
name|l
argument_list|,
name|base
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* pdp11 */
if|if
condition|(
name|sint
operator|<
literal|0
condition|)
operator|*
operator|--
name|sp
operator|=
literal|'-'
expr_stmt|;
return|return
operator|(
name|sp
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  *   UTOS (USINT, BASE)  *  *        unsigned USINT;  *  *        int BASE;  *  *   Return a pointer to a string denoting the value of USINT   *   in base BASE.  The string will be stored within HEXSTR.  *   It will begin with the base followed by a single '#'.  *  */
end_comment

begin_function
name|char
modifier|*
name|utos
parameter_list|(
name|usint
parameter_list|,
name|base
parameter_list|)
specifier|register
name|int
name|base
decl_stmt|;
ifdef|#
directive|ifdef
name|pdp11
comment|/* unsigned longs are not supported on pdp11 */
name|long
name|usint
decl_stmt|;
block|{
name|long
name|l
init|=
name|usint
decl_stmt|;
else|#
directive|else
name|unsigned
name|long
name|usint
decl_stmt|;
block|{
specifier|register
name|unsigned
name|long
name|l
init|=
name|usint
decl_stmt|;
endif|#
directive|endif
comment|/* pdp11 */
specifier|register
name|char
modifier|*
name|cp
init|=
name|hexstr
operator|+
operator|(
name|BASEMAX
operator|-
literal|1
operator|)
decl_stmt|;
if|if
condition|(
name|base
operator|<
literal|2
operator|||
name|base
operator|>
name|BASEMAX
condition|)
return|return
operator|(
name|cp
operator|)
return|;
for|for
control|(
operator|*
name|cp
operator|=
literal|0
init|;
name|cp
operator|>
name|hexstr
operator|&&
name|l
condition|;
name|l
operator|/=
name|base
control|)
operator|*
operator|--
name|cp
operator|=
name|hdigits
index|[
operator|(
name|l
operator|%
name|base
operator|)
operator|<<
literal|1
index|]
expr_stmt|;
if|if
condition|(
name|usint
operator|==
literal|0
condition|)
operator|*
operator|--
name|cp
operator|=
literal|'0'
expr_stmt|;
if|if
condition|(
name|base
operator|==
literal|10
condition|)
return|return
operator|(
name|cp
operator|)
return|;
operator|*
operator|--
name|cp
operator|=
literal|'#'
expr_stmt|;
operator|*
operator|--
name|cp
operator|=
name|hdigits
index|[
operator|(
name|base
operator|%
literal|10
operator|)
operator|<<
literal|1
index|]
expr_stmt|;
if|if
condition|(
name|base
operator|/=
literal|10
condition|)
operator|*
operator|--
name|cp
operator|=
name|hdigits
index|[
operator|(
name|base
operator|%
literal|10
operator|)
operator|<<
literal|1
index|]
expr_stmt|;
return|return
operator|(
name|cp
operator|)
return|;
block|}
end_function

end_unit

