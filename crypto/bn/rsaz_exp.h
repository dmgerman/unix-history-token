begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/****************************************************************************** * Copyright(c) 2012, Intel Corp. * Developers and authors: * Shay Gueron (1, 2), and Vlad Krasnov (1) * (1) Intel Corporation, Israel Development Center, Haifa, Israel * (2) University of Haifa, Israel ****************************************************************************** * LICENSE: * This submission to OpenSSL is to be made available under the OpenSSL * license, and only to the OpenSSL project, in order to allow integration * into the publicly distributed code. * The use of this code, or portions of this code, or concepts embedded in * this code, or modification of this code and/or algorithm(s) in it, or the * use of this code for any other purpose than stated above, requires special * licensing. ****************************************************************************** * DISCLAIMER: * THIS SOFTWARE IS PROVIDED BY THE CONTRIBUTORS AND THE COPYRIGHT OWNERS * ``AS IS''. ANY EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR * PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE CONTRIBUTORS OR THE COPYRIGHT * OWNERS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, * OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. ******************************************************************************/
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|RSAZ_EXP_H
end_ifndef

begin_define
define|#
directive|define
name|RSAZ_EXP_H
end_define

begin_undef
undef|#
directive|undef
name|RSAZ_ENABLED
end_undef

begin_if
if|#
directive|if
name|defined
argument_list|(
name|OPENSSL_BN_ASM_MONT
argument_list|)
operator|&&
expr|\
operator|(
name|defined
argument_list|(
name|__x86_64
argument_list|)
operator|||
name|defined
argument_list|(
name|__x86_64__
argument_list|)
operator|||
expr|\
name|defined
argument_list|(
name|_M_AMD64
argument_list|)
operator|||
name|defined
argument_list|(
name|_M_X64
argument_list|)
operator|)
end_if

begin_define
define|#
directive|define
name|RSAZ_ENABLED
end_define

begin_include
include|#
directive|include
file|<openssl/bn.h>
end_include

begin_function_decl
name|void
name|RSAZ_1024_mod_exp_avx2
parameter_list|(
name|BN_ULONG
name|result
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|BN_ULONG
name|base_norm
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|BN_ULONG
name|exponent
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|BN_ULONG
name|m_norm
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|BN_ULONG
name|RR
index|[
literal|16
index|]
parameter_list|,
name|BN_ULONG
name|k0
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|rsaz_avx2_eligible
parameter_list|()
function_decl|;
end_function_decl

begin_function_decl
name|void
name|RSAZ_512_mod_exp
parameter_list|(
name|BN_ULONG
name|result
index|[
literal|8
index|]
parameter_list|,
specifier|const
name|BN_ULONG
name|base_norm
index|[
literal|8
index|]
parameter_list|,
specifier|const
name|BN_ULONG
name|exponent
index|[
literal|8
index|]
parameter_list|,
specifier|const
name|BN_ULONG
name|m_norm
index|[
literal|8
index|]
parameter_list|,
name|BN_ULONG
name|k0
parameter_list|,
specifier|const
name|BN_ULONG
name|RR
index|[
literal|8
index|]
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

end_unit

