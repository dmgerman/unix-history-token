begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* $OpenBSD: smult_curve25519_ref.c,v 1.2 2013/11/02 22:02:14 markus Exp $ */
end_comment

begin_comment
comment|/* version 20081011 Matthew Dempsky Public domain. Derived from public domain code by D. J. Bernstein. */
end_comment

begin_function_decl
name|int
name|crypto_scalarmult_curve25519
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function
specifier|static
name|void
name|add
parameter_list|(
name|unsigned
name|int
name|out
index|[
literal|32
index|]
parameter_list|,
specifier|const
name|unsigned
name|int
name|a
index|[
literal|32
index|]
parameter_list|,
specifier|const
name|unsigned
name|int
name|b
index|[
literal|32
index|]
parameter_list|)
block|{
name|unsigned
name|int
name|j
decl_stmt|;
name|unsigned
name|int
name|u
decl_stmt|;
name|u
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|31
condition|;
operator|++
name|j
control|)
block|{
name|u
operator|+=
name|a
index|[
name|j
index|]
operator|+
name|b
index|[
name|j
index|]
expr_stmt|;
name|out
index|[
name|j
index|]
operator|=
name|u
operator|&
literal|255
expr_stmt|;
name|u
operator|>>=
literal|8
expr_stmt|;
block|}
name|u
operator|+=
name|a
index|[
literal|31
index|]
operator|+
name|b
index|[
literal|31
index|]
expr_stmt|;
name|out
index|[
literal|31
index|]
operator|=
name|u
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|sub
parameter_list|(
name|unsigned
name|int
name|out
index|[
literal|32
index|]
parameter_list|,
specifier|const
name|unsigned
name|int
name|a
index|[
literal|32
index|]
parameter_list|,
specifier|const
name|unsigned
name|int
name|b
index|[
literal|32
index|]
parameter_list|)
block|{
name|unsigned
name|int
name|j
decl_stmt|;
name|unsigned
name|int
name|u
decl_stmt|;
name|u
operator|=
literal|218
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|31
condition|;
operator|++
name|j
control|)
block|{
name|u
operator|+=
name|a
index|[
name|j
index|]
operator|+
literal|65280
operator|-
name|b
index|[
name|j
index|]
expr_stmt|;
name|out
index|[
name|j
index|]
operator|=
name|u
operator|&
literal|255
expr_stmt|;
name|u
operator|>>=
literal|8
expr_stmt|;
block|}
name|u
operator|+=
name|a
index|[
literal|31
index|]
operator|-
name|b
index|[
literal|31
index|]
expr_stmt|;
name|out
index|[
literal|31
index|]
operator|=
name|u
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|squeeze
parameter_list|(
name|unsigned
name|int
name|a
index|[
literal|32
index|]
parameter_list|)
block|{
name|unsigned
name|int
name|j
decl_stmt|;
name|unsigned
name|int
name|u
decl_stmt|;
name|u
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|31
condition|;
operator|++
name|j
control|)
block|{
name|u
operator|+=
name|a
index|[
name|j
index|]
expr_stmt|;
name|a
index|[
name|j
index|]
operator|=
name|u
operator|&
literal|255
expr_stmt|;
name|u
operator|>>=
literal|8
expr_stmt|;
block|}
name|u
operator|+=
name|a
index|[
literal|31
index|]
expr_stmt|;
name|a
index|[
literal|31
index|]
operator|=
name|u
operator|&
literal|127
expr_stmt|;
name|u
operator|=
literal|19
operator|*
operator|(
name|u
operator|>>
literal|7
operator|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|31
condition|;
operator|++
name|j
control|)
block|{
name|u
operator|+=
name|a
index|[
name|j
index|]
expr_stmt|;
name|a
index|[
name|j
index|]
operator|=
name|u
operator|&
literal|255
expr_stmt|;
name|u
operator|>>=
literal|8
expr_stmt|;
block|}
name|u
operator|+=
name|a
index|[
literal|31
index|]
expr_stmt|;
name|a
index|[
literal|31
index|]
operator|=
name|u
expr_stmt|;
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|int
name|minusp
index|[
literal|32
index|]
init|=
block|{
literal|19
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|128
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
name|freeze
parameter_list|(
name|unsigned
name|int
name|a
index|[
literal|32
index|]
parameter_list|)
block|{
name|unsigned
name|int
name|aorig
index|[
literal|32
index|]
decl_stmt|;
name|unsigned
name|int
name|j
decl_stmt|;
name|unsigned
name|int
name|negative
decl_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|32
condition|;
operator|++
name|j
control|)
name|aorig
index|[
name|j
index|]
operator|=
name|a
index|[
name|j
index|]
expr_stmt|;
name|add
argument_list|(
name|a
argument_list|,
name|a
argument_list|,
name|minusp
argument_list|)
expr_stmt|;
name|negative
operator|=
operator|-
operator|(
operator|(
name|a
index|[
literal|31
index|]
operator|>>
literal|7
operator|)
operator|&
literal|1
operator|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|32
condition|;
operator|++
name|j
control|)
name|a
index|[
name|j
index|]
operator|^=
name|negative
operator|&
operator|(
name|aorig
index|[
name|j
index|]
operator|^
name|a
index|[
name|j
index|]
operator|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|mult
parameter_list|(
name|unsigned
name|int
name|out
index|[
literal|32
index|]
parameter_list|,
specifier|const
name|unsigned
name|int
name|a
index|[
literal|32
index|]
parameter_list|,
specifier|const
name|unsigned
name|int
name|b
index|[
literal|32
index|]
parameter_list|)
block|{
name|unsigned
name|int
name|i
decl_stmt|;
name|unsigned
name|int
name|j
decl_stmt|;
name|unsigned
name|int
name|u
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|32
condition|;
operator|++
name|i
control|)
block|{
name|u
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<=
name|i
condition|;
operator|++
name|j
control|)
name|u
operator|+=
name|a
index|[
name|j
index|]
operator|*
name|b
index|[
name|i
operator|-
name|j
index|]
expr_stmt|;
for|for
control|(
name|j
operator|=
name|i
operator|+
literal|1
init|;
name|j
operator|<
literal|32
condition|;
operator|++
name|j
control|)
name|u
operator|+=
literal|38
operator|*
name|a
index|[
name|j
index|]
operator|*
name|b
index|[
name|i
operator|+
literal|32
operator|-
name|j
index|]
expr_stmt|;
name|out
index|[
name|i
index|]
operator|=
name|u
expr_stmt|;
block|}
name|squeeze
argument_list|(
name|out
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|mult121665
parameter_list|(
name|unsigned
name|int
name|out
index|[
literal|32
index|]
parameter_list|,
specifier|const
name|unsigned
name|int
name|a
index|[
literal|32
index|]
parameter_list|)
block|{
name|unsigned
name|int
name|j
decl_stmt|;
name|unsigned
name|int
name|u
decl_stmt|;
name|u
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|31
condition|;
operator|++
name|j
control|)
block|{
name|u
operator|+=
literal|121665
operator|*
name|a
index|[
name|j
index|]
expr_stmt|;
name|out
index|[
name|j
index|]
operator|=
name|u
operator|&
literal|255
expr_stmt|;
name|u
operator|>>=
literal|8
expr_stmt|;
block|}
name|u
operator|+=
literal|121665
operator|*
name|a
index|[
literal|31
index|]
expr_stmt|;
name|out
index|[
literal|31
index|]
operator|=
name|u
operator|&
literal|127
expr_stmt|;
name|u
operator|=
literal|19
operator|*
operator|(
name|u
operator|>>
literal|7
operator|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|31
condition|;
operator|++
name|j
control|)
block|{
name|u
operator|+=
name|out
index|[
name|j
index|]
expr_stmt|;
name|out
index|[
name|j
index|]
operator|=
name|u
operator|&
literal|255
expr_stmt|;
name|u
operator|>>=
literal|8
expr_stmt|;
block|}
name|u
operator|+=
name|out
index|[
name|j
index|]
expr_stmt|;
name|out
index|[
name|j
index|]
operator|=
name|u
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|square
parameter_list|(
name|unsigned
name|int
name|out
index|[
literal|32
index|]
parameter_list|,
specifier|const
name|unsigned
name|int
name|a
index|[
literal|32
index|]
parameter_list|)
block|{
name|unsigned
name|int
name|i
decl_stmt|;
name|unsigned
name|int
name|j
decl_stmt|;
name|unsigned
name|int
name|u
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|32
condition|;
operator|++
name|i
control|)
block|{
name|u
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|i
operator|-
name|j
condition|;
operator|++
name|j
control|)
name|u
operator|+=
name|a
index|[
name|j
index|]
operator|*
name|a
index|[
name|i
operator|-
name|j
index|]
expr_stmt|;
for|for
control|(
name|j
operator|=
name|i
operator|+
literal|1
init|;
name|j
operator|<
name|i
operator|+
literal|32
operator|-
name|j
condition|;
operator|++
name|j
control|)
name|u
operator|+=
literal|38
operator|*
name|a
index|[
name|j
index|]
operator|*
name|a
index|[
name|i
operator|+
literal|32
operator|-
name|j
index|]
expr_stmt|;
name|u
operator|*=
literal|2
expr_stmt|;
if|if
condition|(
operator|(
name|i
operator|&
literal|1
operator|)
operator|==
literal|0
condition|)
block|{
name|u
operator|+=
name|a
index|[
name|i
operator|/
literal|2
index|]
operator|*
name|a
index|[
name|i
operator|/
literal|2
index|]
expr_stmt|;
name|u
operator|+=
literal|38
operator|*
name|a
index|[
name|i
operator|/
literal|2
operator|+
literal|16
index|]
operator|*
name|a
index|[
name|i
operator|/
literal|2
operator|+
literal|16
index|]
expr_stmt|;
block|}
name|out
index|[
name|i
index|]
operator|=
name|u
expr_stmt|;
block|}
name|squeeze
argument_list|(
name|out
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|select
parameter_list|(
name|unsigned
name|int
name|p
index|[
literal|64
index|]
parameter_list|,
name|unsigned
name|int
name|q
index|[
literal|64
index|]
parameter_list|,
specifier|const
name|unsigned
name|int
name|r
index|[
literal|64
index|]
parameter_list|,
specifier|const
name|unsigned
name|int
name|s
index|[
literal|64
index|]
parameter_list|,
name|unsigned
name|int
name|b
parameter_list|)
block|{
name|unsigned
name|int
name|j
decl_stmt|;
name|unsigned
name|int
name|t
decl_stmt|;
name|unsigned
name|int
name|bminus1
decl_stmt|;
name|bminus1
operator|=
name|b
operator|-
literal|1
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|64
condition|;
operator|++
name|j
control|)
block|{
name|t
operator|=
name|bminus1
operator|&
operator|(
name|r
index|[
name|j
index|]
operator|^
name|s
index|[
name|j
index|]
operator|)
expr_stmt|;
name|p
index|[
name|j
index|]
operator|=
name|s
index|[
name|j
index|]
operator|^
name|t
expr_stmt|;
name|q
index|[
name|j
index|]
operator|=
name|r
index|[
name|j
index|]
operator|^
name|t
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|mainloop
parameter_list|(
name|unsigned
name|int
name|work
index|[
literal|64
index|]
parameter_list|,
specifier|const
name|unsigned
name|char
name|e
index|[
literal|32
index|]
parameter_list|)
block|{
name|unsigned
name|int
name|xzm1
index|[
literal|64
index|]
decl_stmt|;
name|unsigned
name|int
name|xzm
index|[
literal|64
index|]
decl_stmt|;
name|unsigned
name|int
name|xzmb
index|[
literal|64
index|]
decl_stmt|;
name|unsigned
name|int
name|xzm1b
index|[
literal|64
index|]
decl_stmt|;
name|unsigned
name|int
name|xznb
index|[
literal|64
index|]
decl_stmt|;
name|unsigned
name|int
name|xzn1b
index|[
literal|64
index|]
decl_stmt|;
name|unsigned
name|int
name|a0
index|[
literal|64
index|]
decl_stmt|;
name|unsigned
name|int
name|a1
index|[
literal|64
index|]
decl_stmt|;
name|unsigned
name|int
name|b0
index|[
literal|64
index|]
decl_stmt|;
name|unsigned
name|int
name|b1
index|[
literal|64
index|]
decl_stmt|;
name|unsigned
name|int
name|c1
index|[
literal|64
index|]
decl_stmt|;
name|unsigned
name|int
name|r
index|[
literal|32
index|]
decl_stmt|;
name|unsigned
name|int
name|s
index|[
literal|32
index|]
decl_stmt|;
name|unsigned
name|int
name|t
index|[
literal|32
index|]
decl_stmt|;
name|unsigned
name|int
name|u
index|[
literal|32
index|]
decl_stmt|;
name|unsigned
name|int
name|j
decl_stmt|;
name|unsigned
name|int
name|b
decl_stmt|;
name|int
name|pos
decl_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|32
condition|;
operator|++
name|j
control|)
name|xzm1
index|[
name|j
index|]
operator|=
name|work
index|[
name|j
index|]
expr_stmt|;
name|xzm1
index|[
literal|32
index|]
operator|=
literal|1
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|33
init|;
name|j
operator|<
literal|64
condition|;
operator|++
name|j
control|)
name|xzm1
index|[
name|j
index|]
operator|=
literal|0
expr_stmt|;
name|xzm
index|[
literal|0
index|]
operator|=
literal|1
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|1
init|;
name|j
operator|<
literal|64
condition|;
operator|++
name|j
control|)
name|xzm
index|[
name|j
index|]
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|pos
operator|=
literal|254
init|;
name|pos
operator|>=
literal|0
condition|;
operator|--
name|pos
control|)
block|{
name|b
operator|=
name|e
index|[
name|pos
operator|/
literal|8
index|]
operator|>>
operator|(
name|pos
operator|&
literal|7
operator|)
expr_stmt|;
name|b
operator|&=
literal|1
expr_stmt|;
name|select
argument_list|(
name|xzmb
argument_list|,
name|xzm1b
argument_list|,
name|xzm
argument_list|,
name|xzm1
argument_list|,
name|b
argument_list|)
expr_stmt|;
name|add
argument_list|(
name|a0
argument_list|,
name|xzmb
argument_list|,
name|xzmb
operator|+
literal|32
argument_list|)
expr_stmt|;
name|sub
argument_list|(
name|a0
operator|+
literal|32
argument_list|,
name|xzmb
argument_list|,
name|xzmb
operator|+
literal|32
argument_list|)
expr_stmt|;
name|add
argument_list|(
name|a1
argument_list|,
name|xzm1b
argument_list|,
name|xzm1b
operator|+
literal|32
argument_list|)
expr_stmt|;
name|sub
argument_list|(
name|a1
operator|+
literal|32
argument_list|,
name|xzm1b
argument_list|,
name|xzm1b
operator|+
literal|32
argument_list|)
expr_stmt|;
name|square
argument_list|(
name|b0
argument_list|,
name|a0
argument_list|)
expr_stmt|;
name|square
argument_list|(
name|b0
operator|+
literal|32
argument_list|,
name|a0
operator|+
literal|32
argument_list|)
expr_stmt|;
name|mult
argument_list|(
name|b1
argument_list|,
name|a1
argument_list|,
name|a0
operator|+
literal|32
argument_list|)
expr_stmt|;
name|mult
argument_list|(
name|b1
operator|+
literal|32
argument_list|,
name|a1
operator|+
literal|32
argument_list|,
name|a0
argument_list|)
expr_stmt|;
name|add
argument_list|(
name|c1
argument_list|,
name|b1
argument_list|,
name|b1
operator|+
literal|32
argument_list|)
expr_stmt|;
name|sub
argument_list|(
name|c1
operator|+
literal|32
argument_list|,
name|b1
argument_list|,
name|b1
operator|+
literal|32
argument_list|)
expr_stmt|;
name|square
argument_list|(
name|r
argument_list|,
name|c1
operator|+
literal|32
argument_list|)
expr_stmt|;
name|sub
argument_list|(
name|s
argument_list|,
name|b0
argument_list|,
name|b0
operator|+
literal|32
argument_list|)
expr_stmt|;
name|mult121665
argument_list|(
name|t
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|add
argument_list|(
name|u
argument_list|,
name|t
argument_list|,
name|b0
argument_list|)
expr_stmt|;
name|mult
argument_list|(
name|xznb
argument_list|,
name|b0
argument_list|,
name|b0
operator|+
literal|32
argument_list|)
expr_stmt|;
name|mult
argument_list|(
name|xznb
operator|+
literal|32
argument_list|,
name|s
argument_list|,
name|u
argument_list|)
expr_stmt|;
name|square
argument_list|(
name|xzn1b
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mult
argument_list|(
name|xzn1b
operator|+
literal|32
argument_list|,
name|r
argument_list|,
name|work
argument_list|)
expr_stmt|;
name|select
argument_list|(
name|xzm
argument_list|,
name|xzm1
argument_list|,
name|xznb
argument_list|,
name|xzn1b
argument_list|,
name|b
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|64
condition|;
operator|++
name|j
control|)
name|work
index|[
name|j
index|]
operator|=
name|xzm
index|[
name|j
index|]
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|recip
parameter_list|(
name|unsigned
name|int
name|out
index|[
literal|32
index|]
parameter_list|,
specifier|const
name|unsigned
name|int
name|z
index|[
literal|32
index|]
parameter_list|)
block|{
name|unsigned
name|int
name|z2
index|[
literal|32
index|]
decl_stmt|;
name|unsigned
name|int
name|z9
index|[
literal|32
index|]
decl_stmt|;
name|unsigned
name|int
name|z11
index|[
literal|32
index|]
decl_stmt|;
name|unsigned
name|int
name|z2_5_0
index|[
literal|32
index|]
decl_stmt|;
name|unsigned
name|int
name|z2_10_0
index|[
literal|32
index|]
decl_stmt|;
name|unsigned
name|int
name|z2_20_0
index|[
literal|32
index|]
decl_stmt|;
name|unsigned
name|int
name|z2_50_0
index|[
literal|32
index|]
decl_stmt|;
name|unsigned
name|int
name|z2_100_0
index|[
literal|32
index|]
decl_stmt|;
name|unsigned
name|int
name|t0
index|[
literal|32
index|]
decl_stmt|;
name|unsigned
name|int
name|t1
index|[
literal|32
index|]
decl_stmt|;
name|int
name|i
decl_stmt|;
comment|/* 2 */
name|square
argument_list|(
name|z2
argument_list|,
name|z
argument_list|)
expr_stmt|;
comment|/* 4 */
name|square
argument_list|(
name|t1
argument_list|,
name|z2
argument_list|)
expr_stmt|;
comment|/* 8 */
name|square
argument_list|(
name|t0
argument_list|,
name|t1
argument_list|)
expr_stmt|;
comment|/* 9 */
name|mult
argument_list|(
name|z9
argument_list|,
name|t0
argument_list|,
name|z
argument_list|)
expr_stmt|;
comment|/* 11 */
name|mult
argument_list|(
name|z11
argument_list|,
name|z9
argument_list|,
name|z2
argument_list|)
expr_stmt|;
comment|/* 22 */
name|square
argument_list|(
name|t0
argument_list|,
name|z11
argument_list|)
expr_stmt|;
comment|/* 2^5 - 2^0 = 31 */
name|mult
argument_list|(
name|z2_5_0
argument_list|,
name|t0
argument_list|,
name|z9
argument_list|)
expr_stmt|;
comment|/* 2^6 - 2^1 */
name|square
argument_list|(
name|t0
argument_list|,
name|z2_5_0
argument_list|)
expr_stmt|;
comment|/* 2^7 - 2^2 */
name|square
argument_list|(
name|t1
argument_list|,
name|t0
argument_list|)
expr_stmt|;
comment|/* 2^8 - 2^3 */
name|square
argument_list|(
name|t0
argument_list|,
name|t1
argument_list|)
expr_stmt|;
comment|/* 2^9 - 2^4 */
name|square
argument_list|(
name|t1
argument_list|,
name|t0
argument_list|)
expr_stmt|;
comment|/* 2^10 - 2^5 */
name|square
argument_list|(
name|t0
argument_list|,
name|t1
argument_list|)
expr_stmt|;
comment|/* 2^10 - 2^0 */
name|mult
argument_list|(
name|z2_10_0
argument_list|,
name|t0
argument_list|,
name|z2_5_0
argument_list|)
expr_stmt|;
comment|/* 2^11 - 2^1 */
name|square
argument_list|(
name|t0
argument_list|,
name|z2_10_0
argument_list|)
expr_stmt|;
comment|/* 2^12 - 2^2 */
name|square
argument_list|(
name|t1
argument_list|,
name|t0
argument_list|)
expr_stmt|;
comment|/* 2^20 - 2^10 */
for|for
control|(
name|i
operator|=
literal|2
init|;
name|i
operator|<
literal|10
condition|;
name|i
operator|+=
literal|2
control|)
block|{
name|square
argument_list|(
name|t0
argument_list|,
name|t1
argument_list|)
expr_stmt|;
name|square
argument_list|(
name|t1
argument_list|,
name|t0
argument_list|)
expr_stmt|;
block|}
comment|/* 2^20 - 2^0 */
name|mult
argument_list|(
name|z2_20_0
argument_list|,
name|t1
argument_list|,
name|z2_10_0
argument_list|)
expr_stmt|;
comment|/* 2^21 - 2^1 */
name|square
argument_list|(
name|t0
argument_list|,
name|z2_20_0
argument_list|)
expr_stmt|;
comment|/* 2^22 - 2^2 */
name|square
argument_list|(
name|t1
argument_list|,
name|t0
argument_list|)
expr_stmt|;
comment|/* 2^40 - 2^20 */
for|for
control|(
name|i
operator|=
literal|2
init|;
name|i
operator|<
literal|20
condition|;
name|i
operator|+=
literal|2
control|)
block|{
name|square
argument_list|(
name|t0
argument_list|,
name|t1
argument_list|)
expr_stmt|;
name|square
argument_list|(
name|t1
argument_list|,
name|t0
argument_list|)
expr_stmt|;
block|}
comment|/* 2^40 - 2^0 */
name|mult
argument_list|(
name|t0
argument_list|,
name|t1
argument_list|,
name|z2_20_0
argument_list|)
expr_stmt|;
comment|/* 2^41 - 2^1 */
name|square
argument_list|(
name|t1
argument_list|,
name|t0
argument_list|)
expr_stmt|;
comment|/* 2^42 - 2^2 */
name|square
argument_list|(
name|t0
argument_list|,
name|t1
argument_list|)
expr_stmt|;
comment|/* 2^50 - 2^10 */
for|for
control|(
name|i
operator|=
literal|2
init|;
name|i
operator|<
literal|10
condition|;
name|i
operator|+=
literal|2
control|)
block|{
name|square
argument_list|(
name|t1
argument_list|,
name|t0
argument_list|)
expr_stmt|;
name|square
argument_list|(
name|t0
argument_list|,
name|t1
argument_list|)
expr_stmt|;
block|}
comment|/* 2^50 - 2^0 */
name|mult
argument_list|(
name|z2_50_0
argument_list|,
name|t0
argument_list|,
name|z2_10_0
argument_list|)
expr_stmt|;
comment|/* 2^51 - 2^1 */
name|square
argument_list|(
name|t0
argument_list|,
name|z2_50_0
argument_list|)
expr_stmt|;
comment|/* 2^52 - 2^2 */
name|square
argument_list|(
name|t1
argument_list|,
name|t0
argument_list|)
expr_stmt|;
comment|/* 2^100 - 2^50 */
for|for
control|(
name|i
operator|=
literal|2
init|;
name|i
operator|<
literal|50
condition|;
name|i
operator|+=
literal|2
control|)
block|{
name|square
argument_list|(
name|t0
argument_list|,
name|t1
argument_list|)
expr_stmt|;
name|square
argument_list|(
name|t1
argument_list|,
name|t0
argument_list|)
expr_stmt|;
block|}
comment|/* 2^100 - 2^0 */
name|mult
argument_list|(
name|z2_100_0
argument_list|,
name|t1
argument_list|,
name|z2_50_0
argument_list|)
expr_stmt|;
comment|/* 2^101 - 2^1 */
name|square
argument_list|(
name|t1
argument_list|,
name|z2_100_0
argument_list|)
expr_stmt|;
comment|/* 2^102 - 2^2 */
name|square
argument_list|(
name|t0
argument_list|,
name|t1
argument_list|)
expr_stmt|;
comment|/* 2^200 - 2^100 */
for|for
control|(
name|i
operator|=
literal|2
init|;
name|i
operator|<
literal|100
condition|;
name|i
operator|+=
literal|2
control|)
block|{
name|square
argument_list|(
name|t1
argument_list|,
name|t0
argument_list|)
expr_stmt|;
name|square
argument_list|(
name|t0
argument_list|,
name|t1
argument_list|)
expr_stmt|;
block|}
comment|/* 2^200 - 2^0 */
name|mult
argument_list|(
name|t1
argument_list|,
name|t0
argument_list|,
name|z2_100_0
argument_list|)
expr_stmt|;
comment|/* 2^201 - 2^1 */
name|square
argument_list|(
name|t0
argument_list|,
name|t1
argument_list|)
expr_stmt|;
comment|/* 2^202 - 2^2 */
name|square
argument_list|(
name|t1
argument_list|,
name|t0
argument_list|)
expr_stmt|;
comment|/* 2^250 - 2^50 */
for|for
control|(
name|i
operator|=
literal|2
init|;
name|i
operator|<
literal|50
condition|;
name|i
operator|+=
literal|2
control|)
block|{
name|square
argument_list|(
name|t0
argument_list|,
name|t1
argument_list|)
expr_stmt|;
name|square
argument_list|(
name|t1
argument_list|,
name|t0
argument_list|)
expr_stmt|;
block|}
comment|/* 2^250 - 2^0 */
name|mult
argument_list|(
name|t0
argument_list|,
name|t1
argument_list|,
name|z2_50_0
argument_list|)
expr_stmt|;
comment|/* 2^251 - 2^1 */
name|square
argument_list|(
name|t1
argument_list|,
name|t0
argument_list|)
expr_stmt|;
comment|/* 2^252 - 2^2 */
name|square
argument_list|(
name|t0
argument_list|,
name|t1
argument_list|)
expr_stmt|;
comment|/* 2^253 - 2^3 */
name|square
argument_list|(
name|t1
argument_list|,
name|t0
argument_list|)
expr_stmt|;
comment|/* 2^254 - 2^4 */
name|square
argument_list|(
name|t0
argument_list|,
name|t1
argument_list|)
expr_stmt|;
comment|/* 2^255 - 2^5 */
name|square
argument_list|(
name|t1
argument_list|,
name|t0
argument_list|)
expr_stmt|;
comment|/* 2^255 - 21 */
name|mult
argument_list|(
name|out
argument_list|,
name|t1
argument_list|,
name|z11
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|int
name|crypto_scalarmult_curve25519
parameter_list|(
name|unsigned
name|char
modifier|*
name|q
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|n
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|p
parameter_list|)
block|{
name|unsigned
name|int
name|work
index|[
literal|96
index|]
decl_stmt|;
name|unsigned
name|char
name|e
index|[
literal|32
index|]
decl_stmt|;
name|unsigned
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|32
condition|;
operator|++
name|i
control|)
name|e
index|[
name|i
index|]
operator|=
name|n
index|[
name|i
index|]
expr_stmt|;
name|e
index|[
literal|0
index|]
operator|&=
literal|248
expr_stmt|;
name|e
index|[
literal|31
index|]
operator|&=
literal|127
expr_stmt|;
name|e
index|[
literal|31
index|]
operator||=
literal|64
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|32
condition|;
operator|++
name|i
control|)
name|work
index|[
name|i
index|]
operator|=
name|p
index|[
name|i
index|]
expr_stmt|;
name|mainloop
argument_list|(
name|work
argument_list|,
name|e
argument_list|)
expr_stmt|;
name|recip
argument_list|(
name|work
operator|+
literal|32
argument_list|,
name|work
operator|+
literal|32
argument_list|)
expr_stmt|;
name|mult
argument_list|(
name|work
operator|+
literal|64
argument_list|,
name|work
argument_list|,
name|work
operator|+
literal|32
argument_list|)
expr_stmt|;
name|freeze
argument_list|(
name|work
operator|+
literal|64
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|32
condition|;
operator|++
name|i
control|)
name|q
index|[
name|i
index|]
operator|=
name|work
index|[
literal|64
operator|+
name|i
index|]
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

end_unit

