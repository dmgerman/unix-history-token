begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* $OpenBSD: packet.h,v 1.76 2017/02/03 23:03:33 djm Exp $ */
end_comment

begin_comment
comment|/*  * Author: Tatu Ylonen<ylo@cs.hut.fi>  * Copyright (c) 1995 Tatu Ylonen<ylo@cs.hut.fi>, Espoo, Finland  *                    All rights reserved  * Interface for the packet protocol functions.  *  * As far as I am concerned, the code I have written for this software  * can be used freely for any purpose.  Any derived versions of this  * software must be clearly marked as such, and if the derived work is  * incompatible with the protocol description in the RFC file, it must be  * called by a name other than "ssh" or "Secure Shell".  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|PACKET_H
end_ifndef

begin_define
define|#
directive|define
name|PACKET_H
end_define

begin_include
include|#
directive|include
file|<termios.h>
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|WITH_OPENSSL
end_ifdef

begin_include
include|#
directive|include
file|<openssl/bn.h>
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|OPENSSL_HAS_ECC
end_ifdef

begin_include
include|#
directive|include
file|<openssl/ec.h>
end_include

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* OPENSSL_HAS_ECC */
end_comment

begin_define
define|#
directive|define
name|EC_KEY
value|void
end_define

begin_define
define|#
directive|define
name|EC_GROUP
value|void
end_define

begin_define
define|#
directive|define
name|EC_POINT
value|void
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* OPENSSL_HAS_ECC */
end_comment

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* WITH_OPENSSL */
end_comment

begin_define
define|#
directive|define
name|BIGNUM
value|void
end_define

begin_define
define|#
directive|define
name|EC_KEY
value|void
end_define

begin_define
define|#
directive|define
name|EC_GROUP
value|void
end_define

begin_define
define|#
directive|define
name|EC_POINT
value|void
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* WITH_OPENSSL */
end_comment

begin_include
include|#
directive|include
file|<signal.h>
end_include

begin_include
include|#
directive|include
file|"openbsd-compat/sys-queue.h"
end_include

begin_struct_decl
struct_decl|struct
name|kex
struct_decl|;
end_struct_decl

begin_struct_decl
struct_decl|struct
name|sshkey
struct_decl|;
end_struct_decl

begin_struct_decl
struct_decl|struct
name|sshbuf
struct_decl|;
end_struct_decl

begin_struct_decl
struct_decl|struct
name|session_state
struct_decl|;
end_struct_decl

begin_comment
comment|/* private session data */
end_comment

begin_include
include|#
directive|include
file|"dispatch.h"
end_include

begin_comment
comment|/* typedef, DISPATCH_MAX */
end_comment

begin_struct
struct|struct
name|key_entry
block|{
name|TAILQ_ENTRY
argument_list|(
argument|key_entry
argument_list|)
name|next
expr_stmt|;
name|struct
name|sshkey
modifier|*
name|key
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|ssh
block|{
comment|/* Session state */
name|struct
name|session_state
modifier|*
name|state
decl_stmt|;
comment|/* Key exchange */
name|struct
name|kex
modifier|*
name|kex
decl_stmt|;
comment|/* cached local and remote ip addresses and ports */
name|char
modifier|*
name|remote_ipaddr
decl_stmt|;
name|int
name|remote_port
decl_stmt|;
name|char
modifier|*
name|local_ipaddr
decl_stmt|;
name|int
name|local_port
decl_stmt|;
comment|/* Optional preamble for log messages (e.g. username) */
name|char
modifier|*
name|log_preamble
decl_stmt|;
comment|/* Dispatcher table */
name|dispatch_fn
modifier|*
name|dispatch
index|[
name|DISPATCH_MAX
index|]
decl_stmt|;
comment|/* number of packets to ignore in the dispatcher */
name|int
name|dispatch_skip_packets
decl_stmt|;
comment|/* datafellows */
name|int
name|compat
decl_stmt|;
comment|/* Lists for private and public keys */
name|TAILQ_HEAD
argument_list|(
argument_list|,
argument|key_entry
argument_list|)
name|private_keys
expr_stmt|;
name|TAILQ_HEAD
argument_list|(
argument_list|,
argument|key_entry
argument_list|)
name|public_keys
expr_stmt|;
comment|/* APP data */
name|void
modifier|*
name|app_data
decl_stmt|;
block|}
struct|;
end_struct

begin_typedef
typedef|typedef
name|int
function_decl|(
name|ssh_packet_hook_fn
function_decl|)
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|struct
name|sshbuf
modifier|*
parameter_list|,
name|u_char
modifier|*
parameter_list|,
name|void
modifier|*
parameter_list|)
function_decl|;
end_typedef

begin_function_decl
name|struct
name|ssh
modifier|*
name|ssh_alloc_session_state
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|ssh
modifier|*
name|ssh_packet_set_connection
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ssh_packet_set_timeout
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_stop_discard
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_connection_af
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ssh_packet_set_nonblocking
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_get_connection_in
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_get_connection_out
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ssh_packet_close
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ssh_packet_set_encryption_key
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
specifier|const
name|u_char
modifier|*
parameter_list|,
name|u_int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ssh_packet_set_input_hook
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|ssh_packet_hook_fn
modifier|*
parameter_list|,
name|void
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_is_rekeying
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ssh_packet_set_protocol_flags
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|u_int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|u_int
name|ssh_packet_get_protocol_flags
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_start_compression
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ssh_packet_set_tos
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ssh_packet_set_interactive
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_is_interactive
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ssh_packet_set_server
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ssh_packet_set_authenticated
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ssh_packet_set_mux
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_get_mux
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_set_log_preamble
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
modifier|...
parameter_list|)
function_decl|__attribute__
parameter_list|(
function_decl|(format
parameter_list|(
name|printf
parameter_list|,
function_decl|2
operator|,
function_decl|3
end_function_decl

begin_empty_stmt
unit|)))
empty_stmt|;
end_empty_stmt

begin_function_decl
name|int
name|ssh_packet_log_type
parameter_list|(
name|u_char
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_send1
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_send2_wrapped
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_send2
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_read
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_read_expect
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|u_int
name|type
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_read_poll
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_read_poll1
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|u_char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_read_poll2
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|u_char
modifier|*
parameter_list|,
name|u_int32_t
modifier|*
name|seqnr_p
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_process_incoming
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
name|buf
parameter_list|,
name|u_int
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_read_seqnr
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|u_char
modifier|*
parameter_list|,
name|u_int32_t
modifier|*
name|seqnr_p
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_read_poll_seqnr
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|u_char
modifier|*
parameter_list|,
name|u_int32_t
modifier|*
name|seqnr_p
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|const
name|void
modifier|*
name|ssh_packet_get_string_ptr
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|u_int
modifier|*
name|length_ptr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ssh_packet_disconnect
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
name|fmt
parameter_list|,
modifier|...
parameter_list|)
function_decl|__attribute__
parameter_list|(
function_decl|(format
parameter_list|(
name|printf
parameter_list|,
function_decl|2
operator|,
function_decl|3
end_function_decl

begin_expr_stmt
unit|)))
name|__attribute__
argument_list|(
operator|(
name|noreturn
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function_decl
name|void
name|ssh_packet_send_debug
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
name|fmt
parameter_list|,
modifier|...
parameter_list|)
function_decl|__attribute__
parameter_list|(
function_decl|(format
parameter_list|(
name|printf
parameter_list|,
function_decl|2
operator|,
function_decl|3
end_function_decl

begin_empty_stmt
unit|)))
empty_stmt|;
end_empty_stmt

begin_function_decl
name|int
name|ssh_set_newkeys
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|int
name|mode
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ssh_packet_get_bytes
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|u_int64_t
modifier|*
parameter_list|,
name|u_int64_t
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_write_poll
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_write_wait
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_have_data_to_write
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_not_very_much_data_to_write
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_connection_is_on_socket
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_remaining
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ssh_packet_send_ignore
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|tty_make_modes
parameter_list|(
name|int
parameter_list|,
name|struct
name|termios
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|tty_parse_modes
parameter_list|(
name|int
parameter_list|,
name|int
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ssh_packet_set_alive_timeouts
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_inc_alive_timeouts
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_set_maxsize
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|u_int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|u_int
name|ssh_packet_get_maxsize
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_get_state
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|struct
name|sshbuf
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_packet_set_state
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|struct
name|sshbuf
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|const
name|char
modifier|*
name|ssh_remote_ipaddr
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_remote_port
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|const
name|char
modifier|*
name|ssh_local_ipaddr
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ssh_local_port
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ssh_packet_set_rekey_limits
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|u_int64_t
parameter_list|,
name|u_int32_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|time_t
name|ssh_packet_get_rekey_timeout
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
modifier|*
name|ssh_packet_get_input
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
modifier|*
name|ssh_packet_get_output
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* new API */
end_comment

begin_function_decl
name|int
name|sshpkt_start
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
name|u_char
name|type
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_send
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_disconnect
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
name|fmt
parameter_list|,
modifier|...
parameter_list|)
function_decl|__attribute__
parameter_list|(
function_decl|(format
parameter_list|(
name|printf
parameter_list|,
function_decl|2
operator|,
function_decl|3
end_function_decl

begin_empty_stmt
unit|)))
empty_stmt|;
end_empty_stmt

begin_function_decl
name|int
name|sshpkt_add_padding
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|u_char
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|sshpkt_fatal
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
specifier|const
name|char
modifier|*
name|tag
parameter_list|,
name|int
name|r
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_put
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
specifier|const
name|void
modifier|*
name|v
parameter_list|,
name|size_t
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_putb
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
specifier|const
name|struct
name|sshbuf
modifier|*
name|b
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_put_u8
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
name|u_char
name|val
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_put_u32
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
name|u_int32_t
name|val
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_put_u64
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
name|u_int64_t
name|val
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_put_string
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
specifier|const
name|void
modifier|*
name|v
parameter_list|,
name|size_t
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_put_cstring
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
specifier|const
name|void
modifier|*
name|v
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_put_stringb
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
specifier|const
name|struct
name|sshbuf
modifier|*
name|v
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_put_ec
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
specifier|const
name|EC_POINT
modifier|*
name|v
parameter_list|,
specifier|const
name|EC_GROUP
modifier|*
name|g
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_put_bignum1
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
specifier|const
name|BIGNUM
modifier|*
name|v
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_put_bignum2
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
specifier|const
name|BIGNUM
modifier|*
name|v
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_get
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
name|void
modifier|*
name|valp
parameter_list|,
name|size_t
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_get_u8
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
name|u_char
modifier|*
name|valp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_get_u32
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
name|u_int32_t
modifier|*
name|valp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_get_u64
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
name|u_int64_t
modifier|*
name|valp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_get_string
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
name|u_char
modifier|*
modifier|*
name|valp
parameter_list|,
name|size_t
modifier|*
name|lenp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_get_string_direct
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
specifier|const
name|u_char
modifier|*
modifier|*
name|valp
parameter_list|,
name|size_t
modifier|*
name|lenp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_get_cstring
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
name|char
modifier|*
modifier|*
name|valp
parameter_list|,
name|size_t
modifier|*
name|lenp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_get_ec
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
name|EC_POINT
modifier|*
name|v
parameter_list|,
specifier|const
name|EC_GROUP
modifier|*
name|g
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_get_bignum1
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
name|BIGNUM
modifier|*
name|v
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_get_bignum2
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|,
name|BIGNUM
modifier|*
name|v
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sshpkt_get_end
parameter_list|(
name|struct
name|ssh
modifier|*
name|ssh
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|const
name|u_char
modifier|*
name|sshpkt_ptr
parameter_list|(
name|struct
name|ssh
modifier|*
parameter_list|,
name|size_t
modifier|*
name|lenp
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* OLD API */
end_comment

begin_decl_stmt
specifier|extern
name|struct
name|ssh
modifier|*
name|active_state
decl_stmt|;
end_decl_stmt

begin_include
include|#
directive|include
file|"opacket.h"
end_include

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|WITH_OPENSSL
argument_list|)
end_if

begin_undef
undef|#
directive|undef
name|BIGNUM
end_undef

begin_undef
undef|#
directive|undef
name|EC_KEY
end_undef

begin_undef
undef|#
directive|undef
name|EC_GROUP
end_undef

begin_undef
undef|#
directive|undef
name|EC_POINT
end_undef

begin_elif
elif|#
directive|elif
operator|!
name|defined
argument_list|(
name|OPENSSL_HAS_ECC
argument_list|)
end_elif

begin_undef
undef|#
directive|undef
name|EC_KEY
end_undef

begin_undef
undef|#
directive|undef
name|EC_GROUP
end_undef

begin_undef
undef|#
directive|undef
name|EC_POINT
end_undef

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* PACKET_H */
end_comment

end_unit

