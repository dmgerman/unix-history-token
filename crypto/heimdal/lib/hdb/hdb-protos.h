begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* This is a generated file */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|__hdb_protos_h__
end_ifndef

begin_define
define|#
directive|define
name|__hdb_protos_h__
end_define

begin_ifdef
ifdef|#
directive|ifdef
name|__STDC__
end_ifdef

begin_include
include|#
directive|include
file|<stdarg.h>
end_include

begin_ifndef
ifndef|#
directive|ifndef
name|__P
end_ifndef

begin_define
define|#
directive|define
name|__P
parameter_list|(
name|x
parameter_list|)
value|x
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_else
else|#
directive|else
end_else

begin_ifndef
ifndef|#
directive|ifndef
name|__P
end_ifndef

begin_define
define|#
directive|define
name|__P
parameter_list|(
name|x
parameter_list|)
value|()
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
name|krb5_error_code
name|hdb_add_master_key
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|krb5_keyblock
operator|*
name|key
operator|,
name|hdb_master_key
operator|*
name|inout
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_check_db_format
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|HDB
operator|*
name|db
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_clear_master_key
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|HDB
operator|*
name|db
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_create
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|HDB
operator|*
operator|*
name|db
operator|,
specifier|const
name|char
operator|*
name|filename
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_db_create
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|HDB
operator|*
operator|*
name|db
operator|,
specifier|const
name|char
operator|*
name|filename
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_enctype2key
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|hdb_entry
operator|*
name|e
operator|,
name|krb5_enctype
name|enctype
operator|,
name|Key
operator|*
operator|*
name|key
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_entry2string
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|hdb_entry
operator|*
name|ent
operator|,
name|char
operator|*
operator|*
name|str
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|hdb_entry2value
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|hdb_entry
operator|*
name|ent
operator|,
name|krb5_data
operator|*
name|value
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_foreach
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|HDB
operator|*
name|db
operator|,
name|unsigned
name|flags
operator|,
name|hdb_foreach_func_t
name|func
operator|,
name|void
operator|*
name|data
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|void
name|hdb_free_entry
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|hdb_entry
operator|*
name|ent
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|void
name|hdb_free_key
name|__P
argument_list|(
operator|(
name|Key
operator|*
name|key
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|void
name|hdb_free_master_key
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|hdb_master_key
name|mkey
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_init_db
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|HDB
operator|*
name|db
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|hdb_key2principal
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|krb5_data
operator|*
name|key
operator|,
name|krb5_principal
name|p
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_ldap_create
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|HDB
operator|*
operator|*
name|db
operator|,
specifier|const
name|char
operator|*
name|filename
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_lock
name|__P
argument_list|(
operator|(
name|int
name|fd
operator|,
name|int
name|operation
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_ndbm_create
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|HDB
operator|*
operator|*
name|db
operator|,
specifier|const
name|char
operator|*
name|filename
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_next_enctype2key
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
specifier|const
name|hdb_entry
operator|*
name|e
operator|,
name|krb5_enctype
name|enctype
operator|,
name|Key
operator|*
operator|*
name|key
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|hdb_principal2key
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|krb5_principal
name|p
operator|,
name|krb5_data
operator|*
name|key
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_print_entry
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|HDB
operator|*
name|db
operator|,
name|hdb_entry
operator|*
name|entry
operator|,
name|void
operator|*
name|data
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_process_master_key
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|int
name|kvno
operator|,
name|krb5_keyblock
operator|*
name|key
operator|,
name|krb5_enctype
name|etype
operator|,
name|hdb_master_key
operator|*
name|mkey
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_read_master_key
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
specifier|const
name|char
operator|*
name|filename
operator|,
name|hdb_master_key
operator|*
name|mkey
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_seal_keys
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|HDB
operator|*
name|db
operator|,
name|hdb_entry
operator|*
name|ent
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_seal_keys_mkey
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|hdb_entry
operator|*
name|ent
operator|,
name|hdb_master_key
name|mkey
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_set_master_key
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|HDB
operator|*
name|db
operator|,
name|krb5_keyblock
operator|*
name|key
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_set_master_keyfile
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|HDB
operator|*
name|db
operator|,
specifier|const
name|char
operator|*
name|keyfile
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_unlock
name|__P
argument_list|(
operator|(
name|int
name|fd
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_unseal_keys
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|HDB
operator|*
name|db
operator|,
name|hdb_entry
operator|*
name|ent
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_unseal_keys_mkey
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|hdb_entry
operator|*
name|ent
operator|,
name|hdb_master_key
name|mkey
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|hdb_value2entry
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
name|krb5_data
operator|*
name|value
operator|,
name|hdb_entry
operator|*
name|ent
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|krb5_error_code
name|hdb_write_master_key
name|__P
argument_list|(
operator|(
name|krb5_context
name|context
operator|,
specifier|const
name|char
operator|*
name|filename
operator|,
name|hdb_master_key
name|mkey
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* __hdb_protos_h__ */
end_comment

end_unit

