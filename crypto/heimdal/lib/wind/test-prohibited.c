begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (c) 2004 Kungliga Tekniska HÃ¶gskolan  * (Royal Institute of Technology, Stockholm, Sweden).  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  *  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  *  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * 3. Neither the name of the Institute nor the names of its contributors  *    may be used to endorse or promote products derived from this software  *    without specific prior written permission.  *  * THIS SOFTWARE IS PROVIDED BY THE INSTITUTE AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE INSTITUTE OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|HAVE_CONFIG_H
end_ifdef

begin_include
include|#
directive|include
file|<config.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|"windlocl.h"
end_include

begin_decl_stmt
specifier|static
name|uint32_t
name|positives
index|[]
init|=
block|{
literal|0x00A0
block|,
literal|0x3000
block|,
literal|0x0080
block|,
literal|0x009F
block|,
literal|0x206A
block|,
literal|0x206F
block|,
literal|0xFEFF
block|,
literal|0xFFF9
block|,
literal|0xFFFD
block|,
literal|0xFFFE
block|,
literal|0xFFFF
block|,
literal|0x1D173
block|,
literal|0x1D17A
block|,
literal|0xE000
block|,
literal|0xF8FF
block|,
literal|0xF0000
block|,
literal|0xFFFFD
block|,
literal|0x100000
block|,
literal|0x10FFFD
block|,
literal|0xFDD0
block|,
literal|0xFDEF
block|,
literal|0xFFFE
block|,
literal|0xFFFF
block|,
literal|0x1FFFE
block|,
literal|0x1FFFF
block|,
literal|0x2FFFE
block|,
literal|0x2FFFF
block|,
literal|0x3FFFE
block|,
literal|0x3FFFF
block|,
literal|0x4FFFE
block|,
literal|0x4FFFF
block|,
literal|0x5FFFE
block|,
literal|0x5FFFF
block|,
literal|0x6FFFE
block|,
literal|0x6FFFF
block|,
literal|0x7FFFE
block|,
literal|0x7FFFF
block|,
literal|0x8FFFE
block|,
literal|0x8FFFF
block|,
literal|0x9FFFE
block|,
literal|0x9FFFF
block|,
literal|0xAFFFE
block|,
literal|0xAFFFF
block|,
literal|0xBFFFE
block|,
literal|0xBFFFF
block|,
literal|0xCFFFE
block|,
literal|0xCFFFF
block|,
literal|0xDFFFE
block|,
literal|0xDFFFF
block|,
literal|0xEFFFE
block|,
literal|0xEFFFF
block|,
literal|0xFFFFE
block|,
literal|0xFFFFF
block|,
literal|0x10FFFE
block|,
literal|0x10FFFF
block|,
literal|0xD800
block|,
literal|0xDFFF
block|,
literal|0xFFF9
block|,
literal|0xFFFA
block|,
literal|0xFFFB
block|,
literal|0xFFFC
block|,
literal|0x2FF0
block|,
literal|0x2FFB
block|,
literal|0x0340
block|,
literal|0x0341
block|,
literal|0x200E
block|,
literal|0x200F
block|,
literal|0x202A
block|,
literal|0x202B
block|,
literal|0x202C
block|,
literal|0x202D
block|,
literal|0x202E
block|,
literal|0x206A
block|,
literal|0x206B
block|,
literal|0x206C
block|,
literal|0x206D
block|,
literal|0x206E
block|,
literal|0x206F
block|,
literal|0xE0001
block|,
literal|0xE0020
block|,
literal|0xE007F
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|uint32_t
name|negatives
index|[]
init|=
block|{
literal|0x0000
block|,
literal|0x001F
block|,
literal|0x007F
block|,
literal|0x0020
block|,
literal|0x2069
block|,
literal|0x2070
block|,
literal|0x0FFF8
block|,
literal|0x1D172
block|,
literal|0x1D17B
block|,
literal|0xF900
block|,
literal|0xFDCF
block|,
literal|0xFDF0
block|,
literal|0x10000
block|,
literal|0x1FFFD
block|,
literal|0x20000
block|,
literal|0x2FFFD
block|,
literal|0x30000
block|,
literal|0x3FFFD
block|,
literal|0x40000
block|,
literal|0x4FFFD
block|,
literal|0x50000
block|,
literal|0x5FFFD
block|,
literal|0x60000
block|,
literal|0x6FFFD
block|,
literal|0x70000
block|,
literal|0x7FFFD
block|,
literal|0x80000
block|,
literal|0x8FFFD
block|,
literal|0x90000
block|,
literal|0x9FFFD
block|,
literal|0xA0000
block|,
literal|0xAFFFD
block|,
literal|0xB0000
block|,
literal|0xBFFFD
block|,
literal|0xC0000
block|,
literal|0xCFFFD
block|,
literal|0xD0000
block|,
literal|0xDFFFD
block|,
literal|0xE0000
block|,
literal|0xEFFFD
block|,
literal|0x110000
block|,
literal|0xD7FF
block|,
literal|0xFFF8
block|,
literal|0x2FEF
block|,
literal|0x2FFC
block|, }
decl_stmt|;
end_decl_stmt

begin_function
name|int
name|main
parameter_list|(
name|void
parameter_list|)
block|{
name|unsigned
name|i
decl_stmt|;
name|unsigned
name|failures
init|=
literal|0
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
sizeof|sizeof
argument_list|(
name|positives
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|positives
index|[
literal|0
index|]
argument_list|)
condition|;
operator|++
name|i
control|)
if|if
condition|(
operator|!
name|_wind_stringprep_error
argument_list|(
name|positives
index|[
name|i
index|]
argument_list|,
name|WIND_PROFILE_NAME
argument_list|)
condition|)
block|{
name|printf
argument_list|(
literal|"code-point 0x%x not marked as prohibited\n"
argument_list|,
name|positives
index|[
name|i
index|]
argument_list|)
expr_stmt|;
operator|++
name|failures
expr_stmt|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
sizeof|sizeof
argument_list|(
name|negatives
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|negatives
index|[
literal|0
index|]
argument_list|)
condition|;
operator|++
name|i
control|)
if|if
condition|(
name|_wind_stringprep_error
argument_list|(
name|negatives
index|[
name|i
index|]
argument_list|,
name|WIND_PROFILE_NAME
argument_list|)
condition|)
block|{
name|printf
argument_list|(
literal|"code-point 0x%x not marked as non-prohibited\n"
argument_list|,
name|negatives
index|[
name|i
index|]
argument_list|)
expr_stmt|;
operator|++
name|failures
expr_stmt|;
block|}
return|return
name|failures
operator|!=
literal|0
return|;
block|}
end_function

end_unit

