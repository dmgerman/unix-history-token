begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* This is a generated file */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|__kdc_private_h__
end_ifndef

begin_define
define|#
directive|define
name|__kdc_private_h__
end_define

begin_include
include|#
directive|include
file|<stdarg.h>
end_include

begin_function_decl
name|krb5_error_code
name|_kdc_add_KRB5SignedPath
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
name|hdb_entry_ex
modifier|*
comment|/*krbtgt*/
parameter_list|,
name|krb5_enctype
comment|/*enctype*/
parameter_list|,
name|krb5_const_principal
comment|/*server*/
parameter_list|,
name|KRB5SignedPathPrincipals
modifier|*
comment|/*principals*/
parameter_list|,
name|EncTicketPart
modifier|*
comment|/*tkt*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_add_inital_verified_cas
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
name|pk_client_params
modifier|*
comment|/*params*/
parameter_list|,
name|EncTicketPart
modifier|*
comment|/*tkt*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_as_rep
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
name|KDC_REQ
modifier|*
comment|/*req*/
parameter_list|,
specifier|const
name|krb5_data
modifier|*
comment|/*req_buffer*/
parameter_list|,
name|krb5_data
modifier|*
comment|/*reply*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*from*/
parameter_list|,
name|struct
name|sockaddr
modifier|*
comment|/*from_addr*/
parameter_list|,
name|int
comment|/*datagram_reply*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_boolean
name|_kdc_check_addresses
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
name|HostAddresses
modifier|*
comment|/*addresses*/
parameter_list|,
specifier|const
name|struct
name|sockaddr
modifier|*
comment|/*from*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_check_flags
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
name|hdb_entry_ex
modifier|*
comment|/*client_ex*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*client_name*/
parameter_list|,
name|hdb_entry_ex
modifier|*
comment|/*server_ex*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*server_name*/
parameter_list|,
name|krb5_boolean
comment|/*is_as_req*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_db_fetch
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
name|krb5_const_principal
comment|/*principal*/
parameter_list|,
name|unsigned
comment|/*flags*/
parameter_list|,
name|HDB
modifier|*
modifier|*
comment|/*db*/
parameter_list|,
name|hdb_entry_ex
modifier|*
modifier|*
comment|/*h*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_db_fetch4
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*name*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*instance*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*realm*/
parameter_list|,
name|unsigned
comment|/*flags*/
parameter_list|,
name|hdb_entry_ex
modifier|*
modifier|*
comment|/*ent*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_do_524
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
specifier|const
name|Ticket
modifier|*
comment|/*t*/
parameter_list|,
name|krb5_data
modifier|*
comment|/*reply*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*from*/
parameter_list|,
name|struct
name|sockaddr
modifier|*
comment|/*addr*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_do_digest
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
specifier|const
name|DigestREQ
modifier|*
comment|/*req*/
parameter_list|,
name|krb5_data
modifier|*
comment|/*reply*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*from*/
parameter_list|,
name|struct
name|sockaddr
modifier|*
comment|/*addr*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_do_kaserver
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
name|unsigned
name|char
modifier|*
comment|/*buf*/
parameter_list|,
name|size_t
comment|/*len*/
parameter_list|,
name|krb5_data
modifier|*
comment|/*reply*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*from*/
parameter_list|,
name|struct
name|sockaddr_in
modifier|*
comment|/*addr*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_do_kx509
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
specifier|const
name|Kx509Request
modifier|*
comment|/*req*/
parameter_list|,
name|krb5_data
modifier|*
comment|/*reply*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*from*/
parameter_list|,
name|struct
name|sockaddr
modifier|*
comment|/*addr*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_do_version4
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
name|unsigned
name|char
modifier|*
comment|/*buf*/
parameter_list|,
name|size_t
comment|/*len*/
parameter_list|,
name|krb5_data
modifier|*
comment|/*reply*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*from*/
parameter_list|,
name|struct
name|sockaddr_in
modifier|*
comment|/*addr*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_encode_reply
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
name|KDC_REP
modifier|*
comment|/*rep*/
parameter_list|,
specifier|const
name|EncTicketPart
modifier|*
comment|/*et*/
parameter_list|,
name|EncKDCRepPart
modifier|*
comment|/*ek*/
parameter_list|,
name|krb5_enctype
comment|/*etype*/
parameter_list|,
name|int
comment|/*skvno*/
parameter_list|,
specifier|const
name|EncryptionKey
modifier|*
comment|/*skey*/
parameter_list|,
name|int
comment|/*ckvno*/
parameter_list|,
specifier|const
name|EncryptionKey
modifier|*
comment|/*ckey*/
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
comment|/*e_text*/
parameter_list|,
name|krb5_data
modifier|*
comment|/*reply*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_encode_v4_ticket
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
name|void
modifier|*
comment|/*buf*/
parameter_list|,
name|size_t
comment|/*len*/
parameter_list|,
specifier|const
name|EncTicketPart
modifier|*
comment|/*et*/
parameter_list|,
specifier|const
name|PrincipalName
modifier|*
comment|/*service*/
parameter_list|,
name|size_t
modifier|*
comment|/*size*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_find_etype
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
specifier|const
name|hdb_entry_ex
modifier|*
comment|/*princ*/
parameter_list|,
name|krb5_enctype
modifier|*
comment|/*etypes*/
parameter_list|,
name|unsigned
comment|/*len*/
parameter_list|,
name|Key
modifier|*
modifier|*
comment|/*ret_key*/
parameter_list|,
name|krb5_enctype
modifier|*
comment|/*ret_etype*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|const
name|PA_DATA
modifier|*
name|_kdc_find_padata
parameter_list|(
specifier|const
name|KDC_REQ
modifier|*
comment|/*req*/
parameter_list|,
name|int
modifier|*
comment|/*start*/
parameter_list|,
name|int
comment|/*type*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|_kdc_fix_time
parameter_list|(
name|time_t
modifier|*
modifier|*
comment|/*t*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|_kdc_free_ent
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|hdb_entry_ex
modifier|*
comment|/*ent*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_get_des_key
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|hdb_entry_ex
modifier|*
comment|/*principal*/
parameter_list|,
name|krb5_boolean
comment|/*is_server*/
parameter_list|,
name|krb5_boolean
comment|/*prefer_afs_key*/
parameter_list|,
name|Key
modifier|*
modifier|*
comment|/*ret_key*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_get_preferred_key
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
name|hdb_entry_ex
modifier|*
comment|/*h*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*name*/
parameter_list|,
name|krb5_enctype
modifier|*
comment|/*enctype*/
parameter_list|,
name|Key
modifier|*
modifier|*
comment|/*key*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|_kdc_log_timestamp
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*type*/
parameter_list|,
name|KerberosTime
comment|/*authtime*/
parameter_list|,
name|KerberosTime
modifier|*
comment|/*starttime*/
parameter_list|,
name|KerberosTime
comment|/*endtime*/
parameter_list|,
name|KerberosTime
modifier|*
comment|/*renew_till*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_make_anonymous_principalname
parameter_list|(
name|PrincipalName
modifier|*
comment|/*pn*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|_kdc_maybe_version4
parameter_list|(
name|unsigned
name|char
modifier|*
comment|/*buf*/
parameter_list|,
name|int
comment|/*len*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_pac_generate
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|hdb_entry_ex
modifier|*
comment|/*client*/
parameter_list|,
name|krb5_pac
modifier|*
comment|/*pac*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_pac_verify
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
specifier|const
name|krb5_principal
comment|/*client_principal*/
parameter_list|,
name|hdb_entry_ex
modifier|*
comment|/*client*/
parameter_list|,
name|hdb_entry_ex
modifier|*
comment|/*server*/
parameter_list|,
name|krb5_pac
modifier|*
comment|/*pac*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_pk_check_client
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
specifier|const
name|hdb_entry_ex
modifier|*
comment|/*client*/
parameter_list|,
name|pk_client_params
modifier|*
comment|/*client_params*/
parameter_list|,
name|char
modifier|*
modifier|*
comment|/*subject_name*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|_kdc_pk_free_client_param
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|pk_client_params
modifier|*
comment|/*client_params*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_pk_initialize
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*user_id*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*anchors*/
parameter_list|,
name|char
modifier|*
modifier|*
comment|/*pool*/
parameter_list|,
name|char
modifier|*
modifier|*
comment|/*revoke_list*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_pk_mk_pa_reply
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
name|pk_client_params
modifier|*
comment|/*client_params*/
parameter_list|,
specifier|const
name|hdb_entry_ex
modifier|*
comment|/*client*/
parameter_list|,
specifier|const
name|KDC_REQ
modifier|*
comment|/*req*/
parameter_list|,
specifier|const
name|krb5_data
modifier|*
comment|/*req_buffer*/
parameter_list|,
name|krb5_keyblock
modifier|*
modifier|*
comment|/*reply_key*/
parameter_list|,
name|METHOD_DATA
modifier|*
comment|/*md*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_pk_rd_padata
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
specifier|const
name|KDC_REQ
modifier|*
comment|/*req*/
parameter_list|,
specifier|const
name|PA_DATA
modifier|*
comment|/*pa*/
parameter_list|,
name|pk_client_params
modifier|*
modifier|*
comment|/*ret_params*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_tgs_rep
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_kdc_configuration
modifier|*
comment|/*config*/
parameter_list|,
name|KDC_REQ
modifier|*
comment|/*req*/
parameter_list|,
name|krb5_data
modifier|*
comment|/*data*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*from*/
parameter_list|,
name|struct
name|sockaddr
modifier|*
comment|/*from_addr*/
parameter_list|,
name|int
comment|/*datagram_reply*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_tkt_add_if_relevant_ad
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|EncTicketPart
modifier|*
comment|/*tkt*/
parameter_list|,
name|int
comment|/*type*/
parameter_list|,
specifier|const
name|krb5_data
modifier|*
comment|/*data*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_try_kx509_request
parameter_list|(
name|void
modifier|*
comment|/*ptr*/
parameter_list|,
name|size_t
comment|/*len*/
parameter_list|,
name|Kx509Request
modifier|*
comment|/*req*/
parameter_list|,
name|size_t
modifier|*
comment|/*size*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kdc_windc_client_access
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|struct
name|hdb_entry_ex
modifier|*
comment|/*client*/
parameter_list|,
name|KDC_REQ
modifier|*
comment|/*req*/
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* __kdc_private_h__ */
end_comment

end_unit

