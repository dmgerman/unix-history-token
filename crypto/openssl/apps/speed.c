begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* apps/speed.c -*- mode:C; c-file-style: "eay" -*- */
end_comment

begin_comment
comment|/* Copyright (C) 1995-1998 Eric Young (eay@cryptsoft.com)  * All rights reserved.  *  * This package is an SSL implementation written  * by Eric Young (eay@cryptsoft.com).  * The implementation was written so as to conform with Netscapes SSL.  *   * This library is free for commercial and non-commercial use as long as  * the following conditions are aheared to.  The following conditions  * apply to all code found in this distribution, be it the RC4, RSA,  * lhash, DES, etc., code; not just the SSL code.  The SSL documentation  * included with this distribution is covered by the same copyright terms  * except that the holder is Tim Hudson (tjh@cryptsoft.com).  *   * Copyright remains Eric Young's, and as such any Copyright notices in  * the code are not to be removed.  * If this package is used in a product, Eric Young should be given attribution  * as the author of the parts of the library used.  * This can be in the form of a textual message at program startup or  * in documentation (online or textual) provided with the package.  *   * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  * 3. All advertising materials mentioning features or use of this software  *    must display the following acknowledgement:  *    "This product includes cryptographic software written by  *     Eric Young (eay@cryptsoft.com)"  *    The word 'cryptographic' can be left out if the rouines from the library  *    being used are not cryptographic related :-).  * 4. If you include any Windows specific code (or a derivative thereof) from   *    the apps directory (application code) you must include an acknowledgement:  *    "This product includes software written by Tim Hudson (tjh@cryptsoft.com)"  *   * THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  *   * The licence and distribution terms for any publically available version or  * derivative of this code cannot be changed.  i.e. this code cannot simply be  * copied and put under another distribution licence  * [including the GNU Public Licence.]  */
end_comment

begin_comment
comment|/* most of this code has been pilfered from my libdes speed.c program */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_SPEED
end_ifndef

begin_undef
undef|#
directive|undef
name|SECONDS
end_undef

begin_define
define|#
directive|define
name|SECONDS
value|3
end_define

begin_define
define|#
directive|define
name|RSA_SECONDS
value|10
end_define

begin_define
define|#
directive|define
name|DSA_SECONDS
value|10
end_define

begin_comment
comment|/* 11-Sep-92 Andrew Daviel   Support for Silicon Graphics IRIX added */
end_comment

begin_comment
comment|/* 06-Apr-92 Luke Brennan    Support for VMS and add extra signal calls */
end_comment

begin_undef
undef|#
directive|undef
name|PROG
end_undef

begin_define
define|#
directive|define
name|PROG
value|speed_main
end_define

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<signal.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<math.h>
end_include

begin_include
include|#
directive|include
file|"apps.h"
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|OPENSSL_NO_STDIO
end_ifdef

begin_define
define|#
directive|define
name|APPS_WIN16
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<openssl/crypto.h>
end_include

begin_include
include|#
directive|include
file|<openssl/rand.h>
end_include

begin_include
include|#
directive|include
file|<openssl/err.h>
end_include

begin_include
include|#
directive|include
file|<openssl/evp.h>
end_include

begin_include
include|#
directive|include
file|<openssl/objects.h>
end_include

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|OPENSSL_SYS_MSDOS
argument_list|)
end_if

begin_include
include|#
directive|include
include|OPENSSL_UNISTD
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__FreeBSD__
argument_list|)
operator|||
name|defined
argument_list|(
name|__NetBSD__
argument_list|)
operator|||
name|defined
argument_list|(
name|__OpenBSD__
argument_list|)
operator|||
name|defined
argument_list|(
name|OPENSSL_SYS_MACOSX
argument_list|)
end_if

begin_define
define|#
directive|define
name|USE_TOD
end_define

begin_elif
elif|#
directive|elif
operator|!
name|defined
argument_list|(
name|OPENSSL_SYS_MSDOS
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|OPENSSL_SYS_VXWORKS
argument_list|)
operator|&&
operator|(
operator|!
name|defined
argument_list|(
name|OPENSSL_SYS_VMS
argument_list|)
operator|||
name|defined
argument_list|(
name|__DECC
argument_list|)
operator|)
end_elif

begin_define
define|#
directive|define
name|TIMES
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|_UNICOS
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|__OpenBSD__
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|sgi
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|__FreeBSD__
argument_list|)
operator|&&
operator|!
operator|(
name|defined
argument_list|(
name|__bsdi
argument_list|)
operator|||
name|defined
argument_list|(
name|__bsdi__
argument_list|)
operator|)
operator|&&
operator|!
name|defined
argument_list|(
name|_AIX
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|OPENSSL_SYS_MPE
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|__NetBSD__
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|OPENSSL_SYS_VXWORKS
argument_list|)
end_if

begin_comment
comment|/* FIXME */
end_comment

begin_define
define|#
directive|define
name|TIMEB
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|_IRIX
end_ifndef

begin_include
include|#
directive|include
file|<time.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifdef
ifdef|#
directive|ifdef
name|TIMES
end_ifdef

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|<sys/times.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifdef
ifdef|#
directive|ifdef
name|USE_TOD
end_ifdef

begin_include
include|#
directive|include
file|<sys/time.h>
end_include

begin_include
include|#
directive|include
file|<sys/resource.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* Depending on the VMS version, the tms structure is perhaps defined.    The __TMS macro will show if it was.  If it wasn't defined, we should    undefine TIMES, since that tells the rest of the program how things    should be handled.				-- Richard Levitte */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|OPENSSL_SYS_VMS_DECC
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|__TMS
argument_list|)
end_if

begin_undef
undef|#
directive|undef
name|TIMES
end_undef

begin_endif
endif|#
directive|endif
end_endif

begin_ifdef
ifdef|#
directive|ifdef
name|TIMEB
end_ifdef

begin_include
include|#
directive|include
file|<sys/timeb.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|TIMES
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|TIMEB
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|USE_TOD
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|OPENSSL_SYS_VXWORKS
argument_list|)
end_if

begin_error
error|#
directive|error
literal|"It seems neither struct tms nor struct timeb is supported in this platform!"
end_error

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
name|defined
argument_list|(
name|sun
argument_list|)
operator|||
name|defined
argument_list|(
name|__ultrix
argument_list|)
end_if

begin_define
define|#
directive|define
name|_POSIX_SOURCE
end_define

begin_include
include|#
directive|include
file|<limits.h>
end_include

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_DES
end_ifndef

begin_include
include|#
directive|include
file|<openssl/des.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_AES
end_ifndef

begin_include
include|#
directive|include
file|<openssl/aes.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_MD2
end_ifndef

begin_include
include|#
directive|include
file|<openssl/md2.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_MDC2
end_ifndef

begin_include
include|#
directive|include
file|<openssl/mdc2.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_MD4
end_ifndef

begin_include
include|#
directive|include
file|<openssl/md4.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_MD5
end_ifndef

begin_include
include|#
directive|include
file|<openssl/md5.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_HMAC
end_ifndef

begin_include
include|#
directive|include
file|<openssl/hmac.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<openssl/evp.h>
end_include

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_SHA
end_ifndef

begin_include
include|#
directive|include
file|<openssl/sha.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_RIPEMD
end_ifndef

begin_include
include|#
directive|include
file|<openssl/ripemd.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC4
end_ifndef

begin_include
include|#
directive|include
file|<openssl/rc4.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC5
end_ifndef

begin_include
include|#
directive|include
file|<openssl/rc5.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC2
end_ifndef

begin_include
include|#
directive|include
file|<openssl/rc2.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_IDEA
end_ifndef

begin_include
include|#
directive|include
file|<openssl/idea.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_BF
end_ifndef

begin_include
include|#
directive|include
file|<openssl/blowfish.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_CAST
end_ifndef

begin_include
include|#
directive|include
file|<openssl/cast.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_RSA
end_ifndef

begin_include
include|#
directive|include
file|<openssl/rsa.h>
end_include

begin_include
include|#
directive|include
file|"./testrsa.h"
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<openssl/x509.h>
end_include

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_DSA
end_ifndef

begin_include
include|#
directive|include
file|"./testdsa.h"
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* The following if from times(3) man page.  It may need to be changed */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|HZ
end_ifndef

begin_if
if|#
directive|if
name|defined
argument_list|(
name|_SC_CLK_TCK
argument_list|)
expr|\
operator|&&
operator|(
operator|!
name|defined
argument_list|(
name|OPENSSL_SYS_VMS
argument_list|)
operator|||
name|__CTRL_VER
operator|>=
literal|70000000
operator|)
end_if

begin_define
define|#
directive|define
name|HZ
value|((double)sysconf(_SC_CLK_TCK))
end_define

begin_else
else|#
directive|else
end_else

begin_ifndef
ifndef|#
directive|ifndef
name|CLK_TCK
end_ifndef

begin_ifndef
ifndef|#
directive|ifndef
name|_BSD_CLK_TCK_
end_ifndef

begin_comment
comment|/* FreeBSD hack */
end_comment

begin_define
define|#
directive|define
name|HZ
value|100.0
end_define

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* _BSD_CLK_TCK_ */
end_comment

begin_define
define|#
directive|define
name|HZ
value|((double)_BSD_CLK_TCK_)
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* CLK_TCK */
end_comment

begin_define
define|#
directive|define
name|HZ
value|((double)CLK_TCK)
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|OPENSSL_SYS_VMS
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|OPENSSL_SYS_WINDOWS
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|OPENSSL_SYS_MACINTOSH_CLASSIC
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|OPENSSL_SYS_OS2
argument_list|)
end_if

begin_define
define|#
directive|define
name|HAVE_FORK
value|1
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_undef
undef|#
directive|undef
name|BUFSIZE
end_undef

begin_define
define|#
directive|define
name|BUFSIZE
value|((long)1024*8+1)
end_define

begin_decl_stmt
name|int
name|run
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
name|ftime_used
init|=
literal|0
decl_stmt|,
name|times_used
init|=
literal|0
decl_stmt|,
name|gettimeofday_used
init|=
literal|0
decl_stmt|,
name|getrusage_used
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|mr
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|usertime
init|=
literal|1
decl_stmt|;
end_decl_stmt

begin_function_decl
specifier|static
name|double
name|Time_F
parameter_list|(
name|int
name|s
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|print_message
parameter_list|(
specifier|const
name|char
modifier|*
name|s
parameter_list|,
name|long
name|num
parameter_list|,
name|int
name|length
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|pkey_print_message
parameter_list|(
name|char
modifier|*
name|str
parameter_list|,
name|char
modifier|*
name|str2
parameter_list|,
name|long
name|num
parameter_list|,
name|int
name|bits
parameter_list|,
name|int
name|sec
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|print_result
parameter_list|(
name|int
name|alg
parameter_list|,
name|int
name|run_no
parameter_list|,
name|int
name|count
parameter_list|,
name|double
name|time_used
parameter_list|)
function_decl|;
end_function_decl

begin_ifdef
ifdef|#
directive|ifdef
name|HAVE_FORK
end_ifdef

begin_function_decl
specifier|static
name|int
name|do_multi
parameter_list|(
name|int
name|multi
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_define
define|#
directive|define
name|ALGOR_NUM
value|19
end_define

begin_define
define|#
directive|define
name|SIZE_NUM
value|5
end_define

begin_define
define|#
directive|define
name|RSA_NUM
value|4
end_define

begin_define
define|#
directive|define
name|DSA_NUM
value|3
end_define

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|names
index|[
name|ALGOR_NUM
index|]
init|=
block|{
literal|"md2"
block|,
literal|"mdc2"
block|,
literal|"md4"
block|,
literal|"md5"
block|,
literal|"hmac(md5)"
block|,
literal|"sha1"
block|,
literal|"rmd160"
block|,
literal|"rc4"
block|,
literal|"des cbc"
block|,
literal|"des ede3"
block|,
literal|"idea cbc"
block|,
literal|"rc2 cbc"
block|,
literal|"rc5-32/12 cbc"
block|,
literal|"blowfish cbc"
block|,
literal|"cast cbc"
block|,
literal|"aes-128 cbc"
block|,
literal|"aes-192 cbc"
block|,
literal|"aes-256 cbc"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|results
index|[
name|ALGOR_NUM
index|]
index|[
name|SIZE_NUM
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|lengths
index|[
name|SIZE_NUM
index|]
init|=
block|{
literal|16
block|,
literal|64
block|,
literal|256
block|,
literal|1024
block|,
literal|8
operator|*
literal|1024
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|rsa_results
index|[
name|RSA_NUM
index|]
index|[
literal|2
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|dsa_results
index|[
name|DSA_NUM
index|]
index|[
literal|2
index|]
decl_stmt|;
end_decl_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|SIGALRM
end_ifdef

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__STDC__
argument_list|)
operator|||
name|defined
argument_list|(
name|sgi
argument_list|)
operator|||
name|defined
argument_list|(
name|_AIX
argument_list|)
end_if

begin_define
define|#
directive|define
name|SIGRETTYPE
value|void
end_define

begin_else
else|#
directive|else
end_else

begin_define
define|#
directive|define
name|SIGRETTYPE
value|int
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_function_decl
specifier|static
name|SIGRETTYPE
name|sig_done
parameter_list|(
name|int
name|sig
parameter_list|)
function_decl|;
end_function_decl

begin_function
specifier|static
name|SIGRETTYPE
name|sig_done
parameter_list|(
name|int
name|sig
parameter_list|)
block|{
name|signal
argument_list|(
name|SIGALRM
argument_list|,
name|sig_done
argument_list|)
expr_stmt|;
name|run
operator|=
literal|0
expr_stmt|;
ifdef|#
directive|ifdef
name|LINT
name|sig
operator|=
name|sig
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_define
define|#
directive|define
name|START
value|0
end_define

begin_define
define|#
directive|define
name|STOP
value|1
end_define

begin_function
specifier|static
name|double
name|Time_F
parameter_list|(
name|int
name|s
parameter_list|)
block|{
name|double
name|ret
decl_stmt|;
ifdef|#
directive|ifdef
name|USE_TOD
if|if
condition|(
name|usertime
condition|)
block|{
specifier|static
name|struct
name|rusage
name|tstart
decl_stmt|,
name|tend
decl_stmt|;
name|getrusage_used
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|s
operator|==
name|START
condition|)
block|{
name|getrusage
argument_list|(
name|RUSAGE_SELF
argument_list|,
operator|&
name|tstart
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
else|else
block|{
name|long
name|i
decl_stmt|;
name|getrusage
argument_list|(
name|RUSAGE_SELF
argument_list|,
operator|&
name|tend
argument_list|)
expr_stmt|;
name|i
operator|=
operator|(
name|long
operator|)
name|tend
operator|.
name|ru_utime
operator|.
name|tv_usec
operator|-
operator|(
name|long
operator|)
name|tstart
operator|.
name|ru_utime
operator|.
name|tv_usec
expr_stmt|;
name|ret
operator|=
operator|(
call|(
name|double
call|)
argument_list|(
name|tend
operator|.
name|ru_utime
operator|.
name|tv_sec
operator|-
name|tstart
operator|.
name|ru_utime
operator|.
name|tv_sec
argument_list|)
operator|)
operator|+
operator|(
operator|(
name|double
operator|)
name|i
operator|)
operator|/
literal|1000000.0
expr_stmt|;
return|return
operator|(
operator|(
name|ret
operator|<
literal|0.001
operator|)
condition|?
literal|0.001
else|:
name|ret
operator|)
return|;
block|}
block|}
else|else
block|{
specifier|static
name|struct
name|timeval
name|tstart
decl_stmt|,
name|tend
decl_stmt|;
name|long
name|i
decl_stmt|;
name|gettimeofday_used
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|s
operator|==
name|START
condition|)
block|{
name|gettimeofday
argument_list|(
operator|&
name|tstart
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
else|else
block|{
name|gettimeofday
argument_list|(
operator|&
name|tend
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|i
operator|=
operator|(
name|long
operator|)
name|tend
operator|.
name|tv_usec
operator|-
operator|(
name|long
operator|)
name|tstart
operator|.
name|tv_usec
expr_stmt|;
name|ret
operator|=
operator|(
call|(
name|double
call|)
argument_list|(
name|tend
operator|.
name|tv_sec
operator|-
name|tstart
operator|.
name|tv_sec
argument_list|)
operator|)
operator|+
operator|(
operator|(
name|double
operator|)
name|i
operator|)
operator|/
literal|1000000.0
expr_stmt|;
return|return
operator|(
operator|(
name|ret
operator|<
literal|0.001
operator|)
condition|?
literal|0.001
else|:
name|ret
operator|)
return|;
block|}
block|}
else|#
directive|else
comment|/* ndef USE_TOD */
ifdef|#
directive|ifdef
name|TIMES
if|if
condition|(
name|usertime
condition|)
block|{
specifier|static
name|struct
name|tms
name|tstart
decl_stmt|,
name|tend
decl_stmt|;
name|times_used
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|s
operator|==
name|START
condition|)
block|{
name|times
argument_list|(
operator|&
name|tstart
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
else|else
block|{
name|times
argument_list|(
operator|&
name|tend
argument_list|)
expr_stmt|;
name|ret
operator|=
operator|(
call|(
name|double
call|)
argument_list|(
name|tend
operator|.
name|tms_utime
operator|-
name|tstart
operator|.
name|tms_utime
argument_list|)
operator|)
operator|/
name|HZ
expr_stmt|;
return|return
operator|(
operator|(
name|ret
operator|<
literal|1e-3
operator|)
condition|?
literal|1e-3
else|:
name|ret
operator|)
return|;
block|}
block|}
endif|#
directive|endif
comment|/* times() */
if|#
directive|if
name|defined
argument_list|(
name|TIMES
argument_list|)
operator|&&
name|defined
argument_list|(
name|TIMEB
argument_list|)
else|else
endif|#
directive|endif
ifdef|#
directive|ifdef
name|OPENSSL_SYS_VXWORKS
block|{
specifier|static
name|unsigned
name|long
name|tick_start
decl_stmt|,
name|tick_end
decl_stmt|;
if|if
condition|(
name|s
operator|==
name|START
condition|)
block|{
name|tick_start
operator|=
name|tickGet
argument_list|()
expr_stmt|;
return|return
literal|0
return|;
block|}
else|else
block|{
name|tick_end
operator|=
name|tickGet
argument_list|()
expr_stmt|;
name|ret
operator|=
call|(
name|double
call|)
argument_list|(
name|tick_end
operator|-
name|tick_start
argument_list|)
operator|/
operator|(
name|double
operator|)
name|sysClkRateGet
argument_list|()
expr_stmt|;
return|return
operator|(
operator|(
name|ret
operator|<
literal|0.001
operator|)
condition|?
literal|0.001
else|:
name|ret
operator|)
return|;
block|}
block|}
elif|#
directive|elif
name|defined
argument_list|(
name|TIMEB
argument_list|)
block|{
specifier|static
name|struct
name|timeb
name|tstart
decl_stmt|,
name|tend
decl_stmt|;
name|long
name|i
decl_stmt|;
name|ftime_used
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|s
operator|==
name|START
condition|)
block|{
name|ftime
argument_list|(
operator|&
name|tstart
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
else|else
block|{
name|ftime
argument_list|(
operator|&
name|tend
argument_list|)
expr_stmt|;
name|i
operator|=
operator|(
name|long
operator|)
name|tend
operator|.
name|millitm
operator|-
operator|(
name|long
operator|)
name|tstart
operator|.
name|millitm
expr_stmt|;
name|ret
operator|=
operator|(
call|(
name|double
call|)
argument_list|(
name|tend
operator|.
name|time
operator|-
name|tstart
operator|.
name|time
argument_list|)
operator|)
operator|+
operator|(
operator|(
name|double
operator|)
name|i
operator|)
operator|/
literal|1000.0
expr_stmt|;
return|return
operator|(
operator|(
name|ret
operator|<
literal|0.001
operator|)
condition|?
literal|0.001
else|:
name|ret
operator|)
return|;
block|}
block|}
endif|#
directive|endif
endif|#
directive|endif
block|}
end_function

begin_function_decl
name|int
name|MAIN
parameter_list|(
name|int
parameter_list|,
name|char
modifier|*
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|int
name|MAIN
parameter_list|(
name|int
name|argc
parameter_list|,
name|char
modifier|*
modifier|*
name|argv
parameter_list|)
block|{
ifndef|#
directive|ifndef
name|OPENSSL_NO_ENGINE
name|ENGINE
modifier|*
name|e
init|=
name|NULL
decl_stmt|;
endif|#
directive|endif
name|unsigned
name|char
modifier|*
name|buf
init|=
name|NULL
decl_stmt|,
modifier|*
name|buf2
init|=
name|NULL
decl_stmt|;
name|int
name|mret
init|=
literal|1
decl_stmt|;
name|long
name|count
init|=
literal|0
decl_stmt|,
name|save_count
init|=
literal|0
decl_stmt|;
name|int
name|i
decl_stmt|,
name|j
decl_stmt|,
name|k
decl_stmt|;
if|#
directive|if
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_RSA
argument_list|)
operator|||
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_DSA
argument_list|)
name|long
name|rsa_count
decl_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RSA
name|unsigned
name|rsa_num
decl_stmt|;
endif|#
directive|endif
name|unsigned
name|char
name|md
index|[
name|EVP_MAX_MD_SIZE
index|]
decl_stmt|;
ifndef|#
directive|ifndef
name|OPENSSL_NO_MD2
name|unsigned
name|char
name|md2
index|[
name|MD2_DIGEST_LENGTH
index|]
decl_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_MDC2
name|unsigned
name|char
name|mdc2
index|[
name|MDC2_DIGEST_LENGTH
index|]
decl_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_MD4
name|unsigned
name|char
name|md4
index|[
name|MD4_DIGEST_LENGTH
index|]
decl_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_MD5
name|unsigned
name|char
name|md5
index|[
name|MD5_DIGEST_LENGTH
index|]
decl_stmt|;
name|unsigned
name|char
name|hmac
index|[
name|MD5_DIGEST_LENGTH
index|]
decl_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_SHA
name|unsigned
name|char
name|sha
index|[
name|SHA_DIGEST_LENGTH
index|]
decl_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RIPEMD
name|unsigned
name|char
name|rmd160
index|[
name|RIPEMD160_DIGEST_LENGTH
index|]
decl_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC4
name|RC4_KEY
name|rc4_ks
decl_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC5
name|RC5_32_KEY
name|rc5_ks
decl_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC2
name|RC2_KEY
name|rc2_ks
decl_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_IDEA
name|IDEA_KEY_SCHEDULE
name|idea_ks
decl_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_BF
name|BF_KEY
name|bf_ks
decl_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_CAST
name|CAST_KEY
name|cast_ks
decl_stmt|;
endif|#
directive|endif
specifier|static
specifier|const
name|unsigned
name|char
name|key16
index|[
literal|16
index|]
init|=
block|{
literal|0x12
block|,
literal|0x34
block|,
literal|0x56
block|,
literal|0x78
block|,
literal|0x9a
block|,
literal|0xbc
block|,
literal|0xde
block|,
literal|0xf0
block|,
literal|0x34
block|,
literal|0x56
block|,
literal|0x78
block|,
literal|0x9a
block|,
literal|0xbc
block|,
literal|0xde
block|,
literal|0xf0
block|,
literal|0x12
block|}
decl_stmt|;
specifier|static
specifier|const
name|unsigned
name|char
name|key24
index|[
literal|24
index|]
init|=
block|{
literal|0x12
block|,
literal|0x34
block|,
literal|0x56
block|,
literal|0x78
block|,
literal|0x9a
block|,
literal|0xbc
block|,
literal|0xde
block|,
literal|0xf0
block|,
literal|0x34
block|,
literal|0x56
block|,
literal|0x78
block|,
literal|0x9a
block|,
literal|0xbc
block|,
literal|0xde
block|,
literal|0xf0
block|,
literal|0x12
block|,
literal|0x56
block|,
literal|0x78
block|,
literal|0x9a
block|,
literal|0xbc
block|,
literal|0xde
block|,
literal|0xf0
block|,
literal|0x12
block|,
literal|0x34
block|}
decl_stmt|;
specifier|static
specifier|const
name|unsigned
name|char
name|key32
index|[
literal|32
index|]
init|=
block|{
literal|0x12
block|,
literal|0x34
block|,
literal|0x56
block|,
literal|0x78
block|,
literal|0x9a
block|,
literal|0xbc
block|,
literal|0xde
block|,
literal|0xf0
block|,
literal|0x34
block|,
literal|0x56
block|,
literal|0x78
block|,
literal|0x9a
block|,
literal|0xbc
block|,
literal|0xde
block|,
literal|0xf0
block|,
literal|0x12
block|,
literal|0x56
block|,
literal|0x78
block|,
literal|0x9a
block|,
literal|0xbc
block|,
literal|0xde
block|,
literal|0xf0
block|,
literal|0x12
block|,
literal|0x34
block|,
literal|0x78
block|,
literal|0x9a
block|,
literal|0xbc
block|,
literal|0xde
block|,
literal|0xf0
block|,
literal|0x12
block|,
literal|0x34
block|,
literal|0x56
block|}
decl_stmt|;
ifndef|#
directive|ifndef
name|OPENSSL_NO_AES
define|#
directive|define
name|MAX_BLOCK_SIZE
value|128
else|#
directive|else
define|#
directive|define
name|MAX_BLOCK_SIZE
value|64
endif|#
directive|endif
name|unsigned
name|char
name|DES_iv
index|[
literal|8
index|]
decl_stmt|;
name|unsigned
name|char
name|iv
index|[
name|MAX_BLOCK_SIZE
operator|/
literal|8
index|]
decl_stmt|;
ifndef|#
directive|ifndef
name|OPENSSL_NO_DES
name|DES_cblock
modifier|*
name|buf_as_des_cblock
init|=
name|NULL
decl_stmt|;
specifier|static
name|DES_cblock
name|key
init|=
block|{
literal|0x12
block|,
literal|0x34
block|,
literal|0x56
block|,
literal|0x78
block|,
literal|0x9a
block|,
literal|0xbc
block|,
literal|0xde
block|,
literal|0xf0
block|}
decl_stmt|;
specifier|static
name|DES_cblock
name|key2
init|=
block|{
literal|0x34
block|,
literal|0x56
block|,
literal|0x78
block|,
literal|0x9a
block|,
literal|0xbc
block|,
literal|0xde
block|,
literal|0xf0
block|,
literal|0x12
block|}
decl_stmt|;
specifier|static
name|DES_cblock
name|key3
init|=
block|{
literal|0x56
block|,
literal|0x78
block|,
literal|0x9a
block|,
literal|0xbc
block|,
literal|0xde
block|,
literal|0xf0
block|,
literal|0x12
block|,
literal|0x34
block|}
decl_stmt|;
name|DES_key_schedule
name|sch
decl_stmt|;
name|DES_key_schedule
name|sch2
decl_stmt|;
name|DES_key_schedule
name|sch3
decl_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_AES
name|AES_KEY
name|aes_ks1
decl_stmt|,
name|aes_ks2
decl_stmt|,
name|aes_ks3
decl_stmt|;
endif|#
directive|endif
define|#
directive|define
name|D_MD2
value|0
define|#
directive|define
name|D_MDC2
value|1
define|#
directive|define
name|D_MD4
value|2
define|#
directive|define
name|D_MD5
value|3
define|#
directive|define
name|D_HMAC
value|4
define|#
directive|define
name|D_SHA1
value|5
define|#
directive|define
name|D_RMD160
value|6
define|#
directive|define
name|D_RC4
value|7
define|#
directive|define
name|D_CBC_DES
value|8
define|#
directive|define
name|D_EDE3_DES
value|9
define|#
directive|define
name|D_CBC_IDEA
value|10
define|#
directive|define
name|D_CBC_RC2
value|11
define|#
directive|define
name|D_CBC_RC5
value|12
define|#
directive|define
name|D_CBC_BF
value|13
define|#
directive|define
name|D_CBC_CAST
value|14
define|#
directive|define
name|D_CBC_128_AES
value|15
define|#
directive|define
name|D_CBC_192_AES
value|16
define|#
directive|define
name|D_CBC_256_AES
value|17
define|#
directive|define
name|D_EVP
value|18
name|double
name|d
init|=
literal|0.0
decl_stmt|;
name|long
name|c
index|[
name|ALGOR_NUM
index|]
index|[
name|SIZE_NUM
index|]
decl_stmt|;
define|#
directive|define
name|R_DSA_512
value|0
define|#
directive|define
name|R_DSA_1024
value|1
define|#
directive|define
name|R_DSA_2048
value|2
define|#
directive|define
name|R_RSA_512
value|0
define|#
directive|define
name|R_RSA_1024
value|1
define|#
directive|define
name|R_RSA_2048
value|2
define|#
directive|define
name|R_RSA_4096
value|3
ifndef|#
directive|ifndef
name|OPENSSL_NO_RSA
name|RSA
modifier|*
name|rsa_key
index|[
name|RSA_NUM
index|]
decl_stmt|;
name|long
name|rsa_c
index|[
name|RSA_NUM
index|]
index|[
literal|2
index|]
decl_stmt|;
specifier|static
name|unsigned
name|int
name|rsa_bits
index|[
name|RSA_NUM
index|]
init|=
block|{
literal|512
block|,
literal|1024
block|,
literal|2048
block|,
literal|4096
block|}
decl_stmt|;
specifier|static
name|unsigned
name|char
modifier|*
name|rsa_data
index|[
name|RSA_NUM
index|]
init|=
block|{
name|test512
block|,
name|test1024
block|,
name|test2048
block|,
name|test4096
block|}
decl_stmt|;
specifier|static
name|int
name|rsa_data_length
index|[
name|RSA_NUM
index|]
init|=
block|{
sizeof|sizeof
argument_list|(
name|test512
argument_list|)
block|,
sizeof|sizeof
argument_list|(
name|test1024
argument_list|)
block|,
sizeof|sizeof
argument_list|(
name|test2048
argument_list|)
block|,
expr|sizeof
operator|(
name|test4096
operator|)
block|}
decl_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_DSA
name|DSA
modifier|*
name|dsa_key
index|[
name|DSA_NUM
index|]
decl_stmt|;
name|long
name|dsa_c
index|[
name|DSA_NUM
index|]
index|[
literal|2
index|]
decl_stmt|;
specifier|static
name|unsigned
name|int
name|dsa_bits
index|[
name|DSA_NUM
index|]
init|=
block|{
literal|512
block|,
literal|1024
block|,
literal|2048
block|}
decl_stmt|;
endif|#
directive|endif
name|int
name|rsa_doit
index|[
name|RSA_NUM
index|]
decl_stmt|;
name|int
name|dsa_doit
index|[
name|DSA_NUM
index|]
decl_stmt|;
name|int
name|doit
index|[
name|ALGOR_NUM
index|]
decl_stmt|;
name|int
name|pr_header
init|=
literal|0
decl_stmt|;
specifier|const
name|EVP_CIPHER
modifier|*
name|evp_cipher
init|=
name|NULL
decl_stmt|;
specifier|const
name|EVP_MD
modifier|*
name|evp_md
init|=
name|NULL
decl_stmt|;
name|int
name|decrypt
init|=
literal|0
decl_stmt|;
ifdef|#
directive|ifdef
name|HAVE_FORK
name|int
name|multi
init|=
literal|0
decl_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|TIMES
name|usertime
operator|=
operator|-
literal|1
expr_stmt|;
endif|#
directive|endif
name|apps_startup
argument_list|()
expr_stmt|;
name|memset
argument_list|(
name|results
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|results
argument_list|)
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|OPENSSL_NO_DSA
name|memset
argument_list|(
name|dsa_key
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|dsa_key
argument_list|)
argument_list|)
expr_stmt|;
endif|#
directive|endif
if|if
condition|(
name|bio_err
operator|==
name|NULL
condition|)
if|if
condition|(
operator|(
name|bio_err
operator|=
name|BIO_new
argument_list|(
name|BIO_s_file
argument_list|()
argument_list|)
operator|)
operator|!=
name|NULL
condition|)
name|BIO_set_fp
argument_list|(
name|bio_err
argument_list|,
name|stderr
argument_list|,
name|BIO_NOCLOSE
operator||
name|BIO_FP_TEXT
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|load_config
argument_list|(
name|bio_err
argument_list|,
name|NULL
argument_list|)
condition|)
goto|goto
name|end
goto|;
ifndef|#
directive|ifndef
name|OPENSSL_NO_RSA
name|memset
argument_list|(
name|rsa_key
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|rsa_key
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|RSA_NUM
condition|;
name|i
operator|++
control|)
name|rsa_key
index|[
name|i
index|]
operator|=
name|NULL
expr_stmt|;
endif|#
directive|endif
if|if
condition|(
operator|(
name|buf
operator|=
operator|(
name|unsigned
name|char
operator|*
operator|)
name|OPENSSL_malloc
argument_list|(
operator|(
name|int
operator|)
name|BUFSIZE
argument_list|)
operator|)
operator|==
name|NULL
condition|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"out of memory\n"
argument_list|)
expr_stmt|;
goto|goto
name|end
goto|;
block|}
ifndef|#
directive|ifndef
name|OPENSSL_NO_DES
name|buf_as_des_cblock
operator|=
operator|(
name|DES_cblock
operator|*
operator|)
name|buf
expr_stmt|;
endif|#
directive|endif
if|if
condition|(
operator|(
name|buf2
operator|=
operator|(
name|unsigned
name|char
operator|*
operator|)
name|OPENSSL_malloc
argument_list|(
operator|(
name|int
operator|)
name|BUFSIZE
argument_list|)
operator|)
operator|==
name|NULL
condition|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"out of memory\n"
argument_list|)
expr_stmt|;
goto|goto
name|end
goto|;
block|}
name|memset
argument_list|(
name|c
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|c
argument_list|)
argument_list|)
expr_stmt|;
name|memset
argument_list|(
name|DES_iv
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|DES_iv
argument_list|)
argument_list|)
expr_stmt|;
name|memset
argument_list|(
name|iv
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|iv
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ALGOR_NUM
condition|;
name|i
operator|++
control|)
name|doit
index|[
name|i
index|]
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|RSA_NUM
condition|;
name|i
operator|++
control|)
name|rsa_doit
index|[
name|i
index|]
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|DSA_NUM
condition|;
name|i
operator|++
control|)
name|dsa_doit
index|[
name|i
index|]
operator|=
literal|0
expr_stmt|;
name|j
operator|=
literal|0
expr_stmt|;
name|argc
operator|--
expr_stmt|;
name|argv
operator|++
expr_stmt|;
while|while
condition|(
name|argc
condition|)
block|{
if|if
condition|(
operator|(
name|argc
operator|>
literal|0
operator|)
operator|&&
operator|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"-elapsed"
argument_list|)
operator|==
literal|0
operator|)
condition|)
block|{
name|usertime
operator|=
literal|0
expr_stmt|;
name|j
operator|--
expr_stmt|;
comment|/* Otherwise, -elapsed gets confused with 				   an algorithm. */
block|}
elseif|else
if|if
condition|(
operator|(
name|argc
operator|>
literal|0
operator|)
operator|&&
operator|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"-evp"
argument_list|)
operator|==
literal|0
operator|)
condition|)
block|{
name|argc
operator|--
expr_stmt|;
name|argv
operator|++
expr_stmt|;
if|if
condition|(
name|argc
operator|==
literal|0
condition|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"no EVP given\n"
argument_list|)
expr_stmt|;
goto|goto
name|end
goto|;
block|}
name|evp_cipher
operator|=
name|EVP_get_cipherbyname
argument_list|(
operator|*
name|argv
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|evp_cipher
condition|)
block|{
name|evp_md
operator|=
name|EVP_get_digestbyname
argument_list|(
operator|*
name|argv
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|evp_cipher
operator|&&
operator|!
name|evp_md
condition|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"%s is an unknown cipher or digest\n"
argument_list|,
operator|*
name|argv
argument_list|)
expr_stmt|;
goto|goto
name|end
goto|;
block|}
name|doit
index|[
name|D_EVP
index|]
operator|=
literal|1
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|argc
operator|>
literal|0
operator|&&
operator|!
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"-decrypt"
argument_list|)
condition|)
block|{
name|decrypt
operator|=
literal|1
expr_stmt|;
name|j
operator|--
expr_stmt|;
comment|/* Otherwise, -elapsed gets confused with 				   an algorithm. */
block|}
ifndef|#
directive|ifndef
name|OPENSSL_NO_ENGINE
elseif|else
if|if
condition|(
operator|(
name|argc
operator|>
literal|0
operator|)
operator|&&
operator|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"-engine"
argument_list|)
operator|==
literal|0
operator|)
condition|)
block|{
name|argc
operator|--
expr_stmt|;
name|argv
operator|++
expr_stmt|;
if|if
condition|(
name|argc
operator|==
literal|0
condition|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"no engine given\n"
argument_list|)
expr_stmt|;
goto|goto
name|end
goto|;
block|}
name|e
operator|=
name|setup_engine
argument_list|(
name|bio_err
argument_list|,
operator|*
name|argv
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|/* j will be increased again further down.  We just 			   don't want speed to confuse an engine with an 			   algorithm, especially when none is given (which 			   means all of them should be run) */
name|j
operator|--
expr_stmt|;
block|}
endif|#
directive|endif
ifdef|#
directive|ifdef
name|HAVE_FORK
elseif|else
if|if
condition|(
operator|(
name|argc
operator|>
literal|0
operator|)
operator|&&
operator|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"-multi"
argument_list|)
operator|==
literal|0
operator|)
condition|)
block|{
name|argc
operator|--
expr_stmt|;
name|argv
operator|++
expr_stmt|;
if|if
condition|(
name|argc
operator|==
literal|0
condition|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"no multi count given\n"
argument_list|)
expr_stmt|;
goto|goto
name|end
goto|;
block|}
name|multi
operator|=
name|atoi
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|multi
operator|<=
literal|0
condition|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"bad multi count\n"
argument_list|)
expr_stmt|;
goto|goto
name|end
goto|;
block|}
name|j
operator|--
expr_stmt|;
comment|/* Otherwise, -mr gets confused with 				   an algorithm. */
block|}
endif|#
directive|endif
elseif|else
if|if
condition|(
name|argc
operator|>
literal|0
operator|&&
operator|!
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"-mr"
argument_list|)
condition|)
block|{
name|mr
operator|=
literal|1
expr_stmt|;
name|j
operator|--
expr_stmt|;
comment|/* Otherwise, -mr gets confused with 				   an algorithm. */
block|}
elseif|else
ifndef|#
directive|ifndef
name|OPENSSL_NO_MD2
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"md2"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_MD2
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_MDC2
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"mdc2"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_MDC2
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_MD4
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"md4"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_MD4
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_MD5
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"md5"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_MD5
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_MD5
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"hmac"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_HMAC
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_SHA
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"sha1"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_SHA1
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"sha"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_SHA1
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RIPEMD
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"ripemd"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_RMD160
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"rmd160"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_RMD160
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"ripemd160"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_RMD160
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC4
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"rc4"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_RC4
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_DES
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"des-cbc"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_CBC_DES
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"des-ede3"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_EDE3_DES
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_AES
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"aes-128-cbc"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_CBC_128_AES
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"aes-192-cbc"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_CBC_192_AES
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"aes-256-cbc"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_CBC_256_AES
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RSA
if|#
directive|if
literal|0
comment|/* was: #ifdef RSAref */
elseif|if (strcmp(*argv,"rsaref") == 0)  			{ 			RSA_set_default_openssl_method(RSA_PKCS1_RSAref()); 			j--; 			} 		else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|RSA_NULL
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"openssl"
argument_list|)
operator|==
literal|0
condition|)
block|{
name|RSA_set_default_method
argument_list|(
name|RSA_PKCS1_SSLeay
argument_list|()
argument_list|)
expr_stmt|;
name|j
operator|--
expr_stmt|;
block|}
elseif|else
endif|#
directive|endif
endif|#
directive|endif
comment|/* !OPENSSL_NO_RSA */
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"dsa512"
argument_list|)
operator|==
literal|0
condition|)
name|dsa_doit
index|[
name|R_DSA_512
index|]
operator|=
literal|2
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"dsa1024"
argument_list|)
operator|==
literal|0
condition|)
name|dsa_doit
index|[
name|R_DSA_1024
index|]
operator|=
literal|2
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"dsa2048"
argument_list|)
operator|==
literal|0
condition|)
name|dsa_doit
index|[
name|R_DSA_2048
index|]
operator|=
literal|2
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"rsa512"
argument_list|)
operator|==
literal|0
condition|)
name|rsa_doit
index|[
name|R_RSA_512
index|]
operator|=
literal|2
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"rsa1024"
argument_list|)
operator|==
literal|0
condition|)
name|rsa_doit
index|[
name|R_RSA_1024
index|]
operator|=
literal|2
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"rsa2048"
argument_list|)
operator|==
literal|0
condition|)
name|rsa_doit
index|[
name|R_RSA_2048
index|]
operator|=
literal|2
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"rsa4096"
argument_list|)
operator|==
literal|0
condition|)
name|rsa_doit
index|[
name|R_RSA_4096
index|]
operator|=
literal|2
expr_stmt|;
elseif|else
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC2
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"rc2-cbc"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_CBC_RC2
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"rc2"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_CBC_RC2
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC5
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"rc5-cbc"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_CBC_RC5
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"rc5"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_CBC_RC5
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_IDEA
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"idea-cbc"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_CBC_IDEA
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"idea"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_CBC_IDEA
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_BF
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"bf-cbc"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_CBC_BF
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"blowfish"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_CBC_BF
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"bf"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_CBC_BF
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_CAST
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"cast-cbc"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_CBC_CAST
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"cast"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_CBC_CAST
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"cast5"
argument_list|)
operator|==
literal|0
condition|)
name|doit
index|[
name|D_CBC_CAST
index|]
operator|=
literal|1
expr_stmt|;
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_DES
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"des"
argument_list|)
operator|==
literal|0
condition|)
block|{
name|doit
index|[
name|D_CBC_DES
index|]
operator|=
literal|1
expr_stmt|;
name|doit
index|[
name|D_EDE3_DES
index|]
operator|=
literal|1
expr_stmt|;
block|}
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_AES
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"aes"
argument_list|)
operator|==
literal|0
condition|)
block|{
name|doit
index|[
name|D_CBC_128_AES
index|]
operator|=
literal|1
expr_stmt|;
name|doit
index|[
name|D_CBC_192_AES
index|]
operator|=
literal|1
expr_stmt|;
name|doit
index|[
name|D_CBC_256_AES
index|]
operator|=
literal|1
expr_stmt|;
block|}
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RSA
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"rsa"
argument_list|)
operator|==
literal|0
condition|)
block|{
name|rsa_doit
index|[
name|R_RSA_512
index|]
operator|=
literal|1
expr_stmt|;
name|rsa_doit
index|[
name|R_RSA_1024
index|]
operator|=
literal|1
expr_stmt|;
name|rsa_doit
index|[
name|R_RSA_2048
index|]
operator|=
literal|1
expr_stmt|;
name|rsa_doit
index|[
name|R_RSA_4096
index|]
operator|=
literal|1
expr_stmt|;
block|}
elseif|else
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_DSA
if|if
condition|(
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"dsa"
argument_list|)
operator|==
literal|0
condition|)
block|{
name|dsa_doit
index|[
name|R_DSA_512
index|]
operator|=
literal|1
expr_stmt|;
name|dsa_doit
index|[
name|R_DSA_1024
index|]
operator|=
literal|1
expr_stmt|;
block|}
else|else
endif|#
directive|endif
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"Error: bad option or value\n"
argument_list|)
expr_stmt|;
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"Available values:\n"
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|OPENSSL_NO_MD2
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"md2      "
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_MDC2
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"mdc2     "
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_MD4
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"md4      "
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_MD5
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"md5      "
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|OPENSSL_NO_HMAC
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"hmac     "
argument_list|)
expr_stmt|;
endif|#
directive|endif
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_SHA1
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"sha1     "
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RIPEMD160
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"rmd160"
argument_list|)
expr_stmt|;
endif|#
directive|endif
if|#
directive|if
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_MD2
argument_list|)
operator|||
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_MDC2
argument_list|)
operator|||
expr|\
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_MD4
argument_list|)
operator|||
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_MD5
argument_list|)
operator|||
expr|\
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_SHA1
argument_list|)
operator|||
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_RIPEMD160
argument_list|)
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_IDEA
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"idea-cbc "
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC2
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"rc2-cbc  "
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC5
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"rc5-cbc  "
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_BF
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"bf-cbc"
argument_list|)
expr_stmt|;
endif|#
directive|endif
if|#
directive|if
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_IDEA
argument_list|)
operator|||
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_RC2
argument_list|)
operator|||
expr|\
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_BF
argument_list|)
operator|||
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_RC5
argument_list|)
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_DES
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"des-cbc  des-ede3 "
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_AES
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"aes-128-cbc aes-192-cbc aes-256-cbc "
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC4
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"rc4"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|OPENSSL_NO_RSA
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"rsa512   rsa1024  rsa2048  rsa4096\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_DSA
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"dsa512   dsa1024  dsa2048\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_IDEA
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"idea     "
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC2
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"rc2      "
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_DES
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"des      "
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_AES
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"aes      "
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RSA
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"rsa      "
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_BF
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"blowfish"
argument_list|)
expr_stmt|;
endif|#
directive|endif
if|#
directive|if
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_IDEA
argument_list|)
operator|||
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_RC2
argument_list|)
operator|||
expr|\
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_DES
argument_list|)
operator|||
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_RSA
argument_list|)
operator|||
expr|\
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_BF
argument_list|)
operator|||
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_AES
argument_list|)
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"Available options:\n"
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|TIMES
argument_list|)
operator|||
name|defined
argument_list|(
name|USE_TOD
argument_list|)
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"-elapsed        measure time in real time instead of CPU user time.\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_ENGINE
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"-engine e       use engine e, possibly a hardware device.\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"-evp e          use EVP e.\n"
argument_list|)
expr_stmt|;
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"-decrypt        time decryption instead of encryption (only EVP).\n"
argument_list|)
expr_stmt|;
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"-mr             produce machine readable output.\n"
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|HAVE_FORK
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"-multi n        run n benchmarks in parallel.\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
goto|goto
name|end
goto|;
block|}
name|argc
operator|--
expr_stmt|;
name|argv
operator|++
expr_stmt|;
name|j
operator|++
expr_stmt|;
block|}
ifdef|#
directive|ifdef
name|HAVE_FORK
if|if
condition|(
name|multi
operator|&&
name|do_multi
argument_list|(
name|multi
argument_list|)
condition|)
goto|goto
name|show_res
goto|;
endif|#
directive|endif
if|if
condition|(
name|j
operator|==
literal|0
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ALGOR_NUM
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|i
operator|!=
name|D_EVP
condition|)
name|doit
index|[
name|i
index|]
operator|=
literal|1
expr_stmt|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|RSA_NUM
condition|;
name|i
operator|++
control|)
name|rsa_doit
index|[
name|i
index|]
operator|=
literal|1
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|DSA_NUM
condition|;
name|i
operator|++
control|)
name|dsa_doit
index|[
name|i
index|]
operator|=
literal|1
expr_stmt|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ALGOR_NUM
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|doit
index|[
name|i
index|]
condition|)
name|pr_header
operator|++
expr_stmt|;
if|if
condition|(
name|usertime
operator|==
literal|0
operator|&&
operator|!
name|mr
condition|)
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"You have chosen to measure elapsed time instead of user CPU time.\n"
argument_list|)
expr_stmt|;
if|if
condition|(
name|usertime
operator|<=
literal|0
operator|&&
operator|!
name|mr
condition|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"To get the most accurate results, try to run this\n"
argument_list|)
expr_stmt|;
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"program when this computer is idle.\n"
argument_list|)
expr_stmt|;
block|}
ifndef|#
directive|ifndef
name|OPENSSL_NO_RSA
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|RSA_NUM
condition|;
name|i
operator|++
control|)
block|{
specifier|const
name|unsigned
name|char
modifier|*
name|p
decl_stmt|;
name|p
operator|=
name|rsa_data
index|[
name|i
index|]
expr_stmt|;
name|rsa_key
index|[
name|i
index|]
operator|=
name|d2i_RSAPrivateKey
argument_list|(
name|NULL
argument_list|,
operator|&
name|p
argument_list|,
name|rsa_data_length
index|[
name|i
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|rsa_key
index|[
name|i
index|]
operator|==
name|NULL
condition|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"internal error loading RSA key number %d\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
goto|goto
name|end
goto|;
block|}
if|#
directive|if
literal|0
block|else 			{ 			BIO_printf(bio_err,mr ? "+RK:%d:" 				   : "Loaded RSA key, %d bit modulus and e= 0x", 				   BN_num_bits(rsa_key[i]->n)); 			BN_print(bio_err,rsa_key[i]->e); 			BIO_printf(bio_err,"\n"); 			}
endif|#
directive|endif
block|}
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_DSA
name|dsa_key
index|[
literal|0
index|]
operator|=
name|get_dsa512
argument_list|()
expr_stmt|;
name|dsa_key
index|[
literal|1
index|]
operator|=
name|get_dsa1024
argument_list|()
expr_stmt|;
name|dsa_key
index|[
literal|2
index|]
operator|=
name|get_dsa2048
argument_list|()
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_DES
name|DES_set_key_unchecked
argument_list|(
operator|&
name|key
argument_list|,
operator|&
name|sch
argument_list|)
expr_stmt|;
name|DES_set_key_unchecked
argument_list|(
operator|&
name|key2
argument_list|,
operator|&
name|sch2
argument_list|)
expr_stmt|;
name|DES_set_key_unchecked
argument_list|(
operator|&
name|key3
argument_list|,
operator|&
name|sch3
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_AES
name|AES_set_encrypt_key
argument_list|(
name|key16
argument_list|,
literal|128
argument_list|,
operator|&
name|aes_ks1
argument_list|)
expr_stmt|;
name|AES_set_encrypt_key
argument_list|(
name|key24
argument_list|,
literal|192
argument_list|,
operator|&
name|aes_ks2
argument_list|)
expr_stmt|;
name|AES_set_encrypt_key
argument_list|(
name|key32
argument_list|,
literal|256
argument_list|,
operator|&
name|aes_ks3
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_IDEA
name|idea_set_encrypt_key
argument_list|(
name|key16
argument_list|,
operator|&
name|idea_ks
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC4
name|RC4_set_key
argument_list|(
operator|&
name|rc4_ks
argument_list|,
literal|16
argument_list|,
name|key16
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC2
name|RC2_set_key
argument_list|(
operator|&
name|rc2_ks
argument_list|,
literal|16
argument_list|,
name|key16
argument_list|,
literal|128
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC5
name|RC5_32_set_key
argument_list|(
operator|&
name|rc5_ks
argument_list|,
literal|16
argument_list|,
name|key16
argument_list|,
literal|12
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_BF
name|BF_set_key
argument_list|(
operator|&
name|bf_ks
argument_list|,
literal|16
argument_list|,
name|key16
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_CAST
name|CAST_set_key
argument_list|(
operator|&
name|cast_ks
argument_list|,
literal|16
argument_list|,
name|key16
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RSA
name|memset
argument_list|(
name|rsa_c
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|rsa_c
argument_list|)
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|SIGALRM
ifndef|#
directive|ifndef
name|OPENSSL_NO_DES
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"First we calculate the approximate speed ...\n"
argument_list|)
expr_stmt|;
name|count
operator|=
literal|10
expr_stmt|;
do|do
block|{
name|long
name|i
decl_stmt|;
name|count
operator|*=
literal|2
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
name|count
init|;
name|i
condition|;
name|i
operator|--
control|)
name|DES_ecb_encrypt
argument_list|(
name|buf_as_des_cblock
argument_list|,
name|buf_as_des_cblock
argument_list|,
operator|&
name|sch
argument_list|,
name|DES_ENCRYPT
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
block|}
do|while
condition|(
name|d
operator|<
literal|3
condition|)
do|;
name|save_count
operator|=
name|count
expr_stmt|;
name|c
index|[
name|D_MD2
index|]
index|[
literal|0
index|]
operator|=
name|count
operator|/
literal|10
expr_stmt|;
name|c
index|[
name|D_MDC2
index|]
index|[
literal|0
index|]
operator|=
name|count
operator|/
literal|10
expr_stmt|;
name|c
index|[
name|D_MD4
index|]
index|[
literal|0
index|]
operator|=
name|count
expr_stmt|;
name|c
index|[
name|D_MD5
index|]
index|[
literal|0
index|]
operator|=
name|count
expr_stmt|;
name|c
index|[
name|D_HMAC
index|]
index|[
literal|0
index|]
operator|=
name|count
expr_stmt|;
name|c
index|[
name|D_SHA1
index|]
index|[
literal|0
index|]
operator|=
name|count
expr_stmt|;
name|c
index|[
name|D_RMD160
index|]
index|[
literal|0
index|]
operator|=
name|count
expr_stmt|;
name|c
index|[
name|D_RC4
index|]
index|[
literal|0
index|]
operator|=
name|count
operator|*
literal|5
expr_stmt|;
name|c
index|[
name|D_CBC_DES
index|]
index|[
literal|0
index|]
operator|=
name|count
expr_stmt|;
name|c
index|[
name|D_EDE3_DES
index|]
index|[
literal|0
index|]
operator|=
name|count
operator|/
literal|3
expr_stmt|;
name|c
index|[
name|D_CBC_IDEA
index|]
index|[
literal|0
index|]
operator|=
name|count
expr_stmt|;
name|c
index|[
name|D_CBC_RC2
index|]
index|[
literal|0
index|]
operator|=
name|count
expr_stmt|;
name|c
index|[
name|D_CBC_RC5
index|]
index|[
literal|0
index|]
operator|=
name|count
expr_stmt|;
name|c
index|[
name|D_CBC_BF
index|]
index|[
literal|0
index|]
operator|=
name|count
expr_stmt|;
name|c
index|[
name|D_CBC_CAST
index|]
index|[
literal|0
index|]
operator|=
name|count
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<
name|SIZE_NUM
condition|;
name|i
operator|++
control|)
block|{
name|c
index|[
name|D_MD2
index|]
index|[
name|i
index|]
operator|=
name|c
index|[
name|D_MD2
index|]
index|[
literal|0
index|]
operator|*
literal|4
operator|*
name|lengths
index|[
literal|0
index|]
operator|/
name|lengths
index|[
name|i
index|]
expr_stmt|;
name|c
index|[
name|D_MDC2
index|]
index|[
name|i
index|]
operator|=
name|c
index|[
name|D_MDC2
index|]
index|[
literal|0
index|]
operator|*
literal|4
operator|*
name|lengths
index|[
literal|0
index|]
operator|/
name|lengths
index|[
name|i
index|]
expr_stmt|;
name|c
index|[
name|D_MD4
index|]
index|[
name|i
index|]
operator|=
name|c
index|[
name|D_MD4
index|]
index|[
literal|0
index|]
operator|*
literal|4
operator|*
name|lengths
index|[
literal|0
index|]
operator|/
name|lengths
index|[
name|i
index|]
expr_stmt|;
name|c
index|[
name|D_MD5
index|]
index|[
name|i
index|]
operator|=
name|c
index|[
name|D_MD5
index|]
index|[
literal|0
index|]
operator|*
literal|4
operator|*
name|lengths
index|[
literal|0
index|]
operator|/
name|lengths
index|[
name|i
index|]
expr_stmt|;
name|c
index|[
name|D_HMAC
index|]
index|[
name|i
index|]
operator|=
name|c
index|[
name|D_HMAC
index|]
index|[
literal|0
index|]
operator|*
literal|4
operator|*
name|lengths
index|[
literal|0
index|]
operator|/
name|lengths
index|[
name|i
index|]
expr_stmt|;
name|c
index|[
name|D_SHA1
index|]
index|[
name|i
index|]
operator|=
name|c
index|[
name|D_SHA1
index|]
index|[
literal|0
index|]
operator|*
literal|4
operator|*
name|lengths
index|[
literal|0
index|]
operator|/
name|lengths
index|[
name|i
index|]
expr_stmt|;
name|c
index|[
name|D_RMD160
index|]
index|[
name|i
index|]
operator|=
name|c
index|[
name|D_RMD160
index|]
index|[
literal|0
index|]
operator|*
literal|4
operator|*
name|lengths
index|[
literal|0
index|]
operator|/
name|lengths
index|[
name|i
index|]
expr_stmt|;
block|}
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<
name|SIZE_NUM
condition|;
name|i
operator|++
control|)
block|{
name|long
name|l0
decl_stmt|,
name|l1
decl_stmt|;
name|l0
operator|=
operator|(
name|long
operator|)
name|lengths
index|[
name|i
operator|-
literal|1
index|]
expr_stmt|;
name|l1
operator|=
operator|(
name|long
operator|)
name|lengths
index|[
name|i
index|]
expr_stmt|;
name|c
index|[
name|D_RC4
index|]
index|[
name|i
index|]
operator|=
name|c
index|[
name|D_RC4
index|]
index|[
name|i
operator|-
literal|1
index|]
operator|*
name|l0
operator|/
name|l1
expr_stmt|;
name|c
index|[
name|D_CBC_DES
index|]
index|[
name|i
index|]
operator|=
name|c
index|[
name|D_CBC_DES
index|]
index|[
name|i
operator|-
literal|1
index|]
operator|*
name|l0
operator|/
name|l1
expr_stmt|;
name|c
index|[
name|D_EDE3_DES
index|]
index|[
name|i
index|]
operator|=
name|c
index|[
name|D_EDE3_DES
index|]
index|[
name|i
operator|-
literal|1
index|]
operator|*
name|l0
operator|/
name|l1
expr_stmt|;
name|c
index|[
name|D_CBC_IDEA
index|]
index|[
name|i
index|]
operator|=
name|c
index|[
name|D_CBC_IDEA
index|]
index|[
name|i
operator|-
literal|1
index|]
operator|*
name|l0
operator|/
name|l1
expr_stmt|;
name|c
index|[
name|D_CBC_RC2
index|]
index|[
name|i
index|]
operator|=
name|c
index|[
name|D_CBC_RC2
index|]
index|[
name|i
operator|-
literal|1
index|]
operator|*
name|l0
operator|/
name|l1
expr_stmt|;
name|c
index|[
name|D_CBC_RC5
index|]
index|[
name|i
index|]
operator|=
name|c
index|[
name|D_CBC_RC5
index|]
index|[
name|i
operator|-
literal|1
index|]
operator|*
name|l0
operator|/
name|l1
expr_stmt|;
name|c
index|[
name|D_CBC_BF
index|]
index|[
name|i
index|]
operator|=
name|c
index|[
name|D_CBC_BF
index|]
index|[
name|i
operator|-
literal|1
index|]
operator|*
name|l0
operator|/
name|l1
expr_stmt|;
name|c
index|[
name|D_CBC_CAST
index|]
index|[
name|i
index|]
operator|=
name|c
index|[
name|D_CBC_CAST
index|]
index|[
name|i
operator|-
literal|1
index|]
operator|*
name|l0
operator|/
name|l1
expr_stmt|;
block|}
ifndef|#
directive|ifndef
name|OPENSSL_NO_RSA
name|rsa_c
index|[
name|R_RSA_512
index|]
index|[
literal|0
index|]
operator|=
name|count
operator|/
literal|2000
expr_stmt|;
name|rsa_c
index|[
name|R_RSA_512
index|]
index|[
literal|1
index|]
operator|=
name|count
operator|/
literal|400
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<
name|RSA_NUM
condition|;
name|i
operator|++
control|)
block|{
name|rsa_c
index|[
name|i
index|]
index|[
literal|0
index|]
operator|=
name|rsa_c
index|[
name|i
operator|-
literal|1
index|]
index|[
literal|0
index|]
operator|/
literal|8
expr_stmt|;
name|rsa_c
index|[
name|i
index|]
index|[
literal|1
index|]
operator|=
name|rsa_c
index|[
name|i
operator|-
literal|1
index|]
index|[
literal|1
index|]
operator|/
literal|4
expr_stmt|;
if|if
condition|(
operator|(
name|rsa_doit
index|[
name|i
index|]
operator|<=
literal|1
operator|)
operator|&&
operator|(
name|rsa_c
index|[
name|i
index|]
index|[
literal|0
index|]
operator|==
literal|0
operator|)
condition|)
name|rsa_doit
index|[
name|i
index|]
operator|=
literal|0
expr_stmt|;
else|else
block|{
if|if
condition|(
name|rsa_c
index|[
name|i
index|]
index|[
literal|0
index|]
operator|==
literal|0
condition|)
block|{
name|rsa_c
index|[
name|i
index|]
index|[
literal|0
index|]
operator|=
literal|1
expr_stmt|;
name|rsa_c
index|[
name|i
index|]
index|[
literal|1
index|]
operator|=
literal|20
expr_stmt|;
block|}
block|}
block|}
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_DSA
name|dsa_c
index|[
name|R_DSA_512
index|]
index|[
literal|0
index|]
operator|=
name|count
operator|/
literal|1000
expr_stmt|;
name|dsa_c
index|[
name|R_DSA_512
index|]
index|[
literal|1
index|]
operator|=
name|count
operator|/
literal|1000
operator|/
literal|2
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<
name|DSA_NUM
condition|;
name|i
operator|++
control|)
block|{
name|dsa_c
index|[
name|i
index|]
index|[
literal|0
index|]
operator|=
name|dsa_c
index|[
name|i
operator|-
literal|1
index|]
index|[
literal|0
index|]
operator|/
literal|4
expr_stmt|;
name|dsa_c
index|[
name|i
index|]
index|[
literal|1
index|]
operator|=
name|dsa_c
index|[
name|i
operator|-
literal|1
index|]
index|[
literal|1
index|]
operator|/
literal|4
expr_stmt|;
if|if
condition|(
operator|(
name|dsa_doit
index|[
name|i
index|]
operator|<=
literal|1
operator|)
operator|&&
operator|(
name|dsa_c
index|[
name|i
index|]
index|[
literal|0
index|]
operator|==
literal|0
operator|)
condition|)
name|dsa_doit
index|[
name|i
index|]
operator|=
literal|0
expr_stmt|;
else|else
block|{
if|if
condition|(
name|dsa_c
index|[
name|i
index|]
operator|==
literal|0
condition|)
block|{
name|dsa_c
index|[
name|i
index|]
index|[
literal|0
index|]
operator|=
literal|1
expr_stmt|;
name|dsa_c
index|[
name|i
index|]
index|[
literal|1
index|]
operator|=
literal|1
expr_stmt|;
block|}
block|}
block|}
endif|#
directive|endif
define|#
directive|define
name|COND
parameter_list|(
name|d
parameter_list|)
value|(count< (d))
define|#
directive|define
name|COUNT
parameter_list|(
name|d
parameter_list|)
value|(d)
else|#
directive|else
comment|/* not worth fixing */
error|#
directive|error
literal|"You cannot disable DES on systems without SIGALRM."
endif|#
directive|endif
comment|/* OPENSSL_NO_DES */
else|#
directive|else
define|#
directive|define
name|COND
parameter_list|(
name|c
parameter_list|)
value|(run)
define|#
directive|define
name|COUNT
parameter_list|(
name|d
parameter_list|)
value|(count)
name|signal
argument_list|(
name|SIGALRM
argument_list|,
name|sig_done
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* SIGALRM */
ifndef|#
directive|ifndef
name|OPENSSL_NO_MD2
if|if
condition|(
name|doit
index|[
name|D_MD2
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_MD2
index|]
argument_list|,
name|c
index|[
name|D_MD2
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_MD2
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|EVP_Digest
argument_list|(
name|buf
argument_list|,
operator|(
name|unsigned
name|long
operator|)
name|lengths
index|[
name|j
index|]
argument_list|,
operator|&
operator|(
name|md2
index|[
literal|0
index|]
operator|)
argument_list|,
name|NULL
argument_list|,
name|EVP_md2
argument_list|()
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_MD2
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_MDC2
if|if
condition|(
name|doit
index|[
name|D_MDC2
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_MDC2
index|]
argument_list|,
name|c
index|[
name|D_MDC2
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_MDC2
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|EVP_Digest
argument_list|(
name|buf
argument_list|,
operator|(
name|unsigned
name|long
operator|)
name|lengths
index|[
name|j
index|]
argument_list|,
operator|&
operator|(
name|mdc2
index|[
literal|0
index|]
operator|)
argument_list|,
name|NULL
argument_list|,
name|EVP_mdc2
argument_list|()
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_MDC2
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_MD4
if|if
condition|(
name|doit
index|[
name|D_MD4
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_MD4
index|]
argument_list|,
name|c
index|[
name|D_MD4
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_MD4
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|EVP_Digest
argument_list|(
operator|&
operator|(
name|buf
index|[
literal|0
index|]
operator|)
argument_list|,
operator|(
name|unsigned
name|long
operator|)
name|lengths
index|[
name|j
index|]
argument_list|,
operator|&
operator|(
name|md4
index|[
literal|0
index|]
operator|)
argument_list|,
name|NULL
argument_list|,
name|EVP_md4
argument_list|()
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_MD4
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_MD5
if|if
condition|(
name|doit
index|[
name|D_MD5
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_MD5
index|]
argument_list|,
name|c
index|[
name|D_MD5
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_MD5
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|EVP_Digest
argument_list|(
operator|&
operator|(
name|buf
index|[
literal|0
index|]
operator|)
argument_list|,
operator|(
name|unsigned
name|long
operator|)
name|lengths
index|[
name|j
index|]
argument_list|,
operator|&
operator|(
name|md5
index|[
literal|0
index|]
operator|)
argument_list|,
name|NULL
argument_list|,
name|EVP_get_digestbyname
argument_list|(
literal|"md5"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_MD5
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
endif|#
directive|endif
if|#
directive|if
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_MD5
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_HMAC
argument_list|)
if|if
condition|(
name|doit
index|[
name|D_HMAC
index|]
condition|)
block|{
name|HMAC_CTX
name|hctx
decl_stmt|;
name|HMAC_CTX_init
argument_list|(
operator|&
name|hctx
argument_list|)
expr_stmt|;
name|HMAC_Init_ex
argument_list|(
operator|&
name|hctx
argument_list|,
operator|(
name|unsigned
name|char
operator|*
operator|)
literal|"This is a key..."
argument_list|,
literal|16
argument_list|,
name|EVP_md5
argument_list|()
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_HMAC
index|]
argument_list|,
name|c
index|[
name|D_HMAC
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_HMAC
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
block|{
name|HMAC_Init_ex
argument_list|(
operator|&
name|hctx
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|HMAC_Update
argument_list|(
operator|&
name|hctx
argument_list|,
name|buf
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|HMAC_Final
argument_list|(
operator|&
name|hctx
argument_list|,
operator|&
operator|(
name|hmac
index|[
literal|0
index|]
operator|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_HMAC
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
name|HMAC_CTX_cleanup
argument_list|(
operator|&
name|hctx
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_SHA
if|if
condition|(
name|doit
index|[
name|D_SHA1
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_SHA1
index|]
argument_list|,
name|c
index|[
name|D_SHA1
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_SHA1
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|EVP_Digest
argument_list|(
name|buf
argument_list|,
operator|(
name|unsigned
name|long
operator|)
name|lengths
index|[
name|j
index|]
argument_list|,
operator|&
operator|(
name|sha
index|[
literal|0
index|]
operator|)
argument_list|,
name|NULL
argument_list|,
name|EVP_sha1
argument_list|()
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_SHA1
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RIPEMD
if|if
condition|(
name|doit
index|[
name|D_RMD160
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_RMD160
index|]
argument_list|,
name|c
index|[
name|D_RMD160
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_RMD160
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|EVP_Digest
argument_list|(
name|buf
argument_list|,
operator|(
name|unsigned
name|long
operator|)
name|lengths
index|[
name|j
index|]
argument_list|,
operator|&
operator|(
name|rmd160
index|[
literal|0
index|]
operator|)
argument_list|,
name|NULL
argument_list|,
name|EVP_ripemd160
argument_list|()
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_RMD160
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC4
if|if
condition|(
name|doit
index|[
name|D_RC4
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_RC4
index|]
argument_list|,
name|c
index|[
name|D_RC4
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_RC4
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|RC4
argument_list|(
operator|&
name|rc4_ks
argument_list|,
operator|(
name|unsigned
name|int
operator|)
name|lengths
index|[
name|j
index|]
argument_list|,
name|buf
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_RC4
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_DES
if|if
condition|(
name|doit
index|[
name|D_CBC_DES
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_CBC_DES
index|]
argument_list|,
name|c
index|[
name|D_CBC_DES
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_CBC_DES
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|DES_ncbc_encrypt
argument_list|(
name|buf
argument_list|,
name|buf
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|,
operator|&
name|sch
argument_list|,
operator|&
name|DES_iv
argument_list|,
name|DES_ENCRYPT
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_CBC_DES
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|doit
index|[
name|D_EDE3_DES
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_EDE3_DES
index|]
argument_list|,
name|c
index|[
name|D_EDE3_DES
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_EDE3_DES
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|DES_ede3_cbc_encrypt
argument_list|(
name|buf
argument_list|,
name|buf
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|,
operator|&
name|sch
argument_list|,
operator|&
name|sch2
argument_list|,
operator|&
name|sch3
argument_list|,
operator|&
name|DES_iv
argument_list|,
name|DES_ENCRYPT
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_EDE3_DES
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_AES
if|if
condition|(
name|doit
index|[
name|D_CBC_128_AES
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_CBC_128_AES
index|]
argument_list|,
name|c
index|[
name|D_CBC_128_AES
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_CBC_128_AES
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|AES_cbc_encrypt
argument_list|(
name|buf
argument_list|,
name|buf
argument_list|,
operator|(
name|unsigned
name|long
operator|)
name|lengths
index|[
name|j
index|]
argument_list|,
operator|&
name|aes_ks1
argument_list|,
name|iv
argument_list|,
name|AES_ENCRYPT
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_CBC_128_AES
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|doit
index|[
name|D_CBC_192_AES
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_CBC_192_AES
index|]
argument_list|,
name|c
index|[
name|D_CBC_192_AES
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_CBC_192_AES
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|AES_cbc_encrypt
argument_list|(
name|buf
argument_list|,
name|buf
argument_list|,
operator|(
name|unsigned
name|long
operator|)
name|lengths
index|[
name|j
index|]
argument_list|,
operator|&
name|aes_ks2
argument_list|,
name|iv
argument_list|,
name|AES_ENCRYPT
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_CBC_192_AES
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|doit
index|[
name|D_CBC_256_AES
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_CBC_256_AES
index|]
argument_list|,
name|c
index|[
name|D_CBC_256_AES
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_CBC_256_AES
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|AES_cbc_encrypt
argument_list|(
name|buf
argument_list|,
name|buf
argument_list|,
operator|(
name|unsigned
name|long
operator|)
name|lengths
index|[
name|j
index|]
argument_list|,
operator|&
name|aes_ks3
argument_list|,
name|iv
argument_list|,
name|AES_ENCRYPT
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_CBC_256_AES
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_IDEA
if|if
condition|(
name|doit
index|[
name|D_CBC_IDEA
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_CBC_IDEA
index|]
argument_list|,
name|c
index|[
name|D_CBC_IDEA
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_CBC_IDEA
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|idea_cbc_encrypt
argument_list|(
name|buf
argument_list|,
name|buf
argument_list|,
operator|(
name|unsigned
name|long
operator|)
name|lengths
index|[
name|j
index|]
argument_list|,
operator|&
name|idea_ks
argument_list|,
name|iv
argument_list|,
name|IDEA_ENCRYPT
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_CBC_IDEA
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC2
if|if
condition|(
name|doit
index|[
name|D_CBC_RC2
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_CBC_RC2
index|]
argument_list|,
name|c
index|[
name|D_CBC_RC2
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_CBC_RC2
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|RC2_cbc_encrypt
argument_list|(
name|buf
argument_list|,
name|buf
argument_list|,
operator|(
name|unsigned
name|long
operator|)
name|lengths
index|[
name|j
index|]
argument_list|,
operator|&
name|rc2_ks
argument_list|,
name|iv
argument_list|,
name|RC2_ENCRYPT
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_CBC_RC2
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC5
if|if
condition|(
name|doit
index|[
name|D_CBC_RC5
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_CBC_RC5
index|]
argument_list|,
name|c
index|[
name|D_CBC_RC5
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_CBC_RC5
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|RC5_32_cbc_encrypt
argument_list|(
name|buf
argument_list|,
name|buf
argument_list|,
operator|(
name|unsigned
name|long
operator|)
name|lengths
index|[
name|j
index|]
argument_list|,
operator|&
name|rc5_ks
argument_list|,
name|iv
argument_list|,
name|RC5_ENCRYPT
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_CBC_RC5
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_BF
if|if
condition|(
name|doit
index|[
name|D_CBC_BF
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_CBC_BF
index|]
argument_list|,
name|c
index|[
name|D_CBC_BF
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_CBC_BF
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|BF_cbc_encrypt
argument_list|(
name|buf
argument_list|,
name|buf
argument_list|,
operator|(
name|unsigned
name|long
operator|)
name|lengths
index|[
name|j
index|]
argument_list|,
operator|&
name|bf_ks
argument_list|,
name|iv
argument_list|,
name|BF_ENCRYPT
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_CBC_BF
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_CAST
if|if
condition|(
name|doit
index|[
name|D_CBC_CAST
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
name|print_message
argument_list|(
name|names
index|[
name|D_CBC_CAST
index|]
argument_list|,
name|c
index|[
name|D_CBC_CAST
index|]
index|[
name|j
index|]
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|c
index|[
name|D_CBC_CAST
index|]
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|CAST_cbc_encrypt
argument_list|(
name|buf
argument_list|,
name|buf
argument_list|,
operator|(
name|unsigned
name|long
operator|)
name|lengths
index|[
name|j
index|]
argument_list|,
operator|&
name|cast_ks
argument_list|,
name|iv
argument_list|,
name|CAST_ENCRYPT
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|print_result
argument_list|(
name|D_CBC_CAST
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
endif|#
directive|endif
if|if
condition|(
name|doit
index|[
name|D_EVP
index|]
condition|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
if|if
condition|(
name|evp_cipher
condition|)
block|{
name|EVP_CIPHER_CTX
name|ctx
decl_stmt|;
name|int
name|outl
decl_stmt|;
name|names
index|[
name|D_EVP
index|]
operator|=
name|OBJ_nid2ln
argument_list|(
name|evp_cipher
operator|->
name|nid
argument_list|)
expr_stmt|;
comment|/* -O3 -fschedule-insns messes up an 				 * optimization here!  names[D_EVP] 				 * somehow becomes NULL */
name|print_message
argument_list|(
name|names
index|[
name|D_EVP
index|]
argument_list|,
name|save_count
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|EVP_CIPHER_CTX_init
argument_list|(
operator|&
name|ctx
argument_list|)
expr_stmt|;
if|if
condition|(
name|decrypt
condition|)
name|EVP_DecryptInit_ex
argument_list|(
operator|&
name|ctx
argument_list|,
name|evp_cipher
argument_list|,
name|NULL
argument_list|,
name|key16
argument_list|,
name|iv
argument_list|)
expr_stmt|;
else|else
name|EVP_EncryptInit_ex
argument_list|(
operator|&
name|ctx
argument_list|,
name|evp_cipher
argument_list|,
name|NULL
argument_list|,
name|key16
argument_list|,
name|iv
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
if|if
condition|(
name|decrypt
condition|)
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|save_count
operator|*
literal|4
operator|*
name|lengths
index|[
literal|0
index|]
operator|/
name|lengths
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|EVP_DecryptUpdate
argument_list|(
operator|&
name|ctx
argument_list|,
name|buf
argument_list|,
operator|&
name|outl
argument_list|,
name|buf
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
else|else
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|save_count
operator|*
literal|4
operator|*
name|lengths
index|[
literal|0
index|]
operator|/
name|lengths
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|EVP_EncryptUpdate
argument_list|(
operator|&
name|ctx
argument_list|,
name|buf
argument_list|,
operator|&
name|outl
argument_list|,
name|buf
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|decrypt
condition|)
name|EVP_DecryptFinal_ex
argument_list|(
operator|&
name|ctx
argument_list|,
name|buf
argument_list|,
operator|&
name|outl
argument_list|)
expr_stmt|;
else|else
name|EVP_EncryptFinal_ex
argument_list|(
operator|&
name|ctx
argument_list|,
name|buf
argument_list|,
operator|&
name|outl
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|EVP_CIPHER_CTX_cleanup
argument_list|(
operator|&
name|ctx
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|evp_md
condition|)
block|{
name|names
index|[
name|D_EVP
index|]
operator|=
name|OBJ_nid2ln
argument_list|(
name|evp_md
operator|->
name|type
argument_list|)
expr_stmt|;
name|print_message
argument_list|(
name|names
index|[
name|D_EVP
index|]
argument_list|,
name|save_count
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|save_count
operator|*
literal|4
operator|*
name|lengths
index|[
literal|0
index|]
operator|/
name|lengths
index|[
name|j
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
name|EVP_Digest
argument_list|(
name|buf
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|,
operator|&
operator|(
name|md
index|[
literal|0
index|]
operator|)
argument_list|,
name|NULL
argument_list|,
name|evp_md
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
block|}
name|print_result
argument_list|(
name|D_EVP
argument_list|,
name|j
argument_list|,
name|count
argument_list|,
name|d
argument_list|)
expr_stmt|;
block|}
block|}
name|RAND_pseudo_bytes
argument_list|(
name|buf
argument_list|,
literal|36
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|OPENSSL_NO_RSA
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|RSA_NUM
condition|;
name|j
operator|++
control|)
block|{
name|int
name|ret
decl_stmt|;
if|if
condition|(
operator|!
name|rsa_doit
index|[
name|j
index|]
condition|)
continue|continue;
name|ret
operator|=
name|RSA_sign
argument_list|(
name|NID_md5_sha1
argument_list|,
name|buf
argument_list|,
literal|36
argument_list|,
name|buf2
argument_list|,
operator|&
name|rsa_num
argument_list|,
name|rsa_key
index|[
name|j
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"RSA sign failure.  No RSA sign will be done.\n"
argument_list|)
expr_stmt|;
name|ERR_print_errors
argument_list|(
name|bio_err
argument_list|)
expr_stmt|;
name|rsa_count
operator|=
literal|1
expr_stmt|;
block|}
else|else
block|{
name|pkey_print_message
argument_list|(
literal|"private"
argument_list|,
literal|"rsa"
argument_list|,
name|rsa_c
index|[
name|j
index|]
index|[
literal|0
index|]
argument_list|,
name|rsa_bits
index|[
name|j
index|]
argument_list|,
name|RSA_SECONDS
argument_list|)
expr_stmt|;
comment|/*			RSA_blinding_on(rsa_key[j],NULL); */
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|rsa_c
index|[
name|j
index|]
index|[
literal|0
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
block|{
name|ret
operator|=
name|RSA_sign
argument_list|(
name|NID_md5_sha1
argument_list|,
name|buf
argument_list|,
literal|36
argument_list|,
name|buf2
argument_list|,
operator|&
name|rsa_num
argument_list|,
name|rsa_key
index|[
name|j
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"RSA sign failure\n"
argument_list|)
expr_stmt|;
name|ERR_print_errors
argument_list|(
name|bio_err
argument_list|)
expr_stmt|;
name|count
operator|=
literal|1
expr_stmt|;
break|break;
block|}
block|}
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
name|mr
condition|?
literal|"+R1:%ld:%d:%.2f\n"
else|:
literal|"%ld %d bit private RSA's in %.2fs\n"
argument_list|,
name|count
argument_list|,
name|rsa_bits
index|[
name|j
index|]
argument_list|,
name|d
argument_list|)
expr_stmt|;
name|rsa_results
index|[
name|j
index|]
index|[
literal|0
index|]
operator|=
name|d
operator|/
operator|(
name|double
operator|)
name|count
expr_stmt|;
name|rsa_count
operator|=
name|count
expr_stmt|;
block|}
if|#
directive|if
literal|1
name|ret
operator|=
name|RSA_verify
argument_list|(
name|NID_md5_sha1
argument_list|,
name|buf
argument_list|,
literal|36
argument_list|,
name|buf2
argument_list|,
name|rsa_num
argument_list|,
name|rsa_key
index|[
name|j
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
operator|<=
literal|0
condition|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"RSA verify failure.  No RSA verify will be done.\n"
argument_list|)
expr_stmt|;
name|ERR_print_errors
argument_list|(
name|bio_err
argument_list|)
expr_stmt|;
name|rsa_doit
index|[
name|j
index|]
operator|=
literal|0
expr_stmt|;
block|}
else|else
block|{
name|pkey_print_message
argument_list|(
literal|"public"
argument_list|,
literal|"rsa"
argument_list|,
name|rsa_c
index|[
name|j
index|]
index|[
literal|1
index|]
argument_list|,
name|rsa_bits
index|[
name|j
index|]
argument_list|,
name|RSA_SECONDS
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|rsa_c
index|[
name|j
index|]
index|[
literal|1
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
block|{
name|ret
operator|=
name|RSA_verify
argument_list|(
name|NID_md5_sha1
argument_list|,
name|buf
argument_list|,
literal|36
argument_list|,
name|buf2
argument_list|,
name|rsa_num
argument_list|,
name|rsa_key
index|[
name|j
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"RSA verify failure\n"
argument_list|)
expr_stmt|;
name|ERR_print_errors
argument_list|(
name|bio_err
argument_list|)
expr_stmt|;
name|count
operator|=
literal|1
expr_stmt|;
break|break;
block|}
block|}
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
name|mr
condition|?
literal|"+R2:%ld:%d:%.2f\n"
else|:
literal|"%ld %d bit public RSA's in %.2fs\n"
argument_list|,
name|count
argument_list|,
name|rsa_bits
index|[
name|j
index|]
argument_list|,
name|d
argument_list|)
expr_stmt|;
name|rsa_results
index|[
name|j
index|]
index|[
literal|1
index|]
operator|=
name|d
operator|/
operator|(
name|double
operator|)
name|count
expr_stmt|;
block|}
endif|#
directive|endif
if|if
condition|(
name|rsa_count
operator|<=
literal|1
condition|)
block|{
comment|/* if longer than 10s, don't do any more */
for|for
control|(
name|j
operator|++
init|;
name|j
operator|<
name|RSA_NUM
condition|;
name|j
operator|++
control|)
name|rsa_doit
index|[
name|j
index|]
operator|=
literal|0
expr_stmt|;
block|}
block|}
endif|#
directive|endif
name|RAND_pseudo_bytes
argument_list|(
name|buf
argument_list|,
literal|20
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|OPENSSL_NO_DSA
if|if
condition|(
name|RAND_status
argument_list|()
operator|!=
literal|1
condition|)
block|{
name|RAND_seed
argument_list|(
name|rnd_seed
argument_list|,
sizeof|sizeof
name|rnd_seed
argument_list|)
expr_stmt|;
name|rnd_fake
operator|=
literal|1
expr_stmt|;
block|}
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|DSA_NUM
condition|;
name|j
operator|++
control|)
block|{
name|unsigned
name|int
name|kk
decl_stmt|;
name|int
name|ret
decl_stmt|;
if|if
condition|(
operator|!
name|dsa_doit
index|[
name|j
index|]
condition|)
continue|continue;
comment|/*		DSA_generate_key(dsa_key[j]); */
comment|/*		DSA_sign_setup(dsa_key[j],NULL); */
name|ret
operator|=
name|DSA_sign
argument_list|(
name|EVP_PKEY_DSA
argument_list|,
name|buf
argument_list|,
literal|20
argument_list|,
name|buf2
argument_list|,
operator|&
name|kk
argument_list|,
name|dsa_key
index|[
name|j
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"DSA sign failure.  No DSA sign will be done.\n"
argument_list|)
expr_stmt|;
name|ERR_print_errors
argument_list|(
name|bio_err
argument_list|)
expr_stmt|;
name|rsa_count
operator|=
literal|1
expr_stmt|;
block|}
else|else
block|{
name|pkey_print_message
argument_list|(
literal|"sign"
argument_list|,
literal|"dsa"
argument_list|,
name|dsa_c
index|[
name|j
index|]
index|[
literal|0
index|]
argument_list|,
name|dsa_bits
index|[
name|j
index|]
argument_list|,
name|DSA_SECONDS
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|dsa_c
index|[
name|j
index|]
index|[
literal|0
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
block|{
name|ret
operator|=
name|DSA_sign
argument_list|(
name|EVP_PKEY_DSA
argument_list|,
name|buf
argument_list|,
literal|20
argument_list|,
name|buf2
argument_list|,
operator|&
name|kk
argument_list|,
name|dsa_key
index|[
name|j
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"DSA sign failure\n"
argument_list|)
expr_stmt|;
name|ERR_print_errors
argument_list|(
name|bio_err
argument_list|)
expr_stmt|;
name|count
operator|=
literal|1
expr_stmt|;
break|break;
block|}
block|}
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
name|mr
condition|?
literal|"+R3:%ld:%d:%.2f\n"
else|:
literal|"%ld %d bit DSA signs in %.2fs\n"
argument_list|,
name|count
argument_list|,
name|dsa_bits
index|[
name|j
index|]
argument_list|,
name|d
argument_list|)
expr_stmt|;
name|dsa_results
index|[
name|j
index|]
index|[
literal|0
index|]
operator|=
name|d
operator|/
operator|(
name|double
operator|)
name|count
expr_stmt|;
name|rsa_count
operator|=
name|count
expr_stmt|;
block|}
name|ret
operator|=
name|DSA_verify
argument_list|(
name|EVP_PKEY_DSA
argument_list|,
name|buf
argument_list|,
literal|20
argument_list|,
name|buf2
argument_list|,
name|kk
argument_list|,
name|dsa_key
index|[
name|j
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
operator|<=
literal|0
condition|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"DSA verify failure.  No DSA verify will be done.\n"
argument_list|)
expr_stmt|;
name|ERR_print_errors
argument_list|(
name|bio_err
argument_list|)
expr_stmt|;
name|dsa_doit
index|[
name|j
index|]
operator|=
literal|0
expr_stmt|;
block|}
else|else
block|{
name|pkey_print_message
argument_list|(
literal|"verify"
argument_list|,
literal|"dsa"
argument_list|,
name|dsa_c
index|[
name|j
index|]
index|[
literal|1
index|]
argument_list|,
name|dsa_bits
index|[
name|j
index|]
argument_list|,
name|DSA_SECONDS
argument_list|)
expr_stmt|;
name|Time_F
argument_list|(
name|START
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
operator|,
name|run
operator|=
literal|1
init|;
name|COND
argument_list|(
name|dsa_c
index|[
name|j
index|]
index|[
literal|1
index|]
argument_list|)
condition|;
name|count
operator|++
control|)
block|{
name|ret
operator|=
name|DSA_verify
argument_list|(
name|EVP_PKEY_DSA
argument_list|,
name|buf
argument_list|,
literal|20
argument_list|,
name|buf2
argument_list|,
name|kk
argument_list|,
name|dsa_key
index|[
name|j
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
operator|<=
literal|0
condition|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
literal|"DSA verify failure\n"
argument_list|)
expr_stmt|;
name|ERR_print_errors
argument_list|(
name|bio_err
argument_list|)
expr_stmt|;
name|count
operator|=
literal|1
expr_stmt|;
break|break;
block|}
block|}
name|d
operator|=
name|Time_F
argument_list|(
name|STOP
argument_list|)
expr_stmt|;
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
name|mr
condition|?
literal|"+R4:%ld:%d:%.2f\n"
else|:
literal|"%ld %d bit DSA verify in %.2fs\n"
argument_list|,
name|count
argument_list|,
name|dsa_bits
index|[
name|j
index|]
argument_list|,
name|d
argument_list|)
expr_stmt|;
name|dsa_results
index|[
name|j
index|]
index|[
literal|1
index|]
operator|=
name|d
operator|/
operator|(
name|double
operator|)
name|count
expr_stmt|;
block|}
if|if
condition|(
name|rsa_count
operator|<=
literal|1
condition|)
block|{
comment|/* if longer than 10s, don't do any more */
for|for
control|(
name|j
operator|++
init|;
name|j
operator|<
name|DSA_NUM
condition|;
name|j
operator|++
control|)
name|dsa_doit
index|[
name|j
index|]
operator|=
literal|0
expr_stmt|;
block|}
block|}
if|if
condition|(
name|rnd_fake
condition|)
name|RAND_cleanup
argument_list|()
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|HAVE_FORK
name|show_res
label|:
endif|#
directive|endif
if|if
condition|(
operator|!
name|mr
condition|)
block|{
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"%s\n"
argument_list|,
name|SSLeay_version
argument_list|(
name|SSLEAY_VERSION
argument_list|)
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"%s\n"
argument_list|,
name|SSLeay_version
argument_list|(
name|SSLEAY_BUILT_ON
argument_list|)
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"options:"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"%s "
argument_list|,
name|BN_options
argument_list|()
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|OPENSSL_NO_MD2
name|printf
argument_list|(
literal|"%s "
argument_list|,
name|MD2_options
argument_list|()
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_RC4
name|printf
argument_list|(
literal|"%s "
argument_list|,
name|RC4_options
argument_list|()
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_DES
name|printf
argument_list|(
literal|"%s "
argument_list|,
name|DES_options
argument_list|()
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_AES
name|printf
argument_list|(
literal|"%s "
argument_list|,
name|AES_options
argument_list|()
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_IDEA
name|printf
argument_list|(
literal|"%s "
argument_list|,
name|idea_options
argument_list|()
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_BF
name|printf
argument_list|(
literal|"%s "
argument_list|,
name|BF_options
argument_list|()
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\n%s\n"
argument_list|,
name|SSLeay_version
argument_list|(
name|SSLEAY_CFLAGS
argument_list|)
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"available timing options: "
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|TIMES
name|printf
argument_list|(
literal|"TIMES "
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|TIMEB
name|printf
argument_list|(
literal|"TIMEB "
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|USE_TOD
name|printf
argument_list|(
literal|"USE_TOD "
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|HZ
define|#
directive|define
name|as_string
parameter_list|(
name|s
parameter_list|)
value|(#s)
name|printf
argument_list|(
literal|"HZ=%g"
argument_list|,
operator|(
name|double
operator|)
name|HZ
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|_SC_CLK_TCK
name|printf
argument_list|(
literal|" [sysconf value]"
argument_list|)
expr_stmt|;
endif|#
directive|endif
endif|#
directive|endif
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"timing function used: %s%s%s%s%s%s%s\n"
argument_list|,
operator|(
name|ftime_used
condition|?
literal|"ftime"
else|:
literal|""
operator|)
argument_list|,
operator|(
name|ftime_used
operator|+
name|times_used
operator|>
literal|1
condition|?
literal|","
else|:
literal|""
operator|)
argument_list|,
operator|(
name|times_used
condition|?
literal|"times"
else|:
literal|""
operator|)
argument_list|,
operator|(
name|ftime_used
operator|+
name|times_used
operator|+
name|gettimeofday_used
operator|>
literal|1
condition|?
literal|","
else|:
literal|""
operator|)
argument_list|,
operator|(
name|gettimeofday_used
condition|?
literal|"gettimeofday"
else|:
literal|""
operator|)
argument_list|,
operator|(
name|ftime_used
operator|+
name|times_used
operator|+
name|gettimeofday_used
operator|+
name|getrusage_used
operator|>
literal|1
condition|?
literal|","
else|:
literal|""
operator|)
argument_list|,
operator|(
name|getrusage_used
condition|?
literal|"getrusage"
else|:
literal|""
operator|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|pr_header
condition|)
block|{
if|if
condition|(
name|mr
condition|)
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"+H"
argument_list|)
expr_stmt|;
else|else
block|{
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"The 'numbers' are in 1000s of bytes per second processed.\n"
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"type        "
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
name|fprintf
argument_list|(
name|stdout
argument_list|,
name|mr
condition|?
literal|":%d"
else|:
literal|"%7d bytes"
argument_list|,
name|lengths
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|k
operator|=
literal|0
init|;
name|k
operator|<
name|ALGOR_NUM
condition|;
name|k
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|doit
index|[
name|k
index|]
condition|)
continue|continue;
if|if
condition|(
name|mr
condition|)
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"+F:%d:%s"
argument_list|,
name|k
argument_list|,
name|names
index|[
name|k
index|]
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"%-13s"
argument_list|,
name|names
index|[
name|k
index|]
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
name|j
operator|++
control|)
block|{
if|if
condition|(
name|results
index|[
name|k
index|]
index|[
name|j
index|]
operator|>
literal|10000
operator|&&
operator|!
name|mr
condition|)
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|" %11.2fk"
argument_list|,
name|results
index|[
name|k
index|]
index|[
name|j
index|]
operator|/
literal|1e3
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|stdout
argument_list|,
name|mr
condition|?
literal|":%.2f"
else|:
literal|" %11.2f "
argument_list|,
name|results
index|[
name|k
index|]
index|[
name|j
index|]
argument_list|)
expr_stmt|;
block|}
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
ifndef|#
directive|ifndef
name|OPENSSL_NO_RSA
name|j
operator|=
literal|1
expr_stmt|;
for|for
control|(
name|k
operator|=
literal|0
init|;
name|k
operator|<
name|RSA_NUM
condition|;
name|k
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|rsa_doit
index|[
name|k
index|]
condition|)
continue|continue;
if|if
condition|(
name|j
operator|&&
operator|!
name|mr
condition|)
block|{
name|printf
argument_list|(
literal|"%18ssign    verify    sign/s verify/s\n"
argument_list|,
literal|" "
argument_list|)
expr_stmt|;
name|j
operator|=
literal|0
expr_stmt|;
block|}
if|if
condition|(
name|mr
condition|)
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"+F2:%u:%u:%f:%f\n"
argument_list|,
name|k
argument_list|,
name|rsa_bits
index|[
name|k
index|]
argument_list|,
name|rsa_results
index|[
name|k
index|]
index|[
literal|0
index|]
argument_list|,
name|rsa_results
index|[
name|k
index|]
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"rsa %4u bits %8.4fs %8.4fs %8.1f %8.1f\n"
argument_list|,
name|rsa_bits
index|[
name|k
index|]
argument_list|,
name|rsa_results
index|[
name|k
index|]
index|[
literal|0
index|]
argument_list|,
name|rsa_results
index|[
name|k
index|]
index|[
literal|1
index|]
argument_list|,
literal|1.0
operator|/
name|rsa_results
index|[
name|k
index|]
index|[
literal|0
index|]
argument_list|,
literal|1.0
operator|/
name|rsa_results
index|[
name|k
index|]
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_DSA
name|j
operator|=
literal|1
expr_stmt|;
for|for
control|(
name|k
operator|=
literal|0
init|;
name|k
operator|<
name|DSA_NUM
condition|;
name|k
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|dsa_doit
index|[
name|k
index|]
condition|)
continue|continue;
if|if
condition|(
name|j
operator|&&
operator|!
name|mr
condition|)
block|{
name|printf
argument_list|(
literal|"%18ssign    verify    sign/s verify/s\n"
argument_list|,
literal|" "
argument_list|)
expr_stmt|;
name|j
operator|=
literal|0
expr_stmt|;
block|}
if|if
condition|(
name|mr
condition|)
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"+F3:%u:%u:%f:%f\n"
argument_list|,
name|k
argument_list|,
name|dsa_bits
index|[
name|k
index|]
argument_list|,
name|dsa_results
index|[
name|k
index|]
index|[
literal|0
index|]
argument_list|,
name|dsa_results
index|[
name|k
index|]
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"dsa %4u bits %8.4fs %8.4fs %8.1f %8.1f\n"
argument_list|,
name|dsa_bits
index|[
name|k
index|]
argument_list|,
name|dsa_results
index|[
name|k
index|]
index|[
literal|0
index|]
argument_list|,
name|dsa_results
index|[
name|k
index|]
index|[
literal|1
index|]
argument_list|,
literal|1.0
operator|/
name|dsa_results
index|[
name|k
index|]
index|[
literal|0
index|]
argument_list|,
literal|1.0
operator|/
name|dsa_results
index|[
name|k
index|]
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
name|mret
operator|=
literal|0
expr_stmt|;
name|end
label|:
name|ERR_print_errors
argument_list|(
name|bio_err
argument_list|)
expr_stmt|;
if|if
condition|(
name|buf
operator|!=
name|NULL
condition|)
name|OPENSSL_free
argument_list|(
name|buf
argument_list|)
expr_stmt|;
if|if
condition|(
name|buf2
operator|!=
name|NULL
condition|)
name|OPENSSL_free
argument_list|(
name|buf2
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|OPENSSL_NO_RSA
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|RSA_NUM
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|rsa_key
index|[
name|i
index|]
operator|!=
name|NULL
condition|)
name|RSA_free
argument_list|(
name|rsa_key
index|[
name|i
index|]
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|OPENSSL_NO_DSA
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|DSA_NUM
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|dsa_key
index|[
name|i
index|]
operator|!=
name|NULL
condition|)
name|DSA_free
argument_list|(
name|dsa_key
index|[
name|i
index|]
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|apps_shutdown
argument_list|()
expr_stmt|;
name|OPENSSL_EXIT
argument_list|(
name|mret
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|print_message
parameter_list|(
specifier|const
name|char
modifier|*
name|s
parameter_list|,
name|long
name|num
parameter_list|,
name|int
name|length
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|SIGALRM
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
name|mr
condition|?
literal|"+DT:%s:%d:%d\n"
else|:
literal|"Doing %s for %ds on %d size blocks: "
argument_list|,
name|s
argument_list|,
name|SECONDS
argument_list|,
name|length
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|BIO_flush
argument_list|(
name|bio_err
argument_list|)
expr_stmt|;
name|alarm
argument_list|(
name|SECONDS
argument_list|)
expr_stmt|;
else|#
directive|else
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
name|mr
condition|?
literal|"+DN:%s:%ld:%d\n"
else|:
literal|"Doing %s %ld times on %d size blocks: "
argument_list|,
name|s
argument_list|,
name|num
argument_list|,
name|length
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|BIO_flush
argument_list|(
name|bio_err
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|LINT
name|num
operator|=
name|num
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|pkey_print_message
parameter_list|(
name|char
modifier|*
name|str
parameter_list|,
name|char
modifier|*
name|str2
parameter_list|,
name|long
name|num
parameter_list|,
name|int
name|bits
parameter_list|,
name|int
name|tm
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|SIGALRM
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
name|mr
condition|?
literal|"+DTP:%d:%s:%s:%d\n"
else|:
literal|"Doing %d bit %s %s's for %ds: "
argument_list|,
name|bits
argument_list|,
name|str
argument_list|,
name|str2
argument_list|,
name|tm
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|BIO_flush
argument_list|(
name|bio_err
argument_list|)
expr_stmt|;
name|alarm
argument_list|(
name|RSA_SECONDS
argument_list|)
expr_stmt|;
else|#
directive|else
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
name|mr
condition|?
literal|"+DNP:%ld:%d:%s:%s\n"
else|:
literal|"Doing %ld %d bit %s %s's: "
argument_list|,
name|num
argument_list|,
name|bits
argument_list|,
name|str
argument_list|,
name|str2
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|BIO_flush
argument_list|(
name|bio_err
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|LINT
name|num
operator|=
name|num
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|print_result
parameter_list|(
name|int
name|alg
parameter_list|,
name|int
name|run_no
parameter_list|,
name|int
name|count
parameter_list|,
name|double
name|time_used
parameter_list|)
block|{
name|BIO_printf
argument_list|(
name|bio_err
argument_list|,
name|mr
condition|?
literal|"+R:%ld:%s:%f\n"
else|:
literal|"%ld %s's in %.2fs\n"
argument_list|,
name|count
argument_list|,
name|names
index|[
name|alg
index|]
argument_list|,
name|time_used
argument_list|)
expr_stmt|;
name|results
index|[
name|alg
index|]
index|[
name|run_no
index|]
operator|=
operator|(
operator|(
name|double
operator|)
name|count
operator|)
operator|/
name|time_used
operator|*
name|lengths
index|[
name|run_no
index|]
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|char
modifier|*
name|sstrsep
parameter_list|(
name|char
modifier|*
modifier|*
name|string
parameter_list|,
specifier|const
name|char
modifier|*
name|delim
parameter_list|)
block|{
name|char
name|isdelim
index|[
literal|256
index|]
decl_stmt|;
name|char
modifier|*
name|token
init|=
operator|*
name|string
decl_stmt|;
if|if
condition|(
operator|*
operator|*
name|string
operator|==
literal|0
condition|)
return|return
name|NULL
return|;
name|memset
argument_list|(
name|isdelim
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
name|isdelim
argument_list|)
expr_stmt|;
name|isdelim
index|[
literal|0
index|]
operator|=
literal|1
expr_stmt|;
while|while
condition|(
operator|*
name|delim
condition|)
block|{
name|isdelim
index|[
call|(
name|unsigned
name|char
call|)
argument_list|(
operator|*
name|delim
argument_list|)
index|]
operator|=
literal|1
expr_stmt|;
name|delim
operator|++
expr_stmt|;
block|}
while|while
condition|(
operator|!
name|isdelim
index|[
call|(
name|unsigned
name|char
call|)
argument_list|(
operator|*
operator|*
name|string
argument_list|)
index|]
condition|)
block|{
operator|(
operator|*
name|string
operator|)
operator|++
expr_stmt|;
block|}
if|if
condition|(
operator|*
operator|*
name|string
condition|)
block|{
operator|*
operator|*
name|string
operator|=
literal|0
expr_stmt|;
operator|(
operator|*
name|string
operator|)
operator|++
expr_stmt|;
block|}
return|return
name|token
return|;
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|HAVE_FORK
end_ifdef

begin_function
specifier|static
name|int
name|do_multi
parameter_list|(
name|int
name|multi
parameter_list|)
block|{
name|int
name|n
decl_stmt|;
name|int
name|fd
index|[
literal|2
index|]
decl_stmt|;
name|int
modifier|*
name|fds
decl_stmt|;
specifier|static
name|char
name|sep
index|[]
init|=
literal|":"
decl_stmt|;
name|fds
operator|=
name|malloc
argument_list|(
name|multi
operator|*
sizeof|sizeof
expr|*
name|fds
argument_list|)
expr_stmt|;
for|for
control|(
name|n
operator|=
literal|0
init|;
name|n
operator|<
name|multi
condition|;
operator|++
name|n
control|)
block|{
name|pipe
argument_list|(
name|fd
argument_list|)
expr_stmt|;
if|if
condition|(
name|fork
argument_list|()
condition|)
block|{
name|close
argument_list|(
name|fd
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|fds
index|[
name|n
index|]
operator|=
name|fd
index|[
literal|0
index|]
expr_stmt|;
block|}
else|else
block|{
name|close
argument_list|(
name|fd
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|close
argument_list|(
literal|1
argument_list|)
expr_stmt|;
name|dup
argument_list|(
name|fd
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|close
argument_list|(
name|fd
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|mr
operator|=
literal|1
expr_stmt|;
name|usertime
operator|=
literal|0
expr_stmt|;
return|return
literal|0
return|;
block|}
name|printf
argument_list|(
literal|"Forked child %d\n"
argument_list|,
name|n
argument_list|)
expr_stmt|;
block|}
comment|/* for now, assume the pipe is long enough to take all the output */
for|for
control|(
name|n
operator|=
literal|0
init|;
name|n
operator|<
name|multi
condition|;
operator|++
name|n
control|)
block|{
name|FILE
modifier|*
name|f
decl_stmt|;
name|char
name|buf
index|[
literal|1024
index|]
decl_stmt|;
name|char
modifier|*
name|p
decl_stmt|;
name|f
operator|=
name|fdopen
argument_list|(
name|fds
index|[
name|n
index|]
argument_list|,
literal|"r"
argument_list|)
expr_stmt|;
while|while
condition|(
name|fgets
argument_list|(
name|buf
argument_list|,
sizeof|sizeof
name|buf
argument_list|,
name|f
argument_list|)
condition|)
block|{
name|p
operator|=
name|strchr
argument_list|(
name|buf
argument_list|,
literal|'\n'
argument_list|)
expr_stmt|;
if|if
condition|(
name|p
condition|)
operator|*
name|p
operator|=
literal|'\0'
expr_stmt|;
if|if
condition|(
name|buf
index|[
literal|0
index|]
operator|!=
literal|'+'
condition|)
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Don't understand line '%s' from child %d\n"
argument_list|,
name|buf
argument_list|,
name|n
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|printf
argument_list|(
literal|"Got: %s from %d\n"
argument_list|,
name|buf
argument_list|,
name|n
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|strncmp
argument_list|(
name|buf
argument_list|,
literal|"+F:"
argument_list|,
literal|3
argument_list|)
condition|)
block|{
name|int
name|alg
decl_stmt|;
name|int
name|j
decl_stmt|;
name|p
operator|=
name|buf
operator|+
literal|3
expr_stmt|;
name|alg
operator|=
name|atoi
argument_list|(
name|sstrsep
argument_list|(
operator|&
name|p
argument_list|,
name|sep
argument_list|)
argument_list|)
expr_stmt|;
name|sstrsep
argument_list|(
operator|&
name|p
argument_list|,
name|sep
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|SIZE_NUM
condition|;
operator|++
name|j
control|)
name|results
index|[
name|alg
index|]
index|[
name|j
index|]
operator|+=
name|atof
argument_list|(
name|sstrsep
argument_list|(
operator|&
name|p
argument_list|,
name|sep
argument_list|)
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|!
name|strncmp
argument_list|(
name|buf
argument_list|,
literal|"+F2:"
argument_list|,
literal|4
argument_list|)
condition|)
block|{
name|int
name|k
decl_stmt|;
name|double
name|d
decl_stmt|;
name|p
operator|=
name|buf
operator|+
literal|4
expr_stmt|;
name|k
operator|=
name|atoi
argument_list|(
name|sstrsep
argument_list|(
operator|&
name|p
argument_list|,
name|sep
argument_list|)
argument_list|)
expr_stmt|;
name|sstrsep
argument_list|(
operator|&
name|p
argument_list|,
name|sep
argument_list|)
expr_stmt|;
name|d
operator|=
name|atof
argument_list|(
name|sstrsep
argument_list|(
operator|&
name|p
argument_list|,
name|sep
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|n
condition|)
name|rsa_results
index|[
name|k
index|]
index|[
literal|0
index|]
operator|=
literal|1
operator|/
operator|(
literal|1
operator|/
name|rsa_results
index|[
name|k
index|]
index|[
literal|0
index|]
operator|+
literal|1
operator|/
name|d
operator|)
expr_stmt|;
else|else
name|rsa_results
index|[
name|k
index|]
index|[
literal|0
index|]
operator|=
name|d
expr_stmt|;
name|d
operator|=
name|atof
argument_list|(
name|sstrsep
argument_list|(
operator|&
name|p
argument_list|,
name|sep
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|n
condition|)
name|rsa_results
index|[
name|k
index|]
index|[
literal|1
index|]
operator|=
literal|1
operator|/
operator|(
literal|1
operator|/
name|rsa_results
index|[
name|k
index|]
index|[
literal|1
index|]
operator|+
literal|1
operator|/
name|d
operator|)
expr_stmt|;
else|else
name|rsa_results
index|[
name|k
index|]
index|[
literal|1
index|]
operator|=
name|d
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|!
name|strncmp
argument_list|(
name|buf
argument_list|,
literal|"+F2:"
argument_list|,
literal|4
argument_list|)
condition|)
block|{
name|int
name|k
decl_stmt|;
name|double
name|d
decl_stmt|;
name|p
operator|=
name|buf
operator|+
literal|4
expr_stmt|;
name|k
operator|=
name|atoi
argument_list|(
name|sstrsep
argument_list|(
operator|&
name|p
argument_list|,
name|sep
argument_list|)
argument_list|)
expr_stmt|;
name|sstrsep
argument_list|(
operator|&
name|p
argument_list|,
name|sep
argument_list|)
expr_stmt|;
name|d
operator|=
name|atof
argument_list|(
name|sstrsep
argument_list|(
operator|&
name|p
argument_list|,
name|sep
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|n
condition|)
name|rsa_results
index|[
name|k
index|]
index|[
literal|0
index|]
operator|=
literal|1
operator|/
operator|(
literal|1
operator|/
name|rsa_results
index|[
name|k
index|]
index|[
literal|0
index|]
operator|+
literal|1
operator|/
name|d
operator|)
expr_stmt|;
else|else
name|rsa_results
index|[
name|k
index|]
index|[
literal|0
index|]
operator|=
name|d
expr_stmt|;
name|d
operator|=
name|atof
argument_list|(
name|sstrsep
argument_list|(
operator|&
name|p
argument_list|,
name|sep
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|n
condition|)
name|rsa_results
index|[
name|k
index|]
index|[
literal|1
index|]
operator|=
literal|1
operator|/
operator|(
literal|1
operator|/
name|rsa_results
index|[
name|k
index|]
index|[
literal|1
index|]
operator|+
literal|1
operator|/
name|d
operator|)
expr_stmt|;
else|else
name|rsa_results
index|[
name|k
index|]
index|[
literal|1
index|]
operator|=
name|d
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|!
name|strncmp
argument_list|(
name|buf
argument_list|,
literal|"+F3:"
argument_list|,
literal|4
argument_list|)
condition|)
block|{
name|int
name|k
decl_stmt|;
name|double
name|d
decl_stmt|;
name|p
operator|=
name|buf
operator|+
literal|4
expr_stmt|;
name|k
operator|=
name|atoi
argument_list|(
name|sstrsep
argument_list|(
operator|&
name|p
argument_list|,
name|sep
argument_list|)
argument_list|)
expr_stmt|;
name|sstrsep
argument_list|(
operator|&
name|p
argument_list|,
name|sep
argument_list|)
expr_stmt|;
name|d
operator|=
name|atof
argument_list|(
name|sstrsep
argument_list|(
operator|&
name|p
argument_list|,
name|sep
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|n
condition|)
name|dsa_results
index|[
name|k
index|]
index|[
literal|0
index|]
operator|=
literal|1
operator|/
operator|(
literal|1
operator|/
name|dsa_results
index|[
name|k
index|]
index|[
literal|0
index|]
operator|+
literal|1
operator|/
name|d
operator|)
expr_stmt|;
else|else
name|dsa_results
index|[
name|k
index|]
index|[
literal|0
index|]
operator|=
name|d
expr_stmt|;
name|d
operator|=
name|atof
argument_list|(
name|sstrsep
argument_list|(
operator|&
name|p
argument_list|,
name|sep
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|n
condition|)
name|dsa_results
index|[
name|k
index|]
index|[
literal|1
index|]
operator|=
literal|1
operator|/
operator|(
literal|1
operator|/
name|dsa_results
index|[
name|k
index|]
index|[
literal|1
index|]
operator|+
literal|1
operator|/
name|d
operator|)
expr_stmt|;
else|else
name|dsa_results
index|[
name|k
index|]
index|[
literal|1
index|]
operator|=
name|d
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|!
name|strncmp
argument_list|(
name|buf
argument_list|,
literal|"+H:"
argument_list|,
literal|3
argument_list|)
condition|)
block|{ 				}
else|else
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Unknown type '%s' from child %d\n"
argument_list|,
name|buf
argument_list|,
name|n
argument_list|)
expr_stmt|;
block|}
block|}
return|return
literal|1
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

end_unit

