begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* ssl/ssl_stat.c */
end_comment

begin_comment
comment|/* Copyright (C) 1995-1998 Eric Young (eay@cryptsoft.com)  * All rights reserved.  *  * This package is an SSL implementation written  * by Eric Young (eay@cryptsoft.com).  * The implementation was written so as to conform with Netscapes SSL.  *   * This library is free for commercial and non-commercial use as long as  * the following conditions are aheared to.  The following conditions  * apply to all code found in this distribution, be it the RC4, RSA,  * lhash, DES, etc., code; not just the SSL code.  The SSL documentation  * included with this distribution is covered by the same copyright terms  * except that the holder is Tim Hudson (tjh@cryptsoft.com).  *   * Copyright remains Eric Young's, and as such any Copyright notices in  * the code are not to be removed.  * If this package is used in a product, Eric Young should be given attribution  * as the author of the parts of the library used.  * This can be in the form of a textual message at program startup or  * in documentation (online or textual) provided with the package.  *   * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  * 3. All advertising materials mentioning features or use of this software  *    must display the following acknowledgement:  *    "This product includes cryptographic software written by  *     Eric Young (eay@cryptsoft.com)"  *    The word 'cryptographic' can be left out if the rouines from the library  *    being used are not cryptographic related :-).  * 4. If you include any Windows specific code (or a derivative thereof) from   *    the apps directory (application code) you must include an acknowledgement:  *    "This product includes software written by Tim Hudson (tjh@cryptsoft.com)"  *   * THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  *   * The licence and distribution terms for any publically available version or  * derivative of this code cannot be changed.  i.e. this code cannot simply be  * copied and put under another distribution licence  * [including the GNU Public Licence.]  */
end_comment

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|"ssl_locl.h"
end_include

begin_function
name|char
modifier|*
name|SSL_state_string_long
parameter_list|(
name|SSL
modifier|*
name|s
parameter_list|)
block|{
name|char
modifier|*
name|str
decl_stmt|;
switch|switch
condition|(
name|s
operator|->
name|state
condition|)
block|{
case|case
name|SSL_ST_BEFORE
case|:
name|str
operator|=
literal|"before SSL initialization"
expr_stmt|;
break|break;
case|case
name|SSL_ST_ACCEPT
case|:
name|str
operator|=
literal|"before accept initialization"
expr_stmt|;
break|break;
case|case
name|SSL_ST_CONNECT
case|:
name|str
operator|=
literal|"before connect initialization"
expr_stmt|;
break|break;
case|case
name|SSL_ST_OK
case|:
name|str
operator|=
literal|"SSL negotiation finished successfully"
expr_stmt|;
break|break;
case|case
name|SSL_ST_RENEGOTIATE
case|:
name|str
operator|=
literal|"SSL renegotiate ciphers"
expr_stmt|;
break|break;
case|case
name|SSL_ST_BEFORE
operator||
name|SSL_ST_CONNECT
case|:
name|str
operator|=
literal|"before/connect initialization"
expr_stmt|;
break|break;
case|case
name|SSL_ST_OK
operator||
name|SSL_ST_CONNECT
case|:
name|str
operator|=
literal|"ok/connect SSL initialization"
expr_stmt|;
break|break;
case|case
name|SSL_ST_BEFORE
operator||
name|SSL_ST_ACCEPT
case|:
name|str
operator|=
literal|"before/accept initialization"
expr_stmt|;
break|break;
case|case
name|SSL_ST_OK
operator||
name|SSL_ST_ACCEPT
case|:
name|str
operator|=
literal|"ok/accept SSL initialization"
expr_stmt|;
break|break;
ifndef|#
directive|ifndef
name|NO_SSL2
case|case
name|SSL2_ST_CLIENT_START_ENCRYPTION
case|:
name|str
operator|=
literal|"SSLv2 client start encryption"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SERVER_START_ENCRYPTION
case|:
name|str
operator|=
literal|"SSLv2 server start encryption"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_HELLO_A
case|:
name|str
operator|=
literal|"SSLv2 write client hello A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_HELLO_B
case|:
name|str
operator|=
literal|"SSLv2 write client hello B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_SERVER_HELLO_A
case|:
name|str
operator|=
literal|"SSLv2 read server hello A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_SERVER_HELLO_B
case|:
name|str
operator|=
literal|"SSLv2 read server hello B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_MASTER_KEY_A
case|:
name|str
operator|=
literal|"SSLv2 write client master key A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_MASTER_KEY_B
case|:
name|str
operator|=
literal|"SSLv2 write client master key B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_FINISHED_A
case|:
name|str
operator|=
literal|"SSLv2 write client finished A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_FINISHED_B
case|:
name|str
operator|=
literal|"SSLv2 write client finished B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_CERTIFICATE_A
case|:
name|str
operator|=
literal|"SSLv2 write client certificate A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_CERTIFICATE_B
case|:
name|str
operator|=
literal|"SSLv2 write client certificate B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_CERTIFICATE_C
case|:
name|str
operator|=
literal|"SSLv2 write client certificate C"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_CERTIFICATE_D
case|:
name|str
operator|=
literal|"SSLv2 write client certificate D"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_SERVER_VERIFY_A
case|:
name|str
operator|=
literal|"SSLv2 read server verify A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_SERVER_VERIFY_B
case|:
name|str
operator|=
literal|"SSLv2 read server verify B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_SERVER_FINISHED_A
case|:
name|str
operator|=
literal|"SSLv2 read server finished A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_SERVER_FINISHED_B
case|:
name|str
operator|=
literal|"SSLv2 read server finished B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_CLIENT_HELLO_A
case|:
name|str
operator|=
literal|"SSLv2 read client hello A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_CLIENT_HELLO_B
case|:
name|str
operator|=
literal|"SSLv2 read client hello B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_CLIENT_HELLO_C
case|:
name|str
operator|=
literal|"SSLv2 read client hello C"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_SERVER_HELLO_A
case|:
name|str
operator|=
literal|"SSLv2 write server hello A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_SERVER_HELLO_B
case|:
name|str
operator|=
literal|"SSLv2 write server hello B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_CLIENT_MASTER_KEY_A
case|:
name|str
operator|=
literal|"SSLv2 read client master key A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_CLIENT_MASTER_KEY_B
case|:
name|str
operator|=
literal|"SSLv2 read client master key B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_SERVER_VERIFY_A
case|:
name|str
operator|=
literal|"SSLv2 write server verify A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_SERVER_VERIFY_B
case|:
name|str
operator|=
literal|"SSLv2 write server verify B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_SERVER_VERIFY_C
case|:
name|str
operator|=
literal|"SSLv2 write server verify C"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_CLIENT_FINISHED_A
case|:
name|str
operator|=
literal|"SSLv2 read client finished A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_CLIENT_FINISHED_B
case|:
name|str
operator|=
literal|"SSLv2 read client finished B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_SERVER_FINISHED_A
case|:
name|str
operator|=
literal|"SSLv2 write server finished A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_SERVER_FINISHED_B
case|:
name|str
operator|=
literal|"SSLv2 write server finished B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_REQUEST_CERTIFICATE_A
case|:
name|str
operator|=
literal|"SSLv2 write request certificate A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_REQUEST_CERTIFICATE_B
case|:
name|str
operator|=
literal|"SSLv2 write request certificate B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_REQUEST_CERTIFICATE_C
case|:
name|str
operator|=
literal|"SSLv2 write request certificate C"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_REQUEST_CERTIFICATE_D
case|:
name|str
operator|=
literal|"SSLv2 write request certificate D"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_X509_GET_SERVER_CERTIFICATE
case|:
name|str
operator|=
literal|"SSLv2 X509 read server certificate"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_X509_GET_CLIENT_CERTIFICATE
case|:
name|str
operator|=
literal|"SSLv2 X509 read client certificate"
expr_stmt|;
break|break;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|NO_SSL3
comment|/* SSLv3 additions */
case|case
name|SSL3_ST_CW_CLNT_HELLO_A
case|:
name|str
operator|=
literal|"SSLv3 write client hello A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_CLNT_HELLO_B
case|:
name|str
operator|=
literal|"SSLv3 write client hello B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_SRVR_HELLO_A
case|:
name|str
operator|=
literal|"SSLv3 read server hello A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_SRVR_HELLO_B
case|:
name|str
operator|=
literal|"SSLv3 read server hello B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_CERT_A
case|:
name|str
operator|=
literal|"SSLv3 read server certificate A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_CERT_B
case|:
name|str
operator|=
literal|"SSLv3 read server certificate B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_KEY_EXCH_A
case|:
name|str
operator|=
literal|"SSLv3 read server key exchange A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_KEY_EXCH_B
case|:
name|str
operator|=
literal|"SSLv3 read server key exchange B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_CERT_REQ_A
case|:
name|str
operator|=
literal|"SSLv3 read server certificate request A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_CERT_REQ_B
case|:
name|str
operator|=
literal|"SSLv3 read server certificate request B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_SRVR_DONE_A
case|:
name|str
operator|=
literal|"SSLv3 read server done A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_SRVR_DONE_B
case|:
name|str
operator|=
literal|"SSLv3 read server done B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_CERT_A
case|:
name|str
operator|=
literal|"SSLv3 write client certificate A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_CERT_B
case|:
name|str
operator|=
literal|"SSLv3 write client certificate B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_CERT_C
case|:
name|str
operator|=
literal|"SSLv3 write client certificate C"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_CERT_D
case|:
name|str
operator|=
literal|"SSLv3 write client certificate D"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_KEY_EXCH_A
case|:
name|str
operator|=
literal|"SSLv3 write client key exchange A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_KEY_EXCH_B
case|:
name|str
operator|=
literal|"SSLv3 write client key exchange B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_CERT_VRFY_A
case|:
name|str
operator|=
literal|"SSLv3 write certificate verify A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_CERT_VRFY_B
case|:
name|str
operator|=
literal|"SSLv3 write certificate verify A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_CHANGE_A
case|:
case|case
name|SSL3_ST_SW_CHANGE_A
case|:
name|str
operator|=
literal|"SSLv3 write change cipher spec A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_CHANGE_B
case|:
case|case
name|SSL3_ST_SW_CHANGE_B
case|:
name|str
operator|=
literal|"SSLv3 write change cipher spec B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_FINISHED_A
case|:
case|case
name|SSL3_ST_SW_FINISHED_A
case|:
name|str
operator|=
literal|"SSLv3 write finished A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_FINISHED_B
case|:
case|case
name|SSL3_ST_SW_FINISHED_B
case|:
name|str
operator|=
literal|"SSLv3 write finished A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_CHANGE_A
case|:
case|case
name|SSL3_ST_SR_CHANGE_A
case|:
name|str
operator|=
literal|"SSLv3 read change cipher spec A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_CHANGE_B
case|:
case|case
name|SSL3_ST_SR_CHANGE_B
case|:
name|str
operator|=
literal|"SSLv3 read change cipher spec B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_FINISHED_A
case|:
case|case
name|SSL3_ST_SR_FINISHED_A
case|:
name|str
operator|=
literal|"SSLv3 read finished A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_FINISHED_B
case|:
case|case
name|SSL3_ST_SR_FINISHED_B
case|:
name|str
operator|=
literal|"SSLv3 read finished B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_FLUSH
case|:
case|case
name|SSL3_ST_SW_FLUSH
case|:
name|str
operator|=
literal|"SSLv3 flush data"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_CLNT_HELLO_A
case|:
name|str
operator|=
literal|"SSLv3 read client hello A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_CLNT_HELLO_B
case|:
name|str
operator|=
literal|"SSLv3 read client hello B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_CLNT_HELLO_C
case|:
name|str
operator|=
literal|"SSLv3 read client hello C"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_HELLO_REQ_A
case|:
name|str
operator|=
literal|"SSLv3 write hello request A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_HELLO_REQ_B
case|:
name|str
operator|=
literal|"SSLv3 write hello request B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_HELLO_REQ_C
case|:
name|str
operator|=
literal|"SSLv3 write hello request C"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_SRVR_HELLO_A
case|:
name|str
operator|=
literal|"SSLv3 write server hello A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_SRVR_HELLO_B
case|:
name|str
operator|=
literal|"SSLv3 write server hello B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_CERT_A
case|:
name|str
operator|=
literal|"SSLv3 write certificate A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_CERT_B
case|:
name|str
operator|=
literal|"SSLv3 write certificate B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_KEY_EXCH_A
case|:
name|str
operator|=
literal|"SSLv3 write key exchange A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_KEY_EXCH_B
case|:
name|str
operator|=
literal|"SSLv3 write key exchange B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_CERT_REQ_A
case|:
name|str
operator|=
literal|"SSLv3 write certificate request A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_CERT_REQ_B
case|:
name|str
operator|=
literal|"SSLv3 write certificate request B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_SRVR_DONE_A
case|:
name|str
operator|=
literal|"SSLv3 write server done A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_SRVR_DONE_B
case|:
name|str
operator|=
literal|"SSLv3 write server done B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_CERT_A
case|:
name|str
operator|=
literal|"SSLv3 read client certificate A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_CERT_B
case|:
name|str
operator|=
literal|"SSLv3 read client certificate B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_KEY_EXCH_A
case|:
name|str
operator|=
literal|"SSLv3 read client key exchange A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_KEY_EXCH_B
case|:
name|str
operator|=
literal|"SSLv3 read client key exchange B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_CERT_VRFY_A
case|:
name|str
operator|=
literal|"SSLv3 read certificate verify A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_CERT_VRFY_B
case|:
name|str
operator|=
literal|"SSLv3 read certificate verify B"
expr_stmt|;
break|break;
endif|#
directive|endif
if|#
directive|if
operator|!
name|defined
argument_list|(
name|NO_SSL2
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|NO_SSL3
argument_list|)
comment|/* SSLv2/v3 compatibility states */
comment|/* client */
case|case
name|SSL23_ST_CW_CLNT_HELLO_A
case|:
name|str
operator|=
literal|"SSLv2/v3 write client hello A"
expr_stmt|;
break|break;
case|case
name|SSL23_ST_CW_CLNT_HELLO_B
case|:
name|str
operator|=
literal|"SSLv2/v3 write client hello B"
expr_stmt|;
break|break;
case|case
name|SSL23_ST_CR_SRVR_HELLO_A
case|:
name|str
operator|=
literal|"SSLv2/v3 read server hello A"
expr_stmt|;
break|break;
case|case
name|SSL23_ST_CR_SRVR_HELLO_B
case|:
name|str
operator|=
literal|"SSLv2/v3 read server hello B"
expr_stmt|;
break|break;
comment|/* server */
case|case
name|SSL23_ST_SR_CLNT_HELLO_A
case|:
name|str
operator|=
literal|"SSLv2/v3 read client hello A"
expr_stmt|;
break|break;
case|case
name|SSL23_ST_SR_CLNT_HELLO_B
case|:
name|str
operator|=
literal|"SSLv2/v3 read client hello B"
expr_stmt|;
break|break;
endif|#
directive|endif
default|default:
name|str
operator|=
literal|"unknown state"
expr_stmt|;
break|break;
block|}
return|return
operator|(
name|str
operator|)
return|;
block|}
end_function

begin_function
name|char
modifier|*
name|SSL_rstate_string_long
parameter_list|(
name|SSL
modifier|*
name|s
parameter_list|)
block|{
name|char
modifier|*
name|str
decl_stmt|;
switch|switch
condition|(
name|s
operator|->
name|rstate
condition|)
block|{
case|case
name|SSL_ST_READ_HEADER
case|:
name|str
operator|=
literal|"read header"
expr_stmt|;
break|break;
case|case
name|SSL_ST_READ_BODY
case|:
name|str
operator|=
literal|"read body"
expr_stmt|;
break|break;
case|case
name|SSL_ST_READ_DONE
case|:
name|str
operator|=
literal|"read done"
expr_stmt|;
break|break;
default|default:
name|str
operator|=
literal|"unknown"
expr_stmt|;
break|break;
block|}
return|return
operator|(
name|str
operator|)
return|;
block|}
end_function

begin_function
name|char
modifier|*
name|SSL_state_string
parameter_list|(
name|SSL
modifier|*
name|s
parameter_list|)
block|{
name|char
modifier|*
name|str
decl_stmt|;
switch|switch
condition|(
name|s
operator|->
name|state
condition|)
block|{
case|case
name|SSL_ST_BEFORE
case|:
name|str
operator|=
literal|"PINIT "
expr_stmt|;
break|break;
case|case
name|SSL_ST_ACCEPT
case|:
name|str
operator|=
literal|"AINIT "
expr_stmt|;
break|break;
case|case
name|SSL_ST_CONNECT
case|:
name|str
operator|=
literal|"CINIT "
expr_stmt|;
break|break;
case|case
name|SSL_ST_OK
case|:
name|str
operator|=
literal|"SSLOK "
expr_stmt|;
break|break;
ifndef|#
directive|ifndef
name|NO_SSL2
case|case
name|SSL2_ST_CLIENT_START_ENCRYPTION
case|:
name|str
operator|=
literal|"2CSENC"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SERVER_START_ENCRYPTION
case|:
name|str
operator|=
literal|"2SSENC"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_HELLO_A
case|:
name|str
operator|=
literal|"2SCH_A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_HELLO_B
case|:
name|str
operator|=
literal|"2SCH_B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_SERVER_HELLO_A
case|:
name|str
operator|=
literal|"2GSH_A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_SERVER_HELLO_B
case|:
name|str
operator|=
literal|"2GSH_B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_MASTER_KEY_A
case|:
name|str
operator|=
literal|"2SCMKA"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_MASTER_KEY_B
case|:
name|str
operator|=
literal|"2SCMKB"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_FINISHED_A
case|:
name|str
operator|=
literal|"2SCF_A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_FINISHED_B
case|:
name|str
operator|=
literal|"2SCF_B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_CERTIFICATE_A
case|:
name|str
operator|=
literal|"2SCC_A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_CERTIFICATE_B
case|:
name|str
operator|=
literal|"2SCC_B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_CERTIFICATE_C
case|:
name|str
operator|=
literal|"2SCC_C"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_CLIENT_CERTIFICATE_D
case|:
name|str
operator|=
literal|"2SCC_D"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_SERVER_VERIFY_A
case|:
name|str
operator|=
literal|"2GSV_A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_SERVER_VERIFY_B
case|:
name|str
operator|=
literal|"2GSV_B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_SERVER_FINISHED_A
case|:
name|str
operator|=
literal|"2GSF_A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_SERVER_FINISHED_B
case|:
name|str
operator|=
literal|"2GSF_B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_CLIENT_HELLO_A
case|:
name|str
operator|=
literal|"2GCH_A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_CLIENT_HELLO_B
case|:
name|str
operator|=
literal|"2GCH_B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_CLIENT_HELLO_C
case|:
name|str
operator|=
literal|"2GCH_C"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_SERVER_HELLO_A
case|:
name|str
operator|=
literal|"2SSH_A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_SERVER_HELLO_B
case|:
name|str
operator|=
literal|"2SSH_B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_CLIENT_MASTER_KEY_A
case|:
name|str
operator|=
literal|"2GCMKA"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_CLIENT_MASTER_KEY_B
case|:
name|str
operator|=
literal|"2GCMKA"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_SERVER_VERIFY_A
case|:
name|str
operator|=
literal|"2SSV_A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_SERVER_VERIFY_B
case|:
name|str
operator|=
literal|"2SSV_B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_SERVER_VERIFY_C
case|:
name|str
operator|=
literal|"2SSV_C"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_CLIENT_FINISHED_A
case|:
name|str
operator|=
literal|"2GCF_A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_GET_CLIENT_FINISHED_B
case|:
name|str
operator|=
literal|"2GCF_B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_SERVER_FINISHED_A
case|:
name|str
operator|=
literal|"2SSF_A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_SERVER_FINISHED_B
case|:
name|str
operator|=
literal|"2SSF_B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_REQUEST_CERTIFICATE_A
case|:
name|str
operator|=
literal|"2SRC_A"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_REQUEST_CERTIFICATE_B
case|:
name|str
operator|=
literal|"2SRC_B"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_REQUEST_CERTIFICATE_C
case|:
name|str
operator|=
literal|"2SRC_C"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_SEND_REQUEST_CERTIFICATE_D
case|:
name|str
operator|=
literal|"2SRC_D"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_X509_GET_SERVER_CERTIFICATE
case|:
name|str
operator|=
literal|"2X9GSC"
expr_stmt|;
break|break;
case|case
name|SSL2_ST_X509_GET_CLIENT_CERTIFICATE
case|:
name|str
operator|=
literal|"2X9GCC"
expr_stmt|;
break|break;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|NO_SSL3
comment|/* SSLv3 additions */
case|case
name|SSL3_ST_SW_FLUSH
case|:
case|case
name|SSL3_ST_CW_FLUSH
case|:
name|str
operator|=
literal|"3FLUSH"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_CLNT_HELLO_A
case|:
name|str
operator|=
literal|"3WCH_A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_CLNT_HELLO_B
case|:
name|str
operator|=
literal|"3WCH_B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_SRVR_HELLO_A
case|:
name|str
operator|=
literal|"3RSH_A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_SRVR_HELLO_B
case|:
name|str
operator|=
literal|"3RSH_B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_CERT_A
case|:
name|str
operator|=
literal|"3RSC_A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_CERT_B
case|:
name|str
operator|=
literal|"3RSC_B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_KEY_EXCH_A
case|:
name|str
operator|=
literal|"3RSKEA"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_KEY_EXCH_B
case|:
name|str
operator|=
literal|"3RSKEB"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_CERT_REQ_A
case|:
name|str
operator|=
literal|"3RCR_A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_CERT_REQ_B
case|:
name|str
operator|=
literal|"3RCR_B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_SRVR_DONE_A
case|:
name|str
operator|=
literal|"3RSD_A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CR_SRVR_DONE_B
case|:
name|str
operator|=
literal|"3RSD_B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_CERT_A
case|:
name|str
operator|=
literal|"3WCC_A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_CERT_B
case|:
name|str
operator|=
literal|"3WCC_B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_CERT_C
case|:
name|str
operator|=
literal|"3WCC_C"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_CERT_D
case|:
name|str
operator|=
literal|"3WCC_D"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_KEY_EXCH_A
case|:
name|str
operator|=
literal|"3WCKEA"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_KEY_EXCH_B
case|:
name|str
operator|=
literal|"3WCKEB"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_CERT_VRFY_A
case|:
name|str
operator|=
literal|"3WCV_A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_CW_CERT_VRFY_B
case|:
name|str
operator|=
literal|"3WCV_B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_CHANGE_A
case|:
case|case
name|SSL3_ST_CW_CHANGE_A
case|:
name|str
operator|=
literal|"3WCCSA"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_CHANGE_B
case|:
case|case
name|SSL3_ST_CW_CHANGE_B
case|:
name|str
operator|=
literal|"3WCCSB"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_FINISHED_A
case|:
case|case
name|SSL3_ST_CW_FINISHED_A
case|:
name|str
operator|=
literal|"3WFINA"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_FINISHED_B
case|:
case|case
name|SSL3_ST_CW_FINISHED_B
case|:
name|str
operator|=
literal|"3WFINB"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_CHANGE_A
case|:
case|case
name|SSL3_ST_CR_CHANGE_A
case|:
name|str
operator|=
literal|"3RCCSA"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_CHANGE_B
case|:
case|case
name|SSL3_ST_CR_CHANGE_B
case|:
name|str
operator|=
literal|"3RCCSB"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_FINISHED_A
case|:
case|case
name|SSL3_ST_CR_FINISHED_A
case|:
name|str
operator|=
literal|"3RFINA"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_FINISHED_B
case|:
case|case
name|SSL3_ST_CR_FINISHED_B
case|:
name|str
operator|=
literal|"3RFINB"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_HELLO_REQ_A
case|:
name|str
operator|=
literal|"3WHR_A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_HELLO_REQ_B
case|:
name|str
operator|=
literal|"3WHR_B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_HELLO_REQ_C
case|:
name|str
operator|=
literal|"3WHR_C"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_CLNT_HELLO_A
case|:
name|str
operator|=
literal|"3RCH_A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_CLNT_HELLO_B
case|:
name|str
operator|=
literal|"3RCH_B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_CLNT_HELLO_C
case|:
name|str
operator|=
literal|"3RCH_C"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_SRVR_HELLO_A
case|:
name|str
operator|=
literal|"3WSH_A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_SRVR_HELLO_B
case|:
name|str
operator|=
literal|"3WSH_B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_CERT_A
case|:
name|str
operator|=
literal|"3WSC_A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_CERT_B
case|:
name|str
operator|=
literal|"3WSC_B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_KEY_EXCH_A
case|:
name|str
operator|=
literal|"3WSKEA"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_KEY_EXCH_B
case|:
name|str
operator|=
literal|"3WSKEB"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_CERT_REQ_A
case|:
name|str
operator|=
literal|"3WCR_A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_CERT_REQ_B
case|:
name|str
operator|=
literal|"3WCR_B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_SRVR_DONE_A
case|:
name|str
operator|=
literal|"3WSD_A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SW_SRVR_DONE_B
case|:
name|str
operator|=
literal|"3WSD_B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_CERT_A
case|:
name|str
operator|=
literal|"3RCC_A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_CERT_B
case|:
name|str
operator|=
literal|"3RCC_B"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_KEY_EXCH_A
case|:
name|str
operator|=
literal|"3RCKEA"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_KEY_EXCH_B
case|:
name|str
operator|=
literal|"3RCKEB"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_CERT_VRFY_A
case|:
name|str
operator|=
literal|"3RCV_A"
expr_stmt|;
break|break;
case|case
name|SSL3_ST_SR_CERT_VRFY_B
case|:
name|str
operator|=
literal|"3RCV_B"
expr_stmt|;
break|break;
endif|#
directive|endif
if|#
directive|if
operator|!
name|defined
argument_list|(
name|NO_SSL2
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|NO_SSL3
argument_list|)
comment|/* SSLv2/v3 compatibility states */
comment|/* client */
case|case
name|SSL23_ST_CW_CLNT_HELLO_A
case|:
name|str
operator|=
literal|"23WCHA"
expr_stmt|;
break|break;
case|case
name|SSL23_ST_CW_CLNT_HELLO_B
case|:
name|str
operator|=
literal|"23WCHB"
expr_stmt|;
break|break;
case|case
name|SSL23_ST_CR_SRVR_HELLO_A
case|:
name|str
operator|=
literal|"23RSHA"
expr_stmt|;
break|break;
case|case
name|SSL23_ST_CR_SRVR_HELLO_B
case|:
name|str
operator|=
literal|"23RSHA"
expr_stmt|;
break|break;
comment|/* server */
case|case
name|SSL23_ST_SR_CLNT_HELLO_A
case|:
name|str
operator|=
literal|"23RCHA"
expr_stmt|;
break|break;
case|case
name|SSL23_ST_SR_CLNT_HELLO_B
case|:
name|str
operator|=
literal|"23RCHB"
expr_stmt|;
break|break;
endif|#
directive|endif
default|default:
name|str
operator|=
literal|"UNKWN "
expr_stmt|;
break|break;
block|}
return|return
operator|(
name|str
operator|)
return|;
block|}
end_function

begin_function
name|char
modifier|*
name|SSL_alert_type_string_long
parameter_list|(
name|int
name|value
parameter_list|)
block|{
name|value
operator|>>=
literal|8
expr_stmt|;
if|if
condition|(
name|value
operator|==
name|SSL3_AL_WARNING
condition|)
return|return
operator|(
literal|"warning"
operator|)
return|;
elseif|else
if|if
condition|(
name|value
operator|==
name|SSL3_AL_FATAL
condition|)
return|return
operator|(
literal|"fatal"
operator|)
return|;
else|else
return|return
operator|(
literal|"unknown"
operator|)
return|;
block|}
end_function

begin_function
name|char
modifier|*
name|SSL_alert_type_string
parameter_list|(
name|int
name|value
parameter_list|)
block|{
name|value
operator|>>=
literal|8
expr_stmt|;
if|if
condition|(
name|value
operator|==
name|SSL3_AL_WARNING
condition|)
return|return
operator|(
literal|"W"
operator|)
return|;
elseif|else
if|if
condition|(
name|value
operator|==
name|SSL3_AL_FATAL
condition|)
return|return
operator|(
literal|"F"
operator|)
return|;
else|else
return|return
operator|(
literal|"U"
operator|)
return|;
block|}
end_function

begin_function
name|char
modifier|*
name|SSL_alert_desc_string
parameter_list|(
name|int
name|value
parameter_list|)
block|{
name|char
modifier|*
name|str
decl_stmt|;
switch|switch
condition|(
name|value
operator|&
literal|0xff
condition|)
block|{
case|case
name|SSL3_AD_CLOSE_NOTIFY
case|:
name|str
operator|=
literal|"CN"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_UNEXPECTED_MESSAGE
case|:
name|str
operator|=
literal|"UM"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_BAD_RECORD_MAC
case|:
name|str
operator|=
literal|"BM"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_DECOMPRESSION_FAILURE
case|:
name|str
operator|=
literal|"DF"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_HANDSHAKE_FAILURE
case|:
name|str
operator|=
literal|"HF"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_NO_CERTIFICATE
case|:
name|str
operator|=
literal|"NC"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_BAD_CERTIFICATE
case|:
name|str
operator|=
literal|"BC"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_UNSUPPORTED_CERTIFICATE
case|:
name|str
operator|=
literal|"UC"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_CERTIFICATE_REVOKED
case|:
name|str
operator|=
literal|"CR"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_CERTIFICATE_EXPIRED
case|:
name|str
operator|=
literal|"CE"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_CERTIFICATE_UNKNOWN
case|:
name|str
operator|=
literal|"CU"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_ILLEGAL_PARAMETER
case|:
name|str
operator|=
literal|"IP"
expr_stmt|;
break|break;
default|default:
name|str
operator|=
literal|"UK"
expr_stmt|;
break|break;
block|}
return|return
operator|(
name|str
operator|)
return|;
block|}
end_function

begin_function
name|char
modifier|*
name|SSL_alert_desc_string_long
parameter_list|(
name|int
name|value
parameter_list|)
block|{
name|char
modifier|*
name|str
decl_stmt|;
switch|switch
condition|(
name|value
operator|&
literal|0xff
condition|)
block|{
case|case
name|SSL3_AD_CLOSE_NOTIFY
case|:
name|str
operator|=
literal|"close notify"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_UNEXPECTED_MESSAGE
case|:
name|str
operator|=
literal|"unexpected_message"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_BAD_RECORD_MAC
case|:
name|str
operator|=
literal|"bad record mac"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_DECOMPRESSION_FAILURE
case|:
name|str
operator|=
literal|"decompression failure"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_HANDSHAKE_FAILURE
case|:
name|str
operator|=
literal|"handshake failure"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_NO_CERTIFICATE
case|:
name|str
operator|=
literal|"no certificate"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_BAD_CERTIFICATE
case|:
name|str
operator|=
literal|"bad certificate"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_UNSUPPORTED_CERTIFICATE
case|:
name|str
operator|=
literal|"unsupported certificate"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_CERTIFICATE_REVOKED
case|:
name|str
operator|=
literal|"certificate revoked"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_CERTIFICATE_EXPIRED
case|:
name|str
operator|=
literal|"certificate expired"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_CERTIFICATE_UNKNOWN
case|:
name|str
operator|=
literal|"certificate unknown"
expr_stmt|;
break|break;
case|case
name|SSL3_AD_ILLEGAL_PARAMETER
case|:
name|str
operator|=
literal|"illegal parameter"
expr_stmt|;
break|break;
default|default:
name|str
operator|=
literal|"unknown"
expr_stmt|;
break|break;
block|}
return|return
operator|(
name|str
operator|)
return|;
block|}
end_function

begin_function
name|char
modifier|*
name|SSL_rstate_string
parameter_list|(
name|SSL
modifier|*
name|s
parameter_list|)
block|{
name|char
modifier|*
name|str
decl_stmt|;
switch|switch
condition|(
name|s
operator|->
name|rstate
condition|)
block|{
case|case
name|SSL_ST_READ_HEADER
case|:
name|str
operator|=
literal|"RH"
expr_stmt|;
break|break;
case|case
name|SSL_ST_READ_BODY
case|:
name|str
operator|=
literal|"RB"
expr_stmt|;
break|break;
case|case
name|SSL_ST_READ_DONE
case|:
name|str
operator|=
literal|"RD"
expr_stmt|;
break|break;
default|default:
name|str
operator|=
literal|"unknown"
expr_stmt|;
break|break;
block|}
return|return
operator|(
name|str
operator|)
return|;
block|}
end_function

end_unit

