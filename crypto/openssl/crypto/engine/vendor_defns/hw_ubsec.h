begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/******************************************************************************  *  *  Copyright 2000  *  Broadcom Corporation  *  16215 Alton Parkway  *  PO Box 57013  *  Irvine CA 92619-7013  *  *****************************************************************************/
end_comment

begin_comment
comment|/*   * Broadcom Corporation uBSec SDK   */
end_comment

begin_comment
comment|/*  * Character device header file.  */
end_comment

begin_comment
comment|/*  * Revision History:  *  * October 2000 JTT Created.  */
end_comment

begin_define
define|#
directive|define
name|MAX_PUBLIC_KEY_BITS
value|(1024)
end_define

begin_define
define|#
directive|define
name|MAX_PUBLIC_KEY_BYTES
value|(1024/8)
end_define

begin_define
define|#
directive|define
name|SHA_BIT_SIZE
value|(160)
end_define

begin_define
define|#
directive|define
name|MAX_CRYPTO_KEY_LENGTH
value|24
end_define

begin_define
define|#
directive|define
name|MAX_MAC_KEY_LENGTH
value|64
end_define

begin_define
define|#
directive|define
name|UBSEC_CRYPTO_DEVICE_NAME
value|((unsigned char *)"/dev/ubscrypt")
end_define

begin_define
define|#
directive|define
name|UBSEC_KEY_DEVICE_NAME
value|((unsigned char *)"/dev/ubskey")
end_define

begin_comment
comment|/* Math command types. */
end_comment

begin_define
define|#
directive|define
name|UBSEC_MATH_MODADD
value|0x0001
end_define

begin_define
define|#
directive|define
name|UBSEC_MATH_MODSUB
value|0x0002
end_define

begin_define
define|#
directive|define
name|UBSEC_MATH_MODMUL
value|0x0004
end_define

begin_define
define|#
directive|define
name|UBSEC_MATH_MODEXP
value|0x0008
end_define

begin_define
define|#
directive|define
name|UBSEC_MATH_MODREM
value|0x0010
end_define

begin_define
define|#
directive|define
name|UBSEC_MATH_MODINV
value|0x0020
end_define

begin_typedef
typedef|typedef
name|long
name|ubsec_MathCommand_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
name|long
name|ubsec_RNGCommand_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|ubsec_crypto_context_s
block|{
name|unsigned
name|int
name|flags
decl_stmt|;
name|unsigned
name|char
name|crypto
index|[
name|MAX_CRYPTO_KEY_LENGTH
index|]
decl_stmt|;
name|unsigned
name|char
name|auth
index|[
name|MAX_MAC_KEY_LENGTH
index|]
decl_stmt|;
block|}
name|ubsec_crypto_context_t
operator|,
typedef|*
name|ubsec_crypto_context_p
typedef|;
end_typedef

begin_comment
comment|/*   * Predeclare the function pointer types that we dynamically load from the DSO.  */
end_comment

begin_typedef
typedef|typedef
name|int
name|t_UBSEC_ubsec_bytes_to_bits
parameter_list|(
name|unsigned
name|char
modifier|*
name|n
parameter_list|,
name|int
name|bytes
parameter_list|)
function_decl|;
end_typedef

begin_typedef
typedef|typedef
name|int
name|t_UBSEC_ubsec_bits_to_bytes
parameter_list|(
name|int
name|bits
parameter_list|)
function_decl|;
end_typedef

begin_typedef
typedef|typedef
name|int
name|t_UBSEC_ubsec_open
parameter_list|(
name|unsigned
name|char
modifier|*
name|device
parameter_list|)
function_decl|;
end_typedef

begin_typedef
typedef|typedef
name|int
name|t_UBSEC_ubsec_close
parameter_list|(
name|int
name|fd
parameter_list|)
function_decl|;
end_typedef

begin_typedef
typedef|typedef
name|int
name|t_UBSEC_diffie_hellman_generate_ioctl
parameter_list|(
name|int
name|fd
parameter_list|,
name|unsigned
name|char
modifier|*
name|x
parameter_list|,
name|int
modifier|*
name|x_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|y
parameter_list|,
name|int
modifier|*
name|y_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|g
parameter_list|,
name|int
name|g_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|m
parameter_list|,
name|int
name|m_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|userX
parameter_list|,
name|int
name|userX_len
parameter_list|,
name|int
name|random_bits
parameter_list|)
function_decl|;
end_typedef

begin_typedef
typedef|typedef
name|int
name|t_UBSEC_diffie_hellman_agree_ioctl
parameter_list|(
name|int
name|fd
parameter_list|,
name|unsigned
name|char
modifier|*
name|x
parameter_list|,
name|int
name|x_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|y
parameter_list|,
name|int
name|y_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|m
parameter_list|,
name|int
name|m_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|k
parameter_list|,
name|int
modifier|*
name|k_len
parameter_list|)
function_decl|;
end_typedef

begin_typedef
typedef|typedef
name|int
name|t_UBSEC_rsa_mod_exp_ioctl
parameter_list|(
name|int
name|fd
parameter_list|,
name|unsigned
name|char
modifier|*
name|x
parameter_list|,
name|int
name|x_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|m
parameter_list|,
name|int
name|m_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|e
parameter_list|,
name|int
name|e_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|y
parameter_list|,
name|int
modifier|*
name|y_len
parameter_list|)
function_decl|;
end_typedef

begin_typedef
typedef|typedef
name|int
name|t_UBSEC_rsa_mod_exp_crt_ioctl
parameter_list|(
name|int
name|fd
parameter_list|,
name|unsigned
name|char
modifier|*
name|x
parameter_list|,
name|int
name|x_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|qinv
parameter_list|,
name|int
name|qinv_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|edq
parameter_list|,
name|int
name|edq_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|q
parameter_list|,
name|int
name|q_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|edp
parameter_list|,
name|int
name|edp_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|p
parameter_list|,
name|int
name|p_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|y
parameter_list|,
name|int
modifier|*
name|y_len
parameter_list|)
function_decl|;
end_typedef

begin_typedef
typedef|typedef
name|int
name|t_UBSEC_dsa_sign_ioctl
parameter_list|(
name|int
name|fd
parameter_list|,
name|int
name|hash
parameter_list|,
name|unsigned
name|char
modifier|*
name|data
parameter_list|,
name|int
name|data_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|rndom
parameter_list|,
name|int
name|random_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|p
parameter_list|,
name|int
name|p_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|q
parameter_list|,
name|int
name|q_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|g
parameter_list|,
name|int
name|g_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|key
parameter_list|,
name|int
name|key_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|r
parameter_list|,
name|int
modifier|*
name|r_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|s
parameter_list|,
name|int
modifier|*
name|s_len
parameter_list|)
function_decl|;
end_typedef

begin_typedef
typedef|typedef
name|int
name|t_UBSEC_dsa_verify_ioctl
parameter_list|(
name|int
name|fd
parameter_list|,
name|int
name|hash
parameter_list|,
name|unsigned
name|char
modifier|*
name|data
parameter_list|,
name|int
name|data_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|p
parameter_list|,
name|int
name|p_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|q
parameter_list|,
name|int
name|q_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|g
parameter_list|,
name|int
name|g_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|key
parameter_list|,
name|int
name|key_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|r
parameter_list|,
name|int
name|r_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|s
parameter_list|,
name|int
name|s_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|v
parameter_list|,
name|int
modifier|*
name|v_len
parameter_list|)
function_decl|;
end_typedef

begin_typedef
typedef|typedef
name|int
name|t_UBSEC_math_accelerate_ioctl
parameter_list|(
name|int
name|fd
parameter_list|,
name|ubsec_MathCommand_t
name|command
parameter_list|,
name|unsigned
name|char
modifier|*
name|ModN
parameter_list|,
name|int
modifier|*
name|ModN_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|ExpE
parameter_list|,
name|int
modifier|*
name|ExpE_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|ParamA
parameter_list|,
name|int
modifier|*
name|ParamA_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|ParamB
parameter_list|,
name|int
modifier|*
name|ParamB_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|Result
parameter_list|,
name|int
modifier|*
name|Result_len
parameter_list|)
function_decl|;
end_typedef

begin_typedef
typedef|typedef
name|int
name|t_UBSEC_rng_ioctl
parameter_list|(
name|int
name|fd
parameter_list|,
name|ubsec_RNGCommand_t
name|command
parameter_list|,
name|unsigned
name|char
modifier|*
name|Result
parameter_list|,
name|int
modifier|*
name|Result_len
parameter_list|)
function_decl|;
end_typedef

begin_typedef
typedef|typedef
name|int
name|t_UBSEC_max_key_len_ioctl
parameter_list|(
name|int
name|fd
parameter_list|,
name|int
modifier|*
name|max_key_len
parameter_list|)
function_decl|;
end_typedef

end_unit

