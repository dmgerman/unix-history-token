begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* crypto/bn/bn_asm.c */
end_comment

begin_comment
comment|/* Copyright (C) 1995-1998 Eric Young (eay@cryptsoft.com)  * All rights reserved.  *  * This package is an SSL implementation written  * by Eric Young (eay@cryptsoft.com).  * The implementation was written so as to conform with Netscapes SSL.  *   * This library is free for commercial and non-commercial use as long as  * the following conditions are aheared to.  The following conditions  * apply to all code found in this distribution, be it the RC4, RSA,  * lhash, DES, etc., code; not just the SSL code.  The SSL documentation  * included with this distribution is covered by the same copyright terms  * except that the holder is Tim Hudson (tjh@cryptsoft.com).  *   * Copyright remains Eric Young's, and as such any Copyright notices in  * the code are not to be removed.  * If this package is used in a product, Eric Young should be given attribution  * as the author of the parts of the library used.  * This can be in the form of a textual message at program startup or  * in documentation (online or textual) provided with the package.  *   * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  * 3. All advertising materials mentioning features or use of this software  *    must display the following acknowledgement:  *    "This product includes cryptographic software written by  *     Eric Young (eay@cryptsoft.com)"  *    The word 'cryptographic' can be left out if the rouines from the library  *    being used are not cryptographic related :-).  * 4. If you include any Windows specific code (or a derivative thereof) from   *    the apps directory (application code) you must include an acknowledgement:  *    "This product includes software written by Tim Hudson (tjh@cryptsoft.com)"  *   * THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  *   * The licence and distribution terms for any publically available version or  * derivative of this code cannot be changed.  i.e. this code cannot simply be  * copied and put under another distribution licence  * [including the GNU Public Licence.]  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|BN_DEBUG
end_ifndef

begin_undef
undef|#
directive|undef
name|NDEBUG
end_undef

begin_comment
comment|/* avoid conflicting definitions */
end_comment

begin_define
define|#
directive|define
name|NDEBUG
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<assert.h>
end_include

begin_include
include|#
directive|include
file|"cryptlib.h"
end_include

begin_include
include|#
directive|include
file|"bn_lcl.h"
end_include

begin_if
if|#
directive|if
name|defined
argument_list|(
name|BN_LLONG
argument_list|)
operator|||
name|defined
argument_list|(
name|BN_UMULT_HIGH
argument_list|)
end_if

begin_function
name|BN_ULONG
name|bn_mul_add_words
parameter_list|(
name|BN_ULONG
modifier|*
name|rp
parameter_list|,
name|BN_ULONG
modifier|*
name|ap
parameter_list|,
name|int
name|num
parameter_list|,
name|BN_ULONG
name|w
parameter_list|)
block|{
name|BN_ULONG
name|c1
init|=
literal|0
decl_stmt|;
name|assert
argument_list|(
name|num
operator|>=
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|num
operator|<=
literal|0
condition|)
return|return
operator|(
name|c1
operator|)
return|;
while|while
condition|(
name|num
operator|&
operator|~
literal|3
condition|)
block|{
name|mul_add
argument_list|(
name|rp
index|[
literal|0
index|]
argument_list|,
name|ap
index|[
literal|0
index|]
argument_list|,
name|w
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add
argument_list|(
name|rp
index|[
literal|1
index|]
argument_list|,
name|ap
index|[
literal|1
index|]
argument_list|,
name|w
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add
argument_list|(
name|rp
index|[
literal|2
index|]
argument_list|,
name|ap
index|[
literal|2
index|]
argument_list|,
name|w
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add
argument_list|(
name|rp
index|[
literal|3
index|]
argument_list|,
name|ap
index|[
literal|3
index|]
argument_list|,
name|w
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|ap
operator|+=
literal|4
expr_stmt|;
name|rp
operator|+=
literal|4
expr_stmt|;
name|num
operator|-=
literal|4
expr_stmt|;
block|}
if|if
condition|(
name|num
condition|)
block|{
name|mul_add
argument_list|(
name|rp
index|[
literal|0
index|]
argument_list|,
name|ap
index|[
literal|0
index|]
argument_list|,
name|w
argument_list|,
name|c1
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|num
operator|==
literal|0
condition|)
return|return
name|c1
return|;
name|mul_add
argument_list|(
name|rp
index|[
literal|1
index|]
argument_list|,
name|ap
index|[
literal|1
index|]
argument_list|,
name|w
argument_list|,
name|c1
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|num
operator|==
literal|0
condition|)
return|return
name|c1
return|;
name|mul_add
argument_list|(
name|rp
index|[
literal|2
index|]
argument_list|,
name|ap
index|[
literal|2
index|]
argument_list|,
name|w
argument_list|,
name|c1
argument_list|)
expr_stmt|;
return|return
name|c1
return|;
block|}
return|return
operator|(
name|c1
operator|)
return|;
block|}
end_function

begin_function
name|BN_ULONG
name|bn_mul_words
parameter_list|(
name|BN_ULONG
modifier|*
name|rp
parameter_list|,
name|BN_ULONG
modifier|*
name|ap
parameter_list|,
name|int
name|num
parameter_list|,
name|BN_ULONG
name|w
parameter_list|)
block|{
name|BN_ULONG
name|c1
init|=
literal|0
decl_stmt|;
name|assert
argument_list|(
name|num
operator|>=
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|num
operator|<=
literal|0
condition|)
return|return
operator|(
name|c1
operator|)
return|;
while|while
condition|(
name|num
operator|&
operator|~
literal|3
condition|)
block|{
name|mul
argument_list|(
name|rp
index|[
literal|0
index|]
argument_list|,
name|ap
index|[
literal|0
index|]
argument_list|,
name|w
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul
argument_list|(
name|rp
index|[
literal|1
index|]
argument_list|,
name|ap
index|[
literal|1
index|]
argument_list|,
name|w
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul
argument_list|(
name|rp
index|[
literal|2
index|]
argument_list|,
name|ap
index|[
literal|2
index|]
argument_list|,
name|w
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul
argument_list|(
name|rp
index|[
literal|3
index|]
argument_list|,
name|ap
index|[
literal|3
index|]
argument_list|,
name|w
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|ap
operator|+=
literal|4
expr_stmt|;
name|rp
operator|+=
literal|4
expr_stmt|;
name|num
operator|-=
literal|4
expr_stmt|;
block|}
if|if
condition|(
name|num
condition|)
block|{
name|mul
argument_list|(
name|rp
index|[
literal|0
index|]
argument_list|,
name|ap
index|[
literal|0
index|]
argument_list|,
name|w
argument_list|,
name|c1
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|num
operator|==
literal|0
condition|)
return|return
name|c1
return|;
name|mul
argument_list|(
name|rp
index|[
literal|1
index|]
argument_list|,
name|ap
index|[
literal|1
index|]
argument_list|,
name|w
argument_list|,
name|c1
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|num
operator|==
literal|0
condition|)
return|return
name|c1
return|;
name|mul
argument_list|(
name|rp
index|[
literal|2
index|]
argument_list|,
name|ap
index|[
literal|2
index|]
argument_list|,
name|w
argument_list|,
name|c1
argument_list|)
expr_stmt|;
block|}
return|return
operator|(
name|c1
operator|)
return|;
block|}
end_function

begin_function
name|void
name|bn_sqr_words
parameter_list|(
name|BN_ULONG
modifier|*
name|r
parameter_list|,
name|BN_ULONG
modifier|*
name|a
parameter_list|,
name|int
name|n
parameter_list|)
block|{
name|assert
argument_list|(
name|n
operator|>=
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|n
operator|<=
literal|0
condition|)
return|return;
while|while
condition|(
name|n
operator|&
operator|~
literal|3
condition|)
block|{
name|sqr
argument_list|(
name|r
index|[
literal|0
index|]
argument_list|,
name|r
index|[
literal|1
index|]
argument_list|,
name|a
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|sqr
argument_list|(
name|r
index|[
literal|2
index|]
argument_list|,
name|r
index|[
literal|3
index|]
argument_list|,
name|a
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|sqr
argument_list|(
name|r
index|[
literal|4
index|]
argument_list|,
name|r
index|[
literal|5
index|]
argument_list|,
name|a
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|sqr
argument_list|(
name|r
index|[
literal|6
index|]
argument_list|,
name|r
index|[
literal|7
index|]
argument_list|,
name|a
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|a
operator|+=
literal|4
expr_stmt|;
name|r
operator|+=
literal|8
expr_stmt|;
name|n
operator|-=
literal|4
expr_stmt|;
block|}
if|if
condition|(
name|n
condition|)
block|{
name|sqr
argument_list|(
name|r
index|[
literal|0
index|]
argument_list|,
name|r
index|[
literal|1
index|]
argument_list|,
name|a
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|==
literal|0
condition|)
return|return;
name|sqr
argument_list|(
name|r
index|[
literal|2
index|]
argument_list|,
name|r
index|[
literal|3
index|]
argument_list|,
name|a
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|==
literal|0
condition|)
return|return;
name|sqr
argument_list|(
name|r
index|[
literal|4
index|]
argument_list|,
name|r
index|[
literal|5
index|]
argument_list|,
name|a
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* !(defined(BN_LLONG) || defined(BN_UMULT_HIGH)) */
end_comment

begin_function
name|BN_ULONG
name|bn_mul_add_words
parameter_list|(
name|BN_ULONG
modifier|*
name|rp
parameter_list|,
name|BN_ULONG
modifier|*
name|ap
parameter_list|,
name|int
name|num
parameter_list|,
name|BN_ULONG
name|w
parameter_list|)
block|{
name|BN_ULONG
name|c
init|=
literal|0
decl_stmt|;
name|BN_ULONG
name|bl
decl_stmt|,
name|bh
decl_stmt|;
name|assert
argument_list|(
name|num
operator|>=
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|num
operator|<=
literal|0
condition|)
return|return
operator|(
operator|(
name|BN_ULONG
operator|)
literal|0
operator|)
return|;
name|bl
operator|=
name|LBITS
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|bh
operator|=
name|HBITS
argument_list|(
name|w
argument_list|)
expr_stmt|;
for|for
control|(
init|;
condition|;
control|)
block|{
name|mul_add
argument_list|(
name|rp
index|[
literal|0
index|]
argument_list|,
name|ap
index|[
literal|0
index|]
argument_list|,
name|bl
argument_list|,
name|bh
argument_list|,
name|c
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|num
operator|==
literal|0
condition|)
break|break;
name|mul_add
argument_list|(
name|rp
index|[
literal|1
index|]
argument_list|,
name|ap
index|[
literal|1
index|]
argument_list|,
name|bl
argument_list|,
name|bh
argument_list|,
name|c
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|num
operator|==
literal|0
condition|)
break|break;
name|mul_add
argument_list|(
name|rp
index|[
literal|2
index|]
argument_list|,
name|ap
index|[
literal|2
index|]
argument_list|,
name|bl
argument_list|,
name|bh
argument_list|,
name|c
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|num
operator|==
literal|0
condition|)
break|break;
name|mul_add
argument_list|(
name|rp
index|[
literal|3
index|]
argument_list|,
name|ap
index|[
literal|3
index|]
argument_list|,
name|bl
argument_list|,
name|bh
argument_list|,
name|c
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|num
operator|==
literal|0
condition|)
break|break;
name|ap
operator|+=
literal|4
expr_stmt|;
name|rp
operator|+=
literal|4
expr_stmt|;
block|}
return|return
operator|(
name|c
operator|)
return|;
block|}
end_function

begin_function
name|BN_ULONG
name|bn_mul_words
parameter_list|(
name|BN_ULONG
modifier|*
name|rp
parameter_list|,
name|BN_ULONG
modifier|*
name|ap
parameter_list|,
name|int
name|num
parameter_list|,
name|BN_ULONG
name|w
parameter_list|)
block|{
name|BN_ULONG
name|carry
init|=
literal|0
decl_stmt|;
name|BN_ULONG
name|bl
decl_stmt|,
name|bh
decl_stmt|;
name|assert
argument_list|(
name|num
operator|>=
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|num
operator|<=
literal|0
condition|)
return|return
operator|(
operator|(
name|BN_ULONG
operator|)
literal|0
operator|)
return|;
name|bl
operator|=
name|LBITS
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|bh
operator|=
name|HBITS
argument_list|(
name|w
argument_list|)
expr_stmt|;
for|for
control|(
init|;
condition|;
control|)
block|{
name|mul
argument_list|(
name|rp
index|[
literal|0
index|]
argument_list|,
name|ap
index|[
literal|0
index|]
argument_list|,
name|bl
argument_list|,
name|bh
argument_list|,
name|carry
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|num
operator|==
literal|0
condition|)
break|break;
name|mul
argument_list|(
name|rp
index|[
literal|1
index|]
argument_list|,
name|ap
index|[
literal|1
index|]
argument_list|,
name|bl
argument_list|,
name|bh
argument_list|,
name|carry
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|num
operator|==
literal|0
condition|)
break|break;
name|mul
argument_list|(
name|rp
index|[
literal|2
index|]
argument_list|,
name|ap
index|[
literal|2
index|]
argument_list|,
name|bl
argument_list|,
name|bh
argument_list|,
name|carry
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|num
operator|==
literal|0
condition|)
break|break;
name|mul
argument_list|(
name|rp
index|[
literal|3
index|]
argument_list|,
name|ap
index|[
literal|3
index|]
argument_list|,
name|bl
argument_list|,
name|bh
argument_list|,
name|carry
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|num
operator|==
literal|0
condition|)
break|break;
name|ap
operator|+=
literal|4
expr_stmt|;
name|rp
operator|+=
literal|4
expr_stmt|;
block|}
return|return
operator|(
name|carry
operator|)
return|;
block|}
end_function

begin_function
name|void
name|bn_sqr_words
parameter_list|(
name|BN_ULONG
modifier|*
name|r
parameter_list|,
name|BN_ULONG
modifier|*
name|a
parameter_list|,
name|int
name|n
parameter_list|)
block|{
name|assert
argument_list|(
name|n
operator|>=
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|n
operator|<=
literal|0
condition|)
return|return;
for|for
control|(
init|;
condition|;
control|)
block|{
name|sqr64
argument_list|(
name|r
index|[
literal|0
index|]
argument_list|,
name|r
index|[
literal|1
index|]
argument_list|,
name|a
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|==
literal|0
condition|)
break|break;
name|sqr64
argument_list|(
name|r
index|[
literal|2
index|]
argument_list|,
name|r
index|[
literal|3
index|]
argument_list|,
name|a
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|==
literal|0
condition|)
break|break;
name|sqr64
argument_list|(
name|r
index|[
literal|4
index|]
argument_list|,
name|r
index|[
literal|5
index|]
argument_list|,
name|a
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|==
literal|0
condition|)
break|break;
name|sqr64
argument_list|(
name|r
index|[
literal|6
index|]
argument_list|,
name|r
index|[
literal|7
index|]
argument_list|,
name|a
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|==
literal|0
condition|)
break|break;
name|a
operator|+=
literal|4
expr_stmt|;
name|r
operator|+=
literal|8
expr_stmt|;
block|}
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* !(defined(BN_LLONG) || defined(BN_UMULT_HIGH)) */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|BN_LLONG
argument_list|)
operator|&&
name|defined
argument_list|(
name|BN_DIV2W
argument_list|)
end_if

begin_function
name|BN_ULONG
name|bn_div_words
parameter_list|(
name|BN_ULONG
name|h
parameter_list|,
name|BN_ULONG
name|l
parameter_list|,
name|BN_ULONG
name|d
parameter_list|)
block|{
return|return
operator|(
call|(
name|BN_ULONG
call|)
argument_list|(
operator|(
operator|(
operator|(
operator|(
name|BN_ULLONG
operator|)
name|h
operator|)
operator|<<
name|BN_BITS2
operator|)
operator||
name|l
operator|)
operator|/
operator|(
name|BN_ULLONG
operator|)
name|d
argument_list|)
operator|)
return|;
block|}
end_function

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* Divide h,l by d and return the result. */
end_comment

begin_comment
comment|/* I need to test this some more :-( */
end_comment

begin_function
name|BN_ULONG
name|bn_div_words
parameter_list|(
name|BN_ULONG
name|h
parameter_list|,
name|BN_ULONG
name|l
parameter_list|,
name|BN_ULONG
name|d
parameter_list|)
block|{
name|BN_ULONG
name|dh
decl_stmt|,
name|dl
decl_stmt|,
name|q
decl_stmt|,
name|ret
init|=
literal|0
decl_stmt|,
name|th
decl_stmt|,
name|tl
decl_stmt|,
name|t
decl_stmt|;
name|int
name|i
decl_stmt|,
name|count
init|=
literal|2
decl_stmt|;
if|if
condition|(
name|d
operator|==
literal|0
condition|)
return|return
operator|(
name|BN_MASK2
operator|)
return|;
name|i
operator|=
name|BN_num_bits_word
argument_list|(
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
operator|(
name|i
operator|==
name|BN_BITS2
operator|)
operator|||
operator|(
name|h
operator|>
operator|(
name|BN_ULONG
operator|)
literal|1
operator|<<
name|i
operator|)
argument_list|)
expr_stmt|;
name|i
operator|=
name|BN_BITS2
operator|-
name|i
expr_stmt|;
if|if
condition|(
name|h
operator|>=
name|d
condition|)
name|h
operator|-=
name|d
expr_stmt|;
if|if
condition|(
name|i
condition|)
block|{
name|d
operator|<<=
name|i
expr_stmt|;
name|h
operator|=
operator|(
name|h
operator|<<
name|i
operator|)
operator||
operator|(
name|l
operator|>>
operator|(
name|BN_BITS2
operator|-
name|i
operator|)
operator|)
expr_stmt|;
name|l
operator|<<=
name|i
expr_stmt|;
block|}
name|dh
operator|=
operator|(
name|d
operator|&
name|BN_MASK2h
operator|)
operator|>>
name|BN_BITS4
expr_stmt|;
name|dl
operator|=
operator|(
name|d
operator|&
name|BN_MASK2l
operator|)
expr_stmt|;
for|for
control|(
init|;
condition|;
control|)
block|{
if|if
condition|(
operator|(
name|h
operator|>>
name|BN_BITS4
operator|)
operator|==
name|dh
condition|)
name|q
operator|=
name|BN_MASK2l
expr_stmt|;
else|else
name|q
operator|=
name|h
operator|/
name|dh
expr_stmt|;
name|th
operator|=
name|q
operator|*
name|dh
expr_stmt|;
name|tl
operator|=
name|dl
operator|*
name|q
expr_stmt|;
for|for
control|(
init|;
condition|;
control|)
block|{
name|t
operator|=
name|h
operator|-
name|th
expr_stmt|;
if|if
condition|(
operator|(
name|t
operator|&
name|BN_MASK2h
operator|)
operator|||
operator|(
operator|(
name|tl
operator|)
operator|<=
operator|(
operator|(
name|t
operator|<<
name|BN_BITS4
operator|)
operator||
operator|(
operator|(
name|l
operator|&
name|BN_MASK2h
operator|)
operator|>>
name|BN_BITS4
operator|)
operator|)
operator|)
condition|)
break|break;
name|q
operator|--
expr_stmt|;
name|th
operator|-=
name|dh
expr_stmt|;
name|tl
operator|-=
name|dl
expr_stmt|;
block|}
name|t
operator|=
operator|(
name|tl
operator|>>
name|BN_BITS4
operator|)
expr_stmt|;
name|tl
operator|=
operator|(
name|tl
operator|<<
name|BN_BITS4
operator|)
operator|&
name|BN_MASK2h
expr_stmt|;
name|th
operator|+=
name|t
expr_stmt|;
if|if
condition|(
name|l
operator|<
name|tl
condition|)
name|th
operator|++
expr_stmt|;
name|l
operator|-=
name|tl
expr_stmt|;
if|if
condition|(
name|h
operator|<
name|th
condition|)
block|{
name|h
operator|+=
name|d
expr_stmt|;
name|q
operator|--
expr_stmt|;
block|}
name|h
operator|-=
name|th
expr_stmt|;
if|if
condition|(
operator|--
name|count
operator|==
literal|0
condition|)
break|break;
name|ret
operator|=
name|q
operator|<<
name|BN_BITS4
expr_stmt|;
name|h
operator|=
operator|(
operator|(
name|h
operator|<<
name|BN_BITS4
operator|)
operator||
operator|(
name|l
operator|>>
name|BN_BITS4
operator|)
operator|)
operator|&
name|BN_MASK2
expr_stmt|;
name|l
operator|=
operator|(
name|l
operator|&
name|BN_MASK2l
operator|)
operator|<<
name|BN_BITS4
expr_stmt|;
block|}
name|ret
operator||=
name|q
expr_stmt|;
return|return
operator|(
name|ret
operator|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* !defined(BN_LLONG)&& defined(BN_DIV2W) */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|BN_LLONG
end_ifdef

begin_function
name|BN_ULONG
name|bn_add_words
parameter_list|(
name|BN_ULONG
modifier|*
name|r
parameter_list|,
name|BN_ULONG
modifier|*
name|a
parameter_list|,
name|BN_ULONG
modifier|*
name|b
parameter_list|,
name|int
name|n
parameter_list|)
block|{
name|BN_ULLONG
name|ll
init|=
literal|0
decl_stmt|;
name|assert
argument_list|(
name|n
operator|>=
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|n
operator|<=
literal|0
condition|)
return|return
operator|(
operator|(
name|BN_ULONG
operator|)
literal|0
operator|)
return|;
for|for
control|(
init|;
condition|;
control|)
block|{
name|ll
operator|+=
operator|(
name|BN_ULLONG
operator|)
name|a
index|[
literal|0
index|]
operator|+
name|b
index|[
literal|0
index|]
expr_stmt|;
name|r
index|[
literal|0
index|]
operator|=
operator|(
name|BN_ULONG
operator|)
name|ll
operator|&
name|BN_MASK2
expr_stmt|;
name|ll
operator|>>=
name|BN_BITS2
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|<=
literal|0
condition|)
break|break;
name|ll
operator|+=
operator|(
name|BN_ULLONG
operator|)
name|a
index|[
literal|1
index|]
operator|+
name|b
index|[
literal|1
index|]
expr_stmt|;
name|r
index|[
literal|1
index|]
operator|=
operator|(
name|BN_ULONG
operator|)
name|ll
operator|&
name|BN_MASK2
expr_stmt|;
name|ll
operator|>>=
name|BN_BITS2
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|<=
literal|0
condition|)
break|break;
name|ll
operator|+=
operator|(
name|BN_ULLONG
operator|)
name|a
index|[
literal|2
index|]
operator|+
name|b
index|[
literal|2
index|]
expr_stmt|;
name|r
index|[
literal|2
index|]
operator|=
operator|(
name|BN_ULONG
operator|)
name|ll
operator|&
name|BN_MASK2
expr_stmt|;
name|ll
operator|>>=
name|BN_BITS2
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|<=
literal|0
condition|)
break|break;
name|ll
operator|+=
operator|(
name|BN_ULLONG
operator|)
name|a
index|[
literal|3
index|]
operator|+
name|b
index|[
literal|3
index|]
expr_stmt|;
name|r
index|[
literal|3
index|]
operator|=
operator|(
name|BN_ULONG
operator|)
name|ll
operator|&
name|BN_MASK2
expr_stmt|;
name|ll
operator|>>=
name|BN_BITS2
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|<=
literal|0
condition|)
break|break;
name|a
operator|+=
literal|4
expr_stmt|;
name|b
operator|+=
literal|4
expr_stmt|;
name|r
operator|+=
literal|4
expr_stmt|;
block|}
return|return
operator|(
operator|(
name|BN_ULONG
operator|)
name|ll
operator|)
return|;
block|}
end_function

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* !BN_LLONG */
end_comment

begin_function
name|BN_ULONG
name|bn_add_words
parameter_list|(
name|BN_ULONG
modifier|*
name|r
parameter_list|,
name|BN_ULONG
modifier|*
name|a
parameter_list|,
name|BN_ULONG
modifier|*
name|b
parameter_list|,
name|int
name|n
parameter_list|)
block|{
name|BN_ULONG
name|c
decl_stmt|,
name|l
decl_stmt|,
name|t
decl_stmt|;
name|assert
argument_list|(
name|n
operator|>=
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|n
operator|<=
literal|0
condition|)
return|return
operator|(
operator|(
name|BN_ULONG
operator|)
literal|0
operator|)
return|;
name|c
operator|=
literal|0
expr_stmt|;
for|for
control|(
init|;
condition|;
control|)
block|{
name|t
operator|=
name|a
index|[
literal|0
index|]
expr_stmt|;
name|t
operator|=
operator|(
name|t
operator|+
name|c
operator|)
operator|&
name|BN_MASK2
expr_stmt|;
name|c
operator|=
operator|(
name|t
operator|<
name|c
operator|)
expr_stmt|;
name|l
operator|=
operator|(
name|t
operator|+
name|b
index|[
literal|0
index|]
operator|)
operator|&
name|BN_MASK2
expr_stmt|;
name|c
operator|+=
operator|(
name|l
operator|<
name|t
operator|)
expr_stmt|;
name|r
index|[
literal|0
index|]
operator|=
name|l
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|<=
literal|0
condition|)
break|break;
name|t
operator|=
name|a
index|[
literal|1
index|]
expr_stmt|;
name|t
operator|=
operator|(
name|t
operator|+
name|c
operator|)
operator|&
name|BN_MASK2
expr_stmt|;
name|c
operator|=
operator|(
name|t
operator|<
name|c
operator|)
expr_stmt|;
name|l
operator|=
operator|(
name|t
operator|+
name|b
index|[
literal|1
index|]
operator|)
operator|&
name|BN_MASK2
expr_stmt|;
name|c
operator|+=
operator|(
name|l
operator|<
name|t
operator|)
expr_stmt|;
name|r
index|[
literal|1
index|]
operator|=
name|l
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|<=
literal|0
condition|)
break|break;
name|t
operator|=
name|a
index|[
literal|2
index|]
expr_stmt|;
name|t
operator|=
operator|(
name|t
operator|+
name|c
operator|)
operator|&
name|BN_MASK2
expr_stmt|;
name|c
operator|=
operator|(
name|t
operator|<
name|c
operator|)
expr_stmt|;
name|l
operator|=
operator|(
name|t
operator|+
name|b
index|[
literal|2
index|]
operator|)
operator|&
name|BN_MASK2
expr_stmt|;
name|c
operator|+=
operator|(
name|l
operator|<
name|t
operator|)
expr_stmt|;
name|r
index|[
literal|2
index|]
operator|=
name|l
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|<=
literal|0
condition|)
break|break;
name|t
operator|=
name|a
index|[
literal|3
index|]
expr_stmt|;
name|t
operator|=
operator|(
name|t
operator|+
name|c
operator|)
operator|&
name|BN_MASK2
expr_stmt|;
name|c
operator|=
operator|(
name|t
operator|<
name|c
operator|)
expr_stmt|;
name|l
operator|=
operator|(
name|t
operator|+
name|b
index|[
literal|3
index|]
operator|)
operator|&
name|BN_MASK2
expr_stmt|;
name|c
operator|+=
operator|(
name|l
operator|<
name|t
operator|)
expr_stmt|;
name|r
index|[
literal|3
index|]
operator|=
name|l
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|<=
literal|0
condition|)
break|break;
name|a
operator|+=
literal|4
expr_stmt|;
name|b
operator|+=
literal|4
expr_stmt|;
name|r
operator|+=
literal|4
expr_stmt|;
block|}
return|return
operator|(
operator|(
name|BN_ULONG
operator|)
name|c
operator|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* !BN_LLONG */
end_comment

begin_function
name|BN_ULONG
name|bn_sub_words
parameter_list|(
name|BN_ULONG
modifier|*
name|r
parameter_list|,
name|BN_ULONG
modifier|*
name|a
parameter_list|,
name|BN_ULONG
modifier|*
name|b
parameter_list|,
name|int
name|n
parameter_list|)
block|{
name|BN_ULONG
name|t1
decl_stmt|,
name|t2
decl_stmt|;
name|int
name|c
init|=
literal|0
decl_stmt|;
name|assert
argument_list|(
name|n
operator|>=
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|n
operator|<=
literal|0
condition|)
return|return
operator|(
operator|(
name|BN_ULONG
operator|)
literal|0
operator|)
return|;
for|for
control|(
init|;
condition|;
control|)
block|{
name|t1
operator|=
name|a
index|[
literal|0
index|]
expr_stmt|;
name|t2
operator|=
name|b
index|[
literal|0
index|]
expr_stmt|;
name|r
index|[
literal|0
index|]
operator|=
operator|(
name|t1
operator|-
name|t2
operator|-
name|c
operator|)
operator|&
name|BN_MASK2
expr_stmt|;
if|if
condition|(
name|t1
operator|!=
name|t2
condition|)
name|c
operator|=
operator|(
name|t1
operator|<
name|t2
operator|)
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|<=
literal|0
condition|)
break|break;
name|t1
operator|=
name|a
index|[
literal|1
index|]
expr_stmt|;
name|t2
operator|=
name|b
index|[
literal|1
index|]
expr_stmt|;
name|r
index|[
literal|1
index|]
operator|=
operator|(
name|t1
operator|-
name|t2
operator|-
name|c
operator|)
operator|&
name|BN_MASK2
expr_stmt|;
if|if
condition|(
name|t1
operator|!=
name|t2
condition|)
name|c
operator|=
operator|(
name|t1
operator|<
name|t2
operator|)
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|<=
literal|0
condition|)
break|break;
name|t1
operator|=
name|a
index|[
literal|2
index|]
expr_stmt|;
name|t2
operator|=
name|b
index|[
literal|2
index|]
expr_stmt|;
name|r
index|[
literal|2
index|]
operator|=
operator|(
name|t1
operator|-
name|t2
operator|-
name|c
operator|)
operator|&
name|BN_MASK2
expr_stmt|;
if|if
condition|(
name|t1
operator|!=
name|t2
condition|)
name|c
operator|=
operator|(
name|t1
operator|<
name|t2
operator|)
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|<=
literal|0
condition|)
break|break;
name|t1
operator|=
name|a
index|[
literal|3
index|]
expr_stmt|;
name|t2
operator|=
name|b
index|[
literal|3
index|]
expr_stmt|;
name|r
index|[
literal|3
index|]
operator|=
operator|(
name|t1
operator|-
name|t2
operator|-
name|c
operator|)
operator|&
name|BN_MASK2
expr_stmt|;
if|if
condition|(
name|t1
operator|!=
name|t2
condition|)
name|c
operator|=
operator|(
name|t1
operator|<
name|t2
operator|)
expr_stmt|;
if|if
condition|(
operator|--
name|n
operator|<=
literal|0
condition|)
break|break;
name|a
operator|+=
literal|4
expr_stmt|;
name|b
operator|+=
literal|4
expr_stmt|;
name|r
operator|+=
literal|4
expr_stmt|;
block|}
return|return
operator|(
name|c
operator|)
return|;
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|BN_MUL_COMBA
end_ifdef

begin_undef
undef|#
directive|undef
name|bn_mul_comba8
end_undef

begin_undef
undef|#
directive|undef
name|bn_mul_comba4
end_undef

begin_undef
undef|#
directive|undef
name|bn_sqr_comba8
end_undef

begin_undef
undef|#
directive|undef
name|bn_sqr_comba4
end_undef

begin_comment
comment|/* mul_add_c(a,b,c0,c1,c2)  -- c+=a*b for three word number c=(c2,c1,c0) */
end_comment

begin_comment
comment|/* mul_add_c2(a,b,c0,c1,c2) -- c+=2*a*b for three word number c=(c2,c1,c0) */
end_comment

begin_comment
comment|/* sqr_add_c(a,i,c0,c1,c2)  -- c+=a[i]^2 for three word number c=(c2,c1,c0) */
end_comment

begin_comment
comment|/* sqr_add_c2(a,i,c0,c1,c2) -- c+=2*a[i]*a[j] for three word number c=(c2,c1,c0) */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|BN_LLONG
end_ifdef

begin_define
define|#
directive|define
name|mul_add_c
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|c0
parameter_list|,
name|c1
parameter_list|,
name|c2
parameter_list|)
define|\
value|t=(BN_ULLONG)a*b; \ 	t1=(BN_ULONG)Lw(t); \ 	t2=(BN_ULONG)Hw(t); \ 	c0=(c0+t1)&BN_MASK2; if ((c0)< t1) t2++; \ 	c1=(c1+t2)&BN_MASK2; if ((c1)< t2) c2++;
end_define

begin_define
define|#
directive|define
name|mul_add_c2
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|c0
parameter_list|,
name|c1
parameter_list|,
name|c2
parameter_list|)
define|\
value|t=(BN_ULLONG)a*b; \ 	tt=(t+t)&BN_MASK; \ 	if (tt< t) c2++; \ 	t1=(BN_ULONG)Lw(tt); \ 	t2=(BN_ULONG)Hw(tt); \ 	c0=(c0+t1)&BN_MASK2;  \ 	if ((c0< t1)&& (((++t2)&BN_MASK2) == 0)) c2++; \ 	c1=(c1+t2)&BN_MASK2; if ((c1)< t2) c2++;
end_define

begin_define
define|#
directive|define
name|sqr_add_c
parameter_list|(
name|a
parameter_list|,
name|i
parameter_list|,
name|c0
parameter_list|,
name|c1
parameter_list|,
name|c2
parameter_list|)
define|\
value|t=(BN_ULLONG)a[i]*a[i]; \ 	t1=(BN_ULONG)Lw(t); \ 	t2=(BN_ULONG)Hw(t); \ 	c0=(c0+t1)&BN_MASK2; if ((c0)< t1) t2++; \ 	c1=(c1+t2)&BN_MASK2; if ((c1)< t2) c2++;
end_define

begin_define
define|#
directive|define
name|sqr_add_c2
parameter_list|(
name|a
parameter_list|,
name|i
parameter_list|,
name|j
parameter_list|,
name|c0
parameter_list|,
name|c1
parameter_list|,
name|c2
parameter_list|)
define|\
value|mul_add_c2((a)[i],(a)[j],c0,c1,c2)
end_define

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|BN_UMULT_HIGH
argument_list|)
end_elif

begin_define
define|#
directive|define
name|mul_add_c
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|c0
parameter_list|,
name|c1
parameter_list|,
name|c2
parameter_list|)
value|{	\ 	BN_ULONG ta=(a),tb=(b);		\ 	t1 = ta * tb;			\ 	t2 = BN_UMULT_HIGH(ta,tb);	\ 	c0 += t1; t2 += (c0<t1)?1:0;	\ 	c1 += t2; c2 += (c1<t2)?1:0;	\ 	}
end_define

begin_define
define|#
directive|define
name|mul_add_c2
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|c0
parameter_list|,
name|c1
parameter_list|,
name|c2
parameter_list|)
value|{	\ 	BN_ULONG ta=(a),tb=(b),t0;	\ 	t1 = BN_UMULT_HIGH(ta,tb);	\ 	t0 = ta * tb;			\ 	t2 = t1+t1; c2 += (t2<t1)?1:0;	\ 	t1 = t0+t0; t2 += (t1<t0)?1:0;	\ 	c0 += t1; t2 += (c0<t1)?1:0;	\ 	c1 += t2; c2 += (c1<t2)?1:0;	\ 	}
end_define

begin_define
define|#
directive|define
name|sqr_add_c
parameter_list|(
name|a
parameter_list|,
name|i
parameter_list|,
name|c0
parameter_list|,
name|c1
parameter_list|,
name|c2
parameter_list|)
value|{	\ 	BN_ULONG ta=(a)[i];		\ 	t1 = ta * ta;			\ 	t2 = BN_UMULT_HIGH(ta,ta);	\ 	c0 += t1; t2 += (c0<t1)?1:0;	\ 	c1 += t2; c2 += (c1<t2)?1:0;	\ 	}
end_define

begin_define
define|#
directive|define
name|sqr_add_c2
parameter_list|(
name|a
parameter_list|,
name|i
parameter_list|,
name|j
parameter_list|,
name|c0
parameter_list|,
name|c1
parameter_list|,
name|c2
parameter_list|)
define|\
value|mul_add_c2((a)[i],(a)[j],c0,c1,c2)
end_define

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* !BN_LLONG */
end_comment

begin_define
define|#
directive|define
name|mul_add_c
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|c0
parameter_list|,
name|c1
parameter_list|,
name|c2
parameter_list|)
define|\
value|t1=LBITS(a); t2=HBITS(a); \ 	bl=LBITS(b); bh=HBITS(b); \ 	mul64(t1,t2,bl,bh); \ 	c0=(c0+t1)&BN_MASK2; if ((c0)< t1) t2++; \ 	c1=(c1+t2)&BN_MASK2; if ((c1)< t2) c2++;
end_define

begin_define
define|#
directive|define
name|mul_add_c2
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|c0
parameter_list|,
name|c1
parameter_list|,
name|c2
parameter_list|)
define|\
value|t1=LBITS(a); t2=HBITS(a); \ 	bl=LBITS(b); bh=HBITS(b); \ 	mul64(t1,t2,bl,bh); \ 	if (t2& BN_TBIT) c2++; \ 	t2=(t2+t2)&BN_MASK2; \ 	if (t1& BN_TBIT) t2++; \ 	t1=(t1+t1)&BN_MASK2; \ 	c0=(c0+t1)&BN_MASK2;  \ 	if ((c0< t1)&& (((++t2)&BN_MASK2) == 0)) c2++; \ 	c1=(c1+t2)&BN_MASK2; if ((c1)< t2) c2++;
end_define

begin_define
define|#
directive|define
name|sqr_add_c
parameter_list|(
name|a
parameter_list|,
name|i
parameter_list|,
name|c0
parameter_list|,
name|c1
parameter_list|,
name|c2
parameter_list|)
define|\
value|sqr64(t1,t2,(a)[i]); \ 	c0=(c0+t1)&BN_MASK2; if ((c0)< t1) t2++; \ 	c1=(c1+t2)&BN_MASK2; if ((c1)< t2) c2++;
end_define

begin_define
define|#
directive|define
name|sqr_add_c2
parameter_list|(
name|a
parameter_list|,
name|i
parameter_list|,
name|j
parameter_list|,
name|c0
parameter_list|,
name|c1
parameter_list|,
name|c2
parameter_list|)
define|\
value|mul_add_c2((a)[i],(a)[j],c0,c1,c2)
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* !BN_LLONG */
end_comment

begin_function
name|void
name|bn_mul_comba8
parameter_list|(
name|BN_ULONG
modifier|*
name|r
parameter_list|,
name|BN_ULONG
modifier|*
name|a
parameter_list|,
name|BN_ULONG
modifier|*
name|b
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|BN_LLONG
name|BN_ULLONG
name|t
decl_stmt|;
else|#
directive|else
name|BN_ULONG
name|bl
decl_stmt|,
name|bh
decl_stmt|;
endif|#
directive|endif
name|BN_ULONG
name|t1
decl_stmt|,
name|t2
decl_stmt|;
name|BN_ULONG
name|c1
decl_stmt|,
name|c2
decl_stmt|,
name|c3
decl_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|c3
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|0
index|]
argument_list|,
name|b
index|[
literal|0
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|r
index|[
literal|0
index|]
operator|=
name|c1
expr_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|0
index|]
argument_list|,
name|b
index|[
literal|1
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|1
index|]
argument_list|,
name|b
index|[
literal|0
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|r
index|[
literal|1
index|]
operator|=
name|c2
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|2
index|]
argument_list|,
name|b
index|[
literal|0
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|1
index|]
argument_list|,
name|b
index|[
literal|1
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|0
index|]
argument_list|,
name|b
index|[
literal|2
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|r
index|[
literal|2
index|]
operator|=
name|c3
expr_stmt|;
name|c3
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|0
index|]
argument_list|,
name|b
index|[
literal|3
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|1
index|]
argument_list|,
name|b
index|[
literal|2
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|2
index|]
argument_list|,
name|b
index|[
literal|1
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|3
index|]
argument_list|,
name|b
index|[
literal|0
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|r
index|[
literal|3
index|]
operator|=
name|c1
expr_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|4
index|]
argument_list|,
name|b
index|[
literal|0
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|3
index|]
argument_list|,
name|b
index|[
literal|1
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|2
index|]
argument_list|,
name|b
index|[
literal|2
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|1
index|]
argument_list|,
name|b
index|[
literal|3
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|0
index|]
argument_list|,
name|b
index|[
literal|4
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|r
index|[
literal|4
index|]
operator|=
name|c2
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|0
index|]
argument_list|,
name|b
index|[
literal|5
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|1
index|]
argument_list|,
name|b
index|[
literal|4
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|2
index|]
argument_list|,
name|b
index|[
literal|3
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|3
index|]
argument_list|,
name|b
index|[
literal|2
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|4
index|]
argument_list|,
name|b
index|[
literal|1
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|5
index|]
argument_list|,
name|b
index|[
literal|0
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|r
index|[
literal|5
index|]
operator|=
name|c3
expr_stmt|;
name|c3
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|6
index|]
argument_list|,
name|b
index|[
literal|0
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|5
index|]
argument_list|,
name|b
index|[
literal|1
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|4
index|]
argument_list|,
name|b
index|[
literal|2
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|3
index|]
argument_list|,
name|b
index|[
literal|3
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|2
index|]
argument_list|,
name|b
index|[
literal|4
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|1
index|]
argument_list|,
name|b
index|[
literal|5
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|0
index|]
argument_list|,
name|b
index|[
literal|6
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|r
index|[
literal|6
index|]
operator|=
name|c1
expr_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|0
index|]
argument_list|,
name|b
index|[
literal|7
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|1
index|]
argument_list|,
name|b
index|[
literal|6
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|2
index|]
argument_list|,
name|b
index|[
literal|5
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|3
index|]
argument_list|,
name|b
index|[
literal|4
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|4
index|]
argument_list|,
name|b
index|[
literal|3
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|5
index|]
argument_list|,
name|b
index|[
literal|2
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|6
index|]
argument_list|,
name|b
index|[
literal|1
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|7
index|]
argument_list|,
name|b
index|[
literal|0
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|r
index|[
literal|7
index|]
operator|=
name|c2
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|7
index|]
argument_list|,
name|b
index|[
literal|1
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|6
index|]
argument_list|,
name|b
index|[
literal|2
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|5
index|]
argument_list|,
name|b
index|[
literal|3
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|4
index|]
argument_list|,
name|b
index|[
literal|4
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|3
index|]
argument_list|,
name|b
index|[
literal|5
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|2
index|]
argument_list|,
name|b
index|[
literal|6
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|1
index|]
argument_list|,
name|b
index|[
literal|7
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|r
index|[
literal|8
index|]
operator|=
name|c3
expr_stmt|;
name|c3
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|2
index|]
argument_list|,
name|b
index|[
literal|7
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|3
index|]
argument_list|,
name|b
index|[
literal|6
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|4
index|]
argument_list|,
name|b
index|[
literal|5
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|5
index|]
argument_list|,
name|b
index|[
literal|4
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|6
index|]
argument_list|,
name|b
index|[
literal|3
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|7
index|]
argument_list|,
name|b
index|[
literal|2
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|r
index|[
literal|9
index|]
operator|=
name|c1
expr_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|7
index|]
argument_list|,
name|b
index|[
literal|3
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|6
index|]
argument_list|,
name|b
index|[
literal|4
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|5
index|]
argument_list|,
name|b
index|[
literal|5
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|4
index|]
argument_list|,
name|b
index|[
literal|6
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|3
index|]
argument_list|,
name|b
index|[
literal|7
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|r
index|[
literal|10
index|]
operator|=
name|c2
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|4
index|]
argument_list|,
name|b
index|[
literal|7
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|5
index|]
argument_list|,
name|b
index|[
literal|6
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|6
index|]
argument_list|,
name|b
index|[
literal|5
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|7
index|]
argument_list|,
name|b
index|[
literal|4
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|r
index|[
literal|11
index|]
operator|=
name|c3
expr_stmt|;
name|c3
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|7
index|]
argument_list|,
name|b
index|[
literal|5
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|6
index|]
argument_list|,
name|b
index|[
literal|6
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|5
index|]
argument_list|,
name|b
index|[
literal|7
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|r
index|[
literal|12
index|]
operator|=
name|c1
expr_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|6
index|]
argument_list|,
name|b
index|[
literal|7
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|7
index|]
argument_list|,
name|b
index|[
literal|6
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|r
index|[
literal|13
index|]
operator|=
name|c2
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|7
index|]
argument_list|,
name|b
index|[
literal|7
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|r
index|[
literal|14
index|]
operator|=
name|c3
expr_stmt|;
name|r
index|[
literal|15
index|]
operator|=
name|c1
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bn_mul_comba4
parameter_list|(
name|BN_ULONG
modifier|*
name|r
parameter_list|,
name|BN_ULONG
modifier|*
name|a
parameter_list|,
name|BN_ULONG
modifier|*
name|b
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|BN_LLONG
name|BN_ULLONG
name|t
decl_stmt|;
else|#
directive|else
name|BN_ULONG
name|bl
decl_stmt|,
name|bh
decl_stmt|;
endif|#
directive|endif
name|BN_ULONG
name|t1
decl_stmt|,
name|t2
decl_stmt|;
name|BN_ULONG
name|c1
decl_stmt|,
name|c2
decl_stmt|,
name|c3
decl_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|c3
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|0
index|]
argument_list|,
name|b
index|[
literal|0
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|r
index|[
literal|0
index|]
operator|=
name|c1
expr_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|0
index|]
argument_list|,
name|b
index|[
literal|1
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|1
index|]
argument_list|,
name|b
index|[
literal|0
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|r
index|[
literal|1
index|]
operator|=
name|c2
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|2
index|]
argument_list|,
name|b
index|[
literal|0
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|1
index|]
argument_list|,
name|b
index|[
literal|1
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|0
index|]
argument_list|,
name|b
index|[
literal|2
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|r
index|[
literal|2
index|]
operator|=
name|c3
expr_stmt|;
name|c3
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|0
index|]
argument_list|,
name|b
index|[
literal|3
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|1
index|]
argument_list|,
name|b
index|[
literal|2
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|2
index|]
argument_list|,
name|b
index|[
literal|1
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|3
index|]
argument_list|,
name|b
index|[
literal|0
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|r
index|[
literal|3
index|]
operator|=
name|c1
expr_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|3
index|]
argument_list|,
name|b
index|[
literal|1
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|2
index|]
argument_list|,
name|b
index|[
literal|2
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|1
index|]
argument_list|,
name|b
index|[
literal|3
index|]
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|r
index|[
literal|4
index|]
operator|=
name|c2
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|2
index|]
argument_list|,
name|b
index|[
literal|3
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|3
index|]
argument_list|,
name|b
index|[
literal|2
index|]
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|r
index|[
literal|5
index|]
operator|=
name|c3
expr_stmt|;
name|c3
operator|=
literal|0
expr_stmt|;
name|mul_add_c
argument_list|(
name|a
index|[
literal|3
index|]
argument_list|,
name|b
index|[
literal|3
index|]
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|r
index|[
literal|6
index|]
operator|=
name|c1
expr_stmt|;
name|r
index|[
literal|7
index|]
operator|=
name|c2
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bn_sqr_comba8
parameter_list|(
name|BN_ULONG
modifier|*
name|r
parameter_list|,
name|BN_ULONG
modifier|*
name|a
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|BN_LLONG
name|BN_ULLONG
name|t
decl_stmt|,
name|tt
decl_stmt|;
else|#
directive|else
name|BN_ULONG
name|bl
decl_stmt|,
name|bh
decl_stmt|;
endif|#
directive|endif
name|BN_ULONG
name|t1
decl_stmt|,
name|t2
decl_stmt|;
name|BN_ULONG
name|c1
decl_stmt|,
name|c2
decl_stmt|,
name|c3
decl_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|c3
operator|=
literal|0
expr_stmt|;
name|sqr_add_c
argument_list|(
name|a
argument_list|,
literal|0
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|r
index|[
literal|0
index|]
operator|=
name|c1
expr_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|r
index|[
literal|1
index|]
operator|=
name|c2
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|sqr_add_c
argument_list|(
name|a
argument_list|,
literal|1
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|r
index|[
literal|2
index|]
operator|=
name|c3
expr_stmt|;
name|c3
operator|=
literal|0
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|r
index|[
literal|3
index|]
operator|=
name|c1
expr_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|sqr_add_c
argument_list|(
name|a
argument_list|,
literal|2
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|4
argument_list|,
literal|0
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|r
index|[
literal|4
index|]
operator|=
name|c2
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|4
argument_list|,
literal|1
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|3
argument_list|,
literal|2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|r
index|[
literal|5
index|]
operator|=
name|c3
expr_stmt|;
name|c3
operator|=
literal|0
expr_stmt|;
name|sqr_add_c
argument_list|(
name|a
argument_list|,
literal|3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|4
argument_list|,
literal|2
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|5
argument_list|,
literal|1
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|6
argument_list|,
literal|0
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|r
index|[
literal|6
index|]
operator|=
name|c1
expr_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|7
argument_list|,
literal|0
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|6
argument_list|,
literal|1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|5
argument_list|,
literal|2
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|4
argument_list|,
literal|3
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|r
index|[
literal|7
index|]
operator|=
name|c2
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|sqr_add_c
argument_list|(
name|a
argument_list|,
literal|4
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|5
argument_list|,
literal|3
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|6
argument_list|,
literal|2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|7
argument_list|,
literal|1
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|r
index|[
literal|8
index|]
operator|=
name|c3
expr_stmt|;
name|c3
operator|=
literal|0
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|7
argument_list|,
literal|2
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|6
argument_list|,
literal|3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|5
argument_list|,
literal|4
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|r
index|[
literal|9
index|]
operator|=
name|c1
expr_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|sqr_add_c
argument_list|(
name|a
argument_list|,
literal|5
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|6
argument_list|,
literal|4
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|7
argument_list|,
literal|3
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|r
index|[
literal|10
index|]
operator|=
name|c2
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|7
argument_list|,
literal|4
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|6
argument_list|,
literal|5
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|r
index|[
literal|11
index|]
operator|=
name|c3
expr_stmt|;
name|c3
operator|=
literal|0
expr_stmt|;
name|sqr_add_c
argument_list|(
name|a
argument_list|,
literal|6
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|7
argument_list|,
literal|5
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|r
index|[
literal|12
index|]
operator|=
name|c1
expr_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|7
argument_list|,
literal|6
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|r
index|[
literal|13
index|]
operator|=
name|c2
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|sqr_add_c
argument_list|(
name|a
argument_list|,
literal|7
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|r
index|[
literal|14
index|]
operator|=
name|c3
expr_stmt|;
name|r
index|[
literal|15
index|]
operator|=
name|c1
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bn_sqr_comba4
parameter_list|(
name|BN_ULONG
modifier|*
name|r
parameter_list|,
name|BN_ULONG
modifier|*
name|a
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|BN_LLONG
name|BN_ULLONG
name|t
decl_stmt|,
name|tt
decl_stmt|;
else|#
directive|else
name|BN_ULONG
name|bl
decl_stmt|,
name|bh
decl_stmt|;
endif|#
directive|endif
name|BN_ULONG
name|t1
decl_stmt|,
name|t2
decl_stmt|;
name|BN_ULONG
name|c1
decl_stmt|,
name|c2
decl_stmt|,
name|c3
decl_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|c3
operator|=
literal|0
expr_stmt|;
name|sqr_add_c
argument_list|(
name|a
argument_list|,
literal|0
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|r
index|[
literal|0
index|]
operator|=
name|c1
expr_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|r
index|[
literal|1
index|]
operator|=
name|c2
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|sqr_add_c
argument_list|(
name|a
argument_list|,
literal|1
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|r
index|[
literal|2
index|]
operator|=
name|c3
expr_stmt|;
name|c3
operator|=
literal|0
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|r
index|[
literal|3
index|]
operator|=
name|c1
expr_stmt|;
name|c1
operator|=
literal|0
expr_stmt|;
name|sqr_add_c
argument_list|(
name|a
argument_list|,
literal|2
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|)
expr_stmt|;
name|r
index|[
literal|4
index|]
operator|=
name|c2
expr_stmt|;
name|c2
operator|=
literal|0
expr_stmt|;
name|sqr_add_c2
argument_list|(
name|a
argument_list|,
literal|3
argument_list|,
literal|2
argument_list|,
name|c3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|r
index|[
literal|5
index|]
operator|=
name|c3
expr_stmt|;
name|c3
operator|=
literal|0
expr_stmt|;
name|sqr_add_c
argument_list|(
name|a
argument_list|,
literal|3
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|,
name|c3
argument_list|)
expr_stmt|;
name|r
index|[
literal|6
index|]
operator|=
name|c1
expr_stmt|;
name|r
index|[
literal|7
index|]
operator|=
name|c2
expr_stmt|;
block|}
end_function

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* !BN_MUL_COMBA */
end_comment

begin_comment
comment|/* hmm... is it faster just to do a multiply? */
end_comment

begin_undef
undef|#
directive|undef
name|bn_sqr_comba4
end_undef

begin_function
name|void
name|bn_sqr_comba4
parameter_list|(
name|BN_ULONG
modifier|*
name|r
parameter_list|,
name|BN_ULONG
modifier|*
name|a
parameter_list|)
block|{
name|BN_ULONG
name|t
index|[
literal|8
index|]
decl_stmt|;
name|bn_sqr_normal
argument_list|(
name|r
argument_list|,
name|a
argument_list|,
literal|4
argument_list|,
name|t
argument_list|)
expr_stmt|;
block|}
end_function

begin_undef
undef|#
directive|undef
name|bn_sqr_comba8
end_undef

begin_function
name|void
name|bn_sqr_comba8
parameter_list|(
name|BN_ULONG
modifier|*
name|r
parameter_list|,
name|BN_ULONG
modifier|*
name|a
parameter_list|)
block|{
name|BN_ULONG
name|t
index|[
literal|16
index|]
decl_stmt|;
name|bn_sqr_normal
argument_list|(
name|r
argument_list|,
name|a
argument_list|,
literal|8
argument_list|,
name|t
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bn_mul_comba4
parameter_list|(
name|BN_ULONG
modifier|*
name|r
parameter_list|,
name|BN_ULONG
modifier|*
name|a
parameter_list|,
name|BN_ULONG
modifier|*
name|b
parameter_list|)
block|{
name|r
index|[
literal|4
index|]
operator|=
name|bn_mul_words
argument_list|(
operator|&
operator|(
name|r
index|[
literal|0
index|]
operator|)
argument_list|,
name|a
argument_list|,
literal|4
argument_list|,
name|b
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|r
index|[
literal|5
index|]
operator|=
name|bn_mul_add_words
argument_list|(
operator|&
operator|(
name|r
index|[
literal|1
index|]
operator|)
argument_list|,
name|a
argument_list|,
literal|4
argument_list|,
name|b
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|r
index|[
literal|6
index|]
operator|=
name|bn_mul_add_words
argument_list|(
operator|&
operator|(
name|r
index|[
literal|2
index|]
operator|)
argument_list|,
name|a
argument_list|,
literal|4
argument_list|,
name|b
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|r
index|[
literal|7
index|]
operator|=
name|bn_mul_add_words
argument_list|(
operator|&
operator|(
name|r
index|[
literal|3
index|]
operator|)
argument_list|,
name|a
argument_list|,
literal|4
argument_list|,
name|b
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bn_mul_comba8
parameter_list|(
name|BN_ULONG
modifier|*
name|r
parameter_list|,
name|BN_ULONG
modifier|*
name|a
parameter_list|,
name|BN_ULONG
modifier|*
name|b
parameter_list|)
block|{
name|r
index|[
literal|8
index|]
operator|=
name|bn_mul_words
argument_list|(
operator|&
operator|(
name|r
index|[
literal|0
index|]
operator|)
argument_list|,
name|a
argument_list|,
literal|8
argument_list|,
name|b
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|r
index|[
literal|9
index|]
operator|=
name|bn_mul_add_words
argument_list|(
operator|&
operator|(
name|r
index|[
literal|1
index|]
operator|)
argument_list|,
name|a
argument_list|,
literal|8
argument_list|,
name|b
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|r
index|[
literal|10
index|]
operator|=
name|bn_mul_add_words
argument_list|(
operator|&
operator|(
name|r
index|[
literal|2
index|]
operator|)
argument_list|,
name|a
argument_list|,
literal|8
argument_list|,
name|b
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|r
index|[
literal|11
index|]
operator|=
name|bn_mul_add_words
argument_list|(
operator|&
operator|(
name|r
index|[
literal|3
index|]
operator|)
argument_list|,
name|a
argument_list|,
literal|8
argument_list|,
name|b
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|r
index|[
literal|12
index|]
operator|=
name|bn_mul_add_words
argument_list|(
operator|&
operator|(
name|r
index|[
literal|4
index|]
operator|)
argument_list|,
name|a
argument_list|,
literal|8
argument_list|,
name|b
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|r
index|[
literal|13
index|]
operator|=
name|bn_mul_add_words
argument_list|(
operator|&
operator|(
name|r
index|[
literal|5
index|]
operator|)
argument_list|,
name|a
argument_list|,
literal|8
argument_list|,
name|b
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
name|r
index|[
literal|14
index|]
operator|=
name|bn_mul_add_words
argument_list|(
operator|&
operator|(
name|r
index|[
literal|6
index|]
operator|)
argument_list|,
name|a
argument_list|,
literal|8
argument_list|,
name|b
index|[
literal|6
index|]
argument_list|)
expr_stmt|;
name|r
index|[
literal|15
index|]
operator|=
name|bn_mul_add_words
argument_list|(
operator|&
operator|(
name|r
index|[
literal|7
index|]
operator|)
argument_list|,
name|a
argument_list|,
literal|8
argument_list|,
name|b
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* !BN_MUL_COMBA */
end_comment

end_unit

