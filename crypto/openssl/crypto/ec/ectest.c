begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* crypto/ec/ectest.c */
end_comment

begin_comment
comment|/* ====================================================================  * Copyright (c) 1998-2001 The OpenSSL Project.  All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  *  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.   *  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in  *    the documentation and/or other materials provided with the  *    distribution.  *  * 3. All advertising materials mentioning features or use of this  *    software must display the following acknowledgment:  *    "This product includes software developed by the OpenSSL Project  *    for use in the OpenSSL Toolkit. (http://www.openssl.org/)"  *  * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to  *    endorse or promote products derived from this software without  *    prior written permission. For written permission, please contact  *    openssl-core@openssl.org.  *  * 5. Products derived from this software may not be called "OpenSSL"  *    nor may "OpenSSL" appear in their names without prior written  *    permission of the OpenSSL Project.  *  * 6. Redistributions of any form whatsoever must retain the following  *    acknowledgment:  *    "This product includes software developed by the OpenSSL Project  *    for use in the OpenSSL Toolkit (http://www.openssl.org/)"  *  * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY  * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR  * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,  * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT  * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED  * OF THE POSSIBILITY OF SUCH DAMAGE.  * ====================================================================  *  * This product includes cryptographic software written by Eric Young  * (eay@cryptsoft.com).  This product includes software written by Tim  * Hudson (tjh@cryptsoft.com).  *  */
end_comment

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|FLAT_INC
end_ifdef

begin_include
include|#
directive|include
file|"e_os.h"
end_include

begin_else
else|#
directive|else
end_else

begin_include
include|#
directive|include
file|"../e_os.h"
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<time.h>
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|OPENSSL_NO_EC
end_ifdef

begin_function
name|int
name|main
parameter_list|(
name|int
name|argc
parameter_list|,
name|char
modifier|*
name|argv
index|[]
parameter_list|)
block|{
name|puts
argument_list|(
literal|"Elliptic curves are disabled."
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_else
else|#
directive|else
end_else

begin_include
include|#
directive|include
file|<openssl/ec.h>
end_include

begin_ifndef
ifndef|#
directive|ifndef
name|OPENSSL_NO_ENGINE
end_ifndef

begin_include
include|#
directive|include
file|<openssl/engine.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<openssl/err.h>
end_include

begin_define
define|#
directive|define
name|ABORT
value|do { \ 	fflush(stdout); \ 	fprintf(stderr, "%s:%d: ABORT\n", __FILE__, __LINE__); \ 	ERR_print_errors_fp(stderr); \ 	EXIT(1); \ } while (0)
end_define

begin_if
if|#
directive|if
literal|0
end_if

begin_ifdef
unit|static void timings(EC_GROUP *group, int multi, BN_CTX *ctx) 	{ 	clock_t clck; 	int i, j; 	BIGNUM *s, *s0; 	EC_POINT *P; 		 	s = BN_new(); 	s0 = BN_new(); 	if (s == NULL || s0 == NULL) ABORT;  	if (!EC_GROUP_get_curve_GFp(group, s, NULL, NULL, ctx)) ABORT; 	fprintf(stdout, "Timings for %d bit prime, ", (int)BN_num_bits(s)); 	if (!EC_GROUP_get_order(group, s, ctx)) ABORT; 	fprintf(stdout, "%d bit scalars ", (int)BN_num_bits(s)); 	fflush(stdout);  	P = EC_POINT_new(group); 	if (P == NULL) ABORT; 	EC_POINT_copy(P, EC_GROUP_get0_generator(group));  	clck = clock(); 	for (i = 0; i< 10; i++) 		{ 		if (!BN_pseudo_rand(s, BN_num_bits(s), 0, 0)) ABORT; 		if (multi) 			{ 			if (!BN_pseudo_rand(s0, BN_num_bits(s), 0, 0)) ABORT; 			} 		for (j = 0; j< 10; j++) 			{ 			if (!EC_POINT_mul(group, P, s, multi ? P : NULL, multi ? s0 : NULL, ctx)) ABORT; 			} 		fprintf(stdout, "."); 		fflush(stdout); 		} 	fprintf(stdout, "\n"); 	 	clck = clock() - clck;
ifdef|#
directive|ifdef
name|CLOCKS_PER_SEC
end_ifdef

begin_comment
comment|/* "To determine the time in seconds, the value returned 	 * by the clock function should be divided by the value 	 * of the macro CLOCKS_PER_SEC." 	 *                                       -- ISO/IEC 9899 */
end_comment

begin_define
define|#
directive|define
name|UNIT
value|"s"
end_define

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* "`CLOCKS_PER_SEC' undeclared (first use this function)" 	 *                            -- cc on NeXTstep/OpenStep */
end_comment

begin_define
define|#
directive|define
name|UNIT
value|"units"
end_define

begin_define
define|#
directive|define
name|CLOCKS_PER_SEC
value|1
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_endif
unit|fprintf(stdout, "%i %s in %.2f " UNIT "\n", i*j, 		multi ? "s*P+t*Q operations" : "point multiplications", 		(double)clck/CLOCKS_PER_SEC); 	fprintf(stdout, "average: %.4f " UNIT "\n", (double)clck/(CLOCKS_PER_SEC*i*j));  	EC_POINT_free(P); 	BN_free(s); 	BN_free(s0); 	}
endif|#
directive|endif
end_endif

begin_function
name|int
name|main
parameter_list|(
name|int
name|argc
parameter_list|,
name|char
modifier|*
name|argv
index|[]
parameter_list|)
block|{
name|BN_CTX
modifier|*
name|ctx
init|=
name|NULL
decl_stmt|;
name|BIGNUM
modifier|*
name|p
decl_stmt|,
modifier|*
name|a
decl_stmt|,
modifier|*
name|b
decl_stmt|;
name|EC_GROUP
modifier|*
name|group
decl_stmt|;
name|EC_GROUP
modifier|*
name|P_192
init|=
name|NULL
decl_stmt|,
modifier|*
name|P_224
init|=
name|NULL
decl_stmt|,
modifier|*
name|P_256
init|=
name|NULL
decl_stmt|,
modifier|*
name|P_384
init|=
name|NULL
decl_stmt|,
modifier|*
name|P_521
init|=
name|NULL
decl_stmt|;
name|EC_POINT
modifier|*
name|P
decl_stmt|,
modifier|*
name|Q
decl_stmt|,
modifier|*
name|R
decl_stmt|;
name|BIGNUM
modifier|*
name|x
decl_stmt|,
modifier|*
name|y
decl_stmt|,
modifier|*
name|z
decl_stmt|;
name|unsigned
name|char
name|buf
index|[
literal|100
index|]
decl_stmt|;
name|size_t
name|i
decl_stmt|,
name|len
decl_stmt|;
name|int
name|k
decl_stmt|;
comment|/* enable memory leak checking unless explicitly disabled */
if|if
condition|(
operator|!
operator|(
operator|(
name|getenv
argument_list|(
literal|"OPENSSL_DEBUG_MEMORY"
argument_list|)
operator|!=
name|NULL
operator|)
operator|&&
operator|(
literal|0
operator|==
name|strcmp
argument_list|(
name|getenv
argument_list|(
literal|"OPENSSL_DEBUG_MEMORY"
argument_list|)
argument_list|,
literal|"off"
argument_list|)
operator|)
operator|)
condition|)
block|{
name|CRYPTO_malloc_debug_init
argument_list|()
expr_stmt|;
name|CRYPTO_set_mem_debug_options
argument_list|(
name|V_CRYPTO_MDEBUG_ALL
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|/* OPENSSL_DEBUG_MEMORY=off */
name|CRYPTO_set_mem_debug_functions
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
name|CRYPTO_mem_ctrl
argument_list|(
name|CRYPTO_MEM_CHECK_ON
argument_list|)
expr_stmt|;
name|ERR_load_crypto_strings
argument_list|()
expr_stmt|;
if|#
directive|if
literal|1
comment|/* optional */
name|ctx
operator|=
name|BN_CTX_new
argument_list|()
expr_stmt|;
if|if
condition|(
operator|!
name|ctx
condition|)
name|ABORT
expr_stmt|;
endif|#
directive|endif
name|p
operator|=
name|BN_new
argument_list|()
expr_stmt|;
name|a
operator|=
name|BN_new
argument_list|()
expr_stmt|;
name|b
operator|=
name|BN_new
argument_list|()
expr_stmt|;
if|if
condition|(
operator|!
name|p
operator|||
operator|!
name|a
operator|||
operator|!
name|b
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|p
argument_list|,
literal|"17"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|a
argument_list|,
literal|"1"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|b
argument_list|,
literal|"1"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|group
operator|=
name|EC_GROUP_new
argument_list|(
name|EC_GFp_mont_method
argument_list|()
argument_list|)
expr_stmt|;
comment|/* applications should use EC_GROUP_new_curve_GFp 	                                             * so that the library gets to choose the EC_METHOD */
if|if
condition|(
operator|!
name|group
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_set_curve_GFp
argument_list|(
name|group
argument_list|,
name|p
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
block|{
name|EC_GROUP
modifier|*
name|tmp
decl_stmt|;
name|tmp
operator|=
name|EC_GROUP_new
argument_list|(
name|EC_GROUP_method_of
argument_list|(
name|group
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|tmp
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_copy
argument_list|(
name|tmp
argument_list|,
name|group
argument_list|)
condition|)
empty_stmt|;
name|EC_GROUP_free
argument_list|(
name|group
argument_list|)
expr_stmt|;
name|group
operator|=
name|tmp
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|EC_GROUP_get_curve_GFp
argument_list|(
name|group
argument_list|,
name|p
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"Curve defined by Weierstrass equation\n     y^2 = x^3 + a*x + b  (mod 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|p
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|")\n     a = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|a
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\n     b = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|b
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
name|P
operator|=
name|EC_POINT_new
argument_list|(
name|group
argument_list|)
expr_stmt|;
name|Q
operator|=
name|EC_POINT_new
argument_list|(
name|group
argument_list|)
expr_stmt|;
name|R
operator|=
name|EC_POINT_new
argument_list|(
name|group
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|P
operator|||
operator|!
name|Q
operator|||
operator|!
name|R
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_set_to_infinity
argument_list|(
name|group
argument_list|,
name|P
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|P
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|buf
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_oct2point
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|buf
argument_list|,
literal|1
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_add
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|P
argument_list|,
name|Q
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|P
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|x
operator|=
name|BN_new
argument_list|()
expr_stmt|;
name|y
operator|=
name|BN_new
argument_list|()
expr_stmt|;
name|z
operator|=
name|BN_new
argument_list|()
expr_stmt|;
if|if
condition|(
operator|!
name|x
operator|||
operator|!
name|y
operator|||
operator|!
name|z
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|x
argument_list|,
literal|"D"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_set_compressed_coordinates_GFp
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|x
argument_list|,
literal|1
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_on_curve
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|ctx
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|EC_POINT_get_affine_coordinates_GFp
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Point is not on curve: x = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stderr
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|", y = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stderr
argument_list|,
name|y
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
name|ABORT
expr_stmt|;
block|}
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"A cyclic subgroup:\n"
argument_list|)
expr_stmt|;
name|k
operator|=
literal|100
expr_stmt|;
do|do
block|{
if|if
condition|(
name|k
operator|--
operator|==
literal|0
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|P
argument_list|)
condition|)
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"     point at infinity\n"
argument_list|)
expr_stmt|;
else|else
block|{
if|if
condition|(
operator|!
name|EC_POINT_get_affine_coordinates_GFp
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"     x = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|", y = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|y
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|EC_POINT_copy
argument_list|(
name|R
argument_list|,
name|P
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_add
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|P
argument_list|,
name|Q
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|#
directive|if
literal|0
comment|/* optional */
block|{ 			EC_POINT *points[3]; 		 			points[0] = R; 			points[1] = Q; 			points[2] = P; 			if (!EC_POINTs_make_affine(group, 2, points, ctx)) ABORT; 		}
endif|#
directive|endif
block|}
do|while
condition|(
operator|!
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|P
argument_list|)
condition|)
do|;
if|if
condition|(
operator|!
name|EC_POINT_add
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|Q
argument_list|,
name|R
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|P
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|len
operator|=
name|EC_POINT_point2oct
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|POINT_CONVERSION_COMPRESSED
argument_list|,
name|buf
argument_list|,
sizeof|sizeof
name|buf
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
if|if
condition|(
name|len
operator|==
literal|0
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_oct2point
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|buf
argument_list|,
name|len
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
literal|0
operator|!=
name|EC_POINT_cmp
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|Q
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"Generator as octect string, compressed form:\n     "
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
name|i
operator|++
control|)
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"%02X"
argument_list|,
name|buf
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|len
operator|=
name|EC_POINT_point2oct
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|POINT_CONVERSION_UNCOMPRESSED
argument_list|,
name|buf
argument_list|,
sizeof|sizeof
name|buf
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
if|if
condition|(
name|len
operator|==
literal|0
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_oct2point
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|buf
argument_list|,
name|len
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
literal|0
operator|!=
name|EC_POINT_cmp
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|Q
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\nGenerator as octect string, uncompressed form:\n     "
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
name|i
operator|++
control|)
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"%02X"
argument_list|,
name|buf
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|len
operator|=
name|EC_POINT_point2oct
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|POINT_CONVERSION_HYBRID
argument_list|,
name|buf
argument_list|,
sizeof|sizeof
name|buf
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
if|if
condition|(
name|len
operator|==
literal|0
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_oct2point
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|buf
argument_list|,
name|len
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
literal|0
operator|!=
name|EC_POINT_cmp
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|Q
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\nGenerator as octect string, hybrid form:\n     "
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
name|i
operator|++
control|)
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"%02X"
argument_list|,
name|buf
index|[
name|i
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_get_Jprojective_coordinates_GFp
argument_list|(
name|group
argument_list|,
name|R
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|z
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\nA representation of the inverse of that generator in\nJacobian projective coordinates:\n     X = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|", Y = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|y
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|", Z = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|z
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_invert
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
literal|0
operator|!=
name|EC_POINT_cmp
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|R
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
comment|/* Curve P-192 (FIPS PUB 186-2, App. 6) */
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|p
argument_list|,
literal|"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
literal|1
operator|!=
name|BN_is_prime
argument_list|(
name|p
argument_list|,
name|BN_prime_checks
argument_list|,
literal|0
argument_list|,
name|ctx
argument_list|,
name|NULL
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|a
argument_list|,
literal|"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|b
argument_list|,
literal|"64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_set_curve_GFp
argument_list|(
name|group
argument_list|,
name|p
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|x
argument_list|,
literal|"188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_set_compressed_coordinates_GFp
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|x
argument_list|,
literal|1
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_on_curve
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|z
argument_list|,
literal|"FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_set_generator
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|z
argument_list|,
name|BN_value_one
argument_list|()
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_get_affine_coordinates_GFp
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\nNIST curve P-192 -- Generator:\n     x = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\n     y = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|y
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
comment|/* G_y value taken from the standard: */
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|z
argument_list|,
literal|"07192B95FFC8DA78631011ED6B24CDD573F977A11E794811"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
literal|0
operator|!=
name|BN_cmp
argument_list|(
name|y
argument_list|,
name|z
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"verify group order ..."
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_get_order
argument_list|(
name|group
argument_list|,
name|z
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_mul
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|z
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|Q
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"."
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_precompute_mult
argument_list|(
name|group
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_mul
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|z
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|Q
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|" ok\n"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|P_192
operator|=
name|EC_GROUP_new
argument_list|(
name|EC_GROUP_method_of
argument_list|(
name|group
argument_list|)
argument_list|)
operator|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_copy
argument_list|(
name|P_192
argument_list|,
name|group
argument_list|)
condition|)
name|ABORT
expr_stmt|;
comment|/* Curve P-224 (FIPS PUB 186-2, App. 6) */
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|p
argument_list|,
literal|"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
literal|1
operator|!=
name|BN_is_prime
argument_list|(
name|p
argument_list|,
name|BN_prime_checks
argument_list|,
literal|0
argument_list|,
name|ctx
argument_list|,
name|NULL
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|a
argument_list|,
literal|"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|b
argument_list|,
literal|"B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_set_curve_GFp
argument_list|(
name|group
argument_list|,
name|p
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|x
argument_list|,
literal|"B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_set_compressed_coordinates_GFp
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|x
argument_list|,
literal|0
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_on_curve
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|z
argument_list|,
literal|"FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_set_generator
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|z
argument_list|,
name|BN_value_one
argument_list|()
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_get_affine_coordinates_GFp
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\nNIST curve P-224 -- Generator:\n     x = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\n     y = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|y
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
comment|/* G_y value taken from the standard: */
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|z
argument_list|,
literal|"BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
literal|0
operator|!=
name|BN_cmp
argument_list|(
name|y
argument_list|,
name|z
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"verify group order ..."
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_get_order
argument_list|(
name|group
argument_list|,
name|z
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_mul
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|z
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|Q
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"."
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_precompute_mult
argument_list|(
name|group
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_mul
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|z
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|Q
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|" ok\n"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|P_224
operator|=
name|EC_GROUP_new
argument_list|(
name|EC_GROUP_method_of
argument_list|(
name|group
argument_list|)
argument_list|)
operator|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_copy
argument_list|(
name|P_224
argument_list|,
name|group
argument_list|)
condition|)
name|ABORT
expr_stmt|;
comment|/* Curve P-256 (FIPS PUB 186-2, App. 6) */
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|p
argument_list|,
literal|"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
literal|1
operator|!=
name|BN_is_prime
argument_list|(
name|p
argument_list|,
name|BN_prime_checks
argument_list|,
literal|0
argument_list|,
name|ctx
argument_list|,
name|NULL
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|a
argument_list|,
literal|"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|b
argument_list|,
literal|"5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_set_curve_GFp
argument_list|(
name|group
argument_list|,
name|p
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|x
argument_list|,
literal|"6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_set_compressed_coordinates_GFp
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|x
argument_list|,
literal|1
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_on_curve
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|z
argument_list|,
literal|"FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E"
literal|"84F3B9CAC2FC632551"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_set_generator
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|z
argument_list|,
name|BN_value_one
argument_list|()
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_get_affine_coordinates_GFp
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\nNIST curve P-256 -- Generator:\n     x = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\n     y = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|y
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
comment|/* G_y value taken from the standard: */
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|z
argument_list|,
literal|"4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
literal|0
operator|!=
name|BN_cmp
argument_list|(
name|y
argument_list|,
name|z
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"verify group order ..."
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_get_order
argument_list|(
name|group
argument_list|,
name|z
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_mul
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|z
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|Q
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"."
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_precompute_mult
argument_list|(
name|group
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_mul
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|z
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|Q
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|" ok\n"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|P_256
operator|=
name|EC_GROUP_new
argument_list|(
name|EC_GROUP_method_of
argument_list|(
name|group
argument_list|)
argument_list|)
operator|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_copy
argument_list|(
name|P_256
argument_list|,
name|group
argument_list|)
condition|)
name|ABORT
expr_stmt|;
comment|/* Curve P-384 (FIPS PUB 186-2, App. 6) */
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|p
argument_list|,
literal|"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"
literal|"FFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
literal|1
operator|!=
name|BN_is_prime
argument_list|(
name|p
argument_list|,
name|BN_prime_checks
argument_list|,
literal|0
argument_list|,
name|ctx
argument_list|,
name|NULL
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|a
argument_list|,
literal|"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"
literal|"FFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|b
argument_list|,
literal|"B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141"
literal|"120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_set_curve_GFp
argument_list|(
name|group
argument_list|,
name|p
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|x
argument_list|,
literal|"AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B"
literal|"9859F741E082542A385502F25DBF55296C3A545E3872760AB7"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_set_compressed_coordinates_GFp
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|x
argument_list|,
literal|1
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_on_curve
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|z
argument_list|,
literal|"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"
literal|"FFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_set_generator
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|z
argument_list|,
name|BN_value_one
argument_list|()
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_get_affine_coordinates_GFp
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\nNIST curve P-384 -- Generator:\n     x = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\n     y = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|y
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
comment|/* G_y value taken from the standard: */
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|z
argument_list|,
literal|"3617DE4A96262C6F5D9E98BF9292DC29F8F41DBD289A14"
literal|"7CE9DA3113B5F0B8C00A60B1CE1D7E819D7A431D7C90EA0E5F"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
literal|0
operator|!=
name|BN_cmp
argument_list|(
name|y
argument_list|,
name|z
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"verify group order ..."
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_get_order
argument_list|(
name|group
argument_list|,
name|z
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_mul
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|z
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|Q
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"."
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_precompute_mult
argument_list|(
name|group
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_mul
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|z
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|Q
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|" ok\n"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|P_384
operator|=
name|EC_GROUP_new
argument_list|(
name|EC_GROUP_method_of
argument_list|(
name|group
argument_list|)
argument_list|)
operator|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_copy
argument_list|(
name|P_384
argument_list|,
name|group
argument_list|)
condition|)
name|ABORT
expr_stmt|;
comment|/* Curve P-521 (FIPS PUB 186-2, App. 6) */
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|p
argument_list|,
literal|"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"
literal|"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"
literal|"FFFFFFFFFFFFFFFFFFFFFFFFFFFF"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
literal|1
operator|!=
name|BN_is_prime
argument_list|(
name|p
argument_list|,
name|BN_prime_checks
argument_list|,
literal|0
argument_list|,
name|ctx
argument_list|,
name|NULL
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|a
argument_list|,
literal|"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"
literal|"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"
literal|"FFFFFFFFFFFFFFFFFFFFFFFFFFFC"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|b
argument_list|,
literal|"051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B"
literal|"315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573"
literal|"DF883D2C34F1EF451FD46B503F00"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_set_curve_GFp
argument_list|(
name|group
argument_list|,
name|p
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|x
argument_list|,
literal|"C6858E06B70404E9CD9E3ECB662395B4429C648139053F"
literal|"B521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B"
literal|"3C1856A429BF97E7E31C2E5BD66"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_set_compressed_coordinates_GFp
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|x
argument_list|,
literal|0
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_on_curve
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|z
argument_list|,
literal|"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"
literal|"FFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5"
literal|"C9B8899C47AEBB6FB71E91386409"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_set_generator
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|z
argument_list|,
name|BN_value_one
argument_list|()
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_get_affine_coordinates_GFp
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\nNIST curve P-521 -- Generator:\n     x = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\n     y = 0x"
argument_list|)
expr_stmt|;
name|BN_print_fp
argument_list|(
name|stdout
argument_list|,
name|y
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
comment|/* G_y value taken from the standard: */
if|if
condition|(
operator|!
name|BN_hex2bn
argument_list|(
operator|&
name|z
argument_list|,
literal|"11839296A789A3BC0045C8A5FB42C7D1BD998F54449579"
literal|"B446817AFBD17273E662C97EE72995EF42640C550B9013FAD0761353C"
literal|"7086A272C24088BE94769FD16650"
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
literal|0
operator|!=
name|BN_cmp
argument_list|(
name|y
argument_list|,
name|z
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"verify group order ..."
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_get_order
argument_list|(
name|group
argument_list|,
name|z
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_mul
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|z
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|Q
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"."
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_precompute_mult
argument_list|(
name|group
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_mul
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|z
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|Q
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|" ok\n"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|P_521
operator|=
name|EC_GROUP_new
argument_list|(
name|EC_GROUP_method_of
argument_list|(
name|group
argument_list|)
argument_list|)
operator|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_GROUP_copy
argument_list|(
name|P_521
argument_list|,
name|group
argument_list|)
condition|)
name|ABORT
expr_stmt|;
comment|/* more tests using the last curve */
if|if
condition|(
operator|!
name|EC_POINT_copy
argument_list|(
name|Q
argument_list|,
name|P
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|Q
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_dbl
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|P
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_on_curve
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_invert
argument_list|(
name|group
argument_list|,
name|Q
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
comment|/* P = -2Q */
if|if
condition|(
operator|!
name|EC_POINT_add
argument_list|(
name|group
argument_list|,
name|R
argument_list|,
name|P
argument_list|,
name|Q
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_add
argument_list|(
name|group
argument_list|,
name|R
argument_list|,
name|R
argument_list|,
name|Q
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|R
argument_list|)
condition|)
name|ABORT
expr_stmt|;
comment|/* R = P + 2Q */
block|{
specifier|const
name|EC_POINT
modifier|*
name|points
index|[
literal|3
index|]
decl_stmt|;
specifier|const
name|BIGNUM
modifier|*
name|scalars
index|[
literal|3
index|]
decl_stmt|;
if|if
condition|(
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|Q
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|points
index|[
literal|0
index|]
operator|=
name|Q
expr_stmt|;
name|points
index|[
literal|1
index|]
operator|=
name|Q
expr_stmt|;
name|points
index|[
literal|2
index|]
operator|=
name|Q
expr_stmt|;
if|if
condition|(
operator|!
name|BN_add
argument_list|(
name|y
argument_list|,
name|z
argument_list|,
name|BN_value_one
argument_list|()
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
name|BN_is_odd
argument_list|(
name|y
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_rshift1
argument_list|(
name|y
argument_list|,
name|y
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|scalars
index|[
literal|0
index|]
operator|=
name|y
expr_stmt|;
comment|/* (group order + 1)/2,  so  y*Q + y*Q = Q */
name|scalars
index|[
literal|1
index|]
operator|=
name|y
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"combined multiplication ..."
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
comment|/* z is still the group order */
if|if
condition|(
operator|!
name|EC_POINTs_mul
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|NULL
argument_list|,
literal|2
argument_list|,
name|points
argument_list|,
name|scalars
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINTs_mul
argument_list|(
name|group
argument_list|,
name|R
argument_list|,
name|z
argument_list|,
literal|2
argument_list|,
name|points
argument_list|,
name|scalars
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
literal|0
operator|!=
name|EC_POINT_cmp
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|R
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
literal|0
operator|!=
name|EC_POINT_cmp
argument_list|(
name|group
argument_list|,
name|R
argument_list|,
name|Q
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"."
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|BN_pseudo_rand
argument_list|(
name|y
argument_list|,
name|BN_num_bits
argument_list|(
name|y
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_add
argument_list|(
name|z
argument_list|,
name|z
argument_list|,
name|y
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|z
operator|->
name|neg
operator|=
literal|1
expr_stmt|;
name|scalars
index|[
literal|0
index|]
operator|=
name|y
expr_stmt|;
name|scalars
index|[
literal|1
index|]
operator|=
name|z
expr_stmt|;
comment|/* z = -(order + y) */
if|if
condition|(
operator|!
name|EC_POINTs_mul
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|NULL
argument_list|,
literal|2
argument_list|,
name|points
argument_list|,
name|scalars
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|P
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|"."
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stdout
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|BN_pseudo_rand
argument_list|(
name|x
argument_list|,
name|BN_num_bits
argument_list|(
name|y
argument_list|)
operator|-
literal|1
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|BN_add
argument_list|(
name|z
argument_list|,
name|x
argument_list|,
name|y
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|z
operator|->
name|neg
operator|=
literal|1
expr_stmt|;
name|scalars
index|[
literal|0
index|]
operator|=
name|x
expr_stmt|;
name|scalars
index|[
literal|1
index|]
operator|=
name|y
expr_stmt|;
name|scalars
index|[
literal|2
index|]
operator|=
name|z
expr_stmt|;
comment|/* z = -(x+y) */
if|if
condition|(
operator|!
name|EC_POINTs_mul
argument_list|(
name|group
argument_list|,
name|P
argument_list|,
name|NULL
argument_list|,
literal|3
argument_list|,
name|points
argument_list|,
name|scalars
argument_list|,
name|ctx
argument_list|)
condition|)
name|ABORT
expr_stmt|;
if|if
condition|(
operator|!
name|EC_POINT_is_at_infinity
argument_list|(
name|group
argument_list|,
name|P
argument_list|)
condition|)
name|ABORT
expr_stmt|;
name|fprintf
argument_list|(
name|stdout
argument_list|,
literal|" ok\n\n"
argument_list|)
expr_stmt|;
block|}
if|#
directive|if
literal|0
block|timings(P_192, 0, ctx); 	timings(P_192, 1, ctx); 	timings(P_224, 0, ctx); 	timings(P_224, 1, ctx); 	timings(P_256, 0, ctx); 	timings(P_256, 1, ctx); 	timings(P_384, 0, ctx); 	timings(P_384, 1, ctx); 	timings(P_521, 0, ctx); 	timings(P_521, 1, ctx);
endif|#
directive|endif
if|if
condition|(
name|ctx
condition|)
name|BN_CTX_free
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
name|BN_free
argument_list|(
name|p
argument_list|)
expr_stmt|;
name|BN_free
argument_list|(
name|a
argument_list|)
expr_stmt|;
name|BN_free
argument_list|(
name|b
argument_list|)
expr_stmt|;
name|EC_GROUP_free
argument_list|(
name|group
argument_list|)
expr_stmt|;
name|EC_POINT_free
argument_list|(
name|P
argument_list|)
expr_stmt|;
name|EC_POINT_free
argument_list|(
name|Q
argument_list|)
expr_stmt|;
name|EC_POINT_free
argument_list|(
name|R
argument_list|)
expr_stmt|;
name|BN_free
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|BN_free
argument_list|(
name|y
argument_list|)
expr_stmt|;
name|BN_free
argument_list|(
name|z
argument_list|)
expr_stmt|;
if|if
condition|(
name|P_192
condition|)
name|EC_GROUP_free
argument_list|(
name|P_192
argument_list|)
expr_stmt|;
if|if
condition|(
name|P_224
condition|)
name|EC_GROUP_free
argument_list|(
name|P_224
argument_list|)
expr_stmt|;
if|if
condition|(
name|P_256
condition|)
name|EC_GROUP_free
argument_list|(
name|P_256
argument_list|)
expr_stmt|;
if|if
condition|(
name|P_384
condition|)
name|EC_GROUP_free
argument_list|(
name|P_384
argument_list|)
expr_stmt|;
if|if
condition|(
name|P_521
condition|)
name|EC_GROUP_free
argument_list|(
name|P_521
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|OPENSSL_NO_ENGINE
name|ENGINE_cleanup
argument_list|()
expr_stmt|;
endif|#
directive|endif
name|CRYPTO_cleanup_all_ex_data
argument_list|()
expr_stmt|;
name|ERR_free_strings
argument_list|()
expr_stmt|;
name|ERR_remove_state
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|CRYPTO_mem_leaks_fp
argument_list|(
name|stderr
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

end_unit

