begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* ====================================================================  * Copyright (c) 2010 The OpenSSL Project.  All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  *  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  *  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in  *    the documentation and/or other materials provided with the  *    distribution.  *  * 3. All advertising materials mentioning features or use of this  *    software must display the following acknowledgment:  *    "This product includes software developed by the OpenSSL Project  *    for use in the OpenSSL Toolkit. (http://www.openssl.org/)"  *  * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to  *    endorse or promote products derived from this software without  *    prior written permission. For written permission, please contact  *    openssl-core@openssl.org.  *  * 5. Products derived from this software may not be called "OpenSSL"  *    nor may "OpenSSL" appear in their names without prior written  *    permission of the OpenSSL Project.  *  * 6. Redistributions of any form whatsoever must retain the following  *    acknowledgment:  *    "This product includes software developed by the OpenSSL Project  *    for use in the OpenSSL Toolkit (http://www.openssl.org/)"  *  * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY  * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR  * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,  * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT  * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED  * OF THE POSSIBILITY OF SUCH DAMAGE.  * ====================================================================  */
end_comment

begin_define
define|#
directive|define
name|OPENSSL_FIPSAPI
end_define

begin_include
include|#
directive|include
file|<openssl/crypto.h>
end_include

begin_include
include|#
directive|include
file|"modes_lcl.h"
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_ifndef
ifndef|#
directive|ifndef
name|MODES_DEBUG
end_ifndef

begin_ifndef
ifndef|#
directive|ifndef
name|NDEBUG
end_ifndef

begin_define
define|#
directive|define
name|NDEBUG
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<assert.h>
end_include

begin_if
if|#
directive|if
name|defined
argument_list|(
name|BSWAP4
argument_list|)
operator|&&
name|defined
argument_list|(
name|STRICT_ALIGNMENT
argument_list|)
end_if

begin_comment
comment|/* redefine, because alignment is ensured */
end_comment

begin_undef
undef|#
directive|undef
name|GETU32
end_undef

begin_define
define|#
directive|define
name|GETU32
parameter_list|(
name|p
parameter_list|)
value|BSWAP4(*(const u32 *)(p))
end_define

begin_undef
undef|#
directive|undef
name|PUTU32
end_undef

begin_define
define|#
directive|define
name|PUTU32
parameter_list|(
name|p
parameter_list|,
name|v
parameter_list|)
value|*(u32 *)(p) = BSWAP4(v)
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_define
define|#
directive|define
name|PACK
parameter_list|(
name|s
parameter_list|)
value|((size_t)(s)<<(sizeof(size_t)*8-16))
end_define

begin_define
define|#
directive|define
name|REDUCE1BIT
parameter_list|(
name|V
parameter_list|)
value|do { \         if (sizeof(size_t)==8) { \                 u64 T = U64(0xe100000000000000)& (0-(V.lo&1)); \                 V.lo  = (V.hi<<63)|(V.lo>>1); \                 V.hi  = (V.hi>>1 )^T; \         } \         else { \                 u32 T = 0xe1000000U& (0-(u32)(V.lo&1)); \                 V.lo  = (V.hi<<63)|(V.lo>>1); \                 V.hi  = (V.hi>>1 )^((u64)T<<32); \         } \ } while(0)
end_define

begin_comment
comment|/*-  * Even though permitted values for TABLE_BITS are 8, 4 and 1, it should  * never be set to 8. 8 is effectively reserved for testing purposes.  * TABLE_BITS>1 are lookup-table-driven implementations referred to as  * "Shoup's" in GCM specification. In other words OpenSSL does not cover  * whole spectrum of possible table driven implementations. Why? In  * non-"Shoup's" case memory access pattern is segmented in such manner,  * that it's trivial to see that cache timing information can reveal  * fair portion of intermediate hash value. Given that ciphertext is  * always available to attacker, it's possible for him to attempt to  * deduce secret parameter H and if successful, tamper with messages  * [which is nothing but trivial in CTR mode]. In "Shoup's" case it's  * not as trivial, but there is no reason to believe that it's resistant  * to cache-timing attack. And the thing about "8-bit" implementation is  * that it consumes 16 (sixteen) times more memory, 4KB per individual  * key + 1KB shared. Well, on pros side it should be twice as fast as  * "4-bit" version. And for gcc-generated x86[_64] code, "8-bit" version  * was observed to run ~75% faster, closer to 100% for commercial  * compilers... Yet "4-bit" procedure is preferred, because it's  * believed to provide better security-performance balance and adequate  * all-round performance. "All-round" refers to things like:  *  * - shorter setup time effectively improves overall timing for  *   handling short messages;  * - larger table allocation can become unbearable because of VM  *   subsystem penalties (for example on Windows large enough free  *   results in VM working set trimming, meaning that consequent  *   malloc would immediately incur working set expansion);  * - larger table has larger cache footprint, which can affect  *   performance of other code paths (not necessarily even from same  *   thread in Hyper-Threading world);  *  * Value of 1 is not appropriate for performance reasons.  */
end_comment

begin_if
if|#
directive|if
name|TABLE_BITS
operator|==
literal|8
end_if

begin_function
specifier|static
name|void
name|gcm_init_8bit
parameter_list|(
name|u128
name|Htable
index|[
literal|256
index|]
parameter_list|,
name|u64
name|H
index|[
literal|2
index|]
parameter_list|)
block|{
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
name|u128
name|V
decl_stmt|;
name|Htable
index|[
literal|0
index|]
operator|.
name|hi
operator|=
literal|0
expr_stmt|;
name|Htable
index|[
literal|0
index|]
operator|.
name|lo
operator|=
literal|0
expr_stmt|;
name|V
operator|.
name|hi
operator|=
name|H
index|[
literal|0
index|]
expr_stmt|;
name|V
operator|.
name|lo
operator|=
name|H
index|[
literal|1
index|]
expr_stmt|;
for|for
control|(
name|Htable
index|[
literal|128
index|]
operator|=
name|V
operator|,
name|i
operator|=
literal|64
init|;
name|i
operator|>
literal|0
condition|;
name|i
operator|>>=
literal|1
control|)
block|{
name|REDUCE1BIT
argument_list|(
name|V
argument_list|)
expr_stmt|;
name|Htable
index|[
name|i
index|]
operator|=
name|V
expr_stmt|;
block|}
for|for
control|(
name|i
operator|=
literal|2
init|;
name|i
operator|<
literal|256
condition|;
name|i
operator|<<=
literal|1
control|)
block|{
name|u128
modifier|*
name|Hi
init|=
name|Htable
operator|+
name|i
decl_stmt|,
name|H0
init|=
operator|*
name|Hi
decl_stmt|;
for|for
control|(
name|j
operator|=
literal|1
init|;
name|j
operator|<
name|i
condition|;
operator|++
name|j
control|)
block|{
name|Hi
index|[
name|j
index|]
operator|.
name|hi
operator|=
name|H0
operator|.
name|hi
operator|^
name|Htable
index|[
name|j
index|]
operator|.
name|hi
expr_stmt|;
name|Hi
index|[
name|j
index|]
operator|.
name|lo
operator|=
name|H0
operator|.
name|lo
operator|^
name|Htable
index|[
name|j
index|]
operator|.
name|lo
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|gcm_gmult_8bit
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|256
index|]
parameter_list|)
block|{
name|u128
name|Z
init|=
block|{
literal|0
block|,
literal|0
block|}
decl_stmt|;
specifier|const
name|u8
modifier|*
name|xi
init|=
operator|(
specifier|const
name|u8
operator|*
operator|)
name|Xi
operator|+
literal|15
decl_stmt|;
name|size_t
name|rem
decl_stmt|,
name|n
init|=
operator|*
name|xi
decl_stmt|;
specifier|const
union|union
block|{
name|long
name|one
decl_stmt|;
name|char
name|little
decl_stmt|;
block|}
name|is_endian
init|=
block|{
literal|1
block|}
union|;
specifier|static
specifier|const
name|size_t
name|rem_8bit
index|[
literal|256
index|]
init|=
block|{
name|PACK
argument_list|(
literal|0x0000
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x01C2
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x0384
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x0246
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x0708
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x06CA
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x048C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x054E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x0E10
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x0FD2
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x0D94
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x0C56
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x0918
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x08DA
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x0A9C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x0B5E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x1C20
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x1DE2
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x1FA4
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x1E66
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x1B28
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x1AEA
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x18AC
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x196E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x1230
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x13F2
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x11B4
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x1076
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x1538
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x14FA
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x16BC
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x177E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x3840
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x3982
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x3BC4
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x3A06
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x3F48
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x3E8A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x3CCC
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x3D0E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x3650
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x3792
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x35D4
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x3416
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x3158
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x309A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x32DC
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x331E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x2460
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x25A2
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x27E4
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x2626
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x2368
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x22AA
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x20EC
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x212E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x2A70
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x2BB2
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x29F4
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x2836
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x2D78
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x2CBA
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x2EFC
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x2F3E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x7080
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x7142
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x7304
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x72C6
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x7788
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x764A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x740C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x75CE
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x7E90
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x7F52
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x7D14
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x7CD6
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x7998
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x785A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x7A1C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x7BDE
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x6CA0
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x6D62
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x6F24
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x6EE6
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x6BA8
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x6A6A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x682C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x69EE
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x62B0
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x6372
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x6134
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x60F6
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x65B8
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x647A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x663C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x67FE
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x48C0
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x4902
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x4B44
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x4A86
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x4FC8
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x4E0A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x4C4C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x4D8E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x46D0
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x4712
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x4554
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x4496
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x41D8
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x401A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x425C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x439E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x54E0
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x5522
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x5764
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x56A6
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x53E8
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x522A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x506C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x51AE
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x5AF0
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x5B32
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x5974
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x58B6
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x5DF8
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x5C3A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x5E7C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x5FBE
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xE100
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xE0C2
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xE284
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xE346
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xE608
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xE7CA
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xE58C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xE44E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xEF10
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xEED2
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xEC94
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xED56
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xE818
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xE9DA
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xEB9C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xEA5E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xFD20
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xFCE2
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xFEA4
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xFF66
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xFA28
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xFBEA
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xF9AC
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xF86E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xF330
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xF2F2
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xF0B4
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xF176
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xF438
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xF5FA
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xF7BC
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xF67E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xD940
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xD882
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xDAC4
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xDB06
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xDE48
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xDF8A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xDDCC
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xDC0E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xD750
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xD692
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xD4D4
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xD516
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xD058
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xD19A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xD3DC
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xD21E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xC560
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xC4A2
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xC6E4
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xC726
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xC268
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xC3AA
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xC1EC
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xC02E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xCB70
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xCAB2
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xC8F4
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xC936
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xCC78
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xCDBA
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xCFFC
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xCE3E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x9180
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x9042
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x9204
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x93C6
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x9688
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x974A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x950C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x94CE
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x9F90
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x9E52
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x9C14
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x9DD6
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x9898
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x995A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x9B1C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x9ADE
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x8DA0
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x8C62
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x8E24
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x8FE6
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x8AA8
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x8B6A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x892C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x88EE
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x83B0
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x8272
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x8034
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x81F6
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x84B8
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x857A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x873C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x86FE
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xA9C0
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xA802
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xAA44
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xAB86
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xAEC8
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xAF0A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xAD4C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xAC8E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xA7D0
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xA612
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xA454
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xA596
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xA0D8
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xA11A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xA35C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xA29E
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xB5E0
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xB422
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xB664
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xB7A6
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xB2E8
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xB32A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xB16C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xB0AE
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xBBF0
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xBA32
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xB874
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xB9B6
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xBCF8
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xBD3A
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xBF7C
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xBEBE
argument_list|)
block|}
decl_stmt|;
while|while
condition|(
literal|1
condition|)
block|{
name|Z
operator|.
name|hi
operator|^=
name|Htable
index|[
name|n
index|]
operator|.
name|hi
expr_stmt|;
name|Z
operator|.
name|lo
operator|^=
name|Htable
index|[
name|n
index|]
operator|.
name|lo
expr_stmt|;
if|if
condition|(
operator|(
name|u8
operator|*
operator|)
name|Xi
operator|==
name|xi
condition|)
break|break;
name|n
operator|=
operator|*
operator|(
operator|--
name|xi
operator|)
expr_stmt|;
name|rem
operator|=
operator|(
name|size_t
operator|)
name|Z
operator|.
name|lo
operator|&
literal|0xff
expr_stmt|;
name|Z
operator|.
name|lo
operator|=
operator|(
name|Z
operator|.
name|hi
operator|<<
literal|56
operator|)
operator||
operator|(
name|Z
operator|.
name|lo
operator|>>
literal|8
operator|)
expr_stmt|;
name|Z
operator|.
name|hi
operator|=
operator|(
name|Z
operator|.
name|hi
operator|>>
literal|8
operator|)
expr_stmt|;
if|if
condition|(
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
operator|==
literal|8
condition|)
name|Z
operator|.
name|hi
operator|^=
name|rem_8bit
index|[
name|rem
index|]
expr_stmt|;
else|else
name|Z
operator|.
name|hi
operator|^=
operator|(
name|u64
operator|)
name|rem_8bit
index|[
name|rem
index|]
operator|<<
literal|32
expr_stmt|;
block|}
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
block|{
ifdef|#
directive|ifdef
name|BSWAP8
name|Xi
index|[
literal|0
index|]
operator|=
name|BSWAP8
argument_list|(
name|Z
operator|.
name|hi
argument_list|)
expr_stmt|;
name|Xi
index|[
literal|1
index|]
operator|=
name|BSWAP8
argument_list|(
name|Z
operator|.
name|lo
argument_list|)
expr_stmt|;
else|#
directive|else
name|u8
modifier|*
name|p
init|=
operator|(
name|u8
operator|*
operator|)
name|Xi
decl_stmt|;
name|u32
name|v
decl_stmt|;
name|v
operator|=
call|(
name|u32
call|)
argument_list|(
name|Z
operator|.
name|hi
operator|>>
literal|32
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|p
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|v
operator|=
call|(
name|u32
call|)
argument_list|(
name|Z
operator|.
name|hi
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|p
operator|+
literal|4
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|v
operator|=
call|(
name|u32
call|)
argument_list|(
name|Z
operator|.
name|lo
operator|>>
literal|32
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|p
operator|+
literal|8
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|v
operator|=
call|(
name|u32
call|)
argument_list|(
name|Z
operator|.
name|lo
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|p
operator|+
literal|12
argument_list|,
name|v
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
else|else
block|{
name|Xi
index|[
literal|0
index|]
operator|=
name|Z
operator|.
name|hi
expr_stmt|;
name|Xi
index|[
literal|1
index|]
operator|=
name|Z
operator|.
name|lo
expr_stmt|;
block|}
block|}
end_function

begin_define
define|#
directive|define
name|GCM_MUL
parameter_list|(
name|ctx
parameter_list|,
name|Xi
parameter_list|)
value|gcm_gmult_8bit(ctx->Xi.u,ctx->Htable)
end_define

begin_elif
elif|#
directive|elif
name|TABLE_BITS
operator|==
literal|4
end_elif

begin_function
specifier|static
name|void
name|gcm_init_4bit
parameter_list|(
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
name|u64
name|H
index|[
literal|2
index|]
parameter_list|)
block|{
name|u128
name|V
decl_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|OPENSSL_SMALL_FOOTPRINT
argument_list|)
name|int
name|i
decl_stmt|;
endif|#
directive|endif
name|Htable
index|[
literal|0
index|]
operator|.
name|hi
operator|=
literal|0
expr_stmt|;
name|Htable
index|[
literal|0
index|]
operator|.
name|lo
operator|=
literal|0
expr_stmt|;
name|V
operator|.
name|hi
operator|=
name|H
index|[
literal|0
index|]
expr_stmt|;
name|V
operator|.
name|lo
operator|=
name|H
index|[
literal|1
index|]
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|OPENSSL_SMALL_FOOTPRINT
argument_list|)
for|for
control|(
name|Htable
index|[
literal|8
index|]
operator|=
name|V
operator|,
name|i
operator|=
literal|4
init|;
name|i
operator|>
literal|0
condition|;
name|i
operator|>>=
literal|1
control|)
block|{
name|REDUCE1BIT
argument_list|(
name|V
argument_list|)
expr_stmt|;
name|Htable
index|[
name|i
index|]
operator|=
name|V
expr_stmt|;
block|}
for|for
control|(
name|i
operator|=
literal|2
init|;
name|i
operator|<
literal|16
condition|;
name|i
operator|<<=
literal|1
control|)
block|{
name|u128
modifier|*
name|Hi
init|=
name|Htable
operator|+
name|i
decl_stmt|;
name|int
name|j
decl_stmt|;
for|for
control|(
name|V
operator|=
operator|*
name|Hi
operator|,
name|j
operator|=
literal|1
init|;
name|j
operator|<
name|i
condition|;
operator|++
name|j
control|)
block|{
name|Hi
index|[
name|j
index|]
operator|.
name|hi
operator|=
name|V
operator|.
name|hi
operator|^
name|Htable
index|[
name|j
index|]
operator|.
name|hi
expr_stmt|;
name|Hi
index|[
name|j
index|]
operator|.
name|lo
operator|=
name|V
operator|.
name|lo
operator|^
name|Htable
index|[
name|j
index|]
operator|.
name|lo
expr_stmt|;
block|}
block|}
else|#
directive|else
name|Htable
index|[
literal|8
index|]
operator|=
name|V
expr_stmt|;
name|REDUCE1BIT
argument_list|(
name|V
argument_list|)
expr_stmt|;
name|Htable
index|[
literal|4
index|]
operator|=
name|V
expr_stmt|;
name|REDUCE1BIT
argument_list|(
name|V
argument_list|)
expr_stmt|;
name|Htable
index|[
literal|2
index|]
operator|=
name|V
expr_stmt|;
name|REDUCE1BIT
argument_list|(
name|V
argument_list|)
expr_stmt|;
name|Htable
index|[
literal|1
index|]
operator|=
name|V
expr_stmt|;
name|Htable
index|[
literal|3
index|]
operator|.
name|hi
operator|=
name|V
operator|.
name|hi
operator|^
name|Htable
index|[
literal|2
index|]
operator|.
name|hi
operator|,
name|Htable
index|[
literal|3
index|]
operator|.
name|lo
operator|=
name|V
operator|.
name|lo
operator|^
name|Htable
index|[
literal|2
index|]
operator|.
name|lo
expr_stmt|;
name|V
operator|=
name|Htable
index|[
literal|4
index|]
expr_stmt|;
name|Htable
index|[
literal|5
index|]
operator|.
name|hi
operator|=
name|V
operator|.
name|hi
operator|^
name|Htable
index|[
literal|1
index|]
operator|.
name|hi
operator|,
name|Htable
index|[
literal|5
index|]
operator|.
name|lo
operator|=
name|V
operator|.
name|lo
operator|^
name|Htable
index|[
literal|1
index|]
operator|.
name|lo
expr_stmt|;
name|Htable
index|[
literal|6
index|]
operator|.
name|hi
operator|=
name|V
operator|.
name|hi
operator|^
name|Htable
index|[
literal|2
index|]
operator|.
name|hi
operator|,
name|Htable
index|[
literal|6
index|]
operator|.
name|lo
operator|=
name|V
operator|.
name|lo
operator|^
name|Htable
index|[
literal|2
index|]
operator|.
name|lo
expr_stmt|;
name|Htable
index|[
literal|7
index|]
operator|.
name|hi
operator|=
name|V
operator|.
name|hi
operator|^
name|Htable
index|[
literal|3
index|]
operator|.
name|hi
operator|,
name|Htable
index|[
literal|7
index|]
operator|.
name|lo
operator|=
name|V
operator|.
name|lo
operator|^
name|Htable
index|[
literal|3
index|]
operator|.
name|lo
expr_stmt|;
name|V
operator|=
name|Htable
index|[
literal|8
index|]
expr_stmt|;
name|Htable
index|[
literal|9
index|]
operator|.
name|hi
operator|=
name|V
operator|.
name|hi
operator|^
name|Htable
index|[
literal|1
index|]
operator|.
name|hi
operator|,
name|Htable
index|[
literal|9
index|]
operator|.
name|lo
operator|=
name|V
operator|.
name|lo
operator|^
name|Htable
index|[
literal|1
index|]
operator|.
name|lo
expr_stmt|;
name|Htable
index|[
literal|10
index|]
operator|.
name|hi
operator|=
name|V
operator|.
name|hi
operator|^
name|Htable
index|[
literal|2
index|]
operator|.
name|hi
operator|,
name|Htable
index|[
literal|10
index|]
operator|.
name|lo
operator|=
name|V
operator|.
name|lo
operator|^
name|Htable
index|[
literal|2
index|]
operator|.
name|lo
expr_stmt|;
name|Htable
index|[
literal|11
index|]
operator|.
name|hi
operator|=
name|V
operator|.
name|hi
operator|^
name|Htable
index|[
literal|3
index|]
operator|.
name|hi
operator|,
name|Htable
index|[
literal|11
index|]
operator|.
name|lo
operator|=
name|V
operator|.
name|lo
operator|^
name|Htable
index|[
literal|3
index|]
operator|.
name|lo
expr_stmt|;
name|Htable
index|[
literal|12
index|]
operator|.
name|hi
operator|=
name|V
operator|.
name|hi
operator|^
name|Htable
index|[
literal|4
index|]
operator|.
name|hi
operator|,
name|Htable
index|[
literal|12
index|]
operator|.
name|lo
operator|=
name|V
operator|.
name|lo
operator|^
name|Htable
index|[
literal|4
index|]
operator|.
name|lo
expr_stmt|;
name|Htable
index|[
literal|13
index|]
operator|.
name|hi
operator|=
name|V
operator|.
name|hi
operator|^
name|Htable
index|[
literal|5
index|]
operator|.
name|hi
operator|,
name|Htable
index|[
literal|13
index|]
operator|.
name|lo
operator|=
name|V
operator|.
name|lo
operator|^
name|Htable
index|[
literal|5
index|]
operator|.
name|lo
expr_stmt|;
name|Htable
index|[
literal|14
index|]
operator|.
name|hi
operator|=
name|V
operator|.
name|hi
operator|^
name|Htable
index|[
literal|6
index|]
operator|.
name|hi
operator|,
name|Htable
index|[
literal|14
index|]
operator|.
name|lo
operator|=
name|V
operator|.
name|lo
operator|^
name|Htable
index|[
literal|6
index|]
operator|.
name|lo
expr_stmt|;
name|Htable
index|[
literal|15
index|]
operator|.
name|hi
operator|=
name|V
operator|.
name|hi
operator|^
name|Htable
index|[
literal|7
index|]
operator|.
name|hi
operator|,
name|Htable
index|[
literal|15
index|]
operator|.
name|lo
operator|=
name|V
operator|.
name|lo
operator|^
name|Htable
index|[
literal|7
index|]
operator|.
name|lo
expr_stmt|;
endif|#
directive|endif
if|#
directive|if
name|defined
argument_list|(
name|GHASH_ASM
argument_list|)
operator|&&
operator|(
name|defined
argument_list|(
name|__arm__
argument_list|)
operator|||
name|defined
argument_list|(
name|__arm
argument_list|)
operator|)
comment|/*      * ARM assembler expects specific dword order in Htable.      */
block|{
name|int
name|j
decl_stmt|;
specifier|const
union|union
block|{
name|long
name|one
decl_stmt|;
name|char
name|little
decl_stmt|;
block|}
name|is_endian
init|=
block|{
literal|1
block|}
union|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|16
condition|;
operator|++
name|j
control|)
block|{
name|V
operator|=
name|Htable
index|[
name|j
index|]
expr_stmt|;
name|Htable
index|[
name|j
index|]
operator|.
name|hi
operator|=
name|V
operator|.
name|lo
expr_stmt|;
name|Htable
index|[
name|j
index|]
operator|.
name|lo
operator|=
name|V
operator|.
name|hi
expr_stmt|;
block|}
else|else
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|16
condition|;
operator|++
name|j
control|)
block|{
name|V
operator|=
name|Htable
index|[
name|j
index|]
expr_stmt|;
name|Htable
index|[
name|j
index|]
operator|.
name|hi
operator|=
name|V
operator|.
name|lo
operator|<<
literal|32
operator||
name|V
operator|.
name|lo
operator|>>
literal|32
expr_stmt|;
name|Htable
index|[
name|j
index|]
operator|.
name|lo
operator|=
name|V
operator|.
name|hi
operator|<<
literal|32
operator||
name|V
operator|.
name|hi
operator|>>
literal|32
expr_stmt|;
block|}
block|}
endif|#
directive|endif
block|}
end_function

begin_ifndef
ifndef|#
directive|ifndef
name|GHASH_ASM
end_ifndef

begin_decl_stmt
specifier|static
specifier|const
name|size_t
name|rem_4bit
index|[
literal|16
index|]
init|=
block|{
name|PACK
argument_list|(
literal|0x0000
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x1C20
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x3840
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x2460
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x7080
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x6CA0
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x48C0
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x54E0
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xE100
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xFD20
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xD940
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xC560
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x9180
argument_list|)
block|,
name|PACK
argument_list|(
literal|0x8DA0
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xA9C0
argument_list|)
block|,
name|PACK
argument_list|(
literal|0xB5E0
argument_list|)
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
name|gcm_gmult_4bit
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|)
block|{
name|u128
name|Z
decl_stmt|;
name|int
name|cnt
init|=
literal|15
decl_stmt|;
name|size_t
name|rem
decl_stmt|,
name|nlo
decl_stmt|,
name|nhi
decl_stmt|;
specifier|const
union|union
block|{
name|long
name|one
decl_stmt|;
name|char
name|little
decl_stmt|;
block|}
name|is_endian
init|=
block|{
literal|1
block|}
union|;
name|nlo
operator|=
operator|(
operator|(
specifier|const
name|u8
operator|*
operator|)
name|Xi
operator|)
index|[
literal|15
index|]
expr_stmt|;
name|nhi
operator|=
name|nlo
operator|>>
literal|4
expr_stmt|;
name|nlo
operator|&=
literal|0xf
expr_stmt|;
name|Z
operator|.
name|hi
operator|=
name|Htable
index|[
name|nlo
index|]
operator|.
name|hi
expr_stmt|;
name|Z
operator|.
name|lo
operator|=
name|Htable
index|[
name|nlo
index|]
operator|.
name|lo
expr_stmt|;
while|while
condition|(
literal|1
condition|)
block|{
name|rem
operator|=
operator|(
name|size_t
operator|)
name|Z
operator|.
name|lo
operator|&
literal|0xf
expr_stmt|;
name|Z
operator|.
name|lo
operator|=
operator|(
name|Z
operator|.
name|hi
operator|<<
literal|60
operator|)
operator||
operator|(
name|Z
operator|.
name|lo
operator|>>
literal|4
operator|)
expr_stmt|;
name|Z
operator|.
name|hi
operator|=
operator|(
name|Z
operator|.
name|hi
operator|>>
literal|4
operator|)
expr_stmt|;
if|if
condition|(
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
operator|==
literal|8
condition|)
name|Z
operator|.
name|hi
operator|^=
name|rem_4bit
index|[
name|rem
index|]
expr_stmt|;
else|else
name|Z
operator|.
name|hi
operator|^=
operator|(
name|u64
operator|)
name|rem_4bit
index|[
name|rem
index|]
operator|<<
literal|32
expr_stmt|;
name|Z
operator|.
name|hi
operator|^=
name|Htable
index|[
name|nhi
index|]
operator|.
name|hi
expr_stmt|;
name|Z
operator|.
name|lo
operator|^=
name|Htable
index|[
name|nhi
index|]
operator|.
name|lo
expr_stmt|;
if|if
condition|(
operator|--
name|cnt
operator|<
literal|0
condition|)
break|break;
name|nlo
operator|=
operator|(
operator|(
specifier|const
name|u8
operator|*
operator|)
name|Xi
operator|)
index|[
name|cnt
index|]
expr_stmt|;
name|nhi
operator|=
name|nlo
operator|>>
literal|4
expr_stmt|;
name|nlo
operator|&=
literal|0xf
expr_stmt|;
name|rem
operator|=
operator|(
name|size_t
operator|)
name|Z
operator|.
name|lo
operator|&
literal|0xf
expr_stmt|;
name|Z
operator|.
name|lo
operator|=
operator|(
name|Z
operator|.
name|hi
operator|<<
literal|60
operator|)
operator||
operator|(
name|Z
operator|.
name|lo
operator|>>
literal|4
operator|)
expr_stmt|;
name|Z
operator|.
name|hi
operator|=
operator|(
name|Z
operator|.
name|hi
operator|>>
literal|4
operator|)
expr_stmt|;
if|if
condition|(
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
operator|==
literal|8
condition|)
name|Z
operator|.
name|hi
operator|^=
name|rem_4bit
index|[
name|rem
index|]
expr_stmt|;
else|else
name|Z
operator|.
name|hi
operator|^=
operator|(
name|u64
operator|)
name|rem_4bit
index|[
name|rem
index|]
operator|<<
literal|32
expr_stmt|;
name|Z
operator|.
name|hi
operator|^=
name|Htable
index|[
name|nlo
index|]
operator|.
name|hi
expr_stmt|;
name|Z
operator|.
name|lo
operator|^=
name|Htable
index|[
name|nlo
index|]
operator|.
name|lo
expr_stmt|;
block|}
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
block|{
ifdef|#
directive|ifdef
name|BSWAP8
name|Xi
index|[
literal|0
index|]
operator|=
name|BSWAP8
argument_list|(
name|Z
operator|.
name|hi
argument_list|)
expr_stmt|;
name|Xi
index|[
literal|1
index|]
operator|=
name|BSWAP8
argument_list|(
name|Z
operator|.
name|lo
argument_list|)
expr_stmt|;
else|#
directive|else
name|u8
modifier|*
name|p
init|=
operator|(
name|u8
operator|*
operator|)
name|Xi
decl_stmt|;
name|u32
name|v
decl_stmt|;
name|v
operator|=
call|(
name|u32
call|)
argument_list|(
name|Z
operator|.
name|hi
operator|>>
literal|32
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|p
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|v
operator|=
call|(
name|u32
call|)
argument_list|(
name|Z
operator|.
name|hi
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|p
operator|+
literal|4
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|v
operator|=
call|(
name|u32
call|)
argument_list|(
name|Z
operator|.
name|lo
operator|>>
literal|32
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|p
operator|+
literal|8
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|v
operator|=
call|(
name|u32
call|)
argument_list|(
name|Z
operator|.
name|lo
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|p
operator|+
literal|12
argument_list|,
name|v
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
else|else
block|{
name|Xi
index|[
literal|0
index|]
operator|=
name|Z
operator|.
name|hi
expr_stmt|;
name|Xi
index|[
literal|1
index|]
operator|=
name|Z
operator|.
name|lo
expr_stmt|;
block|}
block|}
end_function

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|OPENSSL_SMALL_FOOTPRINT
argument_list|)
end_if

begin_comment
comment|/*  * Streamed gcm_mult_4bit, see CRYPTO_gcm128_[en|de]crypt for  * details... Compiler-generated code doesn't seem to give any  * performance improvement, at least not on x86[_64]. It's here  * mostly as reference and a placeholder for possible future  * non-trivial optimization[s]...  */
end_comment

begin_function
specifier|static
name|void
name|gcm_ghash_4bit
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u8
modifier|*
name|inp
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
name|u128
name|Z
decl_stmt|;
name|int
name|cnt
decl_stmt|;
name|size_t
name|rem
decl_stmt|,
name|nlo
decl_stmt|,
name|nhi
decl_stmt|;
specifier|const
union|union
block|{
name|long
name|one
decl_stmt|;
name|char
name|little
decl_stmt|;
block|}
name|is_endian
init|=
block|{
literal|1
block|}
union|;
if|#
directive|if
literal|1
do|do
block|{
name|cnt
operator|=
literal|15
expr_stmt|;
name|nlo
operator|=
operator|(
operator|(
specifier|const
name|u8
operator|*
operator|)
name|Xi
operator|)
index|[
literal|15
index|]
expr_stmt|;
name|nlo
operator|^=
name|inp
index|[
literal|15
index|]
expr_stmt|;
name|nhi
operator|=
name|nlo
operator|>>
literal|4
expr_stmt|;
name|nlo
operator|&=
literal|0xf
expr_stmt|;
name|Z
operator|.
name|hi
operator|=
name|Htable
index|[
name|nlo
index|]
operator|.
name|hi
expr_stmt|;
name|Z
operator|.
name|lo
operator|=
name|Htable
index|[
name|nlo
index|]
operator|.
name|lo
expr_stmt|;
while|while
condition|(
literal|1
condition|)
block|{
name|rem
operator|=
operator|(
name|size_t
operator|)
name|Z
operator|.
name|lo
operator|&
literal|0xf
expr_stmt|;
name|Z
operator|.
name|lo
operator|=
operator|(
name|Z
operator|.
name|hi
operator|<<
literal|60
operator|)
operator||
operator|(
name|Z
operator|.
name|lo
operator|>>
literal|4
operator|)
expr_stmt|;
name|Z
operator|.
name|hi
operator|=
operator|(
name|Z
operator|.
name|hi
operator|>>
literal|4
operator|)
expr_stmt|;
if|if
condition|(
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
operator|==
literal|8
condition|)
name|Z
operator|.
name|hi
operator|^=
name|rem_4bit
index|[
name|rem
index|]
expr_stmt|;
else|else
name|Z
operator|.
name|hi
operator|^=
operator|(
name|u64
operator|)
name|rem_4bit
index|[
name|rem
index|]
operator|<<
literal|32
expr_stmt|;
name|Z
operator|.
name|hi
operator|^=
name|Htable
index|[
name|nhi
index|]
operator|.
name|hi
expr_stmt|;
name|Z
operator|.
name|lo
operator|^=
name|Htable
index|[
name|nhi
index|]
operator|.
name|lo
expr_stmt|;
if|if
condition|(
operator|--
name|cnt
operator|<
literal|0
condition|)
break|break;
name|nlo
operator|=
operator|(
operator|(
specifier|const
name|u8
operator|*
operator|)
name|Xi
operator|)
index|[
name|cnt
index|]
expr_stmt|;
name|nlo
operator|^=
name|inp
index|[
name|cnt
index|]
expr_stmt|;
name|nhi
operator|=
name|nlo
operator|>>
literal|4
expr_stmt|;
name|nlo
operator|&=
literal|0xf
expr_stmt|;
name|rem
operator|=
operator|(
name|size_t
operator|)
name|Z
operator|.
name|lo
operator|&
literal|0xf
expr_stmt|;
name|Z
operator|.
name|lo
operator|=
operator|(
name|Z
operator|.
name|hi
operator|<<
literal|60
operator|)
operator||
operator|(
name|Z
operator|.
name|lo
operator|>>
literal|4
operator|)
expr_stmt|;
name|Z
operator|.
name|hi
operator|=
operator|(
name|Z
operator|.
name|hi
operator|>>
literal|4
operator|)
expr_stmt|;
if|if
condition|(
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
operator|==
literal|8
condition|)
name|Z
operator|.
name|hi
operator|^=
name|rem_4bit
index|[
name|rem
index|]
expr_stmt|;
else|else
name|Z
operator|.
name|hi
operator|^=
operator|(
name|u64
operator|)
name|rem_4bit
index|[
name|rem
index|]
operator|<<
literal|32
expr_stmt|;
name|Z
operator|.
name|hi
operator|^=
name|Htable
index|[
name|nlo
index|]
operator|.
name|hi
expr_stmt|;
name|Z
operator|.
name|lo
operator|^=
name|Htable
index|[
name|nlo
index|]
operator|.
name|lo
expr_stmt|;
block|}
else|#
directive|else
comment|/*      * Extra 256+16 bytes per-key plus 512 bytes shared tables      * [should] give ~50% improvement... One could have PACK()-ed      * the rem_8bit even here, but the priority is to minimize      * cache footprint...      */
name|u128
name|Hshr4
index|[
literal|16
index|]
decl_stmt|;
comment|/* Htable shifted right by 4 bits */
name|u8
name|Hshl4
index|[
literal|16
index|]
decl_stmt|;
comment|/* Htable shifted left by 4 bits */
specifier|static
specifier|const
name|unsigned
name|short
name|rem_8bit
index|[
literal|256
index|]
init|=
block|{
literal|0x0000
block|,
literal|0x01C2
block|,
literal|0x0384
block|,
literal|0x0246
block|,
literal|0x0708
block|,
literal|0x06CA
block|,
literal|0x048C
block|,
literal|0x054E
block|,
literal|0x0E10
block|,
literal|0x0FD2
block|,
literal|0x0D94
block|,
literal|0x0C56
block|,
literal|0x0918
block|,
literal|0x08DA
block|,
literal|0x0A9C
block|,
literal|0x0B5E
block|,
literal|0x1C20
block|,
literal|0x1DE2
block|,
literal|0x1FA4
block|,
literal|0x1E66
block|,
literal|0x1B28
block|,
literal|0x1AEA
block|,
literal|0x18AC
block|,
literal|0x196E
block|,
literal|0x1230
block|,
literal|0x13F2
block|,
literal|0x11B4
block|,
literal|0x1076
block|,
literal|0x1538
block|,
literal|0x14FA
block|,
literal|0x16BC
block|,
literal|0x177E
block|,
literal|0x3840
block|,
literal|0x3982
block|,
literal|0x3BC4
block|,
literal|0x3A06
block|,
literal|0x3F48
block|,
literal|0x3E8A
block|,
literal|0x3CCC
block|,
literal|0x3D0E
block|,
literal|0x3650
block|,
literal|0x3792
block|,
literal|0x35D4
block|,
literal|0x3416
block|,
literal|0x3158
block|,
literal|0x309A
block|,
literal|0x32DC
block|,
literal|0x331E
block|,
literal|0x2460
block|,
literal|0x25A2
block|,
literal|0x27E4
block|,
literal|0x2626
block|,
literal|0x2368
block|,
literal|0x22AA
block|,
literal|0x20EC
block|,
literal|0x212E
block|,
literal|0x2A70
block|,
literal|0x2BB2
block|,
literal|0x29F4
block|,
literal|0x2836
block|,
literal|0x2D78
block|,
literal|0x2CBA
block|,
literal|0x2EFC
block|,
literal|0x2F3E
block|,
literal|0x7080
block|,
literal|0x7142
block|,
literal|0x7304
block|,
literal|0x72C6
block|,
literal|0x7788
block|,
literal|0x764A
block|,
literal|0x740C
block|,
literal|0x75CE
block|,
literal|0x7E90
block|,
literal|0x7F52
block|,
literal|0x7D14
block|,
literal|0x7CD6
block|,
literal|0x7998
block|,
literal|0x785A
block|,
literal|0x7A1C
block|,
literal|0x7BDE
block|,
literal|0x6CA0
block|,
literal|0x6D62
block|,
literal|0x6F24
block|,
literal|0x6EE6
block|,
literal|0x6BA8
block|,
literal|0x6A6A
block|,
literal|0x682C
block|,
literal|0x69EE
block|,
literal|0x62B0
block|,
literal|0x6372
block|,
literal|0x6134
block|,
literal|0x60F6
block|,
literal|0x65B8
block|,
literal|0x647A
block|,
literal|0x663C
block|,
literal|0x67FE
block|,
literal|0x48C0
block|,
literal|0x4902
block|,
literal|0x4B44
block|,
literal|0x4A86
block|,
literal|0x4FC8
block|,
literal|0x4E0A
block|,
literal|0x4C4C
block|,
literal|0x4D8E
block|,
literal|0x46D0
block|,
literal|0x4712
block|,
literal|0x4554
block|,
literal|0x4496
block|,
literal|0x41D8
block|,
literal|0x401A
block|,
literal|0x425C
block|,
literal|0x439E
block|,
literal|0x54E0
block|,
literal|0x5522
block|,
literal|0x5764
block|,
literal|0x56A6
block|,
literal|0x53E8
block|,
literal|0x522A
block|,
literal|0x506C
block|,
literal|0x51AE
block|,
literal|0x5AF0
block|,
literal|0x5B32
block|,
literal|0x5974
block|,
literal|0x58B6
block|,
literal|0x5DF8
block|,
literal|0x5C3A
block|,
literal|0x5E7C
block|,
literal|0x5FBE
block|,
literal|0xE100
block|,
literal|0xE0C2
block|,
literal|0xE284
block|,
literal|0xE346
block|,
literal|0xE608
block|,
literal|0xE7CA
block|,
literal|0xE58C
block|,
literal|0xE44E
block|,
literal|0xEF10
block|,
literal|0xEED2
block|,
literal|0xEC94
block|,
literal|0xED56
block|,
literal|0xE818
block|,
literal|0xE9DA
block|,
literal|0xEB9C
block|,
literal|0xEA5E
block|,
literal|0xFD20
block|,
literal|0xFCE2
block|,
literal|0xFEA4
block|,
literal|0xFF66
block|,
literal|0xFA28
block|,
literal|0xFBEA
block|,
literal|0xF9AC
block|,
literal|0xF86E
block|,
literal|0xF330
block|,
literal|0xF2F2
block|,
literal|0xF0B4
block|,
literal|0xF176
block|,
literal|0xF438
block|,
literal|0xF5FA
block|,
literal|0xF7BC
block|,
literal|0xF67E
block|,
literal|0xD940
block|,
literal|0xD882
block|,
literal|0xDAC4
block|,
literal|0xDB06
block|,
literal|0xDE48
block|,
literal|0xDF8A
block|,
literal|0xDDCC
block|,
literal|0xDC0E
block|,
literal|0xD750
block|,
literal|0xD692
block|,
literal|0xD4D4
block|,
literal|0xD516
block|,
literal|0xD058
block|,
literal|0xD19A
block|,
literal|0xD3DC
block|,
literal|0xD21E
block|,
literal|0xC560
block|,
literal|0xC4A2
block|,
literal|0xC6E4
block|,
literal|0xC726
block|,
literal|0xC268
block|,
literal|0xC3AA
block|,
literal|0xC1EC
block|,
literal|0xC02E
block|,
literal|0xCB70
block|,
literal|0xCAB2
block|,
literal|0xC8F4
block|,
literal|0xC936
block|,
literal|0xCC78
block|,
literal|0xCDBA
block|,
literal|0xCFFC
block|,
literal|0xCE3E
block|,
literal|0x9180
block|,
literal|0x9042
block|,
literal|0x9204
block|,
literal|0x93C6
block|,
literal|0x9688
block|,
literal|0x974A
block|,
literal|0x950C
block|,
literal|0x94CE
block|,
literal|0x9F90
block|,
literal|0x9E52
block|,
literal|0x9C14
block|,
literal|0x9DD6
block|,
literal|0x9898
block|,
literal|0x995A
block|,
literal|0x9B1C
block|,
literal|0x9ADE
block|,
literal|0x8DA0
block|,
literal|0x8C62
block|,
literal|0x8E24
block|,
literal|0x8FE6
block|,
literal|0x8AA8
block|,
literal|0x8B6A
block|,
literal|0x892C
block|,
literal|0x88EE
block|,
literal|0x83B0
block|,
literal|0x8272
block|,
literal|0x8034
block|,
literal|0x81F6
block|,
literal|0x84B8
block|,
literal|0x857A
block|,
literal|0x873C
block|,
literal|0x86FE
block|,
literal|0xA9C0
block|,
literal|0xA802
block|,
literal|0xAA44
block|,
literal|0xAB86
block|,
literal|0xAEC8
block|,
literal|0xAF0A
block|,
literal|0xAD4C
block|,
literal|0xAC8E
block|,
literal|0xA7D0
block|,
literal|0xA612
block|,
literal|0xA454
block|,
literal|0xA596
block|,
literal|0xA0D8
block|,
literal|0xA11A
block|,
literal|0xA35C
block|,
literal|0xA29E
block|,
literal|0xB5E0
block|,
literal|0xB422
block|,
literal|0xB664
block|,
literal|0xB7A6
block|,
literal|0xB2E8
block|,
literal|0xB32A
block|,
literal|0xB16C
block|,
literal|0xB0AE
block|,
literal|0xBBF0
block|,
literal|0xBA32
block|,
literal|0xB874
block|,
literal|0xB9B6
block|,
literal|0xBCF8
block|,
literal|0xBD3A
block|,
literal|0xBF7C
block|,
literal|0xBEBE
block|}
decl_stmt|;
comment|/*      * This pre-processing phase slows down procedure by approximately      * same time as it makes each loop spin faster. In other words      * single block performance is approximately same as straightforward      * "4-bit" implementation, and then it goes only faster...      */
for|for
control|(
name|cnt
operator|=
literal|0
init|;
name|cnt
operator|<
literal|16
condition|;
operator|++
name|cnt
control|)
block|{
name|Z
operator|.
name|hi
operator|=
name|Htable
index|[
name|cnt
index|]
operator|.
name|hi
expr_stmt|;
name|Z
operator|.
name|lo
operator|=
name|Htable
index|[
name|cnt
index|]
operator|.
name|lo
expr_stmt|;
name|Hshr4
index|[
name|cnt
index|]
operator|.
name|lo
operator|=
operator|(
name|Z
operator|.
name|hi
operator|<<
literal|60
operator|)
operator||
operator|(
name|Z
operator|.
name|lo
operator|>>
literal|4
operator|)
expr_stmt|;
name|Hshr4
index|[
name|cnt
index|]
operator|.
name|hi
operator|=
operator|(
name|Z
operator|.
name|hi
operator|>>
literal|4
operator|)
expr_stmt|;
name|Hshl4
index|[
name|cnt
index|]
operator|=
call|(
name|u8
call|)
argument_list|(
name|Z
operator|.
name|lo
operator|<<
literal|4
argument_list|)
expr_stmt|;
block|}
do|do
block|{
for|for
control|(
name|Z
operator|.
name|lo
operator|=
literal|0
operator|,
name|Z
operator|.
name|hi
operator|=
literal|0
operator|,
name|cnt
operator|=
literal|15
init|;
name|cnt
condition|;
operator|--
name|cnt
control|)
block|{
name|nlo
operator|=
operator|(
operator|(
specifier|const
name|u8
operator|*
operator|)
name|Xi
operator|)
index|[
name|cnt
index|]
expr_stmt|;
name|nlo
operator|^=
name|inp
index|[
name|cnt
index|]
expr_stmt|;
name|nhi
operator|=
name|nlo
operator|>>
literal|4
expr_stmt|;
name|nlo
operator|&=
literal|0xf
expr_stmt|;
name|Z
operator|.
name|hi
operator|^=
name|Htable
index|[
name|nlo
index|]
operator|.
name|hi
expr_stmt|;
name|Z
operator|.
name|lo
operator|^=
name|Htable
index|[
name|nlo
index|]
operator|.
name|lo
expr_stmt|;
name|rem
operator|=
operator|(
name|size_t
operator|)
name|Z
operator|.
name|lo
operator|&
literal|0xff
expr_stmt|;
name|Z
operator|.
name|lo
operator|=
operator|(
name|Z
operator|.
name|hi
operator|<<
literal|56
operator|)
operator||
operator|(
name|Z
operator|.
name|lo
operator|>>
literal|8
operator|)
expr_stmt|;
name|Z
operator|.
name|hi
operator|=
operator|(
name|Z
operator|.
name|hi
operator|>>
literal|8
operator|)
expr_stmt|;
name|Z
operator|.
name|hi
operator|^=
name|Hshr4
index|[
name|nhi
index|]
operator|.
name|hi
expr_stmt|;
name|Z
operator|.
name|lo
operator|^=
name|Hshr4
index|[
name|nhi
index|]
operator|.
name|lo
expr_stmt|;
name|Z
operator|.
name|hi
operator|^=
operator|(
name|u64
operator|)
name|rem_8bit
index|[
name|rem
operator|^
name|Hshl4
index|[
name|nhi
index|]
index|]
operator|<<
literal|48
expr_stmt|;
block|}
name|nlo
operator|=
operator|(
operator|(
specifier|const
name|u8
operator|*
operator|)
name|Xi
operator|)
index|[
literal|0
index|]
expr_stmt|;
name|nlo
operator|^=
name|inp
index|[
literal|0
index|]
expr_stmt|;
name|nhi
operator|=
name|nlo
operator|>>
literal|4
expr_stmt|;
name|nlo
operator|&=
literal|0xf
expr_stmt|;
name|Z
operator|.
name|hi
operator|^=
name|Htable
index|[
name|nlo
index|]
operator|.
name|hi
expr_stmt|;
name|Z
operator|.
name|lo
operator|^=
name|Htable
index|[
name|nlo
index|]
operator|.
name|lo
expr_stmt|;
name|rem
operator|=
operator|(
name|size_t
operator|)
name|Z
operator|.
name|lo
operator|&
literal|0xf
expr_stmt|;
name|Z
operator|.
name|lo
operator|=
operator|(
name|Z
operator|.
name|hi
operator|<<
literal|60
operator|)
operator||
operator|(
name|Z
operator|.
name|lo
operator|>>
literal|4
operator|)
expr_stmt|;
name|Z
operator|.
name|hi
operator|=
operator|(
name|Z
operator|.
name|hi
operator|>>
literal|4
operator|)
expr_stmt|;
name|Z
operator|.
name|hi
operator|^=
name|Htable
index|[
name|nhi
index|]
operator|.
name|hi
expr_stmt|;
name|Z
operator|.
name|lo
operator|^=
name|Htable
index|[
name|nhi
index|]
operator|.
name|lo
expr_stmt|;
name|Z
operator|.
name|hi
operator|^=
operator|(
operator|(
name|u64
operator|)
name|rem_8bit
index|[
name|rem
operator|<<
literal|4
index|]
operator|)
operator|<<
literal|48
expr_stmt|;
endif|#
directive|endif
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
block|{
ifdef|#
directive|ifdef
name|BSWAP8
name|Xi
index|[
literal|0
index|]
operator|=
name|BSWAP8
argument_list|(
name|Z
operator|.
name|hi
argument_list|)
expr_stmt|;
name|Xi
index|[
literal|1
index|]
operator|=
name|BSWAP8
argument_list|(
name|Z
operator|.
name|lo
argument_list|)
expr_stmt|;
else|#
directive|else
name|u8
modifier|*
name|p
init|=
operator|(
name|u8
operator|*
operator|)
name|Xi
decl_stmt|;
name|u32
name|v
decl_stmt|;
name|v
operator|=
call|(
name|u32
call|)
argument_list|(
name|Z
operator|.
name|hi
operator|>>
literal|32
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|p
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|v
operator|=
call|(
name|u32
call|)
argument_list|(
name|Z
operator|.
name|hi
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|p
operator|+
literal|4
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|v
operator|=
call|(
name|u32
call|)
argument_list|(
name|Z
operator|.
name|lo
operator|>>
literal|32
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|p
operator|+
literal|8
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|v
operator|=
call|(
name|u32
call|)
argument_list|(
name|Z
operator|.
name|lo
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|p
operator|+
literal|12
argument_list|,
name|v
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
else|else
block|{
name|Xi
index|[
literal|0
index|]
operator|=
name|Z
operator|.
name|hi
expr_stmt|;
name|Xi
index|[
literal|1
index|]
operator|=
name|Z
operator|.
name|lo
expr_stmt|;
block|}
block|}
do|while
condition|(
name|inp
operator|+=
literal|16
operator|,
name|len
operator|-=
literal|16
condition|)
do|;
block|}
endif|#
directive|endif
else|#
directive|else
do|void gcm_gmult_4bit(u64 Xi[2]
operator|,
do|const u128 Htable[16]
block|)
function|;
end_function

begin_function_decl
name|void
name|gcm_ghash_4bit
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u8
modifier|*
name|inp
parameter_list|,
name|size_t
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_define
define|#
directive|define
name|GCM_MUL
parameter_list|(
name|ctx
parameter_list|,
name|Xi
parameter_list|)
value|gcm_gmult_4bit(ctx->Xi.u,ctx->Htable)
end_define

begin_if
if|#
directive|if
name|defined
argument_list|(
name|GHASH_ASM
argument_list|)
operator|||
operator|!
name|defined
argument_list|(
name|OPENSSL_SMALL_FOOTPRINT
argument_list|)
end_if

begin_define
define|#
directive|define
name|GHASH
parameter_list|(
name|ctx
parameter_list|,
name|in
parameter_list|,
name|len
parameter_list|)
value|gcm_ghash_4bit((ctx)->Xi.u,(ctx)->Htable,in,len)
end_define

begin_comment
comment|/*  * GHASH_CHUNK is "stride parameter" missioned to mitigate cache trashing  * effect. In other words idea is to hash data while it's still in L1 cache  * after encryption pass...  */
end_comment

begin_define
define|#
directive|define
name|GHASH_CHUNK
value|(3*1024)
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* TABLE_BITS */
end_comment

begin_function
specifier|static
name|void
name|gcm_gmult_1bit
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u64
name|H
index|[
literal|2
index|]
parameter_list|)
block|{
name|u128
name|V
decl_stmt|,
name|Z
init|=
block|{
literal|0
block|,
literal|0
block|}
decl_stmt|;
name|long
name|X
decl_stmt|;
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
specifier|const
name|long
modifier|*
name|xi
init|=
operator|(
specifier|const
name|long
operator|*
operator|)
name|Xi
decl_stmt|;
specifier|const
union|union
block|{
name|long
name|one
decl_stmt|;
name|char
name|little
decl_stmt|;
block|}
name|is_endian
init|=
block|{
literal|1
block|}
union|;
name|V
operator|.
name|hi
operator|=
name|H
index|[
literal|0
index|]
expr_stmt|;
comment|/* H is in host byte order, no byte swapping */
name|V
operator|.
name|lo
operator|=
name|H
index|[
literal|1
index|]
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|16
operator|/
sizeof|sizeof
argument_list|(
name|long
argument_list|)
condition|;
operator|++
name|j
control|)
block|{
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
block|{
if|if
condition|(
sizeof|sizeof
argument_list|(
name|long
argument_list|)
operator|==
literal|8
condition|)
block|{
ifdef|#
directive|ifdef
name|BSWAP8
name|X
operator|=
call|(
name|long
call|)
argument_list|(
name|BSWAP8
argument_list|(
name|xi
index|[
name|j
index|]
argument_list|)
argument_list|)
expr_stmt|;
else|#
directive|else
specifier|const
name|u8
modifier|*
name|p
init|=
operator|(
specifier|const
name|u8
operator|*
operator|)
operator|(
name|xi
operator|+
name|j
operator|)
decl_stmt|;
name|X
operator|=
call|(
name|long
call|)
argument_list|(
operator|(
name|u64
operator|)
name|GETU32
argument_list|(
name|p
argument_list|)
operator|<<
literal|32
operator||
name|GETU32
argument_list|(
name|p
operator|+
literal|4
argument_list|)
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
else|else
block|{
specifier|const
name|u8
modifier|*
name|p
init|=
operator|(
specifier|const
name|u8
operator|*
operator|)
operator|(
name|xi
operator|+
name|j
operator|)
decl_stmt|;
name|X
operator|=
operator|(
name|long
operator|)
name|GETU32
argument_list|(
name|p
argument_list|)
expr_stmt|;
block|}
block|}
else|else
name|X
operator|=
name|xi
index|[
name|j
index|]
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|8
operator|*
sizeof|sizeof
argument_list|(
name|long
argument_list|)
condition|;
operator|++
name|i
operator|,
name|X
operator|<<=
literal|1
control|)
block|{
name|u64
name|M
init|=
call|(
name|u64
call|)
argument_list|(
name|X
operator|>>
operator|(
literal|8
operator|*
sizeof|sizeof
argument_list|(
name|long
argument_list|)
operator|-
literal|1
operator|)
argument_list|)
decl_stmt|;
name|Z
operator|.
name|hi
operator|^=
name|V
operator|.
name|hi
operator|&
name|M
expr_stmt|;
name|Z
operator|.
name|lo
operator|^=
name|V
operator|.
name|lo
operator|&
name|M
expr_stmt|;
name|REDUCE1BIT
argument_list|(
name|V
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
block|{
ifdef|#
directive|ifdef
name|BSWAP8
name|Xi
index|[
literal|0
index|]
operator|=
name|BSWAP8
argument_list|(
name|Z
operator|.
name|hi
argument_list|)
expr_stmt|;
name|Xi
index|[
literal|1
index|]
operator|=
name|BSWAP8
argument_list|(
name|Z
operator|.
name|lo
argument_list|)
expr_stmt|;
else|#
directive|else
name|u8
modifier|*
name|p
init|=
operator|(
name|u8
operator|*
operator|)
name|Xi
decl_stmt|;
name|u32
name|v
decl_stmt|;
name|v
operator|=
call|(
name|u32
call|)
argument_list|(
name|Z
operator|.
name|hi
operator|>>
literal|32
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|p
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|v
operator|=
call|(
name|u32
call|)
argument_list|(
name|Z
operator|.
name|hi
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|p
operator|+
literal|4
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|v
operator|=
call|(
name|u32
call|)
argument_list|(
name|Z
operator|.
name|lo
operator|>>
literal|32
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|p
operator|+
literal|8
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|v
operator|=
call|(
name|u32
call|)
argument_list|(
name|Z
operator|.
name|lo
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|p
operator|+
literal|12
argument_list|,
name|v
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
else|else
block|{
name|Xi
index|[
literal|0
index|]
operator|=
name|Z
operator|.
name|hi
expr_stmt|;
name|Xi
index|[
literal|1
index|]
operator|=
name|Z
operator|.
name|lo
expr_stmt|;
block|}
block|}
end_function

begin_define
define|#
directive|define
name|GCM_MUL
parameter_list|(
name|ctx
parameter_list|,
name|Xi
parameter_list|)
value|gcm_gmult_1bit(ctx->Xi.u,ctx->H.u)
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
name|TABLE_BITS
operator|==
literal|4
operator|&&
operator|(
name|defined
argument_list|(
name|GHASH_ASM
argument_list|)
operator|||
name|defined
argument_list|(
name|OPENSSL_CPUID_OBJ
argument_list|)
operator|)
end_if

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|I386_ONLY
argument_list|)
operator|&&
expr|\
operator|(
name|defined
argument_list|(
name|__i386
argument_list|)
operator|||
name|defined
argument_list|(
name|__i386__
argument_list|)
operator|||
expr|\
name|defined
argument_list|(
name|__x86_64
argument_list|)
operator|||
name|defined
argument_list|(
name|__x86_64__
argument_list|)
operator|||
expr|\
name|defined
argument_list|(
name|_M_IX86
argument_list|)
operator|||
name|defined
argument_list|(
name|_M_AMD64
argument_list|)
operator|||
name|defined
argument_list|(
name|_M_X64
argument_list|)
operator|)
end_if

begin_define
define|#
directive|define
name|GHASH_ASM_X86_OR_64
end_define

begin_define
define|#
directive|define
name|GCM_FUNCREF_4BIT
end_define

begin_decl_stmt
specifier|extern
name|unsigned
name|int
name|OPENSSL_ia32cap_P
index|[]
decl_stmt|;
end_decl_stmt

begin_function_decl
name|void
name|gcm_init_clmul
parameter_list|(
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gcm_gmult_clmul
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gcm_ghash_clmul
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u8
modifier|*
name|inp
parameter_list|,
name|size_t
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__i386
argument_list|)
operator|||
name|defined
argument_list|(
name|__i386__
argument_list|)
operator|||
name|defined
argument_list|(
name|_M_IX86
argument_list|)
end_if

begin_define
define|#
directive|define
name|gcm_init_avx
value|gcm_init_clmul
end_define

begin_define
define|#
directive|define
name|gcm_gmult_avx
value|gcm_gmult_clmul
end_define

begin_define
define|#
directive|define
name|gcm_ghash_avx
value|gcm_ghash_clmul
end_define

begin_else
else|#
directive|else
end_else

begin_function_decl
name|void
name|gcm_init_avx
parameter_list|(
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gcm_gmult_avx
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gcm_ghash_avx
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u8
modifier|*
name|inp
parameter_list|,
name|size_t
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__i386
argument_list|)
operator|||
name|defined
argument_list|(
name|__i386__
argument_list|)
operator|||
name|defined
argument_list|(
name|_M_IX86
argument_list|)
end_if

begin_define
define|#
directive|define
name|GHASH_ASM_X86
end_define

begin_function_decl
name|void
name|gcm_gmult_4bit_mmx
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gcm_ghash_4bit_mmx
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u8
modifier|*
name|inp
parameter_list|,
name|size_t
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gcm_gmult_4bit_x86
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gcm_ghash_4bit_x86
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u8
modifier|*
name|inp
parameter_list|,
name|size_t
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|__arm__
argument_list|)
operator|||
name|defined
argument_list|(
name|__arm
argument_list|)
operator|||
name|defined
argument_list|(
name|__aarch64__
argument_list|)
end_elif

begin_include
include|#
directive|include
file|"arm_arch.h"
end_include

begin_if
if|#
directive|if
name|__ARM_MAX_ARCH__
operator|>=
literal|7
end_if

begin_define
define|#
directive|define
name|GHASH_ASM_ARM
end_define

begin_define
define|#
directive|define
name|GCM_FUNCREF_4BIT
end_define

begin_define
define|#
directive|define
name|PMULL_CAPABLE
value|(OPENSSL_armcap_P& ARMV8_PMULL)
end_define

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__arm__
argument_list|)
operator|||
name|defined
argument_list|(
name|__arm
argument_list|)
end_if

begin_define
define|#
directive|define
name|NEON_CAPABLE
value|(OPENSSL_armcap_P& ARMV7_NEON)
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_function_decl
name|void
name|gcm_init_neon
parameter_list|(
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gcm_gmult_neon
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gcm_ghash_neon
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u8
modifier|*
name|inp
parameter_list|,
name|size_t
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gcm_init_v8
parameter_list|(
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gcm_gmult_v8
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gcm_ghash_v8
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u8
modifier|*
name|inp
parameter_list|,
name|size_t
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|__sparc__
argument_list|)
operator|||
name|defined
argument_list|(
name|__sparc
argument_list|)
end_elif

begin_include
include|#
directive|include
file|"sparc_arch.h"
end_include

begin_define
define|#
directive|define
name|GHASH_ASM_SPARC
end_define

begin_define
define|#
directive|define
name|GCM_FUNCREF_4BIT
end_define

begin_decl_stmt
specifier|extern
name|unsigned
name|int
name|OPENSSL_sparcv9cap_P
index|[]
decl_stmt|;
end_decl_stmt

begin_function_decl
name|void
name|gcm_init_vis3
parameter_list|(
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gcm_gmult_vis3
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gcm_ghash_vis3
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u8
modifier|*
name|inp
parameter_list|,
name|size_t
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|OPENSSL_CPUID_OBJ
argument_list|)
operator|&&
operator|(
name|defined
argument_list|(
name|__powerpc__
argument_list|)
operator|||
name|defined
argument_list|(
name|__ppc__
argument_list|)
operator|||
name|defined
argument_list|(
name|_ARCH_PPC
argument_list|)
operator|)
end_elif

begin_include
include|#
directive|include
file|"ppc_arch.h"
end_include

begin_define
define|#
directive|define
name|GHASH_ASM_PPC
end_define

begin_define
define|#
directive|define
name|GCM_FUNCREF_4BIT
end_define

begin_function_decl
name|void
name|gcm_init_p8
parameter_list|(
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gcm_gmult_p8
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gcm_ghash_p8
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u8
modifier|*
name|inp
parameter_list|,
name|size_t
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_ifdef
ifdef|#
directive|ifdef
name|GCM_FUNCREF_4BIT
end_ifdef

begin_undef
undef|#
directive|undef
name|GCM_MUL
end_undef

begin_define
define|#
directive|define
name|GCM_MUL
parameter_list|(
name|ctx
parameter_list|,
name|Xi
parameter_list|)
value|(*gcm_gmult_p)(ctx->Xi.u,ctx->Htable)
end_define

begin_ifdef
ifdef|#
directive|ifdef
name|GHASH
end_ifdef

begin_undef
undef|#
directive|undef
name|GHASH
end_undef

begin_define
define|#
directive|define
name|GHASH
parameter_list|(
name|ctx
parameter_list|,
name|in
parameter_list|,
name|len
parameter_list|)
value|(*gcm_ghash_p)(ctx->Xi.u,ctx->Htable,in,len)
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_function
name|void
name|CRYPTO_gcm128_init
parameter_list|(
name|GCM128_CONTEXT
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|key
parameter_list|,
name|block128_f
name|block
parameter_list|)
block|{
specifier|const
union|union
block|{
name|long
name|one
decl_stmt|;
name|char
name|little
decl_stmt|;
block|}
name|is_endian
init|=
block|{
literal|1
block|}
union|;
name|memset
argument_list|(
name|ctx
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|ctx
argument_list|)
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|block
operator|=
name|block
expr_stmt|;
name|ctx
operator|->
name|key
operator|=
name|key
expr_stmt|;
call|(
modifier|*
name|block
call|)
argument_list|(
name|ctx
operator|->
name|H
operator|.
name|c
argument_list|,
name|ctx
operator|->
name|H
operator|.
name|c
argument_list|,
name|key
argument_list|)
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
block|{
comment|/* H is stored in host byte order */
ifdef|#
directive|ifdef
name|BSWAP8
name|ctx
operator|->
name|H
operator|.
name|u
index|[
literal|0
index|]
operator|=
name|BSWAP8
argument_list|(
name|ctx
operator|->
name|H
operator|.
name|u
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|H
operator|.
name|u
index|[
literal|1
index|]
operator|=
name|BSWAP8
argument_list|(
name|ctx
operator|->
name|H
operator|.
name|u
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
else|#
directive|else
name|u8
modifier|*
name|p
init|=
name|ctx
operator|->
name|H
operator|.
name|c
decl_stmt|;
name|u64
name|hi
decl_stmt|,
name|lo
decl_stmt|;
name|hi
operator|=
operator|(
name|u64
operator|)
name|GETU32
argument_list|(
name|p
argument_list|)
operator|<<
literal|32
operator||
name|GETU32
argument_list|(
name|p
operator|+
literal|4
argument_list|)
expr_stmt|;
name|lo
operator|=
operator|(
name|u64
operator|)
name|GETU32
argument_list|(
name|p
operator|+
literal|8
argument_list|)
operator|<<
literal|32
operator||
name|GETU32
argument_list|(
name|p
operator|+
literal|12
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|H
operator|.
name|u
index|[
literal|0
index|]
operator|=
name|hi
expr_stmt|;
name|ctx
operator|->
name|H
operator|.
name|u
index|[
literal|1
index|]
operator|=
name|lo
expr_stmt|;
endif|#
directive|endif
block|}
if|#
directive|if
name|TABLE_BITS
operator|==
literal|8
name|gcm_init_8bit
argument_list|(
name|ctx
operator|->
name|Htable
argument_list|,
name|ctx
operator|->
name|H
operator|.
name|u
argument_list|)
expr_stmt|;
elif|#
directive|elif
name|TABLE_BITS
operator|==
literal|4
if|#
directive|if
name|defined
argument_list|(
name|GHASH_ASM_X86_OR_64
argument_list|)
if|#
directive|if
operator|!
name|defined
argument_list|(
name|GHASH_ASM_X86
argument_list|)
operator|||
name|defined
argument_list|(
name|OPENSSL_IA32_SSE2
argument_list|)
if|if
condition|(
name|OPENSSL_ia32cap_P
index|[
literal|0
index|]
operator|&
operator|(
literal|1
operator|<<
literal|24
operator|)
operator|&&
comment|/* check FXSR bit */
name|OPENSSL_ia32cap_P
index|[
literal|1
index|]
operator|&
operator|(
literal|1
operator|<<
literal|1
operator|)
condition|)
block|{
comment|/* check PCLMULQDQ bit */
if|if
condition|(
operator|(
operator|(
name|OPENSSL_ia32cap_P
index|[
literal|1
index|]
operator|>>
literal|22
operator|)
operator|&
literal|0x41
operator|)
operator|==
literal|0x41
condition|)
block|{
comment|/* AVX+MOVBE */
name|gcm_init_avx
argument_list|(
name|ctx
operator|->
name|Htable
argument_list|,
name|ctx
operator|->
name|H
operator|.
name|u
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|gmult
operator|=
name|gcm_gmult_avx
expr_stmt|;
name|ctx
operator|->
name|ghash
operator|=
name|gcm_ghash_avx
expr_stmt|;
block|}
else|else
block|{
name|gcm_init_clmul
argument_list|(
name|ctx
operator|->
name|Htable
argument_list|,
name|ctx
operator|->
name|H
operator|.
name|u
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|gmult
operator|=
name|gcm_gmult_clmul
expr_stmt|;
name|ctx
operator|->
name|ghash
operator|=
name|gcm_ghash_clmul
expr_stmt|;
block|}
return|return;
block|}
endif|#
directive|endif
name|gcm_init_4bit
argument_list|(
name|ctx
operator|->
name|Htable
argument_list|,
name|ctx
operator|->
name|H
operator|.
name|u
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|GHASH_ASM_X86
argument_list|)
comment|/* x86 only */
if|#
directive|if
name|defined
argument_list|(
name|OPENSSL_IA32_SSE2
argument_list|)
if|if
condition|(
name|OPENSSL_ia32cap_P
index|[
literal|0
index|]
operator|&
operator|(
literal|1
operator|<<
literal|25
operator|)
condition|)
block|{
comment|/* check SSE bit */
else|#
directive|else
if|if
condition|(
name|OPENSSL_ia32cap_P
index|[
literal|0
index|]
operator|&
operator|(
literal|1
operator|<<
literal|23
operator|)
condition|)
block|{
comment|/* check MMX bit */
endif|#
directive|endif
name|ctx
operator|->
name|gmult
operator|=
name|gcm_gmult_4bit_mmx
expr_stmt|;
name|ctx
operator|->
name|ghash
operator|=
name|gcm_ghash_4bit_mmx
expr_stmt|;
block|}
else|else
block|{
name|ctx
operator|->
name|gmult
operator|=
name|gcm_gmult_4bit_x86
expr_stmt|;
name|ctx
operator|->
name|ghash
operator|=
name|gcm_ghash_4bit_x86
expr_stmt|;
block|}
else|#
directive|else
name|ctx
operator|->
name|gmult
operator|=
name|gcm_gmult_4bit
expr_stmt|;
name|ctx
operator|->
name|ghash
operator|=
name|gcm_ghash_4bit
expr_stmt|;
endif|#
directive|endif
elif|#
directive|elif
name|defined
argument_list|(
name|GHASH_ASM_ARM
argument_list|)
ifdef|#
directive|ifdef
name|PMULL_CAPABLE
if|if
condition|(
name|PMULL_CAPABLE
condition|)
block|{
name|gcm_init_v8
argument_list|(
name|ctx
operator|->
name|Htable
argument_list|,
name|ctx
operator|->
name|H
operator|.
name|u
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|gmult
operator|=
name|gcm_gmult_v8
expr_stmt|;
name|ctx
operator|->
name|ghash
operator|=
name|gcm_ghash_v8
expr_stmt|;
block|}
elseif|else
endif|#
directive|endif
ifdef|#
directive|ifdef
name|NEON_CAPABLE
if|if
condition|(
name|NEON_CAPABLE
condition|)
block|{
name|gcm_init_neon
argument_list|(
name|ctx
operator|->
name|Htable
argument_list|,
name|ctx
operator|->
name|H
operator|.
name|u
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|gmult
operator|=
name|gcm_gmult_neon
expr_stmt|;
name|ctx
operator|->
name|ghash
operator|=
name|gcm_ghash_neon
expr_stmt|;
block|}
else|else
endif|#
directive|endif
block|{
name|gcm_init_4bit
argument_list|(
name|ctx
operator|->
name|Htable
argument_list|,
name|ctx
operator|->
name|H
operator|.
name|u
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|gmult
operator|=
name|gcm_gmult_4bit
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|GHASH
argument_list|)
name|ctx
operator|->
name|ghash
operator|=
name|gcm_ghash_4bit
expr_stmt|;
else|#
directive|else
name|ctx
operator|->
name|ghash
operator|=
name|NULL
expr_stmt|;
endif|#
directive|endif
block|}
elif|#
directive|elif
name|defined
argument_list|(
name|GHASH_ASM_SPARC
argument_list|)
if|if
condition|(
name|OPENSSL_sparcv9cap_P
index|[
literal|0
index|]
operator|&
name|SPARCV9_VIS3
condition|)
block|{
name|gcm_init_vis3
argument_list|(
name|ctx
operator|->
name|Htable
argument_list|,
name|ctx
operator|->
name|H
operator|.
name|u
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|gmult
operator|=
name|gcm_gmult_vis3
expr_stmt|;
name|ctx
operator|->
name|ghash
operator|=
name|gcm_ghash_vis3
expr_stmt|;
block|}
else|else
block|{
name|gcm_init_4bit
argument_list|(
name|ctx
operator|->
name|Htable
argument_list|,
name|ctx
operator|->
name|H
operator|.
name|u
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|gmult
operator|=
name|gcm_gmult_4bit
expr_stmt|;
name|ctx
operator|->
name|ghash
operator|=
name|gcm_ghash_4bit
expr_stmt|;
block|}
elif|#
directive|elif
name|defined
argument_list|(
name|GHASH_ASM_PPC
argument_list|)
if|if
condition|(
name|OPENSSL_ppccap_P
operator|&
name|PPC_CRYPTO207
condition|)
block|{
name|gcm_init_p8
argument_list|(
name|ctx
operator|->
name|Htable
argument_list|,
name|ctx
operator|->
name|H
operator|.
name|u
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|gmult
operator|=
name|gcm_gmult_p8
expr_stmt|;
name|ctx
operator|->
name|ghash
operator|=
name|gcm_ghash_p8
expr_stmt|;
block|}
else|else
block|{
name|gcm_init_4bit
argument_list|(
name|ctx
operator|->
name|Htable
argument_list|,
name|ctx
operator|->
name|H
operator|.
name|u
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|gmult
operator|=
name|gcm_gmult_4bit
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|GHASH
argument_list|)
name|ctx
operator|->
name|ghash
operator|=
name|gcm_ghash_4bit
expr_stmt|;
else|#
directive|else
name|ctx
operator|->
name|ghash
operator|=
name|NULL
expr_stmt|;
endif|#
directive|endif
block|}
else|#
directive|else
name|gcm_init_4bit
argument_list|(
name|ctx
operator|->
name|Htable
argument_list|,
name|ctx
operator|->
name|H
operator|.
name|u
argument_list|)
expr_stmt|;
endif|#
directive|endif
endif|#
directive|endif
block|}
name|void
name|CRYPTO_gcm128_setiv
parameter_list|(
name|GCM128_CONTEXT
modifier|*
name|ctx
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|iv
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
specifier|const
union|union
block|{
name|long
name|one
decl_stmt|;
name|char
name|little
decl_stmt|;
block|}
name|is_endian
init|=
block|{
literal|1
block|}
union|;
name|unsigned
name|int
name|ctr
decl_stmt|;
ifdef|#
directive|ifdef
name|GCM_FUNCREF_4BIT
name|void
function_decl|(
modifier|*
name|gcm_gmult_p
function_decl|)
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|)
init|=
name|ctx
operator|->
name|gmult
function_decl|;
endif|#
directive|endif
name|ctx
operator|->
name|Yi
operator|.
name|u
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|ctx
operator|->
name|Yi
operator|.
name|u
index|[
literal|1
index|]
operator|=
literal|0
expr_stmt|;
name|ctx
operator|->
name|Xi
operator|.
name|u
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|ctx
operator|->
name|Xi
operator|.
name|u
index|[
literal|1
index|]
operator|=
literal|0
expr_stmt|;
name|ctx
operator|->
name|len
operator|.
name|u
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
comment|/* AAD length */
name|ctx
operator|->
name|len
operator|.
name|u
index|[
literal|1
index|]
operator|=
literal|0
expr_stmt|;
comment|/* message length */
name|ctx
operator|->
name|ares
operator|=
literal|0
expr_stmt|;
name|ctx
operator|->
name|mres
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|len
operator|==
literal|12
condition|)
block|{
name|memcpy
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|,
name|iv
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|Yi
operator|.
name|c
index|[
literal|15
index|]
operator|=
literal|1
expr_stmt|;
name|ctr
operator|=
literal|1
expr_stmt|;
block|}
else|else
block|{
name|size_t
name|i
decl_stmt|;
name|u64
name|len0
init|=
name|len
decl_stmt|;
while|while
condition|(
name|len
operator|>=
literal|16
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|16
condition|;
operator|++
name|i
control|)
name|ctx
operator|->
name|Yi
operator|.
name|c
index|[
name|i
index|]
operator|^=
name|iv
index|[
name|i
index|]
expr_stmt|;
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Yi
argument_list|)
expr_stmt|;
name|iv
operator|+=
literal|16
expr_stmt|;
name|len
operator|-=
literal|16
expr_stmt|;
block|}
if|if
condition|(
name|len
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
operator|++
name|i
control|)
name|ctx
operator|->
name|Yi
operator|.
name|c
index|[
name|i
index|]
operator|^=
name|iv
index|[
name|i
index|]
expr_stmt|;
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Yi
argument_list|)
expr_stmt|;
block|}
name|len0
operator|<<=
literal|3
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
block|{
ifdef|#
directive|ifdef
name|BSWAP8
name|ctx
operator|->
name|Yi
operator|.
name|u
index|[
literal|1
index|]
operator|^=
name|BSWAP8
argument_list|(
name|len0
argument_list|)
expr_stmt|;
else|#
directive|else
name|ctx
operator|->
name|Yi
operator|.
name|c
index|[
literal|8
index|]
operator|^=
call|(
name|u8
call|)
argument_list|(
name|len0
operator|>>
literal|56
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|Yi
operator|.
name|c
index|[
literal|9
index|]
operator|^=
call|(
name|u8
call|)
argument_list|(
name|len0
operator|>>
literal|48
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|Yi
operator|.
name|c
index|[
literal|10
index|]
operator|^=
call|(
name|u8
call|)
argument_list|(
name|len0
operator|>>
literal|40
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|Yi
operator|.
name|c
index|[
literal|11
index|]
operator|^=
call|(
name|u8
call|)
argument_list|(
name|len0
operator|>>
literal|32
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|Yi
operator|.
name|c
index|[
literal|12
index|]
operator|^=
call|(
name|u8
call|)
argument_list|(
name|len0
operator|>>
literal|24
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|Yi
operator|.
name|c
index|[
literal|13
index|]
operator|^=
call|(
name|u8
call|)
argument_list|(
name|len0
operator|>>
literal|16
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|Yi
operator|.
name|c
index|[
literal|14
index|]
operator|^=
call|(
name|u8
call|)
argument_list|(
name|len0
operator|>>
literal|8
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|Yi
operator|.
name|c
index|[
literal|15
index|]
operator|^=
call|(
name|u8
call|)
argument_list|(
name|len0
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
else|else
name|ctx
operator|->
name|Yi
operator|.
name|u
index|[
literal|1
index|]
operator|^=
name|len0
expr_stmt|;
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Yi
argument_list|)
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctr
operator|=
name|BSWAP4
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
else|#
directive|else
name|ctr
operator|=
name|GETU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctr
operator|=
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
expr_stmt|;
block|}
call|(
modifier|*
name|ctx
operator|->
name|block
call|)
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|,
name|ctx
operator|->
name|EK0
operator|.
name|c
argument_list|,
name|ctx
operator|->
name|key
argument_list|)
expr_stmt|;
operator|++
name|ctr
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|BSWAP4
argument_list|(
name|ctr
argument_list|)
expr_stmt|;
else|#
directive|else
name|PUTU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|,
name|ctr
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|ctr
expr_stmt|;
block|}
name|int
name|CRYPTO_gcm128_aad
parameter_list|(
name|GCM128_CONTEXT
modifier|*
name|ctx
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|aad
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
name|size_t
name|i
decl_stmt|;
name|unsigned
name|int
name|n
decl_stmt|;
name|u64
name|alen
init|=
name|ctx
operator|->
name|len
operator|.
name|u
index|[
literal|0
index|]
decl_stmt|;
ifdef|#
directive|ifdef
name|GCM_FUNCREF_4BIT
name|void
function_decl|(
modifier|*
name|gcm_gmult_p
function_decl|)
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|)
init|=
name|ctx
operator|->
name|gmult
function_decl|;
ifdef|#
directive|ifdef
name|GHASH
name|void
function_decl|(
modifier|*
name|gcm_ghash_p
function_decl|)
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u8
modifier|*
name|inp
parameter_list|,
name|size_t
name|len
parameter_list|)
init|=
name|ctx
operator|->
name|ghash
function_decl|;
endif|#
directive|endif
endif|#
directive|endif
if|if
condition|(
name|ctx
operator|->
name|len
operator|.
name|u
index|[
literal|1
index|]
condition|)
return|return
operator|-
literal|2
return|;
name|alen
operator|+=
name|len
expr_stmt|;
if|if
condition|(
name|alen
operator|>
operator|(
name|U64
argument_list|(
literal|1
argument_list|)
operator|<<
literal|61
operator|)
operator|||
operator|(
sizeof|sizeof
argument_list|(
name|len
argument_list|)
operator|==
literal|8
operator|&&
name|alen
operator|<
name|len
operator|)
condition|)
return|return
operator|-
literal|1
return|;
name|ctx
operator|->
name|len
operator|.
name|u
index|[
literal|0
index|]
operator|=
name|alen
expr_stmt|;
name|n
operator|=
name|ctx
operator|->
name|ares
expr_stmt|;
if|if
condition|(
name|n
condition|)
block|{
while|while
condition|(
name|n
operator|&&
name|len
condition|)
block|{
name|ctx
operator|->
name|Xi
operator|.
name|c
index|[
name|n
index|]
operator|^=
operator|*
operator|(
name|aad
operator|++
operator|)
expr_stmt|;
operator|--
name|len
expr_stmt|;
name|n
operator|=
operator|(
name|n
operator|+
literal|1
operator|)
operator|%
literal|16
expr_stmt|;
block|}
if|if
condition|(
name|n
operator|==
literal|0
condition|)
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
else|else
block|{
name|ctx
operator|->
name|ares
operator|=
name|n
expr_stmt|;
return|return
literal|0
return|;
block|}
block|}
ifdef|#
directive|ifdef
name|GHASH
if|if
condition|(
operator|(
name|i
operator|=
operator|(
name|len
operator|&
operator|(
name|size_t
operator|)
operator|-
literal|16
operator|)
operator|)
condition|)
block|{
name|GHASH
argument_list|(
name|ctx
argument_list|,
name|aad
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|aad
operator|+=
name|i
expr_stmt|;
name|len
operator|-=
name|i
expr_stmt|;
block|}
else|#
directive|else
while|while
condition|(
name|len
operator|>=
literal|16
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|16
condition|;
operator|++
name|i
control|)
name|ctx
operator|->
name|Xi
operator|.
name|c
index|[
name|i
index|]
operator|^=
name|aad
index|[
name|i
index|]
expr_stmt|;
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
name|aad
operator|+=
literal|16
expr_stmt|;
name|len
operator|-=
literal|16
expr_stmt|;
block|}
endif|#
directive|endif
if|if
condition|(
name|len
condition|)
block|{
name|n
operator|=
operator|(
name|unsigned
name|int
operator|)
name|len
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
operator|++
name|i
control|)
name|ctx
operator|->
name|Xi
operator|.
name|c
index|[
name|i
index|]
operator|^=
name|aad
index|[
name|i
index|]
expr_stmt|;
block|}
name|ctx
operator|->
name|ares
operator|=
name|n
expr_stmt|;
return|return
literal|0
return|;
block|}
name|int
name|CRYPTO_gcm128_encrypt
parameter_list|(
name|GCM128_CONTEXT
modifier|*
name|ctx
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|in
parameter_list|,
name|unsigned
name|char
modifier|*
name|out
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
specifier|const
union|union
block|{
name|long
name|one
decl_stmt|;
name|char
name|little
decl_stmt|;
block|}
name|is_endian
init|=
block|{
literal|1
block|}
union|;
name|unsigned
name|int
name|n
decl_stmt|,
name|ctr
decl_stmt|;
name|size_t
name|i
decl_stmt|;
name|u64
name|mlen
init|=
name|ctx
operator|->
name|len
operator|.
name|u
index|[
literal|1
index|]
decl_stmt|;
name|block128_f
name|block
init|=
name|ctx
operator|->
name|block
decl_stmt|;
name|void
modifier|*
name|key
init|=
name|ctx
operator|->
name|key
decl_stmt|;
ifdef|#
directive|ifdef
name|GCM_FUNCREF_4BIT
name|void
function_decl|(
modifier|*
name|gcm_gmult_p
function_decl|)
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|)
init|=
name|ctx
operator|->
name|gmult
function_decl|;
ifdef|#
directive|ifdef
name|GHASH
name|void
function_decl|(
modifier|*
name|gcm_ghash_p
function_decl|)
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u8
modifier|*
name|inp
parameter_list|,
name|size_t
name|len
parameter_list|)
init|=
name|ctx
operator|->
name|ghash
function_decl|;
endif|#
directive|endif
endif|#
directive|endif
if|#
directive|if
literal|0
block|n = (unsigned int)mlen % 16;
comment|/* alternative to ctx->mres */
endif|#
directive|endif
name|mlen
operator|+=
name|len
expr_stmt|;
if|if
condition|(
name|mlen
operator|>
operator|(
operator|(
name|U64
argument_list|(
literal|1
argument_list|)
operator|<<
literal|36
operator|)
operator|-
literal|32
operator|)
operator|||
operator|(
sizeof|sizeof
argument_list|(
name|len
argument_list|)
operator|==
literal|8
operator|&&
name|mlen
operator|<
name|len
operator|)
condition|)
return|return
operator|-
literal|1
return|;
name|ctx
operator|->
name|len
operator|.
name|u
index|[
literal|1
index|]
operator|=
name|mlen
expr_stmt|;
if|if
condition|(
name|ctx
operator|->
name|ares
condition|)
block|{
comment|/* First call to encrypt finalizes GHASH(AAD) */
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|ares
operator|=
literal|0
expr_stmt|;
block|}
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctr
operator|=
name|BSWAP4
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
else|#
directive|else
name|ctr
operator|=
name|GETU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctr
operator|=
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
expr_stmt|;
name|n
operator|=
name|ctx
operator|->
name|mres
expr_stmt|;
if|#
directive|if
operator|!
name|defined
argument_list|(
name|OPENSSL_SMALL_FOOTPRINT
argument_list|)
if|if
condition|(
literal|16
operator|%
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
operator|==
literal|0
condition|)
block|{
comment|/* always true actually */
do|do
block|{
if|if
condition|(
name|n
condition|)
block|{
while|while
condition|(
name|n
operator|&&
name|len
condition|)
block|{
name|ctx
operator|->
name|Xi
operator|.
name|c
index|[
name|n
index|]
operator|^=
operator|*
operator|(
name|out
operator|++
operator|)
operator|=
operator|*
operator|(
name|in
operator|++
operator|)
operator|^
name|ctx
operator|->
name|EKi
operator|.
name|c
index|[
name|n
index|]
expr_stmt|;
operator|--
name|len
expr_stmt|;
name|n
operator|=
operator|(
name|n
operator|+
literal|1
operator|)
operator|%
literal|16
expr_stmt|;
block|}
if|if
condition|(
name|n
operator|==
literal|0
condition|)
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
else|else
block|{
name|ctx
operator|->
name|mres
operator|=
name|n
expr_stmt|;
return|return
literal|0
return|;
block|}
block|}
if|#
directive|if
name|defined
argument_list|(
name|STRICT_ALIGNMENT
argument_list|)
if|if
condition|(
operator|(
operator|(
name|size_t
operator|)
name|in
operator||
operator|(
name|size_t
operator|)
name|out
operator|)
operator|%
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
operator|!=
literal|0
condition|)
break|break;
endif|#
directive|endif
if|#
directive|if
name|defined
argument_list|(
name|GHASH
argument_list|)
operator|&&
name|defined
argument_list|(
name|GHASH_CHUNK
argument_list|)
while|while
condition|(
name|len
operator|>=
name|GHASH_CHUNK
condition|)
block|{
name|size_t
name|j
init|=
name|GHASH_CHUNK
decl_stmt|;
while|while
condition|(
name|j
condition|)
block|{
name|size_t
modifier|*
name|out_t
init|=
operator|(
name|size_t
operator|*
operator|)
name|out
decl_stmt|;
specifier|const
name|size_t
modifier|*
name|in_t
init|=
operator|(
specifier|const
name|size_t
operator|*
operator|)
name|in
decl_stmt|;
call|(
modifier|*
name|block
call|)
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|,
name|ctx
operator|->
name|EKi
operator|.
name|c
argument_list|,
name|key
argument_list|)
expr_stmt|;
operator|++
name|ctr
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|BSWAP4
argument_list|(
name|ctr
argument_list|)
expr_stmt|;
else|#
directive|else
name|PUTU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|,
name|ctr
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|ctr
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|16
operator|/
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
condition|;
operator|++
name|i
control|)
name|out_t
index|[
name|i
index|]
operator|=
name|in_t
index|[
name|i
index|]
operator|^
name|ctx
operator|->
name|EKi
operator|.
name|t
index|[
name|i
index|]
expr_stmt|;
name|out
operator|+=
literal|16
expr_stmt|;
name|in
operator|+=
literal|16
expr_stmt|;
name|j
operator|-=
literal|16
expr_stmt|;
block|}
name|GHASH
argument_list|(
name|ctx
argument_list|,
name|out
operator|-
name|GHASH_CHUNK
argument_list|,
name|GHASH_CHUNK
argument_list|)
expr_stmt|;
name|len
operator|-=
name|GHASH_CHUNK
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|i
operator|=
operator|(
name|len
operator|&
operator|(
name|size_t
operator|)
operator|-
literal|16
operator|)
operator|)
condition|)
block|{
name|size_t
name|j
init|=
name|i
decl_stmt|;
while|while
condition|(
name|len
operator|>=
literal|16
condition|)
block|{
name|size_t
modifier|*
name|out_t
init|=
operator|(
name|size_t
operator|*
operator|)
name|out
decl_stmt|;
specifier|const
name|size_t
modifier|*
name|in_t
init|=
operator|(
specifier|const
name|size_t
operator|*
operator|)
name|in
decl_stmt|;
call|(
modifier|*
name|block
call|)
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|,
name|ctx
operator|->
name|EKi
operator|.
name|c
argument_list|,
name|key
argument_list|)
expr_stmt|;
operator|++
name|ctr
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|BSWAP4
argument_list|(
name|ctr
argument_list|)
expr_stmt|;
else|#
directive|else
name|PUTU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|,
name|ctr
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|ctr
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|16
operator|/
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
condition|;
operator|++
name|i
control|)
name|out_t
index|[
name|i
index|]
operator|=
name|in_t
index|[
name|i
index|]
operator|^
name|ctx
operator|->
name|EKi
operator|.
name|t
index|[
name|i
index|]
expr_stmt|;
name|out
operator|+=
literal|16
expr_stmt|;
name|in
operator|+=
literal|16
expr_stmt|;
name|len
operator|-=
literal|16
expr_stmt|;
block|}
name|GHASH
argument_list|(
name|ctx
argument_list|,
name|out
operator|-
name|j
argument_list|,
name|j
argument_list|)
expr_stmt|;
block|}
else|#
directive|else
while|while
condition|(
name|len
operator|>=
literal|16
condition|)
block|{
name|size_t
modifier|*
name|out_t
init|=
operator|(
name|size_t
operator|*
operator|)
name|out
decl_stmt|;
specifier|const
name|size_t
modifier|*
name|in_t
init|=
operator|(
specifier|const
name|size_t
operator|*
operator|)
name|in
decl_stmt|;
call|(
modifier|*
name|block
call|)
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|,
name|ctx
operator|->
name|EKi
operator|.
name|c
argument_list|,
name|key
argument_list|)
expr_stmt|;
operator|++
name|ctr
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|BSWAP4
argument_list|(
name|ctr
argument_list|)
expr_stmt|;
else|#
directive|else
name|PUTU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|,
name|ctr
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|ctr
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|16
operator|/
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
condition|;
operator|++
name|i
control|)
name|ctx
operator|->
name|Xi
operator|.
name|t
index|[
name|i
index|]
operator|^=
name|out_t
index|[
name|i
index|]
operator|=
name|in_t
index|[
name|i
index|]
operator|^
name|ctx
operator|->
name|EKi
operator|.
name|t
index|[
name|i
index|]
expr_stmt|;
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
name|out
operator|+=
literal|16
expr_stmt|;
name|in
operator|+=
literal|16
expr_stmt|;
name|len
operator|-=
literal|16
expr_stmt|;
block|}
endif|#
directive|endif
if|if
condition|(
name|len
condition|)
block|{
call|(
modifier|*
name|block
call|)
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|,
name|ctx
operator|->
name|EKi
operator|.
name|c
argument_list|,
name|key
argument_list|)
expr_stmt|;
operator|++
name|ctr
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|BSWAP4
argument_list|(
name|ctr
argument_list|)
expr_stmt|;
else|#
directive|else
name|PUTU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|,
name|ctr
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|ctr
expr_stmt|;
while|while
condition|(
name|len
operator|--
condition|)
block|{
name|ctx
operator|->
name|Xi
operator|.
name|c
index|[
name|n
index|]
operator|^=
name|out
index|[
name|n
index|]
operator|=
name|in
index|[
name|n
index|]
operator|^
name|ctx
operator|->
name|EKi
operator|.
name|c
index|[
name|n
index|]
expr_stmt|;
operator|++
name|n
expr_stmt|;
block|}
block|}
name|ctx
operator|->
name|mres
operator|=
name|n
expr_stmt|;
return|return
literal|0
return|;
block|}
do|while
condition|(
literal|0
condition|)
do|;
block|}
endif|#
directive|endif
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
operator|++
name|i
control|)
block|{
if|if
condition|(
name|n
operator|==
literal|0
condition|)
block|{
call|(
modifier|*
name|block
call|)
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|,
name|ctx
operator|->
name|EKi
operator|.
name|c
argument_list|,
name|key
argument_list|)
expr_stmt|;
operator|++
name|ctr
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|BSWAP4
argument_list|(
name|ctr
argument_list|)
expr_stmt|;
else|#
directive|else
name|PUTU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|,
name|ctr
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|ctr
expr_stmt|;
block|}
name|ctx
operator|->
name|Xi
operator|.
name|c
index|[
name|n
index|]
operator|^=
name|out
index|[
name|i
index|]
operator|=
name|in
index|[
name|i
index|]
operator|^
name|ctx
operator|->
name|EKi
operator|.
name|c
index|[
name|n
index|]
expr_stmt|;
name|n
operator|=
operator|(
name|n
operator|+
literal|1
operator|)
operator|%
literal|16
expr_stmt|;
if|if
condition|(
name|n
operator|==
literal|0
condition|)
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
block|}
name|ctx
operator|->
name|mres
operator|=
name|n
expr_stmt|;
return|return
literal|0
return|;
block|}
name|int
name|CRYPTO_gcm128_decrypt
parameter_list|(
name|GCM128_CONTEXT
modifier|*
name|ctx
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|in
parameter_list|,
name|unsigned
name|char
modifier|*
name|out
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
specifier|const
union|union
block|{
name|long
name|one
decl_stmt|;
name|char
name|little
decl_stmt|;
block|}
name|is_endian
init|=
block|{
literal|1
block|}
union|;
name|unsigned
name|int
name|n
decl_stmt|,
name|ctr
decl_stmt|;
name|size_t
name|i
decl_stmt|;
name|u64
name|mlen
init|=
name|ctx
operator|->
name|len
operator|.
name|u
index|[
literal|1
index|]
decl_stmt|;
name|block128_f
name|block
init|=
name|ctx
operator|->
name|block
decl_stmt|;
name|void
modifier|*
name|key
init|=
name|ctx
operator|->
name|key
decl_stmt|;
ifdef|#
directive|ifdef
name|GCM_FUNCREF_4BIT
name|void
function_decl|(
modifier|*
name|gcm_gmult_p
function_decl|)
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|)
init|=
name|ctx
operator|->
name|gmult
function_decl|;
ifdef|#
directive|ifdef
name|GHASH
name|void
function_decl|(
modifier|*
name|gcm_ghash_p
function_decl|)
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u8
modifier|*
name|inp
parameter_list|,
name|size_t
name|len
parameter_list|)
init|=
name|ctx
operator|->
name|ghash
function_decl|;
endif|#
directive|endif
endif|#
directive|endif
name|mlen
operator|+=
name|len
expr_stmt|;
if|if
condition|(
name|mlen
operator|>
operator|(
operator|(
name|U64
argument_list|(
literal|1
argument_list|)
operator|<<
literal|36
operator|)
operator|-
literal|32
operator|)
operator|||
operator|(
sizeof|sizeof
argument_list|(
name|len
argument_list|)
operator|==
literal|8
operator|&&
name|mlen
operator|<
name|len
operator|)
condition|)
return|return
operator|-
literal|1
return|;
name|ctx
operator|->
name|len
operator|.
name|u
index|[
literal|1
index|]
operator|=
name|mlen
expr_stmt|;
if|if
condition|(
name|ctx
operator|->
name|ares
condition|)
block|{
comment|/* First call to decrypt finalizes GHASH(AAD) */
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|ares
operator|=
literal|0
expr_stmt|;
block|}
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctr
operator|=
name|BSWAP4
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
else|#
directive|else
name|ctr
operator|=
name|GETU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctr
operator|=
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
expr_stmt|;
name|n
operator|=
name|ctx
operator|->
name|mres
expr_stmt|;
if|#
directive|if
operator|!
name|defined
argument_list|(
name|OPENSSL_SMALL_FOOTPRINT
argument_list|)
if|if
condition|(
literal|16
operator|%
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
operator|==
literal|0
condition|)
block|{
comment|/* always true actually */
do|do
block|{
if|if
condition|(
name|n
condition|)
block|{
while|while
condition|(
name|n
operator|&&
name|len
condition|)
block|{
name|u8
name|c
init|=
operator|*
operator|(
name|in
operator|++
operator|)
decl_stmt|;
operator|*
operator|(
name|out
operator|++
operator|)
operator|=
name|c
operator|^
name|ctx
operator|->
name|EKi
operator|.
name|c
index|[
name|n
index|]
expr_stmt|;
name|ctx
operator|->
name|Xi
operator|.
name|c
index|[
name|n
index|]
operator|^=
name|c
expr_stmt|;
operator|--
name|len
expr_stmt|;
name|n
operator|=
operator|(
name|n
operator|+
literal|1
operator|)
operator|%
literal|16
expr_stmt|;
block|}
if|if
condition|(
name|n
operator|==
literal|0
condition|)
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
else|else
block|{
name|ctx
operator|->
name|mres
operator|=
name|n
expr_stmt|;
return|return
literal|0
return|;
block|}
block|}
if|#
directive|if
name|defined
argument_list|(
name|STRICT_ALIGNMENT
argument_list|)
if|if
condition|(
operator|(
operator|(
name|size_t
operator|)
name|in
operator||
operator|(
name|size_t
operator|)
name|out
operator|)
operator|%
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
operator|!=
literal|0
condition|)
break|break;
endif|#
directive|endif
if|#
directive|if
name|defined
argument_list|(
name|GHASH
argument_list|)
operator|&&
name|defined
argument_list|(
name|GHASH_CHUNK
argument_list|)
while|while
condition|(
name|len
operator|>=
name|GHASH_CHUNK
condition|)
block|{
name|size_t
name|j
init|=
name|GHASH_CHUNK
decl_stmt|;
name|GHASH
argument_list|(
name|ctx
argument_list|,
name|in
argument_list|,
name|GHASH_CHUNK
argument_list|)
expr_stmt|;
while|while
condition|(
name|j
condition|)
block|{
name|size_t
modifier|*
name|out_t
init|=
operator|(
name|size_t
operator|*
operator|)
name|out
decl_stmt|;
specifier|const
name|size_t
modifier|*
name|in_t
init|=
operator|(
specifier|const
name|size_t
operator|*
operator|)
name|in
decl_stmt|;
call|(
modifier|*
name|block
call|)
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|,
name|ctx
operator|->
name|EKi
operator|.
name|c
argument_list|,
name|key
argument_list|)
expr_stmt|;
operator|++
name|ctr
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|BSWAP4
argument_list|(
name|ctr
argument_list|)
expr_stmt|;
else|#
directive|else
name|PUTU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|,
name|ctr
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|ctr
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|16
operator|/
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
condition|;
operator|++
name|i
control|)
name|out_t
index|[
name|i
index|]
operator|=
name|in_t
index|[
name|i
index|]
operator|^
name|ctx
operator|->
name|EKi
operator|.
name|t
index|[
name|i
index|]
expr_stmt|;
name|out
operator|+=
literal|16
expr_stmt|;
name|in
operator|+=
literal|16
expr_stmt|;
name|j
operator|-=
literal|16
expr_stmt|;
block|}
name|len
operator|-=
name|GHASH_CHUNK
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|i
operator|=
operator|(
name|len
operator|&
operator|(
name|size_t
operator|)
operator|-
literal|16
operator|)
operator|)
condition|)
block|{
name|GHASH
argument_list|(
name|ctx
argument_list|,
name|in
argument_list|,
name|i
argument_list|)
expr_stmt|;
while|while
condition|(
name|len
operator|>=
literal|16
condition|)
block|{
name|size_t
modifier|*
name|out_t
init|=
operator|(
name|size_t
operator|*
operator|)
name|out
decl_stmt|;
specifier|const
name|size_t
modifier|*
name|in_t
init|=
operator|(
specifier|const
name|size_t
operator|*
operator|)
name|in
decl_stmt|;
call|(
modifier|*
name|block
call|)
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|,
name|ctx
operator|->
name|EKi
operator|.
name|c
argument_list|,
name|key
argument_list|)
expr_stmt|;
operator|++
name|ctr
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|BSWAP4
argument_list|(
name|ctr
argument_list|)
expr_stmt|;
else|#
directive|else
name|PUTU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|,
name|ctr
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|ctr
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|16
operator|/
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
condition|;
operator|++
name|i
control|)
name|out_t
index|[
name|i
index|]
operator|=
name|in_t
index|[
name|i
index|]
operator|^
name|ctx
operator|->
name|EKi
operator|.
name|t
index|[
name|i
index|]
expr_stmt|;
name|out
operator|+=
literal|16
expr_stmt|;
name|in
operator|+=
literal|16
expr_stmt|;
name|len
operator|-=
literal|16
expr_stmt|;
block|}
block|}
else|#
directive|else
while|while
condition|(
name|len
operator|>=
literal|16
condition|)
block|{
name|size_t
modifier|*
name|out_t
init|=
operator|(
name|size_t
operator|*
operator|)
name|out
decl_stmt|;
specifier|const
name|size_t
modifier|*
name|in_t
init|=
operator|(
specifier|const
name|size_t
operator|*
operator|)
name|in
decl_stmt|;
call|(
modifier|*
name|block
call|)
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|,
name|ctx
operator|->
name|EKi
operator|.
name|c
argument_list|,
name|key
argument_list|)
expr_stmt|;
operator|++
name|ctr
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|BSWAP4
argument_list|(
name|ctr
argument_list|)
expr_stmt|;
else|#
directive|else
name|PUTU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|,
name|ctr
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|ctr
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|16
operator|/
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
condition|;
operator|++
name|i
control|)
block|{
name|size_t
name|c
init|=
name|in
index|[
name|i
index|]
decl_stmt|;
name|out
index|[
name|i
index|]
operator|=
name|c
operator|^
name|ctx
operator|->
name|EKi
operator|.
name|t
index|[
name|i
index|]
expr_stmt|;
name|ctx
operator|->
name|Xi
operator|.
name|t
index|[
name|i
index|]
operator|^=
name|c
expr_stmt|;
block|}
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
name|out
operator|+=
literal|16
expr_stmt|;
name|in
operator|+=
literal|16
expr_stmt|;
name|len
operator|-=
literal|16
expr_stmt|;
block|}
endif|#
directive|endif
if|if
condition|(
name|len
condition|)
block|{
call|(
modifier|*
name|block
call|)
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|,
name|ctx
operator|->
name|EKi
operator|.
name|c
argument_list|,
name|key
argument_list|)
expr_stmt|;
operator|++
name|ctr
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|BSWAP4
argument_list|(
name|ctr
argument_list|)
expr_stmt|;
else|#
directive|else
name|PUTU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|,
name|ctr
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|ctr
expr_stmt|;
while|while
condition|(
name|len
operator|--
condition|)
block|{
name|u8
name|c
init|=
name|in
index|[
name|n
index|]
decl_stmt|;
name|ctx
operator|->
name|Xi
operator|.
name|c
index|[
name|n
index|]
operator|^=
name|c
expr_stmt|;
name|out
index|[
name|n
index|]
operator|=
name|c
operator|^
name|ctx
operator|->
name|EKi
operator|.
name|c
index|[
name|n
index|]
expr_stmt|;
operator|++
name|n
expr_stmt|;
block|}
block|}
name|ctx
operator|->
name|mres
operator|=
name|n
expr_stmt|;
return|return
literal|0
return|;
block|}
do|while
condition|(
literal|0
condition|)
do|;
block|}
endif|#
directive|endif
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
operator|++
name|i
control|)
block|{
name|u8
name|c
decl_stmt|;
if|if
condition|(
name|n
operator|==
literal|0
condition|)
block|{
call|(
modifier|*
name|block
call|)
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|,
name|ctx
operator|->
name|EKi
operator|.
name|c
argument_list|,
name|key
argument_list|)
expr_stmt|;
operator|++
name|ctr
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|BSWAP4
argument_list|(
name|ctr
argument_list|)
expr_stmt|;
else|#
directive|else
name|PUTU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|,
name|ctr
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|ctr
expr_stmt|;
block|}
name|c
operator|=
name|in
index|[
name|i
index|]
expr_stmt|;
name|out
index|[
name|i
index|]
operator|=
name|c
operator|^
name|ctx
operator|->
name|EKi
operator|.
name|c
index|[
name|n
index|]
expr_stmt|;
name|ctx
operator|->
name|Xi
operator|.
name|c
index|[
name|n
index|]
operator|^=
name|c
expr_stmt|;
name|n
operator|=
operator|(
name|n
operator|+
literal|1
operator|)
operator|%
literal|16
expr_stmt|;
if|if
condition|(
name|n
operator|==
literal|0
condition|)
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
block|}
name|ctx
operator|->
name|mres
operator|=
name|n
expr_stmt|;
return|return
literal|0
return|;
block|}
name|int
name|CRYPTO_gcm128_encrypt_ctr32
parameter_list|(
name|GCM128_CONTEXT
modifier|*
name|ctx
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|in
parameter_list|,
name|unsigned
name|char
modifier|*
name|out
parameter_list|,
name|size_t
name|len
parameter_list|,
name|ctr128_f
name|stream
parameter_list|)
block|{
specifier|const
union|union
block|{
name|long
name|one
decl_stmt|;
name|char
name|little
decl_stmt|;
block|}
name|is_endian
init|=
block|{
literal|1
block|}
union|;
name|unsigned
name|int
name|n
decl_stmt|,
name|ctr
decl_stmt|;
name|size_t
name|i
decl_stmt|;
name|u64
name|mlen
init|=
name|ctx
operator|->
name|len
operator|.
name|u
index|[
literal|1
index|]
decl_stmt|;
name|void
modifier|*
name|key
init|=
name|ctx
operator|->
name|key
decl_stmt|;
ifdef|#
directive|ifdef
name|GCM_FUNCREF_4BIT
name|void
function_decl|(
modifier|*
name|gcm_gmult_p
function_decl|)
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|)
init|=
name|ctx
operator|->
name|gmult
function_decl|;
ifdef|#
directive|ifdef
name|GHASH
name|void
function_decl|(
modifier|*
name|gcm_ghash_p
function_decl|)
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u8
modifier|*
name|inp
parameter_list|,
name|size_t
name|len
parameter_list|)
init|=
name|ctx
operator|->
name|ghash
function_decl|;
endif|#
directive|endif
endif|#
directive|endif
name|mlen
operator|+=
name|len
expr_stmt|;
if|if
condition|(
name|mlen
operator|>
operator|(
operator|(
name|U64
argument_list|(
literal|1
argument_list|)
operator|<<
literal|36
operator|)
operator|-
literal|32
operator|)
operator|||
operator|(
sizeof|sizeof
argument_list|(
name|len
argument_list|)
operator|==
literal|8
operator|&&
name|mlen
operator|<
name|len
operator|)
condition|)
return|return
operator|-
literal|1
return|;
name|ctx
operator|->
name|len
operator|.
name|u
index|[
literal|1
index|]
operator|=
name|mlen
expr_stmt|;
if|if
condition|(
name|ctx
operator|->
name|ares
condition|)
block|{
comment|/* First call to encrypt finalizes GHASH(AAD) */
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|ares
operator|=
literal|0
expr_stmt|;
block|}
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctr
operator|=
name|BSWAP4
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
else|#
directive|else
name|ctr
operator|=
name|GETU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctr
operator|=
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
expr_stmt|;
name|n
operator|=
name|ctx
operator|->
name|mres
expr_stmt|;
if|if
condition|(
name|n
condition|)
block|{
while|while
condition|(
name|n
operator|&&
name|len
condition|)
block|{
name|ctx
operator|->
name|Xi
operator|.
name|c
index|[
name|n
index|]
operator|^=
operator|*
operator|(
name|out
operator|++
operator|)
operator|=
operator|*
operator|(
name|in
operator|++
operator|)
operator|^
name|ctx
operator|->
name|EKi
operator|.
name|c
index|[
name|n
index|]
expr_stmt|;
operator|--
name|len
expr_stmt|;
name|n
operator|=
operator|(
name|n
operator|+
literal|1
operator|)
operator|%
literal|16
expr_stmt|;
block|}
if|if
condition|(
name|n
operator|==
literal|0
condition|)
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
else|else
block|{
name|ctx
operator|->
name|mres
operator|=
name|n
expr_stmt|;
return|return
literal|0
return|;
block|}
block|}
if|#
directive|if
name|defined
argument_list|(
name|GHASH
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|OPENSSL_SMALL_FOOTPRINT
argument_list|)
while|while
condition|(
name|len
operator|>=
name|GHASH_CHUNK
condition|)
block|{
call|(
modifier|*
name|stream
call|)
argument_list|(
name|in
argument_list|,
name|out
argument_list|,
name|GHASH_CHUNK
operator|/
literal|16
argument_list|,
name|key
argument_list|,
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|)
expr_stmt|;
name|ctr
operator|+=
name|GHASH_CHUNK
operator|/
literal|16
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|BSWAP4
argument_list|(
name|ctr
argument_list|)
expr_stmt|;
else|#
directive|else
name|PUTU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|,
name|ctr
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|ctr
expr_stmt|;
name|GHASH
argument_list|(
name|ctx
argument_list|,
name|out
argument_list|,
name|GHASH_CHUNK
argument_list|)
expr_stmt|;
name|out
operator|+=
name|GHASH_CHUNK
expr_stmt|;
name|in
operator|+=
name|GHASH_CHUNK
expr_stmt|;
name|len
operator|-=
name|GHASH_CHUNK
expr_stmt|;
block|}
endif|#
directive|endif
if|if
condition|(
operator|(
name|i
operator|=
operator|(
name|len
operator|&
operator|(
name|size_t
operator|)
operator|-
literal|16
operator|)
operator|)
condition|)
block|{
name|size_t
name|j
init|=
name|i
operator|/
literal|16
decl_stmt|;
call|(
modifier|*
name|stream
call|)
argument_list|(
name|in
argument_list|,
name|out
argument_list|,
name|j
argument_list|,
name|key
argument_list|,
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|)
expr_stmt|;
name|ctr
operator|+=
operator|(
name|unsigned
name|int
operator|)
name|j
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|BSWAP4
argument_list|(
name|ctr
argument_list|)
expr_stmt|;
else|#
directive|else
name|PUTU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|,
name|ctr
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|ctr
expr_stmt|;
name|in
operator|+=
name|i
expr_stmt|;
name|len
operator|-=
name|i
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|GHASH
argument_list|)
name|GHASH
argument_list|(
name|ctx
argument_list|,
name|out
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|out
operator|+=
name|i
expr_stmt|;
else|#
directive|else
while|while
condition|(
name|j
operator|--
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|16
condition|;
operator|++
name|i
control|)
name|ctx
operator|->
name|Xi
operator|.
name|c
index|[
name|i
index|]
operator|^=
name|out
index|[
name|i
index|]
expr_stmt|;
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
name|out
operator|+=
literal|16
expr_stmt|;
block|}
endif|#
directive|endif
block|}
if|if
condition|(
name|len
condition|)
block|{
call|(
modifier|*
name|ctx
operator|->
name|block
call|)
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|,
name|ctx
operator|->
name|EKi
operator|.
name|c
argument_list|,
name|key
argument_list|)
expr_stmt|;
operator|++
name|ctr
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|BSWAP4
argument_list|(
name|ctr
argument_list|)
expr_stmt|;
else|#
directive|else
name|PUTU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|,
name|ctr
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|ctr
expr_stmt|;
while|while
condition|(
name|len
operator|--
condition|)
block|{
name|ctx
operator|->
name|Xi
operator|.
name|c
index|[
name|n
index|]
operator|^=
name|out
index|[
name|n
index|]
operator|=
name|in
index|[
name|n
index|]
operator|^
name|ctx
operator|->
name|EKi
operator|.
name|c
index|[
name|n
index|]
expr_stmt|;
operator|++
name|n
expr_stmt|;
block|}
block|}
name|ctx
operator|->
name|mres
operator|=
name|n
expr_stmt|;
return|return
literal|0
return|;
block|}
name|int
name|CRYPTO_gcm128_decrypt_ctr32
parameter_list|(
name|GCM128_CONTEXT
modifier|*
name|ctx
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|in
parameter_list|,
name|unsigned
name|char
modifier|*
name|out
parameter_list|,
name|size_t
name|len
parameter_list|,
name|ctr128_f
name|stream
parameter_list|)
block|{
specifier|const
union|union
block|{
name|long
name|one
decl_stmt|;
name|char
name|little
decl_stmt|;
block|}
name|is_endian
init|=
block|{
literal|1
block|}
union|;
name|unsigned
name|int
name|n
decl_stmt|,
name|ctr
decl_stmt|;
name|size_t
name|i
decl_stmt|;
name|u64
name|mlen
init|=
name|ctx
operator|->
name|len
operator|.
name|u
index|[
literal|1
index|]
decl_stmt|;
name|void
modifier|*
name|key
init|=
name|ctx
operator|->
name|key
decl_stmt|;
ifdef|#
directive|ifdef
name|GCM_FUNCREF_4BIT
name|void
function_decl|(
modifier|*
name|gcm_gmult_p
function_decl|)
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|)
init|=
name|ctx
operator|->
name|gmult
function_decl|;
ifdef|#
directive|ifdef
name|GHASH
name|void
function_decl|(
modifier|*
name|gcm_ghash_p
function_decl|)
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u8
modifier|*
name|inp
parameter_list|,
name|size_t
name|len
parameter_list|)
init|=
name|ctx
operator|->
name|ghash
function_decl|;
endif|#
directive|endif
endif|#
directive|endif
name|mlen
operator|+=
name|len
expr_stmt|;
if|if
condition|(
name|mlen
operator|>
operator|(
operator|(
name|U64
argument_list|(
literal|1
argument_list|)
operator|<<
literal|36
operator|)
operator|-
literal|32
operator|)
operator|||
operator|(
sizeof|sizeof
argument_list|(
name|len
argument_list|)
operator|==
literal|8
operator|&&
name|mlen
operator|<
name|len
operator|)
condition|)
return|return
operator|-
literal|1
return|;
name|ctx
operator|->
name|len
operator|.
name|u
index|[
literal|1
index|]
operator|=
name|mlen
expr_stmt|;
if|if
condition|(
name|ctx
operator|->
name|ares
condition|)
block|{
comment|/* First call to decrypt finalizes GHASH(AAD) */
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|ares
operator|=
literal|0
expr_stmt|;
block|}
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctr
operator|=
name|BSWAP4
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
else|#
directive|else
name|ctr
operator|=
name|GETU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctr
operator|=
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
expr_stmt|;
name|n
operator|=
name|ctx
operator|->
name|mres
expr_stmt|;
if|if
condition|(
name|n
condition|)
block|{
while|while
condition|(
name|n
operator|&&
name|len
condition|)
block|{
name|u8
name|c
init|=
operator|*
operator|(
name|in
operator|++
operator|)
decl_stmt|;
operator|*
operator|(
name|out
operator|++
operator|)
operator|=
name|c
operator|^
name|ctx
operator|->
name|EKi
operator|.
name|c
index|[
name|n
index|]
expr_stmt|;
name|ctx
operator|->
name|Xi
operator|.
name|c
index|[
name|n
index|]
operator|^=
name|c
expr_stmt|;
operator|--
name|len
expr_stmt|;
name|n
operator|=
operator|(
name|n
operator|+
literal|1
operator|)
operator|%
literal|16
expr_stmt|;
block|}
if|if
condition|(
name|n
operator|==
literal|0
condition|)
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
else|else
block|{
name|ctx
operator|->
name|mres
operator|=
name|n
expr_stmt|;
return|return
literal|0
return|;
block|}
block|}
if|#
directive|if
name|defined
argument_list|(
name|GHASH
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|OPENSSL_SMALL_FOOTPRINT
argument_list|)
while|while
condition|(
name|len
operator|>=
name|GHASH_CHUNK
condition|)
block|{
name|GHASH
argument_list|(
name|ctx
argument_list|,
name|in
argument_list|,
name|GHASH_CHUNK
argument_list|)
expr_stmt|;
call|(
modifier|*
name|stream
call|)
argument_list|(
name|in
argument_list|,
name|out
argument_list|,
name|GHASH_CHUNK
operator|/
literal|16
argument_list|,
name|key
argument_list|,
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|)
expr_stmt|;
name|ctr
operator|+=
name|GHASH_CHUNK
operator|/
literal|16
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|BSWAP4
argument_list|(
name|ctr
argument_list|)
expr_stmt|;
else|#
directive|else
name|PUTU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|,
name|ctr
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|ctr
expr_stmt|;
name|out
operator|+=
name|GHASH_CHUNK
expr_stmt|;
name|in
operator|+=
name|GHASH_CHUNK
expr_stmt|;
name|len
operator|-=
name|GHASH_CHUNK
expr_stmt|;
block|}
endif|#
directive|endif
if|if
condition|(
operator|(
name|i
operator|=
operator|(
name|len
operator|&
operator|(
name|size_t
operator|)
operator|-
literal|16
operator|)
operator|)
condition|)
block|{
name|size_t
name|j
init|=
name|i
operator|/
literal|16
decl_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|GHASH
argument_list|)
name|GHASH
argument_list|(
name|ctx
argument_list|,
name|in
argument_list|,
name|i
argument_list|)
expr_stmt|;
else|#
directive|else
while|while
condition|(
name|j
operator|--
condition|)
block|{
name|size_t
name|k
decl_stmt|;
for|for
control|(
name|k
operator|=
literal|0
init|;
name|k
operator|<
literal|16
condition|;
operator|++
name|k
control|)
name|ctx
operator|->
name|Xi
operator|.
name|c
index|[
name|k
index|]
operator|^=
name|in
index|[
name|k
index|]
expr_stmt|;
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
name|in
operator|+=
literal|16
expr_stmt|;
block|}
name|j
operator|=
name|i
operator|/
literal|16
expr_stmt|;
name|in
operator|-=
name|i
expr_stmt|;
endif|#
directive|endif
call|(
modifier|*
name|stream
call|)
argument_list|(
name|in
argument_list|,
name|out
argument_list|,
name|j
argument_list|,
name|key
argument_list|,
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|)
expr_stmt|;
name|ctr
operator|+=
operator|(
name|unsigned
name|int
operator|)
name|j
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|BSWAP4
argument_list|(
name|ctr
argument_list|)
expr_stmt|;
else|#
directive|else
name|PUTU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|,
name|ctr
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|ctr
expr_stmt|;
name|out
operator|+=
name|i
expr_stmt|;
name|in
operator|+=
name|i
expr_stmt|;
name|len
operator|-=
name|i
expr_stmt|;
block|}
if|if
condition|(
name|len
condition|)
block|{
call|(
modifier|*
name|ctx
operator|->
name|block
call|)
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
argument_list|,
name|ctx
operator|->
name|EKi
operator|.
name|c
argument_list|,
name|key
argument_list|)
expr_stmt|;
operator|++
name|ctr
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
ifdef|#
directive|ifdef
name|BSWAP4
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|BSWAP4
argument_list|(
name|ctr
argument_list|)
expr_stmt|;
else|#
directive|else
name|PUTU32
argument_list|(
name|ctx
operator|->
name|Yi
operator|.
name|c
operator|+
literal|12
argument_list|,
name|ctr
argument_list|)
expr_stmt|;
endif|#
directive|endif
else|else
name|ctx
operator|->
name|Yi
operator|.
name|d
index|[
literal|3
index|]
operator|=
name|ctr
expr_stmt|;
while|while
condition|(
name|len
operator|--
condition|)
block|{
name|u8
name|c
init|=
name|in
index|[
name|n
index|]
decl_stmt|;
name|ctx
operator|->
name|Xi
operator|.
name|c
index|[
name|n
index|]
operator|^=
name|c
expr_stmt|;
name|out
index|[
name|n
index|]
operator|=
name|c
operator|^
name|ctx
operator|->
name|EKi
operator|.
name|c
index|[
name|n
index|]
expr_stmt|;
operator|++
name|n
expr_stmt|;
block|}
block|}
name|ctx
operator|->
name|mres
operator|=
name|n
expr_stmt|;
return|return
literal|0
return|;
block|}
name|int
name|CRYPTO_gcm128_finish
parameter_list|(
name|GCM128_CONTEXT
modifier|*
name|ctx
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|tag
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
specifier|const
union|union
block|{
name|long
name|one
decl_stmt|;
name|char
name|little
decl_stmt|;
block|}
name|is_endian
init|=
block|{
literal|1
block|}
union|;
name|u64
name|alen
init|=
name|ctx
operator|->
name|len
operator|.
name|u
index|[
literal|0
index|]
operator|<<
literal|3
decl_stmt|;
name|u64
name|clen
init|=
name|ctx
operator|->
name|len
operator|.
name|u
index|[
literal|1
index|]
operator|<<
literal|3
decl_stmt|;
ifdef|#
directive|ifdef
name|GCM_FUNCREF_4BIT
name|void
function_decl|(
modifier|*
name|gcm_gmult_p
function_decl|)
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|)
init|=
name|ctx
operator|->
name|gmult
function_decl|;
endif|#
directive|endif
if|if
condition|(
name|ctx
operator|->
name|mres
operator|||
name|ctx
operator|->
name|ares
condition|)
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
if|if
condition|(
name|is_endian
operator|.
name|little
condition|)
block|{
ifdef|#
directive|ifdef
name|BSWAP8
name|alen
operator|=
name|BSWAP8
argument_list|(
name|alen
argument_list|)
expr_stmt|;
name|clen
operator|=
name|BSWAP8
argument_list|(
name|clen
argument_list|)
expr_stmt|;
else|#
directive|else
name|u8
modifier|*
name|p
init|=
name|ctx
operator|->
name|len
operator|.
name|c
decl_stmt|;
name|ctx
operator|->
name|len
operator|.
name|u
index|[
literal|0
index|]
operator|=
name|alen
expr_stmt|;
name|ctx
operator|->
name|len
operator|.
name|u
index|[
literal|1
index|]
operator|=
name|clen
expr_stmt|;
name|alen
operator|=
operator|(
name|u64
operator|)
name|GETU32
argument_list|(
name|p
argument_list|)
operator|<<
literal|32
operator||
name|GETU32
argument_list|(
name|p
operator|+
literal|4
argument_list|)
expr_stmt|;
name|clen
operator|=
operator|(
name|u64
operator|)
name|GETU32
argument_list|(
name|p
operator|+
literal|8
argument_list|)
operator|<<
literal|32
operator||
name|GETU32
argument_list|(
name|p
operator|+
literal|12
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
name|ctx
operator|->
name|Xi
operator|.
name|u
index|[
literal|0
index|]
operator|^=
name|alen
expr_stmt|;
name|ctx
operator|->
name|Xi
operator|.
name|u
index|[
literal|1
index|]
operator|^=
name|clen
expr_stmt|;
name|GCM_MUL
argument_list|(
name|ctx
argument_list|,
name|Xi
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|Xi
operator|.
name|u
index|[
literal|0
index|]
operator|^=
name|ctx
operator|->
name|EK0
operator|.
name|u
index|[
literal|0
index|]
expr_stmt|;
name|ctx
operator|->
name|Xi
operator|.
name|u
index|[
literal|1
index|]
operator|^=
name|ctx
operator|->
name|EK0
operator|.
name|u
index|[
literal|1
index|]
expr_stmt|;
if|if
condition|(
name|tag
operator|&&
name|len
operator|<=
sizeof|sizeof
argument_list|(
name|ctx
operator|->
name|Xi
argument_list|)
condition|)
return|return
name|CRYPTO_memcmp
argument_list|(
name|ctx
operator|->
name|Xi
operator|.
name|c
argument_list|,
name|tag
argument_list|,
name|len
argument_list|)
return|;
else|else
return|return
operator|-
literal|1
return|;
block|}
name|void
name|CRYPTO_gcm128_tag
parameter_list|(
name|GCM128_CONTEXT
modifier|*
name|ctx
parameter_list|,
name|unsigned
name|char
modifier|*
name|tag
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
name|CRYPTO_gcm128_finish
argument_list|(
name|ctx
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|memcpy
argument_list|(
name|tag
argument_list|,
name|ctx
operator|->
name|Xi
operator|.
name|c
argument_list|,
name|len
operator|<=
sizeof|sizeof
argument_list|(
name|ctx
operator|->
name|Xi
operator|.
name|c
argument_list|)
condition|?
name|len
else|:
sizeof|sizeof
argument_list|(
name|ctx
operator|->
name|Xi
operator|.
name|c
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|GCM128_CONTEXT
modifier|*
name|CRYPTO_gcm128_new
parameter_list|(
name|void
modifier|*
name|key
parameter_list|,
name|block128_f
name|block
parameter_list|)
block|{
name|GCM128_CONTEXT
modifier|*
name|ret
decl_stmt|;
if|if
condition|(
operator|(
name|ret
operator|=
operator|(
name|GCM128_CONTEXT
operator|*
operator|)
name|OPENSSL_malloc
argument_list|(
sizeof|sizeof
argument_list|(
name|GCM128_CONTEXT
argument_list|)
argument_list|)
operator|)
condition|)
name|CRYPTO_gcm128_init
argument_list|(
name|ret
argument_list|,
name|key
argument_list|,
name|block
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
name|void
name|CRYPTO_gcm128_release
parameter_list|(
name|GCM128_CONTEXT
modifier|*
name|ctx
parameter_list|)
block|{
if|if
condition|(
name|ctx
condition|)
block|{
name|OPENSSL_cleanse
argument_list|(
name|ctx
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|ctx
argument_list|)
argument_list|)
expr_stmt|;
name|OPENSSL_free
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
block|}
block|}
if|#
directive|if
name|defined
argument_list|(
name|SELFTEST
argument_list|)
include|#
directive|include
file|<stdio.h>
include|#
directive|include
file|<openssl/aes.h>
comment|/* Test Case 1 */
specifier|static
specifier|const
name|u8
name|K1
index|[
literal|16
index|]
decl_stmt|,
modifier|*
name|P1
init|=
name|NULL
decl_stmt|,
modifier|*
name|A1
init|=
name|NULL
decl_stmt|,
name|IV1
index|[
literal|12
index|]
decl_stmt|,
modifier|*
name|C1
init|=
name|NULL
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T1
index|[]
init|=
block|{
literal|0x58
block|,
literal|0xe2
block|,
literal|0xfc
block|,
literal|0xce
block|,
literal|0xfa
block|,
literal|0x7e
block|,
literal|0x30
block|,
literal|0x61
block|,
literal|0x36
block|,
literal|0x7f
block|,
literal|0x1d
block|,
literal|0x57
block|,
literal|0xa4
block|,
literal|0xe7
block|,
literal|0x45
block|,
literal|0x5a
block|}
decl_stmt|;
comment|/* Test Case 2 */
define|#
directive|define
name|K2
value|K1
define|#
directive|define
name|A2
value|A1
define|#
directive|define
name|IV2
value|IV1
specifier|static
specifier|const
name|u8
name|P2
index|[
literal|16
index|]
decl_stmt|;
specifier|static
specifier|const
name|u8
name|C2
index|[]
init|=
block|{
literal|0x03
block|,
literal|0x88
block|,
literal|0xda
block|,
literal|0xce
block|,
literal|0x60
block|,
literal|0xb6
block|,
literal|0xa3
block|,
literal|0x92
block|,
literal|0xf3
block|,
literal|0x28
block|,
literal|0xc2
block|,
literal|0xb9
block|,
literal|0x71
block|,
literal|0xb2
block|,
literal|0xfe
block|,
literal|0x78
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T2
index|[]
init|=
block|{
literal|0xab
block|,
literal|0x6e
block|,
literal|0x47
block|,
literal|0xd4
block|,
literal|0x2c
block|,
literal|0xec
block|,
literal|0x13
block|,
literal|0xbd
block|,
literal|0xf5
block|,
literal|0x3a
block|,
literal|0x67
block|,
literal|0xb2
block|,
literal|0x12
block|,
literal|0x57
block|,
literal|0xbd
block|,
literal|0xdf
block|}
decl_stmt|;
comment|/* Test Case 3 */
define|#
directive|define
name|A3
value|A2
specifier|static
specifier|const
name|u8
name|K3
index|[]
init|=
block|{
literal|0xfe
block|,
literal|0xff
block|,
literal|0xe9
block|,
literal|0x92
block|,
literal|0x86
block|,
literal|0x65
block|,
literal|0x73
block|,
literal|0x1c
block|,
literal|0x6d
block|,
literal|0x6a
block|,
literal|0x8f
block|,
literal|0x94
block|,
literal|0x67
block|,
literal|0x30
block|,
literal|0x83
block|,
literal|0x08
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|P3
index|[]
init|=
block|{
literal|0xd9
block|,
literal|0x31
block|,
literal|0x32
block|,
literal|0x25
block|,
literal|0xf8
block|,
literal|0x84
block|,
literal|0x06
block|,
literal|0xe5
block|,
literal|0xa5
block|,
literal|0x59
block|,
literal|0x09
block|,
literal|0xc5
block|,
literal|0xaf
block|,
literal|0xf5
block|,
literal|0x26
block|,
literal|0x9a
block|,
literal|0x86
block|,
literal|0xa7
block|,
literal|0xa9
block|,
literal|0x53
block|,
literal|0x15
block|,
literal|0x34
block|,
literal|0xf7
block|,
literal|0xda
block|,
literal|0x2e
block|,
literal|0x4c
block|,
literal|0x30
block|,
literal|0x3d
block|,
literal|0x8a
block|,
literal|0x31
block|,
literal|0x8a
block|,
literal|0x72
block|,
literal|0x1c
block|,
literal|0x3c
block|,
literal|0x0c
block|,
literal|0x95
block|,
literal|0x95
block|,
literal|0x68
block|,
literal|0x09
block|,
literal|0x53
block|,
literal|0x2f
block|,
literal|0xcf
block|,
literal|0x0e
block|,
literal|0x24
block|,
literal|0x49
block|,
literal|0xa6
block|,
literal|0xb5
block|,
literal|0x25
block|,
literal|0xb1
block|,
literal|0x6a
block|,
literal|0xed
block|,
literal|0xf5
block|,
literal|0xaa
block|,
literal|0x0d
block|,
literal|0xe6
block|,
literal|0x57
block|,
literal|0xba
block|,
literal|0x63
block|,
literal|0x7b
block|,
literal|0x39
block|,
literal|0x1a
block|,
literal|0xaf
block|,
literal|0xd2
block|,
literal|0x55
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|IV3
index|[]
init|=
block|{
literal|0xca
block|,
literal|0xfe
block|,
literal|0xba
block|,
literal|0xbe
block|,
literal|0xfa
block|,
literal|0xce
block|,
literal|0xdb
block|,
literal|0xad
block|,
literal|0xde
block|,
literal|0xca
block|,
literal|0xf8
block|,
literal|0x88
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|C3
index|[]
init|=
block|{
literal|0x42
block|,
literal|0x83
block|,
literal|0x1e
block|,
literal|0xc2
block|,
literal|0x21
block|,
literal|0x77
block|,
literal|0x74
block|,
literal|0x24
block|,
literal|0x4b
block|,
literal|0x72
block|,
literal|0x21
block|,
literal|0xb7
block|,
literal|0x84
block|,
literal|0xd0
block|,
literal|0xd4
block|,
literal|0x9c
block|,
literal|0xe3
block|,
literal|0xaa
block|,
literal|0x21
block|,
literal|0x2f
block|,
literal|0x2c
block|,
literal|0x02
block|,
literal|0xa4
block|,
literal|0xe0
block|,
literal|0x35
block|,
literal|0xc1
block|,
literal|0x7e
block|,
literal|0x23
block|,
literal|0x29
block|,
literal|0xac
block|,
literal|0xa1
block|,
literal|0x2e
block|,
literal|0x21
block|,
literal|0xd5
block|,
literal|0x14
block|,
literal|0xb2
block|,
literal|0x54
block|,
literal|0x66
block|,
literal|0x93
block|,
literal|0x1c
block|,
literal|0x7d
block|,
literal|0x8f
block|,
literal|0x6a
block|,
literal|0x5a
block|,
literal|0xac
block|,
literal|0x84
block|,
literal|0xaa
block|,
literal|0x05
block|,
literal|0x1b
block|,
literal|0xa3
block|,
literal|0x0b
block|,
literal|0x39
block|,
literal|0x6a
block|,
literal|0x0a
block|,
literal|0xac
block|,
literal|0x97
block|,
literal|0x3d
block|,
literal|0x58
block|,
literal|0xe0
block|,
literal|0x91
block|,
literal|0x47
block|,
literal|0x3f
block|,
literal|0x59
block|,
literal|0x85
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T3
index|[]
init|=
block|{
literal|0x4d
block|,
literal|0x5c
block|,
literal|0x2a
block|,
literal|0xf3
block|,
literal|0x27
block|,
literal|0xcd
block|,
literal|0x64
block|,
literal|0xa6
block|,
literal|0x2c
block|,
literal|0xf3
block|,
literal|0x5a
block|,
literal|0xbd
block|,
literal|0x2b
block|,
literal|0xa6
block|,
literal|0xfa
block|,
literal|0xb4
block|}
decl_stmt|;
comment|/* Test Case 4 */
define|#
directive|define
name|K4
value|K3
define|#
directive|define
name|IV4
value|IV3
specifier|static
specifier|const
name|u8
name|P4
index|[]
init|=
block|{
literal|0xd9
block|,
literal|0x31
block|,
literal|0x32
block|,
literal|0x25
block|,
literal|0xf8
block|,
literal|0x84
block|,
literal|0x06
block|,
literal|0xe5
block|,
literal|0xa5
block|,
literal|0x59
block|,
literal|0x09
block|,
literal|0xc5
block|,
literal|0xaf
block|,
literal|0xf5
block|,
literal|0x26
block|,
literal|0x9a
block|,
literal|0x86
block|,
literal|0xa7
block|,
literal|0xa9
block|,
literal|0x53
block|,
literal|0x15
block|,
literal|0x34
block|,
literal|0xf7
block|,
literal|0xda
block|,
literal|0x2e
block|,
literal|0x4c
block|,
literal|0x30
block|,
literal|0x3d
block|,
literal|0x8a
block|,
literal|0x31
block|,
literal|0x8a
block|,
literal|0x72
block|,
literal|0x1c
block|,
literal|0x3c
block|,
literal|0x0c
block|,
literal|0x95
block|,
literal|0x95
block|,
literal|0x68
block|,
literal|0x09
block|,
literal|0x53
block|,
literal|0x2f
block|,
literal|0xcf
block|,
literal|0x0e
block|,
literal|0x24
block|,
literal|0x49
block|,
literal|0xa6
block|,
literal|0xb5
block|,
literal|0x25
block|,
literal|0xb1
block|,
literal|0x6a
block|,
literal|0xed
block|,
literal|0xf5
block|,
literal|0xaa
block|,
literal|0x0d
block|,
literal|0xe6
block|,
literal|0x57
block|,
literal|0xba
block|,
literal|0x63
block|,
literal|0x7b
block|,
literal|0x39
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|A4
index|[]
init|=
block|{
literal|0xfe
block|,
literal|0xed
block|,
literal|0xfa
block|,
literal|0xce
block|,
literal|0xde
block|,
literal|0xad
block|,
literal|0xbe
block|,
literal|0xef
block|,
literal|0xfe
block|,
literal|0xed
block|,
literal|0xfa
block|,
literal|0xce
block|,
literal|0xde
block|,
literal|0xad
block|,
literal|0xbe
block|,
literal|0xef
block|,
literal|0xab
block|,
literal|0xad
block|,
literal|0xda
block|,
literal|0xd2
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|C4
index|[]
init|=
block|{
literal|0x42
block|,
literal|0x83
block|,
literal|0x1e
block|,
literal|0xc2
block|,
literal|0x21
block|,
literal|0x77
block|,
literal|0x74
block|,
literal|0x24
block|,
literal|0x4b
block|,
literal|0x72
block|,
literal|0x21
block|,
literal|0xb7
block|,
literal|0x84
block|,
literal|0xd0
block|,
literal|0xd4
block|,
literal|0x9c
block|,
literal|0xe3
block|,
literal|0xaa
block|,
literal|0x21
block|,
literal|0x2f
block|,
literal|0x2c
block|,
literal|0x02
block|,
literal|0xa4
block|,
literal|0xe0
block|,
literal|0x35
block|,
literal|0xc1
block|,
literal|0x7e
block|,
literal|0x23
block|,
literal|0x29
block|,
literal|0xac
block|,
literal|0xa1
block|,
literal|0x2e
block|,
literal|0x21
block|,
literal|0xd5
block|,
literal|0x14
block|,
literal|0xb2
block|,
literal|0x54
block|,
literal|0x66
block|,
literal|0x93
block|,
literal|0x1c
block|,
literal|0x7d
block|,
literal|0x8f
block|,
literal|0x6a
block|,
literal|0x5a
block|,
literal|0xac
block|,
literal|0x84
block|,
literal|0xaa
block|,
literal|0x05
block|,
literal|0x1b
block|,
literal|0xa3
block|,
literal|0x0b
block|,
literal|0x39
block|,
literal|0x6a
block|,
literal|0x0a
block|,
literal|0xac
block|,
literal|0x97
block|,
literal|0x3d
block|,
literal|0x58
block|,
literal|0xe0
block|,
literal|0x91
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T4
index|[]
init|=
block|{
literal|0x5b
block|,
literal|0xc9
block|,
literal|0x4f
block|,
literal|0xbc
block|,
literal|0x32
block|,
literal|0x21
block|,
literal|0xa5
block|,
literal|0xdb
block|,
literal|0x94
block|,
literal|0xfa
block|,
literal|0xe9
block|,
literal|0x5a
block|,
literal|0xe7
block|,
literal|0x12
block|,
literal|0x1a
block|,
literal|0x47
block|}
decl_stmt|;
comment|/* Test Case 5 */
define|#
directive|define
name|K5
value|K4
define|#
directive|define
name|P5
value|P4
define|#
directive|define
name|A5
value|A4
specifier|static
specifier|const
name|u8
name|IV5
index|[]
init|=
block|{
literal|0xca
block|,
literal|0xfe
block|,
literal|0xba
block|,
literal|0xbe
block|,
literal|0xfa
block|,
literal|0xce
block|,
literal|0xdb
block|,
literal|0xad
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|C5
index|[]
init|=
block|{
literal|0x61
block|,
literal|0x35
block|,
literal|0x3b
block|,
literal|0x4c
block|,
literal|0x28
block|,
literal|0x06
block|,
literal|0x93
block|,
literal|0x4a
block|,
literal|0x77
block|,
literal|0x7f
block|,
literal|0xf5
block|,
literal|0x1f
block|,
literal|0xa2
block|,
literal|0x2a
block|,
literal|0x47
block|,
literal|0x55
block|,
literal|0x69
block|,
literal|0x9b
block|,
literal|0x2a
block|,
literal|0x71
block|,
literal|0x4f
block|,
literal|0xcd
block|,
literal|0xc6
block|,
literal|0xf8
block|,
literal|0x37
block|,
literal|0x66
block|,
literal|0xe5
block|,
literal|0xf9
block|,
literal|0x7b
block|,
literal|0x6c
block|,
literal|0x74
block|,
literal|0x23
block|,
literal|0x73
block|,
literal|0x80
block|,
literal|0x69
block|,
literal|0x00
block|,
literal|0xe4
block|,
literal|0x9f
block|,
literal|0x24
block|,
literal|0xb2
block|,
literal|0x2b
block|,
literal|0x09
block|,
literal|0x75
block|,
literal|0x44
block|,
literal|0xd4
block|,
literal|0x89
block|,
literal|0x6b
block|,
literal|0x42
block|,
literal|0x49
block|,
literal|0x89
block|,
literal|0xb5
block|,
literal|0xe1
block|,
literal|0xeb
block|,
literal|0xac
block|,
literal|0x0f
block|,
literal|0x07
block|,
literal|0xc2
block|,
literal|0x3f
block|,
literal|0x45
block|,
literal|0x98
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T5
index|[]
init|=
block|{
literal|0x36
block|,
literal|0x12
block|,
literal|0xd2
block|,
literal|0xe7
block|,
literal|0x9e
block|,
literal|0x3b
block|,
literal|0x07
block|,
literal|0x85
block|,
literal|0x56
block|,
literal|0x1b
block|,
literal|0xe1
block|,
literal|0x4a
block|,
literal|0xac
block|,
literal|0xa2
block|,
literal|0xfc
block|,
literal|0xcb
block|}
decl_stmt|;
comment|/* Test Case 6 */
define|#
directive|define
name|K6
value|K5
define|#
directive|define
name|P6
value|P5
define|#
directive|define
name|A6
value|A5
specifier|static
specifier|const
name|u8
name|IV6
index|[]
init|=
block|{
literal|0x93
block|,
literal|0x13
block|,
literal|0x22
block|,
literal|0x5d
block|,
literal|0xf8
block|,
literal|0x84
block|,
literal|0x06
block|,
literal|0xe5
block|,
literal|0x55
block|,
literal|0x90
block|,
literal|0x9c
block|,
literal|0x5a
block|,
literal|0xff
block|,
literal|0x52
block|,
literal|0x69
block|,
literal|0xaa
block|,
literal|0x6a
block|,
literal|0x7a
block|,
literal|0x95
block|,
literal|0x38
block|,
literal|0x53
block|,
literal|0x4f
block|,
literal|0x7d
block|,
literal|0xa1
block|,
literal|0xe4
block|,
literal|0xc3
block|,
literal|0x03
block|,
literal|0xd2
block|,
literal|0xa3
block|,
literal|0x18
block|,
literal|0xa7
block|,
literal|0x28
block|,
literal|0xc3
block|,
literal|0xc0
block|,
literal|0xc9
block|,
literal|0x51
block|,
literal|0x56
block|,
literal|0x80
block|,
literal|0x95
block|,
literal|0x39
block|,
literal|0xfc
block|,
literal|0xf0
block|,
literal|0xe2
block|,
literal|0x42
block|,
literal|0x9a
block|,
literal|0x6b
block|,
literal|0x52
block|,
literal|0x54
block|,
literal|0x16
block|,
literal|0xae
block|,
literal|0xdb
block|,
literal|0xf5
block|,
literal|0xa0
block|,
literal|0xde
block|,
literal|0x6a
block|,
literal|0x57
block|,
literal|0xa6
block|,
literal|0x37
block|,
literal|0xb3
block|,
literal|0x9b
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|C6
index|[]
init|=
block|{
literal|0x8c
block|,
literal|0xe2
block|,
literal|0x49
block|,
literal|0x98
block|,
literal|0x62
block|,
literal|0x56
block|,
literal|0x15
block|,
literal|0xb6
block|,
literal|0x03
block|,
literal|0xa0
block|,
literal|0x33
block|,
literal|0xac
block|,
literal|0xa1
block|,
literal|0x3f
block|,
literal|0xb8
block|,
literal|0x94
block|,
literal|0xbe
block|,
literal|0x91
block|,
literal|0x12
block|,
literal|0xa5
block|,
literal|0xc3
block|,
literal|0xa2
block|,
literal|0x11
block|,
literal|0xa8
block|,
literal|0xba
block|,
literal|0x26
block|,
literal|0x2a
block|,
literal|0x3c
block|,
literal|0xca
block|,
literal|0x7e
block|,
literal|0x2c
block|,
literal|0xa7
block|,
literal|0x01
block|,
literal|0xe4
block|,
literal|0xa9
block|,
literal|0xa4
block|,
literal|0xfb
block|,
literal|0xa4
block|,
literal|0x3c
block|,
literal|0x90
block|,
literal|0xcc
block|,
literal|0xdc
block|,
literal|0xb2
block|,
literal|0x81
block|,
literal|0xd4
block|,
literal|0x8c
block|,
literal|0x7c
block|,
literal|0x6f
block|,
literal|0xd6
block|,
literal|0x28
block|,
literal|0x75
block|,
literal|0xd2
block|,
literal|0xac
block|,
literal|0xa4
block|,
literal|0x17
block|,
literal|0x03
block|,
literal|0x4c
block|,
literal|0x34
block|,
literal|0xae
block|,
literal|0xe5
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T6
index|[]
init|=
block|{
literal|0x61
block|,
literal|0x9c
block|,
literal|0xc5
block|,
literal|0xae
block|,
literal|0xff
block|,
literal|0xfe
block|,
literal|0x0b
block|,
literal|0xfa
block|,
literal|0x46
block|,
literal|0x2a
block|,
literal|0xf4
block|,
literal|0x3c
block|,
literal|0x16
block|,
literal|0x99
block|,
literal|0xd0
block|,
literal|0x50
block|}
decl_stmt|;
comment|/* Test Case 7 */
specifier|static
specifier|const
name|u8
name|K7
index|[
literal|24
index|]
decl_stmt|,
modifier|*
name|P7
init|=
name|NULL
decl_stmt|,
modifier|*
name|A7
init|=
name|NULL
decl_stmt|,
name|IV7
index|[
literal|12
index|]
decl_stmt|,
modifier|*
name|C7
init|=
name|NULL
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T7
index|[]
init|=
block|{
literal|0xcd
block|,
literal|0x33
block|,
literal|0xb2
block|,
literal|0x8a
block|,
literal|0xc7
block|,
literal|0x73
block|,
literal|0xf7
block|,
literal|0x4b
block|,
literal|0xa0
block|,
literal|0x0e
block|,
literal|0xd1
block|,
literal|0xf3
block|,
literal|0x12
block|,
literal|0x57
block|,
literal|0x24
block|,
literal|0x35
block|}
decl_stmt|;
comment|/* Test Case 8 */
define|#
directive|define
name|K8
value|K7
define|#
directive|define
name|IV8
value|IV7
define|#
directive|define
name|A8
value|A7
specifier|static
specifier|const
name|u8
name|P8
index|[
literal|16
index|]
decl_stmt|;
specifier|static
specifier|const
name|u8
name|C8
index|[]
init|=
block|{
literal|0x98
block|,
literal|0xe7
block|,
literal|0x24
block|,
literal|0x7c
block|,
literal|0x07
block|,
literal|0xf0
block|,
literal|0xfe
block|,
literal|0x41
block|,
literal|0x1c
block|,
literal|0x26
block|,
literal|0x7e
block|,
literal|0x43
block|,
literal|0x84
block|,
literal|0xb0
block|,
literal|0xf6
block|,
literal|0x00
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T8
index|[]
init|=
block|{
literal|0x2f
block|,
literal|0xf5
block|,
literal|0x8d
block|,
literal|0x80
block|,
literal|0x03
block|,
literal|0x39
block|,
literal|0x27
block|,
literal|0xab
block|,
literal|0x8e
block|,
literal|0xf4
block|,
literal|0xd4
block|,
literal|0x58
block|,
literal|0x75
block|,
literal|0x14
block|,
literal|0xf0
block|,
literal|0xfb
block|}
decl_stmt|;
comment|/* Test Case 9 */
define|#
directive|define
name|A9
value|A8
specifier|static
specifier|const
name|u8
name|K9
index|[]
init|=
block|{
literal|0xfe
block|,
literal|0xff
block|,
literal|0xe9
block|,
literal|0x92
block|,
literal|0x86
block|,
literal|0x65
block|,
literal|0x73
block|,
literal|0x1c
block|,
literal|0x6d
block|,
literal|0x6a
block|,
literal|0x8f
block|,
literal|0x94
block|,
literal|0x67
block|,
literal|0x30
block|,
literal|0x83
block|,
literal|0x08
block|,
literal|0xfe
block|,
literal|0xff
block|,
literal|0xe9
block|,
literal|0x92
block|,
literal|0x86
block|,
literal|0x65
block|,
literal|0x73
block|,
literal|0x1c
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|P9
index|[]
init|=
block|{
literal|0xd9
block|,
literal|0x31
block|,
literal|0x32
block|,
literal|0x25
block|,
literal|0xf8
block|,
literal|0x84
block|,
literal|0x06
block|,
literal|0xe5
block|,
literal|0xa5
block|,
literal|0x59
block|,
literal|0x09
block|,
literal|0xc5
block|,
literal|0xaf
block|,
literal|0xf5
block|,
literal|0x26
block|,
literal|0x9a
block|,
literal|0x86
block|,
literal|0xa7
block|,
literal|0xa9
block|,
literal|0x53
block|,
literal|0x15
block|,
literal|0x34
block|,
literal|0xf7
block|,
literal|0xda
block|,
literal|0x2e
block|,
literal|0x4c
block|,
literal|0x30
block|,
literal|0x3d
block|,
literal|0x8a
block|,
literal|0x31
block|,
literal|0x8a
block|,
literal|0x72
block|,
literal|0x1c
block|,
literal|0x3c
block|,
literal|0x0c
block|,
literal|0x95
block|,
literal|0x95
block|,
literal|0x68
block|,
literal|0x09
block|,
literal|0x53
block|,
literal|0x2f
block|,
literal|0xcf
block|,
literal|0x0e
block|,
literal|0x24
block|,
literal|0x49
block|,
literal|0xa6
block|,
literal|0xb5
block|,
literal|0x25
block|,
literal|0xb1
block|,
literal|0x6a
block|,
literal|0xed
block|,
literal|0xf5
block|,
literal|0xaa
block|,
literal|0x0d
block|,
literal|0xe6
block|,
literal|0x57
block|,
literal|0xba
block|,
literal|0x63
block|,
literal|0x7b
block|,
literal|0x39
block|,
literal|0x1a
block|,
literal|0xaf
block|,
literal|0xd2
block|,
literal|0x55
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|IV9
index|[]
init|=
block|{
literal|0xca
block|,
literal|0xfe
block|,
literal|0xba
block|,
literal|0xbe
block|,
literal|0xfa
block|,
literal|0xce
block|,
literal|0xdb
block|,
literal|0xad
block|,
literal|0xde
block|,
literal|0xca
block|,
literal|0xf8
block|,
literal|0x88
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|C9
index|[]
init|=
block|{
literal|0x39
block|,
literal|0x80
block|,
literal|0xca
block|,
literal|0x0b
block|,
literal|0x3c
block|,
literal|0x00
block|,
literal|0xe8
block|,
literal|0x41
block|,
literal|0xeb
block|,
literal|0x06
block|,
literal|0xfa
block|,
literal|0xc4
block|,
literal|0x87
block|,
literal|0x2a
block|,
literal|0x27
block|,
literal|0x57
block|,
literal|0x85
block|,
literal|0x9e
block|,
literal|0x1c
block|,
literal|0xea
block|,
literal|0xa6
block|,
literal|0xef
block|,
literal|0xd9
block|,
literal|0x84
block|,
literal|0x62
block|,
literal|0x85
block|,
literal|0x93
block|,
literal|0xb4
block|,
literal|0x0c
block|,
literal|0xa1
block|,
literal|0xe1
block|,
literal|0x9c
block|,
literal|0x7d
block|,
literal|0x77
block|,
literal|0x3d
block|,
literal|0x00
block|,
literal|0xc1
block|,
literal|0x44
block|,
literal|0xc5
block|,
literal|0x25
block|,
literal|0xac
block|,
literal|0x61
block|,
literal|0x9d
block|,
literal|0x18
block|,
literal|0xc8
block|,
literal|0x4a
block|,
literal|0x3f
block|,
literal|0x47
block|,
literal|0x18
block|,
literal|0xe2
block|,
literal|0x44
block|,
literal|0x8b
block|,
literal|0x2f
block|,
literal|0xe3
block|,
literal|0x24
block|,
literal|0xd9
block|,
literal|0xcc
block|,
literal|0xda
block|,
literal|0x27
block|,
literal|0x10
block|,
literal|0xac
block|,
literal|0xad
block|,
literal|0xe2
block|,
literal|0x56
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T9
index|[]
init|=
block|{
literal|0x99
block|,
literal|0x24
block|,
literal|0xa7
block|,
literal|0xc8
block|,
literal|0x58
block|,
literal|0x73
block|,
literal|0x36
block|,
literal|0xbf
block|,
literal|0xb1
block|,
literal|0x18
block|,
literal|0x02
block|,
literal|0x4d
block|,
literal|0xb8
block|,
literal|0x67
block|,
literal|0x4a
block|,
literal|0x14
block|}
decl_stmt|;
comment|/* Test Case 10 */
define|#
directive|define
name|K10
value|K9
define|#
directive|define
name|IV10
value|IV9
specifier|static
specifier|const
name|u8
name|P10
index|[]
init|=
block|{
literal|0xd9
block|,
literal|0x31
block|,
literal|0x32
block|,
literal|0x25
block|,
literal|0xf8
block|,
literal|0x84
block|,
literal|0x06
block|,
literal|0xe5
block|,
literal|0xa5
block|,
literal|0x59
block|,
literal|0x09
block|,
literal|0xc5
block|,
literal|0xaf
block|,
literal|0xf5
block|,
literal|0x26
block|,
literal|0x9a
block|,
literal|0x86
block|,
literal|0xa7
block|,
literal|0xa9
block|,
literal|0x53
block|,
literal|0x15
block|,
literal|0x34
block|,
literal|0xf7
block|,
literal|0xda
block|,
literal|0x2e
block|,
literal|0x4c
block|,
literal|0x30
block|,
literal|0x3d
block|,
literal|0x8a
block|,
literal|0x31
block|,
literal|0x8a
block|,
literal|0x72
block|,
literal|0x1c
block|,
literal|0x3c
block|,
literal|0x0c
block|,
literal|0x95
block|,
literal|0x95
block|,
literal|0x68
block|,
literal|0x09
block|,
literal|0x53
block|,
literal|0x2f
block|,
literal|0xcf
block|,
literal|0x0e
block|,
literal|0x24
block|,
literal|0x49
block|,
literal|0xa6
block|,
literal|0xb5
block|,
literal|0x25
block|,
literal|0xb1
block|,
literal|0x6a
block|,
literal|0xed
block|,
literal|0xf5
block|,
literal|0xaa
block|,
literal|0x0d
block|,
literal|0xe6
block|,
literal|0x57
block|,
literal|0xba
block|,
literal|0x63
block|,
literal|0x7b
block|,
literal|0x39
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|A10
index|[]
init|=
block|{
literal|0xfe
block|,
literal|0xed
block|,
literal|0xfa
block|,
literal|0xce
block|,
literal|0xde
block|,
literal|0xad
block|,
literal|0xbe
block|,
literal|0xef
block|,
literal|0xfe
block|,
literal|0xed
block|,
literal|0xfa
block|,
literal|0xce
block|,
literal|0xde
block|,
literal|0xad
block|,
literal|0xbe
block|,
literal|0xef
block|,
literal|0xab
block|,
literal|0xad
block|,
literal|0xda
block|,
literal|0xd2
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|C10
index|[]
init|=
block|{
literal|0x39
block|,
literal|0x80
block|,
literal|0xca
block|,
literal|0x0b
block|,
literal|0x3c
block|,
literal|0x00
block|,
literal|0xe8
block|,
literal|0x41
block|,
literal|0xeb
block|,
literal|0x06
block|,
literal|0xfa
block|,
literal|0xc4
block|,
literal|0x87
block|,
literal|0x2a
block|,
literal|0x27
block|,
literal|0x57
block|,
literal|0x85
block|,
literal|0x9e
block|,
literal|0x1c
block|,
literal|0xea
block|,
literal|0xa6
block|,
literal|0xef
block|,
literal|0xd9
block|,
literal|0x84
block|,
literal|0x62
block|,
literal|0x85
block|,
literal|0x93
block|,
literal|0xb4
block|,
literal|0x0c
block|,
literal|0xa1
block|,
literal|0xe1
block|,
literal|0x9c
block|,
literal|0x7d
block|,
literal|0x77
block|,
literal|0x3d
block|,
literal|0x00
block|,
literal|0xc1
block|,
literal|0x44
block|,
literal|0xc5
block|,
literal|0x25
block|,
literal|0xac
block|,
literal|0x61
block|,
literal|0x9d
block|,
literal|0x18
block|,
literal|0xc8
block|,
literal|0x4a
block|,
literal|0x3f
block|,
literal|0x47
block|,
literal|0x18
block|,
literal|0xe2
block|,
literal|0x44
block|,
literal|0x8b
block|,
literal|0x2f
block|,
literal|0xe3
block|,
literal|0x24
block|,
literal|0xd9
block|,
literal|0xcc
block|,
literal|0xda
block|,
literal|0x27
block|,
literal|0x10
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T10
index|[]
init|=
block|{
literal|0x25
block|,
literal|0x19
block|,
literal|0x49
block|,
literal|0x8e
block|,
literal|0x80
block|,
literal|0xf1
block|,
literal|0x47
block|,
literal|0x8f
block|,
literal|0x37
block|,
literal|0xba
block|,
literal|0x55
block|,
literal|0xbd
block|,
literal|0x6d
block|,
literal|0x27
block|,
literal|0x61
block|,
literal|0x8c
block|}
decl_stmt|;
comment|/* Test Case 11 */
define|#
directive|define
name|K11
value|K10
define|#
directive|define
name|P11
value|P10
define|#
directive|define
name|A11
value|A10
specifier|static
specifier|const
name|u8
name|IV11
index|[]
init|=
block|{
literal|0xca
block|,
literal|0xfe
block|,
literal|0xba
block|,
literal|0xbe
block|,
literal|0xfa
block|,
literal|0xce
block|,
literal|0xdb
block|,
literal|0xad
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|C11
index|[]
init|=
block|{
literal|0x0f
block|,
literal|0x10
block|,
literal|0xf5
block|,
literal|0x99
block|,
literal|0xae
block|,
literal|0x14
block|,
literal|0xa1
block|,
literal|0x54
block|,
literal|0xed
block|,
literal|0x24
block|,
literal|0xb3
block|,
literal|0x6e
block|,
literal|0x25
block|,
literal|0x32
block|,
literal|0x4d
block|,
literal|0xb8
block|,
literal|0xc5
block|,
literal|0x66
block|,
literal|0x63
block|,
literal|0x2e
block|,
literal|0xf2
block|,
literal|0xbb
block|,
literal|0xb3
block|,
literal|0x4f
block|,
literal|0x83
block|,
literal|0x47
block|,
literal|0x28
block|,
literal|0x0f
block|,
literal|0xc4
block|,
literal|0x50
block|,
literal|0x70
block|,
literal|0x57
block|,
literal|0xfd
block|,
literal|0xdc
block|,
literal|0x29
block|,
literal|0xdf
block|,
literal|0x9a
block|,
literal|0x47
block|,
literal|0x1f
block|,
literal|0x75
block|,
literal|0xc6
block|,
literal|0x65
block|,
literal|0x41
block|,
literal|0xd4
block|,
literal|0xd4
block|,
literal|0xda
block|,
literal|0xd1
block|,
literal|0xc9
block|,
literal|0xe9
block|,
literal|0x3a
block|,
literal|0x19
block|,
literal|0xa5
block|,
literal|0x8e
block|,
literal|0x8b
block|,
literal|0x47
block|,
literal|0x3f
block|,
literal|0xa0
block|,
literal|0xf0
block|,
literal|0x62
block|,
literal|0xf7
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T11
index|[]
init|=
block|{
literal|0x65
block|,
literal|0xdc
block|,
literal|0xc5
block|,
literal|0x7f
block|,
literal|0xcf
block|,
literal|0x62
block|,
literal|0x3a
block|,
literal|0x24
block|,
literal|0x09
block|,
literal|0x4f
block|,
literal|0xcc
block|,
literal|0xa4
block|,
literal|0x0d
block|,
literal|0x35
block|,
literal|0x33
block|,
literal|0xf8
block|}
decl_stmt|;
comment|/* Test Case 12 */
define|#
directive|define
name|K12
value|K11
define|#
directive|define
name|P12
value|P11
define|#
directive|define
name|A12
value|A11
specifier|static
specifier|const
name|u8
name|IV12
index|[]
init|=
block|{
literal|0x93
block|,
literal|0x13
block|,
literal|0x22
block|,
literal|0x5d
block|,
literal|0xf8
block|,
literal|0x84
block|,
literal|0x06
block|,
literal|0xe5
block|,
literal|0x55
block|,
literal|0x90
block|,
literal|0x9c
block|,
literal|0x5a
block|,
literal|0xff
block|,
literal|0x52
block|,
literal|0x69
block|,
literal|0xaa
block|,
literal|0x6a
block|,
literal|0x7a
block|,
literal|0x95
block|,
literal|0x38
block|,
literal|0x53
block|,
literal|0x4f
block|,
literal|0x7d
block|,
literal|0xa1
block|,
literal|0xe4
block|,
literal|0xc3
block|,
literal|0x03
block|,
literal|0xd2
block|,
literal|0xa3
block|,
literal|0x18
block|,
literal|0xa7
block|,
literal|0x28
block|,
literal|0xc3
block|,
literal|0xc0
block|,
literal|0xc9
block|,
literal|0x51
block|,
literal|0x56
block|,
literal|0x80
block|,
literal|0x95
block|,
literal|0x39
block|,
literal|0xfc
block|,
literal|0xf0
block|,
literal|0xe2
block|,
literal|0x42
block|,
literal|0x9a
block|,
literal|0x6b
block|,
literal|0x52
block|,
literal|0x54
block|,
literal|0x16
block|,
literal|0xae
block|,
literal|0xdb
block|,
literal|0xf5
block|,
literal|0xa0
block|,
literal|0xde
block|,
literal|0x6a
block|,
literal|0x57
block|,
literal|0xa6
block|,
literal|0x37
block|,
literal|0xb3
block|,
literal|0x9b
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|C12
index|[]
init|=
block|{
literal|0xd2
block|,
literal|0x7e
block|,
literal|0x88
block|,
literal|0x68
block|,
literal|0x1c
block|,
literal|0xe3
block|,
literal|0x24
block|,
literal|0x3c
block|,
literal|0x48
block|,
literal|0x30
block|,
literal|0x16
block|,
literal|0x5a
block|,
literal|0x8f
block|,
literal|0xdc
block|,
literal|0xf9
block|,
literal|0xff
block|,
literal|0x1d
block|,
literal|0xe9
block|,
literal|0xa1
block|,
literal|0xd8
block|,
literal|0xe6
block|,
literal|0xb4
block|,
literal|0x47
block|,
literal|0xef
block|,
literal|0x6e
block|,
literal|0xf7
block|,
literal|0xb7
block|,
literal|0x98
block|,
literal|0x28
block|,
literal|0x66
block|,
literal|0x6e
block|,
literal|0x45
block|,
literal|0x81
block|,
literal|0xe7
block|,
literal|0x90
block|,
literal|0x12
block|,
literal|0xaf
block|,
literal|0x34
block|,
literal|0xdd
block|,
literal|0xd9
block|,
literal|0xe2
block|,
literal|0xf0
block|,
literal|0x37
block|,
literal|0x58
block|,
literal|0x9b
block|,
literal|0x29
block|,
literal|0x2d
block|,
literal|0xb3
block|,
literal|0xe6
block|,
literal|0x7c
block|,
literal|0x03
block|,
literal|0x67
block|,
literal|0x45
block|,
literal|0xfa
block|,
literal|0x22
block|,
literal|0xe7
block|,
literal|0xe9
block|,
literal|0xb7
block|,
literal|0x37
block|,
literal|0x3b
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T12
index|[]
init|=
block|{
literal|0xdc
block|,
literal|0xf5
block|,
literal|0x66
block|,
literal|0xff
block|,
literal|0x29
block|,
literal|0x1c
block|,
literal|0x25
block|,
literal|0xbb
block|,
literal|0xb8
block|,
literal|0x56
block|,
literal|0x8f
block|,
literal|0xc3
block|,
literal|0xd3
block|,
literal|0x76
block|,
literal|0xa6
block|,
literal|0xd9
block|}
decl_stmt|;
comment|/* Test Case 13 */
specifier|static
specifier|const
name|u8
name|K13
index|[
literal|32
index|]
decl_stmt|,
modifier|*
name|P13
init|=
name|NULL
decl_stmt|,
modifier|*
name|A13
init|=
name|NULL
decl_stmt|,
name|IV13
index|[
literal|12
index|]
decl_stmt|,
modifier|*
name|C13
init|=
name|NULL
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T13
index|[]
init|=
block|{
literal|0x53
block|,
literal|0x0f
block|,
literal|0x8a
block|,
literal|0xfb
block|,
literal|0xc7
block|,
literal|0x45
block|,
literal|0x36
block|,
literal|0xb9
block|,
literal|0xa9
block|,
literal|0x63
block|,
literal|0xb4
block|,
literal|0xf1
block|,
literal|0xc4
block|,
literal|0xcb
block|,
literal|0x73
block|,
literal|0x8b
block|}
decl_stmt|;
comment|/* Test Case 14 */
define|#
directive|define
name|K14
value|K13
define|#
directive|define
name|A14
value|A13
specifier|static
specifier|const
name|u8
name|P14
index|[
literal|16
index|]
decl_stmt|,
name|IV14
index|[
literal|12
index|]
decl_stmt|;
specifier|static
specifier|const
name|u8
name|C14
index|[]
init|=
block|{
literal|0xce
block|,
literal|0xa7
block|,
literal|0x40
block|,
literal|0x3d
block|,
literal|0x4d
block|,
literal|0x60
block|,
literal|0x6b
block|,
literal|0x6e
block|,
literal|0x07
block|,
literal|0x4e
block|,
literal|0xc5
block|,
literal|0xd3
block|,
literal|0xba
block|,
literal|0xf3
block|,
literal|0x9d
block|,
literal|0x18
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T14
index|[]
init|=
block|{
literal|0xd0
block|,
literal|0xd1
block|,
literal|0xc8
block|,
literal|0xa7
block|,
literal|0x99
block|,
literal|0x99
block|,
literal|0x6b
block|,
literal|0xf0
block|,
literal|0x26
block|,
literal|0x5b
block|,
literal|0x98
block|,
literal|0xb5
block|,
literal|0xd4
block|,
literal|0x8a
block|,
literal|0xb9
block|,
literal|0x19
block|}
decl_stmt|;
comment|/* Test Case 15 */
define|#
directive|define
name|A15
value|A14
specifier|static
specifier|const
name|u8
name|K15
index|[]
init|=
block|{
literal|0xfe
block|,
literal|0xff
block|,
literal|0xe9
block|,
literal|0x92
block|,
literal|0x86
block|,
literal|0x65
block|,
literal|0x73
block|,
literal|0x1c
block|,
literal|0x6d
block|,
literal|0x6a
block|,
literal|0x8f
block|,
literal|0x94
block|,
literal|0x67
block|,
literal|0x30
block|,
literal|0x83
block|,
literal|0x08
block|,
literal|0xfe
block|,
literal|0xff
block|,
literal|0xe9
block|,
literal|0x92
block|,
literal|0x86
block|,
literal|0x65
block|,
literal|0x73
block|,
literal|0x1c
block|,
literal|0x6d
block|,
literal|0x6a
block|,
literal|0x8f
block|,
literal|0x94
block|,
literal|0x67
block|,
literal|0x30
block|,
literal|0x83
block|,
literal|0x08
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|P15
index|[]
init|=
block|{
literal|0xd9
block|,
literal|0x31
block|,
literal|0x32
block|,
literal|0x25
block|,
literal|0xf8
block|,
literal|0x84
block|,
literal|0x06
block|,
literal|0xe5
block|,
literal|0xa5
block|,
literal|0x59
block|,
literal|0x09
block|,
literal|0xc5
block|,
literal|0xaf
block|,
literal|0xf5
block|,
literal|0x26
block|,
literal|0x9a
block|,
literal|0x86
block|,
literal|0xa7
block|,
literal|0xa9
block|,
literal|0x53
block|,
literal|0x15
block|,
literal|0x34
block|,
literal|0xf7
block|,
literal|0xda
block|,
literal|0x2e
block|,
literal|0x4c
block|,
literal|0x30
block|,
literal|0x3d
block|,
literal|0x8a
block|,
literal|0x31
block|,
literal|0x8a
block|,
literal|0x72
block|,
literal|0x1c
block|,
literal|0x3c
block|,
literal|0x0c
block|,
literal|0x95
block|,
literal|0x95
block|,
literal|0x68
block|,
literal|0x09
block|,
literal|0x53
block|,
literal|0x2f
block|,
literal|0xcf
block|,
literal|0x0e
block|,
literal|0x24
block|,
literal|0x49
block|,
literal|0xa6
block|,
literal|0xb5
block|,
literal|0x25
block|,
literal|0xb1
block|,
literal|0x6a
block|,
literal|0xed
block|,
literal|0xf5
block|,
literal|0xaa
block|,
literal|0x0d
block|,
literal|0xe6
block|,
literal|0x57
block|,
literal|0xba
block|,
literal|0x63
block|,
literal|0x7b
block|,
literal|0x39
block|,
literal|0x1a
block|,
literal|0xaf
block|,
literal|0xd2
block|,
literal|0x55
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|IV15
index|[]
init|=
block|{
literal|0xca
block|,
literal|0xfe
block|,
literal|0xba
block|,
literal|0xbe
block|,
literal|0xfa
block|,
literal|0xce
block|,
literal|0xdb
block|,
literal|0xad
block|,
literal|0xde
block|,
literal|0xca
block|,
literal|0xf8
block|,
literal|0x88
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|C15
index|[]
init|=
block|{
literal|0x52
block|,
literal|0x2d
block|,
literal|0xc1
block|,
literal|0xf0
block|,
literal|0x99
block|,
literal|0x56
block|,
literal|0x7d
block|,
literal|0x07
block|,
literal|0xf4
block|,
literal|0x7f
block|,
literal|0x37
block|,
literal|0xa3
block|,
literal|0x2a
block|,
literal|0x84
block|,
literal|0x42
block|,
literal|0x7d
block|,
literal|0x64
block|,
literal|0x3a
block|,
literal|0x8c
block|,
literal|0xdc
block|,
literal|0xbf
block|,
literal|0xe5
block|,
literal|0xc0
block|,
literal|0xc9
block|,
literal|0x75
block|,
literal|0x98
block|,
literal|0xa2
block|,
literal|0xbd
block|,
literal|0x25
block|,
literal|0x55
block|,
literal|0xd1
block|,
literal|0xaa
block|,
literal|0x8c
block|,
literal|0xb0
block|,
literal|0x8e
block|,
literal|0x48
block|,
literal|0x59
block|,
literal|0x0d
block|,
literal|0xbb
block|,
literal|0x3d
block|,
literal|0xa7
block|,
literal|0xb0
block|,
literal|0x8b
block|,
literal|0x10
block|,
literal|0x56
block|,
literal|0x82
block|,
literal|0x88
block|,
literal|0x38
block|,
literal|0xc5
block|,
literal|0xf6
block|,
literal|0x1e
block|,
literal|0x63
block|,
literal|0x93
block|,
literal|0xba
block|,
literal|0x7a
block|,
literal|0x0a
block|,
literal|0xbc
block|,
literal|0xc9
block|,
literal|0xf6
block|,
literal|0x62
block|,
literal|0x89
block|,
literal|0x80
block|,
literal|0x15
block|,
literal|0xad
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T15
index|[]
init|=
block|{
literal|0xb0
block|,
literal|0x94
block|,
literal|0xda
block|,
literal|0xc5
block|,
literal|0xd9
block|,
literal|0x34
block|,
literal|0x71
block|,
literal|0xbd
block|,
literal|0xec
block|,
literal|0x1a
block|,
literal|0x50
block|,
literal|0x22
block|,
literal|0x70
block|,
literal|0xe3
block|,
literal|0xcc
block|,
literal|0x6c
block|}
decl_stmt|;
comment|/* Test Case 16 */
define|#
directive|define
name|K16
value|K15
define|#
directive|define
name|IV16
value|IV15
specifier|static
specifier|const
name|u8
name|P16
index|[]
init|=
block|{
literal|0xd9
block|,
literal|0x31
block|,
literal|0x32
block|,
literal|0x25
block|,
literal|0xf8
block|,
literal|0x84
block|,
literal|0x06
block|,
literal|0xe5
block|,
literal|0xa5
block|,
literal|0x59
block|,
literal|0x09
block|,
literal|0xc5
block|,
literal|0xaf
block|,
literal|0xf5
block|,
literal|0x26
block|,
literal|0x9a
block|,
literal|0x86
block|,
literal|0xa7
block|,
literal|0xa9
block|,
literal|0x53
block|,
literal|0x15
block|,
literal|0x34
block|,
literal|0xf7
block|,
literal|0xda
block|,
literal|0x2e
block|,
literal|0x4c
block|,
literal|0x30
block|,
literal|0x3d
block|,
literal|0x8a
block|,
literal|0x31
block|,
literal|0x8a
block|,
literal|0x72
block|,
literal|0x1c
block|,
literal|0x3c
block|,
literal|0x0c
block|,
literal|0x95
block|,
literal|0x95
block|,
literal|0x68
block|,
literal|0x09
block|,
literal|0x53
block|,
literal|0x2f
block|,
literal|0xcf
block|,
literal|0x0e
block|,
literal|0x24
block|,
literal|0x49
block|,
literal|0xa6
block|,
literal|0xb5
block|,
literal|0x25
block|,
literal|0xb1
block|,
literal|0x6a
block|,
literal|0xed
block|,
literal|0xf5
block|,
literal|0xaa
block|,
literal|0x0d
block|,
literal|0xe6
block|,
literal|0x57
block|,
literal|0xba
block|,
literal|0x63
block|,
literal|0x7b
block|,
literal|0x39
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|A16
index|[]
init|=
block|{
literal|0xfe
block|,
literal|0xed
block|,
literal|0xfa
block|,
literal|0xce
block|,
literal|0xde
block|,
literal|0xad
block|,
literal|0xbe
block|,
literal|0xef
block|,
literal|0xfe
block|,
literal|0xed
block|,
literal|0xfa
block|,
literal|0xce
block|,
literal|0xde
block|,
literal|0xad
block|,
literal|0xbe
block|,
literal|0xef
block|,
literal|0xab
block|,
literal|0xad
block|,
literal|0xda
block|,
literal|0xd2
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|C16
index|[]
init|=
block|{
literal|0x52
block|,
literal|0x2d
block|,
literal|0xc1
block|,
literal|0xf0
block|,
literal|0x99
block|,
literal|0x56
block|,
literal|0x7d
block|,
literal|0x07
block|,
literal|0xf4
block|,
literal|0x7f
block|,
literal|0x37
block|,
literal|0xa3
block|,
literal|0x2a
block|,
literal|0x84
block|,
literal|0x42
block|,
literal|0x7d
block|,
literal|0x64
block|,
literal|0x3a
block|,
literal|0x8c
block|,
literal|0xdc
block|,
literal|0xbf
block|,
literal|0xe5
block|,
literal|0xc0
block|,
literal|0xc9
block|,
literal|0x75
block|,
literal|0x98
block|,
literal|0xa2
block|,
literal|0xbd
block|,
literal|0x25
block|,
literal|0x55
block|,
literal|0xd1
block|,
literal|0xaa
block|,
literal|0x8c
block|,
literal|0xb0
block|,
literal|0x8e
block|,
literal|0x48
block|,
literal|0x59
block|,
literal|0x0d
block|,
literal|0xbb
block|,
literal|0x3d
block|,
literal|0xa7
block|,
literal|0xb0
block|,
literal|0x8b
block|,
literal|0x10
block|,
literal|0x56
block|,
literal|0x82
block|,
literal|0x88
block|,
literal|0x38
block|,
literal|0xc5
block|,
literal|0xf6
block|,
literal|0x1e
block|,
literal|0x63
block|,
literal|0x93
block|,
literal|0xba
block|,
literal|0x7a
block|,
literal|0x0a
block|,
literal|0xbc
block|,
literal|0xc9
block|,
literal|0xf6
block|,
literal|0x62
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T16
index|[]
init|=
block|{
literal|0x76
block|,
literal|0xfc
block|,
literal|0x6e
block|,
literal|0xce
block|,
literal|0x0f
block|,
literal|0x4e
block|,
literal|0x17
block|,
literal|0x68
block|,
literal|0xcd
block|,
literal|0xdf
block|,
literal|0x88
block|,
literal|0x53
block|,
literal|0xbb
block|,
literal|0x2d
block|,
literal|0x55
block|,
literal|0x1b
block|}
decl_stmt|;
comment|/* Test Case 17 */
define|#
directive|define
name|K17
value|K16
define|#
directive|define
name|P17
value|P16
define|#
directive|define
name|A17
value|A16
specifier|static
specifier|const
name|u8
name|IV17
index|[]
init|=
block|{
literal|0xca
block|,
literal|0xfe
block|,
literal|0xba
block|,
literal|0xbe
block|,
literal|0xfa
block|,
literal|0xce
block|,
literal|0xdb
block|,
literal|0xad
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|C17
index|[]
init|=
block|{
literal|0xc3
block|,
literal|0x76
block|,
literal|0x2d
block|,
literal|0xf1
block|,
literal|0xca
block|,
literal|0x78
block|,
literal|0x7d
block|,
literal|0x32
block|,
literal|0xae
block|,
literal|0x47
block|,
literal|0xc1
block|,
literal|0x3b
block|,
literal|0xf1
block|,
literal|0x98
block|,
literal|0x44
block|,
literal|0xcb
block|,
literal|0xaf
block|,
literal|0x1a
block|,
literal|0xe1
block|,
literal|0x4d
block|,
literal|0x0b
block|,
literal|0x97
block|,
literal|0x6a
block|,
literal|0xfa
block|,
literal|0xc5
block|,
literal|0x2f
block|,
literal|0xf7
block|,
literal|0xd7
block|,
literal|0x9b
block|,
literal|0xba
block|,
literal|0x9d
block|,
literal|0xe0
block|,
literal|0xfe
block|,
literal|0xb5
block|,
literal|0x82
block|,
literal|0xd3
block|,
literal|0x39
block|,
literal|0x34
block|,
literal|0xa4
block|,
literal|0xf0
block|,
literal|0x95
block|,
literal|0x4c
block|,
literal|0xc2
block|,
literal|0x36
block|,
literal|0x3b
block|,
literal|0xc7
block|,
literal|0x3f
block|,
literal|0x78
block|,
literal|0x62
block|,
literal|0xac
block|,
literal|0x43
block|,
literal|0x0e
block|,
literal|0x64
block|,
literal|0xab
block|,
literal|0xe4
block|,
literal|0x99
block|,
literal|0xf4
block|,
literal|0x7c
block|,
literal|0x9b
block|,
literal|0x1f
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T17
index|[]
init|=
block|{
literal|0x3a
block|,
literal|0x33
block|,
literal|0x7d
block|,
literal|0xbf
block|,
literal|0x46
block|,
literal|0xa7
block|,
literal|0x92
block|,
literal|0xc4
block|,
literal|0x5e
block|,
literal|0x45
block|,
literal|0x49
block|,
literal|0x13
block|,
literal|0xfe
block|,
literal|0x2e
block|,
literal|0xa8
block|,
literal|0xf2
block|}
decl_stmt|;
comment|/* Test Case 18 */
define|#
directive|define
name|K18
value|K17
define|#
directive|define
name|P18
value|P17
define|#
directive|define
name|A18
value|A17
specifier|static
specifier|const
name|u8
name|IV18
index|[]
init|=
block|{
literal|0x93
block|,
literal|0x13
block|,
literal|0x22
block|,
literal|0x5d
block|,
literal|0xf8
block|,
literal|0x84
block|,
literal|0x06
block|,
literal|0xe5
block|,
literal|0x55
block|,
literal|0x90
block|,
literal|0x9c
block|,
literal|0x5a
block|,
literal|0xff
block|,
literal|0x52
block|,
literal|0x69
block|,
literal|0xaa
block|,
literal|0x6a
block|,
literal|0x7a
block|,
literal|0x95
block|,
literal|0x38
block|,
literal|0x53
block|,
literal|0x4f
block|,
literal|0x7d
block|,
literal|0xa1
block|,
literal|0xe4
block|,
literal|0xc3
block|,
literal|0x03
block|,
literal|0xd2
block|,
literal|0xa3
block|,
literal|0x18
block|,
literal|0xa7
block|,
literal|0x28
block|,
literal|0xc3
block|,
literal|0xc0
block|,
literal|0xc9
block|,
literal|0x51
block|,
literal|0x56
block|,
literal|0x80
block|,
literal|0x95
block|,
literal|0x39
block|,
literal|0xfc
block|,
literal|0xf0
block|,
literal|0xe2
block|,
literal|0x42
block|,
literal|0x9a
block|,
literal|0x6b
block|,
literal|0x52
block|,
literal|0x54
block|,
literal|0x16
block|,
literal|0xae
block|,
literal|0xdb
block|,
literal|0xf5
block|,
literal|0xa0
block|,
literal|0xde
block|,
literal|0x6a
block|,
literal|0x57
block|,
literal|0xa6
block|,
literal|0x37
block|,
literal|0xb3
block|,
literal|0x9b
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|C18
index|[]
init|=
block|{
literal|0x5a
block|,
literal|0x8d
block|,
literal|0xef
block|,
literal|0x2f
block|,
literal|0x0c
block|,
literal|0x9e
block|,
literal|0x53
block|,
literal|0xf1
block|,
literal|0xf7
block|,
literal|0x5d
block|,
literal|0x78
block|,
literal|0x53
block|,
literal|0x65
block|,
literal|0x9e
block|,
literal|0x2a
block|,
literal|0x20
block|,
literal|0xee
block|,
literal|0xb2
block|,
literal|0xb2
block|,
literal|0x2a
block|,
literal|0xaf
block|,
literal|0xde
block|,
literal|0x64
block|,
literal|0x19
block|,
literal|0xa0
block|,
literal|0x58
block|,
literal|0xab
block|,
literal|0x4f
block|,
literal|0x6f
block|,
literal|0x74
block|,
literal|0x6b
block|,
literal|0xf4
block|,
literal|0x0f
block|,
literal|0xc0
block|,
literal|0xc3
block|,
literal|0xb7
block|,
literal|0x80
block|,
literal|0xf2
block|,
literal|0x44
block|,
literal|0x45
block|,
literal|0x2d
block|,
literal|0xa3
block|,
literal|0xeb
block|,
literal|0xf1
block|,
literal|0xc5
block|,
literal|0xd8
block|,
literal|0x2c
block|,
literal|0xde
block|,
literal|0xa2
block|,
literal|0x41
block|,
literal|0x89
block|,
literal|0x97
block|,
literal|0x20
block|,
literal|0x0e
block|,
literal|0xf8
block|,
literal|0x2e
block|,
literal|0x44
block|,
literal|0xae
block|,
literal|0x7e
block|,
literal|0x3f
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T18
index|[]
init|=
block|{
literal|0xa4
block|,
literal|0x4a
block|,
literal|0x82
block|,
literal|0x66
block|,
literal|0xee
block|,
literal|0x1c
block|,
literal|0x8e
block|,
literal|0xb0
block|,
literal|0xc8
block|,
literal|0xb5
block|,
literal|0xd4
block|,
literal|0xcf
block|,
literal|0x5a
block|,
literal|0xe9
block|,
literal|0xf1
block|,
literal|0x9a
block|}
decl_stmt|;
comment|/* Test Case 19 */
define|#
directive|define
name|K19
value|K1
define|#
directive|define
name|P19
value|P1
define|#
directive|define
name|IV19
value|IV1
define|#
directive|define
name|C19
value|C1
specifier|static
specifier|const
name|u8
name|A19
index|[]
init|=
block|{
literal|0xd9
block|,
literal|0x31
block|,
literal|0x32
block|,
literal|0x25
block|,
literal|0xf8
block|,
literal|0x84
block|,
literal|0x06
block|,
literal|0xe5
block|,
literal|0xa5
block|,
literal|0x59
block|,
literal|0x09
block|,
literal|0xc5
block|,
literal|0xaf
block|,
literal|0xf5
block|,
literal|0x26
block|,
literal|0x9a
block|,
literal|0x86
block|,
literal|0xa7
block|,
literal|0xa9
block|,
literal|0x53
block|,
literal|0x15
block|,
literal|0x34
block|,
literal|0xf7
block|,
literal|0xda
block|,
literal|0x2e
block|,
literal|0x4c
block|,
literal|0x30
block|,
literal|0x3d
block|,
literal|0x8a
block|,
literal|0x31
block|,
literal|0x8a
block|,
literal|0x72
block|,
literal|0x1c
block|,
literal|0x3c
block|,
literal|0x0c
block|,
literal|0x95
block|,
literal|0x95
block|,
literal|0x68
block|,
literal|0x09
block|,
literal|0x53
block|,
literal|0x2f
block|,
literal|0xcf
block|,
literal|0x0e
block|,
literal|0x24
block|,
literal|0x49
block|,
literal|0xa6
block|,
literal|0xb5
block|,
literal|0x25
block|,
literal|0xb1
block|,
literal|0x6a
block|,
literal|0xed
block|,
literal|0xf5
block|,
literal|0xaa
block|,
literal|0x0d
block|,
literal|0xe6
block|,
literal|0x57
block|,
literal|0xba
block|,
literal|0x63
block|,
literal|0x7b
block|,
literal|0x39
block|,
literal|0x1a
block|,
literal|0xaf
block|,
literal|0xd2
block|,
literal|0x55
block|,
literal|0x52
block|,
literal|0x2d
block|,
literal|0xc1
block|,
literal|0xf0
block|,
literal|0x99
block|,
literal|0x56
block|,
literal|0x7d
block|,
literal|0x07
block|,
literal|0xf4
block|,
literal|0x7f
block|,
literal|0x37
block|,
literal|0xa3
block|,
literal|0x2a
block|,
literal|0x84
block|,
literal|0x42
block|,
literal|0x7d
block|,
literal|0x64
block|,
literal|0x3a
block|,
literal|0x8c
block|,
literal|0xdc
block|,
literal|0xbf
block|,
literal|0xe5
block|,
literal|0xc0
block|,
literal|0xc9
block|,
literal|0x75
block|,
literal|0x98
block|,
literal|0xa2
block|,
literal|0xbd
block|,
literal|0x25
block|,
literal|0x55
block|,
literal|0xd1
block|,
literal|0xaa
block|,
literal|0x8c
block|,
literal|0xb0
block|,
literal|0x8e
block|,
literal|0x48
block|,
literal|0x59
block|,
literal|0x0d
block|,
literal|0xbb
block|,
literal|0x3d
block|,
literal|0xa7
block|,
literal|0xb0
block|,
literal|0x8b
block|,
literal|0x10
block|,
literal|0x56
block|,
literal|0x82
block|,
literal|0x88
block|,
literal|0x38
block|,
literal|0xc5
block|,
literal|0xf6
block|,
literal|0x1e
block|,
literal|0x63
block|,
literal|0x93
block|,
literal|0xba
block|,
literal|0x7a
block|,
literal|0x0a
block|,
literal|0xbc
block|,
literal|0xc9
block|,
literal|0xf6
block|,
literal|0x62
block|,
literal|0x89
block|,
literal|0x80
block|,
literal|0x15
block|,
literal|0xad
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T19
index|[]
init|=
block|{
literal|0x5f
block|,
literal|0xea
block|,
literal|0x79
block|,
literal|0x3a
block|,
literal|0x2d
block|,
literal|0x6f
block|,
literal|0x97
block|,
literal|0x4d
block|,
literal|0x37
block|,
literal|0xe6
block|,
literal|0x8e
block|,
literal|0x0c
block|,
literal|0xb8
block|,
literal|0xff
block|,
literal|0x94
block|,
literal|0x92
block|}
decl_stmt|;
comment|/* Test Case 20 */
define|#
directive|define
name|K20
value|K1
define|#
directive|define
name|A20
value|A1
comment|/* this results in 0xff in counter LSB */
specifier|static
specifier|const
name|u8
name|IV20
index|[
literal|64
index|]
init|=
block|{
literal|0xff
block|,
literal|0xff
block|,
literal|0xff
block|,
literal|0xff
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|P20
index|[
literal|288
index|]
decl_stmt|;
specifier|static
specifier|const
name|u8
name|C20
index|[]
init|=
block|{
literal|0x56
block|,
literal|0xb3
block|,
literal|0x37
block|,
literal|0x3c
block|,
literal|0xa9
block|,
literal|0xef
block|,
literal|0x6e
block|,
literal|0x4a
block|,
literal|0x2b
block|,
literal|0x64
block|,
literal|0xfe
block|,
literal|0x1e
block|,
literal|0x9a
block|,
literal|0x17
block|,
literal|0xb6
block|,
literal|0x14
block|,
literal|0x25
block|,
literal|0xf1
block|,
literal|0x0d
block|,
literal|0x47
block|,
literal|0xa7
block|,
literal|0x5a
block|,
literal|0x5f
block|,
literal|0xce
block|,
literal|0x13
block|,
literal|0xef
block|,
literal|0xc6
block|,
literal|0xbc
block|,
literal|0x78
block|,
literal|0x4a
block|,
literal|0xf2
block|,
literal|0x4f
block|,
literal|0x41
block|,
literal|0x41
block|,
literal|0xbd
block|,
literal|0xd4
block|,
literal|0x8c
block|,
literal|0xf7
block|,
literal|0xc7
block|,
literal|0x70
block|,
literal|0x88
block|,
literal|0x7a
block|,
literal|0xfd
block|,
literal|0x57
block|,
literal|0x3c
block|,
literal|0xca
block|,
literal|0x54
block|,
literal|0x18
block|,
literal|0xa9
block|,
literal|0xae
block|,
literal|0xff
block|,
literal|0xcd
block|,
literal|0x7c
block|,
literal|0x5c
block|,
literal|0xed
block|,
literal|0xdf
block|,
literal|0xc6
block|,
literal|0xa7
block|,
literal|0x83
block|,
literal|0x97
block|,
literal|0xb9
block|,
literal|0xa8
block|,
literal|0x5b
block|,
literal|0x49
block|,
literal|0x9d
block|,
literal|0xa5
block|,
literal|0x58
block|,
literal|0x25
block|,
literal|0x72
block|,
literal|0x67
block|,
literal|0xca
block|,
literal|0xab
block|,
literal|0x2a
block|,
literal|0xd0
block|,
literal|0xb2
block|,
literal|0x3c
block|,
literal|0xa4
block|,
literal|0x76
block|,
literal|0xa5
block|,
literal|0x3c
block|,
literal|0xb1
block|,
literal|0x7f
block|,
literal|0xb4
block|,
literal|0x1c
block|,
literal|0x4b
block|,
literal|0x8b
block|,
literal|0x47
block|,
literal|0x5c
block|,
literal|0xb4
block|,
literal|0xf3
block|,
literal|0xf7
block|,
literal|0x16
block|,
literal|0x50
block|,
literal|0x94
block|,
literal|0xc2
block|,
literal|0x29
block|,
literal|0xc9
block|,
literal|0xe8
block|,
literal|0xc4
block|,
literal|0xdc
block|,
literal|0x0a
block|,
literal|0x2a
block|,
literal|0x5f
block|,
literal|0xf1
block|,
literal|0x90
block|,
literal|0x3e
block|,
literal|0x50
block|,
literal|0x15
block|,
literal|0x11
block|,
literal|0x22
block|,
literal|0x13
block|,
literal|0x76
block|,
literal|0xa1
block|,
literal|0xcd
block|,
literal|0xb8
block|,
literal|0x36
block|,
literal|0x4c
block|,
literal|0x50
block|,
literal|0x61
block|,
literal|0xa2
block|,
literal|0x0c
block|,
literal|0xae
block|,
literal|0x74
block|,
literal|0xbc
block|,
literal|0x4a
block|,
literal|0xcd
block|,
literal|0x76
block|,
literal|0xce
block|,
literal|0xb0
block|,
literal|0xab
block|,
literal|0xc9
block|,
literal|0xfd
block|,
literal|0x32
block|,
literal|0x17
block|,
literal|0xef
block|,
literal|0x9f
block|,
literal|0x8c
block|,
literal|0x90
block|,
literal|0xbe
block|,
literal|0x40
block|,
literal|0x2d
block|,
literal|0xdf
block|,
literal|0x6d
block|,
literal|0x86
block|,
literal|0x97
block|,
literal|0xf4
block|,
literal|0xf8
block|,
literal|0x80
block|,
literal|0xdf
block|,
literal|0xf1
block|,
literal|0x5b
block|,
literal|0xfb
block|,
literal|0x7a
block|,
literal|0x6b
block|,
literal|0x28
block|,
literal|0x24
block|,
literal|0x1e
block|,
literal|0xc8
block|,
literal|0xfe
block|,
literal|0x18
block|,
literal|0x3c
block|,
literal|0x2d
block|,
literal|0x59
block|,
literal|0xe3
block|,
literal|0xf9
block|,
literal|0xdf
block|,
literal|0xff
block|,
literal|0x65
block|,
literal|0x3c
block|,
literal|0x71
block|,
literal|0x26
block|,
literal|0xf0
block|,
literal|0xac
block|,
literal|0xb9
block|,
literal|0xe6
block|,
literal|0x42
block|,
literal|0x11
block|,
literal|0xf4
block|,
literal|0x2b
block|,
literal|0xae
block|,
literal|0x12
block|,
literal|0xaf
block|,
literal|0x46
block|,
literal|0x2b
block|,
literal|0x10
block|,
literal|0x70
block|,
literal|0xbe
block|,
literal|0xf1
block|,
literal|0xab
block|,
literal|0x5e
block|,
literal|0x36
block|,
literal|0x06
block|,
literal|0x87
block|,
literal|0x2c
block|,
literal|0xa1
block|,
literal|0x0d
block|,
literal|0xee
block|,
literal|0x15
block|,
literal|0xb3
block|,
literal|0x24
block|,
literal|0x9b
block|,
literal|0x1a
block|,
literal|0x1b
block|,
literal|0x95
block|,
literal|0x8f
block|,
literal|0x23
block|,
literal|0x13
block|,
literal|0x4c
block|,
literal|0x4b
block|,
literal|0xcc
block|,
literal|0xb7
block|,
literal|0xd0
block|,
literal|0x32
block|,
literal|0x00
block|,
literal|0xbc
block|,
literal|0xe4
block|,
literal|0x20
block|,
literal|0xa2
block|,
literal|0xf8
block|,
literal|0xeb
block|,
literal|0x66
block|,
literal|0xdc
block|,
literal|0xf3
block|,
literal|0x64
block|,
literal|0x4d
block|,
literal|0x14
block|,
literal|0x23
block|,
literal|0xc1
block|,
literal|0xb5
block|,
literal|0x69
block|,
literal|0x90
block|,
literal|0x03
block|,
literal|0xc1
block|,
literal|0x3e
block|,
literal|0xce
block|,
literal|0xf4
block|,
literal|0xbf
block|,
literal|0x38
block|,
literal|0xa3
block|,
literal|0xb6
block|,
literal|0x0e
block|,
literal|0xed
block|,
literal|0xc3
block|,
literal|0x40
block|,
literal|0x33
block|,
literal|0xba
block|,
literal|0xc1
block|,
literal|0x90
block|,
literal|0x27
block|,
literal|0x83
block|,
literal|0xdc
block|,
literal|0x6d
block|,
literal|0x89
block|,
literal|0xe2
block|,
literal|0xe7
block|,
literal|0x74
block|,
literal|0x18
block|,
literal|0x8a
block|,
literal|0x43
block|,
literal|0x9c
block|,
literal|0x7e
block|,
literal|0xbc
block|,
literal|0xc0
block|,
literal|0x67
block|,
literal|0x2d
block|,
literal|0xbd
block|,
literal|0xa4
block|,
literal|0xdd
block|,
literal|0xcf
block|,
literal|0xb2
block|,
literal|0x79
block|,
literal|0x46
block|,
literal|0x13
block|,
literal|0xb0
block|,
literal|0xbe
block|,
literal|0x41
block|,
literal|0x31
block|,
literal|0x5e
block|,
literal|0xf7
block|,
literal|0x78
block|,
literal|0x70
block|,
literal|0x8a
block|,
literal|0x70
block|,
literal|0xee
block|,
literal|0x7d
block|,
literal|0x75
block|,
literal|0x16
block|,
literal|0x5c
block|}
decl_stmt|;
specifier|static
specifier|const
name|u8
name|T20
index|[]
init|=
block|{
literal|0x8b
block|,
literal|0x30
block|,
literal|0x7f
block|,
literal|0x6b
block|,
literal|0x33
block|,
literal|0x28
block|,
literal|0x6d
block|,
literal|0x0a
block|,
literal|0xb0
block|,
literal|0x26
block|,
literal|0xa9
block|,
literal|0xed
block|,
literal|0x3f
block|,
literal|0xe1
block|,
literal|0xe8
block|,
literal|0x5f
block|}
decl_stmt|;
define|#
directive|define
name|TEST_CASE
parameter_list|(
name|n
parameter_list|)
value|do {                                    \         u8 out[sizeof(P##n)];                                   \         AES_set_encrypt_key(K##n,sizeof(K##n)*8,&key);          \         CRYPTO_gcm128_init(&ctx,&key,(block128_f)AES_encrypt);  \         CRYPTO_gcm128_setiv(&ctx,IV##n,sizeof(IV##n));          \         memset(out,0,sizeof(out));                              \         if (A##n) CRYPTO_gcm128_aad(&ctx,A##n,sizeof(A##n));    \         if (P##n) CRYPTO_gcm128_encrypt(&ctx,P##n,out,sizeof(out));     \         if (CRYPTO_gcm128_finish(&ctx,T##n,16) ||               \             (C##n&& memcmp(out,C##n,sizeof(out))))             \                 ret++, printf ("encrypt test#%d failed.\n",n);  \         CRYPTO_gcm128_setiv(&ctx,IV##n,sizeof(IV##n));          \         memset(out,0,sizeof(out));                              \         if (A##n) CRYPTO_gcm128_aad(&ctx,A##n,sizeof(A##n));    \         if (C##n) CRYPTO_gcm128_decrypt(&ctx,C##n,out,sizeof(out));     \         if (CRYPTO_gcm128_finish(&ctx,T##n,16) ||               \             (P##n&& memcmp(out,P##n,sizeof(out))))             \                 ret++, printf ("decrypt test#%d failed.\n",n);  \         } while(0)
name|int
name|main
parameter_list|()
block|{
name|GCM128_CONTEXT
name|ctx
decl_stmt|;
name|AES_KEY
name|key
decl_stmt|;
name|int
name|ret
init|=
literal|0
decl_stmt|;
name|TEST_CASE
argument_list|(
literal|1
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|2
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|3
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|4
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|5
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|6
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|7
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|8
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|9
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|10
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|11
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|12
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|13
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|14
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|15
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|16
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|17
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|18
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|19
argument_list|)
expr_stmt|;
name|TEST_CASE
argument_list|(
literal|20
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|OPENSSL_CPUID_OBJ
block|{
name|size_t
name|start
decl_stmt|,
name|stop
decl_stmt|,
name|gcm_t
decl_stmt|,
name|ctr_t
decl_stmt|,
name|OPENSSL_rdtsc
argument_list|()
decl_stmt|;
union|union
block|{
name|u64
name|u
decl_stmt|;
name|u8
name|c
index|[
literal|1024
index|]
decl_stmt|;
block|}
name|buf
union|;
name|int
name|i
decl_stmt|;
name|AES_set_encrypt_key
argument_list|(
name|K1
argument_list|,
sizeof|sizeof
argument_list|(
name|K1
argument_list|)
operator|*
literal|8
argument_list|,
operator|&
name|key
argument_list|)
expr_stmt|;
name|CRYPTO_gcm128_init
argument_list|(
operator|&
name|ctx
argument_list|,
operator|&
name|key
argument_list|,
operator|(
name|block128_f
operator|)
name|AES_encrypt
argument_list|)
expr_stmt|;
name|CRYPTO_gcm128_setiv
argument_list|(
operator|&
name|ctx
argument_list|,
name|IV1
argument_list|,
sizeof|sizeof
argument_list|(
name|IV1
argument_list|)
argument_list|)
expr_stmt|;
name|CRYPTO_gcm128_encrypt
argument_list|(
operator|&
name|ctx
argument_list|,
name|buf
operator|.
name|c
argument_list|,
name|buf
operator|.
name|c
argument_list|,
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|)
expr_stmt|;
name|start
operator|=
name|OPENSSL_rdtsc
argument_list|()
expr_stmt|;
name|CRYPTO_gcm128_encrypt
argument_list|(
operator|&
name|ctx
argument_list|,
name|buf
operator|.
name|c
argument_list|,
name|buf
operator|.
name|c
argument_list|,
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|)
expr_stmt|;
name|gcm_t
operator|=
name|OPENSSL_rdtsc
argument_list|()
operator|-
name|start
expr_stmt|;
name|CRYPTO_ctr128_encrypt
argument_list|(
name|buf
operator|.
name|c
argument_list|,
name|buf
operator|.
name|c
argument_list|,
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|,
operator|&
name|key
argument_list|,
name|ctx
operator|.
name|Yi
operator|.
name|c
argument_list|,
name|ctx
operator|.
name|EKi
operator|.
name|c
argument_list|,
operator|&
name|ctx
operator|.
name|mres
argument_list|,
operator|(
name|block128_f
operator|)
name|AES_encrypt
argument_list|)
expr_stmt|;
name|start
operator|=
name|OPENSSL_rdtsc
argument_list|()
expr_stmt|;
name|CRYPTO_ctr128_encrypt
argument_list|(
name|buf
operator|.
name|c
argument_list|,
name|buf
operator|.
name|c
argument_list|,
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|,
operator|&
name|key
argument_list|,
name|ctx
operator|.
name|Yi
operator|.
name|c
argument_list|,
name|ctx
operator|.
name|EKi
operator|.
name|c
argument_list|,
operator|&
name|ctx
operator|.
name|mres
argument_list|,
operator|(
name|block128_f
operator|)
name|AES_encrypt
argument_list|)
expr_stmt|;
name|ctr_t
operator|=
name|OPENSSL_rdtsc
argument_list|()
operator|-
name|start
expr_stmt|;
name|printf
argument_list|(
literal|"%.2f-%.2f=%.2f\n"
argument_list|,
name|gcm_t
operator|/
operator|(
name|double
operator|)
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|,
name|ctr_t
operator|/
operator|(
name|double
operator|)
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|,
operator|(
name|gcm_t
operator|-
name|ctr_t
operator|)
operator|/
operator|(
name|double
operator|)
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|GHASH
block|{
name|void
function_decl|(
modifier|*
name|gcm_ghash_p
function_decl|)
parameter_list|(
name|u64
name|Xi
index|[
literal|2
index|]
parameter_list|,
specifier|const
name|u128
name|Htable
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|u8
modifier|*
name|inp
parameter_list|,
name|size_t
name|len
parameter_list|)
init|=
name|ctx
operator|.
name|ghash
function_decl|;
name|GHASH
argument_list|(
operator|(
operator|&
name|ctx
operator|)
argument_list|,
name|buf
operator|.
name|c
argument_list|,
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|)
expr_stmt|;
name|start
operator|=
name|OPENSSL_rdtsc
argument_list|()
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|100
condition|;
operator|++
name|i
control|)
name|GHASH
argument_list|(
operator|(
operator|&
name|ctx
operator|)
argument_list|,
name|buf
operator|.
name|c
argument_list|,
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|)
expr_stmt|;
name|gcm_t
operator|=
name|OPENSSL_rdtsc
argument_list|()
operator|-
name|start
expr_stmt|;
name|printf
argument_list|(
literal|"%.2f\n"
argument_list|,
name|gcm_t
operator|/
operator|(
name|double
operator|)
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
operator|/
operator|(
name|double
operator|)
name|i
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
block|}
endif|#
directive|endif
return|return
name|ret
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

end_unit

