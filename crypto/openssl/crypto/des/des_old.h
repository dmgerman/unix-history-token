begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* crypto/des/des_old.h -*- mode:C; c-file-style: "eay" -*- */
end_comment

begin_comment
comment|/* WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING  *  * The function names in here are deprecated and are only present to  * provide an interface compatible with openssl 0.9.6 and older as  * well as libdes.  OpenSSL now provides functions where "des_" has  * been replaced with "DES_" in the names, to make it possible to  * make incompatible changes that are needed for C type security and  * other stuff.  *  * This include files has two compatibility modes:  *  *   - If OPENSSL_DES_LIBDES_COMPATIBILITY is defined, you get an API  *     that is compatible with libdes and SSLeay.  *   - If OPENSSL_DES_LIBDES_COMPATIBILITY isn't defined, you get an  *     API that is compatible with OpenSSL 0.9.5x to 0.9.6x.  *  * Note that these modes break earlier snapshots of OpenSSL, where  * libdes compatibility was the only available mode or (later on) the  * prefered compatibility mode.  However, after much consideration  * (and more or less violent discussions with external parties), it  * was concluded that OpenSSL should be compatible with earlier versions  * of itself before anything else.  Also, in all honesty, libdes is  * an old beast that shouldn't really be used any more.  *  * Please consider starting to use the DES_ functions rather than the  * des_ ones.  The des_ functions will disappear completely before  * OpenSSL 1.0!  *  * WARNING WARNING WARNING WARNING WARNING WARNING WARNING WARNING  */
end_comment

begin_comment
comment|/* Written by Richard Levitte (richard@levitte.org) for the OpenSSL  * project 2001.  */
end_comment

begin_comment
comment|/* ====================================================================  * Copyright (c) 1998-2002 The OpenSSL Project.  All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  *  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.   *  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in  *    the documentation and/or other materials provided with the  *    distribution.  *  * 3. All advertising materials mentioning features or use of this  *    software must display the following acknowledgment:  *    "This product includes software developed by the OpenSSL Project  *    for use in the OpenSSL Toolkit. (http://www.openssl.org/)"  *  * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to  *    endorse or promote products derived from this software without  *    prior written permission. For written permission, please contact  *    openssl-core@openssl.org.  *  * 5. Products derived from this software may not be called "OpenSSL"  *    nor may "OpenSSL" appear in their names without prior written  *    permission of the OpenSSL Project.  *  * 6. Redistributions of any form whatsoever must retain the following  *    acknowledgment:  *    "This product includes software developed by the OpenSSL Project  *    for use in the OpenSSL Toolkit (http://www.openssl.org/)"  *  * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY  * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR  * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,  * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT  * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED  * OF THE POSSIBILITY OF SUCH DAMAGE.  * ====================================================================  *  * This product includes cryptographic software written by Eric Young  * (eay@cryptsoft.com).  This product includes software written by Tim  * Hudson (tjh@cryptsoft.com).  *  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|HEADER_DES_H
end_ifndef

begin_define
define|#
directive|define
name|HEADER_DES_H
end_define

begin_ifdef
ifdef|#
directive|ifdef
name|OPENSSL_NO_DES
end_ifdef

begin_error
error|#
directive|error
error|DES is disabled.
end_error

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|HEADER_NEW_DES_H
end_ifndef

begin_error
error|#
directive|error
error|You must include des.h, not des_old.h directly.
end_error

begin_endif
endif|#
directive|endif
end_endif

begin_ifdef
ifdef|#
directive|ifdef
name|_KERBEROS_DES_H
end_ifdef

begin_error
error|#
directive|error
literal|<openssl/des_old.h>
error|replaces<kerberos/des.h>.
end_error

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<openssl/opensslconf.h>
end_include

begin_comment
comment|/* DES_LONG */
end_comment

begin_include
include|#
directive|include
file|<openssl/e_os2.h>
end_include

begin_comment
comment|/* OPENSSL_EXTERN */
end_comment

begin_include
include|#
directive|include
file|<openssl/symhacks.h>
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|OPENSSL_BUILD_SHLIBCRYPTO
end_ifdef

begin_undef
undef|#
directive|undef
name|OPENSSL_EXTERN
end_undef

begin_define
define|#
directive|define
name|OPENSSL_EXTERN
value|OPENSSL_EXPORT
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_ifdef
ifdef|#
directive|ifdef
name|__cplusplus
end_ifdef

begin_extern
extern|extern
literal|"C"
block|{
endif|#
directive|endif
typedef|typedef
name|unsigned
name|char
name|_ossl_old_des_cblock
index|[
literal|8
index|]
typedef|;
typedef|typedef
struct|struct
name|_ossl_old_des_ks_struct
block|{
union|union
block|{
name|_ossl_old_des_cblock
name|_
decl_stmt|;
comment|/* make sure things are correct size on machines with 		 * 8 byte longs */
name|DES_LONG
name|pad
index|[
literal|2
index|]
decl_stmt|;
block|}
name|ks
union|;
block|}
name|_ossl_old_des_key_schedule
index|[
literal|16
index|]
typedef|;
ifndef|#
directive|ifndef
name|OPENSSL_DES_LIBDES_COMPATIBILITY
define|#
directive|define
name|des_cblock
value|DES_cblock
define|#
directive|define
name|const_des_cblock
value|const_DES_cblock
define|#
directive|define
name|des_key_schedule
value|DES_key_schedule
define|#
directive|define
name|des_ecb3_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|k3
parameter_list|,
name|e
parameter_list|)
define|\
value|DES_ecb3_encrypt((i),(o),&(k1),&(k2),&(k3),(e))
define|#
directive|define
name|des_ede3_cbc_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|k3
parameter_list|,
name|iv
parameter_list|,
name|e
parameter_list|)
define|\
value|DES_ede3_cbc_encrypt((i),(o),(l),&(k1),&(k2),&(k3),(iv),(e))
define|#
directive|define
name|des_ede3_cbcm_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|k3
parameter_list|,
name|iv1
parameter_list|,
name|iv2
parameter_list|,
name|e
parameter_list|)
define|\
value|DES_ede3_cbcm_encrypt((i),(o),(l),&(k1),&(k2),&(k3),(iv1),(iv2),(e))
define|#
directive|define
name|des_ede3_cfb64_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|k3
parameter_list|,
name|iv
parameter_list|,
name|n
parameter_list|,
name|e
parameter_list|)
define|\
value|DES_ede3_cfb64_encrypt((i),(o),(l),&(k1),&(k2),&(k3),(iv),(n),(e))
define|#
directive|define
name|des_ede3_ofb64_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|k3
parameter_list|,
name|iv
parameter_list|,
name|n
parameter_list|)
define|\
value|DES_ede3_ofb64_encrypt((i),(o),(l),&(k1),&(k2),&(k3),(iv),(n))
define|#
directive|define
name|des_options
parameter_list|()
define|\
value|DES_options()
define|#
directive|define
name|des_cbc_cksum
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|)
define|\
value|DES_cbc_cksum((i),(o),(l),&(k),(iv))
define|#
directive|define
name|des_cbc_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|,
name|e
parameter_list|)
define|\
value|DES_cbc_encrypt((i),(o),(l),&(k),(iv),(e))
define|#
directive|define
name|des_ncbc_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|,
name|e
parameter_list|)
define|\
value|DES_ncbc_encrypt((i),(o),(l),&(k),(iv),(e))
define|#
directive|define
name|des_xcbc_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|,
name|inw
parameter_list|,
name|outw
parameter_list|,
name|e
parameter_list|)
define|\
value|DES_xcbc_encrypt((i),(o),(l),&(k),(iv),(inw),(outw),(e))
define|#
directive|define
name|des_cfb_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|n
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|,
name|e
parameter_list|)
define|\
value|DES_cfb_encrypt((i),(o),(n),(l),&(k),(iv),(e))
define|#
directive|define
name|des_ecb_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|k
parameter_list|,
name|e
parameter_list|)
define|\
value|DES_ecb_encrypt((i),(o),&(k),(e))
define|#
directive|define
name|des_encrypt1
parameter_list|(
name|d
parameter_list|,
name|k
parameter_list|,
name|e
parameter_list|)
define|\
value|DES_encrypt1((d),&(k),(e))
define|#
directive|define
name|des_encrypt2
parameter_list|(
name|d
parameter_list|,
name|k
parameter_list|,
name|e
parameter_list|)
define|\
value|DES_encrypt2((d),&(k),(e))
define|#
directive|define
name|des_encrypt3
parameter_list|(
name|d
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|k3
parameter_list|)
define|\
value|DES_encrypt3((d),&(k1),&(k2),&(k3))
define|#
directive|define
name|des_decrypt3
parameter_list|(
name|d
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|k3
parameter_list|)
define|\
value|DES_decrypt3((d),&(k1),&(k2),&(k3))
define|#
directive|define
name|des_xwhite_in2out
parameter_list|(
name|k
parameter_list|,
name|i
parameter_list|,
name|o
parameter_list|)
define|\
value|DES_xwhite_in2out((k),(i),(o))
define|#
directive|define
name|des_enc_read
parameter_list|(
name|f
parameter_list|,
name|b
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|)
define|\
value|DES_enc_read((f),(b),(l),&(k),(iv))
define|#
directive|define
name|des_enc_write
parameter_list|(
name|f
parameter_list|,
name|b
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|)
define|\
value|DES_enc_write((f),(b),(l),&(k),(iv))
define|#
directive|define
name|des_fcrypt
parameter_list|(
name|b
parameter_list|,
name|s
parameter_list|,
name|r
parameter_list|)
define|\
value|DES_fcrypt((b),(s),(r))
define|#
directive|define
name|des_crypt
parameter_list|(
name|b
parameter_list|,
name|s
parameter_list|)
define|\
value|DES_crypt((b),(s))
if|#
directive|if
literal|0
if|#
directive|if
operator|!
name|defined
argument_list|(
name|PERL5
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|__FreeBSD__
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|NeXT
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|__OpenBSD__
argument_list|)
define|#
directive|define
name|crypt
parameter_list|(
name|b
parameter_list|,
name|s
parameter_list|)
define|\
value|DES_crypt((b),(s))
endif|#
directive|endif
endif|#
directive|endif
define|#
directive|define
name|des_ofb_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|n
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|)
define|\
value|DES_ofb_encrypt((i),(o),(n),(l),&(k),(iv))
define|#
directive|define
name|des_pcbc_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|,
name|e
parameter_list|)
define|\
value|DES_pcbc_encrypt((i),(o),(l),&(k),(iv),(e))
define|#
directive|define
name|des_quad_cksum
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|c
parameter_list|,
name|s
parameter_list|)
define|\
value|DES_quad_cksum((i),(o),(l),(c),(s))
define|#
directive|define
name|des_random_seed
parameter_list|(
name|k
parameter_list|)
define|\
value|_ossl_096_des_random_seed((k))
define|#
directive|define
name|des_random_key
parameter_list|(
name|r
parameter_list|)
define|\
value|DES_random_key((r))
define|#
directive|define
name|des_read_password
parameter_list|(
name|k
parameter_list|,
name|p
parameter_list|,
name|v
parameter_list|)
define|\
value|DES_read_password((k),(p),(v))
define|#
directive|define
name|des_read_2passwords
parameter_list|(
name|k1
parameter_list|,
name|k2
parameter_list|,
name|p
parameter_list|,
name|v
parameter_list|)
define|\
value|DES_read_2passwords((k1),(k2),(p),(v))
define|#
directive|define
name|des_set_odd_parity
parameter_list|(
name|k
parameter_list|)
define|\
value|DES_set_odd_parity((k))
define|#
directive|define
name|des_check_key_parity
parameter_list|(
name|k
parameter_list|)
define|\
value|DES_check_key_parity((k))
define|#
directive|define
name|des_is_weak_key
parameter_list|(
name|k
parameter_list|)
define|\
value|DES_is_weak_key((k))
define|#
directive|define
name|des_set_key
parameter_list|(
name|k
parameter_list|,
name|ks
parameter_list|)
define|\
value|DES_set_key((k),&(ks))
define|#
directive|define
name|des_key_sched
parameter_list|(
name|k
parameter_list|,
name|ks
parameter_list|)
define|\
value|DES_key_sched((k),&(ks))
define|#
directive|define
name|des_set_key_checked
parameter_list|(
name|k
parameter_list|,
name|ks
parameter_list|)
define|\
value|DES_set_key_checked((k),&(ks))
define|#
directive|define
name|des_set_key_unchecked
parameter_list|(
name|k
parameter_list|,
name|ks
parameter_list|)
define|\
value|DES_set_key_unchecked((k),&(ks))
define|#
directive|define
name|des_string_to_key
parameter_list|(
name|s
parameter_list|,
name|k
parameter_list|)
define|\
value|DES_string_to_key((s),(k))
define|#
directive|define
name|des_string_to_2keys
parameter_list|(
name|s
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|)
define|\
value|DES_string_to_2keys((s),(k1),(k2))
define|#
directive|define
name|des_cfb64_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|ks
parameter_list|,
name|iv
parameter_list|,
name|n
parameter_list|,
name|e
parameter_list|)
define|\
value|DES_cfb64_encrypt((i),(o),(l),&(ks),(iv),(n),(e))
define|#
directive|define
name|des_ofb64_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|ks
parameter_list|,
name|iv
parameter_list|,
name|n
parameter_list|)
define|\
value|DES_ofb64_encrypt((i),(o),(l),&(ks),(iv),(n))
define|#
directive|define
name|des_ecb2_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|e
parameter_list|)
define|\
value|des_ecb3_encrypt((i),(o),(k1),(k2),(k1),(e))
define|#
directive|define
name|des_ede2_cbc_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|iv
parameter_list|,
name|e
parameter_list|)
define|\
value|des_ede3_cbc_encrypt((i),(o),(l),(k1),(k2),(k1),(iv),(e))
define|#
directive|define
name|des_ede2_cfb64_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|iv
parameter_list|,
name|n
parameter_list|,
name|e
parameter_list|)
define|\
value|des_ede3_cfb64_encrypt((i),(o),(l),(k1),(k2),(k1),(iv),(n),(e))
define|#
directive|define
name|des_ede2_ofb64_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|iv
parameter_list|,
name|n
parameter_list|)
define|\
value|des_ede3_ofb64_encrypt((i),(o),(l),(k1),(k2),(k1),(iv),(n))
define|#
directive|define
name|des_check_key
value|DES_check_key
define|#
directive|define
name|des_rw_mode
value|DES_rw_mode
else|#
directive|else
comment|/* libdes compatibility */
comment|/* Map all symbol names to _ossl_old_des_* form, so we avoid all    clashes with libdes */
define|#
directive|define
name|des_cblock
value|_ossl_old_des_cblock
define|#
directive|define
name|des_key_schedule
value|_ossl_old_des_key_schedule
define|#
directive|define
name|des_ecb3_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|k3
parameter_list|,
name|e
parameter_list|)
define|\
value|_ossl_old_des_ecb3_encrypt((i),(o),(k1),(k2),(k3),(e))
define|#
directive|define
name|des_ede3_cbc_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|k3
parameter_list|,
name|iv
parameter_list|,
name|e
parameter_list|)
define|\
value|_ossl_old_des_ede3_cbc_encrypt((i),(o),(l),(k1),(k2),(k3),(iv),(e))
define|#
directive|define
name|des_ede3_cfb64_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|k3
parameter_list|,
name|iv
parameter_list|,
name|n
parameter_list|,
name|e
parameter_list|)
define|\
value|_ossl_old_des_ede3_cfb64_encrypt((i),(o),(l),(k1),(k2),(k3),(iv),(n),(e))
define|#
directive|define
name|des_ede3_ofb64_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|k3
parameter_list|,
name|iv
parameter_list|,
name|n
parameter_list|)
define|\
value|_ossl_old_des_ede3_ofb64_encrypt((i),(o),(l),(k1),(k2),(k3),(iv),(n))
define|#
directive|define
name|des_options
parameter_list|()
define|\
value|_ossl_old_des_options()
define|#
directive|define
name|des_cbc_cksum
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|)
define|\
value|_ossl_old_des_cbc_cksum((i),(o),(l),(k),(iv))
define|#
directive|define
name|des_cbc_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|,
name|e
parameter_list|)
define|\
value|_ossl_old_des_cbc_encrypt((i),(o),(l),(k),(iv),(e))
define|#
directive|define
name|des_ncbc_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|,
name|e
parameter_list|)
define|\
value|_ossl_old_des_ncbc_encrypt((i),(o),(l),(k),(iv),(e))
define|#
directive|define
name|des_xcbc_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|,
name|inw
parameter_list|,
name|outw
parameter_list|,
name|e
parameter_list|)
define|\
value|_ossl_old_des_xcbc_encrypt((i),(o),(l),(k),(iv),(inw),(outw),(e))
define|#
directive|define
name|des_cfb_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|n
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|,
name|e
parameter_list|)
define|\
value|_ossl_old_des_cfb_encrypt((i),(o),(n),(l),(k),(iv),(e))
define|#
directive|define
name|des_ecb_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|k
parameter_list|,
name|e
parameter_list|)
define|\
value|_ossl_old_des_ecb_encrypt((i),(o),(k),(e))
define|#
directive|define
name|des_encrypt
parameter_list|(
name|d
parameter_list|,
name|k
parameter_list|,
name|e
parameter_list|)
define|\
value|_ossl_old_des_encrypt((d),(k),(e))
define|#
directive|define
name|des_encrypt2
parameter_list|(
name|d
parameter_list|,
name|k
parameter_list|,
name|e
parameter_list|)
define|\
value|_ossl_old_des_encrypt2((d),(k),(e))
define|#
directive|define
name|des_encrypt3
parameter_list|(
name|d
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|k3
parameter_list|)
define|\
value|_ossl_old_des_encrypt3((d),(k1),(k2),(k3))
define|#
directive|define
name|des_decrypt3
parameter_list|(
name|d
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|k3
parameter_list|)
define|\
value|_ossl_old_des_decrypt3((d),(k1),(k2),(k3))
define|#
directive|define
name|des_xwhite_in2out
parameter_list|(
name|k
parameter_list|,
name|i
parameter_list|,
name|o
parameter_list|)
define|\
value|_ossl_old_des_xwhite_in2out((k),(i),(o))
define|#
directive|define
name|des_enc_read
parameter_list|(
name|f
parameter_list|,
name|b
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|)
define|\
value|_ossl_old_des_enc_read((f),(b),(l),(k),(iv))
define|#
directive|define
name|des_enc_write
parameter_list|(
name|f
parameter_list|,
name|b
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|)
define|\
value|_ossl_old_des_enc_write((f),(b),(l),(k),(iv))
define|#
directive|define
name|des_fcrypt
parameter_list|(
name|b
parameter_list|,
name|s
parameter_list|,
name|r
parameter_list|)
define|\
value|_ossl_old_des_fcrypt((b),(s),(r))
define|#
directive|define
name|des_crypt
parameter_list|(
name|b
parameter_list|,
name|s
parameter_list|)
define|\
value|_ossl_old_des_crypt((b),(s))
if|#
directive|if
literal|0
define|#
directive|define
name|crypt
parameter_list|(
name|b
parameter_list|,
name|s
parameter_list|)
define|\
value|_ossl_old_crypt((b),(s))
endif|#
directive|endif
define|#
directive|define
name|des_ofb_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|n
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|)
define|\
value|_ossl_old_des_ofb_encrypt((i),(o),(n),(l),(k),(iv))
define|#
directive|define
name|des_pcbc_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k
parameter_list|,
name|iv
parameter_list|,
name|e
parameter_list|)
define|\
value|_ossl_old_des_pcbc_encrypt((i),(o),(l),(k),(iv),(e))
define|#
directive|define
name|des_quad_cksum
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|c
parameter_list|,
name|s
parameter_list|)
define|\
value|_ossl_old_des_quad_cksum((i),(o),(l),(c),(s))
define|#
directive|define
name|des_random_seed
parameter_list|(
name|k
parameter_list|)
define|\
value|_ossl_old_des_random_seed((k))
define|#
directive|define
name|des_random_key
parameter_list|(
name|r
parameter_list|)
define|\
value|_ossl_old_des_random_key((r))
define|#
directive|define
name|des_read_password
parameter_list|(
name|k
parameter_list|,
name|p
parameter_list|,
name|v
parameter_list|)
define|\
value|_ossl_old_des_read_password((k),(p),(v))
define|#
directive|define
name|des_read_2passwords
parameter_list|(
name|k1
parameter_list|,
name|k2
parameter_list|,
name|p
parameter_list|,
name|v
parameter_list|)
define|\
value|_ossl_old_des_read_2passwords((k1),(k2),(p),(v))
define|#
directive|define
name|des_set_odd_parity
parameter_list|(
name|k
parameter_list|)
define|\
value|_ossl_old_des_set_odd_parity((k))
define|#
directive|define
name|des_is_weak_key
parameter_list|(
name|k
parameter_list|)
define|\
value|_ossl_old_des_is_weak_key((k))
define|#
directive|define
name|des_set_key
parameter_list|(
name|k
parameter_list|,
name|ks
parameter_list|)
define|\
value|_ossl_old_des_set_key((k),(ks))
define|#
directive|define
name|des_key_sched
parameter_list|(
name|k
parameter_list|,
name|ks
parameter_list|)
define|\
value|_ossl_old_des_key_sched((k),(ks))
define|#
directive|define
name|des_string_to_key
parameter_list|(
name|s
parameter_list|,
name|k
parameter_list|)
define|\
value|_ossl_old_des_string_to_key((s),(k))
define|#
directive|define
name|des_string_to_2keys
parameter_list|(
name|s
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|)
define|\
value|_ossl_old_des_string_to_2keys((s),(k1),(k2))
define|#
directive|define
name|des_cfb64_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|ks
parameter_list|,
name|iv
parameter_list|,
name|n
parameter_list|,
name|e
parameter_list|)
define|\
value|_ossl_old_des_cfb64_encrypt((i),(o),(l),(ks),(iv),(n),(e))
define|#
directive|define
name|des_ofb64_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|ks
parameter_list|,
name|iv
parameter_list|,
name|n
parameter_list|)
define|\
value|_ossl_old_des_ofb64_encrypt((i),(o),(l),(ks),(iv),(n))
define|#
directive|define
name|des_ecb2_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|e
parameter_list|)
define|\
value|des_ecb3_encrypt((i),(o),(k1),(k2),(k1),(e))
define|#
directive|define
name|des_ede2_cbc_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|iv
parameter_list|,
name|e
parameter_list|)
define|\
value|des_ede3_cbc_encrypt((i),(o),(l),(k1),(k2),(k1),(iv),(e))
define|#
directive|define
name|des_ede2_cfb64_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|iv
parameter_list|,
name|n
parameter_list|,
name|e
parameter_list|)
define|\
value|des_ede3_cfb64_encrypt((i),(o),(l),(k1),(k2),(k1),(iv),(n),(e))
define|#
directive|define
name|des_ede2_ofb64_encrypt
parameter_list|(
name|i
parameter_list|,
name|o
parameter_list|,
name|l
parameter_list|,
name|k1
parameter_list|,
name|k2
parameter_list|,
name|iv
parameter_list|,
name|n
parameter_list|)
define|\
value|des_ede3_ofb64_encrypt((i),(o),(l),(k1),(k2),(k1),(iv),(n))
define|#
directive|define
name|des_check_key
value|DES_check_key
define|#
directive|define
name|des_rw_mode
value|DES_rw_mode
endif|#
directive|endif
specifier|const
name|char
modifier|*
name|_ossl_old_des_options
parameter_list|(
name|void
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_ecb3_encrypt
parameter_list|(
name|_ossl_old_des_cblock
modifier|*
name|input
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|output
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks1
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks2
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks3
parameter_list|,
name|int
name|enc
parameter_list|)
function_decl|;
name|DES_LONG
name|_ossl_old_des_cbc_cksum
parameter_list|(
name|_ossl_old_des_cblock
modifier|*
name|input
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|output
parameter_list|,
name|long
name|length
parameter_list|,
name|_ossl_old_des_key_schedule
name|schedule
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|ivec
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_cbc_encrypt
parameter_list|(
name|_ossl_old_des_cblock
modifier|*
name|input
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|output
parameter_list|,
name|long
name|length
parameter_list|,
name|_ossl_old_des_key_schedule
name|schedule
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|ivec
parameter_list|,
name|int
name|enc
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_ncbc_encrypt
parameter_list|(
name|_ossl_old_des_cblock
modifier|*
name|input
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|output
parameter_list|,
name|long
name|length
parameter_list|,
name|_ossl_old_des_key_schedule
name|schedule
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|ivec
parameter_list|,
name|int
name|enc
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_xcbc_encrypt
parameter_list|(
name|_ossl_old_des_cblock
modifier|*
name|input
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|output
parameter_list|,
name|long
name|length
parameter_list|,
name|_ossl_old_des_key_schedule
name|schedule
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|ivec
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|inw
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|outw
parameter_list|,
name|int
name|enc
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_cfb_encrypt
parameter_list|(
name|unsigned
name|char
modifier|*
name|in
parameter_list|,
name|unsigned
name|char
modifier|*
name|out
parameter_list|,
name|int
name|numbits
parameter_list|,
name|long
name|length
parameter_list|,
name|_ossl_old_des_key_schedule
name|schedule
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|ivec
parameter_list|,
name|int
name|enc
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_ecb_encrypt
parameter_list|(
name|_ossl_old_des_cblock
modifier|*
name|input
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|output
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks
parameter_list|,
name|int
name|enc
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_encrypt
parameter_list|(
name|DES_LONG
modifier|*
name|data
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks
parameter_list|,
name|int
name|enc
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_encrypt2
parameter_list|(
name|DES_LONG
modifier|*
name|data
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks
parameter_list|,
name|int
name|enc
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_encrypt3
parameter_list|(
name|DES_LONG
modifier|*
name|data
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks1
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks2
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks3
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_decrypt3
parameter_list|(
name|DES_LONG
modifier|*
name|data
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks1
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks2
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks3
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_ede3_cbc_encrypt
parameter_list|(
name|_ossl_old_des_cblock
modifier|*
name|input
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|output
parameter_list|,
name|long
name|length
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks1
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks2
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks3
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|ivec
parameter_list|,
name|int
name|enc
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_ede3_cfb64_encrypt
parameter_list|(
name|unsigned
name|char
modifier|*
name|in
parameter_list|,
name|unsigned
name|char
modifier|*
name|out
parameter_list|,
name|long
name|length
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks1
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks2
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks3
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|ivec
parameter_list|,
name|int
modifier|*
name|num
parameter_list|,
name|int
name|enc
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_ede3_ofb64_encrypt
parameter_list|(
name|unsigned
name|char
modifier|*
name|in
parameter_list|,
name|unsigned
name|char
modifier|*
name|out
parameter_list|,
name|long
name|length
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks1
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks2
parameter_list|,
name|_ossl_old_des_key_schedule
name|ks3
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|ivec
parameter_list|,
name|int
modifier|*
name|num
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_xwhite_in2out
argument_list|(
name|_ossl_old_des_cblock
argument_list|(
operator|*
name|des_key
argument_list|)
argument_list|,
name|_ossl_old_des_cblock
argument_list|(
operator|*
name|in_white
argument_list|)
argument_list|,
name|_ossl_old_des_cblock
argument_list|(
operator|*
name|out_white
argument_list|)
argument_list|)
decl_stmt|;
name|int
name|_ossl_old_des_enc_read
parameter_list|(
name|int
name|fd
parameter_list|,
name|char
modifier|*
name|buf
parameter_list|,
name|int
name|len
parameter_list|,
name|_ossl_old_des_key_schedule
name|sched
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|iv
parameter_list|)
function_decl|;
name|int
name|_ossl_old_des_enc_write
parameter_list|(
name|int
name|fd
parameter_list|,
name|char
modifier|*
name|buf
parameter_list|,
name|int
name|len
parameter_list|,
name|_ossl_old_des_key_schedule
name|sched
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|iv
parameter_list|)
function_decl|;
name|char
modifier|*
name|_ossl_old_des_fcrypt
parameter_list|(
specifier|const
name|char
modifier|*
name|buf
parameter_list|,
specifier|const
name|char
modifier|*
name|salt
parameter_list|,
name|char
modifier|*
name|ret
parameter_list|)
function_decl|;
name|char
modifier|*
name|_ossl_old_des_crypt
parameter_list|(
specifier|const
name|char
modifier|*
name|buf
parameter_list|,
specifier|const
name|char
modifier|*
name|salt
parameter_list|)
function_decl|;
if|#
directive|if
operator|!
name|defined
argument_list|(
name|PERL5
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|NeXT
argument_list|)
name|char
modifier|*
name|_ossl_old_crypt
parameter_list|(
specifier|const
name|char
modifier|*
name|buf
parameter_list|,
specifier|const
name|char
modifier|*
name|salt
parameter_list|)
function_decl|;
endif|#
directive|endif
name|void
name|_ossl_old_des_ofb_encrypt
parameter_list|(
name|unsigned
name|char
modifier|*
name|in
parameter_list|,
name|unsigned
name|char
modifier|*
name|out
parameter_list|,
name|int
name|numbits
parameter_list|,
name|long
name|length
parameter_list|,
name|_ossl_old_des_key_schedule
name|schedule
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|ivec
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_pcbc_encrypt
parameter_list|(
name|_ossl_old_des_cblock
modifier|*
name|input
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|output
parameter_list|,
name|long
name|length
parameter_list|,
name|_ossl_old_des_key_schedule
name|schedule
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|ivec
parameter_list|,
name|int
name|enc
parameter_list|)
function_decl|;
name|DES_LONG
name|_ossl_old_des_quad_cksum
parameter_list|(
name|_ossl_old_des_cblock
modifier|*
name|input
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|output
parameter_list|,
name|long
name|length
parameter_list|,
name|int
name|out_count
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|seed
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_random_seed
parameter_list|(
name|_ossl_old_des_cblock
name|key
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_random_key
parameter_list|(
name|_ossl_old_des_cblock
name|ret
parameter_list|)
function_decl|;
name|int
name|_ossl_old_des_read_password
parameter_list|(
name|_ossl_old_des_cblock
modifier|*
name|key
parameter_list|,
specifier|const
name|char
modifier|*
name|prompt
parameter_list|,
name|int
name|verify
parameter_list|)
function_decl|;
name|int
name|_ossl_old_des_read_2passwords
parameter_list|(
name|_ossl_old_des_cblock
modifier|*
name|key1
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|key2
parameter_list|,
specifier|const
name|char
modifier|*
name|prompt
parameter_list|,
name|int
name|verify
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_set_odd_parity
parameter_list|(
name|_ossl_old_des_cblock
modifier|*
name|key
parameter_list|)
function_decl|;
name|int
name|_ossl_old_des_is_weak_key
parameter_list|(
name|_ossl_old_des_cblock
modifier|*
name|key
parameter_list|)
function_decl|;
name|int
name|_ossl_old_des_set_key
parameter_list|(
name|_ossl_old_des_cblock
modifier|*
name|key
parameter_list|,
name|_ossl_old_des_key_schedule
name|schedule
parameter_list|)
function_decl|;
name|int
name|_ossl_old_des_key_sched
parameter_list|(
name|_ossl_old_des_cblock
modifier|*
name|key
parameter_list|,
name|_ossl_old_des_key_schedule
name|schedule
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_string_to_key
parameter_list|(
name|char
modifier|*
name|str
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|key
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_string_to_2keys
parameter_list|(
name|char
modifier|*
name|str
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|key1
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|key2
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_cfb64_encrypt
parameter_list|(
name|unsigned
name|char
modifier|*
name|in
parameter_list|,
name|unsigned
name|char
modifier|*
name|out
parameter_list|,
name|long
name|length
parameter_list|,
name|_ossl_old_des_key_schedule
name|schedule
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|ivec
parameter_list|,
name|int
modifier|*
name|num
parameter_list|,
name|int
name|enc
parameter_list|)
function_decl|;
name|void
name|_ossl_old_des_ofb64_encrypt
parameter_list|(
name|unsigned
name|char
modifier|*
name|in
parameter_list|,
name|unsigned
name|char
modifier|*
name|out
parameter_list|,
name|long
name|length
parameter_list|,
name|_ossl_old_des_key_schedule
name|schedule
parameter_list|,
name|_ossl_old_des_cblock
modifier|*
name|ivec
parameter_list|,
name|int
modifier|*
name|num
parameter_list|)
function_decl|;
name|void
name|_ossl_096_des_random_seed
parameter_list|(
name|des_cblock
modifier|*
name|key
parameter_list|)
function_decl|;
comment|/* The following definitions provide compatibility with the MIT Kerberos  * library. The _ossl_old_des_key_schedule structure is not binary compatible. */
define|#
directive|define
name|_KERBEROS_DES_H
define|#
directive|define
name|KRBDES_ENCRYPT
value|DES_ENCRYPT
define|#
directive|define
name|KRBDES_DECRYPT
value|DES_DECRYPT
ifdef|#
directive|ifdef
name|KERBEROS
define|#
directive|define
name|ENCRYPT
value|DES_ENCRYPT
define|#
directive|define
name|DECRYPT
value|DES_DECRYPT
endif|#
directive|endif
ifndef|#
directive|ifndef
name|NCOMPAT
define|#
directive|define
name|C_Block
value|des_cblock
define|#
directive|define
name|Key_schedule
value|des_key_schedule
define|#
directive|define
name|KEY_SZ
value|DES_KEY_SZ
define|#
directive|define
name|string_to_key
value|des_string_to_key
define|#
directive|define
name|read_pw_string
value|des_read_pw_string
define|#
directive|define
name|random_key
value|des_random_key
define|#
directive|define
name|pcbc_encrypt
value|des_pcbc_encrypt
define|#
directive|define
name|set_key
value|des_set_key
define|#
directive|define
name|key_sched
value|des_key_sched
define|#
directive|define
name|ecb_encrypt
value|des_ecb_encrypt
define|#
directive|define
name|cbc_encrypt
value|des_cbc_encrypt
define|#
directive|define
name|ncbc_encrypt
value|des_ncbc_encrypt
define|#
directive|define
name|xcbc_encrypt
value|des_xcbc_encrypt
define|#
directive|define
name|cbc_cksum
value|des_cbc_cksum
define|#
directive|define
name|quad_cksum
value|des_quad_cksum
define|#
directive|define
name|check_parity
value|des_check_key_parity
endif|#
directive|endif
define|#
directive|define
name|des_fixup_key_parity
value|DES_fixup_key_parity
ifdef|#
directive|ifdef
name|__cplusplus
block|}
end_extern

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* for DES_read_pw_string et al */
end_comment

begin_include
include|#
directive|include
file|<openssl/ui_compat.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

end_unit

