begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* crypto/cms/cms_lcl.h */
end_comment

begin_comment
comment|/* Written by Dr Stephen N Henson (steve@openssl.org) for the OpenSSL  * project.  */
end_comment

begin_comment
comment|/* ====================================================================  * Copyright (c) 2008 The OpenSSL Project.  All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  *  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.   *  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in  *    the documentation and/or other materials provided with the  *    distribution.  *  * 3. All advertising materials mentioning features or use of this  *    software must display the following acknowledgment:  *    "This product includes software developed by the OpenSSL Project  *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"  *  * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to  *    endorse or promote products derived from this software without  *    prior written permission. For written permission, please contact  *    licensing@OpenSSL.org.  *  * 5. Products derived from this software may not be called "OpenSSL"  *    nor may "OpenSSL" appear in their names without prior written  *    permission of the OpenSSL Project.  *  * 6. Redistributions of any form whatsoever must retain the following  *    acknowledgment:  *    "This product includes software developed by the OpenSSL Project  *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"  *  * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY  * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR  * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,  * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT  * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED  * OF THE POSSIBILITY OF SUCH DAMAGE.  * ====================================================================  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|HEADER_CMS_LCL_H
end_ifndef

begin_define
define|#
directive|define
name|HEADER_CMS_LCL_H
end_define

begin_ifdef
ifdef|#
directive|ifdef
name|__cplusplus
end_ifdef

begin_extern
extern|extern
literal|"C"
block|{
endif|#
directive|endif
include|#
directive|include
file|<openssl/x509.h>
comment|/* Cryptographic message syntax (CMS) structures: taken  * from RFC3852  */
comment|/* Forward references */
typedef|typedef
name|struct
name|CMS_IssuerAndSerialNumber_st
name|CMS_IssuerAndSerialNumber
typedef|;
typedef|typedef
name|struct
name|CMS_EncapsulatedContentInfo_st
name|CMS_EncapsulatedContentInfo
typedef|;
typedef|typedef
name|struct
name|CMS_SignerIdentifier_st
name|CMS_SignerIdentifier
typedef|;
typedef|typedef
name|struct
name|CMS_SignedData_st
name|CMS_SignedData
typedef|;
typedef|typedef
name|struct
name|CMS_OtherRevocationInfoFormat_st
name|CMS_OtherRevocationInfoFormat
typedef|;
typedef|typedef
name|struct
name|CMS_OriginatorInfo_st
name|CMS_OriginatorInfo
typedef|;
typedef|typedef
name|struct
name|CMS_EncryptedContentInfo_st
name|CMS_EncryptedContentInfo
typedef|;
typedef|typedef
name|struct
name|CMS_EnvelopedData_st
name|CMS_EnvelopedData
typedef|;
typedef|typedef
name|struct
name|CMS_DigestedData_st
name|CMS_DigestedData
typedef|;
typedef|typedef
name|struct
name|CMS_EncryptedData_st
name|CMS_EncryptedData
typedef|;
typedef|typedef
name|struct
name|CMS_AuthenticatedData_st
name|CMS_AuthenticatedData
typedef|;
typedef|typedef
name|struct
name|CMS_CompressedData_st
name|CMS_CompressedData
typedef|;
typedef|typedef
name|struct
name|CMS_OtherCertificateFormat_st
name|CMS_OtherCertificateFormat
typedef|;
typedef|typedef
name|struct
name|CMS_KeyTransRecipientInfo_st
name|CMS_KeyTransRecipientInfo
typedef|;
typedef|typedef
name|struct
name|CMS_OriginatorPublicKey_st
name|CMS_OriginatorPublicKey
typedef|;
typedef|typedef
name|struct
name|CMS_OriginatorIdentifierOrKey_st
name|CMS_OriginatorIdentifierOrKey
typedef|;
typedef|typedef
name|struct
name|CMS_KeyAgreeRecipientInfo_st
name|CMS_KeyAgreeRecipientInfo
typedef|;
typedef|typedef
name|struct
name|CMS_OtherKeyAttribute_st
name|CMS_OtherKeyAttribute
typedef|;
typedef|typedef
name|struct
name|CMS_RecipientKeyIdentifier_st
name|CMS_RecipientKeyIdentifier
typedef|;
typedef|typedef
name|struct
name|CMS_KeyAgreeRecipientIdentifier_st
name|CMS_KeyAgreeRecipientIdentifier
typedef|;
typedef|typedef
name|struct
name|CMS_RecipientEncryptedKey_st
name|CMS_RecipientEncryptedKey
typedef|;
typedef|typedef
name|struct
name|CMS_KEKIdentifier_st
name|CMS_KEKIdentifier
typedef|;
typedef|typedef
name|struct
name|CMS_KEKRecipientInfo_st
name|CMS_KEKRecipientInfo
typedef|;
typedef|typedef
name|struct
name|CMS_PasswordRecipientInfo_st
name|CMS_PasswordRecipientInfo
typedef|;
typedef|typedef
name|struct
name|CMS_OtherRecipientInfo_st
name|CMS_OtherRecipientInfo
typedef|;
typedef|typedef
name|struct
name|CMS_ReceiptsFrom_st
name|CMS_ReceiptsFrom
typedef|;
struct|struct
name|CMS_ContentInfo_st
block|{
name|ASN1_OBJECT
modifier|*
name|contentType
decl_stmt|;
union|union
block|{
name|ASN1_OCTET_STRING
modifier|*
name|data
decl_stmt|;
name|CMS_SignedData
modifier|*
name|signedData
decl_stmt|;
name|CMS_EnvelopedData
modifier|*
name|envelopedData
decl_stmt|;
name|CMS_DigestedData
modifier|*
name|digestedData
decl_stmt|;
name|CMS_EncryptedData
modifier|*
name|encryptedData
decl_stmt|;
name|CMS_AuthenticatedData
modifier|*
name|authenticatedData
decl_stmt|;
name|CMS_CompressedData
modifier|*
name|compressedData
decl_stmt|;
name|ASN1_TYPE
modifier|*
name|other
decl_stmt|;
comment|/* Other types ... */
name|void
modifier|*
name|otherData
decl_stmt|;
block|}
name|d
union|;
block|}
struct|;
struct|struct
name|CMS_SignedData_st
block|{
name|long
name|version
decl_stmt|;
name|STACK_OF
argument_list|(
name|X509_ALGOR
argument_list|)
operator|*
name|digestAlgorithms
expr_stmt|;
name|CMS_EncapsulatedContentInfo
modifier|*
name|encapContentInfo
decl_stmt|;
name|STACK_OF
argument_list|(
name|CMS_CertificateChoices
argument_list|)
operator|*
name|certificates
expr_stmt|;
name|STACK_OF
argument_list|(
name|CMS_RevocationInfoChoice
argument_list|)
operator|*
name|crls
expr_stmt|;
name|STACK_OF
argument_list|(
name|CMS_SignerInfo
argument_list|)
operator|*
name|signerInfos
expr_stmt|;
block|}
struct|;
struct|struct
name|CMS_EncapsulatedContentInfo_st
block|{
name|ASN1_OBJECT
modifier|*
name|eContentType
decl_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|eContent
decl_stmt|;
comment|/* Set to 1 if incomplete structure only part set up */
name|int
name|partial
decl_stmt|;
block|}
struct|;
struct|struct
name|CMS_SignerInfo_st
block|{
name|long
name|version
decl_stmt|;
name|CMS_SignerIdentifier
modifier|*
name|sid
decl_stmt|;
name|X509_ALGOR
modifier|*
name|digestAlgorithm
decl_stmt|;
name|STACK_OF
argument_list|(
name|X509_ATTRIBUTE
argument_list|)
operator|*
name|signedAttrs
expr_stmt|;
name|X509_ALGOR
modifier|*
name|signatureAlgorithm
decl_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|signature
decl_stmt|;
name|STACK_OF
argument_list|(
name|X509_ATTRIBUTE
argument_list|)
operator|*
name|unsignedAttrs
expr_stmt|;
comment|/* Signing certificate and key */
name|X509
modifier|*
name|signer
decl_stmt|;
name|EVP_PKEY
modifier|*
name|pkey
decl_stmt|;
block|}
struct|;
struct|struct
name|CMS_SignerIdentifier_st
block|{
name|int
name|type
decl_stmt|;
union|union
block|{
name|CMS_IssuerAndSerialNumber
modifier|*
name|issuerAndSerialNumber
decl_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|subjectKeyIdentifier
decl_stmt|;
block|}
name|d
union|;
block|}
struct|;
struct|struct
name|CMS_EnvelopedData_st
block|{
name|long
name|version
decl_stmt|;
name|CMS_OriginatorInfo
modifier|*
name|originatorInfo
decl_stmt|;
name|STACK_OF
argument_list|(
name|CMS_RecipientInfo
argument_list|)
operator|*
name|recipientInfos
expr_stmt|;
name|CMS_EncryptedContentInfo
modifier|*
name|encryptedContentInfo
decl_stmt|;
name|STACK_OF
argument_list|(
name|X509_ATTRIBUTE
argument_list|)
operator|*
name|unprotectedAttrs
expr_stmt|;
block|}
struct|;
struct|struct
name|CMS_OriginatorInfo_st
block|{
name|STACK_OF
argument_list|(
name|CMS_CertificateChoices
argument_list|)
operator|*
name|certificates
expr_stmt|;
name|STACK_OF
argument_list|(
name|CMS_RevocationInfoChoice
argument_list|)
operator|*
name|crls
expr_stmt|;
block|}
struct|;
struct|struct
name|CMS_EncryptedContentInfo_st
block|{
name|ASN1_OBJECT
modifier|*
name|contentType
decl_stmt|;
name|X509_ALGOR
modifier|*
name|contentEncryptionAlgorithm
decl_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|encryptedContent
decl_stmt|;
comment|/* Content encryption algorithm and key */
specifier|const
name|EVP_CIPHER
modifier|*
name|cipher
decl_stmt|;
name|unsigned
name|char
modifier|*
name|key
decl_stmt|;
name|size_t
name|keylen
decl_stmt|;
comment|/* Set to 1 if we are debugging decrypt and don't fake keys for MMA */
name|int
name|debug
decl_stmt|;
block|}
struct|;
struct|struct
name|CMS_RecipientInfo_st
block|{
name|int
name|type
decl_stmt|;
union|union
block|{
name|CMS_KeyTransRecipientInfo
modifier|*
name|ktri
decl_stmt|;
name|CMS_KeyAgreeRecipientInfo
modifier|*
name|kari
decl_stmt|;
name|CMS_KEKRecipientInfo
modifier|*
name|kekri
decl_stmt|;
name|CMS_PasswordRecipientInfo
modifier|*
name|pwri
decl_stmt|;
name|CMS_OtherRecipientInfo
modifier|*
name|ori
decl_stmt|;
block|}
name|d
union|;
block|}
struct|;
typedef|typedef
name|CMS_SignerIdentifier
name|CMS_RecipientIdentifier
typedef|;
struct|struct
name|CMS_KeyTransRecipientInfo_st
block|{
name|long
name|version
decl_stmt|;
name|CMS_RecipientIdentifier
modifier|*
name|rid
decl_stmt|;
name|X509_ALGOR
modifier|*
name|keyEncryptionAlgorithm
decl_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|encryptedKey
decl_stmt|;
comment|/* Recipient Key and cert */
name|X509
modifier|*
name|recip
decl_stmt|;
name|EVP_PKEY
modifier|*
name|pkey
decl_stmt|;
block|}
struct|;
struct|struct
name|CMS_KeyAgreeRecipientInfo_st
block|{
name|long
name|version
decl_stmt|;
name|CMS_OriginatorIdentifierOrKey
modifier|*
name|originator
decl_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|ukm
decl_stmt|;
name|X509_ALGOR
modifier|*
name|keyEncryptionAlgorithm
decl_stmt|;
name|STACK_OF
argument_list|(
name|CMS_RecipientEncryptedKey
argument_list|)
operator|*
name|recipientEncryptedKeys
expr_stmt|;
block|}
struct|;
struct|struct
name|CMS_OriginatorIdentifierOrKey_st
block|{
name|int
name|type
decl_stmt|;
union|union
block|{
name|CMS_IssuerAndSerialNumber
modifier|*
name|issuerAndSerialNumber
decl_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|subjectKeyIdentifier
decl_stmt|;
name|CMS_OriginatorPublicKey
modifier|*
name|originatorKey
decl_stmt|;
block|}
name|d
union|;
block|}
struct|;
struct|struct
name|CMS_OriginatorPublicKey_st
block|{
name|X509_ALGOR
modifier|*
name|algorithm
decl_stmt|;
name|ASN1_BIT_STRING
modifier|*
name|publicKey
decl_stmt|;
block|}
struct|;
struct|struct
name|CMS_RecipientEncryptedKey_st
block|{
name|CMS_KeyAgreeRecipientIdentifier
modifier|*
name|rid
decl_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|encryptedKey
decl_stmt|;
block|}
struct|;
struct|struct
name|CMS_KeyAgreeRecipientIdentifier_st
block|{
name|int
name|type
decl_stmt|;
union|union
block|{
name|CMS_IssuerAndSerialNumber
modifier|*
name|issuerAndSerialNumber
decl_stmt|;
name|CMS_RecipientKeyIdentifier
modifier|*
name|rKeyId
decl_stmt|;
block|}
name|d
union|;
block|}
struct|;
struct|struct
name|CMS_RecipientKeyIdentifier_st
block|{
name|ASN1_OCTET_STRING
modifier|*
name|subjectKeyIdentifier
decl_stmt|;
name|ASN1_GENERALIZEDTIME
modifier|*
name|date
decl_stmt|;
name|CMS_OtherKeyAttribute
modifier|*
name|other
decl_stmt|;
block|}
struct|;
struct|struct
name|CMS_KEKRecipientInfo_st
block|{
name|long
name|version
decl_stmt|;
name|CMS_KEKIdentifier
modifier|*
name|kekid
decl_stmt|;
name|X509_ALGOR
modifier|*
name|keyEncryptionAlgorithm
decl_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|encryptedKey
decl_stmt|;
comment|/* Extra info: symmetric key to use */
name|unsigned
name|char
modifier|*
name|key
decl_stmt|;
name|size_t
name|keylen
decl_stmt|;
block|}
struct|;
struct|struct
name|CMS_KEKIdentifier_st
block|{
name|ASN1_OCTET_STRING
modifier|*
name|keyIdentifier
decl_stmt|;
name|ASN1_GENERALIZEDTIME
modifier|*
name|date
decl_stmt|;
name|CMS_OtherKeyAttribute
modifier|*
name|other
decl_stmt|;
block|}
struct|;
struct|struct
name|CMS_PasswordRecipientInfo_st
block|{
name|long
name|version
decl_stmt|;
name|X509_ALGOR
modifier|*
name|keyDerivationAlgorithm
decl_stmt|;
name|X509_ALGOR
modifier|*
name|keyEncryptionAlgorithm
decl_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|encryptedKey
decl_stmt|;
comment|/* Extra info: password to use */
name|unsigned
name|char
modifier|*
name|pass
decl_stmt|;
name|size_t
name|passlen
decl_stmt|;
block|}
struct|;
struct|struct
name|CMS_OtherRecipientInfo_st
block|{
name|ASN1_OBJECT
modifier|*
name|oriType
decl_stmt|;
name|ASN1_TYPE
modifier|*
name|oriValue
decl_stmt|;
block|}
struct|;
struct|struct
name|CMS_DigestedData_st
block|{
name|long
name|version
decl_stmt|;
name|X509_ALGOR
modifier|*
name|digestAlgorithm
decl_stmt|;
name|CMS_EncapsulatedContentInfo
modifier|*
name|encapContentInfo
decl_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|digest
decl_stmt|;
block|}
struct|;
struct|struct
name|CMS_EncryptedData_st
block|{
name|long
name|version
decl_stmt|;
name|CMS_EncryptedContentInfo
modifier|*
name|encryptedContentInfo
decl_stmt|;
name|STACK_OF
argument_list|(
name|X509_ATTRIBUTE
argument_list|)
operator|*
name|unprotectedAttrs
expr_stmt|;
block|}
struct|;
struct|struct
name|CMS_AuthenticatedData_st
block|{
name|long
name|version
decl_stmt|;
name|CMS_OriginatorInfo
modifier|*
name|originatorInfo
decl_stmt|;
name|STACK_OF
argument_list|(
name|CMS_RecipientInfo
argument_list|)
operator|*
name|recipientInfos
expr_stmt|;
name|X509_ALGOR
modifier|*
name|macAlgorithm
decl_stmt|;
name|X509_ALGOR
modifier|*
name|digestAlgorithm
decl_stmt|;
name|CMS_EncapsulatedContentInfo
modifier|*
name|encapContentInfo
decl_stmt|;
name|STACK_OF
argument_list|(
name|X509_ATTRIBUTE
argument_list|)
operator|*
name|authAttrs
expr_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|mac
decl_stmt|;
name|STACK_OF
argument_list|(
name|X509_ATTRIBUTE
argument_list|)
operator|*
name|unauthAttrs
expr_stmt|;
block|}
struct|;
struct|struct
name|CMS_CompressedData_st
block|{
name|long
name|version
decl_stmt|;
name|X509_ALGOR
modifier|*
name|compressionAlgorithm
decl_stmt|;
name|STACK_OF
argument_list|(
name|CMS_RecipientInfo
argument_list|)
operator|*
name|recipientInfos
expr_stmt|;
name|CMS_EncapsulatedContentInfo
modifier|*
name|encapContentInfo
decl_stmt|;
block|}
struct|;
struct|struct
name|CMS_RevocationInfoChoice_st
block|{
name|int
name|type
decl_stmt|;
union|union
block|{
name|X509_CRL
modifier|*
name|crl
decl_stmt|;
name|CMS_OtherRevocationInfoFormat
modifier|*
name|other
decl_stmt|;
block|}
name|d
union|;
block|}
struct|;
define|#
directive|define
name|CMS_REVCHOICE_CRL
value|0
define|#
directive|define
name|CMS_REVCHOICE_OTHER
value|1
struct|struct
name|CMS_OtherRevocationInfoFormat_st
block|{
name|ASN1_OBJECT
modifier|*
name|otherRevInfoFormat
decl_stmt|;
name|ASN1_TYPE
modifier|*
name|otherRevInfo
decl_stmt|;
block|}
struct|;
struct|struct
name|CMS_CertificateChoices
block|{
name|int
name|type
decl_stmt|;
union|union
block|{
name|X509
modifier|*
name|certificate
decl_stmt|;
name|ASN1_STRING
modifier|*
name|extendedCertificate
decl_stmt|;
comment|/* Obsolete */
name|ASN1_STRING
modifier|*
name|v1AttrCert
decl_stmt|;
comment|/* Left encoded for now */
name|ASN1_STRING
modifier|*
name|v2AttrCert
decl_stmt|;
comment|/* Left encoded for now */
name|CMS_OtherCertificateFormat
modifier|*
name|other
decl_stmt|;
block|}
name|d
union|;
block|}
struct|;
define|#
directive|define
name|CMS_CERTCHOICE_CERT
value|0
define|#
directive|define
name|CMS_CERTCHOICE_EXCERT
value|1
define|#
directive|define
name|CMS_CERTCHOICE_V1ACERT
value|2
define|#
directive|define
name|CMS_CERTCHOICE_V2ACERT
value|3
define|#
directive|define
name|CMS_CERTCHOICE_OTHER
value|4
struct|struct
name|CMS_OtherCertificateFormat_st
block|{
name|ASN1_OBJECT
modifier|*
name|otherCertFormat
decl_stmt|;
name|ASN1_TYPE
modifier|*
name|otherCert
decl_stmt|;
block|}
struct|;
comment|/* This is also defined in pkcs7.h but we duplicate it  * to allow the CMS code to be independent of PKCS#7  */
struct|struct
name|CMS_IssuerAndSerialNumber_st
block|{
name|X509_NAME
modifier|*
name|issuer
decl_stmt|;
name|ASN1_INTEGER
modifier|*
name|serialNumber
decl_stmt|;
block|}
struct|;
struct|struct
name|CMS_OtherKeyAttribute_st
block|{
name|ASN1_OBJECT
modifier|*
name|keyAttrId
decl_stmt|;
name|ASN1_TYPE
modifier|*
name|keyAttr
decl_stmt|;
block|}
struct|;
comment|/* ESS structures */
ifdef|#
directive|ifdef
name|HEADER_X509V3_H
struct|struct
name|CMS_ReceiptRequest_st
block|{
name|ASN1_OCTET_STRING
modifier|*
name|signedContentIdentifier
decl_stmt|;
name|CMS_ReceiptsFrom
modifier|*
name|receiptsFrom
decl_stmt|;
name|STACK_OF
argument_list|(
name|GENERAL_NAMES
argument_list|)
operator|*
name|receiptsTo
expr_stmt|;
block|}
struct|;
struct|struct
name|CMS_ReceiptsFrom_st
block|{
name|int
name|type
decl_stmt|;
union|union
block|{
name|long
name|allOrFirstTier
decl_stmt|;
name|STACK_OF
argument_list|(
name|GENERAL_NAMES
argument_list|)
operator|*
name|receiptList
expr_stmt|;
block|}
name|d
union|;
block|}
struct|;
endif|#
directive|endif
struct|struct
name|CMS_Receipt_st
block|{
name|long
name|version
decl_stmt|;
name|ASN1_OBJECT
modifier|*
name|contentType
decl_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|signedContentIdentifier
decl_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|originatorSignatureValue
decl_stmt|;
block|}
struct|;
name|DECLARE_ASN1_FUNCTIONS
argument_list|(
argument|CMS_ContentInfo
argument_list|)
name|DECLARE_ASN1_ITEM
argument_list|(
argument|CMS_SignerInfo
argument_list|)
name|DECLARE_ASN1_ITEM
argument_list|(
argument|CMS_IssuerAndSerialNumber
argument_list|)
name|DECLARE_ASN1_ITEM
argument_list|(
argument|CMS_Attributes_Sign
argument_list|)
name|DECLARE_ASN1_ITEM
argument_list|(
argument|CMS_Attributes_Verify
argument_list|)
name|DECLARE_ASN1_ITEM
argument_list|(
argument|CMS_RecipientInfo
argument_list|)
name|DECLARE_ASN1_ITEM
argument_list|(
argument|CMS_PasswordRecipientInfo
argument_list|)
name|DECLARE_ASN1_ALLOC_FUNCTIONS
argument_list|(
argument|CMS_IssuerAndSerialNumber
argument_list|)
define|#
directive|define
name|CMS_SIGNERINFO_ISSUER_SERIAL
value|0
define|#
directive|define
name|CMS_SIGNERINFO_KEYIDENTIFIER
value|1
define|#
directive|define
name|CMS_RECIPINFO_ISSUER_SERIAL
value|0
define|#
directive|define
name|CMS_RECIPINFO_KEYIDENTIFIER
value|1
name|BIO
modifier|*
name|cms_content_bio
parameter_list|(
name|CMS_ContentInfo
modifier|*
name|cms
parameter_list|)
function_decl|;
name|CMS_ContentInfo
modifier|*
name|cms_Data_create
parameter_list|(
name|void
parameter_list|)
function_decl|;
name|CMS_ContentInfo
modifier|*
name|cms_DigestedData_create
parameter_list|(
specifier|const
name|EVP_MD
modifier|*
name|md
parameter_list|)
function_decl|;
name|BIO
modifier|*
name|cms_DigestedData_init_bio
parameter_list|(
name|CMS_ContentInfo
modifier|*
name|cms
parameter_list|)
function_decl|;
name|int
name|cms_DigestedData_do_final
parameter_list|(
name|CMS_ContentInfo
modifier|*
name|cms
parameter_list|,
name|BIO
modifier|*
name|chain
parameter_list|,
name|int
name|verify
parameter_list|)
function_decl|;
name|BIO
modifier|*
name|cms_SignedData_init_bio
parameter_list|(
name|CMS_ContentInfo
modifier|*
name|cms
parameter_list|)
function_decl|;
name|int
name|cms_SignedData_final
parameter_list|(
name|CMS_ContentInfo
modifier|*
name|cms
parameter_list|,
name|BIO
modifier|*
name|chain
parameter_list|)
function_decl|;
name|int
name|cms_set1_SignerIdentifier
parameter_list|(
name|CMS_SignerIdentifier
modifier|*
name|sid
parameter_list|,
name|X509
modifier|*
name|cert
parameter_list|,
name|int
name|type
parameter_list|)
function_decl|;
name|int
name|cms_SignerIdentifier_get0_signer_id
parameter_list|(
name|CMS_SignerIdentifier
modifier|*
name|sid
parameter_list|,
name|ASN1_OCTET_STRING
modifier|*
modifier|*
name|keyid
parameter_list|,
name|X509_NAME
modifier|*
modifier|*
name|issuer
parameter_list|,
name|ASN1_INTEGER
modifier|*
modifier|*
name|sno
parameter_list|)
function_decl|;
name|int
name|cms_SignerIdentifier_cert_cmp
parameter_list|(
name|CMS_SignerIdentifier
modifier|*
name|sid
parameter_list|,
name|X509
modifier|*
name|cert
parameter_list|)
function_decl|;
name|CMS_ContentInfo
modifier|*
name|cms_CompressedData_create
parameter_list|(
name|int
name|comp_nid
parameter_list|)
function_decl|;
name|BIO
modifier|*
name|cms_CompressedData_init_bio
parameter_list|(
name|CMS_ContentInfo
modifier|*
name|cms
parameter_list|)
function_decl|;
name|void
name|cms_DigestAlgorithm_set
parameter_list|(
name|X509_ALGOR
modifier|*
name|alg
parameter_list|,
specifier|const
name|EVP_MD
modifier|*
name|md
parameter_list|)
function_decl|;
name|BIO
modifier|*
name|cms_DigestAlgorithm_init_bio
parameter_list|(
name|X509_ALGOR
modifier|*
name|digestAlgorithm
parameter_list|)
function_decl|;
name|int
name|cms_DigestAlgorithm_find_ctx
parameter_list|(
name|EVP_MD_CTX
modifier|*
name|mctx
parameter_list|,
name|BIO
modifier|*
name|chain
parameter_list|,
name|X509_ALGOR
modifier|*
name|mdalg
parameter_list|)
function_decl|;
name|BIO
modifier|*
name|cms_EncryptedContent_init_bio
parameter_list|(
name|CMS_EncryptedContentInfo
modifier|*
name|ec
parameter_list|)
function_decl|;
name|BIO
modifier|*
name|cms_EncryptedData_init_bio
parameter_list|(
name|CMS_ContentInfo
modifier|*
name|cms
parameter_list|)
function_decl|;
name|int
name|cms_EncryptedContent_init
parameter_list|(
name|CMS_EncryptedContentInfo
modifier|*
name|ec
parameter_list|,
specifier|const
name|EVP_CIPHER
modifier|*
name|cipher
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|key
parameter_list|,
name|size_t
name|keylen
parameter_list|)
function_decl|;
name|int
name|cms_Receipt_verify
parameter_list|(
name|CMS_ContentInfo
modifier|*
name|cms
parameter_list|,
name|CMS_ContentInfo
modifier|*
name|req_cms
parameter_list|)
function_decl|;
name|int
name|cms_msgSigDigest_add1
parameter_list|(
name|CMS_SignerInfo
modifier|*
name|dest
parameter_list|,
name|CMS_SignerInfo
modifier|*
name|src
parameter_list|)
function_decl|;
name|ASN1_OCTET_STRING
modifier|*
name|cms_encode_Receipt
parameter_list|(
name|CMS_SignerInfo
modifier|*
name|si
parameter_list|)
function_decl|;
name|BIO
modifier|*
name|cms_EnvelopedData_init_bio
parameter_list|(
name|CMS_ContentInfo
modifier|*
name|cms
parameter_list|)
function_decl|;
name|CMS_EnvelopedData
modifier|*
name|cms_get0_enveloped
parameter_list|(
name|CMS_ContentInfo
modifier|*
name|cms
parameter_list|)
function_decl|;
comment|/* PWRI routines */
name|int
name|cms_RecipientInfo_pwri_crypt
parameter_list|(
name|CMS_ContentInfo
modifier|*
name|cms
parameter_list|,
name|CMS_RecipientInfo
modifier|*
name|ri
parameter_list|,
name|int
name|en_de
parameter_list|)
function_decl|;
ifdef|#
directive|ifdef
name|__cplusplus
block|}
end_extern

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

end_unit

