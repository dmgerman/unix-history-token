begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* $FreeBSD$ */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|_EF_H_
end_ifndef

begin_define
define|#
directive|define
name|_EF_H_
end_define

begin_define
define|#
directive|define
name|EFT_KLD
value|1
end_define

begin_define
define|#
directive|define
name|EFT_KERNEL
value|2
end_define

begin_typedef
typedef|typedef
struct|struct
name|elf_file
block|{
name|char
modifier|*
name|ef_name
decl_stmt|;
name|Elf_Phdr
modifier|*
name|ef_ph
decl_stmt|;
name|int
name|ef_fd
decl_stmt|;
name|int
name|ef_type
decl_stmt|;
name|Elf_Ehdr
name|ef_hdr
decl_stmt|;
name|void
modifier|*
name|ef_fpage
decl_stmt|;
comment|/* First block of the file */
name|int
name|ef_fplen
decl_stmt|;
comment|/* length of first block */
name|Elf_Dyn
modifier|*
name|ef_dyn
decl_stmt|;
comment|/* Symbol table etc. */
name|Elf_Hashelt
name|ef_nbuckets
decl_stmt|;
name|Elf_Hashelt
name|ef_nchains
decl_stmt|;
name|Elf_Hashelt
modifier|*
name|ef_buckets
decl_stmt|;
name|Elf_Hashelt
modifier|*
name|ef_chains
decl_stmt|;
name|Elf_Hashelt
modifier|*
name|ef_hashtab
decl_stmt|;
name|Elf_Off
name|ef_stroff
decl_stmt|;
name|caddr_t
name|ef_strtab
decl_stmt|;
name|int
name|ef_strsz
decl_stmt|;
name|Elf_Off
name|ef_symoff
decl_stmt|;
name|Elf_Sym
modifier|*
name|ef_symtab
decl_stmt|;
name|int
name|ef_nsegs
decl_stmt|;
name|Elf_Phdr
modifier|*
name|ef_segs
index|[
literal|2
index|]
decl_stmt|;
name|int
name|ef_verbose
decl_stmt|;
block|}
typedef|*
name|elf_file_t
typedef|;
end_typedef

begin_function_decl
name|__BEGIN_DECLS
name|int
name|ef_open
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|elf_file_t
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ef_close
parameter_list|(
name|elf_file_t
name|ef
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ef_read
parameter_list|(
name|elf_file_t
name|ef
parameter_list|,
name|Elf_Off
name|offset
parameter_list|,
name|size_t
name|len
parameter_list|,
name|void
modifier|*
name|dest
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ef_read_entry
parameter_list|(
name|elf_file_t
name|ef
parameter_list|,
name|Elf_Off
name|offset
parameter_list|,
name|size_t
name|len
parameter_list|,
name|void
modifier|*
modifier|*
name|ptr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ef_seg_read
parameter_list|(
name|elf_file_t
name|ef
parameter_list|,
name|Elf_Off
name|offset
parameter_list|,
name|size_t
name|len
parameter_list|,
name|void
modifier|*
name|dest
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ef_seg_read_entry
parameter_list|(
name|elf_file_t
name|ef
parameter_list|,
name|Elf_Off
name|offset
parameter_list|,
name|size_t
name|len
parameter_list|,
name|void
modifier|*
modifier|*
name|ptr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ef_lookup_symbol
parameter_list|(
name|elf_file_t
name|ef
parameter_list|,
specifier|const
name|char
modifier|*
name|name
parameter_list|,
name|Elf_Sym
modifier|*
modifier|*
name|sym
parameter_list|)
function_decl|;
end_function_decl

begin_macro
name|__END_DECLS
end_macro

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* _EF_H_*/
end_comment

end_unit

