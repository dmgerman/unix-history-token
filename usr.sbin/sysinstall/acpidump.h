begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 1999 Doug Rabson  * Copyright (c) 2000 Mitsuru IWASAKI<iwasaki@FreeBSD.org>  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  *  *	$FreeBSD$  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|_ACPIDUMP_H_
end_ifndef

begin_define
define|#
directive|define
name|_ACPIDUMP_H_
end_define

begin_comment
comment|/* Root System Description Pointer */
end_comment

begin_struct
struct|struct
name|ACPIrsdp
block|{
name|u_char
name|signature
index|[
literal|8
index|]
decl_stmt|;
name|u_char
name|sum
decl_stmt|;
name|u_char
name|oem
index|[
literal|6
index|]
decl_stmt|;
name|u_char
name|revision
decl_stmt|;
name|u_int32_t
name|rsdt_addr
decl_stmt|;
name|u_int32_t
name|length
decl_stmt|;
name|u_int64_t
name|xsdt_addr
decl_stmt|;
name|u_char
name|xsum
decl_stmt|;
name|u_char
name|_reserved_
index|[
literal|3
index|]
decl_stmt|;
block|}
name|__packed
struct|;
end_struct

begin_comment
comment|/* System Description Table */
end_comment

begin_struct
struct|struct
name|ACPIsdt
block|{
name|u_char
name|signature
index|[
literal|4
index|]
decl_stmt|;
name|u_int32_t
name|len
decl_stmt|;
name|u_char
name|rev
decl_stmt|;
name|u_char
name|check
decl_stmt|;
name|u_char
name|oemid
index|[
literal|6
index|]
decl_stmt|;
name|u_char
name|oemtblid
index|[
literal|8
index|]
decl_stmt|;
name|u_int32_t
name|oemrev
decl_stmt|;
name|u_char
name|creator
index|[
literal|4
index|]
decl_stmt|;
name|u_int32_t
name|crerev
decl_stmt|;
define|#
directive|define
name|SIZEOF_SDT_HDR
value|36
comment|/* struct size except body */
name|u_int32_t
name|body
index|[
literal|1
index|]
decl_stmt|;
comment|/* This member should be casted */
block|}
name|__packed
struct|;
end_struct

begin_struct
struct|struct
name|MADT_local_apic
block|{
name|u_char
name|cpu_id
decl_stmt|;
name|u_char
name|apic_id
decl_stmt|;
name|u_int32_t
name|flags
decl_stmt|;
define|#
directive|define
name|ACPI_MADT_APIC_LOCAL_FLAG_ENABLED
value|1
block|}
name|__packed
struct|;
end_struct

begin_struct
struct|struct
name|MADT_io_apic
block|{
name|u_char
name|apic_id
decl_stmt|;
name|u_char
name|reserved
decl_stmt|;
name|u_int32_t
name|apic_addr
decl_stmt|;
name|u_int32_t
name|int_base
decl_stmt|;
block|}
name|__packed
struct|;
end_struct

begin_struct
struct|struct
name|MADT_int_override
block|{
name|u_char
name|bus
decl_stmt|;
name|u_char
name|source
decl_stmt|;
name|u_int32_t
name|intr
decl_stmt|;
name|u_int16_t
name|mps_flags
decl_stmt|;
define|#
directive|define
name|MPS_INT_FLAG_POLARITY_MASK
value|0x3
define|#
directive|define
name|MPS_INT_FLAG_POLARITY_CONFORM
value|0x0
define|#
directive|define
name|MPS_INT_FLAG_POLARITY_HIGH
value|0x1
define|#
directive|define
name|MPS_INT_FLAG_POLARITY_LOW
value|0x3
define|#
directive|define
name|MPS_INT_FLAG_TRIGGER_MASK
value|0xc
define|#
directive|define
name|MPS_INT_FLAG_TRIGGER_CONFORM
value|0x0
define|#
directive|define
name|MPS_INT_FLAG_TRIGGER_EDGE
value|0x4
define|#
directive|define
name|MPS_INT_FLAG_TRIGGER_LEVEL
value|0xc
block|}
name|__packed
struct|;
end_struct

begin_struct
struct|struct
name|MADT_nmi
block|{
name|u_int16_t
name|mps_flags
decl_stmt|;
name|u_int32_t
name|intr
decl_stmt|;
block|}
name|__packed
struct|;
end_struct

begin_struct
struct|struct
name|MADT_local_nmi
block|{
name|u_char
name|cpu_id
decl_stmt|;
name|u_int16_t
name|mps_flags
decl_stmt|;
name|u_char
name|lintpin
decl_stmt|;
block|}
name|__packed
struct|;
end_struct

begin_struct
struct|struct
name|MADT_local_apic_override
block|{
name|u_char
name|reserved
index|[
literal|2
index|]
decl_stmt|;
name|u_int64_t
name|apic_addr
decl_stmt|;
block|}
name|__packed
struct|;
end_struct

begin_struct
struct|struct
name|MADT_io_sapic
block|{
name|u_char
name|apic_id
decl_stmt|;
name|u_char
name|reserved
decl_stmt|;
name|u_int32_t
name|int_base
decl_stmt|;
name|u_int64_t
name|apic_addr
decl_stmt|;
block|}
name|__packed
struct|;
end_struct

begin_struct
struct|struct
name|MADT_local_sapic
block|{
name|u_char
name|cpu_id
decl_stmt|;
name|u_char
name|apic_id
decl_stmt|;
name|u_char
name|apic_eid
decl_stmt|;
name|u_char
name|reserved
index|[
literal|3
index|]
decl_stmt|;
name|u_int32_t
name|flags
decl_stmt|;
block|}
name|__packed
struct|;
end_struct

begin_struct
struct|struct
name|MADT_int_src
block|{
name|u_int16_t
name|mps_flags
decl_stmt|;
name|u_char
name|type
decl_stmt|;
define|#
directive|define
name|ACPI_MADT_APIC_INT_SOURCE_PMI
value|1
define|#
directive|define
name|ACPI_MADT_APIC_INT_SOURCE_INIT
value|2
define|#
directive|define
name|ACPI_MADT_APIC_INT_SOURCE_CPEI
value|3
comment|/* Corrected Platform Error */
name|u_char
name|cpu_id
decl_stmt|;
name|u_char
name|cpu_eid
decl_stmt|;
name|u_char
name|sapic_vector
decl_stmt|;
name|u_int32_t
name|intr
decl_stmt|;
name|u_char
name|reserved
index|[
literal|4
index|]
decl_stmt|;
block|}
name|__packed
struct|;
end_struct

begin_struct
struct|struct
name|MADT_APIC
block|{
name|u_char
name|type
decl_stmt|;
define|#
directive|define
name|ACPI_MADT_APIC_TYPE_LOCAL_APIC
value|0
define|#
directive|define
name|ACPI_MADT_APIC_TYPE_IO_APIC
value|1
define|#
directive|define
name|ACPI_MADT_APIC_TYPE_INT_OVERRIDE
value|2
define|#
directive|define
name|ACPI_MADT_APIC_TYPE_NMI
value|3
define|#
directive|define
name|ACPI_MADT_APIC_TYPE_LOCAL_NMI
value|4
define|#
directive|define
name|ACPI_MADT_APIC_TYPE_LOCAL_OVERRIDE
value|5
define|#
directive|define
name|ACPI_MADT_APIC_TYPE_IO_SAPIC
value|6
define|#
directive|define
name|ACPI_MADT_APIC_TYPE_LOCAL_SAPIC
value|7
define|#
directive|define
name|ACPI_MADT_APIC_TYPE_INT_SRC
value|8
name|u_char
name|len
decl_stmt|;
union|union
block|{
name|struct
name|MADT_local_apic
name|local_apic
decl_stmt|;
name|struct
name|MADT_io_apic
name|io_apic
decl_stmt|;
name|struct
name|MADT_int_override
name|int_override
decl_stmt|;
name|struct
name|MADT_nmi
name|nmi
decl_stmt|;
name|struct
name|MADT_local_nmi
name|local_nmi
decl_stmt|;
name|struct
name|MADT_local_apic_override
name|local_apic_override
decl_stmt|;
name|struct
name|MADT_io_sapic
name|io_sapic
decl_stmt|;
name|struct
name|MADT_local_sapic
name|local_sapic
decl_stmt|;
name|struct
name|MADT_int_src
name|int_src
decl_stmt|;
block|}
name|body
union|;
block|}
name|__packed
struct|;
end_struct

begin_struct
struct|struct
name|MADTbody
block|{
name|u_int32_t
name|lapic_addr
decl_stmt|;
name|u_int32_t
name|flags
decl_stmt|;
define|#
directive|define
name|ACPI_APIC_FLAG_PCAT_COMPAT
value|1
comment|/* System has dual-8259 setup. */
name|u_char
name|body
index|[
literal|1
index|]
decl_stmt|;
block|}
name|__packed
struct|;
end_struct

begin_comment
comment|/*  * Addresses to scan on ia32 for the RSD PTR.  According to section 5.2.2  * of the ACPI spec, we only consider two regions for the base address:  * 1. EBDA (1 KB area addressed to by 16 bit pointer at 0x40E)  * 2. High memory (0xE0000 - 0xFFFFF)  */
end_comment

begin_define
define|#
directive|define
name|RSDP_EBDA_PTR
value|0x40E
end_define

begin_define
define|#
directive|define
name|RSDP_EBDA_SIZE
value|0x400
end_define

begin_define
define|#
directive|define
name|RSDP_HI_START
value|0xE0000
end_define

begin_define
define|#
directive|define
name|RSDP_HI_SIZE
value|0x20000
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* !_ACPIDUMP_H_ */
end_comment

end_unit

