begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * authdes.c - an implementation of the DES cipher algorithm for NTP  */
end_comment

begin_include
include|#
directive|include
file|"ntp_stdlib.h"
end_include

begin_comment
comment|/*  * There are two entries in here.  auth_subkeys() called to  * compute the encryption and decryption key schedules, while  * auth_des() is called to do the actual encryption/decryption  */
end_comment

begin_comment
comment|/*  * Key setup.  Here we entirely permute a key, saving the results  * for both the encryption and decryption.  Note that while the  * decryption subkeys are simply the encryption keys reordered,  * we save both so that a common cipher routine may be used.  */
end_comment

begin_comment
comment|/*  * Permuted choice 1 tables.  These are used to extract bits  * from the left and right parts of the key to form Ci and Di.  * The code that uses these tables knows which bits from which  * part of each key are used to form Ci and Di.  */
end_comment

begin_decl_stmt
specifier|static
name|U_LONG
name|PC1_CL
index|[
literal|8
index|]
init|=
block|{
literal|0x00000000
block|,
literal|0x00000010
block|,
literal|0x00001000
block|,
literal|0x00001010
block|,
literal|0x00100000
block|,
literal|0x00100010
block|,
literal|0x00101000
block|,
literal|0x00101010
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|U_LONG
name|PC1_DL
index|[
literal|16
index|]
init|=
block|{
literal|0x00000000
block|,
literal|0x00100000
block|,
literal|0x00001000
block|,
literal|0x00101000
block|,
literal|0x00000010
block|,
literal|0x00100010
block|,
literal|0x00001010
block|,
literal|0x00101010
block|,
literal|0x00000001
block|,
literal|0x00100001
block|,
literal|0x00001001
block|,
literal|0x00101001
block|,
literal|0x00000011
block|,
literal|0x00100011
block|,
literal|0x00001011
block|,
literal|0x00101011
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|U_LONG
name|PC1_CR
index|[
literal|16
index|]
init|=
block|{
literal|0x00000000
block|,
literal|0x00000001
block|,
literal|0x00000100
block|,
literal|0x00000101
block|,
literal|0x00010000
block|,
literal|0x00010001
block|,
literal|0x00010100
block|,
literal|0x00010101
block|,
literal|0x01000000
block|,
literal|0x01000001
block|,
literal|0x01000100
block|,
literal|0x01000101
block|,
literal|0x01010000
block|,
literal|0x01010001
block|,
literal|0x01010100
block|,
literal|0x01010101
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|U_LONG
name|PC1_DR
index|[
literal|8
index|]
init|=
block|{
literal|0x00000000
block|,
literal|0x01000000
block|,
literal|0x00010000
block|,
literal|0x01010000
block|,
literal|0x00000100
block|,
literal|0x01000100
block|,
literal|0x00010100
block|,
literal|0x01010100
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * At the start of some iterations of the key schedule we do  * a circular left shift by one place, while for others we do a shift by  * two places.  This has bits set for the iterations where we do 2 bit  * shifts, starting at the low order bit.  */
end_comment

begin_define
define|#
directive|define
name|TWO_BIT_SHIFTS
value|0x7efc
end_define

begin_comment
comment|/*  * Permuted choice 2 tables.  The first actually produces the low order  * 24 bits of the subkey Ki from the 28 bit value of Ci.  The second produces  * the high order 24 bits from Di.  The tables are indexed by six bit  * segments of Ci and Di respectively.  The code is handcrafted to compute  * the appropriate 6 bit chunks.  *  * Note that for ease of computation, the 24 bit values are produced with  * six bits going into each byte.  */
end_comment

begin_decl_stmt
specifier|static
name|U_LONG
name|PC2_C
index|[
literal|4
index|]
index|[
literal|64
index|]
init|=
block|{
block|{
literal|0x00000000
block|,
literal|0x00040000
block|,
literal|0x01000000
block|,
literal|0x01040000
block|,
literal|0x00000400
block|,
literal|0x00040400
block|,
literal|0x01000400
block|,
literal|0x01040400
block|,
literal|0x00200000
block|,
literal|0x00240000
block|,
literal|0x01200000
block|,
literal|0x01240000
block|,
literal|0x00200400
block|,
literal|0x00240400
block|,
literal|0x01200400
block|,
literal|0x01240400
block|,
literal|0x00000001
block|,
literal|0x00040001
block|,
literal|0x01000001
block|,
literal|0x01040001
block|,
literal|0x00000401
block|,
literal|0x00040401
block|,
literal|0x01000401
block|,
literal|0x01040401
block|,
literal|0x00200001
block|,
literal|0x00240001
block|,
literal|0x01200001
block|,
literal|0x01240001
block|,
literal|0x00200401
block|,
literal|0x00240401
block|,
literal|0x01200401
block|,
literal|0x01240401
block|,
literal|0x02000000
block|,
literal|0x02040000
block|,
literal|0x03000000
block|,
literal|0x03040000
block|,
literal|0x02000400
block|,
literal|0x02040400
block|,
literal|0x03000400
block|,
literal|0x03040400
block|,
literal|0x02200000
block|,
literal|0x02240000
block|,
literal|0x03200000
block|,
literal|0x03240000
block|,
literal|0x02200400
block|,
literal|0x02240400
block|,
literal|0x03200400
block|,
literal|0x03240400
block|,
literal|0x02000001
block|,
literal|0x02040001
block|,
literal|0x03000001
block|,
literal|0x03040001
block|,
literal|0x02000401
block|,
literal|0x02040401
block|,
literal|0x03000401
block|,
literal|0x03040401
block|,
literal|0x02200001
block|,
literal|0x02240001
block|,
literal|0x03200001
block|,
literal|0x03240001
block|,
literal|0x02200401
block|,
literal|0x02240401
block|,
literal|0x03200401
block|,
literal|0x03240401
block|}
block|,
block|{
literal|0x00000000
block|,
literal|0x00000002
block|,
literal|0x00000800
block|,
literal|0x00000802
block|,
literal|0x08000000
block|,
literal|0x08000002
block|,
literal|0x08000800
block|,
literal|0x08000802
block|,
literal|0x00010000
block|,
literal|0x00010002
block|,
literal|0x00010800
block|,
literal|0x00010802
block|,
literal|0x08010000
block|,
literal|0x08010002
block|,
literal|0x08010800
block|,
literal|0x08010802
block|,
literal|0x00000100
block|,
literal|0x00000102
block|,
literal|0x00000900
block|,
literal|0x00000902
block|,
literal|0x08000100
block|,
literal|0x08000102
block|,
literal|0x08000900
block|,
literal|0x08000902
block|,
literal|0x00010100
block|,
literal|0x00010102
block|,
literal|0x00010900
block|,
literal|0x00010902
block|,
literal|0x08010100
block|,
literal|0x08010102
block|,
literal|0x08010900
block|,
literal|0x08010902
block|,
literal|0x00000010
block|,
literal|0x00000012
block|,
literal|0x00000810
block|,
literal|0x00000812
block|,
literal|0x08000010
block|,
literal|0x08000012
block|,
literal|0x08000810
block|,
literal|0x08000812
block|,
literal|0x00010010
block|,
literal|0x00010012
block|,
literal|0x00010810
block|,
literal|0x00010812
block|,
literal|0x08010010
block|,
literal|0x08010012
block|,
literal|0x08010810
block|,
literal|0x08010812
block|,
literal|0x00000110
block|,
literal|0x00000112
block|,
literal|0x00000910
block|,
literal|0x00000912
block|,
literal|0x08000110
block|,
literal|0x08000112
block|,
literal|0x08000910
block|,
literal|0x08000912
block|,
literal|0x00010110
block|,
literal|0x00010112
block|,
literal|0x00010910
block|,
literal|0x00010912
block|,
literal|0x08010110
block|,
literal|0x08010112
block|,
literal|0x08010910
block|,
literal|0x08010912
block|}
block|,
block|{
literal|0x00000000
block|,
literal|0x04000000
block|,
literal|0x00002000
block|,
literal|0x04002000
block|,
literal|0x10000000
block|,
literal|0x14000000
block|,
literal|0x10002000
block|,
literal|0x14002000
block|,
literal|0x00000020
block|,
literal|0x04000020
block|,
literal|0x00002020
block|,
literal|0x04002020
block|,
literal|0x10000020
block|,
literal|0x14000020
block|,
literal|0x10002020
block|,
literal|0x14002020
block|,
literal|0x00080000
block|,
literal|0x04080000
block|,
literal|0x00082000
block|,
literal|0x04082000
block|,
literal|0x10080000
block|,
literal|0x14080000
block|,
literal|0x10082000
block|,
literal|0x14082000
block|,
literal|0x00080020
block|,
literal|0x04080020
block|,
literal|0x00082020
block|,
literal|0x04082020
block|,
literal|0x10080020
block|,
literal|0x14080020
block|,
literal|0x10082020
block|,
literal|0x14082020
block|,
literal|0x20000000
block|,
literal|0x24000000
block|,
literal|0x20002000
block|,
literal|0x24002000
block|,
literal|0x30000000
block|,
literal|0x34000000
block|,
literal|0x30002000
block|,
literal|0x34002000
block|,
literal|0x20000020
block|,
literal|0x24000020
block|,
literal|0x20002020
block|,
literal|0x24002020
block|,
literal|0x30000020
block|,
literal|0x34000020
block|,
literal|0x30002020
block|,
literal|0x34002020
block|,
literal|0x20080000
block|,
literal|0x24080000
block|,
literal|0x20082000
block|,
literal|0x24082000
block|,
literal|0x30080000
block|,
literal|0x34080000
block|,
literal|0x30082000
block|,
literal|0x34082000
block|,
literal|0x20080020
block|,
literal|0x24080020
block|,
literal|0x20082020
block|,
literal|0x24082020
block|,
literal|0x30080020
block|,
literal|0x34080020
block|,
literal|0x30082020
block|,
literal|0x34082020
block|}
block|,
block|{
literal|0x00000000
block|,
literal|0x00100000
block|,
literal|0x00000008
block|,
literal|0x00100008
block|,
literal|0x00000200
block|,
literal|0x00100200
block|,
literal|0x00000208
block|,
literal|0x00100208
block|,
literal|0x00020000
block|,
literal|0x00120000
block|,
literal|0x00020008
block|,
literal|0x00120008
block|,
literal|0x00020200
block|,
literal|0x00120200
block|,
literal|0x00020208
block|,
literal|0x00120208
block|,
literal|0x00000004
block|,
literal|0x00100004
block|,
literal|0x0000000c
block|,
literal|0x0010000c
block|,
literal|0x00000204
block|,
literal|0x00100204
block|,
literal|0x0000020c
block|,
literal|0x0010020c
block|,
literal|0x00020004
block|,
literal|0x00120004
block|,
literal|0x0002000c
block|,
literal|0x0012000c
block|,
literal|0x00020204
block|,
literal|0x00120204
block|,
literal|0x0002020c
block|,
literal|0x0012020c
block|,
literal|0x00001000
block|,
literal|0x00101000
block|,
literal|0x00001008
block|,
literal|0x00101008
block|,
literal|0x00001200
block|,
literal|0x00101200
block|,
literal|0x00001208
block|,
literal|0x00101208
block|,
literal|0x00021000
block|,
literal|0x00121000
block|,
literal|0x00021008
block|,
literal|0x00121008
block|,
literal|0x00021200
block|,
literal|0x00121200
block|,
literal|0x00021208
block|,
literal|0x00121208
block|,
literal|0x00001004
block|,
literal|0x00101004
block|,
literal|0x0000100c
block|,
literal|0x0010100c
block|,
literal|0x00001204
block|,
literal|0x00101204
block|,
literal|0x0000120c
block|,
literal|0x0010120c
block|,
literal|0x00021004
block|,
literal|0x00121004
block|,
literal|0x0002100c
block|,
literal|0x0012100c
block|,
literal|0x00021204
block|,
literal|0x00121204
block|,
literal|0x0002120c
block|,
literal|0x0012120c
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|U_LONG
name|PC2_D
index|[
literal|4
index|]
index|[
literal|64
index|]
init|=
block|{
block|{
literal|0x00000000
block|,
literal|0x00000200
block|,
literal|0x00020000
block|,
literal|0x00020200
block|,
literal|0x00000001
block|,
literal|0x00000201
block|,
literal|0x00020001
block|,
literal|0x00020201
block|,
literal|0x08000000
block|,
literal|0x08000200
block|,
literal|0x08020000
block|,
literal|0x08020200
block|,
literal|0x08000001
block|,
literal|0x08000201
block|,
literal|0x08020001
block|,
literal|0x08020201
block|,
literal|0x00200000
block|,
literal|0x00200200
block|,
literal|0x00220000
block|,
literal|0x00220200
block|,
literal|0x00200001
block|,
literal|0x00200201
block|,
literal|0x00220001
block|,
literal|0x00220201
block|,
literal|0x08200000
block|,
literal|0x08200200
block|,
literal|0x08220000
block|,
literal|0x08220200
block|,
literal|0x08200001
block|,
literal|0x08200201
block|,
literal|0x08220001
block|,
literal|0x08220201
block|,
literal|0x00000002
block|,
literal|0x00000202
block|,
literal|0x00020002
block|,
literal|0x00020202
block|,
literal|0x00000003
block|,
literal|0x00000203
block|,
literal|0x00020003
block|,
literal|0x00020203
block|,
literal|0x08000002
block|,
literal|0x08000202
block|,
literal|0x08020002
block|,
literal|0x08020202
block|,
literal|0x08000003
block|,
literal|0x08000203
block|,
literal|0x08020003
block|,
literal|0x08020203
block|,
literal|0x00200002
block|,
literal|0x00200202
block|,
literal|0x00220002
block|,
literal|0x00220202
block|,
literal|0x00200003
block|,
literal|0x00200203
block|,
literal|0x00220003
block|,
literal|0x00220203
block|,
literal|0x08200002
block|,
literal|0x08200202
block|,
literal|0x08220002
block|,
literal|0x08220202
block|,
literal|0x08200003
block|,
literal|0x08200203
block|,
literal|0x08220003
block|,
literal|0x08220203
block|}
block|,
block|{
literal|0x00000000
block|,
literal|0x00000010
block|,
literal|0x20000000
block|,
literal|0x20000010
block|,
literal|0x00100000
block|,
literal|0x00100010
block|,
literal|0x20100000
block|,
literal|0x20100010
block|,
literal|0x00000800
block|,
literal|0x00000810
block|,
literal|0x20000800
block|,
literal|0x20000810
block|,
literal|0x00100800
block|,
literal|0x00100810
block|,
literal|0x20100800
block|,
literal|0x20100810
block|,
literal|0x04000000
block|,
literal|0x04000010
block|,
literal|0x24000000
block|,
literal|0x24000010
block|,
literal|0x04100000
block|,
literal|0x04100010
block|,
literal|0x24100000
block|,
literal|0x24100010
block|,
literal|0x04000800
block|,
literal|0x04000810
block|,
literal|0x24000800
block|,
literal|0x24000810
block|,
literal|0x04100800
block|,
literal|0x04100810
block|,
literal|0x24100800
block|,
literal|0x24100810
block|,
literal|0x00000004
block|,
literal|0x00000014
block|,
literal|0x20000004
block|,
literal|0x20000014
block|,
literal|0x00100004
block|,
literal|0x00100014
block|,
literal|0x20100004
block|,
literal|0x20100014
block|,
literal|0x00000804
block|,
literal|0x00000814
block|,
literal|0x20000804
block|,
literal|0x20000814
block|,
literal|0x00100804
block|,
literal|0x00100814
block|,
literal|0x20100804
block|,
literal|0x20100814
block|,
literal|0x04000004
block|,
literal|0x04000014
block|,
literal|0x24000004
block|,
literal|0x24000014
block|,
literal|0x04100004
block|,
literal|0x04100014
block|,
literal|0x24100004
block|,
literal|0x24100014
block|,
literal|0x04000804
block|,
literal|0x04000814
block|,
literal|0x24000804
block|,
literal|0x24000814
block|,
literal|0x04100804
block|,
literal|0x04100814
block|,
literal|0x24100804
block|,
literal|0x24100814
block|}
block|,
block|{
literal|0x00000000
block|,
literal|0x00001000
block|,
literal|0x00010000
block|,
literal|0x00011000
block|,
literal|0x02000000
block|,
literal|0x02001000
block|,
literal|0x02010000
block|,
literal|0x02011000
block|,
literal|0x00000020
block|,
literal|0x00001020
block|,
literal|0x00010020
block|,
literal|0x00011020
block|,
literal|0x02000020
block|,
literal|0x02001020
block|,
literal|0x02010020
block|,
literal|0x02011020
block|,
literal|0x00040000
block|,
literal|0x00041000
block|,
literal|0x00050000
block|,
literal|0x00051000
block|,
literal|0x02040000
block|,
literal|0x02041000
block|,
literal|0x02050000
block|,
literal|0x02051000
block|,
literal|0x00040020
block|,
literal|0x00041020
block|,
literal|0x00050020
block|,
literal|0x00051020
block|,
literal|0x02040020
block|,
literal|0x02041020
block|,
literal|0x02050020
block|,
literal|0x02051020
block|,
literal|0x00002000
block|,
literal|0x00003000
block|,
literal|0x00012000
block|,
literal|0x00013000
block|,
literal|0x02002000
block|,
literal|0x02003000
block|,
literal|0x02012000
block|,
literal|0x02013000
block|,
literal|0x00002020
block|,
literal|0x00003020
block|,
literal|0x00012020
block|,
literal|0x00013020
block|,
literal|0x02002020
block|,
literal|0x02003020
block|,
literal|0x02012020
block|,
literal|0x02013020
block|,
literal|0x00042000
block|,
literal|0x00043000
block|,
literal|0x00052000
block|,
literal|0x00053000
block|,
literal|0x02042000
block|,
literal|0x02043000
block|,
literal|0x02052000
block|,
literal|0x02053000
block|,
literal|0x00042020
block|,
literal|0x00043020
block|,
literal|0x00052020
block|,
literal|0x00053020
block|,
literal|0x02042020
block|,
literal|0x02043020
block|,
literal|0x02052020
block|,
literal|0x02053020
block|}
block|,
block|{
literal|0x00000000
block|,
literal|0x00000400
block|,
literal|0x01000000
block|,
literal|0x01000400
block|,
literal|0x00000100
block|,
literal|0x00000500
block|,
literal|0x01000100
block|,
literal|0x01000500
block|,
literal|0x10000000
block|,
literal|0x10000400
block|,
literal|0x11000000
block|,
literal|0x11000400
block|,
literal|0x10000100
block|,
literal|0x10000500
block|,
literal|0x11000100
block|,
literal|0x11000500
block|,
literal|0x00080000
block|,
literal|0x00080400
block|,
literal|0x01080000
block|,
literal|0x01080400
block|,
literal|0x00080100
block|,
literal|0x00080500
block|,
literal|0x01080100
block|,
literal|0x01080500
block|,
literal|0x10080000
block|,
literal|0x10080400
block|,
literal|0x11080000
block|,
literal|0x11080400
block|,
literal|0x10080100
block|,
literal|0x10080500
block|,
literal|0x11080100
block|,
literal|0x11080500
block|,
literal|0x00000008
block|,
literal|0x00000408
block|,
literal|0x01000008
block|,
literal|0x01000408
block|,
literal|0x00000108
block|,
literal|0x00000508
block|,
literal|0x01000108
block|,
literal|0x01000508
block|,
literal|0x10000008
block|,
literal|0x10000408
block|,
literal|0x11000008
block|,
literal|0x11000408
block|,
literal|0x10000108
block|,
literal|0x10000508
block|,
literal|0x11000108
block|,
literal|0x11000508
block|,
literal|0x00080008
block|,
literal|0x00080408
block|,
literal|0x01080008
block|,
literal|0x01080408
block|,
literal|0x00080108
block|,
literal|0x00080508
block|,
literal|0x01080108
block|,
literal|0x01080508
block|,
literal|0x10080008
block|,
literal|0x10080408
block|,
literal|0x11080008
block|,
literal|0x11080408
block|,
literal|0x10080108
block|,
literal|0x10080508
block|,
literal|0x11080108
block|,
literal|0x11080508
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Permute the key to give us our key schedule.  */
end_comment

begin_function
name|void
name|DESauth_subkeys
parameter_list|(
name|key
parameter_list|,
name|encryptkeys
parameter_list|,
name|decryptkeys
parameter_list|)
specifier|const
name|U_LONG
modifier|*
name|key
decl_stmt|;
name|u_char
modifier|*
name|encryptkeys
decl_stmt|;
name|u_char
modifier|*
name|decryptkeys
decl_stmt|;
block|{
specifier|register
name|U_LONG
name|tmp
decl_stmt|;
specifier|register
name|U_LONG
name|c
decl_stmt|,
name|d
decl_stmt|;
specifier|register
name|u_char
modifier|*
name|ek
decl_stmt|,
modifier|*
name|dk
decl_stmt|;
specifier|register
name|int
name|two_bit_shifts
decl_stmt|;
specifier|register
name|int
name|i
decl_stmt|;
comment|/* 	 * The first permutted choice gives us the 28 bits for C0 and 	 * 28 for D0.  C0 gets 12 bits from the left key and 16 from 	 * the right, while D0 gets 16 from the left and 12 from the 	 * right.  The code knows which bits go where. 	 */
name|tmp
operator|=
operator|*
name|key
expr_stmt|;
comment|/* left part of key */
name|c
operator|=
name|PC1_CL
index|[
operator|(
name|tmp
operator|>>
literal|29
operator|)
operator|&
literal|0x7
index|]
operator||
operator|(
name|PC1_CL
index|[
operator|(
name|tmp
operator|>>
literal|21
operator|)
operator|&
literal|0x7
index|]
operator|<<
literal|1
operator|)
operator||
operator|(
name|PC1_CL
index|[
operator|(
name|tmp
operator|>>
literal|13
operator|)
operator|&
literal|0x7
index|]
operator|<<
literal|2
operator|)
operator||
operator|(
name|PC1_CL
index|[
operator|(
name|tmp
operator|>>
literal|5
operator|)
operator|&
literal|0x7
index|]
operator|<<
literal|3
operator|)
expr_stmt|;
name|d
operator|=
name|PC1_DL
index|[
operator|(
name|tmp
operator|>>
literal|25
operator|)
operator|&
literal|0xf
index|]
operator||
operator|(
name|PC1_DL
index|[
operator|(
name|tmp
operator|>>
literal|17
operator|)
operator|&
literal|0xf
index|]
operator|<<
literal|1
operator|)
operator||
operator|(
name|PC1_DL
index|[
operator|(
name|tmp
operator|>>
literal|9
operator|)
operator|&
literal|0xf
index|]
operator|<<
literal|2
operator|)
operator||
operator|(
name|PC1_DL
index|[
operator|(
name|tmp
operator|>>
literal|1
operator|)
operator|&
literal|0xf
index|]
operator|<<
literal|3
operator|)
expr_stmt|;
name|tmp
operator|=
operator|*
operator|(
name|key
operator|+
literal|1
operator|)
expr_stmt|;
comment|/* right part of key */
name|c
operator||=
name|PC1_CR
index|[
operator|(
name|tmp
operator|>>
literal|28
operator|)
operator|&
literal|0xf
index|]
operator||
operator|(
name|PC1_CR
index|[
operator|(
name|tmp
operator|>>
literal|20
operator|)
operator|&
literal|0xf
index|]
operator|<<
literal|1
operator|)
operator||
operator|(
name|PC1_CR
index|[
operator|(
name|tmp
operator|>>
literal|12
operator|)
operator|&
literal|0xf
index|]
operator|<<
literal|2
operator|)
operator||
operator|(
name|PC1_CR
index|[
operator|(
name|tmp
operator|>>
literal|4
operator|)
operator|&
literal|0xf
index|]
operator|<<
literal|3
operator|)
expr_stmt|;
name|d
operator||=
name|PC1_DR
index|[
operator|(
name|tmp
operator|>>
literal|25
operator|)
operator|&
literal|0x7
index|]
operator||
operator|(
name|PC1_DR
index|[
operator|(
name|tmp
operator|>>
literal|17
operator|)
operator|&
literal|0x7
index|]
operator|<<
literal|1
operator|)
operator||
operator|(
name|PC1_DR
index|[
operator|(
name|tmp
operator|>>
literal|9
operator|)
operator|&
literal|0x7
index|]
operator|<<
literal|2
operator|)
operator||
operator|(
name|PC1_DR
index|[
operator|(
name|tmp
operator|>>
literal|1
operator|)
operator|&
literal|0x7
index|]
operator|<<
literal|3
operator|)
expr_stmt|;
comment|/* 	 * Now iterate to compute the key schedule.  Note that we 	 * record the entire set of subkeys in 6 bit chunks since 	 * they are used that way.  At 6 bits/char, we need 	 * 48/6 char's/subkey * 16 subkeys/encryption == 128 chars. 	 * encryptkeys and decryptkeys must be this big. 	 */
name|ek
operator|=
name|encryptkeys
expr_stmt|;
name|dk
operator|=
name|decryptkeys
operator|+
operator|(
literal|8
operator|*
literal|15
operator|)
expr_stmt|;
name|two_bit_shifts
operator|=
name|TWO_BIT_SHIFTS
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|16
init|;
name|i
operator|>
literal|0
condition|;
name|i
operator|--
control|)
block|{
comment|/* 		 * Do the rotation.  One bit and two bit rotations 		 * are done separately.  Note C and D are 28 bits. 		 */
if|if
condition|(
name|two_bit_shifts
operator|&
literal|0x1
condition|)
block|{
name|c
operator|=
operator|(
operator|(
name|c
operator|<<
literal|2
operator|)
operator|&
literal|0xffffffc
operator|)
operator||
operator|(
name|c
operator|>>
literal|26
operator|)
expr_stmt|;
name|d
operator|=
operator|(
operator|(
name|d
operator|<<
literal|2
operator|)
operator|&
literal|0xffffffc
operator|)
operator||
operator|(
name|d
operator|>>
literal|26
operator|)
expr_stmt|;
block|}
else|else
block|{
name|c
operator|=
operator|(
operator|(
name|c
operator|<<
literal|1
operator|)
operator|&
literal|0xffffffe
operator|)
operator||
operator|(
name|c
operator|>>
literal|27
operator|)
expr_stmt|;
name|d
operator|=
operator|(
operator|(
name|d
operator|<<
literal|1
operator|)
operator|&
literal|0xffffffe
operator|)
operator||
operator|(
name|d
operator|>>
literal|27
operator|)
expr_stmt|;
block|}
name|two_bit_shifts
operator|>>=
literal|1
expr_stmt|;
comment|/* 		 * Apply permutted choice 2 to C to get the first 		 * 24 bits worth of keys.  Note that bits 9, 18, 22 		 * and 25 (using DES numbering) in C are unused.  The 		 * shift-mask stuff is done to delete these bits from 		 * the indices, since this cuts the table size in half. 		 */
name|tmp
operator|=
name|PC2_C
index|[
literal|0
index|]
index|[
operator|(
operator|(
name|c
operator|>>
literal|22
operator|)
operator|&
literal|0x3f
operator|)
index|]
operator||
name|PC2_C
index|[
literal|1
index|]
index|[
operator|(
operator|(
name|c
operator|>>
literal|15
operator|)
operator|&
literal|0xf
operator|)
operator||
operator|(
operator|(
name|c
operator|>>
literal|16
operator|)
operator|&
literal|0x30
operator|)
index|]
operator||
name|PC2_C
index|[
literal|2
index|]
index|[
operator|(
operator|(
name|c
operator|>>
literal|4
operator|)
operator|&
literal|0x3
operator|)
operator||
operator|(
operator|(
name|c
operator|>>
literal|9
operator|)
operator|&
literal|0x3c
operator|)
index|]
operator||
name|PC2_C
index|[
literal|3
index|]
index|[
operator|(
operator|(
name|c
operator|)
operator|&
literal|0x7
operator|)
operator||
operator|(
operator|(
name|c
operator|>>
literal|4
operator|)
operator|&
literal|0x38
operator|)
index|]
expr_stmt|;
operator|*
name|ek
operator|++
operator|=
operator|*
name|dk
operator|++
operator|=
call|(
name|u_char
call|)
argument_list|(
name|tmp
operator|>>
literal|24
argument_list|)
expr_stmt|;
operator|*
name|ek
operator|++
operator|=
operator|*
name|dk
operator|++
operator|=
call|(
name|u_char
call|)
argument_list|(
name|tmp
operator|>>
literal|16
argument_list|)
expr_stmt|;
operator|*
name|ek
operator|++
operator|=
operator|*
name|dk
operator|++
operator|=
call|(
name|u_char
call|)
argument_list|(
name|tmp
operator|>>
literal|8
argument_list|)
expr_stmt|;
operator|*
name|ek
operator|++
operator|=
operator|*
name|dk
operator|++
operator|=
operator|(
name|u_char
operator|)
name|tmp
expr_stmt|;
comment|/* 		 * Apply permutted choice 2 to D to get the other half. 		 * Here, bits 7, 10, 15 and 26 go unused.  The sqeezing 		 * actually turns out to be cheaper here. 		 */
name|tmp
operator|=
name|PC2_D
index|[
literal|0
index|]
index|[
operator|(
operator|(
name|d
operator|>>
literal|22
operator|)
operator|&
literal|0x3f
operator|)
index|]
operator||
name|PC2_D
index|[
literal|1
index|]
index|[
operator|(
operator|(
name|d
operator|>>
literal|14
operator|)
operator|&
literal|0xf
operator|)
operator||
operator|(
operator|(
name|d
operator|>>
literal|15
operator|)
operator|&
literal|0x30
operator|)
index|]
operator||
name|PC2_D
index|[
literal|2
index|]
index|[
operator|(
operator|(
name|d
operator|>>
literal|7
operator|)
operator|&
literal|0x3f
operator|)
index|]
operator||
name|PC2_D
index|[
literal|3
index|]
index|[
operator|(
operator|(
name|d
operator|)
operator|&
literal|0x3
operator|)
operator||
operator|(
operator|(
name|d
operator|>>
literal|1
operator|)
operator|&
literal|0x3c
operator|)
index|]
expr_stmt|;
operator|*
name|ek
operator|++
operator|=
operator|*
name|dk
operator|++
operator|=
call|(
name|u_char
call|)
argument_list|(
name|tmp
operator|>>
literal|24
argument_list|)
expr_stmt|;
operator|*
name|ek
operator|++
operator|=
operator|*
name|dk
operator|++
operator|=
call|(
name|u_char
call|)
argument_list|(
name|tmp
operator|>>
literal|16
argument_list|)
expr_stmt|;
operator|*
name|ek
operator|++
operator|=
operator|*
name|dk
operator|++
operator|=
call|(
name|u_char
call|)
argument_list|(
name|tmp
operator|>>
literal|8
argument_list|)
expr_stmt|;
operator|*
name|ek
operator|++
operator|=
operator|*
name|dk
operator|++
operator|=
operator|(
name|u_char
operator|)
name|tmp
expr_stmt|;
comment|/* 		 * We are filling in the decryption subkeys from the end. 		 * Space it back 16 elements to get to the start of the 		 * next set. 		 */
name|dk
operator|-=
literal|16
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*  * The DES algorithm.  This is intended to be fairly speedy at the  * expense of some memory.  *  * This uses all the standard hacks.  The S boxes and the P permutation  * are precomputed into one table.  The E box never actually appears  * explicitly since it is easy to apply this algorithmically.  The  * initial permutation and final (inverse initial) permuation are  * computed from tables designed to permute four bits at a time.  This  * should run pretty fast on machines with 32 bit words and  * bit field/multiple bit shift instructions which are fast.  */
end_comment

begin_comment
comment|/*  * The initial permutation array.  This is used to compute both the  * left and the right halves of the initial permutation using bytes  * from words made from the following operations:  *  * ((left& 0x55555555)<< 1) | (right& 0x55555555)  for left half  * (left& 0xaaaaaaaa) | ((right& 0xaaaaaaaa)>> 1)  for right half  *  * The scheme is that we index into the table using each byte.  The  * result from the high order byte is or'd with the result from the  * next byte shifted left once is or'd with the result from the next  * byte shifted left twice if or'd with the result from the low order  * byte shifted left by three.  Clear?  */
end_comment

begin_decl_stmt
specifier|static
name|U_LONG
name|IP
index|[
literal|256
index|]
init|=
block|{
literal|0x00000000
block|,
literal|0x00000010
block|,
literal|0x00000001
block|,
literal|0x00000011
block|,
literal|0x00001000
block|,
literal|0x00001010
block|,
literal|0x00001001
block|,
literal|0x00001011
block|,
literal|0x00000100
block|,
literal|0x00000110
block|,
literal|0x00000101
block|,
literal|0x00000111
block|,
literal|0x00001100
block|,
literal|0x00001110
block|,
literal|0x00001101
block|,
literal|0x00001111
block|,
literal|0x00100000
block|,
literal|0x00100010
block|,
literal|0x00100001
block|,
literal|0x00100011
block|,
literal|0x00101000
block|,
literal|0x00101010
block|,
literal|0x00101001
block|,
literal|0x00101011
block|,
literal|0x00100100
block|,
literal|0x00100110
block|,
literal|0x00100101
block|,
literal|0x00100111
block|,
literal|0x00101100
block|,
literal|0x00101110
block|,
literal|0x00101101
block|,
literal|0x00101111
block|,
literal|0x00010000
block|,
literal|0x00010010
block|,
literal|0x00010001
block|,
literal|0x00010011
block|,
literal|0x00011000
block|,
literal|0x00011010
block|,
literal|0x00011001
block|,
literal|0x00011011
block|,
literal|0x00010100
block|,
literal|0x00010110
block|,
literal|0x00010101
block|,
literal|0x00010111
block|,
literal|0x00011100
block|,
literal|0x00011110
block|,
literal|0x00011101
block|,
literal|0x00011111
block|,
literal|0x00110000
block|,
literal|0x00110010
block|,
literal|0x00110001
block|,
literal|0x00110011
block|,
literal|0x00111000
block|,
literal|0x00111010
block|,
literal|0x00111001
block|,
literal|0x00111011
block|,
literal|0x00110100
block|,
literal|0x00110110
block|,
literal|0x00110101
block|,
literal|0x00110111
block|,
literal|0x00111100
block|,
literal|0x00111110
block|,
literal|0x00111101
block|,
literal|0x00111111
block|,
literal|0x10000000
block|,
literal|0x10000010
block|,
literal|0x10000001
block|,
literal|0x10000011
block|,
literal|0x10001000
block|,
literal|0x10001010
block|,
literal|0x10001001
block|,
literal|0x10001011
block|,
literal|0x10000100
block|,
literal|0x10000110
block|,
literal|0x10000101
block|,
literal|0x10000111
block|,
literal|0x10001100
block|,
literal|0x10001110
block|,
literal|0x10001101
block|,
literal|0x10001111
block|,
literal|0x10100000
block|,
literal|0x10100010
block|,
literal|0x10100001
block|,
literal|0x10100011
block|,
literal|0x10101000
block|,
literal|0x10101010
block|,
literal|0x10101001
block|,
literal|0x10101011
block|,
literal|0x10100100
block|,
literal|0x10100110
block|,
literal|0x10100101
block|,
literal|0x10100111
block|,
literal|0x10101100
block|,
literal|0x10101110
block|,
literal|0x10101101
block|,
literal|0x10101111
block|,
literal|0x10010000
block|,
literal|0x10010010
block|,
literal|0x10010001
block|,
literal|0x10010011
block|,
literal|0x10011000
block|,
literal|0x10011010
block|,
literal|0x10011001
block|,
literal|0x10011011
block|,
literal|0x10010100
block|,
literal|0x10010110
block|,
literal|0x10010101
block|,
literal|0x10010111
block|,
literal|0x10011100
block|,
literal|0x10011110
block|,
literal|0x10011101
block|,
literal|0x10011111
block|,
literal|0x10110000
block|,
literal|0x10110010
block|,
literal|0x10110001
block|,
literal|0x10110011
block|,
literal|0x10111000
block|,
literal|0x10111010
block|,
literal|0x10111001
block|,
literal|0x10111011
block|,
literal|0x10110100
block|,
literal|0x10110110
block|,
literal|0x10110101
block|,
literal|0x10110111
block|,
literal|0x10111100
block|,
literal|0x10111110
block|,
literal|0x10111101
block|,
literal|0x10111111
block|,
literal|0x01000000
block|,
literal|0x01000010
block|,
literal|0x01000001
block|,
literal|0x01000011
block|,
literal|0x01001000
block|,
literal|0x01001010
block|,
literal|0x01001001
block|,
literal|0x01001011
block|,
literal|0x01000100
block|,
literal|0x01000110
block|,
literal|0x01000101
block|,
literal|0x01000111
block|,
literal|0x01001100
block|,
literal|0x01001110
block|,
literal|0x01001101
block|,
literal|0x01001111
block|,
literal|0x01100000
block|,
literal|0x01100010
block|,
literal|0x01100001
block|,
literal|0x01100011
block|,
literal|0x01101000
block|,
literal|0x01101010
block|,
literal|0x01101001
block|,
literal|0x01101011
block|,
literal|0x01100100
block|,
literal|0x01100110
block|,
literal|0x01100101
block|,
literal|0x01100111
block|,
literal|0x01101100
block|,
literal|0x01101110
block|,
literal|0x01101101
block|,
literal|0x01101111
block|,
literal|0x01010000
block|,
literal|0x01010010
block|,
literal|0x01010001
block|,
literal|0x01010011
block|,
literal|0x01011000
block|,
literal|0x01011010
block|,
literal|0x01011001
block|,
literal|0x01011011
block|,
literal|0x01010100
block|,
literal|0x01010110
block|,
literal|0x01010101
block|,
literal|0x01010111
block|,
literal|0x01011100
block|,
literal|0x01011110
block|,
literal|0x01011101
block|,
literal|0x01011111
block|,
literal|0x01110000
block|,
literal|0x01110010
block|,
literal|0x01110001
block|,
literal|0x01110011
block|,
literal|0x01111000
block|,
literal|0x01111010
block|,
literal|0x01111001
block|,
literal|0x01111011
block|,
literal|0x01110100
block|,
literal|0x01110110
block|,
literal|0x01110101
block|,
literal|0x01110111
block|,
literal|0x01111100
block|,
literal|0x01111110
block|,
literal|0x01111101
block|,
literal|0x01111111
block|,
literal|0x11000000
block|,
literal|0x11000010
block|,
literal|0x11000001
block|,
literal|0x11000011
block|,
literal|0x11001000
block|,
literal|0x11001010
block|,
literal|0x11001001
block|,
literal|0x11001011
block|,
literal|0x11000100
block|,
literal|0x11000110
block|,
literal|0x11000101
block|,
literal|0x11000111
block|,
literal|0x11001100
block|,
literal|0x11001110
block|,
literal|0x11001101
block|,
literal|0x11001111
block|,
literal|0x11100000
block|,
literal|0x11100010
block|,
literal|0x11100001
block|,
literal|0x11100011
block|,
literal|0x11101000
block|,
literal|0x11101010
block|,
literal|0x11101001
block|,
literal|0x11101011
block|,
literal|0x11100100
block|,
literal|0x11100110
block|,
literal|0x11100101
block|,
literal|0x11100111
block|,
literal|0x11101100
block|,
literal|0x11101110
block|,
literal|0x11101101
block|,
literal|0x11101111
block|,
literal|0x11010000
block|,
literal|0x11010010
block|,
literal|0x11010001
block|,
literal|0x11010011
block|,
literal|0x11011000
block|,
literal|0x11011010
block|,
literal|0x11011001
block|,
literal|0x11011011
block|,
literal|0x11010100
block|,
literal|0x11010110
block|,
literal|0x11010101
block|,
literal|0x11010111
block|,
literal|0x11011100
block|,
literal|0x11011110
block|,
literal|0x11011101
block|,
literal|0x11011111
block|,
literal|0x11110000
block|,
literal|0x11110010
block|,
literal|0x11110001
block|,
literal|0x11110011
block|,
literal|0x11111000
block|,
literal|0x11111010
block|,
literal|0x11111001
block|,
literal|0x11111011
block|,
literal|0x11110100
block|,
literal|0x11110110
block|,
literal|0x11110101
block|,
literal|0x11110111
block|,
literal|0x11111100
block|,
literal|0x11111110
block|,
literal|0x11111101
block|,
literal|0x11111111
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * The final permutation array.  Like the IP array, used  * to compute both the left and right results from the nibbles  * of words computed from:  *  * ((left& 0x0f0f0f0f)<< 4) | (right& 0x0f0f0f0f)  for left result  * (left& 0xf0f0f0f0) | ((right& 0xf0f0f0f0)>> 4)  for right result  *  * The result from the high order byte is shifted left 6 bits and  * or'd with the result from the next byte shifted left 4 bits, which  * is or'd with the result from the next byte shifted left 2 bits,  * which is or'd with the result from the low byte.  *  * There is one of these for big end machines (the natural order for  * DES) and a second for little end machines.  One is a byte swapped  * version of the other.  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|XNTP_LITTLE_ENDIAN
end_ifndef

begin_comment
comment|/* 	 * Big end version 	 */
end_comment

begin_decl_stmt
specifier|static
name|U_LONG
name|FP
index|[
literal|256
index|]
init|=
block|{
literal|0x00000000
block|,
literal|0x02000000
block|,
literal|0x00020000
block|,
literal|0x02020000
block|,
literal|0x00000200
block|,
literal|0x02000200
block|,
literal|0x00020200
block|,
literal|0x02020200
block|,
literal|0x00000002
block|,
literal|0x02000002
block|,
literal|0x00020002
block|,
literal|0x02020002
block|,
literal|0x00000202
block|,
literal|0x02000202
block|,
literal|0x00020202
block|,
literal|0x02020202
block|,
literal|0x01000000
block|,
literal|0x03000000
block|,
literal|0x01020000
block|,
literal|0x03020000
block|,
literal|0x01000200
block|,
literal|0x03000200
block|,
literal|0x01020200
block|,
literal|0x03020200
block|,
literal|0x01000002
block|,
literal|0x03000002
block|,
literal|0x01020002
block|,
literal|0x03020002
block|,
literal|0x01000202
block|,
literal|0x03000202
block|,
literal|0x01020202
block|,
literal|0x03020202
block|,
literal|0x00010000
block|,
literal|0x02010000
block|,
literal|0x00030000
block|,
literal|0x02030000
block|,
literal|0x00010200
block|,
literal|0x02010200
block|,
literal|0x00030200
block|,
literal|0x02030200
block|,
literal|0x00010002
block|,
literal|0x02010002
block|,
literal|0x00030002
block|,
literal|0x02030002
block|,
literal|0x00010202
block|,
literal|0x02010202
block|,
literal|0x00030202
block|,
literal|0x02030202
block|,
literal|0x01010000
block|,
literal|0x03010000
block|,
literal|0x01030000
block|,
literal|0x03030000
block|,
literal|0x01010200
block|,
literal|0x03010200
block|,
literal|0x01030200
block|,
literal|0x03030200
block|,
literal|0x01010002
block|,
literal|0x03010002
block|,
literal|0x01030002
block|,
literal|0x03030002
block|,
literal|0x01010202
block|,
literal|0x03010202
block|,
literal|0x01030202
block|,
literal|0x03030202
block|,
literal|0x00000100
block|,
literal|0x02000100
block|,
literal|0x00020100
block|,
literal|0x02020100
block|,
literal|0x00000300
block|,
literal|0x02000300
block|,
literal|0x00020300
block|,
literal|0x02020300
block|,
literal|0x00000102
block|,
literal|0x02000102
block|,
literal|0x00020102
block|,
literal|0x02020102
block|,
literal|0x00000302
block|,
literal|0x02000302
block|,
literal|0x00020302
block|,
literal|0x02020302
block|,
literal|0x01000100
block|,
literal|0x03000100
block|,
literal|0x01020100
block|,
literal|0x03020100
block|,
literal|0x01000300
block|,
literal|0x03000300
block|,
literal|0x01020300
block|,
literal|0x03020300
block|,
literal|0x01000102
block|,
literal|0x03000102
block|,
literal|0x01020102
block|,
literal|0x03020102
block|,
literal|0x01000302
block|,
literal|0x03000302
block|,
literal|0x01020302
block|,
literal|0x03020302
block|,
literal|0x00010100
block|,
literal|0x02010100
block|,
literal|0x00030100
block|,
literal|0x02030100
block|,
literal|0x00010300
block|,
literal|0x02010300
block|,
literal|0x00030300
block|,
literal|0x02030300
block|,
literal|0x00010102
block|,
literal|0x02010102
block|,
literal|0x00030102
block|,
literal|0x02030102
block|,
literal|0x00010302
block|,
literal|0x02010302
block|,
literal|0x00030302
block|,
literal|0x02030302
block|,
literal|0x01010100
block|,
literal|0x03010100
block|,
literal|0x01030100
block|,
literal|0x03030100
block|,
literal|0x01010300
block|,
literal|0x03010300
block|,
literal|0x01030300
block|,
literal|0x03030300
block|,
literal|0x01010102
block|,
literal|0x03010102
block|,
literal|0x01030102
block|,
literal|0x03030102
block|,
literal|0x01010302
block|,
literal|0x03010302
block|,
literal|0x01030302
block|,
literal|0x03030302
block|,
literal|0x00000001
block|,
literal|0x02000001
block|,
literal|0x00020001
block|,
literal|0x02020001
block|,
literal|0x00000201
block|,
literal|0x02000201
block|,
literal|0x00020201
block|,
literal|0x02020201
block|,
literal|0x00000003
block|,
literal|0x02000003
block|,
literal|0x00020003
block|,
literal|0x02020003
block|,
literal|0x00000203
block|,
literal|0x02000203
block|,
literal|0x00020203
block|,
literal|0x02020203
block|,
literal|0x01000001
block|,
literal|0x03000001
block|,
literal|0x01020001
block|,
literal|0x03020001
block|,
literal|0x01000201
block|,
literal|0x03000201
block|,
literal|0x01020201
block|,
literal|0x03020201
block|,
literal|0x01000003
block|,
literal|0x03000003
block|,
literal|0x01020003
block|,
literal|0x03020003
block|,
literal|0x01000203
block|,
literal|0x03000203
block|,
literal|0x01020203
block|,
literal|0x03020203
block|,
literal|0x00010001
block|,
literal|0x02010001
block|,
literal|0x00030001
block|,
literal|0x02030001
block|,
literal|0x00010201
block|,
literal|0x02010201
block|,
literal|0x00030201
block|,
literal|0x02030201
block|,
literal|0x00010003
block|,
literal|0x02010003
block|,
literal|0x00030003
block|,
literal|0x02030003
block|,
literal|0x00010203
block|,
literal|0x02010203
block|,
literal|0x00030203
block|,
literal|0x02030203
block|,
literal|0x01010001
block|,
literal|0x03010001
block|,
literal|0x01030001
block|,
literal|0x03030001
block|,
literal|0x01010201
block|,
literal|0x03010201
block|,
literal|0x01030201
block|,
literal|0x03030201
block|,
literal|0x01010003
block|,
literal|0x03010003
block|,
literal|0x01030003
block|,
literal|0x03030003
block|,
literal|0x01010203
block|,
literal|0x03010203
block|,
literal|0x01030203
block|,
literal|0x03030203
block|,
literal|0x00000101
block|,
literal|0x02000101
block|,
literal|0x00020101
block|,
literal|0x02020101
block|,
literal|0x00000301
block|,
literal|0x02000301
block|,
literal|0x00020301
block|,
literal|0x02020301
block|,
literal|0x00000103
block|,
literal|0x02000103
block|,
literal|0x00020103
block|,
literal|0x02020103
block|,
literal|0x00000303
block|,
literal|0x02000303
block|,
literal|0x00020303
block|,
literal|0x02020303
block|,
literal|0x01000101
block|,
literal|0x03000101
block|,
literal|0x01020101
block|,
literal|0x03020101
block|,
literal|0x01000301
block|,
literal|0x03000301
block|,
literal|0x01020301
block|,
literal|0x03020301
block|,
literal|0x01000103
block|,
literal|0x03000103
block|,
literal|0x01020103
block|,
literal|0x03020103
block|,
literal|0x01000303
block|,
literal|0x03000303
block|,
literal|0x01020303
block|,
literal|0x03020303
block|,
literal|0x00010101
block|,
literal|0x02010101
block|,
literal|0x00030101
block|,
literal|0x02030101
block|,
literal|0x00010301
block|,
literal|0x02010301
block|,
literal|0x00030301
block|,
literal|0x02030301
block|,
literal|0x00010103
block|,
literal|0x02010103
block|,
literal|0x00030103
block|,
literal|0x02030103
block|,
literal|0x00010303
block|,
literal|0x02010303
block|,
literal|0x00030303
block|,
literal|0x02030303
block|,
literal|0x01010101
block|,
literal|0x03010101
block|,
literal|0x01030101
block|,
literal|0x03030101
block|,
literal|0x01010301
block|,
literal|0x03010301
block|,
literal|0x01030301
block|,
literal|0x03030301
block|,
literal|0x01010103
block|,
literal|0x03010103
block|,
literal|0x01030103
block|,
literal|0x03030103
block|,
literal|0x01010303
block|,
literal|0x03010303
block|,
literal|0x01030303
block|,
literal|0x03030303
block|}
decl_stmt|;
end_decl_stmt

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* 	 * Byte swapped for little end machines. 	 */
end_comment

begin_decl_stmt
specifier|static
name|U_LONG
name|FP
index|[
literal|256
index|]
init|=
block|{
literal|0x00000000
block|,
literal|0x00000002
block|,
literal|0x00000200
block|,
literal|0x00000202
block|,
literal|0x00020000
block|,
literal|0x00020002
block|,
literal|0x00020200
block|,
literal|0x00020202
block|,
literal|0x02000000
block|,
literal|0x02000002
block|,
literal|0x02000200
block|,
literal|0x02000202
block|,
literal|0x02020000
block|,
literal|0x02020002
block|,
literal|0x02020200
block|,
literal|0x02020202
block|,
literal|0x00000001
block|,
literal|0x00000003
block|,
literal|0x00000201
block|,
literal|0x00000203
block|,
literal|0x00020001
block|,
literal|0x00020003
block|,
literal|0x00020201
block|,
literal|0x00020203
block|,
literal|0x02000001
block|,
literal|0x02000003
block|,
literal|0x02000201
block|,
literal|0x02000203
block|,
literal|0x02020001
block|,
literal|0x02020003
block|,
literal|0x02020201
block|,
literal|0x02020203
block|,
literal|0x00000100
block|,
literal|0x00000102
block|,
literal|0x00000300
block|,
literal|0x00000302
block|,
literal|0x00020100
block|,
literal|0x00020102
block|,
literal|0x00020300
block|,
literal|0x00020302
block|,
literal|0x02000100
block|,
literal|0x02000102
block|,
literal|0x02000300
block|,
literal|0x02000302
block|,
literal|0x02020100
block|,
literal|0x02020102
block|,
literal|0x02020300
block|,
literal|0x02020302
block|,
literal|0x00000101
block|,
literal|0x00000103
block|,
literal|0x00000301
block|,
literal|0x00000303
block|,
literal|0x00020101
block|,
literal|0x00020103
block|,
literal|0x00020301
block|,
literal|0x00020303
block|,
literal|0x02000101
block|,
literal|0x02000103
block|,
literal|0x02000301
block|,
literal|0x02000303
block|,
literal|0x02020101
block|,
literal|0x02020103
block|,
literal|0x02020301
block|,
literal|0x02020303
block|,
literal|0x00010000
block|,
literal|0x00010002
block|,
literal|0x00010200
block|,
literal|0x00010202
block|,
literal|0x00030000
block|,
literal|0x00030002
block|,
literal|0x00030200
block|,
literal|0x00030202
block|,
literal|0x02010000
block|,
literal|0x02010002
block|,
literal|0x02010200
block|,
literal|0x02010202
block|,
literal|0x02030000
block|,
literal|0x02030002
block|,
literal|0x02030200
block|,
literal|0x02030202
block|,
literal|0x00010001
block|,
literal|0x00010003
block|,
literal|0x00010201
block|,
literal|0x00010203
block|,
literal|0x00030001
block|,
literal|0x00030003
block|,
literal|0x00030201
block|,
literal|0x00030203
block|,
literal|0x02010001
block|,
literal|0x02010003
block|,
literal|0x02010201
block|,
literal|0x02010203
block|,
literal|0x02030001
block|,
literal|0x02030003
block|,
literal|0x02030201
block|,
literal|0x02030203
block|,
literal|0x00010100
block|,
literal|0x00010102
block|,
literal|0x00010300
block|,
literal|0x00010302
block|,
literal|0x00030100
block|,
literal|0x00030102
block|,
literal|0x00030300
block|,
literal|0x00030302
block|,
literal|0x02010100
block|,
literal|0x02010102
block|,
literal|0x02010300
block|,
literal|0x02010302
block|,
literal|0x02030100
block|,
literal|0x02030102
block|,
literal|0x02030300
block|,
literal|0x02030302
block|,
literal|0x00010101
block|,
literal|0x00010103
block|,
literal|0x00010301
block|,
literal|0x00010303
block|,
literal|0x00030101
block|,
literal|0x00030103
block|,
literal|0x00030301
block|,
literal|0x00030303
block|,
literal|0x02010101
block|,
literal|0x02010103
block|,
literal|0x02010301
block|,
literal|0x02010303
block|,
literal|0x02030101
block|,
literal|0x02030103
block|,
literal|0x02030301
block|,
literal|0x02030303
block|,
literal|0x01000000
block|,
literal|0x01000002
block|,
literal|0x01000200
block|,
literal|0x01000202
block|,
literal|0x01020000
block|,
literal|0x01020002
block|,
literal|0x01020200
block|,
literal|0x01020202
block|,
literal|0x03000000
block|,
literal|0x03000002
block|,
literal|0x03000200
block|,
literal|0x03000202
block|,
literal|0x03020000
block|,
literal|0x03020002
block|,
literal|0x03020200
block|,
literal|0x03020202
block|,
literal|0x01000001
block|,
literal|0x01000003
block|,
literal|0x01000201
block|,
literal|0x01000203
block|,
literal|0x01020001
block|,
literal|0x01020003
block|,
literal|0x01020201
block|,
literal|0x01020203
block|,
literal|0x03000001
block|,
literal|0x03000003
block|,
literal|0x03000201
block|,
literal|0x03000203
block|,
literal|0x03020001
block|,
literal|0x03020003
block|,
literal|0x03020201
block|,
literal|0x03020203
block|,
literal|0x01000100
block|,
literal|0x01000102
block|,
literal|0x01000300
block|,
literal|0x01000302
block|,
literal|0x01020100
block|,
literal|0x01020102
block|,
literal|0x01020300
block|,
literal|0x01020302
block|,
literal|0x03000100
block|,
literal|0x03000102
block|,
literal|0x03000300
block|,
literal|0x03000302
block|,
literal|0x03020100
block|,
literal|0x03020102
block|,
literal|0x03020300
block|,
literal|0x03020302
block|,
literal|0x01000101
block|,
literal|0x01000103
block|,
literal|0x01000301
block|,
literal|0x01000303
block|,
literal|0x01020101
block|,
literal|0x01020103
block|,
literal|0x01020301
block|,
literal|0x01020303
block|,
literal|0x03000101
block|,
literal|0x03000103
block|,
literal|0x03000301
block|,
literal|0x03000303
block|,
literal|0x03020101
block|,
literal|0x03020103
block|,
literal|0x03020301
block|,
literal|0x03020303
block|,
literal|0x01010000
block|,
literal|0x01010002
block|,
literal|0x01010200
block|,
literal|0x01010202
block|,
literal|0x01030000
block|,
literal|0x01030002
block|,
literal|0x01030200
block|,
literal|0x01030202
block|,
literal|0x03010000
block|,
literal|0x03010002
block|,
literal|0x03010200
block|,
literal|0x03010202
block|,
literal|0x03030000
block|,
literal|0x03030002
block|,
literal|0x03030200
block|,
literal|0x03030202
block|,
literal|0x01010001
block|,
literal|0x01010003
block|,
literal|0x01010201
block|,
literal|0x01010203
block|,
literal|0x01030001
block|,
literal|0x01030003
block|,
literal|0x01030201
block|,
literal|0x01030203
block|,
literal|0x03010001
block|,
literal|0x03010003
block|,
literal|0x03010201
block|,
literal|0x03010203
block|,
literal|0x03030001
block|,
literal|0x03030003
block|,
literal|0x03030201
block|,
literal|0x03030203
block|,
literal|0x01010100
block|,
literal|0x01010102
block|,
literal|0x01010300
block|,
literal|0x01010302
block|,
literal|0x01030100
block|,
literal|0x01030102
block|,
literal|0x01030300
block|,
literal|0x01030302
block|,
literal|0x03010100
block|,
literal|0x03010102
block|,
literal|0x03010300
block|,
literal|0x03010302
block|,
literal|0x03030100
block|,
literal|0x03030102
block|,
literal|0x03030300
block|,
literal|0x03030302
block|,
literal|0x01010101
block|,
literal|0x01010103
block|,
literal|0x01010301
block|,
literal|0x01010303
block|,
literal|0x01030101
block|,
literal|0x01030103
block|,
literal|0x01030301
block|,
literal|0x01030303
block|,
literal|0x03010101
block|,
literal|0x03010103
block|,
literal|0x03010301
block|,
literal|0x03010303
block|,
literal|0x03030101
block|,
literal|0x03030103
block|,
literal|0x03030301
block|,
literal|0x03030303
block|}
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/*  * The SP table is actually the S boxes and the P permutation  * table combined.  */
end_comment

begin_decl_stmt
specifier|static
name|U_LONG
name|SP
index|[
literal|8
index|]
index|[
literal|64
index|]
init|=
block|{
block|{
literal|0x00808200
block|,
literal|0x00000000
block|,
literal|0x00008000
block|,
literal|0x00808202
block|,
literal|0x00808002
block|,
literal|0x00008202
block|,
literal|0x00000002
block|,
literal|0x00008000
block|,
literal|0x00000200
block|,
literal|0x00808200
block|,
literal|0x00808202
block|,
literal|0x00000200
block|,
literal|0x00800202
block|,
literal|0x00808002
block|,
literal|0x00800000
block|,
literal|0x00000002
block|,
literal|0x00000202
block|,
literal|0x00800200
block|,
literal|0x00800200
block|,
literal|0x00008200
block|,
literal|0x00008200
block|,
literal|0x00808000
block|,
literal|0x00808000
block|,
literal|0x00800202
block|,
literal|0x00008002
block|,
literal|0x00800002
block|,
literal|0x00800002
block|,
literal|0x00008002
block|,
literal|0x00000000
block|,
literal|0x00000202
block|,
literal|0x00008202
block|,
literal|0x00800000
block|,
literal|0x00008000
block|,
literal|0x00808202
block|,
literal|0x00000002
block|,
literal|0x00808000
block|,
literal|0x00808200
block|,
literal|0x00800000
block|,
literal|0x00800000
block|,
literal|0x00000200
block|,
literal|0x00808002
block|,
literal|0x00008000
block|,
literal|0x00008200
block|,
literal|0x00800002
block|,
literal|0x00000200
block|,
literal|0x00000002
block|,
literal|0x00800202
block|,
literal|0x00008202
block|,
literal|0x00808202
block|,
literal|0x00008002
block|,
literal|0x00808000
block|,
literal|0x00800202
block|,
literal|0x00800002
block|,
literal|0x00000202
block|,
literal|0x00008202
block|,
literal|0x00808200
block|,
literal|0x00000202
block|,
literal|0x00800200
block|,
literal|0x00800200
block|,
literal|0x00000000
block|,
literal|0x00008002
block|,
literal|0x00008200
block|,
literal|0x00000000
block|,
literal|0x00808002
block|}
block|,
block|{
literal|0x40084010
block|,
literal|0x40004000
block|,
literal|0x00004000
block|,
literal|0x00084010
block|,
literal|0x00080000
block|,
literal|0x00000010
block|,
literal|0x40080010
block|,
literal|0x40004010
block|,
literal|0x40000010
block|,
literal|0x40084010
block|,
literal|0x40084000
block|,
literal|0x40000000
block|,
literal|0x40004000
block|,
literal|0x00080000
block|,
literal|0x00000010
block|,
literal|0x40080010
block|,
literal|0x00084000
block|,
literal|0x00080010
block|,
literal|0x40004010
block|,
literal|0x00000000
block|,
literal|0x40000000
block|,
literal|0x00004000
block|,
literal|0x00084010
block|,
literal|0x40080000
block|,
literal|0x00080010
block|,
literal|0x40000010
block|,
literal|0x00000000
block|,
literal|0x00084000
block|,
literal|0x00004010
block|,
literal|0x40084000
block|,
literal|0x40080000
block|,
literal|0x00004010
block|,
literal|0x00000000
block|,
literal|0x00084010
block|,
literal|0x40080010
block|,
literal|0x00080000
block|,
literal|0x40004010
block|,
literal|0x40080000
block|,
literal|0x40084000
block|,
literal|0x00004000
block|,
literal|0x40080000
block|,
literal|0x40004000
block|,
literal|0x00000010
block|,
literal|0x40084010
block|,
literal|0x00084010
block|,
literal|0x00000010
block|,
literal|0x00004000
block|,
literal|0x40000000
block|,
literal|0x00004010
block|,
literal|0x40084000
block|,
literal|0x00080000
block|,
literal|0x40000010
block|,
literal|0x00080010
block|,
literal|0x40004010
block|,
literal|0x40000010
block|,
literal|0x00080010
block|,
literal|0x00084000
block|,
literal|0x00000000
block|,
literal|0x40004000
block|,
literal|0x00004010
block|,
literal|0x40000000
block|,
literal|0x40080010
block|,
literal|0x40084010
block|,
literal|0x00084000
block|}
block|,
block|{
literal|0x00000104
block|,
literal|0x04010100
block|,
literal|0x00000000
block|,
literal|0x04010004
block|,
literal|0x04000100
block|,
literal|0x00000000
block|,
literal|0x00010104
block|,
literal|0x04000100
block|,
literal|0x00010004
block|,
literal|0x04000004
block|,
literal|0x04000004
block|,
literal|0x00010000
block|,
literal|0x04010104
block|,
literal|0x00010004
block|,
literal|0x04010000
block|,
literal|0x00000104
block|,
literal|0x04000000
block|,
literal|0x00000004
block|,
literal|0x04010100
block|,
literal|0x00000100
block|,
literal|0x00010100
block|,
literal|0x04010000
block|,
literal|0x04010004
block|,
literal|0x00010104
block|,
literal|0x04000104
block|,
literal|0x00010100
block|,
literal|0x00010000
block|,
literal|0x04000104
block|,
literal|0x00000004
block|,
literal|0x04010104
block|,
literal|0x00000100
block|,
literal|0x04000000
block|,
literal|0x04010100
block|,
literal|0x04000000
block|,
literal|0x00010004
block|,
literal|0x00000104
block|,
literal|0x00010000
block|,
literal|0x04010100
block|,
literal|0x04000100
block|,
literal|0x00000000
block|,
literal|0x00000100
block|,
literal|0x00010004
block|,
literal|0x04010104
block|,
literal|0x04000100
block|,
literal|0x04000004
block|,
literal|0x00000100
block|,
literal|0x00000000
block|,
literal|0x04010004
block|,
literal|0x04000104
block|,
literal|0x00010000
block|,
literal|0x04000000
block|,
literal|0x04010104
block|,
literal|0x00000004
block|,
literal|0x00010104
block|,
literal|0x00010100
block|,
literal|0x04000004
block|,
literal|0x04010000
block|,
literal|0x04000104
block|,
literal|0x00000104
block|,
literal|0x04010000
block|,
literal|0x00010104
block|,
literal|0x00000004
block|,
literal|0x04010004
block|,
literal|0x00010100
block|}
block|,
block|{
literal|0x80401000
block|,
literal|0x80001040
block|,
literal|0x80001040
block|,
literal|0x00000040
block|,
literal|0x00401040
block|,
literal|0x80400040
block|,
literal|0x80400000
block|,
literal|0x80001000
block|,
literal|0x00000000
block|,
literal|0x00401000
block|,
literal|0x00401000
block|,
literal|0x80401040
block|,
literal|0x80000040
block|,
literal|0x00000000
block|,
literal|0x00400040
block|,
literal|0x80400000
block|,
literal|0x80000000
block|,
literal|0x00001000
block|,
literal|0x00400000
block|,
literal|0x80401000
block|,
literal|0x00000040
block|,
literal|0x00400000
block|,
literal|0x80001000
block|,
literal|0x00001040
block|,
literal|0x80400040
block|,
literal|0x80000000
block|,
literal|0x00001040
block|,
literal|0x00400040
block|,
literal|0x00001000
block|,
literal|0x00401040
block|,
literal|0x80401040
block|,
literal|0x80000040
block|,
literal|0x00400040
block|,
literal|0x80400000
block|,
literal|0x00401000
block|,
literal|0x80401040
block|,
literal|0x80000040
block|,
literal|0x00000000
block|,
literal|0x00000000
block|,
literal|0x00401000
block|,
literal|0x00001040
block|,
literal|0x00400040
block|,
literal|0x80400040
block|,
literal|0x80000000
block|,
literal|0x80401000
block|,
literal|0x80001040
block|,
literal|0x80001040
block|,
literal|0x00000040
block|,
literal|0x80401040
block|,
literal|0x80000040
block|,
literal|0x80000000
block|,
literal|0x00001000
block|,
literal|0x80400000
block|,
literal|0x80001000
block|,
literal|0x00401040
block|,
literal|0x80400040
block|,
literal|0x80001000
block|,
literal|0x00001040
block|,
literal|0x00400000
block|,
literal|0x80401000
block|,
literal|0x00000040
block|,
literal|0x00400000
block|,
literal|0x00001000
block|,
literal|0x00401040
block|}
block|,
block|{
literal|0x00000080
block|,
literal|0x01040080
block|,
literal|0x01040000
block|,
literal|0x21000080
block|,
literal|0x00040000
block|,
literal|0x00000080
block|,
literal|0x20000000
block|,
literal|0x01040000
block|,
literal|0x20040080
block|,
literal|0x00040000
block|,
literal|0x01000080
block|,
literal|0x20040080
block|,
literal|0x21000080
block|,
literal|0x21040000
block|,
literal|0x00040080
block|,
literal|0x20000000
block|,
literal|0x01000000
block|,
literal|0x20040000
block|,
literal|0x20040000
block|,
literal|0x00000000
block|,
literal|0x20000080
block|,
literal|0x21040080
block|,
literal|0x21040080
block|,
literal|0x01000080
block|,
literal|0x21040000
block|,
literal|0x20000080
block|,
literal|0x00000000
block|,
literal|0x21000000
block|,
literal|0x01040080
block|,
literal|0x01000000
block|,
literal|0x21000000
block|,
literal|0x00040080
block|,
literal|0x00040000
block|,
literal|0x21000080
block|,
literal|0x00000080
block|,
literal|0x01000000
block|,
literal|0x20000000
block|,
literal|0x01040000
block|,
literal|0x21000080
block|,
literal|0x20040080
block|,
literal|0x01000080
block|,
literal|0x20000000
block|,
literal|0x21040000
block|,
literal|0x01040080
block|,
literal|0x20040080
block|,
literal|0x00000080
block|,
literal|0x01000000
block|,
literal|0x21040000
block|,
literal|0x21040080
block|,
literal|0x00040080
block|,
literal|0x21000000
block|,
literal|0x21040080
block|,
literal|0x01040000
block|,
literal|0x00000000
block|,
literal|0x20040000
block|,
literal|0x21000000
block|,
literal|0x00040080
block|,
literal|0x01000080
block|,
literal|0x20000080
block|,
literal|0x00040000
block|,
literal|0x00000000
block|,
literal|0x20040000
block|,
literal|0x01040080
block|,
literal|0x20000080
block|}
block|,
block|{
literal|0x10000008
block|,
literal|0x10200000
block|,
literal|0x00002000
block|,
literal|0x10202008
block|,
literal|0x10200000
block|,
literal|0x00000008
block|,
literal|0x10202008
block|,
literal|0x00200000
block|,
literal|0x10002000
block|,
literal|0x00202008
block|,
literal|0x00200000
block|,
literal|0x10000008
block|,
literal|0x00200008
block|,
literal|0x10002000
block|,
literal|0x10000000
block|,
literal|0x00002008
block|,
literal|0x00000000
block|,
literal|0x00200008
block|,
literal|0x10002008
block|,
literal|0x00002000
block|,
literal|0x00202000
block|,
literal|0x10002008
block|,
literal|0x00000008
block|,
literal|0x10200008
block|,
literal|0x10200008
block|,
literal|0x00000000
block|,
literal|0x00202008
block|,
literal|0x10202000
block|,
literal|0x00002008
block|,
literal|0x00202000
block|,
literal|0x10202000
block|,
literal|0x10000000
block|,
literal|0x10002000
block|,
literal|0x00000008
block|,
literal|0x10200008
block|,
literal|0x00202000
block|,
literal|0x10202008
block|,
literal|0x00200000
block|,
literal|0x00002008
block|,
literal|0x10000008
block|,
literal|0x00200000
block|,
literal|0x10002000
block|,
literal|0x10000000
block|,
literal|0x00002008
block|,
literal|0x10000008
block|,
literal|0x10202008
block|,
literal|0x00202000
block|,
literal|0x10200000
block|,
literal|0x00202008
block|,
literal|0x10202000
block|,
literal|0x00000000
block|,
literal|0x10200008
block|,
literal|0x00000008
block|,
literal|0x00002000
block|,
literal|0x10200000
block|,
literal|0x00202008
block|,
literal|0x00002000
block|,
literal|0x00200008
block|,
literal|0x10002008
block|,
literal|0x00000000
block|,
literal|0x10202000
block|,
literal|0x10000000
block|,
literal|0x00200008
block|,
literal|0x10002008
block|}
block|,
block|{
literal|0x00100000
block|,
literal|0x02100001
block|,
literal|0x02000401
block|,
literal|0x00000000
block|,
literal|0x00000400
block|,
literal|0x02000401
block|,
literal|0x00100401
block|,
literal|0x02100400
block|,
literal|0x02100401
block|,
literal|0x00100000
block|,
literal|0x00000000
block|,
literal|0x02000001
block|,
literal|0x00000001
block|,
literal|0x02000000
block|,
literal|0x02100001
block|,
literal|0x00000401
block|,
literal|0x02000400
block|,
literal|0x00100401
block|,
literal|0x00100001
block|,
literal|0x02000400
block|,
literal|0x02000001
block|,
literal|0x02100000
block|,
literal|0x02100400
block|,
literal|0x00100001
block|,
literal|0x02100000
block|,
literal|0x00000400
block|,
literal|0x00000401
block|,
literal|0x02100401
block|,
literal|0x00100400
block|,
literal|0x00000001
block|,
literal|0x02000000
block|,
literal|0x00100400
block|,
literal|0x02000000
block|,
literal|0x00100400
block|,
literal|0x00100000
block|,
literal|0x02000401
block|,
literal|0x02000401
block|,
literal|0x02100001
block|,
literal|0x02100001
block|,
literal|0x00000001
block|,
literal|0x00100001
block|,
literal|0x02000000
block|,
literal|0x02000400
block|,
literal|0x00100000
block|,
literal|0x02100400
block|,
literal|0x00000401
block|,
literal|0x00100401
block|,
literal|0x02100400
block|,
literal|0x00000401
block|,
literal|0x02000001
block|,
literal|0x02100401
block|,
literal|0x02100000
block|,
literal|0x00100400
block|,
literal|0x00000000
block|,
literal|0x00000001
block|,
literal|0x02100401
block|,
literal|0x00000000
block|,
literal|0x00100401
block|,
literal|0x02100000
block|,
literal|0x00000400
block|,
literal|0x02000001
block|,
literal|0x02000400
block|,
literal|0x00000400
block|,
literal|0x00100001
block|}
block|,
block|{
literal|0x08000820
block|,
literal|0x00000800
block|,
literal|0x00020000
block|,
literal|0x08020820
block|,
literal|0x08000000
block|,
literal|0x08000820
block|,
literal|0x00000020
block|,
literal|0x08000000
block|,
literal|0x00020020
block|,
literal|0x08020000
block|,
literal|0x08020820
block|,
literal|0x00020800
block|,
literal|0x08020800
block|,
literal|0x00020820
block|,
literal|0x00000800
block|,
literal|0x00000020
block|,
literal|0x08020000
block|,
literal|0x08000020
block|,
literal|0x08000800
block|,
literal|0x00000820
block|,
literal|0x00020800
block|,
literal|0x00020020
block|,
literal|0x08020020
block|,
literal|0x08020800
block|,
literal|0x00000820
block|,
literal|0x00000000
block|,
literal|0x00000000
block|,
literal|0x08020020
block|,
literal|0x08000020
block|,
literal|0x08000800
block|,
literal|0x00020820
block|,
literal|0x00020000
block|,
literal|0x00020820
block|,
literal|0x00020000
block|,
literal|0x08020800
block|,
literal|0x00000800
block|,
literal|0x00000020
block|,
literal|0x08020020
block|,
literal|0x00000800
block|,
literal|0x00020820
block|,
literal|0x08000800
block|,
literal|0x00000020
block|,
literal|0x08000020
block|,
literal|0x08020000
block|,
literal|0x08020020
block|,
literal|0x08000000
block|,
literal|0x00020000
block|,
literal|0x08000820
block|,
literal|0x00000000
block|,
literal|0x08020820
block|,
literal|0x00020020
block|,
literal|0x08000020
block|,
literal|0x08020000
block|,
literal|0x08000800
block|,
literal|0x08000820
block|,
literal|0x00000000
block|,
literal|0x08020820
block|,
literal|0x00020800
block|,
literal|0x00020800
block|,
literal|0x00000820
block|,
literal|0x00000820
block|,
literal|0x00020020
block|,
literal|0x08000000
block|,
literal|0x08020800
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * DESauth_des - perform an in place DES encryption on 64 bits  *  * Note that the `data' argument is always in big-end-first  * byte order, i.e. *(char *)data is the high order byte of  * the 8 byte data word.  We modify the initial and final  * permutation computations for little-end-first machines to  * swap bytes into the natural host order at the beginning and  * back to big-end order at the end.  This is unclean but avoids  * a byte swapping performance penalty on Vaxes (which are slow already).  */
end_comment

begin_function
name|void
name|DESauth_des
parameter_list|(
name|data
parameter_list|,
name|subkeys
parameter_list|)
name|U_LONG
modifier|*
name|data
decl_stmt|;
name|u_char
modifier|*
name|subkeys
decl_stmt|;
block|{
specifier|register
name|U_LONG
name|left
decl_stmt|,
name|right
decl_stmt|;
specifier|register
name|U_LONG
name|temp
decl_stmt|;
specifier|register
name|u_char
modifier|*
name|kp
decl_stmt|;
specifier|register
name|int
name|i
decl_stmt|;
comment|/* 	 * Do the initial permutation.  The first operation gets 	 * all the bits which are used to form the left half of the 	 * permutted result in one word, which is then used to 	 * index the appropriate table a byte at a time. 	 */
name|temp
operator|=
operator|(
operator|(
operator|*
name|data
operator|&
literal|0x55555555
operator|)
operator|<<
literal|1
operator|)
operator||
operator|(
operator|*
operator|(
name|data
operator|+
literal|1
operator|)
operator|&
literal|0x55555555
operator|)
expr_stmt|;
ifdef|#
directive|ifdef
name|XNTP_LITTLE_ENDIAN
comment|/* 	 * Modify the computation to use the opposite set of bytes. 	 */
name|left
operator|=
operator|(
name|IP
index|[
operator|(
name|temp
operator|>>
literal|24
operator|)
operator|&
literal|0xff
index|]
operator|<<
literal|3
operator|)
operator||
operator|(
name|IP
index|[
operator|(
name|temp
operator|>>
literal|16
operator|)
operator|&
literal|0xff
index|]
operator|<<
literal|2
operator|)
operator||
operator|(
name|IP
index|[
operator|(
name|temp
operator|>>
literal|8
operator|)
operator|&
literal|0xff
index|]
operator|<<
literal|1
operator|)
operator||
name|IP
index|[
name|temp
operator|&
literal|0xff
index|]
expr_stmt|;
else|#
directive|else
name|left
operator|=
name|IP
index|[
operator|(
name|temp
operator|>>
literal|24
operator|)
operator|&
literal|0xff
index|]
operator||
operator|(
name|IP
index|[
operator|(
name|temp
operator|>>
literal|16
operator|)
operator|&
literal|0xff
index|]
operator|<<
literal|1
operator|)
operator||
operator|(
name|IP
index|[
operator|(
name|temp
operator|>>
literal|8
operator|)
operator|&
literal|0xff
index|]
operator|<<
literal|2
operator|)
operator||
operator|(
name|IP
index|[
name|temp
operator|&
literal|0xff
index|]
operator|<<
literal|3
operator|)
expr_stmt|;
endif|#
directive|endif
comment|/* 	 * Same thing again except for the right half. 	 */
name|temp
operator|=
operator|(
operator|*
name|data
operator|&
literal|0xaaaaaaaa
operator|)
operator||
operator|(
operator|(
operator|*
operator|(
name|data
operator|+
literal|1
operator|)
operator|&
literal|0xaaaaaaaa
operator|)
operator|>>
literal|1
operator|)
expr_stmt|;
ifdef|#
directive|ifdef
name|XNTP_LITTLE_ENDIAN
name|right
operator|=
operator|(
name|IP
index|[
operator|(
name|temp
operator|>>
literal|24
operator|)
operator|&
literal|0xff
index|]
operator|<<
literal|3
operator|)
operator||
operator|(
name|IP
index|[
operator|(
name|temp
operator|>>
literal|16
operator|)
operator|&
literal|0xff
index|]
operator|<<
literal|2
operator|)
operator||
operator|(
name|IP
index|[
operator|(
name|temp
operator|>>
literal|8
operator|)
operator|&
literal|0xff
index|]
operator|<<
literal|1
operator|)
operator||
name|IP
index|[
name|temp
operator|&
literal|0xff
index|]
expr_stmt|;
else|#
directive|else
name|right
operator|=
name|IP
index|[
operator|(
name|temp
operator|>>
literal|24
operator|)
operator|&
literal|0xff
index|]
operator||
operator|(
name|IP
index|[
operator|(
name|temp
operator|>>
literal|16
operator|)
operator|&
literal|0xff
index|]
operator|<<
literal|1
operator|)
operator||
operator|(
name|IP
index|[
operator|(
name|temp
operator|>>
literal|8
operator|)
operator|&
literal|0xff
index|]
operator|<<
literal|2
operator|)
operator||
operator|(
name|IP
index|[
name|temp
operator|&
literal|0xff
index|]
operator|<<
literal|3
operator|)
expr_stmt|;
endif|#
directive|endif
comment|/* 	 * Do the 16 rounds through the cipher function.  We actually 	 * do two at a time, one on the left half and one on the right 	 * half. 	 */
name|kp
operator|=
name|subkeys
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|8
condition|;
name|i
operator|++
control|)
block|{
comment|/* 		 * The E expansion is easy to compute algorithmically. 		 * Take a look at its form and compare it to 		 * everything involving temp below.  Note that 		 * since SP[0-7] don't have any bits in common set 		 * it is okay to do the successive xor's. 		 */
name|temp
operator|=
operator|(
name|right
operator|>>
literal|1
operator|)
operator||
operator|(
operator|(
name|right
operator|&
literal|1
operator|)
condition|?
literal|0x80000000
else|:
literal|0
operator|)
expr_stmt|;
name|left
operator|^=
name|SP
index|[
literal|0
index|]
index|[
operator|(
operator|(
name|temp
operator|>>
literal|26
operator|)
operator|&
literal|0x3f
operator|)
operator|^
operator|*
name|kp
operator|++
index|]
expr_stmt|;
name|left
operator|^=
name|SP
index|[
literal|1
index|]
index|[
operator|(
operator|(
name|temp
operator|>>
literal|22
operator|)
operator|&
literal|0x3f
operator|)
operator|^
operator|*
name|kp
operator|++
index|]
expr_stmt|;
name|left
operator|^=
name|SP
index|[
literal|2
index|]
index|[
operator|(
operator|(
name|temp
operator|>>
literal|18
operator|)
operator|&
literal|0x3f
operator|)
operator|^
operator|*
name|kp
operator|++
index|]
expr_stmt|;
name|left
operator|^=
name|SP
index|[
literal|3
index|]
index|[
operator|(
operator|(
name|temp
operator|>>
literal|14
operator|)
operator|&
literal|0x3f
operator|)
operator|^
operator|*
name|kp
operator|++
index|]
expr_stmt|;
name|left
operator|^=
name|SP
index|[
literal|4
index|]
index|[
operator|(
operator|(
name|temp
operator|>>
literal|10
operator|)
operator|&
literal|0x3f
operator|)
operator|^
operator|*
name|kp
operator|++
index|]
expr_stmt|;
name|left
operator|^=
name|SP
index|[
literal|5
index|]
index|[
operator|(
operator|(
name|temp
operator|>>
literal|6
operator|)
operator|&
literal|0x3f
operator|)
operator|^
operator|*
name|kp
operator|++
index|]
expr_stmt|;
name|left
operator|^=
name|SP
index|[
literal|6
index|]
index|[
operator|(
operator|(
name|temp
operator|>>
literal|2
operator|)
operator|&
literal|0x3f
operator|)
operator|^
operator|*
name|kp
operator|++
index|]
expr_stmt|;
name|left
operator|^=
name|SP
index|[
literal|7
index|]
index|[
operator|(
operator|(
operator|(
name|right
operator|<<
literal|1
operator|)
operator||
operator|(
operator|(
name|right
operator|&
literal|0x80000000
operator|)
condition|?
literal|1
else|:
literal|0
operator|)
operator|)
operator|&
literal|0x3f
operator|)
operator|^
operator|*
name|kp
operator|++
index|]
expr_stmt|;
comment|/* 		 * Careful here.  Right now `right' is actually the 		 * left side and `left' is the right side.  Do the 		 * same thing again, except swap `left' and `right' 		 */
name|temp
operator|=
operator|(
name|left
operator|>>
literal|1
operator|)
operator||
operator|(
operator|(
name|left
operator|&
literal|1
operator|)
condition|?
literal|0x80000000
else|:
literal|0
operator|)
expr_stmt|;
name|right
operator|^=
name|SP
index|[
literal|0
index|]
index|[
operator|(
operator|(
name|temp
operator|>>
literal|26
operator|)
operator|&
literal|0x3f
operator|)
operator|^
operator|*
name|kp
operator|++
index|]
expr_stmt|;
name|right
operator|^=
name|SP
index|[
literal|1
index|]
index|[
operator|(
operator|(
name|temp
operator|>>
literal|22
operator|)
operator|&
literal|0x3f
operator|)
operator|^
operator|*
name|kp
operator|++
index|]
expr_stmt|;
name|right
operator|^=
name|SP
index|[
literal|2
index|]
index|[
operator|(
operator|(
name|temp
operator|>>
literal|18
operator|)
operator|&
literal|0x3f
operator|)
operator|^
operator|*
name|kp
operator|++
index|]
expr_stmt|;
name|right
operator|^=
name|SP
index|[
literal|3
index|]
index|[
operator|(
operator|(
name|temp
operator|>>
literal|14
operator|)
operator|&
literal|0x3f
operator|)
operator|^
operator|*
name|kp
operator|++
index|]
expr_stmt|;
name|right
operator|^=
name|SP
index|[
literal|4
index|]
index|[
operator|(
operator|(
name|temp
operator|>>
literal|10
operator|)
operator|&
literal|0x3f
operator|)
operator|^
operator|*
name|kp
operator|++
index|]
expr_stmt|;
name|right
operator|^=
name|SP
index|[
literal|5
index|]
index|[
operator|(
operator|(
name|temp
operator|>>
literal|6
operator|)
operator|&
literal|0x3f
operator|)
operator|^
operator|*
name|kp
operator|++
index|]
expr_stmt|;
name|right
operator|^=
name|SP
index|[
literal|6
index|]
index|[
operator|(
operator|(
name|temp
operator|>>
literal|2
operator|)
operator|&
literal|0x3f
operator|)
operator|^
operator|*
name|kp
operator|++
index|]
expr_stmt|;
name|right
operator|^=
name|SP
index|[
literal|7
index|]
index|[
operator|(
operator|(
operator|(
name|left
operator|<<
literal|1
operator|)
operator||
operator|(
operator|(
name|left
operator|&
literal|0x80000000
operator|)
condition|?
literal|1
else|:
literal|0
operator|)
operator|)
operator|&
literal|0x3f
operator|)
operator|^
operator|*
name|kp
operator|++
index|]
expr_stmt|;
comment|/* 		 * By the time we get here, all is straightened out 		 * again.  `left' is left and `right' is right. 		 */
block|}
comment|/* 	 * Now the final permutation.  Note this is like the IP above 	 * except that the data is computed from 	 *  	 * ((left& 0x0f0f0f0f)<< 4) | (right& 0x0f0f0f0f)  for left result  	 * (left& 0xf0f0f0f0) | ((right& 0xf0f0f0f0)>> 4)  for right result 	 * 	 * Just to confuse things more, we're supposed to swap the right 	 * and the left halves before doing this.  Instead, we'll just 	 * switch which goes where when computing the temporary. 	 * 	 * This operation also byte swaps stuff back into big end byte 	 * order.  This is accomplished by modifying the FP table for 	 * little end machines, however, so we don't have to worry about 	 * it here. 	 */
name|temp
operator|=
operator|(
operator|(
name|right
operator|&
literal|0x0f0f0f0f
operator|)
operator|<<
literal|4
operator|)
operator||
operator|(
name|left
operator|&
literal|0x0f0f0f0f
operator|)
expr_stmt|;
operator|*
name|data
operator|=
operator|(
name|FP
index|[
operator|(
name|temp
operator|>>
literal|24
operator|)
operator|&
literal|0xff
index|]
operator|<<
literal|6
operator|)
operator||
operator|(
name|FP
index|[
operator|(
name|temp
operator|>>
literal|16
operator|)
operator|&
literal|0xff
index|]
operator|<<
literal|4
operator|)
operator||
operator|(
name|FP
index|[
operator|(
name|temp
operator|>>
literal|8
operator|)
operator|&
literal|0xff
index|]
operator|<<
literal|2
operator|)
operator||
name|FP
index|[
name|temp
operator|&
literal|0xff
index|]
expr_stmt|;
name|temp
operator|=
operator|(
name|right
operator|&
literal|0xf0f0f0f0
operator|)
operator||
operator|(
operator|(
name|left
operator|&
literal|0xf0f0f0f0
operator|)
operator|>>
literal|4
operator|)
expr_stmt|;
operator|*
operator|(
name|data
operator|+
literal|1
operator|)
operator|=
operator|(
name|FP
index|[
operator|(
name|temp
operator|>>
literal|24
operator|)
operator|&
literal|0xff
index|]
operator|<<
literal|6
operator|)
operator||
operator|(
name|FP
index|[
operator|(
name|temp
operator|>>
literal|16
operator|)
operator|&
literal|0xff
index|]
operator|<<
literal|4
operator|)
operator||
operator|(
name|FP
index|[
operator|(
name|temp
operator|>>
literal|8
operator|)
operator|&
literal|0xff
index|]
operator|<<
literal|2
operator|)
operator||
name|FP
index|[
name|temp
operator|&
literal|0xff
index|]
expr_stmt|;
block|}
end_function

end_unit

