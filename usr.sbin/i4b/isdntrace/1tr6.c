begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (c) 1997, 1999 Hellmuth Michaelis. All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  *  *---------------------------------------------------------------------------  *  *	1tr6.c - print 1TR6 protocol traces  *	-----------------------------------  *  *	$Id: 1tr6.c,v 1.6 1999/12/13 21:25:26 hm Exp $   *  * $FreeBSD$  *  *      last edit-date: [Mon Dec 13 21:55:31 1999]  *  *---------------------------------------------------------------------------*/
end_comment

begin_include
include|#
directive|include
file|"trace.h"
end_include

begin_function_decl
specifier|static
name|int
name|p_1tr6address
parameter_list|(
name|char
modifier|*
name|pbuf
parameter_list|,
name|unsigned
name|char
name|buf
index|[]
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|p_1tr6cause
parameter_list|(
name|char
modifier|*
name|pbuf
parameter_list|,
name|unsigned
name|char
name|buf
index|[]
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/*---------------------------------------------------------------------------*  *	decode the (german) national specific 1TR6 protocol  *---------------------------------------------------------------------------*/
end_comment

begin_function
name|void
name|decode_1tr6
parameter_list|(
name|char
modifier|*
name|pbuf
parameter_list|,
name|int
name|n
parameter_list|,
name|int
name|off
parameter_list|,
name|unsigned
name|char
modifier|*
name|buf
parameter_list|,
name|int
name|raw
parameter_list|)
block|{
name|int
name|codeset
init|=
literal|0
decl_stmt|;
name|int
name|oldcodeset
init|=
literal|0
decl_stmt|;
name|int
name|codelock
init|=
literal|0
decl_stmt|;
name|int
name|pd
decl_stmt|;
name|int
name|len
decl_stmt|;
name|int
name|j
decl_stmt|;
name|int
name|i
decl_stmt|;
if|if
condition|(
name|n
operator|<=
literal|0
condition|)
return|return;
operator|*
name|pbuf
operator|=
literal|'\0'
expr_stmt|;
if|if
condition|(
name|raw
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|n
condition|;
name|i
operator|+=
literal|16
control|)
block|{
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"Dump:%.3d  "
argument_list|,
name|i
operator|+
name|off
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|16
condition|;
name|j
operator|++
control|)
if|if
condition|(
name|i
operator|+
name|j
operator|<
name|n
condition|)
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"%02x "
argument_list|,
name|buf
index|[
name|i
operator|+
name|j
index|]
argument_list|)
expr_stmt|;
else|else
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"   "
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"      "
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|16
operator|&&
name|i
operator|+
name|j
operator|<
name|n
condition|;
name|j
operator|++
control|)
if|if
condition|(
name|isprint
argument_list|(
name|buf
index|[
name|i
operator|+
name|j
index|]
argument_list|)
condition|)
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"%c"
argument_list|,
name|buf
index|[
name|i
operator|+
name|j
index|]
argument_list|)
expr_stmt|;
else|else
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"."
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"1TR6: "
argument_list|)
expr_stmt|;
comment|/* protocol discriminator */
name|i
operator|=
literal|0
expr_stmt|;
name|pd
operator|=
name|buf
index|[
name|i
index|]
expr_stmt|;
switch|switch
condition|(
name|pd
condition|)
block|{
case|case
literal|0x40
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"pd=N0, "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x41
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"pd=N1, "
argument_list|)
expr_stmt|;
break|break;
default|default:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"pd=UNDEF (0x%02x), "
argument_list|,
name|pd
argument_list|)
expr_stmt|;
break|break;
block|}
comment|/* call reference */
name|i
operator|++
expr_stmt|;
name|len
operator|=
name|buf
index|[
name|i
index|]
operator|&
literal|0x0f
expr_stmt|;
switch|switch
condition|(
name|len
condition|)
block|{
case|case
literal|1
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"cr=0x%02x %s, "
argument_list|,
operator|(
name|buf
index|[
name|i
operator|+
literal|1
index|]
operator|&
literal|0x7f
operator|)
argument_list|,
operator|(
name|buf
index|[
name|i
operator|+
literal|1
index|]
operator|&
literal|0x80
operator|)
condition|?
literal|"(from destination)"
else|:
literal|"(from origination)"
argument_list|)
expr_stmt|;
break|break;
default|default:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"cr: LEN=%d %s 0x%02x 0x%02x, "
argument_list|,
name|len
argument_list|,
operator|(
name|buf
index|[
name|i
operator|+
literal|1
index|]
operator|&
literal|0x80
operator|)
condition|?
literal|"org"
else|:
literal|"dst"
argument_list|,
operator|(
name|buf
index|[
name|i
operator|+
literal|1
index|]
operator|&
literal|0x7f
operator|)
argument_list|,
operator|(
name|buf
index|[
name|i
operator|+
literal|2
index|]
operator|&
literal|0x7f
operator|)
argument_list|)
expr_stmt|;
break|break;
block|}
name|i
operator|+=
operator|(
name|len
operator|+
literal|1
operator|)
expr_stmt|;
comment|/* message type */
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"message="
argument_list|)
expr_stmt|;
if|if
condition|(
name|pd
operator|==
literal|0x40
condition|)
comment|/* protocol discriminator N0 */
block|{
switch|switch
condition|(
name|buf
index|[
name|i
index|]
condition|)
block|{
case|case
literal|0x61
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"REGISTER INDICATION: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x62
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"CANCEL INDICATION: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x63
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"FACILITY STATUS: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x64
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"STATUS ACKNOWLEDGE: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x65
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"STATUS REJECT: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x66
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"FACILITY INFORMATION: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x67
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"INFORMATION ACKNOWLEDGE: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x68
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"INFORMATION REJECT: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x75
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"CLOSE: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x77
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"CLOSE ACKNOWLEDGE: "
argument_list|)
expr_stmt|;
break|break;
default|default:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"ERROR: PD=0x40 MSG=0x%02x, "
argument_list|,
name|buf
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
elseif|else
if|if
condition|(
name|pd
operator|==
literal|0x41
condition|)
block|{
switch|switch
condition|(
name|buf
index|[
name|i
index|]
condition|)
block|{
case|case
literal|0x00
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"ESCAPE: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x01
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"ALERT: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x02
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"CALL SENT: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x07
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"CONNECT: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x0f
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"CONNECT ACKNOWLEDGE: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x05
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"SETUP: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x0d
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"SETUP ACKNOWLEDGE: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x26
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"RESUME: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x2e
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"RESUME ACKNOWLEDGE: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x22
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"RESUME REJECT: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x25
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"SUSPEND: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x2d
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"SUSPEND ACKNOWLEDGE: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x21
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"SUSPEND REJECT: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x20
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"USER INFORMATION: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x40
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"DETACH"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x45
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"DISCONNECT: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x4d
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"RELEASE: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x5a
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"RELEASE ACKNOWLEDGE"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x6e
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"CANCEL ACKNOWLEDGE: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x67
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"CANCEL REJECT: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x69
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"CONGESTION CONTROL: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x60
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"FACILITY: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x68
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"FACILITY ACKNOWLEDGE: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x66
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"FACILITY CANCEL: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x64
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"FACILITY REGISTER: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x65
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"FACILITY REJECT: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x6d
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"INFORMATION: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x6c
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"REGISTER ACKNOWLEDGE: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x6f
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"REGISTER REJECT: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x63
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"STATUS: "
argument_list|)
expr_stmt|;
break|break;
default|default:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"ERROR: PD=0x41 MSG=0x%02x, "
argument_list|,
name|buf
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
else|else
block|{
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"ERROR: PD=0x%02x MSG=0x%02x, "
argument_list|,
name|pd
argument_list|,
name|buf
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
comment|/* other information elements */
name|i
operator|++
expr_stmt|;
for|for
control|(
init|;
name|i
operator|<
name|n
condition|;
control|)
block|{
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"\n     "
argument_list|)
expr_stmt|;
if|if
condition|(
name|buf
index|[
name|i
index|]
operator|&
literal|0x80
condition|)
block|{
comment|/* single octett info element */
switch|switch
condition|(
name|buf
index|[
name|i
index|]
operator|&
literal|0x70
condition|)
block|{
case|case
literal|0x00
case|:
comment|/* reserved */
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[reserved single octett info]"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x10
case|:
comment|/* shift */
name|oldcodeset
operator|=
name|codeset
expr_stmt|;
name|codeset
operator|=
name|buf
index|[
name|i
index|]
operator|&
literal|0x07
expr_stmt|;
if|if
condition|(
name|buf
index|[
name|i
index|]
operator|&
literal|0x08
condition|)
name|codelock
operator|=
literal|0
expr_stmt|;
else|else
name|codelock
operator|=
literal|1
expr_stmt|;
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[shift: codeset=%d lock=%d]"
argument_list|,
name|codeset
argument_list|,
name|codelock
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x20
case|:
comment|/* more data */
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[more data]"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x30
case|:
comment|/* congestion level */
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[congestion level = %d]"
argument_list|,
name|buf
index|[
name|i
index|]
operator|&
literal|0x0f
argument_list|)
expr_stmt|;
break|break;
default|default:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[UNDEF SINGLE OCTET ELEMENT 0x%02x]"
argument_list|,
name|buf
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
name|i
operator|++
expr_stmt|;
comment|/* next */
block|}
else|else
block|{
comment|/* variable length info element */
if|if
condition|(
name|codeset
operator|==
literal|0
condition|)
block|{
switch|switch
condition|(
name|buf
index|[
name|i
index|]
condition|)
block|{
case|case
literal|0x08
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[cause: "
argument_list|)
expr_stmt|;
name|i
operator|+=
name|p_1tr6cause
argument_list|(
name|pbuf
argument_list|,
operator|&
name|buf
index|[
name|i
index|]
argument_list|)
expr_stmt|;
goto|goto
name|next
goto|;
break|break;
case|case
literal|0x0c
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[connected address: "
argument_list|)
expr_stmt|;
name|i
operator|+=
name|p_1tr6address
argument_list|(
name|pbuf
argument_list|,
operator|&
name|buf
index|[
name|i
index|]
argument_list|)
expr_stmt|;
goto|goto
name|next
goto|;
break|break;
case|case
literal|0x10
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[call identity: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x18
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[channel id: channel="
argument_list|)
expr_stmt|;
name|i
operator|+=
literal|2
expr_stmt|;
switch|switch
condition|(
name|buf
index|[
name|i
index|]
operator|&
literal|0x03
condition|)
block|{
case|case
literal|0
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"no channel"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|1
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"B-1"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"B-2"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|3
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"any channel"
argument_list|)
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|buf
index|[
name|i
index|]
operator|&
literal|0x08
condition|)
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|" (exclusive)]"
argument_list|)
expr_stmt|;
else|else
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|" (preferred)]"
argument_list|)
expr_stmt|;
name|i
operator|++
expr_stmt|;
goto|goto
name|next
goto|;
break|break;
case|case
literal|0x20
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[network specific facilities: "
argument_list|)
expr_stmt|;
name|i
operator|++
expr_stmt|;
name|len
operator|=
name|buf
index|[
name|i
index|]
expr_stmt|;
name|i
operator|+=
literal|2
expr_stmt|;
switch|switch
condition|(
name|buf
index|[
name|i
index|]
condition|)
block|{
case|case
literal|1
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"Sperre"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"AWS 1"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|3
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"AWS 2"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0xe
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"Konferenz"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0xf
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"B-Kan uebern."
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x10
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"aktvrg. ghlt. Vbdg."
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x11
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"3er Konf"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x12
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"1seitg D/G Wechsel"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x13
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"2seitig D/G Wechsel"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x14
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"Rufnr. identifiz."
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x15
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"GBG"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x17
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"ueberg. Ruf"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x1a
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"um/weitergel. Ruf"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x1b
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"unterdr. A-Rufnr."
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x1e
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"Verbdg. deaktivieren"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x1d
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"Verbdg. aktivieren"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x1f
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"SPV"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x23
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"Rueckw. 2seitg. DW"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x24
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"Anrufumltg. priv. Netz"
argument_list|)
expr_stmt|;
break|break;
default|default:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"undefined"
argument_list|)
expr_stmt|;
break|break;
block|}
name|i
operator|++
expr_stmt|;
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|", serv=%d"
argument_list|,
name|buf
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|i
operator|++
expr_stmt|;
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|", ainfo=%d"
argument_list|,
name|buf
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|i
operator|++
expr_stmt|;
name|len
operator|-=
literal|4
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|len
condition|;
name|j
operator|++
control|)
block|{
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|" 0x%02x"
argument_list|,
name|buf
index|[
name|j
operator|+
name|i
index|]
argument_list|)
expr_stmt|;
block|}
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"]"
argument_list|)
expr_stmt|;
name|i
operator|+=
name|j
expr_stmt|;
goto|goto
name|next
goto|;
break|break;
case|case
literal|0x28
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[display: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x2c
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[keypad: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x6c
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[origination address: "
argument_list|)
expr_stmt|;
name|i
operator|+=
name|p_1tr6address
argument_list|(
name|pbuf
argument_list|,
operator|&
name|buf
index|[
name|i
index|]
argument_list|)
expr_stmt|;
goto|goto
name|next
goto|;
break|break;
case|case
literal|0x70
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[destination address: "
argument_list|)
expr_stmt|;
name|i
operator|+=
name|p_1tr6address
argument_list|(
name|pbuf
argument_list|,
operator|&
name|buf
index|[
name|i
index|]
argument_list|)
expr_stmt|;
goto|goto
name|next
goto|;
break|break;
case|case
literal|0x7e
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[user-user information: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x7f
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[reserved: "
argument_list|)
expr_stmt|;
break|break;
default|default:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[UNKNOWN INFO-ELEMENT-ID"
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
elseif|else
if|if
condition|(
name|codeset
operator|==
literal|6
condition|)
block|{
switch|switch
condition|(
name|buf
index|[
name|i
index|]
condition|)
block|{
case|case
literal|0x01
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[service ind: serv="
argument_list|)
expr_stmt|;
name|i
operator|+=
literal|2
expr_stmt|;
switch|switch
condition|(
name|buf
index|[
name|i
index|]
condition|)
block|{
case|case
literal|0x01
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"phone"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x02
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"a/b"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x03
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"X.21"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x04
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"fax g4"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x05
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"btx"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x07
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"64k data"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x08
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"X.25"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x09
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"teletex"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x0a
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"mixed"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x0d
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"temex"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x0e
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"picturephone"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x0f
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"btx (new)"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x10
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"videophone"
argument_list|)
expr_stmt|;
break|break;
default|default:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"undefined"
argument_list|)
expr_stmt|;
break|break;
block|}
name|i
operator|++
expr_stmt|;
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|", ainfo=0x%02x]"
argument_list|,
name|buf
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|i
operator|++
expr_stmt|;
goto|goto
name|next
goto|;
break|break;
case|case
literal|0x02
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[charging information: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x03
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[date: "
argument_list|)
expr_stmt|;
name|i
operator|++
expr_stmt|;
name|len
operator|=
name|buf
index|[
name|i
index|]
expr_stmt|;
name|i
operator|++
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|len
condition|;
name|j
operator|++
control|)
block|{
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"%c"
argument_list|,
name|buf
index|[
name|j
operator|+
name|i
index|]
argument_list|)
expr_stmt|;
block|}
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"]"
argument_list|)
expr_stmt|;
name|i
operator|+=
name|j
expr_stmt|;
goto|goto
name|next
goto|;
break|break;
case|case
literal|0x05
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[facility select: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x06
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[status of facilities: "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x07
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[status of called party: "
argument_list|)
expr_stmt|;
name|i
operator|+=
literal|2
expr_stmt|;
switch|switch
condition|(
name|buf
index|[
name|i
index|]
condition|)
block|{
case|case
literal|1
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"no information]"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"is being called]"
argument_list|)
expr_stmt|;
break|break;
default|default:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"undefined (0x%02x)]"
argument_list|,
name|buf
index|[
name|i
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
name|i
operator|++
expr_stmt|;
goto|goto
name|next
goto|;
break|break;
case|case
literal|0x08
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[additional tx attributes: "
argument_list|)
expr_stmt|;
name|i
operator|++
expr_stmt|;
name|len
operator|=
name|buf
index|[
name|i
index|]
expr_stmt|;
name|i
operator|++
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|len
condition|;
name|j
operator|++
control|)
block|{
switch|switch
condition|(
name|buf
index|[
name|j
operator|+
name|i
index|]
operator|&
literal|0x70
condition|)
block|{
case|case
literal|0
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"no satellite link"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|1
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"one satellite link"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"two satellite links"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|3
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"three satellite links"
argument_list|)
expr_stmt|;
break|break;
default|default:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"undefined value"
argument_list|)
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|buf
index|[
name|j
operator|+
name|i
index|]
operator|&
literal|0x80
condition|)
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"(flag=req)]"
argument_list|)
expr_stmt|;
else|else
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"(flag=ind)]"
argument_list|)
expr_stmt|;
block|}
name|i
operator|+=
name|j
expr_stmt|;
goto|goto
name|next
goto|;
break|break;
default|default:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[UNKNOWN INFO-ELEMENT-ID"
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
else|else
block|{
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"[ILLEGAL CODESET = 0x%02x"
argument_list|,
name|codeset
argument_list|)
expr_stmt|;
block|}
name|i
operator|++
expr_stmt|;
comment|/* index -> length */
name|len
operator|=
name|buf
index|[
name|i
index|]
expr_stmt|;
name|i
operator|++
expr_stmt|;
comment|/* index -> 1st param */
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|len
condition|;
name|j
operator|++
control|)
block|{
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|" 0x%02x"
argument_list|,
name|buf
index|[
name|j
operator|+
name|i
index|]
argument_list|)
expr_stmt|;
block|}
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"]"
argument_list|)
expr_stmt|;
name|i
operator|+=
name|len
expr_stmt|;
name|next
label|:
if|if
condition|(
operator|!
name|codelock
operator|&&
operator|(
name|codeset
operator|!=
name|oldcodeset
operator|)
condition|)
name|codeset
operator|=
name|oldcodeset
expr_stmt|;
block|}
block|}
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*---------------------------------------------------------------------------*  *	decode and print the cause  *---------------------------------------------------------------------------*/
end_comment

begin_function
specifier|static
name|int
name|p_1tr6cause
parameter_list|(
name|char
modifier|*
name|pbuf
parameter_list|,
name|unsigned
name|char
name|buf
index|[]
parameter_list|)
block|{
name|int
name|j
decl_stmt|;
name|int
name|len
decl_stmt|;
name|int
name|i
init|=
literal|0
decl_stmt|;
name|i
operator|++
expr_stmt|;
comment|/* index -> length */
name|len
operator|=
name|buf
index|[
name|i
index|]
expr_stmt|;
switch|switch
condition|(
name|len
condition|)
block|{
case|case
literal|0
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"%s"
argument_list|,
name|print_cause_1tr6
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|1
case|:
name|i
operator|++
expr_stmt|;
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"%s"
argument_list|,
name|print_cause_1tr6
argument_list|(
name|buf
index|[
name|i
index|]
operator|&
literal|0x7f
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|i
operator|++
expr_stmt|;
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"%s, location: "
argument_list|,
name|print_cause_1tr6
argument_list|(
name|buf
index|[
name|i
index|]
operator|&
literal|0x7f
argument_list|)
argument_list|)
expr_stmt|;
name|i
operator|++
expr_stmt|;
switch|switch
condition|(
name|buf
index|[
name|i
index|]
operator|&
literal|0x0f
condition|)
block|{
case|case
literal|0x04
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"public network"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x05
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"private network"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x0f
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"no information"
argument_list|)
expr_stmt|;
break|break;
default|default:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"reserved (0x%02x)"
argument_list|,
name|buf
index|[
name|i
index|]
operator|&
literal|0x0f
argument_list|)
expr_stmt|;
break|break;
block|}
break|break;
default|default:
name|i
operator|++
expr_stmt|;
comment|/* index -> length */
name|len
operator|=
name|buf
index|[
name|i
index|]
expr_stmt|;
name|i
operator|++
expr_stmt|;
comment|/* index -> 1st param */
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|len
condition|;
name|j
operator|++
control|)
block|{
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|" 0x%02x"
argument_list|,
name|buf
index|[
name|j
operator|+
name|i
index|]
argument_list|)
expr_stmt|;
block|}
break|break;
block|}
name|i
operator|++
expr_stmt|;
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"]"
argument_list|)
expr_stmt|;
return|return
operator|(
name|i
operator|)
return|;
block|}
end_function

begin_comment
comment|/*---------------------------------------------------------------------------*  *	decode and print the ISDN (telephone) number  *---------------------------------------------------------------------------*/
end_comment

begin_function
specifier|static
name|int
name|p_1tr6address
parameter_list|(
name|char
modifier|*
name|pbuf
parameter_list|,
name|unsigned
name|char
name|buf
index|[]
parameter_list|)
block|{
name|int
name|j
decl_stmt|;
name|int
name|len
decl_stmt|;
name|int
name|i
init|=
literal|0
decl_stmt|;
name|int
name|tp
decl_stmt|;
name|i
operator|++
expr_stmt|;
comment|/* index -> length */
name|len
operator|=
name|buf
index|[
name|i
index|]
expr_stmt|;
name|i
operator|++
expr_stmt|;
comment|/* index -> 1st param */
name|tp
operator|=
name|buf
index|[
name|i
index|]
expr_stmt|;
name|i
operator|++
expr_stmt|;
name|len
operator|--
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|len
condition|;
name|j
operator|++
control|)
block|{
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"%c"
argument_list|,
name|buf
index|[
name|j
operator|+
name|i
index|]
argument_list|)
expr_stmt|;
block|}
switch|switch
condition|(
operator|(
name|tp
operator|&
literal|0x70
operator|)
operator|>>
literal|4
condition|)
block|{
case|case
literal|0
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|" (type=unknown, "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|1
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|" (type=international, "
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|" (type=national, "
argument_list|)
expr_stmt|;
break|break;
default|default:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|" (type=%d, "
argument_list|,
operator|(
operator|(
name|tp
operator|&
literal|0x70
operator|)
operator|>>
literal|4
operator|)
argument_list|)
expr_stmt|;
break|break;
block|}
switch|switch
condition|(
name|tp
operator|&
literal|0x0f
condition|)
block|{
case|case
literal|0
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"plan=unknown)"
argument_list|)
expr_stmt|;
break|break;
case|case
literal|1
case|:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"plan=ISDN)"
argument_list|)
expr_stmt|;
break|break;
default|default:
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"plan=%d)"
argument_list|,
operator|(
name|tp
operator|&
literal|0x0f
operator|)
argument_list|)
expr_stmt|;
break|break;
block|}
name|sprintf
argument_list|(
operator|(
name|pbuf
operator|+
name|strlen
argument_list|(
name|pbuf
argument_list|)
operator|)
argument_list|,
literal|"]"
argument_list|)
expr_stmt|;
name|i
operator|+=
name|j
expr_stmt|;
return|return
operator|(
name|i
operator|)
return|;
block|}
end_function

begin_comment
comment|/* EOF */
end_comment

end_unit

