begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* ns_func.h - declarations for ns_*.c's externally visible functions  *  * $FreeBSD$  */
end_comment

begin_comment
comment|/* ++from ns_resp.c++ */
end_comment

begin_decl_stmt
specifier|extern
name|void
name|ns_resp
name|__P
argument_list|(
operator|(
name|u_char
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|,
name|prime_cache
name|__P
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|,
name|delete_all
name|__P
argument_list|(
operator|(
expr|struct
name|namebuf
operator|*
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|struct
name|qinfo
modifier|*
name|sysquery
name|__P
argument_list|(
operator|(
specifier|const
name|char
operator|*
operator|,
name|int
operator|,
name|int
operator|,
expr|struct
name|in_addr
operator|*
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|struct
name|notify
modifier|*
name|findNotifyPeer
name|__P
argument_list|(
operator|(
specifier|const
expr|struct
name|zoneinfo
operator|*
operator|,
expr|struct
name|in_addr
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|void
name|sysnotify
name|__P
argument_list|(
operator|(
specifier|const
name|char
operator|*
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|doupdate
name|__P
argument_list|(
operator|(
name|u_char
operator|*
operator|,
name|int
operator|,
name|u_char
operator|*
operator|,
name|int
operator|,
expr|struct
name|databuf
operator|*
operator|*
operator|,
name|int
operator|,
name|u_int
operator|)
argument_list|)
decl_stmt|,
name|send_msg
name|__P
argument_list|(
operator|(
name|u_char
operator|*
operator|,
name|int
operator|,
expr|struct
name|qinfo
operator|*
operator|)
argument_list|)
decl_stmt|,
name|findns
name|__P
argument_list|(
operator|(
expr|struct
name|namebuf
operator|*
operator|*
operator|,
name|int
operator|,
expr|struct
name|databuf
operator|*
operator|*
operator|,
name|int
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|,
name|finddata
name|__P
argument_list|(
operator|(
expr|struct
name|namebuf
operator|*
operator|,
name|int
operator|,
name|int
operator|,
name|HEADER
operator|*
operator|,
name|char
operator|*
operator|*
operator|,
name|int
operator|*
operator|,
name|int
operator|*
operator|)
argument_list|)
decl_stmt|,
name|wanted
name|__P
argument_list|(
operator|(
expr|struct
name|databuf
operator|*
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|,
name|add_data
name|__P
argument_list|(
operator|(
expr|struct
name|namebuf
operator|*
operator|,
expr|struct
name|databuf
operator|*
operator|*
operator|,
name|u_char
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* --from ns_resp.c-- */
end_comment

begin_comment
comment|/* ++from ns_req.c++ */
end_comment

begin_decl_stmt
specifier|extern
name|void
name|ns_req
name|__P
argument_list|(
operator|(
name|u_char
operator|*
operator|,
name|int
operator|,
name|int
operator|,
expr|struct
name|qstream
operator|*
operator|,
expr|struct
name|sockaddr_in
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|,
name|free_addinfo
name|__P
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|,
name|free_nsp
name|__P
argument_list|(
operator|(
expr|struct
name|databuf
operator|*
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|stale
name|__P
argument_list|(
operator|(
expr|struct
name|databuf
operator|*
operator|)
argument_list|)
decl_stmt|,
name|make_rr
name|__P
argument_list|(
operator|(
specifier|const
name|char
operator|*
operator|,
expr|struct
name|databuf
operator|*
operator|,
name|u_char
operator|*
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|,
name|doaddinfo
name|__P
argument_list|(
operator|(
name|HEADER
operator|*
operator|,
name|u_char
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|,
name|doaddauth
name|__P
argument_list|(
operator|(
name|HEADER
operator|*
operator|,
name|u_char
operator|*
operator|,
name|int
operator|,
expr|struct
name|namebuf
operator|*
operator|,
expr|struct
name|databuf
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|BIND_NOTIFY
end_ifdef

begin_decl_stmt
specifier|extern
name|int
name|findZonePri
name|__P
argument_list|(
operator|(
specifier|const
expr|struct
name|zoneinfo
operator|*
operator|,
specifier|const
expr|struct
name|sockaddr_in
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* --from ns_req.c-- */
end_comment

begin_comment
comment|/* ++from ns_forw.c++ */
end_comment

begin_decl_stmt
specifier|extern
name|time_t
name|retrytime
name|__P
argument_list|(
operator|(
expr|struct
name|qinfo
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ns_forw
name|__P
argument_list|(
operator|(
expr|struct
name|databuf
operator|*
name|nsp
index|[]
operator|,
name|u_char
operator|*
name|msg
operator|,
name|int
name|msglen
operator|,
expr|struct
name|sockaddr_in
operator|*
name|fp
operator|,
expr|struct
name|qstream
operator|*
name|qsp
operator|,
name|int
name|dfd
operator|,
expr|struct
name|qinfo
operator|*
operator|*
name|qpp
operator|,
name|char
operator|*
name|dname
operator|,
expr|struct
name|namebuf
operator|*
name|np
operator|)
argument_list|)
decl_stmt|,
name|haveComplained
name|__P
argument_list|(
operator|(
specifier|const
name|char
operator|*
operator|,
specifier|const
name|char
operator|*
operator|)
argument_list|)
decl_stmt|,
name|nslookup
name|__P
argument_list|(
operator|(
expr|struct
name|databuf
operator|*
name|nsp
index|[]
operator|,
expr|struct
name|qinfo
operator|*
name|qp
operator|,
specifier|const
name|char
operator|*
name|syslogdname
operator|,
specifier|const
name|char
operator|*
name|sysloginfo
operator|)
argument_list|)
decl_stmt|,
name|qcomp
name|__P
argument_list|(
operator|(
expr|struct
name|qserv
operator|*
operator|,
expr|struct
name|qserv
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|struct
name|qdatagram
modifier|*
name|aIsUs
name|__P
argument_list|(
operator|(
expr|struct
name|in_addr
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|void
name|nslookupComplain
name|__P
argument_list|(
operator|(
specifier|const
name|char
operator|*
operator|,
specifier|const
name|char
operator|*
operator|,
specifier|const
name|char
operator|*
operator|,
specifier|const
name|char
operator|*
operator|,
specifier|const
expr|struct
name|databuf
operator|*
operator|)
argument_list|)
decl_stmt|,
name|schedretry
name|__P
argument_list|(
operator|(
expr|struct
name|qinfo
operator|*
operator|,
name|time_t
operator|)
argument_list|)
decl_stmt|,
name|unsched
name|__P
argument_list|(
operator|(
expr|struct
name|qinfo
operator|*
operator|)
argument_list|)
decl_stmt|,
name|retry
name|__P
argument_list|(
operator|(
expr|struct
name|qinfo
operator|*
operator|)
argument_list|)
decl_stmt|,
name|qflush
name|__P
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|,
name|qremove
name|__P
argument_list|(
operator|(
expr|struct
name|qinfo
operator|*
operator|)
argument_list|)
decl_stmt|,
name|qfree
name|__P
argument_list|(
operator|(
expr|struct
name|qinfo
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|struct
name|qinfo
modifier|*
name|qfindid
name|__P
argument_list|(
operator|(
name|u_int16_t
operator|)
argument_list|)
decl_stmt|,
ifdef|#
directive|ifdef
name|DMALLOC
modifier|*
name|qnew_tagged
name|__P
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|qnew
parameter_list|()
value|qnew_tagged(__FILE__, __LINE__)
end_define

begin_else
else|#
directive|else
end_else

begin_expr_stmt
operator|*
name|qnew
argument_list|()
expr_stmt|;
end_expr_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* --from ns_forw.c-- */
end_comment

begin_comment
comment|/* ++from ns_main.c++ */
end_comment

begin_decl_stmt
specifier|extern
name|u_int32_t
name|net_mask
name|__P
argument_list|(
operator|(
expr|struct
name|in_addr
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|void
name|sqrm
name|__P
argument_list|(
operator|(
expr|struct
name|qstream
operator|*
operator|)
argument_list|)
decl_stmt|,
name|sqflush
name|__P
argument_list|(
operator|(
expr|struct
name|qstream
operator|*
name|allbut
operator|)
argument_list|)
decl_stmt|,
name|dqflush
name|__P
argument_list|(
operator|(
name|time_t
name|gen
operator|)
argument_list|)
decl_stmt|,
name|sq_done
name|__P
argument_list|(
operator|(
expr|struct
name|qstream
operator|*
operator|)
argument_list|)
decl_stmt|,
name|ns_setproctitle
name|__P
argument_list|(
operator|(
name|char
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|,
name|getnetconf
name|__P
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|,
name|nsid_init
name|__P
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|u_int16_t
name|nsid_next
name|__P
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|struct
name|netinfo
modifier|*
name|findnetinfo
name|__P
argument_list|(
operator|(
expr|struct
name|in_addr
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* --from ns_main.c-- */
end_comment

begin_comment
comment|/* ++from ns_maint.c++ */
end_comment

begin_decl_stmt
specifier|extern
name|void
name|ns_maint
name|__P
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|,
name|sched_maint
name|__P
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|,
ifdef|#
directive|ifdef
name|CLEANCACHE
name|remove_zone
name|__P
argument_list|(
operator|(
expr|struct
name|hashbuf
operator|*
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|,
else|#
directive|else
name|remove_zone
name|__P
argument_list|(
operator|(
expr|struct
name|hashbuf
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|,
endif|#
directive|endif
ifdef|#
directive|ifdef
name|PURGE_ZONE
name|purge_zone
name|__P
argument_list|(
operator|(
specifier|const
name|char
operator|*
operator|,
expr|struct
name|hashbuf
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|,
endif|#
directive|endif
name|loadxfer
name|__P
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|,
name|qserial_query
name|__P
argument_list|(
operator|(
expr|struct
name|zoneinfo
operator|*
operator|)
argument_list|)
decl_stmt|,
name|qserial_answer
name|__P
argument_list|(
operator|(
expr|struct
name|qinfo
operator|*
operator|,
name|u_int32_t
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|SIG_FN
name|endxfer
name|__P
argument_list|(
operator|(
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
specifier|const
name|char
modifier|*
name|zoneTypeString
name|__P
argument_list|(
operator|(
specifier|const
expr|struct
name|zoneinfo
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|DEBUG
end_ifdef

begin_decl_stmt
specifier|extern
name|void
name|printzoneinfo
name|__P
argument_list|(
operator|(
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* --from ns_maint.c-- */
end_comment

begin_comment
comment|/* ++from ns_sort.c++ */
end_comment

begin_decl_stmt
specifier|extern
name|struct
name|netinfo
modifier|*
name|local
name|__P
argument_list|(
operator|(
expr|struct
name|sockaddr_in
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|void
name|sort_response
name|__P
argument_list|(
operator|(
name|u_char
operator|*
operator|,
name|int
operator|,
expr|struct
name|netinfo
operator|*
operator|,
name|u_char
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* --from ns_sort.c-- */
end_comment

begin_comment
comment|/* ++from ns_init.c++ */
end_comment

begin_decl_stmt
specifier|extern
name|void
name|ns_refreshtime
name|__P
argument_list|(
operator|(
expr|struct
name|zoneinfo
operator|*
operator|,
name|time_t
operator|)
argument_list|)
decl_stmt|,
name|ns_retrytime
name|__P
argument_list|(
operator|(
expr|struct
name|zoneinfo
operator|*
operator|,
name|time_t
operator|)
argument_list|)
decl_stmt|,
name|ns_init
name|__P
argument_list|(
operator|(
name|char
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* --from ns_init.c-- */
end_comment

begin_comment
comment|/* ++from ns_ncache.c++ */
end_comment

begin_decl_stmt
specifier|extern
name|void
name|cache_n_resp
name|__P
argument_list|(
operator|(
name|u_char
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* --from ns_ncache.c-- */
end_comment

begin_comment
comment|/* ++from ns_stats.c++ */
end_comment

begin_decl_stmt
specifier|extern
name|void
name|ns_stats
name|__P
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|XSTATS
end_ifdef

begin_decl_stmt
specifier|extern
name|void
name|ns_logstats
name|__P
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
specifier|extern
name|void
name|qtypeIncr
name|__P
argument_list|(
operator|(
name|int
name|qtype
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|struct
name|nameser
modifier|*
name|nameserFind
name|__P
argument_list|(
operator|(
expr|struct
name|in_addr
name|addr
operator|,
name|int
name|flags
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|NS_F_INSERT
value|0x0001
end_define

begin_decl_stmt
specifier|extern
name|void
name|nameserIncr
name|__P
argument_list|(
operator|(
expr|struct
name|in_addr
name|addr
operator|,
expr|enum
name|nameserStats
name|which
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* --from ns_stats.c-- */
end_comment

begin_comment
comment|/* ++from ns_validate.c++ */
end_comment

begin_decl_stmt
specifier|extern
name|int
ifdef|#
directive|ifdef
name|NCACHE
name|validate
name|__P
argument_list|(
operator|(
name|char
operator|*
operator|,
expr|struct
name|sockaddr_in
operator|*
operator|,
name|int
operator|,
name|int
operator|,
name|char
operator|*
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|,
else|#
directive|else
name|validate
name|__P
argument_list|(
operator|(
name|char
operator|*
operator|,
expr|struct
name|sockaddr_in
operator|*
operator|,
name|int
operator|,
name|int
operator|,
name|char
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|,
endif|#
directive|endif
name|dovalidate
name|__P
argument_list|(
operator|(
name|u_char
operator|*
operator|,
name|int
operator|,
name|u_char
operator|*
operator|,
name|int
operator|,
name|int
operator|,
expr|struct
name|sockaddr_in
operator|*
operator|,
name|int
operator|*
operator|)
argument_list|)
decl_stmt|,
name|update_msg
name|__P
argument_list|(
operator|(
name|u_char
operator|*
operator|,
name|int
operator|*
operator|,
name|int
name|Vlist
index|[]
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|void
name|store_name_addr
name|__P
argument_list|(
operator|(
name|char
operator|*
operator|,
expr|struct
name|in_addr
operator|,
name|char
operator|*
operator|,
name|char
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* --from ns_validate.c-- */
end_comment

end_unit

