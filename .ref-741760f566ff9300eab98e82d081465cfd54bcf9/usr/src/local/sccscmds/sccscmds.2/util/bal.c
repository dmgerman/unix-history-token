begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_decl_stmt
specifier|static
name|char
name|Sccsid
index|[]
init|=
literal|"@(#)bal.c	1.2	%G%"
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* 	Function to find the position, in str, of the first of the char- 	acters in end occurring outside a balanced string.  A balanced string 	contains matched occurrences of any character in open and the corres- 	ponding character in clos.  Balanced strings may be nested.  The null 	at the end of str is considered to belong to end.  Unmatched members 	of open or clos result in an error return. */
end_comment

begin_define
define|#
directive|define
name|ifany
parameter_list|(
name|x
parameter_list|)
value|for (p=x; *p; p++) if (c == *p)
end_define

begin_define
define|#
directive|define
name|matching_clos
value|clos[p-open]
end_define

begin_define
define|#
directive|define
name|error
value|-1
end_define

begin_define
define|#
directive|define
name|position
value|s-str-1
end_define

begin_macro
name|balbrk
argument_list|(
argument|str
argument_list|,
argument|open
argument_list|,
argument|clos
argument_list|,
argument|end
argument_list|)
end_macro

begin_decl_stmt
name|char
modifier|*
name|str
decl_stmt|,
modifier|*
name|open
decl_stmt|,
modifier|*
name|clos
decl_stmt|,
modifier|*
name|end
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|char
modifier|*
name|p
decl_stmt|,
modifier|*
name|s
decl_stmt|,
name|c
decl_stmt|;
name|char
name|opp
index|[
literal|2
index|]
decl_stmt|;
name|opp
index|[
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
for|for
control|(
name|s
operator|=
name|str
init|;
name|c
operator|=
operator|*
name|s
operator|++
condition|;
control|)
block|{
name|ifany
argument_list|(
argument|end
argument_list|)
return|return
name|position
return|;
name|ifany
argument_list|(
argument|clos
argument_list|)
return|return
name|error
return|;
name|ifany
argument_list|(
argument|open
argument_list|)
block|{
name|opp
index|[
literal|0
index|]
operator|=
name|matching_clos
expr_stmt|;
name|s
operator|+=
name|balbrk
argument_list|(
name|s
argument_list|,
name|open
argument_list|,
name|clos
argument_list|,
name|opp
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
name|s
operator|++
operator|!=
name|matching_clos
condition|)
return|return
name|error
return|;
break|break;
block|}
block|}
return|return
name|position
return|;
block|}
end_block

end_unit

