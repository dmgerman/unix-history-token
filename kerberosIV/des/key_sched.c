begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * $Source: /mit/kerberos/src/lib/des/RCS/key_sched.c,v $  * $Author: wesommer $  *  * Copyright 1985, 1986, 1987, 1988 by the Massachusetts Institute  * of Technology.  *  * For copying and distribution information, please see the file  *<mit-copyright.h>.  *  * This routine computes the DES key schedule given a key.  The  * permutations and shifts have been done at compile time, resulting  * in a direct one-step mapping from the input key to the key  * schedule.  *  * Also checks parity and weak keys.  *  * Watch out for the subscripts -- most effectively start at 1 instead  * of at zero.  Maybe some bugs in that area.  *  * DON'T change the data types for arrays and such, or it will either  * break or run slower.  This was optimized for Uvax2.  *  * In case the user wants to cache the computed key schedule, it is  * passed as an arg.  Also implies that caller has explicit control  * over zeroing both the key schedule and the key.  *  * All registers labeled imply Vax using the Ultrix or 4.2bsd compiler.  *  * Originally written 6/85 by Steve Miller, MIT Project Athena.  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
name|rcsid_key_sched_c
index|[]
init|=
literal|"$Header: key_sched.c,v 4.7 89/01/23 15:42:17 wesommer Exp $"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
endif|lint
end_endif

begin_include
include|#
directive|include
file|<mit-copyright.h>
end_include

begin_include
include|#
directive|include
file|"des_internal.h"
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|"des.h"
end_include

begin_include
include|#
directive|include
file|"key_perm.h"
end_include

begin_decl_stmt
specifier|extern
name|int
name|des_debug
decl_stmt|;
end_decl_stmt

begin_extern
extern|extern rev_swap_bit_pos_0(
end_extern

begin_empty_stmt
unit|)
empty_stmt|;
end_empty_stmt

begin_typedef
typedef|typedef
name|char
name|key
index|[
literal|64
index|]
typedef|;
end_typedef

begin_comment
comment|/* the following are really void but cc86 doesnt allow it */
end_comment

begin_function_decl
name|int
name|make_key_sched
parameter_list|()
function_decl|;
end_function_decl

begin_function
name|int
name|des_key_sched
parameter_list|(
name|k
parameter_list|,
name|schedule
parameter_list|)
specifier|register
name|des_cblock
name|k
decl_stmt|;
comment|/* r11 */
name|des_key_schedule
name|schedule
decl_stmt|;
block|{
comment|/* better pass 8 bytes, length not checked here */
specifier|register
name|i
operator|,
name|j
operator|,
name|n
expr_stmt|;
comment|/* i = r10, j = r9, n = r8 */
specifier|register
name|unsigned
name|int
name|temp
decl_stmt|;
comment|/*  r7 */
specifier|register
name|char
modifier|*
name|p_char
decl_stmt|;
comment|/* r6 */
specifier|static
name|key
name|k_char
decl_stmt|;
name|i
operator|=
literal|8
expr_stmt|;
name|n
operator|=
literal|0
expr_stmt|;
name|p_char
operator|=
name|k_char
expr_stmt|;
ifdef|#
directive|ifdef
name|lint
name|n
operator|=
name|n
expr_stmt|;
comment|/* fool it in case of VAXASM */
endif|#
directive|endif
ifdef|#
directive|ifdef
name|DEBUG
if|if
condition|(
name|des_debug
condition|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"\n\ninput key, left to right = "
argument_list|)
expr_stmt|;
endif|#
directive|endif
if|if
condition|(
operator|!
name|des_check_key_parity
argument_list|(
name|k
argument_list|)
condition|)
comment|/* bad parity --> return -1 */
return|return
operator|(
operator|-
literal|1
operator|)
return|;
do|do
block|{
comment|/* get next input key byte */
ifdef|#
directive|ifdef
name|DEBUG
if|if
condition|(
name|des_debug
condition|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%02x "
argument_list|,
operator|*
name|k
operator|&
literal|0xff
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|temp
operator|=
call|(
name|unsigned
name|int
call|)
argument_list|(
operator|(
name|unsigned
name|char
operator|)
operator|*
name|k
operator|++
argument_list|)
expr_stmt|;
name|j
operator|=
literal|8
expr_stmt|;
do|do
block|{
ifndef|#
directive|ifndef
name|VAXASM
operator|*
name|p_char
operator|++
operator|=
operator|(
name|int
operator|)
name|temp
operator|&
literal|01
expr_stmt|;
name|temp
operator|=
name|temp
operator|>>
literal|1
expr_stmt|;
else|#
directive|else
asm|asm("bicb3	$-2,r7,(r8)+[r6]");
asm|asm("rotl	$-1,r7,r7");
endif|#
directive|endif
block|}
do|while
condition|(
operator|--
name|j
operator|>
literal|0
condition|)
do|;
block|}
do|while
condition|(
operator|--
name|i
operator|>
literal|0
condition|)
do|;
ifdef|#
directive|ifdef
name|DEBUG
if|if
condition|(
name|des_debug
condition|)
block|{
name|p_char
operator|=
name|k_char
expr_stmt|;
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"\nKey bits, from zero to 63"
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<=
literal|7
condition|;
name|i
operator|++
control|)
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"\n\t"
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<=
literal|7
condition|;
name|j
operator|++
control|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%d "
argument_list|,
operator|*
name|p_char
operator|++
argument_list|)
expr_stmt|;
block|}
block|}
else|#
directive|else
ifdef|#
directive|ifdef
name|lint
name|p_char
operator|=
name|p_char
expr_stmt|;
endif|#
directive|endif
endif|#
directive|endif
comment|/* check against weak keys */
name|k
operator|-=
sizeof|sizeof
argument_list|(
name|des_cblock
argument_list|)
expr_stmt|;
if|if
condition|(
name|des_is_weak_key
argument_list|(
name|k
argument_list|)
condition|)
return|return
operator|(
operator|-
literal|2
operator|)
return|;
name|make_key_sched
argument_list|(
name|k_char
argument_list|,
name|schedule
argument_list|)
expr_stmt|;
comment|/* if key was good, return 0 */
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|make_key_sched
parameter_list|(
name|Key
parameter_list|,
name|Schedule
parameter_list|)
specifier|register
name|key
name|Key
decl_stmt|;
comment|/* r11 */
name|des_key_schedule
name|Schedule
decl_stmt|;
block|{
comment|/*      * The key has been converted to an array to make this run faster;      * on a microvax 2, this routine takes about 3.5ms.  The code and      * size of the arrays has been played with to get it as fast as      * possible.      *      * Don't change the order of the declarations below without      * checking the assembler code to make sure that things are still      * where it expects them.      */
comment|/* r10, unroll by AUTH_DES_ITER */
specifier|register
name|int
name|iter
init|=
name|AUTH_DES_ITER
decl_stmt|;
specifier|register
name|unsigned
name|long
modifier|*
name|k
decl_stmt|;
comment|/* r9 */
specifier|register
name|int
modifier|*
name|kp
decl_stmt|;
comment|/* r8 */
specifier|register
name|unsigned
name|long
name|temp
decl_stmt|;
comment|/* r7 */
name|kp
operator|=
operator|(
name|int
operator|*
operator|)
name|key_perm
expr_stmt|;
name|k
operator|=
operator|(
name|unsigned
name|long
operator|*
operator|)
name|Schedule
expr_stmt|;
do|do
block|{
comment|/* 	 * create the Key schedule 	 * 	 * put into lsb first order (lsb is bit 0) 	 */
comment|/* 	 * On the uvax2, this C code below is as fast as straight 	 * assembler, so just use C code below. 	 */
name|temp
operator|=
literal|0
expr_stmt|;
ifdef|#
directive|ifdef
name|LSBFIRST
define|#
directive|define
name|BIT
parameter_list|(
name|x
parameter_list|)
value|x
else|#
directive|else
ifdef|#
directive|ifdef
name|notdef
define|#
directive|define
name|BIT
parameter_list|(
name|x
parameter_list|)
value|rev_swap_bit_pos_0(x)
else|#
directive|else
define|#
directive|define
name|BIT
parameter_list|(
name|x
parameter_list|)
value|x
endif|#
directive|endif
endif|#
directive|endif
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|0
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|1
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|2
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|3
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|4
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|5
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|6
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|7
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|8
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|9
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|10
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|11
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|12
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|13
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|14
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|15
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|16
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|17
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|18
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|19
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|20
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|21
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|22
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|23
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|24
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|25
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|26
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|27
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|28
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|29
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|30
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|31
argument_list|)
operator|)
expr_stmt|;
operator|*
name|k
operator|++
operator|=
name|temp
expr_stmt|;
name|temp
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|0
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|1
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|2
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|3
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|4
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|5
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|6
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|7
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|8
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|9
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|10
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|11
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|12
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|13
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|14
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|unsigned
operator|)
name|Key
index|[
operator|(
name|int
operator|)
operator|*
name|kp
operator|++
index|]
condition|)
name|temp
operator||=
operator|(
literal|1
operator|<<
name|BIT
argument_list|(
literal|15
argument_list|)
operator|)
expr_stmt|;
operator|*
name|k
operator|++
operator|=
name|temp
expr_stmt|;
block|}
do|while
condition|(
operator|--
name|iter
operator|>
literal|0
condition|)
do|;
ifdef|#
directive|ifdef
name|DEBUG
if|if
condition|(
name|des_debug
condition|)
block|{
name|char
modifier|*
name|n
decl_stmt|;
name|int
name|q
decl_stmt|;
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"\nKey Schedule, left to right"
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|AUTH_DES_ITER
condition|;
name|i
operator|++
control|)
block|{
name|n
operator|=
operator|(
name|char
operator|*
operator|)
operator|&
name|Schedule
index|[
name|i
index|]
expr_stmt|;
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
for|for
control|(
name|q
operator|=
literal|0
init|;
name|q
operator|<=
literal|7
condition|;
name|q
operator|++
control|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%02x "
argument_list|,
operator|*
name|n
operator|++
operator|&
literal|0xff
argument_list|)
expr_stmt|;
block|}
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
block|}
end_function

end_unit

