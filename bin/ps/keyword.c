begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 1990, 1993, 1994  *	The Regents of the University of California.  All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  * 3. All advertising materials mentioning features or use of this software  *    must display the following acknowledgement:  *	This product includes software developed by the University of  *	California, Berkeley and its contributors.  * 4. Neither the name of the University nor the names of its contributors  *    may be used to endorse or promote products derived from this software  *    without specific prior written permission.  *  * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_if
if|#
directive|if
literal|0
end_if

begin_else
unit|static char sccsid[] = "@(#)keyword.c	8.5 (Berkeley) 4/2/94";
else|#
directive|else
end_else

begin_decl_stmt
specifier|static
specifier|const
name|char
name|rcsid
index|[]
init|=
literal|"$FreeBSD$"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* not lint */
end_comment

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<sys/time.h>
end_include

begin_include
include|#
directive|include
file|<sys/resource.h>
end_include

begin_include
include|#
directive|include
file|<sys/proc.h>
end_include

begin_include
include|#
directive|include
file|<sys/sysctl.h>
end_include

begin_include
include|#
directive|include
file|<sys/ucred.h>
end_include

begin_include
include|#
directive|include
file|<sys/user.h>
end_include

begin_include
include|#
directive|include
file|<err.h>
end_include

begin_include
include|#
directive|include
file|<errno.h>
end_include

begin_include
include|#
directive|include
file|<stddef.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<utmp.h>
end_include

begin_include
include|#
directive|include
file|"ps.h"
end_include

begin_decl_stmt
specifier|static
name|VAR
modifier|*
name|findvar
name|__P
argument_list|(
operator|(
name|char
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|vcmp
name|__P
argument_list|(
operator|(
specifier|const
name|void
operator|*
operator|,
specifier|const
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|NOTINUSE
end_ifdef

begin_decl_stmt
name|int
name|utime
argument_list|()
decl_stmt|,
name|stime
argument_list|()
decl_stmt|,
name|ixrss
argument_list|()
decl_stmt|,
name|idrss
argument_list|()
decl_stmt|,
name|isrss
argument_list|()
decl_stmt|;
end_decl_stmt

begin_block
block|{
block|{
literal|"utime"
block|}
operator|,
literal|"UTIME"
operator|,
name|USER
operator|,
name|utime
operator|,
name|NULL
operator|,
literal|4
block|}
end_block

begin_operator
operator|,
end_operator

begin_block
block|{
block|{
literal|"stime"
block|}
operator|,
literal|"STIME"
operator|,
name|USER
operator|,
name|stime
operator|,
name|NULL
operator|,
literal|4
block|}
end_block

begin_operator
operator|,
end_operator

begin_block
block|{
block|{
literal|"ixrss"
block|}
operator|,
literal|"IXRSS"
operator|,
name|USER
operator|,
name|ixrss
operator|,
name|NULL
operator|,
literal|4
block|}
end_block

begin_operator
operator|,
end_operator

begin_block
block|{
block|{
literal|"idrss"
block|}
operator|,
literal|"IDRSS"
operator|,
name|USER
operator|,
name|idrss
operator|,
name|NULL
operator|,
literal|4
block|}
end_block

begin_operator
operator|,
end_operator

begin_block
block|{
block|{
literal|"isrss"
block|}
operator|,
literal|"ISRSS"
operator|,
name|USER
operator|,
name|isrss
operator|,
name|NULL
operator|,
literal|4
block|}
end_block

begin_operator
operator|,
end_operator

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* Compute offset in common structures. */
end_comment

begin_define
define|#
directive|define
name|KOFF
parameter_list|(
name|x
parameter_list|)
value|offsetof(struct kinfo_proc, x)
end_define

begin_define
define|#
directive|define
name|UOFF
parameter_list|(
name|x
parameter_list|)
value|offsetof(struct usave, x)
end_define

begin_define
define|#
directive|define
name|ROFF
parameter_list|(
name|x
parameter_list|)
value|offsetof(struct rusage, x)
end_define

begin_define
define|#
directive|define
name|UIDFMT
value|"u"
end_define

begin_define
define|#
directive|define
name|UIDLEN
value|5
end_define

begin_define
define|#
directive|define
name|PIDFMT
value|"d"
end_define

begin_define
define|#
directive|define
name|PIDLEN
value|5
end_define

begin_define
define|#
directive|define
name|USERLEN
value|UT_NAMESIZE
end_define

begin_decl_stmt
name|VAR
name|var
index|[]
init|=
block|{
block|{
literal|"%cpu"
block|,
literal|"%CPU"
block|,
name|NULL
block|,
literal|0
block|,
name|pcpu
block|,
name|NULL
block|,
literal|4
block|}
block|,
block|{
literal|"%mem"
block|,
literal|"%MEM"
block|,
name|NULL
block|,
literal|0
block|,
name|pmem
block|,
name|NULL
block|,
literal|4
block|}
block|,
block|{
literal|"acflag"
block|,
literal|"ACFLG"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
literal|3
block|,
name|KOFF
argument_list|(
name|ki_acflag
argument_list|)
block|,
name|USHORT
block|,
literal|"x"
block|}
block|,
block|{
literal|"acflg"
block|,
literal|""
block|,
literal|"acflag"
block|}
block|,
block|{
literal|"blocked"
block|,
literal|""
block|,
literal|"sigmask"
block|}
block|,
block|{
literal|"caught"
block|,
literal|""
block|,
literal|"sigcatch"
block|}
block|,
block|{
literal|"command"
block|,
literal|"COMMAND"
block|,
name|NULL
block|,
name|COMM
operator||
name|LJUST
operator||
name|USER
block|,
name|command
block|,
name|NULL
block|,
literal|16
block|}
block|,
block|{
literal|"cpu"
block|,
literal|"CPU"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
literal|3
block|,
name|KOFF
argument_list|(
name|ki_estcpu
argument_list|)
block|,
name|UINT
block|,
literal|"d"
block|}
block|,
block|{
literal|"cputime"
block|,
literal|""
block|,
literal|"time"
block|}
block|,
block|{
literal|"f"
block|,
literal|"F"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
literal|7
block|,
name|KOFF
argument_list|(
name|ki_flag
argument_list|)
block|,
name|INT
block|,
literal|"x"
block|}
block|,
block|{
literal|"flags"
block|,
literal|""
block|,
literal|"f"
block|}
block|,
block|{
literal|"ignored"
block|,
literal|""
block|,
literal|"sigignore"
block|}
block|,
block|{
literal|"inblk"
block|,
literal|"INBLK"
block|,
name|NULL
block|,
name|USER
block|,
name|rvar
block|,
name|NULL
block|,
literal|4
block|,
name|ROFF
argument_list|(
name|ru_inblock
argument_list|)
block|,
name|LONG
block|,
literal|"ld"
block|}
block|,
block|{
literal|"inblock"
block|,
literal|""
block|,
literal|"inblk"
block|}
block|,
block|{
literal|"jobc"
block|,
literal|"JOBC"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
literal|4
block|,
name|KOFF
argument_list|(
name|ki_jobc
argument_list|)
block|,
name|SHORT
block|,
literal|"d"
block|}
block|,
block|{
literal|"ktrace"
block|,
literal|"KTRACE"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
literal|8
block|,
name|KOFF
argument_list|(
name|ki_traceflag
argument_list|)
block|,
name|INT
block|,
literal|"x"
block|}
block|,
block|{
literal|"lim"
block|,
literal|"LIM"
block|,
name|NULL
block|,
literal|0
block|,
name|maxrss
block|,
name|NULL
block|,
literal|5
block|}
block|,
block|{
literal|"login"
block|,
literal|"LOGIN"
block|,
name|NULL
block|,
name|LJUST
block|,
name|logname
block|,
name|NULL
block|,
name|MAXLOGNAME
operator|-
literal|1
block|}
block|,
block|{
literal|"logname"
block|,
literal|""
block|,
literal|"login"
block|}
block|,
block|{
literal|"lstart"
block|,
literal|"STARTED"
block|,
name|NULL
block|,
name|LJUST
operator||
name|USER
block|,
name|lstarted
block|,
name|NULL
block|,
literal|28
block|}
block|,
block|{
literal|"majflt"
block|,
literal|"MAJFLT"
block|,
name|NULL
block|,
name|USER
block|,
name|rvar
block|,
name|NULL
block|,
literal|4
block|,
name|ROFF
argument_list|(
name|ru_majflt
argument_list|)
block|,
name|LONG
block|,
literal|"ld"
block|}
block|,
block|{
literal|"minflt"
block|,
literal|"MINFLT"
block|,
name|NULL
block|,
name|USER
block|,
name|rvar
block|,
name|NULL
block|,
literal|4
block|,
name|ROFF
argument_list|(
name|ru_minflt
argument_list|)
block|,
name|LONG
block|,
literal|"ld"
block|}
block|,
block|{
literal|"mtxname"
block|,
literal|"MUTEX"
block|,
name|NULL
block|,
name|LJUST
block|,
name|mtxname
block|,
name|NULL
block|,
literal|6
block|}
block|,
block|{
literal|"msgrcv"
block|,
literal|"MSGRCV"
block|,
name|NULL
block|,
name|USER
block|,
name|rvar
block|,
name|NULL
block|,
literal|4
block|,
name|ROFF
argument_list|(
name|ru_msgrcv
argument_list|)
block|,
name|LONG
block|,
literal|"ld"
block|}
block|,
block|{
literal|"msgsnd"
block|,
literal|"MSGSND"
block|,
name|NULL
block|,
name|USER
block|,
name|rvar
block|,
name|NULL
block|,
literal|4
block|,
name|ROFF
argument_list|(
name|ru_msgsnd
argument_list|)
block|,
name|LONG
block|,
literal|"ld"
block|}
block|,
block|{
literal|"ni"
block|,
literal|""
block|,
literal|"nice"
block|}
block|,
block|{
literal|"nice"
block|,
literal|"NI"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
literal|2
block|,
name|KOFF
argument_list|(
name|ki_nice
argument_list|)
block|,
name|CHAR
block|,
literal|"d"
block|}
block|,
block|{
literal|"nivcsw"
block|,
literal|"NIVCSW"
block|,
name|NULL
block|,
name|USER
block|,
name|rvar
block|,
name|NULL
block|,
literal|5
block|,
name|ROFF
argument_list|(
name|ru_nivcsw
argument_list|)
block|,
name|LONG
block|,
literal|"ld"
block|}
block|,
block|{
literal|"nsignals"
block|,
literal|""
block|,
literal|"nsigs"
block|}
block|,
block|{
literal|"nsigs"
block|,
literal|"NSIGS"
block|,
name|NULL
block|,
name|USER
block|,
name|rvar
block|,
name|NULL
block|,
literal|4
block|,
name|ROFF
argument_list|(
name|ru_nsignals
argument_list|)
block|,
name|LONG
block|,
literal|"ld"
block|}
block|,
block|{
literal|"nswap"
block|,
literal|"NSWAP"
block|,
name|NULL
block|,
name|USER
block|,
name|rvar
block|,
name|NULL
block|,
literal|4
block|,
name|ROFF
argument_list|(
name|ru_nswap
argument_list|)
block|,
name|LONG
block|,
literal|"ld"
block|}
block|,
block|{
literal|"nvcsw"
block|,
literal|"NVCSW"
block|,
name|NULL
block|,
name|USER
block|,
name|rvar
block|,
name|NULL
block|,
literal|5
block|,
name|ROFF
argument_list|(
name|ru_nvcsw
argument_list|)
block|,
name|LONG
block|,
literal|"ld"
block|}
block|,
block|{
literal|"nwchan"
block|,
literal|"WCHAN"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
literal|6
block|,
name|KOFF
argument_list|(
name|ki_wchan
argument_list|)
block|,
name|KPTR
block|,
literal|"lx"
block|}
block|,
block|{
literal|"oublk"
block|,
literal|"OUBLK"
block|,
name|NULL
block|,
name|USER
block|,
name|rvar
block|,
name|NULL
block|,
literal|4
block|,
name|ROFF
argument_list|(
name|ru_oublock
argument_list|)
block|,
name|LONG
block|,
literal|"ld"
block|}
block|,
block|{
literal|"oublock"
block|,
literal|""
block|,
literal|"oublk"
block|}
block|,
block|{
literal|"paddr"
block|,
literal|"PADDR"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
literal|6
block|,
name|KOFF
argument_list|(
name|ki_paddr
argument_list|)
block|,
name|KPTR
block|,
literal|"lx"
block|}
block|,
block|{
literal|"pagein"
block|,
literal|"PAGEIN"
block|,
name|NULL
block|,
name|USER
block|,
name|pagein
block|,
name|NULL
block|,
literal|6
block|}
block|,
block|{
literal|"pcpu"
block|,
literal|""
block|,
literal|"%cpu"
block|}
block|,
block|{
literal|"pending"
block|,
literal|""
block|,
literal|"sig"
block|}
block|,
block|{
literal|"pgid"
block|,
literal|"PGID"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
name|PIDLEN
block|,
name|KOFF
argument_list|(
name|ki_pgid
argument_list|)
block|,
name|UINT
block|,
name|PIDFMT
block|}
block|,
block|{
literal|"pid"
block|,
literal|"PID"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
name|PIDLEN
block|,
name|KOFF
argument_list|(
name|ki_pid
argument_list|)
block|,
name|UINT
block|,
name|PIDFMT
block|}
block|,
block|{
literal|"pmem"
block|,
literal|""
block|,
literal|"%mem"
block|}
block|,
block|{
literal|"ppid"
block|,
literal|"PPID"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
name|PIDLEN
block|,
name|KOFF
argument_list|(
name|ki_ppid
argument_list|)
block|,
name|UINT
block|,
name|PIDFMT
block|}
block|,
block|{
literal|"pri"
block|,
literal|"PRI"
block|,
name|NULL
block|,
literal|0
block|,
name|pri
block|,
name|NULL
block|,
literal|3
block|}
block|,
block|{
literal|"re"
block|,
literal|"RE"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
literal|3
block|,
name|KOFF
argument_list|(
name|ki_swtime
argument_list|)
block|,
name|UINT
block|,
literal|"d"
block|}
block|,
block|{
literal|"rgid"
block|,
literal|"RGID"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
name|UIDLEN
block|,
name|KOFF
argument_list|(
name|ki_rgid
argument_list|)
block|,
name|UINT
block|,
name|UIDFMT
block|}
block|,
block|{
literal|"rtprio"
block|,
literal|"RTPRIO"
block|,
name|NULL
block|,
literal|0
block|,
name|rtprior
block|,
name|NULL
block|,
literal|7
block|,
name|KOFF
argument_list|(
argument|ki_rtprio
argument_list|)
block|}
block|,
block|{
literal|"ruid"
block|,
literal|"RUID"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
name|UIDLEN
block|,
name|KOFF
argument_list|(
name|ki_ruid
argument_list|)
block|,
name|UINT
block|,
name|UIDFMT
block|}
block|,
block|{
literal|"ruser"
block|,
literal|"RUSER"
block|,
name|NULL
block|,
name|LJUST
operator||
name|DSIZ
block|,
name|runame
block|,
name|s_runame
block|,
name|USERLEN
block|}
block|,
block|{
literal|"sig"
block|,
literal|"PENDING"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
literal|8
block|,
name|KOFF
argument_list|(
name|ki_siglist
argument_list|)
block|,
name|INT
block|,
literal|"x"
block|}
block|,
block|{
literal|"sigcatch"
block|,
literal|"CAUGHT"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
literal|8
block|,
name|KOFF
argument_list|(
name|ki_sigcatch
argument_list|)
block|,
name|UINT
block|,
literal|"x"
block|}
block|,
block|{
literal|"sigignore"
block|,
literal|"IGNORED"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
literal|8
block|,
name|KOFF
argument_list|(
name|ki_sigignore
argument_list|)
block|,
name|UINT
block|,
literal|"x"
block|}
block|,
block|{
literal|"sigmask"
block|,
literal|"BLOCKED"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
literal|8
block|,
name|KOFF
argument_list|(
name|ki_sigmask
argument_list|)
block|,
name|UINT
block|,
literal|"x"
block|}
block|,
block|{
literal|"sl"
block|,
literal|"SL"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
literal|3
block|,
name|KOFF
argument_list|(
name|ki_slptime
argument_list|)
block|,
name|UINT
block|,
literal|"d"
block|}
block|,
block|{
literal|"start"
block|,
literal|"STARTED"
block|,
name|NULL
block|,
name|LJUST
operator||
name|USER
block|,
name|started
block|,
name|NULL
block|,
literal|7
block|}
block|,
block|{
literal|"stat"
block|,
literal|""
block|,
literal|"state"
block|}
block|,
block|{
literal|"state"
block|,
literal|"STAT"
block|,
name|NULL
block|,
literal|0
block|,
name|state
block|,
name|NULL
block|,
literal|4
block|}
block|,
block|{
literal|"svgid"
block|,
literal|"SVGID"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
name|UIDLEN
block|,
name|KOFF
argument_list|(
name|ki_svgid
argument_list|)
block|,
name|UINT
block|,
name|UIDFMT
block|}
block|,
block|{
literal|"svuid"
block|,
literal|"SVUID"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
name|UIDLEN
block|,
name|KOFF
argument_list|(
name|ki_svuid
argument_list|)
block|,
name|UINT
block|,
name|UIDFMT
block|}
block|,
block|{
literal|"tdev"
block|,
literal|"TDEV"
block|,
name|NULL
block|,
literal|0
block|,
name|tdev
block|,
name|NULL
block|,
literal|4
block|}
block|,
block|{
literal|"time"
block|,
literal|"TIME"
block|,
name|NULL
block|,
name|USER
block|,
name|cputime
block|,
name|NULL
block|,
literal|9
block|}
block|,
block|{
literal|"tpgid"
block|,
literal|"TPGID"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
literal|4
block|,
name|KOFF
argument_list|(
name|ki_tpgid
argument_list|)
block|,
name|UINT
block|,
name|PIDFMT
block|}
block|,
block|{
literal|"tsiz"
block|,
literal|"TSIZ"
block|,
name|NULL
block|,
literal|0
block|,
name|tsize
block|,
name|NULL
block|,
literal|4
block|}
block|,
block|{
literal|"tt"
block|,
literal|"TT "
block|,
name|NULL
block|,
literal|0
block|,
name|tname
block|,
name|NULL
block|,
literal|4
block|}
block|,
block|{
literal|"tty"
block|,
literal|"TTY"
block|,
name|NULL
block|,
name|LJUST
block|,
name|longtname
block|,
name|NULL
block|,
literal|8
block|}
block|,
block|{
literal|"ucomm"
block|,
literal|"UCOMM"
block|,
name|NULL
block|,
name|LJUST
block|,
name|ucomm
block|,
name|NULL
block|,
name|MAXCOMLEN
block|}
block|,
block|{
literal|"uid"
block|,
literal|"UID"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
name|UIDLEN
block|,
name|KOFF
argument_list|(
name|ki_uid
argument_list|)
block|,
name|UINT
block|,
name|UIDFMT
block|}
block|,
block|{
literal|"upr"
block|,
literal|"UPR"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
literal|3
block|,
name|KOFF
argument_list|(
name|ki_usrpri
argument_list|)
block|,
name|CHAR
block|,
literal|"d"
block|}
block|,
block|{
literal|"user"
block|,
literal|"USER"
block|,
name|NULL
block|,
name|LJUST
operator||
name|DSIZ
block|,
name|uname
block|,
name|s_uname
block|,
name|USERLEN
block|}
block|,
block|{
literal|"usrpri"
block|,
literal|""
block|,
literal|"upr"
block|}
block|,
block|{
literal|"vsize"
block|,
literal|""
block|,
literal|"vsz"
block|}
block|,
block|{
literal|"vsz"
block|,
literal|"VSZ"
block|,
name|NULL
block|,
literal|0
block|,
name|vsize
block|,
name|NULL
block|,
literal|5
block|}
block|,
block|{
literal|"wchan"
block|,
literal|"WCHAN"
block|,
name|NULL
block|,
name|LJUST
block|,
name|wchan
block|,
name|NULL
block|,
literal|6
block|}
block|,
block|{
literal|"xstat"
block|,
literal|"XSTAT"
block|,
name|NULL
block|,
literal|0
block|,
name|kvar
block|,
name|NULL
block|,
literal|4
block|,
name|KOFF
argument_list|(
name|ki_xstat
argument_list|)
block|,
name|USHORT
block|,
literal|"x"
block|}
block|,
block|{
literal|""
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_function
name|void
name|showkey
parameter_list|()
block|{
name|VAR
modifier|*
name|v
decl_stmt|;
name|int
name|i
decl_stmt|;
name|char
modifier|*
name|p
decl_stmt|,
modifier|*
name|sep
decl_stmt|;
name|i
operator|=
literal|0
expr_stmt|;
name|sep
operator|=
literal|""
expr_stmt|;
for|for
control|(
name|v
operator|=
name|var
init|;
operator|*
operator|(
name|p
operator|=
name|v
operator|->
name|name
operator|)
condition|;
operator|++
name|v
control|)
block|{
name|int
name|len
init|=
name|strlen
argument_list|(
name|p
argument_list|)
decl_stmt|;
if|if
condition|(
name|termwidth
operator|&&
operator|(
name|i
operator|+=
name|len
operator|+
literal|1
operator|)
operator|>
name|termwidth
condition|)
block|{
name|i
operator|=
name|len
expr_stmt|;
name|sep
operator|=
literal|"\n"
expr_stmt|;
block|}
operator|(
name|void
operator|)
name|printf
argument_list|(
literal|"%s%s"
argument_list|,
name|sep
argument_list|,
name|p
argument_list|)
expr_stmt|;
name|sep
operator|=
literal|" "
expr_stmt|;
block|}
operator|(
name|void
operator|)
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|parsefmt
parameter_list|(
name|p
parameter_list|)
name|char
modifier|*
name|p
decl_stmt|;
block|{
specifier|static
name|struct
name|varent
modifier|*
name|vtail
decl_stmt|;
define|#
directive|define
name|FMTSEP
value|" \t,\n"
while|while
condition|(
name|p
operator|&&
operator|*
name|p
condition|)
block|{
name|char
modifier|*
name|cp
decl_stmt|;
name|VAR
modifier|*
name|v
decl_stmt|;
name|struct
name|varent
modifier|*
name|vent
decl_stmt|;
while|while
condition|(
operator|(
name|cp
operator|=
name|strsep
argument_list|(
operator|&
name|p
argument_list|,
name|FMTSEP
argument_list|)
operator|)
operator|!=
name|NULL
operator|&&
operator|*
name|cp
operator|==
literal|'\0'
condition|)
comment|/* void */
empty_stmt|;
if|if
condition|(
operator|!
operator|(
name|v
operator|=
name|findvar
argument_list|(
name|cp
argument_list|)
operator|)
condition|)
continue|continue;
if|if
condition|(
operator|(
name|vent
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
expr|struct
name|varent
argument_list|)
argument_list|)
operator|)
operator|==
name|NULL
condition|)
name|err
argument_list|(
literal|1
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|vent
operator|->
name|var
operator|=
name|v
expr_stmt|;
name|vent
operator|->
name|next
operator|=
name|NULL
expr_stmt|;
if|if
condition|(
name|vhead
operator|==
name|NULL
condition|)
name|vhead
operator|=
name|vtail
operator|=
name|vent
expr_stmt|;
else|else
block|{
name|vtail
operator|->
name|next
operator|=
name|vent
expr_stmt|;
name|vtail
operator|=
name|vent
expr_stmt|;
block|}
block|}
if|if
condition|(
operator|!
name|vhead
condition|)
name|errx
argument_list|(
literal|1
argument_list|,
literal|"no valid keywords"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|VAR
modifier|*
name|findvar
parameter_list|(
name|p
parameter_list|)
name|char
modifier|*
name|p
decl_stmt|;
block|{
name|VAR
modifier|*
name|v
decl_stmt|,
name|key
decl_stmt|;
name|char
modifier|*
name|hp
decl_stmt|;
name|int
name|vcmp
parameter_list|()
function_decl|;
name|hp
operator|=
name|strchr
argument_list|(
name|p
argument_list|,
literal|'='
argument_list|)
expr_stmt|;
if|if
condition|(
name|hp
condition|)
operator|*
name|hp
operator|++
operator|=
literal|'\0'
expr_stmt|;
name|key
operator|.
name|name
operator|=
name|p
expr_stmt|;
name|v
operator|=
name|bsearch
argument_list|(
operator|&
name|key
argument_list|,
name|var
argument_list|,
sizeof|sizeof
argument_list|(
name|var
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|VAR
argument_list|)
operator|-
literal|1
argument_list|,
sizeof|sizeof
argument_list|(
name|VAR
argument_list|)
argument_list|,
name|vcmp
argument_list|)
expr_stmt|;
if|if
condition|(
name|v
operator|&&
name|v
operator|->
name|alias
condition|)
block|{
if|if
condition|(
name|hp
condition|)
block|{
name|warnx
argument_list|(
literal|"%s: illegal keyword specification"
argument_list|,
name|p
argument_list|)
expr_stmt|;
name|eval
operator|=
literal|1
expr_stmt|;
block|}
name|parsefmt
argument_list|(
name|v
operator|->
name|alias
argument_list|)
expr_stmt|;
return|return
operator|(
operator|(
name|VAR
operator|*
operator|)
name|NULL
operator|)
return|;
block|}
if|if
condition|(
operator|!
name|v
condition|)
block|{
name|warnx
argument_list|(
literal|"%s: keyword not found"
argument_list|,
name|p
argument_list|)
expr_stmt|;
name|eval
operator|=
literal|1
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|hp
condition|)
name|v
operator|->
name|header
operator|=
name|hp
expr_stmt|;
return|return
operator|(
name|v
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|vcmp
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
specifier|const
name|void
modifier|*
name|a
decl_stmt|,
decl|*
name|b
decl_stmt|;
end_function

begin_block
block|{
return|return
operator|(
name|strcmp
argument_list|(
operator|(
operator|(
name|VAR
operator|*
operator|)
name|a
operator|)
operator|->
name|name
argument_list|,
operator|(
operator|(
name|VAR
operator|*
operator|)
name|b
operator|)
operator|->
name|name
argument_list|)
operator|)
return|;
block|}
end_block

end_unit

