begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * pretty printing of status information  */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|HAVE_CONFIG_H
end_ifdef

begin_include
include|#
directive|include
file|<config.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|"ntp_stdlib.h"
end_include

begin_include
include|#
directive|include
file|"ntp_fp.h"
end_include

begin_include
include|#
directive|include
file|"ntp.h"
end_include

begin_include
include|#
directive|include
file|"lib_strbuf.h"
end_include

begin_include
include|#
directive|include
file|"ntp_refclock.h"
end_include

begin_include
include|#
directive|include
file|"ntp_control.h"
end_include

begin_include
include|#
directive|include
file|"ntp_string.h"
end_include

begin_comment
comment|/*  * Structure for turning various constants into a readable string.  */
end_comment

begin_struct
struct|struct
name|codestring
block|{
name|int
name|code
decl_stmt|;
specifier|const
name|char
modifier|*
name|string
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/*  * Leap status (leap)  */
end_comment

begin_decl_stmt
specifier|static
name|struct
name|codestring
name|leap_codes
index|[]
init|=
block|{
block|{
name|LEAP_NOWARNING
block|,
literal|"leap_none"
block|}
block|,
block|{
name|LEAP_ADDSECOND
block|,
literal|"leap_add_sec"
block|}
block|,
block|{
name|LEAP_DELSECOND
block|,
literal|"leap_del_sec"
block|}
block|,
block|{
name|LEAP_NOTINSYNC
block|,
literal|"leap_alarm"
block|}
block|,
block|{
operator|-
literal|1
block|,
literal|"leap"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Clock source status (sync)  */
end_comment

begin_decl_stmt
specifier|static
name|struct
name|codestring
name|sync_codes
index|[]
init|=
block|{
block|{
name|CTL_SST_TS_UNSPEC
block|,
literal|"sync_unspec"
block|}
block|,
block|{
name|CTL_SST_TS_ATOM
block|,
literal|"sync_pps"
block|}
block|,
block|{
name|CTL_SST_TS_LF
block|,
literal|"sync_lf_radio"
block|}
block|,
block|{
name|CTL_SST_TS_HF
block|,
literal|"sync_hf_radio"
block|}
block|,
block|{
name|CTL_SST_TS_UHF
block|,
literal|"sync_uhf_radio"
block|}
block|,
block|{
name|CTL_SST_TS_LOCAL
block|,
literal|"sync_local"
block|}
block|,
block|{
name|CTL_SST_TS_NTP
block|,
literal|"sync_ntp"
block|}
block|,
block|{
name|CTL_SST_TS_UDPTIME
block|,
literal|"sync_other"
block|}
block|,
block|{
name|CTL_SST_TS_WRSTWTCH
block|,
literal|"sync_wristwatch"
block|}
block|,
block|{
name|CTL_SST_TS_TELEPHONE
block|,
literal|"sync_telephone"
block|}
block|,
block|{
operator|-
literal|1
block|,
literal|"sync"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Peer selection status (sel)  */
end_comment

begin_decl_stmt
specifier|static
name|struct
name|codestring
name|select_codes
index|[]
init|=
block|{
block|{
name|CTL_PST_SEL_REJECT
block|,
literal|"sel_reject"
block|}
block|,
block|{
name|CTL_PST_SEL_SANE
block|,
literal|"sel_falsetick"
block|}
block|,
block|{
name|CTL_PST_SEL_CORRECT
block|,
literal|"sel_excess"
block|}
block|,
block|{
name|CTL_PST_SEL_SELCAND
block|,
literal|"sel_outlyer"
block|}
block|,
block|{
name|CTL_PST_SEL_SYNCCAND
block|,
literal|"sel_candidate"
block|}
block|,
block|{
name|CTL_PST_SEL_EXCESS
block|,
literal|"sel_backup"
block|}
block|,
block|{
name|CTL_PST_SEL_SYSPEER
block|,
literal|"sel_sys.peer"
block|}
block|,
block|{
name|CTL_PST_SEL_PPS
block|,
literal|"sel_pps.peer"
block|}
block|,
block|{
operator|-
literal|1
block|,
literal|"sel"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Clock status (clk)  */
end_comment

begin_decl_stmt
specifier|static
name|struct
name|codestring
name|clock_codes
index|[]
init|=
block|{
block|{
name|CTL_CLK_OKAY
block|,
literal|"clk_unspec"
block|}
block|,
block|{
name|CTL_CLK_NOREPLY
block|,
literal|"clk_no_reply"
block|}
block|,
block|{
name|CTL_CLK_BADFORMAT
block|,
literal|"clk_bad_format"
block|}
block|,
block|{
name|CTL_CLK_FAULT
block|,
literal|"clk_fault"
block|}
block|,
block|{
name|CTL_CLK_PROPAGATION
block|,
literal|"clk_bad_signal"
block|}
block|,
block|{
name|CTL_CLK_BADDATE
block|,
literal|"clk_bad_date"
block|}
block|,
block|{
name|CTL_CLK_BADTIME
block|,
literal|"clk_bad_time"
block|}
block|,
block|{
operator|-
literal|1
block|,
literal|"clk"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|FLASH_CODES_UNUSED
end_ifdef

begin_comment
comment|/*  * Flash bits -- see ntpq.c tstflags& tstflagnames  */
end_comment

begin_decl_stmt
specifier|static
name|struct
name|codestring
name|flash_codes
index|[]
init|=
block|{
block|{
name|TEST1
block|,
literal|"pkt_dup"
block|}
block|,
block|{
name|TEST2
block|,
literal|"pkt_bogus"
block|}
block|,
block|{
name|TEST3
block|,
literal|"pkt_unsync"
block|}
block|,
block|{
name|TEST4
block|,
literal|"pkt_denied"
block|}
block|,
block|{
name|TEST5
block|,
literal|"pkt_auth"
block|}
block|,
block|{
name|TEST6
block|,
literal|"pkt_stratum"
block|}
block|,
block|{
name|TEST7
block|,
literal|"pkt_header"
block|}
block|,
block|{
name|TEST8
block|,
literal|"pkt_autokey"
block|}
block|,
block|{
name|TEST9
block|,
literal|"pkt_crypto"
block|}
block|,
block|{
name|TEST10
block|,
literal|"peer_stratum"
block|}
block|,
block|{
name|TEST11
block|,
literal|"peer_dist"
block|}
block|,
block|{
name|TEST12
block|,
literal|"peer_loop"
block|}
block|,
block|{
name|TEST13
block|,
literal|"peer_unreach"
block|}
block|,
block|{
operator|-
literal|1
block|,
literal|"flash"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/*  * System events (sys)  */
end_comment

begin_decl_stmt
specifier|static
name|struct
name|codestring
name|sys_codes
index|[]
init|=
block|{
block|{
name|EVNT_UNSPEC
block|,
literal|"unspecified"
block|}
block|,
block|{
name|EVNT_NSET
block|,
literal|"freq_not_set"
block|}
block|,
block|{
name|EVNT_FSET
block|,
literal|"freq_set"
block|}
block|,
block|{
name|EVNT_SPIK
block|,
literal|"spike_detect"
block|}
block|,
block|{
name|EVNT_FREQ
block|,
literal|"freq_mode"
block|}
block|,
block|{
name|EVNT_SYNC
block|,
literal|"clock_sync"
block|}
block|,
block|{
name|EVNT_SYSRESTART
block|,
literal|"restart"
block|}
block|,
block|{
name|EVNT_SYSFAULT
block|,
literal|"panic_stop"
block|}
block|,
block|{
name|EVNT_NOPEER
block|,
literal|"no_sys_peer"
block|}
block|,
block|{
name|EVNT_ARMED
block|,
literal|"leap_armed"
block|}
block|,
block|{
name|EVNT_DISARMED
block|,
literal|"leap_disarmed"
block|}
block|,
block|{
name|EVNT_LEAP
block|,
literal|"leap_event"
block|}
block|,
block|{
name|EVNT_CLOCKRESET
block|,
literal|"clock_step"
block|}
block|,
block|{
name|EVNT_KERN
block|,
literal|"kern"
block|}
block|,
block|{
name|EVNT_TAI
block|,
literal|"TAI"
block|}
block|,
block|{
name|EVNT_LEAPVAL
block|,
literal|"stale_leapsecond_values"
block|}
block|,
block|{
name|EVNT_CLKHOP
block|,
literal|"clockhop"
block|}
block|,
block|{
operator|-
literal|1
block|,
literal|""
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Peer events (peer)  */
end_comment

begin_decl_stmt
specifier|static
name|struct
name|codestring
name|peer_codes
index|[]
init|=
block|{
block|{
name|PEVNT_MOBIL
operator|&
operator|~
name|PEER_EVENT
block|,
literal|"mobilize"
block|}
block|,
block|{
name|PEVNT_DEMOBIL
operator|&
operator|~
name|PEER_EVENT
block|,
literal|"demobilize"
block|}
block|,
block|{
name|PEVNT_UNREACH
operator|&
operator|~
name|PEER_EVENT
block|,
literal|"unreachable"
block|}
block|,
block|{
name|PEVNT_REACH
operator|&
operator|~
name|PEER_EVENT
block|,
literal|"reachable"
block|}
block|,
block|{
name|PEVNT_RESTART
operator|&
operator|~
name|PEER_EVENT
block|,
literal|"restart"
block|}
block|,
block|{
name|PEVNT_REPLY
operator|&
operator|~
name|PEER_EVENT
block|,
literal|"no_reply"
block|}
block|,
block|{
name|PEVNT_RATE
operator|&
operator|~
name|PEER_EVENT
block|,
literal|"rate_exceeded"
block|}
block|,
block|{
name|PEVNT_DENY
operator|&
operator|~
name|PEER_EVENT
block|,
literal|"access_denied"
block|}
block|,
block|{
name|PEVNT_ARMED
operator|&
operator|~
name|PEER_EVENT
block|,
literal|"leap_armed"
block|}
block|,
block|{
name|PEVNT_NEWPEER
operator|&
operator|~
name|PEER_EVENT
block|,
literal|"sys_peer"
block|}
block|,
block|{
name|PEVNT_CLOCK
operator|&
operator|~
name|PEER_EVENT
block|,
literal|"clock_event"
block|}
block|,
block|{
name|PEVNT_AUTH
operator|&
operator|~
name|PEER_EVENT
block|,
literal|"bad_auth"
block|}
block|,
block|{
name|PEVNT_POPCORN
operator|&
operator|~
name|PEER_EVENT
block|,
literal|"popcorn"
block|}
block|,
block|{
name|PEVNT_XLEAVE
operator|&
operator|~
name|PEER_EVENT
block|,
literal|"interleave_mode"
block|}
block|,
block|{
name|PEVNT_XERR
operator|&
operator|~
name|PEER_EVENT
block|,
literal|"interleave_error"
block|}
block|,
block|{
name|PEVNT_TAI
operator|&
operator|~
name|PEER_EVENT
block|,
literal|"TAI"
block|}
block|,
block|{
operator|-
literal|1
block|,
literal|""
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|OPENSSL
end_ifdef

begin_comment
comment|/*  * Crypto events (cryp)  */
end_comment

begin_decl_stmt
specifier|static
name|struct
name|codestring
name|crypto_codes
index|[]
init|=
block|{
block|{
name|XEVNT_OK
operator|&
operator|~
name|CRPT_EVENT
block|,
literal|"success"
block|}
block|,
block|{
name|XEVNT_LEN
operator|&
operator|~
name|CRPT_EVENT
block|,
literal|"bad_field_format_or_length"
block|}
block|,
block|{
name|XEVNT_TSP
operator|&
operator|~
name|CRPT_EVENT
block|,
literal|"bad_timestamp"
block|}
block|,
block|{
name|XEVNT_FSP
operator|&
operator|~
name|CRPT_EVENT
block|,
literal|"bad_filestamp"
block|}
block|,
block|{
name|XEVNT_PUB
operator|&
operator|~
name|CRPT_EVENT
block|,
literal|"bad_or_missing_public_key"
block|}
block|,
block|{
name|XEVNT_MD
operator|&
operator|~
name|CRPT_EVENT
block|,
literal|"unsupported_digest_type"
block|}
block|,
block|{
name|XEVNT_KEY
operator|&
operator|~
name|CRPT_EVENT
block|,
literal|"unsupported_identity_type"
block|}
block|,
block|{
name|XEVNT_SGL
operator|&
operator|~
name|CRPT_EVENT
block|,
literal|"bad_signature_length"
block|}
block|,
block|{
name|XEVNT_SIG
operator|&
operator|~
name|CRPT_EVENT
block|,
literal|"signature_not_verified"
block|}
block|,
block|{
name|XEVNT_VFY
operator|&
operator|~
name|CRPT_EVENT
block|,
literal|"certificate_not_verified"
block|}
block|,
block|{
name|XEVNT_PER
operator|&
operator|~
name|CRPT_EVENT
block|,
literal|"host_certificate_expired"
block|}
block|,
block|{
name|XEVNT_CKY
operator|&
operator|~
name|CRPT_EVENT
block|,
literal|"bad_or_missing_cookie"
block|}
block|,
block|{
name|XEVNT_DAT
operator|&
operator|~
name|CRPT_EVENT
block|,
literal|"bad_or_missing_leapseconds"
block|}
block|,
block|{
name|XEVNT_CRT
operator|&
operator|~
name|CRPT_EVENT
block|,
literal|"bad_or_missing_certificate"
block|}
block|,
block|{
name|XEVNT_ID
operator|&
operator|~
name|CRPT_EVENT
block|,
literal|"bad_or_missing_group key"
block|}
block|,
block|{
name|XEVNT_ERR
operator|&
operator|~
name|CRPT_EVENT
block|,
literal|"protocol_error"
block|}
block|,
block|{
operator|-
literal|1
block|,
literal|""
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* OPENSSL */
end_comment

begin_comment
comment|/* Forwards */
end_comment

begin_function_decl
specifier|static
specifier|const
name|char
modifier|*
name|getcode
parameter_list|(
name|int
parameter_list|,
name|struct
name|codestring
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
specifier|const
name|char
modifier|*
name|getevents
parameter_list|(
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/*  * getcode - return string corresponding to code  */
end_comment

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|getcode
parameter_list|(
name|int
name|code
parameter_list|,
name|struct
name|codestring
modifier|*
name|codetab
parameter_list|)
block|{
specifier|static
name|char
name|buf
index|[
literal|30
index|]
decl_stmt|;
while|while
condition|(
name|codetab
operator|->
name|code
operator|!=
operator|-
literal|1
condition|)
block|{
if|if
condition|(
name|codetab
operator|->
name|code
operator|==
name|code
condition|)
return|return
name|codetab
operator|->
name|string
return|;
name|codetab
operator|++
expr_stmt|;
block|}
name|snprintf
argument_list|(
name|buf
argument_list|,
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|,
literal|"%s_%d"
argument_list|,
name|codetab
operator|->
name|string
argument_list|,
name|code
argument_list|)
expr_stmt|;
return|return
name|buf
return|;
block|}
end_function

begin_comment
comment|/*  * getevents - return a descriptive string for the event count  */
end_comment

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|getevents
parameter_list|(
name|int
name|cnt
parameter_list|)
block|{
specifier|static
name|char
name|buf
index|[
literal|20
index|]
decl_stmt|;
if|if
condition|(
name|cnt
operator|==
literal|0
condition|)
return|return
literal|"no events"
return|;
name|snprintf
argument_list|(
name|buf
argument_list|,
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|,
literal|"%d event%s"
argument_list|,
name|cnt
argument_list|,
operator|(
name|cnt
operator|==
literal|1
operator|)
condition|?
literal|""
else|:
literal|"s"
argument_list|)
expr_stmt|;
return|return
name|buf
return|;
block|}
end_function

begin_comment
comment|/*  * statustoa - return a descriptive string for a peer status  */
end_comment

begin_function
name|char
modifier|*
name|statustoa
parameter_list|(
name|int
name|type
parameter_list|,
name|int
name|st
parameter_list|)
block|{
name|char
modifier|*
name|cb
decl_stmt|;
name|u_char
name|pst
decl_stmt|;
name|LIB_GETBUF
argument_list|(
name|cb
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|type
condition|)
block|{
case|case
name|TYPE_SYS
case|:
name|strcpy
argument_list|(
name|cb
argument_list|,
name|getcode
argument_list|(
name|CTL_SYS_LI
argument_list|(
name|st
argument_list|)
argument_list|,
name|leap_codes
argument_list|)
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|cb
argument_list|,
literal|", "
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|cb
argument_list|,
name|getcode
argument_list|(
name|CTL_SYS_SOURCE
argument_list|(
name|st
argument_list|)
argument_list|,
name|sync_codes
argument_list|)
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|cb
argument_list|,
literal|", "
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|cb
argument_list|,
name|getevents
argument_list|(
name|CTL_SYS_NEVNT
argument_list|(
name|st
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|cb
argument_list|,
literal|", "
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|cb
argument_list|,
name|getcode
argument_list|(
name|CTL_SYS_EVENT
argument_list|(
name|st
argument_list|)
argument_list|,
name|sys_codes
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|TYPE_PEER
case|:
comment|/* 		 * Handcraft the bits 		 */
name|pst
operator|=
operator|(
name|u_char
operator|)
name|CTL_PEER_STATVAL
argument_list|(
name|st
argument_list|)
expr_stmt|;
if|if
condition|(
name|pst
operator|&
name|CTL_PST_CONFIG
condition|)
name|strcpy
argument_list|(
name|cb
argument_list|,
literal|"conf"
argument_list|)
expr_stmt|;
if|if
condition|(
name|pst
operator|&
name|CTL_PST_AUTHENABLE
condition|)
block|{
if|if
condition|(
name|pst
operator|&
name|CTL_PST_CONFIG
condition|)
name|strcat
argument_list|(
name|cb
argument_list|,
literal|", authenb"
argument_list|)
expr_stmt|;
else|else
name|strcat
argument_list|(
name|cb
argument_list|,
literal|"authenb"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|pst
operator|&
name|CTL_PST_AUTHENTIC
condition|)
block|{
if|if
condition|(
name|pst
operator|&
operator|(
name|CTL_PST_CONFIG
operator||
name|CTL_PST_AUTHENABLE
operator|)
condition|)
name|strcat
argument_list|(
name|cb
argument_list|,
literal|", auth"
argument_list|)
expr_stmt|;
else|else
name|strcat
argument_list|(
name|cb
argument_list|,
literal|"auth"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|pst
operator|&
name|CTL_PST_REACH
condition|)
block|{
if|if
condition|(
name|pst
operator|&
operator|(
name|CTL_PST_CONFIG
operator||
name|CTL_PST_AUTHENABLE
operator||
name|CTL_PST_AUTHENTIC
operator|)
condition|)
name|strcat
argument_list|(
name|cb
argument_list|,
literal|", reach"
argument_list|)
expr_stmt|;
else|else
name|strcat
argument_list|(
name|cb
argument_list|,
literal|"reach"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|pst
operator|&
name|CTL_PST_BCAST
condition|)
block|{
if|if
condition|(
name|pst
operator|&
operator|(
name|CTL_PST_CONFIG
operator||
name|CTL_PST_AUTHENABLE
operator||
name|CTL_PST_AUTHENTIC
operator||
name|CTL_PST_REACH
operator|)
condition|)
name|strcat
argument_list|(
name|cb
argument_list|,
literal|", bcst"
argument_list|)
expr_stmt|;
else|else
name|strcat
argument_list|(
name|cb
argument_list|,
literal|"bcst"
argument_list|)
expr_stmt|;
block|}
comment|/* 		 * Now the codes 		 */
name|strcat
argument_list|(
name|cb
argument_list|,
literal|", "
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|cb
argument_list|,
name|getcode
argument_list|(
name|pst
operator|&
literal|0x7
argument_list|,
name|select_codes
argument_list|)
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|cb
argument_list|,
literal|", "
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|cb
argument_list|,
name|getevents
argument_list|(
name|CTL_PEER_NEVNT
argument_list|(
name|st
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|CTL_PEER_EVENT
argument_list|(
name|st
argument_list|)
operator|!=
name|EVNT_UNSPEC
condition|)
block|{
name|strcat
argument_list|(
name|cb
argument_list|,
literal|", "
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|cb
argument_list|,
name|getcode
argument_list|(
name|CTL_PEER_EVENT
argument_list|(
name|st
argument_list|)
argument_list|,
name|peer_codes
argument_list|)
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|TYPE_CLOCK
case|:
name|strcat
argument_list|(
name|cb
argument_list|,
literal|", "
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|cb
argument_list|,
name|getevents
argument_list|(
name|CTL_SYS_NEVNT
argument_list|(
name|st
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|cb
argument_list|,
literal|", "
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|cb
argument_list|,
name|getcode
argument_list|(
operator|(
name|st
operator|)
operator|&
literal|0xf
argument_list|,
name|clock_codes
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
return|return
name|cb
return|;
block|}
end_function

begin_function
specifier|const
name|char
modifier|*
name|eventstr
parameter_list|(
name|int
name|num
parameter_list|)
block|{
if|if
condition|(
name|num
operator|&
name|PEER_EVENT
condition|)
return|return
operator|(
name|getcode
argument_list|(
name|num
operator|&
operator|~
name|PEER_EVENT
argument_list|,
name|peer_codes
argument_list|)
operator|)
return|;
ifdef|#
directive|ifdef
name|OPENSSL
elseif|else
if|if
condition|(
name|num
operator|&
name|CRPT_EVENT
condition|)
return|return
operator|(
name|getcode
argument_list|(
name|num
operator|&
operator|~
name|CRPT_EVENT
argument_list|,
name|crypto_codes
argument_list|)
operator|)
return|;
endif|#
directive|endif
comment|/* OPENSSL */
else|else
return|return
operator|(
name|getcode
argument_list|(
name|num
argument_list|,
name|sys_codes
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|const
name|char
modifier|*
name|ceventstr
parameter_list|(
name|int
name|num
parameter_list|)
block|{
return|return
name|getcode
argument_list|(
name|num
argument_list|,
name|clock_codes
argument_list|)
return|;
block|}
end_function

end_unit

