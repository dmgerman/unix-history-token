begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* This code could be made a lot faster for PPP */
end_comment

begin_comment
comment|/* Copyright (C) 1991-2, RSA Data Security, Inc. Created 1991. All  * rights reserved.  *  * License to copy and use this software is granted provided that it  * is identified as the "RSA Data Security, Inc. MD5 Message-Digest  * Algorithm" in all material mentioning or referencing this software  * or this function.  *  * License is also granted to make and use derivative works provided  * that such works are identified as "derived from the RSA Data  * Security, Inc. MD5 Message-Digest Algorithm" in all material  * mentioning or referencing the derived work.  *  * RSA Data Security, Inc. makes no representations concerning either  * the merchantability of this software or the suitability of this  * software for any particular purpose. It is provided "as is"  * without express or implied warranty of any kind.  *  * These notices must be retained in any copies of any part of this  * documentation and/or software.  */
end_comment

begin_empty
empty|#ident "$Revision: 1.2 $"
end_empty

begin_ifdef
ifdef|#
directive|ifdef
name|sgi
end_ifdef

begin_include
include|#
directive|include
file|<strings.h>
end_include

begin_include
include|#
directive|include
file|<bstring.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_define
define|#
directive|define
name|MD5_DIGEST_LEN
value|16
end_define

begin_typedef
typedef|typedef
struct|struct
block|{
name|u_int32_t
name|state
index|[
literal|4
index|]
decl_stmt|;
comment|/* state (ABCD) */
name|u_int32_t
name|count
index|[
literal|2
index|]
decl_stmt|;
comment|/* # of bits, modulo 2^64 (LSB 1st) */
name|unsigned
name|char
name|buffer
index|[
literal|64
index|]
decl_stmt|;
comment|/* input buffer */
block|}
name|MD5_CTX
typedef|;
end_typedef

begin_function_decl
specifier|extern
name|void
name|MD5Init
parameter_list|(
name|MD5_CTX
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|void
name|MD5Update
parameter_list|(
name|MD5_CTX
modifier|*
parameter_list|,
name|u_char
modifier|*
parameter_list|,
name|u_int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|void
name|MD5Final
parameter_list|(
name|u_char
index|[
name|MD5_DIGEST_LEN
index|]
parameter_list|,
name|MD5_CTX
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* UINT4 defines a four byte word */
end_comment

begin_define
define|#
directive|define
name|UINT4
value|u_int32_t
end_define

begin_define
define|#
directive|define
name|MD5_memcpy
parameter_list|(
name|d
parameter_list|,
name|s
parameter_list|,
name|l
parameter_list|)
value|bcopy(s,d,l)
end_define

begin_comment
comment|/* Constants for MD5Transform routine.  */
end_comment

begin_define
define|#
directive|define
name|S11
value|7
end_define

begin_define
define|#
directive|define
name|S12
value|12
end_define

begin_define
define|#
directive|define
name|S13
value|17
end_define

begin_define
define|#
directive|define
name|S14
value|22
end_define

begin_define
define|#
directive|define
name|S21
value|5
end_define

begin_define
define|#
directive|define
name|S22
value|9
end_define

begin_define
define|#
directive|define
name|S23
value|14
end_define

begin_define
define|#
directive|define
name|S24
value|20
end_define

begin_define
define|#
directive|define
name|S31
value|4
end_define

begin_define
define|#
directive|define
name|S32
value|11
end_define

begin_define
define|#
directive|define
name|S33
value|16
end_define

begin_define
define|#
directive|define
name|S34
value|23
end_define

begin_define
define|#
directive|define
name|S41
value|6
end_define

begin_define
define|#
directive|define
name|S42
value|10
end_define

begin_define
define|#
directive|define
name|S43
value|15
end_define

begin_define
define|#
directive|define
name|S44
value|21
end_define

begin_function_decl
specifier|static
name|void
name|MD5Transform
parameter_list|(
name|UINT4
index|[
literal|4
index|]
parameter_list|,
name|unsigned
name|char
index|[
literal|64
index|]
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|Encode
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|,
name|UINT4
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|Decode
parameter_list|(
name|UINT4
modifier|*
parameter_list|,
name|unsigned
name|char
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_decl_stmt
specifier|static
name|unsigned
name|char
name|PADDING
index|[
literal|64
index|]
init|=
block|{
literal|0x80
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* F, G, H and I are basic MD5 functions.  */
end_comment

begin_define
define|#
directive|define
name|F
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|,
name|z
parameter_list|)
value|(((x)& (y)) | ((~x)& (z)))
end_define

begin_define
define|#
directive|define
name|G
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|,
name|z
parameter_list|)
value|(((x)& (z)) | ((y)& (~z)))
end_define

begin_define
define|#
directive|define
name|H
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|,
name|z
parameter_list|)
value|((x) ^ (y) ^ (z))
end_define

begin_define
define|#
directive|define
name|I
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|,
name|z
parameter_list|)
value|((y) ^ ((x) | (~z)))
end_define

begin_comment
comment|/* ROTATE_LEFT rotates x left n bits.  */
end_comment

begin_define
define|#
directive|define
name|ROTATE_LEFT
parameter_list|(
name|x
parameter_list|,
name|n
parameter_list|)
value|(((x)<< (n)) | ((x)>> (32-(n))))
end_define

begin_comment
comment|/* FF, GG, HH, and II transformations for rounds 1, 2, 3, and 4.  * Rotation is separate from addition to prevent recomputation.  */
end_comment

begin_define
define|#
directive|define
name|FF
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|c
parameter_list|,
name|d
parameter_list|,
name|x
parameter_list|,
name|s
parameter_list|,
name|ac
parameter_list|)
value|{ \ 	(a) += F ((b), (c), (d)) + (x) + (UINT4)(ac); \ 	(a) = ROTATE_LEFT ((a), (s)); \ 	(a) += (b); \ }
end_define

begin_define
define|#
directive|define
name|GG
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|c
parameter_list|,
name|d
parameter_list|,
name|x
parameter_list|,
name|s
parameter_list|,
name|ac
parameter_list|)
value|{ \ 	(a) += G ((b), (c), (d)) + (x) + (UINT4)(ac); \ 	(a) = ROTATE_LEFT ((a), (s)); \ 	(a) += (b); \ }
end_define

begin_define
define|#
directive|define
name|HH
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|c
parameter_list|,
name|d
parameter_list|,
name|x
parameter_list|,
name|s
parameter_list|,
name|ac
parameter_list|)
value|{ \ 	(a) += H ((b), (c), (d)) + (x) + (UINT4)(ac); \ 	(a) = ROTATE_LEFT ((a), (s)); \ 	(a) += (b); \ }
end_define

begin_define
define|#
directive|define
name|II
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|c
parameter_list|,
name|d
parameter_list|,
name|x
parameter_list|,
name|s
parameter_list|,
name|ac
parameter_list|)
value|{ \ 	(a) += I ((b), (c), (d)) + (x) + (UINT4)(ac); \ 	(a) = ROTATE_LEFT ((a), (s)); \ 	(a) += (b); \ }
end_define

begin_comment
comment|/* MD5 initialization. Begins an MD5 operation, writing a new context.  */
end_comment

begin_function
name|void
name|MD5Init
parameter_list|(
name|MD5_CTX
modifier|*
name|context
parameter_list|)
block|{
name|context
operator|->
name|count
index|[
literal|0
index|]
operator|=
name|context
operator|->
name|count
index|[
literal|1
index|]
operator|=
literal|0
expr_stmt|;
comment|/* Load magic initialization constants. 	 */
name|context
operator|->
name|state
index|[
literal|0
index|]
operator|=
literal|0x67452301
expr_stmt|;
name|context
operator|->
name|state
index|[
literal|1
index|]
operator|=
literal|0xefcdab89
expr_stmt|;
name|context
operator|->
name|state
index|[
literal|2
index|]
operator|=
literal|0x98badcfe
expr_stmt|;
name|context
operator|->
name|state
index|[
literal|3
index|]
operator|=
literal|0x10325476
expr_stmt|;
block|}
end_function

begin_comment
comment|/* MD5 block update operation. Continues an MD5 message-digest  * operation, processing another message block, and updating the  * context.  */
end_comment

begin_function
name|void
name|MD5Update
parameter_list|(
name|MD5_CTX
modifier|*
name|context
parameter_list|,
comment|/* context */
name|unsigned
name|char
modifier|*
name|input
parameter_list|,
comment|/* input block */
name|unsigned
name|int
name|inputLen
parameter_list|)
comment|/* length of input block */
block|{
name|unsigned
name|int
name|i
decl_stmt|,
name|indx
decl_stmt|,
name|partLen
decl_stmt|;
comment|/* Compute number of bytes mod 64 */
name|indx
operator|=
operator|(
operator|(
name|context
operator|->
name|count
index|[
literal|0
index|]
operator|>>
literal|3
operator|)
operator|&
literal|0x3F
operator|)
expr_stmt|;
comment|/* Update number of bits */
if|if
condition|(
operator|(
name|context
operator|->
name|count
index|[
literal|0
index|]
operator|+=
operator|(
operator|(
name|UINT4
operator|)
name|inputLen
operator|<<
literal|3
operator|)
operator|)
operator|<
operator|(
operator|(
name|UINT4
operator|)
name|inputLen
operator|<<
literal|3
operator|)
condition|)
name|context
operator|->
name|count
index|[
literal|1
index|]
operator|++
expr_stmt|;
name|context
operator|->
name|count
index|[
literal|1
index|]
operator|+=
operator|(
operator|(
name|UINT4
operator|)
name|inputLen
operator|>>
literal|29
operator|)
expr_stmt|;
name|partLen
operator|=
literal|64
operator|-
name|indx
expr_stmt|;
comment|/* Transform as many times as possible. 	 */
if|if
condition|(
name|inputLen
operator|>=
name|partLen
condition|)
block|{
name|bcopy
argument_list|(
name|input
argument_list|,
operator|&
name|context
operator|->
name|buffer
index|[
name|indx
index|]
argument_list|,
name|partLen
argument_list|)
expr_stmt|;
name|MD5Transform
argument_list|(
name|context
operator|->
name|state
argument_list|,
name|context
operator|->
name|buffer
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
name|partLen
init|;
name|i
operator|+
literal|63
operator|<
name|inputLen
condition|;
name|i
operator|+=
literal|64
control|)
name|MD5Transform
argument_list|(
name|context
operator|->
name|state
argument_list|,
operator|&
name|input
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|indx
operator|=
literal|0
expr_stmt|;
block|}
else|else
block|{
name|i
operator|=
literal|0
expr_stmt|;
block|}
comment|/* Buffer remaining input */
name|bcopy
argument_list|(
operator|&
name|input
index|[
name|i
index|]
argument_list|,
operator|&
name|context
operator|->
name|buffer
index|[
name|indx
index|]
argument_list|,
name|inputLen
operator|-
name|i
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* MD5 finalization. Ends an MD5 message-digest operation, writing the   the message digest and zeroizing the context.  */
end_comment

begin_function
name|void
name|MD5Final
parameter_list|(
name|unsigned
name|char
name|digest
index|[
name|MD5_DIGEST_LEN
index|]
parameter_list|,
comment|/* message digest */
name|MD5_CTX
modifier|*
name|context
parameter_list|)
comment|/* context */
block|{
name|unsigned
name|char
name|bits
index|[
literal|8
index|]
decl_stmt|;
name|unsigned
name|int
name|indx
decl_stmt|,
name|padLen
decl_stmt|;
comment|/* Save number of bits */
name|Encode
argument_list|(
name|bits
argument_list|,
name|context
operator|->
name|count
argument_list|,
literal|8
argument_list|)
expr_stmt|;
comment|/* Pad out to 56 mod 64. 	 */
name|indx
operator|=
call|(
name|unsigned
name|int
call|)
argument_list|(
operator|(
name|context
operator|->
name|count
index|[
literal|0
index|]
operator|>>
literal|3
operator|)
operator|&
literal|0x3f
argument_list|)
expr_stmt|;
name|padLen
operator|=
operator|(
name|indx
operator|<
literal|56
operator|)
condition|?
operator|(
literal|56
operator|-
name|indx
operator|)
else|:
operator|(
literal|120
operator|-
name|indx
operator|)
expr_stmt|;
name|MD5Update
argument_list|(
name|context
argument_list|,
name|PADDING
argument_list|,
name|padLen
argument_list|)
expr_stmt|;
comment|/* Append length (before padding) */
name|MD5Update
argument_list|(
name|context
argument_list|,
name|bits
argument_list|,
literal|8
argument_list|)
expr_stmt|;
comment|/* Store state in digest */
name|Encode
argument_list|(
name|digest
argument_list|,
name|context
operator|->
name|state
argument_list|,
name|MD5_DIGEST_LEN
argument_list|)
expr_stmt|;
comment|/* Zeroize sensitive information. 	 */
name|bzero
argument_list|(
name|context
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|context
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* MD5 basic transformation. Transforms state based on block.  */
end_comment

begin_function
specifier|static
name|void
name|MD5Transform
parameter_list|(
name|UINT4
name|state
index|[
literal|4
index|]
parameter_list|,
name|unsigned
name|char
name|block
index|[
literal|64
index|]
parameter_list|)
block|{
name|UINT4
name|a
init|=
name|state
index|[
literal|0
index|]
decl_stmt|,
name|b
init|=
name|state
index|[
literal|1
index|]
decl_stmt|,
name|c
init|=
name|state
index|[
literal|2
index|]
decl_stmt|,
name|d
init|=
name|state
index|[
literal|3
index|]
decl_stmt|,
name|x
index|[
literal|16
index|]
decl_stmt|;
name|Decode
argument_list|(
name|x
argument_list|,
name|block
argument_list|,
literal|64
argument_list|)
expr_stmt|;
comment|/* Round 1 */
name|FF
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|0
index|]
argument_list|,
name|S11
argument_list|,
literal|0xd76aa478
argument_list|)
expr_stmt|;
comment|/* 1 */
name|FF
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|1
index|]
argument_list|,
name|S12
argument_list|,
literal|0xe8c7b756
argument_list|)
expr_stmt|;
comment|/* 2 */
name|FF
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|2
index|]
argument_list|,
name|S13
argument_list|,
literal|0x242070db
argument_list|)
expr_stmt|;
comment|/* 3 */
name|FF
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|3
index|]
argument_list|,
name|S14
argument_list|,
literal|0xc1bdceee
argument_list|)
expr_stmt|;
comment|/* 4 */
name|FF
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|4
index|]
argument_list|,
name|S11
argument_list|,
literal|0xf57c0faf
argument_list|)
expr_stmt|;
comment|/* 5 */
name|FF
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|5
index|]
argument_list|,
name|S12
argument_list|,
literal|0x4787c62a
argument_list|)
expr_stmt|;
comment|/* 6 */
name|FF
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|6
index|]
argument_list|,
name|S13
argument_list|,
literal|0xa8304613
argument_list|)
expr_stmt|;
comment|/* 7 */
name|FF
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|7
index|]
argument_list|,
name|S14
argument_list|,
literal|0xfd469501
argument_list|)
expr_stmt|;
comment|/* 8 */
name|FF
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|8
index|]
argument_list|,
name|S11
argument_list|,
literal|0x698098d8
argument_list|)
expr_stmt|;
comment|/* 9 */
name|FF
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|9
index|]
argument_list|,
name|S12
argument_list|,
literal|0x8b44f7af
argument_list|)
expr_stmt|;
comment|/* 10 */
name|FF
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|10
index|]
argument_list|,
name|S13
argument_list|,
literal|0xffff5bb1
argument_list|)
expr_stmt|;
comment|/* 11 */
name|FF
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|11
index|]
argument_list|,
name|S14
argument_list|,
literal|0x895cd7be
argument_list|)
expr_stmt|;
comment|/* 12 */
name|FF
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|12
index|]
argument_list|,
name|S11
argument_list|,
literal|0x6b901122
argument_list|)
expr_stmt|;
comment|/* 13 */
name|FF
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|13
index|]
argument_list|,
name|S12
argument_list|,
literal|0xfd987193
argument_list|)
expr_stmt|;
comment|/* 14 */
name|FF
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|14
index|]
argument_list|,
name|S13
argument_list|,
literal|0xa679438e
argument_list|)
expr_stmt|;
comment|/* 15 */
name|FF
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|15
index|]
argument_list|,
name|S14
argument_list|,
literal|0x49b40821
argument_list|)
expr_stmt|;
comment|/* 16 */
comment|/* Round 2 */
name|GG
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|1
index|]
argument_list|,
name|S21
argument_list|,
literal|0xf61e2562
argument_list|)
expr_stmt|;
comment|/* 17 */
name|GG
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|6
index|]
argument_list|,
name|S22
argument_list|,
literal|0xc040b340
argument_list|)
expr_stmt|;
comment|/* 18 */
name|GG
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|11
index|]
argument_list|,
name|S23
argument_list|,
literal|0x265e5a51
argument_list|)
expr_stmt|;
comment|/* 19 */
name|GG
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|0
index|]
argument_list|,
name|S24
argument_list|,
literal|0xe9b6c7aa
argument_list|)
expr_stmt|;
comment|/* 20 */
name|GG
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|5
index|]
argument_list|,
name|S21
argument_list|,
literal|0xd62f105d
argument_list|)
expr_stmt|;
comment|/* 21 */
name|GG
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|10
index|]
argument_list|,
name|S22
argument_list|,
literal|0x2441453
argument_list|)
expr_stmt|;
comment|/* 22 */
name|GG
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|15
index|]
argument_list|,
name|S23
argument_list|,
literal|0xd8a1e681
argument_list|)
expr_stmt|;
comment|/* 23 */
name|GG
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|4
index|]
argument_list|,
name|S24
argument_list|,
literal|0xe7d3fbc8
argument_list|)
expr_stmt|;
comment|/* 24 */
name|GG
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|9
index|]
argument_list|,
name|S21
argument_list|,
literal|0x21e1cde6
argument_list|)
expr_stmt|;
comment|/* 25 */
name|GG
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|14
index|]
argument_list|,
name|S22
argument_list|,
literal|0xc33707d6
argument_list|)
expr_stmt|;
comment|/* 26 */
name|GG
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|3
index|]
argument_list|,
name|S23
argument_list|,
literal|0xf4d50d87
argument_list|)
expr_stmt|;
comment|/* 27 */
name|GG
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|8
index|]
argument_list|,
name|S24
argument_list|,
literal|0x455a14ed
argument_list|)
expr_stmt|;
comment|/* 28 */
name|GG
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|13
index|]
argument_list|,
name|S21
argument_list|,
literal|0xa9e3e905
argument_list|)
expr_stmt|;
comment|/* 29 */
name|GG
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|2
index|]
argument_list|,
name|S22
argument_list|,
literal|0xfcefa3f8
argument_list|)
expr_stmt|;
comment|/* 30 */
name|GG
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|7
index|]
argument_list|,
name|S23
argument_list|,
literal|0x676f02d9
argument_list|)
expr_stmt|;
comment|/* 31 */
name|GG
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|12
index|]
argument_list|,
name|S24
argument_list|,
literal|0x8d2a4c8a
argument_list|)
expr_stmt|;
comment|/* 32 */
comment|/* Round 3 */
name|HH
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|5
index|]
argument_list|,
name|S31
argument_list|,
literal|0xfffa3942
argument_list|)
expr_stmt|;
comment|/* 33 */
name|HH
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|8
index|]
argument_list|,
name|S32
argument_list|,
literal|0x8771f681
argument_list|)
expr_stmt|;
comment|/* 34 */
name|HH
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|11
index|]
argument_list|,
name|S33
argument_list|,
literal|0x6d9d6122
argument_list|)
expr_stmt|;
comment|/* 35 */
name|HH
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|14
index|]
argument_list|,
name|S34
argument_list|,
literal|0xfde5380c
argument_list|)
expr_stmt|;
comment|/* 36 */
name|HH
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|1
index|]
argument_list|,
name|S31
argument_list|,
literal|0xa4beea44
argument_list|)
expr_stmt|;
comment|/* 37 */
name|HH
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|4
index|]
argument_list|,
name|S32
argument_list|,
literal|0x4bdecfa9
argument_list|)
expr_stmt|;
comment|/* 38 */
name|HH
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|7
index|]
argument_list|,
name|S33
argument_list|,
literal|0xf6bb4b60
argument_list|)
expr_stmt|;
comment|/* 39 */
name|HH
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|10
index|]
argument_list|,
name|S34
argument_list|,
literal|0xbebfbc70
argument_list|)
expr_stmt|;
comment|/* 40 */
name|HH
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|13
index|]
argument_list|,
name|S31
argument_list|,
literal|0x289b7ec6
argument_list|)
expr_stmt|;
comment|/* 41 */
name|HH
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|0
index|]
argument_list|,
name|S32
argument_list|,
literal|0xeaa127fa
argument_list|)
expr_stmt|;
comment|/* 42 */
name|HH
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|3
index|]
argument_list|,
name|S33
argument_list|,
literal|0xd4ef3085
argument_list|)
expr_stmt|;
comment|/* 43 */
name|HH
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|6
index|]
argument_list|,
name|S34
argument_list|,
literal|0x4881d05
argument_list|)
expr_stmt|;
comment|/* 44 */
name|HH
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|9
index|]
argument_list|,
name|S31
argument_list|,
literal|0xd9d4d039
argument_list|)
expr_stmt|;
comment|/* 45 */
name|HH
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|12
index|]
argument_list|,
name|S32
argument_list|,
literal|0xe6db99e5
argument_list|)
expr_stmt|;
comment|/* 46 */
name|HH
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|15
index|]
argument_list|,
name|S33
argument_list|,
literal|0x1fa27cf8
argument_list|)
expr_stmt|;
comment|/* 47 */
name|HH
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|2
index|]
argument_list|,
name|S34
argument_list|,
literal|0xc4ac5665
argument_list|)
expr_stmt|;
comment|/* 48 */
comment|/* Round 4 */
name|II
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|0
index|]
argument_list|,
name|S41
argument_list|,
literal|0xf4292244
argument_list|)
expr_stmt|;
comment|/* 49 */
name|II
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|7
index|]
argument_list|,
name|S42
argument_list|,
literal|0x432aff97
argument_list|)
expr_stmt|;
comment|/* 50 */
name|II
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|14
index|]
argument_list|,
name|S43
argument_list|,
literal|0xab9423a7
argument_list|)
expr_stmt|;
comment|/* 51 */
name|II
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|5
index|]
argument_list|,
name|S44
argument_list|,
literal|0xfc93a039
argument_list|)
expr_stmt|;
comment|/* 52 */
name|II
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|12
index|]
argument_list|,
name|S41
argument_list|,
literal|0x655b59c3
argument_list|)
expr_stmt|;
comment|/* 53 */
name|II
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|3
index|]
argument_list|,
name|S42
argument_list|,
literal|0x8f0ccc92
argument_list|)
expr_stmt|;
comment|/* 54 */
name|II
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|10
index|]
argument_list|,
name|S43
argument_list|,
literal|0xffeff47d
argument_list|)
expr_stmt|;
comment|/* 55 */
name|II
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|1
index|]
argument_list|,
name|S44
argument_list|,
literal|0x85845dd1
argument_list|)
expr_stmt|;
comment|/* 56 */
name|II
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|8
index|]
argument_list|,
name|S41
argument_list|,
literal|0x6fa87e4f
argument_list|)
expr_stmt|;
comment|/* 57 */
name|II
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|15
index|]
argument_list|,
name|S42
argument_list|,
literal|0xfe2ce6e0
argument_list|)
expr_stmt|;
comment|/* 58 */
name|II
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|6
index|]
argument_list|,
name|S43
argument_list|,
literal|0xa3014314
argument_list|)
expr_stmt|;
comment|/* 59 */
name|II
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|13
index|]
argument_list|,
name|S44
argument_list|,
literal|0x4e0811a1
argument_list|)
expr_stmt|;
comment|/* 60 */
name|II
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|4
index|]
argument_list|,
name|S41
argument_list|,
literal|0xf7537e82
argument_list|)
expr_stmt|;
comment|/* 61 */
name|II
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|11
index|]
argument_list|,
name|S42
argument_list|,
literal|0xbd3af235
argument_list|)
expr_stmt|;
comment|/* 62 */
name|II
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|2
index|]
argument_list|,
name|S43
argument_list|,
literal|0x2ad7d2bb
argument_list|)
expr_stmt|;
comment|/* 63 */
name|II
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|9
index|]
argument_list|,
name|S44
argument_list|,
literal|0xeb86d391
argument_list|)
expr_stmt|;
comment|/* 64 */
name|state
index|[
literal|0
index|]
operator|+=
name|a
expr_stmt|;
name|state
index|[
literal|1
index|]
operator|+=
name|b
expr_stmt|;
name|state
index|[
literal|2
index|]
operator|+=
name|c
expr_stmt|;
name|state
index|[
literal|3
index|]
operator|+=
name|d
expr_stmt|;
comment|/* Zeroize sensitive information. 	 */
name|bzero
argument_list|(
name|x
argument_list|,
sizeof|sizeof
argument_list|(
name|x
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* Encodes input (UINT4) into output (unsigned char). Assumes len is  * a multiple of 4.  */
end_comment

begin_function
specifier|static
name|void
name|Encode
parameter_list|(
name|unsigned
name|char
modifier|*
name|output
parameter_list|,
name|UINT4
modifier|*
name|input
parameter_list|,
name|unsigned
name|int
name|len
parameter_list|)
block|{
name|unsigned
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|len
condition|;
name|i
operator|++
operator|,
name|j
operator|+=
literal|4
control|)
block|{
name|output
index|[
name|j
index|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
name|input
index|[
name|i
index|]
operator|&
literal|0xff
argument_list|)
expr_stmt|;
name|output
index|[
name|j
operator|+
literal|1
index|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
operator|(
name|input
index|[
name|i
index|]
operator|>>
literal|8
operator|)
operator|&
literal|0xff
argument_list|)
expr_stmt|;
name|output
index|[
name|j
operator|+
literal|2
index|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
operator|(
name|input
index|[
name|i
index|]
operator|>>
literal|16
operator|)
operator|&
literal|0xff
argument_list|)
expr_stmt|;
name|output
index|[
name|j
operator|+
literal|3
index|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
operator|(
name|input
index|[
name|i
index|]
operator|>>
literal|24
operator|)
operator|&
literal|0xff
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* Decodes input (unsigned char) into output (UINT4). Assumes len is  * a multiple of 4.  */
end_comment

begin_function
specifier|static
name|void
name|Decode
parameter_list|(
name|UINT4
modifier|*
name|output
parameter_list|,
name|unsigned
name|char
modifier|*
name|input
parameter_list|,
name|unsigned
name|int
name|len
parameter_list|)
block|{
name|unsigned
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|len
condition|;
name|i
operator|++
operator|,
name|j
operator|+=
literal|4
control|)
name|output
index|[
name|i
index|]
operator|=
operator|(
operator|(
name|UINT4
operator|)
name|input
index|[
name|j
index|]
operator|)
operator||
operator|(
operator|(
operator|(
name|UINT4
operator|)
name|input
index|[
name|j
operator|+
literal|1
index|]
operator|)
operator|<<
literal|8
operator|)
operator||
operator|(
operator|(
operator|(
name|UINT4
operator|)
name|input
index|[
name|j
operator|+
literal|2
index|]
operator|)
operator|<<
literal|16
operator|)
operator||
operator|(
operator|(
operator|(
name|UINT4
operator|)
name|input
index|[
name|j
operator|+
literal|3
index|]
operator|)
operator|<<
literal|24
operator|)
expr_stmt|;
block|}
end_function

end_unit

