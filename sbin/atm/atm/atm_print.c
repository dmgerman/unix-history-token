begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  *  * ===================================  * HARP  |  Host ATM Research Platform  * ===================================  *  *  * This Host ATM Research Platform ("HARP") file (the "Software") is  * made available by Network Computing Services, Inc. ("NetworkCS")  * "AS IS".  NetworkCS does not provide maintenance, improvements or  * support of any kind.  *  * NETWORKCS MAKES NO WARRANTIES OR REPRESENTATIONS, EXPRESS OR IMPLIED,  * INCLUDING, BUT NOT LIMITED TO, IMPLIED WARRANTIES OF MERCHANTABILITY  * AND FITNESS FOR A PARTICULAR PURPOSE, AS TO ANY ELEMENT OF THE  * SOFTWARE OR ANY SUPPORT PROVIDED IN CONNECTION WITH THIS SOFTWARE.  * In no event shall NetworkCS be responsible for any damages, including  * but not limited to consequential damages, arising from or relating to  * any use of the Software or related support.  *  * Copyright 1994-1998 Network Computing Services, Inc.  *  * Copies of this Software may be made, however, the above copyright  * notice must be reproduced on all copies.  *  *	@(#) $FreeBSD$  *  */
end_comment

begin_comment
comment|/*  * User configuration and display program  * --------------------------------------  *  * Print routines for "show" subcommand  *  */
end_comment

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<sys/socket.h>
end_include

begin_include
include|#
directive|include
file|<net/if.h>
end_include

begin_include
include|#
directive|include
file|<netinet/in.h>
end_include

begin_include
include|#
directive|include
file|<arpa/inet.h>
end_include

begin_include
include|#
directive|include
file|<netatm/port.h>
end_include

begin_include
include|#
directive|include
file|<netatm/atm.h>
end_include

begin_include
include|#
directive|include
file|<netatm/atm_if.h>
end_include

begin_include
include|#
directive|include
file|<netatm/atm_sap.h>
end_include

begin_include
include|#
directive|include
file|<netatm/atm_sigmgr.h>
end_include

begin_include
include|#
directive|include
file|<netatm/atm_sys.h>
end_include

begin_include
include|#
directive|include
file|<netatm/atm_vc.h>
end_include

begin_include
include|#
directive|include
file|<netatm/atm_ioctl.h>
end_include

begin_include
include|#
directive|include
file|<netatm/ipatm/ipatm_var.h>
end_include

begin_include
include|#
directive|include
file|<netatm/sigpvc/sigpvc_var.h>
end_include

begin_include
include|#
directive|include
file|<netatm/spans/spans_var.h>
end_include

begin_include
include|#
directive|include
file|<netatm/uni/uniip_var.h>
end_include

begin_include
include|#
directive|include
file|<netatm/uni/unisig_var.h>
end_include

begin_include
include|#
directive|include
file|<errno.h>
end_include

begin_include
include|#
directive|include
file|<libatm.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|"atm.h"
end_include

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_expr_stmt
name|__RCSID
argument_list|(
literal|"@(#) $FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_define
define|#
directive|define
name|ARP_HDR
define|\
value|"Net Intf  Flags  Age  Origin\n"
end_define

begin_define
define|#
directive|define
name|ASRV_HDR
define|\
value|"Net Intf  State     ATM Address\n"
end_define

begin_define
define|#
directive|define
name|CFG_HDR
define|\
value|"Intf      Vendor    Model     Media           Bus   Serial No\n"
end_define

begin_define
define|#
directive|define
name|IP_VCC_HDR
define|\
value|"Net Intf  VPI   VCI  State   Flags IP Address\n"
end_define

begin_define
define|#
directive|define
name|INTF_HDR
define|\
value|"Interface  Sigmgr   State\n"
end_define

begin_define
define|#
directive|define
name|NETIF_HDR
define|\
value|"Net Intf  Phy Intf  IP Address\n"
end_define

begin_define
define|#
directive|define
name|VCC_HDR
define|\
value|"Interface  VPI   VCI  AAL   Type Dir    State    Encaps   Owner\n"
end_define

begin_define
define|#
directive|define
name|VCC_STATS_HDR
define|\
value|"                        Input    Input  Input  Output   Output Output\n\ Interface  VPI   VCI     PDUs    Bytes   Errs    PDUs    Bytes   Errs\n"
end_define

begin_define
define|#
directive|define
name|VERSION_HDR
define|\
value|"Version\n"
end_define

begin_define
define|#
directive|define
name|PHY_STATS_HDR
define|\
value|"             Input    Input  Input  Output   Output Output    Cmd\n\ Interface     PDUs    Bytes   Errs    PDUs    Bytes   Errs   Errs\n"
end_define

begin_comment
comment|/*  * External references  */
end_comment

begin_decl_stmt
specifier|extern
name|struct
name|proto
name|protos
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|struct
name|aal
name|aals
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|struct
name|encaps
name|encaps
index|[]
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Local variables  */
end_comment

begin_decl_stmt
specifier|static
name|int
name|arp_hdr
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|asrv_hdr
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|cfg_hdr
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|ip_vcc_hdr
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|netif_hdr
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|vcc_hdr
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|vcc_stats_hdr
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|phy_stats_hdr
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|version_hdr
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * SIGPVC state definitions  */
end_comment

begin_decl_stmt
name|struct
name|state
name|sigpvc_states
index|[]
init|=
block|{
block|{
literal|"ACTIVE"
block|,
name|SIGPVC_ACTIVE
block|}
block|,
block|{
literal|"DETACH"
block|,
name|SIGPVC_DETACH
block|}
block|,
block|{
literal|0
block|,
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * SPANS state definitions  */
end_comment

begin_decl_stmt
name|struct
name|state
name|spans_states
index|[]
init|=
block|{
block|{
literal|"ACTIVE"
block|,
name|SPANS_ACTIVE
block|}
block|,
block|{
literal|"DETACH"
block|,
name|SPANS_DETACH
block|}
block|,
block|{
literal|"INIT"
block|,
name|SPANS_INIT
block|}
block|,
block|{
literal|"PROBE"
block|,
name|SPANS_PROBE
block|}
block|,
block|{
literal|0
block|,
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * UNISIG state definitions  */
end_comment

begin_decl_stmt
name|struct
name|state
name|unisig_states
index|[]
init|=
block|{
block|{
literal|"NULL"
block|,
name|UNISIG_NULL
block|}
block|,
block|{
literal|"ADR_WAIT"
block|,
name|UNISIG_ADDR_WAIT
block|}
block|,
block|{
literal|"INIT"
block|,
name|UNISIG_INIT
block|}
block|,
block|{
literal|"ACTIVE"
block|,
name|UNISIG_ACTIVE
block|}
block|,
block|{
literal|"DETACH"
block|,
name|UNISIG_DETACH
block|}
block|,
block|{
literal|0
block|,
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * SIGPVC VCC state definitions  */
end_comment

begin_decl_stmt
name|struct
name|state
name|sigpvc_vcc_states
index|[]
init|=
block|{
block|{
literal|"NULL"
block|,
name|VCCS_NULL
block|}
block|,
block|{
literal|"ACTIVE"
block|,
name|VCCS_ACTIVE
block|}
block|,
block|{
literal|"FREE"
block|,
name|VCCS_FREE
block|}
block|,
block|{
literal|0
block|,
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * SPANS VCC state definitions  */
end_comment

begin_decl_stmt
name|struct
name|state
name|spans_vcc_states
index|[]
init|=
block|{
block|{
literal|"NULL"
block|,
name|SPANS_VC_NULL
block|}
block|,
block|{
literal|"ACTIVE"
block|,
name|SPANS_VC_ACTIVE
block|}
block|,
block|{
literal|"ACT_DOWN"
block|,
name|SPANS_VC_ACT_DOWN
block|}
block|,
block|{
literal|"POPEN"
block|,
name|SPANS_VC_POPEN
block|}
block|,
block|{
literal|"R_POPEN"
block|,
name|SPANS_VC_R_POPEN
block|}
block|,
block|{
literal|"OPEN"
block|,
name|SPANS_VC_OPEN
block|}
block|,
block|{
literal|"CLOSE"
block|,
name|SPANS_VC_CLOSE
block|}
block|,
block|{
literal|"ABORT"
block|,
name|SPANS_VC_ABORT
block|}
block|,
block|{
literal|"FREE"
block|,
name|SPANS_VC_FREE
block|}
block|,
block|{
literal|0
block|,
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * UNISIG VCC state definitions  */
end_comment

begin_decl_stmt
name|struct
name|state
name|unisig_vcc_states
index|[]
init|=
block|{
block|{
literal|"NULL"
block|,
name|UNI_NULL
block|}
block|,
block|{
literal|"C_INIT"
block|,
name|UNI_CALL_INITIATED
block|}
block|,
block|{
literal|"C_OUT_PR"
block|,
name|UNI_CALL_OUT_PROC
block|}
block|,
block|{
literal|"C_DELIV"
block|,
name|UNI_CALL_DELIVERED
block|}
block|,
block|{
literal|"C_PRES"
block|,
name|UNI_CALL_PRESENT
block|}
block|,
block|{
literal|"C_REC"
block|,
name|UNI_CALL_RECEIVED
block|}
block|,
block|{
literal|"CONN_REQ"
block|,
name|UNI_CONNECT_REQUEST
block|}
block|,
block|{
literal|"C_IN_PR"
block|,
name|UNI_CALL_IN_PROC
block|}
block|,
block|{
literal|"ACTIVE"
block|,
name|UNI_ACTIVE
block|}
block|,
block|{
literal|"REL_REQ"
block|,
name|UNI_RELEASE_REQUEST
block|}
block|,
block|{
literal|"REL_IND"
block|,
name|UNI_RELEASE_IND
block|}
block|,
block|{
literal|"SSCF_REC"
block|,
name|UNI_SSCF_RECOV
block|}
block|,
block|{
literal|"FREE"
block|,
name|UNI_FREE
block|}
block|,
block|{
literal|"ACTIVE"
block|,
name|UNI_PVC_ACTIVE
block|}
block|,
block|{
literal|"ACT_DOWN"
block|,
name|UNI_PVC_ACT_DOWN
block|}
block|,
block|{
literal|0
block|,
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * IP VCC state definitions  */
end_comment

begin_decl_stmt
name|struct
name|state
name|ip_vcc_states
index|[]
init|=
block|{
block|{
literal|"FREE"
block|,
name|IPVCC_FREE
block|}
block|,
block|{
literal|"PMAP"
block|,
name|IPVCC_PMAP
block|}
block|,
block|{
literal|"POPEN"
block|,
name|IPVCC_POPEN
block|}
block|,
block|{
literal|"PACCEPT"
block|,
name|IPVCC_PACCEPT
block|}
block|,
block|{
literal|"ACTPENT"
block|,
name|IPVCC_ACTPENT
block|}
block|,
block|{
literal|"ACTIVE"
block|,
name|IPVCC_ACTIVE
block|}
block|,
block|{
literal|"CLOSED"
block|,
name|IPVCC_CLOSED
block|}
block|,
block|{
literal|0
block|,
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * ARP server state definitions  */
end_comment

begin_decl_stmt
name|struct
name|state
name|arpserver_states
index|[]
init|=
block|{
block|{
literal|"NOT_CONF"
block|,
name|UIAS_NOTCONF
block|}
block|,
block|{
literal|"SERVER"
block|,
name|UIAS_SERVER_ACTIVE
block|}
block|,
block|{
literal|"PEND_ADR"
block|,
name|UIAS_CLIENT_PADDR
block|}
block|,
block|{
literal|"POPEN"
block|,
name|UIAS_CLIENT_POPEN
block|}
block|,
block|{
literal|"REGISTER"
block|,
name|UIAS_CLIENT_REGISTER
block|}
block|,
block|{
literal|"ACTIVE"
block|,
name|UIAS_CLIENT_ACTIVE
block|}
block|,
block|{
literal|0
block|,
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Supported signalling managers  */
end_comment

begin_decl_stmt
name|struct
name|proto_state
name|proto_states
index|[]
init|=
block|{
block|{
literal|"SIGPVC"
block|,
name|sigpvc_states
block|,
name|sigpvc_vcc_states
block|,
name|ATM_SIG_PVC
block|}
block|,
block|{
literal|"SPANS"
block|,
name|spans_states
block|,
name|spans_vcc_states
block|,
name|ATM_SIG_SPANS
block|}
block|,
block|{
literal|"UNI 3.0"
block|,
name|unisig_states
block|,
name|unisig_vcc_states
block|,
name|ATM_SIG_UNI30
block|}
block|,
block|{
literal|"UNI 3.1"
block|,
name|unisig_states
block|,
name|unisig_vcc_states
block|,
name|ATM_SIG_UNI31
block|}
block|,
block|{
literal|"UNI 4.0"
block|,
name|unisig_states
block|,
name|unisig_vcc_states
block|,
name|ATM_SIG_UNI40
block|}
block|,
block|{
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * ATMARP origin values  */
end_comment

begin_decl_stmt
name|struct
name|state
name|arp_origins
index|[]
init|=
block|{
block|{
literal|"LOCAL"
block|,
name|UAO_LOCAL
block|}
block|,
block|{
literal|"PERM"
block|,
name|UAO_PERM
block|}
block|,
block|{
literal|"REG"
block|,
name|UAO_REGISTER
block|}
block|,
block|{
literal|"SCSP"
block|,
name|UAO_SCSP
block|}
block|,
block|{
literal|"LOOKUP"
block|,
name|UAO_LOOKUP
block|}
block|,
block|{
literal|"PEER_RSP"
block|,
name|UAO_PEER_RSP
block|}
block|,
block|{
literal|"PEER_REQ"
block|,
name|UAO_PEER_REQ
block|}
block|,
block|{
literal|0
block|,
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Print ARP table information  *   * Arguments:  *	ai	pointer to a struct air_arp_rsp  *  * Returns:  *	none  *  */
end_comment

begin_function
name|void
name|print_arp_info
parameter_list|(
name|ai
parameter_list|)
name|struct
name|air_arp_rsp
modifier|*
name|ai
decl_stmt|;
block|{
name|int
name|i
decl_stmt|;
name|char
modifier|*
name|atm_addr
decl_stmt|,
modifier|*
name|ip_addr
decl_stmt|,
modifier|*
name|origin
decl_stmt|;
name|char
name|age
index|[
literal|8
index|]
decl_stmt|,
name|flags
index|[
literal|32
index|]
decl_stmt|;
name|struct
name|sockaddr_in
modifier|*
name|sin
decl_stmt|;
comment|/* 	 * Print a header if it hasn't been done yet. 	 */
if|if
condition|(
operator|!
name|arp_hdr
condition|)
block|{
name|printf
argument_list|(
name|ARP_HDR
argument_list|)
expr_stmt|;
name|arp_hdr
operator|=
literal|1
expr_stmt|;
block|}
comment|/* 	 * Format the addresses 	 */
name|atm_addr
operator|=
name|format_atm_addr
argument_list|(
operator|&
name|ai
operator|->
name|aap_addr
argument_list|)
expr_stmt|;
name|sin
operator|=
operator|(
expr|struct
name|sockaddr_in
operator|*
operator|)
operator|&
name|ai
operator|->
name|aap_arp_addr
expr_stmt|;
name|ip_addr
operator|=
name|format_ip_addr
argument_list|(
operator|&
name|sin
operator|->
name|sin_addr
argument_list|)
expr_stmt|;
comment|/* 	 * Decode the flags 	 */
name|UM_ZERO
argument_list|(
name|flags
argument_list|,
sizeof|sizeof
argument_list|(
name|flags
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|ai
operator|->
name|aap_flags
operator|&
name|ARPF_VALID
condition|)
block|{
name|strcat
argument_list|(
name|flags
argument_list|,
literal|"V"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|ai
operator|->
name|aap_flags
operator|&
name|ARPF_REFRESH
condition|)
block|{
name|strcat
argument_list|(
name|flags
argument_list|,
literal|"R"
argument_list|)
expr_stmt|;
block|}
comment|/* 	 * Format the origin 	 */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|arp_origins
index|[
name|i
index|]
operator|.
name|s_name
operator|!=
name|NULL
operator|&&
name|ai
operator|->
name|aap_origin
operator|!=
name|arp_origins
index|[
name|i
index|]
operator|.
name|s_id
condition|;
name|i
operator|++
control|)
empty_stmt|;
if|if
condition|(
name|arp_origins
index|[
name|i
index|]
operator|.
name|s_name
condition|)
block|{
name|origin
operator|=
name|arp_origins
index|[
name|i
index|]
operator|.
name|s_name
expr_stmt|;
block|}
else|else
block|{
name|origin
operator|=
literal|"-"
expr_stmt|;
block|}
comment|/* 	 * Format the age 	 */
name|UM_ZERO
argument_list|(
name|age
argument_list|,
sizeof|sizeof
argument_list|(
name|age
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|ai
operator|->
name|aap_flags
operator|&
name|ARPF_VALID
operator|)
condition|)
block|{
name|strcpy
argument_list|(
name|age
argument_list|,
literal|"-"
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|sprintf
argument_list|(
name|age
argument_list|,
literal|"%d"
argument_list|,
name|ai
operator|->
name|aap_age
argument_list|)
expr_stmt|;
block|}
comment|/* 	 * Print the ARP information 	 */
name|printf
argument_list|(
literal|"%-8s  %-5s  %3s  %s\n    ATM address = %s\n    IP address = %s\n"
argument_list|,
name|ai
operator|->
name|aap_intf
argument_list|,
name|flags
argument_list|,
name|age
argument_list|,
name|origin
argument_list|,
name|atm_addr
argument_list|,
name|ip_addr
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Print ARP server information  *   * Arguments:  *	si	pointer to a struct air_asrv_rsp  *  * Returns:  *	none  *  */
end_comment

begin_function
name|void
name|print_asrv_info
parameter_list|(
name|si
parameter_list|)
name|struct
name|air_asrv_rsp
modifier|*
name|si
decl_stmt|;
block|{
name|int
name|i
decl_stmt|;
name|char
modifier|*
name|atm_addr
decl_stmt|,
modifier|*
name|state
decl_stmt|;
name|struct
name|in_addr
modifier|*
name|addr
decl_stmt|;
comment|/* 	 * Print a header if it hasn't been done yet. 	 */
if|if
condition|(
operator|!
name|asrv_hdr
condition|)
block|{
name|printf
argument_list|(
name|ASRV_HDR
argument_list|)
expr_stmt|;
name|asrv_hdr
operator|=
literal|1
expr_stmt|;
block|}
comment|/* 	 * Format the ATM address of the ARP server 	 */
name|atm_addr
operator|=
name|format_atm_addr
argument_list|(
operator|&
name|si
operator|->
name|asp_addr
argument_list|)
expr_stmt|;
comment|/* 	 * Format the server state 	 */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|arpserver_states
index|[
name|i
index|]
operator|.
name|s_name
operator|!=
name|NULL
operator|&&
name|si
operator|->
name|asp_state
operator|!=
name|arpserver_states
index|[
name|i
index|]
operator|.
name|s_id
condition|;
name|i
operator|++
control|)
empty_stmt|;
if|if
condition|(
name|arpserver_states
index|[
name|i
index|]
operator|.
name|s_name
condition|)
block|{
name|state
operator|=
name|arpserver_states
index|[
name|i
index|]
operator|.
name|s_name
expr_stmt|;
block|}
else|else
block|{
name|state
operator|=
literal|"-"
expr_stmt|;
block|}
comment|/* 	 * Print the ARP server information 	 */
name|printf
argument_list|(
literal|"%-8s  %-8s  %s\n"
argument_list|,
name|si
operator|->
name|asp_intf
argument_list|,
name|state
argument_list|,
name|atm_addr
argument_list|)
expr_stmt|;
comment|/* 	 * Format and print the LIS prefixes 	 */
if|if
condition|(
name|si
operator|->
name|asp_nprefix
condition|)
block|{
name|addr
operator|=
operator|(
expr|struct
name|in_addr
operator|*
operator|)
operator|(
operator|(
name|u_long
operator|)
name|si
operator|+
sizeof|sizeof
argument_list|(
expr|struct
name|air_asrv_rsp
argument_list|)
operator|)
expr_stmt|;
name|printf
argument_list|(
literal|"    LIS = "
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|si
operator|->
name|asp_nprefix
condition|;
name|i
operator|++
control|)
block|{
name|printf
argument_list|(
literal|"%s"
argument_list|,
name|inet_ntoa
argument_list|(
operator|*
name|addr
argument_list|)
argument_list|)
expr_stmt|;
name|addr
operator|++
expr_stmt|;
name|printf
argument_list|(
literal|"/0x%0lx"
argument_list|,
name|ntohl
argument_list|(
name|addr
operator|->
name|s_addr
argument_list|)
argument_list|)
expr_stmt|;
name|addr
operator|++
expr_stmt|;
if|if
condition|(
name|i
operator|<
name|si
operator|->
name|asp_nprefix
operator|-
literal|1
condition|)
name|printf
argument_list|(
literal|", "
argument_list|)
expr_stmt|;
block|}
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*  * Print adapter configuration information  *   * Arguments:  *	si	pointer to a struct air_cfg_rsp  *  * Returns:  *	none  *  */
end_comment

begin_function
name|void
name|print_cfg_info
parameter_list|(
name|si
parameter_list|)
name|struct
name|air_cfg_rsp
modifier|*
name|si
decl_stmt|;
block|{
name|char
modifier|*
name|adapter
decl_stmt|,
modifier|*
name|bus
decl_stmt|,
modifier|*
name|media
decl_stmt|,
modifier|*
name|vendor
decl_stmt|;
comment|/* 	 * Print a header if it hasn't been done yet. 	 */
if|if
condition|(
operator|!
name|cfg_hdr
condition|)
block|{
name|printf
argument_list|(
name|CFG_HDR
argument_list|)
expr_stmt|;
name|cfg_hdr
operator|=
literal|1
expr_stmt|;
block|}
comment|/* 	 * Format the vendor name and adapter type 	 */
name|vendor
operator|=
name|get_vendor
argument_list|(
name|si
operator|->
name|acp_vendor
argument_list|)
expr_stmt|;
name|adapter
operator|=
name|get_adapter
argument_list|(
name|si
operator|->
name|acp_device
argument_list|)
expr_stmt|;
comment|/* 	 * Format the communications medium 	 */
name|media
operator|=
name|get_media_type
argument_list|(
name|si
operator|->
name|acp_media
argument_list|)
expr_stmt|;
name|bus
operator|=
name|get_bus_type
argument_list|(
name|si
operator|->
name|acp_bustype
argument_list|)
expr_stmt|;
comment|/* 	 * Print the ARP server information 	 */
name|printf
argument_list|(
literal|"%-8s  %-8s  %-8s  %-14s  %-4s  %ld\n"
argument_list|,
name|si
operator|->
name|acp_intf
argument_list|,
name|vendor
argument_list|,
name|adapter
argument_list|,
name|media
argument_list|,
name|bus
argument_list|,
name|si
operator|->
name|acp_serial
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"    MAC address = %s\n"
argument_list|,
name|format_mac_addr
argument_list|(
operator|&
name|si
operator|->
name|acp_macaddr
argument_list|)
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"    Hardware version = %s\n"
argument_list|,
name|si
operator|->
name|acp_hard_vers
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"    Firmware version = %s\n"
argument_list|,
name|si
operator|->
name|acp_firm_vers
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Print interface information  *   * Arguments:  *	ni	pointer to a struct air_int_rsp  *  * Returns:  *	none  *  */
end_comment

begin_function
name|void
name|print_intf_info
parameter_list|(
name|ni
parameter_list|)
name|struct
name|air_int_rsp
modifier|*
name|ni
decl_stmt|;
block|{
name|int
name|i
decl_stmt|;
name|char
name|nif_names
index|[
operator|(
name|IFNAMSIZ
operator|*
literal|2
operator|)
operator|+
literal|4
index|]
decl_stmt|;
name|char
modifier|*
name|atm_addr
decl_stmt|;
name|char
modifier|*
name|sigmgr
init|=
literal|"-"
decl_stmt|,
modifier|*
name|state_name
init|=
literal|"-"
decl_stmt|;
name|struct
name|state
modifier|*
name|s_t
decl_stmt|;
comment|/* 	 * Print a header 	 */
name|printf
argument_list|(
name|INTF_HDR
argument_list|)
expr_stmt|;
comment|/* 	 * Translate signalling manager name 	 */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|proto_states
index|[
name|i
index|]
operator|.
name|p_state
operator|!=
name|NULL
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|ni
operator|->
name|anp_sig_proto
operator|==
name|proto_states
index|[
name|i
index|]
operator|.
name|p_id
condition|)
break|break;
if|if
condition|(
name|proto_states
index|[
name|i
index|]
operator|.
name|p_state
operator|!=
name|NULL
condition|)
name|sigmgr
operator|=
name|proto_states
index|[
name|i
index|]
operator|.
name|p_name
expr_stmt|;
comment|/* 	 * Get the signalling manager state 	 */
if|if
condition|(
name|proto_states
index|[
name|i
index|]
operator|.
name|p_state
operator|!=
name|NULL
condition|)
block|{
name|s_t
operator|=
name|proto_states
index|[
name|i
index|]
operator|.
name|p_state
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|s_t
index|[
name|i
index|]
operator|.
name|s_name
operator|!=
name|NULL
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|ni
operator|->
name|anp_sig_state
operator|==
name|s_t
index|[
name|i
index|]
operator|.
name|s_id
condition|)
break|break;
if|if
condition|(
name|s_t
index|[
name|i
index|]
operator|.
name|s_name
operator|!=
name|NULL
condition|)
name|state_name
operator|=
name|s_t
index|[
name|i
index|]
operator|.
name|s_name
expr_stmt|;
block|}
comment|/* 	 * Format the ATM address 	 */
name|atm_addr
operator|=
name|format_atm_addr
argument_list|(
operator|&
name|ni
operator|->
name|anp_addr
argument_list|)
expr_stmt|;
comment|/* 	 * Get the range of NIFs on the physical interface 	 */
name|UM_ZERO
argument_list|(
name|nif_names
argument_list|,
sizeof|sizeof
argument_list|(
name|nif_names
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|strlen
argument_list|(
name|ni
operator|->
name|anp_nif_pref
argument_list|)
operator|==
literal|0
condition|)
block|{
name|strcpy
argument_list|(
name|nif_names
argument_list|,
literal|"-"
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|strcpy
argument_list|(
name|nif_names
argument_list|,
name|ni
operator|->
name|anp_nif_pref
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|nif_names
argument_list|,
literal|"0"
argument_list|)
expr_stmt|;
if|if
condition|(
name|ni
operator|->
name|anp_nif_cnt
operator|>
literal|1
condition|)
block|{
name|strcat
argument_list|(
name|nif_names
argument_list|,
literal|" - "
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|nif_names
argument_list|,
name|ni
operator|->
name|anp_nif_pref
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
operator|&
name|nif_names
index|[
name|strlen
argument_list|(
name|nif_names
argument_list|)
index|]
argument_list|,
literal|"%d"
argument_list|,
name|ni
operator|->
name|anp_nif_cnt
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
block|}
comment|/* 	 * Print the interface information 	 */
name|printf
argument_list|(
literal|"%-9s  %-7s  %s\n"
argument_list|,
name|ni
operator|->
name|anp_intf
argument_list|,
name|sigmgr
argument_list|,
name|state_name
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"    ATM address = %s\n"
argument_list|,
name|atm_addr
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"    Network interfaces: %s\n"
argument_list|,
name|nif_names
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Print IP address map information  *   * Arguments:  *	ai	pointer to a struct air_arp_rsp  *  * Returns:  *	none  *  */
end_comment

begin_function
name|void
name|print_ip_vcc_info
parameter_list|(
name|ai
parameter_list|)
name|struct
name|air_ip_vcc_rsp
modifier|*
name|ai
decl_stmt|;
block|{
name|int
name|i
decl_stmt|;
name|char
modifier|*
name|ip_addr
decl_stmt|,
modifier|*
name|state
decl_stmt|;
name|char
name|flags
index|[
literal|32
index|]
decl_stmt|,
name|vpi_vci
index|[
literal|16
index|]
decl_stmt|;
name|struct
name|sockaddr_in
modifier|*
name|sin
decl_stmt|;
comment|/* 	 * Print a header if it hasn't been done yet. 	 */
if|if
condition|(
operator|!
name|ip_vcc_hdr
condition|)
block|{
name|printf
argument_list|(
name|IP_VCC_HDR
argument_list|)
expr_stmt|;
name|ip_vcc_hdr
operator|=
literal|1
expr_stmt|;
block|}
comment|/* 	 * Format the IP address 	 */
name|sin
operator|=
operator|(
expr|struct
name|sockaddr_in
operator|*
operator|)
operator|&
name|ai
operator|->
name|aip_dst_addr
expr_stmt|;
name|ip_addr
operator|=
name|format_ip_addr
argument_list|(
operator|&
name|sin
operator|->
name|sin_addr
argument_list|)
expr_stmt|;
comment|/* 	 * Format the VPI/VCI 	 */
if|if
condition|(
name|ai
operator|->
name|aip_vpi
operator|==
literal|0
operator|&&
name|ai
operator|->
name|aip_vci
operator|==
literal|0
condition|)
block|{
name|strcpy
argument_list|(
name|vpi_vci
argument_list|,
literal|"  -     -"
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|sprintf
argument_list|(
name|vpi_vci
argument_list|,
literal|"%3d %5d"
argument_list|,
name|ai
operator|->
name|aip_vpi
argument_list|,
name|ai
operator|->
name|aip_vci
argument_list|)
expr_stmt|;
block|}
comment|/* 	 * Decode VCC flags 	 */
name|UM_ZERO
argument_list|(
name|flags
argument_list|,
sizeof|sizeof
argument_list|(
name|flags
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|ai
operator|->
name|aip_flags
operator|&
name|IVF_PVC
condition|)
block|{
name|strcat
argument_list|(
name|flags
argument_list|,
literal|"P"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|ai
operator|->
name|aip_flags
operator|&
name|IVF_SVC
condition|)
block|{
name|strcat
argument_list|(
name|flags
argument_list|,
literal|"S"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|ai
operator|->
name|aip_flags
operator|&
name|IVF_LLC
condition|)
block|{
name|strcat
argument_list|(
name|flags
argument_list|,
literal|"L"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|ai
operator|->
name|aip_flags
operator|&
name|IVF_MAPOK
condition|)
block|{
name|strcat
argument_list|(
name|flags
argument_list|,
literal|"M"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|ai
operator|->
name|aip_flags
operator|&
name|IVF_NOIDLE
condition|)
block|{
name|strcat
argument_list|(
name|flags
argument_list|,
literal|"N"
argument_list|)
expr_stmt|;
block|}
comment|/* 	 * Get the state of the VCC 	 */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|ip_vcc_states
index|[
name|i
index|]
operator|.
name|s_name
operator|!=
name|NULL
operator|&&
name|ai
operator|->
name|aip_state
operator|!=
name|ip_vcc_states
index|[
name|i
index|]
operator|.
name|s_id
condition|;
name|i
operator|++
control|)
empty_stmt|;
if|if
condition|(
name|ip_vcc_states
index|[
name|i
index|]
operator|.
name|s_name
condition|)
block|{
name|state
operator|=
name|ip_vcc_states
index|[
name|i
index|]
operator|.
name|s_name
expr_stmt|;
block|}
else|else
block|{
name|state
operator|=
literal|"-"
expr_stmt|;
block|}
comment|/* 	 * Print the IP VCC information 	 */
name|printf
argument_list|(
literal|"%-8s  %9s  %-7s %-5s %s\n"
argument_list|,
name|ai
operator|->
name|aip_intf
argument_list|,
name|vpi_vci
argument_list|,
name|state
argument_list|,
name|flags
argument_list|,
name|ip_addr
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Print network interface information  *   * Arguments:  *	ni	pointer to a struct air_int_rsp  *  * Returns:  *	none  *  */
end_comment

begin_function
name|void
name|print_netif_info
parameter_list|(
name|ni
parameter_list|)
name|struct
name|air_netif_rsp
modifier|*
name|ni
decl_stmt|;
block|{
name|char
modifier|*
name|ip_addr
decl_stmt|;
name|struct
name|sockaddr_in
modifier|*
name|sin
decl_stmt|;
comment|/* 	 * Print a header 	 */
if|if
condition|(
operator|!
name|netif_hdr
condition|)
block|{
name|netif_hdr
operator|++
expr_stmt|;
name|printf
argument_list|(
name|NETIF_HDR
argument_list|)
expr_stmt|;
block|}
comment|/* 	 * Format the protocol address 	 */
name|sin
operator|=
operator|(
expr|struct
name|sockaddr_in
operator|*
operator|)
operator|&
name|ni
operator|->
name|anp_proto_addr
expr_stmt|;
name|ip_addr
operator|=
name|format_ip_addr
argument_list|(
operator|&
name|sin
operator|->
name|sin_addr
argument_list|)
expr_stmt|;
comment|/* 	 * Print the network interface information 	 */
name|printf
argument_list|(
literal|"%-8s  %-8s  %s\n"
argument_list|,
name|ni
operator|->
name|anp_intf
argument_list|,
name|ni
operator|->
name|anp_phy_intf
argument_list|,
name|ip_addr
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Print physical interface statistics  *   * Arguments:  *	pi	pointer to a struct air_phy_stat_rsp  *  * Returns:  *	none  *  */
end_comment

begin_function
name|void
name|print_intf_stats
parameter_list|(
name|pi
parameter_list|)
name|struct
name|air_phy_stat_rsp
modifier|*
name|pi
decl_stmt|;
block|{
comment|/* 	 * Print a header if it hasn't already been done 	 */
if|if
condition|(
operator|!
name|phy_stats_hdr
condition|)
block|{
name|printf
argument_list|(
name|PHY_STATS_HDR
argument_list|)
expr_stmt|;
name|phy_stats_hdr
operator|=
literal|1
expr_stmt|;
block|}
comment|/* 	 * Print the interface statistics 	 */
name|printf
argument_list|(
literal|"%-9s  %7ld %8ld  %5ld %7ld %8ld  %5ld  %5ld\n"
argument_list|,
name|pi
operator|->
name|app_intf
argument_list|,
name|pi
operator|->
name|app_ipdus
argument_list|,
name|pi
operator|->
name|app_ibytes
argument_list|,
name|pi
operator|->
name|app_ierrors
argument_list|,
name|pi
operator|->
name|app_opdus
argument_list|,
name|pi
operator|->
name|app_obytes
argument_list|,
name|pi
operator|->
name|app_oerrors
argument_list|,
name|pi
operator|->
name|app_cmderrors
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Print VCC statistics  *   * Arguments:  *	vi	pointer to VCC statistics to print  *  * Returns:  *	none  *  */
end_comment

begin_function
name|void
name|print_vcc_stats
parameter_list|(
name|vi
parameter_list|)
name|struct
name|air_vcc_rsp
modifier|*
name|vi
decl_stmt|;
block|{
comment|/* 	 * Print a header if it hasn't already been done 	 */
if|if
condition|(
operator|!
name|vcc_stats_hdr
condition|)
block|{
name|printf
argument_list|(
name|VCC_STATS_HDR
argument_list|)
expr_stmt|;
name|vcc_stats_hdr
operator|=
literal|1
expr_stmt|;
block|}
comment|/* 	 * Print the VCC statistics 	 */
name|printf
argument_list|(
literal|"%-9s  %3d  %4d"
argument_list|,
name|vi
operator|->
name|avp_intf
argument_list|,
name|vi
operator|->
name|avp_vpi
argument_list|,
name|vi
operator|->
name|avp_vci
argument_list|)
expr_stmt|;
if|if
condition|(
name|vi
operator|->
name|avp_type
operator|&
name|VCC_IN
condition|)
name|printf
argument_list|(
literal|"  %7ld %8ld  %5ld"
argument_list|,
name|vi
operator|->
name|avp_ipdus
argument_list|,
name|vi
operator|->
name|avp_ibytes
argument_list|,
name|vi
operator|->
name|avp_ierrors
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"        -        -      -"
argument_list|)
expr_stmt|;
if|if
condition|(
name|vi
operator|->
name|avp_type
operator|&
name|VCC_OUT
condition|)
name|printf
argument_list|(
literal|" %7ld %8ld  %5ld\n"
argument_list|,
name|vi
operator|->
name|avp_opdus
argument_list|,
name|vi
operator|->
name|avp_obytes
argument_list|,
name|vi
operator|->
name|avp_oerrors
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"       -        -      -\n"
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Print VCC information  *   * Arguments:  *	vi	pointer to a struct air_vcc_rsp  *  * Returns:  *	none  *  */
end_comment

begin_function
name|void
name|print_vcc_info
parameter_list|(
name|vi
parameter_list|)
name|struct
name|air_vcc_rsp
modifier|*
name|vi
decl_stmt|;
block|{
name|int
name|i
decl_stmt|;
name|char
modifier|*
name|aal_name
init|=
literal|"-"
decl_stmt|,
modifier|*
name|encaps_name
init|=
literal|"-"
decl_stmt|,
modifier|*
name|owner_name
init|=
literal|"-"
decl_stmt|;
name|char
modifier|*
name|state_name
init|=
literal|"-"
decl_stmt|,
modifier|*
name|type_name
init|=
literal|"-"
decl_stmt|;
name|char
name|dir_name
index|[
literal|10
index|]
decl_stmt|;
name|struct
name|state
modifier|*
name|s_t
decl_stmt|;
comment|/* 	 * Print a header if it hasn't already been done 	 */
if|if
condition|(
operator|!
name|vcc_hdr
condition|)
block|{
name|printf
argument_list|(
name|VCC_HDR
argument_list|)
expr_stmt|;
name|vcc_hdr
operator|=
literal|1
expr_stmt|;
block|}
comment|/* 	 * Translate AAL 	 */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|aals
index|[
name|i
index|]
operator|.
name|a_name
operator|!=
name|NULL
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|vi
operator|->
name|avp_aal
operator|==
name|aals
index|[
name|i
index|]
operator|.
name|a_id
condition|)
break|break;
if|if
condition|(
name|aals
index|[
name|i
index|]
operator|.
name|a_name
condition|)
name|aal_name
operator|=
name|aals
index|[
name|i
index|]
operator|.
name|a_name
expr_stmt|;
comment|/* 	 * Translate VCC type 	 */
if|if
condition|(
name|vi
operator|->
name|avp_type
operator|&
name|VCC_PVC
condition|)
name|type_name
operator|=
literal|"PVC"
expr_stmt|;
elseif|else
if|if
condition|(
name|vi
operator|->
name|avp_type
operator|&
name|VCC_SVC
condition|)
name|type_name
operator|=
literal|"SVC"
expr_stmt|;
comment|/* 	 * Translate VCC direction 	 */
name|UM_ZERO
argument_list|(
name|dir_name
argument_list|,
sizeof|sizeof
argument_list|(
name|dir_name
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|vi
operator|->
name|avp_type
operator|&
name|VCC_IN
condition|)
name|strcat
argument_list|(
name|dir_name
argument_list|,
literal|"In"
argument_list|)
expr_stmt|;
if|if
condition|(
name|vi
operator|->
name|avp_type
operator|&
name|VCC_OUT
condition|)
name|strcat
argument_list|(
name|dir_name
argument_list|,
literal|"Out"
argument_list|)
expr_stmt|;
if|if
condition|(
name|strlen
argument_list|(
name|dir_name
argument_list|)
operator|==
literal|0
condition|)
name|strcpy
argument_list|(
name|dir_name
argument_list|,
literal|"-"
argument_list|)
expr_stmt|;
comment|/* 	 * Translate state 	 */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|proto_states
index|[
name|i
index|]
operator|.
name|p_state
operator|!=
name|NULL
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|vi
operator|->
name|avp_sig_proto
operator|==
name|proto_states
index|[
name|i
index|]
operator|.
name|p_id
condition|)
break|break;
if|if
condition|(
name|proto_states
index|[
name|i
index|]
operator|.
name|p_state
condition|)
block|{
name|s_t
operator|=
name|proto_states
index|[
name|i
index|]
operator|.
name|v_state
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|s_t
index|[
name|i
index|]
operator|.
name|s_name
operator|!=
name|NULL
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|vi
operator|->
name|avp_state
operator|==
name|s_t
index|[
name|i
index|]
operator|.
name|s_id
condition|)
break|break;
if|if
condition|(
name|s_t
index|[
name|i
index|]
operator|.
name|s_name
condition|)
name|state_name
operator|=
name|s_t
index|[
name|i
index|]
operator|.
name|s_name
expr_stmt|;
block|}
comment|/* 	 * Translate encapsulation 	 */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|encaps
index|[
name|i
index|]
operator|.
name|e_name
operator|!=
name|NULL
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|vi
operator|->
name|avp_encaps
operator|==
name|encaps
index|[
name|i
index|]
operator|.
name|e_id
condition|)
break|break;
if|if
condition|(
name|encaps
index|[
name|i
index|]
operator|.
name|e_name
condition|)
name|encaps_name
operator|=
name|encaps
index|[
name|i
index|]
operator|.
name|e_name
expr_stmt|;
comment|/* 	 * Print the VCC information 	 */
name|printf
argument_list|(
literal|"%-9s  %3d %5d  %-4s  %-4s %-5s  %-8s %-8s "
argument_list|,
name|vi
operator|->
name|avp_intf
argument_list|,
name|vi
operator|->
name|avp_vpi
argument_list|,
name|vi
operator|->
name|avp_vci
argument_list|,
name|aal_name
argument_list|,
name|type_name
argument_list|,
name|dir_name
argument_list|,
name|state_name
argument_list|,
name|encaps_name
argument_list|)
expr_stmt|;
comment|/* 	 * Print VCC owners' names 	 */
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|owner_name
operator|=
name|vi
operator|->
name|avp_owners
init|;
name|i
operator|<
name|O_CNT
operator|-
literal|1
operator|&&
name|strlen
argument_list|(
name|owner_name
argument_list|)
condition|;
name|i
operator|++
operator|,
name|owner_name
operator|+=
operator|(
name|T_ATM_APP_NAME_LEN
operator|+
literal|1
operator|)
control|)
block|{
if|if
condition|(
name|i
operator|>
literal|0
condition|)
name|printf
argument_list|(
literal|", "
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"%s"
argument_list|,
name|owner_name
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|i
operator|==
literal|0
condition|)
name|printf
argument_list|(
literal|"-"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
comment|/* 	 * Print destination address if it's an SVC 	 */
if|if
condition|(
name|vi
operator|->
name|avp_type
operator|&
name|VCC_SVC
condition|)
block|{
name|printf
argument_list|(
literal|"    Dest = %s\n"
argument_list|,
name|format_atm_addr
argument_list|(
operator|&
name|vi
operator|->
name|avp_daddr
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*  * Print network interface information  *   * Arguments:  *	ni	pointer to a struct air_int_rsp  *  * Returns:  *	none  *  */
end_comment

begin_function
name|void
name|print_version_info
parameter_list|(
name|vi
parameter_list|)
name|struct
name|air_version_rsp
modifier|*
name|vi
decl_stmt|;
block|{
name|char
name|version_str
index|[
literal|80
index|]
decl_stmt|;
comment|/* 	 * Print a header 	 */
if|if
condition|(
operator|!
name|version_hdr
condition|)
block|{
name|version_hdr
operator|++
expr_stmt|;
name|printf
argument_list|(
name|VERSION_HDR
argument_list|)
expr_stmt|;
block|}
comment|/* 	 * Print the interface information 	 */
name|sprintf
argument_list|(
name|version_str
argument_list|,
literal|"%d.%d"
argument_list|,
name|ATM_VERS_MAJ
argument_list|(
name|vi
operator|->
name|avp_version
argument_list|)
argument_list|,
name|ATM_VERS_MIN
argument_list|(
name|vi
operator|->
name|avp_version
argument_list|)
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"%7s\n"
argument_list|,
name|version_str
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

