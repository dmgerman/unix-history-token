begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*	$OpenBSD: dhcpd.h,v 1.33 2004/05/06 22:29:15 deraadt Exp $	*/
end_comment

begin_comment
comment|/*  * Copyright (c) 2004 Henning Brauer<henning@openbsd.org>  * Copyright (c) 1995, 1996, 1997, 1998, 1999  * The Internet Software Consortium.    All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  *  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  * 3. Neither the name of The Internet Software Consortium nor the names  *    of its contributors may be used to endorse or promote products derived  *    from this software without specific prior written permission.  *  * THIS SOFTWARE IS PROVIDED BY THE INTERNET SOFTWARE CONSORTIUM AND  * CONTRIBUTORS ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES,  * INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF  * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE  * DISCLAIMED.  IN NO EVENT SHALL THE INTERNET SOFTWARE CONSORTIUM OR  * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,  * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT  * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF  * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND  * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,  * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT  * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  *  * This software has been written for the Internet Software Consortium  * by Ted Lemon<mellon@fugue.com> in cooperation with Vixie  * Enterprises.  To learn more about the Internet Software Consortium,  * see ``http://www.vix.com/isc''.  To learn more about Vixie  * Enterprises, see ``http://www.vix.com''.  *  * $FreeBSD$  */
end_comment

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|<sys/socket.h>
end_include

begin_include
include|#
directive|include
file|<sys/sockio.h>
end_include

begin_include
include|#
directive|include
file|<sys/stat.h>
end_include

begin_include
include|#
directive|include
file|<sys/time.h>
end_include

begin_include
include|#
directive|include
file|<sys/un.h>
end_include

begin_include
include|#
directive|include
file|<sys/wait.h>
end_include

begin_include
include|#
directive|include
file|<net/if.h>
end_include

begin_include
include|#
directive|include
file|<net/if_dl.h>
end_include

begin_include
include|#
directive|include
file|<net/route.h>
end_include

begin_include
include|#
directive|include
file|<netinet/in.h>
end_include

begin_include
include|#
directive|include
file|<arpa/inet.h>
end_include

begin_include
include|#
directive|include
file|<ctype.h>
end_include

begin_include
include|#
directive|include
file|<errno.h>
end_include

begin_include
include|#
directive|include
file|<fcntl.h>
end_include

begin_include
include|#
directive|include
file|<limits.h>
end_include

begin_include
include|#
directive|include
file|<netdb.h>
end_include

begin_include
include|#
directive|include
file|<paths.h>
end_include

begin_include
include|#
directive|include
file|<unistd.h>
end_include

begin_include
include|#
directive|include
file|<stdarg.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<syslog.h>
end_include

begin_include
include|#
directive|include
file|<time.h>
end_include

begin_include
include|#
directive|include
file|<unistd.h>
end_include

begin_include
include|#
directive|include
file|"dhcp.h"
end_include

begin_include
include|#
directive|include
file|"tree.h"
end_include

begin_define
define|#
directive|define
name|LOCAL_PORT
value|68
end_define

begin_define
define|#
directive|define
name|REMOTE_PORT
value|67
end_define

begin_struct
struct|struct
name|option_data
block|{
name|int
name|len
decl_stmt|;
name|u_int8_t
modifier|*
name|data
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|string_list
block|{
name|struct
name|string_list
modifier|*
name|next
decl_stmt|;
name|char
modifier|*
name|string
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|iaddr
block|{
name|int
name|len
decl_stmt|;
name|unsigned
name|char
name|iabuf
index|[
literal|16
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|iaddrlist
block|{
name|struct
name|iaddrlist
modifier|*
name|next
decl_stmt|;
name|struct
name|iaddr
name|addr
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|packet
block|{
name|struct
name|dhcp_packet
modifier|*
name|raw
decl_stmt|;
name|int
name|packet_length
decl_stmt|;
name|int
name|packet_type
decl_stmt|;
name|int
name|options_valid
decl_stmt|;
name|int
name|client_port
decl_stmt|;
name|struct
name|iaddr
name|client_addr
decl_stmt|;
name|struct
name|interface_info
modifier|*
name|interface
decl_stmt|;
name|struct
name|hardware
modifier|*
name|haddr
decl_stmt|;
name|struct
name|option_data
name|options
index|[
literal|256
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|hardware
block|{
name|u_int8_t
name|htype
decl_stmt|;
name|u_int8_t
name|hlen
decl_stmt|;
name|u_int8_t
name|haddr
index|[
literal|16
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|client_lease
block|{
name|struct
name|client_lease
modifier|*
name|next
decl_stmt|;
name|time_t
name|expiry
decl_stmt|,
name|renewal
decl_stmt|,
name|rebind
decl_stmt|;
name|struct
name|iaddr
name|address
decl_stmt|;
name|char
modifier|*
name|server_name
decl_stmt|;
name|char
modifier|*
name|filename
decl_stmt|;
name|struct
name|string_list
modifier|*
name|medium
decl_stmt|;
name|unsigned
name|int
name|is_static
range|:
literal|1
decl_stmt|;
name|unsigned
name|int
name|is_bootp
range|:
literal|1
decl_stmt|;
name|struct
name|option_data
name|options
index|[
literal|256
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/* Possible states in which the client can be. */
end_comment

begin_enum
enum|enum
name|dhcp_state
block|{
name|S_REBOOTING
block|,
name|S_INIT
block|,
name|S_SELECTING
block|,
name|S_REQUESTING
block|,
name|S_BOUND
block|,
name|S_RENEWING
block|,
name|S_REBINDING
block|}
enum|;
end_enum

begin_struct
struct|struct
name|client_config
block|{
name|struct
name|option_data
name|defaults
index|[
literal|256
index|]
decl_stmt|;
enum|enum
block|{
name|ACTION_DEFAULT
block|,
name|ACTION_SUPERSEDE
block|,
name|ACTION_PREPEND
block|,
name|ACTION_APPEND
block|}
name|default_actions
index|[
literal|256
index|]
enum|;
name|struct
name|option_data
name|send_options
index|[
literal|256
index|]
decl_stmt|;
name|u_int8_t
name|required_options
index|[
literal|256
index|]
decl_stmt|;
name|u_int8_t
name|requested_options
index|[
literal|256
index|]
decl_stmt|;
name|int
name|requested_option_count
decl_stmt|;
name|time_t
name|timeout
decl_stmt|;
name|time_t
name|initial_interval
decl_stmt|;
name|time_t
name|retry_interval
decl_stmt|;
name|time_t
name|select_interval
decl_stmt|;
name|time_t
name|reboot_timeout
decl_stmt|;
name|time_t
name|backoff_cutoff
decl_stmt|;
name|struct
name|string_list
modifier|*
name|media
decl_stmt|;
name|char
modifier|*
name|script_name
decl_stmt|;
enum|enum
block|{
name|IGNORE
block|,
name|ACCEPT
block|,
name|PREFER
block|}
name|bootp_policy
enum|;
name|struct
name|string_list
modifier|*
name|medium
decl_stmt|;
name|struct
name|iaddrlist
modifier|*
name|reject_list
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|client_state
block|{
name|struct
name|client_lease
modifier|*
name|active
decl_stmt|;
name|struct
name|client_lease
modifier|*
name|new
decl_stmt|;
name|struct
name|client_lease
modifier|*
name|offered_leases
decl_stmt|;
name|struct
name|client_lease
modifier|*
name|leases
decl_stmt|;
name|struct
name|client_lease
modifier|*
name|alias
decl_stmt|;
name|enum
name|dhcp_state
name|state
decl_stmt|;
name|struct
name|iaddr
name|destination
decl_stmt|;
name|u_int32_t
name|xid
decl_stmt|;
name|u_int16_t
name|secs
decl_stmt|;
name|time_t
name|first_sending
decl_stmt|;
name|time_t
name|interval
decl_stmt|;
name|struct
name|string_list
modifier|*
name|medium
decl_stmt|;
name|struct
name|dhcp_packet
name|packet
decl_stmt|;
name|int
name|packet_length
decl_stmt|;
name|struct
name|iaddr
name|requested_address
decl_stmt|;
name|struct
name|client_config
modifier|*
name|config
decl_stmt|;
name|char
modifier|*
modifier|*
name|scriptEnv
decl_stmt|;
name|int
name|scriptEnvsize
decl_stmt|;
name|struct
name|string_list
modifier|*
name|env
decl_stmt|;
name|int
name|envc
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|interface_info
block|{
name|struct
name|interface_info
modifier|*
name|next
decl_stmt|;
name|struct
name|hardware
name|hw_address
decl_stmt|;
name|struct
name|in_addr
name|primary_address
decl_stmt|;
name|char
name|name
index|[
name|IFNAMSIZ
index|]
decl_stmt|;
name|int
name|rfdesc
decl_stmt|;
name|int
name|wfdesc
decl_stmt|;
name|int
name|ufdesc
decl_stmt|;
name|unsigned
name|char
modifier|*
name|rbuf
decl_stmt|;
name|size_t
name|rbuf_max
decl_stmt|;
name|size_t
name|rbuf_offset
decl_stmt|;
name|size_t
name|rbuf_len
decl_stmt|;
name|struct
name|ifreq
modifier|*
name|ifp
decl_stmt|;
name|struct
name|client_state
modifier|*
name|client
decl_stmt|;
name|int
name|noifmedia
decl_stmt|;
name|int
name|errors
decl_stmt|;
name|int
name|dead
decl_stmt|;
name|u_int16_t
name|index
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|timeout
block|{
name|struct
name|timeout
modifier|*
name|next
decl_stmt|;
name|time_t
name|when
decl_stmt|;
name|void
function_decl|(
modifier|*
name|func
function_decl|)
parameter_list|(
name|void
modifier|*
parameter_list|)
function_decl|;
name|void
modifier|*
name|what
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|protocol
block|{
name|struct
name|protocol
modifier|*
name|next
decl_stmt|;
name|int
name|fd
decl_stmt|;
name|void
function_decl|(
modifier|*
name|handler
function_decl|)
parameter_list|(
name|struct
name|protocol
modifier|*
parameter_list|)
function_decl|;
name|void
modifier|*
name|local
decl_stmt|;
block|}
struct|;
end_struct

begin_define
define|#
directive|define
name|DEFAULT_HASH_SIZE
value|97
end_define

begin_struct
struct|struct
name|hash_bucket
block|{
name|struct
name|hash_bucket
modifier|*
name|next
decl_stmt|;
name|unsigned
name|char
modifier|*
name|name
decl_stmt|;
name|int
name|len
decl_stmt|;
name|unsigned
name|char
modifier|*
name|value
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|hash_table
block|{
name|int
name|hash_count
decl_stmt|;
name|struct
name|hash_bucket
modifier|*
name|buckets
index|[
name|DEFAULT_HASH_SIZE
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/* Default path to dhcpd config file. */
end_comment

begin_define
define|#
directive|define
name|_PATH_DHCLIENT_CONF
value|"/etc/dhclient.conf"
end_define

begin_define
define|#
directive|define
name|_PATH_DHCLIENT_DB
value|"/var/db/dhclient.leases"
end_define

begin_define
define|#
directive|define
name|DHCPD_LOG_FACILITY
value|LOG_DAEMON
end_define

begin_define
define|#
directive|define
name|MAX_TIME
value|0x7fffffff
end_define

begin_define
define|#
directive|define
name|MIN_TIME
value|0
end_define

begin_comment
comment|/* External definitions... */
end_comment

begin_comment
comment|/* options.c */
end_comment

begin_function_decl
name|int
name|cons_options
parameter_list|(
name|struct
name|packet
modifier|*
parameter_list|,
name|struct
name|dhcp_packet
modifier|*
parameter_list|,
name|int
parameter_list|,
name|struct
name|tree_cache
modifier|*
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|u_int8_t
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|char
modifier|*
name|pretty_print_option
parameter_list|(
name|unsigned
name|int
parameter_list|,
name|unsigned
name|char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|do_packet
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|,
name|struct
name|dhcp_packet
modifier|*
parameter_list|,
name|int
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|struct
name|iaddr
parameter_list|,
name|struct
name|hardware
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* errwarn.c */
end_comment

begin_decl_stmt
specifier|extern
name|int
name|warnings_occurred
decl_stmt|;
end_decl_stmt

begin_function_decl
name|void
name|error
parameter_list|(
name|char
modifier|*
parameter_list|,
modifier|...
parameter_list|)
function_decl|__attribute__
parameter_list|(
function_decl|(__format__
parameter_list|(
name|__printf__
parameter_list|,
function_decl|1
operator|,
function_decl|2
end_function_decl

begin_empty_stmt
unit|)))
empty_stmt|;
end_empty_stmt

begin_function_decl
name|int
name|warning
parameter_list|(
name|char
modifier|*
parameter_list|,
modifier|...
parameter_list|)
function_decl|__attribute__
parameter_list|(
function_decl|(__format__
parameter_list|(
name|__printf__
parameter_list|,
function_decl|1
operator|,
function_decl|2
end_function_decl

begin_empty_stmt
unit|)))
empty_stmt|;
end_empty_stmt

begin_function_decl
name|int
name|note
parameter_list|(
name|char
modifier|*
parameter_list|,
modifier|...
parameter_list|)
function_decl|__attribute__
parameter_list|(
function_decl|(__format__
parameter_list|(
name|__printf__
parameter_list|,
function_decl|1
operator|,
function_decl|2
end_function_decl

begin_empty_stmt
unit|)))
empty_stmt|;
end_empty_stmt

begin_function_decl
name|int
name|debug
parameter_list|(
name|char
modifier|*
parameter_list|,
modifier|...
parameter_list|)
function_decl|__attribute__
parameter_list|(
function_decl|(__format__
parameter_list|(
name|__printf__
parameter_list|,
function_decl|1
operator|,
function_decl|2
end_function_decl

begin_empty_stmt
unit|)))
empty_stmt|;
end_empty_stmt

begin_function_decl
name|int
name|parse_warn
parameter_list|(
name|char
modifier|*
parameter_list|,
modifier|...
parameter_list|)
function_decl|__attribute__
parameter_list|(
function_decl|(__format__
parameter_list|(
name|__printf__
parameter_list|,
function_decl|1
operator|,
function_decl|2
end_function_decl

begin_empty_stmt
unit|)))
empty_stmt|;
end_empty_stmt

begin_comment
comment|/* conflex.c */
end_comment

begin_decl_stmt
specifier|extern
name|int
name|lexline
decl_stmt|,
name|lexchar
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|char
modifier|*
name|token_line
decl_stmt|,
modifier|*
name|tlname
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|char
name|comments
index|[
literal|4096
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|comment_index
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|eol_token
decl_stmt|;
end_decl_stmt

begin_function_decl
name|void
name|new_parse
parameter_list|(
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|next_token
parameter_list|(
name|char
modifier|*
modifier|*
parameter_list|,
name|FILE
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|peek_token
parameter_list|(
name|char
modifier|*
modifier|*
parameter_list|,
name|FILE
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* parse.c */
end_comment

begin_function_decl
name|void
name|skip_to_semi
parameter_list|(
name|FILE
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|parse_semi
parameter_list|(
name|FILE
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|char
modifier|*
name|parse_string
parameter_list|(
name|FILE
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|parse_ip_addr
parameter_list|(
name|FILE
modifier|*
parameter_list|,
name|struct
name|iaddr
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|parse_hardware_param
parameter_list|(
name|FILE
modifier|*
parameter_list|,
name|struct
name|hardware
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|parse_lease_time
parameter_list|(
name|FILE
modifier|*
parameter_list|,
name|time_t
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|unsigned
name|char
modifier|*
name|parse_numeric_aggregate
parameter_list|(
name|FILE
modifier|*
parameter_list|,
name|unsigned
name|char
modifier|*
parameter_list|,
name|int
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|convert_num
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|,
name|char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|time_t
name|parse_date
parameter_list|(
name|FILE
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* tree.c */
end_comment

begin_function_decl
name|pair
name|cons
parameter_list|(
name|caddr_t
parameter_list|,
name|pair
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* alloc.c */
end_comment

begin_function_decl
name|struct
name|string_list
modifier|*
name|new_string_list
parameter_list|(
name|size_t
name|size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|hash_table
modifier|*
name|new_hash_table
parameter_list|(
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|hash_bucket
modifier|*
name|new_hash_bucket
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* bpf.c */
end_comment

begin_function_decl
name|int
name|if_register_bpf
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|if_register_send
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|if_register_receive
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ssize_t
name|send_packet
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|,
name|struct
name|dhcp_packet
modifier|*
parameter_list|,
name|size_t
parameter_list|,
name|struct
name|in_addr
parameter_list|,
name|struct
name|sockaddr_in
modifier|*
parameter_list|,
name|struct
name|hardware
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ssize_t
name|receive_packet
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|,
name|unsigned
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|,
name|struct
name|sockaddr_in
modifier|*
parameter_list|,
name|struct
name|hardware
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* dispatch.c */
end_comment

begin_function_decl
specifier|extern
name|void
function_decl|(
modifier|*
name|bootp_packet_handler
function_decl|)
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|,
name|struct
name|dhcp_packet
modifier|*
parameter_list|,
name|int
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|struct
name|iaddr
parameter_list|,
name|struct
name|hardware
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|discover_interfaces
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|reinitialize_interfaces
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|dispatch
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|got_one
parameter_list|(
name|struct
name|protocol
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|add_timeout
parameter_list|(
name|time_t
parameter_list|,
name|void
function_decl|(
modifier|*
function_decl|)
parameter_list|(
name|void
modifier|*
parameter_list|)
parameter_list|,
name|void
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|cancel_timeout
parameter_list|(
name|void
function_decl|(
modifier|*
function_decl|)
parameter_list|(
name|void
modifier|*
parameter_list|)
parameter_list|,
name|void
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|add_protocol
parameter_list|(
name|char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|void
function_decl|(
modifier|*
function_decl|)
parameter_list|(
name|struct
name|protocol
modifier|*
parameter_list|)
parameter_list|,
name|void
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|remove_protocol
parameter_list|(
name|struct
name|protocol
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|interface_link_status
parameter_list|(
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* hash.c */
end_comment

begin_function_decl
name|struct
name|hash_table
modifier|*
name|new_hash
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|add_hash
parameter_list|(
name|struct
name|hash_table
modifier|*
parameter_list|,
name|unsigned
name|char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|unsigned
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|unsigned
name|char
modifier|*
name|hash_lookup
parameter_list|(
name|struct
name|hash_table
modifier|*
parameter_list|,
name|unsigned
name|char
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* tables.c */
end_comment

begin_decl_stmt
specifier|extern
name|struct
name|option
name|dhcp_options
index|[
literal|256
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|unsigned
name|char
name|dhcp_option_default_priority_list
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|sizeof_dhcp_option_default_priority_list
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|struct
name|hash_table
name|universe_hash
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|struct
name|universe
name|dhcp_universe
decl_stmt|;
end_decl_stmt

begin_function_decl
name|void
name|initialize_universes
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* convert.c */
end_comment

begin_function_decl
name|u_int32_t
name|getULong
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int32_t
name|getLong
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|u_int16_t
name|getUShort
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int16_t
name|getShort
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|putULong
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|,
name|u_int32_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|putLong
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|,
name|int32_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|putUShort
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|putShort
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* inet.c */
end_comment

begin_function_decl
name|struct
name|iaddr
name|subnet_number
parameter_list|(
name|struct
name|iaddr
parameter_list|,
name|struct
name|iaddr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|iaddr
name|broadcast_addr
parameter_list|(
name|struct
name|iaddr
parameter_list|,
name|struct
name|iaddr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|addr_eq
parameter_list|(
name|struct
name|iaddr
parameter_list|,
name|struct
name|iaddr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|char
modifier|*
name|piaddr
parameter_list|(
name|struct
name|iaddr
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* dhclient.c */
end_comment

begin_decl_stmt
specifier|extern
name|char
modifier|*
name|path_dhclient_conf
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|char
modifier|*
name|path_dhclient_db
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|time_t
name|cur_time
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|log_priority
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|log_perror
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|struct
name|client_config
name|top_level_config
decl_stmt|;
end_decl_stmt

begin_function_decl
name|void
name|dhcpoffer
parameter_list|(
name|struct
name|packet
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|dhcpack
parameter_list|(
name|struct
name|packet
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|dhcpnak
parameter_list|(
name|struct
name|packet
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|send_discover
parameter_list|(
name|void
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|send_request
parameter_list|(
name|void
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|send_decline
parameter_list|(
name|void
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|state_reboot
parameter_list|(
name|void
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|state_init
parameter_list|(
name|void
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|state_selecting
parameter_list|(
name|void
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|state_requesting
parameter_list|(
name|void
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|state_bound
parameter_list|(
name|void
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|state_panic
parameter_list|(
name|void
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|bind_lease
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|make_discover
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|,
name|struct
name|client_lease
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|make_request
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|,
name|struct
name|client_lease
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|make_decline
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|,
name|struct
name|client_lease
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|free_client_lease
parameter_list|(
name|struct
name|client_lease
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|rewrite_client_leases
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|write_client_lease
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|,
name|struct
name|client_lease
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|priv_script_init
parameter_list|(
name|char
modifier|*
parameter_list|,
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|priv_script_write_params
parameter_list|(
name|char
modifier|*
parameter_list|,
name|struct
name|client_lease
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|priv_script_go
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|script_init
parameter_list|(
name|char
modifier|*
parameter_list|,
name|struct
name|string_list
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|script_write_params
parameter_list|(
name|char
modifier|*
parameter_list|,
name|struct
name|client_lease
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|script_go
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|client_envadd
parameter_list|(
name|struct
name|client_state
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
modifier|...
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|script_set_env
parameter_list|(
name|struct
name|client_state
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|script_flush_env
parameter_list|(
name|struct
name|client_state
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|dhcp_option_ev_name
parameter_list|(
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|,
name|struct
name|option
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|client_lease
modifier|*
name|packet_to_lease
parameter_list|(
name|struct
name|packet
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|go_daemon
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|client_location_changed
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|bootp
parameter_list|(
name|struct
name|packet
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|dhcp
parameter_list|(
name|struct
name|packet
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* packet.c */
end_comment

begin_function_decl
name|void
name|assemble_hw_header
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|,
name|unsigned
name|char
modifier|*
parameter_list|,
name|int
modifier|*
parameter_list|,
name|struct
name|hardware
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|assemble_udp_ip_header
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|,
name|int
modifier|*
parameter_list|,
name|u_int32_t
parameter_list|,
name|u_int32_t
parameter_list|,
name|unsigned
name|int
parameter_list|,
name|unsigned
name|char
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ssize_t
name|decode_hw_header
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|struct
name|hardware
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ssize_t
name|decode_udp_ip_header
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|struct
name|sockaddr_in
modifier|*
parameter_list|,
name|unsigned
name|char
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* ethernet.c */
end_comment

begin_function_decl
name|void
name|assemble_ethernet_header
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|,
name|unsigned
name|char
modifier|*
parameter_list|,
name|int
modifier|*
parameter_list|,
name|struct
name|hardware
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ssize_t
name|decode_ethernet_header
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|,
name|unsigned
name|char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|struct
name|hardware
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* clparse.c */
end_comment

begin_function_decl
name|int
name|read_client_conf
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|read_client_leases
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|parse_client_statement
parameter_list|(
name|FILE
modifier|*
parameter_list|,
name|struct
name|interface_info
modifier|*
parameter_list|,
name|struct
name|client_config
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|parse_X
parameter_list|(
name|FILE
modifier|*
parameter_list|,
name|u_int8_t
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|parse_option_list
parameter_list|(
name|FILE
modifier|*
parameter_list|,
name|u_int8_t
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|parse_interface_declaration
parameter_list|(
name|FILE
modifier|*
parameter_list|,
name|struct
name|client_config
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|interface_info
modifier|*
name|interface_or_dummy
parameter_list|(
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|make_client_state
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|make_client_config
parameter_list|(
name|struct
name|interface_info
modifier|*
parameter_list|,
name|struct
name|client_config
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|parse_client_lease_statement
parameter_list|(
name|FILE
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|parse_client_lease_declaration
parameter_list|(
name|FILE
modifier|*
parameter_list|,
name|struct
name|client_lease
modifier|*
parameter_list|,
name|struct
name|interface_info
modifier|*
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|option
modifier|*
name|parse_option_decl
parameter_list|(
name|FILE
modifier|*
parameter_list|,
name|struct
name|option_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|parse_string_list
parameter_list|(
name|FILE
modifier|*
parameter_list|,
name|struct
name|string_list
modifier|*
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|parse_reject_statement
parameter_list|(
name|FILE
modifier|*
parameter_list|,
name|struct
name|client_config
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* privsep.c */
end_comment

begin_function_decl
name|struct
name|buf
modifier|*
name|buf_open
parameter_list|(
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|buf_add
parameter_list|(
name|struct
name|buf
modifier|*
parameter_list|,
name|void
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|buf_close
parameter_list|(
name|int
parameter_list|,
name|struct
name|buf
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ssize_t
name|buf_read
parameter_list|(
name|int
parameter_list|,
name|void
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|dispatch_imsg
parameter_list|(
name|int
parameter_list|)
function_decl|;
end_function_decl

end_unit

