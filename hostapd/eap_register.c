begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * EAP method registration  * Copyright (c) 2004-2009, Jouni Malinen<j@w1.fi>  *  * This software may be distributed under the terms of the BSD license.  * See README for more details.  */
end_comment

begin_include
include|#
directive|include
file|"includes.h"
end_include

begin_include
include|#
directive|include
file|"common.h"
end_include

begin_include
include|#
directive|include
file|"eap_server/eap_methods.h"
end_include

begin_include
include|#
directive|include
file|"eap_register.h"
end_include

begin_comment
comment|/**  * eap_server_register_methods - Register statically linked EAP server methods  * Returns: 0 on success, -1 or -2 on failure  *  * This function is called at program initialization to register all EAP  * methods that were linked in statically.  */
end_comment

begin_function
name|int
name|eap_server_register_methods
parameter_list|(
name|void
parameter_list|)
block|{
name|int
name|ret
init|=
literal|0
decl_stmt|;
ifdef|#
directive|ifdef
name|EAP_SERVER_IDENTITY
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_identity_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_IDENTITY */
ifdef|#
directive|ifdef
name|EAP_SERVER_MD5
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_md5_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_MD5 */
ifdef|#
directive|ifdef
name|EAP_SERVER_TLS
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_tls_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_TLS */
ifdef|#
directive|ifdef
name|EAP_SERVER_UNAUTH_TLS
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_unauth_tls_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_TLS */
ifdef|#
directive|ifdef
name|EAP_SERVER_MSCHAPV2
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_mschapv2_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_MSCHAPV2 */
ifdef|#
directive|ifdef
name|EAP_SERVER_PEAP
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_peap_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_PEAP */
ifdef|#
directive|ifdef
name|EAP_SERVER_TLV
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_tlv_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_TLV */
ifdef|#
directive|ifdef
name|EAP_SERVER_GTC
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_gtc_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_GTC */
ifdef|#
directive|ifdef
name|EAP_SERVER_TTLS
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_ttls_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_TTLS */
ifdef|#
directive|ifdef
name|EAP_SERVER_SIM
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_sim_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_SIM */
ifdef|#
directive|ifdef
name|EAP_SERVER_AKA
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_aka_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_AKA */
ifdef|#
directive|ifdef
name|EAP_SERVER_AKA_PRIME
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_aka_prime_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_AKA_PRIME */
ifdef|#
directive|ifdef
name|EAP_SERVER_PAX
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_pax_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_PAX */
ifdef|#
directive|ifdef
name|EAP_SERVER_PSK
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_psk_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_PSK */
ifdef|#
directive|ifdef
name|EAP_SERVER_SAKE
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_sake_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_SAKE */
ifdef|#
directive|ifdef
name|EAP_SERVER_GPSK
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_gpsk_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_GPSK */
ifdef|#
directive|ifdef
name|EAP_SERVER_VENDOR_TEST
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_vendor_test_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_VENDOR_TEST */
ifdef|#
directive|ifdef
name|EAP_SERVER_FAST
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_fast_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_FAST */
ifdef|#
directive|ifdef
name|EAP_SERVER_WSC
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_wsc_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_WSC */
ifdef|#
directive|ifdef
name|EAP_SERVER_IKEV2
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_ikev2_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_IKEV2 */
ifdef|#
directive|ifdef
name|EAP_SERVER_TNC
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_tnc_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_TNC */
ifdef|#
directive|ifdef
name|EAP_SERVER_PWD
if|if
condition|(
name|ret
operator|==
literal|0
condition|)
name|ret
operator|=
name|eap_server_pwd_register
argument_list|()
expr_stmt|;
endif|#
directive|endif
comment|/* EAP_SERVER_PWD */
return|return
name|ret
return|;
block|}
end_function

end_unit

