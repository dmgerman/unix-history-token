begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* BFD back-end for CISCO crash dumps.    Copyright 1994, 1997, 1999, 2000, 2001, 2002, 2004, 2006, 2007    Free Software Foundation, Inc.  This file is part of BFD, the Binary File Descriptor library.  This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street - Fifth Floor, Boston, MA 02110-1301, USA.  */
end_comment

begin_include
include|#
directive|include
file|"sysdep.h"
end_include

begin_include
include|#
directive|include
file|"bfd.h"
end_include

begin_include
include|#
directive|include
file|"libbfd.h"
end_include

begin_comment
comment|/* core_file_failing_signal returns a host signal (this probably should    be fixed).  */
end_comment

begin_include
include|#
directive|include
file|<signal.h>
end_include

begin_comment
comment|/* for MSVC builds */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|SIGTRAP
end_ifndef

begin_define
define|#
directive|define
name|SIGTRAP
value|5
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|SIGEMT
end_ifndef

begin_define
define|#
directive|define
name|SIGEMT
value|6
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|SIGBUS
end_ifndef

begin_define
define|#
directive|define
name|SIGBUS
value|10
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_escape
end_escape

begin_decl_stmt
name|int
name|crash_info_locs
index|[]
init|=
block|{
literal|0x0250
block|,
comment|/* mips, ppc, x86, i960 */
literal|0x0400
block|,
comment|/* m68k, mips, x86, i960 */
literal|0x0FFC
block|,
comment|/* m68k, mips, ppc, x86, i960 */
literal|0x3000
block|,
comment|/* ppc */
literal|0x4FFC
block|,
comment|/* m68k */
operator|-
literal|1
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|CRASH_MAGIC
value|0xdead1234
end_define

begin_define
define|#
directive|define
name|MASK_ADDR
parameter_list|(
name|x
parameter_list|)
value|((x)& 0x0fffffff)
end_define

begin_comment
comment|/* Mask crash info address */
end_comment

begin_typedef
typedef|typedef
enum|enum
block|{
name|CRASH_REASON_NOTCRASHED
init|=
literal|0
block|,
name|CRASH_REASON_EXCEPTION
init|=
literal|1
block|,
name|CRASH_REASON_CORRUPT
init|=
literal|2
block|, }
name|crashreason
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
block|{
name|char
name|magic
index|[
literal|4
index|]
decl_stmt|;
comment|/* Magic number */
name|char
name|version
index|[
literal|4
index|]
decl_stmt|;
comment|/* Version number */
name|char
name|reason
index|[
literal|4
index|]
decl_stmt|;
comment|/* Crash reason */
name|char
name|cpu_vector
index|[
literal|4
index|]
decl_stmt|;
comment|/* CPU vector for exceptions */
name|char
name|registers
index|[
literal|4
index|]
decl_stmt|;
comment|/* Pointer to saved registers */
name|char
name|rambase
index|[
literal|4
index|]
decl_stmt|;
comment|/* Base of RAM (not in V1 crash info) */
name|char
name|textbase
index|[
literal|4
index|]
decl_stmt|;
comment|/* Base of .text section (not in V3 crash info) */
name|char
name|database
index|[
literal|4
index|]
decl_stmt|;
comment|/* Base of .data section (not in V3 crash info) */
name|char
name|bssbase
index|[
literal|4
index|]
decl_stmt|;
comment|/* Base of .bss section (not in V3 crash info) */
block|}
name|crashinfo_external
typedef|;
end_typedef

begin_struct
struct|struct
name|cisco_core_struct
block|{
name|int
name|sig
decl_stmt|;
block|}
struct|;
end_struct

begin_decl_stmt
specifier|static
specifier|const
name|bfd_target
modifier|*
name|cisco_core_file_validate
name|PARAMS
argument_list|(
operator|(
name|bfd
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|bfd_target
modifier|*
name|cisco_core_file_p
name|PARAMS
argument_list|(
operator|(
name|bfd
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|cisco_core_file_failing_command
name|PARAMS
argument_list|(
operator|(
name|bfd
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|cisco_core_file_failing_signal
name|PARAMS
argument_list|(
operator|(
name|bfd
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|cisco_core_file_matches_executable_p
value|generic_core_file_matches_executable_p
end_define

begin_escape
end_escape

begin_comment
comment|/* Examine the file for a crash info struct at the offset given by    CRASH_INFO_LOC.  */
end_comment

begin_function
specifier|static
specifier|const
name|bfd_target
modifier|*
name|cisco_core_file_validate
parameter_list|(
name|abfd
parameter_list|,
name|crash_info_loc
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|int
name|crash_info_loc
decl_stmt|;
block|{
name|char
name|buf
index|[
literal|4
index|]
decl_stmt|;
name|unsigned
name|int
name|crashinfo_offset
decl_stmt|;
name|crashinfo_external
name|crashinfo
decl_stmt|;
name|bfd_size_type
name|nread
decl_stmt|;
name|unsigned
name|int
name|magic
decl_stmt|;
name|unsigned
name|int
name|version
decl_stmt|;
name|unsigned
name|int
name|rambase
decl_stmt|;
name|sec_ptr
name|asect
decl_stmt|;
name|struct
name|stat
name|statbuf
decl_stmt|;
name|bfd_size_type
name|amt
decl_stmt|;
name|flagword
name|flags
decl_stmt|;
if|if
condition|(
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
operator|(
name|file_ptr
operator|)
name|crash_info_loc
argument_list|,
name|SEEK_SET
argument_list|)
operator|!=
literal|0
condition|)
return|return
name|NULL
return|;
name|nread
operator|=
name|bfd_bread
argument_list|(
name|buf
argument_list|,
operator|(
name|bfd_size_type
operator|)
literal|4
argument_list|,
name|abfd
argument_list|)
expr_stmt|;
if|if
condition|(
name|nread
operator|!=
literal|4
condition|)
block|{
if|if
condition|(
name|bfd_get_error
argument_list|()
operator|!=
name|bfd_error_system_call
condition|)
name|bfd_set_error
argument_list|(
name|bfd_error_wrong_format
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|crashinfo_offset
operator|=
name|MASK_ADDR
argument_list|(
name|bfd_get_32
argument_list|(
name|abfd
argument_list|,
name|buf
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
operator|(
name|file_ptr
operator|)
name|crashinfo_offset
argument_list|,
name|SEEK_SET
argument_list|)
operator|!=
literal|0
condition|)
block|{
comment|/* Most likely we failed because of a bogus (huge) offset */
name|bfd_set_error
argument_list|(
name|bfd_error_wrong_format
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|nread
operator|=
name|bfd_bread
argument_list|(
operator|&
name|crashinfo
argument_list|,
operator|(
name|bfd_size_type
operator|)
sizeof|sizeof
argument_list|(
name|crashinfo
argument_list|)
argument_list|,
name|abfd
argument_list|)
expr_stmt|;
if|if
condition|(
name|nread
operator|!=
sizeof|sizeof
argument_list|(
name|crashinfo
argument_list|)
condition|)
block|{
if|if
condition|(
name|bfd_get_error
argument_list|()
operator|!=
name|bfd_error_system_call
condition|)
name|bfd_set_error
argument_list|(
name|bfd_error_wrong_format
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
name|bfd_stat
argument_list|(
name|abfd
argument_list|,
operator|&
name|statbuf
argument_list|)
operator|<
literal|0
condition|)
block|{
name|bfd_set_error
argument_list|(
name|bfd_error_system_call
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|magic
operator|=
name|bfd_get_32
argument_list|(
name|abfd
argument_list|,
name|crashinfo
operator|.
name|magic
argument_list|)
expr_stmt|;
if|if
condition|(
name|magic
operator|!=
name|CRASH_MAGIC
condition|)
block|{
name|bfd_set_error
argument_list|(
name|bfd_error_wrong_format
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|version
operator|=
name|bfd_get_32
argument_list|(
name|abfd
argument_list|,
name|crashinfo
operator|.
name|version
argument_list|)
expr_stmt|;
if|if
condition|(
name|version
operator|==
literal|0
condition|)
block|{
name|bfd_set_error
argument_list|(
name|bfd_error_wrong_format
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
elseif|else
if|if
condition|(
name|version
operator|==
literal|1
condition|)
block|{
comment|/* V1 core dumps don't specify the dump base, assume 0 */
name|rambase
operator|=
literal|0
expr_stmt|;
block|}
else|else
block|{
name|rambase
operator|=
name|bfd_get_32
argument_list|(
name|abfd
argument_list|,
name|crashinfo
operator|.
name|rambase
argument_list|)
expr_stmt|;
block|}
comment|/* OK, we believe you.  You're a core file.  */
name|amt
operator|=
sizeof|sizeof
argument_list|(
expr|struct
name|cisco_core_struct
argument_list|)
expr_stmt|;
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|=
operator|(
expr|struct
name|cisco_core_struct
operator|*
operator|)
name|bfd_zmalloc
argument_list|(
name|amt
argument_list|)
expr_stmt|;
if|if
condition|(
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|==
name|NULL
condition|)
return|return
name|NULL
return|;
switch|switch
condition|(
operator|(
name|crashreason
operator|)
name|bfd_get_32
argument_list|(
name|abfd
argument_list|,
name|crashinfo
operator|.
name|reason
argument_list|)
condition|)
block|{
case|case
name|CRASH_REASON_NOTCRASHED
case|:
comment|/* Crash file probably came from write core.  */
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
literal|0
expr_stmt|;
break|break;
case|case
name|CRASH_REASON_CORRUPT
case|:
comment|/* The crash context area was corrupt -- proceed with caution. 	 We have no way of passing this information back to the caller.  */
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
literal|0
expr_stmt|;
break|break;
case|case
name|CRASH_REASON_EXCEPTION
case|:
comment|/* Crash occured due to CPU exception.  */
comment|/* This is 68k-specific; for MIPS we'll need to interpret 	 cpu_vector differently based on the target configuration 	 (since CISCO core files don't seem to have the processor 	 encoded in them).  */
switch|switch
condition|(
name|bfd_get_32
argument_list|(
name|abfd
argument_list|,
name|crashinfo
operator|.
name|cpu_vector
argument_list|)
condition|)
block|{
comment|/* bus error           */
case|case
literal|2
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGBUS
expr_stmt|;
break|break;
comment|/* address error       */
case|case
literal|3
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGBUS
expr_stmt|;
break|break;
comment|/* illegal instruction */
case|case
literal|4
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGILL
expr_stmt|;
break|break;
comment|/* zero divide         */
case|case
literal|5
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGFPE
expr_stmt|;
break|break;
comment|/* chk instruction     */
case|case
literal|6
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGFPE
expr_stmt|;
break|break;
comment|/* trapv instruction   */
case|case
literal|7
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGFPE
expr_stmt|;
break|break;
comment|/* privilege violation */
case|case
literal|8
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGSEGV
expr_stmt|;
break|break;
comment|/* trace trap          */
case|case
literal|9
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGTRAP
expr_stmt|;
break|break;
comment|/* line 1010 emulator  */
case|case
literal|10
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGILL
expr_stmt|;
break|break;
comment|/* line 1111 emulator  */
case|case
literal|11
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGILL
expr_stmt|;
break|break;
comment|/* Coprocessor protocol violation.  Using a standard MMU or FPU 	     this cannot be triggered by software.  Call it a SIGBUS.  */
case|case
literal|13
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGBUS
expr_stmt|;
break|break;
comment|/* interrupt           */
case|case
literal|31
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGINT
expr_stmt|;
break|break;
comment|/* breakpoint          */
case|case
literal|33
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGTRAP
expr_stmt|;
break|break;
comment|/* floating point err  */
case|case
literal|48
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGFPE
expr_stmt|;
break|break;
comment|/* floating point err  */
case|case
literal|49
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGFPE
expr_stmt|;
break|break;
comment|/* zero divide         */
case|case
literal|50
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGFPE
expr_stmt|;
break|break;
comment|/* underflow           */
case|case
literal|51
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGFPE
expr_stmt|;
break|break;
comment|/* operand error       */
case|case
literal|52
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGFPE
expr_stmt|;
break|break;
comment|/* overflow            */
case|case
literal|53
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGFPE
expr_stmt|;
break|break;
comment|/* NAN                 */
case|case
literal|54
case|:
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGFPE
expr_stmt|;
break|break;
default|default:
ifndef|#
directive|ifndef
name|SIGEMT
define|#
directive|define
name|SIGEMT
value|SIGTRAP
endif|#
directive|endif
comment|/* "software generated"*/
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
name|SIGEMT
expr_stmt|;
block|}
break|break;
default|default:
comment|/* Unknown crash reason.  */
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
operator|=
literal|0
expr_stmt|;
break|break;
block|}
comment|/* Create a ".data" section that maps the entire file, which is      essentially a dump of the target system's RAM.  */
name|flags
operator|=
name|SEC_ALLOC
operator||
name|SEC_LOAD
operator||
name|SEC_HAS_CONTENTS
expr_stmt|;
name|asect
operator|=
name|bfd_make_section_anyway_with_flags
argument_list|(
name|abfd
argument_list|,
literal|".data"
argument_list|,
name|flags
argument_list|)
expr_stmt|;
if|if
condition|(
name|asect
operator|==
name|NULL
condition|)
goto|goto
name|error_return
goto|;
comment|/* The size of memory is the size of the core file itself.  */
name|asect
operator|->
name|size
operator|=
name|statbuf
operator|.
name|st_size
expr_stmt|;
name|asect
operator|->
name|vma
operator|=
name|rambase
expr_stmt|;
name|asect
operator|->
name|filepos
operator|=
literal|0
expr_stmt|;
comment|/* Create a ".crash" section to allow access to the saved      crash information.  */
name|flags
operator|=
name|SEC_HAS_CONTENTS
expr_stmt|;
name|asect
operator|=
name|bfd_make_section_anyway_with_flags
argument_list|(
name|abfd
argument_list|,
literal|".crash"
argument_list|,
name|flags
argument_list|)
expr_stmt|;
if|if
condition|(
name|asect
operator|==
name|NULL
condition|)
goto|goto
name|error_return
goto|;
name|asect
operator|->
name|vma
operator|=
literal|0
expr_stmt|;
name|asect
operator|->
name|filepos
operator|=
name|crashinfo_offset
expr_stmt|;
name|asect
operator|->
name|size
operator|=
sizeof|sizeof
argument_list|(
name|crashinfo
argument_list|)
expr_stmt|;
comment|/* Create a ".reg" section to allow access to the saved      registers.  */
name|asect
operator|=
name|bfd_make_section_anyway_with_flags
argument_list|(
name|abfd
argument_list|,
literal|".reg"
argument_list|,
name|flags
argument_list|)
expr_stmt|;
if|if
condition|(
name|asect
operator|==
name|NULL
condition|)
goto|goto
name|error_return
goto|;
name|asect
operator|->
name|vma
operator|=
literal|0
expr_stmt|;
name|asect
operator|->
name|filepos
operator|=
name|bfd_get_32
argument_list|(
name|abfd
argument_list|,
name|crashinfo
operator|.
name|registers
argument_list|)
operator|-
name|rambase
expr_stmt|;
comment|/* Since we don't know the exact size of the saved register info,      choose a register section size that is either the remaining part      of the file, or 1024, whichever is smaller.  */
name|nread
operator|=
name|statbuf
operator|.
name|st_size
operator|-
name|asect
operator|->
name|filepos
expr_stmt|;
name|asect
operator|->
name|size
operator|=
operator|(
name|nread
operator|<
literal|1024
operator|)
condition|?
name|nread
else|:
literal|1024
expr_stmt|;
return|return
name|abfd
operator|->
name|xvec
return|;
comment|/* Get here if we have already started filling out the BFD      and there is an error of some kind.  */
name|error_return
label|:
name|bfd_release
argument_list|(
name|abfd
argument_list|,
name|abfd
operator|->
name|tdata
operator|.
name|any
argument_list|)
expr_stmt|;
name|abfd
operator|->
name|tdata
operator|.
name|any
operator|=
name|NULL
expr_stmt|;
name|bfd_section_list_clear
argument_list|(
name|abfd
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|bfd_target
modifier|*
name|cisco_core_file_p
parameter_list|(
name|abfd
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
block|{
name|int
modifier|*
name|crash_info_locp
decl_stmt|;
specifier|const
name|bfd_target
modifier|*
name|target
init|=
name|NULL
decl_stmt|;
for|for
control|(
name|crash_info_locp
operator|=
name|crash_info_locs
init|;
operator|*
name|crash_info_locp
operator|!=
operator|-
literal|1
operator|&&
name|target
operator|==
name|NULL
condition|;
name|crash_info_locp
operator|++
control|)
block|{
name|target
operator|=
name|cisco_core_file_validate
argument_list|(
name|abfd
argument_list|,
operator|*
name|crash_info_locp
argument_list|)
expr_stmt|;
block|}
return|return
operator|(
name|target
operator|)
return|;
block|}
end_function

begin_function
name|char
modifier|*
name|cisco_core_file_failing_command
parameter_list|(
name|abfd
parameter_list|)
name|bfd
modifier|*
name|abfd
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
return|return
name|NULL
return|;
block|}
end_function

begin_function
name|int
name|cisco_core_file_failing_signal
parameter_list|(
name|abfd
parameter_list|)
name|bfd
modifier|*
name|abfd
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
return|return
name|abfd
operator|->
name|tdata
operator|.
name|cisco_core_data
operator|->
name|sig
return|;
block|}
end_function

begin_escape
end_escape

begin_decl_stmt
specifier|extern
specifier|const
name|bfd_target
name|cisco_core_little_vec
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|bfd_target
name|cisco_core_big_vec
init|=
block|{
literal|"cisco-ios-core-big"
block|,
name|bfd_target_unknown_flavour
block|,
name|BFD_ENDIAN_BIG
block|,
comment|/* target byte order */
name|BFD_ENDIAN_BIG
block|,
comment|/* target headers byte order */
operator|(
name|HAS_RELOC
operator||
name|EXEC_P
operator||
comment|/* object flags */
name|HAS_LINENO
operator||
name|HAS_DEBUG
operator||
name|HAS_SYMS
operator||
name|HAS_LOCALS
operator||
name|WP_TEXT
operator||
name|D_PAGED
operator|)
block|,
operator|(
name|SEC_HAS_CONTENTS
operator||
name|SEC_ALLOC
operator||
name|SEC_LOAD
operator||
name|SEC_RELOC
operator|)
block|,
comment|/* section flags */
literal|0
block|,
comment|/* symbol prefix */
literal|' '
block|,
comment|/* ar_pad_char */
literal|16
block|,
comment|/* ar_max_namelen */
name|bfd_getb64
block|,
name|bfd_getb_signed_64
block|,
name|bfd_putb64
block|,
name|bfd_getb32
block|,
name|bfd_getb_signed_32
block|,
name|bfd_putb32
block|,
name|bfd_getb16
block|,
name|bfd_getb_signed_16
block|,
name|bfd_putb16
block|,
comment|/* data */
name|bfd_getb64
block|,
name|bfd_getb_signed_64
block|,
name|bfd_putb64
block|,
name|bfd_getb32
block|,
name|bfd_getb_signed_32
block|,
name|bfd_putb32
block|,
name|bfd_getb16
block|,
name|bfd_getb_signed_16
block|,
name|bfd_putb16
block|,
comment|/* hdrs */
block|{
comment|/* bfd_check_format */
name|_bfd_dummy_target
block|,
comment|/* unknown format */
name|_bfd_dummy_target
block|,
comment|/* object file */
name|_bfd_dummy_target
block|,
comment|/* archive */
name|cisco_core_file_p
comment|/* a core file */
block|}
block|,
block|{
comment|/* bfd_set_format */
name|bfd_false
block|,
name|bfd_false
block|,
name|bfd_false
block|,
name|bfd_false
block|}
block|,
block|{
comment|/* bfd_write_contents */
name|bfd_false
block|,
name|bfd_false
block|,
name|bfd_false
block|,
name|bfd_false
block|}
block|,
name|BFD_JUMP_TABLE_GENERIC
argument_list|(
name|_bfd_generic
argument_list|)
block|,
name|BFD_JUMP_TABLE_COPY
argument_list|(
name|_bfd_generic
argument_list|)
block|,
name|BFD_JUMP_TABLE_CORE
argument_list|(
name|cisco
argument_list|)
block|,
name|BFD_JUMP_TABLE_ARCHIVE
argument_list|(
name|_bfd_noarchive
argument_list|)
block|,
name|BFD_JUMP_TABLE_SYMBOLS
argument_list|(
name|_bfd_nosymbols
argument_list|)
block|,
name|BFD_JUMP_TABLE_RELOCS
argument_list|(
name|_bfd_norelocs
argument_list|)
block|,
name|BFD_JUMP_TABLE_WRITE
argument_list|(
name|_bfd_generic
argument_list|)
block|,
name|BFD_JUMP_TABLE_LINK
argument_list|(
name|_bfd_nolink
argument_list|)
block|,
name|BFD_JUMP_TABLE_DYNAMIC
argument_list|(
name|_bfd_nodynamic
argument_list|)
block|,
operator|&
name|cisco_core_little_vec
block|,
operator|(
name|PTR
operator|)
literal|0
comment|/* backend_data */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|bfd_target
name|cisco_core_little_vec
init|=
block|{
literal|"cisco-ios-core-little"
block|,
name|bfd_target_unknown_flavour
block|,
name|BFD_ENDIAN_LITTLE
block|,
comment|/* target byte order */
name|BFD_ENDIAN_LITTLE
block|,
comment|/* target headers byte order */
operator|(
name|HAS_RELOC
operator||
name|EXEC_P
operator||
comment|/* object flags */
name|HAS_LINENO
operator||
name|HAS_DEBUG
operator||
name|HAS_SYMS
operator||
name|HAS_LOCALS
operator||
name|WP_TEXT
operator||
name|D_PAGED
operator|)
block|,
operator|(
name|SEC_HAS_CONTENTS
operator||
name|SEC_ALLOC
operator||
name|SEC_LOAD
operator||
name|SEC_RELOC
operator|)
block|,
comment|/* section flags */
literal|0
block|,
comment|/* symbol prefix */
literal|' '
block|,
comment|/* ar_pad_char */
literal|16
block|,
comment|/* ar_max_namelen */
name|bfd_getl64
block|,
name|bfd_getl_signed_64
block|,
name|bfd_putl64
block|,
name|bfd_getl32
block|,
name|bfd_getl_signed_32
block|,
name|bfd_putl32
block|,
name|bfd_getl16
block|,
name|bfd_getl_signed_16
block|,
name|bfd_putl16
block|,
comment|/* data */
name|bfd_getl64
block|,
name|bfd_getl_signed_64
block|,
name|bfd_putl64
block|,
name|bfd_getl32
block|,
name|bfd_getl_signed_32
block|,
name|bfd_putl32
block|,
name|bfd_getl16
block|,
name|bfd_getl_signed_16
block|,
name|bfd_putl16
block|,
comment|/* hdrs */
block|{
comment|/* bfd_check_format */
name|_bfd_dummy_target
block|,
comment|/* unknown format */
name|_bfd_dummy_target
block|,
comment|/* object file */
name|_bfd_dummy_target
block|,
comment|/* archive */
name|cisco_core_file_p
comment|/* a core file */
block|}
block|,
block|{
comment|/* bfd_set_format */
name|bfd_false
block|,
name|bfd_false
block|,
name|bfd_false
block|,
name|bfd_false
block|}
block|,
block|{
comment|/* bfd_write_contents */
name|bfd_false
block|,
name|bfd_false
block|,
name|bfd_false
block|,
name|bfd_false
block|}
block|,
name|BFD_JUMP_TABLE_GENERIC
argument_list|(
name|_bfd_generic
argument_list|)
block|,
name|BFD_JUMP_TABLE_COPY
argument_list|(
name|_bfd_generic
argument_list|)
block|,
name|BFD_JUMP_TABLE_CORE
argument_list|(
name|cisco
argument_list|)
block|,
name|BFD_JUMP_TABLE_ARCHIVE
argument_list|(
name|_bfd_noarchive
argument_list|)
block|,
name|BFD_JUMP_TABLE_SYMBOLS
argument_list|(
name|_bfd_nosymbols
argument_list|)
block|,
name|BFD_JUMP_TABLE_RELOCS
argument_list|(
name|_bfd_norelocs
argument_list|)
block|,
name|BFD_JUMP_TABLE_WRITE
argument_list|(
name|_bfd_generic
argument_list|)
block|,
name|BFD_JUMP_TABLE_LINK
argument_list|(
name|_bfd_nolink
argument_list|)
block|,
name|BFD_JUMP_TABLE_DYNAMIC
argument_list|(
name|_bfd_nodynamic
argument_list|)
block|,
operator|&
name|cisco_core_big_vec
block|,
operator|(
name|PTR
operator|)
literal|0
comment|/* backend_data */
block|}
decl_stmt|;
end_decl_stmt

end_unit

