begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* xSYM symbol-file support for BFD.    Copyright 1999, 2000, 2001, 2002, 2003    Free Software Foundation, Inc.     This file is part of BFD, the Binary File Descriptor library.     This program is free software; you can redistribute it and/or modify    it under the terms of the GNU General Public License as published by    the Free Software Foundation; either version 2 of the License, or    (at your option) any later version.     This program is distributed in the hope that it will be useful,    but WITHOUT ANY WARRANTY; without even the implied warranty of    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    GNU General Public License for more details.     You should have received a copy of the GNU General Public License    along with this program; if not, write to the Free Software    Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_include
include|#
directive|include
file|"xsym.h"
end_include

begin_include
include|#
directive|include
file|"bfd.h"
end_include

begin_include
include|#
directive|include
file|"sysdep.h"
end_include

begin_include
include|#
directive|include
file|"libbfd.h"
end_include

begin_define
define|#
directive|define
name|bfd_sym_close_and_cleanup
value|_bfd_generic_close_and_cleanup
end_define

begin_define
define|#
directive|define
name|bfd_sym_bfd_free_cached_info
value|_bfd_generic_bfd_free_cached_info
end_define

begin_define
define|#
directive|define
name|bfd_sym_new_section_hook
value|_bfd_generic_new_section_hook
end_define

begin_define
define|#
directive|define
name|bfd_sym_bfd_is_local_label_name
value|bfd_generic_is_local_label_name
end_define

begin_define
define|#
directive|define
name|bfd_sym_get_lineno
value|_bfd_nosymbols_get_lineno
end_define

begin_define
define|#
directive|define
name|bfd_sym_find_nearest_line
value|_bfd_nosymbols_find_nearest_line
end_define

begin_define
define|#
directive|define
name|bfd_sym_bfd_make_debug_symbol
value|_bfd_nosymbols_bfd_make_debug_symbol
end_define

begin_define
define|#
directive|define
name|bfd_sym_read_minisymbols
value|_bfd_generic_read_minisymbols
end_define

begin_define
define|#
directive|define
name|bfd_sym_minisymbol_to_symbol
value|_bfd_generic_minisymbol_to_symbol
end_define

begin_define
define|#
directive|define
name|bfd_sym_get_reloc_upper_bound
value|_bfd_norelocs_get_reloc_upper_bound
end_define

begin_define
define|#
directive|define
name|bfd_sym_canonicalize_reloc
value|_bfd_norelocs_canonicalize_reloc
end_define

begin_define
define|#
directive|define
name|bfd_sym_bfd_reloc_type_lookup
value|_bfd_norelocs_bfd_reloc_type_lookup
end_define

begin_define
define|#
directive|define
name|bfd_sym_set_arch_mach
value|_bfd_generic_set_arch_mach
end_define

begin_define
define|#
directive|define
name|bfd_sym_get_section_contents
value|_bfd_generic_get_section_contents
end_define

begin_define
define|#
directive|define
name|bfd_sym_set_section_contents
value|_bfd_generic_set_section_contents
end_define

begin_define
define|#
directive|define
name|bfd_sym_bfd_get_relocated_section_contents
value|bfd_generic_get_relocated_section_contents
end_define

begin_define
define|#
directive|define
name|bfd_sym_bfd_relax_section
value|bfd_generic_relax_section
end_define

begin_define
define|#
directive|define
name|bfd_sym_bfd_gc_sections
value|bfd_generic_gc_sections
end_define

begin_define
define|#
directive|define
name|bfd_sym_bfd_merge_sections
value|bfd_generic_merge_sections
end_define

begin_define
define|#
directive|define
name|bfd_sym_bfd_discard_group
value|bfd_generic_discard_group
end_define

begin_define
define|#
directive|define
name|bfd_sym_bfd_link_hash_table_create
value|_bfd_generic_link_hash_table_create
end_define

begin_define
define|#
directive|define
name|bfd_sym_bfd_link_hash_table_free
value|_bfd_generic_link_hash_table_free
end_define

begin_define
define|#
directive|define
name|bfd_sym_bfd_link_add_symbols
value|_bfd_generic_link_add_symbols
end_define

begin_define
define|#
directive|define
name|bfd_sym_bfd_link_just_syms
value|_bfd_generic_link_just_syms
end_define

begin_define
define|#
directive|define
name|bfd_sym_bfd_final_link
value|_bfd_generic_final_link
end_define

begin_define
define|#
directive|define
name|bfd_sym_bfd_link_split_section
value|_bfd_generic_link_split_section
end_define

begin_define
define|#
directive|define
name|bfd_sym_get_section_contents_in_window
value|_bfd_generic_get_section_contents_in_window
end_define

begin_decl_stmt
specifier|static
name|int
name|pstrcmp
name|PARAMS
argument_list|(
operator|(
name|unsigned
name|char
operator|*
operator|,
name|unsigned
name|char
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|unsigned
name|long
name|compute_offset
name|PARAMS
argument_list|(
operator|(
name|unsigned
name|long
operator|,
name|unsigned
name|long
operator|,
name|unsigned
name|long
operator|,
name|unsigned
name|long
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
specifier|const
name|bfd_target
name|sym_vec
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|int
name|pstrcmp
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
name|unsigned
name|char
modifier|*
name|a
decl_stmt|;
name|unsigned
name|char
modifier|*
name|b
decl_stmt|;
block|{
name|unsigned
name|char
name|clen
decl_stmt|;
name|int
name|ret
decl_stmt|;
name|clen
operator|=
operator|(
name|a
index|[
literal|0
index|]
operator|>
name|b
index|[
literal|0
index|]
operator|)
condition|?
name|a
index|[
literal|0
index|]
else|:
name|b
index|[
literal|0
index|]
expr_stmt|;
name|ret
operator|=
name|memcmp
argument_list|(
name|a
operator|+
literal|1
argument_list|,
name|b
operator|+
literal|1
argument_list|,
name|clen
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
operator|!=
literal|0
condition|)
return|return
name|ret
return|;
if|if
condition|(
name|a
index|[
literal|0
index|]
operator|==
name|b
index|[
literal|0
index|]
condition|)
return|return
literal|0
return|;
elseif|else
if|if
condition|(
name|a
index|[
literal|0
index|]
operator|<
name|b
index|[
literal|0
index|]
condition|)
return|return
operator|-
literal|1
return|;
else|else
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|unsigned
name|long
name|compute_offset
parameter_list|(
name|first_page
parameter_list|,
name|page_size
parameter_list|,
name|entry_size
parameter_list|,
name|index
parameter_list|)
name|unsigned
name|long
name|first_page
decl_stmt|;
name|unsigned
name|long
name|page_size
decl_stmt|;
name|unsigned
name|long
name|entry_size
decl_stmt|;
name|unsigned
name|long
name|index
decl_stmt|;
block|{
name|unsigned
name|long
name|entries_per_page
init|=
name|page_size
operator|/
name|entry_size
decl_stmt|;
name|unsigned
name|long
name|page_number
init|=
name|first_page
operator|+
operator|(
name|index
operator|/
name|entries_per_page
operator|)
decl_stmt|;
name|unsigned
name|long
name|page_offset
init|=
operator|(
name|index
operator|%
name|entries_per_page
operator|)
operator|*
name|entry_size
decl_stmt|;
return|return
operator|(
name|page_number
operator|*
name|page_size
operator|)
operator|+
name|page_offset
return|;
block|}
end_function

begin_function
name|bfd_boolean
name|bfd_sym_mkobject
parameter_list|(
name|abfd
parameter_list|)
name|bfd
modifier|*
name|abfd
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
return|return
literal|1
return|;
block|}
end_function

begin_function
name|void
name|bfd_sym_print_symbol
parameter_list|(
name|abfd
parameter_list|,
name|afile
parameter_list|,
name|symbol
parameter_list|,
name|how
parameter_list|)
name|bfd
modifier|*
name|abfd
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|PTR
name|afile
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|asymbol
modifier|*
name|symbol
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|bfd_print_symbol_type
name|how
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
return|return;
block|}
end_function

begin_function
name|bfd_boolean
name|bfd_sym_valid
parameter_list|(
name|abfd
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
block|{
if|if
condition|(
name|abfd
operator|==
name|NULL
operator|||
name|abfd
operator|->
name|xvec
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|abfd
operator|->
name|xvec
operator|==
operator|&
name|sym_vec
return|;
block|}
end_function

begin_function
name|unsigned
name|char
modifier|*
name|bfd_sym_read_name_table
parameter_list|(
name|abfd
parameter_list|,
name|dshb
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_header_block
modifier|*
name|dshb
decl_stmt|;
block|{
name|unsigned
name|char
modifier|*
name|rstr
decl_stmt|;
name|long
name|ret
decl_stmt|;
name|size_t
name|table_size
init|=
name|dshb
operator|->
name|dshb_nte
operator|.
name|dti_page_count
operator|*
name|dshb
operator|->
name|dshb_page_size
decl_stmt|;
name|size_t
name|table_offset
init|=
name|dshb
operator|->
name|dshb_nte
operator|.
name|dti_first_page
operator|*
name|dshb
operator|->
name|dshb_page_size
decl_stmt|;
name|rstr
operator|=
operator|(
name|unsigned
name|char
operator|*
operator|)
name|bfd_alloc
argument_list|(
name|abfd
argument_list|,
name|table_size
argument_list|)
expr_stmt|;
if|if
condition|(
name|rstr
operator|==
name|NULL
condition|)
return|return
name|rstr
return|;
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
name|table_offset
argument_list|,
name|SEEK_SET
argument_list|)
expr_stmt|;
name|ret
operator|=
name|bfd_bread
argument_list|(
name|rstr
argument_list|,
name|table_size
argument_list|,
name|abfd
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
operator|<
literal|0
operator|||
operator|(
name|unsigned
name|long
operator|)
name|ret
operator|!=
name|table_size
condition|)
block|{
name|bfd_release
argument_list|(
name|abfd
argument_list|,
name|rstr
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
return|return
name|rstr
return|;
block|}
end_function

begin_function
name|void
name|bfd_sym_parse_file_reference_v32
parameter_list|(
name|buf
parameter_list|,
name|len
parameter_list|,
name|entry
parameter_list|)
name|unsigned
name|char
modifier|*
name|buf
decl_stmt|;
name|size_t
name|len
decl_stmt|;
name|bfd_sym_file_reference
modifier|*
name|entry
decl_stmt|;
block|{
name|BFD_ASSERT
argument_list|(
name|len
operator|==
literal|6
argument_list|)
expr_stmt|;
name|entry
operator|->
name|fref_frte_index
operator|=
name|bfd_getb16
argument_list|(
name|buf
argument_list|)
expr_stmt|;
name|entry
operator|->
name|fref_offset
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|2
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bfd_sym_parse_disk_table_v32
parameter_list|(
name|buf
parameter_list|,
name|len
parameter_list|,
name|table
parameter_list|)
name|unsigned
name|char
modifier|*
name|buf
decl_stmt|;
name|size_t
name|len
decl_stmt|;
name|bfd_sym_table_info
modifier|*
name|table
decl_stmt|;
block|{
name|BFD_ASSERT
argument_list|(
name|len
operator|==
literal|8
argument_list|)
expr_stmt|;
name|table
operator|->
name|dti_first_page
operator|=
name|bfd_getb16
argument_list|(
name|buf
argument_list|)
expr_stmt|;
name|table
operator|->
name|dti_page_count
operator|=
name|bfd_getb16
argument_list|(
name|buf
operator|+
literal|2
argument_list|)
expr_stmt|;
name|table
operator|->
name|dti_object_count
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|4
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bfd_sym_parse_header_v32
parameter_list|(
name|buf
parameter_list|,
name|len
parameter_list|,
name|header
parameter_list|)
name|unsigned
name|char
modifier|*
name|buf
decl_stmt|;
name|size_t
name|len
decl_stmt|;
name|bfd_sym_header_block
modifier|*
name|header
decl_stmt|;
block|{
name|BFD_ASSERT
argument_list|(
name|len
operator|==
literal|154
argument_list|)
expr_stmt|;
name|memcpy
argument_list|(
name|header
operator|->
name|dshb_id
argument_list|,
name|buf
argument_list|,
literal|32
argument_list|)
expr_stmt|;
name|header
operator|->
name|dshb_page_size
operator|=
name|bfd_getb16
argument_list|(
name|buf
operator|+
literal|32
argument_list|)
expr_stmt|;
name|header
operator|->
name|dshb_hash_page
operator|=
name|bfd_getb16
argument_list|(
name|buf
operator|+
literal|34
argument_list|)
expr_stmt|;
name|header
operator|->
name|dshb_root_mte
operator|=
name|bfd_getb16
argument_list|(
name|buf
operator|+
literal|36
argument_list|)
expr_stmt|;
name|header
operator|->
name|dshb_mod_date
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|38
argument_list|)
expr_stmt|;
name|bfd_sym_parse_disk_table_v32
argument_list|(
name|buf
operator|+
literal|42
argument_list|,
literal|8
argument_list|,
operator|&
name|header
operator|->
name|dshb_frte
argument_list|)
expr_stmt|;
name|bfd_sym_parse_disk_table_v32
argument_list|(
name|buf
operator|+
literal|50
argument_list|,
literal|8
argument_list|,
operator|&
name|header
operator|->
name|dshb_rte
argument_list|)
expr_stmt|;
name|bfd_sym_parse_disk_table_v32
argument_list|(
name|buf
operator|+
literal|58
argument_list|,
literal|8
argument_list|,
operator|&
name|header
operator|->
name|dshb_mte
argument_list|)
expr_stmt|;
name|bfd_sym_parse_disk_table_v32
argument_list|(
name|buf
operator|+
literal|66
argument_list|,
literal|8
argument_list|,
operator|&
name|header
operator|->
name|dshb_cmte
argument_list|)
expr_stmt|;
name|bfd_sym_parse_disk_table_v32
argument_list|(
name|buf
operator|+
literal|74
argument_list|,
literal|8
argument_list|,
operator|&
name|header
operator|->
name|dshb_cvte
argument_list|)
expr_stmt|;
name|bfd_sym_parse_disk_table_v32
argument_list|(
name|buf
operator|+
literal|82
argument_list|,
literal|8
argument_list|,
operator|&
name|header
operator|->
name|dshb_csnte
argument_list|)
expr_stmt|;
name|bfd_sym_parse_disk_table_v32
argument_list|(
name|buf
operator|+
literal|90
argument_list|,
literal|8
argument_list|,
operator|&
name|header
operator|->
name|dshb_clte
argument_list|)
expr_stmt|;
name|bfd_sym_parse_disk_table_v32
argument_list|(
name|buf
operator|+
literal|98
argument_list|,
literal|8
argument_list|,
operator|&
name|header
operator|->
name|dshb_ctte
argument_list|)
expr_stmt|;
name|bfd_sym_parse_disk_table_v32
argument_list|(
name|buf
operator|+
literal|106
argument_list|,
literal|8
argument_list|,
operator|&
name|header
operator|->
name|dshb_tte
argument_list|)
expr_stmt|;
name|bfd_sym_parse_disk_table_v32
argument_list|(
name|buf
operator|+
literal|114
argument_list|,
literal|8
argument_list|,
operator|&
name|header
operator|->
name|dshb_nte
argument_list|)
expr_stmt|;
name|bfd_sym_parse_disk_table_v32
argument_list|(
name|buf
operator|+
literal|122
argument_list|,
literal|8
argument_list|,
operator|&
name|header
operator|->
name|dshb_tinfo
argument_list|)
expr_stmt|;
name|bfd_sym_parse_disk_table_v32
argument_list|(
name|buf
operator|+
literal|130
argument_list|,
literal|8
argument_list|,
operator|&
name|header
operator|->
name|dshb_fite
argument_list|)
expr_stmt|;
name|bfd_sym_parse_disk_table_v32
argument_list|(
name|buf
operator|+
literal|138
argument_list|,
literal|8
argument_list|,
operator|&
name|header
operator|->
name|dshb_const
argument_list|)
expr_stmt|;
name|memcpy
argument_list|(
operator|&
name|header
operator|->
name|dshb_file_creator
argument_list|,
name|buf
operator|+
literal|146
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|memcpy
argument_list|(
operator|&
name|header
operator|->
name|dshb_file_type
argument_list|,
name|buf
operator|+
literal|150
argument_list|,
literal|4
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|int
name|bfd_sym_read_header_v32
parameter_list|(
name|abfd
parameter_list|,
name|header
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_header_block
modifier|*
name|header
decl_stmt|;
block|{
name|unsigned
name|char
name|buf
index|[
literal|154
index|]
decl_stmt|;
name|long
name|ret
decl_stmt|;
name|ret
operator|=
name|bfd_bread
argument_list|(
name|buf
argument_list|,
literal|154
argument_list|,
name|abfd
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
operator|!=
literal|154
condition|)
return|return
operator|-
literal|1
return|;
name|bfd_sym_parse_header_v32
argument_list|(
name|buf
argument_list|,
literal|154
argument_list|,
name|header
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|bfd_sym_read_header_v34
parameter_list|(
name|abfd
parameter_list|,
name|header
parameter_list|)
name|bfd
modifier|*
name|abfd
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|bfd_sym_header_block
modifier|*
name|header
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|abort
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
name|int
name|bfd_sym_read_header
parameter_list|(
name|abfd
parameter_list|,
name|header
parameter_list|,
name|version
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_header_block
modifier|*
name|header
decl_stmt|;
name|bfd_sym_version
name|version
decl_stmt|;
block|{
switch|switch
condition|(
name|version
condition|)
block|{
case|case
name|BFD_SYM_VERSION_3_5
case|:
case|case
name|BFD_SYM_VERSION_3_4
case|:
return|return
name|bfd_sym_read_header_v34
argument_list|(
name|abfd
argument_list|,
name|header
argument_list|)
return|;
case|case
name|BFD_SYM_VERSION_3_3
case|:
case|case
name|BFD_SYM_VERSION_3_2
case|:
return|return
name|bfd_sym_read_header_v32
argument_list|(
name|abfd
argument_list|,
name|header
argument_list|)
return|;
case|case
name|BFD_SYM_VERSION_3_1
case|:
default|default:
return|return
name|FALSE
return|;
block|}
block|}
end_function

begin_function
name|int
name|bfd_sym_read_version
parameter_list|(
name|abfd
parameter_list|,
name|version
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_version
modifier|*
name|version
decl_stmt|;
block|{
name|unsigned
name|char
name|version_string
index|[
literal|32
index|]
decl_stmt|;
name|long
name|ret
decl_stmt|;
name|ret
operator|=
name|bfd_bread
argument_list|(
name|version_string
argument_list|,
sizeof|sizeof
argument_list|(
name|version_string
argument_list|)
argument_list|,
name|abfd
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
operator|!=
sizeof|sizeof
argument_list|(
name|version_string
argument_list|)
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|pstrcmp
argument_list|(
name|version_string
argument_list|,
name|BFD_SYM_VERSION_STR_3_1
argument_list|)
operator|==
literal|0
condition|)
operator|*
name|version
operator|=
name|BFD_SYM_VERSION_3_1
expr_stmt|;
elseif|else
if|if
condition|(
name|pstrcmp
argument_list|(
name|version_string
argument_list|,
name|BFD_SYM_VERSION_STR_3_2
argument_list|)
operator|==
literal|0
condition|)
operator|*
name|version
operator|=
name|BFD_SYM_VERSION_3_2
expr_stmt|;
elseif|else
if|if
condition|(
name|pstrcmp
argument_list|(
name|version_string
argument_list|,
name|BFD_SYM_VERSION_STR_3_3
argument_list|)
operator|==
literal|0
condition|)
operator|*
name|version
operator|=
name|BFD_SYM_VERSION_3_3
expr_stmt|;
elseif|else
if|if
condition|(
name|pstrcmp
argument_list|(
name|version_string
argument_list|,
name|BFD_SYM_VERSION_STR_3_4
argument_list|)
operator|==
literal|0
condition|)
operator|*
name|version
operator|=
name|BFD_SYM_VERSION_3_4
expr_stmt|;
elseif|else
if|if
condition|(
name|pstrcmp
argument_list|(
name|version_string
argument_list|,
name|BFD_SYM_VERSION_STR_3_5
argument_list|)
operator|==
literal|0
condition|)
operator|*
name|version
operator|=
name|BFD_SYM_VERSION_3_5
expr_stmt|;
else|else
return|return
operator|-
literal|1
return|;
return|return
literal|0
return|;
block|}
end_function

begin_function
name|void
name|bfd_sym_display_table_summary
parameter_list|(
name|f
parameter_list|,
name|dti
parameter_list|,
name|name
parameter_list|)
name|FILE
modifier|*
name|f
decl_stmt|;
name|bfd_sym_table_info
modifier|*
name|dti
decl_stmt|;
specifier|const
name|char
modifier|*
name|name
decl_stmt|;
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"%-6s %13ld %13ld %13ld\n"
argument_list|,
name|name
argument_list|,
name|dti
operator|->
name|dti_first_page
argument_list|,
name|dti
operator|->
name|dti_page_count
argument_list|,
name|dti
operator|->
name|dti_object_count
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bfd_sym_display_header
parameter_list|(
name|f
parameter_list|,
name|dshb
parameter_list|)
name|FILE
modifier|*
name|f
decl_stmt|;
name|bfd_sym_header_block
modifier|*
name|dshb
decl_stmt|;
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"            Version: %.*s\n"
argument_list|,
name|dshb
operator|->
name|dshb_id
index|[
literal|0
index|]
argument_list|,
name|dshb
operator|->
name|dshb_id
operator|+
literal|1
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"          Page Size: 0x%x\n"
argument_list|,
name|dshb
operator|->
name|dshb_page_size
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"          Hash Page: %lu\n"
argument_list|,
name|dshb
operator|->
name|dshb_hash_page
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"           Root MTE: %lu\n"
argument_list|,
name|dshb
operator|->
name|dshb_root_mte
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"  Modification Date: "
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[unimplemented]"
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" (0x%lx)\n"
argument_list|,
name|dshb
operator|->
name|dshb_mod_date
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"       File Creator:  %.4s  Type: %.4s\n\n"
argument_list|,
name|dshb
operator|->
name|dshb_file_creator
argument_list|,
name|dshb
operator|->
name|dshb_file_type
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"Table Name   First Page    Page Count   Object Count\n"
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n"
argument_list|)
expr_stmt|;
name|bfd_sym_display_table_summary
argument_list|(
name|f
argument_list|,
operator|&
name|dshb
operator|->
name|dshb_nte
argument_list|,
literal|"NTE"
argument_list|)
expr_stmt|;
name|bfd_sym_display_table_summary
argument_list|(
name|f
argument_list|,
operator|&
name|dshb
operator|->
name|dshb_rte
argument_list|,
literal|"RTE"
argument_list|)
expr_stmt|;
name|bfd_sym_display_table_summary
argument_list|(
name|f
argument_list|,
operator|&
name|dshb
operator|->
name|dshb_mte
argument_list|,
literal|"MTE"
argument_list|)
expr_stmt|;
name|bfd_sym_display_table_summary
argument_list|(
name|f
argument_list|,
operator|&
name|dshb
operator|->
name|dshb_frte
argument_list|,
literal|"FRTE"
argument_list|)
expr_stmt|;
name|bfd_sym_display_table_summary
argument_list|(
name|f
argument_list|,
operator|&
name|dshb
operator|->
name|dshb_cmte
argument_list|,
literal|"CMTE"
argument_list|)
expr_stmt|;
name|bfd_sym_display_table_summary
argument_list|(
name|f
argument_list|,
operator|&
name|dshb
operator|->
name|dshb_cvte
argument_list|,
literal|"CVTE"
argument_list|)
expr_stmt|;
name|bfd_sym_display_table_summary
argument_list|(
name|f
argument_list|,
operator|&
name|dshb
operator|->
name|dshb_csnte
argument_list|,
literal|"CSNTE"
argument_list|)
expr_stmt|;
name|bfd_sym_display_table_summary
argument_list|(
name|f
argument_list|,
operator|&
name|dshb
operator|->
name|dshb_clte
argument_list|,
literal|"CLTE"
argument_list|)
expr_stmt|;
name|bfd_sym_display_table_summary
argument_list|(
name|f
argument_list|,
operator|&
name|dshb
operator|->
name|dshb_ctte
argument_list|,
literal|"CTTE"
argument_list|)
expr_stmt|;
name|bfd_sym_display_table_summary
argument_list|(
name|f
argument_list|,
operator|&
name|dshb
operator|->
name|dshb_tte
argument_list|,
literal|"TTE"
argument_list|)
expr_stmt|;
name|bfd_sym_display_table_summary
argument_list|(
name|f
argument_list|,
operator|&
name|dshb
operator|->
name|dshb_tinfo
argument_list|,
literal|"TINFO"
argument_list|)
expr_stmt|;
name|bfd_sym_display_table_summary
argument_list|(
name|f
argument_list|,
operator|&
name|dshb
operator|->
name|dshb_fite
argument_list|,
literal|"FITE"
argument_list|)
expr_stmt|;
name|bfd_sym_display_table_summary
argument_list|(
name|f
argument_list|,
operator|&
name|dshb
operator|->
name|dshb_const
argument_list|,
literal|"CONST"
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bfd_sym_parse_resources_table_entry_v32
parameter_list|(
name|buf
parameter_list|,
name|len
parameter_list|,
name|entry
parameter_list|)
name|unsigned
name|char
modifier|*
name|buf
decl_stmt|;
name|size_t
name|len
decl_stmt|;
name|bfd_sym_resources_table_entry
modifier|*
name|entry
decl_stmt|;
block|{
name|BFD_ASSERT
argument_list|(
name|len
operator|==
literal|18
argument_list|)
expr_stmt|;
name|memcpy
argument_list|(
operator|&
name|entry
operator|->
name|rte_res_type
argument_list|,
name|buf
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|entry
operator|->
name|rte_res_number
operator|=
name|bfd_getb16
argument_list|(
name|buf
operator|+
literal|4
argument_list|)
expr_stmt|;
name|entry
operator|->
name|rte_nte_index
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|6
argument_list|)
expr_stmt|;
name|entry
operator|->
name|rte_mte_first
operator|=
name|bfd_getb16
argument_list|(
name|buf
operator|+
literal|10
argument_list|)
expr_stmt|;
name|entry
operator|->
name|rte_mte_last
operator|=
name|bfd_getb16
argument_list|(
name|buf
operator|+
literal|12
argument_list|)
expr_stmt|;
name|entry
operator|->
name|rte_res_size
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|14
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bfd_sym_parse_modules_table_entry_v33
parameter_list|(
name|buf
parameter_list|,
name|len
parameter_list|,
name|entry
parameter_list|)
name|unsigned
name|char
modifier|*
name|buf
decl_stmt|;
name|size_t
name|len
decl_stmt|;
name|bfd_sym_modules_table_entry
modifier|*
name|entry
decl_stmt|;
block|{
name|BFD_ASSERT
argument_list|(
name|len
operator|==
literal|46
argument_list|)
expr_stmt|;
name|entry
operator|->
name|mte_rte_index
operator|=
name|bfd_getb16
argument_list|(
name|buf
argument_list|)
expr_stmt|;
name|entry
operator|->
name|mte_res_offset
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|2
argument_list|)
expr_stmt|;
name|entry
operator|->
name|mte_size
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|6
argument_list|)
expr_stmt|;
name|entry
operator|->
name|mte_kind
operator|=
name|buf
index|[
literal|10
index|]
expr_stmt|;
name|entry
operator|->
name|mte_scope
operator|=
name|buf
index|[
literal|11
index|]
expr_stmt|;
name|entry
operator|->
name|mte_parent
operator|=
name|bfd_getb16
argument_list|(
name|buf
operator|+
literal|12
argument_list|)
expr_stmt|;
name|bfd_sym_parse_file_reference_v32
argument_list|(
name|buf
operator|+
literal|14
argument_list|,
literal|6
argument_list|,
operator|&
name|entry
operator|->
name|mte_imp_fref
argument_list|)
expr_stmt|;
name|entry
operator|->
name|mte_imp_end
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|20
argument_list|)
expr_stmt|;
name|entry
operator|->
name|mte_nte_index
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|24
argument_list|)
expr_stmt|;
name|entry
operator|->
name|mte_cmte_index
operator|=
name|bfd_getb16
argument_list|(
name|buf
operator|+
literal|28
argument_list|)
expr_stmt|;
name|entry
operator|->
name|mte_cvte_index
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|30
argument_list|)
expr_stmt|;
name|entry
operator|->
name|mte_clte_index
operator|=
name|bfd_getb16
argument_list|(
name|buf
operator|+
literal|34
argument_list|)
expr_stmt|;
name|entry
operator|->
name|mte_ctte_index
operator|=
name|bfd_getb16
argument_list|(
name|buf
operator|+
literal|36
argument_list|)
expr_stmt|;
name|entry
operator|->
name|mte_csnte_idx_1
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|38
argument_list|)
expr_stmt|;
name|entry
operator|->
name|mte_csnte_idx_2
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|42
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bfd_sym_parse_file_references_table_entry_v32
parameter_list|(
name|buf
parameter_list|,
name|len
parameter_list|,
name|entry
parameter_list|)
name|unsigned
name|char
modifier|*
name|buf
decl_stmt|;
name|size_t
name|len
decl_stmt|;
name|bfd_sym_file_references_table_entry
modifier|*
name|entry
decl_stmt|;
block|{
name|unsigned
name|int
name|type
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|len
operator|==
literal|10
argument_list|)
expr_stmt|;
name|memset
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|bfd_sym_file_references_table_entry
argument_list|)
argument_list|)
expr_stmt|;
name|type
operator|=
name|bfd_getb16
argument_list|(
name|buf
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|type
condition|)
block|{
case|case
name|BFD_SYM_END_OF_LIST_3_2
case|:
name|entry
operator|->
name|generic
operator|.
name|type
operator|=
name|BFD_SYM_END_OF_LIST
expr_stmt|;
break|break;
case|case
name|BFD_SYM_FILE_NAME_INDEX_3_2
case|:
name|entry
operator|->
name|filename
operator|.
name|type
operator|=
name|BFD_SYM_FILE_NAME_INDEX
expr_stmt|;
name|entry
operator|->
name|filename
operator|.
name|nte_index
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|2
argument_list|)
expr_stmt|;
name|entry
operator|->
name|filename
operator|.
name|mod_date
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|6
argument_list|)
expr_stmt|;
break|break;
default|default:
name|entry
operator|->
name|entry
operator|.
name|mte_index
operator|=
name|type
expr_stmt|;
name|entry
operator|->
name|entry
operator|.
name|file_offset
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|2
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_parse_contained_modules_table_entry_v32
parameter_list|(
name|buf
parameter_list|,
name|len
parameter_list|,
name|entry
parameter_list|)
name|unsigned
name|char
modifier|*
name|buf
decl_stmt|;
name|size_t
name|len
decl_stmt|;
name|bfd_sym_contained_modules_table_entry
modifier|*
name|entry
decl_stmt|;
block|{
name|unsigned
name|int
name|type
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|len
operator|==
literal|6
argument_list|)
expr_stmt|;
name|memset
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|bfd_sym_contained_modules_table_entry
argument_list|)
argument_list|)
expr_stmt|;
name|type
operator|=
name|bfd_getb16
argument_list|(
name|buf
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|type
condition|)
block|{
case|case
name|BFD_SYM_END_OF_LIST_3_2
case|:
name|entry
operator|->
name|generic
operator|.
name|type
operator|=
name|BFD_SYM_END_OF_LIST
expr_stmt|;
break|break;
default|default:
name|entry
operator|->
name|entry
operator|.
name|mte_index
operator|=
name|type
expr_stmt|;
name|entry
operator|->
name|entry
operator|.
name|nte_index
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|2
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_parse_contained_variables_table_entry_v32
parameter_list|(
name|buf
parameter_list|,
name|len
parameter_list|,
name|entry
parameter_list|)
name|unsigned
name|char
modifier|*
name|buf
decl_stmt|;
name|size_t
name|len
decl_stmt|;
name|bfd_sym_contained_variables_table_entry
modifier|*
name|entry
decl_stmt|;
block|{
name|unsigned
name|int
name|type
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|len
operator|==
literal|26
argument_list|)
expr_stmt|;
name|memset
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|bfd_sym_contained_variables_table_entry
argument_list|)
argument_list|)
expr_stmt|;
name|type
operator|=
name|bfd_getb16
argument_list|(
name|buf
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|type
condition|)
block|{
case|case
name|BFD_SYM_END_OF_LIST_3_2
case|:
name|entry
operator|->
name|generic
operator|.
name|type
operator|=
name|BFD_SYM_END_OF_LIST
expr_stmt|;
break|break;
case|case
name|BFD_SYM_SOURCE_FILE_CHANGE_3_2
case|:
name|entry
operator|->
name|file
operator|.
name|type
operator|=
name|BFD_SYM_SOURCE_FILE_CHANGE
expr_stmt|;
name|bfd_sym_parse_file_reference_v32
argument_list|(
name|buf
operator|+
literal|2
argument_list|,
literal|6
argument_list|,
operator|&
name|entry
operator|->
name|file
operator|.
name|fref
argument_list|)
expr_stmt|;
break|break;
default|default:
name|entry
operator|->
name|entry
operator|.
name|tte_index
operator|=
name|type
expr_stmt|;
name|entry
operator|->
name|entry
operator|.
name|nte_index
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|2
argument_list|)
expr_stmt|;
name|entry
operator|->
name|entry
operator|.
name|file_delta
operator|=
name|bfd_getb16
argument_list|(
name|buf
operator|+
literal|6
argument_list|)
expr_stmt|;
name|entry
operator|->
name|entry
operator|.
name|scope
operator|=
name|buf
index|[
literal|8
index|]
expr_stmt|;
name|entry
operator|->
name|entry
operator|.
name|la_size
operator|=
name|buf
index|[
literal|9
index|]
expr_stmt|;
if|if
condition|(
name|entry
operator|->
name|entry
operator|.
name|la_size
operator|==
name|BFD_SYM_CVTE_SCA
condition|)
block|{
name|entry
operator|->
name|entry
operator|.
name|address
operator|.
name|scstruct
operator|.
name|sca_kind
operator|=
name|buf
index|[
literal|10
index|]
expr_stmt|;
name|entry
operator|->
name|entry
operator|.
name|address
operator|.
name|scstruct
operator|.
name|sca_class
operator|=
name|buf
index|[
literal|11
index|]
expr_stmt|;
name|entry
operator|->
name|entry
operator|.
name|address
operator|.
name|scstruct
operator|.
name|sca_offset
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|12
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|entry
operator|->
name|entry
operator|.
name|la_size
operator|<=
name|BFD_SYM_CVTE_SCA
condition|)
block|{
name|memcpy
argument_list|(
operator|&
name|entry
operator|->
name|entry
operator|.
name|address
operator|.
name|lastruct
operator|.
name|la
argument_list|,
name|buf
operator|+
literal|10
argument_list|,
name|BFD_SYM_CVTE_SCA
argument_list|)
expr_stmt|;
name|entry
operator|->
name|entry
operator|.
name|address
operator|.
name|lastruct
operator|.
name|la_kind
operator|=
name|buf
index|[
literal|23
index|]
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|entry
operator|->
name|entry
operator|.
name|la_size
operator|==
name|BFD_SYM_CVTE_BIG_LA
condition|)
block|{
name|entry
operator|->
name|entry
operator|.
name|address
operator|.
name|biglastruct
operator|.
name|big_la
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|10
argument_list|)
expr_stmt|;
name|entry
operator|->
name|entry
operator|.
name|address
operator|.
name|biglastruct
operator|.
name|big_la_kind
operator|=
name|buf
index|[
literal|12
index|]
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_parse_contained_statements_table_entry_v32
parameter_list|(
name|buf
parameter_list|,
name|len
parameter_list|,
name|entry
parameter_list|)
name|unsigned
name|char
modifier|*
name|buf
decl_stmt|;
name|size_t
name|len
decl_stmt|;
name|bfd_sym_contained_statements_table_entry
modifier|*
name|entry
decl_stmt|;
block|{
name|unsigned
name|int
name|type
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|len
operator|==
literal|8
argument_list|)
expr_stmt|;
name|memset
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|bfd_sym_contained_statements_table_entry
argument_list|)
argument_list|)
expr_stmt|;
name|type
operator|=
name|bfd_getb16
argument_list|(
name|buf
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|type
condition|)
block|{
case|case
name|BFD_SYM_END_OF_LIST_3_2
case|:
name|entry
operator|->
name|generic
operator|.
name|type
operator|=
name|BFD_SYM_END_OF_LIST
expr_stmt|;
break|break;
case|case
name|BFD_SYM_SOURCE_FILE_CHANGE_3_2
case|:
name|entry
operator|->
name|file
operator|.
name|type
operator|=
name|BFD_SYM_SOURCE_FILE_CHANGE
expr_stmt|;
name|bfd_sym_parse_file_reference_v32
argument_list|(
name|buf
operator|+
literal|2
argument_list|,
literal|6
argument_list|,
operator|&
name|entry
operator|->
name|file
operator|.
name|fref
argument_list|)
expr_stmt|;
break|break;
default|default:
name|entry
operator|->
name|entry
operator|.
name|mte_index
operator|=
name|type
expr_stmt|;
name|entry
operator|->
name|entry
operator|.
name|mte_offset
operator|=
name|bfd_getb16
argument_list|(
name|buf
operator|+
literal|2
argument_list|)
expr_stmt|;
name|entry
operator|->
name|entry
operator|.
name|file_delta
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|4
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_parse_contained_labels_table_entry_v32
parameter_list|(
name|buf
parameter_list|,
name|len
parameter_list|,
name|entry
parameter_list|)
name|unsigned
name|char
modifier|*
name|buf
decl_stmt|;
name|size_t
name|len
decl_stmt|;
name|bfd_sym_contained_labels_table_entry
modifier|*
name|entry
decl_stmt|;
block|{
name|unsigned
name|int
name|type
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|len
operator|==
literal|12
argument_list|)
expr_stmt|;
name|memset
argument_list|(
name|entry
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|bfd_sym_contained_labels_table_entry
argument_list|)
argument_list|)
expr_stmt|;
name|type
operator|=
name|bfd_getb16
argument_list|(
name|buf
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|type
condition|)
block|{
case|case
name|BFD_SYM_END_OF_LIST_3_2
case|:
name|entry
operator|->
name|generic
operator|.
name|type
operator|=
name|BFD_SYM_END_OF_LIST
expr_stmt|;
break|break;
case|case
name|BFD_SYM_SOURCE_FILE_CHANGE_3_2
case|:
name|entry
operator|->
name|file
operator|.
name|type
operator|=
name|BFD_SYM_SOURCE_FILE_CHANGE
expr_stmt|;
name|bfd_sym_parse_file_reference_v32
argument_list|(
name|buf
operator|+
literal|2
argument_list|,
literal|6
argument_list|,
operator|&
name|entry
operator|->
name|file
operator|.
name|fref
argument_list|)
expr_stmt|;
break|break;
default|default:
name|entry
operator|->
name|entry
operator|.
name|mte_index
operator|=
name|type
expr_stmt|;
name|entry
operator|->
name|entry
operator|.
name|mte_offset
operator|=
name|bfd_getb16
argument_list|(
name|buf
operator|+
literal|2
argument_list|)
expr_stmt|;
name|entry
operator|->
name|entry
operator|.
name|nte_index
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
literal|4
argument_list|)
expr_stmt|;
name|entry
operator|->
name|entry
operator|.
name|file_delta
operator|=
name|bfd_getb16
argument_list|(
name|buf
operator|+
literal|8
argument_list|)
expr_stmt|;
name|entry
operator|->
name|entry
operator|.
name|scope
operator|=
name|bfd_getb16
argument_list|(
name|buf
operator|+
literal|10
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_parse_type_table_entry_v32
parameter_list|(
name|buf
parameter_list|,
name|len
parameter_list|,
name|entry
parameter_list|)
name|unsigned
name|char
modifier|*
name|buf
decl_stmt|;
name|size_t
name|len
decl_stmt|;
name|bfd_sym_type_table_entry
modifier|*
name|entry
decl_stmt|;
block|{
name|BFD_ASSERT
argument_list|(
name|len
operator|==
literal|4
argument_list|)
expr_stmt|;
operator|*
name|entry
operator|=
name|bfd_getb32
argument_list|(
name|buf
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|int
name|bfd_sym_fetch_resources_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|entry
parameter_list|,
name|index
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_resources_table_entry
modifier|*
name|entry
decl_stmt|;
name|unsigned
name|long
name|index
decl_stmt|;
block|{
name|void
argument_list|(
argument|*parser
argument_list|)
name|PARAMS
argument_list|(
operator|(
name|unsigned
name|char
operator|*
operator|,
name|size_t
operator|,
name|bfd_sym_resources_table_entry
operator|*
operator|)
argument_list|)
expr_stmt|;
name|unsigned
name|long
name|offset
decl_stmt|;
name|unsigned
name|long
name|entry_size
decl_stmt|;
name|unsigned
name|char
name|buf
index|[
literal|18
index|]
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|parser
operator|=
name|NULL
expr_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
if|if
condition|(
name|index
operator|==
literal|0
condition|)
return|return
operator|-
literal|1
return|;
switch|switch
condition|(
name|sdata
operator|->
name|version
condition|)
block|{
case|case
name|BFD_SYM_VERSION_3_5
case|:
case|case
name|BFD_SYM_VERSION_3_4
case|:
return|return
operator|-
literal|1
return|;
case|case
name|BFD_SYM_VERSION_3_3
case|:
case|case
name|BFD_SYM_VERSION_3_2
case|:
name|entry_size
operator|=
literal|18
expr_stmt|;
name|parser
operator|=
name|bfd_sym_parse_resources_table_entry_v32
expr_stmt|;
break|break;
case|case
name|BFD_SYM_VERSION_3_1
case|:
default|default:
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
name|parser
operator|==
name|NULL
condition|)
return|return
operator|-
literal|1
return|;
name|offset
operator|=
name|compute_offset
argument_list|(
name|sdata
operator|->
name|header
operator|.
name|dshb_rte
operator|.
name|dti_first_page
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_page_size
argument_list|,
name|entry_size
argument_list|,
name|index
argument_list|)
expr_stmt|;
if|if
condition|(
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
name|offset
argument_list|,
name|SEEK_SET
argument_list|)
operator|<
literal|0
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|bfd_bread
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|abfd
argument_list|)
operator|!=
name|entry_size
condition|)
return|return
operator|-
literal|1
return|;
call|(
modifier|*
name|parser
call|)
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|entry
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|bfd_sym_fetch_modules_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|entry
parameter_list|,
name|index
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_modules_table_entry
modifier|*
name|entry
decl_stmt|;
name|unsigned
name|long
name|index
decl_stmt|;
block|{
name|void
argument_list|(
argument|*parser
argument_list|)
name|PARAMS
argument_list|(
operator|(
name|unsigned
name|char
operator|*
operator|,
name|size_t
operator|,
name|bfd_sym_modules_table_entry
operator|*
operator|)
argument_list|)
expr_stmt|;
name|unsigned
name|long
name|offset
decl_stmt|;
name|unsigned
name|long
name|entry_size
decl_stmt|;
name|unsigned
name|char
name|buf
index|[
literal|46
index|]
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|parser
operator|=
name|NULL
expr_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
if|if
condition|(
name|index
operator|==
literal|0
condition|)
return|return
operator|-
literal|1
return|;
switch|switch
condition|(
name|sdata
operator|->
name|version
condition|)
block|{
case|case
name|BFD_SYM_VERSION_3_5
case|:
case|case
name|BFD_SYM_VERSION_3_4
case|:
return|return
operator|-
literal|1
return|;
case|case
name|BFD_SYM_VERSION_3_3
case|:
name|entry_size
operator|=
literal|46
expr_stmt|;
name|parser
operator|=
name|bfd_sym_parse_modules_table_entry_v33
expr_stmt|;
break|break;
case|case
name|BFD_SYM_VERSION_3_2
case|:
case|case
name|BFD_SYM_VERSION_3_1
case|:
default|default:
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
name|parser
operator|==
name|NULL
condition|)
return|return
operator|-
literal|1
return|;
name|offset
operator|=
name|compute_offset
argument_list|(
name|sdata
operator|->
name|header
operator|.
name|dshb_mte
operator|.
name|dti_first_page
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_page_size
argument_list|,
name|entry_size
argument_list|,
name|index
argument_list|)
expr_stmt|;
if|if
condition|(
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
name|offset
argument_list|,
name|SEEK_SET
argument_list|)
operator|<
literal|0
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|bfd_bread
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|abfd
argument_list|)
operator|!=
name|entry_size
condition|)
return|return
operator|-
literal|1
return|;
call|(
modifier|*
name|parser
call|)
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|entry
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|bfd_sym_fetch_file_references_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|entry
parameter_list|,
name|index
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_file_references_table_entry
modifier|*
name|entry
decl_stmt|;
name|unsigned
name|long
name|index
decl_stmt|;
block|{
name|void
argument_list|(
argument|*parser
argument_list|)
name|PARAMS
argument_list|(
operator|(
name|unsigned
name|char
operator|*
operator|,
name|size_t
operator|,
name|bfd_sym_file_references_table_entry
operator|*
operator|)
argument_list|)
expr_stmt|;
name|unsigned
name|long
name|offset
decl_stmt|;
name|unsigned
name|long
name|entry_size
init|=
literal|0
decl_stmt|;
name|unsigned
name|char
name|buf
index|[
literal|8
index|]
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|parser
operator|=
name|NULL
expr_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
if|if
condition|(
name|index
operator|==
literal|0
condition|)
return|return
operator|-
literal|1
return|;
switch|switch
condition|(
name|sdata
operator|->
name|version
condition|)
block|{
case|case
name|BFD_SYM_VERSION_3_3
case|:
case|case
name|BFD_SYM_VERSION_3_2
case|:
name|entry_size
operator|=
literal|10
expr_stmt|;
name|parser
operator|=
name|bfd_sym_parse_file_references_table_entry_v32
expr_stmt|;
break|break;
case|case
name|BFD_SYM_VERSION_3_5
case|:
case|case
name|BFD_SYM_VERSION_3_4
case|:
case|case
name|BFD_SYM_VERSION_3_1
case|:
default|default:
break|break;
block|}
if|if
condition|(
name|parser
operator|==
name|NULL
condition|)
return|return
operator|-
literal|1
return|;
name|offset
operator|=
name|compute_offset
argument_list|(
name|sdata
operator|->
name|header
operator|.
name|dshb_frte
operator|.
name|dti_first_page
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_page_size
argument_list|,
name|entry_size
argument_list|,
name|index
argument_list|)
expr_stmt|;
if|if
condition|(
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
name|offset
argument_list|,
name|SEEK_SET
argument_list|)
operator|<
literal|0
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|bfd_bread
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|abfd
argument_list|)
operator|!=
name|entry_size
condition|)
return|return
operator|-
literal|1
return|;
call|(
modifier|*
name|parser
call|)
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|entry
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|bfd_sym_fetch_contained_modules_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|entry
parameter_list|,
name|index
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_contained_modules_table_entry
modifier|*
name|entry
decl_stmt|;
name|unsigned
name|long
name|index
decl_stmt|;
block|{
name|void
argument_list|(
argument|*parser
argument_list|)
name|PARAMS
argument_list|(
operator|(
name|unsigned
name|char
operator|*
operator|,
name|size_t
operator|,
name|bfd_sym_contained_modules_table_entry
operator|*
operator|)
argument_list|)
expr_stmt|;
name|unsigned
name|long
name|offset
decl_stmt|;
name|unsigned
name|long
name|entry_size
init|=
literal|0
decl_stmt|;
name|unsigned
name|char
name|buf
index|[
literal|6
index|]
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|parser
operator|=
name|NULL
expr_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
if|if
condition|(
name|index
operator|==
literal|0
condition|)
return|return
operator|-
literal|1
return|;
switch|switch
condition|(
name|sdata
operator|->
name|version
condition|)
block|{
case|case
name|BFD_SYM_VERSION_3_3
case|:
case|case
name|BFD_SYM_VERSION_3_2
case|:
name|entry_size
operator|=
literal|6
expr_stmt|;
name|parser
operator|=
name|bfd_sym_parse_contained_modules_table_entry_v32
expr_stmt|;
break|break;
case|case
name|BFD_SYM_VERSION_3_5
case|:
case|case
name|BFD_SYM_VERSION_3_4
case|:
case|case
name|BFD_SYM_VERSION_3_1
case|:
default|default:
break|break;
block|}
if|if
condition|(
name|parser
operator|==
name|NULL
condition|)
return|return
operator|-
literal|1
return|;
name|offset
operator|=
name|compute_offset
argument_list|(
name|sdata
operator|->
name|header
operator|.
name|dshb_cmte
operator|.
name|dti_first_page
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_page_size
argument_list|,
name|entry_size
argument_list|,
name|index
argument_list|)
expr_stmt|;
if|if
condition|(
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
name|offset
argument_list|,
name|SEEK_SET
argument_list|)
operator|<
literal|0
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|bfd_bread
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|abfd
argument_list|)
operator|!=
name|entry_size
condition|)
return|return
operator|-
literal|1
return|;
call|(
modifier|*
name|parser
call|)
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|entry
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|bfd_sym_fetch_contained_variables_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|entry
parameter_list|,
name|index
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_contained_variables_table_entry
modifier|*
name|entry
decl_stmt|;
name|unsigned
name|long
name|index
decl_stmt|;
block|{
name|void
argument_list|(
argument|*parser
argument_list|)
name|PARAMS
argument_list|(
operator|(
name|unsigned
name|char
operator|*
operator|,
name|size_t
operator|,
name|bfd_sym_contained_variables_table_entry
operator|*
operator|)
argument_list|)
expr_stmt|;
name|unsigned
name|long
name|offset
decl_stmt|;
name|unsigned
name|long
name|entry_size
init|=
literal|0
decl_stmt|;
name|unsigned
name|char
name|buf
index|[
literal|26
index|]
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|parser
operator|=
name|NULL
expr_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
if|if
condition|(
name|index
operator|==
literal|0
condition|)
return|return
operator|-
literal|1
return|;
switch|switch
condition|(
name|sdata
operator|->
name|version
condition|)
block|{
case|case
name|BFD_SYM_VERSION_3_3
case|:
case|case
name|BFD_SYM_VERSION_3_2
case|:
name|entry_size
operator|=
literal|26
expr_stmt|;
name|parser
operator|=
name|bfd_sym_parse_contained_variables_table_entry_v32
expr_stmt|;
break|break;
case|case
name|BFD_SYM_VERSION_3_5
case|:
case|case
name|BFD_SYM_VERSION_3_4
case|:
case|case
name|BFD_SYM_VERSION_3_1
case|:
default|default:
break|break;
block|}
if|if
condition|(
name|parser
operator|==
name|NULL
condition|)
return|return
operator|-
literal|1
return|;
name|offset
operator|=
name|compute_offset
argument_list|(
name|sdata
operator|->
name|header
operator|.
name|dshb_cvte
operator|.
name|dti_first_page
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_page_size
argument_list|,
name|entry_size
argument_list|,
name|index
argument_list|)
expr_stmt|;
if|if
condition|(
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
name|offset
argument_list|,
name|SEEK_SET
argument_list|)
operator|<
literal|0
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|bfd_bread
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|abfd
argument_list|)
operator|!=
name|entry_size
condition|)
return|return
operator|-
literal|1
return|;
call|(
modifier|*
name|parser
call|)
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|entry
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|bfd_sym_fetch_contained_statements_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|entry
parameter_list|,
name|index
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_contained_statements_table_entry
modifier|*
name|entry
decl_stmt|;
name|unsigned
name|long
name|index
decl_stmt|;
block|{
name|void
argument_list|(
argument|*parser
argument_list|)
name|PARAMS
argument_list|(
operator|(
name|unsigned
name|char
operator|*
operator|,
name|size_t
operator|,
name|bfd_sym_contained_statements_table_entry
operator|*
operator|)
argument_list|)
expr_stmt|;
name|unsigned
name|long
name|offset
decl_stmt|;
name|unsigned
name|long
name|entry_size
init|=
literal|0
decl_stmt|;
name|unsigned
name|char
name|buf
index|[
literal|8
index|]
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|parser
operator|=
name|NULL
expr_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
if|if
condition|(
name|index
operator|==
literal|0
condition|)
return|return
operator|-
literal|1
return|;
switch|switch
condition|(
name|sdata
operator|->
name|version
condition|)
block|{
case|case
name|BFD_SYM_VERSION_3_3
case|:
case|case
name|BFD_SYM_VERSION_3_2
case|:
name|entry_size
operator|=
literal|8
expr_stmt|;
name|parser
operator|=
name|bfd_sym_parse_contained_statements_table_entry_v32
expr_stmt|;
break|break;
case|case
name|BFD_SYM_VERSION_3_5
case|:
case|case
name|BFD_SYM_VERSION_3_4
case|:
case|case
name|BFD_SYM_VERSION_3_1
case|:
default|default:
break|break;
block|}
if|if
condition|(
name|parser
operator|==
name|NULL
condition|)
return|return
operator|-
literal|1
return|;
name|offset
operator|=
name|compute_offset
argument_list|(
name|sdata
operator|->
name|header
operator|.
name|dshb_csnte
operator|.
name|dti_first_page
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_page_size
argument_list|,
name|entry_size
argument_list|,
name|index
argument_list|)
expr_stmt|;
if|if
condition|(
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
name|offset
argument_list|,
name|SEEK_SET
argument_list|)
operator|<
literal|0
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|bfd_bread
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|abfd
argument_list|)
operator|!=
name|entry_size
condition|)
return|return
operator|-
literal|1
return|;
call|(
modifier|*
name|parser
call|)
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|entry
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|bfd_sym_fetch_contained_labels_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|entry
parameter_list|,
name|index
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_contained_labels_table_entry
modifier|*
name|entry
decl_stmt|;
name|unsigned
name|long
name|index
decl_stmt|;
block|{
name|void
argument_list|(
argument|*parser
argument_list|)
name|PARAMS
argument_list|(
operator|(
name|unsigned
name|char
operator|*
operator|,
name|size_t
operator|,
name|bfd_sym_contained_labels_table_entry
operator|*
operator|)
argument_list|)
expr_stmt|;
name|unsigned
name|long
name|offset
decl_stmt|;
name|unsigned
name|long
name|entry_size
init|=
literal|0
decl_stmt|;
name|unsigned
name|char
name|buf
index|[
literal|12
index|]
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|parser
operator|=
name|NULL
expr_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
if|if
condition|(
name|index
operator|==
literal|0
condition|)
return|return
operator|-
literal|1
return|;
switch|switch
condition|(
name|sdata
operator|->
name|version
condition|)
block|{
case|case
name|BFD_SYM_VERSION_3_3
case|:
case|case
name|BFD_SYM_VERSION_3_2
case|:
name|entry_size
operator|=
literal|12
expr_stmt|;
name|parser
operator|=
name|bfd_sym_parse_contained_labels_table_entry_v32
expr_stmt|;
break|break;
case|case
name|BFD_SYM_VERSION_3_5
case|:
case|case
name|BFD_SYM_VERSION_3_4
case|:
case|case
name|BFD_SYM_VERSION_3_1
case|:
default|default:
break|break;
block|}
if|if
condition|(
name|parser
operator|==
name|NULL
condition|)
return|return
operator|-
literal|1
return|;
name|offset
operator|=
name|compute_offset
argument_list|(
name|sdata
operator|->
name|header
operator|.
name|dshb_clte
operator|.
name|dti_first_page
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_page_size
argument_list|,
name|entry_size
argument_list|,
name|index
argument_list|)
expr_stmt|;
if|if
condition|(
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
name|offset
argument_list|,
name|SEEK_SET
argument_list|)
operator|<
literal|0
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|bfd_bread
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|abfd
argument_list|)
operator|!=
name|entry_size
condition|)
return|return
operator|-
literal|1
return|;
call|(
modifier|*
name|parser
call|)
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|entry
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|bfd_sym_fetch_contained_types_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|entry
parameter_list|,
name|index
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_contained_types_table_entry
modifier|*
name|entry
decl_stmt|;
name|unsigned
name|long
name|index
decl_stmt|;
block|{
name|void
argument_list|(
argument|*parser
argument_list|)
name|PARAMS
argument_list|(
operator|(
name|unsigned
name|char
operator|*
operator|,
name|size_t
operator|,
name|bfd_sym_contained_types_table_entry
operator|*
operator|)
argument_list|)
expr_stmt|;
name|unsigned
name|long
name|offset
decl_stmt|;
name|unsigned
name|long
name|entry_size
init|=
literal|0
decl_stmt|;
name|unsigned
name|char
name|buf
index|[
literal|0
index|]
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|parser
operator|=
name|NULL
expr_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
if|if
condition|(
name|index
operator|==
literal|0
condition|)
return|return
operator|-
literal|1
return|;
switch|switch
condition|(
name|sdata
operator|->
name|version
condition|)
block|{
case|case
name|BFD_SYM_VERSION_3_3
case|:
case|case
name|BFD_SYM_VERSION_3_2
case|:
name|entry_size
operator|=
literal|0
expr_stmt|;
name|parser
operator|=
name|NULL
expr_stmt|;
break|break;
case|case
name|BFD_SYM_VERSION_3_5
case|:
case|case
name|BFD_SYM_VERSION_3_4
case|:
case|case
name|BFD_SYM_VERSION_3_1
case|:
default|default:
break|break;
block|}
if|if
condition|(
name|parser
operator|==
name|NULL
condition|)
return|return
operator|-
literal|1
return|;
name|offset
operator|=
name|compute_offset
argument_list|(
name|sdata
operator|->
name|header
operator|.
name|dshb_ctte
operator|.
name|dti_first_page
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_page_size
argument_list|,
name|entry_size
argument_list|,
name|index
argument_list|)
expr_stmt|;
if|if
condition|(
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
name|offset
argument_list|,
name|SEEK_SET
argument_list|)
operator|<
literal|0
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|bfd_bread
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|abfd
argument_list|)
operator|!=
name|entry_size
condition|)
return|return
operator|-
literal|1
return|;
call|(
modifier|*
name|parser
call|)
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|entry
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|bfd_sym_fetch_file_references_index_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|entry
parameter_list|,
name|index
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_file_references_index_table_entry
modifier|*
name|entry
decl_stmt|;
name|unsigned
name|long
name|index
decl_stmt|;
block|{
name|void
argument_list|(
argument|*parser
argument_list|)
name|PARAMS
argument_list|(
operator|(
name|unsigned
name|char
operator|*
operator|,
name|size_t
operator|,
name|bfd_sym_file_references_index_table_entry
operator|*
operator|)
argument_list|)
expr_stmt|;
name|unsigned
name|long
name|offset
decl_stmt|;
name|unsigned
name|long
name|entry_size
init|=
literal|0
decl_stmt|;
name|unsigned
name|char
name|buf
index|[
literal|0
index|]
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|parser
operator|=
name|NULL
expr_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
if|if
condition|(
name|index
operator|==
literal|0
condition|)
return|return
operator|-
literal|1
return|;
switch|switch
condition|(
name|sdata
operator|->
name|version
condition|)
block|{
case|case
name|BFD_SYM_VERSION_3_3
case|:
case|case
name|BFD_SYM_VERSION_3_2
case|:
name|entry_size
operator|=
literal|0
expr_stmt|;
name|parser
operator|=
name|NULL
expr_stmt|;
break|break;
case|case
name|BFD_SYM_VERSION_3_5
case|:
case|case
name|BFD_SYM_VERSION_3_4
case|:
case|case
name|BFD_SYM_VERSION_3_1
case|:
default|default:
break|break;
block|}
if|if
condition|(
name|parser
operator|==
name|NULL
condition|)
return|return
operator|-
literal|1
return|;
name|offset
operator|=
name|compute_offset
argument_list|(
name|sdata
operator|->
name|header
operator|.
name|dshb_fite
operator|.
name|dti_first_page
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_page_size
argument_list|,
name|entry_size
argument_list|,
name|index
argument_list|)
expr_stmt|;
if|if
condition|(
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
name|offset
argument_list|,
name|SEEK_SET
argument_list|)
operator|<
literal|0
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|bfd_bread
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|abfd
argument_list|)
operator|!=
name|entry_size
condition|)
return|return
operator|-
literal|1
return|;
call|(
modifier|*
name|parser
call|)
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|entry
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|bfd_sym_fetch_constant_pool_entry
parameter_list|(
name|abfd
parameter_list|,
name|entry
parameter_list|,
name|index
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_constant_pool_entry
modifier|*
name|entry
decl_stmt|;
name|unsigned
name|long
name|index
decl_stmt|;
block|{
name|void
argument_list|(
argument|*parser
argument_list|)
name|PARAMS
argument_list|(
operator|(
name|unsigned
name|char
operator|*
operator|,
name|size_t
operator|,
name|bfd_sym_constant_pool_entry
operator|*
operator|)
argument_list|)
expr_stmt|;
name|unsigned
name|long
name|offset
decl_stmt|;
name|unsigned
name|long
name|entry_size
init|=
literal|0
decl_stmt|;
name|unsigned
name|char
name|buf
index|[
literal|0
index|]
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|parser
operator|=
name|NULL
expr_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
if|if
condition|(
name|index
operator|==
literal|0
condition|)
return|return
operator|-
literal|1
return|;
switch|switch
condition|(
name|sdata
operator|->
name|version
condition|)
block|{
case|case
name|BFD_SYM_VERSION_3_3
case|:
case|case
name|BFD_SYM_VERSION_3_2
case|:
name|entry_size
operator|=
literal|0
expr_stmt|;
name|parser
operator|=
name|NULL
expr_stmt|;
break|break;
case|case
name|BFD_SYM_VERSION_3_5
case|:
case|case
name|BFD_SYM_VERSION_3_4
case|:
case|case
name|BFD_SYM_VERSION_3_1
case|:
default|default:
break|break;
block|}
if|if
condition|(
name|parser
operator|==
name|NULL
condition|)
return|return
operator|-
literal|1
return|;
name|offset
operator|=
name|compute_offset
argument_list|(
name|sdata
operator|->
name|header
operator|.
name|dshb_fite
operator|.
name|dti_first_page
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_page_size
argument_list|,
name|entry_size
argument_list|,
name|index
argument_list|)
expr_stmt|;
if|if
condition|(
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
name|offset
argument_list|,
name|SEEK_SET
argument_list|)
operator|<
literal|0
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|bfd_bread
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|abfd
argument_list|)
operator|!=
name|entry_size
condition|)
return|return
operator|-
literal|1
return|;
call|(
modifier|*
name|parser
call|)
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|entry
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|bfd_sym_fetch_type_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|entry
parameter_list|,
name|index
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_type_table_entry
modifier|*
name|entry
decl_stmt|;
name|unsigned
name|long
name|index
decl_stmt|;
block|{
name|void
argument_list|(
argument|*parser
argument_list|)
name|PARAMS
argument_list|(
operator|(
name|unsigned
name|char
operator|*
operator|,
name|size_t
operator|,
name|bfd_sym_type_table_entry
operator|*
operator|)
argument_list|)
expr_stmt|;
name|unsigned
name|long
name|offset
decl_stmt|;
name|unsigned
name|long
name|entry_size
init|=
literal|0
decl_stmt|;
name|unsigned
name|char
name|buf
index|[
literal|4
index|]
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|parser
operator|=
name|NULL
expr_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
switch|switch
condition|(
name|sdata
operator|->
name|version
condition|)
block|{
case|case
name|BFD_SYM_VERSION_3_3
case|:
case|case
name|BFD_SYM_VERSION_3_2
case|:
name|entry_size
operator|=
literal|4
expr_stmt|;
name|parser
operator|=
name|bfd_sym_parse_type_table_entry_v32
expr_stmt|;
break|break;
case|case
name|BFD_SYM_VERSION_3_5
case|:
case|case
name|BFD_SYM_VERSION_3_4
case|:
case|case
name|BFD_SYM_VERSION_3_1
case|:
default|default:
break|break;
block|}
if|if
condition|(
name|parser
operator|==
name|NULL
condition|)
return|return
operator|-
literal|1
return|;
name|offset
operator|=
name|compute_offset
argument_list|(
name|sdata
operator|->
name|header
operator|.
name|dshb_tte
operator|.
name|dti_first_page
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_page_size
argument_list|,
name|entry_size
argument_list|,
name|index
argument_list|)
expr_stmt|;
if|if
condition|(
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
name|offset
argument_list|,
name|SEEK_SET
argument_list|)
operator|<
literal|0
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|bfd_bread
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|abfd
argument_list|)
operator|!=
name|entry_size
condition|)
return|return
operator|-
literal|1
return|;
call|(
modifier|*
name|parser
call|)
argument_list|(
name|buf
argument_list|,
name|entry_size
argument_list|,
name|entry
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|bfd_sym_fetch_type_information_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|entry
parameter_list|,
name|offset
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_type_information_table_entry
modifier|*
name|entry
decl_stmt|;
name|unsigned
name|long
name|offset
decl_stmt|;
block|{
name|unsigned
name|char
name|buf
index|[
literal|4
index|]
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
if|if
condition|(
name|offset
operator|==
literal|0
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
name|offset
argument_list|,
name|SEEK_SET
argument_list|)
operator|<
literal|0
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|bfd_bread
argument_list|(
name|buf
argument_list|,
literal|4
argument_list|,
name|abfd
argument_list|)
operator|!=
literal|4
condition|)
return|return
operator|-
literal|1
return|;
name|entry
operator|->
name|nte_index
operator|=
name|bfd_getb32
argument_list|(
name|buf
argument_list|)
expr_stmt|;
if|if
condition|(
name|bfd_bread
argument_list|(
name|buf
argument_list|,
literal|2
argument_list|,
name|abfd
argument_list|)
operator|!=
literal|2
condition|)
return|return
operator|-
literal|1
return|;
name|entry
operator|->
name|physical_size
operator|=
name|bfd_getb16
argument_list|(
name|buf
argument_list|)
expr_stmt|;
if|if
condition|(
name|entry
operator|->
name|physical_size
operator|&
literal|0x8000
condition|)
block|{
if|if
condition|(
name|bfd_bread
argument_list|(
name|buf
argument_list|,
literal|4
argument_list|,
name|abfd
argument_list|)
operator|!=
literal|4
condition|)
return|return
operator|-
literal|1
return|;
name|entry
operator|->
name|physical_size
operator|&=
literal|0x7fff
expr_stmt|;
name|entry
operator|->
name|logical_size
operator|=
name|bfd_getb32
argument_list|(
name|buf
argument_list|)
expr_stmt|;
name|entry
operator|->
name|offset
operator|=
name|offset
operator|+
literal|10
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|bfd_bread
argument_list|(
name|buf
argument_list|,
literal|2
argument_list|,
name|abfd
argument_list|)
operator|!=
literal|2
condition|)
return|return
operator|-
literal|1
return|;
name|entry
operator|->
name|physical_size
operator|&=
literal|0x7fff
expr_stmt|;
name|entry
operator|->
name|logical_size
operator|=
name|bfd_getb16
argument_list|(
name|buf
argument_list|)
expr_stmt|;
name|entry
operator|->
name|offset
operator|=
name|offset
operator|+
literal|8
expr_stmt|;
block|}
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|bfd_sym_fetch_type_table_information
parameter_list|(
name|abfd
parameter_list|,
name|entry
parameter_list|,
name|index
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_type_information_table_entry
modifier|*
name|entry
decl_stmt|;
name|unsigned
name|long
name|index
decl_stmt|;
block|{
name|bfd_sym_type_table_entry
name|tindex
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
if|if
condition|(
name|sdata
operator|->
name|header
operator|.
name|dshb_tte
operator|.
name|dti_object_count
operator|<=
literal|99
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|index
operator|<
literal|100
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|bfd_sym_fetch_type_table_entry
argument_list|(
name|abfd
argument_list|,
operator|&
name|tindex
argument_list|,
name|index
operator|-
literal|100
argument_list|)
operator|<
literal|0
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|bfd_sym_fetch_type_information_table_entry
argument_list|(
name|abfd
argument_list|,
name|entry
argument_list|,
name|tindex
argument_list|)
operator|<
literal|0
condition|)
return|return
operator|-
literal|1
return|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|const
name|unsigned
name|char
modifier|*
name|bfd_sym_symbol_name
parameter_list|(
name|abfd
parameter_list|,
name|index
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|unsigned
name|long
name|index
decl_stmt|;
block|{
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
if|if
condition|(
name|index
operator|==
literal|0
condition|)
return|return
literal|""
return|;
name|index
operator|*=
literal|2
expr_stmt|;
if|if
condition|(
operator|(
name|index
operator|/
name|sdata
operator|->
name|header
operator|.
name|dshb_page_size
operator|)
operator|>
name|sdata
operator|->
name|header
operator|.
name|dshb_nte
operator|.
name|dti_page_count
condition|)
return|return
literal|"\009[INVALID]"
return|;
return|return
operator|(
specifier|const
name|unsigned
name|char
operator|*
operator|)
name|sdata
operator|->
name|name_table
operator|+
name|index
return|;
block|}
end_function

begin_function
specifier|const
name|unsigned
name|char
modifier|*
name|bfd_sym_module_name
parameter_list|(
name|abfd
parameter_list|,
name|index
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|unsigned
name|long
name|index
decl_stmt|;
block|{
name|bfd_sym_modules_table_entry
name|entry
decl_stmt|;
if|if
condition|(
name|bfd_sym_fetch_modules_table_entry
argument_list|(
name|abfd
argument_list|,
operator|&
name|entry
argument_list|,
name|index
argument_list|)
operator|<
literal|0
condition|)
return|return
literal|"\011[INVALID]"
return|;
return|return
name|bfd_sym_symbol_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|.
name|mte_nte_index
argument_list|)
return|;
block|}
end_function

begin_function
specifier|const
name|char
modifier|*
name|bfd_sym_unparse_storage_kind
parameter_list|(
name|kind
parameter_list|)
name|enum
name|bfd_sym_storage_kind
name|kind
decl_stmt|;
block|{
switch|switch
condition|(
name|kind
condition|)
block|{
case|case
name|BFD_SYM_STORAGE_KIND_LOCAL
case|:
return|return
literal|"LOCAL"
return|;
case|case
name|BFD_SYM_STORAGE_KIND_VALUE
case|:
return|return
literal|"VALUE"
return|;
case|case
name|BFD_SYM_STORAGE_KIND_REFERENCE
case|:
return|return
literal|"REFERENCE"
return|;
case|case
name|BFD_SYM_STORAGE_KIND_WITH
case|:
return|return
literal|"WITH"
return|;
default|default:
return|return
literal|"[UNKNOWN]"
return|;
block|}
block|}
end_function

begin_function
specifier|const
name|char
modifier|*
name|bfd_sym_unparse_storage_class
parameter_list|(
name|kind
parameter_list|)
name|enum
name|bfd_sym_storage_class
name|kind
decl_stmt|;
block|{
switch|switch
condition|(
name|kind
condition|)
block|{
case|case
name|BFD_SYM_STORAGE_CLASS_REGISTER
case|:
return|return
literal|"REGISTER"
return|;
case|case
name|BFD_SYM_STORAGE_CLASS_GLOBAL
case|:
return|return
literal|"GLOBAL"
return|;
case|case
name|BFD_SYM_STORAGE_CLASS_FRAME_RELATIVE
case|:
return|return
literal|"FRAME_RELATIVE"
return|;
case|case
name|BFD_SYM_STORAGE_CLASS_STACK_RELATIVE
case|:
return|return
literal|"STACK_RELATIVE"
return|;
case|case
name|BFD_SYM_STORAGE_CLASS_ABSOLUTE
case|:
return|return
literal|"ABSOLUTE"
return|;
case|case
name|BFD_SYM_STORAGE_CLASS_CONSTANT
case|:
return|return
literal|"CONSTANT"
return|;
case|case
name|BFD_SYM_STORAGE_CLASS_RESOURCE
case|:
return|return
literal|"RESOURCE"
return|;
case|case
name|BFD_SYM_STORAGE_CLASS_BIGCONSTANT
case|:
return|return
literal|"BIGCONSTANT"
return|;
default|default:
return|return
literal|"[UNKNOWN]"
return|;
block|}
block|}
end_function

begin_function
specifier|const
name|char
modifier|*
name|bfd_sym_unparse_module_kind
parameter_list|(
name|kind
parameter_list|)
name|enum
name|bfd_sym_module_kind
name|kind
decl_stmt|;
block|{
switch|switch
condition|(
name|kind
condition|)
block|{
case|case
name|BFD_SYM_MODULE_KIND_NONE
case|:
return|return
literal|"NONE"
return|;
case|case
name|BFD_SYM_MODULE_KIND_PROGRAM
case|:
return|return
literal|"PROGRAM"
return|;
case|case
name|BFD_SYM_MODULE_KIND_UNIT
case|:
return|return
literal|"UNIT"
return|;
case|case
name|BFD_SYM_MODULE_KIND_PROCEDURE
case|:
return|return
literal|"PROCEDURE"
return|;
case|case
name|BFD_SYM_MODULE_KIND_FUNCTION
case|:
return|return
literal|"FUNCTION"
return|;
case|case
name|BFD_SYM_MODULE_KIND_DATA
case|:
return|return
literal|"DATA"
return|;
case|case
name|BFD_SYM_MODULE_KIND_BLOCK
case|:
return|return
literal|"BLOCK"
return|;
default|default:
return|return
literal|"[UNKNOWN]"
return|;
block|}
block|}
end_function

begin_function
specifier|const
name|char
modifier|*
name|bfd_sym_unparse_symbol_scope
parameter_list|(
name|scope
parameter_list|)
name|enum
name|bfd_sym_symbol_scope
name|scope
decl_stmt|;
block|{
switch|switch
condition|(
name|scope
condition|)
block|{
case|case
name|BFD_SYM_SYMBOL_SCOPE_LOCAL
case|:
return|return
literal|"LOCAL"
return|;
case|case
name|BFD_SYM_SYMBOL_SCOPE_GLOBAL
case|:
return|return
literal|"GLOBAL"
return|;
default|default:
return|return
literal|"[UNKNOWN]"
return|;
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_print_file_reference
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|,
name|entry
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
name|bfd_sym_file_reference
modifier|*
name|entry
decl_stmt|;
block|{
name|bfd_sym_file_references_table_entry
name|frtentry
decl_stmt|;
name|int
name|ret
decl_stmt|;
name|ret
operator|=
name|bfd_sym_fetch_file_references_table_entry
argument_list|(
name|abfd
argument_list|,
operator|&
name|frtentry
argument_list|,
name|entry
operator|->
name|fref_frte_index
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"FILE "
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|ret
operator|<
literal|0
operator|)
operator|||
operator|(
name|frtentry
operator|.
name|generic
operator|.
name|type
operator|!=
name|BFD_SYM_FILE_NAME_INDEX
operator|)
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[INVALID]"
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\"%.*s\""
argument_list|,
name|bfd_sym_symbol_name
argument_list|(
name|abfd
argument_list|,
name|frtentry
operator|.
name|filename
operator|.
name|nte_index
argument_list|)
index|[
literal|0
index|]
argument_list|,
operator|&
name|bfd_sym_symbol_name
argument_list|(
name|abfd
argument_list|,
name|frtentry
operator|.
name|filename
operator|.
name|nte_index
argument_list|)
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" (FRTE %lu)"
argument_list|,
name|entry
operator|->
name|fref_frte_index
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bfd_sym_print_resources_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|,
name|entry
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
name|bfd_sym_resources_table_entry
modifier|*
name|entry
decl_stmt|;
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" \"%.*s\" (NTE %lu), type \"%.4s\", num %u, size %lu, MTE %lu -- %lu"
argument_list|,
name|bfd_sym_symbol_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|rte_nte_index
argument_list|)
index|[
literal|0
index|]
argument_list|,
operator|&
name|bfd_sym_symbol_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|rte_nte_index
argument_list|)
index|[
literal|1
index|]
argument_list|,
name|entry
operator|->
name|rte_nte_index
argument_list|,
name|entry
operator|->
name|rte_res_type
argument_list|,
name|entry
operator|->
name|rte_res_number
argument_list|,
name|entry
operator|->
name|rte_res_size
argument_list|,
name|entry
operator|->
name|rte_mte_first
argument_list|,
name|entry
operator|->
name|rte_mte_last
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bfd_sym_print_modules_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|,
name|entry
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
name|bfd_sym_modules_table_entry
modifier|*
name|entry
decl_stmt|;
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\"%.*s\" (NTE %lu)"
argument_list|,
name|bfd_sym_symbol_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|mte_nte_index
argument_list|)
index|[
literal|0
index|]
argument_list|,
operator|&
name|bfd_sym_symbol_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|mte_nte_index
argument_list|)
index|[
literal|1
index|]
argument_list|,
name|entry
operator|->
name|mte_nte_index
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n            "
argument_list|)
expr_stmt|;
name|bfd_sym_print_file_reference
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
operator|&
name|entry
operator|->
name|mte_imp_fref
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" range %lu -- %lu"
argument_list|,
name|entry
operator|->
name|mte_imp_fref
operator|.
name|fref_offset
argument_list|,
name|entry
operator|->
name|mte_imp_end
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n            "
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"kind %s"
argument_list|,
name|bfd_sym_unparse_module_kind
argument_list|(
name|entry
operator|->
name|mte_kind
argument_list|)
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|", scope %s"
argument_list|,
name|bfd_sym_unparse_symbol_scope
argument_list|(
name|entry
operator|->
name|mte_scope
argument_list|)
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|", RTE %lu, offset %lu, size %lu"
argument_list|,
name|entry
operator|->
name|mte_rte_index
argument_list|,
name|entry
operator|->
name|mte_res_offset
argument_list|,
name|entry
operator|->
name|mte_size
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n            "
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"CMTE %lu, CVTE %lu, CLTE %lu, CTTE %lu, CSNTE1 %lu, CSNTE2 %lu"
argument_list|,
name|entry
operator|->
name|mte_cmte_index
argument_list|,
name|entry
operator|->
name|mte_cvte_index
argument_list|,
name|entry
operator|->
name|mte_clte_index
argument_list|,
name|entry
operator|->
name|mte_ctte_index
argument_list|,
name|entry
operator|->
name|mte_csnte_idx_1
argument_list|,
name|entry
operator|->
name|mte_csnte_idx_2
argument_list|)
expr_stmt|;
if|if
condition|(
name|entry
operator|->
name|mte_parent
operator|!=
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|", parent %lu"
argument_list|,
name|entry
operator|->
name|mte_parent
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|f
argument_list|,
literal|", no parent"
argument_list|)
expr_stmt|;
if|if
condition|(
name|entry
operator|->
name|mte_cmte_index
operator|!=
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|", child %lu"
argument_list|,
name|entry
operator|->
name|mte_cmte_index
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|f
argument_list|,
literal|", no child"
argument_list|)
expr_stmt|;
if|#
directive|if
literal|0
block|{     MTE bfd_sym_modules_table_entry pentry;      ret = bfd_sym_fetch_modules_table_entry (abfd,&pentry, entry->mte_parent);     if (ret< 0)       fprintf (f, " parent MTE %lu [INVALID]\n", entry->mte_parent);     else       fprintf (f, " parent MTE %lu \"%.*s\"\n", 	       entry->mte_parent, 	       bfd_sym_symbol_name (abfd, pentry.mte_nte_index)[0],&bfd_sym_symbol_name (abfd, pentry.mte_nte_index)[1]);   }
endif|#
directive|endif
block|}
end_function

begin_function
name|void
name|bfd_sym_print_file_references_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|,
name|entry
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
name|bfd_sym_file_references_table_entry
modifier|*
name|entry
decl_stmt|;
block|{
switch|switch
condition|(
name|entry
operator|->
name|generic
operator|.
name|type
condition|)
block|{
case|case
name|BFD_SYM_FILE_NAME_INDEX
case|:
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"FILE \"%.*s\" (NTE %lu), modtime "
argument_list|,
name|bfd_sym_symbol_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|filename
operator|.
name|nte_index
argument_list|)
index|[
literal|0
index|]
argument_list|,
operator|&
name|bfd_sym_symbol_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|filename
operator|.
name|nte_index
argument_list|)
index|[
literal|1
index|]
argument_list|,
name|entry
operator|->
name|filename
operator|.
name|nte_index
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[UNIMPLEMENTED]"
argument_list|)
expr_stmt|;
comment|/* printModDate (entry->filename.mod_date); */
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" (0x%lx)"
argument_list|,
name|entry
operator|->
name|filename
operator|.
name|mod_date
argument_list|)
expr_stmt|;
break|break;
case|case
name|BFD_SYM_END_OF_LIST
case|:
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"END"
argument_list|)
expr_stmt|;
break|break;
default|default:
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\"%.*s\" (MTE %lu), offset %lu"
argument_list|,
name|bfd_sym_module_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|mte_index
argument_list|)
index|[
literal|0
index|]
argument_list|,
operator|&
name|bfd_sym_module_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|mte_index
argument_list|)
index|[
literal|1
index|]
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|mte_index
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|file_offset
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_print_contained_modules_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|,
name|entry
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
name|bfd_sym_contained_modules_table_entry
modifier|*
name|entry
decl_stmt|;
block|{
switch|switch
condition|(
name|entry
operator|->
name|generic
operator|.
name|type
condition|)
block|{
case|case
name|BFD_SYM_END_OF_LIST
case|:
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"END"
argument_list|)
expr_stmt|;
break|break;
default|default:
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\"%.*s\" (MTE %lu, NTE %lu)"
argument_list|,
name|bfd_sym_module_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|mte_index
argument_list|)
index|[
literal|0
index|]
argument_list|,
operator|&
name|bfd_sym_module_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|mte_index
argument_list|)
index|[
literal|1
index|]
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|mte_index
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|nte_index
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_print_contained_variables_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|,
name|entry
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
name|bfd_sym_contained_variables_table_entry
modifier|*
name|entry
decl_stmt|;
block|{
if|if
condition|(
name|entry
operator|->
name|generic
operator|.
name|type
operator|==
name|BFD_SYM_END_OF_LIST
condition|)
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"END"
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|entry
operator|->
name|generic
operator|.
name|type
operator|==
name|BFD_SYM_SOURCE_FILE_CHANGE
condition|)
block|{
name|bfd_sym_print_file_reference
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
operator|&
name|entry
operator|->
name|file
operator|.
name|fref
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" offset %lu"
argument_list|,
name|entry
operator|->
name|file
operator|.
name|fref
operator|.
name|fref_offset
argument_list|)
expr_stmt|;
return|return;
block|}
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\"%.*s\" (NTE %lu)"
argument_list|,
name|bfd_sym_symbol_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|nte_index
argument_list|)
index|[
literal|0
index|]
argument_list|,
operator|&
name|bfd_sym_symbol_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|nte_index
argument_list|)
index|[
literal|1
index|]
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|nte_index
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|", TTE %lu"
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|tte_index
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|", offset %lu"
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|file_delta
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|", scope %s"
argument_list|,
name|bfd_sym_unparse_symbol_scope
argument_list|(
name|entry
operator|->
name|entry
operator|.
name|scope
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|entry
operator|->
name|entry
operator|.
name|la_size
operator|==
name|BFD_SYM_CVTE_SCA
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|", latype %s, laclass %s, laoffset %lu"
argument_list|,
name|bfd_sym_unparse_storage_kind
argument_list|(
name|entry
operator|->
name|entry
operator|.
name|address
operator|.
name|scstruct
operator|.
name|sca_kind
argument_list|)
argument_list|,
name|bfd_sym_unparse_storage_class
argument_list|(
name|entry
operator|->
name|entry
operator|.
name|address
operator|.
name|scstruct
operator|.
name|sca_class
argument_list|)
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|address
operator|.
name|scstruct
operator|.
name|sca_offset
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|entry
operator|->
name|entry
operator|.
name|la_size
operator|<=
name|BFD_SYM_CVTE_LA_MAX_SIZE
condition|)
block|{
name|unsigned
name|long
name|i
decl_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|", la ["
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|entry
operator|->
name|entry
operator|.
name|la_size
condition|;
name|i
operator|++
control|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"0x%02x "
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|address
operator|.
name|lastruct
operator|.
name|la
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"]"
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|entry
operator|->
name|entry
operator|.
name|la_size
operator|==
name|BFD_SYM_CVTE_BIG_LA
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|", bigla %lu, biglakind %u"
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|address
operator|.
name|biglastruct
operator|.
name|big_la
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|address
operator|.
name|biglastruct
operator|.
name|big_la_kind
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|f
argument_list|,
literal|", la [INVALID]"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bfd_sym_print_contained_statements_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|,
name|entry
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
name|bfd_sym_contained_statements_table_entry
modifier|*
name|entry
decl_stmt|;
block|{
if|if
condition|(
name|entry
operator|->
name|generic
operator|.
name|type
operator|==
name|BFD_SYM_END_OF_LIST
condition|)
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"END"
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|entry
operator|->
name|generic
operator|.
name|type
operator|==
name|BFD_SYM_SOURCE_FILE_CHANGE
condition|)
block|{
name|bfd_sym_print_file_reference
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
operator|&
name|entry
operator|->
name|file
operator|.
name|fref
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" offset %lu"
argument_list|,
name|entry
operator|->
name|file
operator|.
name|fref
operator|.
name|fref_offset
argument_list|)
expr_stmt|;
return|return;
block|}
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\"%.*s\" (MTE %lu), offset %lu, delta %lu"
argument_list|,
name|bfd_sym_module_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|mte_index
argument_list|)
index|[
literal|0
index|]
argument_list|,
operator|&
name|bfd_sym_module_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|mte_index
argument_list|)
index|[
literal|1
index|]
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|mte_index
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|mte_offset
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|file_delta
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bfd_sym_print_contained_labels_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|,
name|entry
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
name|bfd_sym_contained_labels_table_entry
modifier|*
name|entry
decl_stmt|;
block|{
if|if
condition|(
name|entry
operator|->
name|generic
operator|.
name|type
operator|==
name|BFD_SYM_END_OF_LIST
condition|)
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"END"
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|entry
operator|->
name|generic
operator|.
name|type
operator|==
name|BFD_SYM_SOURCE_FILE_CHANGE
condition|)
block|{
name|bfd_sym_print_file_reference
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
operator|&
name|entry
operator|->
name|file
operator|.
name|fref
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" offset %lu"
argument_list|,
name|entry
operator|->
name|file
operator|.
name|fref
operator|.
name|fref_offset
argument_list|)
expr_stmt|;
return|return;
block|}
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\"%.*s\" (MTE %lu), offset %lu, delta %lu, scope %s"
argument_list|,
name|bfd_sym_module_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|mte_index
argument_list|)
index|[
literal|0
index|]
argument_list|,
operator|&
name|bfd_sym_module_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|mte_index
argument_list|)
index|[
literal|1
index|]
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|mte_index
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|mte_offset
argument_list|,
name|entry
operator|->
name|entry
operator|.
name|file_delta
argument_list|,
name|bfd_sym_unparse_symbol_scope
argument_list|(
name|entry
operator|->
name|entry
operator|.
name|scope
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bfd_sym_print_contained_types_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|,
name|entry
parameter_list|)
name|bfd
modifier|*
name|abfd
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
name|bfd_sym_contained_types_table_entry
modifier|*
name|entry
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[UNIMPLEMENTED]"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|const
name|char
modifier|*
name|bfd_sym_type_operator_name
parameter_list|(
name|num
parameter_list|)
name|unsigned
name|char
name|num
decl_stmt|;
block|{
switch|switch
condition|(
name|num
condition|)
block|{
case|case
literal|1
case|:
return|return
literal|"TTE"
return|;
case|case
literal|2
case|:
return|return
literal|"PointerTo"
return|;
case|case
literal|3
case|:
return|return
literal|"ScalarOf"
return|;
case|case
literal|4
case|:
return|return
literal|"ConstantOf"
return|;
case|case
literal|5
case|:
return|return
literal|"EnumerationOf"
return|;
case|case
literal|6
case|:
return|return
literal|"VectorOf"
return|;
case|case
literal|7
case|:
return|return
literal|"RecordOf"
return|;
case|case
literal|8
case|:
return|return
literal|"UnionOf"
return|;
case|case
literal|9
case|:
return|return
literal|"SubRangeOf"
return|;
case|case
literal|10
case|:
return|return
literal|"SetOf"
return|;
case|case
literal|11
case|:
return|return
literal|"NamedTypeOf"
return|;
case|case
literal|12
case|:
return|return
literal|"ProcOf"
return|;
case|case
literal|13
case|:
return|return
literal|"ValueOf"
return|;
case|case
literal|14
case|:
return|return
literal|"ArrayOf"
return|;
default|default:
return|return
literal|"[UNKNOWN OPERATOR]"
return|;
block|}
block|}
end_function

begin_function
specifier|const
name|char
modifier|*
name|bfd_sym_type_basic_name
parameter_list|(
name|num
parameter_list|)
name|unsigned
name|char
name|num
decl_stmt|;
block|{
switch|switch
condition|(
name|num
condition|)
block|{
case|case
literal|0
case|:
return|return
literal|"void"
return|;
case|case
literal|1
case|:
return|return
literal|"pascal string"
return|;
case|case
literal|2
case|:
return|return
literal|"unsigned long"
return|;
case|case
literal|3
case|:
return|return
literal|"signed long"
return|;
case|case
literal|4
case|:
return|return
literal|"extended (10 bytes)"
return|;
case|case
literal|5
case|:
return|return
literal|"pascal boolean (1 byte)"
return|;
case|case
literal|6
case|:
return|return
literal|"unsigned byte"
return|;
case|case
literal|7
case|:
return|return
literal|"signed byte"
return|;
case|case
literal|8
case|:
return|return
literal|"character (1 byte)"
return|;
case|case
literal|9
case|:
return|return
literal|"wide character (2 bytes)"
return|;
case|case
literal|10
case|:
return|return
literal|"unsigned short"
return|;
case|case
literal|11
case|:
return|return
literal|"signed short"
return|;
case|case
literal|12
case|:
return|return
literal|"singled"
return|;
case|case
literal|13
case|:
return|return
literal|"double"
return|;
case|case
literal|14
case|:
return|return
literal|"extended (12 bytes)"
return|;
case|case
literal|15
case|:
return|return
literal|"computational (8 bytes)"
return|;
case|case
literal|16
case|:
return|return
literal|"c string"
return|;
case|case
literal|17
case|:
return|return
literal|"as-is string"
return|;
default|default:
return|return
literal|"[UNKNOWN BASIC TYPE]"
return|;
block|}
block|}
end_function

begin_function
name|int
name|bfd_sym_fetch_long
parameter_list|(
name|buf
parameter_list|,
name|len
parameter_list|,
name|offset
parameter_list|,
name|offsetptr
parameter_list|,
name|value
parameter_list|)
name|unsigned
name|char
modifier|*
name|buf
decl_stmt|;
name|unsigned
name|long
name|len
decl_stmt|;
name|unsigned
name|long
name|offset
decl_stmt|;
name|unsigned
name|long
modifier|*
name|offsetptr
decl_stmt|;
name|long
modifier|*
name|value
decl_stmt|;
block|{
name|int
name|ret
decl_stmt|;
if|if
condition|(
name|offset
operator|>=
name|len
condition|)
block|{
operator|*
name|value
operator|=
literal|0
expr_stmt|;
name|offset
operator|+=
literal|0
expr_stmt|;
name|ret
operator|=
operator|-
literal|1
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|!
operator|(
name|buf
index|[
name|offset
index|]
operator|&
literal|0x80
operator|)
condition|)
block|{
operator|*
name|value
operator|=
name|buf
index|[
name|offset
index|]
expr_stmt|;
name|offset
operator|+=
literal|1
expr_stmt|;
name|ret
operator|=
literal|0
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|buf
index|[
name|offset
index|]
operator|==
literal|0xc0
condition|)
block|{
if|if
condition|(
operator|(
name|offset
operator|+
literal|5
operator|)
operator|>
name|len
condition|)
block|{
operator|*
name|value
operator|=
literal|0
expr_stmt|;
name|offset
operator|=
name|len
expr_stmt|;
name|ret
operator|=
operator|-
literal|1
expr_stmt|;
block|}
else|else
block|{
operator|*
name|value
operator|=
name|bfd_getb32
argument_list|(
name|buf
operator|+
name|offset
operator|+
literal|1
argument_list|)
expr_stmt|;
name|offset
operator|+=
literal|5
expr_stmt|;
name|ret
operator|=
literal|0
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
operator|(
name|buf
index|[
name|offset
index|]
operator|&
literal|0xc0
operator|)
operator|==
literal|0xc0
condition|)
block|{
operator|*
name|value
operator|=
operator|-
operator|(
name|buf
index|[
name|offset
index|]
operator|&
literal|0x3f
operator|)
expr_stmt|;
name|offset
operator|+=
literal|1
expr_stmt|;
name|ret
operator|=
literal|0
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|(
name|buf
index|[
name|offset
index|]
operator|&
literal|0xc0
operator|)
operator|==
literal|0x80
condition|)
block|{
if|if
condition|(
operator|(
name|offset
operator|+
literal|2
operator|)
operator|>
name|len
condition|)
block|{
operator|*
name|value
operator|=
literal|0
expr_stmt|;
name|offset
operator|=
name|len
expr_stmt|;
name|ret
operator|=
operator|-
literal|1
expr_stmt|;
block|}
else|else
block|{
operator|*
name|value
operator|=
name|bfd_getb16
argument_list|(
name|buf
operator|+
name|offset
argument_list|)
operator|&
literal|0x3fff
expr_stmt|;
name|offset
operator|+=
literal|2
expr_stmt|;
name|ret
operator|=
literal|0
expr_stmt|;
block|}
block|}
else|else
name|abort
argument_list|()
expr_stmt|;
if|if
condition|(
name|offsetptr
operator|!=
name|NULL
condition|)
operator|*
name|offsetptr
operator|=
name|offset
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
name|void
name|bfd_sym_print_type_information
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|,
name|buf
parameter_list|,
name|len
parameter_list|,
name|offset
parameter_list|,
name|offsetptr
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
name|unsigned
name|char
modifier|*
name|buf
decl_stmt|;
name|unsigned
name|long
name|len
decl_stmt|;
name|unsigned
name|long
name|offset
decl_stmt|;
name|unsigned
name|long
modifier|*
name|offsetptr
decl_stmt|;
block|{
name|unsigned
name|int
name|type
decl_stmt|;
if|if
condition|(
name|offset
operator|>=
name|len
condition|)
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[NULL]"
argument_list|)
expr_stmt|;
if|if
condition|(
name|offsetptr
operator|!=
name|NULL
condition|)
operator|*
name|offsetptr
operator|=
name|offset
expr_stmt|;
return|return;
block|}
name|type
operator|=
name|buf
index|[
name|offset
index|]
expr_stmt|;
name|offset
operator|++
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|type
operator|&
literal|0x80
operator|)
condition|)
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[%s] (0x%x)"
argument_list|,
name|bfd_sym_type_basic_name
argument_list|(
name|type
operator|&
literal|0x7f
argument_list|)
argument_list|,
name|type
argument_list|)
expr_stmt|;
if|if
condition|(
name|offsetptr
operator|!=
name|NULL
condition|)
operator|*
name|offsetptr
operator|=
name|offset
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|type
operator|&
literal|0x40
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[packed "
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"["
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|type
operator|&
literal|0x3f
condition|)
block|{
case|case
literal|1
case|:
block|{
name|long
name|value
decl_stmt|;
name|bfd_sym_type_information_table_entry
name|tinfo
decl_stmt|;
name|bfd_sym_fetch_long
argument_list|(
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|<=
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[INVALID]"
argument_list|)
expr_stmt|;
else|else
block|{
if|if
condition|(
name|bfd_sym_fetch_type_table_information
argument_list|(
name|abfd
argument_list|,
operator|&
name|tinfo
argument_list|,
name|value
argument_list|)
operator|<
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[INVALID]"
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\"%.*s\""
argument_list|,
name|bfd_sym_symbol_name
argument_list|(
name|abfd
argument_list|,
name|tinfo
operator|.
name|nte_index
argument_list|)
index|[
literal|0
index|]
argument_list|,
operator|&
name|bfd_sym_symbol_name
argument_list|(
name|abfd
argument_list|,
name|tinfo
operator|.
name|nte_index
argument_list|)
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
block|}
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" (TTE %lu)"
argument_list|,
name|value
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
literal|2
case|:
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"pointer (0x%x) to "
argument_list|,
name|type
argument_list|)
expr_stmt|;
name|bfd_sym_print_type_information
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|)
expr_stmt|;
break|break;
case|case
literal|3
case|:
block|{
name|unsigned
name|long
name|value
decl_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"scalar (0x%x) of "
argument_list|,
name|type
argument_list|)
expr_stmt|;
name|bfd_sym_print_type_information
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|)
expr_stmt|;
name|bfd_sym_fetch_long
argument_list|(
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" (%lu)"
argument_list|,
name|value
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
literal|5
case|:
block|{
name|unsigned
name|long
name|lower
decl_stmt|,
name|upper
decl_stmt|,
name|nelem
decl_stmt|;
name|unsigned
name|long
name|i
decl_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"enumeration (0x%x) of "
argument_list|,
name|type
argument_list|)
expr_stmt|;
name|bfd_sym_print_type_information
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|)
expr_stmt|;
name|bfd_sym_fetch_long
argument_list|(
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|,
operator|&
name|lower
argument_list|)
expr_stmt|;
name|bfd_sym_fetch_long
argument_list|(
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|,
operator|&
name|upper
argument_list|)
expr_stmt|;
name|bfd_sym_fetch_long
argument_list|(
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|,
operator|&
name|nelem
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" from %lu to %lu with %lu elements: "
argument_list|,
name|lower
argument_list|,
name|upper
argument_list|,
name|nelem
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nelem
condition|;
name|i
operator|++
control|)
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n                    "
argument_list|)
expr_stmt|;
name|bfd_sym_print_type_information
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|)
expr_stmt|;
block|}
break|break;
block|}
case|case
literal|6
case|:
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"vector (0x%x)"
argument_list|,
name|type
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n                index "
argument_list|)
expr_stmt|;
name|bfd_sym_print_type_information
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n                target "
argument_list|)
expr_stmt|;
name|bfd_sym_print_type_information
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|)
expr_stmt|;
break|break;
case|case
literal|7
case|:
case|case
literal|8
case|:
block|{
name|long
name|nrec
decl_stmt|,
name|eloff
decl_stmt|,
name|i
decl_stmt|;
if|if
condition|(
operator|(
name|type
operator|&
literal|0x3f
operator|)
operator|==
literal|7
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"record (0x%x) of "
argument_list|,
name|type
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"union (0x%x) of "
argument_list|,
name|type
argument_list|)
expr_stmt|;
name|bfd_sym_fetch_long
argument_list|(
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|,
operator|&
name|nrec
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"%lu elements: "
argument_list|,
name|nrec
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nrec
condition|;
name|i
operator|++
control|)
block|{
name|bfd_sym_fetch_long
argument_list|(
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|,
operator|&
name|eloff
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n                "
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"offset %lu: "
argument_list|,
name|eloff
argument_list|)
expr_stmt|;
name|bfd_sym_print_type_information
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|)
expr_stmt|;
block|}
break|break;
block|}
case|case
literal|9
case|:
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"subrange (0x%x) of "
argument_list|,
name|type
argument_list|)
expr_stmt|;
name|bfd_sym_print_type_information
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" lower "
argument_list|)
expr_stmt|;
name|bfd_sym_print_type_information
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" upper "
argument_list|)
expr_stmt|;
name|bfd_sym_print_type_information
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|)
expr_stmt|;
break|break;
case|case
literal|11
case|:
block|{
name|long
name|value
decl_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"named type (0x%x) "
argument_list|,
name|type
argument_list|)
expr_stmt|;
name|bfd_sym_fetch_long
argument_list|(
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|<=
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[INVALID]"
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\"%.*s\""
argument_list|,
name|bfd_sym_symbol_name
argument_list|(
name|abfd
argument_list|,
name|value
argument_list|)
index|[
literal|0
index|]
argument_list|,
operator|&
name|bfd_sym_symbol_name
argument_list|(
name|abfd
argument_list|,
name|value
argument_list|)
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" (NTE %lu) with type "
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|bfd_sym_print_type_information
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|)
expr_stmt|;
break|break;
block|}
default|default:
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"%s (0x%x)"
argument_list|,
name|bfd_sym_type_operator_name
argument_list|(
name|type
argument_list|)
argument_list|,
name|type
argument_list|)
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|type
operator|==
operator|(
literal|0x40
operator||
literal|0x6
operator|)
condition|)
block|{
comment|/* Vector.  */
name|long
name|n
decl_stmt|,
name|width
decl_stmt|,
name|m
decl_stmt|;
name|long
name|l
decl_stmt|;
name|long
name|i
decl_stmt|;
name|bfd_sym_fetch_long
argument_list|(
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|,
operator|&
name|n
argument_list|)
expr_stmt|;
name|bfd_sym_fetch_long
argument_list|(
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|,
operator|&
name|width
argument_list|)
expr_stmt|;
name|bfd_sym_fetch_long
argument_list|(
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|,
operator|&
name|m
argument_list|)
expr_stmt|;
comment|/* fprintf (f, "\n                "); */
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" N %ld, width %ld, M %ld, "
argument_list|,
name|n
argument_list|,
name|width
argument_list|,
name|m
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|m
condition|;
name|i
operator|++
control|)
block|{
name|bfd_sym_fetch_long
argument_list|(
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
if|if
condition|(
name|i
operator|!=
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" "
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"%ld"
argument_list|,
name|l
argument_list|)
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|type
operator|&
literal|0x40
condition|)
block|{
comment|/* Other packed type.  */
name|long
name|msb
decl_stmt|,
name|lsb
decl_stmt|;
name|bfd_sym_fetch_long
argument_list|(
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|,
operator|&
name|msb
argument_list|)
expr_stmt|;
name|bfd_sym_fetch_long
argument_list|(
name|buf
argument_list|,
name|len
argument_list|,
name|offset
argument_list|,
operator|&
name|offset
argument_list|,
operator|&
name|lsb
argument_list|)
expr_stmt|;
comment|/* fprintf (f, "\n                "); */
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" msb %ld, lsb %ld"
argument_list|,
name|msb
argument_list|,
name|lsb
argument_list|)
expr_stmt|;
block|}
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"]"
argument_list|)
expr_stmt|;
if|if
condition|(
name|offsetptr
operator|!=
name|NULL
condition|)
operator|*
name|offsetptr
operator|=
name|offset
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bfd_sym_print_type_information_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|,
name|entry
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
name|bfd_sym_type_information_table_entry
modifier|*
name|entry
decl_stmt|;
block|{
name|unsigned
name|char
modifier|*
name|buf
decl_stmt|;
name|unsigned
name|long
name|offset
decl_stmt|;
name|unsigned
name|int
name|i
decl_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\"%.*s\" (NTE %lu), %lu bytes at %lu, logical size %lu"
argument_list|,
name|bfd_sym_symbol_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|nte_index
argument_list|)
index|[
literal|0
index|]
argument_list|,
operator|&
name|bfd_sym_symbol_name
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|nte_index
argument_list|)
index|[
literal|1
index|]
argument_list|,
name|entry
operator|->
name|nte_index
argument_list|,
name|entry
operator|->
name|physical_size
argument_list|,
name|entry
operator|->
name|offset
argument_list|,
name|entry
operator|->
name|logical_size
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n            "
argument_list|)
expr_stmt|;
name|buf
operator|=
name|alloca
argument_list|(
name|entry
operator|->
name|physical_size
argument_list|)
expr_stmt|;
if|if
condition|(
name|buf
operator|==
name|NULL
condition|)
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[ERROR]\n"
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
name|entry
operator|->
name|offset
argument_list|,
name|SEEK_SET
argument_list|)
operator|<
literal|0
condition|)
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[ERROR]\n"
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|bfd_bread
argument_list|(
name|buf
argument_list|,
name|entry
operator|->
name|physical_size
argument_list|,
name|abfd
argument_list|)
operator|!=
name|entry
operator|->
name|physical_size
condition|)
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[ERROR]\n"
argument_list|)
expr_stmt|;
return|return;
block|}
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"["
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|entry
operator|->
name|physical_size
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|i
operator|==
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"0x%02x"
argument_list|,
name|buf
index|[
name|i
index|]
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" 0x%02x"
argument_list|,
name|buf
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"]"
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n            "
argument_list|)
expr_stmt|;
name|bfd_sym_print_type_information
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
name|buf
argument_list|,
name|entry
operator|->
name|physical_size
argument_list|,
literal|0
argument_list|,
operator|&
name|offset
argument_list|)
expr_stmt|;
if|if
condition|(
name|offset
operator|!=
name|entry
operator|->
name|physical_size
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n            [parser used %lu bytes instead of %lu]"
argument_list|,
name|offset
argument_list|,
name|entry
operator|->
name|physical_size
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bfd_sym_print_file_references_index_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|,
name|entry
parameter_list|)
name|bfd
modifier|*
name|abfd
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
name|bfd_sym_file_references_index_table_entry
modifier|*
name|entry
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[UNIMPLEMENTED]"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bfd_sym_print_constant_pool_entry
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|,
name|entry
parameter_list|)
name|bfd
modifier|*
name|abfd
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
name|bfd_sym_constant_pool_entry
modifier|*
name|entry
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[UNIMPLEMENTED]"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|unsigned
name|char
modifier|*
name|bfd_sym_display_name_table_entry
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|,
name|entry
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
name|unsigned
name|char
modifier|*
name|entry
decl_stmt|;
block|{
name|unsigned
name|long
name|index
decl_stmt|;
name|unsigned
name|long
name|offset
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
name|index
operator|=
operator|(
name|entry
operator|-
name|sdata
operator|->
name|name_table
operator|)
operator|/
literal|2
expr_stmt|;
if|if
condition|(
name|sdata
operator|->
name|version
operator|>=
name|BFD_SYM_VERSION_3_4
operator|&&
name|entry
index|[
literal|0
index|]
operator|==
literal|255
operator|&&
name|entry
index|[
literal|1
index|]
operator|==
literal|0
condition|)
block|{
name|unsigned
name|short
name|length
init|=
name|bfd_getb16
argument_list|(
name|entry
operator|+
literal|2
argument_list|)
decl_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[%8lu] \"%.*s\"\n"
argument_list|,
name|index
argument_list|,
name|length
argument_list|,
name|entry
operator|+
literal|4
argument_list|)
expr_stmt|;
name|offset
operator|=
literal|2
operator|+
name|length
operator|+
literal|1
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
operator|!
operator|(
name|entry
index|[
literal|0
index|]
operator|==
literal|0
operator|||
operator|(
name|entry
index|[
literal|0
index|]
operator|==
literal|1
operator|&&
name|entry
index|[
literal|1
index|]
operator|==
literal|'\0'
operator|)
operator|)
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[%8lu] \"%.*s\"\n"
argument_list|,
name|index
argument_list|,
name|entry
index|[
literal|0
index|]
argument_list|,
name|entry
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|sdata
operator|->
name|version
operator|>=
name|BFD_SYM_VERSION_3_4
condition|)
name|offset
operator|=
name|entry
index|[
literal|0
index|]
operator|+
literal|2
expr_stmt|;
else|else
name|offset
operator|=
name|entry
index|[
literal|0
index|]
operator|+
literal|1
expr_stmt|;
block|}
return|return
operator|(
name|entry
operator|+
name|offset
operator|+
operator|(
name|offset
operator|%
literal|2
operator|)
operator|)
return|;
block|}
end_function

begin_function
name|void
name|bfd_sym_display_name_table
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
block|{
name|unsigned
name|long
name|name_table_len
decl_stmt|;
name|unsigned
name|char
modifier|*
name|name_table
decl_stmt|,
modifier|*
name|name_table_end
decl_stmt|,
modifier|*
name|cur
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
name|name_table_len
operator|=
name|sdata
operator|->
name|header
operator|.
name|dshb_nte
operator|.
name|dti_page_count
operator|*
name|sdata
operator|->
name|header
operator|.
name|dshb_page_size
expr_stmt|;
name|name_table
operator|=
name|sdata
operator|->
name|name_table
expr_stmt|;
name|name_table_end
operator|=
name|name_table
operator|+
name|name_table_len
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"name table (NTE) contains %lu bytes:\n\n"
argument_list|,
name|name_table_len
argument_list|)
expr_stmt|;
name|cur
operator|=
name|name_table
expr_stmt|;
for|for
control|(
init|;
condition|;
control|)
block|{
name|cur
operator|=
name|bfd_sym_display_name_table_entry
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
name|cur
argument_list|)
expr_stmt|;
if|if
condition|(
name|cur
operator|>=
name|name_table_end
condition|)
break|break;
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_display_resources_table
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
block|{
name|unsigned
name|long
name|i
decl_stmt|;
name|bfd_sym_resources_table_entry
name|entry
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"resource table (RTE) contains %lu objects:\n\n"
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_rte
operator|.
name|dti_object_count
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<=
name|sdata
operator|->
name|header
operator|.
name|dshb_rte
operator|.
name|dti_object_count
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|bfd_sym_fetch_resources_table_entry
argument_list|(
name|abfd
argument_list|,
operator|&
name|entry
argument_list|,
name|i
argument_list|)
operator|<
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] [INVALID]\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
else|else
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] "
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|bfd_sym_print_resources_table_entry
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
operator|&
name|entry
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_display_modules_table
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
block|{
name|unsigned
name|long
name|i
decl_stmt|;
name|bfd_sym_modules_table_entry
name|entry
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"module table (MTE) contains %lu objects:\n\n"
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_mte
operator|.
name|dti_object_count
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<=
name|sdata
operator|->
name|header
operator|.
name|dshb_mte
operator|.
name|dti_object_count
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|bfd_sym_fetch_modules_table_entry
argument_list|(
name|abfd
argument_list|,
operator|&
name|entry
argument_list|,
name|i
argument_list|)
operator|<
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] [INVALID]\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
else|else
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] "
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|bfd_sym_print_modules_table_entry
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
operator|&
name|entry
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_display_file_references_table
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
block|{
name|unsigned
name|long
name|i
decl_stmt|;
name|bfd_sym_file_references_table_entry
name|entry
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"file reference table (FRTE) contains %lu objects:\n\n"
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_frte
operator|.
name|dti_object_count
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<=
name|sdata
operator|->
name|header
operator|.
name|dshb_frte
operator|.
name|dti_object_count
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|bfd_sym_fetch_file_references_table_entry
argument_list|(
name|abfd
argument_list|,
operator|&
name|entry
argument_list|,
name|i
argument_list|)
operator|<
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] [INVALID]\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
else|else
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] "
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|bfd_sym_print_file_references_table_entry
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
operator|&
name|entry
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_display_contained_modules_table
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
block|{
name|unsigned
name|long
name|i
decl_stmt|;
name|bfd_sym_contained_modules_table_entry
name|entry
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"contained modules table (CMTE) contains %lu objects:\n\n"
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_cmte
operator|.
name|dti_object_count
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<=
name|sdata
operator|->
name|header
operator|.
name|dshb_cmte
operator|.
name|dti_object_count
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|bfd_sym_fetch_contained_modules_table_entry
argument_list|(
name|abfd
argument_list|,
operator|&
name|entry
argument_list|,
name|i
argument_list|)
operator|<
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] [INVALID]\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
else|else
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] "
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|bfd_sym_print_contained_modules_table_entry
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
operator|&
name|entry
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_display_contained_variables_table
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
block|{
name|unsigned
name|long
name|i
decl_stmt|;
name|bfd_sym_contained_variables_table_entry
name|entry
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"contained variables table (CVTE) contains %lu objects:\n\n"
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_cvte
operator|.
name|dti_object_count
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<=
name|sdata
operator|->
name|header
operator|.
name|dshb_cvte
operator|.
name|dti_object_count
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|bfd_sym_fetch_contained_variables_table_entry
argument_list|(
name|abfd
argument_list|,
operator|&
name|entry
argument_list|,
name|i
argument_list|)
operator|<
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] [INVALID]\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
else|else
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] "
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|bfd_sym_print_contained_variables_table_entry
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
operator|&
name|entry
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|bfd_sym_display_contained_statements_table
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
block|{
name|unsigned
name|long
name|i
decl_stmt|;
name|bfd_sym_contained_statements_table_entry
name|entry
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"contained statements table (CSNTE) contains %lu objects:\n\n"
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_csnte
operator|.
name|dti_object_count
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<=
name|sdata
operator|->
name|header
operator|.
name|dshb_csnte
operator|.
name|dti_object_count
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|bfd_sym_fetch_contained_statements_table_entry
argument_list|(
name|abfd
argument_list|,
operator|&
name|entry
argument_list|,
name|i
argument_list|)
operator|<
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] [INVALID]\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
else|else
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] "
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|bfd_sym_print_contained_statements_table_entry
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
operator|&
name|entry
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_display_contained_labels_table
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
block|{
name|unsigned
name|long
name|i
decl_stmt|;
name|bfd_sym_contained_labels_table_entry
name|entry
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"contained labels table (CLTE) contains %lu objects:\n\n"
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_clte
operator|.
name|dti_object_count
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<=
name|sdata
operator|->
name|header
operator|.
name|dshb_clte
operator|.
name|dti_object_count
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|bfd_sym_fetch_contained_labels_table_entry
argument_list|(
name|abfd
argument_list|,
operator|&
name|entry
argument_list|,
name|i
argument_list|)
operator|<
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] [INVALID]\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
else|else
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] "
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|bfd_sym_print_contained_labels_table_entry
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
operator|&
name|entry
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_display_contained_types_table
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
block|{
name|unsigned
name|long
name|i
decl_stmt|;
name|bfd_sym_contained_types_table_entry
name|entry
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"contained types table (CTTE) contains %lu objects:\n\n"
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_ctte
operator|.
name|dti_object_count
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<=
name|sdata
operator|->
name|header
operator|.
name|dshb_ctte
operator|.
name|dti_object_count
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|bfd_sym_fetch_contained_types_table_entry
argument_list|(
name|abfd
argument_list|,
operator|&
name|entry
argument_list|,
name|i
argument_list|)
operator|<
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] [INVALID]\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
else|else
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] "
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|bfd_sym_print_contained_types_table_entry
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
operator|&
name|entry
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_display_file_references_index_table
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
block|{
name|unsigned
name|long
name|i
decl_stmt|;
name|bfd_sym_file_references_index_table_entry
name|entry
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"file references index table (FITE) contains %lu objects:\n\n"
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_fite
operator|.
name|dti_object_count
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<=
name|sdata
operator|->
name|header
operator|.
name|dshb_fite
operator|.
name|dti_object_count
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|bfd_sym_fetch_file_references_index_table_entry
argument_list|(
name|abfd
argument_list|,
operator|&
name|entry
argument_list|,
name|i
argument_list|)
operator|<
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] [INVALID]\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
else|else
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] "
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|bfd_sym_print_file_references_index_table_entry
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
operator|&
name|entry
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_display_constant_pool
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
block|{
name|unsigned
name|long
name|i
decl_stmt|;
name|bfd_sym_constant_pool_entry
name|entry
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"constant pool (CONST) contains %lu objects:\n\n"
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_const
operator|.
name|dti_object_count
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<=
name|sdata
operator|->
name|header
operator|.
name|dshb_const
operator|.
name|dti_object_count
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|bfd_sym_fetch_constant_pool_entry
argument_list|(
name|abfd
argument_list|,
operator|&
name|entry
argument_list|,
name|i
argument_list|)
operator|<
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] [INVALID]\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
else|else
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] "
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|bfd_sym_print_constant_pool_entry
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
operator|&
name|entry
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|bfd_sym_display_type_information_table
parameter_list|(
name|abfd
parameter_list|,
name|f
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|FILE
modifier|*
name|f
decl_stmt|;
block|{
name|unsigned
name|long
name|i
decl_stmt|;
name|bfd_sym_type_table_entry
name|index
decl_stmt|;
name|bfd_sym_type_information_table_entry
name|entry
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|sdata
init|=
name|NULL
decl_stmt|;
name|BFD_ASSERT
argument_list|(
name|bfd_sym_valid
argument_list|(
name|abfd
argument_list|)
argument_list|)
expr_stmt|;
name|sdata
operator|=
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
expr_stmt|;
if|if
condition|(
name|sdata
operator|->
name|header
operator|.
name|dshb_tte
operator|.
name|dti_object_count
operator|>
literal|99
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"type table (TINFO) contains %lu objects:\n\n"
argument_list|,
name|sdata
operator|->
name|header
operator|.
name|dshb_tte
operator|.
name|dti_object_count
operator|-
literal|99
argument_list|)
expr_stmt|;
else|else
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"type table (TINFO) contains [INVALID] objects:\n\n"
argument_list|)
expr_stmt|;
return|return;
block|}
for|for
control|(
name|i
operator|=
literal|100
init|;
name|i
operator|<=
name|sdata
operator|->
name|header
operator|.
name|dshb_tte
operator|.
name|dti_object_count
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|bfd_sym_fetch_type_table_entry
argument_list|(
name|abfd
argument_list|,
operator|&
name|index
argument_list|,
name|i
operator|-
literal|100
argument_list|)
operator|<
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] [INVALID]\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
else|else
block|{
name|fprintf
argument_list|(
name|f
argument_list|,
literal|" [%8lu] (TINFO %lu) "
argument_list|,
name|i
argument_list|,
name|index
argument_list|)
expr_stmt|;
if|if
condition|(
name|bfd_sym_fetch_type_information_table_entry
argument_list|(
name|abfd
argument_list|,
operator|&
name|entry
argument_list|,
name|index
argument_list|)
operator|<
literal|0
condition|)
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"[INVALID]"
argument_list|)
expr_stmt|;
else|else
name|bfd_sym_print_type_information_table_entry
argument_list|(
name|abfd
argument_list|,
name|f
argument_list|,
operator|&
name|entry
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|f
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|int
name|bfd_sym_scan
parameter_list|(
name|abfd
parameter_list|,
name|version
parameter_list|,
name|mdata
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
name|bfd_sym_version
name|version
decl_stmt|;
name|bfd_sym_data_struct
modifier|*
name|mdata
decl_stmt|;
block|{
name|asection
modifier|*
name|bfdsec
decl_stmt|;
specifier|const
name|char
modifier|*
name|name
init|=
literal|"symbols"
decl_stmt|;
name|mdata
operator|->
name|name_table
operator|=
literal|0
expr_stmt|;
name|mdata
operator|->
name|sbfd
operator|=
name|abfd
expr_stmt|;
name|mdata
operator|->
name|version
operator|=
name|version
expr_stmt|;
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
literal|0
argument_list|,
name|SEEK_SET
argument_list|)
expr_stmt|;
if|if
condition|(
name|bfd_sym_read_header
argument_list|(
name|abfd
argument_list|,
operator|&
name|mdata
operator|->
name|header
argument_list|,
name|mdata
operator|->
name|version
argument_list|)
operator|!=
literal|0
condition|)
return|return
operator|-
literal|1
return|;
name|mdata
operator|->
name|name_table
operator|=
name|bfd_sym_read_name_table
argument_list|(
name|abfd
argument_list|,
operator|&
name|mdata
operator|->
name|header
argument_list|)
expr_stmt|;
if|if
condition|(
name|mdata
operator|->
name|name_table
operator|==
name|NULL
condition|)
return|return
operator|-
literal|1
return|;
name|bfdsec
operator|=
name|bfd_make_section_anyway
argument_list|(
name|abfd
argument_list|,
name|name
argument_list|)
expr_stmt|;
if|if
condition|(
name|bfdsec
operator|==
name|NULL
condition|)
return|return
operator|-
literal|1
return|;
name|bfdsec
operator|->
name|vma
operator|=
literal|0
expr_stmt|;
name|bfdsec
operator|->
name|lma
operator|=
literal|0
expr_stmt|;
name|bfdsec
operator|->
name|_raw_size
operator|=
literal|0
expr_stmt|;
name|bfdsec
operator|->
name|filepos
operator|=
literal|0
expr_stmt|;
name|bfdsec
operator|->
name|alignment_power
operator|=
literal|0
expr_stmt|;
name|bfdsec
operator|->
name|flags
operator|=
name|SEC_HAS_CONTENTS
expr_stmt|;
name|abfd
operator|->
name|tdata
operator|.
name|sym_data
operator|=
name|mdata
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|const
name|bfd_target
modifier|*
name|bfd_sym_object_p
parameter_list|(
name|abfd
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
block|{
name|struct
name|bfd_preserve
name|preserve
decl_stmt|;
name|bfd_sym_version
name|version
init|=
operator|-
literal|1
decl_stmt|;
name|preserve
operator|.
name|marker
operator|=
name|NULL
expr_stmt|;
name|bfd_seek
argument_list|(
name|abfd
argument_list|,
literal|0
argument_list|,
name|SEEK_SET
argument_list|)
expr_stmt|;
if|if
condition|(
name|bfd_sym_read_version
argument_list|(
name|abfd
argument_list|,
operator|&
name|version
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|wrong
goto|;
name|preserve
operator|.
name|marker
operator|=
name|bfd_alloc
argument_list|(
name|abfd
argument_list|,
sizeof|sizeof
argument_list|(
name|bfd_sym_data_struct
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|preserve
operator|.
name|marker
operator|==
name|NULL
operator|||
operator|!
name|bfd_preserve_save
argument_list|(
name|abfd
argument_list|,
operator|&
name|preserve
argument_list|)
condition|)
goto|goto
name|fail
goto|;
if|if
condition|(
name|bfd_sym_scan
argument_list|(
name|abfd
argument_list|,
name|version
argument_list|,
operator|(
name|bfd_sym_data_struct
operator|*
operator|)
name|preserve
operator|.
name|marker
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|wrong
goto|;
name|bfd_preserve_finish
argument_list|(
name|abfd
argument_list|,
operator|&
name|preserve
argument_list|)
expr_stmt|;
return|return
name|abfd
operator|->
name|xvec
return|;
name|wrong
label|:
name|bfd_set_error
argument_list|(
name|bfd_error_wrong_format
argument_list|)
expr_stmt|;
name|fail
label|:
if|if
condition|(
name|preserve
operator|.
name|marker
operator|!=
name|NULL
condition|)
name|bfd_preserve_restore
argument_list|(
name|abfd
argument_list|,
operator|&
name|preserve
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
end_function

begin_function
name|asymbol
modifier|*
name|bfd_sym_make_empty_symbol
parameter_list|(
name|abfd
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
block|{
return|return
operator|(
name|asymbol
operator|*
operator|)
name|bfd_alloc
argument_list|(
name|abfd
argument_list|,
sizeof|sizeof
argument_list|(
name|asymbol
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
name|void
name|bfd_sym_get_symbol_info
parameter_list|(
name|abfd
parameter_list|,
name|symbol
parameter_list|,
name|ret
parameter_list|)
name|bfd
modifier|*
name|abfd
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|asymbol
modifier|*
name|symbol
decl_stmt|;
name|symbol_info
modifier|*
name|ret
decl_stmt|;
block|{
name|bfd_symbol_info
argument_list|(
name|symbol
argument_list|,
name|ret
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|long
name|bfd_sym_get_symtab_upper_bound
parameter_list|(
name|abfd
parameter_list|)
name|bfd
modifier|*
name|abfd
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
return|return
literal|0
return|;
block|}
end_function

begin_function
name|long
name|bfd_sym_canonicalize_symtab
parameter_list|(
name|abfd
parameter_list|,
name|sym
parameter_list|)
name|bfd
modifier|*
name|abfd
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|asymbol
modifier|*
modifier|*
name|sym
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|bfd_sym_sizeof_headers
parameter_list|(
name|abfd
parameter_list|,
name|exec
parameter_list|)
name|bfd
modifier|*
name|abfd
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|bfd_boolean
name|exec
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
return|return
literal|0
return|;
block|}
end_function

begin_decl_stmt
specifier|const
name|bfd_target
name|sym_vec
init|=
block|{
literal|"sym"
block|,
comment|/* name */
name|bfd_target_sym_flavour
block|,
comment|/* flavour */
name|BFD_ENDIAN_BIG
block|,
comment|/* byteorder */
name|BFD_ENDIAN_BIG
block|,
comment|/* header_byteorder */
operator|(
name|HAS_RELOC
operator||
name|EXEC_P
operator||
comment|/* object flags */
name|HAS_LINENO
operator||
name|HAS_DEBUG
operator||
name|HAS_SYMS
operator||
name|HAS_LOCALS
operator||
name|DYNAMIC
operator||
name|WP_TEXT
operator||
name|D_PAGED
operator|)
block|,
operator|(
name|SEC_ALLOC
operator||
name|SEC_LOAD
operator||
name|SEC_READONLY
operator||
name|SEC_CODE
operator||
name|SEC_DATA
operator||
name|SEC_ROM
operator||
name|SEC_HAS_CONTENTS
operator|)
block|,
comment|/* section_flags */
literal|0
block|,
comment|/* symbol_leading_char */
literal|' '
block|,
comment|/* ar_pad_char */
literal|16
block|,
comment|/* ar_max_namelen */
name|bfd_getb64
block|,
name|bfd_getb_signed_64
block|,
name|bfd_putb64
block|,
name|bfd_getb32
block|,
name|bfd_getb_signed_32
block|,
name|bfd_putb32
block|,
name|bfd_getb16
block|,
name|bfd_getb_signed_16
block|,
name|bfd_putb16
block|,
comment|/* data */
name|bfd_getb64
block|,
name|bfd_getb_signed_64
block|,
name|bfd_putb64
block|,
name|bfd_getb32
block|,
name|bfd_getb_signed_32
block|,
name|bfd_putb32
block|,
name|bfd_getb16
block|,
name|bfd_getb_signed_16
block|,
name|bfd_putb16
block|,
comment|/* hdrs */
block|{
comment|/* bfd_check_format */
name|_bfd_dummy_target
block|,
name|bfd_sym_object_p
block|,
comment|/* bfd_check_format */
name|_bfd_dummy_target
block|,
name|_bfd_dummy_target
block|,   }
block|,
block|{
comment|/* bfd_set_format */
name|bfd_false
block|,
name|bfd_sym_mkobject
block|,
name|bfd_false
block|,
name|bfd_false
block|,   }
block|,
block|{
comment|/* bfd_write_contents */
name|bfd_false
block|,
name|bfd_true
block|,
name|bfd_false
block|,
name|bfd_false
block|,   }
block|,
name|BFD_JUMP_TABLE_GENERIC
argument_list|(
name|bfd_sym
argument_list|)
block|,
name|BFD_JUMP_TABLE_COPY
argument_list|(
name|_bfd_generic
argument_list|)
block|,
name|BFD_JUMP_TABLE_CORE
argument_list|(
name|_bfd_nocore
argument_list|)
block|,
name|BFD_JUMP_TABLE_ARCHIVE
argument_list|(
name|_bfd_noarchive
argument_list|)
block|,
name|BFD_JUMP_TABLE_SYMBOLS
argument_list|(
name|bfd_sym
argument_list|)
block|,
name|BFD_JUMP_TABLE_RELOCS
argument_list|(
name|bfd_sym
argument_list|)
block|,
name|BFD_JUMP_TABLE_WRITE
argument_list|(
name|bfd_sym
argument_list|)
block|,
name|BFD_JUMP_TABLE_LINK
argument_list|(
name|bfd_sym
argument_list|)
block|,
name|BFD_JUMP_TABLE_DYNAMIC
argument_list|(
name|_bfd_nodynamic
argument_list|)
block|,
name|NULL
block|,
name|NULL
block|}
decl_stmt|;
end_decl_stmt

end_unit

