begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* 	floating point Bessel's function 	of the first and second kinds 	of order one  	j1(x) returns the value of J1(x) 	for all real values of x.  	There are no error returns. 	Calls sin, cos, sqrt.  	There is a niggling bug in J1 which 	causes errors up to 2e-16 for x in the 	interval [-8,8]. 	The bug is caused by an inappropriate order 	of summation of the series.  rhm will fix it 	someday.  	Coefficients are from Hart& Cheney. 	#6050 (20.98D) 	#6750 (19.19D) 	#7150 (19.35D)  	y1(x) returns the value of Y1(x) 	for positive real values of x. 	For x<=0, error number EDOM is set and a 	large negative value is returned.  	Calls sin, cos, sqrt, log, j1.  	The values of Y1 have not been checked 	to more than ten places.  	Coefficients are from Hart& Cheney. 	#6447 (22.18D) 	#6750 (19.19D) 	#7150 (19.35D) */
end_comment

begin_include
include|#
directive|include
file|<math.h>
end_include

begin_include
include|#
directive|include
file|<errno.h>
end_include

begin_decl_stmt
name|int
name|errno
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|pzero
decl_stmt|,
name|qzero
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|tpi
init|=
literal|.6366197723675813430755350535e0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|pio4
init|=
literal|.7853981633974483096156608458e0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p1
index|[]
init|=
block|{
literal|0.581199354001606143928050809e21
block|,
operator|-
literal|.6672106568924916298020941484e20
block|,
literal|0.2316433580634002297931815435e19
block|,
operator|-
literal|.3588817569910106050743641413e17
block|,
literal|0.2908795263834775409737601689e15
block|,
operator|-
literal|.1322983480332126453125473247e13
block|,
literal|0.3413234182301700539091292655e10
block|,
operator|-
literal|.4695753530642995859767162166e7
block|,
literal|0.2701122710892323414856790990e4
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|q1
index|[]
init|=
block|{
literal|0.1162398708003212287858529400e22
block|,
literal|0.1185770712190320999837113348e20
block|,
literal|0.6092061398917521746105196863e17
block|,
literal|0.2081661221307607351240184229e15
block|,
literal|0.5243710262167649715406728642e12
block|,
literal|0.1013863514358673989967045588e10
block|,
literal|0.1501793594998585505921097578e7
block|,
literal|0.1606931573481487801970916749e4
block|,
literal|1.0
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p2
index|[]
init|=
block|{
operator|-
literal|.4435757816794127857114720794e7
block|,
operator|-
literal|.9942246505077641195658377899e7
block|,
operator|-
literal|.6603373248364939109255245434e7
block|,
operator|-
literal|.1523529351181137383255105722e7
block|,
operator|-
literal|.1098240554345934672737413139e6
block|,
operator|-
literal|.1611616644324610116477412898e4
block|,
literal|0.0
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|q2
index|[]
init|=
block|{
operator|-
literal|.4435757816794127856828016962e7
block|,
operator|-
literal|.9934124389934585658967556309e7
block|,
operator|-
literal|.6585339479723087072826915069e7
block|,
operator|-
literal|.1511809506634160881644546358e7
block|,
operator|-
literal|.1072638599110382011903063867e6
block|,
operator|-
literal|.1455009440190496182453565068e4
block|,
literal|1.0
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p3
index|[]
init|=
block|{
literal|0.3322091340985722351859704442e5
block|,
literal|0.8514516067533570196555001171e5
block|,
literal|0.6617883658127083517939992166e5
block|,
literal|0.1849426287322386679652009819e5
block|,
literal|0.1706375429020768002061283546e4
block|,
literal|0.3526513384663603218592175580e2
block|,
literal|0.0
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|q3
index|[]
init|=
block|{
literal|0.7087128194102874357377502472e6
block|,
literal|0.1819458042243997298924553839e7
block|,
literal|0.1419460669603720892855755253e7
block|,
literal|0.4002944358226697511708610813e6
block|,
literal|0.3789022974577220264142952256e5
block|,
literal|0.8638367769604990967475517183e3
block|,
literal|1.0
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p4
index|[]
init|=
block|{
operator|-
literal|.9963753424306922225996744354e23
block|,
literal|0.2655473831434854326894248968e23
block|,
operator|-
literal|.1212297555414509577913561535e22
block|,
literal|0.2193107339917797592111427556e20
block|,
operator|-
literal|.1965887462722140658820322248e18
block|,
literal|0.9569930239921683481121552788e15
block|,
operator|-
literal|.2580681702194450950541426399e13
block|,
literal|0.3639488548124002058278999428e10
block|,
operator|-
literal|.2108847540133123652824139923e7
block|,
literal|0.0
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|q4
index|[]
init|=
block|{
literal|0.5082067366941243245314424152e24
block|,
literal|0.5435310377188854170800653097e22
block|,
literal|0.2954987935897148674290758119e20
block|,
literal|0.1082258259408819552553850180e18
block|,
literal|0.2976632125647276729292742282e15
block|,
literal|0.6465340881265275571961681500e12
block|,
literal|0.1128686837169442121732366891e10
block|,
literal|0.1563282754899580604737366452e7
block|,
literal|0.1612361029677000859332072312e4
block|,
literal|1.0
block|, }
decl_stmt|;
end_decl_stmt

begin_function
name|double
name|j1
parameter_list|(
name|arg
parameter_list|)
name|double
name|arg
decl_stmt|;
block|{
name|double
name|xsq
decl_stmt|,
name|n
decl_stmt|,
name|d
decl_stmt|,
name|x
decl_stmt|;
name|double
name|sin
argument_list|()
decl_stmt|,
name|cos
argument_list|()
decl_stmt|,
name|sqrt
argument_list|()
decl_stmt|;
name|int
name|i
decl_stmt|;
name|x
operator|=
name|arg
expr_stmt|;
if|if
condition|(
name|x
operator|<
literal|0.
condition|)
name|x
operator|=
operator|-
name|x
expr_stmt|;
if|if
condition|(
name|x
operator|>
literal|8.
condition|)
block|{
name|asympt
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|n
operator|=
name|x
operator|-
literal|3.
operator|*
name|pio4
expr_stmt|;
name|n
operator|=
name|sqrt
argument_list|(
name|tpi
operator|/
name|x
argument_list|)
operator|*
operator|(
name|pzero
operator|*
name|cos
argument_list|(
name|n
argument_list|)
operator|-
name|qzero
operator|*
name|sin
argument_list|(
name|n
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
name|arg
operator|<
literal|0.
condition|)
name|n
operator|=
operator|-
name|n
expr_stmt|;
return|return
operator|(
name|n
operator|)
return|;
block|}
name|xsq
operator|=
name|x
operator|*
name|x
expr_stmt|;
for|for
control|(
name|n
operator|=
literal|0
operator|,
name|d
operator|=
literal|0
operator|,
name|i
operator|=
literal|8
init|;
name|i
operator|>=
literal|0
condition|;
name|i
operator|--
control|)
block|{
name|n
operator|=
name|n
operator|*
name|xsq
operator|+
name|p1
index|[
name|i
index|]
expr_stmt|;
name|d
operator|=
name|d
operator|*
name|xsq
operator|+
name|q1
index|[
name|i
index|]
expr_stmt|;
block|}
return|return
operator|(
name|arg
operator|*
name|n
operator|/
name|d
operator|)
return|;
block|}
end_function

begin_function
name|double
name|y1
parameter_list|(
name|arg
parameter_list|)
name|double
name|arg
decl_stmt|;
block|{
name|double
name|xsq
decl_stmt|,
name|n
decl_stmt|,
name|d
decl_stmt|,
name|x
decl_stmt|;
name|double
name|sin
argument_list|()
decl_stmt|,
name|cos
argument_list|()
decl_stmt|,
name|sqrt
argument_list|()
decl_stmt|,
name|log
argument_list|()
decl_stmt|,
name|j1
argument_list|()
decl_stmt|;
name|int
name|i
decl_stmt|;
name|errno
operator|=
literal|0
expr_stmt|;
name|x
operator|=
name|arg
expr_stmt|;
if|if
condition|(
name|x
operator|<=
literal|0.
condition|)
block|{
name|errno
operator|=
name|EDOM
expr_stmt|;
return|return
operator|(
operator|-
name|HUGE
operator|)
return|;
block|}
if|if
condition|(
name|x
operator|>
literal|8.
condition|)
block|{
name|asympt
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|n
operator|=
name|x
operator|-
literal|3
operator|*
name|pio4
expr_stmt|;
return|return
operator|(
name|sqrt
argument_list|(
name|tpi
operator|/
name|x
argument_list|)
operator|*
operator|(
name|pzero
operator|*
name|sin
argument_list|(
name|n
argument_list|)
operator|+
name|qzero
operator|*
name|cos
argument_list|(
name|n
argument_list|)
operator|)
operator|)
return|;
block|}
name|xsq
operator|=
name|x
operator|*
name|x
expr_stmt|;
for|for
control|(
name|n
operator|=
literal|0
operator|,
name|d
operator|=
literal|0
operator|,
name|i
operator|=
literal|9
init|;
name|i
operator|>=
literal|0
condition|;
name|i
operator|--
control|)
block|{
name|n
operator|=
name|n
operator|*
name|xsq
operator|+
name|p4
index|[
name|i
index|]
expr_stmt|;
name|d
operator|=
name|d
operator|*
name|xsq
operator|+
name|q4
index|[
name|i
index|]
expr_stmt|;
block|}
return|return
operator|(
name|x
operator|*
name|n
operator|/
name|d
operator|+
name|tpi
operator|*
operator|(
name|j1
argument_list|(
name|x
argument_list|)
operator|*
name|log
argument_list|(
name|x
argument_list|)
operator|-
literal|1.
operator|/
name|x
operator|)
operator|)
return|;
block|}
end_function

begin_expr_stmt
specifier|static
name|asympt
argument_list|(
argument|arg
argument_list|)
name|double
name|arg
expr_stmt|;
end_expr_stmt

begin_block
block|{
name|double
name|zsq
decl_stmt|,
name|n
decl_stmt|,
name|d
decl_stmt|;
name|int
name|i
decl_stmt|;
name|zsq
operator|=
literal|64.
operator|/
operator|(
name|arg
operator|*
name|arg
operator|)
expr_stmt|;
for|for
control|(
name|n
operator|=
literal|0
operator|,
name|d
operator|=
literal|0
operator|,
name|i
operator|=
literal|6
init|;
name|i
operator|>=
literal|0
condition|;
name|i
operator|--
control|)
block|{
name|n
operator|=
name|n
operator|*
name|zsq
operator|+
name|p2
index|[
name|i
index|]
expr_stmt|;
name|d
operator|=
name|d
operator|*
name|zsq
operator|+
name|q2
index|[
name|i
index|]
expr_stmt|;
block|}
name|pzero
operator|=
name|n
operator|/
name|d
expr_stmt|;
for|for
control|(
name|n
operator|=
literal|0
operator|,
name|d
operator|=
literal|0
operator|,
name|i
operator|=
literal|6
init|;
name|i
operator|>=
literal|0
condition|;
name|i
operator|--
control|)
block|{
name|n
operator|=
name|n
operator|*
name|zsq
operator|+
name|p3
index|[
name|i
index|]
expr_stmt|;
name|d
operator|=
name|d
operator|*
name|zsq
operator|+
name|q3
index|[
name|i
index|]
expr_stmt|;
block|}
name|qzero
operator|=
operator|(
literal|8.
operator|/
name|arg
operator|)
operator|*
operator|(
name|n
operator|/
name|d
operator|)
expr_stmt|;
block|}
end_block

end_unit

