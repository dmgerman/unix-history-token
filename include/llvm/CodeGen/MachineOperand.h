begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|//===-- llvm/CodeGen/MachineOperand.h - MachineOperand class ----*- C++ -*-===//
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|//                     The LLVM Compiler Infrastructure
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// This file is distributed under the University of Illinois Open Source
end_comment

begin_comment
comment|// License. See LICENSE.TXT for details.
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|//===----------------------------------------------------------------------===//
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// This file contains the declaration of the MachineOperand class.
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|//===----------------------------------------------------------------------===//
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|LLVM_CODEGEN_MACHINEOPERAND_H
end_ifndef

begin_define
define|#
directive|define
name|LLVM_CODEGEN_MACHINEOPERAND_H
end_define

begin_include
include|#
directive|include
file|"llvm/System/DataTypes.h"
end_include

begin_include
include|#
directive|include
file|<cassert>
end_include

begin_decl_stmt
name|namespace
name|llvm
block|{
name|class
name|BlockAddress
decl_stmt|;
name|class
name|ConstantFP
decl_stmt|;
name|class
name|GlobalValue
decl_stmt|;
name|class
name|MachineBasicBlock
decl_stmt|;
name|class
name|MachineInstr
decl_stmt|;
name|class
name|MachineRegisterInfo
decl_stmt|;
name|class
name|MDNode
decl_stmt|;
name|class
name|TargetMachine
decl_stmt|;
name|class
name|TargetRegisterInfo
decl_stmt|;
name|class
name|raw_ostream
decl_stmt|;
name|class
name|MCSymbol
decl_stmt|;
comment|/// MachineOperand class - Representation of each machine instruction operand.
comment|///
name|class
name|MachineOperand
block|{
name|public
label|:
enum|enum
name|MachineOperandType
block|{
name|MO_Register
block|,
comment|///< Register operand.
name|MO_Immediate
block|,
comment|///< Immediate operand
name|MO_FPImmediate
block|,
comment|///< Floating-point immediate operand
name|MO_MachineBasicBlock
block|,
comment|///< MachineBasicBlock reference
name|MO_FrameIndex
block|,
comment|///< Abstract Stack Frame Index
name|MO_ConstantPoolIndex
block|,
comment|///< Address of indexed Constant in Constant Pool
name|MO_JumpTableIndex
block|,
comment|///< Address of indexed Jump Table for switch
name|MO_ExternalSymbol
block|,
comment|///< Name of external global symbol
name|MO_GlobalAddress
block|,
comment|///< Address of a global value
name|MO_BlockAddress
block|,
comment|///< Address of a basic block
name|MO_Metadata
block|,
comment|///< Metadata reference (for debug info)
name|MO_MCSymbol
comment|///< MCSymbol reference (for debug/eh info)
block|}
enum|;
name|private
label|:
comment|/// OpKind - Specify what kind of operand this is.  This discriminates the
comment|/// union.
name|unsigned
name|char
name|OpKind
decl_stmt|;
comment|// MachineOperandType
comment|/// SubReg - Subregister number, only valid for MO_Register.  A value of 0
comment|/// indicates the MO_Register has no subReg.
name|unsigned
name|char
name|SubReg
decl_stmt|;
comment|/// TargetFlags - This is a set of target-specific operand flags.
name|unsigned
name|char
name|TargetFlags
decl_stmt|;
comment|/// IsDef/IsImp/IsKill/IsDead flags - These are only valid for MO_Register
comment|/// operands.
comment|/// IsDef - True if this is a def, false if this is a use of the register.
comment|///
name|bool
name|IsDef
range|:
literal|1
decl_stmt|;
comment|/// IsImp - True if this is an implicit def or use, false if it is explicit.
comment|///
name|bool
name|IsImp
range|:
literal|1
decl_stmt|;
comment|/// IsKill - True if this instruction is the last use of the register on this
comment|/// path through the function.  This is only valid on uses of registers.
name|bool
name|IsKill
range|:
literal|1
decl_stmt|;
comment|/// IsDead - True if this register is never used by a subsequent instruction.
comment|/// This is only valid on definitions of registers.
name|bool
name|IsDead
range|:
literal|1
decl_stmt|;
comment|/// IsUndef - True if this is a register def / use of "undef", i.e. register
comment|/// defined by an IMPLICIT_DEF. This is only valid on registers.
name|bool
name|IsUndef
range|:
literal|1
decl_stmt|;
comment|/// IsEarlyClobber - True if this MO_Register 'def' operand is written to
comment|/// by the MachineInstr before all input registers are read.  This is used to
comment|/// model the GCC inline asm '&' constraint modifier.
name|bool
name|IsEarlyClobber
range|:
literal|1
decl_stmt|;
comment|/// IsDebug - True if this MO_Register 'use' operand is in a debug pseudo,
comment|/// not a real instruction.  Such uses should be ignored during codegen.
name|bool
name|IsDebug
range|:
literal|1
decl_stmt|;
comment|/// ParentMI - This is the instruction that this operand is embedded into.
comment|/// This is valid for all operand types, when the operand is in an instr.
name|MachineInstr
modifier|*
name|ParentMI
decl_stmt|;
comment|/// Contents union - This contains the payload for the various operand types.
union|union
block|{
name|MachineBasicBlock
modifier|*
name|MBB
decl_stmt|;
comment|// For MO_MachineBasicBlock.
specifier|const
name|ConstantFP
modifier|*
name|CFP
decl_stmt|;
comment|// For MO_FPImmediate.
name|int64_t
name|ImmVal
decl_stmt|;
comment|// For MO_Immediate.
specifier|const
name|MDNode
modifier|*
name|MD
decl_stmt|;
comment|// For MO_Metadata.
name|MCSymbol
modifier|*
name|Sym
decl_stmt|;
comment|// For MO_MCSymbol
struct|struct
block|{
comment|// For MO_Register.
name|unsigned
name|RegNo
decl_stmt|;
name|MachineOperand
modifier|*
modifier|*
name|Prev
decl_stmt|;
comment|// Access list for register.
name|MachineOperand
modifier|*
name|Next
decl_stmt|;
block|}
name|Reg
struct|;
comment|/// OffsetedInfo - This struct contains the offset and an object identifier.
comment|/// this represent the object as with an optional offset from it.
struct|struct
block|{
union|union
block|{
name|int
name|Index
decl_stmt|;
comment|// For MO_*Index - The index itself.
specifier|const
name|char
modifier|*
name|SymbolName
decl_stmt|;
comment|// For MO_ExternalSymbol.
specifier|const
name|GlobalValue
modifier|*
name|GV
decl_stmt|;
comment|// For MO_GlobalAddress.
specifier|const
name|BlockAddress
modifier|*
name|BA
decl_stmt|;
comment|// For MO_BlockAddress.
block|}
name|Val
union|;
name|int64_t
name|Offset
decl_stmt|;
comment|// An offset from the object.
block|}
name|OffsetedInfo
struct|;
block|}
name|Contents
union|;
name|explicit
name|MachineOperand
argument_list|(
argument|MachineOperandType K
argument_list|)
block|:
name|OpKind
argument_list|(
name|K
argument_list|)
operator|,
name|ParentMI
argument_list|(
literal|0
argument_list|)
block|{
name|TargetFlags
operator|=
literal|0
block|;   }
name|public
operator|:
comment|/// getType - Returns the MachineOperandType for this operand.
comment|///
name|MachineOperandType
name|getType
argument_list|()
specifier|const
block|{
return|return
operator|(
name|MachineOperandType
operator|)
name|OpKind
return|;
block|}
name|unsigned
name|char
name|getTargetFlags
argument_list|()
specifier|const
block|{
return|return
name|TargetFlags
return|;
block|}
name|void
name|setTargetFlags
parameter_list|(
name|unsigned
name|char
name|F
parameter_list|)
block|{
name|TargetFlags
operator|=
name|F
expr_stmt|;
block|}
name|void
name|addTargetFlag
parameter_list|(
name|unsigned
name|char
name|F
parameter_list|)
block|{
name|TargetFlags
operator||=
name|F
expr_stmt|;
block|}
comment|/// getParent - Return the instruction that this operand belongs to.
comment|///
name|MachineInstr
modifier|*
name|getParent
parameter_list|()
block|{
return|return
name|ParentMI
return|;
block|}
specifier|const
name|MachineInstr
operator|*
name|getParent
argument_list|()
specifier|const
block|{
return|return
name|ParentMI
return|;
block|}
name|void
name|print
argument_list|(
name|raw_ostream
operator|&
name|os
argument_list|,
specifier|const
name|TargetMachine
operator|*
name|TM
operator|=
literal|0
argument_list|)
decl|const
decl_stmt|;
comment|//===--------------------------------------------------------------------===//
comment|// Accessors that tell you what kind of MachineOperand you're looking at.
comment|//===--------------------------------------------------------------------===//
comment|/// isReg - Tests if this is a MO_Register operand.
name|bool
name|isReg
argument_list|()
specifier|const
block|{
return|return
name|OpKind
operator|==
name|MO_Register
return|;
block|}
comment|/// isImm - Tests if this is a MO_Immediate operand.
name|bool
name|isImm
argument_list|()
specifier|const
block|{
return|return
name|OpKind
operator|==
name|MO_Immediate
return|;
block|}
comment|/// isFPImm - Tests if this is a MO_FPImmediate operand.
name|bool
name|isFPImm
argument_list|()
specifier|const
block|{
return|return
name|OpKind
operator|==
name|MO_FPImmediate
return|;
block|}
comment|/// isMBB - Tests if this is a MO_MachineBasicBlock operand.
name|bool
name|isMBB
argument_list|()
specifier|const
block|{
return|return
name|OpKind
operator|==
name|MO_MachineBasicBlock
return|;
block|}
comment|/// isFI - Tests if this is a MO_FrameIndex operand.
name|bool
name|isFI
argument_list|()
specifier|const
block|{
return|return
name|OpKind
operator|==
name|MO_FrameIndex
return|;
block|}
comment|/// isCPI - Tests if this is a MO_ConstantPoolIndex operand.
name|bool
name|isCPI
argument_list|()
specifier|const
block|{
return|return
name|OpKind
operator|==
name|MO_ConstantPoolIndex
return|;
block|}
comment|/// isJTI - Tests if this is a MO_JumpTableIndex operand.
name|bool
name|isJTI
argument_list|()
specifier|const
block|{
return|return
name|OpKind
operator|==
name|MO_JumpTableIndex
return|;
block|}
comment|/// isGlobal - Tests if this is a MO_GlobalAddress operand.
name|bool
name|isGlobal
argument_list|()
specifier|const
block|{
return|return
name|OpKind
operator|==
name|MO_GlobalAddress
return|;
block|}
comment|/// isSymbol - Tests if this is a MO_ExternalSymbol operand.
name|bool
name|isSymbol
argument_list|()
specifier|const
block|{
return|return
name|OpKind
operator|==
name|MO_ExternalSymbol
return|;
block|}
comment|/// isBlockAddress - Tests if this is a MO_BlockAddress operand.
name|bool
name|isBlockAddress
argument_list|()
specifier|const
block|{
return|return
name|OpKind
operator|==
name|MO_BlockAddress
return|;
block|}
comment|/// isMetadata - Tests if this is a MO_Metadata operand.
name|bool
name|isMetadata
argument_list|()
specifier|const
block|{
return|return
name|OpKind
operator|==
name|MO_Metadata
return|;
block|}
name|bool
name|isMCSymbol
argument_list|()
specifier|const
block|{
return|return
name|OpKind
operator|==
name|MO_MCSymbol
return|;
block|}
comment|//===--------------------------------------------------------------------===//
comment|// Accessors for Register Operands
comment|//===--------------------------------------------------------------------===//
comment|/// getReg - Returns the register number.
name|unsigned
name|getReg
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
literal|"This is not a register operand!"
argument_list|)
block|;
return|return
name|Contents
operator|.
name|Reg
operator|.
name|RegNo
return|;
block|}
name|unsigned
name|getSubReg
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
operator|(
name|unsigned
operator|)
name|SubReg
return|;
block|}
name|bool
name|isUse
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
operator|!
name|IsDef
return|;
block|}
name|bool
name|isDef
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
name|IsDef
return|;
block|}
name|bool
name|isImplicit
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
name|IsImp
return|;
block|}
name|bool
name|isDead
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
name|IsDead
return|;
block|}
name|bool
name|isKill
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
name|IsKill
return|;
block|}
name|bool
name|isUndef
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
name|IsUndef
return|;
block|}
name|bool
name|isEarlyClobber
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
name|IsEarlyClobber
return|;
block|}
name|bool
name|isDebug
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
name|IsDebug
return|;
block|}
comment|/// getNextOperandForReg - Return the next MachineOperand in the function that
comment|/// uses or defines this register.
name|MachineOperand
operator|*
name|getNextOperandForReg
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
literal|"This is not a register operand!"
argument_list|)
block|;
return|return
name|Contents
operator|.
name|Reg
operator|.
name|Next
return|;
block|}
comment|//===--------------------------------------------------------------------===//
comment|// Mutators for Register Operands
comment|//===--------------------------------------------------------------------===//
comment|/// Change the register this operand corresponds to.
comment|///
name|void
name|setReg
parameter_list|(
name|unsigned
name|Reg
parameter_list|)
function_decl|;
name|void
name|setSubReg
parameter_list|(
name|unsigned
name|subReg
parameter_list|)
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
expr_stmt|;
name|SubReg
operator|=
operator|(
name|unsigned
name|char
operator|)
name|subReg
expr_stmt|;
block|}
comment|/// substVirtReg - Substitute the current register with the virtual
comment|/// subregister Reg:SubReg. Take any existing SubReg index into account,
comment|/// using TargetRegisterInfo to compose the subreg indices if necessary.
comment|/// Reg must be a virtual register, SubIdx can be 0.
comment|///
name|void
name|substVirtReg
parameter_list|(
name|unsigned
name|Reg
parameter_list|,
name|unsigned
name|SubIdx
parameter_list|,
specifier|const
name|TargetRegisterInfo
modifier|&
parameter_list|)
function_decl|;
comment|/// substPhysReg - Substitute the current register with the physical register
comment|/// Reg, taking any existing SubReg into account. For instance,
comment|/// substPhysReg(%EAX) will change %reg1024:sub_8bit to %AL.
comment|///
name|void
name|substPhysReg
parameter_list|(
name|unsigned
name|Reg
parameter_list|,
specifier|const
name|TargetRegisterInfo
modifier|&
parameter_list|)
function_decl|;
name|void
name|setIsUse
parameter_list|(
name|bool
name|Val
init|=
name|true
parameter_list|)
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
expr_stmt|;
name|assert
argument_list|(
operator|(
name|Val
operator|||
operator|!
name|isDebug
argument_list|()
operator|)
operator|&&
literal|"Marking a debug operation as def"
argument_list|)
expr_stmt|;
name|IsDef
operator|=
operator|!
name|Val
expr_stmt|;
block|}
name|void
name|setIsDef
parameter_list|(
name|bool
name|Val
init|=
name|true
parameter_list|)
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
expr_stmt|;
name|assert
argument_list|(
operator|(
operator|!
name|Val
operator|||
operator|!
name|isDebug
argument_list|()
operator|)
operator|&&
literal|"Marking a debug operation as def"
argument_list|)
expr_stmt|;
name|IsDef
operator|=
name|Val
expr_stmt|;
block|}
name|void
name|setImplicit
parameter_list|(
name|bool
name|Val
init|=
name|true
parameter_list|)
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
expr_stmt|;
name|IsImp
operator|=
name|Val
expr_stmt|;
block|}
name|void
name|setIsKill
parameter_list|(
name|bool
name|Val
init|=
name|true
parameter_list|)
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
operator|!
name|IsDef
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
expr_stmt|;
name|assert
argument_list|(
operator|(
operator|!
name|Val
operator|||
operator|!
name|isDebug
argument_list|()
operator|)
operator|&&
literal|"Marking a debug operation as kill"
argument_list|)
expr_stmt|;
name|IsKill
operator|=
name|Val
expr_stmt|;
block|}
name|void
name|setIsDead
parameter_list|(
name|bool
name|Val
init|=
name|true
parameter_list|)
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
name|IsDef
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
expr_stmt|;
name|IsDead
operator|=
name|Val
expr_stmt|;
block|}
name|void
name|setIsUndef
parameter_list|(
name|bool
name|Val
init|=
name|true
parameter_list|)
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
expr_stmt|;
name|IsUndef
operator|=
name|Val
expr_stmt|;
block|}
name|void
name|setIsEarlyClobber
parameter_list|(
name|bool
name|Val
init|=
name|true
parameter_list|)
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
name|IsDef
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
expr_stmt|;
name|IsEarlyClobber
operator|=
name|Val
expr_stmt|;
block|}
name|void
name|setIsDebug
parameter_list|(
name|bool
name|Val
init|=
name|true
parameter_list|)
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
name|IsDef
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
expr_stmt|;
name|IsDebug
operator|=
name|Val
expr_stmt|;
block|}
comment|//===--------------------------------------------------------------------===//
comment|// Accessors for various operand types.
comment|//===--------------------------------------------------------------------===//
name|int64_t
name|getImm
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isImm
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
name|Contents
operator|.
name|ImmVal
return|;
block|}
specifier|const
name|ConstantFP
operator|*
name|getFPImm
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isFPImm
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
name|Contents
operator|.
name|CFP
return|;
block|}
name|MachineBasicBlock
operator|*
name|getMBB
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isMBB
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
name|Contents
operator|.
name|MBB
return|;
block|}
name|int
name|getIndex
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
operator|(
name|isFI
argument_list|()
operator|||
name|isCPI
argument_list|()
operator|||
name|isJTI
argument_list|()
operator|)
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
name|Contents
operator|.
name|OffsetedInfo
operator|.
name|Val
operator|.
name|Index
return|;
block|}
specifier|const
name|GlobalValue
operator|*
name|getGlobal
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isGlobal
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
name|Contents
operator|.
name|OffsetedInfo
operator|.
name|Val
operator|.
name|GV
return|;
block|}
specifier|const
name|BlockAddress
operator|*
name|getBlockAddress
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isBlockAddress
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
name|Contents
operator|.
name|OffsetedInfo
operator|.
name|Val
operator|.
name|BA
return|;
block|}
name|MCSymbol
operator|*
name|getMCSymbol
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isMCSymbol
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
name|Contents
operator|.
name|Sym
return|;
block|}
comment|/// getOffset - Return the offset from the symbol in this operand. This always
comment|/// returns 0 for ExternalSymbol operands.
name|int64_t
name|getOffset
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
operator|(
name|isGlobal
argument_list|()
operator|||
name|isSymbol
argument_list|()
operator|||
name|isCPI
argument_list|()
operator|||
name|isBlockAddress
argument_list|()
operator|)
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
name|Contents
operator|.
name|OffsetedInfo
operator|.
name|Offset
return|;
block|}
specifier|const
name|char
operator|*
name|getSymbolName
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isSymbol
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
name|Contents
operator|.
name|OffsetedInfo
operator|.
name|Val
operator|.
name|SymbolName
return|;
block|}
specifier|const
name|MDNode
operator|*
name|getMetadata
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isMetadata
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
block|;
return|return
name|Contents
operator|.
name|MD
return|;
block|}
comment|//===--------------------------------------------------------------------===//
comment|// Mutators for various operand types.
comment|//===--------------------------------------------------------------------===//
name|void
name|setImm
parameter_list|(
name|int64_t
name|immVal
parameter_list|)
block|{
name|assert
argument_list|(
name|isImm
argument_list|()
operator|&&
literal|"Wrong MachineOperand mutator"
argument_list|)
expr_stmt|;
name|Contents
operator|.
name|ImmVal
operator|=
name|immVal
expr_stmt|;
block|}
name|void
name|setOffset
parameter_list|(
name|int64_t
name|Offset
parameter_list|)
block|{
name|assert
argument_list|(
operator|(
name|isGlobal
argument_list|()
operator|||
name|isSymbol
argument_list|()
operator|||
name|isCPI
argument_list|()
operator|||
name|isBlockAddress
argument_list|()
operator|)
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
expr_stmt|;
name|Contents
operator|.
name|OffsetedInfo
operator|.
name|Offset
operator|=
name|Offset
expr_stmt|;
block|}
name|void
name|setIndex
parameter_list|(
name|int
name|Idx
parameter_list|)
block|{
name|assert
argument_list|(
operator|(
name|isFI
argument_list|()
operator|||
name|isCPI
argument_list|()
operator|||
name|isJTI
argument_list|()
operator|)
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
expr_stmt|;
name|Contents
operator|.
name|OffsetedInfo
operator|.
name|Val
operator|.
name|Index
operator|=
name|Idx
expr_stmt|;
block|}
name|void
name|setMBB
parameter_list|(
name|MachineBasicBlock
modifier|*
name|MBB
parameter_list|)
block|{
name|assert
argument_list|(
name|isMBB
argument_list|()
operator|&&
literal|"Wrong MachineOperand accessor"
argument_list|)
expr_stmt|;
name|Contents
operator|.
name|MBB
operator|=
name|MBB
expr_stmt|;
block|}
comment|//===--------------------------------------------------------------------===//
comment|// Other methods.
comment|//===--------------------------------------------------------------------===//
comment|/// isIdenticalTo - Return true if this operand is identical to the specified
comment|/// operand. Note: This method ignores isKill and isDead properties.
name|bool
name|isIdenticalTo
argument_list|(
specifier|const
name|MachineOperand
operator|&
name|Other
argument_list|)
decl|const
decl_stmt|;
comment|/// ChangeToImmediate - Replace this operand with a new immediate operand of
comment|/// the specified value.  If an operand is known to be an immediate already,
comment|/// the setImm method should be used.
name|void
name|ChangeToImmediate
parameter_list|(
name|int64_t
name|ImmVal
parameter_list|)
function_decl|;
comment|/// ChangeToRegister - Replace this operand with a new register operand of
comment|/// the specified value.  If an operand is known to be an register already,
comment|/// the setReg method should be used.
name|void
name|ChangeToRegister
parameter_list|(
name|unsigned
name|Reg
parameter_list|,
name|bool
name|isDef
parameter_list|,
name|bool
name|isImp
init|=
name|false
parameter_list|,
name|bool
name|isKill
init|=
name|false
parameter_list|,
name|bool
name|isDead
init|=
name|false
parameter_list|,
name|bool
name|isUndef
init|=
name|false
parameter_list|,
name|bool
name|isDebug
init|=
name|false
parameter_list|)
function_decl|;
comment|//===--------------------------------------------------------------------===//
comment|// Construction methods.
comment|//===--------------------------------------------------------------------===//
specifier|static
name|MachineOperand
name|CreateImm
parameter_list|(
name|int64_t
name|Val
parameter_list|)
block|{
name|MachineOperand
name|Op
argument_list|(
name|MachineOperand
operator|::
name|MO_Immediate
argument_list|)
decl_stmt|;
name|Op
operator|.
name|setImm
argument_list|(
name|Val
argument_list|)
expr_stmt|;
return|return
name|Op
return|;
block|}
specifier|static
name|MachineOperand
name|CreateFPImm
parameter_list|(
specifier|const
name|ConstantFP
modifier|*
name|CFP
parameter_list|)
block|{
name|MachineOperand
name|Op
argument_list|(
name|MachineOperand
operator|::
name|MO_FPImmediate
argument_list|)
decl_stmt|;
name|Op
operator|.
name|Contents
operator|.
name|CFP
operator|=
name|CFP
expr_stmt|;
return|return
name|Op
return|;
block|}
specifier|static
name|MachineOperand
name|CreateReg
parameter_list|(
name|unsigned
name|Reg
parameter_list|,
name|bool
name|isDef
parameter_list|,
name|bool
name|isImp
init|=
name|false
parameter_list|,
name|bool
name|isKill
init|=
name|false
parameter_list|,
name|bool
name|isDead
init|=
name|false
parameter_list|,
name|bool
name|isUndef
init|=
name|false
parameter_list|,
name|bool
name|isEarlyClobber
init|=
name|false
parameter_list|,
name|unsigned
name|SubReg
init|=
literal|0
parameter_list|,
name|bool
name|isDebug
init|=
name|false
parameter_list|)
block|{
name|MachineOperand
name|Op
argument_list|(
name|MachineOperand
operator|::
name|MO_Register
argument_list|)
decl_stmt|;
name|Op
operator|.
name|IsDef
operator|=
name|isDef
expr_stmt|;
name|Op
operator|.
name|IsImp
operator|=
name|isImp
expr_stmt|;
name|Op
operator|.
name|IsKill
operator|=
name|isKill
expr_stmt|;
name|Op
operator|.
name|IsDead
operator|=
name|isDead
expr_stmt|;
name|Op
operator|.
name|IsUndef
operator|=
name|isUndef
expr_stmt|;
name|Op
operator|.
name|IsEarlyClobber
operator|=
name|isEarlyClobber
expr_stmt|;
name|Op
operator|.
name|IsDebug
operator|=
name|isDebug
expr_stmt|;
name|Op
operator|.
name|Contents
operator|.
name|Reg
operator|.
name|RegNo
operator|=
name|Reg
expr_stmt|;
name|Op
operator|.
name|Contents
operator|.
name|Reg
operator|.
name|Prev
operator|=
literal|0
expr_stmt|;
name|Op
operator|.
name|Contents
operator|.
name|Reg
operator|.
name|Next
operator|=
literal|0
expr_stmt|;
name|Op
operator|.
name|SubReg
operator|=
name|SubReg
expr_stmt|;
return|return
name|Op
return|;
block|}
specifier|static
name|MachineOperand
name|CreateMBB
parameter_list|(
name|MachineBasicBlock
modifier|*
name|MBB
parameter_list|,
name|unsigned
name|char
name|TargetFlags
init|=
literal|0
parameter_list|)
block|{
name|MachineOperand
name|Op
argument_list|(
name|MachineOperand
operator|::
name|MO_MachineBasicBlock
argument_list|)
decl_stmt|;
name|Op
operator|.
name|setMBB
argument_list|(
name|MBB
argument_list|)
expr_stmt|;
name|Op
operator|.
name|setTargetFlags
argument_list|(
name|TargetFlags
argument_list|)
expr_stmt|;
return|return
name|Op
return|;
block|}
specifier|static
name|MachineOperand
name|CreateFI
parameter_list|(
name|unsigned
name|Idx
parameter_list|)
block|{
name|MachineOperand
name|Op
argument_list|(
name|MachineOperand
operator|::
name|MO_FrameIndex
argument_list|)
decl_stmt|;
name|Op
operator|.
name|setIndex
argument_list|(
name|Idx
argument_list|)
expr_stmt|;
return|return
name|Op
return|;
block|}
specifier|static
name|MachineOperand
name|CreateCPI
parameter_list|(
name|unsigned
name|Idx
parameter_list|,
name|int
name|Offset
parameter_list|,
name|unsigned
name|char
name|TargetFlags
init|=
literal|0
parameter_list|)
block|{
name|MachineOperand
name|Op
argument_list|(
name|MachineOperand
operator|::
name|MO_ConstantPoolIndex
argument_list|)
decl_stmt|;
name|Op
operator|.
name|setIndex
argument_list|(
name|Idx
argument_list|)
expr_stmt|;
name|Op
operator|.
name|setOffset
argument_list|(
name|Offset
argument_list|)
expr_stmt|;
name|Op
operator|.
name|setTargetFlags
argument_list|(
name|TargetFlags
argument_list|)
expr_stmt|;
return|return
name|Op
return|;
block|}
specifier|static
name|MachineOperand
name|CreateJTI
parameter_list|(
name|unsigned
name|Idx
parameter_list|,
name|unsigned
name|char
name|TargetFlags
init|=
literal|0
parameter_list|)
block|{
name|MachineOperand
name|Op
argument_list|(
name|MachineOperand
operator|::
name|MO_JumpTableIndex
argument_list|)
decl_stmt|;
name|Op
operator|.
name|setIndex
argument_list|(
name|Idx
argument_list|)
expr_stmt|;
name|Op
operator|.
name|setTargetFlags
argument_list|(
name|TargetFlags
argument_list|)
expr_stmt|;
return|return
name|Op
return|;
block|}
specifier|static
name|MachineOperand
name|CreateGA
parameter_list|(
specifier|const
name|GlobalValue
modifier|*
name|GV
parameter_list|,
name|int64_t
name|Offset
parameter_list|,
name|unsigned
name|char
name|TargetFlags
init|=
literal|0
parameter_list|)
block|{
name|MachineOperand
name|Op
argument_list|(
name|MachineOperand
operator|::
name|MO_GlobalAddress
argument_list|)
decl_stmt|;
name|Op
operator|.
name|Contents
operator|.
name|OffsetedInfo
operator|.
name|Val
operator|.
name|GV
operator|=
name|GV
expr_stmt|;
name|Op
operator|.
name|setOffset
argument_list|(
name|Offset
argument_list|)
expr_stmt|;
name|Op
operator|.
name|setTargetFlags
argument_list|(
name|TargetFlags
argument_list|)
expr_stmt|;
return|return
name|Op
return|;
block|}
specifier|static
name|MachineOperand
name|CreateES
parameter_list|(
specifier|const
name|char
modifier|*
name|SymName
parameter_list|,
name|unsigned
name|char
name|TargetFlags
init|=
literal|0
parameter_list|)
block|{
name|MachineOperand
name|Op
argument_list|(
name|MachineOperand
operator|::
name|MO_ExternalSymbol
argument_list|)
decl_stmt|;
name|Op
operator|.
name|Contents
operator|.
name|OffsetedInfo
operator|.
name|Val
operator|.
name|SymbolName
operator|=
name|SymName
expr_stmt|;
name|Op
operator|.
name|setOffset
argument_list|(
literal|0
argument_list|)
expr_stmt|;
comment|// Offset is always 0.
name|Op
operator|.
name|setTargetFlags
argument_list|(
name|TargetFlags
argument_list|)
expr_stmt|;
return|return
name|Op
return|;
block|}
specifier|static
name|MachineOperand
name|CreateBA
parameter_list|(
specifier|const
name|BlockAddress
modifier|*
name|BA
parameter_list|,
name|unsigned
name|char
name|TargetFlags
init|=
literal|0
parameter_list|)
block|{
name|MachineOperand
name|Op
argument_list|(
name|MachineOperand
operator|::
name|MO_BlockAddress
argument_list|)
decl_stmt|;
name|Op
operator|.
name|Contents
operator|.
name|OffsetedInfo
operator|.
name|Val
operator|.
name|BA
operator|=
name|BA
expr_stmt|;
name|Op
operator|.
name|setOffset
argument_list|(
literal|0
argument_list|)
expr_stmt|;
comment|// Offset is always 0.
name|Op
operator|.
name|setTargetFlags
argument_list|(
name|TargetFlags
argument_list|)
expr_stmt|;
return|return
name|Op
return|;
block|}
specifier|static
name|MachineOperand
name|CreateMetadata
parameter_list|(
specifier|const
name|MDNode
modifier|*
name|Meta
parameter_list|)
block|{
name|MachineOperand
name|Op
argument_list|(
name|MachineOperand
operator|::
name|MO_Metadata
argument_list|)
decl_stmt|;
name|Op
operator|.
name|Contents
operator|.
name|MD
operator|=
name|Meta
expr_stmt|;
return|return
name|Op
return|;
block|}
specifier|static
name|MachineOperand
name|CreateMCSymbol
parameter_list|(
name|MCSymbol
modifier|*
name|Sym
parameter_list|)
block|{
name|MachineOperand
name|Op
argument_list|(
name|MachineOperand
operator|::
name|MO_MCSymbol
argument_list|)
decl_stmt|;
name|Op
operator|.
name|Contents
operator|.
name|Sym
operator|=
name|Sym
expr_stmt|;
return|return
name|Op
return|;
block|}
name|friend
name|class
name|MachineInstr
decl_stmt|;
name|friend
name|class
name|MachineRegisterInfo
decl_stmt|;
name|private
label|:
comment|//===--------------------------------------------------------------------===//
comment|// Methods for handling register use/def lists.
comment|//===--------------------------------------------------------------------===//
comment|/// isOnRegUseList - Return true if this operand is on a register use/def list
comment|/// or false if not.  This can only be called for register operands that are
comment|/// part of a machine instruction.
name|bool
name|isOnRegUseList
argument_list|()
specifier|const
block|{
name|assert
argument_list|(
name|isReg
argument_list|()
operator|&&
literal|"Can only add reg operand to use lists"
argument_list|)
block|;
return|return
name|Contents
operator|.
name|Reg
operator|.
name|Prev
operator|!=
literal|0
return|;
block|}
comment|/// AddRegOperandToRegInfo - Add this register operand to the specified
comment|/// MachineRegisterInfo.  If it is null, then the next/prev fields should be
comment|/// explicitly nulled out.
name|void
name|AddRegOperandToRegInfo
parameter_list|(
name|MachineRegisterInfo
modifier|*
name|RegInfo
parameter_list|)
function_decl|;
comment|/// RemoveRegOperandFromRegInfo - Remove this register operand from the
comment|/// MachineRegisterInfo it is linked with.
name|void
name|RemoveRegOperandFromRegInfo
parameter_list|()
function_decl|;
block|}
empty_stmt|;
specifier|inline
name|raw_ostream
operator|&
name|operator
operator|<<
operator|(
name|raw_ostream
operator|&
name|OS
operator|,
specifier|const
name|MachineOperand
operator|&
name|MO
operator|)
block|{
name|MO
operator|.
name|print
argument_list|(
name|OS
argument_list|,
literal|0
argument_list|)
block|;
return|return
name|OS
return|;
block|}
block|}
end_decl_stmt

begin_comment
comment|// End llvm namespace
end_comment

begin_endif
endif|#
directive|endif
end_endif

end_unit

