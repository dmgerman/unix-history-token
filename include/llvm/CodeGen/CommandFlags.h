begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|//===-- CommandFlags.h - Command Line Flags Interface -----------*- C++ -*-===//
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|//                     The LLVM Compiler Infrastructure
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// This file is distributed under the University of Illinois Open Source
end_comment

begin_comment
comment|// License. See LICENSE.TXT for details.
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|//===----------------------------------------------------------------------===//
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// This file contains codegen-specific flags that are shared between different
end_comment

begin_comment
comment|// command line tools. The tools "llc" and "opt" both use this file to prevent
end_comment

begin_comment
comment|// flag duplication.
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|//===----------------------------------------------------------------------===//
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|LLVM_CODEGEN_COMMANDFLAGS_H
end_ifndef

begin_define
define|#
directive|define
name|LLVM_CODEGEN_COMMANDFLAGS_H
end_define

begin_include
include|#
directive|include
file|"llvm/ADT/StringExtras.h"
end_include

begin_include
include|#
directive|include
file|"llvm/IR/Instructions.h"
end_include

begin_include
include|#
directive|include
file|"llvm/IR/Intrinsics.h"
end_include

begin_include
include|#
directive|include
file|"llvm/IR/Module.h"
end_include

begin_include
include|#
directive|include
file|"llvm/MC/MCTargetOptionsCommandFlags.h"
end_include

begin_include
include|#
directive|include
file|"llvm/MC/SubtargetFeature.h"
end_include

begin_include
include|#
directive|include
file|"llvm/Support/CodeGen.h"
end_include

begin_include
include|#
directive|include
file|"llvm/Support/CommandLine.h"
end_include

begin_include
include|#
directive|include
file|"llvm/Support/Host.h"
end_include

begin_include
include|#
directive|include
file|"llvm/Target/TargetMachine.h"
end_include

begin_include
include|#
directive|include
file|"llvm/Target/TargetOptions.h"
end_include

begin_include
include|#
directive|include
file|<string>
end_include

begin_decl_stmt
name|using
name|namespace
name|llvm
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|std
operator|::
name|string
operator|>
name|MArch
argument_list|(
literal|"march"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Architecture to generate code for (see --version)"
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|std
operator|::
name|string
operator|>
name|MCPU
argument_list|(
literal|"mcpu"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Target a specific cpu type (-mcpu=help for details)"
argument_list|)
argument_list|,
name|cl
operator|::
name|value_desc
argument_list|(
literal|"cpu-name"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
literal|""
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|list
operator|<
name|std
operator|::
name|string
operator|>
name|MAttrs
argument_list|(
literal|"mattr"
argument_list|,
name|cl
operator|::
name|CommaSeparated
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Target specific attributes (-mattr=help for details)"
argument_list|)
argument_list|,
name|cl
operator|::
name|value_desc
argument_list|(
literal|"a1,+a2,-a3,..."
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|Reloc
operator|::
name|Model
operator|>
name|RelocModel
argument_list|(
literal|"relocation-model"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Choose relocation model"
argument_list|)
argument_list|,
name|cl
operator|::
name|values
argument_list|(
name|clEnumValN
argument_list|(
name|Reloc
operator|::
name|Static
argument_list|,
literal|"static"
argument_list|,
literal|"Non-relocatable code"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|Reloc
operator|::
name|PIC_
argument_list|,
literal|"pic"
argument_list|,
literal|"Fully relocatable, position independent code"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|Reloc
operator|::
name|DynamicNoPIC
argument_list|,
literal|"dynamic-no-pic"
argument_list|,
literal|"Relocatable external references, non-relocatable code"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|Reloc
operator|::
name|ROPI
argument_list|,
literal|"ropi"
argument_list|,
literal|"Code and read-only data relocatable, accessed PC-relative"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|Reloc
operator|::
name|RWPI
argument_list|,
literal|"rwpi"
argument_list|,
literal|"Read-write data relocatable, accessed relative to static base"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|Reloc
operator|::
name|ROPI_RWPI
argument_list|,
literal|"ropi-rwpi"
argument_list|,
literal|"Combination of ropi and rwpi"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
specifier|static
specifier|inline
name|Optional
operator|<
name|Reloc
operator|::
name|Model
operator|>
name|getRelocModel
argument_list|()
block|{
if|if
condition|(
name|RelocModel
operator|.
name|getNumOccurrences
argument_list|()
condition|)
block|{
name|Reloc
operator|::
name|Model
name|R
operator|=
name|RelocModel
expr_stmt|;
return|return
name|R
return|;
block|}
end_expr_stmt

begin_return
return|return
name|None
return|;
end_return

begin_expr_stmt
unit|}  cl
operator|::
name|opt
operator|<
name|ThreadModel
operator|::
name|Model
operator|>
name|TMModel
argument_list|(
literal|"thread-model"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Choose threading model"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|ThreadModel
operator|::
name|POSIX
argument_list|)
argument_list|,
name|cl
operator|::
name|values
argument_list|(
name|clEnumValN
argument_list|(
name|ThreadModel
operator|::
name|POSIX
argument_list|,
literal|"posix"
argument_list|,
literal|"POSIX thread model"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|ThreadModel
operator|::
name|Single
argument_list|,
literal|"single"
argument_list|,
literal|"Single thread model"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|llvm
operator|::
name|CodeModel
operator|::
name|Model
operator|>
name|CMModel
argument_list|(
literal|"code-model"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Choose code model"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|CodeModel
operator|::
name|Default
argument_list|)
argument_list|,
name|cl
operator|::
name|values
argument_list|(
name|clEnumValN
argument_list|(
name|CodeModel
operator|::
name|Default
argument_list|,
literal|"default"
argument_list|,
literal|"Target default code model"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|CodeModel
operator|::
name|Small
argument_list|,
literal|"small"
argument_list|,
literal|"Small code model"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|CodeModel
operator|::
name|Kernel
argument_list|,
literal|"kernel"
argument_list|,
literal|"Kernel code model"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|CodeModel
operator|::
name|Medium
argument_list|,
literal|"medium"
argument_list|,
literal|"Medium code model"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|CodeModel
operator|::
name|Large
argument_list|,
literal|"large"
argument_list|,
literal|"Large code model"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|llvm
operator|::
name|ExceptionHandling
operator|>
name|ExceptionModel
argument_list|(
literal|"exception-model"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"exception model"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|ExceptionHandling
operator|::
name|None
argument_list|)
argument_list|,
name|cl
operator|::
name|values
argument_list|(
name|clEnumValN
argument_list|(
name|ExceptionHandling
operator|::
name|None
argument_list|,
literal|"default"
argument_list|,
literal|"default exception handling model"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|ExceptionHandling
operator|::
name|DwarfCFI
argument_list|,
literal|"dwarf"
argument_list|,
literal|"DWARF-like CFI based exception handling"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|ExceptionHandling
operator|::
name|SjLj
argument_list|,
literal|"sjlj"
argument_list|,
literal|"SjLj exception handling"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|ExceptionHandling
operator|::
name|ARM
argument_list|,
literal|"arm"
argument_list|,
literal|"ARM EHABI exceptions"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|ExceptionHandling
operator|::
name|WinEH
argument_list|,
literal|"wineh"
argument_list|,
literal|"Windows exception model"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|TargetMachine
operator|::
name|CodeGenFileType
operator|>
name|FileType
argument_list|(
literal|"filetype"
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|TargetMachine
operator|::
name|CGFT_AssemblyFile
argument_list|)
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Choose a file type (not all types are supported by all targets):"
argument_list|)
argument_list|,
name|cl
operator|::
name|values
argument_list|(
name|clEnumValN
argument_list|(
name|TargetMachine
operator|::
name|CGFT_AssemblyFile
argument_list|,
literal|"asm"
argument_list|,
literal|"Emit an assembly ('.s') file"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|TargetMachine
operator|::
name|CGFT_ObjectFile
argument_list|,
literal|"obj"
argument_list|,
literal|"Emit a native object ('.o') file"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|TargetMachine
operator|::
name|CGFT_Null
argument_list|,
literal|"null"
argument_list|,
literal|"Emit nothing, for performance testing"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|DisableFPElim
argument_list|(
literal|"disable-fp-elim"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Disable frame pointer elimination optimization"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|false
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|EnableUnsafeFPMath
argument_list|(
literal|"enable-unsafe-fp-math"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Enable optimizations that may decrease FP precision"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|false
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|EnableNoInfsFPMath
argument_list|(
literal|"enable-no-infs-fp-math"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Enable FP math optimizations that assume no +-Infs"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|false
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|EnableNoNaNsFPMath
argument_list|(
literal|"enable-no-nans-fp-math"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Enable FP math optimizations that assume no NaNs"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|false
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|EnableNoSignedZerosFPMath
argument_list|(
literal|"enable-no-signed-zeros-fp-math"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Enable FP math optimizations that assume "
literal|"the sign of 0 is insignificant"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|false
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|EnableNoTrappingFPMath
argument_list|(
literal|"enable-no-trapping-fp-math"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Enable setting the FP exceptions build "
literal|"attribute not to use exceptions"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|false
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|llvm
operator|::
name|FPDenormal
operator|::
name|DenormalMode
operator|>
name|DenormalMode
argument_list|(
literal|"denormal-fp-math"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Select which denormal numbers the code is permitted to require"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|FPDenormal
operator|::
name|IEEE
argument_list|)
argument_list|,
name|cl
operator|::
name|values
argument_list|(
name|clEnumValN
argument_list|(
name|FPDenormal
operator|::
name|IEEE
argument_list|,
literal|"ieee"
argument_list|,
literal|"IEEE 754 denormal numbers"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|FPDenormal
operator|::
name|PreserveSign
argument_list|,
literal|"preserve-sign"
argument_list|,
literal|"the sign of a  flushed-to-zero number is preserved "
literal|"in the sign of 0"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|FPDenormal
operator|::
name|PositiveZero
argument_list|,
literal|"positive-zero"
argument_list|,
literal|"denormals are flushed to positive zero"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|EnableHonorSignDependentRoundingFPMath
argument_list|(
literal|"enable-sign-dependent-rounding-fp-math"
argument_list|,
name|cl
operator|::
name|Hidden
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Force codegen to assume rounding mode can change dynamically"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|false
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|llvm
operator|::
name|FloatABI
operator|::
name|ABIType
operator|>
name|FloatABIForCalls
argument_list|(
literal|"float-abi"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Choose float ABI type"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|FloatABI
operator|::
name|Default
argument_list|)
argument_list|,
name|cl
operator|::
name|values
argument_list|(
name|clEnumValN
argument_list|(
name|FloatABI
operator|::
name|Default
argument_list|,
literal|"default"
argument_list|,
literal|"Target default float ABI type"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|FloatABI
operator|::
name|Soft
argument_list|,
literal|"soft"
argument_list|,
literal|"Soft float ABI (implied by -soft-float)"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|FloatABI
operator|::
name|Hard
argument_list|,
literal|"hard"
argument_list|,
literal|"Hard float ABI (uses FP registers)"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|llvm
operator|::
name|FPOpFusion
operator|::
name|FPOpFusionMode
operator|>
name|FuseFPOps
argument_list|(
literal|"fp-contract"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Enable aggressive formation of fused FP ops"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|FPOpFusion
operator|::
name|Standard
argument_list|)
argument_list|,
name|cl
operator|::
name|values
argument_list|(
name|clEnumValN
argument_list|(
name|FPOpFusion
operator|::
name|Fast
argument_list|,
literal|"fast"
argument_list|,
literal|"Fuse FP ops whenever profitable"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|FPOpFusion
operator|::
name|Standard
argument_list|,
literal|"on"
argument_list|,
literal|"Only fuse 'blessed' FP ops."
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|FPOpFusion
operator|::
name|Strict
argument_list|,
literal|"off"
argument_list|,
literal|"Only fuse FP ops when the result won't be affected."
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|DontPlaceZerosInBSS
argument_list|(
literal|"nozero-initialized-in-bss"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Don't place zero-initialized symbols into bss section"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|false
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|EnableGuaranteedTailCallOpt
argument_list|(
literal|"tailcallopt"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Turn fastcc calls into tail calls by (potentially) changing ABI."
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|false
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|DisableTailCalls
argument_list|(
literal|"disable-tail-calls"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Never emit tail calls"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|false
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|StackSymbolOrdering
argument_list|(
literal|"stack-symbol-ordering"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Order local stack symbols."
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|true
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|unsigned
operator|>
name|OverrideStackAlignment
argument_list|(
literal|"stack-alignment"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Override default stack alignment"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|StackRealign
argument_list|(
literal|"stackrealign"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Force align the stack to the minimum alignment"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|false
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|std
operator|::
name|string
operator|>
name|TrapFuncName
argument_list|(
literal|"trap-func"
argument_list|,
name|cl
operator|::
name|Hidden
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Emit a call to trap function rather than a trap instruction"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
literal|""
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|UseCtors
argument_list|(
literal|"use-ctors"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Use .ctors instead of .init_array."
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|false
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|RelaxELFRelocations
argument_list|(
literal|"relax-elf-relocations"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Emit GOTPCRELX/REX_GOTPCRELX instead of GOTPCREL on x86-64 ELF"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|false
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|DataSections
argument_list|(
literal|"data-sections"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Emit data into separate sections"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|false
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|FunctionSections
argument_list|(
literal|"function-sections"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Emit functions into separate sections"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|false
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|EmulatedTLS
argument_list|(
literal|"emulated-tls"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Use emulated TLS model"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|false
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|bool
operator|>
name|UniqueSectionNames
argument_list|(
literal|"unique-section-names"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Give unique names to every section"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|true
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|llvm
operator|::
name|EABI
operator|>
name|EABIVersion
argument_list|(
literal|"meabi"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Set EABI type (default depends on triple):"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|EABI
operator|::
name|Default
argument_list|)
argument_list|,
name|cl
operator|::
name|values
argument_list|(
name|clEnumValN
argument_list|(
name|EABI
operator|::
name|Default
argument_list|,
literal|"default"
argument_list|,
literal|"Triple default EABI version"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|EABI
operator|::
name|EABI4
argument_list|,
literal|"4"
argument_list|,
literal|"EABI version 4"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|EABI
operator|::
name|EABI5
argument_list|,
literal|"5"
argument_list|,
literal|"EABI version 5"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|EABI
operator|::
name|GNU
argument_list|,
literal|"gnu"
argument_list|,
literal|"EABI GNU"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|cl
operator|::
name|opt
operator|<
name|DebuggerKind
operator|>
name|DebuggerTuningOpt
argument_list|(
literal|"debugger-tune"
argument_list|,
name|cl
operator|::
name|desc
argument_list|(
literal|"Tune debug info for a particular debugger"
argument_list|)
argument_list|,
name|cl
operator|::
name|init
argument_list|(
name|DebuggerKind
operator|::
name|Default
argument_list|)
argument_list|,
name|cl
operator|::
name|values
argument_list|(
name|clEnumValN
argument_list|(
name|DebuggerKind
operator|::
name|GDB
argument_list|,
literal|"gdb"
argument_list|,
literal|"gdb"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|DebuggerKind
operator|::
name|LLDB
argument_list|,
literal|"lldb"
argument_list|,
literal|"lldb"
argument_list|)
argument_list|,
name|clEnumValN
argument_list|(
name|DebuggerKind
operator|::
name|SCE
argument_list|,
literal|"sce"
argument_list|,
literal|"SCE targets (e.g. PS4)"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_comment
comment|// Common utility function tightly tied to the options listed here. Initializes
end_comment

begin_comment
comment|// a TargetOptions object with CodeGen flags and returns it.
end_comment

begin_function
specifier|static
specifier|inline
name|TargetOptions
name|InitTargetOptionsFromCodeGenFlags
parameter_list|()
block|{
name|TargetOptions
name|Options
decl_stmt|;
name|Options
operator|.
name|AllowFPOpFusion
operator|=
name|FuseFPOps
expr_stmt|;
name|Options
operator|.
name|UnsafeFPMath
operator|=
name|EnableUnsafeFPMath
expr_stmt|;
name|Options
operator|.
name|NoInfsFPMath
operator|=
name|EnableNoInfsFPMath
expr_stmt|;
name|Options
operator|.
name|NoNaNsFPMath
operator|=
name|EnableNoNaNsFPMath
expr_stmt|;
name|Options
operator|.
name|NoSignedZerosFPMath
operator|=
name|EnableNoSignedZerosFPMath
expr_stmt|;
name|Options
operator|.
name|NoTrappingFPMath
operator|=
name|EnableNoTrappingFPMath
expr_stmt|;
name|Options
operator|.
name|FPDenormalMode
operator|=
name|DenormalMode
expr_stmt|;
name|Options
operator|.
name|HonorSignDependentRoundingFPMathOption
operator|=
name|EnableHonorSignDependentRoundingFPMath
expr_stmt|;
if|if
condition|(
name|FloatABIForCalls
operator|!=
name|FloatABI
operator|::
name|Default
condition|)
name|Options
operator|.
name|FloatABIType
operator|=
name|FloatABIForCalls
expr_stmt|;
name|Options
operator|.
name|NoZerosInBSS
operator|=
name|DontPlaceZerosInBSS
expr_stmt|;
name|Options
operator|.
name|GuaranteedTailCallOpt
operator|=
name|EnableGuaranteedTailCallOpt
expr_stmt|;
name|Options
operator|.
name|StackAlignmentOverride
operator|=
name|OverrideStackAlignment
expr_stmt|;
name|Options
operator|.
name|StackSymbolOrdering
operator|=
name|StackSymbolOrdering
expr_stmt|;
name|Options
operator|.
name|UseInitArray
operator|=
operator|!
name|UseCtors
expr_stmt|;
name|Options
operator|.
name|RelaxELFRelocations
operator|=
name|RelaxELFRelocations
expr_stmt|;
name|Options
operator|.
name|DataSections
operator|=
name|DataSections
expr_stmt|;
name|Options
operator|.
name|FunctionSections
operator|=
name|FunctionSections
expr_stmt|;
name|Options
operator|.
name|UniqueSectionNames
operator|=
name|UniqueSectionNames
expr_stmt|;
name|Options
operator|.
name|EmulatedTLS
operator|=
name|EmulatedTLS
expr_stmt|;
name|Options
operator|.
name|ExceptionModel
operator|=
name|ExceptionModel
expr_stmt|;
name|Options
operator|.
name|MCOptions
operator|=
name|InitMCTargetOptionsFromFlags
argument_list|()
expr_stmt|;
name|Options
operator|.
name|ThreadModel
operator|=
name|TMModel
expr_stmt|;
name|Options
operator|.
name|EABIVersion
operator|=
name|EABIVersion
expr_stmt|;
name|Options
operator|.
name|DebuggerTuning
operator|=
name|DebuggerTuningOpt
expr_stmt|;
return|return
name|Options
return|;
block|}
end_function

begin_expr_stmt
specifier|static
specifier|inline
name|std
operator|::
name|string
name|getCPUStr
argument_list|()
block|{
comment|// If user asked for the 'native' CPU, autodetect here. If autodection fails,
comment|// this will set the CPU to an empty string which tells the target to
comment|// pick a basic default.
if|if
condition|(
name|MCPU
operator|==
literal|"native"
condition|)
return|return
name|sys
operator|::
name|getHostCPUName
argument_list|()
return|;
end_expr_stmt

begin_return
return|return
name|MCPU
return|;
end_return

begin_expr_stmt
unit|}  static
specifier|inline
name|std
operator|::
name|string
name|getFeaturesStr
argument_list|()
block|{
name|SubtargetFeatures
name|Features
block|;
comment|// If user asked for the 'native' CPU, we need to autodetect features.
comment|// This is necessary for x86 where the CPU might not support all the
comment|// features the autodetected CPU name lists in the target. For example,
comment|// not all Sandybridge processors support AVX.
if|if
condition|(
name|MCPU
operator|==
literal|"native"
condition|)
block|{
name|StringMap
operator|<
name|bool
operator|>
name|HostFeatures
expr_stmt|;
if|if
condition|(
name|sys
operator|::
name|getHostCPUFeatures
argument_list|(
name|HostFeatures
argument_list|)
condition|)
for|for
control|(
name|auto
operator|&
name|F
operator|:
name|HostFeatures
control|)
name|Features
operator|.
name|AddFeature
argument_list|(
name|F
operator|.
name|first
argument_list|()
argument_list|,
name|F
operator|.
name|second
argument_list|)
expr_stmt|;
block|}
end_expr_stmt

begin_for
for|for
control|(
name|unsigned
name|i
init|=
literal|0
init|;
name|i
operator|!=
name|MAttrs
operator|.
name|size
argument_list|()
condition|;
operator|++
name|i
control|)
name|Features
operator|.
name|AddFeature
argument_list|(
name|MAttrs
index|[
name|i
index|]
argument_list|)
expr_stmt|;
end_for

begin_return
return|return
name|Features
operator|.
name|getString
argument_list|()
return|;
end_return

begin_comment
unit|}
comment|/// \brief Set function attributes of functions in Module M based on CPU,
end_comment

begin_comment
comment|/// Features, and command line flags.
end_comment

begin_function
unit|static
specifier|inline
name|void
name|setFunctionAttributes
parameter_list|(
name|StringRef
name|CPU
parameter_list|,
name|StringRef
name|Features
parameter_list|,
name|Module
modifier|&
name|M
parameter_list|)
block|{
for|for
control|(
name|auto
operator|&
name|F
operator|:
name|M
control|)
block|{
name|auto
operator|&
name|Ctx
operator|=
name|F
operator|.
name|getContext
argument_list|()
expr_stmt|;
name|AttributeList
name|Attrs
init|=
name|F
operator|.
name|getAttributes
argument_list|()
decl_stmt|,
name|NewAttrs
decl_stmt|;
if|if
condition|(
operator|!
name|CPU
operator|.
name|empty
argument_list|()
condition|)
name|NewAttrs
operator|=
name|NewAttrs
operator|.
name|addAttribute
argument_list|(
name|Ctx
argument_list|,
name|AttributeList
operator|::
name|FunctionIndex
argument_list|,
literal|"target-cpu"
argument_list|,
name|CPU
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|Features
operator|.
name|empty
argument_list|()
condition|)
name|NewAttrs
operator|=
name|NewAttrs
operator|.
name|addAttribute
argument_list|(
name|Ctx
argument_list|,
name|AttributeList
operator|::
name|FunctionIndex
argument_list|,
literal|"target-features"
argument_list|,
name|Features
argument_list|)
expr_stmt|;
if|if
condition|(
name|DisableFPElim
operator|.
name|getNumOccurrences
argument_list|()
operator|>
literal|0
condition|)
name|NewAttrs
operator|=
name|NewAttrs
operator|.
name|addAttribute
argument_list|(
name|Ctx
argument_list|,
name|AttributeList
operator|::
name|FunctionIndex
argument_list|,
literal|"no-frame-pointer-elim"
argument_list|,
name|DisableFPElim
condition|?
literal|"true"
else|:
literal|"false"
argument_list|)
expr_stmt|;
if|if
condition|(
name|DisableTailCalls
operator|.
name|getNumOccurrences
argument_list|()
operator|>
literal|0
condition|)
name|NewAttrs
operator|=
name|NewAttrs
operator|.
name|addAttribute
argument_list|(
name|Ctx
argument_list|,
name|AttributeList
operator|::
name|FunctionIndex
argument_list|,
literal|"disable-tail-calls"
argument_list|,
name|toStringRef
argument_list|(
name|DisableTailCalls
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|StackRealign
condition|)
name|NewAttrs
operator|=
name|NewAttrs
operator|.
name|addAttribute
argument_list|(
name|Ctx
argument_list|,
name|AttributeList
operator|::
name|FunctionIndex
argument_list|,
literal|"stackrealign"
argument_list|)
expr_stmt|;
if|if
condition|(
name|TrapFuncName
operator|.
name|getNumOccurrences
argument_list|()
operator|>
literal|0
condition|)
for|for
control|(
name|auto
operator|&
name|B
operator|:
name|F
control|)
for|for
control|(
name|auto
operator|&
name|I
operator|:
name|B
control|)
if|if
condition|(
name|auto
operator|*
name|Call
operator|=
name|dyn_cast
operator|<
name|CallInst
operator|>
operator|(
operator|&
name|I
operator|)
condition|)
if|if
condition|(
specifier|const
specifier|auto
modifier|*
name|F
init|=
name|Call
operator|->
name|getCalledFunction
argument_list|()
condition|)
if|if
condition|(
name|F
operator|->
name|getIntrinsicID
argument_list|()
operator|==
name|Intrinsic
operator|::
name|debugtrap
operator|||
name|F
operator|->
name|getIntrinsicID
argument_list|()
operator|==
name|Intrinsic
operator|::
name|trap
condition|)
name|Call
operator|->
name|addAttribute
argument_list|(
name|llvm
operator|::
name|AttributeList
operator|::
name|FunctionIndex
argument_list|,
name|Attribute
operator|::
name|get
argument_list|(
name|Ctx
argument_list|,
literal|"trap-func-name"
argument_list|,
name|TrapFuncName
argument_list|)
argument_list|)
expr_stmt|;
comment|// Let NewAttrs override Attrs.
name|NewAttrs
operator|=
name|Attrs
operator|.
name|addAttributes
argument_list|(
name|Ctx
argument_list|,
name|AttributeList
operator|::
name|FunctionIndex
argument_list|,
name|NewAttrs
argument_list|)
expr_stmt|;
name|F
operator|.
name|setAttributes
argument_list|(
name|NewAttrs
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

end_unit

