begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_define
define|#
directive|define
name|LCASE
value|01
end_define

begin_define
define|#
directive|define
name|UCASE
value|02
end_define

begin_define
define|#
directive|define
name|SWAB
value|04
end_define

begin_define
define|#
directive|define
name|NERR
value|010
end_define

begin_define
define|#
directive|define
name|SYNC
value|020
end_define

begin_decl_stmt
name|int
name|cflag
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|fflag
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|skip
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|count
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|string
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|ifile
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|ofile
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|ibuf
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|obuf
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|char
operator|*
name|ibs
literal|512
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|char
operator|*
name|obs
literal|512
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|char
modifier|*
name|bs
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|cbs
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|ibc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|obc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|cbc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nifr
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nipr
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nofr
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nopr
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|ntrunc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|ibf
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|obf
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|op
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nspace
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
name|etoa
index|[]
block|{
literal|0000
operator|,
literal|0001
operator|,
literal|0002
operator|,
literal|0003
operator|,
literal|0234
operator|,
literal|0011
operator|,
literal|0206
operator|,
literal|0177
operator|,
literal|0227
operator|,
literal|0215
operator|,
literal|0216
operator|,
literal|0013
operator|,
literal|0014
operator|,
literal|0015
operator|,
literal|0016
operator|,
literal|0017
operator|,
literal|0020
operator|,
literal|0021
operator|,
literal|0022
operator|,
literal|0023
operator|,
literal|0235
operator|,
literal|0205
operator|,
literal|0010
operator|,
literal|0207
operator|,
literal|0030
operator|,
literal|0031
operator|,
literal|0222
operator|,
literal|0217
operator|,
literal|0034
operator|,
literal|0035
operator|,
literal|0036
operator|,
literal|0037
operator|,
literal|0200
operator|,
literal|0201
operator|,
literal|0202
operator|,
literal|0203
operator|,
literal|0204
operator|,
literal|0012
operator|,
literal|0027
operator|,
literal|0033
operator|,
literal|0210
operator|,
literal|0211
operator|,
literal|0212
operator|,
literal|0213
operator|,
literal|0214
operator|,
literal|0005
operator|,
literal|0006
operator|,
literal|0007
operator|,
literal|0220
operator|,
literal|0221
operator|,
literal|0026
operator|,
literal|0223
operator|,
literal|0224
operator|,
literal|0225
operator|,
literal|0226
operator|,
literal|0004
operator|,
literal|0230
operator|,
literal|0231
operator|,
literal|0232
operator|,
literal|0233
operator|,
literal|0024
operator|,
literal|0025
operator|,
literal|0236
operator|,
literal|0032
operator|,
literal|0040
operator|,
literal|0240
operator|,
literal|0241
operator|,
literal|0242
operator|,
literal|0243
operator|,
literal|0244
operator|,
literal|0245
operator|,
literal|0246
operator|,
literal|0247
operator|,
literal|0250
operator|,
literal|0133
operator|,
literal|0056
operator|,
literal|0074
operator|,
literal|0050
operator|,
literal|0053
operator|,
literal|0041
operator|,
literal|0046
operator|,
literal|0251
operator|,
literal|0252
operator|,
literal|0253
operator|,
literal|0254
operator|,
literal|0255
operator|,
literal|0256
operator|,
literal|0257
operator|,
literal|0260
operator|,
literal|0261
operator|,
literal|0135
operator|,
literal|0044
operator|,
literal|0052
operator|,
literal|0051
operator|,
literal|0073
operator|,
literal|0136
operator|,
literal|0055
operator|,
literal|0057
operator|,
literal|0262
operator|,
literal|0263
operator|,
literal|0264
operator|,
literal|0265
operator|,
literal|0266
operator|,
literal|0267
operator|,
literal|0270
operator|,
literal|0271
operator|,
literal|0174
operator|,
literal|0054
operator|,
literal|0045
operator|,
literal|0137
operator|,
literal|0076
operator|,
literal|0077
operator|,
literal|0272
operator|,
literal|0273
operator|,
literal|0274
operator|,
literal|0275
operator|,
literal|0276
operator|,
literal|0277
operator|,
literal|0300
operator|,
literal|0301
operator|,
literal|0302
operator|,
literal|0140
operator|,
literal|0072
operator|,
literal|0043
operator|,
literal|0100
operator|,
literal|0047
operator|,
literal|0075
operator|,
literal|0042
operator|,
literal|0303
operator|,
literal|0141
operator|,
literal|0142
operator|,
literal|0143
operator|,
literal|0144
operator|,
literal|0145
operator|,
literal|0146
operator|,
literal|0147
operator|,
literal|0150
operator|,
literal|0151
operator|,
literal|0304
operator|,
literal|0305
operator|,
literal|0306
operator|,
literal|0307
operator|,
literal|0310
operator|,
literal|0311
operator|,
literal|0312
operator|,
literal|0152
operator|,
literal|0153
operator|,
literal|0154
operator|,
literal|0155
operator|,
literal|0156
operator|,
literal|0157
operator|,
literal|0160
operator|,
literal|0161
operator|,
literal|0162
operator|,
literal|0313
operator|,
literal|0314
operator|,
literal|0315
operator|,
literal|0316
operator|,
literal|0317
operator|,
literal|0320
operator|,
literal|0321
operator|,
literal|0176
operator|,
literal|0163
operator|,
literal|0164
operator|,
literal|0165
operator|,
literal|0166
operator|,
literal|0167
operator|,
literal|0170
operator|,
literal|0171
operator|,
literal|0172
operator|,
literal|0322
operator|,
literal|0323
operator|,
literal|0324
operator|,
literal|0325
operator|,
literal|0326
operator|,
literal|0327
operator|,
literal|0330
operator|,
literal|0331
operator|,
literal|0332
operator|,
literal|0333
operator|,
literal|0334
operator|,
literal|0335
operator|,
literal|0336
operator|,
literal|0337
operator|,
literal|0340
operator|,
literal|0341
operator|,
literal|0342
operator|,
literal|0343
operator|,
literal|0344
operator|,
literal|0345
operator|,
literal|0346
operator|,
literal|0347
operator|,
literal|0173
operator|,
literal|0101
operator|,
literal|0102
operator|,
literal|0103
operator|,
literal|0104
operator|,
literal|0105
operator|,
literal|0106
operator|,
literal|0107
operator|,
literal|0110
operator|,
literal|0111
operator|,
literal|0350
operator|,
literal|0351
operator|,
literal|0352
operator|,
literal|0353
operator|,
literal|0354
operator|,
literal|0355
operator|,
literal|0175
operator|,
literal|0112
operator|,
literal|0113
operator|,
literal|0114
operator|,
literal|0115
operator|,
literal|0116
operator|,
literal|0117
operator|,
literal|0120
operator|,
literal|0121
operator|,
literal|0122
operator|,
literal|0356
operator|,
literal|0357
operator|,
literal|0360
operator|,
literal|0361
operator|,
literal|0362
operator|,
literal|0363
operator|,
literal|0134
operator|,
literal|0237
operator|,
literal|0123
operator|,
literal|0124
operator|,
literal|0125
operator|,
literal|0126
operator|,
literal|0127
operator|,
literal|0130
operator|,
literal|0131
operator|,
literal|0132
operator|,
literal|0364
operator|,
literal|0365
operator|,
literal|0366
operator|,
literal|0367
operator|,
literal|0370
operator|,
literal|0371
operator|,
literal|0060
operator|,
literal|0061
operator|,
literal|0062
operator|,
literal|0063
operator|,
literal|0064
operator|,
literal|0065
operator|,
literal|0066
operator|,
literal|0067
operator|,
literal|0070
operator|,
literal|0071
operator|,
literal|0372
operator|,
literal|0373
operator|,
literal|0374
operator|,
literal|0375
operator|,
literal|0376
operator|,
literal|0377
operator|,
block|}
end_decl_stmt

begin_empty_stmt
empty_stmt|;
end_empty_stmt

begin_decl_stmt
name|char
name|atoe
index|[]
block|{
literal|0000
operator|,
literal|0001
operator|,
literal|0002
operator|,
literal|0003
operator|,
literal|0067
operator|,
literal|0055
operator|,
literal|0056
operator|,
literal|0057
operator|,
literal|0026
operator|,
literal|0005
operator|,
literal|0045
operator|,
literal|0013
operator|,
literal|0014
operator|,
literal|0015
operator|,
literal|0016
operator|,
literal|0017
operator|,
literal|0020
operator|,
literal|0021
operator|,
literal|0022
operator|,
literal|0023
operator|,
literal|0074
operator|,
literal|0075
operator|,
literal|0062
operator|,
literal|0046
operator|,
literal|0030
operator|,
literal|0031
operator|,
literal|0077
operator|,
literal|0047
operator|,
literal|0034
operator|,
literal|0035
operator|,
literal|0036
operator|,
literal|0037
operator|,
literal|0100
operator|,
literal|0117
operator|,
literal|0177
operator|,
literal|0173
operator|,
literal|0133
operator|,
literal|0154
operator|,
literal|0120
operator|,
literal|0175
operator|,
literal|0115
operator|,
literal|0135
operator|,
literal|0134
operator|,
literal|0116
operator|,
literal|0153
operator|,
literal|0140
operator|,
literal|0113
operator|,
literal|0141
operator|,
literal|0360
operator|,
literal|0361
operator|,
literal|0362
operator|,
literal|0363
operator|,
literal|0364
operator|,
literal|0365
operator|,
literal|0366
operator|,
literal|0367
operator|,
literal|0370
operator|,
literal|0371
operator|,
literal|0172
operator|,
literal|0136
operator|,
literal|0114
operator|,
literal|0176
operator|,
literal|0156
operator|,
literal|0157
operator|,
literal|0174
operator|,
literal|0301
operator|,
literal|0302
operator|,
literal|0303
operator|,
literal|0304
operator|,
literal|0305
operator|,
literal|0306
operator|,
literal|0307
operator|,
literal|0310
operator|,
literal|0311
operator|,
literal|0321
operator|,
literal|0322
operator|,
literal|0323
operator|,
literal|0324
operator|,
literal|0325
operator|,
literal|0326
operator|,
literal|0327
operator|,
literal|0330
operator|,
literal|0331
operator|,
literal|0342
operator|,
literal|0343
operator|,
literal|0344
operator|,
literal|0345
operator|,
literal|0346
operator|,
literal|0347
operator|,
literal|0350
operator|,
literal|0351
operator|,
literal|0112
operator|,
literal|0340
operator|,
literal|0132
operator|,
literal|0137
operator|,
literal|0155
operator|,
literal|0171
operator|,
literal|0201
operator|,
literal|0202
operator|,
literal|0203
operator|,
literal|0204
operator|,
literal|0205
operator|,
literal|0206
operator|,
literal|0207
operator|,
literal|0210
operator|,
literal|0211
operator|,
literal|0221
operator|,
literal|0222
operator|,
literal|0223
operator|,
literal|0224
operator|,
literal|0225
operator|,
literal|0226
operator|,
literal|0227
operator|,
literal|0230
operator|,
literal|0231
operator|,
literal|0242
operator|,
literal|0243
operator|,
literal|0244
operator|,
literal|0245
operator|,
literal|0246
operator|,
literal|0247
operator|,
literal|0250
operator|,
literal|0251
operator|,
literal|0300
operator|,
literal|0152
operator|,
literal|0320
operator|,
literal|0241
operator|,
literal|0007
operator|,
literal|0040
operator|,
literal|0041
operator|,
literal|0042
operator|,
literal|0043
operator|,
literal|0044
operator|,
literal|0025
operator|,
literal|0006
operator|,
literal|0027
operator|,
literal|0050
operator|,
literal|0051
operator|,
literal|0052
operator|,
literal|0053
operator|,
literal|0054
operator|,
literal|0011
operator|,
literal|0012
operator|,
literal|0033
operator|,
literal|0060
operator|,
literal|0061
operator|,
literal|0032
operator|,
literal|0063
operator|,
literal|0064
operator|,
literal|0065
operator|,
literal|0066
operator|,
literal|0010
operator|,
literal|0070
operator|,
literal|0071
operator|,
literal|0072
operator|,
literal|0073
operator|,
literal|0004
operator|,
literal|0024
operator|,
literal|0076
operator|,
literal|0341
operator|,
literal|0101
operator|,
literal|0102
operator|,
literal|0103
operator|,
literal|0104
operator|,
literal|0105
operator|,
literal|0106
operator|,
literal|0107
operator|,
literal|0110
operator|,
literal|0111
operator|,
literal|0121
operator|,
literal|0122
operator|,
literal|0123
operator|,
literal|0124
operator|,
literal|0125
operator|,
literal|0126
operator|,
literal|0127
operator|,
literal|0130
operator|,
literal|0131
operator|,
literal|0142
operator|,
literal|0143
operator|,
literal|0144
operator|,
literal|0145
operator|,
literal|0146
operator|,
literal|0147
operator|,
literal|0150
operator|,
literal|0151
operator|,
literal|0160
operator|,
literal|0161
operator|,
literal|0162
operator|,
literal|0163
operator|,
literal|0164
operator|,
literal|0165
operator|,
literal|0166
operator|,
literal|0167
operator|,
literal|0170
operator|,
literal|0200
operator|,
literal|0212
operator|,
literal|0213
operator|,
literal|0214
operator|,
literal|0215
operator|,
literal|0216
operator|,
literal|0217
operator|,
literal|0220
operator|,
literal|0232
operator|,
literal|0233
operator|,
literal|0234
operator|,
literal|0235
operator|,
literal|0236
operator|,
literal|0237
operator|,
literal|0240
operator|,
literal|0252
operator|,
literal|0253
operator|,
literal|0254
operator|,
literal|0255
operator|,
literal|0256
operator|,
literal|0257
operator|,
literal|0260
operator|,
literal|0261
operator|,
literal|0262
operator|,
literal|0263
operator|,
literal|0264
operator|,
literal|0265
operator|,
literal|0266
operator|,
literal|0267
operator|,
literal|0270
operator|,
literal|0271
operator|,
literal|0272
operator|,
literal|0273
operator|,
literal|0274
operator|,
literal|0275
operator|,
literal|0276
operator|,
literal|0277
operator|,
literal|0312
operator|,
literal|0313
operator|,
literal|0314
operator|,
literal|0315
operator|,
literal|0316
operator|,
literal|0317
operator|,
literal|0332
operator|,
literal|0333
operator|,
literal|0334
operator|,
literal|0335
operator|,
literal|0336
operator|,
literal|0337
operator|,
literal|0352
operator|,
literal|0353
operator|,
literal|0354
operator|,
literal|0355
operator|,
literal|0356
operator|,
literal|0357
operator|,
literal|0372
operator|,
literal|0373
operator|,
literal|0374
operator|,
literal|0375
operator|,
literal|0376
operator|,
literal|0377
operator|,
block|}
end_decl_stmt

begin_empty_stmt
empty_stmt|;
end_empty_stmt

begin_function
name|main
parameter_list|(
name|argc
parameter_list|,
name|argv
parameter_list|)
name|int
name|argc
decl_stmt|;
name|char
modifier|*
modifier|*
name|argv
decl_stmt|;
block|{
specifier|register
function_decl|(
modifier|*
name|conv
function_decl|)
parameter_list|()
function_decl|;
specifier|register
name|char
modifier|*
name|ip
decl_stmt|;
specifier|register
name|c
expr_stmt|;
name|int
name|ebcdic
argument_list|()
decl_stmt|,
name|ascii
argument_list|()
decl_stmt|,
name|null
argument_list|()
decl_stmt|,
name|cnull
argument_list|()
decl_stmt|,
name|term
argument_list|()
decl_stmt|;
name|int
name|a
decl_stmt|;
name|conv
operator|=
name|null
expr_stmt|;
for|for
control|(
name|c
operator|=
literal|1
init|;
name|c
operator|<
name|argc
condition|;
name|c
operator|++
control|)
block|{
name|string
operator|=
name|argv
index|[
name|c
index|]
expr_stmt|;
if|if
condition|(
name|match
argument_list|(
literal|"ibs="
argument_list|)
condition|)
block|{
name|ibs
operator|=
name|number
argument_list|()
expr_stmt|;
continue|continue;
block|}
if|if
condition|(
name|match
argument_list|(
literal|"obs="
argument_list|)
condition|)
block|{
name|obs
operator|=
name|number
argument_list|()
expr_stmt|;
continue|continue;
block|}
if|if
condition|(
name|match
argument_list|(
literal|"cbs="
argument_list|)
condition|)
block|{
name|cbs
operator|=
name|number
argument_list|()
expr_stmt|;
continue|continue;
block|}
if|if
condition|(
name|match
argument_list|(
literal|"bs="
argument_list|)
condition|)
block|{
name|bs
operator|=
name|number
argument_list|()
expr_stmt|;
continue|continue;
block|}
if|if
condition|(
name|match
argument_list|(
literal|"if="
argument_list|)
condition|)
block|{
name|ifile
operator|=
name|string
expr_stmt|;
continue|continue;
block|}
if|if
condition|(
name|match
argument_list|(
literal|"of="
argument_list|)
condition|)
block|{
name|ofile
operator|=
name|string
expr_stmt|;
continue|continue;
block|}
if|if
condition|(
name|match
argument_list|(
literal|"skip="
argument_list|)
condition|)
block|{
name|skip
operator|=
name|number
argument_list|()
expr_stmt|;
continue|continue;
block|}
if|if
condition|(
name|match
argument_list|(
literal|"count="
argument_list|)
condition|)
block|{
name|count
operator|=
name|number
argument_list|()
expr_stmt|;
continue|continue;
block|}
if|if
condition|(
name|match
argument_list|(
literal|"conv="
argument_list|)
condition|)
block|{
name|cloop
label|:
if|if
condition|(
name|match
argument_list|(
literal|","
argument_list|)
condition|)
goto|goto
name|cloop
goto|;
if|if
condition|(
operator|*
name|string
operator|==
literal|'\0'
condition|)
continue|continue;
if|if
condition|(
name|match
argument_list|(
literal|"ebcdic"
argument_list|)
condition|)
block|{
name|conv
operator|=
name|ebcdic
expr_stmt|;
goto|goto
name|cloop
goto|;
block|}
if|if
condition|(
name|match
argument_list|(
literal|"ascii"
argument_list|)
condition|)
block|{
name|conv
operator|=
name|ascii
expr_stmt|;
goto|goto
name|cloop
goto|;
block|}
if|if
condition|(
name|match
argument_list|(
literal|"lcase"
argument_list|)
condition|)
block|{
name|cflag
operator|=
operator||
name|LCASE
expr_stmt|;
goto|goto
name|cloop
goto|;
block|}
if|if
condition|(
name|match
argument_list|(
literal|"ucase"
argument_list|)
condition|)
block|{
name|cflag
operator|=
operator||
name|UCASE
expr_stmt|;
goto|goto
name|cloop
goto|;
block|}
if|if
condition|(
name|match
argument_list|(
literal|"swab"
argument_list|)
condition|)
block|{
name|cflag
operator|=
operator||
name|SWAB
expr_stmt|;
goto|goto
name|cloop
goto|;
block|}
if|if
condition|(
name|match
argument_list|(
literal|"noerror"
argument_list|)
condition|)
block|{
name|cflag
operator|=
operator||
name|NERR
expr_stmt|;
goto|goto
name|cloop
goto|;
block|}
if|if
condition|(
name|match
argument_list|(
literal|"sync"
argument_list|)
condition|)
block|{
name|cflag
operator|=
operator||
name|SYNC
expr_stmt|;
goto|goto
name|cloop
goto|;
block|}
block|}
name|printf
argument_list|(
literal|"bad arg: %s\n"
argument_list|,
name|string
argument_list|)
expr_stmt|;
name|exit
argument_list|()
expr_stmt|;
block|}
if|if
condition|(
name|conv
operator|==
name|null
operator|&&
name|cflag
operator|&
operator|(
name|LCASE
operator||
name|UCASE
operator|)
condition|)
name|conv
operator|=
name|cnull
expr_stmt|;
if|if
condition|(
name|ifile
condition|)
name|ibf
operator|=
name|open
argument_list|(
name|ifile
argument_list|,
literal|0
argument_list|)
expr_stmt|;
else|else
name|ibf
operator|=
name|dup
argument_list|(
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|ibf
operator|<
literal|0
condition|)
block|{
name|printf
argument_list|(
literal|"cannot open: %s\n"
argument_list|,
name|ifile
argument_list|)
expr_stmt|;
name|exit
argument_list|()
expr_stmt|;
block|}
if|if
condition|(
name|ofile
condition|)
name|obf
operator|=
name|creat
argument_list|(
name|ofile
argument_list|,
literal|0666
argument_list|)
expr_stmt|;
else|else
name|obf
operator|=
name|dup
argument_list|(
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|obf
operator|<
literal|0
condition|)
block|{
name|printf
argument_list|(
literal|"cannot create: %s\n"
argument_list|,
name|ofile
argument_list|)
expr_stmt|;
name|exit
argument_list|()
expr_stmt|;
block|}
if|if
condition|(
name|bs
condition|)
block|{
name|ibs
operator|=
name|obs
operator|=
name|bs
expr_stmt|;
if|if
condition|(
name|conv
operator|==
name|null
condition|)
name|fflag
operator|++
expr_stmt|;
block|}
if|if
condition|(
name|ibs
operator|==
literal|0
operator|||
name|obs
operator|==
literal|0
condition|)
block|{
name|printf
argument_list|(
literal|"counts: cannot be zero\n"
argument_list|)
expr_stmt|;
name|exit
argument_list|()
expr_stmt|;
block|}
name|ibuf
operator|=
name|sbrk
argument_list|(
name|ibs
argument_list|)
expr_stmt|;
if|if
condition|(
name|fflag
condition|)
name|obuf
operator|=
name|ibuf
expr_stmt|;
else|else
name|obuf
operator|=
name|sbrk
argument_list|(
name|obs
argument_list|)
expr_stmt|;
if|if
condition|(
name|ibuf
operator|==
operator|-
literal|1
operator|||
name|obuf
operator|==
operator|-
literal|1
condition|)
block|{
name|printf
argument_list|(
literal|"not enough memory\n"
argument_list|)
expr_stmt|;
name|exit
argument_list|()
expr_stmt|;
block|}
name|ibc
operator|=
literal|0
expr_stmt|;
name|obc
operator|=
literal|0
expr_stmt|;
name|cbc
operator|=
literal|0
expr_stmt|;
name|op
operator|=
name|obuf
expr_stmt|;
if|if
condition|(
operator|(
name|signal
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
operator|&
literal|01
operator|)
operator|==
literal|0
condition|)
name|signal
argument_list|(
literal|2
argument_list|,
name|term
argument_list|)
expr_stmt|;
while|while
condition|(
name|skip
condition|)
block|{
name|read
argument_list|(
name|ibf
argument_list|,
name|ibuf
argument_list|,
name|ibs
argument_list|)
expr_stmt|;
name|skip
operator|--
expr_stmt|;
block|}
name|loop
label|:
if|if
condition|(
name|ibc
operator|--
operator|==
literal|0
condition|)
block|{
name|ibc
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|count
operator|==
literal|0
operator|||
name|nifr
operator|+
name|nipr
operator|!=
name|count
condition|)
block|{
if|if
condition|(
name|cflag
operator|&
operator|(
name|NERR
operator||
name|SYNC
operator|)
condition|)
for|for
control|(
name|ip
operator|=
name|ibuf
operator|+
name|ibs
init|;
name|ip
operator|>
name|ibuf
condition|;
control|)
operator|*
operator|--
name|ip
operator|=
literal|0
expr_stmt|;
name|ibc
operator|=
name|read
argument_list|(
name|ibf
argument_list|,
name|ibuf
argument_list|,
name|ibs
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|ibc
operator|==
operator|-
literal|1
condition|)
block|{
name|perror
argument_list|(
literal|"read"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|cflag
operator|&
name|NERR
operator|)
operator|==
literal|0
condition|)
block|{
name|flsh
argument_list|()
expr_stmt|;
name|term
argument_list|()
expr_stmt|;
block|}
name|ibc
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|c
operator|=
literal|0
init|;
name|c
operator|<
name|ibs
condition|;
name|c
operator|++
control|)
if|if
condition|(
name|ibuf
index|[
name|c
index|]
operator|!=
literal|0
condition|)
name|ibc
operator|=
name|c
expr_stmt|;
name|stats
argument_list|()
expr_stmt|;
block|}
if|if
condition|(
name|ibc
operator|==
literal|0
condition|)
block|{
name|flsh
argument_list|()
expr_stmt|;
name|term
argument_list|()
expr_stmt|;
block|}
if|if
condition|(
name|ibc
operator|!=
name|ibs
condition|)
block|{
name|nipr
operator|++
expr_stmt|;
if|if
condition|(
name|cflag
operator|&
name|SYNC
condition|)
name|ibc
operator|=
name|ibs
expr_stmt|;
block|}
else|else
name|nifr
operator|++
expr_stmt|;
name|ip
operator|=
name|ibuf
expr_stmt|;
name|c
operator|=
operator|(
name|ibc
operator|>>
literal|1
operator|)
operator|&
operator|~
literal|1
expr_stmt|;
if|if
condition|(
name|cflag
operator|&
name|SWAB
operator|&&
name|c
condition|)
do|do
block|{
name|a
operator|=
operator|*
name|ip
operator|++
expr_stmt|;
name|ip
index|[
operator|-
literal|1
index|]
operator|=
operator|*
name|ip
expr_stmt|;
operator|*
name|ip
operator|++
operator|=
name|a
expr_stmt|;
block|}
do|while
condition|(
operator|--
name|c
condition|)
do|;
name|ip
operator|=
name|ibuf
expr_stmt|;
if|if
condition|(
name|fflag
condition|)
block|{
name|obc
operator|=
name|ibc
expr_stmt|;
name|flsh
argument_list|()
expr_stmt|;
name|ibc
operator|=
literal|0
expr_stmt|;
block|}
goto|goto
name|loop
goto|;
block|}
name|c
operator|=
literal|0
expr_stmt|;
name|c
operator|=
operator||
operator|*
name|ip
operator|++
expr_stmt|;
call|(
modifier|*
name|conv
call|)
argument_list|(
name|c
argument_list|)
expr_stmt|;
goto|goto
name|loop
goto|;
block|}
end_function

begin_macro
name|flsh
argument_list|()
end_macro

begin_block
block|{
specifier|register
name|c
expr_stmt|;
if|if
condition|(
name|obc
condition|)
block|{
if|if
condition|(
name|obc
operator|==
name|obs
condition|)
name|nofr
operator|++
expr_stmt|;
else|else
name|nopr
operator|++
expr_stmt|;
name|c
operator|=
name|write
argument_list|(
name|obf
argument_list|,
name|obuf
argument_list|,
name|obc
argument_list|)
expr_stmt|;
if|if
condition|(
name|c
operator|!=
name|obc
condition|)
block|{
name|perror
argument_list|(
literal|"write"
argument_list|)
expr_stmt|;
name|term
argument_list|()
expr_stmt|;
block|}
name|obc
operator|=
literal|0
expr_stmt|;
block|}
block|}
end_block

begin_macro
name|match
argument_list|(
argument|s
argument_list|)
end_macro

begin_decl_stmt
name|char
modifier|*
name|s
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|char
modifier|*
name|cs
decl_stmt|;
name|cs
operator|=
name|string
expr_stmt|;
while|while
condition|(
operator|*
name|cs
operator|++
operator|==
operator|*
name|s
condition|)
if|if
condition|(
operator|*
name|s
operator|++
operator|==
literal|'\0'
condition|)
goto|goto
name|true
goto|;
if|if
condition|(
operator|*
name|s
operator|!=
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|true
label|:
name|cs
operator|--
expr_stmt|;
name|string
operator|=
name|cs
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_block

begin_macro
name|number
argument_list|()
end_macro

begin_block
block|{
specifier|register
name|char
modifier|*
name|cs
decl_stmt|;
specifier|register
name|n
expr_stmt|;
name|cs
operator|=
name|string
expr_stmt|;
name|n
operator|=
literal|0
expr_stmt|;
while|while
condition|(
operator|*
name|cs
operator|>=
literal|'0'
operator|&&
operator|*
name|cs
operator|<=
literal|'9'
condition|)
name|n
operator|=
name|n
operator|*
literal|10
operator|+
operator|*
name|cs
operator|++
operator|-
literal|'0'
expr_stmt|;
for|for
control|(
init|;
condition|;
control|)
switch|switch
condition|(
operator|*
name|cs
operator|++
condition|)
block|{
case|case
literal|'k'
case|:
name|n
operator|=
operator|*
literal|1024
expr_stmt|;
continue|continue;
case|case
literal|'w'
case|:
name|n
operator|=
operator|*
literal|2
expr_stmt|;
continue|continue;
case|case
literal|'b'
case|:
name|n
operator|=
operator|*
literal|512
expr_stmt|;
continue|continue;
case|case
literal|'*'
case|:
case|case
literal|'x'
case|:
name|string
operator|=
name|cs
expr_stmt|;
name|n
operator|=
operator|*
name|number
argument_list|()
expr_stmt|;
case|case
literal|'\0'
case|:
return|return
operator|(
name|n
operator|)
return|;
block|}
name|printf
argument_list|(
literal|"not a number: %s\n"
argument_list|,
name|string
argument_list|)
expr_stmt|;
name|exit
argument_list|()
expr_stmt|;
block|}
end_block

begin_macro
name|cnull
argument_list|(
argument|cc
argument_list|)
end_macro

begin_block
block|{
specifier|register
name|c
expr_stmt|;
name|c
operator|=
name|cc
expr_stmt|;
if|if
condition|(
name|cflag
operator|&
name|UCASE
operator|&&
name|c
operator|>=
literal|'a'
operator|&&
name|c
operator|<=
literal|'z'
condition|)
name|c
operator|=
operator|+
literal|'A'
operator|-
literal|'a'
expr_stmt|;
if|if
condition|(
name|cflag
operator|&
name|LCASE
operator|&&
name|c
operator|>=
literal|'A'
operator|&&
name|c
operator|<=
literal|'Z'
condition|)
name|c
operator|=
operator|+
literal|'a'
operator|-
literal|'A'
expr_stmt|;
name|null
argument_list|(
name|c
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|null
argument_list|(
argument|c
argument_list|)
end_macro

begin_block
block|{
operator|*
name|op
operator|=
name|c
expr_stmt|;
name|op
operator|++
expr_stmt|;
if|if
condition|(
operator|++
name|obc
operator|>=
name|obs
condition|)
block|{
name|flsh
argument_list|()
expr_stmt|;
name|op
operator|=
name|obuf
expr_stmt|;
block|}
block|}
end_block

begin_macro
name|ascii
argument_list|(
argument|cc
argument_list|)
end_macro

begin_block
block|{
specifier|register
name|c
expr_stmt|;
name|c
operator|=
literal|0
expr_stmt|;
name|c
operator|=
operator||
name|etoa
index|[
name|cc
index|]
expr_stmt|;
if|if
condition|(
name|cbs
operator|==
literal|0
condition|)
block|{
name|cnull
argument_list|(
name|c
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|c
operator|==
literal|' '
condition|)
block|{
name|nspace
operator|++
expr_stmt|;
goto|goto
name|out
goto|;
block|}
while|while
condition|(
name|nspace
operator|>
literal|0
condition|)
block|{
name|null
argument_list|(
literal|' '
argument_list|)
expr_stmt|;
name|nspace
operator|--
expr_stmt|;
block|}
name|cnull
argument_list|(
name|c
argument_list|)
expr_stmt|;
name|out
label|:
if|if
condition|(
operator|++
name|cbc
operator|>=
name|cbs
condition|)
block|{
name|null
argument_list|(
literal|'\n'
argument_list|)
expr_stmt|;
name|cbc
operator|=
literal|0
expr_stmt|;
name|nspace
operator|=
literal|0
expr_stmt|;
block|}
block|}
end_block

begin_macro
name|ebcdic
argument_list|(
argument|cc
argument_list|)
end_macro

begin_block
block|{
specifier|register
name|c
expr_stmt|;
name|c
operator|=
name|cc
expr_stmt|;
if|if
condition|(
name|cflag
operator|&
name|UCASE
operator|&&
name|c
operator|>=
literal|'a'
operator|&&
name|c
operator|<=
literal|'z'
condition|)
name|c
operator|=
operator|+
literal|'A'
operator|-
literal|'a'
expr_stmt|;
if|if
condition|(
name|cflag
operator|&
name|LCASE
operator|&&
name|c
operator|>=
literal|'A'
operator|&&
name|c
operator|<=
literal|'Z'
condition|)
name|c
operator|=
operator|+
literal|'a'
operator|-
literal|'A'
expr_stmt|;
name|c
operator|=
name|atoe
index|[
name|c
index|]
operator|&
literal|0377
expr_stmt|;
if|if
condition|(
name|cbs
operator|==
literal|0
condition|)
block|{
name|null
argument_list|(
name|c
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|cc
operator|==
literal|'\n'
condition|)
block|{
while|while
condition|(
name|cbc
operator|<
name|cbs
condition|)
block|{
name|null
argument_list|(
name|atoe
index|[
literal|' '
index|]
argument_list|)
expr_stmt|;
name|cbc
operator|++
expr_stmt|;
block|}
name|cbc
operator|=
literal|0
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|cbc
operator|==
name|cbs
condition|)
name|ntrunc
operator|++
expr_stmt|;
name|cbc
operator|++
expr_stmt|;
if|if
condition|(
name|cbc
operator|<=
name|cbs
condition|)
name|null
argument_list|(
name|c
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|term
argument_list|()
end_macro

begin_block
block|{
name|stats
argument_list|()
expr_stmt|;
name|exit
argument_list|()
expr_stmt|;
block|}
end_block

begin_macro
name|stats
argument_list|()
end_macro

begin_block
block|{
name|printf
argument_list|(
literal|"%l+%l records in\n"
argument_list|,
name|nifr
argument_list|,
name|nipr
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"%l+%l records out\n"
argument_list|,
name|nofr
argument_list|,
name|nopr
argument_list|)
expr_stmt|;
if|if
condition|(
name|ntrunc
condition|)
name|printf
argument_list|(
literal|"%l truncated records\n"
argument_list|,
name|ntrunc
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|putchar
argument_list|(
argument|c
argument_list|)
end_macro

begin_block
block|{
name|write
argument_list|(
literal|2
argument_list|,
operator|&
name|c
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
end_block

end_unit

