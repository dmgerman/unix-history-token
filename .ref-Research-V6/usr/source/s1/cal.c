begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_decl_stmt
name|char
name|dayw
index|[]
block|{
literal|" S  M Tu  W Th  F  S"
block|}
end_decl_stmt

begin_empty_stmt
empty_stmt|;
end_empty_stmt

begin_decl_stmt
name|char
modifier|*
name|smon
index|[]
block|{
literal|"Jan"
operator|,
literal|"Feb"
operator|,
literal|"Mar"
operator|,
literal|"Apr"
operator|,
literal|"May"
operator|,
literal|"Jun"
operator|,
literal|"Jul"
operator|,
literal|"Aug"
operator|,
literal|"Sep"
operator|,
literal|"Oct"
operator|,
literal|"Nov"
operator|,
literal|"Dec"
operator|,
block|}
end_decl_stmt

begin_empty_stmt
empty_stmt|;
end_empty_stmt

begin_decl_stmt
name|char
name|string
index|[
literal|432
index|]
decl_stmt|;
end_decl_stmt

begin_function
name|main
parameter_list|(
name|argc
parameter_list|,
name|argv
parameter_list|)
name|char
modifier|*
name|argv
index|[]
decl_stmt|;
block|{
specifier|register
name|y
operator|,
name|i
operator|,
name|j
expr_stmt|;
name|int
name|m
decl_stmt|;
if|if
condition|(
name|argc
operator|<
literal|2
condition|)
block|{
name|printf
argument_list|(
literal|"usage: cal [month] year\n"
argument_list|)
expr_stmt|;
name|exit
argument_list|()
expr_stmt|;
block|}
if|if
condition|(
name|argc
operator|==
literal|2
condition|)
goto|goto
name|xlong
goto|;
comment|/*  *	print out just month  */
name|m
operator|=
name|number
argument_list|(
name|argv
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|m
operator|<
literal|1
operator|||
name|m
operator|>
literal|12
condition|)
goto|goto
name|badarg
goto|;
name|y
operator|=
name|number
argument_list|(
name|argv
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|y
operator|<
literal|1
operator|||
name|y
operator|>
literal|9999
condition|)
goto|goto
name|badarg
goto|;
name|printf
argument_list|(
literal|"      %s %l\n"
argument_list|,
name|smon
index|[
name|m
operator|-
literal|1
index|]
argument_list|,
name|y
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"%s\n"
argument_list|,
name|dayw
argument_list|)
expr_stmt|;
name|cal
argument_list|(
name|m
argument_list|,
name|y
argument_list|,
name|string
argument_list|,
literal|24
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|6
operator|*
literal|24
condition|;
name|i
operator|=
operator|+
literal|24
control|)
name|pstr
argument_list|(
name|string
operator|+
name|i
argument_list|,
literal|24
argument_list|)
expr_stmt|;
name|exit
argument_list|()
expr_stmt|;
comment|/*  *	print out complete year  */
name|xlong
label|:
name|y
operator|=
name|number
argument_list|(
name|argv
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|y
operator|<
literal|1
operator|||
name|y
operator|>
literal|9999
condition|)
goto|goto
name|badarg
goto|;
name|printf
argument_list|(
literal|"\n\n\n"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"				%l\n"
argument_list|,
name|y
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|12
condition|;
name|i
operator|=
operator|+
literal|3
control|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|6
operator|*
literal|72
condition|;
name|j
operator|++
control|)
name|string
index|[
name|j
index|]
operator|=
literal|'\0'
expr_stmt|;
name|printf
argument_list|(
literal|"	 %s"
argument_list|,
name|smon
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"			%s"
argument_list|,
name|smon
index|[
name|i
operator|+
literal|1
index|]
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"		       %s\n"
argument_list|,
name|smon
index|[
name|i
operator|+
literal|2
index|]
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"%s   %s   %s\n"
argument_list|,
name|dayw
argument_list|,
name|dayw
argument_list|,
name|dayw
argument_list|)
expr_stmt|;
name|cal
argument_list|(
name|i
operator|+
literal|1
argument_list|,
name|y
argument_list|,
name|string
argument_list|,
literal|72
argument_list|)
expr_stmt|;
name|cal
argument_list|(
name|i
operator|+
literal|2
argument_list|,
name|y
argument_list|,
name|string
operator|+
literal|23
argument_list|,
literal|72
argument_list|)
expr_stmt|;
name|cal
argument_list|(
name|i
operator|+
literal|3
argument_list|,
name|y
argument_list|,
name|string
operator|+
literal|46
argument_list|,
literal|72
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|6
operator|*
literal|72
condition|;
name|j
operator|=
operator|+
literal|72
control|)
name|pstr
argument_list|(
name|string
operator|+
name|j
argument_list|,
literal|72
argument_list|)
expr_stmt|;
block|}
name|printf
argument_list|(
literal|"\n\n\n"
argument_list|)
expr_stmt|;
name|exit
argument_list|()
expr_stmt|;
name|badarg
label|:
name|printf
argument_list|(
literal|"Bad argument\n"
argument_list|)
expr_stmt|;
block|}
end_function

begin_macro
name|number
argument_list|(
argument|str
argument_list|)
end_macro

begin_decl_stmt
name|char
modifier|*
name|str
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|n
operator|,
name|c
expr_stmt|;
specifier|register
name|char
modifier|*
name|s
decl_stmt|;
name|n
operator|=
literal|0
expr_stmt|;
name|s
operator|=
name|str
expr_stmt|;
while|while
condition|(
name|c
operator|=
operator|*
name|s
operator|++
condition|)
block|{
if|if
condition|(
name|c
operator|<
literal|'0'
operator|||
name|c
operator|>
literal|'9'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|n
operator|=
name|n
operator|*
literal|10
operator|+
name|c
operator|-
literal|'0'
expr_stmt|;
block|}
return|return
operator|(
name|n
operator|)
return|;
block|}
end_block

begin_macro
name|pstr
argument_list|(
argument|str
argument_list|,
argument|n
argument_list|)
end_macro

begin_decl_stmt
name|char
modifier|*
name|str
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|i
expr_stmt|;
specifier|register
name|char
modifier|*
name|s
decl_stmt|;
name|s
operator|=
name|str
expr_stmt|;
name|i
operator|=
name|n
expr_stmt|;
while|while
condition|(
name|i
operator|--
condition|)
if|if
condition|(
operator|*
name|s
operator|++
operator|==
literal|'\0'
condition|)
name|s
index|[
operator|-
literal|1
index|]
operator|=
literal|' '
expr_stmt|;
name|i
operator|=
name|n
operator|+
literal|1
expr_stmt|;
while|while
condition|(
name|i
operator|--
condition|)
if|if
condition|(
operator|*
operator|--
name|s
operator|!=
literal|' '
condition|)
break|break;
name|s
index|[
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
name|printf
argument_list|(
literal|"%s\n"
argument_list|,
name|str
argument_list|)
expr_stmt|;
block|}
end_block

begin_decl_stmt
name|char
name|mon
index|[]
block|{
literal|0
operator|,
literal|31
operator|,
literal|29
operator|,
literal|31
operator|,
literal|30
operator|,
literal|31
operator|,
literal|30
operator|,
literal|31
operator|,
literal|31
operator|,
literal|30
operator|,
literal|31
operator|,
literal|30
operator|,
literal|31
operator|,
block|}
end_decl_stmt

begin_empty_stmt
empty_stmt|;
end_empty_stmt

begin_macro
name|cal
argument_list|(
argument|m
argument_list|,
argument|y
argument_list|,
argument|p
argument_list|,
argument|w
argument_list|)
end_macro

begin_decl_stmt
name|char
modifier|*
name|p
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|d
operator|,
name|i
expr_stmt|;
specifier|register
name|char
modifier|*
name|s
decl_stmt|;
name|s
operator|=
name|p
expr_stmt|;
name|d
operator|=
name|jan1
argument_list|(
name|y
argument_list|)
expr_stmt|;
name|mon
index|[
literal|2
index|]
operator|=
literal|29
expr_stmt|;
name|mon
index|[
literal|9
index|]
operator|=
literal|30
expr_stmt|;
switch|switch
condition|(
operator|(
name|jan1
argument_list|(
name|y
operator|+
literal|1
argument_list|)
operator|+
literal|7
operator|-
name|d
operator|)
operator|%
literal|7
condition|)
block|{
comment|/* 	 *	non-leap year 	 */
case|case
literal|1
case|:
name|mon
index|[
literal|2
index|]
operator|=
literal|28
expr_stmt|;
break|break;
comment|/* 	 *	1752 	 */
default|default:
name|mon
index|[
literal|9
index|]
operator|=
literal|19
expr_stmt|;
break|break;
comment|/* 	 *	leap year 	 */
case|case
literal|2
case|:
empty_stmt|;
block|}
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<
name|m
condition|;
name|i
operator|++
control|)
name|d
operator|=
operator|+
name|mon
index|[
name|i
index|]
expr_stmt|;
name|d
operator|=
operator|%
literal|7
expr_stmt|;
name|s
operator|=
operator|+
literal|3
operator|*
name|d
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<=
name|mon
index|[
name|m
index|]
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|i
operator|==
literal|3
operator|&
name|mon
index|[
name|m
index|]
operator|==
literal|19
condition|)
block|{
name|i
operator|=
operator|+
literal|11
expr_stmt|;
name|mon
index|[
name|m
index|]
operator|=
operator|+
literal|11
expr_stmt|;
block|}
if|if
condition|(
name|i
operator|>
literal|9
condition|)
operator|*
name|s
operator|=
name|i
operator|/
literal|10
operator|+
literal|'0'
expr_stmt|;
name|s
operator|++
expr_stmt|;
operator|*
name|s
operator|++
operator|=
name|i
operator|%
literal|10
operator|+
literal|'0'
expr_stmt|;
name|s
operator|++
expr_stmt|;
if|if
condition|(
operator|++
name|d
operator|==
literal|7
condition|)
block|{
name|d
operator|=
literal|0
expr_stmt|;
name|s
operator|=
name|p
operator|+
name|w
expr_stmt|;
name|p
operator|=
name|s
expr_stmt|;
block|}
block|}
block|}
end_block

begin_comment
comment|/*  *	return day of the week  *	of jan 1 of given year  */
end_comment

begin_macro
name|jan1
argument_list|(
argument|yr
argument_list|)
end_macro

begin_block
block|{
specifier|register
name|y
operator|,
name|d
expr_stmt|;
comment|/*  *	normal gregorian calendar  *	one extra day per four years  */
name|y
operator|=
name|yr
expr_stmt|;
name|d
operator|=
literal|4
operator|+
name|y
operator|+
operator|(
name|y
operator|+
literal|3
operator|)
operator|/
literal|4
expr_stmt|;
comment|/*  *	julian calendar  *	regular gregorian  *	less three days per 400  */
if|if
condition|(
name|y
operator|>
literal|1800
condition|)
block|{
name|d
operator|=
operator|-
operator|(
name|y
operator|-
literal|1701
operator|)
operator|/
literal|100
expr_stmt|;
name|d
operator|=
operator|+
operator|(
name|y
operator|-
literal|1601
operator|)
operator|/
literal|400
expr_stmt|;
block|}
comment|/*  *	great calendar changeover instant  */
if|if
condition|(
name|y
operator|>
literal|1752
condition|)
name|d
operator|=
operator|+
literal|3
expr_stmt|;
return|return
operator|(
name|d
operator|%
literal|7
operator|)
return|;
block|}
end_block

end_unit

