begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * IDI,NTNU  *  * CDDL HEADER START  *  * The contents of this file are subject to the terms of the  * Common Development and Distribution License (the "License").  * You may not use this file except in compliance with the License.  *  * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE  * or http://opensource.org/licenses/CDDL-1.0.  * See the License for the specific language governing permissions  * and limitations under the License.  *  * When distributing Covered Code, include this CDDL HEADER in each  * file and include the License file at usr/src/OPENSOLARIS.LICENSE.  * If applicable, add the following below this CDDL HEADER, with the  * fields enclosed by brackets "[]" replaced with your own identifying  * information: Portions Copyright [yyyy] [name of copyright owner]  *  * CDDL HEADER END  *  * Copyright (C) 2009, 2010, Jorn Amundsen<jorn.amundsen@ntnu.no>  * Tweaked Edon-R implementation for SUPERCOP, based on NIST API.  *  * $Id: edonr.c 517 2013-02-17 20:34:39Z joern $  */
end_comment

begin_comment
comment|/*  * Portions copyright (c) 2013, Saso Kiselkov, All rights reserved  */
end_comment

begin_comment
comment|/* determine where we can get bcopy/bzero declarations */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|_KERNEL
end_ifdef

begin_include
include|#
directive|include
file|<sys/systm.h>
end_include

begin_else
else|#
directive|else
end_else

begin_include
include|#
directive|include
file|<strings.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<sys/edonr.h>
end_include

begin_include
include|#
directive|include
file|<sys/debug.h>
end_include

begin_comment
comment|/* big endian support, provides no-op's if run on little endian hosts */
end_comment

begin_include
include|#
directive|include
file|"edonr_byteorder.h"
end_include

begin_define
define|#
directive|define
name|hashState224
parameter_list|(
name|x
parameter_list|)
value|((x)->pipe->p256)
end_define

begin_define
define|#
directive|define
name|hashState256
parameter_list|(
name|x
parameter_list|)
value|((x)->pipe->p256)
end_define

begin_define
define|#
directive|define
name|hashState384
parameter_list|(
name|x
parameter_list|)
value|((x)->pipe->p512)
end_define

begin_define
define|#
directive|define
name|hashState512
parameter_list|(
name|x
parameter_list|)
value|((x)->pipe->p512)
end_define

begin_comment
comment|/* shift and rotate shortcuts */
end_comment

begin_define
define|#
directive|define
name|shl
parameter_list|(
name|x
parameter_list|,
name|n
parameter_list|)
value|((x)<< n)
end_define

begin_define
define|#
directive|define
name|shr
parameter_list|(
name|x
parameter_list|,
name|n
parameter_list|)
value|((x)>> n)
end_define

begin_define
define|#
directive|define
name|rotl32
parameter_list|(
name|x
parameter_list|,
name|n
parameter_list|)
value|(((x)<< (n)) | ((x)>> (32 - (n))))
end_define

begin_define
define|#
directive|define
name|rotr32
parameter_list|(
name|x
parameter_list|,
name|n
parameter_list|)
value|(((x)>> (n)) | ((x)<< (32 - (n))))
end_define

begin_define
define|#
directive|define
name|rotl64
parameter_list|(
name|x
parameter_list|,
name|n
parameter_list|)
value|(((x)<< (n)) | ((x)>> (64 - (n))))
end_define

begin_define
define|#
directive|define
name|rotr64
parameter_list|(
name|x
parameter_list|,
name|n
parameter_list|)
value|(((x)>> (n)) | ((x)<< (64 - (n))))
end_define

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|__C99_RESTRICT
argument_list|)
end_if

begin_define
define|#
directive|define
name|restrict
end_define

begin_comment
comment|/* restrict */
end_comment

begin_endif
endif|#
directive|endif
end_endif

begin_define
define|#
directive|define
name|EDONR_VALID_HASHBITLEN
parameter_list|(
name|x
parameter_list|)
define|\
value|((x) == 512 || (x) == 384 || (x) == 256 || (x) == 224)
end_define

begin_comment
comment|/* EdonR224 initial double chaining pipe */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|uint32_t
name|i224p2
index|[
literal|16
index|]
init|=
block|{
literal|0x00010203ul
block|,
literal|0x04050607ul
block|,
literal|0x08090a0bul
block|,
literal|0x0c0d0e0ful
block|,
literal|0x10111213ul
block|,
literal|0x14151617ul
block|,
literal|0x18191a1bul
block|,
literal|0x1c1d1e1ful
block|,
literal|0x20212223ul
block|,
literal|0x24252627ul
block|,
literal|0x28292a2bul
block|,
literal|0x2c2d2e2ful
block|,
literal|0x30313233ul
block|,
literal|0x34353637ul
block|,
literal|0x38393a3bul
block|,
literal|0x3c3d3e3ful
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* EdonR256 initial double chaining pipe */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|uint32_t
name|i256p2
index|[
literal|16
index|]
init|=
block|{
literal|0x40414243ul
block|,
literal|0x44454647ul
block|,
literal|0x48494a4bul
block|,
literal|0x4c4d4e4ful
block|,
literal|0x50515253ul
block|,
literal|0x54555657ul
block|,
literal|0x58595a5bul
block|,
literal|0x5c5d5e5ful
block|,
literal|0x60616263ul
block|,
literal|0x64656667ul
block|,
literal|0x68696a6bul
block|,
literal|0x6c6d6e6ful
block|,
literal|0x70717273ul
block|,
literal|0x74757677ul
block|,
literal|0x78797a7bul
block|,
literal|0x7c7d7e7ful
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* EdonR384 initial double chaining pipe */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|uint64_t
name|i384p2
index|[
literal|16
index|]
init|=
block|{
literal|0x0001020304050607ull
block|,
literal|0x08090a0b0c0d0e0full
block|,
literal|0x1011121314151617ull
block|,
literal|0x18191a1b1c1d1e1full
block|,
literal|0x2021222324252627ull
block|,
literal|0x28292a2b2c2d2e2full
block|,
literal|0x3031323334353637ull
block|,
literal|0x38393a3b3c3d3e3full
block|,
literal|0x4041424344454647ull
block|,
literal|0x48494a4b4c4d4e4full
block|,
literal|0x5051525354555657ull
block|,
literal|0x58595a5b5c5d5e5full
block|,
literal|0x6061626364656667ull
block|,
literal|0x68696a6b6c6d6e6full
block|,
literal|0x7071727374757677ull
block|,
literal|0x78797a7b7c7d7e7full
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* EdonR512 initial double chaining pipe */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|uint64_t
name|i512p2
index|[
literal|16
index|]
init|=
block|{
literal|0x8081828384858687ull
block|,
literal|0x88898a8b8c8d8e8full
block|,
literal|0x9091929394959697ull
block|,
literal|0x98999a9b9c9d9e9full
block|,
literal|0xa0a1a2a3a4a5a6a7ull
block|,
literal|0xa8a9aaabacadaeafull
block|,
literal|0xb0b1b2b3b4b5b6b7ull
block|,
literal|0xb8b9babbbcbdbebfull
block|,
literal|0xc0c1c2c3c4c5c6c7ull
block|,
literal|0xc8c9cacbcccdcecfull
block|,
literal|0xd0d1d2d3d4d5d6d7ull
block|,
literal|0xd8d9dadbdcdddedfull
block|,
literal|0xe0e1e2e3e4e5e6e7ull
block|,
literal|0xe8e9eaebecedeeefull
block|,
literal|0xf0f1f2f3f4f5f6f7ull
block|,
literal|0xf8f9fafbfcfdfeffull
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * First Latin Square  * 0   7   1   3   2   4   6   5  * 4   1   7   6   3   0   5   2  * 7   0   4   2   5   3   1   6  * 1   4   0   5   6   2   7   3  * 2   3   6   7   1   5   0   4  * 5   2   3   1   7   6   4   0  * 3   6   5   0   4   7   2   1  * 6   5   2   4   0   1   3   7  */
end_comment

begin_define
define|#
directive|define
name|LS1_256
parameter_list|(
name|c
parameter_list|,
name|x0
parameter_list|,
name|x1
parameter_list|,
name|x2
parameter_list|,
name|x3
parameter_list|,
name|x4
parameter_list|,
name|x5
parameter_list|,
name|x6
parameter_list|,
name|x7
parameter_list|)
define|\
value|{									\ 	uint32_t x04, x17, x23, x56, x07, x26;				\ 	x04 = x0+x4, x17 = x1+x7, x07 = x04+x17;			\ 	s0 = c + x07 + x2;						\ 	s1 = rotl32(x07 + x3, 4);					\ 	s2 = rotl32(x07 + x6, 8);					\ 	x23 = x2 + x3;							\ 	s5 = rotl32(x04 + x23 + x5, 22);				\ 	x56 = x5 + x6;							\ 	s6 = rotl32(x17 + x56 + x0, 24);				\ 	x26 = x23+x56;							\ 	s3 = rotl32(x26 + x7, 13);					\ 	s4 = rotl32(x26 + x1, 17);					\ 	s7 = rotl32(x26 + x4, 29);					\ }
end_define

begin_define
define|#
directive|define
name|LS1_512
parameter_list|(
name|c
parameter_list|,
name|x0
parameter_list|,
name|x1
parameter_list|,
name|x2
parameter_list|,
name|x3
parameter_list|,
name|x4
parameter_list|,
name|x5
parameter_list|,
name|x6
parameter_list|,
name|x7
parameter_list|)
define|\
value|{									\ 	uint64_t x04, x17, x23, x56, x07, x26;				\ 	x04 = x0+x4, x17 = x1+x7, x07 = x04+x17;			\ 	s0 = c + x07 + x2;						\ 	s1 = rotl64(x07 + x3, 5);					\ 	s2 = rotl64(x07 + x6, 15);					\ 	x23 = x2 + x3;							\ 	s5 = rotl64(x04 + x23 + x5, 40);				\ 	x56 = x5 + x6;							\ 	s6 = rotl64(x17 + x56 + x0, 50);				\ 	x26 = x23+x56;							\ 	s3 = rotl64(x26 + x7, 22);					\ 	s4 = rotl64(x26 + x1, 31);					\ 	s7 = rotl64(x26 + x4, 59);					\ }
end_define

begin_comment
comment|/*  * Second Orthogonal Latin Square  * 0   4   2   3   1   6   5   7  * 7   6   3   2   5   4   1   0  * 5   3   1   6   0   2   7   4  * 1   0   5   4   3   7   2   6  * 2   1   0   7   4   5   6   3  * 3   5   7   0   6   1   4   2  * 4   7   6   1   2   0   3   5  * 6   2   4   5   7   3   0   1  */
end_comment

begin_define
define|#
directive|define
name|LS2_256
parameter_list|(
name|c
parameter_list|,
name|y0
parameter_list|,
name|y1
parameter_list|,
name|y2
parameter_list|,
name|y3
parameter_list|,
name|y4
parameter_list|,
name|y5
parameter_list|,
name|y6
parameter_list|,
name|y7
parameter_list|)
define|\
value|{									\ 	uint32_t y01, y25, y34, y67, y04, y05, y27, y37;		\ 	y01 = y0+y1, y25 = y2+y5, y05 = y01+y25;			\ 	t0  = ~c + y05 + y7;						\ 	t2 = rotl32(y05 + y3, 9);					\ 	y34 = y3+y4, y04 = y01+y34;					\ 	t1 = rotl32(y04 + y6, 5);					\ 	t4 = rotl32(y04 + y5, 15);					\ 	y67 = y6+y7, y37 = y34+y67;					\ 	t3 = rotl32(y37 + y2, 11);					\ 	t7 = rotl32(y37 + y0, 27);					\ 	y27 = y25+y67;							\ 	t5 = rotl32(y27 + y4, 20);					\ 	t6 = rotl32(y27 + y1, 25);					\ }
end_define

begin_define
define|#
directive|define
name|LS2_512
parameter_list|(
name|c
parameter_list|,
name|y0
parameter_list|,
name|y1
parameter_list|,
name|y2
parameter_list|,
name|y3
parameter_list|,
name|y4
parameter_list|,
name|y5
parameter_list|,
name|y6
parameter_list|,
name|y7
parameter_list|)
define|\
value|{									\ 	uint64_t y01, y25, y34, y67, y04, y05, y27, y37;		\ 	y01 = y0+y1, y25 = y2+y5, y05 = y01+y25;			\ 	t0  = ~c + y05 + y7;						\ 	t2 = rotl64(y05 + y3, 19);					\ 	y34 = y3+y4, y04 = y01+y34;					\ 	t1 = rotl64(y04 + y6, 10);					\ 	t4 = rotl64(y04 + y5, 36);					\ 	y67 = y6+y7, y37 = y34+y67;					\ 	t3 = rotl64(y37 + y2, 29);					\ 	t7 = rotl64(y37 + y0, 55);					\ 	y27 = y25+y67;							\ 	t5 = rotl64(y27 + y4, 44);					\ 	t6 = rotl64(y27 + y1, 48);					\ }
end_define

begin_define
define|#
directive|define
name|quasi_exform256
parameter_list|(
name|r0
parameter_list|,
name|r1
parameter_list|,
name|r2
parameter_list|,
name|r3
parameter_list|,
name|r4
parameter_list|,
name|r5
parameter_list|,
name|r6
parameter_list|,
name|r7
parameter_list|)
define|\
value|{									\ 	uint32_t s04, s17, s23, s56, t01, t25, t34, t67;		\ 	s04 = s0 ^ s4, t01 = t0 ^ t1;					\ 	r0 = (s04 ^ s1) + (t01 ^ t5);					\ 	t67 = t6 ^ t7;							\ 	r1 = (s04 ^ s7) + (t2 ^ t67);					\ 	s23 = s2 ^ s3;							\ 	r7 = (s23 ^ s5) + (t4 ^ t67);					\ 	t34 = t3 ^ t4;							\ 	r3 = (s23 ^ s4) + (t0 ^ t34);					\ 	s56 = s5 ^ s6;							\ 	r5 = (s3 ^ s56) + (t34 ^ t6);					\ 	t25 = t2 ^ t5;							\ 	r6 = (s2 ^ s56) + (t25 ^ t7);					\ 	s17 = s1 ^ s7;							\ 	r4 = (s0 ^ s17) + (t1 ^ t25);					\ 	r2 = (s17 ^ s6) + (t01 ^ t3);					\ }
end_define

begin_define
define|#
directive|define
name|quasi_exform512
parameter_list|(
name|r0
parameter_list|,
name|r1
parameter_list|,
name|r2
parameter_list|,
name|r3
parameter_list|,
name|r4
parameter_list|,
name|r5
parameter_list|,
name|r6
parameter_list|,
name|r7
parameter_list|)
define|\
value|{									\ 	uint64_t s04, s17, s23, s56, t01, t25, t34, t67;		\ 	s04 = s0 ^ s4, t01 = t0 ^ t1;					\ 	r0 = (s04 ^ s1) + (t01 ^ t5);					\ 	t67 = t6 ^ t7;							\ 	r1 = (s04 ^ s7) + (t2 ^ t67);					\ 	s23 = s2 ^ s3;							\ 	r7 = (s23 ^ s5) + (t4 ^ t67);					\ 	t34 = t3 ^ t4;							\ 	r3 = (s23 ^ s4) + (t0 ^ t34);					\ 	s56 = s5 ^ s6;							\ 	r5 = (s3 ^ s56) + (t34 ^ t6);					\ 	t25 = t2 ^ t5;							\ 	r6 = (s2 ^ s56) + (t25 ^ t7);					\ 	s17 = s1 ^ s7;							\ 	r4 = (s0 ^ s17) + (t1 ^ t25);					\ 	r2 = (s17 ^ s6) + (t01 ^ t3);					\ }
end_define

begin_function
specifier|static
name|size_t
name|Q256
parameter_list|(
name|size_t
name|bitlen
parameter_list|,
specifier|const
name|uint32_t
modifier|*
name|data
parameter_list|,
name|uint32_t
modifier|*
specifier|restrict
name|p
parameter_list|)
block|{
name|size_t
name|bl
decl_stmt|;
for|for
control|(
name|bl
operator|=
name|bitlen
init|;
name|bl
operator|>=
name|EdonR256_BLOCK_BITSIZE
condition|;
name|bl
operator|-=
name|EdonR256_BLOCK_BITSIZE
operator|,
name|data
operator|+=
literal|16
control|)
block|{
name|uint32_t
name|s0
decl_stmt|,
name|s1
decl_stmt|,
name|s2
decl_stmt|,
name|s3
decl_stmt|,
name|s4
decl_stmt|,
name|s5
decl_stmt|,
name|s6
decl_stmt|,
name|s7
decl_stmt|,
name|t0
decl_stmt|,
name|t1
decl_stmt|,
name|t2
decl_stmt|,
name|t3
decl_stmt|,
name|t4
decl_stmt|,
name|t5
decl_stmt|,
name|t6
decl_stmt|,
name|t7
decl_stmt|;
name|uint32_t
name|p0
decl_stmt|,
name|p1
decl_stmt|,
name|p2
decl_stmt|,
name|p3
decl_stmt|,
name|p4
decl_stmt|,
name|p5
decl_stmt|,
name|p6
decl_stmt|,
name|p7
decl_stmt|,
name|q0
decl_stmt|,
name|q1
decl_stmt|,
name|q2
decl_stmt|,
name|q3
decl_stmt|,
name|q4
decl_stmt|,
name|q5
decl_stmt|,
name|q6
decl_stmt|,
name|q7
decl_stmt|;
specifier|const
name|uint32_t
name|defix
init|=
literal|0xaaaaaaaa
decl_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MACHINE_IS_BIG_ENDIAN
argument_list|)
name|uint32_t
name|swp0
decl_stmt|,
name|swp1
decl_stmt|,
name|swp2
decl_stmt|,
name|swp3
decl_stmt|,
name|swp4
decl_stmt|,
name|swp5
decl_stmt|,
name|swp6
decl_stmt|,
name|swp7
decl_stmt|,
name|swp8
decl_stmt|,
name|swp9
decl_stmt|,
name|swp10
decl_stmt|,
name|swp11
decl_stmt|,
name|swp12
decl_stmt|,
name|swp13
decl_stmt|,
name|swp14
decl_stmt|,
name|swp15
decl_stmt|;
define|#
directive|define
name|d
parameter_list|(
name|j
parameter_list|)
value|swp ## j
define|#
directive|define
name|s32
parameter_list|(
name|j
parameter_list|)
value|ld_swap32((uint32_t *)data + j, swp ## j)
else|#
directive|else
define|#
directive|define
name|d
parameter_list|(
name|j
parameter_list|)
value|data[j]
endif|#
directive|endif
comment|/* First row of quasigroup e-transformations */
if|#
directive|if
name|defined
argument_list|(
name|MACHINE_IS_BIG_ENDIAN
argument_list|)
name|s32
argument_list|(
literal|8
argument_list|)
expr_stmt|;
name|s32
argument_list|(
literal|9
argument_list|)
expr_stmt|;
name|s32
argument_list|(
literal|10
argument_list|)
expr_stmt|;
name|s32
argument_list|(
literal|11
argument_list|)
expr_stmt|;
name|s32
argument_list|(
literal|12
argument_list|)
expr_stmt|;
name|s32
argument_list|(
literal|13
argument_list|)
expr_stmt|;
name|s32
argument_list|(
literal|14
argument_list|)
expr_stmt|;
name|s32
argument_list|(
literal|15
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|LS1_256
argument_list|(
name|defix
argument_list|,
name|d
argument_list|(
literal|15
argument_list|)
argument_list|,
name|d
argument_list|(
literal|14
argument_list|)
argument_list|,
name|d
argument_list|(
literal|13
argument_list|)
argument_list|,
name|d
argument_list|(
literal|12
argument_list|)
argument_list|,
name|d
argument_list|(
literal|11
argument_list|)
argument_list|,
name|d
argument_list|(
literal|10
argument_list|)
argument_list|,
name|d
argument_list|(
literal|9
argument_list|)
argument_list|,
name|d
argument_list|(
literal|8
argument_list|)
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MACHINE_IS_BIG_ENDIAN
argument_list|)
name|s32
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|s32
argument_list|(
literal|1
argument_list|)
expr_stmt|;
name|s32
argument_list|(
literal|2
argument_list|)
expr_stmt|;
name|s32
argument_list|(
literal|3
argument_list|)
expr_stmt|;
name|s32
argument_list|(
literal|4
argument_list|)
expr_stmt|;
name|s32
argument_list|(
literal|5
argument_list|)
expr_stmt|;
name|s32
argument_list|(
literal|6
argument_list|)
expr_stmt|;
name|s32
argument_list|(
literal|7
argument_list|)
expr_stmt|;
undef|#
directive|undef
name|s32
endif|#
directive|endif
name|LS2_256
argument_list|(
name|defix
argument_list|,
name|d
argument_list|(
literal|0
argument_list|)
argument_list|,
name|d
argument_list|(
literal|1
argument_list|)
argument_list|,
name|d
argument_list|(
literal|2
argument_list|)
argument_list|,
name|d
argument_list|(
literal|3
argument_list|)
argument_list|,
name|d
argument_list|(
literal|4
argument_list|)
argument_list|,
name|d
argument_list|(
literal|5
argument_list|)
argument_list|,
name|d
argument_list|(
literal|6
argument_list|)
argument_list|,
name|d
argument_list|(
literal|7
argument_list|)
argument_list|)
expr_stmt|;
name|quasi_exform256
argument_list|(
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|LS1_256
argument_list|(
name|defix
argument_list|,
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|LS2_256
argument_list|(
name|defix
argument_list|,
name|d
argument_list|(
literal|8
argument_list|)
argument_list|,
name|d
argument_list|(
literal|9
argument_list|)
argument_list|,
name|d
argument_list|(
literal|10
argument_list|)
argument_list|,
name|d
argument_list|(
literal|11
argument_list|)
argument_list|,
name|d
argument_list|(
literal|12
argument_list|)
argument_list|,
name|d
argument_list|(
literal|13
argument_list|)
argument_list|,
name|d
argument_list|(
literal|14
argument_list|)
argument_list|,
name|d
argument_list|(
literal|15
argument_list|)
argument_list|)
expr_stmt|;
name|quasi_exform256
argument_list|(
name|q0
argument_list|,
name|q1
argument_list|,
name|q2
argument_list|,
name|q3
argument_list|,
name|q4
argument_list|,
name|q5
argument_list|,
name|q6
argument_list|,
name|q7
argument_list|)
expr_stmt|;
comment|/* Second row of quasigroup e-transformations */
name|LS1_256
argument_list|(
name|defix
argument_list|,
name|p
index|[
literal|8
index|]
argument_list|,
name|p
index|[
literal|9
index|]
argument_list|,
name|p
index|[
literal|10
index|]
argument_list|,
name|p
index|[
literal|11
index|]
argument_list|,
name|p
index|[
literal|12
index|]
argument_list|,
name|p
index|[
literal|13
index|]
argument_list|,
name|p
index|[
literal|14
index|]
argument_list|,
name|p
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|LS2_256
argument_list|(
name|defix
argument_list|,
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|quasi_exform256
argument_list|(
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|LS1_256
argument_list|(
name|defix
argument_list|,
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|LS2_256
argument_list|(
name|defix
argument_list|,
name|q0
argument_list|,
name|q1
argument_list|,
name|q2
argument_list|,
name|q3
argument_list|,
name|q4
argument_list|,
name|q5
argument_list|,
name|q6
argument_list|,
name|q7
argument_list|)
expr_stmt|;
name|quasi_exform256
argument_list|(
name|q0
argument_list|,
name|q1
argument_list|,
name|q2
argument_list|,
name|q3
argument_list|,
name|q4
argument_list|,
name|q5
argument_list|,
name|q6
argument_list|,
name|q7
argument_list|)
expr_stmt|;
comment|/* Third row of quasigroup e-transformations */
name|LS1_256
argument_list|(
name|defix
argument_list|,
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|LS2_256
argument_list|(
name|defix
argument_list|,
name|p
index|[
literal|0
index|]
argument_list|,
name|p
index|[
literal|1
index|]
argument_list|,
name|p
index|[
literal|2
index|]
argument_list|,
name|p
index|[
literal|3
index|]
argument_list|,
name|p
index|[
literal|4
index|]
argument_list|,
name|p
index|[
literal|5
index|]
argument_list|,
name|p
index|[
literal|6
index|]
argument_list|,
name|p
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|quasi_exform256
argument_list|(
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|LS1_256
argument_list|(
name|defix
argument_list|,
name|q0
argument_list|,
name|q1
argument_list|,
name|q2
argument_list|,
name|q3
argument_list|,
name|q4
argument_list|,
name|q5
argument_list|,
name|q6
argument_list|,
name|q7
argument_list|)
expr_stmt|;
name|LS2_256
argument_list|(
name|defix
argument_list|,
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|quasi_exform256
argument_list|(
name|q0
argument_list|,
name|q1
argument_list|,
name|q2
argument_list|,
name|q3
argument_list|,
name|q4
argument_list|,
name|q5
argument_list|,
name|q6
argument_list|,
name|q7
argument_list|)
expr_stmt|;
comment|/* Fourth row of quasigroup e-transformations */
name|LS1_256
argument_list|(
name|defix
argument_list|,
name|d
argument_list|(
literal|7
argument_list|)
argument_list|,
name|d
argument_list|(
literal|6
argument_list|)
argument_list|,
name|d
argument_list|(
literal|5
argument_list|)
argument_list|,
name|d
argument_list|(
literal|4
argument_list|)
argument_list|,
name|d
argument_list|(
literal|3
argument_list|)
argument_list|,
name|d
argument_list|(
literal|2
argument_list|)
argument_list|,
name|d
argument_list|(
literal|1
argument_list|)
argument_list|,
name|d
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|LS2_256
argument_list|(
name|defix
argument_list|,
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|quasi_exform256
argument_list|(
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|LS1_256
argument_list|(
name|defix
argument_list|,
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|LS2_256
argument_list|(
name|defix
argument_list|,
name|q0
argument_list|,
name|q1
argument_list|,
name|q2
argument_list|,
name|q3
argument_list|,
name|q4
argument_list|,
name|q5
argument_list|,
name|q6
argument_list|,
name|q7
argument_list|)
expr_stmt|;
name|quasi_exform256
argument_list|(
name|q0
argument_list|,
name|q1
argument_list|,
name|q2
argument_list|,
name|q3
argument_list|,
name|q4
argument_list|,
name|q5
argument_list|,
name|q6
argument_list|,
name|q7
argument_list|)
expr_stmt|;
comment|/* Edon-R tweak on the original SHA-3 Edon-R submission. */
name|p
index|[
literal|0
index|]
operator|^=
name|d
argument_list|(
literal|8
argument_list|)
operator|^
name|p0
expr_stmt|;
name|p
index|[
literal|1
index|]
operator|^=
name|d
argument_list|(
literal|9
argument_list|)
operator|^
name|p1
expr_stmt|;
name|p
index|[
literal|2
index|]
operator|^=
name|d
argument_list|(
literal|10
argument_list|)
operator|^
name|p2
expr_stmt|;
name|p
index|[
literal|3
index|]
operator|^=
name|d
argument_list|(
literal|11
argument_list|)
operator|^
name|p3
expr_stmt|;
name|p
index|[
literal|4
index|]
operator|^=
name|d
argument_list|(
literal|12
argument_list|)
operator|^
name|p4
expr_stmt|;
name|p
index|[
literal|5
index|]
operator|^=
name|d
argument_list|(
literal|13
argument_list|)
operator|^
name|p5
expr_stmt|;
name|p
index|[
literal|6
index|]
operator|^=
name|d
argument_list|(
literal|14
argument_list|)
operator|^
name|p6
expr_stmt|;
name|p
index|[
literal|7
index|]
operator|^=
name|d
argument_list|(
literal|15
argument_list|)
operator|^
name|p7
expr_stmt|;
name|p
index|[
literal|8
index|]
operator|^=
name|d
argument_list|(
literal|0
argument_list|)
operator|^
name|q0
expr_stmt|;
name|p
index|[
literal|9
index|]
operator|^=
name|d
argument_list|(
literal|1
argument_list|)
operator|^
name|q1
expr_stmt|;
name|p
index|[
literal|10
index|]
operator|^=
name|d
argument_list|(
literal|2
argument_list|)
operator|^
name|q2
expr_stmt|;
name|p
index|[
literal|11
index|]
operator|^=
name|d
argument_list|(
literal|3
argument_list|)
operator|^
name|q3
expr_stmt|;
name|p
index|[
literal|12
index|]
operator|^=
name|d
argument_list|(
literal|4
argument_list|)
operator|^
name|q4
expr_stmt|;
name|p
index|[
literal|13
index|]
operator|^=
name|d
argument_list|(
literal|5
argument_list|)
operator|^
name|q5
expr_stmt|;
name|p
index|[
literal|14
index|]
operator|^=
name|d
argument_list|(
literal|6
argument_list|)
operator|^
name|q6
expr_stmt|;
name|p
index|[
literal|15
index|]
operator|^=
name|d
argument_list|(
literal|7
argument_list|)
operator|^
name|q7
expr_stmt|;
block|}
undef|#
directive|undef
name|d
return|return
operator|(
name|bitlen
operator|-
name|bl
operator|)
return|;
block|}
end_function

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__IBMC__
argument_list|)
operator|&&
name|defined
argument_list|(
name|_AIX
argument_list|)
operator|&&
name|defined
argument_list|(
name|__64BIT__
argument_list|)
end_if

begin_function
specifier|static
specifier|inline
name|size_t
else|#
directive|else
specifier|static
name|size_t
endif|#
directive|endif
name|Q512
parameter_list|(
name|size_t
name|bitlen
parameter_list|,
specifier|const
name|uint64_t
modifier|*
name|data
parameter_list|,
name|uint64_t
modifier|*
specifier|restrict
name|p
parameter_list|)
block|{
name|size_t
name|bl
decl_stmt|;
for|for
control|(
name|bl
operator|=
name|bitlen
init|;
name|bl
operator|>=
name|EdonR512_BLOCK_BITSIZE
condition|;
name|bl
operator|-=
name|EdonR512_BLOCK_BITSIZE
operator|,
name|data
operator|+=
literal|16
control|)
block|{
name|uint64_t
name|s0
decl_stmt|,
name|s1
decl_stmt|,
name|s2
decl_stmt|,
name|s3
decl_stmt|,
name|s4
decl_stmt|,
name|s5
decl_stmt|,
name|s6
decl_stmt|,
name|s7
decl_stmt|,
name|t0
decl_stmt|,
name|t1
decl_stmt|,
name|t2
decl_stmt|,
name|t3
decl_stmt|,
name|t4
decl_stmt|,
name|t5
decl_stmt|,
name|t6
decl_stmt|,
name|t7
decl_stmt|;
name|uint64_t
name|p0
decl_stmt|,
name|p1
decl_stmt|,
name|p2
decl_stmt|,
name|p3
decl_stmt|,
name|p4
decl_stmt|,
name|p5
decl_stmt|,
name|p6
decl_stmt|,
name|p7
decl_stmt|,
name|q0
decl_stmt|,
name|q1
decl_stmt|,
name|q2
decl_stmt|,
name|q3
decl_stmt|,
name|q4
decl_stmt|,
name|q5
decl_stmt|,
name|q6
decl_stmt|,
name|q7
decl_stmt|;
specifier|const
name|uint64_t
name|defix
init|=
literal|0xaaaaaaaaaaaaaaaaull
decl_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MACHINE_IS_BIG_ENDIAN
argument_list|)
name|uint64_t
name|swp0
decl_stmt|,
name|swp1
decl_stmt|,
name|swp2
decl_stmt|,
name|swp3
decl_stmt|,
name|swp4
decl_stmt|,
name|swp5
decl_stmt|,
name|swp6
decl_stmt|,
name|swp7
decl_stmt|,
name|swp8
decl_stmt|,
name|swp9
decl_stmt|,
name|swp10
decl_stmt|,
name|swp11
decl_stmt|,
name|swp12
decl_stmt|,
name|swp13
decl_stmt|,
name|swp14
decl_stmt|,
name|swp15
decl_stmt|;
define|#
directive|define
name|d
parameter_list|(
name|j
parameter_list|)
value|swp##j
define|#
directive|define
name|s64
parameter_list|(
name|j
parameter_list|)
value|ld_swap64((uint64_t *)data+j, swp##j)
else|#
directive|else
define|#
directive|define
name|d
parameter_list|(
name|j
parameter_list|)
value|data[j]
endif|#
directive|endif
comment|/* First row of quasigroup e-transformations */
if|#
directive|if
name|defined
argument_list|(
name|MACHINE_IS_BIG_ENDIAN
argument_list|)
name|s64
argument_list|(
literal|8
argument_list|)
expr_stmt|;
name|s64
argument_list|(
literal|9
argument_list|)
expr_stmt|;
name|s64
argument_list|(
literal|10
argument_list|)
expr_stmt|;
name|s64
argument_list|(
literal|11
argument_list|)
expr_stmt|;
name|s64
argument_list|(
literal|12
argument_list|)
expr_stmt|;
name|s64
argument_list|(
literal|13
argument_list|)
expr_stmt|;
name|s64
argument_list|(
literal|14
argument_list|)
expr_stmt|;
name|s64
argument_list|(
literal|15
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|LS1_512
argument_list|(
name|defix
argument_list|,
name|d
argument_list|(
literal|15
argument_list|)
argument_list|,
name|d
argument_list|(
literal|14
argument_list|)
argument_list|,
name|d
argument_list|(
literal|13
argument_list|)
argument_list|,
name|d
argument_list|(
literal|12
argument_list|)
argument_list|,
name|d
argument_list|(
literal|11
argument_list|)
argument_list|,
name|d
argument_list|(
literal|10
argument_list|)
argument_list|,
name|d
argument_list|(
literal|9
argument_list|)
argument_list|,
name|d
argument_list|(
literal|8
argument_list|)
argument_list|)
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MACHINE_IS_BIG_ENDIAN
argument_list|)
name|s64
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|s64
argument_list|(
literal|1
argument_list|)
expr_stmt|;
name|s64
argument_list|(
literal|2
argument_list|)
expr_stmt|;
name|s64
argument_list|(
literal|3
argument_list|)
expr_stmt|;
name|s64
argument_list|(
literal|4
argument_list|)
expr_stmt|;
name|s64
argument_list|(
literal|5
argument_list|)
expr_stmt|;
name|s64
argument_list|(
literal|6
argument_list|)
expr_stmt|;
name|s64
argument_list|(
literal|7
argument_list|)
expr_stmt|;
undef|#
directive|undef
name|s64
endif|#
directive|endif
name|LS2_512
argument_list|(
name|defix
argument_list|,
name|d
argument_list|(
literal|0
argument_list|)
argument_list|,
name|d
argument_list|(
literal|1
argument_list|)
argument_list|,
name|d
argument_list|(
literal|2
argument_list|)
argument_list|,
name|d
argument_list|(
literal|3
argument_list|)
argument_list|,
name|d
argument_list|(
literal|4
argument_list|)
argument_list|,
name|d
argument_list|(
literal|5
argument_list|)
argument_list|,
name|d
argument_list|(
literal|6
argument_list|)
argument_list|,
name|d
argument_list|(
literal|7
argument_list|)
argument_list|)
expr_stmt|;
name|quasi_exform512
argument_list|(
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|LS1_512
argument_list|(
name|defix
argument_list|,
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|LS2_512
argument_list|(
name|defix
argument_list|,
name|d
argument_list|(
literal|8
argument_list|)
argument_list|,
name|d
argument_list|(
literal|9
argument_list|)
argument_list|,
name|d
argument_list|(
literal|10
argument_list|)
argument_list|,
name|d
argument_list|(
literal|11
argument_list|)
argument_list|,
name|d
argument_list|(
literal|12
argument_list|)
argument_list|,
name|d
argument_list|(
literal|13
argument_list|)
argument_list|,
name|d
argument_list|(
literal|14
argument_list|)
argument_list|,
name|d
argument_list|(
literal|15
argument_list|)
argument_list|)
expr_stmt|;
name|quasi_exform512
argument_list|(
name|q0
argument_list|,
name|q1
argument_list|,
name|q2
argument_list|,
name|q3
argument_list|,
name|q4
argument_list|,
name|q5
argument_list|,
name|q6
argument_list|,
name|q7
argument_list|)
expr_stmt|;
comment|/* Second row of quasigroup e-transformations */
name|LS1_512
argument_list|(
name|defix
argument_list|,
name|p
index|[
literal|8
index|]
argument_list|,
name|p
index|[
literal|9
index|]
argument_list|,
name|p
index|[
literal|10
index|]
argument_list|,
name|p
index|[
literal|11
index|]
argument_list|,
name|p
index|[
literal|12
index|]
argument_list|,
name|p
index|[
literal|13
index|]
argument_list|,
name|p
index|[
literal|14
index|]
argument_list|,
name|p
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|LS2_512
argument_list|(
name|defix
argument_list|,
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|quasi_exform512
argument_list|(
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|LS1_512
argument_list|(
name|defix
argument_list|,
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|LS2_512
argument_list|(
name|defix
argument_list|,
name|q0
argument_list|,
name|q1
argument_list|,
name|q2
argument_list|,
name|q3
argument_list|,
name|q4
argument_list|,
name|q5
argument_list|,
name|q6
argument_list|,
name|q7
argument_list|)
expr_stmt|;
name|quasi_exform512
argument_list|(
name|q0
argument_list|,
name|q1
argument_list|,
name|q2
argument_list|,
name|q3
argument_list|,
name|q4
argument_list|,
name|q5
argument_list|,
name|q6
argument_list|,
name|q7
argument_list|)
expr_stmt|;
comment|/* Third row of quasigroup e-transformations */
name|LS1_512
argument_list|(
name|defix
argument_list|,
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|LS2_512
argument_list|(
name|defix
argument_list|,
name|p
index|[
literal|0
index|]
argument_list|,
name|p
index|[
literal|1
index|]
argument_list|,
name|p
index|[
literal|2
index|]
argument_list|,
name|p
index|[
literal|3
index|]
argument_list|,
name|p
index|[
literal|4
index|]
argument_list|,
name|p
index|[
literal|5
index|]
argument_list|,
name|p
index|[
literal|6
index|]
argument_list|,
name|p
index|[
literal|7
index|]
argument_list|)
expr_stmt|;
name|quasi_exform512
argument_list|(
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|LS1_512
argument_list|(
name|defix
argument_list|,
name|q0
argument_list|,
name|q1
argument_list|,
name|q2
argument_list|,
name|q3
argument_list|,
name|q4
argument_list|,
name|q5
argument_list|,
name|q6
argument_list|,
name|q7
argument_list|)
expr_stmt|;
name|LS2_512
argument_list|(
name|defix
argument_list|,
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|quasi_exform512
argument_list|(
name|q0
argument_list|,
name|q1
argument_list|,
name|q2
argument_list|,
name|q3
argument_list|,
name|q4
argument_list|,
name|q5
argument_list|,
name|q6
argument_list|,
name|q7
argument_list|)
expr_stmt|;
comment|/* Fourth row of quasigroup e-transformations */
name|LS1_512
argument_list|(
name|defix
argument_list|,
name|d
argument_list|(
literal|7
argument_list|)
argument_list|,
name|d
argument_list|(
literal|6
argument_list|)
argument_list|,
name|d
argument_list|(
literal|5
argument_list|)
argument_list|,
name|d
argument_list|(
literal|4
argument_list|)
argument_list|,
name|d
argument_list|(
literal|3
argument_list|)
argument_list|,
name|d
argument_list|(
literal|2
argument_list|)
argument_list|,
name|d
argument_list|(
literal|1
argument_list|)
argument_list|,
name|d
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|LS2_512
argument_list|(
name|defix
argument_list|,
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|quasi_exform512
argument_list|(
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|LS1_512
argument_list|(
name|defix
argument_list|,
name|p0
argument_list|,
name|p1
argument_list|,
name|p2
argument_list|,
name|p3
argument_list|,
name|p4
argument_list|,
name|p5
argument_list|,
name|p6
argument_list|,
name|p7
argument_list|)
expr_stmt|;
name|LS2_512
argument_list|(
name|defix
argument_list|,
name|q0
argument_list|,
name|q1
argument_list|,
name|q2
argument_list|,
name|q3
argument_list|,
name|q4
argument_list|,
name|q5
argument_list|,
name|q6
argument_list|,
name|q7
argument_list|)
expr_stmt|;
name|quasi_exform512
argument_list|(
name|q0
argument_list|,
name|q1
argument_list|,
name|q2
argument_list|,
name|q3
argument_list|,
name|q4
argument_list|,
name|q5
argument_list|,
name|q6
argument_list|,
name|q7
argument_list|)
expr_stmt|;
comment|/* Edon-R tweak on the original SHA-3 Edon-R submission. */
name|p
index|[
literal|0
index|]
operator|^=
name|d
argument_list|(
literal|8
argument_list|)
operator|^
name|p0
expr_stmt|;
name|p
index|[
literal|1
index|]
operator|^=
name|d
argument_list|(
literal|9
argument_list|)
operator|^
name|p1
expr_stmt|;
name|p
index|[
literal|2
index|]
operator|^=
name|d
argument_list|(
literal|10
argument_list|)
operator|^
name|p2
expr_stmt|;
name|p
index|[
literal|3
index|]
operator|^=
name|d
argument_list|(
literal|11
argument_list|)
operator|^
name|p3
expr_stmt|;
name|p
index|[
literal|4
index|]
operator|^=
name|d
argument_list|(
literal|12
argument_list|)
operator|^
name|p4
expr_stmt|;
name|p
index|[
literal|5
index|]
operator|^=
name|d
argument_list|(
literal|13
argument_list|)
operator|^
name|p5
expr_stmt|;
name|p
index|[
literal|6
index|]
operator|^=
name|d
argument_list|(
literal|14
argument_list|)
operator|^
name|p6
expr_stmt|;
name|p
index|[
literal|7
index|]
operator|^=
name|d
argument_list|(
literal|15
argument_list|)
operator|^
name|p7
expr_stmt|;
name|p
index|[
literal|8
index|]
operator|^=
name|d
argument_list|(
literal|0
argument_list|)
operator|^
name|q0
expr_stmt|;
name|p
index|[
literal|9
index|]
operator|^=
name|d
argument_list|(
literal|1
argument_list|)
operator|^
name|q1
expr_stmt|;
name|p
index|[
literal|10
index|]
operator|^=
name|d
argument_list|(
literal|2
argument_list|)
operator|^
name|q2
expr_stmt|;
name|p
index|[
literal|11
index|]
operator|^=
name|d
argument_list|(
literal|3
argument_list|)
operator|^
name|q3
expr_stmt|;
name|p
index|[
literal|12
index|]
operator|^=
name|d
argument_list|(
literal|4
argument_list|)
operator|^
name|q4
expr_stmt|;
name|p
index|[
literal|13
index|]
operator|^=
name|d
argument_list|(
literal|5
argument_list|)
operator|^
name|q5
expr_stmt|;
name|p
index|[
literal|14
index|]
operator|^=
name|d
argument_list|(
literal|6
argument_list|)
operator|^
name|q6
expr_stmt|;
name|p
index|[
literal|15
index|]
operator|^=
name|d
argument_list|(
literal|7
argument_list|)
operator|^
name|q7
expr_stmt|;
block|}
undef|#
directive|undef
name|d
return|return
operator|(
name|bitlen
operator|-
name|bl
operator|)
return|;
block|}
end_function

begin_function
name|void
name|EdonRInit
parameter_list|(
name|EdonRState
modifier|*
name|state
parameter_list|,
name|size_t
name|hashbitlen
parameter_list|)
block|{
name|ASSERT
argument_list|(
name|EDONR_VALID_HASHBITLEN
argument_list|(
name|hashbitlen
argument_list|)
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|hashbitlen
condition|)
block|{
case|case
literal|224
case|:
name|state
operator|->
name|hashbitlen
operator|=
literal|224
expr_stmt|;
name|state
operator|->
name|bits_processed
operator|=
literal|0
expr_stmt|;
name|state
operator|->
name|unprocessed_bits
operator|=
literal|0
expr_stmt|;
name|bcopy
argument_list|(
name|i224p2
argument_list|,
name|hashState224
argument_list|(
name|state
argument_list|)
operator|->
name|DoublePipe
argument_list|,
literal|16
operator|*
sizeof|sizeof
argument_list|(
name|uint32_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|256
case|:
name|state
operator|->
name|hashbitlen
operator|=
literal|256
expr_stmt|;
name|state
operator|->
name|bits_processed
operator|=
literal|0
expr_stmt|;
name|state
operator|->
name|unprocessed_bits
operator|=
literal|0
expr_stmt|;
name|bcopy
argument_list|(
name|i256p2
argument_list|,
name|hashState256
argument_list|(
name|state
argument_list|)
operator|->
name|DoublePipe
argument_list|,
literal|16
operator|*
sizeof|sizeof
argument_list|(
name|uint32_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|384
case|:
name|state
operator|->
name|hashbitlen
operator|=
literal|384
expr_stmt|;
name|state
operator|->
name|bits_processed
operator|=
literal|0
expr_stmt|;
name|state
operator|->
name|unprocessed_bits
operator|=
literal|0
expr_stmt|;
name|bcopy
argument_list|(
name|i384p2
argument_list|,
name|hashState384
argument_list|(
name|state
argument_list|)
operator|->
name|DoublePipe
argument_list|,
literal|16
operator|*
sizeof|sizeof
argument_list|(
name|uint64_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|512
case|:
name|state
operator|->
name|hashbitlen
operator|=
literal|512
expr_stmt|;
name|state
operator|->
name|bits_processed
operator|=
literal|0
expr_stmt|;
name|state
operator|->
name|unprocessed_bits
operator|=
literal|0
expr_stmt|;
name|bcopy
argument_list|(
name|i512p2
argument_list|,
name|hashState224
argument_list|(
name|state
argument_list|)
operator|->
name|DoublePipe
argument_list|,
literal|16
operator|*
sizeof|sizeof
argument_list|(
name|uint64_t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
end_function

begin_function
name|void
name|EdonRUpdate
parameter_list|(
name|EdonRState
modifier|*
name|state
parameter_list|,
specifier|const
name|uint8_t
modifier|*
name|data
parameter_list|,
name|size_t
name|databitlen
parameter_list|)
block|{
name|uint32_t
modifier|*
name|data32
decl_stmt|;
name|uint64_t
modifier|*
name|data64
decl_stmt|;
name|size_t
name|bits_processed
decl_stmt|;
name|ASSERT
argument_list|(
name|EDONR_VALID_HASHBITLEN
argument_list|(
name|state
operator|->
name|hashbitlen
argument_list|)
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|state
operator|->
name|hashbitlen
condition|)
block|{
case|case
literal|224
case|:
case|case
literal|256
case|:
if|if
condition|(
name|state
operator|->
name|unprocessed_bits
operator|>
literal|0
condition|)
block|{
comment|/* LastBytes = databitlen / 8 */
name|int
name|LastBytes
init|=
operator|(
name|int
operator|)
name|databitlen
operator|>>
literal|3
decl_stmt|;
name|ASSERT
argument_list|(
name|state
operator|->
name|unprocessed_bits
operator|+
name|databitlen
operator|<=
name|EdonR256_BLOCK_SIZE
operator|*
literal|8
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
name|data
argument_list|,
name|hashState256
argument_list|(
name|state
argument_list|)
operator|->
name|LastPart
operator|+
operator|(
name|state
operator|->
name|unprocessed_bits
operator|>>
literal|3
operator|)
argument_list|,
name|LastBytes
argument_list|)
expr_stmt|;
name|state
operator|->
name|unprocessed_bits
operator|+=
operator|(
name|int
operator|)
name|databitlen
expr_stmt|;
name|databitlen
operator|=
name|state
operator|->
name|unprocessed_bits
expr_stmt|;
comment|/* LINTED E_BAD_PTR_CAST_ALIGN */
name|data32
operator|=
operator|(
name|uint32_t
operator|*
operator|)
name|hashState256
argument_list|(
name|state
argument_list|)
operator|->
name|LastPart
expr_stmt|;
block|}
else|else
comment|/* LINTED E_BAD_PTR_CAST_ALIGN */
name|data32
operator|=
operator|(
name|uint32_t
operator|*
operator|)
name|data
expr_stmt|;
name|bits_processed
operator|=
name|Q256
argument_list|(
name|databitlen
argument_list|,
name|data32
argument_list|,
name|hashState256
argument_list|(
name|state
argument_list|)
operator|->
name|DoublePipe
argument_list|)
expr_stmt|;
name|state
operator|->
name|bits_processed
operator|+=
name|bits_processed
expr_stmt|;
name|databitlen
operator|-=
name|bits_processed
expr_stmt|;
name|state
operator|->
name|unprocessed_bits
operator|=
operator|(
name|int
operator|)
name|databitlen
expr_stmt|;
if|if
condition|(
name|databitlen
operator|>
literal|0
condition|)
block|{
comment|/* LastBytes = Ceil(databitlen / 8) */
name|int
name|LastBytes
init|=
operator|(
operator|(
operator|~
operator|(
operator|(
operator|(
operator|-
operator|(
name|int
operator|)
name|databitlen
operator|)
operator|>>
literal|3
operator|)
operator|&
literal|0x01ff
operator|)
operator|)
operator|+
literal|1
operator|)
operator|&
literal|0x01ff
decl_stmt|;
name|data32
operator|+=
name|bits_processed
operator|>>
literal|5
expr_stmt|;
comment|/* byte size update */
name|bcopy
argument_list|(
name|data32
argument_list|,
name|hashState256
argument_list|(
name|state
argument_list|)
operator|->
name|LastPart
argument_list|,
name|LastBytes
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
literal|384
case|:
case|case
literal|512
case|:
if|if
condition|(
name|state
operator|->
name|unprocessed_bits
operator|>
literal|0
condition|)
block|{
comment|/* LastBytes = databitlen / 8 */
name|int
name|LastBytes
init|=
operator|(
name|int
operator|)
name|databitlen
operator|>>
literal|3
decl_stmt|;
name|ASSERT
argument_list|(
name|state
operator|->
name|unprocessed_bits
operator|+
name|databitlen
operator|<=
name|EdonR512_BLOCK_SIZE
operator|*
literal|8
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
name|data
argument_list|,
name|hashState512
argument_list|(
name|state
argument_list|)
operator|->
name|LastPart
operator|+
operator|(
name|state
operator|->
name|unprocessed_bits
operator|>>
literal|3
operator|)
argument_list|,
name|LastBytes
argument_list|)
expr_stmt|;
name|state
operator|->
name|unprocessed_bits
operator|+=
operator|(
name|int
operator|)
name|databitlen
expr_stmt|;
name|databitlen
operator|=
name|state
operator|->
name|unprocessed_bits
expr_stmt|;
comment|/* LINTED E_BAD_PTR_CAST_ALIGN */
name|data64
operator|=
operator|(
name|uint64_t
operator|*
operator|)
name|hashState512
argument_list|(
name|state
argument_list|)
operator|->
name|LastPart
expr_stmt|;
block|}
else|else
comment|/* LINTED E_BAD_PTR_CAST_ALIGN */
name|data64
operator|=
operator|(
name|uint64_t
operator|*
operator|)
name|data
expr_stmt|;
name|bits_processed
operator|=
name|Q512
argument_list|(
name|databitlen
argument_list|,
name|data64
argument_list|,
name|hashState512
argument_list|(
name|state
argument_list|)
operator|->
name|DoublePipe
argument_list|)
expr_stmt|;
name|state
operator|->
name|bits_processed
operator|+=
name|bits_processed
expr_stmt|;
name|databitlen
operator|-=
name|bits_processed
expr_stmt|;
name|state
operator|->
name|unprocessed_bits
operator|=
operator|(
name|int
operator|)
name|databitlen
expr_stmt|;
if|if
condition|(
name|databitlen
operator|>
literal|0
condition|)
block|{
comment|/* LastBytes = Ceil(databitlen / 8) */
name|int
name|LastBytes
init|=
operator|(
operator|(
operator|~
operator|(
operator|(
operator|(
operator|-
operator|(
name|int
operator|)
name|databitlen
operator|)
operator|>>
literal|3
operator|)
operator|&
literal|0x03ff
operator|)
operator|)
operator|+
literal|1
operator|)
operator|&
literal|0x03ff
decl_stmt|;
name|data64
operator|+=
name|bits_processed
operator|>>
literal|6
expr_stmt|;
comment|/* byte size update */
name|bcopy
argument_list|(
name|data64
argument_list|,
name|hashState512
argument_list|(
name|state
argument_list|)
operator|->
name|LastPart
argument_list|,
name|LastBytes
argument_list|)
expr_stmt|;
block|}
break|break;
block|}
block|}
end_function

begin_function
name|void
name|EdonRFinal
parameter_list|(
name|EdonRState
modifier|*
name|state
parameter_list|,
name|uint8_t
modifier|*
name|hashval
parameter_list|)
block|{
name|uint32_t
modifier|*
name|data32
decl_stmt|;
name|uint64_t
modifier|*
name|data64
decl_stmt|,
name|num_bits
decl_stmt|;
name|size_t
name|databitlen
decl_stmt|;
name|int
name|LastByte
decl_stmt|,
name|PadOnePosition
decl_stmt|;
name|num_bits
operator|=
name|state
operator|->
name|bits_processed
operator|+
name|state
operator|->
name|unprocessed_bits
expr_stmt|;
name|ASSERT
argument_list|(
name|EDONR_VALID_HASHBITLEN
argument_list|(
name|state
operator|->
name|hashbitlen
argument_list|)
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|state
operator|->
name|hashbitlen
condition|)
block|{
case|case
literal|224
case|:
case|case
literal|256
case|:
name|LastByte
operator|=
operator|(
name|int
operator|)
name|state
operator|->
name|unprocessed_bits
operator|>>
literal|3
expr_stmt|;
name|PadOnePosition
operator|=
literal|7
operator|-
operator|(
name|state
operator|->
name|unprocessed_bits
operator|&
literal|0x07
operator|)
expr_stmt|;
name|hashState256
argument_list|(
name|state
argument_list|)
operator|->
name|LastPart
index|[
name|LastByte
index|]
operator|=
operator|(
name|hashState256
argument_list|(
name|state
argument_list|)
operator|->
name|LastPart
index|[
name|LastByte
index|]
operator|&
operator|(
literal|0xff
operator|<<
operator|(
name|PadOnePosition
operator|+
literal|1
operator|)
operator|)
operator|)
operator|^
operator|(
literal|0x01
operator|<<
name|PadOnePosition
operator|)
expr_stmt|;
comment|/* LINTED E_BAD_PTR_CAST_ALIGN */
name|data64
operator|=
operator|(
name|uint64_t
operator|*
operator|)
name|hashState256
argument_list|(
name|state
argument_list|)
operator|->
name|LastPart
expr_stmt|;
if|if
condition|(
name|state
operator|->
name|unprocessed_bits
operator|<
literal|448
condition|)
block|{
operator|(
name|void
operator|)
name|memset
argument_list|(
operator|(
name|hashState256
argument_list|(
name|state
argument_list|)
operator|->
name|LastPart
operator|)
operator|+
name|LastByte
operator|+
literal|1
argument_list|,
literal|0x00
argument_list|,
name|EdonR256_BLOCK_SIZE
operator|-
name|LastByte
operator|-
literal|9
argument_list|)
expr_stmt|;
name|databitlen
operator|=
name|EdonR256_BLOCK_SIZE
operator|*
literal|8
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MACHINE_IS_BIG_ENDIAN
argument_list|)
name|st_swap64
argument_list|(
name|num_bits
argument_list|,
name|data64
operator|+
literal|7
argument_list|)
expr_stmt|;
else|#
directive|else
name|data64
index|[
literal|7
index|]
operator|=
name|num_bits
expr_stmt|;
endif|#
directive|endif
block|}
else|else
block|{
operator|(
name|void
operator|)
name|memset
argument_list|(
operator|(
name|hashState256
argument_list|(
name|state
argument_list|)
operator|->
name|LastPart
operator|)
operator|+
name|LastByte
operator|+
literal|1
argument_list|,
literal|0x00
argument_list|,
name|EdonR256_BLOCK_SIZE
operator|*
literal|2
operator|-
name|LastByte
operator|-
literal|9
argument_list|)
expr_stmt|;
name|databitlen
operator|=
name|EdonR256_BLOCK_SIZE
operator|*
literal|16
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MACHINE_IS_BIG_ENDIAN
argument_list|)
name|st_swap64
argument_list|(
name|num_bits
argument_list|,
name|data64
operator|+
literal|15
argument_list|)
expr_stmt|;
else|#
directive|else
name|data64
index|[
literal|15
index|]
operator|=
name|num_bits
expr_stmt|;
endif|#
directive|endif
block|}
comment|/* LINTED E_BAD_PTR_CAST_ALIGN */
name|data32
operator|=
operator|(
name|uint32_t
operator|*
operator|)
name|hashState256
argument_list|(
name|state
argument_list|)
operator|->
name|LastPart
expr_stmt|;
name|state
operator|->
name|bits_processed
operator|+=
name|Q256
argument_list|(
name|databitlen
argument_list|,
name|data32
argument_list|,
name|hashState256
argument_list|(
name|state
argument_list|)
operator|->
name|DoublePipe
argument_list|)
expr_stmt|;
break|break;
case|case
literal|384
case|:
case|case
literal|512
case|:
name|LastByte
operator|=
operator|(
name|int
operator|)
name|state
operator|->
name|unprocessed_bits
operator|>>
literal|3
expr_stmt|;
name|PadOnePosition
operator|=
literal|7
operator|-
operator|(
name|state
operator|->
name|unprocessed_bits
operator|&
literal|0x07
operator|)
expr_stmt|;
name|hashState512
argument_list|(
name|state
argument_list|)
operator|->
name|LastPart
index|[
name|LastByte
index|]
operator|=
operator|(
name|hashState512
argument_list|(
name|state
argument_list|)
operator|->
name|LastPart
index|[
name|LastByte
index|]
operator|&
operator|(
literal|0xff
operator|<<
operator|(
name|PadOnePosition
operator|+
literal|1
operator|)
operator|)
operator|)
operator|^
operator|(
literal|0x01
operator|<<
name|PadOnePosition
operator|)
expr_stmt|;
comment|/* LINTED E_BAD_PTR_CAST_ALIGN */
name|data64
operator|=
operator|(
name|uint64_t
operator|*
operator|)
name|hashState512
argument_list|(
name|state
argument_list|)
operator|->
name|LastPart
expr_stmt|;
if|if
condition|(
name|state
operator|->
name|unprocessed_bits
operator|<
literal|960
condition|)
block|{
operator|(
name|void
operator|)
name|memset
argument_list|(
operator|(
name|hashState512
argument_list|(
name|state
argument_list|)
operator|->
name|LastPart
operator|)
operator|+
name|LastByte
operator|+
literal|1
argument_list|,
literal|0x00
argument_list|,
name|EdonR512_BLOCK_SIZE
operator|-
name|LastByte
operator|-
literal|9
argument_list|)
expr_stmt|;
name|databitlen
operator|=
name|EdonR512_BLOCK_SIZE
operator|*
literal|8
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MACHINE_IS_BIG_ENDIAN
argument_list|)
name|st_swap64
argument_list|(
name|num_bits
argument_list|,
name|data64
operator|+
literal|15
argument_list|)
expr_stmt|;
else|#
directive|else
name|data64
index|[
literal|15
index|]
operator|=
name|num_bits
expr_stmt|;
endif|#
directive|endif
block|}
else|else
block|{
operator|(
name|void
operator|)
name|memset
argument_list|(
operator|(
name|hashState512
argument_list|(
name|state
argument_list|)
operator|->
name|LastPart
operator|)
operator|+
name|LastByte
operator|+
literal|1
argument_list|,
literal|0x00
argument_list|,
name|EdonR512_BLOCK_SIZE
operator|*
literal|2
operator|-
name|LastByte
operator|-
literal|9
argument_list|)
expr_stmt|;
name|databitlen
operator|=
name|EdonR512_BLOCK_SIZE
operator|*
literal|16
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|MACHINE_IS_BIG_ENDIAN
argument_list|)
name|st_swap64
argument_list|(
name|num_bits
argument_list|,
name|data64
operator|+
literal|31
argument_list|)
expr_stmt|;
else|#
directive|else
name|data64
index|[
literal|31
index|]
operator|=
name|num_bits
expr_stmt|;
endif|#
directive|endif
block|}
name|state
operator|->
name|bits_processed
operator|+=
name|Q512
argument_list|(
name|databitlen
argument_list|,
name|data64
argument_list|,
name|hashState512
argument_list|(
name|state
argument_list|)
operator|->
name|DoublePipe
argument_list|)
expr_stmt|;
break|break;
block|}
switch|switch
condition|(
name|state
operator|->
name|hashbitlen
condition|)
block|{
case|case
literal|224
case|:
block|{
if|#
directive|if
name|defined
argument_list|(
name|MACHINE_IS_BIG_ENDIAN
argument_list|)
name|uint32_t
modifier|*
name|d32
init|=
operator|(
name|uint32_t
operator|*
operator|)
name|hashval
decl_stmt|;
name|uint32_t
modifier|*
name|s32
init|=
name|hashState224
argument_list|(
name|state
argument_list|)
operator|->
name|DoublePipe
operator|+
literal|9
decl_stmt|;
name|int
name|j
decl_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|EdonR224_DIGEST_SIZE
operator|>>
literal|2
condition|;
name|j
operator|++
control|)
name|st_swap32
argument_list|(
name|s32
index|[
name|j
index|]
argument_list|,
name|d32
operator|+
name|j
argument_list|)
expr_stmt|;
else|#
directive|else
name|bcopy
argument_list|(
name|hashState256
argument_list|(
name|state
argument_list|)
operator|->
name|DoublePipe
operator|+
literal|9
argument_list|,
name|hashval
argument_list|,
name|EdonR224_DIGEST_SIZE
argument_list|)
expr_stmt|;
endif|#
directive|endif
break|break;
block|}
case|case
literal|256
case|:
block|{
if|#
directive|if
name|defined
argument_list|(
name|MACHINE_IS_BIG_ENDIAN
argument_list|)
name|uint32_t
modifier|*
name|d32
init|=
operator|(
name|uint32_t
operator|*
operator|)
name|hashval
decl_stmt|;
name|uint32_t
modifier|*
name|s32
init|=
name|hashState224
argument_list|(
name|state
argument_list|)
operator|->
name|DoublePipe
operator|+
literal|8
decl_stmt|;
name|int
name|j
decl_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|EdonR256_DIGEST_SIZE
operator|>>
literal|2
condition|;
name|j
operator|++
control|)
name|st_swap32
argument_list|(
name|s32
index|[
name|j
index|]
argument_list|,
name|d32
operator|+
name|j
argument_list|)
expr_stmt|;
else|#
directive|else
name|bcopy
argument_list|(
name|hashState256
argument_list|(
name|state
argument_list|)
operator|->
name|DoublePipe
operator|+
literal|8
argument_list|,
name|hashval
argument_list|,
name|EdonR256_DIGEST_SIZE
argument_list|)
expr_stmt|;
endif|#
directive|endif
break|break;
block|}
case|case
literal|384
case|:
block|{
if|#
directive|if
name|defined
argument_list|(
name|MACHINE_IS_BIG_ENDIAN
argument_list|)
name|uint64_t
modifier|*
name|d64
init|=
operator|(
name|uint64_t
operator|*
operator|)
name|hashval
decl_stmt|;
name|uint64_t
modifier|*
name|s64
init|=
name|hashState384
argument_list|(
name|state
argument_list|)
operator|->
name|DoublePipe
operator|+
literal|10
decl_stmt|;
name|int
name|j
decl_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|EdonR384_DIGEST_SIZE
operator|>>
literal|3
condition|;
name|j
operator|++
control|)
name|st_swap64
argument_list|(
name|s64
index|[
name|j
index|]
argument_list|,
name|d64
operator|+
name|j
argument_list|)
expr_stmt|;
else|#
directive|else
name|bcopy
argument_list|(
name|hashState384
argument_list|(
name|state
argument_list|)
operator|->
name|DoublePipe
operator|+
literal|10
argument_list|,
name|hashval
argument_list|,
name|EdonR384_DIGEST_SIZE
argument_list|)
expr_stmt|;
endif|#
directive|endif
break|break;
block|}
case|case
literal|512
case|:
block|{
if|#
directive|if
name|defined
argument_list|(
name|MACHINE_IS_BIG_ENDIAN
argument_list|)
name|uint64_t
modifier|*
name|d64
init|=
operator|(
name|uint64_t
operator|*
operator|)
name|hashval
decl_stmt|;
name|uint64_t
modifier|*
name|s64
init|=
name|hashState512
argument_list|(
name|state
argument_list|)
operator|->
name|DoublePipe
operator|+
literal|8
decl_stmt|;
name|int
name|j
decl_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|EdonR512_DIGEST_SIZE
operator|>>
literal|3
condition|;
name|j
operator|++
control|)
name|st_swap64
argument_list|(
name|s64
index|[
name|j
index|]
argument_list|,
name|d64
operator|+
name|j
argument_list|)
expr_stmt|;
else|#
directive|else
name|bcopy
argument_list|(
name|hashState512
argument_list|(
name|state
argument_list|)
operator|->
name|DoublePipe
operator|+
literal|8
argument_list|,
name|hashval
argument_list|,
name|EdonR512_DIGEST_SIZE
argument_list|)
expr_stmt|;
endif|#
directive|endif
break|break;
block|}
block|}
block|}
end_function

begin_function
name|void
name|EdonRHash
parameter_list|(
name|size_t
name|hashbitlen
parameter_list|,
specifier|const
name|uint8_t
modifier|*
name|data
parameter_list|,
name|size_t
name|databitlen
parameter_list|,
name|uint8_t
modifier|*
name|hashval
parameter_list|)
block|{
name|EdonRState
name|state
decl_stmt|;
name|EdonRInit
argument_list|(
operator|&
name|state
argument_list|,
name|hashbitlen
argument_list|)
expr_stmt|;
name|EdonRUpdate
argument_list|(
operator|&
name|state
argument_list|,
name|data
argument_list|,
name|databitlen
argument_list|)
expr_stmt|;
name|EdonRFinal
argument_list|(
operator|&
name|state
argument_list|,
name|hashval
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

