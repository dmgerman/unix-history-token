begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/******************************************************************************  *  * Module Name: dmtbdump - Dump ACPI data tables that contain no AML code  *  *****************************************************************************/
end_comment

begin_comment
comment|/*  * Copyright (C) 2000 - 2011, Intel Corp.  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions, and the following disclaimer,  *    without modification.  * 2. Redistributions in binary form must reproduce at minimum a disclaimer  *    substantially similar to the "NO WARRANTY" disclaimer below  *    ("Disclaimer") and any redistribution must be conditioned upon  *    including a substantially similar Disclaimer requirement for further  *    binary redistribution.  * 3. Neither the names of the above-listed copyright holders nor the names  *    of any contributors may be used to endorse or promote products derived  *    from this software without specific prior written permission.  *  * Alternatively, this software may be distributed under the terms of the  * GNU General Public License ("GPL") version 2 as published by the Free  * Software Foundation.  *  * NO WARRANTY  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS  * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT  * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR  * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT  * HOLDERS OR CONTRIBUTORS BE LIABLE FOR SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING  * IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE  * POSSIBILITY OF SUCH DAMAGES.  */
end_comment

begin_include
include|#
directive|include
file|"acpi.h"
end_include

begin_include
include|#
directive|include
file|"accommon.h"
end_include

begin_include
include|#
directive|include
file|"acdisasm.h"
end_include

begin_include
include|#
directive|include
file|"actables.h"
end_include

begin_comment
comment|/* This module used for application-level code only */
end_comment

begin_define
define|#
directive|define
name|_COMPONENT
value|ACPI_CA_DISASSEMBLER
end_define

begin_macro
name|ACPI_MODULE_NAME
argument_list|(
literal|"dmtbdump"
argument_list|)
end_macro

begin_function_decl
specifier|static
name|void
name|AcpiDmValidateFadtLength
parameter_list|(
name|UINT32
name|Revision
parameter_list|,
name|UINT32
name|Length
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpRsdp  *  * PARAMETERS:  Table               - A RSDP  *  * RETURN:      Length of the table (there is not always a length field,  *              use revision or length if available (ACPI 2.0+))  *  * DESCRIPTION: Format the contents of a RSDP  *  ******************************************************************************/
end_comment

begin_function
name|UINT32
name|AcpiDmDumpRsdp
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|ACPI_TABLE_RSDP
modifier|*
name|Rsdp
init|=
name|ACPI_CAST_PTR
argument_list|(
name|ACPI_TABLE_RSDP
argument_list|,
name|Table
argument_list|)
decl_stmt|;
name|UINT32
name|Length
init|=
sizeof|sizeof
argument_list|(
name|ACPI_RSDP_COMMON
argument_list|)
decl_stmt|;
name|UINT8
name|Checksum
decl_stmt|;
comment|/* Dump the common ACPI 1.0 portion */
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoRsdp1
argument_list|)
expr_stmt|;
comment|/* Validate the first checksum */
name|Checksum
operator|=
name|AcpiDmGenerateChecksum
argument_list|(
name|Rsdp
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_RSDP_COMMON
argument_list|)
argument_list|,
name|Rsdp
operator|->
name|Checksum
argument_list|)
expr_stmt|;
if|if
condition|(
name|Checksum
operator|!=
name|Rsdp
operator|->
name|Checksum
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"/* Incorrect Checksum above, should be 0x%2.2X */\n"
argument_list|,
name|Checksum
argument_list|)
expr_stmt|;
block|}
comment|/* The RSDP for ACPI 2.0+ contains more data and has a Length field */
if|if
condition|(
name|Rsdp
operator|->
name|Revision
operator|>
literal|0
condition|)
block|{
name|Length
operator|=
name|Rsdp
operator|->
name|Length
expr_stmt|;
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoRsdp2
argument_list|)
expr_stmt|;
comment|/* Validate the extended checksum over entire RSDP */
name|Checksum
operator|=
name|AcpiDmGenerateChecksum
argument_list|(
name|Rsdp
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_RSDP
argument_list|)
argument_list|,
name|Rsdp
operator|->
name|ExtendedChecksum
argument_list|)
expr_stmt|;
if|if
condition|(
name|Checksum
operator|!=
name|Rsdp
operator|->
name|ExtendedChecksum
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"/* Incorrect Extended Checksum above, should be 0x%2.2X */\n"
argument_list|,
name|Checksum
argument_list|)
expr_stmt|;
block|}
block|}
return|return
operator|(
name|Length
operator|)
return|;
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpRsdt  *  * PARAMETERS:  Table               - A RSDT  *  * RETURN:      None  *  * DESCRIPTION: Format the contents of a RSDT  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmDumpRsdt
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|UINT32
modifier|*
name|Array
decl_stmt|;
name|UINT32
name|Entries
decl_stmt|;
name|UINT32
name|Offset
decl_stmt|;
name|UINT32
name|i
decl_stmt|;
comment|/* Point to start of table pointer array */
name|Array
operator|=
name|ACPI_CAST_PTR
argument_list|(
name|ACPI_TABLE_RSDT
argument_list|,
name|Table
argument_list|)
operator|->
name|TableOffsetEntry
expr_stmt|;
name|Offset
operator|=
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_HEADER
argument_list|)
expr_stmt|;
comment|/* RSDT uses 32-bit pointers */
name|Entries
operator|=
operator|(
name|Table
operator|->
name|Length
operator|-
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_HEADER
argument_list|)
operator|)
operator|/
sizeof|sizeof
argument_list|(
name|UINT32
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|Entries
condition|;
name|i
operator|++
control|)
block|{
name|AcpiDmLineHeader2
argument_list|(
name|Offset
argument_list|,
sizeof|sizeof
argument_list|(
name|UINT32
argument_list|)
argument_list|,
literal|"ACPI Table Address"
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|AcpiOsPrintf
argument_list|(
literal|"%8.8X\n"
argument_list|,
name|Array
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|Offset
operator|+=
sizeof|sizeof
argument_list|(
name|UINT32
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpXsdt  *  * PARAMETERS:  Table               - A XSDT  *  * RETURN:      None  *  * DESCRIPTION: Format the contents of a XSDT  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmDumpXsdt
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|UINT64
modifier|*
name|Array
decl_stmt|;
name|UINT32
name|Entries
decl_stmt|;
name|UINT32
name|Offset
decl_stmt|;
name|UINT32
name|i
decl_stmt|;
comment|/* Point to start of table pointer array */
name|Array
operator|=
name|ACPI_CAST_PTR
argument_list|(
name|ACPI_TABLE_XSDT
argument_list|,
name|Table
argument_list|)
operator|->
name|TableOffsetEntry
expr_stmt|;
name|Offset
operator|=
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_HEADER
argument_list|)
expr_stmt|;
comment|/* XSDT uses 64-bit pointers */
name|Entries
operator|=
operator|(
name|Table
operator|->
name|Length
operator|-
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_HEADER
argument_list|)
operator|)
operator|/
sizeof|sizeof
argument_list|(
name|UINT64
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|Entries
condition|;
name|i
operator|++
control|)
block|{
name|AcpiDmLineHeader2
argument_list|(
name|Offset
argument_list|,
sizeof|sizeof
argument_list|(
name|UINT64
argument_list|)
argument_list|,
literal|"ACPI Table Address"
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|AcpiOsPrintf
argument_list|(
literal|"%8.8X%8.8X\n"
argument_list|,
name|ACPI_FORMAT_UINT64
argument_list|(
name|Array
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|Offset
operator|+=
sizeof|sizeof
argument_list|(
name|UINT64
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpFadt  *  * PARAMETERS:  Table               - A FADT  *  * RETURN:      None  *  * DESCRIPTION: Format the contents of a FADT  *  * NOTE:        We cannot depend on the FADT version to indicate the actual  *              contents of the FADT because of BIOS bugs. The table length  *              is the only reliable indicator.  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmDumpFadt
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
comment|/* Always dump the minimum FADT revision 1 fields (ACPI 1.0) */
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoFadt1
argument_list|)
expr_stmt|;
comment|/* Check for FADT revision 2 fields (ACPI 1.0B MS extensions) */
if|if
condition|(
operator|(
name|Table
operator|->
name|Length
operator|>
name|ACPI_FADT_V1_SIZE
operator|)
operator|&&
operator|(
name|Table
operator|->
name|Length
operator|<=
name|ACPI_FADT_V2_SIZE
operator|)
condition|)
block|{
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoFadt2
argument_list|)
expr_stmt|;
block|}
comment|/* Check for FADT revision 3 fields and up (ACPI 2.0+ extended data) */
elseif|else
if|if
condition|(
name|Table
operator|->
name|Length
operator|>
name|ACPI_FADT_V2_SIZE
condition|)
block|{
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoFadt3
argument_list|)
expr_stmt|;
block|}
comment|/* Validate various fields in the FADT, including length */
name|AcpiTbCreateLocalFadt
argument_list|(
name|Table
argument_list|,
name|Table
operator|->
name|Length
argument_list|)
expr_stmt|;
comment|/* Validate FADT length against the revision */
name|AcpiDmValidateFadtLength
argument_list|(
name|Table
operator|->
name|Revision
argument_list|,
name|Table
operator|->
name|Length
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmValidateFadtLength  *  * PARAMETERS:  Revision            - FADT revision (Header->Revision)  *              Length              - FADT length (Header->Length  *  * RETURN:      None  *  * DESCRIPTION: Check the FADT revision against the expected table length for  *              that revision. Issue a warning if the length is not what was  *              expected. This seems to be such a common BIOS bug that the  *              FADT revision has been rendered virtually meaningless.  *  ******************************************************************************/
end_comment

begin_function
specifier|static
name|void
name|AcpiDmValidateFadtLength
parameter_list|(
name|UINT32
name|Revision
parameter_list|,
name|UINT32
name|Length
parameter_list|)
block|{
name|UINT32
name|ExpectedLength
decl_stmt|;
switch|switch
condition|(
name|Revision
condition|)
block|{
case|case
literal|0
case|:
name|AcpiOsPrintf
argument_list|(
literal|"// ACPI Warning: Invalid FADT revision: 0\n"
argument_list|)
expr_stmt|;
return|return;
case|case
literal|1
case|:
name|ExpectedLength
operator|=
name|ACPI_FADT_V1_SIZE
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|ExpectedLength
operator|=
name|ACPI_FADT_V2_SIZE
expr_stmt|;
break|break;
case|case
literal|3
case|:
case|case
literal|4
case|:
name|ExpectedLength
operator|=
name|ACPI_FADT_V3_SIZE
expr_stmt|;
break|break;
default|default:
return|return;
block|}
if|if
condition|(
name|Length
operator|==
name|ExpectedLength
condition|)
block|{
return|return;
block|}
name|AcpiOsPrintf
argument_list|(
literal|"\n// ACPI Warning: FADT revision %X does not match length: found %X expected %X\n"
argument_list|,
name|Revision
argument_list|,
name|Length
argument_list|,
name|ExpectedLength
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpAsf  *  * PARAMETERS:  Table               - A ASF table  *  * RETURN:      None  *  * DESCRIPTION: Format the contents of a ASF table  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmDumpAsf
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|ACPI_STATUS
name|Status
decl_stmt|;
name|UINT32
name|Offset
init|=
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_HEADER
argument_list|)
decl_stmt|;
name|ACPI_ASF_INFO
modifier|*
name|SubTable
decl_stmt|;
name|ACPI_DMTABLE_INFO
modifier|*
name|InfoTable
decl_stmt|;
name|ACPI_DMTABLE_INFO
modifier|*
name|DataInfoTable
init|=
name|NULL
decl_stmt|;
name|UINT8
modifier|*
name|DataTable
init|=
name|NULL
decl_stmt|;
name|UINT32
name|DataCount
init|=
literal|0
decl_stmt|;
name|UINT32
name|DataLength
init|=
literal|0
decl_stmt|;
name|UINT32
name|DataOffset
init|=
literal|0
decl_stmt|;
name|UINT32
name|i
decl_stmt|;
name|UINT8
name|Type
decl_stmt|;
comment|/* No main table, only sub-tables */
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_ASF_INFO
argument_list|,
name|Table
argument_list|,
name|Offset
argument_list|)
expr_stmt|;
while|while
condition|(
name|Offset
operator|<
name|Table
operator|->
name|Length
condition|)
block|{
comment|/* Common sub-table header */
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Header
operator|.
name|Length
argument_list|,
name|AcpiDmTableInfoAsfHdr
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* The actual type is the lower 7 bits of Type */
name|Type
operator|=
call|(
name|UINT8
call|)
argument_list|(
name|SubTable
operator|->
name|Header
operator|.
name|Type
operator|&
literal|0x7F
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|Type
condition|)
block|{
case|case
name|ACPI_ASF_TYPE_INFO
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoAsf0
expr_stmt|;
break|break;
case|case
name|ACPI_ASF_TYPE_ALERT
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoAsf1
expr_stmt|;
name|DataInfoTable
operator|=
name|AcpiDmTableInfoAsf1a
expr_stmt|;
name|DataTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|UINT8
argument_list|,
name|SubTable
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_ASF_ALERT
argument_list|)
argument_list|)
expr_stmt|;
name|DataCount
operator|=
name|ACPI_CAST_PTR
argument_list|(
name|ACPI_ASF_ALERT
argument_list|,
name|SubTable
argument_list|)
operator|->
name|Alerts
expr_stmt|;
name|DataLength
operator|=
name|ACPI_CAST_PTR
argument_list|(
name|ACPI_ASF_ALERT
argument_list|,
name|SubTable
argument_list|)
operator|->
name|DataLength
expr_stmt|;
name|DataOffset
operator|=
name|Offset
operator|+
sizeof|sizeof
argument_list|(
name|ACPI_ASF_ALERT
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_ASF_TYPE_CONTROL
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoAsf2
expr_stmt|;
name|DataInfoTable
operator|=
name|AcpiDmTableInfoAsf2a
expr_stmt|;
name|DataTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|UINT8
argument_list|,
name|SubTable
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_ASF_REMOTE
argument_list|)
argument_list|)
expr_stmt|;
name|DataCount
operator|=
name|ACPI_CAST_PTR
argument_list|(
name|ACPI_ASF_REMOTE
argument_list|,
name|SubTable
argument_list|)
operator|->
name|Controls
expr_stmt|;
name|DataLength
operator|=
name|ACPI_CAST_PTR
argument_list|(
name|ACPI_ASF_REMOTE
argument_list|,
name|SubTable
argument_list|)
operator|->
name|DataLength
expr_stmt|;
name|DataOffset
operator|=
name|Offset
operator|+
sizeof|sizeof
argument_list|(
name|ACPI_ASF_REMOTE
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_ASF_TYPE_BOOT
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoAsf3
expr_stmt|;
break|break;
case|case
name|ACPI_ASF_TYPE_ADDRESS
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoAsf4
expr_stmt|;
name|DataTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|UINT8
argument_list|,
name|SubTable
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_ASF_ADDRESS
argument_list|)
argument_list|)
expr_stmt|;
name|DataLength
operator|=
name|ACPI_CAST_PTR
argument_list|(
name|ACPI_ASF_ADDRESS
argument_list|,
name|SubTable
argument_list|)
operator|->
name|Devices
expr_stmt|;
name|DataOffset
operator|=
name|Offset
operator|+
sizeof|sizeof
argument_list|(
name|ACPI_ASF_ADDRESS
argument_list|)
expr_stmt|;
break|break;
default|default:
name|AcpiOsPrintf
argument_list|(
literal|"\n**** Unknown ASF sub-table type 0x%X\n"
argument_list|,
name|SubTable
operator|->
name|Header
operator|.
name|Type
argument_list|)
expr_stmt|;
return|return;
block|}
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Header
operator|.
name|Length
argument_list|,
name|InfoTable
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Dump variable-length extra data */
switch|switch
condition|(
name|Type
condition|)
block|{
case|case
name|ACPI_ASF_TYPE_ALERT
case|:
case|case
name|ACPI_ASF_TYPE_CONTROL
case|:
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|DataCount
condition|;
name|i
operator|++
control|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
name|DataOffset
argument_list|,
name|DataTable
argument_list|,
name|DataLength
argument_list|,
name|DataInfoTable
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
name|DataTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|UINT8
argument_list|,
name|DataTable
argument_list|,
name|DataLength
argument_list|)
expr_stmt|;
name|DataOffset
operator|+=
name|DataLength
expr_stmt|;
block|}
break|break;
case|case
name|ACPI_ASF_TYPE_ADDRESS
case|:
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|DataLength
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
operator|!
operator|(
name|i
operator|%
literal|16
operator|)
condition|)
block|{
name|AcpiDmLineHeader
argument_list|(
name|DataOffset
argument_list|,
literal|1
argument_list|,
literal|"Addresses"
argument_list|)
expr_stmt|;
block|}
name|AcpiOsPrintf
argument_list|(
literal|"%2.2X "
argument_list|,
operator|*
name|DataTable
argument_list|)
expr_stmt|;
name|DataTable
operator|++
expr_stmt|;
name|DataOffset
operator|++
expr_stmt|;
if|if
condition|(
name|DataOffset
operator|>
name|Table
operator|->
name|Length
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"**** ACPI table terminates in the middle of a data structure!\n"
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
break|break;
default|default:
break|break;
block|}
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
comment|/* Point to next sub-table */
if|if
condition|(
operator|!
name|SubTable
operator|->
name|Header
operator|.
name|Length
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"Invalid zero subtable header length\n"
argument_list|)
expr_stmt|;
return|return;
block|}
name|Offset
operator|+=
name|SubTable
operator|->
name|Header
operator|.
name|Length
expr_stmt|;
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_ASF_INFO
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Header
operator|.
name|Length
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpCpep  *  * PARAMETERS:  Table               - A CPEP table  *  * RETURN:      None  *  * DESCRIPTION: Format the contents of a CPEP. This table type consists  *              of an open-ended number of subtables.  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmDumpCpep
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|ACPI_STATUS
name|Status
decl_stmt|;
name|ACPI_CPEP_POLLING
modifier|*
name|SubTable
decl_stmt|;
name|UINT32
name|Length
init|=
name|Table
operator|->
name|Length
decl_stmt|;
name|UINT32
name|Offset
init|=
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_CPEP
argument_list|)
decl_stmt|;
comment|/* Main table */
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoCpep
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Sub-tables */
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_CPEP_POLLING
argument_list|,
name|Table
argument_list|,
name|Offset
argument_list|)
expr_stmt|;
while|while
condition|(
name|Offset
operator|<
name|Table
operator|->
name|Length
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Header
operator|.
name|Length
argument_list|,
name|AcpiDmTableInfoCpep0
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Point to next sub-table */
name|Offset
operator|+=
name|SubTable
operator|->
name|Header
operator|.
name|Length
expr_stmt|;
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_CPEP_POLLING
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Header
operator|.
name|Length
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpDmar  *  * PARAMETERS:  Table               - A DMAR table  *  * RETURN:      None  *  * DESCRIPTION: Format the contents of a DMAR. This table type consists  *              of an open-ended number of subtables.  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmDumpDmar
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|ACPI_STATUS
name|Status
decl_stmt|;
name|ACPI_DMAR_HEADER
modifier|*
name|SubTable
decl_stmt|;
name|UINT32
name|Length
init|=
name|Table
operator|->
name|Length
decl_stmt|;
name|UINT32
name|Offset
init|=
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_DMAR
argument_list|)
decl_stmt|;
name|ACPI_DMTABLE_INFO
modifier|*
name|InfoTable
decl_stmt|;
name|ACPI_DMAR_DEVICE_SCOPE
modifier|*
name|ScopeTable
decl_stmt|;
name|UINT32
name|ScopeOffset
decl_stmt|;
name|UINT8
modifier|*
name|PciPath
decl_stmt|;
name|UINT32
name|PathOffset
decl_stmt|;
comment|/* Main table */
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoDmar
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Sub-tables */
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_DMAR_HEADER
argument_list|,
name|Table
argument_list|,
name|Offset
argument_list|)
expr_stmt|;
while|while
condition|(
name|Offset
operator|<
name|Table
operator|->
name|Length
condition|)
block|{
comment|/* Common sub-table header */
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Length
argument_list|,
name|AcpiDmTableInfoDmarHdr
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
switch|switch
condition|(
name|SubTable
operator|->
name|Type
condition|)
block|{
case|case
name|ACPI_DMAR_TYPE_HARDWARE_UNIT
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoDmar0
expr_stmt|;
name|ScopeOffset
operator|=
sizeof|sizeof
argument_list|(
name|ACPI_DMAR_HARDWARE_UNIT
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMAR_TYPE_RESERVED_MEMORY
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoDmar1
expr_stmt|;
name|ScopeOffset
operator|=
sizeof|sizeof
argument_list|(
name|ACPI_DMAR_RESERVED_MEMORY
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMAR_TYPE_ATSR
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoDmar2
expr_stmt|;
name|ScopeOffset
operator|=
sizeof|sizeof
argument_list|(
name|ACPI_DMAR_ATSR
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_DMAR_HARDWARE_AFFINITY
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoDmar3
expr_stmt|;
name|ScopeOffset
operator|=
sizeof|sizeof
argument_list|(
name|ACPI_DMAR_RHSA
argument_list|)
expr_stmt|;
break|break;
default|default:
name|AcpiOsPrintf
argument_list|(
literal|"\n**** Unknown DMAR sub-table type 0x%X\n\n"
argument_list|,
name|SubTable
operator|->
name|Type
argument_list|)
expr_stmt|;
return|return;
block|}
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Length
argument_list|,
name|InfoTable
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Dump the device scope entries (if any) */
name|ScopeTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_DMAR_DEVICE_SCOPE
argument_list|,
name|SubTable
argument_list|,
name|ScopeOffset
argument_list|)
expr_stmt|;
while|while
condition|(
name|ScopeOffset
operator|<
name|SubTable
operator|->
name|Length
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
name|Offset
operator|+
name|ScopeOffset
argument_list|,
name|ScopeTable
argument_list|,
name|ScopeTable
operator|->
name|Length
argument_list|,
name|AcpiDmTableInfoDmarScope
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Dump the PCI Path entries for this device scope */
name|PathOffset
operator|=
sizeof|sizeof
argument_list|(
name|ACPI_DMAR_DEVICE_SCOPE
argument_list|)
expr_stmt|;
comment|/* Path entries start at this offset */
name|PciPath
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|UINT8
argument_list|,
name|ScopeTable
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_DMAR_DEVICE_SCOPE
argument_list|)
argument_list|)
expr_stmt|;
while|while
condition|(
name|PathOffset
operator|<
name|ScopeTable
operator|->
name|Length
condition|)
block|{
name|AcpiDmLineHeader
argument_list|(
operator|(
name|PathOffset
operator|+
name|ScopeOffset
operator|+
name|Offset
operator|)
argument_list|,
literal|2
argument_list|,
literal|"PCI Path"
argument_list|)
expr_stmt|;
name|AcpiOsPrintf
argument_list|(
literal|"%2.2X,%2.2X\n"
argument_list|,
name|PciPath
index|[
literal|0
index|]
argument_list|,
name|PciPath
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
comment|/* Point to next PCI Path entry */
name|PathOffset
operator|+=
literal|2
expr_stmt|;
name|PciPath
operator|+=
literal|2
expr_stmt|;
block|}
comment|/* Point to next device scope entry */
name|ScopeOffset
operator|+=
name|ScopeTable
operator|->
name|Length
expr_stmt|;
name|ScopeTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_DMAR_DEVICE_SCOPE
argument_list|,
name|ScopeTable
argument_list|,
name|ScopeTable
operator|->
name|Length
argument_list|)
expr_stmt|;
block|}
comment|/* Point to next sub-table */
name|Offset
operator|+=
name|SubTable
operator|->
name|Length
expr_stmt|;
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_DMAR_HEADER
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Length
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpEinj  *  * PARAMETERS:  Table               - A EINJ table  *  * RETURN:      None  *  * DESCRIPTION: Format the contents of a EINJ. This table type consists  *              of an open-ended number of subtables.  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmDumpEinj
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|ACPI_STATUS
name|Status
decl_stmt|;
name|ACPI_WHEA_HEADER
modifier|*
name|SubTable
decl_stmt|;
name|UINT32
name|Length
init|=
name|Table
operator|->
name|Length
decl_stmt|;
name|UINT32
name|Offset
init|=
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_EINJ
argument_list|)
decl_stmt|;
comment|/* Main table */
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoEinj
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Sub-tables */
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_WHEA_HEADER
argument_list|,
name|Table
argument_list|,
name|Offset
argument_list|)
expr_stmt|;
while|while
condition|(
name|Offset
operator|<
name|Table
operator|->
name|Length
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_WHEA_HEADER
argument_list|)
argument_list|,
name|AcpiDmTableInfoEinj0
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Point to next sub-table (each subtable is of fixed length) */
name|Offset
operator|+=
sizeof|sizeof
argument_list|(
name|ACPI_WHEA_HEADER
argument_list|)
expr_stmt|;
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_WHEA_HEADER
argument_list|,
name|SubTable
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_WHEA_HEADER
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpErst  *  * PARAMETERS:  Table               - A ERST table  *  * RETURN:      None  *  * DESCRIPTION: Format the contents of a ERST. This table type consists  *              of an open-ended number of subtables.  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmDumpErst
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|ACPI_STATUS
name|Status
decl_stmt|;
name|ACPI_WHEA_HEADER
modifier|*
name|SubTable
decl_stmt|;
name|UINT32
name|Length
init|=
name|Table
operator|->
name|Length
decl_stmt|;
name|UINT32
name|Offset
init|=
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_ERST
argument_list|)
decl_stmt|;
comment|/* Main table */
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoErst
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Sub-tables */
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_WHEA_HEADER
argument_list|,
name|Table
argument_list|,
name|Offset
argument_list|)
expr_stmt|;
while|while
condition|(
name|Offset
operator|<
name|Table
operator|->
name|Length
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_WHEA_HEADER
argument_list|)
argument_list|,
name|AcpiDmTableInfoErst0
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Point to next sub-table (each subtable is of fixed length) */
name|Offset
operator|+=
sizeof|sizeof
argument_list|(
name|ACPI_WHEA_HEADER
argument_list|)
expr_stmt|;
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_WHEA_HEADER
argument_list|,
name|SubTable
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_WHEA_HEADER
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpHest  *  * PARAMETERS:  Table               - A HEST table  *  * RETURN:      None  *  * DESCRIPTION: Format the contents of a HEST. This table type consists  *              of an open-ended number of subtables.  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmDumpHest
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|ACPI_STATUS
name|Status
decl_stmt|;
name|ACPI_HEST_HEADER
modifier|*
name|SubTable
decl_stmt|;
name|UINT32
name|Length
init|=
name|Table
operator|->
name|Length
decl_stmt|;
name|UINT32
name|Offset
init|=
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_HEST
argument_list|)
decl_stmt|;
name|ACPI_DMTABLE_INFO
modifier|*
name|InfoTable
decl_stmt|;
name|UINT32
name|SubTableLength
decl_stmt|;
name|UINT32
name|BankCount
decl_stmt|;
name|ACPI_HEST_IA_ERROR_BANK
modifier|*
name|BankTable
decl_stmt|;
comment|/* Main table */
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoHest
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Sub-tables */
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_HEST_HEADER
argument_list|,
name|Table
argument_list|,
name|Offset
argument_list|)
expr_stmt|;
while|while
condition|(
name|Offset
operator|<
name|Table
operator|->
name|Length
condition|)
block|{
name|BankCount
operator|=
literal|0
expr_stmt|;
switch|switch
condition|(
name|SubTable
operator|->
name|Type
condition|)
block|{
case|case
name|ACPI_HEST_TYPE_IA32_CHECK
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoHest0
expr_stmt|;
name|SubTableLength
operator|=
sizeof|sizeof
argument_list|(
name|ACPI_HEST_IA_MACHINE_CHECK
argument_list|)
expr_stmt|;
name|BankCount
operator|=
operator|(
name|ACPI_CAST_PTR
argument_list|(
name|ACPI_HEST_IA_MACHINE_CHECK
argument_list|,
name|SubTable
argument_list|)
operator|)
operator|->
name|NumHardwareBanks
expr_stmt|;
break|break;
case|case
name|ACPI_HEST_TYPE_IA32_CORRECTED_CHECK
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoHest1
expr_stmt|;
name|SubTableLength
operator|=
sizeof|sizeof
argument_list|(
name|ACPI_HEST_IA_CORRECTED
argument_list|)
expr_stmt|;
name|BankCount
operator|=
operator|(
name|ACPI_CAST_PTR
argument_list|(
name|ACPI_HEST_IA_CORRECTED
argument_list|,
name|SubTable
argument_list|)
operator|)
operator|->
name|NumHardwareBanks
expr_stmt|;
break|break;
case|case
name|ACPI_HEST_TYPE_IA32_NMI
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoHest2
expr_stmt|;
name|SubTableLength
operator|=
sizeof|sizeof
argument_list|(
name|ACPI_HEST_IA_NMI
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_HEST_TYPE_AER_ROOT_PORT
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoHest6
expr_stmt|;
name|SubTableLength
operator|=
sizeof|sizeof
argument_list|(
name|ACPI_HEST_AER_ROOT
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_HEST_TYPE_AER_ENDPOINT
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoHest7
expr_stmt|;
name|SubTableLength
operator|=
sizeof|sizeof
argument_list|(
name|ACPI_HEST_AER
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_HEST_TYPE_AER_BRIDGE
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoHest8
expr_stmt|;
name|SubTableLength
operator|=
sizeof|sizeof
argument_list|(
name|ACPI_HEST_AER_BRIDGE
argument_list|)
expr_stmt|;
break|break;
case|case
name|ACPI_HEST_TYPE_GENERIC_ERROR
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoHest9
expr_stmt|;
name|SubTableLength
operator|=
sizeof|sizeof
argument_list|(
name|ACPI_HEST_GENERIC
argument_list|)
expr_stmt|;
break|break;
default|default:
comment|/* Cannot continue on unknown type - no length */
name|AcpiOsPrintf
argument_list|(
literal|"\n**** Unknown HEST sub-table type 0x%X\n"
argument_list|,
name|SubTable
operator|->
name|Type
argument_list|)
expr_stmt|;
return|return;
block|}
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
name|SubTableLength
argument_list|,
name|InfoTable
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Point to end of current subtable (each subtable above is of fixed length) */
name|Offset
operator|+=
name|SubTableLength
expr_stmt|;
comment|/* If there are any (fixed-length) Error Banks from above, dump them now */
if|if
condition|(
name|BankCount
condition|)
block|{
name|BankTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_HEST_IA_ERROR_BANK
argument_list|,
name|SubTable
argument_list|,
name|SubTableLength
argument_list|)
expr_stmt|;
name|SubTableLength
operator|+=
name|BankCount
operator|*
sizeof|sizeof
argument_list|(
name|ACPI_HEST_IA_ERROR_BANK
argument_list|)
expr_stmt|;
while|while
condition|(
name|BankCount
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
name|Offset
argument_list|,
name|BankTable
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_HEST_IA_ERROR_BANK
argument_list|)
argument_list|,
name|AcpiDmTableInfoHestBank
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
name|Offset
operator|+=
sizeof|sizeof
argument_list|(
name|ACPI_HEST_IA_ERROR_BANK
argument_list|)
expr_stmt|;
name|BankTable
operator|++
expr_stmt|;
name|BankCount
operator|--
expr_stmt|;
block|}
block|}
comment|/* Point to next sub-table */
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_HEST_HEADER
argument_list|,
name|SubTable
argument_list|,
name|SubTableLength
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpIvrs  *  * PARAMETERS:  Table               - A IVRS table  *  * RETURN:      None  *  * DESCRIPTION: Format the contents of a IVRS  *  ******************************************************************************/
end_comment

begin_decl_stmt
specifier|static
name|UINT8
name|EntrySizes
index|[]
init|=
block|{
literal|4
block|,
literal|8
block|,
literal|16
block|,
literal|32
block|}
decl_stmt|;
end_decl_stmt

begin_function
name|void
name|AcpiDmDumpIvrs
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|ACPI_STATUS
name|Status
decl_stmt|;
name|UINT32
name|Offset
init|=
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_IVRS
argument_list|)
decl_stmt|;
name|UINT32
name|EntryOffset
decl_stmt|;
name|UINT32
name|EntryLength
decl_stmt|;
name|UINT32
name|EntryType
decl_stmt|;
name|ACPI_IVRS_DE_HEADER
modifier|*
name|DeviceEntry
decl_stmt|;
name|ACPI_IVRS_HEADER
modifier|*
name|SubTable
decl_stmt|;
name|ACPI_DMTABLE_INFO
modifier|*
name|InfoTable
decl_stmt|;
comment|/* Main table */
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoIvrs
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Sub-tables */
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_IVRS_HEADER
argument_list|,
name|Table
argument_list|,
name|Offset
argument_list|)
expr_stmt|;
while|while
condition|(
name|Offset
operator|<
name|Table
operator|->
name|Length
condition|)
block|{
comment|/* Common sub-table header */
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Length
argument_list|,
name|AcpiDmTableInfoIvrsHdr
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
switch|switch
condition|(
name|SubTable
operator|->
name|Type
condition|)
block|{
case|case
name|ACPI_IVRS_TYPE_HARDWARE
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoIvrs0
expr_stmt|;
break|break;
case|case
name|ACPI_IVRS_TYPE_MEMORY1
case|:
case|case
name|ACPI_IVRS_TYPE_MEMORY2
case|:
case|case
name|ACPI_IVRS_TYPE_MEMORY3
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoIvrs1
expr_stmt|;
break|break;
default|default:
name|AcpiOsPrintf
argument_list|(
literal|"\n**** Unknown IVRS sub-table type 0x%X\n"
argument_list|,
name|SubTable
operator|->
name|Type
argument_list|)
expr_stmt|;
comment|/* Attempt to continue */
if|if
condition|(
operator|!
name|SubTable
operator|->
name|Length
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"Invalid zero length subtable\n"
argument_list|)
expr_stmt|;
return|return;
block|}
goto|goto
name|NextSubTable
goto|;
block|}
comment|/* Dump the subtable */
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Length
argument_list|,
name|InfoTable
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* The hardware subtable can contain multiple device entries */
if|if
condition|(
name|SubTable
operator|->
name|Type
operator|==
name|ACPI_IVRS_TYPE_HARDWARE
condition|)
block|{
name|EntryOffset
operator|=
name|Offset
operator|+
sizeof|sizeof
argument_list|(
name|ACPI_IVRS_HARDWARE
argument_list|)
expr_stmt|;
name|DeviceEntry
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_IVRS_DE_HEADER
argument_list|,
name|SubTable
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_IVRS_HARDWARE
argument_list|)
argument_list|)
expr_stmt|;
while|while
condition|(
name|EntryOffset
operator|<
operator|(
name|Offset
operator|+
name|SubTable
operator|->
name|Length
operator|)
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
comment|/*                  * Upper 2 bits of Type encode the length of the device entry                  *                  * 00 = 4 byte                  * 01 = 8 byte                  * 10 = 16 byte - currently no entries defined                  * 11 = 32 byte - currently no entries defined                  */
name|EntryType
operator|=
name|DeviceEntry
operator|->
name|Type
expr_stmt|;
name|EntryLength
operator|=
name|EntrySizes
index|[
name|EntryType
operator|>>
literal|6
index|]
expr_stmt|;
switch|switch
condition|(
name|EntryType
condition|)
block|{
comment|/* 4-byte device entries */
case|case
name|ACPI_IVRS_TYPE_PAD4
case|:
case|case
name|ACPI_IVRS_TYPE_ALL
case|:
case|case
name|ACPI_IVRS_TYPE_SELECT
case|:
case|case
name|ACPI_IVRS_TYPE_START
case|:
case|case
name|ACPI_IVRS_TYPE_END
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoIvrs4
expr_stmt|;
break|break;
comment|/* 8-byte entries, type A */
case|case
name|ACPI_IVRS_TYPE_ALIAS_SELECT
case|:
case|case
name|ACPI_IVRS_TYPE_ALIAS_START
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoIvrs8a
expr_stmt|;
break|break;
comment|/* 8-byte entries, type B */
case|case
name|ACPI_IVRS_TYPE_PAD8
case|:
case|case
name|ACPI_IVRS_TYPE_EXT_SELECT
case|:
case|case
name|ACPI_IVRS_TYPE_EXT_START
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoIvrs8b
expr_stmt|;
break|break;
comment|/* 8-byte entries, type C */
case|case
name|ACPI_IVRS_TYPE_SPECIAL
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoIvrs8c
expr_stmt|;
break|break;
default|default:
name|InfoTable
operator|=
name|AcpiDmTableInfoIvrs4
expr_stmt|;
name|AcpiOsPrintf
argument_list|(
literal|"\n**** Unknown IVRS device entry type/length: "
literal|"0x%.2X/0x%X at offset 0x%.4X: (header below)\n"
argument_list|,
name|EntryType
argument_list|,
name|EntryLength
argument_list|,
name|EntryOffset
argument_list|)
expr_stmt|;
break|break;
block|}
comment|/* Dump the Device Entry */
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
name|EntryOffset
argument_list|,
name|DeviceEntry
argument_list|,
name|EntryLength
argument_list|,
name|InfoTable
argument_list|)
expr_stmt|;
name|EntryOffset
operator|+=
name|EntryLength
expr_stmt|;
name|DeviceEntry
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_IVRS_DE_HEADER
argument_list|,
name|DeviceEntry
argument_list|,
name|EntryLength
argument_list|)
expr_stmt|;
block|}
block|}
name|NextSubTable
label|:
comment|/* Point to next sub-table */
name|Offset
operator|+=
name|SubTable
operator|->
name|Length
expr_stmt|;
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_IVRS_HEADER
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Length
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpMadt  *  * PARAMETERS:  Table               - A MADT table  *  * RETURN:      None  *  * DESCRIPTION: Format the contents of a MADT. This table type consists  *              of an open-ended number of subtables.  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmDumpMadt
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|ACPI_STATUS
name|Status
decl_stmt|;
name|ACPI_SUBTABLE_HEADER
modifier|*
name|SubTable
decl_stmt|;
name|UINT32
name|Length
init|=
name|Table
operator|->
name|Length
decl_stmt|;
name|UINT32
name|Offset
init|=
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_MADT
argument_list|)
decl_stmt|;
name|ACPI_DMTABLE_INFO
modifier|*
name|InfoTable
decl_stmt|;
comment|/* Main table */
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoMadt
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Sub-tables */
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_SUBTABLE_HEADER
argument_list|,
name|Table
argument_list|,
name|Offset
argument_list|)
expr_stmt|;
while|while
condition|(
name|Offset
operator|<
name|Table
operator|->
name|Length
condition|)
block|{
comment|/* Common sub-table header */
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Length
argument_list|,
name|AcpiDmTableInfoMadtHdr
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
switch|switch
condition|(
name|SubTable
operator|->
name|Type
condition|)
block|{
case|case
name|ACPI_MADT_TYPE_LOCAL_APIC
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoMadt0
expr_stmt|;
break|break;
case|case
name|ACPI_MADT_TYPE_IO_APIC
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoMadt1
expr_stmt|;
break|break;
case|case
name|ACPI_MADT_TYPE_INTERRUPT_OVERRIDE
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoMadt2
expr_stmt|;
break|break;
case|case
name|ACPI_MADT_TYPE_NMI_SOURCE
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoMadt3
expr_stmt|;
break|break;
case|case
name|ACPI_MADT_TYPE_LOCAL_APIC_NMI
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoMadt4
expr_stmt|;
break|break;
case|case
name|ACPI_MADT_TYPE_LOCAL_APIC_OVERRIDE
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoMadt5
expr_stmt|;
break|break;
case|case
name|ACPI_MADT_TYPE_IO_SAPIC
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoMadt6
expr_stmt|;
break|break;
case|case
name|ACPI_MADT_TYPE_LOCAL_SAPIC
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoMadt7
expr_stmt|;
break|break;
case|case
name|ACPI_MADT_TYPE_INTERRUPT_SOURCE
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoMadt8
expr_stmt|;
break|break;
case|case
name|ACPI_MADT_TYPE_LOCAL_X2APIC
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoMadt9
expr_stmt|;
break|break;
case|case
name|ACPI_MADT_TYPE_LOCAL_X2APIC_NMI
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoMadt10
expr_stmt|;
break|break;
default|default:
name|AcpiOsPrintf
argument_list|(
literal|"\n**** Unknown MADT sub-table type 0x%X\n\n"
argument_list|,
name|SubTable
operator|->
name|Type
argument_list|)
expr_stmt|;
comment|/* Attempt to continue */
if|if
condition|(
operator|!
name|SubTable
operator|->
name|Length
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"Invalid zero length subtable\n"
argument_list|)
expr_stmt|;
return|return;
block|}
goto|goto
name|NextSubTable
goto|;
block|}
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Length
argument_list|,
name|InfoTable
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
name|NextSubTable
label|:
comment|/* Point to next sub-table */
name|Offset
operator|+=
name|SubTable
operator|->
name|Length
expr_stmt|;
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_SUBTABLE_HEADER
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Length
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpMcfg  *  * PARAMETERS:  Table               - A MCFG Table  *  * RETURN:      None  *  * DESCRIPTION: Format the contents of a MCFG table  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmDumpMcfg
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|ACPI_STATUS
name|Status
decl_stmt|;
name|UINT32
name|Offset
init|=
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_MCFG
argument_list|)
decl_stmt|;
name|ACPI_MCFG_ALLOCATION
modifier|*
name|SubTable
decl_stmt|;
comment|/* Main table */
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoMcfg
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Sub-tables */
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_MCFG_ALLOCATION
argument_list|,
name|Table
argument_list|,
name|Offset
argument_list|)
expr_stmt|;
while|while
condition|(
name|Offset
operator|<
name|Table
operator|->
name|Length
condition|)
block|{
if|if
condition|(
name|Offset
operator|+
sizeof|sizeof
argument_list|(
name|ACPI_MCFG_ALLOCATION
argument_list|)
operator|>
name|Table
operator|->
name|Length
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"Warning: there are %u invalid trailing bytes\n"
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_MCFG_ALLOCATION
argument_list|)
operator|-
operator|(
name|Offset
operator|-
name|Table
operator|->
name|Length
operator|)
argument_list|)
expr_stmt|;
return|return;
block|}
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_MCFG_ALLOCATION
argument_list|)
argument_list|,
name|AcpiDmTableInfoMcfg0
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Point to next sub-table (each subtable is of fixed length) */
name|Offset
operator|+=
sizeof|sizeof
argument_list|(
name|ACPI_MCFG_ALLOCATION
argument_list|)
expr_stmt|;
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_MCFG_ALLOCATION
argument_list|,
name|SubTable
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_MCFG_ALLOCATION
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpMsct  *  * PARAMETERS:  Table               - A MSCT table  *  * RETURN:      None  *  * DESCRIPTION: Format the contents of a MSCT  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmDumpMsct
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|ACPI_STATUS
name|Status
decl_stmt|;
name|UINT32
name|Offset
init|=
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_MSCT
argument_list|)
decl_stmt|;
name|ACPI_MSCT_PROXIMITY
modifier|*
name|SubTable
decl_stmt|;
comment|/* Main table */
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoMsct
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Sub-tables */
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_MSCT_PROXIMITY
argument_list|,
name|Table
argument_list|,
name|Offset
argument_list|)
expr_stmt|;
while|while
condition|(
name|Offset
operator|<
name|Table
operator|->
name|Length
condition|)
block|{
comment|/* Common sub-table header */
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_MSCT_PROXIMITY
argument_list|)
argument_list|,
name|AcpiDmTableInfoMsct0
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Point to next sub-table */
name|Offset
operator|+=
sizeof|sizeof
argument_list|(
name|ACPI_MSCT_PROXIMITY
argument_list|)
expr_stmt|;
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_MSCT_PROXIMITY
argument_list|,
name|SubTable
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_MSCT_PROXIMITY
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpSlic  *  * PARAMETERS:  Table               - A SLIC table  *  * RETURN:      None  *  * DESCRIPTION: Format the contents of a SLIC  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmDumpSlic
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|ACPI_STATUS
name|Status
decl_stmt|;
name|UINT32
name|Offset
init|=
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_SLIC
argument_list|)
decl_stmt|;
name|ACPI_SLIC_HEADER
modifier|*
name|SubTable
decl_stmt|;
name|ACPI_DMTABLE_INFO
modifier|*
name|InfoTable
decl_stmt|;
comment|/* There is no main SLIC table, only subtables */
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_SLIC_HEADER
argument_list|,
name|Table
argument_list|,
name|Offset
argument_list|)
expr_stmt|;
while|while
condition|(
name|Offset
operator|<
name|Table
operator|->
name|Length
condition|)
block|{
comment|/* Common sub-table header */
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Length
argument_list|,
name|AcpiDmTableInfoSlicHdr
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
switch|switch
condition|(
name|SubTable
operator|->
name|Type
condition|)
block|{
case|case
name|ACPI_SLIC_TYPE_PUBLIC_KEY
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoSlic0
expr_stmt|;
break|break;
case|case
name|ACPI_SLIC_TYPE_WINDOWS_MARKER
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoSlic1
expr_stmt|;
break|break;
default|default:
name|AcpiOsPrintf
argument_list|(
literal|"\n**** Unknown SLIC sub-table type 0x%X\n"
argument_list|,
name|SubTable
operator|->
name|Type
argument_list|)
expr_stmt|;
comment|/* Attempt to continue */
if|if
condition|(
operator|!
name|SubTable
operator|->
name|Length
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"Invalid zero length subtable\n"
argument_list|)
expr_stmt|;
return|return;
block|}
goto|goto
name|NextSubTable
goto|;
block|}
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Length
argument_list|,
name|InfoTable
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
name|NextSubTable
label|:
comment|/* Point to next sub-table */
name|Offset
operator|+=
name|SubTable
operator|->
name|Length
expr_stmt|;
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_SLIC_HEADER
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Length
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpSlit  *  * PARAMETERS:  Table               - An SLIT  *  * RETURN:      None  *  * DESCRIPTION: Format the contents of a SLIT  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmDumpSlit
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|ACPI_STATUS
name|Status
decl_stmt|;
name|UINT32
name|Offset
decl_stmt|;
name|UINT8
modifier|*
name|Row
decl_stmt|;
name|UINT32
name|Localities
decl_stmt|;
name|UINT32
name|i
decl_stmt|;
name|UINT32
name|j
decl_stmt|;
comment|/* Main table */
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoSlit
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Display the Locality NxN Matrix */
name|Localities
operator|=
operator|(
name|UINT32
operator|)
name|ACPI_CAST_PTR
argument_list|(
name|ACPI_TABLE_SLIT
argument_list|,
name|Table
argument_list|)
operator|->
name|LocalityCount
expr_stmt|;
name|Offset
operator|=
name|ACPI_OFFSET
argument_list|(
name|ACPI_TABLE_SLIT
argument_list|,
name|Entry
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|Row
operator|=
operator|(
name|UINT8
operator|*
operator|)
name|ACPI_CAST_PTR
argument_list|(
name|ACPI_TABLE_SLIT
argument_list|,
name|Table
argument_list|)
operator|->
name|Entry
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|Localities
condition|;
name|i
operator|++
control|)
block|{
comment|/* Display one row of the matrix */
name|AcpiDmLineHeader2
argument_list|(
name|Offset
argument_list|,
name|Localities
argument_list|,
literal|"Locality"
argument_list|,
name|i
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|Localities
condition|;
name|j
operator|++
control|)
block|{
comment|/* Check for beyond EOT */
if|if
condition|(
name|Offset
operator|>=
name|Table
operator|->
name|Length
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"\n**** Not enough room in table for all localities\n"
argument_list|)
expr_stmt|;
return|return;
block|}
name|AcpiOsPrintf
argument_list|(
literal|"%2.2X"
argument_list|,
name|Row
index|[
name|j
index|]
argument_list|)
expr_stmt|;
name|Offset
operator|++
expr_stmt|;
comment|/* Display up to 16 bytes per output row */
if|if
condition|(
operator|(
name|j
operator|+
literal|1
operator|)
operator|<
name|Localities
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|" "
argument_list|)
expr_stmt|;
if|if
condition|(
name|j
operator|&&
operator|(
operator|(
operator|(
name|j
operator|+
literal|1
operator|)
operator|%
literal|16
operator|)
operator|==
literal|0
operator|)
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"\\\n"
argument_list|)
expr_stmt|;
comment|/* With line continuation char */
name|AcpiDmLineHeader
argument_list|(
name|Offset
argument_list|,
literal|0
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
block|}
block|}
comment|/* Point to next row */
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Row
operator|+=
name|Localities
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpSrat  *  * PARAMETERS:  Table               - A SRAT table  *  * RETURN:      None  *  * DESCRIPTION: Format the contents of a SRAT  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmDumpSrat
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|ACPI_STATUS
name|Status
decl_stmt|;
name|UINT32
name|Offset
init|=
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_SRAT
argument_list|)
decl_stmt|;
name|ACPI_SUBTABLE_HEADER
modifier|*
name|SubTable
decl_stmt|;
name|ACPI_DMTABLE_INFO
modifier|*
name|InfoTable
decl_stmt|;
comment|/* Main table */
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoSrat
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Sub-tables */
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_SUBTABLE_HEADER
argument_list|,
name|Table
argument_list|,
name|Offset
argument_list|)
expr_stmt|;
while|while
condition|(
name|Offset
operator|<
name|Table
operator|->
name|Length
condition|)
block|{
comment|/* Common sub-table header */
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Length
argument_list|,
name|AcpiDmTableInfoSratHdr
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
switch|switch
condition|(
name|SubTable
operator|->
name|Type
condition|)
block|{
case|case
name|ACPI_SRAT_TYPE_CPU_AFFINITY
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoSrat0
expr_stmt|;
break|break;
case|case
name|ACPI_SRAT_TYPE_MEMORY_AFFINITY
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoSrat1
expr_stmt|;
break|break;
case|case
name|ACPI_SRAT_TYPE_X2APIC_CPU_AFFINITY
case|:
name|InfoTable
operator|=
name|AcpiDmTableInfoSrat2
expr_stmt|;
break|break;
default|default:
name|AcpiOsPrintf
argument_list|(
literal|"\n**** Unknown SRAT sub-table type 0x%X\n"
argument_list|,
name|SubTable
operator|->
name|Type
argument_list|)
expr_stmt|;
comment|/* Attempt to continue */
if|if
condition|(
operator|!
name|SubTable
operator|->
name|Length
condition|)
block|{
name|AcpiOsPrintf
argument_list|(
literal|"Invalid zero length subtable\n"
argument_list|)
expr_stmt|;
return|return;
block|}
goto|goto
name|NextSubTable
goto|;
block|}
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Length
argument_list|,
name|InfoTable
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
name|NextSubTable
label|:
comment|/* Point to next sub-table */
name|Offset
operator|+=
name|SubTable
operator|->
name|Length
expr_stmt|;
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_SUBTABLE_HEADER
argument_list|,
name|SubTable
argument_list|,
name|SubTable
operator|->
name|Length
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*******************************************************************************  *  * FUNCTION:    AcpiDmDumpWdat  *  * PARAMETERS:  Table               - A WDAT table  *  * RETURN:      None  *  * DESCRIPTION: Format the contents of a WDAT  *  ******************************************************************************/
end_comment

begin_function
name|void
name|AcpiDmDumpWdat
parameter_list|(
name|ACPI_TABLE_HEADER
modifier|*
name|Table
parameter_list|)
block|{
name|ACPI_STATUS
name|Status
decl_stmt|;
name|UINT32
name|Offset
init|=
sizeof|sizeof
argument_list|(
name|ACPI_TABLE_WDAT
argument_list|)
decl_stmt|;
name|ACPI_WDAT_ENTRY
modifier|*
name|SubTable
decl_stmt|;
comment|/* Main table */
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
literal|0
argument_list|,
name|Table
argument_list|,
literal|0
argument_list|,
name|AcpiDmTableInfoWdat
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Sub-tables */
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_WDAT_ENTRY
argument_list|,
name|Table
argument_list|,
name|Offset
argument_list|)
expr_stmt|;
while|while
condition|(
name|Offset
operator|<
name|Table
operator|->
name|Length
condition|)
block|{
comment|/* Common sub-table header */
name|AcpiOsPrintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|Status
operator|=
name|AcpiDmDumpTable
argument_list|(
name|Table
operator|->
name|Length
argument_list|,
name|Offset
argument_list|,
name|SubTable
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_WDAT_ENTRY
argument_list|)
argument_list|,
name|AcpiDmTableInfoWdat0
argument_list|)
expr_stmt|;
if|if
condition|(
name|ACPI_FAILURE
argument_list|(
name|Status
argument_list|)
condition|)
block|{
return|return;
block|}
comment|/* Point to next sub-table */
name|Offset
operator|+=
sizeof|sizeof
argument_list|(
name|ACPI_WDAT_ENTRY
argument_list|)
expr_stmt|;
name|SubTable
operator|=
name|ACPI_ADD_PTR
argument_list|(
name|ACPI_WDAT_ENTRY
argument_list|,
name|SubTable
argument_list|,
sizeof|sizeof
argument_list|(
name|ACPI_WDAT_ENTRY
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

end_unit

