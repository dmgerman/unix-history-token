begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * deprecated.c:  holding file for all deprecated APIs.  *                "we can't lose 'em, but we can shun 'em!"  *  * ====================================================================  *    Licensed to the Apache Software Foundation (ASF) under one  *    or more contributor license agreements.  See the NOTICE file  *    distributed with this work for additional information  *    regarding copyright ownership.  The ASF licenses this file  *    to you under the Apache License, Version 2.0 (the  *    "License"); you may not use this file except in compliance  *    with the License.  You may obtain a copy of the License at  *  *      http://www.apache.org/licenses/LICENSE-2.0  *  *    Unless required by applicable law or agreed to in writing,  *    software distributed under the License is distributed on an  *    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY  *    KIND, either express or implied.  See the License for the  *    specific language governing permissions and limitations  *    under the License.  * ====================================================================  */
end_comment

begin_comment
comment|/* We define this here to remove any further warnings about the usage of    deprecated functions in this file. */
end_comment

begin_define
define|#
directive|define
name|SVN_DEPRECATED
end_define

begin_include
include|#
directive|include
file|"svn_hash.h"
end_include

begin_include
include|#
directive|include
file|"svn_ra.h"
end_include

begin_include
include|#
directive|include
file|"svn_path.h"
end_include

begin_include
include|#
directive|include
file|"svn_compat.h"
end_include

begin_include
include|#
directive|include
file|"svn_props.h"
end_include

begin_include
include|#
directive|include
file|"svn_pools.h"
end_include

begin_include
include|#
directive|include
file|"ra_loader.h"
end_include

begin_include
include|#
directive|include
file|"deprecated.h"
end_include

begin_include
include|#
directive|include
file|"svn_private_config.h"
end_include

begin_escape
end_escape

begin_comment
comment|/*** From ra_loader.c ***/
end_comment

begin_comment
comment|/*** Compatibility Wrappers ***/
end_comment

begin_comment
comment|/* Wrap @c svn_ra_reporter3_t in an interface that looks like    @c svn_ra_reporter2_t, for compatibility with functions that take    the latter.  This shields the ra-specific implementations from    worrying about what kind of reporter they're dealing with.     This code does not live in wrapper_template.h because that file is    about the big changeover from a vtable-style to function-style    interface, and does not contain the post-changeover interfaces    that we are compatiblizing here.     This code looks like it duplicates code in libsvn_wc/adm_crawler.c,    but in fact it does not.  That code makes old things look like new    things; this code makes a new thing look like an old thing. */
end_comment

begin_comment
comment|/* Baton for abovementioned wrapping. */
end_comment

begin_struct
struct|struct
name|reporter_3in2_baton
block|{
specifier|const
name|svn_ra_reporter3_t
modifier|*
name|reporter3
decl_stmt|;
name|void
modifier|*
name|reporter3_baton
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/* Wrap the corresponding svn_ra_reporter3_t field in an    svn_ra_reporter2_t interface.  @a report_baton is a    @c reporter_3in2_baton_t *. */
end_comment

begin_function
specifier|static
name|svn_error_t
modifier|*
name|set_path
parameter_list|(
name|void
modifier|*
name|report_baton
parameter_list|,
specifier|const
name|char
modifier|*
name|path
parameter_list|,
name|svn_revnum_t
name|revision
parameter_list|,
name|svn_boolean_t
name|start_empty
parameter_list|,
specifier|const
name|char
modifier|*
name|lock_token
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
name|struct
name|reporter_3in2_baton
modifier|*
name|b
init|=
name|report_baton
decl_stmt|;
return|return
name|b
operator|->
name|reporter3
operator|->
name|set_path
argument_list|(
name|b
operator|->
name|reporter3_baton
argument_list|,
name|path
argument_list|,
name|revision
argument_list|,
name|svn_depth_infinity
argument_list|,
name|start_empty
argument_list|,
name|lock_token
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/* Wrap the corresponding svn_ra_reporter3_t field in an    svn_ra_reporter2_t interface.  @a report_baton is a    @c reporter_3in2_baton_t *. */
end_comment

begin_function
specifier|static
name|svn_error_t
modifier|*
name|delete_path
parameter_list|(
name|void
modifier|*
name|report_baton
parameter_list|,
specifier|const
name|char
modifier|*
name|path
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
name|struct
name|reporter_3in2_baton
modifier|*
name|b
init|=
name|report_baton
decl_stmt|;
return|return
name|b
operator|->
name|reporter3
operator|->
name|delete_path
argument_list|(
name|b
operator|->
name|reporter3_baton
argument_list|,
name|path
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/* Wrap the corresponding svn_ra_reporter3_t field in an    svn_ra_reporter2_t interface.  @a report_baton is a    @c reporter_3in2_baton_t *. */
end_comment

begin_function
specifier|static
name|svn_error_t
modifier|*
name|link_path
parameter_list|(
name|void
modifier|*
name|report_baton
parameter_list|,
specifier|const
name|char
modifier|*
name|path
parameter_list|,
specifier|const
name|char
modifier|*
name|url
parameter_list|,
name|svn_revnum_t
name|revision
parameter_list|,
name|svn_boolean_t
name|start_empty
parameter_list|,
specifier|const
name|char
modifier|*
name|lock_token
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
name|struct
name|reporter_3in2_baton
modifier|*
name|b
init|=
name|report_baton
decl_stmt|;
return|return
name|b
operator|->
name|reporter3
operator|->
name|link_path
argument_list|(
name|b
operator|->
name|reporter3_baton
argument_list|,
name|path
argument_list|,
name|url
argument_list|,
name|revision
argument_list|,
name|svn_depth_infinity
argument_list|,
name|start_empty
argument_list|,
name|lock_token
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/* Wrap the corresponding svn_ra_reporter3_t field in an    svn_ra_reporter2_t interface.  @a report_baton is a    @c reporter_3in2_baton_t *. */
end_comment

begin_function
specifier|static
name|svn_error_t
modifier|*
name|finish_report
parameter_list|(
name|void
modifier|*
name|report_baton
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
name|struct
name|reporter_3in2_baton
modifier|*
name|b
init|=
name|report_baton
decl_stmt|;
return|return
name|b
operator|->
name|reporter3
operator|->
name|finish_report
argument_list|(
name|b
operator|->
name|reporter3_baton
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/* Wrap the corresponding svn_ra_reporter3_t field in an    svn_ra_reporter2_t interface.  @a report_baton is a    @c reporter_3in2_baton_t *. */
end_comment

begin_function
specifier|static
name|svn_error_t
modifier|*
name|abort_report
parameter_list|(
name|void
modifier|*
name|report_baton
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
name|struct
name|reporter_3in2_baton
modifier|*
name|b
init|=
name|report_baton
decl_stmt|;
return|return
name|b
operator|->
name|reporter3
operator|->
name|abort_report
argument_list|(
name|b
operator|->
name|reporter3_baton
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/* Wrap svn_ra_reporter3_t calls in an svn_ra_reporter2_t interface.     Note: For calls where the prototypes are exactly the same, we could    avoid the pass-through overhead by using the function in the    reporter returned from session->vtable->do_foo.  But the code would    get a lot less readable, and the only benefit would be to shave a    few instructions in a network-bound operation anyway.  So in    delete_path(), finish_report(), and abort_report(), we cheerfully    pass through to identical functions. */
end_comment

begin_decl_stmt
specifier|static
name|svn_ra_reporter2_t
name|reporter_3in2_wrapper
init|=
block|{
name|set_path
block|,
name|delete_path
block|,
name|link_path
block|,
name|finish_report
block|,
name|abort_report
block|}
decl_stmt|;
end_decl_stmt

begin_function
name|svn_error_t
modifier|*
name|svn_ra_open3
parameter_list|(
name|svn_ra_session_t
modifier|*
modifier|*
name|session_p
parameter_list|,
specifier|const
name|char
modifier|*
name|repos_URL
parameter_list|,
specifier|const
name|char
modifier|*
name|uuid
parameter_list|,
specifier|const
name|svn_ra_callbacks2_t
modifier|*
name|callbacks
parameter_list|,
name|void
modifier|*
name|callback_baton
parameter_list|,
name|apr_hash_t
modifier|*
name|config
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
return|return
name|svn_ra_open4
argument_list|(
name|session_p
argument_list|,
name|NULL
argument_list|,
name|repos_URL
argument_list|,
name|uuid
argument_list|,
name|callbacks
argument_list|,
name|callback_baton
argument_list|,
name|config
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_open2
parameter_list|(
name|svn_ra_session_t
modifier|*
modifier|*
name|session_p
parameter_list|,
specifier|const
name|char
modifier|*
name|repos_URL
parameter_list|,
specifier|const
name|svn_ra_callbacks2_t
modifier|*
name|callbacks
parameter_list|,
name|void
modifier|*
name|callback_baton
parameter_list|,
name|apr_hash_t
modifier|*
name|config
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
return|return
name|svn_ra_open3
argument_list|(
name|session_p
argument_list|,
name|repos_URL
argument_list|,
name|NULL
argument_list|,
name|callbacks
argument_list|,
name|callback_baton
argument_list|,
name|config
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_open
parameter_list|(
name|svn_ra_session_t
modifier|*
modifier|*
name|session_p
parameter_list|,
specifier|const
name|char
modifier|*
name|repos_URL
parameter_list|,
specifier|const
name|svn_ra_callbacks_t
modifier|*
name|callbacks
parameter_list|,
name|void
modifier|*
name|callback_baton
parameter_list|,
name|apr_hash_t
modifier|*
name|config
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
comment|/* Deprecated function. Copy the contents of the svn_ra_callbacks_t      to a new svn_ra_callbacks2_t and call svn_ra_open2(). */
name|svn_ra_callbacks2_t
modifier|*
name|callbacks2
decl_stmt|;
name|SVN_ERR
argument_list|(
name|svn_ra_create_callbacks
argument_list|(
operator|&
name|callbacks2
argument_list|,
name|pool
argument_list|)
argument_list|)
expr_stmt|;
name|callbacks2
operator|->
name|open_tmp_file
operator|=
name|callbacks
operator|->
name|open_tmp_file
expr_stmt|;
name|callbacks2
operator|->
name|auth_baton
operator|=
name|callbacks
operator|->
name|auth_baton
expr_stmt|;
name|callbacks2
operator|->
name|get_wc_prop
operator|=
name|callbacks
operator|->
name|get_wc_prop
expr_stmt|;
name|callbacks2
operator|->
name|set_wc_prop
operator|=
name|callbacks
operator|->
name|set_wc_prop
expr_stmt|;
name|callbacks2
operator|->
name|push_wc_prop
operator|=
name|callbacks
operator|->
name|push_wc_prop
expr_stmt|;
name|callbacks2
operator|->
name|invalidate_wc_props
operator|=
name|callbacks
operator|->
name|invalidate_wc_props
expr_stmt|;
name|callbacks2
operator|->
name|progress_func
operator|=
name|NULL
expr_stmt|;
name|callbacks2
operator|->
name|progress_baton
operator|=
name|NULL
expr_stmt|;
return|return
name|svn_ra_open2
argument_list|(
name|session_p
argument_list|,
name|repos_URL
argument_list|,
name|callbacks2
argument_list|,
name|callback_baton
argument_list|,
name|config
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_change_rev_prop
parameter_list|(
name|svn_ra_session_t
modifier|*
name|session
parameter_list|,
name|svn_revnum_t
name|rev
parameter_list|,
specifier|const
name|char
modifier|*
name|name
parameter_list|,
specifier|const
name|svn_string_t
modifier|*
name|value
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
return|return
name|svn_ra_change_rev_prop2
argument_list|(
name|session
argument_list|,
name|rev
argument_list|,
name|name
argument_list|,
name|NULL
argument_list|,
name|value
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_get_commit_editor2
parameter_list|(
name|svn_ra_session_t
modifier|*
name|session
parameter_list|,
specifier|const
name|svn_delta_editor_t
modifier|*
modifier|*
name|editor
parameter_list|,
name|void
modifier|*
modifier|*
name|edit_baton
parameter_list|,
specifier|const
name|char
modifier|*
name|log_msg
parameter_list|,
name|svn_commit_callback2_t
name|commit_callback
parameter_list|,
name|void
modifier|*
name|commit_baton
parameter_list|,
name|apr_hash_t
modifier|*
name|lock_tokens
parameter_list|,
name|svn_boolean_t
name|keep_locks
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
name|apr_hash_t
modifier|*
name|revprop_table
init|=
name|apr_hash_make
argument_list|(
name|pool
argument_list|)
decl_stmt|;
if|if
condition|(
name|log_msg
condition|)
name|svn_hash_sets
argument_list|(
name|revprop_table
argument_list|,
name|SVN_PROP_REVISION_LOG
argument_list|,
name|svn_string_create
argument_list|(
name|log_msg
argument_list|,
name|pool
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|svn_ra_get_commit_editor3
argument_list|(
name|session
argument_list|,
name|editor
argument_list|,
name|edit_baton
argument_list|,
name|revprop_table
argument_list|,
name|commit_callback
argument_list|,
name|commit_baton
argument_list|,
name|lock_tokens
argument_list|,
name|keep_locks
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_get_commit_editor
parameter_list|(
name|svn_ra_session_t
modifier|*
name|session
parameter_list|,
specifier|const
name|svn_delta_editor_t
modifier|*
modifier|*
name|editor
parameter_list|,
name|void
modifier|*
modifier|*
name|edit_baton
parameter_list|,
specifier|const
name|char
modifier|*
name|log_msg
parameter_list|,
name|svn_commit_callback_t
name|callback
parameter_list|,
name|void
modifier|*
name|callback_baton
parameter_list|,
name|apr_hash_t
modifier|*
name|lock_tokens
parameter_list|,
name|svn_boolean_t
name|keep_locks
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
name|svn_commit_callback2_t
name|callback2
decl_stmt|;
name|void
modifier|*
name|callback2_baton
decl_stmt|;
name|svn_compat_wrap_commit_callback
argument_list|(
operator|&
name|callback2
argument_list|,
operator|&
name|callback2_baton
argument_list|,
name|callback
argument_list|,
name|callback_baton
argument_list|,
name|pool
argument_list|)
expr_stmt|;
return|return
name|svn_ra_get_commit_editor2
argument_list|(
name|session
argument_list|,
name|editor
argument_list|,
name|edit_baton
argument_list|,
name|log_msg
argument_list|,
name|callback2
argument_list|,
name|callback2_baton
argument_list|,
name|lock_tokens
argument_list|,
name|keep_locks
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_do_diff2
parameter_list|(
name|svn_ra_session_t
modifier|*
name|session
parameter_list|,
specifier|const
name|svn_ra_reporter2_t
modifier|*
modifier|*
name|reporter
parameter_list|,
name|void
modifier|*
modifier|*
name|report_baton
parameter_list|,
name|svn_revnum_t
name|revision
parameter_list|,
specifier|const
name|char
modifier|*
name|diff_target
parameter_list|,
name|svn_boolean_t
name|recurse
parameter_list|,
name|svn_boolean_t
name|ignore_ancestry
parameter_list|,
name|svn_boolean_t
name|text_deltas
parameter_list|,
specifier|const
name|char
modifier|*
name|versus_url
parameter_list|,
specifier|const
name|svn_delta_editor_t
modifier|*
name|diff_editor
parameter_list|,
name|void
modifier|*
name|diff_baton
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
name|struct
name|reporter_3in2_baton
modifier|*
name|b
init|=
name|apr_palloc
argument_list|(
name|pool
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|b
argument_list|)
argument_list|)
decl_stmt|;
name|SVN_ERR_ASSERT
argument_list|(
name|svn_path_is_empty
argument_list|(
name|diff_target
argument_list|)
operator|||
name|svn_path_is_single_path_component
argument_list|(
name|diff_target
argument_list|)
argument_list|)
expr_stmt|;
operator|*
name|reporter
operator|=
operator|&
name|reporter_3in2_wrapper
expr_stmt|;
operator|*
name|report_baton
operator|=
name|b
expr_stmt|;
return|return
name|session
operator|->
name|vtable
operator|->
name|do_diff
argument_list|(
name|session
argument_list|,
operator|&
operator|(
name|b
operator|->
name|reporter3
operator|)
argument_list|,
operator|&
operator|(
name|b
operator|->
name|reporter3_baton
operator|)
argument_list|,
name|revision
argument_list|,
name|diff_target
argument_list|,
name|SVN_DEPTH_INFINITY_OR_FILES
argument_list|(
name|recurse
argument_list|)
argument_list|,
name|ignore_ancestry
argument_list|,
name|text_deltas
argument_list|,
name|versus_url
argument_list|,
name|diff_editor
argument_list|,
name|diff_baton
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_do_diff
parameter_list|(
name|svn_ra_session_t
modifier|*
name|session
parameter_list|,
specifier|const
name|svn_ra_reporter2_t
modifier|*
modifier|*
name|reporter
parameter_list|,
name|void
modifier|*
modifier|*
name|report_baton
parameter_list|,
name|svn_revnum_t
name|revision
parameter_list|,
specifier|const
name|char
modifier|*
name|diff_target
parameter_list|,
name|svn_boolean_t
name|recurse
parameter_list|,
name|svn_boolean_t
name|ignore_ancestry
parameter_list|,
specifier|const
name|char
modifier|*
name|versus_url
parameter_list|,
specifier|const
name|svn_delta_editor_t
modifier|*
name|diff_editor
parameter_list|,
name|void
modifier|*
name|diff_baton
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
name|SVN_ERR_ASSERT
argument_list|(
name|svn_path_is_empty
argument_list|(
name|diff_target
argument_list|)
operator|||
name|svn_path_is_single_path_component
argument_list|(
name|diff_target
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|svn_ra_do_diff2
argument_list|(
name|session
argument_list|,
name|reporter
argument_list|,
name|report_baton
argument_list|,
name|revision
argument_list|,
name|diff_target
argument_list|,
name|recurse
argument_list|,
name|ignore_ancestry
argument_list|,
name|TRUE
argument_list|,
name|versus_url
argument_list|,
name|diff_editor
argument_list|,
name|diff_baton
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_get_log
parameter_list|(
name|svn_ra_session_t
modifier|*
name|session
parameter_list|,
specifier|const
name|apr_array_header_t
modifier|*
name|paths
parameter_list|,
name|svn_revnum_t
name|start
parameter_list|,
name|svn_revnum_t
name|end
parameter_list|,
name|int
name|limit
parameter_list|,
name|svn_boolean_t
name|discover_changed_paths
parameter_list|,
name|svn_boolean_t
name|strict_node_history
parameter_list|,
name|svn_log_message_receiver_t
name|receiver
parameter_list|,
name|void
modifier|*
name|receiver_baton
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
name|svn_log_entry_receiver_t
name|receiver2
decl_stmt|;
name|void
modifier|*
name|receiver2_baton
decl_stmt|;
if|if
condition|(
name|paths
condition|)
block|{
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|paths
operator|->
name|nelts
condition|;
name|i
operator|++
control|)
block|{
specifier|const
name|char
modifier|*
name|path
init|=
name|APR_ARRAY_IDX
argument_list|(
name|paths
argument_list|,
name|i
argument_list|,
specifier|const
name|char
operator|*
argument_list|)
decl_stmt|;
name|SVN_ERR_ASSERT
argument_list|(
operator|*
name|path
operator|!=
literal|'/'
argument_list|)
expr_stmt|;
block|}
block|}
name|svn_compat_wrap_log_receiver
argument_list|(
operator|&
name|receiver2
argument_list|,
operator|&
name|receiver2_baton
argument_list|,
name|receiver
argument_list|,
name|receiver_baton
argument_list|,
name|pool
argument_list|)
expr_stmt|;
return|return
name|svn_ra_get_log2
argument_list|(
name|session
argument_list|,
name|paths
argument_list|,
name|start
argument_list|,
name|end
argument_list|,
name|limit
argument_list|,
name|discover_changed_paths
argument_list|,
name|strict_node_history
argument_list|,
name|FALSE
argument_list|,
name|svn_compat_log_revprops_in
argument_list|(
name|pool
argument_list|)
argument_list|,
name|receiver2
argument_list|,
name|receiver2_baton
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_get_file_revs
parameter_list|(
name|svn_ra_session_t
modifier|*
name|session
parameter_list|,
specifier|const
name|char
modifier|*
name|path
parameter_list|,
name|svn_revnum_t
name|start
parameter_list|,
name|svn_revnum_t
name|end
parameter_list|,
name|svn_ra_file_rev_handler_t
name|handler
parameter_list|,
name|void
modifier|*
name|handler_baton
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
name|svn_file_rev_handler_t
name|handler2
decl_stmt|;
name|void
modifier|*
name|handler2_baton
decl_stmt|;
name|SVN_ERR_ASSERT
argument_list|(
operator|*
name|path
operator|!=
literal|'/'
argument_list|)
expr_stmt|;
name|svn_compat_wrap_file_rev_handler
argument_list|(
operator|&
name|handler2
argument_list|,
operator|&
name|handler2_baton
argument_list|,
name|handler
argument_list|,
name|handler_baton
argument_list|,
name|pool
argument_list|)
expr_stmt|;
return|return
name|svn_ra_get_file_revs2
argument_list|(
name|session
argument_list|,
name|path
argument_list|,
name|start
argument_list|,
name|end
argument_list|,
name|FALSE
argument_list|,
name|handler2
argument_list|,
name|handler2_baton
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_do_update2
parameter_list|(
name|svn_ra_session_t
modifier|*
name|session
parameter_list|,
specifier|const
name|svn_ra_reporter3_t
modifier|*
modifier|*
name|reporter
parameter_list|,
name|void
modifier|*
modifier|*
name|report_baton
parameter_list|,
name|svn_revnum_t
name|revision_to_update_to
parameter_list|,
specifier|const
name|char
modifier|*
name|update_target
parameter_list|,
name|svn_depth_t
name|depth
parameter_list|,
name|svn_boolean_t
name|send_copyfrom_args
parameter_list|,
specifier|const
name|svn_delta_editor_t
modifier|*
name|update_editor
parameter_list|,
name|void
modifier|*
name|update_baton
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
return|return
name|svn_error_trace
argument_list|(
name|svn_ra_do_update3
argument_list|(
name|session
argument_list|,
name|reporter
argument_list|,
name|report_baton
argument_list|,
name|revision_to_update_to
argument_list|,
name|update_target
argument_list|,
name|depth
argument_list|,
name|send_copyfrom_args
argument_list|,
name|FALSE
comment|/* ignore_ancestry */
argument_list|,
name|update_editor
argument_list|,
name|update_baton
argument_list|,
name|pool
argument_list|,
name|pool
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_do_update
parameter_list|(
name|svn_ra_session_t
modifier|*
name|session
parameter_list|,
specifier|const
name|svn_ra_reporter2_t
modifier|*
modifier|*
name|reporter
parameter_list|,
name|void
modifier|*
modifier|*
name|report_baton
parameter_list|,
name|svn_revnum_t
name|revision_to_update_to
parameter_list|,
specifier|const
name|char
modifier|*
name|update_target
parameter_list|,
name|svn_boolean_t
name|recurse
parameter_list|,
specifier|const
name|svn_delta_editor_t
modifier|*
name|update_editor
parameter_list|,
name|void
modifier|*
name|update_baton
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
name|struct
name|reporter_3in2_baton
modifier|*
name|b
init|=
name|apr_palloc
argument_list|(
name|pool
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|b
argument_list|)
argument_list|)
decl_stmt|;
name|SVN_ERR_ASSERT
argument_list|(
name|svn_path_is_empty
argument_list|(
name|update_target
argument_list|)
operator|||
name|svn_path_is_single_path_component
argument_list|(
name|update_target
argument_list|)
argument_list|)
expr_stmt|;
operator|*
name|reporter
operator|=
operator|&
name|reporter_3in2_wrapper
expr_stmt|;
operator|*
name|report_baton
operator|=
name|b
expr_stmt|;
return|return
name|session
operator|->
name|vtable
operator|->
name|do_update
argument_list|(
name|session
argument_list|,
operator|&
operator|(
name|b
operator|->
name|reporter3
operator|)
argument_list|,
operator|&
operator|(
name|b
operator|->
name|reporter3_baton
operator|)
argument_list|,
name|revision_to_update_to
argument_list|,
name|update_target
argument_list|,
name|SVN_DEPTH_INFINITY_OR_FILES
argument_list|(
name|recurse
argument_list|)
argument_list|,
name|FALSE
argument_list|,
comment|/* no copyfrom args */
name|FALSE
comment|/* ignore_ancestry */
argument_list|,
name|update_editor
argument_list|,
name|update_baton
argument_list|,
name|pool
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_do_switch2
parameter_list|(
name|svn_ra_session_t
modifier|*
name|session
parameter_list|,
specifier|const
name|svn_ra_reporter3_t
modifier|*
modifier|*
name|reporter
parameter_list|,
name|void
modifier|*
modifier|*
name|report_baton
parameter_list|,
name|svn_revnum_t
name|revision_to_switch_to
parameter_list|,
specifier|const
name|char
modifier|*
name|switch_target
parameter_list|,
name|svn_depth_t
name|depth
parameter_list|,
specifier|const
name|char
modifier|*
name|switch_url
parameter_list|,
specifier|const
name|svn_delta_editor_t
modifier|*
name|switch_editor
parameter_list|,
name|void
modifier|*
name|switch_baton
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
return|return
name|svn_error_trace
argument_list|(
name|svn_ra_do_switch3
argument_list|(
name|session
argument_list|,
name|reporter
argument_list|,
name|report_baton
argument_list|,
name|revision_to_switch_to
argument_list|,
name|switch_target
argument_list|,
name|depth
argument_list|,
name|switch_url
argument_list|,
name|FALSE
comment|/* send_copyfrom_args */
argument_list|,
name|TRUE
comment|/* ignore_ancestry */
argument_list|,
name|switch_editor
argument_list|,
name|switch_baton
argument_list|,
name|pool
argument_list|,
name|pool
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_do_switch
parameter_list|(
name|svn_ra_session_t
modifier|*
name|session
parameter_list|,
specifier|const
name|svn_ra_reporter2_t
modifier|*
modifier|*
name|reporter
parameter_list|,
name|void
modifier|*
modifier|*
name|report_baton
parameter_list|,
name|svn_revnum_t
name|revision_to_switch_to
parameter_list|,
specifier|const
name|char
modifier|*
name|switch_target
parameter_list|,
name|svn_boolean_t
name|recurse
parameter_list|,
specifier|const
name|char
modifier|*
name|switch_url
parameter_list|,
specifier|const
name|svn_delta_editor_t
modifier|*
name|switch_editor
parameter_list|,
name|void
modifier|*
name|switch_baton
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
name|struct
name|reporter_3in2_baton
modifier|*
name|b
init|=
name|apr_palloc
argument_list|(
name|pool
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|b
argument_list|)
argument_list|)
decl_stmt|;
name|SVN_ERR_ASSERT
argument_list|(
name|svn_path_is_empty
argument_list|(
name|switch_target
argument_list|)
operator|||
name|svn_path_is_single_path_component
argument_list|(
name|switch_target
argument_list|)
argument_list|)
expr_stmt|;
operator|*
name|reporter
operator|=
operator|&
name|reporter_3in2_wrapper
expr_stmt|;
operator|*
name|report_baton
operator|=
name|b
expr_stmt|;
return|return
name|session
operator|->
name|vtable
operator|->
name|do_switch
argument_list|(
name|session
argument_list|,
operator|&
operator|(
name|b
operator|->
name|reporter3
operator|)
argument_list|,
operator|&
operator|(
name|b
operator|->
name|reporter3_baton
operator|)
argument_list|,
name|revision_to_switch_to
argument_list|,
name|switch_target
argument_list|,
name|SVN_DEPTH_INFINITY_OR_FILES
argument_list|(
name|recurse
argument_list|)
argument_list|,
name|switch_url
argument_list|,
name|FALSE
comment|/* send_copyfrom_args */
argument_list|,
name|TRUE
comment|/* ignore_ancestry */
argument_list|,
name|switch_editor
argument_list|,
name|switch_baton
argument_list|,
name|pool
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_do_status
parameter_list|(
name|svn_ra_session_t
modifier|*
name|session
parameter_list|,
specifier|const
name|svn_ra_reporter2_t
modifier|*
modifier|*
name|reporter
parameter_list|,
name|void
modifier|*
modifier|*
name|report_baton
parameter_list|,
specifier|const
name|char
modifier|*
name|status_target
parameter_list|,
name|svn_revnum_t
name|revision
parameter_list|,
name|svn_boolean_t
name|recurse
parameter_list|,
specifier|const
name|svn_delta_editor_t
modifier|*
name|status_editor
parameter_list|,
name|void
modifier|*
name|status_baton
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
name|struct
name|reporter_3in2_baton
modifier|*
name|b
init|=
name|apr_palloc
argument_list|(
name|pool
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|b
argument_list|)
argument_list|)
decl_stmt|;
name|SVN_ERR_ASSERT
argument_list|(
name|svn_path_is_empty
argument_list|(
name|status_target
argument_list|)
operator|||
name|svn_path_is_single_path_component
argument_list|(
name|status_target
argument_list|)
argument_list|)
expr_stmt|;
operator|*
name|reporter
operator|=
operator|&
name|reporter_3in2_wrapper
expr_stmt|;
operator|*
name|report_baton
operator|=
name|b
expr_stmt|;
return|return
name|session
operator|->
name|vtable
operator|->
name|do_status
argument_list|(
name|session
argument_list|,
operator|&
operator|(
name|b
operator|->
name|reporter3
operator|)
argument_list|,
operator|&
operator|(
name|b
operator|->
name|reporter3_baton
operator|)
argument_list|,
name|status_target
argument_list|,
name|revision
argument_list|,
name|SVN_DEPTH_INFINITY_OR_IMMEDIATES
argument_list|(
name|recurse
argument_list|)
argument_list|,
name|status_editor
argument_list|,
name|status_baton
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_get_dir
parameter_list|(
name|svn_ra_session_t
modifier|*
name|session
parameter_list|,
specifier|const
name|char
modifier|*
name|path
parameter_list|,
name|svn_revnum_t
name|revision
parameter_list|,
name|apr_hash_t
modifier|*
modifier|*
name|dirents
parameter_list|,
name|svn_revnum_t
modifier|*
name|fetched_rev
parameter_list|,
name|apr_hash_t
modifier|*
modifier|*
name|props
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|)
block|{
name|SVN_ERR_ASSERT
argument_list|(
operator|*
name|path
operator|!=
literal|'/'
argument_list|)
expr_stmt|;
return|return
name|session
operator|->
name|vtable
operator|->
name|get_dir
argument_list|(
name|session
argument_list|,
name|dirents
argument_list|,
name|fetched_rev
argument_list|,
name|props
argument_list|,
name|path
argument_list|,
name|revision
argument_list|,
name|SVN_DIRENT_ALL
argument_list|,
name|pool
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_local__deprecated_init
parameter_list|(
name|int
name|abi_version
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|,
name|apr_hash_t
modifier|*
name|hash
parameter_list|)
block|{
return|return
name|svn_error_trace
argument_list|(
name|svn_ra_local_init
argument_list|(
name|abi_version
argument_list|,
name|pool
argument_list|,
name|hash
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_svn__deprecated_init
parameter_list|(
name|int
name|abi_version
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|,
name|apr_hash_t
modifier|*
name|hash
parameter_list|)
block|{
return|return
name|svn_error_trace
argument_list|(
name|svn_ra_svn_init
argument_list|(
name|abi_version
argument_list|,
name|pool
argument_list|,
name|hash
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
name|svn_error_t
modifier|*
name|svn_ra_serf__deprecated_init
parameter_list|(
name|int
name|abi_version
parameter_list|,
name|apr_pool_t
modifier|*
name|pool
parameter_list|,
name|apr_hash_t
modifier|*
name|hash
parameter_list|)
block|{
return|return
name|svn_error_trace
argument_list|(
name|svn_ra_serf_init
argument_list|(
name|abi_version
argument_list|,
name|pool
argument_list|,
name|hash
argument_list|)
argument_list|)
return|;
block|}
end_function

end_unit

