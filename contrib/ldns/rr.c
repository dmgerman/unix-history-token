begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* rr.c  *  * access functions for ldns_rr -  * a Net::DNS like library for C  * LibDNS Team @ NLnet Labs  *  * (c) NLnet Labs, 2004-2006  * See the file LICENSE for the license  */
end_comment

begin_include
include|#
directive|include
file|<ldns/config.h>
end_include

begin_include
include|#
directive|include
file|<ldns/ldns.h>
end_include

begin_include
include|#
directive|include
file|<strings.h>
end_include

begin_include
include|#
directive|include
file|<limits.h>
end_include

begin_include
include|#
directive|include
file|<errno.h>
end_include

begin_define
define|#
directive|define
name|LDNS_SYNTAX_DATALEN
value|16
end_define

begin_define
define|#
directive|define
name|LDNS_TTL_DATALEN
value|21
end_define

begin_define
define|#
directive|define
name|LDNS_RRLIST_INIT
value|8
end_define

begin_function
name|ldns_rr
modifier|*
name|ldns_rr_new
parameter_list|(
name|void
parameter_list|)
block|{
name|ldns_rr
modifier|*
name|rr
decl_stmt|;
name|rr
operator|=
name|LDNS_MALLOC
argument_list|(
name|ldns_rr
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|rr
condition|)
block|{
return|return
name|NULL
return|;
block|}
name|ldns_rr_set_owner
argument_list|(
name|rr
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|ldns_rr_set_question
argument_list|(
name|rr
argument_list|,
name|false
argument_list|)
expr_stmt|;
name|ldns_rr_set_rd_count
argument_list|(
name|rr
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|rr
operator|->
name|_rdata_fields
operator|=
name|NULL
expr_stmt|;
name|ldns_rr_set_class
argument_list|(
name|rr
argument_list|,
name|LDNS_RR_CLASS_IN
argument_list|)
expr_stmt|;
name|ldns_rr_set_ttl
argument_list|(
name|rr
argument_list|,
name|LDNS_DEFAULT_TTL
argument_list|)
expr_stmt|;
return|return
name|rr
return|;
block|}
end_function

begin_function
name|ldns_rr
modifier|*
name|ldns_rr_new_frm_type
parameter_list|(
name|ldns_rr_type
name|t
parameter_list|)
block|{
name|ldns_rr
modifier|*
name|rr
decl_stmt|;
specifier|const
name|ldns_rr_descriptor
modifier|*
name|desc
decl_stmt|;
name|size_t
name|i
decl_stmt|;
name|rr
operator|=
name|LDNS_MALLOC
argument_list|(
name|ldns_rr
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|rr
condition|)
block|{
return|return
name|NULL
return|;
block|}
name|desc
operator|=
name|ldns_rr_descript
argument_list|(
name|t
argument_list|)
expr_stmt|;
name|rr
operator|->
name|_rdata_fields
operator|=
name|LDNS_XMALLOC
argument_list|(
name|ldns_rdf
operator|*
argument_list|,
name|ldns_rr_descriptor_minimum
argument_list|(
name|desc
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|rr
operator|->
name|_rdata_fields
condition|)
block|{
name|LDNS_FREE
argument_list|(
name|rr
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ldns_rr_descriptor_minimum
argument_list|(
name|desc
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
name|rr
operator|->
name|_rdata_fields
index|[
name|i
index|]
operator|=
name|NULL
expr_stmt|;
block|}
name|ldns_rr_set_owner
argument_list|(
name|rr
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|ldns_rr_set_question
argument_list|(
name|rr
argument_list|,
name|false
argument_list|)
expr_stmt|;
comment|/* set the count to minimum */
name|ldns_rr_set_rd_count
argument_list|(
name|rr
argument_list|,
name|ldns_rr_descriptor_minimum
argument_list|(
name|desc
argument_list|)
argument_list|)
expr_stmt|;
name|ldns_rr_set_class
argument_list|(
name|rr
argument_list|,
name|LDNS_RR_CLASS_IN
argument_list|)
expr_stmt|;
name|ldns_rr_set_ttl
argument_list|(
name|rr
argument_list|,
name|LDNS_DEFAULT_TTL
argument_list|)
expr_stmt|;
name|ldns_rr_set_type
argument_list|(
name|rr
argument_list|,
name|t
argument_list|)
expr_stmt|;
return|return
name|rr
return|;
block|}
end_function

begin_function
name|void
name|ldns_rr_free
parameter_list|(
name|ldns_rr
modifier|*
name|rr
parameter_list|)
block|{
name|size_t
name|i
decl_stmt|;
if|if
condition|(
name|rr
condition|)
block|{
if|if
condition|(
name|ldns_rr_owner
argument_list|(
name|rr
argument_list|)
condition|)
block|{
name|ldns_rdf_deep_free
argument_list|(
name|ldns_rr_owner
argument_list|(
name|rr
argument_list|)
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ldns_rr_rd_count
argument_list|(
name|rr
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
name|ldns_rdf_deep_free
argument_list|(
name|ldns_rr_rdf
argument_list|(
name|rr
argument_list|,
name|i
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|LDNS_FREE
argument_list|(
name|rr
operator|->
name|_rdata_fields
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rr
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*  * trailing spaces are allowed  * leading spaces are not allowed  * allow ttl to be optional  * class is optional too  * if ttl is missing, and default_ttl is 0, use DEF_TTL  * allow ttl to be written as 1d3h  * So the RR should look like. e.g.  * miek.nl. 3600 IN MX 10 elektron.atoom.net  * or  * miek.nl. 1h IN MX 10 elektron.atoom.net  * or  * miek.nl. IN MX 10 elektron.atoom.net  */
end_comment

begin_function
specifier|static
name|ldns_status
name|ldns_rr_new_frm_str_internal
parameter_list|(
name|ldns_rr
modifier|*
modifier|*
name|newrr
parameter_list|,
specifier|const
name|char
modifier|*
name|str
parameter_list|,
name|uint32_t
name|default_ttl
parameter_list|,
name|ldns_rdf
modifier|*
name|origin
parameter_list|,
name|ldns_rdf
modifier|*
modifier|*
name|prev
parameter_list|,
name|bool
name|question
parameter_list|)
block|{
name|ldns_rr
modifier|*
name|new
decl_stmt|;
specifier|const
name|ldns_rr_descriptor
modifier|*
name|desc
decl_stmt|;
name|ldns_rr_type
name|rr_type
decl_stmt|;
name|ldns_buffer
modifier|*
name|rr_buf
init|=
name|NULL
decl_stmt|;
name|ldns_buffer
modifier|*
name|rd_buf
init|=
name|NULL
decl_stmt|;
name|uint32_t
name|ttl_val
decl_stmt|;
name|char
modifier|*
name|owner
init|=
name|NULL
decl_stmt|;
name|char
modifier|*
name|ttl
init|=
name|NULL
decl_stmt|;
name|ldns_rr_class
name|clas_val
decl_stmt|;
name|char
modifier|*
name|clas
init|=
name|NULL
decl_stmt|;
name|char
modifier|*
name|type
init|=
name|NULL
decl_stmt|;
name|char
modifier|*
name|rdata
init|=
name|NULL
decl_stmt|;
name|char
modifier|*
name|rd
init|=
name|NULL
decl_stmt|;
name|char
modifier|*
name|b64
init|=
name|NULL
decl_stmt|;
name|size_t
name|rd_strlen
decl_stmt|;
specifier|const
name|char
modifier|*
name|delimiters
decl_stmt|;
name|ssize_t
name|c
decl_stmt|;
name|ldns_rdf
modifier|*
name|owner_dname
decl_stmt|;
specifier|const
name|char
modifier|*
name|endptr
decl_stmt|;
name|int
name|was_unknown_rr_format
init|=
literal|0
decl_stmt|;
name|ldns_status
name|status
init|=
name|LDNS_STATUS_OK
decl_stmt|;
comment|/* used for types with unknown number of rdatas */
name|bool
name|done
decl_stmt|;
name|bool
name|quoted
decl_stmt|;
name|ldns_rdf
modifier|*
name|r
init|=
name|NULL
decl_stmt|;
name|uint16_t
name|r_cnt
decl_stmt|;
name|uint16_t
name|r_min
decl_stmt|;
name|uint16_t
name|r_max
decl_stmt|;
name|size_t
name|pre_data_pos
decl_stmt|;
name|new
operator|=
name|ldns_rr_new
argument_list|()
expr_stmt|;
name|owner
operator|=
name|LDNS_XMALLOC
argument_list|(
name|char
argument_list|,
name|LDNS_MAX_DOMAINLEN
operator|+
literal|1
argument_list|)
expr_stmt|;
name|ttl
operator|=
name|LDNS_XMALLOC
argument_list|(
name|char
argument_list|,
name|LDNS_TTL_DATALEN
argument_list|)
expr_stmt|;
name|clas
operator|=
name|LDNS_XMALLOC
argument_list|(
name|char
argument_list|,
name|LDNS_SYNTAX_DATALEN
argument_list|)
expr_stmt|;
name|rdata
operator|=
name|LDNS_XMALLOC
argument_list|(
name|char
argument_list|,
name|LDNS_MAX_PACKETLEN
operator|+
literal|1
argument_list|)
expr_stmt|;
name|rr_buf
operator|=
name|LDNS_MALLOC
argument_list|(
name|ldns_buffer
argument_list|)
expr_stmt|;
name|rd_buf
operator|=
name|LDNS_MALLOC
argument_list|(
name|ldns_buffer
argument_list|)
expr_stmt|;
name|rd
operator|=
name|LDNS_XMALLOC
argument_list|(
name|char
argument_list|,
name|LDNS_MAX_RDFLEN
argument_list|)
expr_stmt|;
name|b64
operator|=
name|LDNS_XMALLOC
argument_list|(
name|char
argument_list|,
name|LDNS_MAX_RDFLEN
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|new
operator|||
operator|!
name|owner
operator|||
operator|!
name|ttl
operator|||
operator|!
name|clas
operator|||
operator|!
name|rdata
operator|||
operator|!
name|rr_buf
operator|||
operator|!
name|rd_buf
operator|||
operator|!
name|rd
operator|||
operator|!
name|b64
condition|)
block|{
name|status
operator|=
name|LDNS_STATUS_MEM_ERR
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
goto|goto
name|ldnserror
goto|;
block|}
name|ldns_buffer_new_frm_data
argument_list|(
name|rr_buf
argument_list|,
operator|(
name|char
operator|*
operator|)
name|str
argument_list|,
name|strlen
argument_list|(
name|str
argument_list|)
argument_list|)
expr_stmt|;
comment|/* split the rr in its parts -1 signals trouble */
if|if
condition|(
name|ldns_bget_token
argument_list|(
name|rr_buf
argument_list|,
name|owner
argument_list|,
literal|"\t\n "
argument_list|,
name|LDNS_MAX_DOMAINLEN
argument_list|)
operator|==
operator|-
literal|1
condition|)
block|{
name|status
operator|=
name|LDNS_STATUS_SYNTAX_ERR
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
goto|goto
name|ldnserror
goto|;
block|}
if|if
condition|(
name|ldns_bget_token
argument_list|(
name|rr_buf
argument_list|,
name|ttl
argument_list|,
literal|"\t\n "
argument_list|,
name|LDNS_TTL_DATALEN
argument_list|)
operator|==
operator|-
literal|1
condition|)
block|{
name|status
operator|=
name|LDNS_STATUS_SYNTAX_TTL_ERR
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
goto|goto
name|ldnserror
goto|;
block|}
name|ttl_val
operator|=
operator|(
name|uint32_t
operator|)
name|ldns_str2period
argument_list|(
name|ttl
argument_list|,
operator|&
name|endptr
argument_list|)
expr_stmt|;
if|if
condition|(
name|strlen
argument_list|(
name|ttl
argument_list|)
operator|>
literal|0
operator|&&
operator|!
name|isdigit
argument_list|(
operator|(
name|int
operator|)
name|ttl
index|[
literal|0
index|]
argument_list|)
condition|)
block|{
comment|/* ah, it's not there or something */
if|if
condition|(
name|default_ttl
operator|==
literal|0
condition|)
block|{
name|ttl_val
operator|=
name|LDNS_DEFAULT_TTL
expr_stmt|;
block|}
else|else
block|{
name|ttl_val
operator|=
name|default_ttl
expr_stmt|;
block|}
comment|/* we not ASSUMING the TTL is missing and that 		 * the rest of the RR is still there. That is 		 * CLASS TYPE RDATA 		 * so ttl value we read is actually the class 		 */
name|clas_val
operator|=
name|ldns_get_rr_class_by_name
argument_list|(
name|ttl
argument_list|)
expr_stmt|;
comment|/* class can be left out too, assume IN, current 		 * token must be type 		 */
if|if
condition|(
name|clas_val
operator|==
literal|0
condition|)
block|{
name|clas_val
operator|=
name|LDNS_RR_CLASS_IN
expr_stmt|;
name|type
operator|=
name|LDNS_XMALLOC
argument_list|(
name|char
argument_list|,
name|strlen
argument_list|(
name|ttl
argument_list|)
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|type
condition|)
block|{
name|status
operator|=
name|LDNS_STATUS_MEM_ERR
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
goto|goto
name|ldnserror
goto|;
block|}
name|strncpy
argument_list|(
name|type
argument_list|,
name|ttl
argument_list|,
name|strlen
argument_list|(
name|ttl
argument_list|)
operator|+
literal|1
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
if|if
condition|(
name|ldns_bget_token
argument_list|(
name|rr_buf
argument_list|,
name|clas
argument_list|,
literal|"\t\n "
argument_list|,
name|LDNS_SYNTAX_DATALEN
argument_list|)
operator|==
operator|-
literal|1
condition|)
block|{
name|status
operator|=
name|LDNS_STATUS_SYNTAX_CLASS_ERR
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
goto|goto
name|ldnserror
goto|;
block|}
name|clas_val
operator|=
name|ldns_get_rr_class_by_name
argument_list|(
name|clas
argument_list|)
expr_stmt|;
comment|/* class can be left out too, assume IN, current 		 * token must be type 		 */
if|if
condition|(
name|clas_val
operator|==
literal|0
condition|)
block|{
name|clas_val
operator|=
name|LDNS_RR_CLASS_IN
expr_stmt|;
name|type
operator|=
name|LDNS_XMALLOC
argument_list|(
name|char
argument_list|,
name|strlen
argument_list|(
name|clas
argument_list|)
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|type
condition|)
block|{
name|status
operator|=
name|LDNS_STATUS_MEM_ERR
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
goto|goto
name|ldnserror
goto|;
block|}
name|strncpy
argument_list|(
name|type
argument_list|,
name|clas
argument_list|,
name|strlen
argument_list|(
name|clas
argument_list|)
operator|+
literal|1
argument_list|)
expr_stmt|;
block|}
block|}
comment|/* the rest should still be waiting for us */
if|if
condition|(
operator|!
name|type
condition|)
block|{
name|type
operator|=
name|LDNS_XMALLOC
argument_list|(
name|char
argument_list|,
name|LDNS_SYNTAX_DATALEN
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|type
condition|)
block|{
name|status
operator|=
name|LDNS_STATUS_MEM_ERR
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
goto|goto
name|ldnserror
goto|;
block|}
if|if
condition|(
name|ldns_bget_token
argument_list|(
name|rr_buf
argument_list|,
name|type
argument_list|,
literal|"\t\n "
argument_list|,
name|LDNS_SYNTAX_DATALEN
argument_list|)
operator|==
operator|-
literal|1
condition|)
block|{
name|status
operator|=
name|LDNS_STATUS_SYNTAX_TYPE_ERR
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
goto|goto
name|ldnserror
goto|;
block|}
block|}
if|if
condition|(
name|ldns_bget_token
argument_list|(
name|rr_buf
argument_list|,
name|rdata
argument_list|,
literal|"\0"
argument_list|,
name|LDNS_MAX_PACKETLEN
argument_list|)
operator|==
operator|-
literal|1
condition|)
block|{
comment|/* apparently we are done, and it's only a question RR 		 * so do not set status and go to ldnserror here 		*/
block|}
name|ldns_buffer_new_frm_data
argument_list|(
name|rd_buf
argument_list|,
name|rdata
argument_list|,
name|strlen
argument_list|(
name|rdata
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|strlen
argument_list|(
name|owner
argument_list|)
operator|<=
literal|1
operator|&&
name|strncmp
argument_list|(
name|owner
argument_list|,
literal|"@"
argument_list|,
literal|1
argument_list|)
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|origin
condition|)
block|{
name|ldns_rr_set_owner
argument_list|(
name|new
argument_list|,
name|ldns_rdf_clone
argument_list|(
name|origin
argument_list|)
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|prev
operator|&&
operator|*
name|prev
condition|)
block|{
name|ldns_rr_set_owner
argument_list|(
name|new
argument_list|,
name|ldns_rdf_clone
argument_list|(
operator|*
name|prev
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|/* default to root */
name|ldns_rr_set_owner
argument_list|(
name|new
argument_list|,
name|ldns_dname_new_frm_str
argument_list|(
literal|"."
argument_list|)
argument_list|)
expr_stmt|;
block|}
comment|/* @ also overrides prev */
if|if
condition|(
name|prev
condition|)
block|{
name|ldns_rdf_deep_free
argument_list|(
operator|*
name|prev
argument_list|)
expr_stmt|;
operator|*
name|prev
operator|=
name|ldns_rdf_clone
argument_list|(
name|ldns_rr_owner
argument_list|(
name|new
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|*
name|prev
condition|)
block|{
name|status
operator|=
name|LDNS_STATUS_MEM_ERR
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
goto|goto
name|ldnserror
goto|;
block|}
block|}
block|}
else|else
block|{
if|if
condition|(
name|strlen
argument_list|(
name|owner
argument_list|)
operator|==
literal|0
condition|)
block|{
comment|/* no ownername was given, try prev, if that fails 			 * origin, else default to root */
if|if
condition|(
name|prev
operator|&&
operator|*
name|prev
condition|)
block|{
name|ldns_rr_set_owner
argument_list|(
name|new
argument_list|,
name|ldns_rdf_clone
argument_list|(
operator|*
name|prev
argument_list|)
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|origin
condition|)
block|{
name|ldns_rr_set_owner
argument_list|(
name|new
argument_list|,
name|ldns_rdf_clone
argument_list|(
name|origin
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|ldns_rr_set_owner
argument_list|(
name|new
argument_list|,
name|ldns_dname_new_frm_str
argument_list|(
literal|"."
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|ldns_rr_owner
argument_list|(
name|new
argument_list|)
condition|)
block|{
name|status
operator|=
name|LDNS_STATUS_MEM_ERR
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
goto|goto
name|ldnserror
goto|;
block|}
block|}
else|else
block|{
name|owner_dname
operator|=
name|ldns_dname_new_frm_str
argument_list|(
name|owner
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|owner_dname
condition|)
block|{
name|status
operator|=
name|LDNS_STATUS_SYNTAX_ERR
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
goto|goto
name|ldnserror
goto|;
block|}
name|ldns_rr_set_owner
argument_list|(
name|new
argument_list|,
name|owner_dname
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|ldns_dname_str_absolute
argument_list|(
name|owner
argument_list|)
operator|&&
name|origin
condition|)
block|{
if|if
condition|(
name|ldns_dname_cat
argument_list|(
name|ldns_rr_owner
argument_list|(
name|new
argument_list|)
argument_list|,
name|origin
argument_list|)
operator|!=
name|LDNS_STATUS_OK
condition|)
block|{
name|status
operator|=
name|LDNS_STATUS_SYNTAX_ERR
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
goto|goto
name|ldnserror
goto|;
block|}
block|}
if|if
condition|(
name|prev
condition|)
block|{
name|ldns_rdf_deep_free
argument_list|(
operator|*
name|prev
argument_list|)
expr_stmt|;
operator|*
name|prev
operator|=
name|ldns_rdf_clone
argument_list|(
name|ldns_rr_owner
argument_list|(
name|new
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|*
name|prev
condition|)
block|{
name|status
operator|=
name|LDNS_STATUS_MEM_ERR
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
goto|goto
name|ldnserror
goto|;
block|}
block|}
block|}
block|}
name|LDNS_FREE
argument_list|(
name|owner
argument_list|)
expr_stmt|;
name|owner
operator|=
name|NULL
expr_stmt|;
name|ldns_rr_set_question
argument_list|(
name|new
argument_list|,
name|question
argument_list|)
expr_stmt|;
name|ldns_rr_set_ttl
argument_list|(
name|new
argument_list|,
name|ttl_val
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|ttl
argument_list|)
expr_stmt|;
name|ttl
operator|=
name|NULL
expr_stmt|;
name|ldns_rr_set_class
argument_list|(
name|new
argument_list|,
name|clas_val
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|clas
argument_list|)
expr_stmt|;
name|clas
operator|=
name|NULL
expr_stmt|;
name|rr_type
operator|=
name|ldns_get_rr_type_by_name
argument_list|(
name|type
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|type
argument_list|)
expr_stmt|;
name|type
operator|=
name|NULL
expr_stmt|;
name|desc
operator|=
name|ldns_rr_descript
argument_list|(
operator|(
name|uint16_t
operator|)
name|rr_type
argument_list|)
expr_stmt|;
name|ldns_rr_set_type
argument_list|(
name|new
argument_list|,
name|rr_type
argument_list|)
expr_stmt|;
if|if
condition|(
name|desc
condition|)
block|{
comment|/* only the rdata remains */
name|r_max
operator|=
name|ldns_rr_descriptor_maximum
argument_list|(
name|desc
argument_list|)
expr_stmt|;
name|r_min
operator|=
name|ldns_rr_descriptor_minimum
argument_list|(
name|desc
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|r_min
operator|=
literal|0
expr_stmt|;
name|r_max
operator|=
literal|1
expr_stmt|;
block|}
comment|/* depending on the rr_type we need to extract 	 * the rdata differently, e.g. NSEC/NSEC3 */
switch|switch
condition|(
name|rr_type
condition|)
block|{
default|default:
name|done
operator|=
name|false
expr_stmt|;
for|for
control|(
name|r_cnt
operator|=
literal|0
init|;
operator|!
name|done
operator|&&
name|r_cnt
operator|<
name|r_max
condition|;
name|r_cnt
operator|++
control|)
block|{
name|quoted
operator|=
name|false
expr_stmt|;
comment|/* if type = B64, the field may contain spaces */
if|if
condition|(
name|ldns_rr_descriptor_field_type
argument_list|(
name|desc
argument_list|,
name|r_cnt
argument_list|)
operator|==
name|LDNS_RDF_TYPE_B64
operator|||
name|ldns_rr_descriptor_field_type
argument_list|(
name|desc
argument_list|,
name|r_cnt
argument_list|)
operator|==
name|LDNS_RDF_TYPE_HEX
operator|||
name|ldns_rr_descriptor_field_type
argument_list|(
name|desc
argument_list|,
name|r_cnt
argument_list|)
operator|==
name|LDNS_RDF_TYPE_LOC
operator|||
name|ldns_rr_descriptor_field_type
argument_list|(
name|desc
argument_list|,
name|r_cnt
argument_list|)
operator|==
name|LDNS_RDF_TYPE_WKS
operator|||
name|ldns_rr_descriptor_field_type
argument_list|(
name|desc
argument_list|,
name|r_cnt
argument_list|)
operator|==
name|LDNS_RDF_TYPE_IPSECKEY
operator|||
name|ldns_rr_descriptor_field_type
argument_list|(
name|desc
argument_list|,
name|r_cnt
argument_list|)
operator|==
name|LDNS_RDF_TYPE_NSEC
condition|)
block|{
name|delimiters
operator|=
literal|"\n\t"
expr_stmt|;
block|}
else|else
block|{
name|delimiters
operator|=
literal|"\n\t "
expr_stmt|;
block|}
if|if
condition|(
name|ldns_rr_descriptor_field_type
argument_list|(
name|desc
argument_list|,
name|r_cnt
argument_list|)
operator|==
name|LDNS_RDF_TYPE_STR
operator|&&
name|ldns_buffer_remaining
argument_list|(
name|rd_buf
argument_list|)
operator|>
literal|0
condition|)
block|{
comment|/* skip spaces */
while|while
condition|(
operator|*
operator|(
name|ldns_buffer_current
argument_list|(
name|rd_buf
argument_list|)
operator|)
operator|==
literal|' '
condition|)
block|{
name|ldns_buffer_skip
argument_list|(
name|rd_buf
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|*
operator|(
name|ldns_buffer_current
argument_list|(
name|rd_buf
argument_list|)
operator|)
operator|==
literal|'\"'
condition|)
block|{
name|delimiters
operator|=
literal|"\"\0"
expr_stmt|;
name|ldns_buffer_skip
argument_list|(
name|rd_buf
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|quoted
operator|=
name|true
expr_stmt|;
block|}
block|}
comment|/* because number of fields can be variable, we can't 				   rely on _maximum() only */
comment|/* skip spaces */
while|while
condition|(
name|ldns_buffer_position
argument_list|(
name|rd_buf
argument_list|)
operator|<
name|ldns_buffer_limit
argument_list|(
name|rd_buf
argument_list|)
operator|&&
operator|*
operator|(
name|ldns_buffer_current
argument_list|(
name|rd_buf
argument_list|)
operator|)
operator|==
literal|' '
operator|&&
operator|!
name|quoted
condition|)
block|{
name|ldns_buffer_skip
argument_list|(
name|rd_buf
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
name|pre_data_pos
operator|=
name|ldns_buffer_position
argument_list|(
name|rd_buf
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|c
operator|=
name|ldns_bget_token
argument_list|(
name|rd_buf
argument_list|,
name|rd
argument_list|,
name|delimiters
argument_list|,
name|LDNS_MAX_RDFLEN
argument_list|)
operator|)
operator|!=
operator|-
literal|1
condition|)
block|{
comment|/* hmmz, rfc3597 specifies that any type can be represented with 					 * \# method, which can contain spaces... 					 * it does specify size though... 					 */
name|rd_strlen
operator|=
name|strlen
argument_list|(
name|rd
argument_list|)
expr_stmt|;
comment|/* unknown RR data */
if|if
condition|(
name|strncmp
argument_list|(
name|rd
argument_list|,
literal|"\\#"
argument_list|,
literal|2
argument_list|)
operator|==
literal|0
operator|&&
operator|!
name|quoted
operator|&&
operator|(
name|rd_strlen
operator|==
literal|2
operator|||
name|rd
index|[
literal|2
index|]
operator|==
literal|' '
operator|)
condition|)
block|{
name|uint16_t
name|hex_data_size
decl_stmt|;
name|char
modifier|*
name|hex_data_str
decl_stmt|;
name|uint16_t
name|cur_hex_data_size
decl_stmt|;
name|was_unknown_rr_format
operator|=
literal|1
expr_stmt|;
comment|/* go back to before \# and skip it while setting delimiters better */
name|ldns_buffer_set_position
argument_list|(
name|rd_buf
argument_list|,
name|pre_data_pos
argument_list|)
expr_stmt|;
name|delimiters
operator|=
literal|"\n\t "
expr_stmt|;
operator|(
name|void
operator|)
name|ldns_bget_token
argument_list|(
name|rd_buf
argument_list|,
name|rd
argument_list|,
name|delimiters
argument_list|,
name|LDNS_MAX_RDFLEN
argument_list|)
expr_stmt|;
comment|/* read rdata octet length */
name|c
operator|=
name|ldns_bget_token
argument_list|(
name|rd_buf
argument_list|,
name|rd
argument_list|,
name|delimiters
argument_list|,
name|LDNS_MAX_RDFLEN
argument_list|)
expr_stmt|;
if|if
condition|(
name|c
operator|==
operator|-
literal|1
condition|)
block|{
comment|/* something goes very wrong here */
name|LDNS_FREE
argument_list|(
name|rd
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|b64
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rd_buf
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rdata
argument_list|)
expr_stmt|;
name|ldns_rr_free
argument_list|(
name|new
argument_list|)
expr_stmt|;
return|return
name|LDNS_STATUS_SYNTAX_RDATA_ERR
return|;
block|}
name|hex_data_size
operator|=
operator|(
name|uint16_t
operator|)
name|atoi
argument_list|(
name|rd
argument_list|)
expr_stmt|;
comment|/* copy the hex chars into hex str (which is 2 chars per byte) */
name|hex_data_str
operator|=
name|LDNS_XMALLOC
argument_list|(
name|char
argument_list|,
literal|2
operator|*
name|hex_data_size
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|hex_data_str
condition|)
block|{
comment|/* malloc error */
name|LDNS_FREE
argument_list|(
name|rd
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|b64
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rd_buf
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rdata
argument_list|)
expr_stmt|;
name|ldns_rr_free
argument_list|(
name|new
argument_list|)
expr_stmt|;
return|return
name|LDNS_STATUS_SYNTAX_RDATA_ERR
return|;
block|}
name|cur_hex_data_size
operator|=
literal|0
expr_stmt|;
while|while
condition|(
name|cur_hex_data_size
operator|<
literal|2
operator|*
name|hex_data_size
condition|)
block|{
name|c
operator|=
name|ldns_bget_token
argument_list|(
name|rd_buf
argument_list|,
name|rd
argument_list|,
name|delimiters
argument_list|,
name|LDNS_MAX_RDFLEN
argument_list|)
expr_stmt|;
if|if
condition|(
name|c
operator|!=
operator|-
literal|1
condition|)
block|{
name|rd_strlen
operator|=
name|strlen
argument_list|(
name|rd
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|c
operator|==
operator|-
literal|1
operator|||
operator|(
name|size_t
operator|)
name|cur_hex_data_size
operator|+
name|rd_strlen
operator|>
literal|2
operator|*
operator|(
name|size_t
operator|)
name|hex_data_size
condition|)
block|{
name|LDNS_FREE
argument_list|(
name|hex_data_str
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rd
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|b64
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rd_buf
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rdata
argument_list|)
expr_stmt|;
name|ldns_rr_free
argument_list|(
name|new
argument_list|)
expr_stmt|;
return|return
name|LDNS_STATUS_SYNTAX_RDATA_ERR
return|;
block|}
name|strncpy
argument_list|(
name|hex_data_str
operator|+
name|cur_hex_data_size
argument_list|,
name|rd
argument_list|,
name|rd_strlen
argument_list|)
expr_stmt|;
name|cur_hex_data_size
operator|+=
name|rd_strlen
expr_stmt|;
block|}
name|hex_data_str
index|[
name|cur_hex_data_size
index|]
operator|=
literal|'\0'
expr_stmt|;
comment|/* correct the rdf type */
comment|/* if *we* know the type, interpret it as wireformat */
if|if
condition|(
name|desc
condition|)
block|{
name|size_t
name|hex_pos
init|=
literal|0
decl_stmt|;
name|uint8_t
modifier|*
name|hex_data
init|=
name|LDNS_XMALLOC
argument_list|(
name|uint8_t
argument_list|,
name|hex_data_size
operator|+
literal|2
argument_list|)
decl_stmt|;
name|ldns_status
name|s
decl_stmt|;
if|if
condition|(
operator|!
name|hex_data
condition|)
block|{
name|LDNS_FREE
argument_list|(
name|hex_data_str
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rd
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|b64
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rd_buf
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rdata
argument_list|)
expr_stmt|;
name|ldns_rr_free
argument_list|(
name|new
argument_list|)
expr_stmt|;
return|return
name|LDNS_STATUS_MEM_ERR
return|;
block|}
name|ldns_write_uint16
argument_list|(
name|hex_data
argument_list|,
name|hex_data_size
argument_list|)
expr_stmt|;
name|ldns_hexstring_to_data
argument_list|(
name|hex_data
operator|+
literal|2
argument_list|,
name|hex_data_str
argument_list|)
expr_stmt|;
name|s
operator|=
name|ldns_wire2rdf
argument_list|(
name|new
argument_list|,
name|hex_data
argument_list|,
name|hex_data_size
operator|+
literal|2
argument_list|,
operator|&
name|hex_pos
argument_list|)
expr_stmt|;
if|if
condition|(
name|s
operator|!=
name|LDNS_STATUS_OK
condition|)
block|{
name|LDNS_FREE
argument_list|(
name|hex_data_str
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rd
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|b64
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rd_buf
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rdata
argument_list|)
expr_stmt|;
name|ldns_rr_free
argument_list|(
name|new
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|hex_data
argument_list|)
expr_stmt|;
return|return
name|s
return|;
block|}
name|LDNS_FREE
argument_list|(
name|hex_data
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|r
operator|=
name|ldns_rdf_new_frm_str
argument_list|(
name|LDNS_RDF_TYPE_HEX
argument_list|,
name|hex_data_str
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|r
condition|)
block|{
name|LDNS_FREE
argument_list|(
name|hex_data_str
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rd
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|b64
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rd_buf
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rdata
argument_list|)
expr_stmt|;
name|ldns_rr_free
argument_list|(
name|new
argument_list|)
expr_stmt|;
return|return
name|LDNS_STATUS_MEM_ERR
return|;
block|}
name|ldns_rdf_set_type
argument_list|(
name|r
argument_list|,
name|LDNS_RDF_TYPE_UNKNOWN
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|ldns_rr_push_rdf
argument_list|(
name|new
argument_list|,
name|r
argument_list|)
condition|)
block|{
name|LDNS_FREE
argument_list|(
name|hex_data_str
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rd
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|b64
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rd_buf
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rdata
argument_list|)
expr_stmt|;
name|ldns_rr_free
argument_list|(
name|new
argument_list|)
expr_stmt|;
return|return
name|LDNS_STATUS_MEM_ERR
return|;
block|}
block|}
name|LDNS_FREE
argument_list|(
name|hex_data_str
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|/* Normal RR */
switch|switch
condition|(
name|ldns_rr_descriptor_field_type
argument_list|(
name|desc
argument_list|,
name|r_cnt
argument_list|)
condition|)
block|{
case|case
name|LDNS_RDF_TYPE_HEX
case|:
case|case
name|LDNS_RDF_TYPE_B64
case|:
comment|/* can have spaces, and will always be the last 							 * record of the rrdata. Read in the rest */
if|if
condition|(
operator|(
name|c
operator|=
name|ldns_bget_token
argument_list|(
name|rd_buf
argument_list|,
name|b64
argument_list|,
literal|"\n"
argument_list|,
name|LDNS_MAX_RDFLEN
argument_list|)
operator|)
operator|!=
operator|-
literal|1
condition|)
block|{
name|rd
operator|=
name|strncat
argument_list|(
name|rd
argument_list|,
name|b64
argument_list|,
name|LDNS_MAX_RDFLEN
operator|-
name|strlen
argument_list|(
name|rd
argument_list|)
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
name|r
operator|=
name|ldns_rdf_new_frm_str
argument_list|(
name|ldns_rr_descriptor_field_type
argument_list|(
name|desc
argument_list|,
name|r_cnt
argument_list|)
argument_list|,
name|rd
argument_list|)
expr_stmt|;
break|break;
case|case
name|LDNS_RDF_TYPE_DNAME
case|:
name|r
operator|=
name|ldns_rdf_new_frm_str
argument_list|(
name|ldns_rr_descriptor_field_type
argument_list|(
name|desc
argument_list|,
name|r_cnt
argument_list|)
argument_list|,
name|rd
argument_list|)
expr_stmt|;
comment|/* check if the origin should be used or concatenated */
if|if
condition|(
name|r
operator|&&
name|ldns_rdf_size
argument_list|(
name|r
argument_list|)
operator|>
literal|1
operator|&&
name|ldns_rdf_data
argument_list|(
name|r
argument_list|)
index|[
literal|0
index|]
operator|==
literal|1
operator|&&
name|ldns_rdf_data
argument_list|(
name|r
argument_list|)
index|[
literal|1
index|]
operator|==
literal|'@'
condition|)
block|{
name|ldns_rdf_deep_free
argument_list|(
name|r
argument_list|)
expr_stmt|;
if|if
condition|(
name|origin
condition|)
block|{
name|r
operator|=
name|ldns_rdf_clone
argument_list|(
name|origin
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|/* if this is the SOA, use its own owner name */
if|if
condition|(
name|rr_type
operator|==
name|LDNS_RR_TYPE_SOA
condition|)
block|{
name|r
operator|=
name|ldns_rdf_clone
argument_list|(
name|ldns_rr_owner
argument_list|(
name|new
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|r
operator|=
name|ldns_rdf_new_frm_str
argument_list|(
name|LDNS_RDF_TYPE_DNAME
argument_list|,
literal|"."
argument_list|)
expr_stmt|;
block|}
block|}
block|}
elseif|else
if|if
condition|(
name|r
operator|&&
name|rd_strlen
operator|>=
literal|1
operator|&&
operator|!
name|ldns_dname_str_absolute
argument_list|(
name|rd
argument_list|)
operator|&&
name|origin
condition|)
block|{
if|if
condition|(
name|ldns_dname_cat
argument_list|(
name|r
argument_list|,
name|origin
argument_list|)
operator|!=
name|LDNS_STATUS_OK
condition|)
block|{
name|LDNS_FREE
argument_list|(
name|rd
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|b64
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rd_buf
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rdata
argument_list|)
expr_stmt|;
name|ldns_rr_free
argument_list|(
name|new
argument_list|)
expr_stmt|;
return|return
name|LDNS_STATUS_ERR
return|;
block|}
block|}
break|break;
default|default:
name|r
operator|=
name|ldns_rdf_new_frm_str
argument_list|(
name|ldns_rr_descriptor_field_type
argument_list|(
name|desc
argument_list|,
name|r_cnt
argument_list|)
argument_list|,
name|rd
argument_list|)
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|r
condition|)
block|{
name|ldns_rr_push_rdf
argument_list|(
name|new
argument_list|,
name|r
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|LDNS_FREE
argument_list|(
name|rd
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|b64
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rd_buf
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rdata
argument_list|)
expr_stmt|;
name|ldns_rr_free
argument_list|(
name|new
argument_list|)
expr_stmt|;
return|return
name|LDNS_STATUS_SYNTAX_RDATA_ERR
return|;
block|}
block|}
if|if
condition|(
name|quoted
condition|)
block|{
if|if
condition|(
name|ldns_buffer_available
argument_list|(
name|rd_buf
argument_list|,
literal|1
argument_list|)
condition|)
block|{
name|ldns_buffer_skip
argument_list|(
name|rd_buf
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|done
operator|=
name|true
expr_stmt|;
block|}
block|}
block|}
else|else
block|{
name|done
operator|=
name|true
expr_stmt|;
block|}
block|}
block|}
name|LDNS_FREE
argument_list|(
name|rd
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|b64
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rd_buf
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr_buf
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rdata
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|question
operator|&&
name|desc
operator|&&
operator|!
name|was_unknown_rr_format
operator|&&
name|ldns_rr_rd_count
argument_list|(
name|new
argument_list|)
operator|<
name|r_min
condition|)
block|{
name|ldns_rr_free
argument_list|(
name|new
argument_list|)
expr_stmt|;
return|return
name|LDNS_STATUS_SYNTAX_MISSING_VALUE_ERR
return|;
block|}
if|if
condition|(
name|newrr
condition|)
block|{
operator|*
name|newrr
operator|=
name|new
expr_stmt|;
block|}
else|else
block|{
comment|/* Maybe the caller just wanted to see if it would parse? */
name|ldns_rr_free
argument_list|(
name|new
argument_list|)
expr_stmt|;
block|}
return|return
name|LDNS_STATUS_OK
return|;
name|ldnserror
label|:
name|LDNS_FREE
argument_list|(
name|type
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|owner
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|ttl
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|clas
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rdata
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rd
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rd_buf
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|b64
argument_list|)
expr_stmt|;
name|ldns_rr_free
argument_list|(
name|new
argument_list|)
expr_stmt|;
return|return
name|status
return|;
block|}
end_function

begin_function
name|ldns_status
name|ldns_rr_new_frm_str
parameter_list|(
name|ldns_rr
modifier|*
modifier|*
name|newrr
parameter_list|,
specifier|const
name|char
modifier|*
name|str
parameter_list|,
name|uint32_t
name|default_ttl
parameter_list|,
name|ldns_rdf
modifier|*
name|origin
parameter_list|,
name|ldns_rdf
modifier|*
modifier|*
name|prev
parameter_list|)
block|{
return|return
name|ldns_rr_new_frm_str_internal
argument_list|(
name|newrr
argument_list|,
name|str
argument_list|,
name|default_ttl
argument_list|,
name|origin
argument_list|,
name|prev
argument_list|,
name|false
argument_list|)
return|;
block|}
end_function

begin_function
name|ldns_status
name|ldns_rr_new_question_frm_str
parameter_list|(
name|ldns_rr
modifier|*
modifier|*
name|newrr
parameter_list|,
specifier|const
name|char
modifier|*
name|str
parameter_list|,
name|ldns_rdf
modifier|*
name|origin
parameter_list|,
name|ldns_rdf
modifier|*
modifier|*
name|prev
parameter_list|)
block|{
return|return
name|ldns_rr_new_frm_str_internal
argument_list|(
name|newrr
argument_list|,
name|str
argument_list|,
literal|0
argument_list|,
name|origin
argument_list|,
name|prev
argument_list|,
name|true
argument_list|)
return|;
block|}
end_function

begin_function
name|ldns_status
name|ldns_rr_new_frm_fp
parameter_list|(
name|ldns_rr
modifier|*
modifier|*
name|newrr
parameter_list|,
name|FILE
modifier|*
name|fp
parameter_list|,
name|uint32_t
modifier|*
name|ttl
parameter_list|,
name|ldns_rdf
modifier|*
modifier|*
name|origin
parameter_list|,
name|ldns_rdf
modifier|*
modifier|*
name|prev
parameter_list|)
block|{
return|return
name|ldns_rr_new_frm_fp_l
argument_list|(
name|newrr
argument_list|,
name|fp
argument_list|,
name|ttl
argument_list|,
name|origin
argument_list|,
name|prev
argument_list|,
name|NULL
argument_list|)
return|;
block|}
end_function

begin_function
name|ldns_status
name|ldns_rr_new_frm_fp_l
parameter_list|(
name|ldns_rr
modifier|*
modifier|*
name|newrr
parameter_list|,
name|FILE
modifier|*
name|fp
parameter_list|,
name|uint32_t
modifier|*
name|default_ttl
parameter_list|,
name|ldns_rdf
modifier|*
modifier|*
name|origin
parameter_list|,
name|ldns_rdf
modifier|*
modifier|*
name|prev
parameter_list|,
name|int
modifier|*
name|line_nr
parameter_list|)
block|{
name|char
modifier|*
name|line
decl_stmt|;
specifier|const
name|char
modifier|*
name|endptr
decl_stmt|;
comment|/* unused */
name|ldns_rr
modifier|*
name|rr
decl_stmt|;
name|uint32_t
name|ttl
decl_stmt|;
name|ldns_rdf
modifier|*
name|tmp
decl_stmt|;
name|ldns_status
name|s
decl_stmt|;
name|ssize_t
name|size
decl_stmt|;
name|int
name|offset
init|=
literal|0
decl_stmt|;
if|if
condition|(
name|default_ttl
condition|)
block|{
name|ttl
operator|=
operator|*
name|default_ttl
expr_stmt|;
block|}
else|else
block|{
name|ttl
operator|=
literal|0
expr_stmt|;
block|}
name|line
operator|=
name|LDNS_XMALLOC
argument_list|(
name|char
argument_list|,
name|LDNS_MAX_LINELEN
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|line
condition|)
block|{
return|return
name|LDNS_STATUS_MEM_ERR
return|;
block|}
comment|/* read an entire line in from the file */
if|if
condition|(
operator|(
name|size
operator|=
name|ldns_fget_token_l
argument_list|(
name|fp
argument_list|,
name|line
argument_list|,
name|LDNS_PARSE_SKIP_SPACE
argument_list|,
name|LDNS_MAX_LINELEN
argument_list|,
name|line_nr
argument_list|)
operator|)
operator|==
operator|-
literal|1
condition|)
block|{
name|LDNS_FREE
argument_list|(
name|line
argument_list|)
expr_stmt|;
comment|/* if last line was empty, we are now at feof, which is not 		 * always a parse error (happens when for instance last line 		 * was a comment) 		 */
return|return
name|LDNS_STATUS_SYNTAX_ERR
return|;
block|}
comment|/* we can have the situation, where we've read ok, but still got 	 * no bytes to play with, in this case size is 0 	 */
if|if
condition|(
name|size
operator|==
literal|0
condition|)
block|{
name|LDNS_FREE
argument_list|(
name|line
argument_list|)
expr_stmt|;
return|return
name|LDNS_STATUS_SYNTAX_EMPTY
return|;
block|}
if|if
condition|(
name|strncmp
argument_list|(
name|line
argument_list|,
literal|"$ORIGIN"
argument_list|,
literal|7
argument_list|)
operator|==
literal|0
operator|&&
name|isspace
argument_list|(
name|line
index|[
literal|7
index|]
argument_list|)
condition|)
block|{
if|if
condition|(
operator|*
name|origin
condition|)
block|{
name|ldns_rdf_deep_free
argument_list|(
operator|*
name|origin
argument_list|)
expr_stmt|;
operator|*
name|origin
operator|=
name|NULL
expr_stmt|;
block|}
name|offset
operator|=
literal|8
expr_stmt|;
while|while
condition|(
name|isspace
argument_list|(
name|line
index|[
name|offset
index|]
argument_list|)
condition|)
block|{
name|offset
operator|++
expr_stmt|;
block|}
name|tmp
operator|=
name|ldns_rdf_new_frm_str
argument_list|(
name|LDNS_RDF_TYPE_DNAME
argument_list|,
name|line
operator|+
name|offset
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|tmp
condition|)
block|{
comment|/* could not parse what next to $ORIGIN */
name|LDNS_FREE
argument_list|(
name|line
argument_list|)
expr_stmt|;
return|return
name|LDNS_STATUS_SYNTAX_DNAME_ERR
return|;
block|}
operator|*
name|origin
operator|=
name|tmp
expr_stmt|;
name|s
operator|=
name|LDNS_STATUS_SYNTAX_ORIGIN
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|strncmp
argument_list|(
name|line
argument_list|,
literal|"$TTL"
argument_list|,
literal|4
argument_list|)
operator|==
literal|0
operator|&&
name|isspace
argument_list|(
name|line
index|[
literal|4
index|]
argument_list|)
condition|)
block|{
name|offset
operator|=
literal|5
expr_stmt|;
while|while
condition|(
name|isspace
argument_list|(
name|line
index|[
name|offset
index|]
argument_list|)
condition|)
block|{
name|offset
operator|++
expr_stmt|;
block|}
if|if
condition|(
name|default_ttl
condition|)
block|{
operator|*
name|default_ttl
operator|=
name|ldns_str2period
argument_list|(
name|line
operator|+
name|offset
argument_list|,
operator|&
name|endptr
argument_list|)
expr_stmt|;
block|}
name|s
operator|=
name|LDNS_STATUS_SYNTAX_TTL
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|strncmp
argument_list|(
name|line
argument_list|,
literal|"$INCLUDE"
argument_list|,
literal|8
argument_list|)
operator|==
literal|0
condition|)
block|{
name|s
operator|=
name|LDNS_STATUS_SYNTAX_INCLUDE
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|origin
operator|&&
operator|*
name|origin
condition|)
block|{
name|s
operator|=
name|ldns_rr_new_frm_str
argument_list|(
operator|&
name|rr
argument_list|,
operator|(
specifier|const
name|char
operator|*
operator|)
name|line
argument_list|,
name|ttl
argument_list|,
operator|*
name|origin
argument_list|,
name|prev
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|s
operator|=
name|ldns_rr_new_frm_str
argument_list|(
operator|&
name|rr
argument_list|,
operator|(
specifier|const
name|char
operator|*
operator|)
name|line
argument_list|,
name|ttl
argument_list|,
name|NULL
argument_list|,
name|prev
argument_list|)
expr_stmt|;
block|}
block|}
name|LDNS_FREE
argument_list|(
name|line
argument_list|)
expr_stmt|;
if|if
condition|(
name|s
operator|==
name|LDNS_STATUS_OK
condition|)
block|{
if|if
condition|(
name|newrr
condition|)
block|{
operator|*
name|newrr
operator|=
name|rr
expr_stmt|;
block|}
else|else
block|{
comment|/* Just testing if it would parse? */
name|ldns_rr_free
argument_list|(
name|rr
argument_list|)
expr_stmt|;
block|}
block|}
return|return
name|s
return|;
block|}
end_function

begin_function
name|void
name|ldns_rr_set_owner
parameter_list|(
name|ldns_rr
modifier|*
name|rr
parameter_list|,
name|ldns_rdf
modifier|*
name|owner
parameter_list|)
block|{
name|rr
operator|->
name|_owner
operator|=
name|owner
expr_stmt|;
block|}
end_function

begin_function
name|void
name|ldns_rr_set_question
parameter_list|(
name|ldns_rr
modifier|*
name|rr
parameter_list|,
name|bool
name|question
parameter_list|)
block|{
name|rr
operator|->
name|_rr_question
operator|=
name|question
expr_stmt|;
block|}
end_function

begin_function
name|void
name|ldns_rr_set_ttl
parameter_list|(
name|ldns_rr
modifier|*
name|rr
parameter_list|,
name|uint32_t
name|ttl
parameter_list|)
block|{
name|rr
operator|->
name|_ttl
operator|=
name|ttl
expr_stmt|;
block|}
end_function

begin_function
name|void
name|ldns_rr_set_rd_count
parameter_list|(
name|ldns_rr
modifier|*
name|rr
parameter_list|,
name|size_t
name|count
parameter_list|)
block|{
name|rr
operator|->
name|_rd_count
operator|=
name|count
expr_stmt|;
block|}
end_function

begin_function
name|void
name|ldns_rr_set_type
parameter_list|(
name|ldns_rr
modifier|*
name|rr
parameter_list|,
name|ldns_rr_type
name|rr_type
parameter_list|)
block|{
name|rr
operator|->
name|_rr_type
operator|=
name|rr_type
expr_stmt|;
block|}
end_function

begin_function
name|void
name|ldns_rr_set_class
parameter_list|(
name|ldns_rr
modifier|*
name|rr
parameter_list|,
name|ldns_rr_class
name|rr_class
parameter_list|)
block|{
name|rr
operator|->
name|_rr_class
operator|=
name|rr_class
expr_stmt|;
block|}
end_function

begin_function
name|ldns_rdf
modifier|*
name|ldns_rr_set_rdf
parameter_list|(
name|ldns_rr
modifier|*
name|rr
parameter_list|,
specifier|const
name|ldns_rdf
modifier|*
name|f
parameter_list|,
name|size_t
name|position
parameter_list|)
block|{
name|size_t
name|rd_count
decl_stmt|;
name|ldns_rdf
modifier|*
name|pop
decl_stmt|;
name|rd_count
operator|=
name|ldns_rr_rd_count
argument_list|(
name|rr
argument_list|)
expr_stmt|;
if|if
condition|(
name|position
operator|<
name|rd_count
condition|)
block|{
comment|/* dicard the old one */
name|pop
operator|=
name|rr
operator|->
name|_rdata_fields
index|[
name|position
index|]
expr_stmt|;
name|rr
operator|->
name|_rdata_fields
index|[
name|position
index|]
operator|=
operator|(
name|ldns_rdf
operator|*
operator|)
name|f
expr_stmt|;
return|return
name|pop
return|;
block|}
else|else
block|{
return|return
name|NULL
return|;
block|}
block|}
end_function

begin_function
name|bool
name|ldns_rr_push_rdf
parameter_list|(
name|ldns_rr
modifier|*
name|rr
parameter_list|,
specifier|const
name|ldns_rdf
modifier|*
name|f
parameter_list|)
block|{
name|size_t
name|rd_count
decl_stmt|;
name|ldns_rdf
modifier|*
modifier|*
name|rdata_fields
decl_stmt|;
name|rd_count
operator|=
name|ldns_rr_rd_count
argument_list|(
name|rr
argument_list|)
expr_stmt|;
comment|/* grow the array */
name|rdata_fields
operator|=
name|LDNS_XREALLOC
argument_list|(
name|rr
operator|->
name|_rdata_fields
argument_list|,
name|ldns_rdf
operator|*
argument_list|,
name|rd_count
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|rdata_fields
condition|)
block|{
return|return
name|false
return|;
block|}
comment|/* add the new member */
name|rr
operator|->
name|_rdata_fields
operator|=
name|rdata_fields
expr_stmt|;
name|rr
operator|->
name|_rdata_fields
index|[
name|rd_count
index|]
operator|=
operator|(
name|ldns_rdf
operator|*
operator|)
name|f
expr_stmt|;
name|ldns_rr_set_rd_count
argument_list|(
name|rr
argument_list|,
name|rd_count
operator|+
literal|1
argument_list|)
expr_stmt|;
return|return
name|true
return|;
block|}
end_function

begin_function
name|ldns_rdf
modifier|*
name|ldns_rr_pop_rdf
parameter_list|(
name|ldns_rr
modifier|*
name|rr
parameter_list|)
block|{
name|size_t
name|rd_count
decl_stmt|;
name|ldns_rdf
modifier|*
name|pop
decl_stmt|;
name|ldns_rdf
modifier|*
modifier|*
name|newrd
decl_stmt|;
name|rd_count
operator|=
name|ldns_rr_rd_count
argument_list|(
name|rr
argument_list|)
expr_stmt|;
if|if
condition|(
name|rd_count
operator|==
literal|0
condition|)
block|{
return|return
name|NULL
return|;
block|}
name|pop
operator|=
name|rr
operator|->
name|_rdata_fields
index|[
name|rd_count
operator|-
literal|1
index|]
expr_stmt|;
comment|/* try to shrink the array */
if|if
condition|(
name|rd_count
operator|>
literal|1
condition|)
block|{
name|newrd
operator|=
name|LDNS_XREALLOC
argument_list|(
name|rr
operator|->
name|_rdata_fields
argument_list|,
name|ldns_rdf
operator|*
argument_list|,
name|rd_count
operator|-
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|newrd
condition|)
name|rr
operator|->
name|_rdata_fields
operator|=
name|newrd
expr_stmt|;
block|}
else|else
block|{
name|LDNS_FREE
argument_list|(
name|rr
operator|->
name|_rdata_fields
argument_list|)
expr_stmt|;
block|}
name|ldns_rr_set_rd_count
argument_list|(
name|rr
argument_list|,
name|rd_count
operator|-
literal|1
argument_list|)
expr_stmt|;
return|return
name|pop
return|;
block|}
end_function

begin_function
name|ldns_rdf
modifier|*
name|ldns_rr_rdf
parameter_list|(
specifier|const
name|ldns_rr
modifier|*
name|rr
parameter_list|,
name|size_t
name|nr
parameter_list|)
block|{
if|if
condition|(
name|rr
operator|&&
name|nr
operator|<
name|ldns_rr_rd_count
argument_list|(
name|rr
argument_list|)
condition|)
block|{
return|return
name|rr
operator|->
name|_rdata_fields
index|[
name|nr
index|]
return|;
block|}
else|else
block|{
return|return
name|NULL
return|;
block|}
block|}
end_function

begin_function
name|ldns_rdf
modifier|*
name|ldns_rr_owner
parameter_list|(
specifier|const
name|ldns_rr
modifier|*
name|rr
parameter_list|)
block|{
return|return
name|rr
operator|->
name|_owner
return|;
block|}
end_function

begin_function
name|bool
name|ldns_rr_is_question
parameter_list|(
specifier|const
name|ldns_rr
modifier|*
name|rr
parameter_list|)
block|{
return|return
name|rr
operator|->
name|_rr_question
return|;
block|}
end_function

begin_function
name|uint32_t
name|ldns_rr_ttl
parameter_list|(
specifier|const
name|ldns_rr
modifier|*
name|rr
parameter_list|)
block|{
return|return
name|rr
operator|->
name|_ttl
return|;
block|}
end_function

begin_function
name|size_t
name|ldns_rr_rd_count
parameter_list|(
specifier|const
name|ldns_rr
modifier|*
name|rr
parameter_list|)
block|{
return|return
name|rr
operator|->
name|_rd_count
return|;
block|}
end_function

begin_function
name|ldns_rr_type
name|ldns_rr_get_type
parameter_list|(
specifier|const
name|ldns_rr
modifier|*
name|rr
parameter_list|)
block|{
return|return
name|rr
operator|->
name|_rr_type
return|;
block|}
end_function

begin_function
name|ldns_rr_class
name|ldns_rr_get_class
parameter_list|(
specifier|const
name|ldns_rr
modifier|*
name|rr
parameter_list|)
block|{
return|return
name|rr
operator|->
name|_rr_class
return|;
block|}
end_function

begin_comment
comment|/* rr_lists */
end_comment

begin_function
name|size_t
name|ldns_rr_list_rr_count
parameter_list|(
specifier|const
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|)
block|{
if|if
condition|(
name|rr_list
condition|)
block|{
return|return
name|rr_list
operator|->
name|_rr_count
return|;
block|}
else|else
block|{
return|return
literal|0
return|;
block|}
block|}
end_function

begin_function
name|ldns_rr
modifier|*
name|ldns_rr_list_set_rr
parameter_list|(
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|,
specifier|const
name|ldns_rr
modifier|*
name|r
parameter_list|,
name|size_t
name|count
parameter_list|)
block|{
name|ldns_rr
modifier|*
name|old
decl_stmt|;
if|if
condition|(
name|count
operator|>
name|ldns_rr_list_rr_count
argument_list|(
name|rr_list
argument_list|)
condition|)
block|{
return|return
name|NULL
return|;
block|}
name|old
operator|=
name|ldns_rr_list_rr
argument_list|(
name|rr_list
argument_list|,
name|count
argument_list|)
expr_stmt|;
comment|/* overwrite old's pointer */
name|rr_list
operator|->
name|_rrs
index|[
name|count
index|]
operator|=
operator|(
name|ldns_rr
operator|*
operator|)
name|r
expr_stmt|;
return|return
name|old
return|;
block|}
end_function

begin_function
name|void
name|ldns_rr_list_set_rr_count
parameter_list|(
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|,
name|size_t
name|count
parameter_list|)
block|{
name|assert
argument_list|(
name|count
operator|<=
name|rr_list
operator|->
name|_rr_capacity
argument_list|)
expr_stmt|;
name|rr_list
operator|->
name|_rr_count
operator|=
name|count
expr_stmt|;
block|}
end_function

begin_function
name|ldns_rr
modifier|*
name|ldns_rr_list_rr
parameter_list|(
specifier|const
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|,
name|size_t
name|nr
parameter_list|)
block|{
if|if
condition|(
name|nr
operator|<
name|ldns_rr_list_rr_count
argument_list|(
name|rr_list
argument_list|)
condition|)
block|{
return|return
name|rr_list
operator|->
name|_rrs
index|[
name|nr
index|]
return|;
block|}
else|else
block|{
return|return
name|NULL
return|;
block|}
block|}
end_function

begin_function
name|ldns_rr_list
modifier|*
name|ldns_rr_list_new
parameter_list|(
name|void
parameter_list|)
block|{
name|ldns_rr_list
modifier|*
name|rr_list
init|=
name|LDNS_MALLOC
argument_list|(
name|ldns_rr_list
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|rr_list
condition|)
return|return
name|NULL
return|;
name|rr_list
operator|->
name|_rr_count
operator|=
literal|0
expr_stmt|;
name|rr_list
operator|->
name|_rr_capacity
operator|=
literal|0
expr_stmt|;
name|rr_list
operator|->
name|_rrs
operator|=
name|NULL
expr_stmt|;
return|return
name|rr_list
return|;
block|}
end_function

begin_function
name|void
name|ldns_rr_list_free
parameter_list|(
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|)
block|{
if|if
condition|(
name|rr_list
condition|)
block|{
name|LDNS_FREE
argument_list|(
name|rr_list
operator|->
name|_rrs
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rr_list
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|ldns_rr_list_deep_free
parameter_list|(
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|)
block|{
name|size_t
name|i
decl_stmt|;
if|if
condition|(
name|rr_list
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ldns_rr_list_rr_count
argument_list|(
name|rr_list
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
name|ldns_rr_free
argument_list|(
name|ldns_rr_list_rr
argument_list|(
name|rr_list
argument_list|,
name|i
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|LDNS_FREE
argument_list|(
name|rr_list
operator|->
name|_rrs
argument_list|)
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|rr_list
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* add right to left. So we modify *left! */
end_comment

begin_function
name|bool
name|ldns_rr_list_cat
parameter_list|(
name|ldns_rr_list
modifier|*
name|left
parameter_list|,
name|ldns_rr_list
modifier|*
name|right
parameter_list|)
block|{
name|size_t
name|r_rr_count
decl_stmt|;
name|size_t
name|i
decl_stmt|;
if|if
condition|(
operator|!
name|left
condition|)
block|{
return|return
name|false
return|;
block|}
if|if
condition|(
name|right
condition|)
block|{
name|r_rr_count
operator|=
name|ldns_rr_list_rr_count
argument_list|(
name|right
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|r_rr_count
operator|=
literal|0
expr_stmt|;
block|}
comment|/* push right to left */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|r_rr_count
condition|;
name|i
operator|++
control|)
block|{
name|ldns_rr_list_push_rr
argument_list|(
name|left
argument_list|,
name|ldns_rr_list_rr
argument_list|(
name|right
argument_list|,
name|i
argument_list|)
argument_list|)
expr_stmt|;
block|}
return|return
name|true
return|;
block|}
end_function

begin_function
name|ldns_rr_list
modifier|*
name|ldns_rr_list_cat_clone
parameter_list|(
name|ldns_rr_list
modifier|*
name|left
parameter_list|,
name|ldns_rr_list
modifier|*
name|right
parameter_list|)
block|{
name|size_t
name|l_rr_count
decl_stmt|;
name|size_t
name|r_rr_count
decl_stmt|;
name|size_t
name|i
decl_stmt|;
name|ldns_rr_list
modifier|*
name|cat
decl_stmt|;
if|if
condition|(
name|left
condition|)
block|{
name|l_rr_count
operator|=
name|ldns_rr_list_rr_count
argument_list|(
name|left
argument_list|)
expr_stmt|;
block|}
else|else
block|{
return|return
name|ldns_rr_list_clone
argument_list|(
name|right
argument_list|)
return|;
block|}
if|if
condition|(
name|right
condition|)
block|{
name|r_rr_count
operator|=
name|ldns_rr_list_rr_count
argument_list|(
name|right
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|r_rr_count
operator|=
literal|0
expr_stmt|;
block|}
name|cat
operator|=
name|ldns_rr_list_new
argument_list|()
expr_stmt|;
if|if
condition|(
operator|!
name|cat
condition|)
block|{
return|return
name|NULL
return|;
block|}
comment|/* left */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|l_rr_count
condition|;
name|i
operator|++
control|)
block|{
name|ldns_rr_list_push_rr
argument_list|(
name|cat
argument_list|,
name|ldns_rr_clone
argument_list|(
name|ldns_rr_list_rr
argument_list|(
name|left
argument_list|,
name|i
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
comment|/* right */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|r_rr_count
condition|;
name|i
operator|++
control|)
block|{
name|ldns_rr_list_push_rr
argument_list|(
name|cat
argument_list|,
name|ldns_rr_clone
argument_list|(
name|ldns_rr_list_rr
argument_list|(
name|right
argument_list|,
name|i
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
return|return
name|cat
return|;
block|}
end_function

begin_function
name|ldns_rr_list
modifier|*
name|ldns_rr_list_subtype_by_rdf
parameter_list|(
name|ldns_rr_list
modifier|*
name|l
parameter_list|,
name|ldns_rdf
modifier|*
name|r
parameter_list|,
name|size_t
name|pos
parameter_list|)
block|{
name|size_t
name|i
decl_stmt|;
name|ldns_rr_list
modifier|*
name|subtyped
decl_stmt|;
name|ldns_rdf
modifier|*
name|list_rdf
decl_stmt|;
name|subtyped
operator|=
name|ldns_rr_list_new
argument_list|()
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ldns_rr_list_rr_count
argument_list|(
name|l
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
name|list_rdf
operator|=
name|ldns_rr_rdf
argument_list|(
name|ldns_rr_list_rr
argument_list|(
name|l
argument_list|,
name|i
argument_list|)
argument_list|,
name|pos
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|list_rdf
condition|)
block|{
comment|/* pos is too large or any other error */
name|ldns_rr_list_deep_free
argument_list|(
name|subtyped
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
name|ldns_rdf_compare
argument_list|(
name|list_rdf
argument_list|,
name|r
argument_list|)
operator|==
literal|0
condition|)
block|{
comment|/* a match */
name|ldns_rr_list_push_rr
argument_list|(
name|subtyped
argument_list|,
name|ldns_rr_clone
argument_list|(
name|ldns_rr_list_rr
argument_list|(
name|l
argument_list|,
name|i
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|ldns_rr_list_rr_count
argument_list|(
name|subtyped
argument_list|)
operator|>
literal|0
condition|)
block|{
return|return
name|subtyped
return|;
block|}
else|else
block|{
name|ldns_rr_list_free
argument_list|(
name|subtyped
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
block|}
end_function

begin_function
name|bool
name|ldns_rr_list_push_rr
parameter_list|(
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|,
specifier|const
name|ldns_rr
modifier|*
name|rr
parameter_list|)
block|{
name|size_t
name|rr_count
decl_stmt|;
name|size_t
name|cap
decl_stmt|;
name|rr_count
operator|=
name|ldns_rr_list_rr_count
argument_list|(
name|rr_list
argument_list|)
expr_stmt|;
name|cap
operator|=
name|rr_list
operator|->
name|_rr_capacity
expr_stmt|;
comment|/* grow the array */
if|if
condition|(
name|rr_count
operator|+
literal|1
operator|>
name|cap
condition|)
block|{
name|ldns_rr
modifier|*
modifier|*
name|rrs
decl_stmt|;
if|if
condition|(
name|cap
operator|==
literal|0
condition|)
name|cap
operator|=
name|LDNS_RRLIST_INIT
expr_stmt|;
comment|/* initial list size */
else|else
name|cap
operator|*=
literal|2
expr_stmt|;
name|rrs
operator|=
name|LDNS_XREALLOC
argument_list|(
name|rr_list
operator|->
name|_rrs
argument_list|,
name|ldns_rr
operator|*
argument_list|,
name|cap
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|rrs
condition|)
block|{
return|return
name|false
return|;
block|}
name|rr_list
operator|->
name|_rrs
operator|=
name|rrs
expr_stmt|;
name|rr_list
operator|->
name|_rr_capacity
operator|=
name|cap
expr_stmt|;
block|}
comment|/* add the new member */
name|rr_list
operator|->
name|_rrs
index|[
name|rr_count
index|]
operator|=
operator|(
name|ldns_rr
operator|*
operator|)
name|rr
expr_stmt|;
name|ldns_rr_list_set_rr_count
argument_list|(
name|rr_list
argument_list|,
name|rr_count
operator|+
literal|1
argument_list|)
expr_stmt|;
return|return
name|true
return|;
block|}
end_function

begin_function
name|bool
name|ldns_rr_list_push_rr_list
parameter_list|(
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|,
specifier|const
name|ldns_rr_list
modifier|*
name|push_list
parameter_list|)
block|{
name|size_t
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ldns_rr_list_rr_count
argument_list|(
name|push_list
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|ldns_rr_list_push_rr
argument_list|(
name|rr_list
argument_list|,
name|ldns_rr_list_rr
argument_list|(
name|push_list
argument_list|,
name|i
argument_list|)
argument_list|)
condition|)
block|{
return|return
name|false
return|;
block|}
block|}
return|return
name|true
return|;
block|}
end_function

begin_function
name|ldns_rr
modifier|*
name|ldns_rr_list_pop_rr
parameter_list|(
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|)
block|{
name|size_t
name|rr_count
decl_stmt|;
name|size_t
name|cap
decl_stmt|;
name|ldns_rr
modifier|*
name|pop
decl_stmt|;
name|rr_count
operator|=
name|ldns_rr_list_rr_count
argument_list|(
name|rr_list
argument_list|)
expr_stmt|;
if|if
condition|(
name|rr_count
operator|==
literal|0
condition|)
block|{
return|return
name|NULL
return|;
block|}
name|cap
operator|=
name|rr_list
operator|->
name|_rr_capacity
expr_stmt|;
name|pop
operator|=
name|ldns_rr_list_rr
argument_list|(
name|rr_list
argument_list|,
name|rr_count
operator|-
literal|1
argument_list|)
expr_stmt|;
comment|/* shrink the array */
if|if
condition|(
name|cap
operator|>
name|LDNS_RRLIST_INIT
operator|&&
name|rr_count
operator|-
literal|1
operator|<=
name|cap
operator|/
literal|2
condition|)
block|{
name|ldns_rr
modifier|*
modifier|*
name|a
decl_stmt|;
name|cap
operator|/=
literal|2
expr_stmt|;
name|a
operator|=
name|LDNS_XREALLOC
argument_list|(
name|rr_list
operator|->
name|_rrs
argument_list|,
name|ldns_rr
operator|*
argument_list|,
name|cap
argument_list|)
expr_stmt|;
if|if
condition|(
name|a
condition|)
block|{
name|rr_list
operator|->
name|_rrs
operator|=
name|a
expr_stmt|;
name|rr_list
operator|->
name|_rr_capacity
operator|=
name|cap
expr_stmt|;
block|}
block|}
name|ldns_rr_list_set_rr_count
argument_list|(
name|rr_list
argument_list|,
name|rr_count
operator|-
literal|1
argument_list|)
expr_stmt|;
return|return
name|pop
return|;
block|}
end_function

begin_function
name|ldns_rr_list
modifier|*
name|ldns_rr_list_pop_rr_list
parameter_list|(
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|,
name|size_t
name|howmany
parameter_list|)
block|{
comment|/* pop a number of rr's and put them in a rr_list */
name|ldns_rr_list
modifier|*
name|popped
decl_stmt|;
name|ldns_rr
modifier|*
name|p
decl_stmt|;
name|size_t
name|i
init|=
name|howmany
decl_stmt|;
name|popped
operator|=
name|ldns_rr_list_new
argument_list|()
expr_stmt|;
if|if
condition|(
operator|!
name|popped
condition|)
block|{
return|return
name|NULL
return|;
block|}
while|while
condition|(
name|i
operator|>
literal|0
operator|&&
operator|(
name|p
operator|=
name|ldns_rr_list_pop_rr
argument_list|(
name|rr_list
argument_list|)
operator|)
operator|!=
name|NULL
condition|)
block|{
name|ldns_rr_list_push_rr
argument_list|(
name|popped
argument_list|,
name|p
argument_list|)
expr_stmt|;
name|i
operator|--
expr_stmt|;
block|}
if|if
condition|(
name|i
operator|==
name|howmany
condition|)
block|{
comment|/* so i<= 0 */
name|ldns_rr_list_free
argument_list|(
name|popped
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
else|else
block|{
return|return
name|popped
return|;
block|}
block|}
end_function

begin_function
name|bool
name|ldns_rr_list_contains_rr
parameter_list|(
specifier|const
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|,
name|ldns_rr
modifier|*
name|rr
parameter_list|)
block|{
name|size_t
name|i
decl_stmt|;
if|if
condition|(
operator|!
name|rr_list
operator|||
operator|!
name|rr
operator|||
name|ldns_rr_list_rr_count
argument_list|(
name|rr_list
argument_list|)
operator|==
literal|0
condition|)
block|{
return|return
name|false
return|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ldns_rr_list_rr_count
argument_list|(
name|rr_list
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|rr
operator|==
name|ldns_rr_list_rr
argument_list|(
name|rr_list
argument_list|,
name|i
argument_list|)
condition|)
block|{
return|return
name|true
return|;
block|}
elseif|else
if|if
condition|(
name|ldns_rr_compare
argument_list|(
name|rr
argument_list|,
name|ldns_rr_list_rr
argument_list|(
name|rr_list
argument_list|,
name|i
argument_list|)
argument_list|)
operator|==
literal|0
condition|)
block|{
return|return
name|true
return|;
block|}
block|}
return|return
name|false
return|;
block|}
end_function

begin_function
name|bool
name|ldns_is_rrset
parameter_list|(
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|)
block|{
name|ldns_rr_type
name|t
decl_stmt|;
name|ldns_rr_class
name|c
decl_stmt|;
name|ldns_rdf
modifier|*
name|o
decl_stmt|;
name|ldns_rr
modifier|*
name|tmp
decl_stmt|;
name|size_t
name|i
decl_stmt|;
if|if
condition|(
operator|!
name|rr_list
operator|||
name|ldns_rr_list_rr_count
argument_list|(
name|rr_list
argument_list|)
operator|==
literal|0
condition|)
block|{
return|return
name|false
return|;
block|}
name|tmp
operator|=
name|ldns_rr_list_rr
argument_list|(
name|rr_list
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|t
operator|=
name|ldns_rr_get_type
argument_list|(
name|tmp
argument_list|)
expr_stmt|;
name|c
operator|=
name|ldns_rr_get_class
argument_list|(
name|tmp
argument_list|)
expr_stmt|;
name|o
operator|=
name|ldns_rr_owner
argument_list|(
name|tmp
argument_list|)
expr_stmt|;
comment|/* compare these with the rest of the rr_list, start with 1 */
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<
name|ldns_rr_list_rr_count
argument_list|(
name|rr_list
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
name|tmp
operator|=
name|ldns_rr_list_rr
argument_list|(
name|rr_list
argument_list|,
name|i
argument_list|)
expr_stmt|;
if|if
condition|(
name|t
operator|!=
name|ldns_rr_get_type
argument_list|(
name|tmp
argument_list|)
condition|)
block|{
return|return
name|false
return|;
block|}
if|if
condition|(
name|c
operator|!=
name|ldns_rr_get_class
argument_list|(
name|tmp
argument_list|)
condition|)
block|{
return|return
name|false
return|;
block|}
if|if
condition|(
name|ldns_rdf_compare
argument_list|(
name|o
argument_list|,
name|ldns_rr_owner
argument_list|(
name|tmp
argument_list|)
argument_list|)
operator|!=
literal|0
condition|)
block|{
return|return
name|false
return|;
block|}
block|}
return|return
name|true
return|;
block|}
end_function

begin_function
name|bool
name|ldns_rr_set_push_rr
parameter_list|(
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|,
name|ldns_rr
modifier|*
name|rr
parameter_list|)
block|{
name|size_t
name|rr_count
decl_stmt|;
name|size_t
name|i
decl_stmt|;
name|ldns_rr
modifier|*
name|last
decl_stmt|;
name|assert
argument_list|(
name|rr
operator|!=
name|NULL
argument_list|)
expr_stmt|;
name|rr_count
operator|=
name|ldns_rr_list_rr_count
argument_list|(
name|rr_list
argument_list|)
expr_stmt|;
if|if
condition|(
name|rr_count
operator|==
literal|0
condition|)
block|{
comment|/* nothing there, so checking it is 		 * not needed */
return|return
name|ldns_rr_list_push_rr
argument_list|(
name|rr_list
argument_list|,
name|rr
argument_list|)
return|;
block|}
else|else
block|{
comment|/* check with the final rr in the rr_list */
name|last
operator|=
name|ldns_rr_list_rr
argument_list|(
name|rr_list
argument_list|,
name|rr_count
operator|-
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|ldns_rr_get_class
argument_list|(
name|last
argument_list|)
operator|!=
name|ldns_rr_get_class
argument_list|(
name|rr
argument_list|)
condition|)
block|{
return|return
name|false
return|;
block|}
if|if
condition|(
name|ldns_rr_get_type
argument_list|(
name|last
argument_list|)
operator|!=
name|ldns_rr_get_type
argument_list|(
name|rr
argument_list|)
condition|)
block|{
return|return
name|false
return|;
block|}
comment|/* only check if not equal to RRSIG */
if|if
condition|(
name|ldns_rr_get_type
argument_list|(
name|rr
argument_list|)
operator|!=
name|LDNS_RR_TYPE_RRSIG
condition|)
block|{
if|if
condition|(
name|ldns_rr_ttl
argument_list|(
name|last
argument_list|)
operator|!=
name|ldns_rr_ttl
argument_list|(
name|rr
argument_list|)
condition|)
block|{
return|return
name|false
return|;
block|}
block|}
if|if
condition|(
name|ldns_rdf_compare
argument_list|(
name|ldns_rr_owner
argument_list|(
name|last
argument_list|)
argument_list|,
name|ldns_rr_owner
argument_list|(
name|rr
argument_list|)
argument_list|)
operator|!=
literal|0
condition|)
block|{
return|return
name|false
return|;
block|}
comment|/* ok, still alive - check if the rr already 		 * exists - if so, dont' add it */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|rr_count
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|ldns_rr_compare
argument_list|(
name|ldns_rr_list_rr
argument_list|(
name|rr_list
argument_list|,
name|i
argument_list|)
argument_list|,
name|rr
argument_list|)
operator|==
literal|0
condition|)
block|{
return|return
name|false
return|;
block|}
block|}
comment|/* it's safe, push it */
return|return
name|ldns_rr_list_push_rr
argument_list|(
name|rr_list
argument_list|,
name|rr
argument_list|)
return|;
block|}
block|}
end_function

begin_function
name|ldns_rr
modifier|*
name|ldns_rr_set_pop_rr
parameter_list|(
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|)
block|{
return|return
name|ldns_rr_list_pop_rr
argument_list|(
name|rr_list
argument_list|)
return|;
block|}
end_function

begin_function
name|ldns_rr_list
modifier|*
name|ldns_rr_list_pop_rrset
parameter_list|(
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|)
block|{
name|ldns_rr_list
modifier|*
name|rrset
decl_stmt|;
name|ldns_rr
modifier|*
name|last_rr
init|=
name|NULL
decl_stmt|;
name|ldns_rr
modifier|*
name|next_rr
decl_stmt|;
if|if
condition|(
operator|!
name|rr_list
condition|)
block|{
return|return
name|NULL
return|;
block|}
name|rrset
operator|=
name|ldns_rr_list_new
argument_list|()
expr_stmt|;
if|if
condition|(
operator|!
name|last_rr
condition|)
block|{
name|last_rr
operator|=
name|ldns_rr_list_pop_rr
argument_list|(
name|rr_list
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|last_rr
condition|)
block|{
name|ldns_rr_list_free
argument_list|(
name|rrset
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
else|else
block|{
name|ldns_rr_list_push_rr
argument_list|(
name|rrset
argument_list|,
name|last_rr
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|ldns_rr_list_rr_count
argument_list|(
name|rr_list
argument_list|)
operator|>
literal|0
condition|)
block|{
name|next_rr
operator|=
name|ldns_rr_list_rr
argument_list|(
name|rr_list
argument_list|,
name|ldns_rr_list_rr_count
argument_list|(
name|rr_list
argument_list|)
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|next_rr
operator|=
name|NULL
expr_stmt|;
block|}
while|while
condition|(
name|next_rr
condition|)
block|{
if|if
condition|(
name|ldns_rdf_compare
argument_list|(
name|ldns_rr_owner
argument_list|(
name|next_rr
argument_list|)
argument_list|,
name|ldns_rr_owner
argument_list|(
name|last_rr
argument_list|)
argument_list|)
operator|==
literal|0
operator|&&
name|ldns_rr_get_type
argument_list|(
name|next_rr
argument_list|)
operator|==
name|ldns_rr_get_type
argument_list|(
name|last_rr
argument_list|)
operator|&&
name|ldns_rr_get_class
argument_list|(
name|next_rr
argument_list|)
operator|==
name|ldns_rr_get_class
argument_list|(
name|last_rr
argument_list|)
condition|)
block|{
name|ldns_rr_list_push_rr
argument_list|(
name|rrset
argument_list|,
name|ldns_rr_list_pop_rr
argument_list|(
name|rr_list
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|ldns_rr_list_rr_count
argument_list|(
name|rr_list
argument_list|)
operator|>
literal|0
condition|)
block|{
name|last_rr
operator|=
name|next_rr
expr_stmt|;
name|next_rr
operator|=
name|ldns_rr_list_rr
argument_list|(
name|rr_list
argument_list|,
name|ldns_rr_list_rr_count
argument_list|(
name|rr_list
argument_list|)
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|next_rr
operator|=
name|NULL
expr_stmt|;
block|}
block|}
else|else
block|{
name|next_rr
operator|=
name|NULL
expr_stmt|;
block|}
block|}
return|return
name|rrset
return|;
block|}
end_function

begin_function
name|ldns_rr
modifier|*
name|ldns_rr_clone
parameter_list|(
specifier|const
name|ldns_rr
modifier|*
name|rr
parameter_list|)
block|{
name|size_t
name|i
decl_stmt|;
name|ldns_rr
modifier|*
name|new_rr
decl_stmt|;
if|if
condition|(
operator|!
name|rr
condition|)
block|{
return|return
name|NULL
return|;
block|}
name|new_rr
operator|=
name|ldns_rr_new
argument_list|()
expr_stmt|;
if|if
condition|(
operator|!
name|new_rr
condition|)
block|{
return|return
name|NULL
return|;
block|}
if|if
condition|(
name|ldns_rr_owner
argument_list|(
name|rr
argument_list|)
condition|)
block|{
name|ldns_rr_set_owner
argument_list|(
name|new_rr
argument_list|,
name|ldns_rdf_clone
argument_list|(
name|ldns_rr_owner
argument_list|(
name|rr
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|ldns_rr_set_ttl
argument_list|(
name|new_rr
argument_list|,
name|ldns_rr_ttl
argument_list|(
name|rr
argument_list|)
argument_list|)
expr_stmt|;
name|ldns_rr_set_type
argument_list|(
name|new_rr
argument_list|,
name|ldns_rr_get_type
argument_list|(
name|rr
argument_list|)
argument_list|)
expr_stmt|;
name|ldns_rr_set_class
argument_list|(
name|new_rr
argument_list|,
name|ldns_rr_get_class
argument_list|(
name|rr
argument_list|)
argument_list|)
expr_stmt|;
name|ldns_rr_set_question
argument_list|(
name|new_rr
argument_list|,
name|ldns_rr_is_question
argument_list|(
name|rr
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ldns_rr_rd_count
argument_list|(
name|rr
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|ldns_rr_rdf
argument_list|(
name|rr
argument_list|,
name|i
argument_list|)
condition|)
block|{
name|ldns_rr_push_rdf
argument_list|(
name|new_rr
argument_list|,
name|ldns_rdf_clone
argument_list|(
name|ldns_rr_rdf
argument_list|(
name|rr
argument_list|,
name|i
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
return|return
name|new_rr
return|;
block|}
end_function

begin_function
name|ldns_rr_list
modifier|*
name|ldns_rr_list_clone
parameter_list|(
specifier|const
name|ldns_rr_list
modifier|*
name|rrlist
parameter_list|)
block|{
name|size_t
name|i
decl_stmt|;
name|ldns_rr_list
modifier|*
name|new_list
decl_stmt|;
name|ldns_rr
modifier|*
name|r
decl_stmt|;
if|if
condition|(
operator|!
name|rrlist
condition|)
block|{
return|return
name|NULL
return|;
block|}
name|new_list
operator|=
name|ldns_rr_list_new
argument_list|()
expr_stmt|;
if|if
condition|(
operator|!
name|new_list
condition|)
block|{
return|return
name|NULL
return|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ldns_rr_list_rr_count
argument_list|(
name|rrlist
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
name|r
operator|=
name|ldns_rr_clone
argument_list|(
name|ldns_rr_list_rr
argument_list|(
name|rrlist
argument_list|,
name|i
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|r
condition|)
block|{
comment|/* huh, failure in cloning */
name|ldns_rr_list_deep_free
argument_list|(
name|new_list
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|ldns_rr_list_push_rr
argument_list|(
name|new_list
argument_list|,
name|r
argument_list|)
expr_stmt|;
block|}
return|return
name|new_list
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|qsort_schwartz_rr_compare
parameter_list|(
specifier|const
name|void
modifier|*
name|a
parameter_list|,
specifier|const
name|void
modifier|*
name|b
parameter_list|)
block|{
name|int
name|result
init|=
literal|0
decl_stmt|;
name|ldns_rr
modifier|*
name|rr1
decl_stmt|,
modifier|*
name|rr2
decl_stmt|;
name|ldns_buffer
modifier|*
name|rr1_buf
decl_stmt|,
modifier|*
name|rr2_buf
decl_stmt|;
name|struct
name|ldns_schwartzian_compare_struct
modifier|*
name|sa
init|=
operator|*
operator|(
expr|struct
name|ldns_schwartzian_compare_struct
operator|*
operator|*
operator|)
name|a
decl_stmt|;
name|struct
name|ldns_schwartzian_compare_struct
modifier|*
name|sb
init|=
operator|*
operator|(
expr|struct
name|ldns_schwartzian_compare_struct
operator|*
operator|*
operator|)
name|b
decl_stmt|;
comment|/* if we are doing 2wire, we need to do lowercasing on the dname (and maybe on the rdata) 	 * this must be done for comparison only, so we need to have a temp var for both buffers, 	 * which is only used when the transformed object value isn't there yet 	 */
name|ldns_rr
modifier|*
name|canonical_a
decl_stmt|,
modifier|*
name|canonical_b
decl_stmt|;
name|rr1
operator|=
operator|(
name|ldns_rr
operator|*
operator|)
name|sa
operator|->
name|original_object
expr_stmt|;
name|rr2
operator|=
operator|(
name|ldns_rr
operator|*
operator|)
name|sb
operator|->
name|original_object
expr_stmt|;
name|result
operator|=
name|ldns_rr_compare_no_rdata
argument_list|(
name|rr1
argument_list|,
name|rr2
argument_list|)
expr_stmt|;
if|if
condition|(
name|result
operator|==
literal|0
condition|)
block|{
if|if
condition|(
operator|!
name|sa
operator|->
name|transformed_object
condition|)
block|{
name|canonical_a
operator|=
name|ldns_rr_clone
argument_list|(
name|sa
operator|->
name|original_object
argument_list|)
expr_stmt|;
name|ldns_rr2canonical
argument_list|(
name|canonical_a
argument_list|)
expr_stmt|;
name|sa
operator|->
name|transformed_object
operator|=
name|ldns_buffer_new
argument_list|(
name|ldns_rr_uncompressed_size
argument_list|(
name|canonical_a
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|ldns_rr2buffer_wire
argument_list|(
name|sa
operator|->
name|transformed_object
argument_list|,
name|canonical_a
argument_list|,
name|LDNS_SECTION_ANY
argument_list|)
operator|!=
name|LDNS_STATUS_OK
condition|)
block|{
name|ldns_buffer_free
argument_list|(
operator|(
name|ldns_buffer
operator|*
operator|)
name|sa
operator|->
name|transformed_object
argument_list|)
expr_stmt|;
name|sa
operator|->
name|transformed_object
operator|=
name|NULL
expr_stmt|;
name|ldns_rr_free
argument_list|(
name|canonical_a
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
name|ldns_rr_free
argument_list|(
name|canonical_a
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|sb
operator|->
name|transformed_object
condition|)
block|{
name|canonical_b
operator|=
name|ldns_rr_clone
argument_list|(
name|sb
operator|->
name|original_object
argument_list|)
expr_stmt|;
name|ldns_rr2canonical
argument_list|(
name|canonical_b
argument_list|)
expr_stmt|;
name|sb
operator|->
name|transformed_object
operator|=
name|ldns_buffer_new
argument_list|(
name|ldns_rr_uncompressed_size
argument_list|(
name|canonical_b
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|ldns_rr2buffer_wire
argument_list|(
name|sb
operator|->
name|transformed_object
argument_list|,
name|canonical_b
argument_list|,
name|LDNS_SECTION_ANY
argument_list|)
operator|!=
name|LDNS_STATUS_OK
condition|)
block|{
name|ldns_buffer_free
argument_list|(
operator|(
name|ldns_buffer
operator|*
operator|)
name|sa
operator|->
name|transformed_object
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
operator|(
name|ldns_buffer
operator|*
operator|)
name|sb
operator|->
name|transformed_object
argument_list|)
expr_stmt|;
name|sa
operator|->
name|transformed_object
operator|=
name|NULL
expr_stmt|;
name|sb
operator|->
name|transformed_object
operator|=
name|NULL
expr_stmt|;
name|ldns_rr_free
argument_list|(
name|canonical_b
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
name|ldns_rr_free
argument_list|(
name|canonical_b
argument_list|)
expr_stmt|;
block|}
name|rr1_buf
operator|=
operator|(
name|ldns_buffer
operator|*
operator|)
name|sa
operator|->
name|transformed_object
expr_stmt|;
name|rr2_buf
operator|=
operator|(
name|ldns_buffer
operator|*
operator|)
name|sb
operator|->
name|transformed_object
expr_stmt|;
name|result
operator|=
name|ldns_rr_compare_wire
argument_list|(
name|rr1_buf
argument_list|,
name|rr2_buf
argument_list|)
expr_stmt|;
block|}
return|return
name|result
return|;
block|}
end_function

begin_function
name|void
name|ldns_rr_list_sort
parameter_list|(
name|ldns_rr_list
modifier|*
name|unsorted
parameter_list|)
block|{
name|struct
name|ldns_schwartzian_compare_struct
modifier|*
modifier|*
name|sortables
decl_stmt|;
name|size_t
name|item_count
decl_stmt|;
name|size_t
name|i
decl_stmt|;
if|if
condition|(
name|unsorted
condition|)
block|{
name|item_count
operator|=
name|ldns_rr_list_rr_count
argument_list|(
name|unsorted
argument_list|)
expr_stmt|;
name|sortables
operator|=
name|LDNS_XMALLOC
argument_list|(
expr|struct
name|ldns_schwartzian_compare_struct
operator|*
argument_list|,
name|item_count
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|sortables
condition|)
return|return;
comment|/* no way to return error */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|item_count
condition|;
name|i
operator|++
control|)
block|{
name|sortables
index|[
name|i
index|]
operator|=
name|LDNS_XMALLOC
argument_list|(
expr|struct
name|ldns_schwartzian_compare_struct
argument_list|,
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|sortables
index|[
name|i
index|]
condition|)
block|{
comment|/* free the allocated parts */
while|while
condition|(
name|i
operator|>
literal|0
condition|)
block|{
name|i
operator|--
expr_stmt|;
name|LDNS_FREE
argument_list|(
name|sortables
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
comment|/* no way to return error */
name|LDNS_FREE
argument_list|(
name|sortables
argument_list|)
expr_stmt|;
return|return;
block|}
name|sortables
index|[
name|i
index|]
operator|->
name|original_object
operator|=
name|ldns_rr_list_rr
argument_list|(
name|unsorted
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|sortables
index|[
name|i
index|]
operator|->
name|transformed_object
operator|=
name|NULL
expr_stmt|;
block|}
name|qsort
argument_list|(
name|sortables
argument_list|,
name|item_count
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|ldns_schwartzian_compare_struct
operator|*
argument_list|)
argument_list|,
name|qsort_schwartz_rr_compare
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|item_count
condition|;
name|i
operator|++
control|)
block|{
name|unsorted
operator|->
name|_rrs
index|[
name|i
index|]
operator|=
name|sortables
index|[
name|i
index|]
operator|->
name|original_object
expr_stmt|;
if|if
condition|(
name|sortables
index|[
name|i
index|]
operator|->
name|transformed_object
condition|)
block|{
name|ldns_buffer_free
argument_list|(
name|sortables
index|[
name|i
index|]
operator|->
name|transformed_object
argument_list|)
expr_stmt|;
block|}
name|LDNS_FREE
argument_list|(
name|sortables
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
name|LDNS_FREE
argument_list|(
name|sortables
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|int
name|ldns_rr_compare_no_rdata
parameter_list|(
specifier|const
name|ldns_rr
modifier|*
name|rr1
parameter_list|,
specifier|const
name|ldns_rr
modifier|*
name|rr2
parameter_list|)
block|{
name|size_t
name|rr1_len
decl_stmt|;
name|size_t
name|rr2_len
decl_stmt|;
name|size_t
name|offset
decl_stmt|;
name|assert
argument_list|(
name|rr1
operator|!=
name|NULL
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|rr2
operator|!=
name|NULL
argument_list|)
expr_stmt|;
name|rr1_len
operator|=
name|ldns_rr_uncompressed_size
argument_list|(
name|rr1
argument_list|)
expr_stmt|;
name|rr2_len
operator|=
name|ldns_rr_uncompressed_size
argument_list|(
name|rr2
argument_list|)
expr_stmt|;
if|if
condition|(
name|ldns_dname_compare
argument_list|(
name|ldns_rr_owner
argument_list|(
name|rr1
argument_list|)
argument_list|,
name|ldns_rr_owner
argument_list|(
name|rr2
argument_list|)
argument_list|)
operator|<
literal|0
condition|)
block|{
return|return
operator|-
literal|1
return|;
block|}
elseif|else
if|if
condition|(
name|ldns_dname_compare
argument_list|(
name|ldns_rr_owner
argument_list|(
name|rr1
argument_list|)
argument_list|,
name|ldns_rr_owner
argument_list|(
name|rr2
argument_list|)
argument_list|)
operator|>
literal|0
condition|)
block|{
return|return
literal|1
return|;
block|}
comment|/* should return -1 if rr1 comes before rr2, so need to do rr1 - rr2, not rr2 - rr1 */
if|if
condition|(
name|ldns_rr_get_class
argument_list|(
name|rr1
argument_list|)
operator|!=
name|ldns_rr_get_class
argument_list|(
name|rr2
argument_list|)
condition|)
block|{
return|return
name|ldns_rr_get_class
argument_list|(
name|rr1
argument_list|)
operator|-
name|ldns_rr_get_class
argument_list|(
name|rr2
argument_list|)
return|;
block|}
comment|/* should return -1 if rr1 comes before rr2, so need to do rr1 - rr2, not rr2 - rr1 */
if|if
condition|(
name|ldns_rr_get_type
argument_list|(
name|rr1
argument_list|)
operator|!=
name|ldns_rr_get_type
argument_list|(
name|rr2
argument_list|)
condition|)
block|{
return|return
name|ldns_rr_get_type
argument_list|(
name|rr1
argument_list|)
operator|-
name|ldns_rr_get_type
argument_list|(
name|rr2
argument_list|)
return|;
block|}
comment|/* offset is the owername length + ttl + type + class + rdlen == start of wire format rdata */
name|offset
operator|=
name|ldns_rdf_size
argument_list|(
name|ldns_rr_owner
argument_list|(
name|rr1
argument_list|)
argument_list|)
operator|+
literal|4
operator|+
literal|2
operator|+
literal|2
operator|+
literal|2
expr_stmt|;
comment|/* if either record doesn't have any RDATA... */
if|if
condition|(
name|offset
operator|>
name|rr1_len
operator|||
name|offset
operator|>
name|rr2_len
condition|)
block|{
if|if
condition|(
name|rr1_len
operator|==
name|rr2_len
condition|)
block|{
return|return
literal|0
return|;
block|}
return|return
operator|(
operator|(
name|int
operator|)
name|rr2_len
operator|-
operator|(
name|int
operator|)
name|rr1_len
operator|)
return|;
block|}
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|ldns_rr_compare_wire
parameter_list|(
name|ldns_buffer
modifier|*
name|rr1_buf
parameter_list|,
name|ldns_buffer
modifier|*
name|rr2_buf
parameter_list|)
block|{
name|size_t
name|rr1_len
decl_stmt|,
name|rr2_len
decl_stmt|,
name|min_len
decl_stmt|,
name|i
decl_stmt|,
name|offset
decl_stmt|;
name|rr1_len
operator|=
name|ldns_buffer_capacity
argument_list|(
name|rr1_buf
argument_list|)
expr_stmt|;
name|rr2_len
operator|=
name|ldns_buffer_capacity
argument_list|(
name|rr2_buf
argument_list|)
expr_stmt|;
comment|/* jump past dname (checked in earlier part)          * and especially past TTL */
name|offset
operator|=
literal|0
expr_stmt|;
while|while
condition|(
name|offset
operator|<
name|rr1_len
operator|&&
operator|*
name|ldns_buffer_at
argument_list|(
name|rr1_buf
argument_list|,
name|offset
argument_list|)
operator|!=
literal|0
condition|)
block|{
name|offset
operator|+=
operator|*
name|ldns_buffer_at
argument_list|(
name|rr1_buf
argument_list|,
name|offset
argument_list|)
operator|+
literal|1
expr_stmt|;
block|}
comment|/* jump to rdata section (PAST the rdata length field, otherwise            rrs with different lengths might be sorted erroneously */
name|offset
operator|+=
literal|11
expr_stmt|;
name|min_len
operator|=
operator|(
name|rr1_len
operator|<
name|rr2_len
operator|)
condition|?
name|rr1_len
else|:
name|rr2_len
expr_stmt|;
comment|/* Compare RRs RDATA byte for byte. */
for|for
control|(
name|i
operator|=
name|offset
init|;
name|i
operator|<
name|min_len
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
operator|*
name|ldns_buffer_at
argument_list|(
name|rr1_buf
argument_list|,
name|i
argument_list|)
operator|<
operator|*
name|ldns_buffer_at
argument_list|(
name|rr2_buf
argument_list|,
name|i
argument_list|)
condition|)
block|{
return|return
operator|-
literal|1
return|;
block|}
elseif|else
if|if
condition|(
operator|*
name|ldns_buffer_at
argument_list|(
name|rr1_buf
argument_list|,
name|i
argument_list|)
operator|>
operator|*
name|ldns_buffer_at
argument_list|(
name|rr2_buf
argument_list|,
name|i
argument_list|)
condition|)
block|{
return|return
operator|+
literal|1
return|;
block|}
block|}
comment|/* If both RDATAs are the same up to min_len, then the shorter one sorts first. */
if|if
condition|(
name|rr1_len
operator|<
name|rr2_len
condition|)
block|{
return|return
operator|-
literal|1
return|;
block|}
elseif|else
if|if
condition|(
name|rr1_len
operator|>
name|rr2_len
condition|)
block|{
return|return
operator|+
literal|1
return|;
block|}
comment|/* The RDATAs are equal. */
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|ldns_rr_compare
parameter_list|(
specifier|const
name|ldns_rr
modifier|*
name|rr1
parameter_list|,
specifier|const
name|ldns_rr
modifier|*
name|rr2
parameter_list|)
block|{
name|int
name|result
decl_stmt|;
name|size_t
name|rr1_len
decl_stmt|,
name|rr2_len
decl_stmt|;
name|ldns_buffer
modifier|*
name|rr1_buf
decl_stmt|;
name|ldns_buffer
modifier|*
name|rr2_buf
decl_stmt|;
name|result
operator|=
name|ldns_rr_compare_no_rdata
argument_list|(
name|rr1
argument_list|,
name|rr2
argument_list|)
expr_stmt|;
if|if
condition|(
name|result
operator|==
literal|0
condition|)
block|{
name|rr1_len
operator|=
name|ldns_rr_uncompressed_size
argument_list|(
name|rr1
argument_list|)
expr_stmt|;
name|rr2_len
operator|=
name|ldns_rr_uncompressed_size
argument_list|(
name|rr2
argument_list|)
expr_stmt|;
name|rr1_buf
operator|=
name|ldns_buffer_new
argument_list|(
name|rr1_len
argument_list|)
expr_stmt|;
name|rr2_buf
operator|=
name|ldns_buffer_new
argument_list|(
name|rr2_len
argument_list|)
expr_stmt|;
if|if
condition|(
name|ldns_rr2buffer_wire_canonical
argument_list|(
name|rr1_buf
argument_list|,
name|rr1
argument_list|,
name|LDNS_SECTION_ANY
argument_list|)
operator|!=
name|LDNS_STATUS_OK
condition|)
block|{
name|ldns_buffer_free
argument_list|(
name|rr1_buf
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr2_buf
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
name|ldns_rr2buffer_wire_canonical
argument_list|(
name|rr2_buf
argument_list|,
name|rr2
argument_list|,
name|LDNS_SECTION_ANY
argument_list|)
operator|!=
name|LDNS_STATUS_OK
condition|)
block|{
name|ldns_buffer_free
argument_list|(
name|rr1_buf
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr2_buf
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
name|result
operator|=
name|ldns_rr_compare_wire
argument_list|(
name|rr1_buf
argument_list|,
name|rr2_buf
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr1_buf
argument_list|)
expr_stmt|;
name|ldns_buffer_free
argument_list|(
name|rr2_buf
argument_list|)
expr_stmt|;
block|}
return|return
name|result
return|;
block|}
end_function

begin_comment
comment|/* convert dnskey to a ds with the given algorithm,  * then compare the result with the given ds */
end_comment

begin_function
specifier|static
name|int
name|ldns_rr_compare_ds_dnskey
parameter_list|(
name|ldns_rr
modifier|*
name|ds
parameter_list|,
name|ldns_rr
modifier|*
name|dnskey
parameter_list|)
block|{
name|ldns_rr
modifier|*
name|ds_gen
decl_stmt|;
name|bool
name|result
init|=
name|false
decl_stmt|;
name|ldns_hash
name|algo
decl_stmt|;
if|if
condition|(
operator|!
name|dnskey
operator|||
operator|!
name|ds
operator|||
name|ldns_rr_get_type
argument_list|(
name|ds
argument_list|)
operator|!=
name|LDNS_RR_TYPE_DS
operator|||
name|ldns_rr_get_type
argument_list|(
name|dnskey
argument_list|)
operator|!=
name|LDNS_RR_TYPE_DNSKEY
condition|)
block|{
return|return
name|false
return|;
block|}
if|if
condition|(
name|ldns_rr_rdf
argument_list|(
name|ds
argument_list|,
literal|2
argument_list|)
operator|==
name|NULL
condition|)
block|{
return|return
name|false
return|;
block|}
name|algo
operator|=
name|ldns_rdf2native_int8
argument_list|(
name|ldns_rr_rdf
argument_list|(
name|ds
argument_list|,
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|ds_gen
operator|=
name|ldns_key_rr2ds
argument_list|(
name|dnskey
argument_list|,
name|algo
argument_list|)
expr_stmt|;
if|if
condition|(
name|ds_gen
condition|)
block|{
name|result
operator|=
name|ldns_rr_compare
argument_list|(
name|ds
argument_list|,
name|ds_gen
argument_list|)
operator|==
literal|0
expr_stmt|;
name|ldns_rr_free
argument_list|(
name|ds_gen
argument_list|)
expr_stmt|;
block|}
return|return
name|result
return|;
block|}
end_function

begin_function
name|bool
name|ldns_rr_compare_ds
parameter_list|(
specifier|const
name|ldns_rr
modifier|*
name|orr1
parameter_list|,
specifier|const
name|ldns_rr
modifier|*
name|orr2
parameter_list|)
block|{
name|bool
name|result
decl_stmt|;
name|ldns_rr
modifier|*
name|rr1
init|=
name|ldns_rr_clone
argument_list|(
name|orr1
argument_list|)
decl_stmt|;
name|ldns_rr
modifier|*
name|rr2
init|=
name|ldns_rr_clone
argument_list|(
name|orr2
argument_list|)
decl_stmt|;
comment|/* set ttls to zero */
name|ldns_rr_set_ttl
argument_list|(
name|rr1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|ldns_rr_set_ttl
argument_list|(
name|rr2
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|ldns_rr_get_type
argument_list|(
name|rr1
argument_list|)
operator|==
name|LDNS_RR_TYPE_DS
operator|&&
name|ldns_rr_get_type
argument_list|(
name|rr2
argument_list|)
operator|==
name|LDNS_RR_TYPE_DNSKEY
condition|)
block|{
name|result
operator|=
name|ldns_rr_compare_ds_dnskey
argument_list|(
name|rr1
argument_list|,
name|rr2
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|ldns_rr_get_type
argument_list|(
name|rr1
argument_list|)
operator|==
name|LDNS_RR_TYPE_DNSKEY
operator|&&
name|ldns_rr_get_type
argument_list|(
name|rr2
argument_list|)
operator|==
name|LDNS_RR_TYPE_DS
condition|)
block|{
name|result
operator|=
name|ldns_rr_compare_ds_dnskey
argument_list|(
name|rr2
argument_list|,
name|rr1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|result
operator|=
operator|(
name|ldns_rr_compare
argument_list|(
name|rr1
argument_list|,
name|rr2
argument_list|)
operator|==
literal|0
operator|)
expr_stmt|;
block|}
name|ldns_rr_free
argument_list|(
name|rr1
argument_list|)
expr_stmt|;
name|ldns_rr_free
argument_list|(
name|rr2
argument_list|)
expr_stmt|;
return|return
name|result
return|;
block|}
end_function

begin_function
name|int
name|ldns_rr_list_compare
parameter_list|(
specifier|const
name|ldns_rr_list
modifier|*
name|rrl1
parameter_list|,
specifier|const
name|ldns_rr_list
modifier|*
name|rrl2
parameter_list|)
block|{
name|size_t
name|i
init|=
literal|0
decl_stmt|;
name|int
name|rr_cmp
decl_stmt|;
name|assert
argument_list|(
name|rrl1
operator|!=
name|NULL
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|rrl2
operator|!=
name|NULL
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ldns_rr_list_rr_count
argument_list|(
name|rrl1
argument_list|)
operator|&&
name|i
operator|<
name|ldns_rr_list_rr_count
argument_list|(
name|rrl2
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
name|rr_cmp
operator|=
name|ldns_rr_compare
argument_list|(
name|ldns_rr_list_rr
argument_list|(
name|rrl1
argument_list|,
name|i
argument_list|)
argument_list|,
name|ldns_rr_list_rr
argument_list|(
name|rrl2
argument_list|,
name|i
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|rr_cmp
operator|!=
literal|0
condition|)
block|{
return|return
name|rr_cmp
return|;
block|}
block|}
if|if
condition|(
name|i
operator|==
name|ldns_rr_list_rr_count
argument_list|(
name|rrl1
argument_list|)
operator|&&
name|i
operator|!=
name|ldns_rr_list_rr_count
argument_list|(
name|rrl2
argument_list|)
condition|)
block|{
return|return
literal|1
return|;
block|}
elseif|else
if|if
condition|(
name|i
operator|==
name|ldns_rr_list_rr_count
argument_list|(
name|rrl2
argument_list|)
operator|&&
name|i
operator|!=
name|ldns_rr_list_rr_count
argument_list|(
name|rrl1
argument_list|)
condition|)
block|{
return|return
operator|-
literal|1
return|;
block|}
else|else
block|{
return|return
literal|0
return|;
block|}
block|}
end_function

begin_function
name|size_t
name|ldns_rr_uncompressed_size
parameter_list|(
specifier|const
name|ldns_rr
modifier|*
name|r
parameter_list|)
block|{
name|size_t
name|rrsize
decl_stmt|;
name|size_t
name|i
decl_stmt|;
name|rrsize
operator|=
literal|0
expr_stmt|;
comment|/* add all the rdf sizes */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ldns_rr_rd_count
argument_list|(
name|r
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
name|rrsize
operator|+=
name|ldns_rdf_size
argument_list|(
name|ldns_rr_rdf
argument_list|(
name|r
argument_list|,
name|i
argument_list|)
argument_list|)
expr_stmt|;
block|}
comment|/* ownername */
name|rrsize
operator|+=
name|ldns_rdf_size
argument_list|(
name|ldns_rr_owner
argument_list|(
name|r
argument_list|)
argument_list|)
expr_stmt|;
name|rrsize
operator|+=
name|LDNS_RR_OVERHEAD
expr_stmt|;
return|return
name|rrsize
return|;
block|}
end_function

begin_function
name|void
name|ldns_rr2canonical
parameter_list|(
name|ldns_rr
modifier|*
name|rr
parameter_list|)
block|{
name|uint16_t
name|i
decl_stmt|;
if|if
condition|(
operator|!
name|rr
condition|)
block|{
return|return;
block|}
name|ldns_dname2canonical
argument_list|(
name|ldns_rr_owner
argument_list|(
name|rr
argument_list|)
argument_list|)
expr_stmt|;
comment|/* 	 * lowercase the rdata dnames if the rr type is one 	 * of the list in chapter 7 of RFC3597 	 * Also added RRSIG, because a "Signer's Name" should be canonicalized 	 * too. See dnssec-bis-updates-16. We can add it to this list because 	 * the "Signer's Name"  is the only dname type rdata field in a RRSIG. 	 */
switch|switch
condition|(
name|ldns_rr_get_type
argument_list|(
name|rr
argument_list|)
condition|)
block|{
case|case
name|LDNS_RR_TYPE_NS
case|:
case|case
name|LDNS_RR_TYPE_MD
case|:
case|case
name|LDNS_RR_TYPE_MF
case|:
case|case
name|LDNS_RR_TYPE_CNAME
case|:
case|case
name|LDNS_RR_TYPE_SOA
case|:
case|case
name|LDNS_RR_TYPE_MB
case|:
case|case
name|LDNS_RR_TYPE_MG
case|:
case|case
name|LDNS_RR_TYPE_MR
case|:
case|case
name|LDNS_RR_TYPE_PTR
case|:
case|case
name|LDNS_RR_TYPE_MINFO
case|:
case|case
name|LDNS_RR_TYPE_MX
case|:
case|case
name|LDNS_RR_TYPE_RP
case|:
case|case
name|LDNS_RR_TYPE_AFSDB
case|:
case|case
name|LDNS_RR_TYPE_RT
case|:
case|case
name|LDNS_RR_TYPE_SIG
case|:
case|case
name|LDNS_RR_TYPE_PX
case|:
case|case
name|LDNS_RR_TYPE_NXT
case|:
case|case
name|LDNS_RR_TYPE_NAPTR
case|:
case|case
name|LDNS_RR_TYPE_KX
case|:
case|case
name|LDNS_RR_TYPE_SRV
case|:
case|case
name|LDNS_RR_TYPE_DNAME
case|:
case|case
name|LDNS_RR_TYPE_A6
case|:
case|case
name|LDNS_RR_TYPE_RRSIG
case|:
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ldns_rr_rd_count
argument_list|(
name|rr
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
name|ldns_dname2canonical
argument_list|(
name|ldns_rr_rdf
argument_list|(
name|rr
argument_list|,
name|i
argument_list|)
argument_list|)
expr_stmt|;
block|}
return|return;
default|default:
comment|/* do nothing */
return|return;
block|}
block|}
end_function

begin_function
name|void
name|ldns_rr_list2canonical
parameter_list|(
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|)
block|{
name|size_t
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ldns_rr_list_rr_count
argument_list|(
name|rr_list
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
name|ldns_rr2canonical
argument_list|(
name|ldns_rr_list_rr
argument_list|(
name|rr_list
argument_list|,
name|i
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|uint8_t
name|ldns_rr_label_count
parameter_list|(
name|ldns_rr
modifier|*
name|rr
parameter_list|)
block|{
if|if
condition|(
operator|!
name|rr
condition|)
block|{
return|return
literal|0
return|;
block|}
return|return
name|ldns_dname_label_count
argument_list|(
name|ldns_rr_owner
argument_list|(
name|rr
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/** \cond */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_0_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_UNKNOWN
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_a_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_A
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_ns_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_md_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_mf_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_cname_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_soa_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_DNAME
block|,
name|LDNS_RDF_TYPE_DNAME
block|,
name|LDNS_RDF_TYPE_INT32
block|,
name|LDNS_RDF_TYPE_PERIOD
block|,
name|LDNS_RDF_TYPE_PERIOD
block|,
name|LDNS_RDF_TYPE_PERIOD
block|,
name|LDNS_RDF_TYPE_PERIOD
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_mb_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_mg_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_mr_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_wks_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_A
block|,
name|LDNS_RDF_TYPE_WKS
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_ptr_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_hinfo_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_STR
block|,
name|LDNS_RDF_TYPE_STR
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_minfo_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_DNAME
block|,
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_mx_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_rp_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_DNAME
block|,
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_afsdb_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_x25_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_STR
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_isdn_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_STR
block|,
name|LDNS_RDF_TYPE_STR
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_rt_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_nsap_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_NSAP
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_nsap_ptr_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_STR
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_sig_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_TYPE
block|,
name|LDNS_RDF_TYPE_ALG
block|,
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_INT32
block|,
name|LDNS_RDF_TYPE_TIME
block|,
name|LDNS_RDF_TYPE_TIME
block|,
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_DNAME
block|,
name|LDNS_RDF_TYPE_B64
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_key_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_B64
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_px_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_DNAME
block|,
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_gpos_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_STR
block|,
name|LDNS_RDF_TYPE_STR
block|,
name|LDNS_RDF_TYPE_STR
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_aaaa_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_AAAA
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_loc_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_LOC
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_nxt_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_DNAME
block|,
name|LDNS_RDF_TYPE_UNKNOWN
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_eid_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_HEX
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_nimloc_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_HEX
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_srv_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_atma_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_ATMA
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_naptr_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_STR
block|,
name|LDNS_RDF_TYPE_STR
block|,
name|LDNS_RDF_TYPE_STR
block|,
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_kx_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_cert_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_CERT_ALG
block|,
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_ALG
block|,
name|LDNS_RDF_TYPE_B64
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_a6_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_UNKNOWN
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_dname_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_sink_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_B64
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_apl_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_APL
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_ds_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_ALG
block|,
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_HEX
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_sshfp_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_HEX
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_ipseckey_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_IPSECKEY
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_rrsig_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_TYPE
block|,
name|LDNS_RDF_TYPE_ALG
block|,
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_INT32
block|,
name|LDNS_RDF_TYPE_TIME
block|,
name|LDNS_RDF_TYPE_TIME
block|,
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_DNAME
block|,
name|LDNS_RDF_TYPE_B64
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_nsec_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_DNAME
block|,
name|LDNS_RDF_TYPE_NSEC
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_dhcid_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_B64
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_talink_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_DNAME
block|,
name|LDNS_RDF_TYPE_DNAME
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* nsec3 is some vars, followed by same type of data of nsec */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_nsec3_wireformat
index|[]
init|=
block|{
comment|/*	LDNS_RDF_TYPE_NSEC3_VARS, LDNS_RDF_TYPE_NSEC3_NEXT_OWNER, LDNS_RDF_TYPE_NSEC*/
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_NSEC3_SALT
block|,
name|LDNS_RDF_TYPE_NSEC3_NEXT_OWNER
block|,
name|LDNS_RDF_TYPE_NSEC
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_nsec3param_wireformat
index|[]
init|=
block|{
comment|/*	LDNS_RDF_TYPE_NSEC3_PARAMS_VARS*/
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_NSEC3_SALT
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_dnskey_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_ALG
block|,
name|LDNS_RDF_TYPE_B64
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_tsig_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_DNAME
block|,
name|LDNS_RDF_TYPE_TSIGTIME
block|,
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_INT16_DATA
block|,
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_INT16
block|,
name|LDNS_RDF_TYPE_INT16_DATA
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|ldns_rdf_type
name|type_tlsa_wireformat
index|[]
init|=
block|{
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_INT8
block|,
name|LDNS_RDF_TYPE_HEX
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/** \endcond */
end_comment

begin_comment
comment|/** \cond */
end_comment

begin_comment
comment|/* All RR's defined in 1035 are well known and can thus  * be compressed. See RFC3597. These RR's are:  * CNAME HINFO MB MD MF MG MINFO MR MX NULL NS PTR SOA TXT  */
end_comment

begin_decl_stmt
specifier|static
name|ldns_rr_descriptor
name|rdata_field_descriptors
index|[]
init|=
block|{
comment|/* 0 */
block|{
literal|0
block|,
name|NULL
block|,
literal|0
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 1 */
block|{
name|LDNS_RR_TYPE_A
block|,
literal|"A"
block|,
literal|1
block|,
literal|1
block|,
name|type_a_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 2 */
block|{
name|LDNS_RR_TYPE_NS
block|,
literal|"NS"
block|,
literal|1
block|,
literal|1
block|,
name|type_ns_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 3 */
block|{
name|LDNS_RR_TYPE_MD
block|,
literal|"MD"
block|,
literal|1
block|,
literal|1
block|,
name|type_md_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 4 */
block|{
name|LDNS_RR_TYPE_MF
block|,
literal|"MF"
block|,
literal|1
block|,
literal|1
block|,
name|type_mf_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 5 */
block|{
name|LDNS_RR_TYPE_CNAME
block|,
literal|"CNAME"
block|,
literal|1
block|,
literal|1
block|,
name|type_cname_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 6 */
block|{
name|LDNS_RR_TYPE_SOA
block|,
literal|"SOA"
block|,
literal|7
block|,
literal|7
block|,
name|type_soa_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_COMPRESS
block|,
literal|2
block|}
block|,
comment|/* 7 */
block|{
name|LDNS_RR_TYPE_MB
block|,
literal|"MB"
block|,
literal|1
block|,
literal|1
block|,
name|type_mb_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 8 */
block|{
name|LDNS_RR_TYPE_MG
block|,
literal|"MG"
block|,
literal|1
block|,
literal|1
block|,
name|type_mg_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 9 */
block|{
name|LDNS_RR_TYPE_MR
block|,
literal|"MR"
block|,
literal|1
block|,
literal|1
block|,
name|type_mr_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 10 */
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"NULL"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 11 */
block|{
name|LDNS_RR_TYPE_WKS
block|,
literal|"WKS"
block|,
literal|2
block|,
literal|2
block|,
name|type_wks_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 12 */
block|{
name|LDNS_RR_TYPE_PTR
block|,
literal|"PTR"
block|,
literal|1
block|,
literal|1
block|,
name|type_ptr_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 13 */
block|{
name|LDNS_RR_TYPE_HINFO
block|,
literal|"HINFO"
block|,
literal|2
block|,
literal|2
block|,
name|type_hinfo_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 14 */
block|{
name|LDNS_RR_TYPE_MINFO
block|,
literal|"MINFO"
block|,
literal|2
block|,
literal|2
block|,
name|type_minfo_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_COMPRESS
block|,
literal|2
block|}
block|,
comment|/* 15 */
block|{
name|LDNS_RR_TYPE_MX
block|,
literal|"MX"
block|,
literal|2
block|,
literal|2
block|,
name|type_mx_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 16 */
block|{
name|LDNS_RR_TYPE_TXT
block|,
literal|"TXT"
block|,
literal|1
block|,
literal|0
block|,
name|NULL
block|,
name|LDNS_RDF_TYPE_STR
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 17 */
block|{
name|LDNS_RR_TYPE_RP
block|,
literal|"RP"
block|,
literal|2
block|,
literal|2
block|,
name|type_rp_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|2
block|}
block|,
comment|/* 18 */
block|{
name|LDNS_RR_TYPE_AFSDB
block|,
literal|"AFSDB"
block|,
literal|2
block|,
literal|2
block|,
name|type_afsdb_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 19 */
block|{
name|LDNS_RR_TYPE_X25
block|,
literal|"X25"
block|,
literal|1
block|,
literal|1
block|,
name|type_x25_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 20 */
block|{
name|LDNS_RR_TYPE_ISDN
block|,
literal|"ISDN"
block|,
literal|1
block|,
literal|2
block|,
name|type_isdn_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 21 */
block|{
name|LDNS_RR_TYPE_RT
block|,
literal|"RT"
block|,
literal|2
block|,
literal|2
block|,
name|type_rt_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 22 */
block|{
name|LDNS_RR_TYPE_NSAP
block|,
literal|"NSAP"
block|,
literal|1
block|,
literal|1
block|,
name|type_nsap_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 23 */
block|{
name|LDNS_RR_TYPE_NSAP_PTR
block|,
literal|"NSAP-PTR"
block|,
literal|1
block|,
literal|1
block|,
name|type_nsap_ptr_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 24 */
block|{
name|LDNS_RR_TYPE_SIG
block|,
literal|"SIG"
block|,
literal|9
block|,
literal|9
block|,
name|type_sig_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 25 */
block|{
name|LDNS_RR_TYPE_KEY
block|,
literal|"KEY"
block|,
literal|4
block|,
literal|4
block|,
name|type_key_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 26 */
block|{
name|LDNS_RR_TYPE_PX
block|,
literal|"PX"
block|,
literal|3
block|,
literal|3
block|,
name|type_px_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|2
block|}
block|,
comment|/* 27 */
block|{
name|LDNS_RR_TYPE_GPOS
block|,
literal|"GPOS"
block|,
literal|1
block|,
literal|1
block|,
name|type_gpos_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 28 */
block|{
name|LDNS_RR_TYPE_AAAA
block|,
literal|"AAAA"
block|,
literal|1
block|,
literal|1
block|,
name|type_aaaa_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 29 */
block|{
name|LDNS_RR_TYPE_LOC
block|,
literal|"LOC"
block|,
literal|1
block|,
literal|1
block|,
name|type_loc_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 30 */
block|{
name|LDNS_RR_TYPE_NXT
block|,
literal|"NXT"
block|,
literal|2
block|,
literal|2
block|,
name|type_nxt_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 31 */
block|{
name|LDNS_RR_TYPE_EID
block|,
literal|"EID"
block|,
literal|1
block|,
literal|1
block|,
name|type_eid_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 32 */
block|{
name|LDNS_RR_TYPE_NIMLOC
block|,
literal|"NIMLOC"
block|,
literal|1
block|,
literal|1
block|,
name|type_nimloc_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 33 */
block|{
name|LDNS_RR_TYPE_SRV
block|,
literal|"SRV"
block|,
literal|4
block|,
literal|4
block|,
name|type_srv_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 34 */
block|{
name|LDNS_RR_TYPE_ATMA
block|,
literal|"ATMA"
block|,
literal|1
block|,
literal|1
block|,
name|type_atma_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 35 */
block|{
name|LDNS_RR_TYPE_NAPTR
block|,
literal|"NAPTR"
block|,
literal|6
block|,
literal|6
block|,
name|type_naptr_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 36 */
block|{
name|LDNS_RR_TYPE_KX
block|,
literal|"KX"
block|,
literal|2
block|,
literal|2
block|,
name|type_kx_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 37 */
block|{
name|LDNS_RR_TYPE_CERT
block|,
literal|"CERT"
block|,
literal|4
block|,
literal|4
block|,
name|type_cert_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 38 */
block|{
name|LDNS_RR_TYPE_A6
block|,
literal|"A6"
block|,
literal|1
block|,
literal|1
block|,
name|type_a6_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 39 */
block|{
name|LDNS_RR_TYPE_DNAME
block|,
literal|"DNAME"
block|,
literal|1
block|,
literal|1
block|,
name|type_dname_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 40 */
block|{
name|LDNS_RR_TYPE_SINK
block|,
literal|"SINK"
block|,
literal|1
block|,
literal|1
block|,
name|type_sink_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 41 */
block|{
name|LDNS_RR_TYPE_OPT
block|,
literal|"OPT"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 42 */
block|{
name|LDNS_RR_TYPE_APL
block|,
literal|"APL"
block|,
literal|0
block|,
literal|0
block|,
name|type_apl_wireformat
block|,
name|LDNS_RDF_TYPE_APL
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 43 */
block|{
name|LDNS_RR_TYPE_DS
block|,
literal|"DS"
block|,
literal|4
block|,
literal|4
block|,
name|type_ds_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 44 */
block|{
name|LDNS_RR_TYPE_SSHFP
block|,
literal|"SSHFP"
block|,
literal|3
block|,
literal|3
block|,
name|type_sshfp_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 45 */
block|{
name|LDNS_RR_TYPE_IPSECKEY
block|,
literal|"IPSECKEY"
block|,
literal|1
block|,
literal|1
block|,
name|type_ipseckey_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 46 */
block|{
name|LDNS_RR_TYPE_RRSIG
block|,
literal|"RRSIG"
block|,
literal|9
block|,
literal|9
block|,
name|type_rrsig_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 47 */
block|{
name|LDNS_RR_TYPE_NSEC
block|,
literal|"NSEC"
block|,
literal|1
block|,
literal|2
block|,
name|type_nsec_wireformat
block|,
name|LDNS_RDF_TYPE_NSEC
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|1
block|}
block|,
comment|/* 48 */
block|{
name|LDNS_RR_TYPE_DNSKEY
block|,
literal|"DNSKEY"
block|,
literal|4
block|,
literal|4
block|,
name|type_dnskey_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 49 */
block|{
name|LDNS_RR_TYPE_DHCID
block|,
literal|"DHCID"
block|,
literal|1
block|,
literal|1
block|,
name|type_dhcid_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 50 */
block|{
name|LDNS_RR_TYPE_NSEC3
block|,
literal|"NSEC3"
block|,
literal|5
block|,
literal|6
block|,
name|type_nsec3_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 51 */
block|{
name|LDNS_RR_TYPE_NSEC3PARAM
block|,
literal|"NSEC3PARAM"
block|,
literal|4
block|,
literal|4
block|,
name|type_nsec3param_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 52 */
block|{
name|LDNS_RR_TYPE_TLSA
block|,
literal|"TLSA"
block|,
literal|4
block|,
literal|4
block|,
name|type_tlsa_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE53"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE54"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE55"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE56"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE57"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* 58 */
block|{
name|LDNS_RR_TYPE_TALINK
block|,
literal|"TALINK"
block|,
literal|2
block|,
literal|2
block|,
name|type_talink_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|2
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE59"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE60"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE61"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE62"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE63"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE64"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE65"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE66"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE67"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE68"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE69"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE70"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE71"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE72"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE73"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE74"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE75"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE76"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE77"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE78"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE79"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE80"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE81"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE82"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE83"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE84"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE85"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE86"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE87"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE88"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE89"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE90"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE91"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE92"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE93"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE94"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE95"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE96"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE97"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE98"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_SPF
block|,
literal|"SPF"
block|,
literal|1
block|,
literal|0
block|,
name|NULL
block|,
name|LDNS_RDF_TYPE_STR
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE100"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE101"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE102"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE103"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE104"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE105"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE106"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE107"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE108"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE109"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE110"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE111"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE112"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE113"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE114"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE115"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE116"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE117"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE118"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE119"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE120"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE121"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE122"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE123"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE124"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE125"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE126"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE127"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE128"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE129"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE130"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE131"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE132"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE133"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE134"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE135"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE136"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE137"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE138"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE139"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE140"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE141"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE142"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE143"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE144"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE145"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE146"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE147"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE148"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE149"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE150"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE151"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE152"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE153"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE154"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE155"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE156"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE157"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE158"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE159"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE160"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE161"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE162"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE163"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE164"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE165"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE166"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE167"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE168"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE169"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE170"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE171"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE172"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE173"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE174"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE175"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE176"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE177"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE178"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE179"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE180"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE181"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE182"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE183"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE184"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE185"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE186"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE187"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE188"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE189"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE190"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE191"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE192"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE193"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE194"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE195"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE196"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE197"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE198"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE199"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE200"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE201"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE202"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE203"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE204"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE205"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE206"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE207"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE208"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE209"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE210"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE211"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE212"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE213"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE214"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE215"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE216"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE217"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE218"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE219"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE220"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE221"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE222"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE223"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE224"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE225"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE226"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE227"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE228"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE229"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE230"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE231"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE232"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE233"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE234"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE235"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE236"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE237"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE238"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE239"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE240"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE241"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE242"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE243"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE244"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE245"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE246"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE247"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE248"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
block|{
name|LDNS_RR_TYPE_NULL
block|,
literal|"TYPE249"
block|,
literal|1
block|,
literal|1
block|,
name|type_0_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* LDNS_RDF_TYPE_INT16_DATA essentially takes two fields (length and data) and  * makes them into one. So, while in rfc 2845 is specified that a TSIG may have   * 8 or 9 rdata fields, by this implementation, the min/max are 7 each.   */
block|{
name|LDNS_RR_TYPE_TSIG
block|,
literal|"TSIG"
block|,
literal|7
block|,
literal|7
block|,
name|type_tsig_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|,
comment|/* split in array, no longer contiguous */
block|{
name|LDNS_RR_TYPE_DLV
block|,
literal|"DLV"
block|,
literal|4
block|,
literal|4
block|,
name|type_ds_wireformat
block|,
name|LDNS_RDF_TYPE_NONE
block|,
name|LDNS_RR_NO_COMPRESS
block|,
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/** \endcond */
end_comment

begin_comment
comment|/**  * \def LDNS_RDATA_FIELD_DESCRIPTORS_COUNT  * computes the number of rdata fields  */
end_comment

begin_define
define|#
directive|define
name|LDNS_RDATA_FIELD_DESCRIPTORS_COUNT
define|\
value|(sizeof(rdata_field_descriptors)/sizeof(rdata_field_descriptors[0]))
end_define

begin_function
specifier|const
name|ldns_rr_descriptor
modifier|*
name|ldns_rr_descript
parameter_list|(
name|uint16_t
name|type
parameter_list|)
block|{
name|size_t
name|i
decl_stmt|;
if|if
condition|(
name|type
operator|<=
name|LDNS_RDATA_FIELD_DESCRIPTORS_COMMON
condition|)
block|{
return|return
operator|&
name|rdata_field_descriptors
index|[
name|type
index|]
return|;
block|}
else|else
block|{
comment|/* because not all array index equals type code */
for|for
control|(
name|i
operator|=
name|LDNS_RDATA_FIELD_DESCRIPTORS_COMMON
init|;
name|i
operator|<
name|LDNS_RDATA_FIELD_DESCRIPTORS_COUNT
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|rdata_field_descriptors
index|[
name|i
index|]
operator|.
name|_type
operator|==
name|type
condition|)
block|{
return|return
operator|&
name|rdata_field_descriptors
index|[
name|i
index|]
return|;
block|}
block|}
return|return
operator|&
name|rdata_field_descriptors
index|[
literal|0
index|]
return|;
block|}
block|}
end_function

begin_function
name|size_t
name|ldns_rr_descriptor_minimum
parameter_list|(
specifier|const
name|ldns_rr_descriptor
modifier|*
name|descriptor
parameter_list|)
block|{
if|if
condition|(
name|descriptor
condition|)
block|{
return|return
name|descriptor
operator|->
name|_minimum
return|;
block|}
else|else
block|{
return|return
literal|0
return|;
block|}
block|}
end_function

begin_function
name|size_t
name|ldns_rr_descriptor_maximum
parameter_list|(
specifier|const
name|ldns_rr_descriptor
modifier|*
name|descriptor
parameter_list|)
block|{
if|if
condition|(
name|descriptor
condition|)
block|{
if|if
condition|(
name|descriptor
operator|->
name|_variable
operator|!=
name|LDNS_RDF_TYPE_NONE
condition|)
block|{
comment|/* Should really be SIZE_MAX... bad FreeBSD.  */
return|return
name|UINT_MAX
return|;
block|}
else|else
block|{
return|return
name|descriptor
operator|->
name|_maximum
return|;
block|}
block|}
else|else
block|{
return|return
literal|0
return|;
block|}
block|}
end_function

begin_function
name|ldns_rdf_type
name|ldns_rr_descriptor_field_type
parameter_list|(
specifier|const
name|ldns_rr_descriptor
modifier|*
name|descriptor
parameter_list|,
name|size_t
name|index
parameter_list|)
block|{
name|assert
argument_list|(
name|descriptor
operator|!=
name|NULL
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|index
operator|<
name|descriptor
operator|->
name|_maximum
operator|||
name|descriptor
operator|->
name|_variable
operator|!=
name|LDNS_RDF_TYPE_NONE
argument_list|)
expr_stmt|;
if|if
condition|(
name|index
operator|<
name|descriptor
operator|->
name|_maximum
condition|)
block|{
return|return
name|descriptor
operator|->
name|_wireformat
index|[
name|index
index|]
return|;
block|}
else|else
block|{
return|return
name|descriptor
operator|->
name|_variable
return|;
block|}
block|}
end_function

begin_function
name|ldns_rr_type
name|ldns_get_rr_type_by_name
parameter_list|(
specifier|const
name|char
modifier|*
name|name
parameter_list|)
block|{
name|unsigned
name|int
name|i
decl_stmt|;
specifier|const
name|char
modifier|*
name|desc_name
decl_stmt|;
specifier|const
name|ldns_rr_descriptor
modifier|*
name|desc
decl_stmt|;
comment|/* TYPEXX representation */
if|if
condition|(
name|strlen
argument_list|(
name|name
argument_list|)
operator|>
literal|4
operator|&&
name|strncasecmp
argument_list|(
name|name
argument_list|,
literal|"TYPE"
argument_list|,
literal|4
argument_list|)
operator|==
literal|0
condition|)
block|{
return|return
name|atoi
argument_list|(
name|name
operator|+
literal|4
argument_list|)
return|;
block|}
comment|/* Normal types */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
operator|(
name|unsigned
name|int
operator|)
name|LDNS_RDATA_FIELD_DESCRIPTORS_COUNT
condition|;
name|i
operator|++
control|)
block|{
name|desc
operator|=
operator|&
name|rdata_field_descriptors
index|[
name|i
index|]
expr_stmt|;
name|desc_name
operator|=
name|desc
operator|->
name|_name
expr_stmt|;
if|if
condition|(
name|desc_name
operator|&&
name|strlen
argument_list|(
name|name
argument_list|)
operator|==
name|strlen
argument_list|(
name|desc_name
argument_list|)
operator|&&
name|strncasecmp
argument_list|(
name|name
argument_list|,
name|desc_name
argument_list|,
name|strlen
argument_list|(
name|desc_name
argument_list|)
argument_list|)
operator|==
literal|0
condition|)
block|{
comment|/* because not all array index equals type code */
return|return
name|desc
operator|->
name|_type
return|;
block|}
block|}
comment|/* special cases for query types */
if|if
condition|(
name|strlen
argument_list|(
name|name
argument_list|)
operator|==
literal|4
operator|&&
name|strncasecmp
argument_list|(
name|name
argument_list|,
literal|"IXFR"
argument_list|,
literal|4
argument_list|)
operator|==
literal|0
condition|)
block|{
return|return
literal|251
return|;
block|}
elseif|else
if|if
condition|(
name|strlen
argument_list|(
name|name
argument_list|)
operator|==
literal|4
operator|&&
name|strncasecmp
argument_list|(
name|name
argument_list|,
literal|"AXFR"
argument_list|,
literal|4
argument_list|)
operator|==
literal|0
condition|)
block|{
return|return
literal|252
return|;
block|}
elseif|else
if|if
condition|(
name|strlen
argument_list|(
name|name
argument_list|)
operator|==
literal|5
operator|&&
name|strncasecmp
argument_list|(
name|name
argument_list|,
literal|"MAILB"
argument_list|,
literal|5
argument_list|)
operator|==
literal|0
condition|)
block|{
return|return
literal|253
return|;
block|}
elseif|else
if|if
condition|(
name|strlen
argument_list|(
name|name
argument_list|)
operator|==
literal|5
operator|&&
name|strncasecmp
argument_list|(
name|name
argument_list|,
literal|"MAILA"
argument_list|,
literal|5
argument_list|)
operator|==
literal|0
condition|)
block|{
return|return
literal|254
return|;
block|}
elseif|else
if|if
condition|(
name|strlen
argument_list|(
name|name
argument_list|)
operator|==
literal|3
operator|&&
name|strncasecmp
argument_list|(
name|name
argument_list|,
literal|"ANY"
argument_list|,
literal|3
argument_list|)
operator|==
literal|0
condition|)
block|{
return|return
literal|255
return|;
block|}
return|return
literal|0
return|;
block|}
end_function

begin_function
name|ldns_rr_class
name|ldns_get_rr_class_by_name
parameter_list|(
specifier|const
name|char
modifier|*
name|name
parameter_list|)
block|{
name|ldns_lookup_table
modifier|*
name|lt
decl_stmt|;
comment|/* CLASSXX representation */
if|if
condition|(
name|strlen
argument_list|(
name|name
argument_list|)
operator|>
literal|5
operator|&&
name|strncasecmp
argument_list|(
name|name
argument_list|,
literal|"CLASS"
argument_list|,
literal|5
argument_list|)
operator|==
literal|0
condition|)
block|{
return|return
name|atoi
argument_list|(
name|name
operator|+
literal|5
argument_list|)
return|;
block|}
comment|/* Normal types */
name|lt
operator|=
name|ldns_lookup_by_name
argument_list|(
name|ldns_rr_classes
argument_list|,
name|name
argument_list|)
expr_stmt|;
if|if
condition|(
name|lt
condition|)
block|{
return|return
name|lt
operator|->
name|id
return|;
block|}
return|return
literal|0
return|;
block|}
end_function

begin_function
name|ldns_rr_type
name|ldns_rdf2rr_type
parameter_list|(
specifier|const
name|ldns_rdf
modifier|*
name|rd
parameter_list|)
block|{
name|ldns_rr_type
name|r
decl_stmt|;
if|if
condition|(
operator|!
name|rd
condition|)
block|{
return|return
literal|0
return|;
block|}
if|if
condition|(
name|ldns_rdf_get_type
argument_list|(
name|rd
argument_list|)
operator|!=
name|LDNS_RDF_TYPE_TYPE
condition|)
block|{
return|return
literal|0
return|;
block|}
name|r
operator|=
operator|(
name|ldns_rr_type
operator|)
name|ldns_rdf2native_int16
argument_list|(
name|rd
argument_list|)
expr_stmt|;
return|return
name|r
return|;
block|}
end_function

begin_function
name|ldns_rr_type
name|ldns_rr_list_type
parameter_list|(
specifier|const
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|)
block|{
if|if
condition|(
name|rr_list
operator|&&
name|ldns_rr_list_rr_count
argument_list|(
name|rr_list
argument_list|)
operator|>
literal|0
condition|)
block|{
return|return
name|ldns_rr_get_type
argument_list|(
name|ldns_rr_list_rr
argument_list|(
name|rr_list
argument_list|,
literal|0
argument_list|)
argument_list|)
return|;
block|}
else|else
block|{
return|return
literal|0
return|;
block|}
block|}
end_function

begin_function
name|ldns_rdf
modifier|*
name|ldns_rr_list_owner
parameter_list|(
specifier|const
name|ldns_rr_list
modifier|*
name|rr_list
parameter_list|)
block|{
if|if
condition|(
name|rr_list
operator|&&
name|ldns_rr_list_rr_count
argument_list|(
name|rr_list
argument_list|)
operator|>
literal|0
condition|)
block|{
return|return
name|ldns_rr_owner
argument_list|(
name|ldns_rr_list_rr
argument_list|(
name|rr_list
argument_list|,
literal|0
argument_list|)
argument_list|)
return|;
block|}
else|else
block|{
return|return
name|NULL
return|;
block|}
block|}
end_function

end_unit

