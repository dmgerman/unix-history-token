begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*    dump.c  *  *    Copyright (c) 1991-2001, Larry Wall  *  *    You may distribute under the terms of either the GNU General Public  *    License or the Artistic License, as specified in the README file.  *  */
end_comment

begin_comment
comment|/*  * "'You have talked long in your sleep, Frodo,' said Gandalf gently, 'and  * it has not been hard for me to read your mind and memory.'"  */
end_comment

begin_include
include|#
directive|include
file|"EXTERN.h"
end_include

begin_define
define|#
directive|define
name|PERL_IN_DUMP_C
end_define

begin_include
include|#
directive|include
file|"perl.h"
end_include

begin_include
include|#
directive|include
file|"regcomp.h"
end_include

begin_function
name|void
name|Perl_dump_indent
parameter_list|(
name|pTHX_
name|I32
name|level
parameter_list|,
name|PerlIO
modifier|*
name|file
parameter_list|,
specifier|const
name|char
modifier|*
name|pat
parameter_list|,
modifier|...
parameter_list|)
block|{
name|va_list
name|args
decl_stmt|;
name|va_start
argument_list|(
name|args
argument_list|,
name|pat
argument_list|)
expr_stmt|;
name|dump_vindent
argument_list|(
name|level
argument_list|,
name|file
argument_list|,
name|pat
argument_list|,
operator|&
name|args
argument_list|)
expr_stmt|;
name|va_end
argument_list|(
name|args
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Perl_dump_vindent
parameter_list|(
name|pTHX_
name|I32
name|level
parameter_list|,
name|PerlIO
modifier|*
name|file
parameter_list|,
specifier|const
name|char
modifier|*
name|pat
parameter_list|,
name|va_list
modifier|*
name|args
parameter_list|)
block|{
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"%*s"
argument_list|,
call|(
name|int
call|)
argument_list|(
name|level
operator|*
name|PL_dumpindent
argument_list|)
argument_list|,
literal|""
argument_list|)
expr_stmt|;
name|PerlIO_vprintf
argument_list|(
name|file
argument_list|,
name|pat
argument_list|,
operator|*
name|args
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Perl_dump_all
parameter_list|(
name|pTHX
parameter_list|)
block|{
name|PerlIO_setlinebuf
argument_list|(
name|Perl_debug_log
argument_list|)
expr_stmt|;
if|if
condition|(
name|PL_main_root
condition|)
name|op_dump
argument_list|(
name|PL_main_root
argument_list|)
expr_stmt|;
name|dump_packsubs
argument_list|(
name|PL_defstash
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Perl_dump_packsubs
parameter_list|(
name|pTHX_
name|HV
modifier|*
name|stash
parameter_list|)
block|{
name|I32
name|i
decl_stmt|;
name|HE
modifier|*
name|entry
decl_stmt|;
if|if
condition|(
operator|!
name|HvARRAY
argument_list|(
name|stash
argument_list|)
condition|)
return|return;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<=
operator|(
name|I32
operator|)
name|HvMAX
argument_list|(
name|stash
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
for|for
control|(
name|entry
operator|=
name|HvARRAY
argument_list|(
name|stash
argument_list|)
index|[
name|i
index|]
init|;
name|entry
condition|;
name|entry
operator|=
name|HeNEXT
argument_list|(
name|entry
argument_list|)
control|)
block|{
name|GV
modifier|*
name|gv
init|=
operator|(
name|GV
operator|*
operator|)
name|HeVAL
argument_list|(
name|entry
argument_list|)
decl_stmt|;
name|HV
modifier|*
name|hv
decl_stmt|;
if|if
condition|(
name|SvTYPE
argument_list|(
name|gv
argument_list|)
operator|!=
name|SVt_PVGV
operator|||
operator|!
name|GvGP
argument_list|(
name|gv
argument_list|)
condition|)
continue|continue;
if|if
condition|(
name|GvCVu
argument_list|(
name|gv
argument_list|)
condition|)
name|dump_sub
argument_list|(
name|gv
argument_list|)
expr_stmt|;
if|if
condition|(
name|GvFORM
argument_list|(
name|gv
argument_list|)
condition|)
name|dump_form
argument_list|(
name|gv
argument_list|)
expr_stmt|;
if|if
condition|(
name|HeKEY
argument_list|(
name|entry
argument_list|)
index|[
name|HeKLEN
argument_list|(
name|entry
argument_list|)
operator|-
literal|1
index|]
operator|==
literal|':'
operator|&&
operator|(
name|hv
operator|=
name|GvHV
argument_list|(
name|gv
argument_list|)
operator|)
operator|&&
name|HvNAME
argument_list|(
name|hv
argument_list|)
operator|&&
name|hv
operator|!=
name|PL_defstash
condition|)
name|dump_packsubs
argument_list|(
name|hv
argument_list|)
expr_stmt|;
comment|/* nested package */
block|}
block|}
block|}
end_function

begin_function
name|void
name|Perl_dump_sub
parameter_list|(
name|pTHX_
name|GV
modifier|*
name|gv
parameter_list|)
block|{
name|SV
modifier|*
name|sv
init|=
name|sv_newmortal
argument_list|()
decl_stmt|;
name|gv_fullname3
argument_list|(
name|sv
argument_list|,
name|gv
argument_list|,
name|Nullch
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
name|aTHX_
literal|0
argument_list|,
name|Perl_debug_log
argument_list|,
literal|"\nSUB %s = "
argument_list|,
name|SvPVX
argument_list|(
name|sv
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|CvXSUB
argument_list|(
name|GvCV
argument_list|(
name|gv
argument_list|)
argument_list|)
condition|)
name|Perl_dump_indent
argument_list|(
name|aTHX_
literal|0
argument_list|,
name|Perl_debug_log
argument_list|,
literal|"(xsub 0x%lx %d)\n"
argument_list|,
operator|(
name|long
operator|)
name|CvXSUB
argument_list|(
name|GvCV
argument_list|(
name|gv
argument_list|)
argument_list|)
argument_list|,
operator|(
name|int
operator|)
name|CvXSUBANY
argument_list|(
name|GvCV
argument_list|(
name|gv
argument_list|)
argument_list|)
operator|.
name|any_i32
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|CvROOT
argument_list|(
name|GvCV
argument_list|(
name|gv
argument_list|)
argument_list|)
condition|)
name|op_dump
argument_list|(
name|CvROOT
argument_list|(
name|GvCV
argument_list|(
name|gv
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|Perl_dump_indent
argument_list|(
name|aTHX_
literal|0
argument_list|,
name|Perl_debug_log
argument_list|,
literal|"<undef>\n"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Perl_dump_form
parameter_list|(
name|pTHX_
name|GV
modifier|*
name|gv
parameter_list|)
block|{
name|SV
modifier|*
name|sv
init|=
name|sv_newmortal
argument_list|()
decl_stmt|;
name|gv_fullname3
argument_list|(
name|sv
argument_list|,
name|gv
argument_list|,
name|Nullch
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
name|aTHX_
literal|0
argument_list|,
name|Perl_debug_log
argument_list|,
literal|"\nFORMAT %s = "
argument_list|,
name|SvPVX
argument_list|(
name|sv
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|CvROOT
argument_list|(
name|GvFORM
argument_list|(
name|gv
argument_list|)
argument_list|)
condition|)
name|op_dump
argument_list|(
name|CvROOT
argument_list|(
name|GvFORM
argument_list|(
name|gv
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|Perl_dump_indent
argument_list|(
name|aTHX_
literal|0
argument_list|,
name|Perl_debug_log
argument_list|,
literal|"<undef>\n"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Perl_dump_eval
parameter_list|(
name|pTHX
parameter_list|)
block|{
name|op_dump
argument_list|(
name|PL_eval_root
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|char
modifier|*
name|Perl_pv_display
parameter_list|(
name|pTHX_
name|SV
modifier|*
name|sv
parameter_list|,
name|char
modifier|*
name|pv
parameter_list|,
name|STRLEN
name|cur
parameter_list|,
name|STRLEN
name|len
parameter_list|,
name|STRLEN
name|pvlim
parameter_list|)
block|{
name|int
name|truncated
init|=
literal|0
decl_stmt|;
name|int
name|nul_terminated
init|=
name|len
operator|>
name|cur
operator|&&
name|pv
index|[
name|cur
index|]
operator|==
literal|'\0'
decl_stmt|;
name|sv_setpvn
argument_list|(
name|sv
argument_list|,
literal|"\""
argument_list|,
literal|1
argument_list|)
expr_stmt|;
for|for
control|(
init|;
name|cur
operator|--
condition|;
name|pv
operator|++
control|)
block|{
if|if
condition|(
name|pvlim
operator|&&
name|SvCUR
argument_list|(
name|sv
argument_list|)
operator|>=
name|pvlim
condition|)
block|{
name|truncated
operator|++
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|isPRINT
argument_list|(
operator|*
name|pv
argument_list|)
condition|)
block|{
switch|switch
condition|(
operator|*
name|pv
condition|)
block|{
case|case
literal|'\t'
case|:
name|sv_catpvn
argument_list|(
name|sv
argument_list|,
literal|"\\t"
argument_list|,
literal|2
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'\n'
case|:
name|sv_catpvn
argument_list|(
name|sv
argument_list|,
literal|"\\n"
argument_list|,
literal|2
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'\r'
case|:
name|sv_catpvn
argument_list|(
name|sv
argument_list|,
literal|"\\r"
argument_list|,
literal|2
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'\f'
case|:
name|sv_catpvn
argument_list|(
name|sv
argument_list|,
literal|"\\f"
argument_list|,
literal|2
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'"'
case|:
name|sv_catpvn
argument_list|(
name|sv
argument_list|,
literal|"\\\""
argument_list|,
literal|2
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'\\'
case|:
name|sv_catpvn
argument_list|(
name|sv
argument_list|,
literal|"\\\\"
argument_list|,
literal|2
argument_list|)
expr_stmt|;
break|break;
default|default:
name|sv_catpvn
argument_list|(
name|sv
argument_list|,
name|pv
argument_list|,
literal|1
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
else|else
block|{
if|if
condition|(
name|cur
operator|&&
name|isDIGIT
argument_list|(
operator|*
operator|(
name|pv
operator|+
literal|1
operator|)
argument_list|)
condition|)
name|Perl_sv_catpvf
argument_list|(
argument|aTHX_ sv
argument_list|,
literal|"\\%03o"
argument_list|,
argument|(U8)*pv
argument_list|)
empty_stmt|;
else|else
name|Perl_sv_catpvf
argument_list|(
argument|aTHX_ sv
argument_list|,
literal|"\\%o"
argument_list|,
argument|(U8)*pv
argument_list|)
empty_stmt|;
block|}
block|}
name|sv_catpvn
argument_list|(
name|sv
argument_list|,
literal|"\""
argument_list|,
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|truncated
condition|)
name|sv_catpvn
argument_list|(
name|sv
argument_list|,
literal|"..."
argument_list|,
literal|3
argument_list|)
expr_stmt|;
if|if
condition|(
name|nul_terminated
condition|)
name|sv_catpvn
argument_list|(
name|sv
argument_list|,
literal|"\\0"
argument_list|,
literal|2
argument_list|)
expr_stmt|;
return|return
name|SvPVX
argument_list|(
name|sv
argument_list|)
return|;
block|}
end_function

begin_function
name|char
modifier|*
name|Perl_sv_peek
parameter_list|(
name|pTHX_
name|SV
modifier|*
name|sv
parameter_list|)
block|{
name|SV
modifier|*
name|t
init|=
name|sv_newmortal
argument_list|()
decl_stmt|;
name|STRLEN
name|n_a
decl_stmt|;
name|int
name|unref
init|=
literal|0
decl_stmt|;
name|sv_setpvn
argument_list|(
name|t
argument_list|,
literal|""
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|retry
label|:
if|if
condition|(
operator|!
name|sv
condition|)
block|{
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"VOID"
argument_list|)
expr_stmt|;
goto|goto
name|finish
goto|;
block|}
elseif|else
if|if
condition|(
name|sv
operator|==
operator|(
name|SV
operator|*
operator|)
literal|0x55555555
operator|||
name|SvTYPE
argument_list|(
name|sv
argument_list|)
operator|==
literal|'U'
condition|)
block|{
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"WILD"
argument_list|)
expr_stmt|;
goto|goto
name|finish
goto|;
block|}
elseif|else
if|if
condition|(
name|sv
operator|==
operator|&
name|PL_sv_undef
operator|||
name|sv
operator|==
operator|&
name|PL_sv_no
operator|||
name|sv
operator|==
operator|&
name|PL_sv_yes
condition|)
block|{
if|if
condition|(
name|sv
operator|==
operator|&
name|PL_sv_undef
condition|)
block|{
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"SV_UNDEF"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|SvFLAGS
argument_list|(
name|sv
argument_list|)
operator|&
operator|(
name|SVf_OK
operator||
name|SVf_OOK
operator||
name|SVs_OBJECT
operator||
name|SVs_GMG
operator||
name|SVs_SMG
operator||
name|SVs_RMG
operator|)
operator|)
operator|&&
name|SvREADONLY
argument_list|(
name|sv
argument_list|)
condition|)
goto|goto
name|finish
goto|;
block|}
elseif|else
if|if
condition|(
name|sv
operator|==
operator|&
name|PL_sv_no
condition|)
block|{
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"SV_NO"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|SvFLAGS
argument_list|(
name|sv
argument_list|)
operator|&
operator|(
name|SVf_ROK
operator||
name|SVf_OOK
operator||
name|SVs_OBJECT
operator||
name|SVs_GMG
operator||
name|SVs_SMG
operator||
name|SVs_RMG
operator|)
operator|)
operator|&&
operator|!
operator|(
operator|~
name|SvFLAGS
argument_list|(
name|sv
argument_list|)
operator|&
operator|(
name|SVf_POK
operator||
name|SVf_NOK
operator||
name|SVf_READONLY
operator||
name|SVp_POK
operator||
name|SVp_NOK
operator|)
operator|)
operator|&&
name|SvCUR
argument_list|(
name|sv
argument_list|)
operator|==
literal|0
operator|&&
name|SvNVX
argument_list|(
name|sv
argument_list|)
operator|==
literal|0.0
condition|)
goto|goto
name|finish
goto|;
block|}
else|else
block|{
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"SV_YES"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|SvFLAGS
argument_list|(
name|sv
argument_list|)
operator|&
operator|(
name|SVf_ROK
operator||
name|SVf_OOK
operator||
name|SVs_OBJECT
operator||
name|SVs_GMG
operator||
name|SVs_SMG
operator||
name|SVs_RMG
operator|)
operator|)
operator|&&
operator|!
operator|(
operator|~
name|SvFLAGS
argument_list|(
name|sv
argument_list|)
operator|&
operator|(
name|SVf_POK
operator||
name|SVf_NOK
operator||
name|SVf_READONLY
operator||
name|SVp_POK
operator||
name|SVp_NOK
operator|)
operator|)
operator|&&
name|SvCUR
argument_list|(
name|sv
argument_list|)
operator|==
literal|1
operator|&&
name|SvPVX
argument_list|(
name|sv
argument_list|)
operator|&&
operator|*
name|SvPVX
argument_list|(
name|sv
argument_list|)
operator|==
literal|'1'
operator|&&
name|SvNVX
argument_list|(
name|sv
argument_list|)
operator|==
literal|1.0
condition|)
goto|goto
name|finish
goto|;
block|}
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|":"
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|SvREFCNT
argument_list|(
name|sv
argument_list|)
operator|==
literal|0
condition|)
block|{
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"("
argument_list|)
expr_stmt|;
name|unref
operator|++
expr_stmt|;
block|}
if|if
condition|(
name|SvROK
argument_list|(
name|sv
argument_list|)
condition|)
block|{
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"\\"
argument_list|)
expr_stmt|;
if|if
condition|(
name|SvCUR
argument_list|(
name|t
argument_list|)
operator|+
name|unref
operator|>
literal|10
condition|)
block|{
name|SvCUR
argument_list|(
name|t
argument_list|)
operator|=
name|unref
operator|+
literal|3
expr_stmt|;
operator|*
name|SvEND
argument_list|(
name|t
argument_list|)
operator|=
literal|'\0'
expr_stmt|;
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"..."
argument_list|)
expr_stmt|;
goto|goto
name|finish
goto|;
block|}
name|sv
operator|=
operator|(
name|SV
operator|*
operator|)
name|SvRV
argument_list|(
name|sv
argument_list|)
expr_stmt|;
goto|goto
name|retry
goto|;
block|}
switch|switch
condition|(
name|SvTYPE
argument_list|(
name|sv
argument_list|)
condition|)
block|{
default|default:
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"FREED"
argument_list|)
expr_stmt|;
goto|goto
name|finish
goto|;
case|case
name|SVt_NULL
case|:
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"UNDEF"
argument_list|)
expr_stmt|;
goto|goto
name|finish
goto|;
case|case
name|SVt_IV
case|:
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"IV"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_NV
case|:
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"NV"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_RV
case|:
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"RV"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PV
case|:
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"PV"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVIV
case|:
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"PVIV"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVNV
case|:
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"PVNV"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVMG
case|:
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"PVMG"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVLV
case|:
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"PVLV"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVAV
case|:
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"AV"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVHV
case|:
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"HV"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVCV
case|:
if|if
condition|(
name|CvGV
argument_list|(
name|sv
argument_list|)
condition|)
name|Perl_sv_catpvf
argument_list|(
argument|aTHX_ t
argument_list|,
literal|"CV(%s)"
argument_list|,
argument|GvNAME(CvGV(sv))
argument_list|)
empty_stmt|;
else|else
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"CV()"
argument_list|)
expr_stmt|;
goto|goto
name|finish
goto|;
case|case
name|SVt_PVGV
case|:
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"GV"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVBM
case|:
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"BM"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVFM
case|:
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"FM"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVIO
case|:
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"IO"
argument_list|)
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|SvPOKp
argument_list|(
name|sv
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|SvPVX
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"(null)"
argument_list|)
expr_stmt|;
else|else
block|{
name|SV
modifier|*
name|tmp
init|=
name|newSVpvn
argument_list|(
literal|""
argument_list|,
literal|0
argument_list|)
decl_stmt|;
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"("
argument_list|)
expr_stmt|;
if|if
condition|(
name|SvOOK
argument_list|(
name|sv
argument_list|)
condition|)
name|Perl_sv_catpvf
argument_list|(
argument|aTHX_ t
argument_list|,
literal|"[%s]"
argument_list|,
argument|pv_display(tmp, SvPVX(sv)-SvIVX(sv), SvIVX(sv),
literal|0
argument|,
literal|127
argument|)
argument_list|)
empty_stmt|;
name|Perl_sv_catpvf
argument_list|(
argument|aTHX_ t
argument_list|,
literal|"%s)"
argument_list|,
argument|pv_display(tmp, SvPVX(sv), SvCUR(sv), SvLEN(sv),
literal|127
argument|)
argument_list|)
empty_stmt|;
name|SvREFCNT_dec
argument_list|(
name|tmp
argument_list|)
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|SvNOKp
argument_list|(
name|sv
argument_list|)
condition|)
block|{
name|STORE_NUMERIC_LOCAL_SET_STANDARD
argument_list|()
expr_stmt|;
name|Perl_sv_catpvf
argument_list|(
argument|aTHX_ t
argument_list|,
literal|"(%g)"
argument_list|,
argument|SvNVX(sv)
argument_list|)
empty_stmt|;
name|RESTORE_NUMERIC_LOCAL
argument_list|()
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|SvIOKp
argument_list|(
name|sv
argument_list|)
condition|)
block|{
if|if
condition|(
name|SvIsUV
argument_list|(
name|sv
argument_list|)
condition|)
name|Perl_sv_catpvf
argument_list|(
argument|aTHX_ t
argument_list|,
literal|"(%"
argument|UVuf
literal|")"
argument_list|,
argument|(UV)SvUVX(sv)
argument_list|)
empty_stmt|;
else|else
name|Perl_sv_catpvf
argument_list|(
argument|aTHX_ t
argument_list|,
literal|"(%"
argument|IVdf
literal|")"
argument_list|,
argument|(IV)SvIVX(sv)
argument_list|)
empty_stmt|;
block|}
else|else
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|"()"
argument_list|)
expr_stmt|;
name|finish
label|:
if|if
condition|(
name|unref
condition|)
block|{
while|while
condition|(
name|unref
operator|--
condition|)
name|sv_catpv
argument_list|(
name|t
argument_list|,
literal|")"
argument_list|)
expr_stmt|;
block|}
return|return
name|SvPV
argument_list|(
name|t
argument_list|,
name|n_a
argument_list|)
return|;
block|}
end_function

begin_function
name|void
name|Perl_do_pmop_dump
parameter_list|(
name|pTHX_
name|I32
name|level
parameter_list|,
name|PerlIO
modifier|*
name|file
parameter_list|,
name|PMOP
modifier|*
name|pm
parameter_list|)
block|{
name|char
name|ch
decl_stmt|;
if|if
condition|(
operator|!
name|pm
condition|)
block|{
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"{}\n"
argument_list|)
empty_stmt|;
return|return;
block|}
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"{\n"
argument_list|)
empty_stmt|;
name|level
operator|++
expr_stmt|;
if|if
condition|(
name|pm
operator|->
name|op_pmflags
operator|&
name|PMf_ONCE
condition|)
name|ch
operator|=
literal|'?'
expr_stmt|;
else|else
name|ch
operator|=
literal|'/'
expr_stmt|;
if|if
condition|(
name|pm
operator|->
name|op_pmregexp
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"PMf_PRE %c%s%c%s\n"
argument_list|,
argument|ch
argument_list|,
argument|pm->op_pmregexp->precomp
argument_list|,
argument|ch
argument_list|,
argument|(pm->op_private& OPpRUNTIME) ?
literal|" (RUNTIME)"
argument|:
literal|""
argument_list|)
empty_stmt|;
else|else
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"PMf_PRE (RUNTIME)\n"
argument_list|)
empty_stmt|;
if|if
condition|(
name|pm
operator|->
name|op_type
operator|!=
name|OP_PUSHRE
operator|&&
name|pm
operator|->
name|op_pmreplroot
condition|)
block|{
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"PMf_REPL = "
argument_list|)
empty_stmt|;
name|op_dump
argument_list|(
name|pm
operator|->
name|op_pmreplroot
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|pm
operator|->
name|op_pmflags
operator|||
operator|(
name|pm
operator|->
name|op_pmregexp
operator|&&
name|pm
operator|->
name|op_pmregexp
operator|->
name|check_substr
operator|)
condition|)
block|{
name|SV
modifier|*
name|tmpsv
init|=
name|newSVpvn
argument_list|(
literal|""
argument_list|,
literal|0
argument_list|)
decl_stmt|;
if|if
condition|(
name|pm
operator|->
name|op_pmdynflags
operator|&
name|PMdf_USED
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",USED"
argument_list|)
expr_stmt|;
if|if
condition|(
name|pm
operator|->
name|op_pmdynflags
operator|&
name|PMdf_TAINTED
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",TAINTED"
argument_list|)
expr_stmt|;
if|if
condition|(
name|pm
operator|->
name|op_pmflags
operator|&
name|PMf_ONCE
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",ONCE"
argument_list|)
expr_stmt|;
if|if
condition|(
name|pm
operator|->
name|op_pmregexp
operator|&&
name|pm
operator|->
name|op_pmregexp
operator|->
name|check_substr
operator|&&
operator|!
operator|(
name|pm
operator|->
name|op_pmregexp
operator|->
name|reganch
operator|&
name|ROPT_NOSCAN
operator|)
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",SCANFIRST"
argument_list|)
expr_stmt|;
if|if
condition|(
name|pm
operator|->
name|op_pmregexp
operator|&&
name|pm
operator|->
name|op_pmregexp
operator|->
name|check_substr
operator|&&
name|pm
operator|->
name|op_pmregexp
operator|->
name|reganch
operator|&
name|ROPT_CHECK_ALL
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",ALL"
argument_list|)
expr_stmt|;
if|if
condition|(
name|pm
operator|->
name|op_pmflags
operator|&
name|PMf_SKIPWHITE
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",SKIPWHITE"
argument_list|)
expr_stmt|;
if|if
condition|(
name|pm
operator|->
name|op_pmflags
operator|&
name|PMf_CONST
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",CONST"
argument_list|)
expr_stmt|;
if|if
condition|(
name|pm
operator|->
name|op_pmflags
operator|&
name|PMf_KEEP
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",KEEP"
argument_list|)
expr_stmt|;
if|if
condition|(
name|pm
operator|->
name|op_pmflags
operator|&
name|PMf_GLOBAL
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",GLOBAL"
argument_list|)
expr_stmt|;
if|if
condition|(
name|pm
operator|->
name|op_pmflags
operator|&
name|PMf_CONTINUE
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",CONTINUE"
argument_list|)
expr_stmt|;
if|if
condition|(
name|pm
operator|->
name|op_pmflags
operator|&
name|PMf_RETAINT
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",RETAINT"
argument_list|)
expr_stmt|;
if|if
condition|(
name|pm
operator|->
name|op_pmflags
operator|&
name|PMf_EVAL
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",EVAL"
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"PMFLAGS = (%s)\n"
argument_list|,
argument|SvCUR(tmpsv) ? SvPVX(tmpsv) +
literal|1
argument|:
literal|""
argument_list|)
empty_stmt|;
name|SvREFCNT_dec
argument_list|(
name|tmpsv
argument_list|)
expr_stmt|;
block|}
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level-
literal|1
argument_list|,
argument|file
argument_list|,
literal|"}\n"
argument_list|)
empty_stmt|;
block|}
end_function

begin_function
name|void
name|Perl_pmop_dump
parameter_list|(
name|pTHX_
name|PMOP
modifier|*
name|pm
parameter_list|)
block|{
name|do_pmop_dump
argument_list|(
literal|0
argument_list|,
name|Perl_debug_log
argument_list|,
name|pm
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Perl_do_op_dump
parameter_list|(
name|pTHX_
name|I32
name|level
parameter_list|,
name|PerlIO
modifier|*
name|file
parameter_list|,
name|OP
modifier|*
name|o
parameter_list|)
block|{
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"{\n"
argument_list|)
empty_stmt|;
name|level
operator|++
expr_stmt|;
if|if
condition|(
name|o
operator|->
name|op_seq
condition|)
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"%-4d"
argument_list|,
name|o
operator|->
name|op_seq
argument_list|)
expr_stmt|;
else|else
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"    "
argument_list|)
expr_stmt|;
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"%*sTYPE = %s  ===> "
argument_list|,
call|(
name|int
call|)
argument_list|(
name|PL_dumpindent
operator|*
name|level
operator|-
literal|4
argument_list|)
argument_list|,
literal|""
argument_list|,
name|PL_op_name
index|[
name|o
operator|->
name|op_type
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|o
operator|->
name|op_next
condition|)
block|{
if|if
condition|(
name|o
operator|->
name|op_seq
condition|)
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"%d\n"
argument_list|,
name|o
operator|->
name|op_next
operator|->
name|op_seq
argument_list|)
expr_stmt|;
else|else
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"(%d)\n"
argument_list|,
name|o
operator|->
name|op_next
operator|->
name|op_seq
argument_list|)
expr_stmt|;
block|}
else|else
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"DONE\n"
argument_list|)
expr_stmt|;
if|if
condition|(
name|o
operator|->
name|op_targ
condition|)
block|{
if|if
condition|(
name|o
operator|->
name|op_type
operator|==
name|OP_NULL
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  (was %s)\n"
argument_list|,
argument|PL_op_name[o->op_targ]
argument_list|)
empty_stmt|;
else|else
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"TARG = %ld\n"
argument_list|,
argument|(long)o->op_targ
argument_list|)
empty_stmt|;
block|}
ifdef|#
directive|ifdef
name|DUMPADDR
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"ADDR = 0x%"
argument|UVxf
literal|" => 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|(UV)o
argument_list|,
argument|(UV)o->op_next
argument_list|)
empty_stmt|;
endif|#
directive|endif
if|if
condition|(
name|o
operator|->
name|op_flags
condition|)
block|{
name|SV
modifier|*
name|tmpsv
init|=
name|newSVpvn
argument_list|(
literal|""
argument_list|,
literal|0
argument_list|)
decl_stmt|;
switch|switch
condition|(
name|o
operator|->
name|op_flags
operator|&
name|OPf_WANT
condition|)
block|{
case|case
name|OPf_WANT_VOID
case|:
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",VOID"
argument_list|)
expr_stmt|;
break|break;
case|case
name|OPf_WANT_SCALAR
case|:
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",SCALAR"
argument_list|)
expr_stmt|;
break|break;
case|case
name|OPf_WANT_LIST
case|:
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",LIST"
argument_list|)
expr_stmt|;
break|break;
default|default:
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",UNKNOWN"
argument_list|)
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|o
operator|->
name|op_flags
operator|&
name|OPf_KIDS
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",KIDS"
argument_list|)
expr_stmt|;
if|if
condition|(
name|o
operator|->
name|op_flags
operator|&
name|OPf_PARENS
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",PARENS"
argument_list|)
expr_stmt|;
if|if
condition|(
name|o
operator|->
name|op_flags
operator|&
name|OPf_STACKED
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",STACKED"
argument_list|)
expr_stmt|;
if|if
condition|(
name|o
operator|->
name|op_flags
operator|&
name|OPf_REF
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",REF"
argument_list|)
expr_stmt|;
if|if
condition|(
name|o
operator|->
name|op_flags
operator|&
name|OPf_MOD
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",MOD"
argument_list|)
expr_stmt|;
if|if
condition|(
name|o
operator|->
name|op_flags
operator|&
name|OPf_SPECIAL
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",SPECIAL"
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"FLAGS = (%s)\n"
argument_list|,
argument|SvCUR(tmpsv) ? SvPVX(tmpsv) +
literal|1
argument|:
literal|""
argument_list|)
empty_stmt|;
name|SvREFCNT_dec
argument_list|(
name|tmpsv
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|o
operator|->
name|op_private
condition|)
block|{
name|SV
modifier|*
name|tmpsv
init|=
name|newSVpvn
argument_list|(
literal|""
argument_list|,
literal|0
argument_list|)
decl_stmt|;
if|if
condition|(
name|PL_opargs
index|[
name|o
operator|->
name|op_type
index|]
operator|&
name|OA_TARGLEX
condition|)
block|{
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpTARGET_MY
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",TARGET_MY"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|o
operator|->
name|op_type
operator|==
name|OP_AASSIGN
condition|)
block|{
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpASSIGN_COMMON
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",COMMON"
argument_list|)
expr_stmt|;
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpASSIGN_HASH
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",HASH"
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|o
operator|->
name|op_type
operator|==
name|OP_SASSIGN
condition|)
block|{
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpASSIGN_BACKWARDS
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",BACKWARDS"
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|o
operator|->
name|op_type
operator|==
name|OP_TRANS
condition|)
block|{
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpTRANS_SQUASH
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",SQUASH"
argument_list|)
expr_stmt|;
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpTRANS_DELETE
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",DELETE"
argument_list|)
expr_stmt|;
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpTRANS_COMPLEMENT
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",COMPLEMENT"
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|o
operator|->
name|op_type
operator|==
name|OP_REPEAT
condition|)
block|{
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpREPEAT_DOLIST
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",DOLIST"
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|o
operator|->
name|op_type
operator|==
name|OP_ENTERSUB
operator|||
name|o
operator|->
name|op_type
operator|==
name|OP_RV2SV
operator|||
name|o
operator|->
name|op_type
operator|==
name|OP_GVSV
operator|||
name|o
operator|->
name|op_type
operator|==
name|OP_RV2AV
operator|||
name|o
operator|->
name|op_type
operator|==
name|OP_RV2HV
operator|||
name|o
operator|->
name|op_type
operator|==
name|OP_RV2GV
operator|||
name|o
operator|->
name|op_type
operator|==
name|OP_AELEM
operator|||
name|o
operator|->
name|op_type
operator|==
name|OP_HELEM
condition|)
block|{
if|if
condition|(
name|o
operator|->
name|op_type
operator|==
name|OP_ENTERSUB
condition|)
block|{
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpENTERSUB_AMPER
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",AMPER"
argument_list|)
expr_stmt|;
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpENTERSUB_DB
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",DB"
argument_list|)
expr_stmt|;
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpENTERSUB_HASTARG
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",HASTARG"
argument_list|)
expr_stmt|;
block|}
else|else
switch|switch
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpDEREF
condition|)
block|{
case|case
name|OPpDEREF_SV
case|:
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",SV"
argument_list|)
expr_stmt|;
break|break;
case|case
name|OPpDEREF_AV
case|:
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",AV"
argument_list|)
expr_stmt|;
break|break;
case|case
name|OPpDEREF_HV
case|:
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",HV"
argument_list|)
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|o
operator|->
name|op_type
operator|==
name|OP_AELEM
operator|||
name|o
operator|->
name|op_type
operator|==
name|OP_HELEM
condition|)
block|{
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpLVAL_DEFER
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",LVAL_DEFER"
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|HINT_STRICT_REFS
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",STRICT_REFS"
argument_list|)
expr_stmt|;
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpOUR_INTRO
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",OUR_INTRO"
argument_list|)
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|o
operator|->
name|op_type
operator|==
name|OP_CONST
condition|)
block|{
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpCONST_BARE
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",BARE"
argument_list|)
expr_stmt|;
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpCONST_STRICT
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",STRICT"
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|o
operator|->
name|op_type
operator|==
name|OP_FLIP
condition|)
block|{
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpFLIP_LINENUM
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",LINENUM"
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|o
operator|->
name|op_type
operator|==
name|OP_FLOP
condition|)
block|{
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpFLIP_LINENUM
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",LINENUM"
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|o
operator|->
name|op_type
operator|==
name|OP_RV2CV
condition|)
block|{
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpLVAL_INTRO
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",INTRO"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|o
operator|->
name|op_flags
operator|&
name|OPf_MOD
operator|&&
name|o
operator|->
name|op_private
operator|&
name|OPpLVAL_INTRO
condition|)
name|sv_catpv
argument_list|(
name|tmpsv
argument_list|,
literal|",INTRO"
argument_list|)
expr_stmt|;
if|if
condition|(
name|SvCUR
argument_list|(
name|tmpsv
argument_list|)
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"PRIVATE = (%s)\n"
argument_list|,
argument|SvPVX(tmpsv) +
literal|1
argument_list|)
empty_stmt|;
name|SvREFCNT_dec
argument_list|(
name|tmpsv
argument_list|)
expr_stmt|;
block|}
switch|switch
condition|(
name|o
operator|->
name|op_type
condition|)
block|{
case|case
name|OP_AELEMFAST
case|:
case|case
name|OP_GVSV
case|:
case|case
name|OP_GV
case|:
ifdef|#
directive|ifdef
name|USE_ITHREADS
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"PADIX = %d\n"
argument_list|,
argument|cPADOPo->op_padix
argument_list|)
empty_stmt|;
else|#
directive|else
if|if
condition|(
name|cSVOPo
operator|->
name|op_sv
condition|)
block|{
name|SV
modifier|*
name|tmpsv
init|=
name|NEWSV
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
decl_stmt|;
name|STRLEN
name|n_a
decl_stmt|;
name|ENTER
expr_stmt|;
name|SAVEFREESV
argument_list|(
name|tmpsv
argument_list|)
expr_stmt|;
name|gv_fullname3
argument_list|(
name|tmpsv
argument_list|,
operator|(
name|GV
operator|*
operator|)
name|cSVOPo
operator|->
name|op_sv
argument_list|,
name|Nullch
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"GV = %s\n"
argument_list|,
argument|SvPV(tmpsv, n_a)
argument_list|)
empty_stmt|;
name|LEAVE
expr_stmt|;
block|}
else|else
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"GV = NULL\n"
argument_list|)
empty_stmt|;
endif|#
directive|endif
break|break;
case|case
name|OP_CONST
case|:
case|case
name|OP_METHOD_NAMED
case|:
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"SV = %s\n"
argument_list|,
argument|SvPEEK(cSVOPo->op_sv)
argument_list|)
empty_stmt|;
break|break;
case|case
name|OP_SETSTATE
case|:
case|case
name|OP_NEXTSTATE
case|:
case|case
name|OP_DBSTATE
case|:
if|if
condition|(
name|CopLINE
argument_list|(
name|cCOPo
argument_list|)
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"LINE = %d\n"
argument_list|,
argument|CopLINE(cCOPo)
argument_list|)
empty_stmt|;
if|if
condition|(
name|CopSTASHPV
argument_list|(
name|cCOPo
argument_list|)
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"PACKAGE = \"%s\"\n"
argument_list|,
argument|CopSTASHPV(cCOPo)
argument_list|)
empty_stmt|;
if|if
condition|(
name|cCOPo
operator|->
name|cop_label
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"LABEL = \"%s\"\n"
argument_list|,
argument|cCOPo->cop_label
argument_list|)
empty_stmt|;
break|break;
case|case
name|OP_ENTERLOOP
case|:
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"REDO ===> "
argument_list|)
empty_stmt|;
if|if
condition|(
name|cLOOPo
operator|->
name|op_redoop
condition|)
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"%d\n"
argument_list|,
name|cLOOPo
operator|->
name|op_redoop
operator|->
name|op_seq
argument_list|)
expr_stmt|;
else|else
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"DONE\n"
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"NEXT ===> "
argument_list|)
empty_stmt|;
if|if
condition|(
name|cLOOPo
operator|->
name|op_nextop
condition|)
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"%d\n"
argument_list|,
name|cLOOPo
operator|->
name|op_nextop
operator|->
name|op_seq
argument_list|)
expr_stmt|;
else|else
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"DONE\n"
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"LAST ===> "
argument_list|)
empty_stmt|;
if|if
condition|(
name|cLOOPo
operator|->
name|op_lastop
condition|)
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"%d\n"
argument_list|,
name|cLOOPo
operator|->
name|op_lastop
operator|->
name|op_seq
argument_list|)
expr_stmt|;
else|else
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"DONE\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_COND_EXPR
case|:
case|case
name|OP_RANGE
case|:
case|case
name|OP_MAPWHILE
case|:
case|case
name|OP_GREPWHILE
case|:
case|case
name|OP_OR
case|:
case|case
name|OP_AND
case|:
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"OTHER ===> "
argument_list|)
empty_stmt|;
if|if
condition|(
name|cLOGOPo
operator|->
name|op_other
condition|)
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"%d\n"
argument_list|,
name|cLOGOPo
operator|->
name|op_other
operator|->
name|op_seq
argument_list|)
expr_stmt|;
else|else
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"DONE\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_PUSHRE
case|:
case|case
name|OP_MATCH
case|:
case|case
name|OP_QR
case|:
case|case
name|OP_SUBST
case|:
name|do_pmop_dump
argument_list|(
name|level
argument_list|,
name|file
argument_list|,
name|cPMOPo
argument_list|)
expr_stmt|;
break|break;
case|case
name|OP_LEAVE
case|:
case|case
name|OP_LEAVEEVAL
case|:
case|case
name|OP_LEAVESUB
case|:
case|case
name|OP_LEAVESUBLV
case|:
case|case
name|OP_LEAVEWRITE
case|:
case|case
name|OP_SCOPE
case|:
if|if
condition|(
name|o
operator|->
name|op_private
operator|&
name|OPpREFCOUNTED
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"REFCNT = %"
argument|UVuf
literal|"\n"
argument_list|,
argument|(UV)o->op_targ
argument_list|)
empty_stmt|;
break|break;
default|default:
break|break;
block|}
if|if
condition|(
name|o
operator|->
name|op_flags
operator|&
name|OPf_KIDS
condition|)
block|{
name|OP
modifier|*
name|kid
decl_stmt|;
for|for
control|(
name|kid
operator|=
name|cUNOPo
operator|->
name|op_first
init|;
name|kid
condition|;
name|kid
operator|=
name|kid
operator|->
name|op_sibling
control|)
name|do_op_dump
argument_list|(
name|level
argument_list|,
name|file
argument_list|,
name|kid
argument_list|)
expr_stmt|;
block|}
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level-
literal|1
argument_list|,
argument|file
argument_list|,
literal|"}\n"
argument_list|)
empty_stmt|;
block|}
end_function

begin_function
name|void
name|Perl_op_dump
parameter_list|(
name|pTHX_
name|OP
modifier|*
name|o
parameter_list|)
block|{
name|do_op_dump
argument_list|(
literal|0
argument_list|,
name|Perl_debug_log
argument_list|,
name|o
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Perl_gv_dump
parameter_list|(
name|pTHX_
name|GV
modifier|*
name|gv
parameter_list|)
block|{
name|SV
modifier|*
name|sv
decl_stmt|;
if|if
condition|(
operator|!
name|gv
condition|)
block|{
name|PerlIO_printf
argument_list|(
name|Perl_debug_log
argument_list|,
literal|"{}\n"
argument_list|)
expr_stmt|;
return|return;
block|}
name|sv
operator|=
name|sv_newmortal
argument_list|()
expr_stmt|;
name|PerlIO_printf
argument_list|(
name|Perl_debug_log
argument_list|,
literal|"{\n"
argument_list|)
expr_stmt|;
name|gv_fullname3
argument_list|(
name|sv
argument_list|,
name|gv
argument_list|,
name|Nullch
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
name|aTHX_
literal|1
argument_list|,
name|Perl_debug_log
argument_list|,
literal|"GV_NAME = %s"
argument_list|,
name|SvPVX
argument_list|(
name|sv
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|gv
operator|!=
name|GvEGV
argument_list|(
name|gv
argument_list|)
condition|)
block|{
name|gv_efullname3
argument_list|(
name|sv
argument_list|,
name|GvEGV
argument_list|(
name|gv
argument_list|)
argument_list|,
name|Nullch
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
name|aTHX_
literal|1
argument_list|,
name|Perl_debug_log
argument_list|,
literal|"-> %s"
argument_list|,
name|SvPVX
argument_list|(
name|sv
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|PerlIO_putc
argument_list|(
name|Perl_debug_log
argument_list|,
literal|'\n'
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
name|aTHX_
literal|0
argument_list|,
name|Perl_debug_log
argument_list|,
literal|"}\n"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Perl_do_magic_dump
parameter_list|(
name|pTHX_
name|I32
name|level
parameter_list|,
name|PerlIO
modifier|*
name|file
parameter_list|,
name|MAGIC
modifier|*
name|mg
parameter_list|,
name|I32
name|nest
parameter_list|,
name|I32
name|maxnest
parameter_list|,
name|bool
name|dumpops
parameter_list|,
name|STRLEN
name|pvlim
parameter_list|)
block|{
for|for
control|(
init|;
name|mg
condition|;
name|mg
operator|=
name|mg
operator|->
name|mg_moremagic
control|)
block|{
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  MAGIC = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(mg)
argument_list|)
empty_stmt|;
if|if
condition|(
name|mg
operator|->
name|mg_virtual
condition|)
block|{
name|MGVTBL
modifier|*
name|v
init|=
name|mg
operator|->
name|mg_virtual
decl_stmt|;
name|char
modifier|*
name|s
init|=
literal|0
decl_stmt|;
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_sv
condition|)
name|s
operator|=
literal|"sv"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_env
condition|)
name|s
operator|=
literal|"env"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_envelem
condition|)
name|s
operator|=
literal|"envelem"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_sig
condition|)
name|s
operator|=
literal|"sig"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_sigelem
condition|)
name|s
operator|=
literal|"sigelem"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_pack
condition|)
name|s
operator|=
literal|"pack"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_packelem
condition|)
name|s
operator|=
literal|"packelem"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_dbline
condition|)
name|s
operator|=
literal|"dbline"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_isa
condition|)
name|s
operator|=
literal|"isa"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_arylen
condition|)
name|s
operator|=
literal|"arylen"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_glob
condition|)
name|s
operator|=
literal|"glob"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_mglob
condition|)
name|s
operator|=
literal|"mglob"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_nkeys
condition|)
name|s
operator|=
literal|"nkeys"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_taint
condition|)
name|s
operator|=
literal|"taint"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_substr
condition|)
name|s
operator|=
literal|"substr"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_vec
condition|)
name|s
operator|=
literal|"vec"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_pos
condition|)
name|s
operator|=
literal|"pos"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_bm
condition|)
name|s
operator|=
literal|"bm"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_fm
condition|)
name|s
operator|=
literal|"fm"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_uvar
condition|)
name|s
operator|=
literal|"uvar"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_defelem
condition|)
name|s
operator|=
literal|"defelem"
expr_stmt|;
ifdef|#
directive|ifdef
name|USE_LOCALE_COLLATE
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_collxfrm
condition|)
name|s
operator|=
literal|"collxfrm"
expr_stmt|;
endif|#
directive|endif
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_amagic
condition|)
name|s
operator|=
literal|"amagic"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_amagicelem
condition|)
name|s
operator|=
literal|"amagicelem"
expr_stmt|;
elseif|else
if|if
condition|(
name|v
operator|==
operator|&
name|PL_vtbl_backref
condition|)
name|s
operator|=
literal|"backref"
expr_stmt|;
if|if
condition|(
name|s
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    MG_VIRTUAL =&PL_vtbl_%s\n"
argument_list|,
argument|s
argument_list|)
empty_stmt|;
else|else
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    MG_VIRTUAL = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(v)
argument_list|)
empty_stmt|;
block|}
else|else
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    MG_VIRTUAL = 0\n"
argument_list|)
empty_stmt|;
if|if
condition|(
name|mg
operator|->
name|mg_private
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    MG_PRIVATE = %d\n"
argument_list|,
argument|mg->mg_private
argument_list|)
empty_stmt|;
if|if
condition|(
name|isPRINT
argument_list|(
name|mg
operator|->
name|mg_type
argument_list|)
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    MG_TYPE = '%c'\n"
argument_list|,
argument|mg->mg_type
argument_list|)
empty_stmt|;
else|else
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    MG_TYPE = '\\%o'\n"
argument_list|,
argument|mg->mg_type
argument_list|)
empty_stmt|;
if|if
condition|(
name|mg
operator|->
name|mg_flags
condition|)
block|{
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    MG_FLAGS = 0x%02X\n"
argument_list|,
argument|mg->mg_flags
argument_list|)
empty_stmt|;
if|if
condition|(
name|mg
operator|->
name|mg_flags
operator|&
name|MGf_TAINTEDDIR
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"      TAINTEDDIR\n"
argument_list|)
empty_stmt|;
if|if
condition|(
name|mg
operator|->
name|mg_flags
operator|&
name|MGf_REFCOUNTED
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"      REFCOUNTED\n"
argument_list|)
empty_stmt|;
if|if
condition|(
name|mg
operator|->
name|mg_flags
operator|&
name|MGf_GSKIP
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"      GSKIP\n"
argument_list|)
empty_stmt|;
if|if
condition|(
name|mg
operator|->
name|mg_flags
operator|&
name|MGf_MINMATCH
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"      MINMATCH\n"
argument_list|)
empty_stmt|;
block|}
if|if
condition|(
name|mg
operator|->
name|mg_obj
condition|)
block|{
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    MG_OBJ = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(mg->mg_obj)
argument_list|)
empty_stmt|;
if|if
condition|(
name|mg
operator|->
name|mg_flags
operator|&
name|MGf_REFCOUNTED
condition|)
name|do_sv_dump
argument_list|(
name|level
operator|+
literal|2
argument_list|,
name|file
argument_list|,
name|mg
operator|->
name|mg_obj
argument_list|,
name|nest
operator|+
literal|1
argument_list|,
name|maxnest
argument_list|,
name|dumpops
argument_list|,
name|pvlim
argument_list|)
expr_stmt|;
comment|/* MG is already +1 */
block|}
if|if
condition|(
name|mg
operator|->
name|mg_len
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    MG_LEN = %ld\n"
argument_list|,
argument|(long)mg->mg_len
argument_list|)
empty_stmt|;
if|if
condition|(
name|mg
operator|->
name|mg_ptr
condition|)
block|{
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    MG_PTR = 0x%"
argument|UVxf
argument_list|,
argument|PTR2UV(mg->mg_ptr)
argument_list|)
empty_stmt|;
if|if
condition|(
name|mg
operator|->
name|mg_len
operator|>=
literal|0
condition|)
block|{
name|SV
modifier|*
name|sv
init|=
name|newSVpvn
argument_list|(
literal|""
argument_list|,
literal|0
argument_list|)
decl_stmt|;
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|" %s"
argument_list|,
name|pv_display
argument_list|(
name|sv
argument_list|,
name|mg
operator|->
name|mg_ptr
argument_list|,
name|mg
operator|->
name|mg_len
argument_list|,
literal|0
argument_list|,
name|pvlim
argument_list|)
argument_list|)
expr_stmt|;
name|SvREFCNT_dec
argument_list|(
name|sv
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|mg
operator|->
name|mg_len
operator|==
name|HEf_SVKEY
condition|)
block|{
name|PerlIO_puts
argument_list|(
name|file
argument_list|,
literal|" => HEf_SVKEY\n"
argument_list|)
expr_stmt|;
name|do_sv_dump
argument_list|(
name|level
operator|+
literal|2
argument_list|,
name|file
argument_list|,
operator|(
name|SV
operator|*
operator|)
operator|(
operator|(
name|mg
operator|)
operator|->
name|mg_ptr
operator|)
argument_list|,
name|nest
operator|+
literal|1
argument_list|,
name|maxnest
argument_list|,
name|dumpops
argument_list|,
name|pvlim
argument_list|)
expr_stmt|;
comment|/* MG is already +1 */
continue|continue;
block|}
else|else
name|PerlIO_puts
argument_list|(
name|file
argument_list|,
literal|" ???? - please notify IZ"
argument_list|)
expr_stmt|;
name|PerlIO_putc
argument_list|(
name|file
argument_list|,
literal|'\n'
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|Perl_magic_dump
parameter_list|(
name|pTHX_
name|MAGIC
modifier|*
name|mg
parameter_list|)
block|{
name|do_magic_dump
argument_list|(
literal|0
argument_list|,
name|Perl_debug_log
argument_list|,
name|mg
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Perl_do_hv_dump
parameter_list|(
name|pTHX_
name|I32
name|level
parameter_list|,
name|PerlIO
modifier|*
name|file
parameter_list|,
name|char
modifier|*
name|name
parameter_list|,
name|HV
modifier|*
name|sv
parameter_list|)
block|{
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"%s = 0x%"
argument|UVxf
argument_list|,
argument|name
argument_list|,
argument|PTR2UV(sv)
argument_list|)
empty_stmt|;
if|if
condition|(
name|sv
operator|&&
name|HvNAME
argument_list|(
name|sv
argument_list|)
condition|)
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"\t\"%s\"\n"
argument_list|,
name|HvNAME
argument_list|(
name|sv
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|PerlIO_putc
argument_list|(
name|file
argument_list|,
literal|'\n'
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Perl_do_gv_dump
parameter_list|(
name|pTHX_
name|I32
name|level
parameter_list|,
name|PerlIO
modifier|*
name|file
parameter_list|,
name|char
modifier|*
name|name
parameter_list|,
name|GV
modifier|*
name|sv
parameter_list|)
block|{
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"%s = 0x%"
argument|UVxf
argument_list|,
argument|name
argument_list|,
argument|PTR2UV(sv)
argument_list|)
empty_stmt|;
if|if
condition|(
name|sv
operator|&&
name|GvNAME
argument_list|(
name|sv
argument_list|)
condition|)
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"\t\"%s\"\n"
argument_list|,
name|GvNAME
argument_list|(
name|sv
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|PerlIO_putc
argument_list|(
name|file
argument_list|,
literal|'\n'
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Perl_do_gvgv_dump
parameter_list|(
name|pTHX_
name|I32
name|level
parameter_list|,
name|PerlIO
modifier|*
name|file
parameter_list|,
name|char
modifier|*
name|name
parameter_list|,
name|GV
modifier|*
name|sv
parameter_list|)
block|{
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"%s = 0x%"
argument|UVxf
argument_list|,
argument|name
argument_list|,
argument|PTR2UV(sv)
argument_list|)
empty_stmt|;
if|if
condition|(
name|sv
operator|&&
name|GvNAME
argument_list|(
name|sv
argument_list|)
condition|)
block|{
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"\t\""
argument_list|)
expr_stmt|;
if|if
condition|(
name|GvSTASH
argument_list|(
name|sv
argument_list|)
operator|&&
name|HvNAME
argument_list|(
name|GvSTASH
argument_list|(
name|sv
argument_list|)
argument_list|)
condition|)
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"%s\" :: \""
argument_list|,
name|HvNAME
argument_list|(
name|GvSTASH
argument_list|(
name|sv
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"%s\"\n"
argument_list|,
name|GvNAME
argument_list|(
name|sv
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
name|PerlIO_putc
argument_list|(
name|file
argument_list|,
literal|'\n'
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Perl_do_sv_dump
parameter_list|(
name|pTHX_
name|I32
name|level
parameter_list|,
name|PerlIO
modifier|*
name|file
parameter_list|,
name|SV
modifier|*
name|sv
parameter_list|,
name|I32
name|nest
parameter_list|,
name|I32
name|maxnest
parameter_list|,
name|bool
name|dumpops
parameter_list|,
name|STRLEN
name|pvlim
parameter_list|)
block|{
name|SV
modifier|*
name|d
decl_stmt|;
name|char
modifier|*
name|s
decl_stmt|;
name|U32
name|flags
decl_stmt|;
name|U32
name|type
decl_stmt|;
name|STRLEN
name|n_a
decl_stmt|;
if|if
condition|(
operator|!
name|sv
condition|)
block|{
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"SV = 0\n"
argument_list|)
empty_stmt|;
return|return;
block|}
name|flags
operator|=
name|SvFLAGS
argument_list|(
name|sv
argument_list|)
expr_stmt|;
name|type
operator|=
name|SvTYPE
argument_list|(
name|sv
argument_list|)
expr_stmt|;
name|d
operator|=
name|Perl_newSVpvf
argument_list|(
name|aTHX_
literal|"(0x%"
name|UVxf
literal|") at 0x%"
name|UVxf
literal|"\n%*s  REFCNT = %"
name|IVdf
literal|"\n%*s  FLAGS = ("
argument_list|,
name|PTR2UV
argument_list|(
name|SvANY
argument_list|(
name|sv
argument_list|)
argument_list|)
argument_list|,
name|PTR2UV
argument_list|(
name|sv
argument_list|)
argument_list|,
call|(
name|int
call|)
argument_list|(
name|PL_dumpindent
operator|*
name|level
argument_list|)
argument_list|,
literal|""
argument_list|,
operator|(
name|IV
operator|)
name|SvREFCNT
argument_list|(
name|sv
argument_list|)
argument_list|,
call|(
name|int
call|)
argument_list|(
name|PL_dumpindent
operator|*
name|level
argument_list|)
argument_list|,
literal|""
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVs_PADBUSY
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"PADBUSY,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVs_PADTMP
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"PADTMP,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVs_PADMY
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"PADMY,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVs_TEMP
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"TEMP,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVs_OBJECT
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"OBJECT,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVs_GMG
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"GMG,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVs_SMG
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"SMG,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVs_RMG
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"RMG,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVf_IOK
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"IOK,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVf_NOK
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"NOK,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVf_POK
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"POK,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVf_ROK
condition|)
block|{
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"ROK,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|SvWEAKREF
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"WEAKREF,"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|flags
operator|&
name|SVf_OOK
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"OOK,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVf_FAKE
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"FAKE,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVf_READONLY
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"READONLY,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVf_AMAGIC
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"OVERLOAD,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVp_IOK
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"pIOK,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVp_NOK
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"pNOK,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVp_POK
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"pPOK,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|SVp_SCREAM
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"SCREAM,"
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|type
condition|)
block|{
case|case
name|SVt_PVCV
case|:
case|case
name|SVt_PVFM
case|:
if|if
condition|(
name|CvANON
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"ANON,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|CvUNIQUE
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"UNIQUE,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|CvCLONE
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"CLONE,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|CvCLONED
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"CLONED,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|CvNODEBUG
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"NODEBUG,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|SvCOMPILED
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"COMPILED,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|CvLVALUE
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"LVALUE,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|CvMETHOD
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"METHOD,"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVHV
case|:
if|if
condition|(
name|HvSHAREKEYS
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"SHAREKEYS,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|HvLAZYDEL
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"LAZYDEL,"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVGV
case|:
if|if
condition|(
name|GvINTRO
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"INTRO,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|GvMULTI
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"MULTI,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|GvASSUMECV
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"ASSUMECV,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|GvIN_PAD
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"IN_PAD,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|GvIMPORTED
argument_list|(
name|sv
argument_list|)
condition|)
block|{
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"IMPORT"
argument_list|)
expr_stmt|;
if|if
condition|(
name|GvIMPORTED
argument_list|(
name|sv
argument_list|)
operator|==
name|GVf_IMPORTED
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"ALL,"
argument_list|)
expr_stmt|;
else|else
block|{
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"("
argument_list|)
expr_stmt|;
if|if
condition|(
name|GvIMPORTED_SV
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|" SV"
argument_list|)
expr_stmt|;
if|if
condition|(
name|GvIMPORTED_AV
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|" AV"
argument_list|)
expr_stmt|;
if|if
condition|(
name|GvIMPORTED_HV
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|" HV"
argument_list|)
expr_stmt|;
if|if
condition|(
name|GvIMPORTED_CV
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|" CV"
argument_list|)
expr_stmt|;
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|" ),"
argument_list|)
expr_stmt|;
block|}
block|}
comment|/* FALL THROGH */
default|default:
if|if
condition|(
name|SvEVALED
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"EVALED,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|SvIsUV
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"IsUV,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|SvUTF8
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"UTF8"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVBM
case|:
if|if
condition|(
name|SvTAIL
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"TAIL,"
argument_list|)
expr_stmt|;
if|if
condition|(
name|SvVALID
argument_list|(
name|sv
argument_list|)
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|"VALID,"
argument_list|)
expr_stmt|;
break|break;
block|}
if|if
condition|(
operator|*
operator|(
name|SvEND
argument_list|(
name|d
argument_list|)
operator|-
literal|1
operator|)
operator|==
literal|','
condition|)
name|SvPVX
argument_list|(
name|d
argument_list|)
index|[
operator|--
name|SvCUR
argument_list|(
name|d
argument_list|)
index|]
operator|=
literal|'\0'
expr_stmt|;
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|")"
argument_list|)
expr_stmt|;
name|s
operator|=
name|SvPVX
argument_list|(
name|d
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"SV = "
argument_list|)
empty_stmt|;
switch|switch
condition|(
name|type
condition|)
block|{
case|case
name|SVt_NULL
case|:
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"NULL%s\n"
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|SvREFCNT_dec
argument_list|(
name|d
argument_list|)
expr_stmt|;
return|return;
case|case
name|SVt_IV
case|:
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"IV%s\n"
argument_list|,
name|s
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_NV
case|:
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"NV%s\n"
argument_list|,
name|s
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_RV
case|:
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"RV%s\n"
argument_list|,
name|s
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PV
case|:
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"PV%s\n"
argument_list|,
name|s
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVIV
case|:
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"PVIV%s\n"
argument_list|,
name|s
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVNV
case|:
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"PVNV%s\n"
argument_list|,
name|s
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVBM
case|:
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"PVBM%s\n"
argument_list|,
name|s
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVMG
case|:
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"PVMG%s\n"
argument_list|,
name|s
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVLV
case|:
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"PVLV%s\n"
argument_list|,
name|s
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVAV
case|:
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"PVAV%s\n"
argument_list|,
name|s
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVHV
case|:
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"PVHV%s\n"
argument_list|,
name|s
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVCV
case|:
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"PVCV%s\n"
argument_list|,
name|s
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVGV
case|:
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"PVGV%s\n"
argument_list|,
name|s
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVFM
case|:
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"PVFM%s\n"
argument_list|,
name|s
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVIO
case|:
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"PVIO%s\n"
argument_list|,
name|s
argument_list|)
expr_stmt|;
break|break;
default|default:
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"UNKNOWN(0x%"
name|UVxf
literal|") %s\n"
argument_list|,
operator|(
name|UV
operator|)
name|type
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|SvREFCNT_dec
argument_list|(
name|d
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|type
operator|>=
name|SVt_PVIV
operator|||
name|type
operator|==
name|SVt_IV
condition|)
block|{
if|if
condition|(
name|SvIsUV
argument_list|(
name|sv
argument_list|)
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  UV = %"
argument|UVuf
argument_list|,
argument|(UV)SvUVX(sv)
argument_list|)
empty_stmt|;
else|else
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  IV = %"
argument|IVdf
argument_list|,
argument|(IV)SvIVX(sv)
argument_list|)
empty_stmt|;
if|if
condition|(
name|SvOOK
argument_list|(
name|sv
argument_list|)
condition|)
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"  (OFFSET)"
argument_list|)
expr_stmt|;
name|PerlIO_putc
argument_list|(
name|file
argument_list|,
literal|'\n'
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|type
operator|>=
name|SVt_PVNV
operator|||
name|type
operator|==
name|SVt_NV
condition|)
block|{
name|STORE_NUMERIC_LOCAL_SET_STANDARD
argument_list|()
expr_stmt|;
comment|/* %Vg doesn't work? --jhi */
ifdef|#
directive|ifdef
name|USE_LONG_DOUBLE
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  NV = %.*"
argument|PERL_PRIgldbl
literal|"\n"
argument_list|,
argument|LDBL_DIG
argument_list|,
argument|SvNVX(sv)
argument_list|)
empty_stmt|;
else|#
directive|else
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  NV = %.*g\n"
argument_list|,
argument|DBL_DIG
argument_list|,
argument|SvNVX(sv)
argument_list|)
empty_stmt|;
endif|#
directive|endif
name|RESTORE_NUMERIC_LOCAL
argument_list|()
expr_stmt|;
block|}
if|if
condition|(
name|SvROK
argument_list|(
name|sv
argument_list|)
condition|)
block|{
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  RV = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(SvRV(sv))
argument_list|)
empty_stmt|;
if|if
condition|(
name|nest
operator|<
name|maxnest
condition|)
name|do_sv_dump
argument_list|(
name|level
operator|+
literal|1
argument_list|,
name|file
argument_list|,
name|SvRV
argument_list|(
name|sv
argument_list|)
argument_list|,
name|nest
operator|+
literal|1
argument_list|,
name|maxnest
argument_list|,
name|dumpops
argument_list|,
name|pvlim
argument_list|)
expr_stmt|;
name|SvREFCNT_dec
argument_list|(
name|d
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|type
operator|<
name|SVt_PV
condition|)
block|{
name|SvREFCNT_dec
argument_list|(
name|d
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|type
operator|<=
name|SVt_PVLV
condition|)
block|{
if|if
condition|(
name|SvPVX
argument_list|(
name|sv
argument_list|)
condition|)
block|{
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  PV = 0x%"
argument|UVxf
literal|" "
argument_list|,
argument|PTR2UV(SvPVX(sv))
argument_list|)
empty_stmt|;
if|if
condition|(
name|SvOOK
argument_list|(
name|sv
argument_list|)
condition|)
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"( %s . ) "
argument_list|,
name|pv_display
argument_list|(
name|d
argument_list|,
name|SvPVX
argument_list|(
name|sv
argument_list|)
operator|-
name|SvIVX
argument_list|(
name|sv
argument_list|)
argument_list|,
name|SvIVX
argument_list|(
name|sv
argument_list|)
argument_list|,
literal|0
argument_list|,
name|pvlim
argument_list|)
argument_list|)
expr_stmt|;
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"%s\n"
argument_list|,
name|pv_display
argument_list|(
name|d
argument_list|,
name|SvPVX
argument_list|(
name|sv
argument_list|)
argument_list|,
name|SvCUR
argument_list|(
name|sv
argument_list|)
argument_list|,
name|SvLEN
argument_list|(
name|sv
argument_list|)
argument_list|,
name|pvlim
argument_list|)
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  CUR = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)SvCUR(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  LEN = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)SvLEN(sv)
argument_list|)
empty_stmt|;
block|}
else|else
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  PV = 0\n"
argument_list|)
empty_stmt|;
block|}
if|if
condition|(
name|type
operator|>=
name|SVt_PVMG
condition|)
block|{
if|if
condition|(
name|SvMAGIC
argument_list|(
name|sv
argument_list|)
condition|)
name|do_magic_dump
argument_list|(
name|level
argument_list|,
name|file
argument_list|,
name|SvMAGIC
argument_list|(
name|sv
argument_list|)
argument_list|,
name|nest
argument_list|,
name|maxnest
argument_list|,
name|dumpops
argument_list|,
name|pvlim
argument_list|)
expr_stmt|;
if|if
condition|(
name|SvSTASH
argument_list|(
name|sv
argument_list|)
condition|)
name|do_hv_dump
argument_list|(
name|level
argument_list|,
name|file
argument_list|,
literal|"  STASH"
argument_list|,
name|SvSTASH
argument_list|(
name|sv
argument_list|)
argument_list|)
expr_stmt|;
block|}
switch|switch
condition|(
name|type
condition|)
block|{
case|case
name|SVt_PVLV
case|:
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  TYPE = %c\n"
argument_list|,
argument|LvTYPE(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  TARGOFF = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)LvTARGOFF(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  TARGLEN = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)LvTARGLEN(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  TARG = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(LvTARG(sv))
argument_list|)
empty_stmt|;
comment|/* XXX level+1 ??? */
name|do_sv_dump
argument_list|(
name|level
argument_list|,
name|file
argument_list|,
name|LvTARG
argument_list|(
name|sv
argument_list|)
argument_list|,
name|nest
operator|+
literal|1
argument_list|,
name|maxnest
argument_list|,
name|dumpops
argument_list|,
name|pvlim
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVAV
case|:
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  ARRAY = 0x%"
argument|UVxf
argument_list|,
argument|PTR2UV(AvARRAY(sv))
argument_list|)
empty_stmt|;
if|if
condition|(
name|AvARRAY
argument_list|(
name|sv
argument_list|)
operator|!=
name|AvALLOC
argument_list|(
name|sv
argument_list|)
condition|)
block|{
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|" (offset=%"
name|IVdf
literal|")\n"
argument_list|,
call|(
name|IV
call|)
argument_list|(
name|AvARRAY
argument_list|(
name|sv
argument_list|)
operator|-
name|AvALLOC
argument_list|(
name|sv
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  ALLOC = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(AvALLOC(sv))
argument_list|)
empty_stmt|;
block|}
else|else
name|PerlIO_putc
argument_list|(
name|file
argument_list|,
literal|'\n'
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  FILL = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)AvFILLp(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  MAX = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)AvMAX(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  ARYLEN = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(AvARYLEN(sv))
argument_list|)
empty_stmt|;
name|flags
operator|=
name|AvFLAGS
argument_list|(
name|sv
argument_list|)
expr_stmt|;
name|sv_setpv
argument_list|(
name|d
argument_list|,
literal|""
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|AVf_REAL
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|",REAL"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|AVf_REIFY
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|",REIFY"
argument_list|)
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|AVf_REUSED
condition|)
name|sv_catpv
argument_list|(
name|d
argument_list|,
literal|",REUSED"
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  FLAGS = (%s)\n"
argument_list|,
argument|SvCUR(d) ? SvPVX(d) +
literal|1
argument|:
literal|""
argument_list|)
empty_stmt|;
if|if
condition|(
name|nest
operator|<
name|maxnest
operator|&&
name|av_len
argument_list|(
operator|(
name|AV
operator|*
operator|)
name|sv
argument_list|)
operator|>=
literal|0
condition|)
block|{
name|int
name|count
decl_stmt|;
for|for
control|(
name|count
operator|=
literal|0
init|;
name|count
operator|<=
name|av_len
argument_list|(
operator|(
name|AV
operator|*
operator|)
name|sv
argument_list|)
operator|&&
name|count
operator|<
name|maxnest
condition|;
name|count
operator|++
control|)
block|{
name|SV
modifier|*
modifier|*
name|elt
init|=
name|av_fetch
argument_list|(
operator|(
name|AV
operator|*
operator|)
name|sv
argument_list|,
name|count
argument_list|,
literal|0
argument_list|)
decl_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level +
literal|1
argument_list|,
argument|file
argument_list|,
literal|"Elt No. %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)count
argument_list|)
empty_stmt|;
if|if
condition|(
name|elt
condition|)
name|do_sv_dump
argument_list|(
name|level
operator|+
literal|1
argument_list|,
name|file
argument_list|,
operator|*
name|elt
argument_list|,
name|nest
operator|+
literal|1
argument_list|,
name|maxnest
argument_list|,
name|dumpops
argument_list|,
name|pvlim
argument_list|)
expr_stmt|;
block|}
block|}
break|break;
case|case
name|SVt_PVHV
case|:
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  ARRAY = 0x%"
argument|UVxf
argument_list|,
argument|PTR2UV(HvARRAY(sv))
argument_list|)
empty_stmt|;
if|if
condition|(
name|HvARRAY
argument_list|(
name|sv
argument_list|)
operator|&&
name|HvKEYS
argument_list|(
name|sv
argument_list|)
condition|)
block|{
comment|/* Show distribution of HEs in the ARRAY */
name|int
name|freq
index|[
literal|200
index|]
decl_stmt|;
define|#
directive|define
name|FREQ_MAX
value|(sizeof freq / sizeof freq[0] - 1)
name|int
name|i
decl_stmt|;
name|int
name|max
init|=
literal|0
decl_stmt|;
name|U32
name|pow2
init|=
literal|2
decl_stmt|,
name|keys
init|=
name|HvKEYS
argument_list|(
name|sv
argument_list|)
decl_stmt|;
name|NV
name|theoret
decl_stmt|,
name|sum
init|=
literal|0
decl_stmt|;
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"  ("
argument_list|)
expr_stmt|;
name|Zero
argument_list|(
name|freq
argument_list|,
name|FREQ_MAX
operator|+
literal|1
argument_list|,
name|int
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<=
name|HvMAX
argument_list|(
name|sv
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
name|HE
modifier|*
name|h
decl_stmt|;
name|int
name|count
init|=
literal|0
decl_stmt|;
for|for
control|(
name|h
operator|=
name|HvARRAY
argument_list|(
name|sv
argument_list|)
index|[
name|i
index|]
init|;
name|h
condition|;
name|h
operator|=
name|HeNEXT
argument_list|(
name|h
argument_list|)
control|)
name|count
operator|++
expr_stmt|;
if|if
condition|(
name|count
operator|>
name|FREQ_MAX
condition|)
name|count
operator|=
name|FREQ_MAX
expr_stmt|;
name|freq
index|[
name|count
index|]
operator|++
expr_stmt|;
if|if
condition|(
name|max
operator|<
name|count
condition|)
name|max
operator|=
name|count
expr_stmt|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<=
name|max
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|freq
index|[
name|i
index|]
condition|)
block|{
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|"%d%s:%d"
argument_list|,
name|i
argument_list|,
operator|(
name|i
operator|==
name|FREQ_MAX
operator|)
condition|?
literal|"+"
else|:
literal|""
argument_list|,
name|freq
index|[
name|i
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|i
operator|!=
name|max
condition|)
name|PerlIO_printf
argument_list|(
name|file
argument_list|,
literal|", "
argument_list|)
expr_stmt|;
block|}
block|}
name|PerlIO_putc
argument_list|(
name|file
argument_list|,
literal|')'
argument_list|)
expr_stmt|;
comment|/* Now calculate quality wrt theoretical value */
for|for
control|(
name|i
operator|=
name|max
init|;
name|i
operator|>
literal|0
condition|;
name|i
operator|--
control|)
block|{
comment|/* Precision: count down. */
name|sum
operator|+=
name|freq
index|[
name|i
index|]
operator|*
name|i
operator|*
name|i
expr_stmt|;
block|}
while|while
condition|(
operator|(
name|keys
operator|=
name|keys
operator|>>
literal|1
operator|)
condition|)
name|pow2
operator|=
name|pow2
operator|<<
literal|1
expr_stmt|;
comment|/* Approximate by Poisson distribution */
name|theoret
operator|=
name|HvKEYS
argument_list|(
name|sv
argument_list|)
expr_stmt|;
name|theoret
operator|+=
name|theoret
operator|*
name|theoret
operator|/
name|pow2
expr_stmt|;
name|PerlIO_putc
argument_list|(
name|file
argument_list|,
literal|'\n'
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  hash quality = %.1"
argument|NVff
literal|"%%"
argument_list|,
argument|theoret/sum*
literal|100
argument_list|)
empty_stmt|;
block|}
name|PerlIO_putc
argument_list|(
name|file
argument_list|,
literal|'\n'
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  KEYS = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)HvKEYS(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  FILL = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)HvFILL(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  MAX = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)HvMAX(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  RITER = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)HvRITER(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  EITER = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(HvEITER(sv))
argument_list|)
empty_stmt|;
if|if
condition|(
name|HvPMROOT
argument_list|(
name|sv
argument_list|)
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  PMROOT = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(HvPMROOT(sv))
argument_list|)
empty_stmt|;
if|if
condition|(
name|HvNAME
argument_list|(
name|sv
argument_list|)
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  NAME = \"%s\"\n"
argument_list|,
argument|HvNAME(sv)
argument_list|)
empty_stmt|;
if|if
condition|(
name|nest
operator|<
name|maxnest
operator|&&
operator|!
name|HvEITER
argument_list|(
name|sv
argument_list|)
condition|)
block|{
comment|/* Try to preserve iterator */
name|HE
modifier|*
name|he
decl_stmt|;
name|HV
modifier|*
name|hv
init|=
operator|(
name|HV
operator|*
operator|)
name|sv
decl_stmt|;
name|int
name|count
init|=
name|maxnest
operator|-
name|nest
decl_stmt|;
name|hv_iterinit
argument_list|(
name|hv
argument_list|)
expr_stmt|;
while|while
condition|(
operator|(
name|he
operator|=
name|hv_iternext
argument_list|(
name|hv
argument_list|)
operator|)
operator|&&
name|count
operator|--
condition|)
block|{
name|SV
modifier|*
name|elt
decl_stmt|;
name|char
modifier|*
name|key
decl_stmt|;
name|I32
name|len
decl_stmt|;
name|U32
name|hash
init|=
name|HeHASH
argument_list|(
name|he
argument_list|)
decl_stmt|;
name|key
operator|=
name|hv_iterkey
argument_list|(
name|he
argument_list|,
operator|&
name|len
argument_list|)
expr_stmt|;
name|elt
operator|=
name|hv_iterval
argument_list|(
name|hv
argument_list|,
name|he
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level+
literal|1
argument_list|,
argument|file
argument_list|,
literal|"Elt %s HASH = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|pv_display(d, key, len,
literal|0
argument|, pvlim)
argument_list|,
argument|(UV)hash
argument_list|)
empty_stmt|;
name|do_sv_dump
argument_list|(
name|level
operator|+
literal|1
argument_list|,
name|file
argument_list|,
name|elt
argument_list|,
name|nest
operator|+
literal|1
argument_list|,
name|maxnest
argument_list|,
name|dumpops
argument_list|,
name|pvlim
argument_list|)
expr_stmt|;
block|}
name|hv_iterinit
argument_list|(
name|hv
argument_list|)
expr_stmt|;
comment|/* Return to status quo */
block|}
break|break;
case|case
name|SVt_PVCV
case|:
if|if
condition|(
name|SvPOK
argument_list|(
name|sv
argument_list|)
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  PROTOTYPE = \"%s\"\n"
argument_list|,
argument|SvPV(sv,n_a)
argument_list|)
empty_stmt|;
comment|/* FALL THROUGH */
case|case
name|SVt_PVFM
case|:
name|do_hv_dump
argument_list|(
name|level
argument_list|,
name|file
argument_list|,
literal|"  COMP_STASH"
argument_list|,
name|CvSTASH
argument_list|(
name|sv
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|CvSTART
argument_list|(
name|sv
argument_list|)
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  START = 0x%"
argument|UVxf
literal|" ===> %"
argument|IVdf
literal|"\n"
argument_list|,
argument|PTR2UV(CvSTART(sv))
argument_list|,
argument|(IV)CvSTART(sv)->op_seq
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  ROOT = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(CvROOT(sv))
argument_list|)
empty_stmt|;
if|if
condition|(
name|CvROOT
argument_list|(
name|sv
argument_list|)
operator|&&
name|dumpops
condition|)
name|do_op_dump
argument_list|(
name|level
operator|+
literal|1
argument_list|,
name|file
argument_list|,
name|CvROOT
argument_list|(
name|sv
argument_list|)
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  XSUB = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(CvXSUB(sv))
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  XSUBANY = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)CvXSUBANY(sv).any_i32
argument_list|)
empty_stmt|;
name|do_gvgv_dump
argument_list|(
name|level
argument_list|,
name|file
argument_list|,
literal|"  GVGV::GV"
argument_list|,
name|CvGV
argument_list|(
name|sv
argument_list|)
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  FILE = \"%s\"\n"
argument_list|,
argument|CvFILE(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  DEPTH = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)CvDEPTH(sv)
argument_list|)
empty_stmt|;
ifdef|#
directive|ifdef
name|USE_THREADS
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  MUTEXP = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(CvMUTEXP(sv))
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  OWNER = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(CvOWNER(sv))
argument_list|)
empty_stmt|;
endif|#
directive|endif
comment|/* USE_THREADS */
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  FLAGS = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|(UV)CvFLAGS(sv)
argument_list|)
empty_stmt|;
if|if
condition|(
name|type
operator|==
name|SVt_PVFM
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  LINES = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)FmLINES(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  PADLIST = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(CvPADLIST(sv))
argument_list|)
empty_stmt|;
if|if
condition|(
name|nest
operator|<
name|maxnest
operator|&&
name|CvPADLIST
argument_list|(
name|sv
argument_list|)
condition|)
block|{
name|AV
modifier|*
name|padlist
init|=
name|CvPADLIST
argument_list|(
name|sv
argument_list|)
decl_stmt|;
name|AV
modifier|*
name|pad_name
init|=
operator|(
name|AV
operator|*
operator|)
operator|*
name|av_fetch
argument_list|(
name|padlist
argument_list|,
literal|0
argument_list|,
name|FALSE
argument_list|)
decl_stmt|;
name|AV
modifier|*
name|pad
init|=
operator|(
name|AV
operator|*
operator|)
operator|*
name|av_fetch
argument_list|(
name|padlist
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
decl_stmt|;
name|SV
modifier|*
modifier|*
name|pname
init|=
name|AvARRAY
argument_list|(
name|pad_name
argument_list|)
decl_stmt|;
name|SV
modifier|*
modifier|*
name|ppad
init|=
name|AvARRAY
argument_list|(
name|pad
argument_list|)
decl_stmt|;
name|I32
name|ix
decl_stmt|;
for|for
control|(
name|ix
operator|=
literal|1
init|;
name|ix
operator|<=
name|AvFILL
argument_list|(
name|pad_name
argument_list|)
condition|;
name|ix
operator|++
control|)
block|{
if|if
condition|(
name|SvPOK
argument_list|(
name|pname
index|[
name|ix
index|]
argument_list|)
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
comment|/* %5d below is enough whitespace. */
argument|file
argument_list|,
literal|"%5d. 0x%"
argument|UVxf
literal|" (%s\"%s\" %"
argument|IVdf
literal|"-%"
argument|IVdf
literal|")\n"
argument_list|,
argument|(int)ix
argument_list|,
argument|PTR2UV(ppad[ix])
argument_list|,
argument|SvFAKE(pname[ix]) ?
literal|"FAKE "
argument|:
literal|""
argument_list|,
argument|SvPVX(pname[ix])
argument_list|,
argument|(IV)SvNVX(pname[ix])
argument_list|,
argument|(IV)SvIVX(pname[ix])
argument_list|)
empty_stmt|;
block|}
block|}
block|{
name|CV
modifier|*
name|outside
init|=
name|CvOUTSIDE
argument_list|(
name|sv
argument_list|)
decl_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  OUTSIDE = 0x%"
argument|UVxf
literal|" (%s)\n"
argument_list|,
argument|PTR2UV(outside)
argument_list|,
argument|(!outside ?
literal|"null"
argument|: CvANON(outside) ?
literal|"ANON"
argument|: (outside == PL_main_cv) ?
literal|"MAIN"
argument|: CvUNIQUE(outside) ?
literal|"UNIQUE"
argument|: CvGV(outside) ? GvNAME(CvGV(outside)) :
literal|"UNDEFINED"
argument|)
argument_list|)
empty_stmt|;
block|}
if|if
condition|(
name|nest
operator|<
name|maxnest
operator|&&
operator|(
name|CvCLONE
argument_list|(
name|sv
argument_list|)
operator|||
name|CvCLONED
argument_list|(
name|sv
argument_list|)
operator|)
condition|)
name|do_sv_dump
argument_list|(
name|level
operator|+
literal|1
argument_list|,
name|file
argument_list|,
operator|(
name|SV
operator|*
operator|)
name|CvOUTSIDE
argument_list|(
name|sv
argument_list|)
argument_list|,
name|nest
operator|+
literal|1
argument_list|,
name|maxnest
argument_list|,
name|dumpops
argument_list|,
name|pvlim
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVGV
case|:
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  NAME = \"%s\"\n"
argument_list|,
argument|GvNAME(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  NAMELEN = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)GvNAMELEN(sv)
argument_list|)
empty_stmt|;
name|do_hv_dump
argument_list|(
name|level
argument_list|,
name|file
argument_list|,
literal|"  GvSTASH"
argument_list|,
name|GvSTASH
argument_list|(
name|sv
argument_list|)
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  GP = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(GvGP(sv))
argument_list|)
empty_stmt|;
if|if
condition|(
operator|!
name|GvGP
argument_list|(
name|sv
argument_list|)
condition|)
break|break;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    SV = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(GvSV(sv))
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    REFCNT = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)GvREFCNT(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    IO = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(GvIOp(sv))
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    FORM = 0x%"
argument|UVxf
literal|"  \n"
argument_list|,
argument|PTR2UV(GvFORM(sv))
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    AV = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(GvAV(sv))
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    HV = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(GvHV(sv))
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    CV = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(GvCV(sv))
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    CVGEN = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|(UV)GvCVGEN(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    GPFLAGS = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|(UV)GvGPFLAGS(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    LINE = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)GvLINE(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    FILE = \"%s\"\n"
argument_list|,
argument|GvFILE(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"    FLAGS = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|(UV)GvFLAGS(sv)
argument_list|)
empty_stmt|;
name|do_gv_dump
argument_list|(
name|level
argument_list|,
name|file
argument_list|,
literal|"    EGV"
argument_list|,
name|GvEGV
argument_list|(
name|sv
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|SVt_PVIO
case|:
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  IFP = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(IoIFP(sv))
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  OFP = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(IoOFP(sv))
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  DIRP = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|PTR2UV(IoDIRP(sv))
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  LINES = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)IoLINES(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  PAGE = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)IoPAGE(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  PAGE_LEN = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)IoPAGE_LEN(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  LINES_LEFT = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)IoLINES_LEFT(sv)
argument_list|)
empty_stmt|;
if|if
condition|(
name|IoTOP_NAME
argument_list|(
name|sv
argument_list|)
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  TOP_NAME = \"%s\"\n"
argument_list|,
argument|IoTOP_NAME(sv)
argument_list|)
empty_stmt|;
name|do_gv_dump
argument_list|(
name|level
argument_list|,
name|file
argument_list|,
literal|"  TOP_GV"
argument_list|,
name|IoTOP_GV
argument_list|(
name|sv
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|IoFMT_NAME
argument_list|(
name|sv
argument_list|)
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  FMT_NAME = \"%s\"\n"
argument_list|,
argument|IoFMT_NAME(sv)
argument_list|)
empty_stmt|;
name|do_gv_dump
argument_list|(
name|level
argument_list|,
name|file
argument_list|,
literal|"  FMT_GV"
argument_list|,
name|IoFMT_GV
argument_list|(
name|sv
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|IoBOTTOM_NAME
argument_list|(
name|sv
argument_list|)
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  BOTTOM_NAME = \"%s\"\n"
argument_list|,
argument|IoBOTTOM_NAME(sv)
argument_list|)
empty_stmt|;
name|do_gv_dump
argument_list|(
name|level
argument_list|,
name|file
argument_list|,
literal|"  BOTTOM_GV"
argument_list|,
name|IoBOTTOM_GV
argument_list|(
name|sv
argument_list|)
argument_list|)
expr_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  SUBPROCESS = %"
argument|IVdf
literal|"\n"
argument_list|,
argument|(IV)IoSUBPROCESS(sv)
argument_list|)
empty_stmt|;
if|if
condition|(
name|isPRINT
argument_list|(
name|IoTYPE
argument_list|(
name|sv
argument_list|)
argument_list|)
condition|)
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  TYPE = '%c'\n"
argument_list|,
argument|IoTYPE(sv)
argument_list|)
empty_stmt|;
else|else
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  TYPE = '\\%o'\n"
argument_list|,
argument|IoTYPE(sv)
argument_list|)
empty_stmt|;
name|Perl_dump_indent
argument_list|(
argument|aTHX_ level
argument_list|,
argument|file
argument_list|,
literal|"  FLAGS = 0x%"
argument|UVxf
literal|"\n"
argument_list|,
argument|(UV)IoFLAGS(sv)
argument_list|)
empty_stmt|;
break|break;
block|}
name|SvREFCNT_dec
argument_list|(
name|d
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Perl_sv_dump
parameter_list|(
name|pTHX_
name|SV
modifier|*
name|sv
parameter_list|)
block|{
name|do_sv_dump
argument_list|(
literal|0
argument_list|,
name|Perl_debug_log
argument_list|,
name|sv
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

