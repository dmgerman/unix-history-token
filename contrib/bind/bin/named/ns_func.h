begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (c) 1985, 1990  *    The Regents of the University of California.  All rights reserved.  *   * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  * 3. All advertising materials mentioning features or use of this software  *    must display the following acknowledgement:  * 	This product includes software developed by the University of  * 	California, Berkeley and its contributors.  * 4. Neither the name of the University nor the names of its contributors  *    may be used to endorse or promote products derived from this software  *    without specific prior written permission.  *   * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  */
end_comment

begin_comment
comment|/*  * Portions Copyright (c) 1993 by Digital Equipment Corporation.  *   * Permission to use, copy, modify, and distribute this software for any  * purpose with or without fee is hereby granted, provided that the above  * copyright notice and this permission notice appear in all copies, and that  * the name of Digital Equipment Corporation not be used in advertising or  * publicity pertaining to distribution of the document or software without  * specific, written prior permission.  *   * THE SOFTWARE IS PROVIDED "AS IS" AND DIGITAL EQUIPMENT CORP. DISCLAIMS ALL  * WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES  * OF MERCHANTABILITY AND FITNESS.   IN NO EVENT SHALL DIGITAL EQUIPMENT  * CORPORATION BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL  * DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR  * PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS  * ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS  * SOFTWARE.  */
end_comment

begin_comment
comment|/*  * Portions Copyright (c) 1996-2000 by Internet Software Consortium.  *  * Permission to use, copy, modify, and distribute this software for any  * purpose with or without fee is hereby granted, provided that the above  * copyright notice and this permission notice appear in all copies.  *  * THE SOFTWARE IS PROVIDED "AS IS" AND INTERNET SOFTWARE CONSORTIUM DISCLAIMS  * ALL WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES  * OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL INTERNET SOFTWARE  * CONSORTIUM BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL  * DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR  * PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS  * ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS  * SOFTWARE.  */
end_comment

begin_comment
comment|/*  * Portions Copyright (c) 1999 by Check Point Software Technologies, Inc.  *   * Permission to use, copy, modify, and distribute this software for any  * purpose with or without fee is hereby granted, provided that the above  * copyright notice and this permission notice appear in all copies, and that  * the name of Check Point Software Technologies Incorporated not be used   * in advertising or publicity pertaining to distribution of the document   * or software without specific, written prior permission.  *   * THE SOFTWARE IS PROVIDED "AS IS" AND CHECK POINT SOFTWARE TECHNOLOGIES   * INCORPORATED DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE,   * INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS.     * IN NO EVENT SHALL CHECK POINT SOFTWARE TECHNOLOGIES INCORPRATED  * BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR   * ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER  * IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT   * OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.  */
end_comment

begin_comment
comment|/* ns_func.h - declarations for ns_*.c's externally visible functions  *  * $Id: ns_func.h,v 8.117 2002/04/25 05:27:07 marka Exp $  */
end_comment

begin_comment
comment|/* ++from ns_glue.c++ */
end_comment

begin_function_decl
name|struct
name|in_addr
name|ina_get
parameter_list|(
specifier|const
name|u_char
modifier|*
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|const
name|char
modifier|*
name|sin_ntoa
parameter_list|(
name|struct
name|sockaddr_in
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ns_wouldlog
parameter_list|(
name|int
name|category
parameter_list|,
name|int
name|level
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_debug
parameter_list|(
name|int
parameter_list|,
name|int
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
modifier|...
parameter_list|)
function_decl|ISC_FORMAT_PRINTF
parameter_list|(
function_decl|3
operator|,
function_decl|4
end_function_decl

begin_empty_stmt
unit|)
empty_stmt|;
end_empty_stmt

begin_function_decl
name|void
name|ns_info
parameter_list|(
name|int
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
modifier|...
parameter_list|)
function_decl|ISC_FORMAT_PRINTF
parameter_list|(
function_decl|2
operator|,
function_decl|3
end_function_decl

begin_empty_stmt
unit|)
empty_stmt|;
end_empty_stmt

begin_function_decl
name|void
name|ns_notice
parameter_list|(
name|int
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
modifier|...
parameter_list|)
function_decl|ISC_FORMAT_PRINTF
parameter_list|(
function_decl|2
operator|,
function_decl|3
end_function_decl

begin_empty_stmt
unit|)
empty_stmt|;
end_empty_stmt

begin_function_decl
name|void
name|ns_warning
parameter_list|(
name|int
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
modifier|...
parameter_list|)
function_decl|ISC_FORMAT_PRINTF
parameter_list|(
function_decl|2
operator|,
function_decl|3
end_function_decl

begin_empty_stmt
unit|)
empty_stmt|;
end_empty_stmt

begin_function_decl
name|void
name|ns_error
parameter_list|(
name|int
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
modifier|...
parameter_list|)
function_decl|ISC_FORMAT_PRINTF
parameter_list|(
function_decl|2
operator|,
function_decl|3
end_function_decl

begin_empty_stmt
unit|)
empty_stmt|;
end_empty_stmt

begin_function_decl
name|void
name|ns_critical
parameter_list|(
name|int
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
modifier|...
parameter_list|)
function_decl|ISC_FORMAT_PRINTF
parameter_list|(
function_decl|2
operator|,
function_decl|3
end_function_decl

begin_empty_stmt
unit|)
empty_stmt|;
end_empty_stmt

begin_function_decl
name|void
name|ns_panic
parameter_list|(
name|int
parameter_list|,
name|int
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
modifier|...
parameter_list|)
function_decl|ISC_FORMAT_PRINTF
parameter_list|(
function_decl|3
operator|,
function_decl|4
end_function_decl

begin_empty_stmt
unit|)
empty_stmt|;
end_empty_stmt

begin_function_decl
name|void
name|ns_assertion_failed
parameter_list|(
specifier|const
name|char
modifier|*
name|file
parameter_list|,
name|int
name|line
parameter_list|,
name|assertion_type
name|type
parameter_list|,
specifier|const
name|char
modifier|*
name|cond
parameter_list|,
name|int
name|print_errno
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|panic
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
specifier|const
name|void
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gettime
parameter_list|(
name|struct
name|timeval
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|nlabels
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|my_close
parameter_list|(
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|my_fclose
parameter_list|(
name|FILE
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
modifier|*
name|__freestr
parameter_list|(
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|char
modifier|*
name|__newstr
parameter_list|(
name|size_t
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|char
modifier|*
name|__savestr
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|const
name|char
modifier|*
name|checked_ctime
parameter_list|(
specifier|const
name|time_t
modifier|*
name|t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|const
name|char
modifier|*
name|ctimel
parameter_list|(
name|long
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
modifier|*
name|__freestr_record
parameter_list|(
name|char
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|char
modifier|*
name|__newstr_record
parameter_list|(
name|size_t
parameter_list|,
name|int
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|char
modifier|*
name|__savestr_record
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|int
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|u_char
modifier|*
name|ina_put
parameter_list|(
name|struct
name|in_addr
name|ina
parameter_list|,
name|u_char
modifier|*
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|u_char
modifier|*
name|savebuf
parameter_list|(
specifier|const
name|u_char
modifier|*
parameter_list|,
name|size_t
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|dprintf
parameter_list|(
name|int
name|level
parameter_list|,
specifier|const
name|char
modifier|*
name|format
parameter_list|,
modifier|...
parameter_list|)
function_decl|ISC_FORMAT_PRINTF
parameter_list|(
function_decl|2
operator|,
function_decl|3
end_function_decl

begin_empty_stmt
unit|)
empty_stmt|;
end_empty_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|DEBUG_STRINGS
end_ifdef

begin_function_decl
name|char
modifier|*
name|debug_newstr
parameter_list|(
name|size_t
parameter_list|,
name|int
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|char
modifier|*
name|debug_savestr
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|int
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
modifier|*
name|debug_freestr
parameter_list|(
name|char
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_define
define|#
directive|define
name|newstr
parameter_list|(
name|l
parameter_list|,
name|n
parameter_list|)
value|debug_newstr((l), (n), __FILE__, __LINE__)
end_define

begin_define
define|#
directive|define
name|savestr
parameter_list|(
name|s
parameter_list|,
name|n
parameter_list|)
value|debug_savestr((s), (n), __FILE__, __LINE__)
end_define

begin_define
define|#
directive|define
name|freestr
parameter_list|(
name|s
parameter_list|)
value|debug_freestr((s), __FILE__, __LINE__)
end_define

begin_else
else|#
directive|else
end_else

begin_ifdef
ifdef|#
directive|ifdef
name|RECORD_STRINGS
end_ifdef

begin_define
define|#
directive|define
name|newstr
parameter_list|(
name|l
parameter_list|,
name|n
parameter_list|)
value|__newstr_record((l), (n), __FILE__, __LINE__)
end_define

begin_define
define|#
directive|define
name|savestr
parameter_list|(
name|s
parameter_list|,
name|n
parameter_list|)
value|__savestr_record((s), (n), __FILE__, __LINE__)
end_define

begin_define
define|#
directive|define
name|freestr
parameter_list|(
name|s
parameter_list|)
value|__freestr_record((s), __FILE__, __LINE__)
end_define

begin_else
else|#
directive|else
end_else

begin_define
define|#
directive|define
name|newstr
parameter_list|(
name|l
parameter_list|,
name|n
parameter_list|)
value|__newstr((l), (n))
end_define

begin_define
define|#
directive|define
name|savestr
parameter_list|(
name|s
parameter_list|,
name|n
parameter_list|)
value|__savestr((s), (n))
end_define

begin_define
define|#
directive|define
name|freestr
parameter_list|(
name|s
parameter_list|)
value|__freestr((s))
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* DEBUG_STRINGS */
end_comment

begin_comment
comment|/* --from ns_glue.c-- */
end_comment

begin_comment
comment|/* ++from ns_notify.c++ */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|BIND_NOTIFY
end_ifdef

begin_function_decl
name|void
name|ns_notify
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|ns_class
parameter_list|,
name|ns_type
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|notify_afterload
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_unnotify
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_stopnotify
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|ns_class
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* --from ns_notify.c-- */
end_comment

begin_comment
comment|/* ++from ns_resp.c++ */
end_comment

begin_function_decl
name|void
name|ns_resp
parameter_list|(
name|u_char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|struct
name|sockaddr_in
parameter_list|,
name|struct
name|qstream
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|prime_cache
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|delete_all
parameter_list|(
name|struct
name|namebuf
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|delete_stale
parameter_list|(
name|struct
name|namebuf
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|qinfo
modifier|*
name|sysquery
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|struct
name|in_addr
modifier|*
parameter_list|,
name|struct
name|dst_key
modifier|*
modifier|*
name|keys
parameter_list|,
name|int
parameter_list|,
name|u_int16_t
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|doupdate
parameter_list|(
name|u_char
modifier|*
parameter_list|,
name|u_char
modifier|*
parameter_list|,
name|struct
name|databuf
modifier|*
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|u_int
parameter_list|,
name|struct
name|sockaddr_in
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|send_msg
parameter_list|(
name|u_char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|struct
name|qinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|findns
parameter_list|(
name|struct
name|namebuf
modifier|*
modifier|*
parameter_list|,
name|int
parameter_list|,
name|struct
name|databuf
modifier|*
modifier|*
parameter_list|,
name|int
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|finddata
parameter_list|(
name|struct
name|namebuf
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|HEADER
modifier|*
parameter_list|,
name|char
modifier|*
modifier|*
parameter_list|,
name|int
modifier|*
parameter_list|,
name|int
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|add_data
parameter_list|(
name|struct
name|namebuf
modifier|*
parameter_list|,
name|struct
name|databuf
modifier|*
modifier|*
parameter_list|,
name|u_char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|trunc_adjust
parameter_list|(
name|u_char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* --from ns_resp.c-- */
end_comment

begin_comment
comment|/* ++from ns_req.c++ */
end_comment

begin_function_decl
name|int
name|ns_get_opt
parameter_list|(
name|u_char
modifier|*
name|msg
parameter_list|,
name|u_char
modifier|*
name|eom
parameter_list|,
name|u_int8_t
modifier|*
name|versionp
parameter_list|,
name|u_int16_t
modifier|*
name|rcodep
parameter_list|,
name|u_int16_t
modifier|*
name|flagp
parameter_list|,
name|u_int16_t
modifier|*
name|bufsizep
parameter_list|,
name|u_char
modifier|*
modifier|*
name|optionsp
parameter_list|,
name|size_t
modifier|*
name|optsizep
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ns_add_opt
parameter_list|(
name|u_char
modifier|*
name|msg
parameter_list|,
name|u_char
modifier|*
name|cp
parameter_list|,
name|size_t
name|buflen
parameter_list|,
name|u_int8_t
name|version
parameter_list|,
name|u_int16_t
name|rcode
parameter_list|,
name|u_int16_t
name|size
parameter_list|,
name|u_int16_t
name|flags
parameter_list|,
name|u_char
modifier|*
name|options
parameter_list|,
name|size_t
name|optlen
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_req
parameter_list|(
name|u_char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|struct
name|qstream
modifier|*
parameter_list|,
name|struct
name|sockaddr_in
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|free_addinfo
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|free_nsp
parameter_list|(
name|struct
name|databuf
modifier|*
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|stale
parameter_list|(
name|struct
name|databuf
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|make_rr
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|struct
name|databuf
modifier|*
parameter_list|,
name|u_char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|u_char
modifier|*
modifier|*
parameter_list|,
name|u_char
modifier|*
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|doaddinfo
parameter_list|(
name|HEADER
modifier|*
parameter_list|,
name|u_char
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|doaddauth
parameter_list|(
name|HEADER
modifier|*
parameter_list|,
name|u_char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|struct
name|namebuf
modifier|*
parameter_list|,
name|struct
name|databuf
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_ifdef
ifdef|#
directive|ifdef
name|BIND_NOTIFY
end_ifdef

begin_function_decl
name|int
name|findZonePri
parameter_list|(
specifier|const
name|struct
name|zoneinfo
modifier|*
parameter_list|,
specifier|const
name|struct
name|sockaddr_in
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_function_decl
name|int
name|drop_port
parameter_list|(
name|u_int16_t
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* --from ns_req.c-- */
end_comment

begin_comment
comment|/* ++from ns_xfr.c++ */
end_comment

begin_function_decl
name|void
name|ns_xfr
parameter_list|(
name|struct
name|qstream
modifier|*
name|qsp
parameter_list|,
name|struct
name|namebuf
modifier|*
name|znp
parameter_list|,
name|int
name|zone
parameter_list|,
name|int
name|class
parameter_list|,
name|int
name|type
parameter_list|,
name|int
name|id
parameter_list|,
name|int
name|opcode
parameter_list|,
name|u_int32_t
name|serial_ixfr
parameter_list|,
name|struct
name|tsig_record
modifier|*
name|in_tsig
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_stopxfrs
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_freexfr
parameter_list|(
name|struct
name|qstream
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|sx_newmsg
parameter_list|(
name|struct
name|qstream
modifier|*
name|qsp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|sx_sendlev
parameter_list|(
name|struct
name|qstream
modifier|*
name|qsp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|sx_sendsoa
parameter_list|(
name|struct
name|qstream
modifier|*
name|qsp
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* --from ns_xfr.c-- */
end_comment

begin_comment
comment|/* ++from ns_ctl.c++ */
end_comment

begin_function_decl
name|void
name|ns_ctl_initialize
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_ctl_shutdown
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_ctl_defaults
parameter_list|(
name|controls
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_ctl_add
parameter_list|(
name|controls
modifier|*
parameter_list|,
name|control
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|control
name|ns_ctl_new_inet
parameter_list|(
name|struct
name|in_addr
parameter_list|,
name|u_int
parameter_list|,
name|ip_match_list
parameter_list|)
function_decl|;
end_function_decl

begin_ifndef
ifndef|#
directive|ifndef
name|NO_SOCKADDR_UN
end_ifndef

begin_function_decl
name|control
name|ns_ctl_new_unix
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|mode_t
parameter_list|,
name|uid_t
parameter_list|,
name|gid_t
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_function_decl
name|void
name|ns_ctl_install
parameter_list|(
name|controls
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* --from ns_ctl.c-- */
end_comment

begin_comment
comment|/* ++from ns_ixfr.c++ */
end_comment

begin_function_decl
name|void
name|sx_send_ixfr
parameter_list|(
name|struct
name|qstream
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ixfr_log_maint
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* --from ns_ixfr.c-- */
end_comment

begin_comment
comment|/* ++from ns_forw.c++ */
end_comment

begin_function_decl
name|time_t
name|retrytime
parameter_list|(
name|struct
name|qinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ns_forw
parameter_list|(
name|struct
name|databuf
modifier|*
name|nsp
index|[]
parameter_list|,
name|u_char
modifier|*
name|msg
parameter_list|,
name|int
name|msglen
parameter_list|,
name|struct
name|sockaddr_in
name|from
parameter_list|,
name|struct
name|qstream
modifier|*
name|qsp
parameter_list|,
name|int
name|dfd
parameter_list|,
name|struct
name|qinfo
modifier|*
modifier|*
name|qpp
parameter_list|,
specifier|const
name|char
modifier|*
name|dname
parameter_list|,
name|int
name|class
parameter_list|,
name|int
name|type
parameter_list|,
name|struct
name|namebuf
modifier|*
name|np
parameter_list|,
name|int
name|use_tcp
parameter_list|,
name|struct
name|tsig_record
modifier|*
name|in_tsig
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|haveComplained
parameter_list|(
name|u_long
parameter_list|,
name|u_long
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|nslookup
parameter_list|(
name|struct
name|databuf
modifier|*
name|nsp
index|[]
parameter_list|,
name|struct
name|qinfo
modifier|*
name|qp
parameter_list|,
specifier|const
name|char
modifier|*
name|syslogdname
parameter_list|,
specifier|const
name|char
modifier|*
name|sysloginfo
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|qcomp
parameter_list|(
name|struct
name|qserv
modifier|*
parameter_list|,
name|struct
name|qserv
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|schedretry
parameter_list|(
name|struct
name|qinfo
modifier|*
parameter_list|,
name|time_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|unsched
parameter_list|(
name|struct
name|qinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|reset_retrytimer
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|retrytimer
parameter_list|(
name|evContext
name|ctx
parameter_list|,
name|void
modifier|*
name|uap
parameter_list|,
name|struct
name|timespec
name|due
parameter_list|,
name|struct
name|timespec
name|ival
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|retry
parameter_list|(
name|struct
name|qinfo
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|qflush
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|qremove
parameter_list|(
name|struct
name|qinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_freeqns
parameter_list|(
name|struct
name|qinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_freeqry
parameter_list|(
name|struct
name|qinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|freeComplaints
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|nsfwdadd
parameter_list|(
name|struct
name|qinfo
modifier|*
parameter_list|,
name|struct
name|fwdinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|qinfo
modifier|*
name|qfindid
parameter_list|(
name|u_int16_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|qinfo
modifier|*
name|qnew
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* --from ns_forw.c-- */
end_comment

begin_comment
comment|/* ++from ns_main.c++ */
end_comment

begin_function_decl
name|void
name|toggle_qrylog
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|in_addr
name|net_mask
parameter_list|(
name|struct
name|in_addr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|sq_remove
parameter_list|(
name|struct
name|qstream
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|sq_flushw
parameter_list|(
name|struct
name|qstream
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|sq_flush
parameter_list|(
name|struct
name|qstream
modifier|*
name|allbut
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|dq_remove_gen
parameter_list|(
name|time_t
name|gen
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|dq_remove_all
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|sq_done
parameter_list|(
name|struct
name|qstream
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_setproctitle
parameter_list|(
name|char
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|getnetconf
parameter_list|(
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|nsid_init
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_setoption
parameter_list|(
name|int
name|option
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|writestream
parameter_list|(
name|struct
name|qstream
modifier|*
parameter_list|,
specifier|const
name|u_char
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_need_unsafe
parameter_list|(
name|enum
name|need
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_need
parameter_list|(
name|enum
name|need
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|opensocket_f
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|nsid_hash
parameter_list|(
name|u_char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|u_int16_t
name|nsid_next
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sq_openw
parameter_list|(
name|struct
name|qstream
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sq_writeh
parameter_list|(
name|struct
name|qstream
modifier|*
parameter_list|,
name|sq_closure
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sq_write
parameter_list|(
name|struct
name|qstream
modifier|*
parameter_list|,
specifier|const
name|u_char
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|tcp_send
parameter_list|(
name|struct
name|qinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|aIsUs
parameter_list|(
name|struct
name|in_addr
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* --from ns_main.c-- */
end_comment

begin_comment
comment|/* ++from ns_maint.c++ */
end_comment

begin_function_decl
name|void
name|zone_maint
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|sched_zone_maint
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_cleancache
parameter_list|(
name|evContext
name|ctx
parameter_list|,
name|void
modifier|*
name|uap
parameter_list|,
name|struct
name|timespec
name|due
parameter_list|,
name|struct
name|timespec
name|inter
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|clean_cache_from
parameter_list|(
name|char
modifier|*
name|dname
parameter_list|,
name|struct
name|hashbuf
modifier|*
name|htp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|remove_zone
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|purge_zone
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|struct
name|hashbuf
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|loadxfer
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|qserial_retrytime
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|,
name|time_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|qserial_query
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|qserial_answer
parameter_list|(
name|struct
name|qinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_ifdef
ifdef|#
directive|ifdef
name|DEBUG
end_ifdef

begin_function_decl
name|void
name|printzoneinfo
parameter_list|(
name|int
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_function_decl
name|void
name|endxfer
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|tryxfer
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|addxfer
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_zreload
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_reload
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_reconfig
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_noexpired
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_if
if|#
directive|if
literal|0
end_if

begin_endif
unit|int			reload_all_unsafe(void);
endif|#
directive|endif
end_endif

begin_function_decl
name|int
name|zonefile_changed_p
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|reload_master
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|const
name|char
modifier|*
name|deferred_reload_unsafe
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|namebuf
modifier|*
name|purge_node
parameter_list|(
name|struct
name|hashbuf
modifier|*
name|htp
parameter_list|,
name|struct
name|namebuf
modifier|*
name|np
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|clean_cache
parameter_list|(
name|struct
name|hashbuf
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|reapchild
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|const
name|char
modifier|*
name|zoneTypeString
parameter_list|(
name|unsigned
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_heartbeat
parameter_list|(
name|evContext
name|ctx
parameter_list|,
name|void
modifier|*
name|uap
parameter_list|,
name|struct
name|timespec
parameter_list|,
name|struct
name|timespec
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|make_new_zones
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|free_zone
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|zoneinfo
modifier|*
name|find_auth_zone
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|ns_class
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|purge_nonglue
parameter_list|(
specifier|const
name|char
modifier|*
name|dname
parameter_list|,
name|struct
name|hashbuf
modifier|*
name|htp
parameter_list|,
name|int
name|class
parameter_list|,
name|int
name|log
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* --from ns_maint.c-- */
end_comment

begin_comment
comment|/* ++from ns_sort.c++ */
end_comment

begin_function_decl
name|void
name|sort_response
parameter_list|(
name|u_char
modifier|*
parameter_list|,
name|u_char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|struct
name|sockaddr_in
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* --from ns_sort.c-- */
end_comment

begin_comment
comment|/* ++from ns_init.c++ */
end_comment

begin_function_decl
name|void
name|ns_refreshtime
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|,
name|time_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_retrytime
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|,
name|time_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|time_t
name|ns_init
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|purgeandload
parameter_list|(
name|struct
name|zoneinfo
modifier|*
name|zp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|enum
name|context
name|ns_ptrcontext
parameter_list|(
specifier|const
name|char
modifier|*
name|owner
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|enum
name|context
name|ns_ownercontext
parameter_list|(
name|int
name|type
parameter_list|,
name|enum
name|transport
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ns_nameok
parameter_list|(
specifier|const
name|struct
name|qinfo
modifier|*
name|qry
parameter_list|,
specifier|const
name|char
modifier|*
name|name
parameter_list|,
name|int
name|class
parameter_list|,
name|struct
name|zoneinfo
modifier|*
name|zp
parameter_list|,
name|enum
name|transport
parameter_list|,
name|enum
name|context
parameter_list|,
specifier|const
name|char
modifier|*
name|owner
parameter_list|,
name|struct
name|in_addr
name|source
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ns_wildcard
parameter_list|(
specifier|const
name|char
modifier|*
name|name
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|zoneinit
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|do_reload
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_shutdown
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* --from ns_init.c-- */
end_comment

begin_comment
comment|/* ++from ns_ncache.c++ */
end_comment

begin_function_decl
name|void
name|cache_n_resp
parameter_list|(
name|u_char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|struct
name|sockaddr_in
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* --from ns_ncache.c-- */
end_comment

begin_comment
comment|/* ++from ns_udp.c++ */
end_comment

begin_function_decl
name|void
name|ns_udp
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* --from ns_udp.c-- */
end_comment

begin_comment
comment|/* ++from ns_stats.c++ */
end_comment

begin_function_decl
name|void
name|ns_stats
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_stats_dumpandclear
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_freestats
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ns_logstats
parameter_list|(
name|evContext
name|ctx
parameter_list|,
name|void
modifier|*
name|uap
parameter_list|,
name|struct
name|timespec
parameter_list|,
name|struct
name|timespec
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|qtypeIncr
parameter_list|(
name|int
name|qtype
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|nameser
modifier|*
name|nameserFind
parameter_list|(
name|struct
name|in_addr
name|addr
parameter_list|,
name|int
name|flags
parameter_list|)
function_decl|;
end_function_decl

begin_define
define|#
directive|define
name|NS_F_INSERT
value|0x0001
end_define

begin_define
define|#
directive|define
name|nameserIncr
parameter_list|(
name|a
parameter_list|,
name|w
parameter_list|)
value|NS_INCRSTAT(a,w)
end_define

begin_comment
comment|/* XXX should change name. */
end_comment

begin_comment
comment|/* --from ns_stats.c-- */
end_comment

begin_comment
comment|/* ++from ns_update.c++ */
end_comment

begin_function_decl
name|struct
name|databuf
modifier|*
name|findzonesoa
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|free_rrecp
parameter_list|(
name|ns_updque
modifier|*
parameter_list|,
name|int
name|rcode
parameter_list|,
name|struct
name|sockaddr_in
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|findzone
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|int
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|u_char
modifier|*
name|findsoaserial
parameter_list|(
name|u_char
modifier|*
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|u_int32_t
name|get_serial_unchecked
parameter_list|(
name|struct
name|zoneinfo
modifier|*
name|zp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|u_int32_t
name|get_serial
parameter_list|(
name|struct
name|zoneinfo
modifier|*
name|zp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|set_serial
parameter_list|(
name|struct
name|zoneinfo
modifier|*
name|zp
parameter_list|,
name|u_int32_t
name|serial
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|schedule_soa_update
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|schedule_dump
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|incr_serial
parameter_list|(
name|struct
name|zoneinfo
modifier|*
name|zp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|merge_logs
parameter_list|(
name|struct
name|zoneinfo
modifier|*
name|zp
parameter_list|,
name|char
modifier|*
name|logname
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|zonedump
parameter_list|(
name|struct
name|zoneinfo
modifier|*
name|zp
parameter_list|,
name|int
name|isixfr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|dynamic_about_to_exit
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|enum
name|req_action
name|req_update
parameter_list|(
name|HEADER
modifier|*
name|hp
parameter_list|,
name|u_char
modifier|*
name|cp
parameter_list|,
name|u_char
modifier|*
name|eom
parameter_list|,
name|u_char
modifier|*
name|msg
parameter_list|,
name|struct
name|sockaddr_in
name|from
parameter_list|,
name|struct
name|tsig_record
modifier|*
name|in_tsig
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|rdata_dump
parameter_list|(
name|struct
name|databuf
modifier|*
name|dp
parameter_list|,
name|FILE
modifier|*
name|fp
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* --from ns_update.c-- */
end_comment

begin_comment
comment|/* ++from ns_config.c++ */
end_comment

begin_function_decl
name|void
name|add_to_rrset_order_list
parameter_list|(
name|rrset_order_list
parameter_list|,
name|rrset_order_element
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|const
name|char
modifier|*
name|p_order
parameter_list|(
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|set_zone_ixfr_file
parameter_list|(
name|zone_config
parameter_list|,
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|set_zone_master_port
parameter_list|(
name|zone_config
parameter_list|,
name|u_short
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|set_zone_max_log_size_ixfr
parameter_list|(
name|zone_config
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|set_zone_dialup
parameter_list|(
name|zone_config
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|set_trusted_key
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
specifier|const
name|int
parameter_list|,
specifier|const
name|int
parameter_list|,
specifier|const
name|int
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|set_zone_ixfr_tmp
parameter_list|(
name|zone_config
parameter_list|,
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|free_zone_timerinfo
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|free_zone_contents
parameter_list|(
name|struct
name|zoneinfo
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|zoneinfo
modifier|*
name|find_zone
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|zone_config
name|begin_zone
parameter_list|(
name|char
modifier|*
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|end_zone
parameter_list|(
name|zone_config
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|set_zone_type
parameter_list|(
name|zone_config
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|set_zone_filename
parameter_list|(
name|zone_config
parameter_list|,
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|set_zone_checknames
parameter_list|(
name|zone_config
parameter_list|,
name|enum
name|severity
parameter_list|)
function_decl|;
end_function_decl

begin_ifdef
ifdef|#
directive|ifdef
name|BIND_NOTIFY
end_ifdef

begin_function_decl
name|int
name|set_zone_notify
parameter_list|(
name|zone_config
parameter_list|,
name|enum
name|notify
name|value
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_function_decl
name|int
name|set_zone_maintain_ixfr_base
parameter_list|(
name|zone_config
parameter_list|,
name|int
name|value
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|set_zone_update_acl
parameter_list|(
name|zone_config
parameter_list|,
name|ip_match_list
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|set_zone_query_acl
parameter_list|(
name|zone_config
parameter_list|,
name|ip_match_list
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|set_zone_transfer_acl
parameter_list|(
name|zone_config
parameter_list|,
name|ip_match_list
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|set_zone_transfer_source
parameter_list|(
name|zone_config
parameter_list|,
name|struct
name|in_addr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|set_zone_pubkey
parameter_list|(
name|zone_config
parameter_list|,
specifier|const
name|int
parameter_list|,
specifier|const
name|int
parameter_list|,
specifier|const
name|int
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|set_zone_transfer_time_in
parameter_list|(
name|zone_config
parameter_list|,
name|long
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|add_zone_master
parameter_list|(
name|zone_config
parameter_list|,
name|struct
name|in_addr
parameter_list|,
name|struct
name|dst_key
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_ifdef
ifdef|#
directive|ifdef
name|BIND_NOTIFY
end_ifdef

begin_function_decl
name|int
name|add_zone_notify
parameter_list|(
name|zone_config
parameter_list|,
name|struct
name|in_addr
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_function_decl
name|void
name|set_zone_forward
parameter_list|(
name|zone_config
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|add_zone_forwarder
parameter_list|(
name|zone_config
parameter_list|,
name|struct
name|in_addr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|set_zone_boolean_option
parameter_list|(
name|zone_config
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|options
name|new_options
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|free_options
parameter_list|(
name|options
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|free_rrset_order_list
parameter_list|(
name|rrset_order_list
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|set_global_boolean_option
parameter_list|(
name|options
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|listen_info_list
name|new_listen_info_list
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|free_listen_info_list
parameter_list|(
name|listen_info_list
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|add_listen_on
parameter_list|(
name|options
parameter_list|,
name|u_short
parameter_list|,
name|ip_match_list
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|FILE
modifier|*
name|write_open
parameter_list|(
name|char
modifier|*
name|filename
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|update_pid_file
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|set_options
parameter_list|(
name|options
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|use_default_options
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|enum
name|ordering
name|lookup_ordering
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|rrset_order_list
name|new_rrset_order_list
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|rrset_order_element
name|new_rrset_order_element
parameter_list|(
name|int
parameter_list|,
name|int
parameter_list|,
name|char
modifier|*
parameter_list|,
name|enum
name|ordering
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ip_match_list
name|new_ip_match_list
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|free_ip_match_list
parameter_list|(
name|ip_match_list
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ip_match_element
name|new_ip_match_pattern
parameter_list|(
name|struct
name|in_addr
parameter_list|,
name|u_int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ip_match_element
name|new_ip_match_mask
parameter_list|(
name|struct
name|in_addr
parameter_list|,
name|struct
name|in_addr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ip_match_element
name|new_ip_match_indirect
parameter_list|(
name|ip_match_list
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ip_match_element
name|new_ip_match_key
parameter_list|(
name|struct
name|dst_key
modifier|*
name|dst_key
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ip_match_element
name|new_ip_match_localhost
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ip_match_element
name|new_ip_match_localnets
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ip_match_negate
parameter_list|(
name|ip_match_element
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|add_to_ip_match_list
parameter_list|(
name|ip_match_list
parameter_list|,
name|ip_match_element
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|dprint_ip_match_list
parameter_list|(
name|int
parameter_list|,
name|ip_match_list
parameter_list|,
name|int
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ip_match_address
parameter_list|(
name|ip_match_list
parameter_list|,
name|struct
name|in_addr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ip_match_addr_or_key
parameter_list|(
name|ip_match_list
parameter_list|,
name|struct
name|in_addr
parameter_list|,
name|struct
name|dst_key
modifier|*
name|key
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ip_address_allowed
parameter_list|(
name|ip_match_list
parameter_list|,
name|struct
name|in_addr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ip_addr_or_key_allowed
parameter_list|(
name|ip_match_list
name|iml
parameter_list|,
name|struct
name|in_addr
parameter_list|,
name|struct
name|dst_key
modifier|*
name|key
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ip_match_network
parameter_list|(
name|ip_match_list
parameter_list|,
name|struct
name|in_addr
parameter_list|,
name|struct
name|in_addr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ip_match_key_name
parameter_list|(
name|ip_match_list
name|iml
parameter_list|,
name|char
modifier|*
name|name
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|distance_of_address
parameter_list|(
name|ip_match_list
parameter_list|,
name|struct
name|in_addr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ip_match_is_none
parameter_list|(
name|ip_match_list
parameter_list|)
function_decl|;
end_function_decl

begin_ifdef
ifdef|#
directive|ifdef
name|BIND_NOTIFY
end_ifdef

begin_function_decl
name|void
name|free_also_notify
parameter_list|(
name|options
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|add_global_also_notify
parameter_list|(
name|options
parameter_list|,
name|struct
name|in_addr
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_function_decl
name|void
name|add_global_forwarder
parameter_list|(
name|options
parameter_list|,
name|struct
name|in_addr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|free_forwarders
parameter_list|(
name|struct
name|fwdinfo
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|server_info
name|find_server
parameter_list|(
name|struct
name|in_addr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|server_config
name|begin_server
parameter_list|(
name|struct
name|in_addr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|end_server
parameter_list|(
name|server_config
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|set_server_option
parameter_list|(
name|server_config
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|set_server_transfers
parameter_list|(
name|server_config
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|set_server_transfer_format
parameter_list|(
name|server_config
parameter_list|,
name|enum
name|axfr_format
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|add_server_key_info
parameter_list|(
name|server_config
parameter_list|,
name|struct
name|dst_key
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|dst_key
modifier|*
name|new_key_info
parameter_list|(
name|char
modifier|*
parameter_list|,
name|char
modifier|*
parameter_list|,
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|free_key_info
parameter_list|(
name|struct
name|dst_key
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|dst_key
modifier|*
name|find_key
parameter_list|(
name|char
modifier|*
name|name
parameter_list|,
name|char
modifier|*
name|algorithm
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|dprint_key_info
parameter_list|(
name|struct
name|dst_key
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|key_info_list
name|new_key_info_list
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|free_key_info_list
parameter_list|(
name|key_info_list
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|add_to_key_info_list
parameter_list|(
name|key_info_list
parameter_list|,
name|struct
name|dst_key
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|dprint_key_info_list
parameter_list|(
name|key_info_list
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|log_config
name|begin_logging
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|add_log_channel
parameter_list|(
name|log_config
parameter_list|,
name|int
parameter_list|,
name|log_channel
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|open_special_channels
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|set_logging
parameter_list|(
name|log_config
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|end_logging
parameter_list|(
name|log_config
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|use_default_logging
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|init_logging
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|shutdown_logging
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|init_configuration
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|shutdown_configuration
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|time_t
name|load_configuration
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* --from ns_config.c-- */
end_comment

begin_comment
comment|/* ++from parser.y++ */
end_comment

begin_function_decl
name|ip_match_list
name|lookup_acl
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|define_acl
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|ip_match_list
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|dst_key
modifier|*
name|lookup_key
parameter_list|(
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|define_key
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|struct
name|dst_key
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|time_t
name|parse_configuration
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|parser_initialize
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|parser_shutdown
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* --from parser.y-- */
end_comment

begin_comment
comment|/* ++from ns_signal.c++ */
end_comment

begin_function_decl
name|void
name|init_signals
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|block_signals
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|unblock_signals
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* --from ns_signal.c-- */
end_comment

end_unit

