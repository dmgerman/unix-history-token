begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Test program for EAP-SIM PRF  * Copyright (c) 2004-2006, Jouni Malinen<j@w1.fi>  *  * This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License version 2 as  * published by the Free Software Foundation.  *  * Alternatively, this software may be distributed under the terms of BSD  * license.  *  * See README and COPYING for more details.  */
end_comment

begin_include
include|#
directive|include
file|"eap_sim_common.c"
end_include

begin_function
specifier|static
name|int
name|test_eap_sim_prf
parameter_list|(
name|void
parameter_list|)
block|{
comment|/* http://csrc.nist.gov/encryption/dss/Examples-1024bit.pdf */
name|u8
name|xkey
index|[]
init|=
block|{
literal|0xbd
block|,
literal|0x02
block|,
literal|0x9b
block|,
literal|0xbe
block|,
literal|0x7f
block|,
literal|0x51
block|,
literal|0x96
block|,
literal|0x0b
block|,
literal|0xcf
block|,
literal|0x9e
block|,
literal|0xdb
block|,
literal|0x2b
block|,
literal|0x61
block|,
literal|0xf0
block|,
literal|0x6f
block|,
literal|0x0f
block|,
literal|0xeb
block|,
literal|0x5a
block|,
literal|0x38
block|,
literal|0xb6
block|}
decl_stmt|;
name|u8
name|w
index|[]
init|=
block|{
literal|0x20
block|,
literal|0x70
block|,
literal|0xb3
block|,
literal|0x22
block|,
literal|0x3d
block|,
literal|0xba
block|,
literal|0x37
block|,
literal|0x2f
block|,
literal|0xde
block|,
literal|0x1c
block|,
literal|0x0f
block|,
literal|0xfc
block|,
literal|0x7b
block|,
literal|0x2e
block|,
literal|0x3b
block|,
literal|0x49
block|,
literal|0x8b
block|,
literal|0x26
block|,
literal|0x06
block|,
literal|0x14
block|,
literal|0x3c
block|,
literal|0x6c
block|,
literal|0x18
block|,
literal|0xba
block|,
literal|0xcb
block|,
literal|0x0f
block|,
literal|0x6c
block|,
literal|0x55
block|,
literal|0xba
block|,
literal|0xbb
block|,
literal|0x13
block|,
literal|0x78
block|,
literal|0x8e
block|,
literal|0x20
block|,
literal|0xd7
block|,
literal|0x37
block|,
literal|0xa3
block|,
literal|0x27
block|,
literal|0x51
block|,
literal|0x16
block|}
decl_stmt|;
name|u8
name|buf
index|[
literal|40
index|]
decl_stmt|;
name|printf
argument_list|(
literal|"Testing EAP-SIM PRF (FIPS 186-2 + change notice 1)\n"
argument_list|)
expr_stmt|;
name|eap_sim_prf
argument_list|(
name|xkey
argument_list|,
name|buf
argument_list|,
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|memcmp
argument_list|(
name|w
argument_list|,
name|buf
argument_list|,
sizeof|sizeof
argument_list|(
name|w
argument_list|)
operator|!=
literal|0
argument_list|)
condition|)
block|{
name|printf
argument_list|(
literal|"eap_sim_prf failed\n"
argument_list|)
expr_stmt|;
return|return
literal|1
return|;
block|}
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|main
parameter_list|(
name|int
name|argc
parameter_list|,
name|char
modifier|*
name|argv
index|[]
parameter_list|)
block|{
name|int
name|errors
init|=
literal|0
decl_stmt|;
name|errors
operator|+=
name|test_eap_sim_prf
argument_list|()
expr_stmt|;
return|return
name|errors
return|;
block|}
end_function

end_unit

