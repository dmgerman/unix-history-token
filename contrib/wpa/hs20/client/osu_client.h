begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Hotspot 2.0 - OSU client  * Copyright (c) 2013-2014, Qualcomm Atheros, Inc.  *  * This software may be distributed under the terms of the BSD license.  * See README for more details.  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|OSU_CLIENT_H
end_ifndef

begin_define
define|#
directive|define
name|OSU_CLIENT_H
end_define

begin_define
define|#
directive|define
name|SPP_NS_URI
value|"http://www.wi-fi.org/specifications/hotspot2dot0/v1.0/spp"
end_define

begin_define
define|#
directive|define
name|URN_OMA_DM_DEVINFO
value|"urn:oma:mo:oma-dm-devinfo:1.0"
end_define

begin_define
define|#
directive|define
name|URN_OMA_DM_DEVDETAIL
value|"urn:oma:mo:oma-dm-devdetail:1.0"
end_define

begin_define
define|#
directive|define
name|URN_HS20_DEVDETAIL_EXT
value|"urn:wfa:mo-ext:hotspot2dot0-devdetail-ext:1.0"
end_define

begin_define
define|#
directive|define
name|URN_HS20_PPS
value|"urn:wfa:mo:hotspot2dot0-perprovidersubscription:1.0"
end_define

begin_define
define|#
directive|define
name|MAX_OSU_VALS
value|10
end_define

begin_struct
struct|struct
name|osu_lang_text
block|{
name|char
name|lang
index|[
literal|4
index|]
decl_stmt|;
name|char
name|text
index|[
literal|253
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|hs20_osu_client
block|{
name|struct
name|xml_node_ctx
modifier|*
name|xml
decl_stmt|;
name|struct
name|http_ctx
modifier|*
name|http
decl_stmt|;
name|int
name|no_reconnect
decl_stmt|;
name|char
name|pps_fname
index|[
literal|300
index|]
decl_stmt|;
name|char
modifier|*
name|devid
decl_stmt|;
specifier|const
name|char
modifier|*
name|result_file
decl_stmt|;
specifier|const
name|char
modifier|*
name|summary_file
decl_stmt|;
specifier|const
name|char
modifier|*
name|ifname
decl_stmt|;
specifier|const
name|char
modifier|*
name|ca_fname
decl_stmt|;
name|int
name|no_osu_cert_validation
decl_stmt|;
comment|/* for EST operations */
name|char
modifier|*
name|fqdn
decl_stmt|;
name|char
modifier|*
name|server_url
decl_stmt|;
name|struct
name|osu_lang_text
name|friendly_name
index|[
name|MAX_OSU_VALS
index|]
decl_stmt|;
name|size_t
name|friendly_name_count
decl_stmt|;
name|size_t
name|icon_count
decl_stmt|;
name|char
name|icon_filename
index|[
name|MAX_OSU_VALS
index|]
index|[
literal|256
index|]
decl_stmt|;
name|u8
name|icon_hash
index|[
name|MAX_OSU_VALS
index|]
index|[
literal|32
index|]
decl_stmt|;
name|int
name|pps_cred_set
decl_stmt|;
name|int
name|pps_updated
decl_stmt|;
name|int
name|client_cert_present
decl_stmt|;
name|char
modifier|*
modifier|*
name|server_dnsname
decl_stmt|;
name|size_t
name|server_dnsname_count
decl_stmt|;
define|#
directive|define
name|WORKAROUND_OCSP_OPTIONAL
value|0x00000001
name|unsigned
name|long
name|int
name|workarounds
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/* osu_client.c */
end_comment

begin_function_decl
name|void
name|write_result
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|fmt
parameter_list|,
modifier|...
parameter_list|)
function_decl|__attribute__
parameter_list|(
function_decl|(format
parameter_list|(
name|printf
parameter_list|,
function_decl|2
operator|,
function_decl|3
end_function_decl

begin_empty_stmt
unit|)))
empty_stmt|;
end_empty_stmt

begin_function_decl
name|void
name|write_summary
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|fmt
parameter_list|,
modifier|...
parameter_list|)
function_decl|__attribute__
parameter_list|(
function_decl|(format
parameter_list|(
name|printf
parameter_list|,
function_decl|2
operator|,
function_decl|3
end_function_decl

begin_empty_stmt
unit|)))
empty_stmt|;
end_empty_stmt

begin_function_decl
name|void
name|debug_dump_node
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|title
parameter_list|,
name|xml_node_t
modifier|*
name|node
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|osu_get_certificate
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
name|xml_node_t
modifier|*
name|getcert
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|hs20_add_pps_mo
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|uri
parameter_list|,
name|xml_node_t
modifier|*
name|add_mo
parameter_list|,
name|char
modifier|*
name|fname
parameter_list|,
name|size_t
name|fname_len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|get_user_pw
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
name|xml_node_t
modifier|*
name|pps
parameter_list|,
specifier|const
name|char
modifier|*
name|alt_loc
parameter_list|,
name|char
modifier|*
modifier|*
name|user
parameter_list|,
name|char
modifier|*
modifier|*
name|pw
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|update_pps_file
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|pps_fname
parameter_list|,
name|xml_node_t
modifier|*
name|pps
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|cmd_set_pps
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|pps_fname
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* spp_client.c */
end_comment

begin_function_decl
name|void
name|spp_sub_rem
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|address
parameter_list|,
specifier|const
name|char
modifier|*
name|pps_fname
parameter_list|,
specifier|const
name|char
modifier|*
name|client_cert
parameter_list|,
specifier|const
name|char
modifier|*
name|client_key
parameter_list|,
specifier|const
name|char
modifier|*
name|cred_username
parameter_list|,
specifier|const
name|char
modifier|*
name|cred_password
parameter_list|,
name|xml_node_t
modifier|*
name|pps
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|spp_pol_upd
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|address
parameter_list|,
specifier|const
name|char
modifier|*
name|pps_fname
parameter_list|,
specifier|const
name|char
modifier|*
name|client_cert
parameter_list|,
specifier|const
name|char
modifier|*
name|client_key
parameter_list|,
specifier|const
name|char
modifier|*
name|cred_username
parameter_list|,
specifier|const
name|char
modifier|*
name|cred_password
parameter_list|,
name|xml_node_t
modifier|*
name|pps
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|cmd_prov
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|url
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|cmd_sim_prov
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|url
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* oma_dm_client.c */
end_comment

begin_function_decl
name|int
name|cmd_oma_dm_prov
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|url
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|cmd_oma_dm_sim_prov
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|url
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|oma_dm_sub_rem
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|address
parameter_list|,
specifier|const
name|char
modifier|*
name|pps_fname
parameter_list|,
specifier|const
name|char
modifier|*
name|client_cert
parameter_list|,
specifier|const
name|char
modifier|*
name|client_key
parameter_list|,
specifier|const
name|char
modifier|*
name|cred_username
parameter_list|,
specifier|const
name|char
modifier|*
name|cred_password
parameter_list|,
name|xml_node_t
modifier|*
name|pps
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|oma_dm_pol_upd
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|address
parameter_list|,
specifier|const
name|char
modifier|*
name|pps_fname
parameter_list|,
specifier|const
name|char
modifier|*
name|client_cert
parameter_list|,
specifier|const
name|char
modifier|*
name|client_key
parameter_list|,
specifier|const
name|char
modifier|*
name|cred_username
parameter_list|,
specifier|const
name|char
modifier|*
name|cred_password
parameter_list|,
name|xml_node_t
modifier|*
name|pps
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|cmd_oma_dm_sub_rem
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|address
parameter_list|,
specifier|const
name|char
modifier|*
name|pps_fname
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|cmd_oma_dm_add
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|pps_fname
parameter_list|,
specifier|const
name|char
modifier|*
name|add_fname
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|cmd_oma_dm_replace
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|pps_fname
parameter_list|,
specifier|const
name|char
modifier|*
name|replace_fname
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* est.c */
end_comment

begin_function_decl
name|int
name|est_load_cacerts
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|url
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|est_build_csr
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|url
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|est_simple_enroll
parameter_list|(
name|struct
name|hs20_osu_client
modifier|*
name|ctx
parameter_list|,
specifier|const
name|char
modifier|*
name|url
parameter_list|,
specifier|const
name|char
modifier|*
name|user
parameter_list|,
specifier|const
name|char
modifier|*
name|pw
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* OSU_CLIENT_H */
end_comment

end_unit

