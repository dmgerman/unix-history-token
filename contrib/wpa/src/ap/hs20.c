begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Hotspot 2.0 AP ANQP processing  * Copyright (c) 2009, Atheros Communications, Inc.  * Copyright (c) 2011-2012, Qualcomm Atheros, Inc.  *  * This software may be distributed under the terms of the BSD license.  * See README for more details.  */
end_comment

begin_include
include|#
directive|include
file|"includes.h"
end_include

begin_include
include|#
directive|include
file|"common.h"
end_include

begin_include
include|#
directive|include
file|"common/ieee802_11_defs.h"
end_include

begin_include
include|#
directive|include
file|"hostapd.h"
end_include

begin_include
include|#
directive|include
file|"ap_config.h"
end_include

begin_include
include|#
directive|include
file|"hs20.h"
end_include

begin_function
name|u8
modifier|*
name|hostapd_eid_hs20_indication
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|u8
modifier|*
name|eid
parameter_list|)
block|{
if|if
condition|(
operator|!
name|hapd
operator|->
name|conf
operator|->
name|hs20
condition|)
return|return
name|eid
return|;
operator|*
name|eid
operator|++
operator|=
name|WLAN_EID_VENDOR_SPECIFIC
expr_stmt|;
operator|*
name|eid
operator|++
operator|=
literal|5
expr_stmt|;
name|WPA_PUT_BE24
argument_list|(
name|eid
argument_list|,
name|OUI_WFA
argument_list|)
expr_stmt|;
name|eid
operator|+=
literal|3
expr_stmt|;
operator|*
name|eid
operator|++
operator|=
name|HS20_INDICATION_OUI_TYPE
expr_stmt|;
comment|/* Hotspot Configuration: DGAF Enabled */
operator|*
name|eid
operator|++
operator|=
name|hapd
operator|->
name|conf
operator|->
name|disable_dgaf
condition|?
literal|0x01
else|:
literal|0x00
expr_stmt|;
return|return
name|eid
return|;
block|}
end_function

end_unit

