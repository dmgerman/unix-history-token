begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * hostapd - Driver operations  * Copyright (c) 2009-2010, Jouni Malinen<j@w1.fi>  *  * This software may be distributed under the terms of the BSD license.  * See README for more details.  */
end_comment

begin_include
include|#
directive|include
file|"utils/includes.h"
end_include

begin_include
include|#
directive|include
file|"utils/common.h"
end_include

begin_include
include|#
directive|include
file|"drivers/driver.h"
end_include

begin_include
include|#
directive|include
file|"common/ieee802_11_defs.h"
end_include

begin_include
include|#
directive|include
file|"wps/wps.h"
end_include

begin_include
include|#
directive|include
file|"p2p/p2p.h"
end_include

begin_include
include|#
directive|include
file|"hostapd.h"
end_include

begin_include
include|#
directive|include
file|"ieee802_11.h"
end_include

begin_include
include|#
directive|include
file|"sta_info.h"
end_include

begin_include
include|#
directive|include
file|"ap_config.h"
end_include

begin_include
include|#
directive|include
file|"p2p_hostapd.h"
end_include

begin_include
include|#
directive|include
file|"hs20.h"
end_include

begin_include
include|#
directive|include
file|"ap_drv_ops.h"
end_include

begin_function
name|u32
name|hostapd_sta_flags_to_drv
parameter_list|(
name|u32
name|flags
parameter_list|)
block|{
name|int
name|res
init|=
literal|0
decl_stmt|;
if|if
condition|(
name|flags
operator|&
name|WLAN_STA_AUTHORIZED
condition|)
name|res
operator||=
name|WPA_STA_AUTHORIZED
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|WLAN_STA_WMM
condition|)
name|res
operator||=
name|WPA_STA_WMM
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|WLAN_STA_SHORT_PREAMBLE
condition|)
name|res
operator||=
name|WPA_STA_SHORT_PREAMBLE
expr_stmt|;
if|if
condition|(
name|flags
operator|&
name|WLAN_STA_MFP
condition|)
name|res
operator||=
name|WPA_STA_MFP
expr_stmt|;
return|return
name|res
return|;
block|}
end_function

begin_function
name|int
name|hostapd_build_ap_extra_ies
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|struct
name|wpabuf
modifier|*
modifier|*
name|beacon_ret
parameter_list|,
name|struct
name|wpabuf
modifier|*
modifier|*
name|proberesp_ret
parameter_list|,
name|struct
name|wpabuf
modifier|*
modifier|*
name|assocresp_ret
parameter_list|)
block|{
name|struct
name|wpabuf
modifier|*
name|beacon
init|=
name|NULL
decl_stmt|,
modifier|*
name|proberesp
init|=
name|NULL
decl_stmt|,
modifier|*
name|assocresp
init|=
name|NULL
decl_stmt|;
name|u8
name|buf
index|[
literal|200
index|]
decl_stmt|,
modifier|*
name|pos
decl_stmt|;
operator|*
name|beacon_ret
operator|=
operator|*
name|proberesp_ret
operator|=
operator|*
name|assocresp_ret
operator|=
name|NULL
expr_stmt|;
name|pos
operator|=
name|buf
expr_stmt|;
name|pos
operator|=
name|hostapd_eid_time_adv
argument_list|(
name|hapd
argument_list|,
name|pos
argument_list|)
expr_stmt|;
if|if
condition|(
name|pos
operator|!=
name|buf
condition|)
block|{
if|if
condition|(
name|wpabuf_resize
argument_list|(
operator|&
name|beacon
argument_list|,
name|pos
operator|-
name|buf
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|fail
goto|;
name|wpabuf_put_data
argument_list|(
name|beacon
argument_list|,
name|buf
argument_list|,
name|pos
operator|-
name|buf
argument_list|)
expr_stmt|;
block|}
name|pos
operator|=
name|hostapd_eid_time_zone
argument_list|(
name|hapd
argument_list|,
name|pos
argument_list|)
expr_stmt|;
if|if
condition|(
name|pos
operator|!=
name|buf
condition|)
block|{
if|if
condition|(
name|wpabuf_resize
argument_list|(
operator|&
name|proberesp
argument_list|,
name|pos
operator|-
name|buf
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|fail
goto|;
name|wpabuf_put_data
argument_list|(
name|proberesp
argument_list|,
name|buf
argument_list|,
name|pos
operator|-
name|buf
argument_list|)
expr_stmt|;
block|}
name|pos
operator|=
name|buf
expr_stmt|;
name|pos
operator|=
name|hostapd_eid_ext_capab
argument_list|(
name|hapd
argument_list|,
name|pos
argument_list|)
expr_stmt|;
if|if
condition|(
name|pos
operator|!=
name|buf
condition|)
block|{
if|if
condition|(
name|wpabuf_resize
argument_list|(
operator|&
name|assocresp
argument_list|,
name|pos
operator|-
name|buf
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|fail
goto|;
name|wpabuf_put_data
argument_list|(
name|assocresp
argument_list|,
name|buf
argument_list|,
name|pos
operator|-
name|buf
argument_list|)
expr_stmt|;
block|}
name|pos
operator|=
name|hostapd_eid_interworking
argument_list|(
name|hapd
argument_list|,
name|pos
argument_list|)
expr_stmt|;
name|pos
operator|=
name|hostapd_eid_adv_proto
argument_list|(
name|hapd
argument_list|,
name|pos
argument_list|)
expr_stmt|;
name|pos
operator|=
name|hostapd_eid_roaming_consortium
argument_list|(
name|hapd
argument_list|,
name|pos
argument_list|)
expr_stmt|;
if|if
condition|(
name|pos
operator|!=
name|buf
condition|)
block|{
if|if
condition|(
name|wpabuf_resize
argument_list|(
operator|&
name|beacon
argument_list|,
name|pos
operator|-
name|buf
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|fail
goto|;
name|wpabuf_put_data
argument_list|(
name|beacon
argument_list|,
name|buf
argument_list|,
name|pos
operator|-
name|buf
argument_list|)
expr_stmt|;
if|if
condition|(
name|wpabuf_resize
argument_list|(
operator|&
name|proberesp
argument_list|,
name|pos
operator|-
name|buf
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|fail
goto|;
name|wpabuf_put_data
argument_list|(
name|proberesp
argument_list|,
name|buf
argument_list|,
name|pos
operator|-
name|buf
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|hapd
operator|->
name|wps_beacon_ie
condition|)
block|{
if|if
condition|(
name|wpabuf_resize
argument_list|(
operator|&
name|beacon
argument_list|,
name|wpabuf_len
argument_list|(
name|hapd
operator|->
name|wps_beacon_ie
argument_list|)
argument_list|)
operator|<
literal|0
condition|)
goto|goto
name|fail
goto|;
name|wpabuf_put_buf
argument_list|(
name|beacon
argument_list|,
name|hapd
operator|->
name|wps_beacon_ie
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|hapd
operator|->
name|wps_probe_resp_ie
condition|)
block|{
if|if
condition|(
name|wpabuf_resize
argument_list|(
operator|&
name|proberesp
argument_list|,
name|wpabuf_len
argument_list|(
name|hapd
operator|->
name|wps_probe_resp_ie
argument_list|)
argument_list|)
operator|<
literal|0
condition|)
goto|goto
name|fail
goto|;
name|wpabuf_put_buf
argument_list|(
name|proberesp
argument_list|,
name|hapd
operator|->
name|wps_probe_resp_ie
argument_list|)
expr_stmt|;
block|}
ifdef|#
directive|ifdef
name|CONFIG_P2P
if|if
condition|(
name|hapd
operator|->
name|p2p_beacon_ie
condition|)
block|{
if|if
condition|(
name|wpabuf_resize
argument_list|(
operator|&
name|beacon
argument_list|,
name|wpabuf_len
argument_list|(
name|hapd
operator|->
name|p2p_beacon_ie
argument_list|)
argument_list|)
operator|<
literal|0
condition|)
goto|goto
name|fail
goto|;
name|wpabuf_put_buf
argument_list|(
name|beacon
argument_list|,
name|hapd
operator|->
name|p2p_beacon_ie
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|hapd
operator|->
name|p2p_probe_resp_ie
condition|)
block|{
if|if
condition|(
name|wpabuf_resize
argument_list|(
operator|&
name|proberesp
argument_list|,
name|wpabuf_len
argument_list|(
name|hapd
operator|->
name|p2p_probe_resp_ie
argument_list|)
argument_list|)
operator|<
literal|0
condition|)
goto|goto
name|fail
goto|;
name|wpabuf_put_buf
argument_list|(
name|proberesp
argument_list|,
name|hapd
operator|->
name|p2p_probe_resp_ie
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
comment|/* CONFIG_P2P */
ifdef|#
directive|ifdef
name|CONFIG_P2P_MANAGER
if|if
condition|(
name|hapd
operator|->
name|conf
operator|->
name|p2p
operator|&
name|P2P_MANAGE
condition|)
block|{
if|if
condition|(
name|wpabuf_resize
argument_list|(
operator|&
name|beacon
argument_list|,
literal|100
argument_list|)
operator|==
literal|0
condition|)
block|{
name|u8
modifier|*
name|start
decl_stmt|,
modifier|*
name|p
decl_stmt|;
name|start
operator|=
name|wpabuf_put
argument_list|(
name|beacon
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|p
operator|=
name|hostapd_eid_p2p_manage
argument_list|(
name|hapd
argument_list|,
name|start
argument_list|)
expr_stmt|;
name|wpabuf_put
argument_list|(
name|beacon
argument_list|,
name|p
operator|-
name|start
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|wpabuf_resize
argument_list|(
operator|&
name|proberesp
argument_list|,
literal|100
argument_list|)
operator|==
literal|0
condition|)
block|{
name|u8
modifier|*
name|start
decl_stmt|,
modifier|*
name|p
decl_stmt|;
name|start
operator|=
name|wpabuf_put
argument_list|(
name|proberesp
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|p
operator|=
name|hostapd_eid_p2p_manage
argument_list|(
name|hapd
argument_list|,
name|start
argument_list|)
expr_stmt|;
name|wpabuf_put
argument_list|(
name|proberesp
argument_list|,
name|p
operator|-
name|start
argument_list|)
expr_stmt|;
block|}
block|}
endif|#
directive|endif
comment|/* CONFIG_P2P_MANAGER */
ifdef|#
directive|ifdef
name|CONFIG_WPS2
if|if
condition|(
name|hapd
operator|->
name|conf
operator|->
name|wps_state
condition|)
block|{
name|struct
name|wpabuf
modifier|*
name|a
init|=
name|wps_build_assoc_resp_ie
argument_list|()
decl_stmt|;
if|if
condition|(
name|a
operator|&&
name|wpabuf_resize
argument_list|(
operator|&
name|assocresp
argument_list|,
name|wpabuf_len
argument_list|(
name|a
argument_list|)
argument_list|)
operator|==
literal|0
condition|)
name|wpabuf_put_buf
argument_list|(
name|assocresp
argument_list|,
name|a
argument_list|)
expr_stmt|;
name|wpabuf_free
argument_list|(
name|a
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
comment|/* CONFIG_WPS2 */
ifdef|#
directive|ifdef
name|CONFIG_P2P_MANAGER
if|if
condition|(
name|hapd
operator|->
name|conf
operator|->
name|p2p
operator|&
name|P2P_MANAGE
condition|)
block|{
if|if
condition|(
name|wpabuf_resize
argument_list|(
operator|&
name|assocresp
argument_list|,
literal|100
argument_list|)
operator|==
literal|0
condition|)
block|{
name|u8
modifier|*
name|start
decl_stmt|,
modifier|*
name|p
decl_stmt|;
name|start
operator|=
name|wpabuf_put
argument_list|(
name|assocresp
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|p
operator|=
name|hostapd_eid_p2p_manage
argument_list|(
name|hapd
argument_list|,
name|start
argument_list|)
expr_stmt|;
name|wpabuf_put
argument_list|(
name|assocresp
argument_list|,
name|p
operator|-
name|start
argument_list|)
expr_stmt|;
block|}
block|}
endif|#
directive|endif
comment|/* CONFIG_P2P_MANAGER */
ifdef|#
directive|ifdef
name|CONFIG_WIFI_DISPLAY
if|if
condition|(
name|hapd
operator|->
name|p2p_group
condition|)
block|{
name|struct
name|wpabuf
modifier|*
name|a
decl_stmt|;
name|a
operator|=
name|p2p_group_assoc_resp_ie
argument_list|(
name|hapd
operator|->
name|p2p_group
argument_list|,
name|P2P_SC_SUCCESS
argument_list|)
expr_stmt|;
if|if
condition|(
name|a
operator|&&
name|wpabuf_resize
argument_list|(
operator|&
name|assocresp
argument_list|,
name|wpabuf_len
argument_list|(
name|a
argument_list|)
argument_list|)
operator|==
literal|0
condition|)
name|wpabuf_put_buf
argument_list|(
name|assocresp
argument_list|,
name|a
argument_list|)
expr_stmt|;
name|wpabuf_free
argument_list|(
name|a
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
comment|/* CONFIG_WIFI_DISPLAY */
ifdef|#
directive|ifdef
name|CONFIG_HS20
name|pos
operator|=
name|buf
expr_stmt|;
name|pos
operator|=
name|hostapd_eid_hs20_indication
argument_list|(
name|hapd
argument_list|,
name|pos
argument_list|)
expr_stmt|;
if|if
condition|(
name|pos
operator|!=
name|buf
condition|)
block|{
if|if
condition|(
name|wpabuf_resize
argument_list|(
operator|&
name|beacon
argument_list|,
name|pos
operator|-
name|buf
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|fail
goto|;
name|wpabuf_put_data
argument_list|(
name|beacon
argument_list|,
name|buf
argument_list|,
name|pos
operator|-
name|buf
argument_list|)
expr_stmt|;
if|if
condition|(
name|wpabuf_resize
argument_list|(
operator|&
name|proberesp
argument_list|,
name|pos
operator|-
name|buf
argument_list|)
operator|!=
literal|0
condition|)
goto|goto
name|fail
goto|;
name|wpabuf_put_data
argument_list|(
name|proberesp
argument_list|,
name|buf
argument_list|,
name|pos
operator|-
name|buf
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
comment|/* CONFIG_HS20 */
operator|*
name|beacon_ret
operator|=
name|beacon
expr_stmt|;
operator|*
name|proberesp_ret
operator|=
name|proberesp
expr_stmt|;
operator|*
name|assocresp_ret
operator|=
name|assocresp
expr_stmt|;
return|return
literal|0
return|;
name|fail
label|:
name|wpabuf_free
argument_list|(
name|beacon
argument_list|)
expr_stmt|;
name|wpabuf_free
argument_list|(
name|proberesp
argument_list|)
expr_stmt|;
name|wpabuf_free
argument_list|(
name|assocresp
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
name|void
name|hostapd_free_ap_extra_ies
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|struct
name|wpabuf
modifier|*
name|beacon
parameter_list|,
name|struct
name|wpabuf
modifier|*
name|proberesp
parameter_list|,
name|struct
name|wpabuf
modifier|*
name|assocresp
parameter_list|)
block|{
name|wpabuf_free
argument_list|(
name|beacon
argument_list|)
expr_stmt|;
name|wpabuf_free
argument_list|(
name|proberesp
argument_list|)
expr_stmt|;
name|wpabuf_free
argument_list|(
name|assocresp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|int
name|hostapd_set_ap_wps_ie
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|)
block|{
name|struct
name|wpabuf
modifier|*
name|beacon
decl_stmt|,
modifier|*
name|proberesp
decl_stmt|,
modifier|*
name|assocresp
decl_stmt|;
name|int
name|ret
decl_stmt|;
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|set_ap_wps_ie
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
if|if
condition|(
name|hostapd_build_ap_extra_ies
argument_list|(
name|hapd
argument_list|,
operator|&
name|beacon
argument_list|,
operator|&
name|proberesp
argument_list|,
operator|&
name|assocresp
argument_list|)
operator|<
literal|0
condition|)
return|return
operator|-
literal|1
return|;
name|ret
operator|=
name|hapd
operator|->
name|driver
operator|->
name|set_ap_wps_ie
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|beacon
argument_list|,
name|proberesp
argument_list|,
name|assocresp
argument_list|)
expr_stmt|;
name|hostapd_free_ap_extra_ies
argument_list|(
name|hapd
argument_list|,
name|beacon
argument_list|,
name|proberesp
argument_list|,
name|assocresp
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
name|int
name|hostapd_set_authorized
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|struct
name|sta_info
modifier|*
name|sta
parameter_list|,
name|int
name|authorized
parameter_list|)
block|{
if|if
condition|(
name|authorized
condition|)
block|{
return|return
name|hostapd_sta_set_flags
argument_list|(
name|hapd
argument_list|,
name|sta
operator|->
name|addr
argument_list|,
name|hostapd_sta_flags_to_drv
argument_list|(
name|sta
operator|->
name|flags
argument_list|)
argument_list|,
name|WPA_STA_AUTHORIZED
argument_list|,
operator|~
literal|0
argument_list|)
return|;
block|}
return|return
name|hostapd_sta_set_flags
argument_list|(
name|hapd
argument_list|,
name|sta
operator|->
name|addr
argument_list|,
name|hostapd_sta_flags_to_drv
argument_list|(
name|sta
operator|->
name|flags
argument_list|)
argument_list|,
literal|0
argument_list|,
operator|~
name|WPA_STA_AUTHORIZED
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_set_sta_flags
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|struct
name|sta_info
modifier|*
name|sta
parameter_list|)
block|{
name|int
name|set_flags
decl_stmt|,
name|total_flags
decl_stmt|,
name|flags_and
decl_stmt|,
name|flags_or
decl_stmt|;
name|total_flags
operator|=
name|hostapd_sta_flags_to_drv
argument_list|(
name|sta
operator|->
name|flags
argument_list|)
expr_stmt|;
name|set_flags
operator|=
name|WPA_STA_SHORT_PREAMBLE
operator||
name|WPA_STA_WMM
operator||
name|WPA_STA_MFP
expr_stmt|;
if|if
condition|(
operator|(
operator|(
operator|!
name|hapd
operator|->
name|conf
operator|->
name|ieee802_1x
operator|&&
operator|!
name|hapd
operator|->
name|conf
operator|->
name|wpa
operator|)
operator|||
name|sta
operator|->
name|auth_alg
operator|==
name|WLAN_AUTH_FT
operator|)
operator|&&
name|sta
operator|->
name|flags
operator|&
name|WLAN_STA_AUTHORIZED
condition|)
name|set_flags
operator||=
name|WPA_STA_AUTHORIZED
expr_stmt|;
name|flags_or
operator|=
name|total_flags
operator|&
name|set_flags
expr_stmt|;
name|flags_and
operator|=
name|total_flags
operator||
operator|~
name|set_flags
expr_stmt|;
return|return
name|hostapd_sta_set_flags
argument_list|(
name|hapd
argument_list|,
name|sta
operator|->
name|addr
argument_list|,
name|total_flags
argument_list|,
name|flags_or
argument_list|,
name|flags_and
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_set_drv_ieee8021x
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
specifier|const
name|char
modifier|*
name|ifname
parameter_list|,
name|int
name|enabled
parameter_list|)
block|{
name|struct
name|wpa_bss_params
name|params
decl_stmt|;
name|os_memset
argument_list|(
operator|&
name|params
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|params
argument_list|)
argument_list|)
expr_stmt|;
name|params
operator|.
name|ifname
operator|=
name|ifname
expr_stmt|;
name|params
operator|.
name|enabled
operator|=
name|enabled
expr_stmt|;
if|if
condition|(
name|enabled
condition|)
block|{
name|params
operator|.
name|wpa
operator|=
name|hapd
operator|->
name|conf
operator|->
name|wpa
expr_stmt|;
name|params
operator|.
name|ieee802_1x
operator|=
name|hapd
operator|->
name|conf
operator|->
name|ieee802_1x
expr_stmt|;
name|params
operator|.
name|wpa_group
operator|=
name|hapd
operator|->
name|conf
operator|->
name|wpa_group
expr_stmt|;
name|params
operator|.
name|wpa_pairwise
operator|=
name|hapd
operator|->
name|conf
operator|->
name|wpa_pairwise
expr_stmt|;
name|params
operator|.
name|wpa_key_mgmt
operator|=
name|hapd
operator|->
name|conf
operator|->
name|wpa_key_mgmt
expr_stmt|;
name|params
operator|.
name|rsn_preauth
operator|=
name|hapd
operator|->
name|conf
operator|->
name|rsn_preauth
expr_stmt|;
ifdef|#
directive|ifdef
name|CONFIG_IEEE80211W
name|params
operator|.
name|ieee80211w
operator|=
name|hapd
operator|->
name|conf
operator|->
name|ieee80211w
expr_stmt|;
endif|#
directive|endif
comment|/* CONFIG_IEEE80211W */
block|}
return|return
name|hostapd_set_ieee8021x
argument_list|(
name|hapd
argument_list|,
operator|&
name|params
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_vlan_if_add
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
specifier|const
name|char
modifier|*
name|ifname
parameter_list|)
block|{
name|char
name|force_ifname
index|[
name|IFNAMSIZ
index|]
decl_stmt|;
name|u8
name|if_addr
index|[
name|ETH_ALEN
index|]
decl_stmt|;
return|return
name|hostapd_if_add
argument_list|(
name|hapd
argument_list|,
name|WPA_IF_AP_VLAN
argument_list|,
name|ifname
argument_list|,
name|hapd
operator|->
name|own_addr
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|force_ifname
argument_list|,
name|if_addr
argument_list|,
name|NULL
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_vlan_if_remove
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
specifier|const
name|char
modifier|*
name|ifname
parameter_list|)
block|{
return|return
name|hostapd_if_remove
argument_list|(
name|hapd
argument_list|,
name|WPA_IF_AP_VLAN
argument_list|,
name|ifname
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_set_wds_sta
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|int
name|aid
parameter_list|,
name|int
name|val
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|bridge
init|=
name|NULL
decl_stmt|;
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|set_wds_sta
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
if|if
condition|(
name|hapd
operator|->
name|conf
operator|->
name|wds_bridge
index|[
literal|0
index|]
condition|)
name|bridge
operator|=
name|hapd
operator|->
name|conf
operator|->
name|wds_bridge
expr_stmt|;
elseif|else
if|if
condition|(
name|hapd
operator|->
name|conf
operator|->
name|bridge
index|[
literal|0
index|]
condition|)
name|bridge
operator|=
name|hapd
operator|->
name|conf
operator|->
name|bridge
expr_stmt|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|set_wds_sta
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|addr
argument_list|,
name|aid
argument_list|,
name|val
argument_list|,
name|bridge
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_add_sta_node
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|u16
name|auth_alg
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|add_sta_node
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|add_sta_node
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|addr
argument_list|,
name|auth_alg
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_sta_auth
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|u16
name|seq
parameter_list|,
name|u16
name|status
parameter_list|,
specifier|const
name|u8
modifier|*
name|ie
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|sta_auth
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|sta_auth
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|hapd
operator|->
name|own_addr
argument_list|,
name|addr
argument_list|,
name|seq
argument_list|,
name|status
argument_list|,
name|ie
argument_list|,
name|len
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_sta_assoc
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|int
name|reassoc
parameter_list|,
name|u16
name|status
parameter_list|,
specifier|const
name|u8
modifier|*
name|ie
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|sta_assoc
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|sta_assoc
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|hapd
operator|->
name|own_addr
argument_list|,
name|addr
argument_list|,
name|reassoc
argument_list|,
name|status
argument_list|,
name|ie
argument_list|,
name|len
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_sta_add
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|u16
name|aid
parameter_list|,
name|u16
name|capability
parameter_list|,
specifier|const
name|u8
modifier|*
name|supp_rates
parameter_list|,
name|size_t
name|supp_rates_len
parameter_list|,
name|u16
name|listen_interval
parameter_list|,
specifier|const
name|struct
name|ieee80211_ht_capabilities
modifier|*
name|ht_capab
parameter_list|,
name|u32
name|flags
parameter_list|,
name|u8
name|qosinfo
parameter_list|)
block|{
name|struct
name|hostapd_sta_add_params
name|params
decl_stmt|;
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
if|if
condition|(
name|hapd
operator|->
name|driver
operator|->
name|sta_add
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
name|os_memset
argument_list|(
operator|&
name|params
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|params
argument_list|)
argument_list|)
expr_stmt|;
name|params
operator|.
name|addr
operator|=
name|addr
expr_stmt|;
name|params
operator|.
name|aid
operator|=
name|aid
expr_stmt|;
name|params
operator|.
name|capability
operator|=
name|capability
expr_stmt|;
name|params
operator|.
name|supp_rates
operator|=
name|supp_rates
expr_stmt|;
name|params
operator|.
name|supp_rates_len
operator|=
name|supp_rates_len
expr_stmt|;
name|params
operator|.
name|listen_interval
operator|=
name|listen_interval
expr_stmt|;
name|params
operator|.
name|ht_capabilities
operator|=
name|ht_capab
expr_stmt|;
name|params
operator|.
name|flags
operator|=
name|hostapd_sta_flags_to_drv
argument_list|(
name|flags
argument_list|)
expr_stmt|;
name|params
operator|.
name|qosinfo
operator|=
name|qosinfo
expr_stmt|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|sta_add
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
operator|&
name|params
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_add_tspec
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|u8
modifier|*
name|tspec_ie
parameter_list|,
name|size_t
name|tspec_ielen
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|add_tspec
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|add_tspec
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|addr
argument_list|,
name|tspec_ie
argument_list|,
name|tspec_ielen
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_set_privacy
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|int
name|enabled
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|set_privacy
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|set_privacy
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|enabled
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_set_generic_elem
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
specifier|const
name|u8
modifier|*
name|elem
parameter_list|,
name|size_t
name|elem_len
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|set_generic_elem
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|set_generic_elem
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|elem
argument_list|,
name|elem_len
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_get_ssid
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|u8
modifier|*
name|buf
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|hapd_get_ssid
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|hapd_get_ssid
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|buf
argument_list|,
name|len
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_set_ssid
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
specifier|const
name|u8
modifier|*
name|buf
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|hapd_set_ssid
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|hapd_set_ssid
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|buf
argument_list|,
name|len
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_if_add
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|enum
name|wpa_driver_if_type
name|type
parameter_list|,
specifier|const
name|char
modifier|*
name|ifname
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|void
modifier|*
name|bss_ctx
parameter_list|,
name|void
modifier|*
modifier|*
name|drv_priv
parameter_list|,
name|char
modifier|*
name|force_ifname
parameter_list|,
name|u8
modifier|*
name|if_addr
parameter_list|,
specifier|const
name|char
modifier|*
name|bridge
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|if_add
operator|==
name|NULL
condition|)
return|return
operator|-
literal|1
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|if_add
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|type
argument_list|,
name|ifname
argument_list|,
name|addr
argument_list|,
name|bss_ctx
argument_list|,
name|drv_priv
argument_list|,
name|force_ifname
argument_list|,
name|if_addr
argument_list|,
name|bridge
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_if_remove
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|enum
name|wpa_driver_if_type
name|type
parameter_list|,
specifier|const
name|char
modifier|*
name|ifname
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|if_remove
operator|==
name|NULL
condition|)
return|return
operator|-
literal|1
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|if_remove
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|type
argument_list|,
name|ifname
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_set_ieee8021x
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|struct
name|wpa_bss_params
modifier|*
name|params
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|set_ieee8021x
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|set_ieee8021x
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|params
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_get_seqnum
parameter_list|(
specifier|const
name|char
modifier|*
name|ifname
parameter_list|,
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|int
name|idx
parameter_list|,
name|u8
modifier|*
name|seq
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|get_seqnum
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|get_seqnum
argument_list|(
name|ifname
argument_list|,
name|hapd
operator|->
name|drv_priv
argument_list|,
name|addr
argument_list|,
name|idx
argument_list|,
name|seq
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_flush
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|flush
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|flush
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_set_freq
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|int
name|mode
parameter_list|,
name|int
name|freq
parameter_list|,
name|int
name|channel
parameter_list|,
name|int
name|ht_enabled
parameter_list|,
name|int
name|sec_channel_offset
parameter_list|)
block|{
name|struct
name|hostapd_freq_params
name|data
decl_stmt|;
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
if|if
condition|(
name|hapd
operator|->
name|driver
operator|->
name|set_freq
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
name|os_memset
argument_list|(
operator|&
name|data
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
name|data
operator|.
name|mode
operator|=
name|mode
expr_stmt|;
name|data
operator|.
name|freq
operator|=
name|freq
expr_stmt|;
name|data
operator|.
name|channel
operator|=
name|channel
expr_stmt|;
name|data
operator|.
name|ht_enabled
operator|=
name|ht_enabled
expr_stmt|;
name|data
operator|.
name|sec_channel_offset
operator|=
name|sec_channel_offset
expr_stmt|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|set_freq
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
operator|&
name|data
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_set_rts
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|int
name|rts
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|set_rts
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|set_rts
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|rts
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_set_frag
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|int
name|frag
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|set_frag
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|set_frag
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|frag
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_sta_set_flags
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|u8
modifier|*
name|addr
parameter_list|,
name|int
name|total_flags
parameter_list|,
name|int
name|flags_or
parameter_list|,
name|int
name|flags_and
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|sta_set_flags
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|sta_set_flags
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|addr
argument_list|,
name|total_flags
argument_list|,
name|flags_or
argument_list|,
name|flags_and
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_set_country
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
specifier|const
name|char
modifier|*
name|country
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|set_country
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|set_country
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|country
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_set_tx_queue_params
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|int
name|queue
parameter_list|,
name|int
name|aifs
parameter_list|,
name|int
name|cw_min
parameter_list|,
name|int
name|cw_max
parameter_list|,
name|int
name|burst_time
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|set_tx_queue_params
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|set_tx_queue_params
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|queue
argument_list|,
name|aifs
argument_list|,
name|cw_min
argument_list|,
name|cw_max
argument_list|,
name|burst_time
argument_list|)
return|;
block|}
end_function

begin_function
name|struct
name|hostapd_hw_modes
modifier|*
name|hostapd_get_hw_feature_data
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|u16
modifier|*
name|num_modes
parameter_list|,
name|u16
modifier|*
name|flags
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|get_hw_feature_data
operator|==
name|NULL
condition|)
return|return
name|NULL
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|get_hw_feature_data
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|num_modes
argument_list|,
name|flags
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_driver_commit
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|commit
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|commit
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_drv_none
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|)
block|{
return|return
name|hapd
operator|->
name|driver
operator|&&
name|os_strcmp
argument_list|(
name|hapd
operator|->
name|driver
operator|->
name|name
argument_list|,
literal|"none"
argument_list|)
operator|==
literal|0
return|;
block|}
end_function

begin_function
name|int
name|hostapd_driver_scan
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|struct
name|wpa_driver_scan_params
modifier|*
name|params
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|&&
name|hapd
operator|->
name|driver
operator|->
name|scan2
condition|)
return|return
name|hapd
operator|->
name|driver
operator|->
name|scan2
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|params
argument_list|)
return|;
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
name|struct
name|wpa_scan_results
modifier|*
name|hostapd_driver_get_scan_results
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|&&
name|hapd
operator|->
name|driver
operator|->
name|get_scan_results2
condition|)
return|return
name|hapd
operator|->
name|driver
operator|->
name|get_scan_results2
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|)
return|;
return|return
name|NULL
return|;
block|}
end_function

begin_function
name|int
name|hostapd_driver_set_noa
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|u8
name|count
parameter_list|,
name|int
name|start
parameter_list|,
name|int
name|duration
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|&&
name|hapd
operator|->
name|driver
operator|->
name|set_noa
condition|)
return|return
name|hapd
operator|->
name|driver
operator|->
name|set_noa
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|count
argument_list|,
name|start
argument_list|,
name|duration
argument_list|)
return|;
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
name|int
name|hostapd_drv_set_key
parameter_list|(
specifier|const
name|char
modifier|*
name|ifname
parameter_list|,
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|enum
name|wpa_alg
name|alg
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|int
name|key_idx
parameter_list|,
name|int
name|set_tx
parameter_list|,
specifier|const
name|u8
modifier|*
name|seq
parameter_list|,
name|size_t
name|seq_len
parameter_list|,
specifier|const
name|u8
modifier|*
name|key
parameter_list|,
name|size_t
name|key_len
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|set_key
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|set_key
argument_list|(
name|ifname
argument_list|,
name|hapd
operator|->
name|drv_priv
argument_list|,
name|alg
argument_list|,
name|addr
argument_list|,
name|key_idx
argument_list|,
name|set_tx
argument_list|,
name|seq
argument_list|,
name|seq_len
argument_list|,
name|key
argument_list|,
name|key_len
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_drv_send_mlme
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
specifier|const
name|void
modifier|*
name|msg
parameter_list|,
name|size_t
name|len
parameter_list|,
name|int
name|noack
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|send_mlme
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|send_mlme
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|msg
argument_list|,
name|len
argument_list|,
name|noack
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_drv_sta_deauth
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|int
name|reason
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|sta_deauth
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|sta_deauth
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|hapd
operator|->
name|own_addr
argument_list|,
name|addr
argument_list|,
name|reason
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_drv_sta_disassoc
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|int
name|reason
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|sta_disassoc
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|sta_disassoc
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|hapd
operator|->
name|own_addr
argument_list|,
name|addr
argument_list|,
name|reason
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_drv_wnm_oper
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|enum
name|wnm_oper
name|oper
parameter_list|,
specifier|const
name|u8
modifier|*
name|peer
parameter_list|,
name|u8
modifier|*
name|buf
parameter_list|,
name|u16
modifier|*
name|buf_len
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|wnm_oper
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|wnm_oper
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|oper
argument_list|,
name|peer
argument_list|,
name|buf
argument_list|,
name|buf_len
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|hostapd_drv_send_action
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|unsigned
name|int
name|freq
parameter_list|,
name|unsigned
name|int
name|wait
parameter_list|,
specifier|const
name|u8
modifier|*
name|dst
parameter_list|,
specifier|const
name|u8
modifier|*
name|data
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
if|if
condition|(
name|hapd
operator|->
name|driver
operator|==
name|NULL
operator|||
name|hapd
operator|->
name|driver
operator|->
name|send_action
operator|==
name|NULL
condition|)
return|return
literal|0
return|;
return|return
name|hapd
operator|->
name|driver
operator|->
name|send_action
argument_list|(
name|hapd
operator|->
name|drv_priv
argument_list|,
name|freq
argument_list|,
name|wait
argument_list|,
name|dst
argument_list|,
name|hapd
operator|->
name|own_addr
argument_list|,
name|hapd
operator|->
name|own_addr
argument_list|,
name|data
argument_list|,
name|len
argument_list|,
literal|0
argument_list|)
return|;
block|}
end_function

end_unit

