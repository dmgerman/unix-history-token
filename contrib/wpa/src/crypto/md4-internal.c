begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * MD4 hash implementation  * Copyright (c) 2006, Jouni Malinen<j@w1.fi>  *  * This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License version 2 as  * published by the Free Software Foundation.  *  * Alternatively, this software may be distributed under the terms of BSD  * license.  *  * See README and COPYING for more details.  */
end_comment

begin_include
include|#
directive|include
file|"includes.h"
end_include

begin_include
include|#
directive|include
file|"common.h"
end_include

begin_include
include|#
directive|include
file|"crypto.h"
end_include

begin_define
define|#
directive|define
name|MD4_BLOCK_LENGTH
value|64
end_define

begin_define
define|#
directive|define
name|MD4_DIGEST_LENGTH
value|16
end_define

begin_typedef
typedef|typedef
struct|struct
name|MD4Context
block|{
name|u32
name|state
index|[
literal|4
index|]
decl_stmt|;
comment|/* state */
name|u64
name|count
decl_stmt|;
comment|/* number of bits, mod 2^64 */
name|u8
name|buffer
index|[
name|MD4_BLOCK_LENGTH
index|]
decl_stmt|;
comment|/* input buffer */
block|}
name|MD4_CTX
typedef|;
end_typedef

begin_function_decl
specifier|static
name|void
name|MD4Init
parameter_list|(
name|MD4_CTX
modifier|*
name|ctx
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|MD4Update
parameter_list|(
name|MD4_CTX
modifier|*
name|ctx
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|input
parameter_list|,
name|size_t
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|MD4Final
parameter_list|(
name|unsigned
name|char
name|digest
index|[
name|MD4_DIGEST_LENGTH
index|]
parameter_list|,
name|MD4_CTX
modifier|*
name|ctx
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|int
name|md4_vector
parameter_list|(
name|size_t
name|num_elem
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
index|[]
parameter_list|,
specifier|const
name|size_t
modifier|*
name|len
parameter_list|,
name|u8
modifier|*
name|mac
parameter_list|)
block|{
name|MD4_CTX
name|ctx
decl_stmt|;
name|size_t
name|i
decl_stmt|;
name|MD4Init
argument_list|(
operator|&
name|ctx
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|num_elem
condition|;
name|i
operator|++
control|)
name|MD4Update
argument_list|(
operator|&
name|ctx
argument_list|,
name|addr
index|[
name|i
index|]
argument_list|,
name|len
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|MD4Final
argument_list|(
name|mac
argument_list|,
operator|&
name|ctx
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_comment
comment|/* ===== start - public domain MD4 implementation ===== */
end_comment

begin_comment
comment|/*	$OpenBSD: md4.c,v 1.7 2005/08/08 08:05:35 espie Exp $	*/
end_comment

begin_comment
comment|/*  * This code implements the MD4 message-digest algorithm.  * The algorithm is due to Ron Rivest.	This code was  * written by Colin Plumb in 1993, no copyright is claimed.  * This code is in the public domain; do with it what you wish.  * Todd C. Miller modified the MD5 code to do MD4 based on RFC 1186.  *  * Equivalent code is available from RSA Data Security, Inc.  * This code has been tested against that, and is equivalent,  * except that you don't need to include two pages of legalese  * with every copy.  *  * To compute the message digest of a chunk of bytes, declare an  * MD4Context structure, pass it to MD4Init, call MD4Update as  * needed on buffers full of bytes, and then call MD4Final, which  * will fill a supplied 16-byte array with the digest.  */
end_comment

begin_define
define|#
directive|define
name|MD4_DIGEST_STRING_LENGTH
value|(MD4_DIGEST_LENGTH * 2 + 1)
end_define

begin_function_decl
specifier|static
name|void
name|MD4Transform
parameter_list|(
name|u32
name|state
index|[
literal|4
index|]
parameter_list|,
specifier|const
name|u8
name|block
index|[
name|MD4_BLOCK_LENGTH
index|]
parameter_list|)
function_decl|;
end_function_decl

begin_define
define|#
directive|define
name|PUT_64BIT_LE
parameter_list|(
name|cp
parameter_list|,
name|value
parameter_list|)
value|do {					\ 	(cp)[7] = (value)>> 56;					\ 	(cp)[6] = (value)>> 48;					\ 	(cp)[5] = (value)>> 40;					\ 	(cp)[4] = (value)>> 32;					\ 	(cp)[3] = (value)>> 24;					\ 	(cp)[2] = (value)>> 16;					\ 	(cp)[1] = (value)>> 8;						\ 	(cp)[0] = (value); } while (0)
end_define

begin_define
define|#
directive|define
name|PUT_32BIT_LE
parameter_list|(
name|cp
parameter_list|,
name|value
parameter_list|)
value|do {					\ 	(cp)[3] = (value)>> 24;					\ 	(cp)[2] = (value)>> 16;					\ 	(cp)[1] = (value)>> 8;						\ 	(cp)[0] = (value); } while (0)
end_define

begin_decl_stmt
specifier|static
name|u8
name|PADDING
index|[
name|MD4_BLOCK_LENGTH
index|]
init|=
block|{
literal|0x80
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Start MD4 accumulation.  * Set bit count to 0 and buffer to mysterious initialization constants.  */
end_comment

begin_function
specifier|static
name|void
name|MD4Init
parameter_list|(
name|MD4_CTX
modifier|*
name|ctx
parameter_list|)
block|{
name|ctx
operator|->
name|count
operator|=
literal|0
expr_stmt|;
name|ctx
operator|->
name|state
index|[
literal|0
index|]
operator|=
literal|0x67452301
expr_stmt|;
name|ctx
operator|->
name|state
index|[
literal|1
index|]
operator|=
literal|0xefcdab89
expr_stmt|;
name|ctx
operator|->
name|state
index|[
literal|2
index|]
operator|=
literal|0x98badcfe
expr_stmt|;
name|ctx
operator|->
name|state
index|[
literal|3
index|]
operator|=
literal|0x10325476
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Update context to reflect the concatenation of another buffer full  * of bytes.  */
end_comment

begin_function
specifier|static
name|void
name|MD4Update
parameter_list|(
name|MD4_CTX
modifier|*
name|ctx
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|input
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
name|size_t
name|have
decl_stmt|,
name|need
decl_stmt|;
comment|/* Check how many bytes we already have and how many more we need. */
name|have
operator|=
call|(
name|size_t
call|)
argument_list|(
operator|(
name|ctx
operator|->
name|count
operator|>>
literal|3
operator|)
operator|&
operator|(
name|MD4_BLOCK_LENGTH
operator|-
literal|1
operator|)
argument_list|)
expr_stmt|;
name|need
operator|=
name|MD4_BLOCK_LENGTH
operator|-
name|have
expr_stmt|;
comment|/* Update bitcount */
name|ctx
operator|->
name|count
operator|+=
operator|(
name|u64
operator|)
name|len
operator|<<
literal|3
expr_stmt|;
if|if
condition|(
name|len
operator|>=
name|need
condition|)
block|{
if|if
condition|(
name|have
operator|!=
literal|0
condition|)
block|{
name|os_memcpy
argument_list|(
name|ctx
operator|->
name|buffer
operator|+
name|have
argument_list|,
name|input
argument_list|,
name|need
argument_list|)
expr_stmt|;
name|MD4Transform
argument_list|(
name|ctx
operator|->
name|state
argument_list|,
name|ctx
operator|->
name|buffer
argument_list|)
expr_stmt|;
name|input
operator|+=
name|need
expr_stmt|;
name|len
operator|-=
name|need
expr_stmt|;
name|have
operator|=
literal|0
expr_stmt|;
block|}
comment|/* Process data in MD4_BLOCK_LENGTH-byte chunks. */
while|while
condition|(
name|len
operator|>=
name|MD4_BLOCK_LENGTH
condition|)
block|{
name|MD4Transform
argument_list|(
name|ctx
operator|->
name|state
argument_list|,
name|input
argument_list|)
expr_stmt|;
name|input
operator|+=
name|MD4_BLOCK_LENGTH
expr_stmt|;
name|len
operator|-=
name|MD4_BLOCK_LENGTH
expr_stmt|;
block|}
block|}
comment|/* Handle any remaining bytes of data. */
if|if
condition|(
name|len
operator|!=
literal|0
condition|)
name|os_memcpy
argument_list|(
name|ctx
operator|->
name|buffer
operator|+
name|have
argument_list|,
name|input
argument_list|,
name|len
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Pad pad to 64-byte boundary with the bit pattern  * 1 0* (64-bit count of bits processed, MSB-first)  */
end_comment

begin_function
specifier|static
name|void
name|MD4Pad
parameter_list|(
name|MD4_CTX
modifier|*
name|ctx
parameter_list|)
block|{
name|u8
name|count
index|[
literal|8
index|]
decl_stmt|;
name|size_t
name|padlen
decl_stmt|;
comment|/* Convert count to 8 bytes in little endian order. */
name|PUT_64BIT_LE
argument_list|(
name|count
argument_list|,
name|ctx
operator|->
name|count
argument_list|)
expr_stmt|;
comment|/* Pad out to 56 mod 64. */
name|padlen
operator|=
name|MD4_BLOCK_LENGTH
operator|-
operator|(
operator|(
name|ctx
operator|->
name|count
operator|>>
literal|3
operator|)
operator|&
operator|(
name|MD4_BLOCK_LENGTH
operator|-
literal|1
operator|)
operator|)
expr_stmt|;
if|if
condition|(
name|padlen
operator|<
literal|1
operator|+
literal|8
condition|)
name|padlen
operator|+=
name|MD4_BLOCK_LENGTH
expr_stmt|;
name|MD4Update
argument_list|(
name|ctx
argument_list|,
name|PADDING
argument_list|,
name|padlen
operator|-
literal|8
argument_list|)
expr_stmt|;
comment|/* padlen - 8<= 64 */
name|MD4Update
argument_list|(
name|ctx
argument_list|,
name|count
argument_list|,
literal|8
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Final wrapup--call MD4Pad, fill in digest and zero out ctx.  */
end_comment

begin_function
specifier|static
name|void
name|MD4Final
parameter_list|(
name|unsigned
name|char
name|digest
index|[
name|MD4_DIGEST_LENGTH
index|]
parameter_list|,
name|MD4_CTX
modifier|*
name|ctx
parameter_list|)
block|{
name|int
name|i
decl_stmt|;
name|MD4Pad
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
if|if
condition|(
name|digest
operator|!=
name|NULL
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|4
condition|;
name|i
operator|++
control|)
name|PUT_32BIT_LE
argument_list|(
name|digest
operator|+
name|i
operator|*
literal|4
argument_list|,
name|ctx
operator|->
name|state
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|os_memset
argument_list|(
name|ctx
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|ctx
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* The three core functions - F1 is optimized somewhat */
end_comment

begin_comment
comment|/* #define F1(x, y, z) (x& y | ~x& z) */
end_comment

begin_define
define|#
directive|define
name|F1
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|,
name|z
parameter_list|)
value|(z ^ (x& (y ^ z)))
end_define

begin_define
define|#
directive|define
name|F2
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|,
name|z
parameter_list|)
value|((x& y) | (x& z) | (y& z))
end_define

begin_define
define|#
directive|define
name|F3
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|,
name|z
parameter_list|)
value|(x ^ y ^ z)
end_define

begin_comment
comment|/* This is the central step in the MD4 algorithm. */
end_comment

begin_define
define|#
directive|define
name|MD4STEP
parameter_list|(
name|f
parameter_list|,
name|w
parameter_list|,
name|x
parameter_list|,
name|y
parameter_list|,
name|z
parameter_list|,
name|data
parameter_list|,
name|s
parameter_list|)
define|\
value|( w += f(x, y, z) + data,  w = w<<s | w>>(32-s) )
end_define

begin_comment
comment|/*  * The core of the MD4 algorithm, this alters an existing MD4 hash to  * reflect the addition of 16 longwords of new data.  MD4Update blocks  * the data and converts bytes into longwords for this routine.  */
end_comment

begin_function
specifier|static
name|void
name|MD4Transform
parameter_list|(
name|u32
name|state
index|[
literal|4
index|]
parameter_list|,
specifier|const
name|u8
name|block
index|[
name|MD4_BLOCK_LENGTH
index|]
parameter_list|)
block|{
name|u32
name|a
decl_stmt|,
name|b
decl_stmt|,
name|c
decl_stmt|,
name|d
decl_stmt|,
name|in
index|[
name|MD4_BLOCK_LENGTH
operator|/
literal|4
index|]
decl_stmt|;
if|#
directive|if
name|BYTE_ORDER
operator|==
name|LITTLE_ENDIAN
name|os_memcpy
argument_list|(
name|in
argument_list|,
name|block
argument_list|,
sizeof|sizeof
argument_list|(
name|in
argument_list|)
argument_list|)
expr_stmt|;
else|#
directive|else
for|for
control|(
name|a
operator|=
literal|0
init|;
name|a
operator|<
name|MD4_BLOCK_LENGTH
operator|/
literal|4
condition|;
name|a
operator|++
control|)
block|{
name|in
index|[
name|a
index|]
operator|=
call|(
name|u32
call|)
argument_list|(
call|(
name|u32
call|)
argument_list|(
name|block
index|[
name|a
operator|*
literal|4
operator|+
literal|0
index|]
argument_list|)
operator||
call|(
name|u32
call|)
argument_list|(
name|block
index|[
name|a
operator|*
literal|4
operator|+
literal|1
index|]
argument_list|)
operator|<<
literal|8
operator||
call|(
name|u32
call|)
argument_list|(
name|block
index|[
name|a
operator|*
literal|4
operator|+
literal|2
index|]
argument_list|)
operator|<<
literal|16
operator||
call|(
name|u32
call|)
argument_list|(
name|block
index|[
name|a
operator|*
literal|4
operator|+
literal|3
index|]
argument_list|)
operator|<<
literal|24
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
name|a
operator|=
name|state
index|[
literal|0
index|]
expr_stmt|;
name|b
operator|=
name|state
index|[
literal|1
index|]
expr_stmt|;
name|c
operator|=
name|state
index|[
literal|2
index|]
expr_stmt|;
name|d
operator|=
name|state
index|[
literal|3
index|]
expr_stmt|;
name|MD4STEP
argument_list|(
name|F1
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|in
index|[
literal|0
index|]
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F1
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|in
index|[
literal|1
index|]
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F1
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|in
index|[
literal|2
index|]
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F1
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|in
index|[
literal|3
index|]
argument_list|,
literal|19
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F1
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|in
index|[
literal|4
index|]
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F1
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|in
index|[
literal|5
index|]
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F1
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|in
index|[
literal|6
index|]
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F1
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|in
index|[
literal|7
index|]
argument_list|,
literal|19
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F1
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|in
index|[
literal|8
index|]
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F1
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|in
index|[
literal|9
index|]
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F1
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|in
index|[
literal|10
index|]
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F1
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|in
index|[
literal|11
index|]
argument_list|,
literal|19
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F1
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|in
index|[
literal|12
index|]
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F1
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|in
index|[
literal|13
index|]
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F1
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|in
index|[
literal|14
index|]
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F1
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|in
index|[
literal|15
index|]
argument_list|,
literal|19
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F2
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|in
index|[
literal|0
index|]
operator|+
literal|0x5a827999
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F2
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|in
index|[
literal|4
index|]
operator|+
literal|0x5a827999
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F2
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|in
index|[
literal|8
index|]
operator|+
literal|0x5a827999
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F2
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|in
index|[
literal|12
index|]
operator|+
literal|0x5a827999
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F2
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|in
index|[
literal|1
index|]
operator|+
literal|0x5a827999
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F2
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|in
index|[
literal|5
index|]
operator|+
literal|0x5a827999
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F2
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|in
index|[
literal|9
index|]
operator|+
literal|0x5a827999
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F2
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|in
index|[
literal|13
index|]
operator|+
literal|0x5a827999
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F2
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|in
index|[
literal|2
index|]
operator|+
literal|0x5a827999
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F2
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|in
index|[
literal|6
index|]
operator|+
literal|0x5a827999
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F2
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|in
index|[
literal|10
index|]
operator|+
literal|0x5a827999
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F2
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|in
index|[
literal|14
index|]
operator|+
literal|0x5a827999
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F2
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|in
index|[
literal|3
index|]
operator|+
literal|0x5a827999
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F2
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|in
index|[
literal|7
index|]
operator|+
literal|0x5a827999
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F2
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|in
index|[
literal|11
index|]
operator|+
literal|0x5a827999
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F2
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|in
index|[
literal|15
index|]
operator|+
literal|0x5a827999
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F3
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|in
index|[
literal|0
index|]
operator|+
literal|0x6ed9eba1
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F3
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|in
index|[
literal|8
index|]
operator|+
literal|0x6ed9eba1
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F3
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|in
index|[
literal|4
index|]
operator|+
literal|0x6ed9eba1
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F3
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|in
index|[
literal|12
index|]
operator|+
literal|0x6ed9eba1
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F3
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|in
index|[
literal|2
index|]
operator|+
literal|0x6ed9eba1
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F3
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|in
index|[
literal|10
index|]
operator|+
literal|0x6ed9eba1
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F3
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|in
index|[
literal|6
index|]
operator|+
literal|0x6ed9eba1
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F3
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|in
index|[
literal|14
index|]
operator|+
literal|0x6ed9eba1
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F3
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|in
index|[
literal|1
index|]
operator|+
literal|0x6ed9eba1
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F3
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|in
index|[
literal|9
index|]
operator|+
literal|0x6ed9eba1
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F3
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|in
index|[
literal|5
index|]
operator|+
literal|0x6ed9eba1
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F3
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|in
index|[
literal|13
index|]
operator|+
literal|0x6ed9eba1
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F3
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|in
index|[
literal|3
index|]
operator|+
literal|0x6ed9eba1
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F3
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|in
index|[
literal|11
index|]
operator|+
literal|0x6ed9eba1
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F3
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|in
index|[
literal|7
index|]
operator|+
literal|0x6ed9eba1
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|MD4STEP
argument_list|(
name|F3
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|in
index|[
literal|15
index|]
operator|+
literal|0x6ed9eba1
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|state
index|[
literal|0
index|]
operator|+=
name|a
expr_stmt|;
name|state
index|[
literal|1
index|]
operator|+=
name|b
expr_stmt|;
name|state
index|[
literal|2
index|]
operator|+=
name|c
expr_stmt|;
name|state
index|[
literal|3
index|]
operator|+=
name|d
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ===== end - public domain MD4 implementation ===== */
end_comment

end_unit

