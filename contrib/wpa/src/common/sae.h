begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Simultaneous authentication of equals  * Copyright (c) 2012-2013, Jouni Malinen<j@w1.fi>  *  * This software may be distributed under the terms of the BSD license.  * See README for more details.  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|SAE_H
end_ifndef

begin_define
define|#
directive|define
name|SAE_H
end_define

begin_define
define|#
directive|define
name|SAE_KCK_LEN
value|32
end_define

begin_define
define|#
directive|define
name|SAE_PMK_LEN
value|32
end_define

begin_define
define|#
directive|define
name|SAE_PMKID_LEN
value|16
end_define

begin_define
define|#
directive|define
name|SAE_KEYSEED_KEY_LEN
value|32
end_define

begin_define
define|#
directive|define
name|SAE_MAX_PRIME_LEN
value|512
end_define

begin_define
define|#
directive|define
name|SAE_MAX_ECC_PRIME_LEN
value|66
end_define

begin_define
define|#
directive|define
name|SAE_COMMIT_MAX_LEN
value|(2 + 3 * SAE_MAX_PRIME_LEN)
end_define

begin_define
define|#
directive|define
name|SAE_CONFIRM_MAX_LEN
value|(2 + SAE_MAX_PRIME_LEN)
end_define

begin_comment
comment|/* Special value returned by sae_parse_commit() */
end_comment

begin_define
define|#
directive|define
name|SAE_SILENTLY_DISCARD
value|65535
end_define

begin_struct
struct|struct
name|sae_temporary_data
block|{
name|u8
name|kck
index|[
name|SAE_KCK_LEN
index|]
decl_stmt|;
name|struct
name|crypto_bignum
modifier|*
name|own_commit_scalar
decl_stmt|;
name|struct
name|crypto_bignum
modifier|*
name|own_commit_element_ffc
decl_stmt|;
name|struct
name|crypto_ec_point
modifier|*
name|own_commit_element_ecc
decl_stmt|;
name|struct
name|crypto_bignum
modifier|*
name|peer_commit_element_ffc
decl_stmt|;
name|struct
name|crypto_ec_point
modifier|*
name|peer_commit_element_ecc
decl_stmt|;
name|struct
name|crypto_ec_point
modifier|*
name|pwe_ecc
decl_stmt|;
name|struct
name|crypto_bignum
modifier|*
name|pwe_ffc
decl_stmt|;
name|struct
name|crypto_bignum
modifier|*
name|sae_rand
decl_stmt|;
name|struct
name|crypto_ec
modifier|*
name|ec
decl_stmt|;
name|int
name|prime_len
decl_stmt|;
specifier|const
name|struct
name|dh_group
modifier|*
name|dh
decl_stmt|;
specifier|const
name|struct
name|crypto_bignum
modifier|*
name|prime
decl_stmt|;
specifier|const
name|struct
name|crypto_bignum
modifier|*
name|order
decl_stmt|;
name|struct
name|crypto_bignum
modifier|*
name|prime_buf
decl_stmt|;
name|struct
name|crypto_bignum
modifier|*
name|order_buf
decl_stmt|;
name|struct
name|wpabuf
modifier|*
name|anti_clogging_token
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|sae_data
block|{
enum|enum
block|{
name|SAE_NOTHING
block|,
name|SAE_COMMITTED
block|,
name|SAE_CONFIRMED
block|,
name|SAE_ACCEPTED
block|}
name|state
enum|;
name|u16
name|send_confirm
decl_stmt|;
name|u8
name|pmk
index|[
name|SAE_PMK_LEN
index|]
decl_stmt|;
name|struct
name|crypto_bignum
modifier|*
name|peer_commit_scalar
decl_stmt|;
name|int
name|group
decl_stmt|;
name|int
name|sync
decl_stmt|;
name|struct
name|sae_temporary_data
modifier|*
name|tmp
decl_stmt|;
block|}
struct|;
end_struct

begin_function_decl
name|int
name|sae_set_group
parameter_list|(
name|struct
name|sae_data
modifier|*
name|sae
parameter_list|,
name|int
name|group
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|sae_clear_temp_data
parameter_list|(
name|struct
name|sae_data
modifier|*
name|sae
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|sae_clear_data
parameter_list|(
name|struct
name|sae_data
modifier|*
name|sae
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sae_prepare_commit
parameter_list|(
specifier|const
name|u8
modifier|*
name|addr1
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr2
parameter_list|,
specifier|const
name|u8
modifier|*
name|password
parameter_list|,
name|size_t
name|password_len
parameter_list|,
name|struct
name|sae_data
modifier|*
name|sae
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sae_process_commit
parameter_list|(
name|struct
name|sae_data
modifier|*
name|sae
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|sae_write_commit
parameter_list|(
name|struct
name|sae_data
modifier|*
name|sae
parameter_list|,
name|struct
name|wpabuf
modifier|*
name|buf
parameter_list|,
specifier|const
name|struct
name|wpabuf
modifier|*
name|token
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|u16
name|sae_parse_commit
parameter_list|(
name|struct
name|sae_data
modifier|*
name|sae
parameter_list|,
specifier|const
name|u8
modifier|*
name|data
parameter_list|,
name|size_t
name|len
parameter_list|,
specifier|const
name|u8
modifier|*
modifier|*
name|token
parameter_list|,
name|size_t
modifier|*
name|token_len
parameter_list|,
name|int
modifier|*
name|allowed_groups
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|sae_write_confirm
parameter_list|(
name|struct
name|sae_data
modifier|*
name|sae
parameter_list|,
name|struct
name|wpabuf
modifier|*
name|buf
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|sae_check_confirm
parameter_list|(
name|struct
name|sae_data
modifier|*
name|sae
parameter_list|,
specifier|const
name|u8
modifier|*
name|data
parameter_list|,
name|size_t
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|u16
name|sae_group_allowed
parameter_list|(
name|struct
name|sae_data
modifier|*
name|sae
parameter_list|,
name|int
modifier|*
name|allowed_groups
parameter_list|,
name|u16
name|group
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* SAE_H */
end_comment

end_unit

