begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Wi-Fi Protected Setup - External Registrar  * Copyright (c) 2009, Jouni Malinen<j@w1.fi>  *  * This software may be distributed under the terms of the BSD license.  * See README for more details.  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|WPS_ER_H
end_ifndef

begin_define
define|#
directive|define
name|WPS_ER_H
end_define

begin_include
include|#
directive|include
file|"utils/list.h"
end_include

begin_struct
struct|struct
name|wps_er_sta
block|{
name|struct
name|dl_list
name|list
decl_stmt|;
name|struct
name|wps_er_ap
modifier|*
name|ap
decl_stmt|;
name|u8
name|addr
index|[
name|ETH_ALEN
index|]
decl_stmt|;
name|u16
name|config_methods
decl_stmt|;
name|u8
name|uuid
index|[
name|WPS_UUID_LEN
index|]
decl_stmt|;
name|u8
name|pri_dev_type
index|[
literal|8
index|]
decl_stmt|;
name|u16
name|dev_passwd_id
decl_stmt|;
name|int
name|m1_received
decl_stmt|;
name|char
modifier|*
name|manufacturer
decl_stmt|;
name|char
modifier|*
name|model_name
decl_stmt|;
name|char
modifier|*
name|model_number
decl_stmt|;
name|char
modifier|*
name|serial_number
decl_stmt|;
name|char
modifier|*
name|dev_name
decl_stmt|;
name|struct
name|wps_data
modifier|*
name|wps
decl_stmt|;
name|struct
name|http_client
modifier|*
name|http
decl_stmt|;
name|struct
name|wps_credential
modifier|*
name|cred
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|wps_er_ap
block|{
name|struct
name|dl_list
name|list
decl_stmt|;
name|struct
name|wps_er
modifier|*
name|er
decl_stmt|;
name|struct
name|dl_list
name|sta
decl_stmt|;
comment|/* list of STAs/Enrollees using this AP */
name|struct
name|in_addr
name|addr
decl_stmt|;
name|char
modifier|*
name|location
decl_stmt|;
name|struct
name|http_client
modifier|*
name|http
decl_stmt|;
name|struct
name|wps_data
modifier|*
name|wps
decl_stmt|;
name|u8
name|uuid
index|[
name|WPS_UUID_LEN
index|]
decl_stmt|;
name|u8
name|pri_dev_type
index|[
literal|8
index|]
decl_stmt|;
name|u8
name|wps_state
decl_stmt|;
name|u8
name|mac_addr
index|[
name|ETH_ALEN
index|]
decl_stmt|;
name|char
modifier|*
name|friendly_name
decl_stmt|;
name|char
modifier|*
name|manufacturer
decl_stmt|;
name|char
modifier|*
name|manufacturer_url
decl_stmt|;
name|char
modifier|*
name|model_description
decl_stmt|;
name|char
modifier|*
name|model_name
decl_stmt|;
name|char
modifier|*
name|model_number
decl_stmt|;
name|char
modifier|*
name|model_url
decl_stmt|;
name|char
modifier|*
name|serial_number
decl_stmt|;
name|char
modifier|*
name|udn
decl_stmt|;
name|char
modifier|*
name|upc
decl_stmt|;
name|char
modifier|*
name|scpd_url
decl_stmt|;
name|char
modifier|*
name|control_url
decl_stmt|;
name|char
modifier|*
name|event_sub_url
decl_stmt|;
name|int
name|subscribed
decl_stmt|;
name|u8
name|sid
index|[
name|WPS_UUID_LEN
index|]
decl_stmt|;
name|unsigned
name|int
name|id
decl_stmt|;
name|struct
name|wps_credential
modifier|*
name|ap_settings
decl_stmt|;
name|void
function_decl|(
modifier|*
name|m1_handler
function_decl|)
parameter_list|(
name|struct
name|wps_er_ap
modifier|*
name|ap
parameter_list|,
name|struct
name|wpabuf
modifier|*
name|m1
parameter_list|)
function_decl|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|wps_er_ap_settings
block|{
name|struct
name|dl_list
name|list
decl_stmt|;
name|u8
name|uuid
index|[
name|WPS_UUID_LEN
index|]
decl_stmt|;
name|struct
name|wps_credential
name|ap_settings
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|wps_er
block|{
name|struct
name|wps_context
modifier|*
name|wps
decl_stmt|;
name|char
name|ifname
index|[
literal|17
index|]
decl_stmt|;
name|u8
name|mac_addr
index|[
name|ETH_ALEN
index|]
decl_stmt|;
comment|/* mac addr of network i.f. we use */
name|char
modifier|*
name|ip_addr_text
decl_stmt|;
comment|/* IP address of network i.f. we use */
name|unsigned
name|ip_addr
decl_stmt|;
comment|/* IP address of network i.f. we use (host order) */
name|int
name|multicast_sd
decl_stmt|;
name|int
name|ssdp_sd
decl_stmt|;
name|struct
name|dl_list
name|ap
decl_stmt|;
name|struct
name|dl_list
name|ap_unsubscribing
decl_stmt|;
name|struct
name|dl_list
name|ap_settings
decl_stmt|;
name|struct
name|http_server
modifier|*
name|http_srv
decl_stmt|;
name|int
name|http_port
decl_stmt|;
name|unsigned
name|int
name|next_ap_id
decl_stmt|;
name|unsigned
name|int
name|event_id
decl_stmt|;
name|int
name|deinitializing
decl_stmt|;
name|void
function_decl|(
modifier|*
name|deinit_done_cb
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|)
function_decl|;
name|void
modifier|*
name|deinit_done_ctx
decl_stmt|;
name|struct
name|in_addr
name|filter_addr
decl_stmt|;
name|int
name|skip_set_sel_reg
decl_stmt|;
specifier|const
name|u8
modifier|*
name|set_sel_reg_uuid_filter
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/* wps_er.c */
end_comment

begin_function_decl
name|void
name|wps_er_ap_add
parameter_list|(
name|struct
name|wps_er
modifier|*
name|er
parameter_list|,
specifier|const
name|u8
modifier|*
name|uuid
parameter_list|,
name|struct
name|in_addr
modifier|*
name|addr
parameter_list|,
specifier|const
name|char
modifier|*
name|location
parameter_list|,
name|int
name|max_age
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wps_er_ap_remove
parameter_list|(
name|struct
name|wps_er
modifier|*
name|er
parameter_list|,
name|struct
name|in_addr
modifier|*
name|addr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wps_er_ap_cache_settings
parameter_list|(
name|struct
name|wps_er
modifier|*
name|er
parameter_list|,
name|struct
name|in_addr
modifier|*
name|addr
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* wps_er_ssdp.c */
end_comment

begin_function_decl
name|int
name|wps_er_ssdp_init
parameter_list|(
name|struct
name|wps_er
modifier|*
name|er
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wps_er_ssdp_deinit
parameter_list|(
name|struct
name|wps_er
modifier|*
name|er
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wps_er_send_ssdp_msearch
parameter_list|(
name|struct
name|wps_er
modifier|*
name|er
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* WPS_ER_H */
end_comment

end_unit

