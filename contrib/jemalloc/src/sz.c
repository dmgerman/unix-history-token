begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_include
include|#
directive|include
file|"jemalloc/internal/jemalloc_preamble.h"
end_include

begin_include
include|#
directive|include
file|"jemalloc/internal/sz.h"
end_include

begin_macro
name|JEMALLOC_ALIGNED
argument_list|(
argument|CACHELINE
argument_list|)
end_macro

begin_decl_stmt
specifier|const
name|size_t
name|sz_pind2sz_tab
index|[
name|NPSIZES
operator|+
literal|1
index|]
init|=
block|{
define|#
directive|define
name|PSZ_yes
parameter_list|(
name|lg_grp
parameter_list|,
name|ndelta
parameter_list|,
name|lg_delta
parameter_list|)
define|\
value|(((ZU(1)<<lg_grp) + (ZU(ndelta)<<lg_delta))),
define|#
directive|define
name|PSZ_no
parameter_list|(
name|lg_grp
parameter_list|,
name|ndelta
parameter_list|,
name|lg_delta
parameter_list|)
define|#
directive|define
name|SC
parameter_list|(
name|index
parameter_list|,
name|lg_grp
parameter_list|,
name|lg_delta
parameter_list|,
name|ndelta
parameter_list|,
name|psz
parameter_list|,
name|bin
parameter_list|,
name|pgs
parameter_list|,
name|lg_delta_lookup
parameter_list|)
define|\
value|PSZ_##psz(lg_grp, ndelta, lg_delta)
name|SIZE_CLASSES
undef|#
directive|undef
name|PSZ_yes
undef|#
directive|undef
name|PSZ_no
undef|#
directive|undef
name|SC
argument_list|(
argument|LARGE_MAXCLASS + PAGE
argument_list|)
block|}
decl_stmt|;
end_decl_stmt

begin_macro
name|JEMALLOC_ALIGNED
argument_list|(
argument|CACHELINE
argument_list|)
end_macro

begin_decl_stmt
specifier|const
name|size_t
name|sz_index2size_tab
index|[
name|NSIZES
index|]
init|=
block|{
define|#
directive|define
name|SC
parameter_list|(
name|index
parameter_list|,
name|lg_grp
parameter_list|,
name|lg_delta
parameter_list|,
name|ndelta
parameter_list|,
name|psz
parameter_list|,
name|bin
parameter_list|,
name|pgs
parameter_list|,
name|lg_delta_lookup
parameter_list|)
define|\
value|((ZU(1)<<lg_grp) + (ZU(ndelta)<<lg_delta)),
name|SIZE_CLASSES
undef|#
directive|undef
name|SC
block|}
decl_stmt|;
end_decl_stmt

begin_macro
name|JEMALLOC_ALIGNED
argument_list|(
argument|CACHELINE
argument_list|)
end_macro

begin_decl_stmt
specifier|const
name|uint8_t
name|sz_size2index_tab
index|[]
init|=
block|{
if|#
directive|if
name|LG_TINY_MIN
operator|==
literal|0
warning|#
directive|warning
literal|"Dangerous LG_TINY_MIN"
define|#
directive|define
name|S2B_0
parameter_list|(
name|i
parameter_list|)
value|i,
elif|#
directive|elif
name|LG_TINY_MIN
operator|==
literal|1
warning|#
directive|warning
literal|"Dangerous LG_TINY_MIN"
define|#
directive|define
name|S2B_1
parameter_list|(
name|i
parameter_list|)
value|i,
elif|#
directive|elif
name|LG_TINY_MIN
operator|==
literal|2
warning|#
directive|warning
literal|"Dangerous LG_TINY_MIN"
define|#
directive|define
name|S2B_2
parameter_list|(
name|i
parameter_list|)
value|i,
elif|#
directive|elif
name|LG_TINY_MIN
operator|==
literal|3
define|#
directive|define
name|S2B_3
parameter_list|(
name|i
parameter_list|)
value|i,
elif|#
directive|elif
name|LG_TINY_MIN
operator|==
literal|4
define|#
directive|define
name|S2B_4
parameter_list|(
name|i
parameter_list|)
value|i,
elif|#
directive|elif
name|LG_TINY_MIN
operator|==
literal|5
define|#
directive|define
name|S2B_5
parameter_list|(
name|i
parameter_list|)
value|i,
elif|#
directive|elif
name|LG_TINY_MIN
operator|==
literal|6
define|#
directive|define
name|S2B_6
parameter_list|(
name|i
parameter_list|)
value|i,
elif|#
directive|elif
name|LG_TINY_MIN
operator|==
literal|7
define|#
directive|define
name|S2B_7
parameter_list|(
name|i
parameter_list|)
value|i,
elif|#
directive|elif
name|LG_TINY_MIN
operator|==
literal|8
define|#
directive|define
name|S2B_8
parameter_list|(
name|i
parameter_list|)
value|i,
elif|#
directive|elif
name|LG_TINY_MIN
operator|==
literal|9
define|#
directive|define
name|S2B_9
parameter_list|(
name|i
parameter_list|)
value|i,
elif|#
directive|elif
name|LG_TINY_MIN
operator|==
literal|10
define|#
directive|define
name|S2B_10
parameter_list|(
name|i
parameter_list|)
value|i,
elif|#
directive|elif
name|LG_TINY_MIN
operator|==
literal|11
define|#
directive|define
name|S2B_11
parameter_list|(
name|i
parameter_list|)
value|i,
else|#
directive|else
error|#
directive|error
literal|"Unsupported LG_TINY_MIN"
endif|#
directive|endif
if|#
directive|if
name|LG_TINY_MIN
operator|<
literal|1
define|#
directive|define
name|S2B_1
parameter_list|(
name|i
parameter_list|)
value|S2B_0(i) S2B_0(i)
endif|#
directive|endif
if|#
directive|if
name|LG_TINY_MIN
operator|<
literal|2
define|#
directive|define
name|S2B_2
parameter_list|(
name|i
parameter_list|)
value|S2B_1(i) S2B_1(i)
endif|#
directive|endif
if|#
directive|if
name|LG_TINY_MIN
operator|<
literal|3
define|#
directive|define
name|S2B_3
parameter_list|(
name|i
parameter_list|)
value|S2B_2(i) S2B_2(i)
endif|#
directive|endif
if|#
directive|if
name|LG_TINY_MIN
operator|<
literal|4
define|#
directive|define
name|S2B_4
parameter_list|(
name|i
parameter_list|)
value|S2B_3(i) S2B_3(i)
endif|#
directive|endif
if|#
directive|if
name|LG_TINY_MIN
operator|<
literal|5
define|#
directive|define
name|S2B_5
parameter_list|(
name|i
parameter_list|)
value|S2B_4(i) S2B_4(i)
endif|#
directive|endif
if|#
directive|if
name|LG_TINY_MIN
operator|<
literal|6
define|#
directive|define
name|S2B_6
parameter_list|(
name|i
parameter_list|)
value|S2B_5(i) S2B_5(i)
endif|#
directive|endif
if|#
directive|if
name|LG_TINY_MIN
operator|<
literal|7
define|#
directive|define
name|S2B_7
parameter_list|(
name|i
parameter_list|)
value|S2B_6(i) S2B_6(i)
endif|#
directive|endif
if|#
directive|if
name|LG_TINY_MIN
operator|<
literal|8
define|#
directive|define
name|S2B_8
parameter_list|(
name|i
parameter_list|)
value|S2B_7(i) S2B_7(i)
endif|#
directive|endif
if|#
directive|if
name|LG_TINY_MIN
operator|<
literal|9
define|#
directive|define
name|S2B_9
parameter_list|(
name|i
parameter_list|)
value|S2B_8(i) S2B_8(i)
endif|#
directive|endif
if|#
directive|if
name|LG_TINY_MIN
operator|<
literal|10
define|#
directive|define
name|S2B_10
parameter_list|(
name|i
parameter_list|)
value|S2B_9(i) S2B_9(i)
endif|#
directive|endif
if|#
directive|if
name|LG_TINY_MIN
operator|<
literal|11
define|#
directive|define
name|S2B_11
parameter_list|(
name|i
parameter_list|)
value|S2B_10(i) S2B_10(i)
endif|#
directive|endif
define|#
directive|define
name|S2B_no
parameter_list|(
name|i
parameter_list|)
define|#
directive|define
name|SC
parameter_list|(
name|index
parameter_list|,
name|lg_grp
parameter_list|,
name|lg_delta
parameter_list|,
name|ndelta
parameter_list|,
name|psz
parameter_list|,
name|bin
parameter_list|,
name|pgs
parameter_list|,
name|lg_delta_lookup
parameter_list|)
define|\
value|S2B_##lg_delta_lookup(index)
name|SIZE_CLASSES
undef|#
directive|undef
name|S2B_3
undef|#
directive|undef
name|S2B_4
undef|#
directive|undef
name|S2B_5
undef|#
directive|undef
name|S2B_6
undef|#
directive|undef
name|S2B_7
undef|#
directive|undef
name|S2B_8
undef|#
directive|undef
name|S2B_9
undef|#
directive|undef
name|S2B_10
undef|#
directive|undef
name|S2B_11
undef|#
directive|undef
name|S2B_no
undef|#
directive|undef
name|SC
block|}
decl_stmt|;
end_decl_stmt

end_unit

