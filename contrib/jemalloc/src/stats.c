begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_define
define|#
directive|define
name|JEMALLOC_STATS_C_
end_define

begin_include
include|#
directive|include
file|"jemalloc/internal/jemalloc_internal.h"
end_include

begin_define
define|#
directive|define
name|CTL_GET
parameter_list|(
name|n
parameter_list|,
name|v
parameter_list|,
name|t
parameter_list|)
value|do {						\ 	size_t sz = sizeof(t);						\ 	xmallctl(n, v,&sz, NULL, 0);					\ } while (0)
end_define

begin_define
define|#
directive|define
name|CTL_I_GET
parameter_list|(
name|n
parameter_list|,
name|v
parameter_list|,
name|t
parameter_list|)
value|do {						\ 	size_t mib[6];							\ 	size_t miblen = sizeof(mib) / sizeof(size_t);			\ 	size_t sz = sizeof(t);						\ 	xmallctlnametomib(n, mib,&miblen);				\ 	mib[2] = i;							\ 	xmallctlbymib(mib, miblen, v,&sz, NULL, 0);			\ } while (0)
end_define

begin_define
define|#
directive|define
name|CTL_J_GET
parameter_list|(
name|n
parameter_list|,
name|v
parameter_list|,
name|t
parameter_list|)
value|do {						\ 	size_t mib[6];							\ 	size_t miblen = sizeof(mib) / sizeof(size_t);			\ 	size_t sz = sizeof(t);						\ 	xmallctlnametomib(n, mib,&miblen);				\ 	mib[2] = j;							\ 	xmallctlbymib(mib, miblen, v,&sz, NULL, 0);			\ } while (0)
end_define

begin_define
define|#
directive|define
name|CTL_IJ_GET
parameter_list|(
name|n
parameter_list|,
name|v
parameter_list|,
name|t
parameter_list|)
value|do {					\ 	size_t mib[6];							\ 	size_t miblen = sizeof(mib) / sizeof(size_t);			\ 	size_t sz = sizeof(t);						\ 	xmallctlnametomib(n, mib,&miblen);				\ 	mib[2] = i;							\ 	mib[4] = j;							\ 	xmallctlbymib(mib, miblen, v,&sz, NULL, 0);			\ } while (0)
end_define

begin_comment
comment|/******************************************************************************/
end_comment

begin_comment
comment|/* Data. */
end_comment

begin_decl_stmt
name|bool
name|opt_stats_print
init|=
name|false
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|size_t
name|stats_cactive
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_comment
comment|/******************************************************************************/
end_comment

begin_comment
comment|/* Function prototypes for non-inline static functions. */
end_comment

begin_function_decl
specifier|static
name|void
name|stats_arena_bins_print
parameter_list|(
name|void
function_decl|(
modifier|*
name|write_cb
function_decl|)
parameter_list|(
name|void
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|)
parameter_list|,
name|void
modifier|*
name|cbopaque
parameter_list|,
name|unsigned
name|i
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|stats_arena_lruns_print
parameter_list|(
name|void
function_decl|(
modifier|*
name|write_cb
function_decl|)
parameter_list|(
name|void
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|)
parameter_list|,
name|void
modifier|*
name|cbopaque
parameter_list|,
name|unsigned
name|i
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|stats_arena_print
parameter_list|(
name|void
function_decl|(
modifier|*
name|write_cb
function_decl|)
parameter_list|(
name|void
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|)
parameter_list|,
name|void
modifier|*
name|cbopaque
parameter_list|,
name|unsigned
name|i
parameter_list|,
name|bool
name|bins
parameter_list|,
name|bool
name|large
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/******************************************************************************/
end_comment

begin_function
specifier|static
name|void
name|stats_arena_bins_print
parameter_list|(
name|void
function_decl|(
modifier|*
name|write_cb
function_decl|)
parameter_list|(
name|void
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|)
parameter_list|,
name|void
modifier|*
name|cbopaque
parameter_list|,
name|unsigned
name|i
parameter_list|)
block|{
name|size_t
name|page
decl_stmt|;
name|bool
name|config_tcache
decl_stmt|;
name|unsigned
name|nbins
decl_stmt|,
name|j
decl_stmt|,
name|gap_start
decl_stmt|;
name|CTL_GET
argument_list|(
literal|"arenas.page"
argument_list|,
operator|&
name|page
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|CTL_GET
argument_list|(
literal|"config.tcache"
argument_list|,
operator|&
name|config_tcache
argument_list|,
name|bool
argument_list|)
expr_stmt|;
if|if
condition|(
name|config_tcache
condition|)
block|{
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"bins:     bin  size regs pgs    allocated      nmalloc"
literal|"      ndalloc    nrequests       nfills     nflushes"
literal|"      newruns       reruns      curruns\n"
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"bins:     bin  size regs pgs    allocated      nmalloc"
literal|"      ndalloc      newruns       reruns      curruns\n"
argument_list|)
expr_stmt|;
block|}
name|CTL_GET
argument_list|(
literal|"arenas.nbins"
argument_list|,
operator|&
name|nbins
argument_list|,
name|unsigned
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
operator|,
name|gap_start
operator|=
name|UINT_MAX
init|;
name|j
operator|<
name|nbins
condition|;
name|j
operator|++
control|)
block|{
name|uint64_t
name|nruns
decl_stmt|;
name|CTL_IJ_GET
argument_list|(
literal|"stats.arenas.0.bins.0.nruns"
argument_list|,
operator|&
name|nruns
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
if|if
condition|(
name|nruns
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|gap_start
operator|==
name|UINT_MAX
condition|)
name|gap_start
operator|=
name|j
expr_stmt|;
block|}
else|else
block|{
name|size_t
name|reg_size
decl_stmt|,
name|run_size
decl_stmt|,
name|allocated
decl_stmt|;
name|uint32_t
name|nregs
decl_stmt|;
name|uint64_t
name|nmalloc
decl_stmt|,
name|ndalloc
decl_stmt|,
name|nrequests
decl_stmt|,
name|nfills
decl_stmt|,
name|nflushes
decl_stmt|;
name|uint64_t
name|reruns
decl_stmt|;
name|size_t
name|curruns
decl_stmt|;
if|if
condition|(
name|gap_start
operator|!=
name|UINT_MAX
condition|)
block|{
if|if
condition|(
name|j
operator|>
name|gap_start
operator|+
literal|1
condition|)
block|{
comment|/* Gap of more than one size class. */
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"[%u..%u]\n"
argument_list|,
name|gap_start
argument_list|,
name|j
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|/* Gap of one size class. */
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"[%u]\n"
argument_list|,
name|gap_start
argument_list|)
expr_stmt|;
block|}
name|gap_start
operator|=
name|UINT_MAX
expr_stmt|;
block|}
name|CTL_J_GET
argument_list|(
literal|"arenas.bin.0.size"
argument_list|,
operator|&
name|reg_size
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|CTL_J_GET
argument_list|(
literal|"arenas.bin.0.nregs"
argument_list|,
operator|&
name|nregs
argument_list|,
name|uint32_t
argument_list|)
expr_stmt|;
name|CTL_J_GET
argument_list|(
literal|"arenas.bin.0.run_size"
argument_list|,
operator|&
name|run_size
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|CTL_IJ_GET
argument_list|(
literal|"stats.arenas.0.bins.0.allocated"
argument_list|,
operator|&
name|allocated
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|CTL_IJ_GET
argument_list|(
literal|"stats.arenas.0.bins.0.nmalloc"
argument_list|,
operator|&
name|nmalloc
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|CTL_IJ_GET
argument_list|(
literal|"stats.arenas.0.bins.0.ndalloc"
argument_list|,
operator|&
name|ndalloc
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
if|if
condition|(
name|config_tcache
condition|)
block|{
name|CTL_IJ_GET
argument_list|(
literal|"stats.arenas.0.bins.0.nrequests"
argument_list|,
operator|&
name|nrequests
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|CTL_IJ_GET
argument_list|(
literal|"stats.arenas.0.bins.0.nfills"
argument_list|,
operator|&
name|nfills
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|CTL_IJ_GET
argument_list|(
literal|"stats.arenas.0.bins.0.nflushes"
argument_list|,
operator|&
name|nflushes
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
block|}
name|CTL_IJ_GET
argument_list|(
literal|"stats.arenas.0.bins.0.nreruns"
argument_list|,
operator|&
name|reruns
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|CTL_IJ_GET
argument_list|(
literal|"stats.arenas.0.bins.0.curruns"
argument_list|,
operator|&
name|curruns
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
if|if
condition|(
name|config_tcache
condition|)
block|{
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"%13u %5zu %4u %3zu %12zu %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|" %12zu\n"
argument_list|,
name|j
argument_list|,
name|reg_size
argument_list|,
name|nregs
argument_list|,
name|run_size
operator|/
name|page
argument_list|,
name|allocated
argument_list|,
name|nmalloc
argument_list|,
name|ndalloc
argument_list|,
name|nrequests
argument_list|,
name|nfills
argument_list|,
name|nflushes
argument_list|,
name|nruns
argument_list|,
name|reruns
argument_list|,
name|curruns
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"%13u %5zu %4u %3zu %12zu %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|" %12zu\n"
argument_list|,
name|j
argument_list|,
name|reg_size
argument_list|,
name|nregs
argument_list|,
name|run_size
operator|/
name|page
argument_list|,
name|allocated
argument_list|,
name|nmalloc
argument_list|,
name|ndalloc
argument_list|,
name|nruns
argument_list|,
name|reruns
argument_list|,
name|curruns
argument_list|)
expr_stmt|;
block|}
block|}
block|}
if|if
condition|(
name|gap_start
operator|!=
name|UINT_MAX
condition|)
block|{
if|if
condition|(
name|j
operator|>
name|gap_start
operator|+
literal|1
condition|)
block|{
comment|/* Gap of more than one size class. */
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"[%u..%u]\n"
argument_list|,
name|gap_start
argument_list|,
name|j
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|/* Gap of one size class. */
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"[%u]\n"
argument_list|,
name|gap_start
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|stats_arena_lruns_print
parameter_list|(
name|void
function_decl|(
modifier|*
name|write_cb
function_decl|)
parameter_list|(
name|void
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|)
parameter_list|,
name|void
modifier|*
name|cbopaque
parameter_list|,
name|unsigned
name|i
parameter_list|)
block|{
name|size_t
name|page
decl_stmt|,
name|nlruns
decl_stmt|,
name|j
decl_stmt|;
name|ssize_t
name|gap_start
decl_stmt|;
name|CTL_GET
argument_list|(
literal|"arenas.page"
argument_list|,
operator|&
name|page
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"large:   size pages      nmalloc      ndalloc    nrequests"
literal|"      curruns\n"
argument_list|)
expr_stmt|;
name|CTL_GET
argument_list|(
literal|"arenas.nlruns"
argument_list|,
operator|&
name|nlruns
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
operator|,
name|gap_start
operator|=
operator|-
literal|1
init|;
name|j
operator|<
name|nlruns
condition|;
name|j
operator|++
control|)
block|{
name|uint64_t
name|nmalloc
decl_stmt|,
name|ndalloc
decl_stmt|,
name|nrequests
decl_stmt|;
name|size_t
name|run_size
decl_stmt|,
name|curruns
decl_stmt|;
name|CTL_IJ_GET
argument_list|(
literal|"stats.arenas.0.lruns.0.nmalloc"
argument_list|,
operator|&
name|nmalloc
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|CTL_IJ_GET
argument_list|(
literal|"stats.arenas.0.lruns.0.ndalloc"
argument_list|,
operator|&
name|ndalloc
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|CTL_IJ_GET
argument_list|(
literal|"stats.arenas.0.lruns.0.nrequests"
argument_list|,
operator|&
name|nrequests
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
if|if
condition|(
name|nrequests
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|gap_start
operator|==
operator|-
literal|1
condition|)
name|gap_start
operator|=
name|j
expr_stmt|;
block|}
else|else
block|{
name|CTL_J_GET
argument_list|(
literal|"arenas.lrun.0.size"
argument_list|,
operator|&
name|run_size
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|CTL_IJ_GET
argument_list|(
literal|"stats.arenas.0.lruns.0.curruns"
argument_list|,
operator|&
name|curruns
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
if|if
condition|(
name|gap_start
operator|!=
operator|-
literal|1
condition|)
block|{
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"[%zu]\n"
argument_list|,
name|j
operator|-
name|gap_start
argument_list|)
expr_stmt|;
name|gap_start
operator|=
operator|-
literal|1
expr_stmt|;
block|}
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"%13zu %5zu %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|" %12zu\n"
argument_list|,
name|run_size
argument_list|,
name|run_size
operator|/
name|page
argument_list|,
name|nmalloc
argument_list|,
name|ndalloc
argument_list|,
name|nrequests
argument_list|,
name|curruns
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|gap_start
operator|!=
operator|-
literal|1
condition|)
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"[%zu]\n"
argument_list|,
name|j
operator|-
name|gap_start
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|stats_arena_print
parameter_list|(
name|void
function_decl|(
modifier|*
name|write_cb
function_decl|)
parameter_list|(
name|void
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|)
parameter_list|,
name|void
modifier|*
name|cbopaque
parameter_list|,
name|unsigned
name|i
parameter_list|,
name|bool
name|bins
parameter_list|,
name|bool
name|large
parameter_list|)
block|{
name|unsigned
name|nthreads
decl_stmt|;
specifier|const
name|char
modifier|*
name|dss
decl_stmt|;
name|size_t
name|page
decl_stmt|,
name|pactive
decl_stmt|,
name|pdirty
decl_stmt|,
name|mapped
decl_stmt|;
name|uint64_t
name|npurge
decl_stmt|,
name|nmadvise
decl_stmt|,
name|purged
decl_stmt|;
name|size_t
name|small_allocated
decl_stmt|;
name|uint64_t
name|small_nmalloc
decl_stmt|,
name|small_ndalloc
decl_stmt|,
name|small_nrequests
decl_stmt|;
name|size_t
name|large_allocated
decl_stmt|;
name|uint64_t
name|large_nmalloc
decl_stmt|,
name|large_ndalloc
decl_stmt|,
name|large_nrequests
decl_stmt|;
name|CTL_GET
argument_list|(
literal|"arenas.page"
argument_list|,
operator|&
name|page
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|CTL_I_GET
argument_list|(
literal|"stats.arenas.0.nthreads"
argument_list|,
operator|&
name|nthreads
argument_list|,
name|unsigned
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"assigned threads: %u\n"
argument_list|,
name|nthreads
argument_list|)
expr_stmt|;
name|CTL_I_GET
argument_list|(
literal|"stats.arenas.0.dss"
argument_list|,
operator|&
name|dss
argument_list|,
specifier|const
name|char
operator|*
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"dss allocation precedence: %s\n"
argument_list|,
name|dss
argument_list|)
expr_stmt|;
name|CTL_I_GET
argument_list|(
literal|"stats.arenas.0.pactive"
argument_list|,
operator|&
name|pactive
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|CTL_I_GET
argument_list|(
literal|"stats.arenas.0.pdirty"
argument_list|,
operator|&
name|pdirty
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|CTL_I_GET
argument_list|(
literal|"stats.arenas.0.npurge"
argument_list|,
operator|&
name|npurge
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|CTL_I_GET
argument_list|(
literal|"stats.arenas.0.nmadvise"
argument_list|,
operator|&
name|nmadvise
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|CTL_I_GET
argument_list|(
literal|"stats.arenas.0.purged"
argument_list|,
operator|&
name|purged
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"dirty pages: %zu:%zu active:dirty, %"
name|PRIu64
literal|" sweep%s,"
literal|" %"
name|PRIu64
literal|" madvise%s, %"
name|PRIu64
literal|" purged\n"
argument_list|,
name|pactive
argument_list|,
name|pdirty
argument_list|,
name|npurge
argument_list|,
name|npurge
operator|==
literal|1
condition|?
literal|""
else|:
literal|"s"
argument_list|,
name|nmadvise
argument_list|,
name|nmadvise
operator|==
literal|1
condition|?
literal|""
else|:
literal|"s"
argument_list|,
name|purged
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"            allocated      nmalloc      ndalloc    nrequests\n"
argument_list|)
expr_stmt|;
name|CTL_I_GET
argument_list|(
literal|"stats.arenas.0.small.allocated"
argument_list|,
operator|&
name|small_allocated
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|CTL_I_GET
argument_list|(
literal|"stats.arenas.0.small.nmalloc"
argument_list|,
operator|&
name|small_nmalloc
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|CTL_I_GET
argument_list|(
literal|"stats.arenas.0.small.ndalloc"
argument_list|,
operator|&
name|small_ndalloc
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|CTL_I_GET
argument_list|(
literal|"stats.arenas.0.small.nrequests"
argument_list|,
operator|&
name|small_nrequests
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"small:   %12zu %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|"\n"
argument_list|,
name|small_allocated
argument_list|,
name|small_nmalloc
argument_list|,
name|small_ndalloc
argument_list|,
name|small_nrequests
argument_list|)
expr_stmt|;
name|CTL_I_GET
argument_list|(
literal|"stats.arenas.0.large.allocated"
argument_list|,
operator|&
name|large_allocated
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|CTL_I_GET
argument_list|(
literal|"stats.arenas.0.large.nmalloc"
argument_list|,
operator|&
name|large_nmalloc
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|CTL_I_GET
argument_list|(
literal|"stats.arenas.0.large.ndalloc"
argument_list|,
operator|&
name|large_ndalloc
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|CTL_I_GET
argument_list|(
literal|"stats.arenas.0.large.nrequests"
argument_list|,
operator|&
name|large_nrequests
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"large:   %12zu %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|"\n"
argument_list|,
name|large_allocated
argument_list|,
name|large_nmalloc
argument_list|,
name|large_ndalloc
argument_list|,
name|large_nrequests
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"total:   %12zu %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|"\n"
argument_list|,
name|small_allocated
operator|+
name|large_allocated
argument_list|,
name|small_nmalloc
operator|+
name|large_nmalloc
argument_list|,
name|small_ndalloc
operator|+
name|large_ndalloc
argument_list|,
name|small_nrequests
operator|+
name|large_nrequests
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"active:  %12zu\n"
argument_list|,
name|pactive
operator|*
name|page
argument_list|)
expr_stmt|;
name|CTL_I_GET
argument_list|(
literal|"stats.arenas.0.mapped"
argument_list|,
operator|&
name|mapped
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"mapped:  %12zu\n"
argument_list|,
name|mapped
argument_list|)
expr_stmt|;
if|if
condition|(
name|bins
condition|)
name|stats_arena_bins_print
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
name|i
argument_list|)
expr_stmt|;
if|if
condition|(
name|large
condition|)
name|stats_arena_lruns_print
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
name|i
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|stats_print
parameter_list|(
name|void
function_decl|(
modifier|*
name|write_cb
function_decl|)
parameter_list|(
name|void
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|)
parameter_list|,
name|void
modifier|*
name|cbopaque
parameter_list|,
specifier|const
name|char
modifier|*
name|opts
parameter_list|)
block|{
name|int
name|err
decl_stmt|;
name|uint64_t
name|epoch
decl_stmt|;
name|size_t
name|u64sz
decl_stmt|;
name|bool
name|general
init|=
name|true
decl_stmt|;
name|bool
name|merged
init|=
name|true
decl_stmt|;
name|bool
name|unmerged
init|=
name|true
decl_stmt|;
name|bool
name|bins
init|=
name|true
decl_stmt|;
name|bool
name|large
init|=
name|true
decl_stmt|;
comment|/* 	 * Refresh stats, in case mallctl() was called by the application. 	 * 	 * Check for OOM here, since refreshing the ctl cache can trigger 	 * allocation.  In practice, none of the subsequent mallctl()-related 	 * calls in this function will cause OOM if this one succeeds. 	 * */
name|epoch
operator|=
literal|1
expr_stmt|;
name|u64sz
operator|=
sizeof|sizeof
argument_list|(
name|uint64_t
argument_list|)
expr_stmt|;
name|err
operator|=
name|je_mallctl
argument_list|(
literal|"epoch"
argument_list|,
operator|&
name|epoch
argument_list|,
operator|&
name|u64sz
argument_list|,
operator|&
name|epoch
argument_list|,
sizeof|sizeof
argument_list|(
name|uint64_t
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|err
operator|!=
literal|0
condition|)
block|{
if|if
condition|(
name|err
operator|==
name|EAGAIN
condition|)
block|{
name|malloc_write
argument_list|(
literal|"<jemalloc>: Memory allocation failure in "
literal|"mallctl(\"epoch\", ...)\n"
argument_list|)
expr_stmt|;
return|return;
block|}
name|malloc_write
argument_list|(
literal|"<jemalloc>: Failure in mallctl(\"epoch\", "
literal|"...)\n"
argument_list|)
expr_stmt|;
name|abort
argument_list|()
expr_stmt|;
block|}
if|if
condition|(
name|opts
operator|!=
name|NULL
condition|)
block|{
name|unsigned
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|opts
index|[
name|i
index|]
operator|!=
literal|'\0'
condition|;
name|i
operator|++
control|)
block|{
switch|switch
condition|(
name|opts
index|[
name|i
index|]
condition|)
block|{
case|case
literal|'g'
case|:
name|general
operator|=
name|false
expr_stmt|;
break|break;
case|case
literal|'m'
case|:
name|merged
operator|=
name|false
expr_stmt|;
break|break;
case|case
literal|'a'
case|:
name|unmerged
operator|=
name|false
expr_stmt|;
break|break;
case|case
literal|'b'
case|:
name|bins
operator|=
name|false
expr_stmt|;
break|break;
case|case
literal|'l'
case|:
name|large
operator|=
name|false
expr_stmt|;
break|break;
default|default:
empty_stmt|;
block|}
block|}
block|}
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"___ Begin jemalloc statistics ___\n"
argument_list|)
expr_stmt|;
if|if
condition|(
name|general
condition|)
block|{
name|int
name|err
decl_stmt|;
specifier|const
name|char
modifier|*
name|cpv
decl_stmt|;
name|bool
name|bv
decl_stmt|;
name|unsigned
name|uv
decl_stmt|;
name|ssize_t
name|ssv
decl_stmt|;
name|size_t
name|sv
decl_stmt|,
name|bsz
decl_stmt|,
name|ssz
decl_stmt|,
name|sssz
decl_stmt|,
name|cpsz
decl_stmt|;
name|bsz
operator|=
sizeof|sizeof
argument_list|(
name|bool
argument_list|)
expr_stmt|;
name|ssz
operator|=
sizeof|sizeof
argument_list|(
name|size_t
argument_list|)
expr_stmt|;
name|sssz
operator|=
sizeof|sizeof
argument_list|(
name|ssize_t
argument_list|)
expr_stmt|;
name|cpsz
operator|=
sizeof|sizeof
argument_list|(
specifier|const
name|char
operator|*
argument_list|)
expr_stmt|;
name|CTL_GET
argument_list|(
literal|"version"
argument_list|,
operator|&
name|cpv
argument_list|,
specifier|const
name|char
operator|*
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"Version: %s\n"
argument_list|,
name|cpv
argument_list|)
expr_stmt|;
name|CTL_GET
argument_list|(
literal|"config.debug"
argument_list|,
operator|&
name|bv
argument_list|,
name|bool
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"Assertions %s\n"
argument_list|,
name|bv
condition|?
literal|"enabled"
else|:
literal|"disabled"
argument_list|)
expr_stmt|;
define|#
directive|define
name|OPT_WRITE_BOOL
parameter_list|(
name|n
parameter_list|)
define|\
value|if ((err = je_mallctl("opt."#n,&bv,&bsz, NULL, 0))	\ 		    == 0) {						\ 			malloc_cprintf(write_cb, cbopaque,		\ 			    "  opt."#n": %s\n", bv ? "true" : "false");	\ 		}
define|#
directive|define
name|OPT_WRITE_SIZE_T
parameter_list|(
name|n
parameter_list|)
define|\
value|if ((err = je_mallctl("opt."#n,&sv,&ssz, NULL, 0))	\ 		    == 0) {						\ 			malloc_cprintf(write_cb, cbopaque,		\ 			"  opt."#n": %zu\n", sv);			\ 		}
define|#
directive|define
name|OPT_WRITE_SSIZE_T
parameter_list|(
name|n
parameter_list|)
define|\
value|if ((err = je_mallctl("opt."#n,&ssv,&sssz, NULL, 0))	\ 		    == 0) {						\ 			malloc_cprintf(write_cb, cbopaque,		\ 			    "  opt."#n": %zd\n", ssv);			\ 		}
define|#
directive|define
name|OPT_WRITE_CHAR_P
parameter_list|(
name|n
parameter_list|)
define|\
value|if ((err = je_mallctl("opt."#n,&cpv,&cpsz, NULL, 0))	\ 		    == 0) {						\ 			malloc_cprintf(write_cb, cbopaque,		\ 			    "  opt."#n": \"%s\"\n", cpv);		\ 		}
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"Run-time option settings:\n"
argument_list|)
expr_stmt|;
name|OPT_WRITE_BOOL
argument_list|(
argument|abort
argument_list|)
name|OPT_WRITE_SIZE_T
argument_list|(
argument|lg_chunk
argument_list|)
name|OPT_WRITE_CHAR_P
argument_list|(
argument|dss
argument_list|)
name|OPT_WRITE_SIZE_T
argument_list|(
argument|narenas
argument_list|)
name|OPT_WRITE_SSIZE_T
argument_list|(
argument|lg_dirty_mult
argument_list|)
name|OPT_WRITE_BOOL
argument_list|(
argument|stats_print
argument_list|)
name|OPT_WRITE_BOOL
argument_list|(
argument|junk
argument_list|)
name|OPT_WRITE_SIZE_T
argument_list|(
argument|quarantine
argument_list|)
name|OPT_WRITE_BOOL
argument_list|(
argument|redzone
argument_list|)
name|OPT_WRITE_BOOL
argument_list|(
argument|zero
argument_list|)
name|OPT_WRITE_BOOL
argument_list|(
argument|utrace
argument_list|)
name|OPT_WRITE_BOOL
argument_list|(
argument|valgrind
argument_list|)
name|OPT_WRITE_BOOL
argument_list|(
argument|xmalloc
argument_list|)
name|OPT_WRITE_BOOL
argument_list|(
argument|tcache
argument_list|)
name|OPT_WRITE_SSIZE_T
argument_list|(
argument|lg_tcache_max
argument_list|)
name|OPT_WRITE_BOOL
argument_list|(
argument|prof
argument_list|)
name|OPT_WRITE_CHAR_P
argument_list|(
argument|prof_prefix
argument_list|)
name|OPT_WRITE_BOOL
argument_list|(
argument|prof_active
argument_list|)
name|OPT_WRITE_SSIZE_T
argument_list|(
argument|lg_prof_sample
argument_list|)
name|OPT_WRITE_BOOL
argument_list|(
argument|prof_accum
argument_list|)
name|OPT_WRITE_SSIZE_T
argument_list|(
argument|lg_prof_interval
argument_list|)
name|OPT_WRITE_BOOL
argument_list|(
argument|prof_gdump
argument_list|)
name|OPT_WRITE_BOOL
argument_list|(
argument|prof_final
argument_list|)
name|OPT_WRITE_BOOL
argument_list|(
argument|prof_leak
argument_list|)
undef|#
directive|undef
name|OPT_WRITE_BOOL
undef|#
directive|undef
name|OPT_WRITE_SIZE_T
undef|#
directive|undef
name|OPT_WRITE_SSIZE_T
undef|#
directive|undef
name|OPT_WRITE_CHAR_P
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"CPUs: %u\n"
argument_list|,
name|ncpus
argument_list|)
expr_stmt|;
name|CTL_GET
argument_list|(
literal|"arenas.narenas"
argument_list|,
operator|&
name|uv
argument_list|,
name|unsigned
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"Arenas: %u\n"
argument_list|,
name|uv
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"Pointer size: %zu\n"
argument_list|,
sizeof|sizeof
argument_list|(
name|void
operator|*
argument_list|)
argument_list|)
expr_stmt|;
name|CTL_GET
argument_list|(
literal|"arenas.quantum"
argument_list|,
operator|&
name|sv
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"Quantum size: %zu\n"
argument_list|,
name|sv
argument_list|)
expr_stmt|;
name|CTL_GET
argument_list|(
literal|"arenas.page"
argument_list|,
operator|&
name|sv
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"Page size: %zu\n"
argument_list|,
name|sv
argument_list|)
expr_stmt|;
name|CTL_GET
argument_list|(
literal|"opt.lg_dirty_mult"
argument_list|,
operator|&
name|ssv
argument_list|,
name|ssize_t
argument_list|)
expr_stmt|;
if|if
condition|(
name|ssv
operator|>=
literal|0
condition|)
block|{
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"Min active:dirty page ratio per arena: %u:1\n"
argument_list|,
operator|(
literal|1U
operator|<<
name|ssv
operator|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"Min active:dirty page ratio per arena: N/A\n"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|err
operator|=
name|je_mallctl
argument_list|(
literal|"arenas.tcache_max"
argument_list|,
operator|&
name|sv
argument_list|,
operator|&
name|ssz
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|)
operator|)
operator|==
literal|0
condition|)
block|{
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"Maximum thread-cached size class: %zu\n"
argument_list|,
name|sv
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|err
operator|=
name|je_mallctl
argument_list|(
literal|"opt.prof"
argument_list|,
operator|&
name|bv
argument_list|,
operator|&
name|bsz
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|)
operator|)
operator|==
literal|0
operator|&&
name|bv
condition|)
block|{
name|CTL_GET
argument_list|(
literal|"opt.lg_prof_sample"
argument_list|,
operator|&
name|sv
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"Average profile sample interval: %"
name|PRIu64
literal|" (2^%zu)\n"
argument_list|,
operator|(
operator|(
operator|(
name|uint64_t
operator|)
literal|1U
operator|)
operator|<<
name|sv
operator|)
argument_list|,
name|sv
argument_list|)
expr_stmt|;
name|CTL_GET
argument_list|(
literal|"opt.lg_prof_interval"
argument_list|,
operator|&
name|ssv
argument_list|,
name|ssize_t
argument_list|)
expr_stmt|;
if|if
condition|(
name|ssv
operator|>=
literal|0
condition|)
block|{
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"Average profile dump interval: %"
name|PRIu64
literal|" (2^%zd)\n"
argument_list|,
operator|(
operator|(
operator|(
name|uint64_t
operator|)
literal|1U
operator|)
operator|<<
name|ssv
operator|)
argument_list|,
name|ssv
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"Average profile dump interval: N/A\n"
argument_list|)
expr_stmt|;
block|}
block|}
name|CTL_GET
argument_list|(
literal|"opt.lg_chunk"
argument_list|,
operator|&
name|sv
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"Chunk size: %zu (2^%zu)\n"
argument_list|,
operator|(
name|ZU
argument_list|(
literal|1
argument_list|)
operator|<<
name|sv
operator|)
argument_list|,
name|sv
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|config_stats
condition|)
block|{
name|size_t
modifier|*
name|cactive
decl_stmt|;
name|size_t
name|allocated
decl_stmt|,
name|active
decl_stmt|,
name|mapped
decl_stmt|;
name|size_t
name|chunks_current
decl_stmt|,
name|chunks_high
decl_stmt|;
name|uint64_t
name|chunks_total
decl_stmt|;
name|size_t
name|huge_allocated
decl_stmt|;
name|uint64_t
name|huge_nmalloc
decl_stmt|,
name|huge_ndalloc
decl_stmt|;
name|CTL_GET
argument_list|(
literal|"stats.cactive"
argument_list|,
operator|&
name|cactive
argument_list|,
name|size_t
operator|*
argument_list|)
expr_stmt|;
name|CTL_GET
argument_list|(
literal|"stats.allocated"
argument_list|,
operator|&
name|allocated
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|CTL_GET
argument_list|(
literal|"stats.active"
argument_list|,
operator|&
name|active
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|CTL_GET
argument_list|(
literal|"stats.mapped"
argument_list|,
operator|&
name|mapped
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"Allocated: %zu, active: %zu, mapped: %zu\n"
argument_list|,
name|allocated
argument_list|,
name|active
argument_list|,
name|mapped
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"Current active ceiling: %zu\n"
argument_list|,
name|atomic_read_z
argument_list|(
name|cactive
argument_list|)
argument_list|)
expr_stmt|;
comment|/* Print chunk stats. */
name|CTL_GET
argument_list|(
literal|"stats.chunks.total"
argument_list|,
operator|&
name|chunks_total
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|CTL_GET
argument_list|(
literal|"stats.chunks.high"
argument_list|,
operator|&
name|chunks_high
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|CTL_GET
argument_list|(
literal|"stats.chunks.current"
argument_list|,
operator|&
name|chunks_current
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"chunks: nchunks   "
literal|"highchunks    curchunks\n"
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"  %13"
name|PRIu64
literal|" %12zu %12zu\n"
argument_list|,
name|chunks_total
argument_list|,
name|chunks_high
argument_list|,
name|chunks_current
argument_list|)
expr_stmt|;
comment|/* Print huge stats. */
name|CTL_GET
argument_list|(
literal|"stats.huge.nmalloc"
argument_list|,
operator|&
name|huge_nmalloc
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|CTL_GET
argument_list|(
literal|"stats.huge.ndalloc"
argument_list|,
operator|&
name|huge_ndalloc
argument_list|,
name|uint64_t
argument_list|)
expr_stmt|;
name|CTL_GET
argument_list|(
literal|"stats.huge.allocated"
argument_list|,
operator|&
name|huge_allocated
argument_list|,
name|size_t
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"huge: nmalloc      ndalloc    allocated\n"
argument_list|)
expr_stmt|;
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|" %12"
name|PRIu64
literal|" %12"
name|PRIu64
literal|" %12zu\n"
argument_list|,
name|huge_nmalloc
argument_list|,
name|huge_ndalloc
argument_list|,
name|huge_allocated
argument_list|)
expr_stmt|;
if|if
condition|(
name|merged
condition|)
block|{
name|unsigned
name|narenas
decl_stmt|;
name|CTL_GET
argument_list|(
literal|"arenas.narenas"
argument_list|,
operator|&
name|narenas
argument_list|,
name|unsigned
argument_list|)
expr_stmt|;
block|{
name|VARIABLE_ARRAY
argument_list|(
name|bool
argument_list|,
name|initialized
argument_list|,
name|narenas
argument_list|)
expr_stmt|;
name|size_t
name|isz
decl_stmt|;
name|unsigned
name|i
decl_stmt|,
name|ninitialized
decl_stmt|;
name|isz
operator|=
sizeof|sizeof
argument_list|(
name|bool
argument_list|)
operator|*
name|narenas
expr_stmt|;
name|xmallctl
argument_list|(
literal|"arenas.initialized"
argument_list|,
name|initialized
argument_list|,
operator|&
name|isz
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
name|ninitialized
operator|=
literal|0
init|;
name|i
operator|<
name|narenas
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|initialized
index|[
name|i
index|]
condition|)
name|ninitialized
operator|++
expr_stmt|;
block|}
if|if
condition|(
name|ninitialized
operator|>
literal|1
operator|||
name|unmerged
operator|==
name|false
condition|)
block|{
comment|/* Print merged arena stats. */
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"\nMerged arenas stats:\n"
argument_list|)
expr_stmt|;
name|stats_arena_print
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
name|narenas
argument_list|,
name|bins
argument_list|,
name|large
argument_list|)
expr_stmt|;
block|}
block|}
block|}
if|if
condition|(
name|unmerged
condition|)
block|{
name|unsigned
name|narenas
decl_stmt|;
comment|/* Print stats for each arena. */
name|CTL_GET
argument_list|(
literal|"arenas.narenas"
argument_list|,
operator|&
name|narenas
argument_list|,
name|unsigned
argument_list|)
expr_stmt|;
block|{
name|VARIABLE_ARRAY
argument_list|(
name|bool
argument_list|,
name|initialized
argument_list|,
name|narenas
argument_list|)
expr_stmt|;
name|size_t
name|isz
decl_stmt|;
name|unsigned
name|i
decl_stmt|;
name|isz
operator|=
sizeof|sizeof
argument_list|(
name|bool
argument_list|)
operator|*
name|narenas
expr_stmt|;
name|xmallctl
argument_list|(
literal|"arenas.initialized"
argument_list|,
name|initialized
argument_list|,
operator|&
name|isz
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|narenas
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|initialized
index|[
name|i
index|]
condition|)
block|{
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"\narenas[%u]:\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|stats_arena_print
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
name|i
argument_list|,
name|bins
argument_list|,
name|large
argument_list|)
expr_stmt|;
block|}
block|}
block|}
block|}
block|}
name|malloc_cprintf
argument_list|(
name|write_cb
argument_list|,
name|cbopaque
argument_list|,
literal|"--- End jemalloc statistics ---\n"
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

