begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_include
include|#
directive|include
file|<yaml.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_function
name|int
name|main
parameter_list|(
name|int
name|argc
parameter_list|,
name|char
modifier|*
name|argv
index|[]
parameter_list|)
block|{
name|int
name|help
init|=
literal|0
decl_stmt|;
name|int
name|canonical
init|=
literal|0
decl_stmt|;
name|int
name|unicode
init|=
literal|0
decl_stmt|;
name|int
name|k
decl_stmt|;
name|int
name|done
init|=
literal|0
decl_stmt|;
name|yaml_parser_t
name|parser
decl_stmt|;
name|yaml_emitter_t
name|emitter
decl_stmt|;
name|yaml_event_t
name|input_event
decl_stmt|;
name|yaml_document_t
name|output_document
decl_stmt|;
name|int
name|root
decl_stmt|;
comment|/* Clear the objects. */
name|memset
argument_list|(
operator|&
name|parser
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|parser
argument_list|)
argument_list|)
expr_stmt|;
name|memset
argument_list|(
operator|&
name|emitter
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|emitter
argument_list|)
argument_list|)
expr_stmt|;
name|memset
argument_list|(
operator|&
name|input_event
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|input_event
argument_list|)
argument_list|)
expr_stmt|;
name|memset
argument_list|(
operator|&
name|output_document
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|output_document
argument_list|)
argument_list|)
expr_stmt|;
comment|/* Analyze command line options. */
for|for
control|(
name|k
operator|=
literal|1
init|;
name|k
operator|<
name|argc
condition|;
name|k
operator|++
control|)
block|{
if|if
condition|(
name|strcmp
argument_list|(
name|argv
index|[
name|k
index|]
argument_list|,
literal|"-h"
argument_list|)
operator|==
literal|0
operator|||
name|strcmp
argument_list|(
name|argv
index|[
name|k
index|]
argument_list|,
literal|"--help"
argument_list|)
operator|==
literal|0
condition|)
block|{
name|help
operator|=
literal|1
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
name|argv
index|[
name|k
index|]
argument_list|,
literal|"-c"
argument_list|)
operator|==
literal|0
operator|||
name|strcmp
argument_list|(
name|argv
index|[
name|k
index|]
argument_list|,
literal|"--canonical"
argument_list|)
operator|==
literal|0
condition|)
block|{
name|canonical
operator|=
literal|1
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
name|argv
index|[
name|k
index|]
argument_list|,
literal|"-u"
argument_list|)
operator|==
literal|0
operator|||
name|strcmp
argument_list|(
name|argv
index|[
name|k
index|]
argument_list|,
literal|"--unicode"
argument_list|)
operator|==
literal|0
condition|)
block|{
name|unicode
operator|=
literal|1
expr_stmt|;
block|}
else|else
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Unrecognized option: %s\n"
literal|"Try `%s --help` for more information.\n"
argument_list|,
name|argv
index|[
name|k
index|]
argument_list|,
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
return|return
literal|1
return|;
block|}
block|}
comment|/* Display the help string. */
if|if
condition|(
name|help
condition|)
block|{
name|printf
argument_list|(
literal|"%s<input\n"
literal|"or\n%s -h | --help\nDeconstruct a YAML stream\n\nOptions:\n"
literal|"-h, --help\t\tdisplay this help and exit\n"
literal|"-c, --canonical\t\toutput in the canonical YAML format\n"
literal|"-u, --unicode\t\toutput unescaped non-ASCII characters\n"
argument_list|,
name|argv
index|[
literal|0
index|]
argument_list|,
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
comment|/* Initialize the parser and emitter objects. */
if|if
condition|(
operator|!
name|yaml_parser_initialize
argument_list|(
operator|&
name|parser
argument_list|)
condition|)
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Could not initialize the parser object\n"
argument_list|)
expr_stmt|;
return|return
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|yaml_emitter_initialize
argument_list|(
operator|&
name|emitter
argument_list|)
condition|)
block|{
name|yaml_parser_delete
argument_list|(
operator|&
name|parser
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Could not inialize the emitter object\n"
argument_list|)
expr_stmt|;
return|return
literal|1
return|;
block|}
comment|/* Set the parser parameters. */
name|yaml_parser_set_input_file
argument_list|(
operator|&
name|parser
argument_list|,
name|stdin
argument_list|)
expr_stmt|;
comment|/* Set the emitter parameters. */
name|yaml_emitter_set_output_file
argument_list|(
operator|&
name|emitter
argument_list|,
name|stdout
argument_list|)
expr_stmt|;
name|yaml_emitter_set_canonical
argument_list|(
operator|&
name|emitter
argument_list|,
name|canonical
argument_list|)
expr_stmt|;
name|yaml_emitter_set_unicode
argument_list|(
operator|&
name|emitter
argument_list|,
name|unicode
argument_list|)
expr_stmt|;
comment|/* Create and emit the STREAM-START event. */
if|if
condition|(
operator|!
name|yaml_emitter_open
argument_list|(
operator|&
name|emitter
argument_list|)
condition|)
goto|goto
name|emitter_error
goto|;
comment|/* Create a output_document object. */
if|if
condition|(
operator|!
name|yaml_document_initialize
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Create the root sequence. */
name|root
operator|=
name|yaml_document_add_sequence
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
name|YAML_BLOCK_SEQUENCE_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|root
condition|)
goto|goto
name|document_error
goto|;
comment|/* Loop through the input events. */
while|while
condition|(
operator|!
name|done
condition|)
block|{
name|int
name|properties
decl_stmt|,
name|key
decl_stmt|,
name|value
decl_stmt|,
name|map
decl_stmt|,
name|seq
decl_stmt|;
comment|/* Get the next event. */
if|if
condition|(
operator|!
name|yaml_parser_parse
argument_list|(
operator|&
name|parser
argument_list|,
operator|&
name|input_event
argument_list|)
condition|)
goto|goto
name|parser_error
goto|;
comment|/* Check if this is the stream end. */
if|if
condition|(
name|input_event
operator|.
name|type
operator|==
name|YAML_STREAM_END_EVENT
condition|)
block|{
name|done
operator|=
literal|1
expr_stmt|;
block|}
comment|/* Create a mapping node and attach it to the root sequence. */
name|properties
operator|=
name|yaml_document_add_mapping
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
name|YAML_BLOCK_MAPPING_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|properties
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_sequence_item
argument_list|(
operator|&
name|output_document
argument_list|,
name|root
argument_list|,
name|properties
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Analyze the event. */
switch|switch
condition|(
name|input_event
operator|.
name|type
condition|)
block|{
case|case
name|YAML_STREAM_START_EVENT
case|:
comment|/* Add 'type': 'STREAM-START'. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"type"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"STREAM-START"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Add 'encoding':<encoding>. */
if|if
condition|(
name|input_event
operator|.
name|data
operator|.
name|stream_start
operator|.
name|encoding
condition|)
block|{
name|yaml_encoding_t
name|encoding
init|=
name|input_event
operator|.
name|data
operator|.
name|stream_start
operator|.
name|encoding
decl_stmt|;
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"encoding"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
operator|(
name|encoding
operator|==
name|YAML_UTF8_ENCODING
condition|?
literal|"utf-8"
else|:
name|encoding
operator|==
name|YAML_UTF16LE_ENCODING
condition|?
literal|"utf-16-le"
else|:
name|encoding
operator|==
name|YAML_UTF16BE_ENCODING
condition|?
literal|"utf-16-be"
else|:
literal|"unknown"
operator|)
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
block|}
break|break;
case|case
name|YAML_STREAM_END_EVENT
case|:
comment|/* Add 'type': 'STREAM-END'. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"type"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"STREAM-END"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
break|break;
case|case
name|YAML_DOCUMENT_START_EVENT
case|:
comment|/* Add 'type': 'DOCUMENT-START'. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"type"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"DOCUMENT-START"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Display the output_document version numbers. */
if|if
condition|(
name|input_event
operator|.
name|data
operator|.
name|document_start
operator|.
name|version_directive
condition|)
block|{
name|yaml_version_directive_t
modifier|*
name|version
init|=
name|input_event
operator|.
name|data
operator|.
name|document_start
operator|.
name|version_directive
decl_stmt|;
name|char
name|number
index|[
literal|64
index|]
decl_stmt|;
comment|/* Add 'version': {}. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"version"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|map
operator|=
name|yaml_document_add_mapping
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
name|YAML_FLOW_MAPPING_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|map
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|map
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Add 'major':<number>. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"major"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|sprintf
argument_list|(
name|number
argument_list|,
literal|"%d"
argument_list|,
name|version
operator|->
name|major
argument_list|)
expr_stmt|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|YAML_INT_TAG
argument_list|,
name|number
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|map
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Add 'minor':<number>. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"minor"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|sprintf
argument_list|(
name|number
argument_list|,
literal|"%d"
argument_list|,
name|version
operator|->
name|minor
argument_list|)
expr_stmt|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|YAML_INT_TAG
argument_list|,
name|number
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|map
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
block|}
comment|/* Display the output_document tag directives. */
if|if
condition|(
name|input_event
operator|.
name|data
operator|.
name|document_start
operator|.
name|tag_directives
operator|.
name|start
operator|!=
name|input_event
operator|.
name|data
operator|.
name|document_start
operator|.
name|tag_directives
operator|.
name|end
condition|)
block|{
name|yaml_tag_directive_t
modifier|*
name|tag
decl_stmt|;
comment|/* Add 'tags': []. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"tags"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|seq
operator|=
name|yaml_document_add_sequence
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
name|YAML_BLOCK_SEQUENCE_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|seq
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|seq
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
for|for
control|(
name|tag
operator|=
name|input_event
operator|.
name|data
operator|.
name|document_start
operator|.
name|tag_directives
operator|.
name|start
init|;
name|tag
operator|!=
name|input_event
operator|.
name|data
operator|.
name|document_start
operator|.
name|tag_directives
operator|.
name|end
condition|;
name|tag
operator|++
control|)
block|{
comment|/* Add {}. */
name|map
operator|=
name|yaml_document_add_mapping
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
name|YAML_FLOW_MAPPING_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|map
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_sequence_item
argument_list|(
operator|&
name|output_document
argument_list|,
name|seq
argument_list|,
name|map
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Add 'handle':<handle>. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"handle"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
name|tag
operator|->
name|handle
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_DOUBLE_QUOTED_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|map
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Add 'prefix':<prefix>. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"prefix"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
name|tag
operator|->
name|prefix
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_DOUBLE_QUOTED_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|map
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
block|}
block|}
comment|/* Add 'implicit':<flag>. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"implicit"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|YAML_BOOL_TAG
argument_list|,
operator|(
name|input_event
operator|.
name|data
operator|.
name|document_start
operator|.
name|implicit
condition|?
literal|"true"
else|:
literal|"false"
operator|)
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
break|break;
case|case
name|YAML_DOCUMENT_END_EVENT
case|:
comment|/* Add 'type': 'DOCUMENT-END'. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"type"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"DOCUMENT-END"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Add 'implicit':<flag>. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"implicit"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|YAML_BOOL_TAG
argument_list|,
operator|(
name|input_event
operator|.
name|data
operator|.
name|document_end
operator|.
name|implicit
condition|?
literal|"true"
else|:
literal|"false"
operator|)
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
break|break;
case|case
name|YAML_ALIAS_EVENT
case|:
comment|/* Add 'type': 'ALIAS'. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"type"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"ALIAS"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Add 'anchor':<anchor>. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"anchor"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
name|input_event
operator|.
name|data
operator|.
name|alias
operator|.
name|anchor
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_DOUBLE_QUOTED_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
break|break;
case|case
name|YAML_SCALAR_EVENT
case|:
comment|/* Add 'type': 'SCALAR'. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"type"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"SCALAR"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Add 'anchor':<anchor>. */
if|if
condition|(
name|input_event
operator|.
name|data
operator|.
name|scalar
operator|.
name|anchor
condition|)
block|{
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"anchor"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
name|input_event
operator|.
name|data
operator|.
name|scalar
operator|.
name|anchor
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_DOUBLE_QUOTED_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
block|}
comment|/* Add 'tag':<tag>. */
if|if
condition|(
name|input_event
operator|.
name|data
operator|.
name|scalar
operator|.
name|tag
condition|)
block|{
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"tag"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
name|input_event
operator|.
name|data
operator|.
name|scalar
operator|.
name|tag
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_DOUBLE_QUOTED_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
block|}
comment|/* Add 'value':<value>. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"value"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
name|input_event
operator|.
name|data
operator|.
name|scalar
operator|.
name|value
argument_list|,
name|input_event
operator|.
name|data
operator|.
name|scalar
operator|.
name|length
argument_list|,
name|YAML_DOUBLE_QUOTED_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Display if the scalar tag is implicit. */
comment|/* Add 'implicit': {} */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"version"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|map
operator|=
name|yaml_document_add_mapping
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
name|YAML_FLOW_MAPPING_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|map
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|map
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Add 'plain':<flag>. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"plain"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|YAML_BOOL_TAG
argument_list|,
operator|(
name|input_event
operator|.
name|data
operator|.
name|scalar
operator|.
name|plain_implicit
condition|?
literal|"true"
else|:
literal|"false"
operator|)
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|map
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Add 'quoted':<flag>. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"quoted"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|YAML_BOOL_TAG
argument_list|,
operator|(
name|input_event
operator|.
name|data
operator|.
name|scalar
operator|.
name|quoted_implicit
condition|?
literal|"true"
else|:
literal|"false"
operator|)
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|map
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Display the style information. */
if|if
condition|(
name|input_event
operator|.
name|data
operator|.
name|scalar
operator|.
name|style
condition|)
block|{
name|yaml_scalar_style_t
name|style
init|=
name|input_event
operator|.
name|data
operator|.
name|scalar
operator|.
name|style
decl_stmt|;
comment|/* Add 'style':<style>. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"style"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
operator|(
name|style
operator|==
name|YAML_PLAIN_SCALAR_STYLE
condition|?
literal|"plain"
else|:
name|style
operator|==
name|YAML_SINGLE_QUOTED_SCALAR_STYLE
condition|?
literal|"single-quoted"
else|:
name|style
operator|==
name|YAML_DOUBLE_QUOTED_SCALAR_STYLE
condition|?
literal|"double-quoted"
else|:
name|style
operator|==
name|YAML_LITERAL_SCALAR_STYLE
condition|?
literal|"literal"
else|:
name|style
operator|==
name|YAML_FOLDED_SCALAR_STYLE
condition|?
literal|"folded"
else|:
literal|"unknown"
operator|)
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
block|}
break|break;
case|case
name|YAML_SEQUENCE_START_EVENT
case|:
comment|/* Add 'type': 'SEQUENCE-START'. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"type"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"SEQUENCE-START"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Add 'anchor':<anchor>. */
if|if
condition|(
name|input_event
operator|.
name|data
operator|.
name|sequence_start
operator|.
name|anchor
condition|)
block|{
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"anchor"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
name|input_event
operator|.
name|data
operator|.
name|sequence_start
operator|.
name|anchor
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_DOUBLE_QUOTED_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
block|}
comment|/* Add 'tag':<tag>. */
if|if
condition|(
name|input_event
operator|.
name|data
operator|.
name|sequence_start
operator|.
name|tag
condition|)
block|{
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"tag"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
name|input_event
operator|.
name|data
operator|.
name|sequence_start
operator|.
name|tag
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_DOUBLE_QUOTED_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
block|}
comment|/* Add 'implicit':<flag>. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"implicit"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|YAML_BOOL_TAG
argument_list|,
operator|(
name|input_event
operator|.
name|data
operator|.
name|sequence_start
operator|.
name|implicit
condition|?
literal|"true"
else|:
literal|"false"
operator|)
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Display the style information. */
if|if
condition|(
name|input_event
operator|.
name|data
operator|.
name|sequence_start
operator|.
name|style
condition|)
block|{
name|yaml_sequence_style_t
name|style
init|=
name|input_event
operator|.
name|data
operator|.
name|sequence_start
operator|.
name|style
decl_stmt|;
comment|/* Add 'style':<style>. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"style"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
operator|(
name|style
operator|==
name|YAML_BLOCK_SEQUENCE_STYLE
condition|?
literal|"block"
else|:
name|style
operator|==
name|YAML_FLOW_SEQUENCE_STYLE
condition|?
literal|"flow"
else|:
literal|"unknown"
operator|)
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
block|}
break|break;
case|case
name|YAML_SEQUENCE_END_EVENT
case|:
comment|/* Add 'type': 'SEQUENCE-END'. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"type"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"SEQUENCE-END"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
break|break;
case|case
name|YAML_MAPPING_START_EVENT
case|:
comment|/* Add 'type': 'MAPPING-START'. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"type"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"MAPPING-START"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Add 'anchor':<anchor>. */
if|if
condition|(
name|input_event
operator|.
name|data
operator|.
name|mapping_start
operator|.
name|anchor
condition|)
block|{
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"anchor"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
name|input_event
operator|.
name|data
operator|.
name|mapping_start
operator|.
name|anchor
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_DOUBLE_QUOTED_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
block|}
comment|/* Add 'tag':<tag>. */
if|if
condition|(
name|input_event
operator|.
name|data
operator|.
name|mapping_start
operator|.
name|tag
condition|)
block|{
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"tag"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
name|input_event
operator|.
name|data
operator|.
name|mapping_start
operator|.
name|tag
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_DOUBLE_QUOTED_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
block|}
comment|/* Add 'implicit':<flag>. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"implicit"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|YAML_BOOL_TAG
argument_list|,
operator|(
name|input_event
operator|.
name|data
operator|.
name|mapping_start
operator|.
name|implicit
condition|?
literal|"true"
else|:
literal|"false"
operator|)
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
comment|/* Display the style information. */
if|if
condition|(
name|input_event
operator|.
name|data
operator|.
name|sequence_start
operator|.
name|style
condition|)
block|{
name|yaml_sequence_style_t
name|style
init|=
name|input_event
operator|.
name|data
operator|.
name|mapping_start
operator|.
name|style
decl_stmt|;
comment|/* Add 'style':<style>. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"style"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
operator|(
name|style
operator|==
name|YAML_BLOCK_MAPPING_STYLE
condition|?
literal|"block"
else|:
name|style
operator|==
name|YAML_FLOW_MAPPING_STYLE
condition|?
literal|"flow"
else|:
literal|"unknown"
operator|)
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
block|}
break|break;
case|case
name|YAML_MAPPING_END_EVENT
case|:
comment|/* Add 'type': 'MAPPING-END'. */
name|key
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"type"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|key
condition|)
goto|goto
name|document_error
goto|;
name|value
operator|=
name|yaml_document_add_scalar
argument_list|(
operator|&
name|output_document
argument_list|,
name|NULL
argument_list|,
literal|"MAPPING-END"
argument_list|,
operator|-
literal|1
argument_list|,
name|YAML_PLAIN_SCALAR_STYLE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|value
condition|)
goto|goto
name|document_error
goto|;
if|if
condition|(
operator|!
name|yaml_document_append_mapping_pair
argument_list|(
operator|&
name|output_document
argument_list|,
name|properties
argument_list|,
name|key
argument_list|,
name|value
argument_list|)
condition|)
goto|goto
name|document_error
goto|;
break|break;
default|default:
comment|/* It couldn't really happen. */
break|break;
block|}
comment|/* Delete the event object. */
name|yaml_event_delete
argument_list|(
operator|&
name|input_event
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|yaml_emitter_dump
argument_list|(
operator|&
name|emitter
argument_list|,
operator|&
name|output_document
argument_list|)
condition|)
goto|goto
name|emitter_error
goto|;
if|if
condition|(
operator|!
name|yaml_emitter_close
argument_list|(
operator|&
name|emitter
argument_list|)
condition|)
goto|goto
name|emitter_error
goto|;
name|yaml_parser_delete
argument_list|(
operator|&
name|parser
argument_list|)
expr_stmt|;
name|yaml_emitter_delete
argument_list|(
operator|&
name|emitter
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
name|parser_error
label|:
comment|/* Display a parser error message. */
switch|switch
condition|(
name|parser
operator|.
name|error
condition|)
block|{
case|case
name|YAML_MEMORY_ERROR
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Memory error: Not enough memory for parsing\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|YAML_READER_ERROR
case|:
if|if
condition|(
name|parser
operator|.
name|problem_value
operator|!=
operator|-
literal|1
condition|)
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Reader error: %s: #%X at %d\n"
argument_list|,
name|parser
operator|.
name|problem
argument_list|,
name|parser
operator|.
name|problem_value
argument_list|,
name|parser
operator|.
name|problem_offset
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Reader error: %s at %d\n"
argument_list|,
name|parser
operator|.
name|problem
argument_list|,
name|parser
operator|.
name|problem_offset
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|YAML_SCANNER_ERROR
case|:
if|if
condition|(
name|parser
operator|.
name|context
condition|)
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Scanner error: %s at line %d, column %d\n"
literal|"%s at line %d, column %d\n"
argument_list|,
name|parser
operator|.
name|context
argument_list|,
name|parser
operator|.
name|context_mark
operator|.
name|line
operator|+
literal|1
argument_list|,
name|parser
operator|.
name|context_mark
operator|.
name|column
operator|+
literal|1
argument_list|,
name|parser
operator|.
name|problem
argument_list|,
name|parser
operator|.
name|problem_mark
operator|.
name|line
operator|+
literal|1
argument_list|,
name|parser
operator|.
name|problem_mark
operator|.
name|column
operator|+
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Scanner error: %s at line %d, column %d\n"
argument_list|,
name|parser
operator|.
name|problem
argument_list|,
name|parser
operator|.
name|problem_mark
operator|.
name|line
operator|+
literal|1
argument_list|,
name|parser
operator|.
name|problem_mark
operator|.
name|column
operator|+
literal|1
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|YAML_PARSER_ERROR
case|:
if|if
condition|(
name|parser
operator|.
name|context
condition|)
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Parser error: %s at line %d, column %d\n"
literal|"%s at line %d, column %d\n"
argument_list|,
name|parser
operator|.
name|context
argument_list|,
name|parser
operator|.
name|context_mark
operator|.
name|line
operator|+
literal|1
argument_list|,
name|parser
operator|.
name|context_mark
operator|.
name|column
operator|+
literal|1
argument_list|,
name|parser
operator|.
name|problem
argument_list|,
name|parser
operator|.
name|problem_mark
operator|.
name|line
operator|+
literal|1
argument_list|,
name|parser
operator|.
name|problem_mark
operator|.
name|column
operator|+
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Parser error: %s at line %d, column %d\n"
argument_list|,
name|parser
operator|.
name|problem
argument_list|,
name|parser
operator|.
name|problem_mark
operator|.
name|line
operator|+
literal|1
argument_list|,
name|parser
operator|.
name|problem_mark
operator|.
name|column
operator|+
literal|1
argument_list|)
expr_stmt|;
block|}
break|break;
default|default:
comment|/* Couldn't happen. */
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Internal error\n"
argument_list|)
expr_stmt|;
break|break;
block|}
name|yaml_event_delete
argument_list|(
operator|&
name|input_event
argument_list|)
expr_stmt|;
name|yaml_document_delete
argument_list|(
operator|&
name|output_document
argument_list|)
expr_stmt|;
name|yaml_parser_delete
argument_list|(
operator|&
name|parser
argument_list|)
expr_stmt|;
name|yaml_emitter_delete
argument_list|(
operator|&
name|emitter
argument_list|)
expr_stmt|;
return|return
literal|1
return|;
name|emitter_error
label|:
comment|/* Display an emitter error message. */
switch|switch
condition|(
name|emitter
operator|.
name|error
condition|)
block|{
case|case
name|YAML_MEMORY_ERROR
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Memory error: Not enough memory for emitting\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|YAML_WRITER_ERROR
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Writer error: %s\n"
argument_list|,
name|emitter
operator|.
name|problem
argument_list|)
expr_stmt|;
break|break;
case|case
name|YAML_EMITTER_ERROR
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Emitter error: %s\n"
argument_list|,
name|emitter
operator|.
name|problem
argument_list|)
expr_stmt|;
break|break;
default|default:
comment|/* Couldn't happen. */
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Internal error\n"
argument_list|)
expr_stmt|;
break|break;
block|}
name|yaml_event_delete
argument_list|(
operator|&
name|input_event
argument_list|)
expr_stmt|;
name|yaml_document_delete
argument_list|(
operator|&
name|output_document
argument_list|)
expr_stmt|;
name|yaml_parser_delete
argument_list|(
operator|&
name|parser
argument_list|)
expr_stmt|;
name|yaml_emitter_delete
argument_list|(
operator|&
name|emitter
argument_list|)
expr_stmt|;
return|return
literal|1
return|;
name|document_error
label|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Memory error: Not enough memory for creating a document\n"
argument_list|)
expr_stmt|;
name|yaml_event_delete
argument_list|(
operator|&
name|input_event
argument_list|)
expr_stmt|;
name|yaml_document_delete
argument_list|(
operator|&
name|output_document
argument_list|)
expr_stmt|;
name|yaml_parser_delete
argument_list|(
operator|&
name|parser
argument_list|)
expr_stmt|;
name|yaml_emitter_delete
argument_list|(
operator|&
name|emitter
argument_list|)
expr_stmt|;
return|return
literal|1
return|;
block|}
end_function

end_unit

