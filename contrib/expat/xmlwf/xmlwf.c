begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* Copyright (c) 1998, 1999 Thai Open Source Software Center Ltd    See the file COPYING for copying permission. */
end_comment

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<stddef.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|"expat.h"
end_include

begin_include
include|#
directive|include
file|"codepage.h"
end_include

begin_include
include|#
directive|include
file|"xmlfile.h"
end_include

begin_include
include|#
directive|include
file|"xmltchar.h"
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|_MSC_VER
end_ifdef

begin_include
include|#
directive|include
file|<crtdbg.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__amigaos__
argument_list|)
operator|&&
name|defined
argument_list|(
name|__USE_INLINE__
argument_list|)
end_if

begin_include
include|#
directive|include
file|<proto/expat.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* This ensures proper sorting. */
end_comment

begin_define
define|#
directive|define
name|NSSEP
value|T('\001')
end_define

begin_function
specifier|static
name|void
name|XMLCALL
name|characterData
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|s
parameter_list|,
name|int
name|len
parameter_list|)
block|{
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|userData
decl_stmt|;
for|for
control|(
init|;
name|len
operator|>
literal|0
condition|;
operator|--
name|len
operator|,
operator|++
name|s
control|)
block|{
switch|switch
condition|(
operator|*
name|s
condition|)
block|{
case|case
name|T
argument_list|(
literal|'&'
argument_list|)
case|:
name|fputts
argument_list|(
name|T
argument_list|(
literal|"&amp;"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|T
argument_list|(
literal|'<'
argument_list|)
case|:
name|fputts
argument_list|(
name|T
argument_list|(
literal|"&lt;"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|T
argument_list|(
literal|'>'
argument_list|)
case|:
name|fputts
argument_list|(
name|T
argument_list|(
literal|"&gt;"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
ifdef|#
directive|ifdef
name|W3C14N
case|case
literal|13
case|:
name|fputts
argument_list|(
name|T
argument_list|(
literal|"&#xD;"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
else|#
directive|else
case|case
name|T
argument_list|(
literal|'"'
argument_list|)
case|:
name|fputts
argument_list|(
name|T
argument_list|(
literal|"&quot;"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
literal|9
case|:
case|case
literal|10
case|:
case|case
literal|13
case|:
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|"&#%d;"
argument_list|)
argument_list|,
operator|*
name|s
argument_list|)
expr_stmt|;
break|break;
endif|#
directive|endif
default|default:
name|puttc
argument_list|(
operator|*
name|s
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|attributeValue
parameter_list|(
name|FILE
modifier|*
name|fp
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|s
parameter_list|)
block|{
name|puttc
argument_list|(
name|T
argument_list|(
literal|'='
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'"'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
for|for
control|(
init|;
condition|;
control|)
block|{
switch|switch
condition|(
operator|*
name|s
condition|)
block|{
case|case
literal|0
case|:
case|case
name|NSSEP
case|:
name|puttc
argument_list|(
name|T
argument_list|(
literal|'"'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
return|return;
case|case
name|T
argument_list|(
literal|'&'
argument_list|)
case|:
name|fputts
argument_list|(
name|T
argument_list|(
literal|"&amp;"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|T
argument_list|(
literal|'<'
argument_list|)
case|:
name|fputts
argument_list|(
name|T
argument_list|(
literal|"&lt;"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|T
argument_list|(
literal|'"'
argument_list|)
case|:
name|fputts
argument_list|(
name|T
argument_list|(
literal|"&quot;"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
ifdef|#
directive|ifdef
name|W3C14N
case|case
literal|9
case|:
name|fputts
argument_list|(
name|T
argument_list|(
literal|"&#x9;"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
literal|10
case|:
name|fputts
argument_list|(
name|T
argument_list|(
literal|"&#xA;"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
literal|13
case|:
name|fputts
argument_list|(
name|T
argument_list|(
literal|"&#xD;"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
else|#
directive|else
case|case
name|T
argument_list|(
literal|'>'
argument_list|)
case|:
name|fputts
argument_list|(
name|T
argument_list|(
literal|"&gt;"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
literal|9
case|:
case|case
literal|10
case|:
case|case
literal|13
case|:
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|"&#%d;"
argument_list|)
argument_list|,
operator|*
name|s
argument_list|)
expr_stmt|;
break|break;
endif|#
directive|endif
default|default:
name|puttc
argument_list|(
operator|*
name|s
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
block|}
name|s
operator|++
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* Lexicographically comparing UTF-8 encoded attribute values, is equivalent to lexicographically comparing based on the character number. */
end_comment

begin_function
specifier|static
name|int
name|attcmp
parameter_list|(
specifier|const
name|void
modifier|*
name|att1
parameter_list|,
specifier|const
name|void
modifier|*
name|att2
parameter_list|)
block|{
return|return
name|tcscmp
argument_list|(
operator|*
operator|(
specifier|const
name|XML_Char
operator|*
operator|*
operator|)
name|att1
argument_list|,
operator|*
operator|(
specifier|const
name|XML_Char
operator|*
operator|*
operator|)
name|att2
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|startElement
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|name
parameter_list|,
specifier|const
name|XML_Char
modifier|*
modifier|*
name|atts
parameter_list|)
block|{
name|int
name|nAtts
decl_stmt|;
specifier|const
name|XML_Char
modifier|*
modifier|*
name|p
decl_stmt|;
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|userData
decl_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'<'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|name
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|p
operator|=
name|atts
expr_stmt|;
while|while
condition|(
operator|*
name|p
condition|)
operator|++
name|p
expr_stmt|;
name|nAtts
operator|=
call|(
name|int
call|)
argument_list|(
operator|(
name|p
operator|-
name|atts
operator|)
operator|>>
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|nAtts
operator|>
literal|1
condition|)
name|qsort
argument_list|(
operator|(
name|void
operator|*
operator|)
name|atts
argument_list|,
name|nAtts
argument_list|,
sizeof|sizeof
argument_list|(
name|XML_Char
operator|*
argument_list|)
operator|*
literal|2
argument_list|,
name|attcmp
argument_list|)
expr_stmt|;
while|while
condition|(
operator|*
name|atts
condition|)
block|{
name|puttc
argument_list|(
name|T
argument_list|(
literal|' '
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
operator|*
name|atts
operator|++
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|attributeValue
argument_list|(
name|fp
argument_list|,
operator|*
name|atts
argument_list|)
expr_stmt|;
name|atts
operator|++
expr_stmt|;
block|}
name|puttc
argument_list|(
name|T
argument_list|(
literal|'>'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|endElement
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|name
parameter_list|)
block|{
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|userData
decl_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'<'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'/'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|name
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'>'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|int
name|nsattcmp
parameter_list|(
specifier|const
name|void
modifier|*
name|p1
parameter_list|,
specifier|const
name|void
modifier|*
name|p2
parameter_list|)
block|{
specifier|const
name|XML_Char
modifier|*
name|att1
init|=
operator|*
operator|(
specifier|const
name|XML_Char
operator|*
operator|*
operator|)
name|p1
decl_stmt|;
specifier|const
name|XML_Char
modifier|*
name|att2
init|=
operator|*
operator|(
specifier|const
name|XML_Char
operator|*
operator|*
operator|)
name|p2
decl_stmt|;
name|int
name|sep1
init|=
operator|(
name|tcsrchr
argument_list|(
name|att1
argument_list|,
name|NSSEP
argument_list|)
operator|!=
literal|0
operator|)
decl_stmt|;
name|int
name|sep2
init|=
operator|(
name|tcsrchr
argument_list|(
name|att1
argument_list|,
name|NSSEP
argument_list|)
operator|!=
literal|0
operator|)
decl_stmt|;
if|if
condition|(
name|sep1
operator|!=
name|sep2
condition|)
return|return
name|sep1
operator|-
name|sep2
return|;
return|return
name|tcscmp
argument_list|(
name|att1
argument_list|,
name|att2
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|startElementNS
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|name
parameter_list|,
specifier|const
name|XML_Char
modifier|*
modifier|*
name|atts
parameter_list|)
block|{
name|int
name|nAtts
decl_stmt|;
name|int
name|nsi
decl_stmt|;
specifier|const
name|XML_Char
modifier|*
modifier|*
name|p
decl_stmt|;
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|userData
decl_stmt|;
specifier|const
name|XML_Char
modifier|*
name|sep
decl_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'<'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|sep
operator|=
name|tcsrchr
argument_list|(
name|name
argument_list|,
name|NSSEP
argument_list|)
expr_stmt|;
if|if
condition|(
name|sep
condition|)
block|{
name|fputts
argument_list|(
name|T
argument_list|(
literal|"n1:"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|sep
operator|+
literal|1
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|" xmlns:n1"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|attributeValue
argument_list|(
name|fp
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|nsi
operator|=
literal|2
expr_stmt|;
block|}
else|else
block|{
name|fputts
argument_list|(
name|name
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|nsi
operator|=
literal|1
expr_stmt|;
block|}
name|p
operator|=
name|atts
expr_stmt|;
while|while
condition|(
operator|*
name|p
condition|)
operator|++
name|p
expr_stmt|;
name|nAtts
operator|=
call|(
name|int
call|)
argument_list|(
operator|(
name|p
operator|-
name|atts
operator|)
operator|>>
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|nAtts
operator|>
literal|1
condition|)
name|qsort
argument_list|(
operator|(
name|void
operator|*
operator|)
name|atts
argument_list|,
name|nAtts
argument_list|,
sizeof|sizeof
argument_list|(
name|XML_Char
operator|*
argument_list|)
operator|*
literal|2
argument_list|,
name|nsattcmp
argument_list|)
expr_stmt|;
while|while
condition|(
operator|*
name|atts
condition|)
block|{
name|name
operator|=
operator|*
name|atts
operator|++
expr_stmt|;
name|sep
operator|=
name|tcsrchr
argument_list|(
name|name
argument_list|,
name|NSSEP
argument_list|)
expr_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|' '
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
if|if
condition|(
name|sep
condition|)
block|{
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|"n%d:"
argument_list|)
argument_list|,
name|nsi
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|sep
operator|+
literal|1
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
else|else
name|fputts
argument_list|(
name|name
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|attributeValue
argument_list|(
name|fp
argument_list|,
operator|*
name|atts
argument_list|)
expr_stmt|;
if|if
condition|(
name|sep
condition|)
block|{
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|" xmlns:n%d"
argument_list|)
argument_list|,
name|nsi
operator|++
argument_list|)
expr_stmt|;
name|attributeValue
argument_list|(
name|fp
argument_list|,
name|name
argument_list|)
expr_stmt|;
block|}
name|atts
operator|++
expr_stmt|;
block|}
name|puttc
argument_list|(
name|T
argument_list|(
literal|'>'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|endElementNS
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|name
parameter_list|)
block|{
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|userData
decl_stmt|;
specifier|const
name|XML_Char
modifier|*
name|sep
decl_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'<'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'/'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|sep
operator|=
name|tcsrchr
argument_list|(
name|name
argument_list|,
name|NSSEP
argument_list|)
expr_stmt|;
if|if
condition|(
name|sep
condition|)
block|{
name|fputts
argument_list|(
name|T
argument_list|(
literal|"n1:"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|sep
operator|+
literal|1
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
else|else
name|fputts
argument_list|(
name|name
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'>'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
end_function

begin_ifndef
ifndef|#
directive|ifndef
name|W3C14N
end_ifndef

begin_function
specifier|static
name|void
name|XMLCALL
name|processingInstruction
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|target
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|data
parameter_list|)
block|{
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|userData
decl_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'<'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'?'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|target
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|' '
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|data
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'?'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'>'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* not W3C14N */
end_comment

begin_function
specifier|static
name|void
name|XMLCALL
name|defaultCharacterData
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|s
parameter_list|,
name|int
name|len
parameter_list|)
block|{
name|XML_DefaultCurrent
argument_list|(
operator|(
name|XML_Parser
operator|)
name|userData
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|defaultStartElement
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|name
parameter_list|,
specifier|const
name|XML_Char
modifier|*
modifier|*
name|atts
parameter_list|)
block|{
name|XML_DefaultCurrent
argument_list|(
operator|(
name|XML_Parser
operator|)
name|userData
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|defaultEndElement
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|name
parameter_list|)
block|{
name|XML_DefaultCurrent
argument_list|(
operator|(
name|XML_Parser
operator|)
name|userData
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|defaultProcessingInstruction
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|target
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|data
parameter_list|)
block|{
name|XML_DefaultCurrent
argument_list|(
operator|(
name|XML_Parser
operator|)
name|userData
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|nopCharacterData
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|s
parameter_list|,
name|int
name|len
parameter_list|)
block|{ }
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|nopStartElement
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|name
parameter_list|,
specifier|const
name|XML_Char
modifier|*
modifier|*
name|atts
parameter_list|)
block|{ }
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|nopEndElement
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|name
parameter_list|)
block|{ }
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|nopProcessingInstruction
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|target
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|data
parameter_list|)
block|{ }
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|markup
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|s
parameter_list|,
name|int
name|len
parameter_list|)
block|{
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
operator|(
name|XML_Parser
operator|)
name|userData
argument_list|)
decl_stmt|;
for|for
control|(
init|;
name|len
operator|>
literal|0
condition|;
operator|--
name|len
operator|,
operator|++
name|s
control|)
name|puttc
argument_list|(
operator|*
name|s
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|metaLocation
parameter_list|(
name|XML_Parser
name|parser
parameter_list|)
block|{
specifier|const
name|XML_Char
modifier|*
name|uri
init|=
name|XML_GetBase
argument_list|(
name|parser
argument_list|)
decl_stmt|;
if|if
condition|(
name|uri
condition|)
name|ftprintf
argument_list|(
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
name|parser
argument_list|)
argument_list|,
name|T
argument_list|(
literal|" uri=\"%s\""
argument_list|)
argument_list|,
name|uri
argument_list|)
expr_stmt|;
name|ftprintf
argument_list|(
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
name|parser
argument_list|)
argument_list|,
name|T
argument_list|(
literal|" byte=\"%"
name|XML_FMT_INT_MOD
literal|"d\" nbytes=\"%d\" \ 			 line=\"%"
name|XML_FMT_INT_MOD
literal|"u\" col=\"%"
name|XML_FMT_INT_MOD
literal|"u\""
argument_list|)
argument_list|,
name|XML_GetCurrentByteIndex
argument_list|(
name|parser
argument_list|)
argument_list|,
name|XML_GetCurrentByteCount
argument_list|(
name|parser
argument_list|)
argument_list|,
name|XML_GetCurrentLineNumber
argument_list|(
name|parser
argument_list|)
argument_list|,
name|XML_GetCurrentColumnNumber
argument_list|(
name|parser
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|metaStartDocument
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|)
block|{
name|fputts
argument_list|(
name|T
argument_list|(
literal|"<document>\n"
argument_list|)
argument_list|,
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
operator|(
name|XML_Parser
operator|)
name|userData
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|metaEndDocument
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|)
block|{
name|fputts
argument_list|(
name|T
argument_list|(
literal|"</document>\n"
argument_list|)
argument_list|,
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
operator|(
name|XML_Parser
operator|)
name|userData
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|metaStartElement
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|name
parameter_list|,
specifier|const
name|XML_Char
modifier|*
modifier|*
name|atts
parameter_list|)
block|{
name|XML_Parser
name|parser
init|=
operator|(
name|XML_Parser
operator|)
name|userData
decl_stmt|;
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
name|parser
argument_list|)
decl_stmt|;
specifier|const
name|XML_Char
modifier|*
modifier|*
name|specifiedAttsEnd
init|=
name|atts
operator|+
name|XML_GetSpecifiedAttributeCount
argument_list|(
name|parser
argument_list|)
decl_stmt|;
specifier|const
name|XML_Char
modifier|*
modifier|*
name|idAttPtr
decl_stmt|;
name|int
name|idAttIndex
init|=
name|XML_GetIdAttributeIndex
argument_list|(
name|parser
argument_list|)
decl_stmt|;
if|if
condition|(
name|idAttIndex
operator|<
literal|0
condition|)
name|idAttPtr
operator|=
literal|0
expr_stmt|;
else|else
name|idAttPtr
operator|=
name|atts
operator|+
name|idAttIndex
expr_stmt|;
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|"<starttag name=\"%s\""
argument_list|)
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|metaLocation
argument_list|(
name|parser
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
name|atts
condition|)
block|{
name|fputts
argument_list|(
name|T
argument_list|(
literal|">\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
do|do
block|{
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|"<attribute name=\"%s\" value=\""
argument_list|)
argument_list|,
name|atts
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|characterData
argument_list|(
name|fp
argument_list|,
name|atts
index|[
literal|1
index|]
argument_list|,
operator|(
name|int
operator|)
name|tcslen
argument_list|(
name|atts
index|[
literal|1
index|]
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|atts
operator|>=
name|specifiedAttsEnd
condition|)
name|fputts
argument_list|(
name|T
argument_list|(
literal|"\" defaulted=\"yes\"/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|atts
operator|==
name|idAttPtr
condition|)
name|fputts
argument_list|(
name|T
argument_list|(
literal|"\" id=\"yes\"/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
else|else
name|fputts
argument_list|(
name|T
argument_list|(
literal|"\"/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
do|while
condition|(
operator|*
operator|(
name|atts
operator|+=
literal|2
operator|)
condition|)
do|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"</starttag>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
else|else
name|fputts
argument_list|(
name|T
argument_list|(
literal|"/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|metaEndElement
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|name
parameter_list|)
block|{
name|XML_Parser
name|parser
init|=
operator|(
name|XML_Parser
operator|)
name|userData
decl_stmt|;
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
name|parser
argument_list|)
decl_stmt|;
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|"<endtag name=\"%s\""
argument_list|)
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|metaLocation
argument_list|(
name|parser
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|metaProcessingInstruction
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|target
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|data
parameter_list|)
block|{
name|XML_Parser
name|parser
init|=
operator|(
name|XML_Parser
operator|)
name|userData
decl_stmt|;
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
name|parser
argument_list|)
decl_stmt|;
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|"<pi target=\"%s\" data=\""
argument_list|)
argument_list|,
name|target
argument_list|)
expr_stmt|;
name|characterData
argument_list|(
name|fp
argument_list|,
name|data
argument_list|,
operator|(
name|int
operator|)
name|tcslen
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'"'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|metaLocation
argument_list|(
name|parser
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|metaComment
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|data
parameter_list|)
block|{
name|XML_Parser
name|parser
init|=
operator|(
name|XML_Parser
operator|)
name|userData
decl_stmt|;
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
name|parser
argument_list|)
decl_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"<comment data=\""
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|characterData
argument_list|(
name|fp
argument_list|,
name|data
argument_list|,
operator|(
name|int
operator|)
name|tcslen
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'"'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|metaLocation
argument_list|(
name|parser
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|metaStartCdataSection
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|)
block|{
name|XML_Parser
name|parser
init|=
operator|(
name|XML_Parser
operator|)
name|userData
decl_stmt|;
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
name|parser
argument_list|)
decl_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"<startcdata"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|metaLocation
argument_list|(
name|parser
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|metaEndCdataSection
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|)
block|{
name|XML_Parser
name|parser
init|=
operator|(
name|XML_Parser
operator|)
name|userData
decl_stmt|;
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
name|parser
argument_list|)
decl_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"<endcdata"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|metaLocation
argument_list|(
name|parser
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|metaCharacterData
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|s
parameter_list|,
name|int
name|len
parameter_list|)
block|{
name|XML_Parser
name|parser
init|=
operator|(
name|XML_Parser
operator|)
name|userData
decl_stmt|;
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
name|parser
argument_list|)
decl_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"<chars str=\""
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|characterData
argument_list|(
name|fp
argument_list|,
name|s
argument_list|,
name|len
argument_list|)
expr_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'"'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|metaLocation
argument_list|(
name|parser
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|metaStartDoctypeDecl
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|doctypeName
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|sysid
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|pubid
parameter_list|,
name|int
name|has_internal_subset
parameter_list|)
block|{
name|XML_Parser
name|parser
init|=
operator|(
name|XML_Parser
operator|)
name|userData
decl_stmt|;
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
name|parser
argument_list|)
decl_stmt|;
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|"<startdoctype name=\"%s\""
argument_list|)
argument_list|,
name|doctypeName
argument_list|)
expr_stmt|;
name|metaLocation
argument_list|(
name|parser
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|metaEndDoctypeDecl
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|)
block|{
name|XML_Parser
name|parser
init|=
operator|(
name|XML_Parser
operator|)
name|userData
decl_stmt|;
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
name|parser
argument_list|)
decl_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"<enddoctype"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|metaLocation
argument_list|(
name|parser
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|metaNotationDecl
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|notationName
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|base
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|systemId
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|publicId
parameter_list|)
block|{
name|XML_Parser
name|parser
init|=
operator|(
name|XML_Parser
operator|)
name|userData
decl_stmt|;
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
name|parser
argument_list|)
decl_stmt|;
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|"<notation name=\"%s\""
argument_list|)
argument_list|,
name|notationName
argument_list|)
expr_stmt|;
if|if
condition|(
name|publicId
condition|)
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|" public=\"%s\""
argument_list|)
argument_list|,
name|publicId
argument_list|)
expr_stmt|;
if|if
condition|(
name|systemId
condition|)
block|{
name|fputts
argument_list|(
name|T
argument_list|(
literal|" system=\""
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|characterData
argument_list|(
name|fp
argument_list|,
name|systemId
argument_list|,
operator|(
name|int
operator|)
name|tcslen
argument_list|(
name|systemId
argument_list|)
argument_list|)
expr_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'"'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
name|metaLocation
argument_list|(
name|parser
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|metaEntityDecl
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|entityName
parameter_list|,
name|int
name|is_param
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|value
parameter_list|,
name|int
name|value_length
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|base
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|systemId
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|publicId
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|notationName
parameter_list|)
block|{
name|XML_Parser
name|parser
init|=
operator|(
name|XML_Parser
operator|)
name|userData
decl_stmt|;
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
name|parser
argument_list|)
decl_stmt|;
if|if
condition|(
name|value
condition|)
block|{
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|"<entity name=\"%s\""
argument_list|)
argument_list|,
name|entityName
argument_list|)
expr_stmt|;
name|metaLocation
argument_list|(
name|parser
argument_list|)
expr_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'>'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|characterData
argument_list|(
name|fp
argument_list|,
name|value
argument_list|,
name|value_length
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"</entity/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|notationName
condition|)
block|{
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|"<entity name=\"%s\""
argument_list|)
argument_list|,
name|entityName
argument_list|)
expr_stmt|;
if|if
condition|(
name|publicId
condition|)
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|" public=\"%s\""
argument_list|)
argument_list|,
name|publicId
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|" system=\""
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|characterData
argument_list|(
name|fp
argument_list|,
name|systemId
argument_list|,
operator|(
name|int
operator|)
name|tcslen
argument_list|(
name|systemId
argument_list|)
argument_list|)
expr_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'"'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|" notation=\"%s\""
argument_list|)
argument_list|,
name|notationName
argument_list|)
expr_stmt|;
name|metaLocation
argument_list|(
name|parser
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|"<entity name=\"%s\""
argument_list|)
argument_list|,
name|entityName
argument_list|)
expr_stmt|;
if|if
condition|(
name|publicId
condition|)
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|" public=\"%s\""
argument_list|)
argument_list|,
name|publicId
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|" system=\""
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|characterData
argument_list|(
name|fp
argument_list|,
name|systemId
argument_list|,
operator|(
name|int
operator|)
name|tcslen
argument_list|(
name|systemId
argument_list|)
argument_list|)
expr_stmt|;
name|puttc
argument_list|(
name|T
argument_list|(
literal|'"'
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|metaLocation
argument_list|(
name|parser
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|metaStartNamespaceDecl
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|prefix
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|uri
parameter_list|)
block|{
name|XML_Parser
name|parser
init|=
operator|(
name|XML_Parser
operator|)
name|userData
decl_stmt|;
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
name|parser
argument_list|)
decl_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"<startns"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
if|if
condition|(
name|prefix
condition|)
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|" prefix=\"%s\""
argument_list|)
argument_list|,
name|prefix
argument_list|)
expr_stmt|;
if|if
condition|(
name|uri
condition|)
block|{
name|fputts
argument_list|(
name|T
argument_list|(
literal|" ns=\""
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|characterData
argument_list|(
name|fp
argument_list|,
name|uri
argument_list|,
operator|(
name|int
operator|)
name|tcslen
argument_list|(
name|uri
argument_list|)
argument_list|)
expr_stmt|;
name|fputts
argument_list|(
name|T
argument_list|(
literal|"\"/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
else|else
name|fputts
argument_list|(
name|T
argument_list|(
literal|"/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|XMLCALL
name|metaEndNamespaceDecl
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|prefix
parameter_list|)
block|{
name|XML_Parser
name|parser
init|=
operator|(
name|XML_Parser
operator|)
name|userData
decl_stmt|;
name|FILE
modifier|*
name|fp
init|=
operator|(
name|FILE
operator|*
operator|)
name|XML_GetUserData
argument_list|(
name|parser
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|prefix
condition|)
name|fputts
argument_list|(
name|T
argument_list|(
literal|"<endns/>\n"
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
else|else
name|ftprintf
argument_list|(
name|fp
argument_list|,
name|T
argument_list|(
literal|"<endns prefix=\"%s\"/>\n"
argument_list|)
argument_list|,
name|prefix
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|int
name|XMLCALL
name|unknownEncodingConvert
parameter_list|(
name|void
modifier|*
name|data
parameter_list|,
specifier|const
name|char
modifier|*
name|p
parameter_list|)
block|{
return|return
name|codepageConvert
argument_list|(
operator|*
operator|(
name|int
operator|*
operator|)
name|data
argument_list|,
name|p
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|XMLCALL
name|unknownEncoding
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|,
specifier|const
name|XML_Char
modifier|*
name|name
parameter_list|,
name|XML_Encoding
modifier|*
name|info
parameter_list|)
block|{
name|int
name|cp
decl_stmt|;
specifier|static
specifier|const
name|XML_Char
name|prefixL
index|[]
init|=
name|T
argument_list|(
literal|"windows-"
argument_list|)
decl_stmt|;
specifier|static
specifier|const
name|XML_Char
name|prefixU
index|[]
init|=
name|T
argument_list|(
literal|"WINDOWS-"
argument_list|)
decl_stmt|;
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|prefixU
index|[
name|i
index|]
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|name
index|[
name|i
index|]
operator|!=
name|prefixU
index|[
name|i
index|]
operator|&&
name|name
index|[
name|i
index|]
operator|!=
name|prefixL
index|[
name|i
index|]
condition|)
return|return
literal|0
return|;
name|cp
operator|=
literal|0
expr_stmt|;
for|for
control|(
init|;
name|name
index|[
name|i
index|]
condition|;
name|i
operator|++
control|)
block|{
specifier|static
specifier|const
name|XML_Char
name|digits
index|[]
init|=
name|T
argument_list|(
literal|"0123456789"
argument_list|)
decl_stmt|;
specifier|const
name|XML_Char
modifier|*
name|s
init|=
name|tcschr
argument_list|(
name|digits
argument_list|,
name|name
index|[
name|i
index|]
argument_list|)
decl_stmt|;
if|if
condition|(
operator|!
name|s
condition|)
return|return
literal|0
return|;
name|cp
operator|*=
literal|10
expr_stmt|;
name|cp
operator|+=
call|(
name|int
call|)
argument_list|(
name|s
operator|-
name|digits
argument_list|)
expr_stmt|;
if|if
condition|(
name|cp
operator|>=
literal|0x10000
condition|)
return|return
literal|0
return|;
block|}
if|if
condition|(
operator|!
name|codepageMap
argument_list|(
name|cp
argument_list|,
name|info
operator|->
name|map
argument_list|)
condition|)
return|return
literal|0
return|;
name|info
operator|->
name|convert
operator|=
name|unknownEncodingConvert
expr_stmt|;
comment|/* We could just cast the code page integer to a void *,   and avoid the use of release. */
name|info
operator|->
name|release
operator|=
name|free
expr_stmt|;
name|info
operator|->
name|data
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
name|int
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|info
operator|->
name|data
condition|)
return|return
literal|0
return|;
operator|*
operator|(
name|int
operator|*
operator|)
name|info
operator|->
name|data
operator|=
name|cp
expr_stmt|;
return|return
literal|1
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|XMLCALL
name|notStandalone
parameter_list|(
name|void
modifier|*
name|userData
parameter_list|)
block|{
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|showVersion
parameter_list|(
name|XML_Char
modifier|*
name|prog
parameter_list|)
block|{
name|XML_Char
modifier|*
name|s
init|=
name|prog
decl_stmt|;
name|XML_Char
name|ch
decl_stmt|;
specifier|const
name|XML_Feature
modifier|*
name|features
init|=
name|XML_GetFeatureList
argument_list|()
decl_stmt|;
while|while
condition|(
operator|(
name|ch
operator|=
operator|*
name|s
operator|)
operator|!=
literal|0
condition|)
block|{
if|if
condition|(
name|ch
operator|==
literal|'/'
if|#
directive|if
operator|(
name|defined
argument_list|(
name|WIN32
argument_list|)
operator|||
name|defined
argument_list|(
name|__WATCOMC__
argument_list|)
operator|)
operator|||
name|ch
operator|==
literal|'\\'
endif|#
directive|endif
condition|)
name|prog
operator|=
name|s
operator|+
literal|1
expr_stmt|;
operator|++
name|s
expr_stmt|;
block|}
name|ftprintf
argument_list|(
name|stdout
argument_list|,
name|T
argument_list|(
literal|"%s using %s\n"
argument_list|)
argument_list|,
name|prog
argument_list|,
name|XML_ExpatVersion
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|features
operator|!=
name|NULL
operator|&&
name|features
index|[
literal|0
index|]
operator|.
name|feature
operator|!=
name|XML_FEATURE_END
condition|)
block|{
name|int
name|i
init|=
literal|1
decl_stmt|;
name|ftprintf
argument_list|(
name|stdout
argument_list|,
name|T
argument_list|(
literal|"%s"
argument_list|)
argument_list|,
name|features
index|[
literal|0
index|]
operator|.
name|name
argument_list|)
expr_stmt|;
if|if
condition|(
name|features
index|[
literal|0
index|]
operator|.
name|value
condition|)
name|ftprintf
argument_list|(
name|stdout
argument_list|,
name|T
argument_list|(
literal|"=%ld"
argument_list|)
argument_list|,
name|features
index|[
literal|0
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
while|while
condition|(
name|features
index|[
name|i
index|]
operator|.
name|feature
operator|!=
name|XML_FEATURE_END
condition|)
block|{
name|ftprintf
argument_list|(
name|stdout
argument_list|,
name|T
argument_list|(
literal|", %s"
argument_list|)
argument_list|,
name|features
index|[
name|i
index|]
operator|.
name|name
argument_list|)
expr_stmt|;
if|if
condition|(
name|features
index|[
name|i
index|]
operator|.
name|value
condition|)
name|ftprintf
argument_list|(
name|stdout
argument_list|,
name|T
argument_list|(
literal|"=%ld"
argument_list|)
argument_list|,
name|features
index|[
name|i
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
operator|++
name|i
expr_stmt|;
block|}
name|ftprintf
argument_list|(
name|stdout
argument_list|,
name|T
argument_list|(
literal|"\n"
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|usage
parameter_list|(
specifier|const
name|XML_Char
modifier|*
name|prog
parameter_list|,
name|int
name|rc
parameter_list|)
block|{
name|ftprintf
argument_list|(
name|stderr
argument_list|,
name|T
argument_list|(
literal|"usage: %s [-n] [-p] [-r] [-s] [-w] [-x] [-d output-dir] "
literal|"[-e encoding] file ...\n"
argument_list|)
argument_list|,
name|prog
argument_list|)
expr_stmt|;
name|exit
argument_list|(
name|rc
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|int
name|tmain
parameter_list|(
name|int
name|argc
parameter_list|,
name|XML_Char
modifier|*
modifier|*
name|argv
parameter_list|)
block|{
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
specifier|const
name|XML_Char
modifier|*
name|outputDir
init|=
name|NULL
decl_stmt|;
specifier|const
name|XML_Char
modifier|*
name|encoding
init|=
name|NULL
decl_stmt|;
name|unsigned
name|processFlags
init|=
name|XML_MAP_FILE
decl_stmt|;
name|int
name|windowsCodePages
init|=
literal|0
decl_stmt|;
name|int
name|outputType
init|=
literal|0
decl_stmt|;
name|int
name|useNamespaces
init|=
literal|0
decl_stmt|;
name|int
name|requireStandalone
init|=
literal|0
decl_stmt|;
name|enum
name|XML_ParamEntityParsing
name|paramEntityParsing
init|=
name|XML_PARAM_ENTITY_PARSING_NEVER
decl_stmt|;
name|int
name|useStdin
init|=
literal|0
decl_stmt|;
ifdef|#
directive|ifdef
name|_MSC_VER
name|_CrtSetDbgFlag
argument_list|(
name|_CRTDBG_ALLOC_MEM_DF
operator||
name|_CRTDBG_LEAK_CHECK_DF
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|i
operator|=
literal|1
expr_stmt|;
name|j
operator|=
literal|0
expr_stmt|;
while|while
condition|(
name|i
operator|<
name|argc
condition|)
block|{
if|if
condition|(
name|j
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|argv
index|[
name|i
index|]
index|[
literal|0
index|]
operator|!=
name|T
argument_list|(
literal|'-'
argument_list|)
condition|)
break|break;
if|if
condition|(
name|argv
index|[
name|i
index|]
index|[
literal|1
index|]
operator|==
name|T
argument_list|(
literal|'-'
argument_list|)
operator|&&
name|argv
index|[
name|i
index|]
index|[
literal|2
index|]
operator|==
name|T
argument_list|(
literal|'\0'
argument_list|)
condition|)
block|{
name|i
operator|++
expr_stmt|;
break|break;
block|}
name|j
operator|++
expr_stmt|;
block|}
switch|switch
condition|(
name|argv
index|[
name|i
index|]
index|[
name|j
index|]
condition|)
block|{
case|case
name|T
argument_list|(
literal|'r'
argument_list|)
case|:
name|processFlags
operator|&=
operator|~
name|XML_MAP_FILE
expr_stmt|;
name|j
operator|++
expr_stmt|;
break|break;
case|case
name|T
argument_list|(
literal|'s'
argument_list|)
case|:
name|requireStandalone
operator|=
literal|1
expr_stmt|;
name|j
operator|++
expr_stmt|;
break|break;
case|case
name|T
argument_list|(
literal|'n'
argument_list|)
case|:
name|useNamespaces
operator|=
literal|1
expr_stmt|;
name|j
operator|++
expr_stmt|;
break|break;
case|case
name|T
argument_list|(
literal|'p'
argument_list|)
case|:
name|paramEntityParsing
operator|=
name|XML_PARAM_ENTITY_PARSING_ALWAYS
expr_stmt|;
comment|/* fall through */
case|case
name|T
argument_list|(
literal|'x'
argument_list|)
case|:
name|processFlags
operator||=
name|XML_EXTERNAL_ENTITIES
expr_stmt|;
name|j
operator|++
expr_stmt|;
break|break;
case|case
name|T
argument_list|(
literal|'w'
argument_list|)
case|:
name|windowsCodePages
operator|=
literal|1
expr_stmt|;
name|j
operator|++
expr_stmt|;
break|break;
case|case
name|T
argument_list|(
literal|'m'
argument_list|)
case|:
name|outputType
operator|=
literal|'m'
expr_stmt|;
name|j
operator|++
expr_stmt|;
break|break;
case|case
name|T
argument_list|(
literal|'c'
argument_list|)
case|:
name|outputType
operator|=
literal|'c'
expr_stmt|;
name|useNamespaces
operator|=
literal|0
expr_stmt|;
name|j
operator|++
expr_stmt|;
break|break;
case|case
name|T
argument_list|(
literal|'t'
argument_list|)
case|:
name|outputType
operator|=
literal|'t'
expr_stmt|;
name|j
operator|++
expr_stmt|;
break|break;
case|case
name|T
argument_list|(
literal|'d'
argument_list|)
case|:
if|if
condition|(
name|argv
index|[
name|i
index|]
index|[
name|j
operator|+
literal|1
index|]
operator|==
name|T
argument_list|(
literal|'\0'
argument_list|)
condition|)
block|{
if|if
condition|(
operator|++
name|i
operator|==
name|argc
condition|)
name|usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|outputDir
operator|=
name|argv
index|[
name|i
index|]
expr_stmt|;
block|}
else|else
name|outputDir
operator|=
name|argv
index|[
name|i
index|]
operator|+
name|j
operator|+
literal|1
expr_stmt|;
name|i
operator|++
expr_stmt|;
name|j
operator|=
literal|0
expr_stmt|;
break|break;
case|case
name|T
argument_list|(
literal|'e'
argument_list|)
case|:
if|if
condition|(
name|argv
index|[
name|i
index|]
index|[
name|j
operator|+
literal|1
index|]
operator|==
name|T
argument_list|(
literal|'\0'
argument_list|)
condition|)
block|{
if|if
condition|(
operator|++
name|i
operator|==
name|argc
condition|)
name|usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|encoding
operator|=
name|argv
index|[
name|i
index|]
expr_stmt|;
block|}
else|else
name|encoding
operator|=
name|argv
index|[
name|i
index|]
operator|+
name|j
operator|+
literal|1
expr_stmt|;
name|i
operator|++
expr_stmt|;
name|j
operator|=
literal|0
expr_stmt|;
break|break;
case|case
name|T
argument_list|(
literal|'h'
argument_list|)
case|:
name|usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|,
literal|0
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
case|case
name|T
argument_list|(
literal|'v'
argument_list|)
case|:
name|showVersion
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
case|case
name|T
argument_list|(
literal|'\0'
argument_list|)
case|:
if|if
condition|(
name|j
operator|>
literal|1
condition|)
block|{
name|i
operator|++
expr_stmt|;
name|j
operator|=
literal|0
expr_stmt|;
break|break;
block|}
comment|/* fall through */
default|default:
name|usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|,
literal|2
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|i
operator|==
name|argc
condition|)
block|{
name|useStdin
operator|=
literal|1
expr_stmt|;
name|processFlags
operator|&=
operator|~
name|XML_MAP_FILE
expr_stmt|;
name|i
operator|--
expr_stmt|;
block|}
for|for
control|(
init|;
name|i
operator|<
name|argc
condition|;
name|i
operator|++
control|)
block|{
name|FILE
modifier|*
name|fp
init|=
literal|0
decl_stmt|;
name|XML_Char
modifier|*
name|outName
init|=
literal|0
decl_stmt|;
name|int
name|result
decl_stmt|;
name|XML_Parser
name|parser
decl_stmt|;
if|if
condition|(
name|useNamespaces
condition|)
name|parser
operator|=
name|XML_ParserCreateNS
argument_list|(
name|encoding
argument_list|,
name|NSSEP
argument_list|)
expr_stmt|;
else|else
name|parser
operator|=
name|XML_ParserCreate
argument_list|(
name|encoding
argument_list|)
expr_stmt|;
if|if
condition|(
name|requireStandalone
condition|)
name|XML_SetNotStandaloneHandler
argument_list|(
name|parser
argument_list|,
name|notStandalone
argument_list|)
expr_stmt|;
name|XML_SetParamEntityParsing
argument_list|(
name|parser
argument_list|,
name|paramEntityParsing
argument_list|)
expr_stmt|;
if|if
condition|(
name|outputType
operator|==
literal|'t'
condition|)
block|{
comment|/* This is for doing timings; this gives a more realistic estimate of          the parsing time. */
name|outputDir
operator|=
literal|0
expr_stmt|;
name|XML_SetElementHandler
argument_list|(
name|parser
argument_list|,
name|nopStartElement
argument_list|,
name|nopEndElement
argument_list|)
expr_stmt|;
name|XML_SetCharacterDataHandler
argument_list|(
name|parser
argument_list|,
name|nopCharacterData
argument_list|)
expr_stmt|;
name|XML_SetProcessingInstructionHandler
argument_list|(
name|parser
argument_list|,
name|nopProcessingInstruction
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|outputDir
condition|)
block|{
specifier|const
name|XML_Char
modifier|*
name|delim
init|=
name|T
argument_list|(
literal|"/"
argument_list|)
decl_stmt|;
specifier|const
name|XML_Char
modifier|*
name|file
init|=
name|useStdin
condition|?
name|T
argument_list|(
literal|"STDIN"
argument_list|)
else|:
name|argv
index|[
name|i
index|]
decl_stmt|;
if|if
condition|(
operator|!
name|useStdin
condition|)
block|{
comment|/* Jump after last (back)slash */
specifier|const
name|XML_Char
modifier|*
name|lastDelim
init|=
name|tcsrchr
argument_list|(
name|file
argument_list|,
name|delim
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
if|if
condition|(
name|lastDelim
condition|)
name|file
operator|=
name|lastDelim
operator|+
literal|1
expr_stmt|;
if|#
directive|if
operator|(
name|defined
argument_list|(
name|WIN32
argument_list|)
operator|||
name|defined
argument_list|(
name|__WATCOMC__
argument_list|)
operator|)
else|else
block|{
specifier|const
name|XML_Char
modifier|*
name|winDelim
init|=
name|T
argument_list|(
literal|"\\"
argument_list|)
decl_stmt|;
name|lastDelim
operator|=
name|tcsrchr
argument_list|(
name|file
argument_list|,
name|winDelim
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|lastDelim
condition|)
block|{
name|file
operator|=
name|lastDelim
operator|+
literal|1
expr_stmt|;
name|delim
operator|=
name|winDelim
expr_stmt|;
block|}
block|}
endif|#
directive|endif
block|}
name|outName
operator|=
operator|(
name|XML_Char
operator|*
operator|)
name|malloc
argument_list|(
operator|(
name|tcslen
argument_list|(
name|outputDir
argument_list|)
operator|+
name|tcslen
argument_list|(
name|file
argument_list|)
operator|+
literal|2
operator|)
operator|*
sizeof|sizeof
argument_list|(
name|XML_Char
argument_list|)
argument_list|)
expr_stmt|;
name|tcscpy
argument_list|(
name|outName
argument_list|,
name|outputDir
argument_list|)
expr_stmt|;
name|tcscat
argument_list|(
name|outName
argument_list|,
name|delim
argument_list|)
expr_stmt|;
name|tcscat
argument_list|(
name|outName
argument_list|,
name|file
argument_list|)
expr_stmt|;
name|fp
operator|=
name|tfopen
argument_list|(
name|outName
argument_list|,
name|T
argument_list|(
literal|"wb"
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|fp
condition|)
block|{
name|tperror
argument_list|(
name|outName
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
name|setvbuf
argument_list|(
name|fp
argument_list|,
name|NULL
argument_list|,
name|_IOFBF
argument_list|,
literal|16384
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|XML_UNICODE
name|puttc
argument_list|(
literal|0xFEFF
argument_list|,
name|fp
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|XML_SetUserData
argument_list|(
name|parser
argument_list|,
name|fp
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|outputType
condition|)
block|{
case|case
literal|'m'
case|:
name|XML_UseParserAsHandlerArg
argument_list|(
name|parser
argument_list|)
expr_stmt|;
name|XML_SetElementHandler
argument_list|(
name|parser
argument_list|,
name|metaStartElement
argument_list|,
name|metaEndElement
argument_list|)
expr_stmt|;
name|XML_SetProcessingInstructionHandler
argument_list|(
name|parser
argument_list|,
name|metaProcessingInstruction
argument_list|)
expr_stmt|;
name|XML_SetCommentHandler
argument_list|(
name|parser
argument_list|,
name|metaComment
argument_list|)
expr_stmt|;
name|XML_SetCdataSectionHandler
argument_list|(
name|parser
argument_list|,
name|metaStartCdataSection
argument_list|,
name|metaEndCdataSection
argument_list|)
expr_stmt|;
name|XML_SetCharacterDataHandler
argument_list|(
name|parser
argument_list|,
name|metaCharacterData
argument_list|)
expr_stmt|;
name|XML_SetDoctypeDeclHandler
argument_list|(
name|parser
argument_list|,
name|metaStartDoctypeDecl
argument_list|,
name|metaEndDoctypeDecl
argument_list|)
expr_stmt|;
name|XML_SetEntityDeclHandler
argument_list|(
name|parser
argument_list|,
name|metaEntityDecl
argument_list|)
expr_stmt|;
name|XML_SetNotationDeclHandler
argument_list|(
name|parser
argument_list|,
name|metaNotationDecl
argument_list|)
expr_stmt|;
name|XML_SetNamespaceDeclHandler
argument_list|(
name|parser
argument_list|,
name|metaStartNamespaceDecl
argument_list|,
name|metaEndNamespaceDecl
argument_list|)
expr_stmt|;
name|metaStartDocument
argument_list|(
name|parser
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'c'
case|:
name|XML_UseParserAsHandlerArg
argument_list|(
name|parser
argument_list|)
expr_stmt|;
name|XML_SetDefaultHandler
argument_list|(
name|parser
argument_list|,
name|markup
argument_list|)
expr_stmt|;
name|XML_SetElementHandler
argument_list|(
name|parser
argument_list|,
name|defaultStartElement
argument_list|,
name|defaultEndElement
argument_list|)
expr_stmt|;
name|XML_SetCharacterDataHandler
argument_list|(
name|parser
argument_list|,
name|defaultCharacterData
argument_list|)
expr_stmt|;
name|XML_SetProcessingInstructionHandler
argument_list|(
name|parser
argument_list|,
name|defaultProcessingInstruction
argument_list|)
expr_stmt|;
break|break;
default|default:
if|if
condition|(
name|useNamespaces
condition|)
name|XML_SetElementHandler
argument_list|(
name|parser
argument_list|,
name|startElementNS
argument_list|,
name|endElementNS
argument_list|)
expr_stmt|;
else|else
name|XML_SetElementHandler
argument_list|(
name|parser
argument_list|,
name|startElement
argument_list|,
name|endElement
argument_list|)
expr_stmt|;
name|XML_SetCharacterDataHandler
argument_list|(
name|parser
argument_list|,
name|characterData
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|W3C14N
name|XML_SetProcessingInstructionHandler
argument_list|(
name|parser
argument_list|,
name|processingInstruction
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* not W3C14N */
break|break;
block|}
block|}
if|if
condition|(
name|windowsCodePages
condition|)
name|XML_SetUnknownEncodingHandler
argument_list|(
name|parser
argument_list|,
name|unknownEncoding
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|result
operator|=
name|XML_ProcessFile
argument_list|(
name|parser
argument_list|,
name|useStdin
condition|?
name|NULL
else|:
name|argv
index|[
name|i
index|]
argument_list|,
name|processFlags
argument_list|)
expr_stmt|;
if|if
condition|(
name|outputDir
condition|)
block|{
if|if
condition|(
name|outputType
operator|==
literal|'m'
condition|)
name|metaEndDocument
argument_list|(
name|parser
argument_list|)
expr_stmt|;
name|fclose
argument_list|(
name|fp
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|result
condition|)
block|{
name|tremove
argument_list|(
name|outName
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|2
argument_list|)
expr_stmt|;
block|}
name|free
argument_list|(
name|outName
argument_list|)
expr_stmt|;
block|}
name|XML_ParserFree
argument_list|(
name|parser
argument_list|)
expr_stmt|;
block|}
return|return
literal|0
return|;
block|}
end_function

end_unit

