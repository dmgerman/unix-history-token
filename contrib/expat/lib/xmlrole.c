begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* Copyright (c) 1998, 1999 Thai Open Source Software Center Ltd    See the file COPYING for copying permission. */
end_comment

begin_include
include|#
directive|include
file|<stddef.h>
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|WIN32
end_ifdef

begin_include
include|#
directive|include
file|"winconfig.h"
end_include

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|MACOS_CLASSIC
argument_list|)
end_elif

begin_include
include|#
directive|include
file|"macconfig.h"
end_include

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|__amigaos__
argument_list|)
end_elif

begin_include
include|#
directive|include
file|"amigaconfig.h"
end_include

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|__WATCOMC__
argument_list|)
end_elif

begin_include
include|#
directive|include
file|"watcomconfig.h"
end_include

begin_else
else|#
directive|else
end_else

begin_ifdef
ifdef|#
directive|ifdef
name|HAVE_EXPAT_CONFIG_H
end_ifdef

begin_include
include|#
directive|include
file|<expat_config.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* ndef WIN32 */
end_comment

begin_include
include|#
directive|include
file|"expat_external.h"
end_include

begin_include
include|#
directive|include
file|"internal.h"
end_include

begin_include
include|#
directive|include
file|"xmlrole.h"
end_include

begin_include
include|#
directive|include
file|"ascii.h"
end_include

begin_comment
comment|/* Doesn't check:   that ,| are not mixed in a model group  content of literals  */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_ANY
index|[]
init|=
block|{
name|ASCII_A
block|,
name|ASCII_N
block|,
name|ASCII_Y
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_ATTLIST
index|[]
init|=
block|{
name|ASCII_A
block|,
name|ASCII_T
block|,
name|ASCII_T
block|,
name|ASCII_L
block|,
name|ASCII_I
block|,
name|ASCII_S
block|,
name|ASCII_T
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_CDATA
index|[]
init|=
block|{
name|ASCII_C
block|,
name|ASCII_D
block|,
name|ASCII_A
block|,
name|ASCII_T
block|,
name|ASCII_A
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_DOCTYPE
index|[]
init|=
block|{
name|ASCII_D
block|,
name|ASCII_O
block|,
name|ASCII_C
block|,
name|ASCII_T
block|,
name|ASCII_Y
block|,
name|ASCII_P
block|,
name|ASCII_E
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_ELEMENT
index|[]
init|=
block|{
name|ASCII_E
block|,
name|ASCII_L
block|,
name|ASCII_E
block|,
name|ASCII_M
block|,
name|ASCII_E
block|,
name|ASCII_N
block|,
name|ASCII_T
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_EMPTY
index|[]
init|=
block|{
name|ASCII_E
block|,
name|ASCII_M
block|,
name|ASCII_P
block|,
name|ASCII_T
block|,
name|ASCII_Y
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_ENTITIES
index|[]
init|=
block|{
name|ASCII_E
block|,
name|ASCII_N
block|,
name|ASCII_T
block|,
name|ASCII_I
block|,
name|ASCII_T
block|,
name|ASCII_I
block|,
name|ASCII_E
block|,
name|ASCII_S
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_ENTITY
index|[]
init|=
block|{
name|ASCII_E
block|,
name|ASCII_N
block|,
name|ASCII_T
block|,
name|ASCII_I
block|,
name|ASCII_T
block|,
name|ASCII_Y
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_FIXED
index|[]
init|=
block|{
name|ASCII_F
block|,
name|ASCII_I
block|,
name|ASCII_X
block|,
name|ASCII_E
block|,
name|ASCII_D
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_ID
index|[]
init|=
block|{
name|ASCII_I
block|,
name|ASCII_D
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_IDREF
index|[]
init|=
block|{
name|ASCII_I
block|,
name|ASCII_D
block|,
name|ASCII_R
block|,
name|ASCII_E
block|,
name|ASCII_F
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_IDREFS
index|[]
init|=
block|{
name|ASCII_I
block|,
name|ASCII_D
block|,
name|ASCII_R
block|,
name|ASCII_E
block|,
name|ASCII_F
block|,
name|ASCII_S
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|XML_DTD
end_ifdef

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_IGNORE
index|[]
init|=
block|{
name|ASCII_I
block|,
name|ASCII_G
block|,
name|ASCII_N
block|,
name|ASCII_O
block|,
name|ASCII_R
block|,
name|ASCII_E
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_IMPLIED
index|[]
init|=
block|{
name|ASCII_I
block|,
name|ASCII_M
block|,
name|ASCII_P
block|,
name|ASCII_L
block|,
name|ASCII_I
block|,
name|ASCII_E
block|,
name|ASCII_D
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|XML_DTD
end_ifdef

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_INCLUDE
index|[]
init|=
block|{
name|ASCII_I
block|,
name|ASCII_N
block|,
name|ASCII_C
block|,
name|ASCII_L
block|,
name|ASCII_U
block|,
name|ASCII_D
block|,
name|ASCII_E
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_NDATA
index|[]
init|=
block|{
name|ASCII_N
block|,
name|ASCII_D
block|,
name|ASCII_A
block|,
name|ASCII_T
block|,
name|ASCII_A
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_NMTOKEN
index|[]
init|=
block|{
name|ASCII_N
block|,
name|ASCII_M
block|,
name|ASCII_T
block|,
name|ASCII_O
block|,
name|ASCII_K
block|,
name|ASCII_E
block|,
name|ASCII_N
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_NMTOKENS
index|[]
init|=
block|{
name|ASCII_N
block|,
name|ASCII_M
block|,
name|ASCII_T
block|,
name|ASCII_O
block|,
name|ASCII_K
block|,
name|ASCII_E
block|,
name|ASCII_N
block|,
name|ASCII_S
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_NOTATION
index|[]
init|=
block|{
name|ASCII_N
block|,
name|ASCII_O
block|,
name|ASCII_T
block|,
name|ASCII_A
block|,
name|ASCII_T
block|,
name|ASCII_I
block|,
name|ASCII_O
block|,
name|ASCII_N
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_PCDATA
index|[]
init|=
block|{
name|ASCII_P
block|,
name|ASCII_C
block|,
name|ASCII_D
block|,
name|ASCII_A
block|,
name|ASCII_T
block|,
name|ASCII_A
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_PUBLIC
index|[]
init|=
block|{
name|ASCII_P
block|,
name|ASCII_U
block|,
name|ASCII_B
block|,
name|ASCII_L
block|,
name|ASCII_I
block|,
name|ASCII_C
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_REQUIRED
index|[]
init|=
block|{
name|ASCII_R
block|,
name|ASCII_E
block|,
name|ASCII_Q
block|,
name|ASCII_U
block|,
name|ASCII_I
block|,
name|ASCII_R
block|,
name|ASCII_E
block|,
name|ASCII_D
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|KW_SYSTEM
index|[]
init|=
block|{
name|ASCII_S
block|,
name|ASCII_Y
block|,
name|ASCII_S
block|,
name|ASCII_T
block|,
name|ASCII_E
block|,
name|ASCII_M
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_ifndef
ifndef|#
directive|ifndef
name|MIN_BYTES_PER_CHAR
end_ifndef

begin_define
define|#
directive|define
name|MIN_BYTES_PER_CHAR
parameter_list|(
name|enc
parameter_list|)
value|((enc)->minBytesPerChar)
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_ifdef
ifdef|#
directive|ifdef
name|XML_DTD
end_ifdef

begin_define
define|#
directive|define
name|setTopLevel
parameter_list|(
name|state
parameter_list|)
define|\
value|((state)->handler = ((state)->documentEntity \                        ? internalSubset \                        : externalSubset1))
end_define

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* not XML_DTD */
end_comment

begin_define
define|#
directive|define
name|setTopLevel
parameter_list|(
name|state
parameter_list|)
value|((state)->handler = internalSubset)
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* not XML_DTD */
end_comment

begin_typedef
typedef|typedef
name|int
name|PTRCALL
name|PROLOG_HANDLER
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|ptr
parameter_list|,
specifier|const
name|char
modifier|*
name|end
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|enc
parameter_list|)
function_decl|;
end_typedef

begin_decl_stmt
specifier|static
name|PROLOG_HANDLER
name|prolog0
decl_stmt|,
name|prolog1
decl_stmt|,
name|prolog2
decl_stmt|,
name|doctype0
decl_stmt|,
name|doctype1
decl_stmt|,
name|doctype2
decl_stmt|,
name|doctype3
decl_stmt|,
name|doctype4
decl_stmt|,
name|doctype5
decl_stmt|,
name|internalSubset
decl_stmt|,
name|entity0
decl_stmt|,
name|entity1
decl_stmt|,
name|entity2
decl_stmt|,
name|entity3
decl_stmt|,
name|entity4
decl_stmt|,
name|entity5
decl_stmt|,
name|entity6
decl_stmt|,
name|entity7
decl_stmt|,
name|entity8
decl_stmt|,
name|entity9
decl_stmt|,
name|entity10
decl_stmt|,
name|notation0
decl_stmt|,
name|notation1
decl_stmt|,
name|notation2
decl_stmt|,
name|notation3
decl_stmt|,
name|notation4
decl_stmt|,
name|attlist0
decl_stmt|,
name|attlist1
decl_stmt|,
name|attlist2
decl_stmt|,
name|attlist3
decl_stmt|,
name|attlist4
decl_stmt|,
name|attlist5
decl_stmt|,
name|attlist6
decl_stmt|,
name|attlist7
decl_stmt|,
name|attlist8
decl_stmt|,
name|attlist9
decl_stmt|,
name|element0
decl_stmt|,
name|element1
decl_stmt|,
name|element2
decl_stmt|,
name|element3
decl_stmt|,
name|element4
decl_stmt|,
name|element5
decl_stmt|,
name|element6
decl_stmt|,
name|element7
decl_stmt|,
ifdef|#
directive|ifdef
name|XML_DTD
name|externalSubset0
decl_stmt|,
name|externalSubset1
decl_stmt|,
name|condSect0
decl_stmt|,
name|condSect1
decl_stmt|,
name|condSect2
decl_stmt|,
endif|#
directive|endif
comment|/* XML_DTD */
name|declClose
decl_stmt|,
name|error
decl_stmt|;
end_decl_stmt

begin_function_decl
specifier|static
name|int
name|FASTCALL
name|common
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|)
function_decl|;
end_function_decl

begin_function
specifier|static
name|int
name|PTRCALL
name|prolog0
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|ptr
parameter_list|,
specifier|const
name|char
modifier|*
name|end
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|enc
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
name|state
operator|->
name|handler
operator|=
name|prolog1
expr_stmt|;
return|return
name|XML_ROLE_NONE
return|;
case|case
name|XML_TOK_XML_DECL
case|:
name|state
operator|->
name|handler
operator|=
name|prolog1
expr_stmt|;
return|return
name|XML_ROLE_XML_DECL
return|;
case|case
name|XML_TOK_PI
case|:
name|state
operator|->
name|handler
operator|=
name|prolog1
expr_stmt|;
return|return
name|XML_ROLE_PI
return|;
case|case
name|XML_TOK_COMMENT
case|:
name|state
operator|->
name|handler
operator|=
name|prolog1
expr_stmt|;
return|return
name|XML_ROLE_COMMENT
return|;
case|case
name|XML_TOK_BOM
case|:
return|return
name|XML_ROLE_NONE
return|;
case|case
name|XML_TOK_DECL_OPEN
case|:
if|if
condition|(
operator|!
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
operator|+
literal|2
operator|*
name|MIN_BYTES_PER_CHAR
argument_list|(
name|enc
argument_list|)
argument_list|,
name|end
argument_list|,
name|KW_DOCTYPE
argument_list|)
condition|)
break|break;
name|state
operator|->
name|handler
operator|=
name|doctype0
expr_stmt|;
return|return
name|XML_ROLE_DOCTYPE_NONE
return|;
case|case
name|XML_TOK_INSTANCE_START
case|:
name|state
operator|->
name|handler
operator|=
name|error
expr_stmt|;
return|return
name|XML_ROLE_INSTANCE_START
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|prolog1
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|ptr
parameter_list|,
specifier|const
name|char
modifier|*
name|end
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|enc
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_NONE
return|;
case|case
name|XML_TOK_PI
case|:
return|return
name|XML_ROLE_PI
return|;
case|case
name|XML_TOK_COMMENT
case|:
return|return
name|XML_ROLE_COMMENT
return|;
case|case
name|XML_TOK_BOM
case|:
return|return
name|XML_ROLE_NONE
return|;
case|case
name|XML_TOK_DECL_OPEN
case|:
if|if
condition|(
operator|!
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
operator|+
literal|2
operator|*
name|MIN_BYTES_PER_CHAR
argument_list|(
name|enc
argument_list|)
argument_list|,
name|end
argument_list|,
name|KW_DOCTYPE
argument_list|)
condition|)
break|break;
name|state
operator|->
name|handler
operator|=
name|doctype0
expr_stmt|;
return|return
name|XML_ROLE_DOCTYPE_NONE
return|;
case|case
name|XML_TOK_INSTANCE_START
case|:
name|state
operator|->
name|handler
operator|=
name|error
expr_stmt|;
return|return
name|XML_ROLE_INSTANCE_START
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|prolog2
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_NONE
return|;
case|case
name|XML_TOK_PI
case|:
return|return
name|XML_ROLE_PI
return|;
case|case
name|XML_TOK_COMMENT
case|:
return|return
name|XML_ROLE_COMMENT
return|;
case|case
name|XML_TOK_INSTANCE_START
case|:
name|state
operator|->
name|handler
operator|=
name|error
expr_stmt|;
return|return
name|XML_ROLE_INSTANCE_START
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|doctype0
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_DOCTYPE_NONE
return|;
case|case
name|XML_TOK_NAME
case|:
case|case
name|XML_TOK_PREFIXED_NAME
case|:
name|state
operator|->
name|handler
operator|=
name|doctype1
expr_stmt|;
return|return
name|XML_ROLE_DOCTYPE_NAME
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|doctype1
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|ptr
parameter_list|,
specifier|const
name|char
modifier|*
name|end
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|enc
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_DOCTYPE_NONE
return|;
case|case
name|XML_TOK_OPEN_BRACKET
case|:
name|state
operator|->
name|handler
operator|=
name|internalSubset
expr_stmt|;
return|return
name|XML_ROLE_DOCTYPE_INTERNAL_SUBSET
return|;
case|case
name|XML_TOK_DECL_CLOSE
case|:
name|state
operator|->
name|handler
operator|=
name|prolog2
expr_stmt|;
return|return
name|XML_ROLE_DOCTYPE_CLOSE
return|;
case|case
name|XML_TOK_NAME
case|:
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
argument_list|,
name|end
argument_list|,
name|KW_SYSTEM
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|doctype3
expr_stmt|;
return|return
name|XML_ROLE_DOCTYPE_NONE
return|;
block|}
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
argument_list|,
name|end
argument_list|,
name|KW_PUBLIC
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|doctype2
expr_stmt|;
return|return
name|XML_ROLE_DOCTYPE_NONE
return|;
block|}
break|break;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|doctype2
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_DOCTYPE_NONE
return|;
case|case
name|XML_TOK_LITERAL
case|:
name|state
operator|->
name|handler
operator|=
name|doctype3
expr_stmt|;
return|return
name|XML_ROLE_DOCTYPE_PUBLIC_ID
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|doctype3
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_DOCTYPE_NONE
return|;
case|case
name|XML_TOK_LITERAL
case|:
name|state
operator|->
name|handler
operator|=
name|doctype4
expr_stmt|;
return|return
name|XML_ROLE_DOCTYPE_SYSTEM_ID
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|doctype4
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_DOCTYPE_NONE
return|;
case|case
name|XML_TOK_OPEN_BRACKET
case|:
name|state
operator|->
name|handler
operator|=
name|internalSubset
expr_stmt|;
return|return
name|XML_ROLE_DOCTYPE_INTERNAL_SUBSET
return|;
case|case
name|XML_TOK_DECL_CLOSE
case|:
name|state
operator|->
name|handler
operator|=
name|prolog2
expr_stmt|;
return|return
name|XML_ROLE_DOCTYPE_CLOSE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|doctype5
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_DOCTYPE_NONE
return|;
case|case
name|XML_TOK_DECL_CLOSE
case|:
name|state
operator|->
name|handler
operator|=
name|prolog2
expr_stmt|;
return|return
name|XML_ROLE_DOCTYPE_CLOSE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|internalSubset
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|ptr
parameter_list|,
specifier|const
name|char
modifier|*
name|end
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|enc
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_NONE
return|;
case|case
name|XML_TOK_DECL_OPEN
case|:
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
operator|+
literal|2
operator|*
name|MIN_BYTES_PER_CHAR
argument_list|(
name|enc
argument_list|)
argument_list|,
name|end
argument_list|,
name|KW_ENTITY
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|entity0
expr_stmt|;
return|return
name|XML_ROLE_ENTITY_NONE
return|;
block|}
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
operator|+
literal|2
operator|*
name|MIN_BYTES_PER_CHAR
argument_list|(
name|enc
argument_list|)
argument_list|,
name|end
argument_list|,
name|KW_ATTLIST
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|attlist0
expr_stmt|;
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
block|}
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
operator|+
literal|2
operator|*
name|MIN_BYTES_PER_CHAR
argument_list|(
name|enc
argument_list|)
argument_list|,
name|end
argument_list|,
name|KW_ELEMENT
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|element0
expr_stmt|;
return|return
name|XML_ROLE_ELEMENT_NONE
return|;
block|}
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
operator|+
literal|2
operator|*
name|MIN_BYTES_PER_CHAR
argument_list|(
name|enc
argument_list|)
argument_list|,
name|end
argument_list|,
name|KW_NOTATION
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|notation0
expr_stmt|;
return|return
name|XML_ROLE_NOTATION_NONE
return|;
block|}
break|break;
case|case
name|XML_TOK_PI
case|:
return|return
name|XML_ROLE_PI
return|;
case|case
name|XML_TOK_COMMENT
case|:
return|return
name|XML_ROLE_COMMENT
return|;
case|case
name|XML_TOK_PARAM_ENTITY_REF
case|:
return|return
name|XML_ROLE_PARAM_ENTITY_REF
return|;
case|case
name|XML_TOK_CLOSE_BRACKET
case|:
name|state
operator|->
name|handler
operator|=
name|doctype5
expr_stmt|;
return|return
name|XML_ROLE_DOCTYPE_NONE
return|;
case|case
name|XML_TOK_NONE
case|:
return|return
name|XML_ROLE_NONE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|XML_DTD
end_ifdef

begin_function
specifier|static
name|int
name|PTRCALL
name|externalSubset0
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|ptr
parameter_list|,
specifier|const
name|char
modifier|*
name|end
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|enc
parameter_list|)
block|{
name|state
operator|->
name|handler
operator|=
name|externalSubset1
expr_stmt|;
if|if
condition|(
name|tok
operator|==
name|XML_TOK_XML_DECL
condition|)
return|return
name|XML_ROLE_TEXT_DECL
return|;
return|return
name|externalSubset1
argument_list|(
name|state
argument_list|,
name|tok
argument_list|,
name|ptr
argument_list|,
name|end
argument_list|,
name|enc
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|externalSubset1
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|ptr
parameter_list|,
specifier|const
name|char
modifier|*
name|end
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|enc
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_COND_SECT_OPEN
case|:
name|state
operator|->
name|handler
operator|=
name|condSect0
expr_stmt|;
return|return
name|XML_ROLE_NONE
return|;
case|case
name|XML_TOK_COND_SECT_CLOSE
case|:
if|if
condition|(
name|state
operator|->
name|includeLevel
operator|==
literal|0
condition|)
break|break;
name|state
operator|->
name|includeLevel
operator|-=
literal|1
expr_stmt|;
return|return
name|XML_ROLE_NONE
return|;
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_NONE
return|;
case|case
name|XML_TOK_CLOSE_BRACKET
case|:
break|break;
case|case
name|XML_TOK_NONE
case|:
if|if
condition|(
name|state
operator|->
name|includeLevel
condition|)
break|break;
return|return
name|XML_ROLE_NONE
return|;
default|default:
return|return
name|internalSubset
argument_list|(
name|state
argument_list|,
name|tok
argument_list|,
name|ptr
argument_list|,
name|end
argument_list|,
name|enc
argument_list|)
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* XML_DTD */
end_comment

begin_function
specifier|static
name|int
name|PTRCALL
name|entity0
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ENTITY_NONE
return|;
case|case
name|XML_TOK_PERCENT
case|:
name|state
operator|->
name|handler
operator|=
name|entity1
expr_stmt|;
return|return
name|XML_ROLE_ENTITY_NONE
return|;
case|case
name|XML_TOK_NAME
case|:
name|state
operator|->
name|handler
operator|=
name|entity2
expr_stmt|;
return|return
name|XML_ROLE_GENERAL_ENTITY_NAME
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|entity1
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ENTITY_NONE
return|;
case|case
name|XML_TOK_NAME
case|:
name|state
operator|->
name|handler
operator|=
name|entity7
expr_stmt|;
return|return
name|XML_ROLE_PARAM_ENTITY_NAME
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|entity2
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|ptr
parameter_list|,
specifier|const
name|char
modifier|*
name|end
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|enc
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ENTITY_NONE
return|;
case|case
name|XML_TOK_NAME
case|:
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
argument_list|,
name|end
argument_list|,
name|KW_SYSTEM
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|entity4
expr_stmt|;
return|return
name|XML_ROLE_ENTITY_NONE
return|;
block|}
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
argument_list|,
name|end
argument_list|,
name|KW_PUBLIC
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|entity3
expr_stmt|;
return|return
name|XML_ROLE_ENTITY_NONE
return|;
block|}
break|break;
case|case
name|XML_TOK_LITERAL
case|:
name|state
operator|->
name|handler
operator|=
name|declClose
expr_stmt|;
name|state
operator|->
name|role_none
operator|=
name|XML_ROLE_ENTITY_NONE
expr_stmt|;
return|return
name|XML_ROLE_ENTITY_VALUE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|entity3
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ENTITY_NONE
return|;
case|case
name|XML_TOK_LITERAL
case|:
name|state
operator|->
name|handler
operator|=
name|entity4
expr_stmt|;
return|return
name|XML_ROLE_ENTITY_PUBLIC_ID
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|entity4
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ENTITY_NONE
return|;
case|case
name|XML_TOK_LITERAL
case|:
name|state
operator|->
name|handler
operator|=
name|entity5
expr_stmt|;
return|return
name|XML_ROLE_ENTITY_SYSTEM_ID
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|entity5
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|ptr
parameter_list|,
specifier|const
name|char
modifier|*
name|end
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|enc
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ENTITY_NONE
return|;
case|case
name|XML_TOK_DECL_CLOSE
case|:
name|setTopLevel
argument_list|(
name|state
argument_list|)
expr_stmt|;
return|return
name|XML_ROLE_ENTITY_COMPLETE
return|;
case|case
name|XML_TOK_NAME
case|:
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
argument_list|,
name|end
argument_list|,
name|KW_NDATA
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|entity6
expr_stmt|;
return|return
name|XML_ROLE_ENTITY_NONE
return|;
block|}
break|break;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|entity6
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ENTITY_NONE
return|;
case|case
name|XML_TOK_NAME
case|:
name|state
operator|->
name|handler
operator|=
name|declClose
expr_stmt|;
name|state
operator|->
name|role_none
operator|=
name|XML_ROLE_ENTITY_NONE
expr_stmt|;
return|return
name|XML_ROLE_ENTITY_NOTATION_NAME
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|entity7
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|ptr
parameter_list|,
specifier|const
name|char
modifier|*
name|end
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|enc
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ENTITY_NONE
return|;
case|case
name|XML_TOK_NAME
case|:
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
argument_list|,
name|end
argument_list|,
name|KW_SYSTEM
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|entity9
expr_stmt|;
return|return
name|XML_ROLE_ENTITY_NONE
return|;
block|}
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
argument_list|,
name|end
argument_list|,
name|KW_PUBLIC
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|entity8
expr_stmt|;
return|return
name|XML_ROLE_ENTITY_NONE
return|;
block|}
break|break;
case|case
name|XML_TOK_LITERAL
case|:
name|state
operator|->
name|handler
operator|=
name|declClose
expr_stmt|;
name|state
operator|->
name|role_none
operator|=
name|XML_ROLE_ENTITY_NONE
expr_stmt|;
return|return
name|XML_ROLE_ENTITY_VALUE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|entity8
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ENTITY_NONE
return|;
case|case
name|XML_TOK_LITERAL
case|:
name|state
operator|->
name|handler
operator|=
name|entity9
expr_stmt|;
return|return
name|XML_ROLE_ENTITY_PUBLIC_ID
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|entity9
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ENTITY_NONE
return|;
case|case
name|XML_TOK_LITERAL
case|:
name|state
operator|->
name|handler
operator|=
name|entity10
expr_stmt|;
return|return
name|XML_ROLE_ENTITY_SYSTEM_ID
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|entity10
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ENTITY_NONE
return|;
case|case
name|XML_TOK_DECL_CLOSE
case|:
name|setTopLevel
argument_list|(
name|state
argument_list|)
expr_stmt|;
return|return
name|XML_ROLE_ENTITY_COMPLETE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|notation0
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_NOTATION_NONE
return|;
case|case
name|XML_TOK_NAME
case|:
name|state
operator|->
name|handler
operator|=
name|notation1
expr_stmt|;
return|return
name|XML_ROLE_NOTATION_NAME
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|notation1
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|ptr
parameter_list|,
specifier|const
name|char
modifier|*
name|end
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|enc
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_NOTATION_NONE
return|;
case|case
name|XML_TOK_NAME
case|:
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
argument_list|,
name|end
argument_list|,
name|KW_SYSTEM
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|notation3
expr_stmt|;
return|return
name|XML_ROLE_NOTATION_NONE
return|;
block|}
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
argument_list|,
name|end
argument_list|,
name|KW_PUBLIC
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|notation2
expr_stmt|;
return|return
name|XML_ROLE_NOTATION_NONE
return|;
block|}
break|break;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|notation2
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_NOTATION_NONE
return|;
case|case
name|XML_TOK_LITERAL
case|:
name|state
operator|->
name|handler
operator|=
name|notation4
expr_stmt|;
return|return
name|XML_ROLE_NOTATION_PUBLIC_ID
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|notation3
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_NOTATION_NONE
return|;
case|case
name|XML_TOK_LITERAL
case|:
name|state
operator|->
name|handler
operator|=
name|declClose
expr_stmt|;
name|state
operator|->
name|role_none
operator|=
name|XML_ROLE_NOTATION_NONE
expr_stmt|;
return|return
name|XML_ROLE_NOTATION_SYSTEM_ID
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|notation4
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_NOTATION_NONE
return|;
case|case
name|XML_TOK_LITERAL
case|:
name|state
operator|->
name|handler
operator|=
name|declClose
expr_stmt|;
name|state
operator|->
name|role_none
operator|=
name|XML_ROLE_NOTATION_NONE
expr_stmt|;
return|return
name|XML_ROLE_NOTATION_SYSTEM_ID
return|;
case|case
name|XML_TOK_DECL_CLOSE
case|:
name|setTopLevel
argument_list|(
name|state
argument_list|)
expr_stmt|;
return|return
name|XML_ROLE_NOTATION_NO_SYSTEM_ID
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|attlist0
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
case|case
name|XML_TOK_NAME
case|:
case|case
name|XML_TOK_PREFIXED_NAME
case|:
name|state
operator|->
name|handler
operator|=
name|attlist1
expr_stmt|;
return|return
name|XML_ROLE_ATTLIST_ELEMENT_NAME
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|attlist1
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
case|case
name|XML_TOK_DECL_CLOSE
case|:
name|setTopLevel
argument_list|(
name|state
argument_list|)
expr_stmt|;
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
case|case
name|XML_TOK_NAME
case|:
case|case
name|XML_TOK_PREFIXED_NAME
case|:
name|state
operator|->
name|handler
operator|=
name|attlist2
expr_stmt|;
return|return
name|XML_ROLE_ATTRIBUTE_NAME
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|attlist2
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|ptr
parameter_list|,
specifier|const
name|char
modifier|*
name|end
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|enc
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
case|case
name|XML_TOK_NAME
case|:
block|{
specifier|static
specifier|const
name|char
modifier|*
specifier|const
name|types
index|[]
init|=
block|{
name|KW_CDATA
block|,
name|KW_ID
block|,
name|KW_IDREF
block|,
name|KW_IDREFS
block|,
name|KW_ENTITY
block|,
name|KW_ENTITIES
block|,
name|KW_NMTOKEN
block|,
name|KW_NMTOKENS
block|,       }
decl_stmt|;
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
call|(
name|int
call|)
argument_list|(
sizeof|sizeof
argument_list|(
name|types
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|types
index|[
literal|0
index|]
argument_list|)
argument_list|)
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
argument_list|,
name|end
argument_list|,
name|types
index|[
name|i
index|]
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|attlist8
expr_stmt|;
return|return
name|XML_ROLE_ATTRIBUTE_TYPE_CDATA
operator|+
name|i
return|;
block|}
block|}
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
argument_list|,
name|end
argument_list|,
name|KW_NOTATION
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|attlist5
expr_stmt|;
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
block|}
break|break;
case|case
name|XML_TOK_OPEN_PAREN
case|:
name|state
operator|->
name|handler
operator|=
name|attlist3
expr_stmt|;
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|attlist3
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
case|case
name|XML_TOK_NMTOKEN
case|:
case|case
name|XML_TOK_NAME
case|:
case|case
name|XML_TOK_PREFIXED_NAME
case|:
name|state
operator|->
name|handler
operator|=
name|attlist4
expr_stmt|;
return|return
name|XML_ROLE_ATTRIBUTE_ENUM_VALUE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|attlist4
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
case|case
name|XML_TOK_CLOSE_PAREN
case|:
name|state
operator|->
name|handler
operator|=
name|attlist8
expr_stmt|;
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
case|case
name|XML_TOK_OR
case|:
name|state
operator|->
name|handler
operator|=
name|attlist3
expr_stmt|;
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|attlist5
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
case|case
name|XML_TOK_OPEN_PAREN
case|:
name|state
operator|->
name|handler
operator|=
name|attlist6
expr_stmt|;
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|attlist6
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
case|case
name|XML_TOK_NAME
case|:
name|state
operator|->
name|handler
operator|=
name|attlist7
expr_stmt|;
return|return
name|XML_ROLE_ATTRIBUTE_NOTATION_VALUE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|attlist7
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
case|case
name|XML_TOK_CLOSE_PAREN
case|:
name|state
operator|->
name|handler
operator|=
name|attlist8
expr_stmt|;
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
case|case
name|XML_TOK_OR
case|:
name|state
operator|->
name|handler
operator|=
name|attlist6
expr_stmt|;
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/* default value */
end_comment

begin_function
specifier|static
name|int
name|PTRCALL
name|attlist8
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|ptr
parameter_list|,
specifier|const
name|char
modifier|*
name|end
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|enc
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
case|case
name|XML_TOK_POUND_NAME
case|:
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
operator|+
name|MIN_BYTES_PER_CHAR
argument_list|(
name|enc
argument_list|)
argument_list|,
name|end
argument_list|,
name|KW_IMPLIED
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|attlist1
expr_stmt|;
return|return
name|XML_ROLE_IMPLIED_ATTRIBUTE_VALUE
return|;
block|}
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
operator|+
name|MIN_BYTES_PER_CHAR
argument_list|(
name|enc
argument_list|)
argument_list|,
name|end
argument_list|,
name|KW_REQUIRED
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|attlist1
expr_stmt|;
return|return
name|XML_ROLE_REQUIRED_ATTRIBUTE_VALUE
return|;
block|}
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
operator|+
name|MIN_BYTES_PER_CHAR
argument_list|(
name|enc
argument_list|)
argument_list|,
name|end
argument_list|,
name|KW_FIXED
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|attlist9
expr_stmt|;
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
block|}
break|break;
case|case
name|XML_TOK_LITERAL
case|:
name|state
operator|->
name|handler
operator|=
name|attlist1
expr_stmt|;
return|return
name|XML_ROLE_DEFAULT_ATTRIBUTE_VALUE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|attlist9
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ATTLIST_NONE
return|;
case|case
name|XML_TOK_LITERAL
case|:
name|state
operator|->
name|handler
operator|=
name|attlist1
expr_stmt|;
return|return
name|XML_ROLE_FIXED_ATTRIBUTE_VALUE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|element0
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ELEMENT_NONE
return|;
case|case
name|XML_TOK_NAME
case|:
case|case
name|XML_TOK_PREFIXED_NAME
case|:
name|state
operator|->
name|handler
operator|=
name|element1
expr_stmt|;
return|return
name|XML_ROLE_ELEMENT_NAME
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|element1
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|ptr
parameter_list|,
specifier|const
name|char
modifier|*
name|end
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|enc
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ELEMENT_NONE
return|;
case|case
name|XML_TOK_NAME
case|:
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
argument_list|,
name|end
argument_list|,
name|KW_EMPTY
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|declClose
expr_stmt|;
name|state
operator|->
name|role_none
operator|=
name|XML_ROLE_ELEMENT_NONE
expr_stmt|;
return|return
name|XML_ROLE_CONTENT_EMPTY
return|;
block|}
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
argument_list|,
name|end
argument_list|,
name|KW_ANY
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|declClose
expr_stmt|;
name|state
operator|->
name|role_none
operator|=
name|XML_ROLE_ELEMENT_NONE
expr_stmt|;
return|return
name|XML_ROLE_CONTENT_ANY
return|;
block|}
break|break;
case|case
name|XML_TOK_OPEN_PAREN
case|:
name|state
operator|->
name|handler
operator|=
name|element2
expr_stmt|;
name|state
operator|->
name|level
operator|=
literal|1
expr_stmt|;
return|return
name|XML_ROLE_GROUP_OPEN
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|element2
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|ptr
parameter_list|,
specifier|const
name|char
modifier|*
name|end
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|enc
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ELEMENT_NONE
return|;
case|case
name|XML_TOK_POUND_NAME
case|:
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
operator|+
name|MIN_BYTES_PER_CHAR
argument_list|(
name|enc
argument_list|)
argument_list|,
name|end
argument_list|,
name|KW_PCDATA
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|element3
expr_stmt|;
return|return
name|XML_ROLE_CONTENT_PCDATA
return|;
block|}
break|break;
case|case
name|XML_TOK_OPEN_PAREN
case|:
name|state
operator|->
name|level
operator|=
literal|2
expr_stmt|;
name|state
operator|->
name|handler
operator|=
name|element6
expr_stmt|;
return|return
name|XML_ROLE_GROUP_OPEN
return|;
case|case
name|XML_TOK_NAME
case|:
case|case
name|XML_TOK_PREFIXED_NAME
case|:
name|state
operator|->
name|handler
operator|=
name|element7
expr_stmt|;
return|return
name|XML_ROLE_CONTENT_ELEMENT
return|;
case|case
name|XML_TOK_NAME_QUESTION
case|:
name|state
operator|->
name|handler
operator|=
name|element7
expr_stmt|;
return|return
name|XML_ROLE_CONTENT_ELEMENT_OPT
return|;
case|case
name|XML_TOK_NAME_ASTERISK
case|:
name|state
operator|->
name|handler
operator|=
name|element7
expr_stmt|;
return|return
name|XML_ROLE_CONTENT_ELEMENT_REP
return|;
case|case
name|XML_TOK_NAME_PLUS
case|:
name|state
operator|->
name|handler
operator|=
name|element7
expr_stmt|;
return|return
name|XML_ROLE_CONTENT_ELEMENT_PLUS
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|element3
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ELEMENT_NONE
return|;
case|case
name|XML_TOK_CLOSE_PAREN
case|:
name|state
operator|->
name|handler
operator|=
name|declClose
expr_stmt|;
name|state
operator|->
name|role_none
operator|=
name|XML_ROLE_ELEMENT_NONE
expr_stmt|;
return|return
name|XML_ROLE_GROUP_CLOSE
return|;
case|case
name|XML_TOK_CLOSE_PAREN_ASTERISK
case|:
name|state
operator|->
name|handler
operator|=
name|declClose
expr_stmt|;
name|state
operator|->
name|role_none
operator|=
name|XML_ROLE_ELEMENT_NONE
expr_stmt|;
return|return
name|XML_ROLE_GROUP_CLOSE_REP
return|;
case|case
name|XML_TOK_OR
case|:
name|state
operator|->
name|handler
operator|=
name|element4
expr_stmt|;
return|return
name|XML_ROLE_ELEMENT_NONE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|element4
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ELEMENT_NONE
return|;
case|case
name|XML_TOK_NAME
case|:
case|case
name|XML_TOK_PREFIXED_NAME
case|:
name|state
operator|->
name|handler
operator|=
name|element5
expr_stmt|;
return|return
name|XML_ROLE_CONTENT_ELEMENT
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|element5
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ELEMENT_NONE
return|;
case|case
name|XML_TOK_CLOSE_PAREN_ASTERISK
case|:
name|state
operator|->
name|handler
operator|=
name|declClose
expr_stmt|;
name|state
operator|->
name|role_none
operator|=
name|XML_ROLE_ELEMENT_NONE
expr_stmt|;
return|return
name|XML_ROLE_GROUP_CLOSE_REP
return|;
case|case
name|XML_TOK_OR
case|:
name|state
operator|->
name|handler
operator|=
name|element4
expr_stmt|;
return|return
name|XML_ROLE_ELEMENT_NONE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|element6
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ELEMENT_NONE
return|;
case|case
name|XML_TOK_OPEN_PAREN
case|:
name|state
operator|->
name|level
operator|+=
literal|1
expr_stmt|;
return|return
name|XML_ROLE_GROUP_OPEN
return|;
case|case
name|XML_TOK_NAME
case|:
case|case
name|XML_TOK_PREFIXED_NAME
case|:
name|state
operator|->
name|handler
operator|=
name|element7
expr_stmt|;
return|return
name|XML_ROLE_CONTENT_ELEMENT
return|;
case|case
name|XML_TOK_NAME_QUESTION
case|:
name|state
operator|->
name|handler
operator|=
name|element7
expr_stmt|;
return|return
name|XML_ROLE_CONTENT_ELEMENT_OPT
return|;
case|case
name|XML_TOK_NAME_ASTERISK
case|:
name|state
operator|->
name|handler
operator|=
name|element7
expr_stmt|;
return|return
name|XML_ROLE_CONTENT_ELEMENT_REP
return|;
case|case
name|XML_TOK_NAME_PLUS
case|:
name|state
operator|->
name|handler
operator|=
name|element7
expr_stmt|;
return|return
name|XML_ROLE_CONTENT_ELEMENT_PLUS
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|element7
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_ELEMENT_NONE
return|;
case|case
name|XML_TOK_CLOSE_PAREN
case|:
name|state
operator|->
name|level
operator|-=
literal|1
expr_stmt|;
if|if
condition|(
name|state
operator|->
name|level
operator|==
literal|0
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|declClose
expr_stmt|;
name|state
operator|->
name|role_none
operator|=
name|XML_ROLE_ELEMENT_NONE
expr_stmt|;
block|}
return|return
name|XML_ROLE_GROUP_CLOSE
return|;
case|case
name|XML_TOK_CLOSE_PAREN_ASTERISK
case|:
name|state
operator|->
name|level
operator|-=
literal|1
expr_stmt|;
if|if
condition|(
name|state
operator|->
name|level
operator|==
literal|0
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|declClose
expr_stmt|;
name|state
operator|->
name|role_none
operator|=
name|XML_ROLE_ELEMENT_NONE
expr_stmt|;
block|}
return|return
name|XML_ROLE_GROUP_CLOSE_REP
return|;
case|case
name|XML_TOK_CLOSE_PAREN_QUESTION
case|:
name|state
operator|->
name|level
operator|-=
literal|1
expr_stmt|;
if|if
condition|(
name|state
operator|->
name|level
operator|==
literal|0
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|declClose
expr_stmt|;
name|state
operator|->
name|role_none
operator|=
name|XML_ROLE_ELEMENT_NONE
expr_stmt|;
block|}
return|return
name|XML_ROLE_GROUP_CLOSE_OPT
return|;
case|case
name|XML_TOK_CLOSE_PAREN_PLUS
case|:
name|state
operator|->
name|level
operator|-=
literal|1
expr_stmt|;
if|if
condition|(
name|state
operator|->
name|level
operator|==
literal|0
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|declClose
expr_stmt|;
name|state
operator|->
name|role_none
operator|=
name|XML_ROLE_ELEMENT_NONE
expr_stmt|;
block|}
return|return
name|XML_ROLE_GROUP_CLOSE_PLUS
return|;
case|case
name|XML_TOK_COMMA
case|:
name|state
operator|->
name|handler
operator|=
name|element6
expr_stmt|;
return|return
name|XML_ROLE_GROUP_SEQUENCE
return|;
case|case
name|XML_TOK_OR
case|:
name|state
operator|->
name|handler
operator|=
name|element6
expr_stmt|;
return|return
name|XML_ROLE_GROUP_CHOICE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|XML_DTD
end_ifdef

begin_function
specifier|static
name|int
name|PTRCALL
name|condSect0
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|ptr
parameter_list|,
specifier|const
name|char
modifier|*
name|end
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|enc
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_NONE
return|;
case|case
name|XML_TOK_NAME
case|:
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
argument_list|,
name|end
argument_list|,
name|KW_INCLUDE
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|condSect1
expr_stmt|;
return|return
name|XML_ROLE_NONE
return|;
block|}
if|if
condition|(
name|XmlNameMatchesAscii
argument_list|(
name|enc
argument_list|,
name|ptr
argument_list|,
name|end
argument_list|,
name|KW_IGNORE
argument_list|)
condition|)
block|{
name|state
operator|->
name|handler
operator|=
name|condSect2
expr_stmt|;
return|return
name|XML_ROLE_NONE
return|;
block|}
break|break;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|condSect1
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_NONE
return|;
case|case
name|XML_TOK_OPEN_BRACKET
case|:
name|state
operator|->
name|handler
operator|=
name|externalSubset1
expr_stmt|;
name|state
operator|->
name|includeLevel
operator|+=
literal|1
expr_stmt|;
return|return
name|XML_ROLE_NONE
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|condSect2
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|XML_ROLE_NONE
return|;
case|case
name|XML_TOK_OPEN_BRACKET
case|:
name|state
operator|->
name|handler
operator|=
name|externalSubset1
expr_stmt|;
return|return
name|XML_ROLE_IGNORE_SECT
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* XML_DTD */
end_comment

begin_function
specifier|static
name|int
name|PTRCALL
name|declClose
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
switch|switch
condition|(
name|tok
condition|)
block|{
case|case
name|XML_TOK_PROLOG_S
case|:
return|return
name|state
operator|->
name|role_none
return|;
case|case
name|XML_TOK_DECL_CLOSE
case|:
name|setTopLevel
argument_list|(
name|state
argument_list|)
expr_stmt|;
return|return
name|state
operator|->
name|role_none
return|;
block|}
return|return
name|common
argument_list|(
name|state
argument_list|,
name|tok
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|PTRCALL
name|error
parameter_list|(
name|PROLOG_STATE
modifier|*
name|UNUSED_P
parameter_list|(
name|state
parameter_list|)
parameter_list|,
name|int
name|UNUSED_P
parameter_list|(
name|tok
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|ptr
parameter_list|)
parameter_list|,
specifier|const
name|char
modifier|*
name|UNUSED_P
parameter_list|(
name|end
parameter_list|)
parameter_list|,
specifier|const
name|ENCODING
modifier|*
name|UNUSED_P
parameter_list|(
name|enc
parameter_list|)
parameter_list|)
block|{
return|return
name|XML_ROLE_NONE
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|FASTCALL
name|common
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|,
name|int
name|tok
parameter_list|)
block|{
ifdef|#
directive|ifdef
name|XML_DTD
if|if
condition|(
operator|!
name|state
operator|->
name|documentEntity
operator|&&
name|tok
operator|==
name|XML_TOK_PARAM_ENTITY_REF
condition|)
return|return
name|XML_ROLE_INNER_PARAM_ENTITY_REF
return|;
endif|#
directive|endif
name|state
operator|->
name|handler
operator|=
name|error
expr_stmt|;
return|return
name|XML_ROLE_ERROR
return|;
block|}
end_function

begin_function
name|void
name|XmlPrologStateInit
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|)
block|{
name|state
operator|->
name|handler
operator|=
name|prolog0
expr_stmt|;
ifdef|#
directive|ifdef
name|XML_DTD
name|state
operator|->
name|documentEntity
operator|=
literal|1
expr_stmt|;
name|state
operator|->
name|includeLevel
operator|=
literal|0
expr_stmt|;
name|state
operator|->
name|inEntityValue
operator|=
literal|0
expr_stmt|;
endif|#
directive|endif
comment|/* XML_DTD */
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|XML_DTD
end_ifdef

begin_function
name|void
name|XmlPrologStateInitExternalEntity
parameter_list|(
name|PROLOG_STATE
modifier|*
name|state
parameter_list|)
block|{
name|state
operator|->
name|handler
operator|=
name|externalSubset0
expr_stmt|;
name|state
operator|->
name|documentEntity
operator|=
literal|0
expr_stmt|;
name|state
operator|->
name|includeLevel
operator|=
literal|0
expr_stmt|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* XML_DTD */
end_comment

end_unit

