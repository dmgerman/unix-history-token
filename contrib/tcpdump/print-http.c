begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that: (1) source code  * distributions retain the above copyright notice and this paragraph  * in its entirety, and (2) distributions including binary code include  * the above copyright notice and this paragraph in its entirety in  * the documentation or other materials provided with the distribution.  * THIS SOFTWARE IS PROVIDED ``AS IS'' AND  * WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, WITHOUT  * LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS  * FOR A PARTICULAR PURPOSE.  */
end_comment

begin_comment
comment|/* \summary: Hypertext Transfer Protocol (HTTP) printer */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|HAVE_CONFIG_H
end_ifdef

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<netdissect-stdinc.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|"netdissect.h"
end_include

begin_include
include|#
directive|include
file|"extract.h"
end_include

begin_comment
comment|/*  * Includes WebDAV requests.  */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|httpcmds
index|[]
init|=
block|{
literal|"GET"
block|,
literal|"PUT"
block|,
literal|"COPY"
block|,
literal|"HEAD"
block|,
literal|"LOCK"
block|,
literal|"MOVE"
block|,
literal|"POLL"
block|,
literal|"POST"
block|,
literal|"BCOPY"
block|,
literal|"BMOVE"
block|,
literal|"MKCOL"
block|,
literal|"TRACE"
block|,
literal|"LABEL"
block|,
literal|"MERGE"
block|,
literal|"DELETE"
block|,
literal|"SEARCH"
block|,
literal|"UNLOCK"
block|,
literal|"REPORT"
block|,
literal|"UPDATE"
block|,
literal|"NOTIFY"
block|,
literal|"BDELETE"
block|,
literal|"CONNECT"
block|,
literal|"OPTIONS"
block|,
literal|"CHECKIN"
block|,
literal|"PROPFIND"
block|,
literal|"CHECKOUT"
block|,
literal|"CCM_POST"
block|,
literal|"SUBSCRIBE"
block|,
literal|"PROPPATCH"
block|,
literal|"BPROPFIND"
block|,
literal|"BPROPPATCH"
block|,
literal|"UNCHECKOUT"
block|,
literal|"MKACTIVITY"
block|,
literal|"MKWORKSPACE"
block|,
literal|"UNSUBSCRIBE"
block|,
literal|"RPC_CONNECT"
block|,
literal|"VERSION-CONTROL"
block|,
literal|"BASELINE-CONTROL"
block|,
name|NULL
block|}
decl_stmt|;
end_decl_stmt

begin_function
name|void
name|http_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|pptr
parameter_list|,
name|u_int
name|len
parameter_list|)
block|{
name|txtproto_print
argument_list|(
name|ndo
argument_list|,
name|pptr
argument_list|,
name|len
argument_list|,
literal|"http"
argument_list|,
name|httpcmds
argument_list|,
name|RESP_CODE_SECOND_TOKEN
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

