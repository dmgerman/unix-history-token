begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Radius printer routines as specified on:  *  * RFC 2865:  *      "Remote Authentication Dial In User Service (RADIUS)"  *  * RFC 2866:  *      "RADIUS Accounting"  *  * RFC 2867:  *      "RADIUS Accounting Modifications for Tunnel Protocol Support"  *  * RFC 2868:  *      "RADIUS Attributes for Tunnel Protocol Support"  *  * RFC 2869:  *      "RADIUS Extensions"  *  * Alfredo Andres Omella (aandres@s21sec.com) v0.1 2000/09/15  *  * TODO: Among other things to print ok MacIntosh and Vendor values   */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
specifier|const
name|char
name|rcsid
index|[]
init|=
literal|"$Id: print-radius.c,v 1.5 2000/12/18 08:16:58 guy Exp $"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_ifdef
ifdef|#
directive|ifdef
name|HAVE_CONFIG_H
end_ifdef

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<netinet/in.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|"interface.h"
end_include

begin_include
include|#
directive|include
file|"addrtoname.h"
end_include

begin_include
include|#
directive|include
file|"extract.h"
end_include

begin_define
define|#
directive|define
name|TAM_SIZE
parameter_list|(
name|x
parameter_list|)
value|(sizeof(x)/sizeof(x[0]) )
end_define

begin_define
define|#
directive|define
name|PRINT_HEX
parameter_list|(
name|bytes_len
parameter_list|,
name|ptr_data
parameter_list|)
define|\
value|while(bytes_len)                                          \            {                                                         \               printf("%02X", *ptr_data );                            \               ptr_data++;                                            \               bytes_len--;                                           \            }
end_define

begin_comment
comment|/* Radius packet codes */
end_comment

begin_define
define|#
directive|define
name|RADCMD_ACCESS_REQ
value|1
end_define

begin_comment
comment|/* Access-Request      */
end_comment

begin_define
define|#
directive|define
name|RADCMD_ACCESS_ACC
value|2
end_define

begin_comment
comment|/* Access-Accept       */
end_comment

begin_define
define|#
directive|define
name|RADCMD_ACCESS_REJ
value|3
end_define

begin_comment
comment|/* Access-Reject       */
end_comment

begin_define
define|#
directive|define
name|RADCMD_ACCOUN_REQ
value|4
end_define

begin_comment
comment|/* Accounting-Request  */
end_comment

begin_define
define|#
directive|define
name|RADCMD_ACCOUN_RES
value|5
end_define

begin_comment
comment|/* Accounting-Response */
end_comment

begin_define
define|#
directive|define
name|RADCMD_ACCESS_CHA
value|11
end_define

begin_comment
comment|/* Access-Challenge    */
end_comment

begin_define
define|#
directive|define
name|RADCMD_STATUS_SER
value|12
end_define

begin_comment
comment|/* Status-Server       */
end_comment

begin_define
define|#
directive|define
name|RADCMD_STATUS_CLI
value|13
end_define

begin_comment
comment|/* Status-Client       */
end_comment

begin_define
define|#
directive|define
name|RADCMD_RESERVED
value|255
end_define

begin_comment
comment|/* Reserved            */
end_comment

begin_comment
comment|/********************************/
end_comment

begin_comment
comment|/* Begin Radius Attribute types */
end_comment

begin_comment
comment|/********************************/
end_comment

begin_define
define|#
directive|define
name|SERV_TYPE
value|6
end_define

begin_define
define|#
directive|define
name|FRM_IPADDR
value|8
end_define

begin_define
define|#
directive|define
name|LOG_IPHOST
value|14
end_define

begin_define
define|#
directive|define
name|LOG_SERVICE
value|15
end_define

begin_define
define|#
directive|define
name|FRM_IPX
value|23
end_define

begin_define
define|#
directive|define
name|SESSION_TIMEOUT
value|27
end_define

begin_define
define|#
directive|define
name|IDLE_TIMEOUT
value|28
end_define

begin_define
define|#
directive|define
name|FRM_ATALK_LINK
value|37
end_define

begin_define
define|#
directive|define
name|FRM_ATALK_NETWORK
value|38
end_define

begin_define
define|#
directive|define
name|ACCT_DELAY
value|41
end_define

begin_define
define|#
directive|define
name|ACCT_SESSION_TIME
value|46
end_define

begin_define
define|#
directive|define
name|TUNNEL_TYPE
value|64
end_define

begin_define
define|#
directive|define
name|TUNNEL_MEDIUM
value|65
end_define

begin_define
define|#
directive|define
name|TUNNEL_CLIENT_END
value|66
end_define

begin_define
define|#
directive|define
name|TUNNEL_SERVER_END
value|67
end_define

begin_define
define|#
directive|define
name|TUNNEL_PASS
value|69
end_define

begin_define
define|#
directive|define
name|ARAP_PASS
value|70
end_define

begin_define
define|#
directive|define
name|ARAP_FEATURES
value|71
end_define

begin_define
define|#
directive|define
name|TUNNEL_PRIV_GROUP
value|81
end_define

begin_define
define|#
directive|define
name|TUNNEL_ASSIGN_ID
value|82
end_define

begin_define
define|#
directive|define
name|TUNNEL_PREFERENCE
value|83
end_define

begin_define
define|#
directive|define
name|ARAP_CHALLENGE_RESP
value|84
end_define

begin_define
define|#
directive|define
name|ACCT_INT_INTERVAL
value|85
end_define

begin_define
define|#
directive|define
name|TUNNEL_CLIENT_AUTH
value|90
end_define

begin_define
define|#
directive|define
name|TUNNEL_SERVER_AUTH
value|91
end_define

begin_comment
comment|/********************************/
end_comment

begin_comment
comment|/* End Radius Attribute types */
end_comment

begin_comment
comment|/********************************/
end_comment

begin_function_decl
specifier|static
name|void
name|print_attr_string
parameter_list|(
specifier|register
name|u_char
modifier|*
parameter_list|,
name|u_int
parameter_list|,
name|u_short
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|print_attr_num
parameter_list|(
specifier|register
name|u_char
modifier|*
parameter_list|,
name|u_int
parameter_list|,
name|u_short
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|print_attr_address
parameter_list|(
specifier|register
name|u_char
modifier|*
parameter_list|,
name|u_int
parameter_list|,
name|u_short
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|print_attr_time
parameter_list|(
specifier|register
name|u_char
modifier|*
parameter_list|,
name|u_int
parameter_list|,
name|u_short
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|print_attr_strange
parameter_list|(
specifier|register
name|u_char
modifier|*
parameter_list|,
name|u_int
parameter_list|,
name|u_short
parameter_list|)
function_decl|;
end_function_decl

begin_struct
struct|struct
name|radius_hdr
block|{
name|u_int8_t
name|code
decl_stmt|;
comment|/* Radius packet code  */
name|u_int8_t
name|id
decl_stmt|;
comment|/* Radius packet id    */
name|u_int16_t
name|len
decl_stmt|;
comment|/* Radius total length */
name|u_int8_t
name|auth
index|[
literal|16
index|]
decl_stmt|;
comment|/* Authenticator   */
block|}
struct|;
end_struct

begin_struct
struct|struct
name|radius_attr
block|{
name|u_int8_t
name|type
decl_stmt|;
comment|/* Attribute type   */
name|u_int8_t
name|len
decl_stmt|;
comment|/* Attribute length */
block|}
struct|;
end_struct

begin_comment
comment|/* Service-Type Attribute standard values */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|serv_type
index|[]
init|=
block|{
name|NULL
block|,
literal|"Login"
block|,
literal|"Framed"
block|,
literal|"Callback Login"
block|,
literal|"Callback Framed"
block|,
literal|"Outbound"
block|,
literal|"Administrative"
block|,
literal|"NAS Prompt"
block|,
literal|"Authenticate Only"
block|,
literal|"Callback NAS Prompt"
block|,
literal|"Call Check"
block|,
literal|"Callback Administrative"
block|,                                }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Framed-Protocol Attribute standard values */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|frm_proto
index|[]
init|=
block|{
name|NULL
block|,
literal|"PPP"
block|,
literal|"SLIP"
block|,
literal|"ARAP"
block|,
literal|"Gandalf proprietary"
block|,
literal|"Xylogics IPX/SLIP"
block|,
literal|"X.75 Synchronous"
block|,                                }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Framed-Routing Attribute standard values */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|frm_routing
index|[]
init|=
block|{
literal|"None"
block|,
literal|"Send"
block|,
literal|"Listen"
block|,
literal|"Send&Listen"
block|,                                  }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Framed-Compression Attribute standard values */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|frm_comp
index|[]
init|=
block|{
literal|"None"
block|,
literal|"VJ TCP/IP"
block|,
literal|"IPX"
block|,
literal|"Stac-LZS"
block|,                               }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Login-Service Attribute standard values */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|login_serv
index|[]
init|=
block|{
literal|"Telnet"
block|,
literal|"Rlogin"
block|,
literal|"TCP Clear"
block|,
literal|"PortMaster(proprietary)"
block|,
literal|"LAT"
block|,
literal|"X.25-PAD"
block|,
literal|"X.25-T3POS"
block|,
literal|"Unassigned"
block|,
literal|"TCP Clear Quiet"
block|,                                 }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Termination-Action Attribute standard values */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|term_action
index|[]
init|=
block|{
literal|"Default"
block|,
literal|"RADIUS-Request"
block|,                                  }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* NAS-Port-Type Attribute standard values */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|nas_port_type
index|[]
init|=
block|{
literal|"Async"
block|,
literal|"Sync"
block|,
literal|"ISDN Sync"
block|,
literal|"ISDN Async V.120"
block|,
literal|"ISDN Async V.110"
block|,
literal|"Virtual"
block|,
literal|"PIAFS"
block|,
literal|"HDLC Clear Channel"
block|,
literal|"X.25"
block|,
literal|"X.75"
block|,
literal|"G.3 Fax"
block|,
literal|"SDSL"
block|,
literal|"ADSL-CAP"
block|,
literal|"ADSL-DMT"
block|,
literal|"ISDN-DSL"
block|,
literal|"Ethernet"
block|,
literal|"xDSL"
block|,
literal|"Cable"
block|,
literal|"Wireless - Other"
block|,
literal|"Wireless - IEEE 802.11"
block|,                                    }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Acct-Status-Type Accounting Attribute standard values */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|acct_status
index|[]
init|=
block|{
name|NULL
block|,
literal|"Start"
block|,
literal|"Stop"
block|,
literal|"Interim-Update"
block|,
literal|"Unassigned"
block|,
literal|"Unassigned"
block|,
literal|"Unassigned"
block|,
literal|"Accounting-On"
block|,
literal|"Accounting-Off"
block|,
literal|"Tunnel-Start"
block|,
literal|"Tunnel-Stop"
block|,
literal|"Tunnel-Reject"
block|,
literal|"Tunnel-Link-Start"
block|,
literal|"Tunnel-Link-Stop"
block|,
literal|"Tunnel-Link-Reject"
block|,
literal|"Failed"
block|,                                  }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Acct-Authentic Accounting Attribute standard values */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|acct_auth
index|[]
init|=
block|{
name|NULL
block|,
literal|"RADIUS"
block|,
literal|"Local"
block|,
literal|"Remote"
block|,                                }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Acct-Terminate-Cause Accounting Attribute standard values */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|acct_term
index|[]
init|=
block|{
name|NULL
block|,
literal|"User Request"
block|,
literal|"Lost Carrier"
block|,
literal|"Lost Service"
block|,
literal|"Idle Timeout"
block|,
literal|"Session Timeout"
block|,
literal|"Admin Reset"
block|,
literal|"Admin Reboot"
block|,
literal|"Port Error"
block|,
literal|"NAS Error"
block|,
literal|"NAS Request"
block|,
literal|"NAS Reboot"
block|,
literal|"Port Unneeded"
block|,
literal|"Port Preempted"
block|,
literal|"Port Suspended"
block|,
literal|"Service Unavailable"
block|,
literal|"Callback"
block|,
literal|"User Error"
block|,
literal|"Host Request"
block|,                                }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Tunnel-Type Attribute standard values */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|tunnel_type
index|[]
init|=
block|{
name|NULL
block|,
literal|"PPTP"
block|,
literal|"L2F"
block|,
literal|"L2TP"
block|,
literal|"ATMP"
block|,
literal|"VTP"
block|,
literal|"AH"
block|,
literal|"IP-IP"
block|,
literal|"MIN-IP-IP"
block|,
literal|"ESP"
block|,
literal|"GRE"
block|,
literal|"DVS"
block|,
literal|"IP-in-IP Tunneling"
block|,                                  }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Tunnel-Medium-Type Attribute standard values */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|tunnel_medium
index|[]
init|=
block|{
name|NULL
block|,
literal|"IPv4"
block|,
literal|"IPv6"
block|,
literal|"NSAP"
block|,
literal|"HDLC"
block|,
literal|"BBN 1822"
block|,
literal|"802"
block|,
literal|"E.163"
block|,
literal|"E.164"
block|,
literal|"F.69"
block|,
literal|"X.121"
block|,
literal|"IPX"
block|,
literal|"Appletalk"
block|,
literal|"Decnet IV"
block|,
literal|"Banyan Vines"
block|,
literal|"E.164 with NSAP subaddress"
block|,                                    }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ARAP-Zone-Access Attribute standard values */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|arap_zone
index|[]
init|=
block|{
name|NULL
block|,
literal|"Only access to dfl zone"
block|,
literal|"Use zone filter inc."
block|,
literal|"Not used"
block|,
literal|"Use zone filter exc."
block|,                                }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|prompt
index|[]
init|=
block|{
literal|"No Echo"
block|,
literal|"Echo"
block|,                             }
decl_stmt|;
end_decl_stmt

begin_struct
struct|struct
name|attrtype
block|{
name|char
modifier|*
name|name
decl_stmt|;
comment|/* Attribute name                 */
specifier|const
name|char
modifier|*
modifier|*
name|subtypes
decl_stmt|;
comment|/* Standard Values (if any)       */
name|u_char
name|siz_subtypes
decl_stmt|;
comment|/* Size of total standard values  */
name|u_char
name|first_subtype
decl_stmt|;
comment|/* First standard value is 0 or 1 */
name|void
function_decl|(
modifier|*
name|print_func
function_decl|)
parameter_list|(
specifier|register
name|u_char
modifier|*
parameter_list|,
name|u_int
parameter_list|,
name|u_short
parameter_list|)
function_decl|;
block|}
name|attr_type
index|[]
init|=
block|{
block|{
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|NULL
block|}
block|,
block|{
literal|"User"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Pass"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|NULL
block|}
block|,
block|{
literal|"CHAP-Pass"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|NULL
block|}
block|,
block|{
literal|"NAS_ipaddr"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_address
block|}
block|,
block|{
literal|"NAS_port"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Service_type"
block|,
name|serv_type
block|,
name|TAM_SIZE
argument_list|(
name|serv_type
argument_list|)
operator|-
literal|1
block|,
literal|1
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Framed_proto"
block|,
name|frm_proto
block|,
name|TAM_SIZE
argument_list|(
name|frm_proto
argument_list|)
operator|-
literal|1
block|,
literal|1
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Framed_ipaddr"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_address
block|}
block|,
block|{
literal|"Framed_ipnet"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_address
block|}
block|,
block|{
literal|"Framed_routing"
block|,
name|frm_routing
block|,
name|TAM_SIZE
argument_list|(
name|frm_routing
argument_list|)
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Filter_id"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Framed_mtu"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Framed_compress"
block|,
name|frm_comp
block|,
name|TAM_SIZE
argument_list|(
name|frm_comp
argument_list|)
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Login_iphost"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_address
block|}
block|,
block|{
literal|"Login_service"
block|,
name|login_serv
block|,
name|TAM_SIZE
argument_list|(
name|login_serv
argument_list|)
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Login_TCP_port"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
comment|/*17*/
block|{
literal|"Unassigned"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|NULL
block|}
block|,
block|{
literal|"Reply"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Callback-number"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Callback-id"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
comment|/*21*/
block|{
literal|"Unassigned"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|NULL
block|}
block|,
block|{
literal|"Framed_route"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Framed_ipx_net"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"State"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Class"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Vendor_specific"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Session_timeout"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Idle_timeout"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Term_action"
block|,
name|term_action
block|,
name|TAM_SIZE
argument_list|(
name|term_action
argument_list|)
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Called_station"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Calling_station"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"NAS_id"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Proxy_state"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Login_LAT_service"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Login_LAT_node"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Login_LAT_group"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Framed_atalk_link"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Framed_atalk_net"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Framed_atalk_zone"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Acct_status"
block|,
name|acct_status
block|,
name|TAM_SIZE
argument_list|(
name|acct_status
argument_list|)
operator|-
literal|1
block|,
literal|1
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Acct_delay"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Acct_in_octets"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Acct_out_octets"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Acct_session_id"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Acct_authentic"
block|,
name|acct_auth
block|,
name|TAM_SIZE
argument_list|(
name|acct_auth
argument_list|)
operator|-
literal|1
block|,
literal|1
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Acct_session_time"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Acct_in_packets"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Acct_out_packets"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Acct_term_cause"
block|,
name|acct_term
block|,
name|TAM_SIZE
argument_list|(
name|acct_term
argument_list|)
operator|-
literal|1
block|,
literal|1
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Acct_multi_session_id"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Acct_link_count"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Acct_in_giga"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Acct_out_giga"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
comment|/*54*/
block|{
literal|"Unassigned"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|NULL
block|}
block|,
block|{
literal|"Event_timestamp"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_time
block|}
block|,
comment|/*56*/
block|{
literal|"Unassigned"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|NULL
block|}
block|,
comment|/*57*/
block|{
literal|"Unassigned"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|NULL
block|}
block|,
comment|/*58*/
block|{
literal|"Unassigned"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|NULL
block|}
block|,
comment|/*59*/
block|{
literal|"Unassigned"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|NULL
block|}
block|,
block|{
literal|"CHAP_challenge"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"NAS_port_type"
block|,
name|nas_port_type
block|,
name|TAM_SIZE
argument_list|(
name|nas_port_type
argument_list|)
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Port_limit"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
comment|/*63*/
block|{
literal|"Login_LAT_port"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Tunnel_type"
block|,
name|tunnel_type
block|,
name|TAM_SIZE
argument_list|(
name|tunnel_type
argument_list|)
operator|-
literal|1
block|,
literal|1
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Tunnel_medium"
block|,
name|tunnel_medium
block|,
name|TAM_SIZE
argument_list|(
name|tunnel_medium
argument_list|)
operator|-
literal|1
block|,
literal|1
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Tunnel_client_end"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Tunnel_server_end"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Acct_tunnel_connect"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Tunnel_pass"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"ARAP_pass"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_strange
block|}
block|,
block|{
literal|"ARAP_feature"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_strange
block|}
block|,
comment|/*72*/
block|{
literal|"ARAP_zone_acces"
block|,
name|arap_zone
block|,
name|TAM_SIZE
argument_list|(
name|arap_zone
argument_list|)
operator|-
literal|1
block|,
literal|1
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"ARAP_security"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"ARAP_security_data"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Password_retry"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Prompt"
block|,
name|prompt
block|,
name|TAM_SIZE
argument_list|(
name|prompt
argument_list|)
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"Connect_info"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Config_token"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"EAP_msg"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
comment|/*80*/
block|{
literal|"Message_auth"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Tunnel_priv_group"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Tunnel_assign_id"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Tunnel_pref"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"ARAP_challenge_resp"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_strange
block|}
block|,
block|{
literal|"Acct_interim_interval"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
comment|/*86*/
block|{
literal|"Acct_tunnel_pack_lost"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_num
block|}
block|,
block|{
literal|"NAS_port_id"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Framed_pool"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Unassigned"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|NULL
block|}
block|,
block|{
literal|"Tunnel_client_auth_id"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
block|{
literal|"Tunnel_server_auth_id"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|print_attr_string
block|}
block|,
comment|/*92*/
block|{
literal|"Unassigned"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|NULL
block|}
block|,
comment|/*93*/
block|{
literal|"Unassigned"
block|,
name|NULL
block|,
literal|0
block|,
literal|0
block|,
name|NULL
block|}
block|}
struct|;
end_struct

begin_comment
comment|/*****************************/
end_comment

begin_comment
comment|/* Print an attribute string */
end_comment

begin_comment
comment|/* value pointed by 'data'   */
end_comment

begin_comment
comment|/* and 'length' size.        */
end_comment

begin_comment
comment|/*****************************/
end_comment

begin_comment
comment|/* Returns nothing.          */
end_comment

begin_comment
comment|/*****************************/
end_comment

begin_function
specifier|static
name|void
name|print_attr_string
parameter_list|(
specifier|register
name|u_char
modifier|*
name|data
parameter_list|,
name|u_int
name|length
parameter_list|,
name|u_short
name|attr_code
parameter_list|)
block|{
specifier|register
name|u_int
name|i
decl_stmt|;
name|TCHECK2
argument_list|(
name|data
index|[
literal|0
index|]
argument_list|,
name|length
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"{"
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|attr_code
condition|)
block|{
case|case
name|TUNNEL_PASS
case|:
if|if
condition|(
operator|*
name|data
operator|&&
operator|(
operator|*
name|data
operator|<=
literal|0x1F
operator|)
condition|)
name|printf
argument_list|(
literal|"Tag[%d] "
argument_list|,
operator|*
name|data
argument_list|)
expr_stmt|;
name|data
operator|++
expr_stmt|;
name|printf
argument_list|(
literal|"Salt[%d] "
argument_list|,
name|EXTRACT_16BITS
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
name|data
operator|+=
literal|2
expr_stmt|;
name|length
operator|-=
literal|2
expr_stmt|;
break|break;
case|case
name|TUNNEL_CLIENT_END
case|:
case|case
name|TUNNEL_SERVER_END
case|:
case|case
name|TUNNEL_PRIV_GROUP
case|:
case|case
name|TUNNEL_ASSIGN_ID
case|:
case|case
name|TUNNEL_CLIENT_AUTH
case|:
case|case
name|TUNNEL_SERVER_AUTH
case|:
if|if
condition|(
operator|*
name|data
operator|<=
literal|0x1F
condition|)
block|{
name|printf
argument_list|(
literal|"Tag[%d] "
argument_list|,
operator|*
name|data
argument_list|)
expr_stmt|;
name|data
operator|++
expr_stmt|;
name|length
operator|--
expr_stmt|;
block|}
break|break;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|length
condition|;
name|i
operator|++
operator|,
name|data
operator|++
control|)
name|printf
argument_list|(
literal|"%c"
argument_list|,
operator|(
operator|*
name|data
operator|<
literal|32
operator|||
operator|*
name|data
operator|>
literal|128
operator|)
condition|?
literal|'.'
else|:
operator|*
name|data
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"}"
argument_list|)
expr_stmt|;
return|return;
name|trunc
label|:
name|printf
argument_list|(
literal|"|radius"
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/******************************/
end_comment

begin_comment
comment|/* Print an attribute numeric */
end_comment

begin_comment
comment|/* value pointed by 'data'    */
end_comment

begin_comment
comment|/* and 'length' size.         */
end_comment

begin_comment
comment|/******************************/
end_comment

begin_comment
comment|/* Returns nothing.           */
end_comment

begin_comment
comment|/******************************/
end_comment

begin_function
specifier|static
name|void
name|print_attr_num
parameter_list|(
specifier|register
name|u_char
modifier|*
name|data
parameter_list|,
name|u_int
name|length
parameter_list|,
name|u_short
name|attr_code
parameter_list|)
block|{
name|u_int8_t
name|tag
decl_stmt|;
name|u_int32_t
name|timeout
decl_stmt|;
if|if
condition|(
name|length
operator|!=
literal|4
condition|)
block|{
name|printf
argument_list|(
literal|"{length %u != 4}"
argument_list|,
name|length
argument_list|)
expr_stmt|;
return|return;
block|}
name|TCHECK2
argument_list|(
name|data
index|[
literal|0
index|]
argument_list|,
literal|4
argument_list|)
expr_stmt|;
comment|/* This attribute has standard values */
if|if
condition|(
name|attr_type
index|[
name|attr_code
index|]
operator|.
name|siz_subtypes
condition|)
block|{
specifier|static
specifier|const
name|char
modifier|*
modifier|*
name|table
decl_stmt|;
name|u_int32_t
name|data_value
decl_stmt|;
name|table
operator|=
name|attr_type
index|[
name|attr_code
index|]
operator|.
name|subtypes
expr_stmt|;
if|if
condition|(
operator|(
name|attr_code
operator|==
name|TUNNEL_TYPE
operator|)
operator|||
operator|(
name|attr_code
operator|==
name|TUNNEL_MEDIUM
operator|)
condition|)
block|{
if|if
condition|(
operator|!
operator|*
name|data
condition|)
name|printf
argument_list|(
literal|"{Tag[Unused]"
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"{Tag[%d]"
argument_list|,
operator|*
name|data
argument_list|)
expr_stmt|;
name|data
operator|++
expr_stmt|;
name|data_value
operator|=
name|EXTRACT_24BITS
argument_list|(
name|data
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|data
operator|++
expr_stmt|;
name|data_value
operator|=
name|EXTRACT_32BITS
argument_list|(
name|data
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|data_value
operator|<=
operator|(
name|attr_type
index|[
name|attr_code
index|]
operator|.
name|siz_subtypes
operator|-
literal|1
operator|+
name|attr_type
index|[
name|attr_code
index|]
operator|.
name|first_subtype
operator|)
condition|)
name|printf
argument_list|(
literal|"{%s}"
argument_list|,
name|table
index|[
name|data_value
index|]
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"{#%d}"
argument_list|,
name|data_value
argument_list|)
expr_stmt|;
block|}
else|else
block|{
switch|switch
condition|(
name|attr_code
condition|)
comment|/* Be aware of special cases... */
block|{
case|case
name|FRM_IPX
case|:
if|if
condition|(
name|EXTRACT_32BITS
argument_list|(
name|data
argument_list|)
operator|==
literal|0xFFFFFFFE
condition|)
name|printf
argument_list|(
literal|"{NAS_select}"
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"{%d}"
argument_list|,
name|EXTRACT_32BITS
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|SESSION_TIMEOUT
case|:
case|case
name|IDLE_TIMEOUT
case|:
case|case
name|ACCT_DELAY
case|:
case|case
name|ACCT_SESSION_TIME
case|:
case|case
name|ACCT_INT_INTERVAL
case|:
name|timeout
operator|=
name|EXTRACT_32BITS
argument_list|(
name|data
argument_list|)
expr_stmt|;
if|if
condition|(
name|timeout
operator|<
literal|60
condition|)
name|printf
argument_list|(
literal|"{%02d secs}"
argument_list|,
name|timeout
argument_list|)
expr_stmt|;
else|else
block|{
if|if
condition|(
name|timeout
operator|<
literal|3600
condition|)
name|printf
argument_list|(
literal|"{%02d:%02d min}"
argument_list|,
name|timeout
operator|/
literal|60
argument_list|,
name|timeout
operator|%
literal|60
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"{%02d:%02d:%02d hours}"
argument_list|,
name|timeout
operator|/
literal|3600
argument_list|,
operator|(
name|timeout
operator|%
literal|3600
operator|)
operator|/
literal|60
argument_list|,
name|timeout
operator|%
literal|60
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|FRM_ATALK_LINK
case|:
if|if
condition|(
name|EXTRACT_32BITS
argument_list|(
name|data
argument_list|)
condition|)
name|printf
argument_list|(
literal|"{%d}"
argument_list|,
name|EXTRACT_32BITS
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"{Unnumbered}"
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRM_ATALK_NETWORK
case|:
if|if
condition|(
name|EXTRACT_32BITS
argument_list|(
name|data
argument_list|)
condition|)
name|printf
argument_list|(
literal|"{%d}"
argument_list|,
name|EXTRACT_32BITS
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"{NAS_assign}"
argument_list|)
expr_stmt|;
break|break;
case|case
name|TUNNEL_PREFERENCE
case|:
name|tag
operator|=
operator|*
name|data
expr_stmt|;
name|data
operator|++
expr_stmt|;
if|if
condition|(
name|tag
operator|==
literal|0
condition|)
name|printf
argument_list|(
literal|"{Tag[Unused] %d}"
argument_list|,
name|EXTRACT_24BITS
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"{Tag[%d] %d}"
argument_list|,
name|tag
argument_list|,
name|EXTRACT_24BITS
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
break|break;
default|default:
name|printf
argument_list|(
literal|"{%d}"
argument_list|,
name|EXTRACT_32BITS
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
comment|/* switch */
block|}
comment|/* if-else */
return|return;
name|trunc
label|:
name|printf
argument_list|(
literal|"|radius}"
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*****************************/
end_comment

begin_comment
comment|/* Print an attribute IPv4   */
end_comment

begin_comment
comment|/* address value pointed by  */
end_comment

begin_comment
comment|/* 'data' and 'length' size. */
end_comment

begin_comment
comment|/*****************************/
end_comment

begin_comment
comment|/* Returns nothing.          */
end_comment

begin_comment
comment|/*****************************/
end_comment

begin_function
specifier|static
name|void
name|print_attr_address
parameter_list|(
specifier|register
name|u_char
modifier|*
name|data
parameter_list|,
name|u_int
name|length
parameter_list|,
name|u_short
name|attr_code
parameter_list|)
block|{
if|if
condition|(
name|length
operator|!=
literal|4
condition|)
block|{
name|printf
argument_list|(
literal|"{length %u != 4}"
argument_list|,
name|length
argument_list|)
expr_stmt|;
return|return;
block|}
name|TCHECK2
argument_list|(
name|data
index|[
literal|0
index|]
argument_list|,
literal|4
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|attr_code
condition|)
block|{
case|case
name|FRM_IPADDR
case|:
case|case
name|LOG_IPHOST
case|:
if|if
condition|(
name|EXTRACT_32BITS
argument_list|(
name|data
argument_list|)
operator|==
literal|0xFFFFFFFF
condition|)
name|printf
argument_list|(
literal|"{User_select}"
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|EXTRACT_32BITS
argument_list|(
name|data
argument_list|)
operator|==
literal|0xFFFFFFFE
condition|)
name|printf
argument_list|(
literal|"{NAS_select}"
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"{%s}"
argument_list|,
name|ipaddr_string
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
break|break;
default|default:
name|printf
argument_list|(
literal|"{%s}"
argument_list|,
name|ipaddr_string
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
return|return;
name|trunc
label|:
name|printf
argument_list|(
literal|"{|radius}"
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*************************************/
end_comment

begin_comment
comment|/* Print an attribute of 'secs since */
end_comment

begin_comment
comment|/* January 1, 1970 00:00 UTC' value  */
end_comment

begin_comment
comment|/* pointed by 'data' and 'length'    */
end_comment

begin_comment
comment|/* size.                             */
end_comment

begin_comment
comment|/*************************************/
end_comment

begin_comment
comment|/* Returns nothing.                  */
end_comment

begin_comment
comment|/*************************************/
end_comment

begin_function
specifier|static
name|void
name|print_attr_time
parameter_list|(
specifier|register
name|u_char
modifier|*
name|data
parameter_list|,
name|u_int
name|length
parameter_list|,
name|u_short
name|attr_code
parameter_list|)
block|{
name|time_t
name|attr_time
decl_stmt|;
name|char
name|string
index|[
literal|26
index|]
decl_stmt|;
if|if
condition|(
name|length
operator|!=
literal|4
condition|)
block|{
name|printf
argument_list|(
literal|"{length %u != 4}"
argument_list|,
name|length
argument_list|)
expr_stmt|;
return|return;
block|}
name|TCHECK2
argument_list|(
name|data
index|[
literal|0
index|]
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|attr_time
operator|=
name|EXTRACT_32BITS
argument_list|(
name|data
argument_list|)
expr_stmt|;
name|strcpy
argument_list|(
name|string
argument_list|,
name|ctime
argument_list|(
operator|&
name|attr_time
argument_list|)
argument_list|)
expr_stmt|;
comment|/* Get rid of the newline */
name|string
index|[
literal|24
index|]
operator|=
literal|'\0'
expr_stmt|;
name|printf
argument_list|(
literal|"{%.24s}"
argument_list|,
name|string
argument_list|)
expr_stmt|;
return|return;
name|trunc
label|:
name|printf
argument_list|(
literal|"{|radius}"
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/***********************************/
end_comment

begin_comment
comment|/* Print an attribute of 'strange' */
end_comment

begin_comment
comment|/* data format pointed by 'data'   */
end_comment

begin_comment
comment|/* and 'length' size.              */
end_comment

begin_comment
comment|/***********************************/
end_comment

begin_comment
comment|/* Returns nothing.                */
end_comment

begin_comment
comment|/***********************************/
end_comment

begin_function
specifier|static
name|void
name|print_attr_strange
parameter_list|(
specifier|register
name|u_char
modifier|*
name|data
parameter_list|,
name|u_int
name|length
parameter_list|,
name|u_short
name|attr_code
parameter_list|)
block|{
name|u_short
name|len_data
decl_stmt|;
switch|switch
condition|(
name|attr_code
condition|)
block|{
case|case
name|ARAP_PASS
case|:
if|if
condition|(
name|length
operator|!=
literal|16
condition|)
block|{
name|printf
argument_list|(
literal|"{length %u != 16}"
argument_list|,
name|length
argument_list|)
expr_stmt|;
return|return;
block|}
name|printf
argument_list|(
literal|"{User_challenge["
argument_list|)
expr_stmt|;
name|TCHECK2
argument_list|(
name|data
index|[
literal|0
index|]
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|len_data
operator|=
literal|8
expr_stmt|;
name|PRINT_HEX
argument_list|(
name|len_data
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"] User_resp["
argument_list|)
expr_stmt|;
name|TCHECK2
argument_list|(
name|data
index|[
literal|0
index|]
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|len_data
operator|=
literal|8
expr_stmt|;
name|PRINT_HEX
argument_list|(
name|len_data
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"]}"
argument_list|)
expr_stmt|;
break|break;
case|case
name|ARAP_FEATURES
case|:
if|if
condition|(
name|length
operator|!=
literal|14
condition|)
block|{
name|printf
argument_list|(
literal|"{length %u != 14}"
argument_list|,
name|length
argument_list|)
expr_stmt|;
return|return;
block|}
name|TCHECK2
argument_list|(
name|data
index|[
literal|0
index|]
argument_list|,
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
name|data
condition|)
name|printf
argument_list|(
literal|"{User_can_change_pass"
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"{User_cant_change_pass"
argument_list|)
expr_stmt|;
name|data
operator|++
expr_stmt|;
name|TCHECK2
argument_list|(
name|data
index|[
literal|0
index|]
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|" Min_pass_len[%d]"
argument_list|,
operator|*
name|data
argument_list|)
expr_stmt|;
name|data
operator|++
expr_stmt|;
name|printf
argument_list|(
literal|" Pass_created_at["
argument_list|)
expr_stmt|;
name|TCHECK2
argument_list|(
name|data
index|[
literal|0
index|]
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|len_data
operator|=
literal|4
expr_stmt|;
name|PRINT_HEX
argument_list|(
name|len_data
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"] Pass_expired_in["
argument_list|)
expr_stmt|;
name|TCHECK2
argument_list|(
name|data
index|[
literal|0
index|]
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|len_data
operator|=
literal|4
expr_stmt|;
name|PRINT_HEX
argument_list|(
name|len_data
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"] Current_time["
argument_list|)
expr_stmt|;
name|len_data
operator|=
literal|4
expr_stmt|;
name|TCHECK2
argument_list|(
name|data
index|[
literal|0
index|]
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|PRINT_HEX
argument_list|(
name|len_data
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"]}"
argument_list|)
expr_stmt|;
break|break;
case|case
name|ARAP_CHALLENGE_RESP
case|:
if|if
condition|(
name|length
operator|<
literal|8
condition|)
block|{
name|printf
argument_list|(
literal|"{length %u != 8}"
argument_list|,
name|length
argument_list|)
expr_stmt|;
return|return;
block|}
name|printf
argument_list|(
literal|"{"
argument_list|)
expr_stmt|;
name|TCHECK2
argument_list|(
name|data
index|[
literal|0
index|]
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|len_data
operator|=
literal|8
expr_stmt|;
name|PRINT_HEX
argument_list|(
name|len_data
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"}"
argument_list|)
expr_stmt|;
break|break;
block|}
name|trunc
label|:
name|printf
argument_list|(
literal|"|radius}"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|radius_attr_print
parameter_list|(
specifier|register
name|u_char
modifier|*
name|attr
parameter_list|,
name|u_int
name|length
parameter_list|)
block|{
specifier|register
specifier|const
name|struct
name|radius_attr
modifier|*
name|rad_attr
init|=
operator|(
expr|struct
name|radius_attr
operator|*
operator|)
name|attr
decl_stmt|;
if|if
condition|(
name|length
operator|<
literal|3
condition|)
block|{
name|printf
argument_list|(
literal|" [|radius]"
argument_list|)
expr_stmt|;
return|return;
block|}
name|printf
argument_list|(
literal|" Attr[ "
argument_list|)
expr_stmt|;
while|while
condition|(
name|length
operator|>
literal|0
condition|)
block|{
if|if
condition|(
name|rad_attr
operator|->
name|len
operator|<=
name|length
condition|)
block|{
if|if
condition|(
operator|!
name|rad_attr
operator|->
name|type
operator|||
operator|(
name|rad_attr
operator|->
name|type
operator|>
operator|(
name|TAM_SIZE
argument_list|(
name|attr_type
argument_list|)
operator|-
literal|1
operator|)
operator|)
condition|)
name|printf
argument_list|(
literal|"#%d"
argument_list|,
name|rad_attr
operator|->
name|type
argument_list|)
expr_stmt|;
else|else
block|{
name|printf
argument_list|(
literal|" %s"
argument_list|,
name|attr_type
index|[
name|rad_attr
operator|->
name|type
index|]
operator|.
name|name
argument_list|)
expr_stmt|;
if|if
condition|(
name|rad_attr
operator|->
name|len
operator|>
literal|2
condition|)
block|{
if|if
condition|(
name|attr_type
index|[
name|rad_attr
operator|->
name|type
index|]
operator|.
name|print_func
condition|)
operator|(
operator|*
name|attr_type
index|[
name|rad_attr
operator|->
name|type
index|]
operator|.
name|print_func
operator|)
operator|(
operator|(
operator|(
name|u_char
operator|*
operator|)
operator|(
name|rad_attr
operator|+
literal|1
operator|)
operator|)
operator|,
name|rad_attr
operator|->
name|len
operator|-
literal|2
operator|,
name|rad_attr
operator|->
name|type
operator|)
expr_stmt|;
block|}
block|}
block|}
else|else
block|{
name|printf
argument_list|(
literal|" [|radius]"
argument_list|)
expr_stmt|;
return|return;
block|}
name|length
operator|-=
operator|(
name|rad_attr
operator|->
name|len
operator|)
expr_stmt|;
name|rad_attr
operator|=
operator|(
expr|struct
name|radius_attr
operator|*
operator|)
operator|(
operator|(
operator|(
name|char
operator|*
operator|)
operator|(
name|rad_attr
operator|)
operator|)
operator|+
name|rad_attr
operator|->
name|len
operator|)
expr_stmt|;
block|}
name|printf
argument_list|(
literal|" ]"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|radius_print
parameter_list|(
specifier|const
name|u_char
modifier|*
name|dat
parameter_list|,
name|u_int
name|length
parameter_list|)
block|{
specifier|register
specifier|const
name|struct
name|radius_hdr
modifier|*
name|rad
decl_stmt|;
specifier|register
name|int
name|i
decl_stmt|;
name|i
operator|=
name|min
argument_list|(
name|length
argument_list|,
name|snapend
operator|-
name|dat
argument_list|)
operator|-
sizeof|sizeof
argument_list|(
operator|*
name|rad
argument_list|)
expr_stmt|;
if|if
condition|(
name|i
operator|<
literal|0
condition|)
block|{
name|printf
argument_list|(
literal|" [|radius]"
argument_list|)
expr_stmt|;
return|return;
block|}
name|rad
operator|=
operator|(
expr|struct
name|radius_hdr
operator|*
operator|)
name|dat
expr_stmt|;
switch|switch
condition|(
name|rad
operator|->
name|code
condition|)
block|{
case|case
name|RADCMD_ACCESS_REQ
case|:
name|printf
argument_list|(
literal|" rad-access-req %d"
argument_list|,
name|length
argument_list|)
expr_stmt|;
break|break;
case|case
name|RADCMD_ACCESS_ACC
case|:
name|printf
argument_list|(
literal|" rad-access-accept %d"
argument_list|,
name|length
argument_list|)
expr_stmt|;
break|break;
case|case
name|RADCMD_ACCESS_REJ
case|:
name|printf
argument_list|(
literal|" rad-access-reject %d"
argument_list|,
name|length
argument_list|)
expr_stmt|;
break|break;
case|case
name|RADCMD_ACCOUN_REQ
case|:
name|printf
argument_list|(
literal|" rad-account-req %d"
argument_list|,
name|length
argument_list|)
expr_stmt|;
break|break;
case|case
name|RADCMD_ACCOUN_RES
case|:
name|printf
argument_list|(
literal|" rad-account-resp %d"
argument_list|,
name|length
argument_list|)
expr_stmt|;
break|break;
case|case
name|RADCMD_ACCESS_CHA
case|:
name|printf
argument_list|(
literal|" rad-access-cha %d"
argument_list|,
name|length
argument_list|)
expr_stmt|;
break|break;
case|case
name|RADCMD_STATUS_SER
case|:
name|printf
argument_list|(
literal|" rad-status-serv %d"
argument_list|,
name|length
argument_list|)
expr_stmt|;
break|break;
case|case
name|RADCMD_STATUS_CLI
case|:
name|printf
argument_list|(
literal|" rad-status-cli %d"
argument_list|,
name|length
argument_list|)
expr_stmt|;
break|break;
case|case
name|RADCMD_RESERVED
case|:
name|printf
argument_list|(
literal|" rad-reserved %d"
argument_list|,
name|length
argument_list|)
expr_stmt|;
break|break;
default|default:
name|printf
argument_list|(
literal|" rad-#%d %d"
argument_list|,
name|rad
operator|->
name|code
argument_list|,
name|length
argument_list|)
expr_stmt|;
break|break;
block|}
name|printf
argument_list|(
literal|" [id %d]"
argument_list|,
name|rad
operator|->
name|id
argument_list|)
expr_stmt|;
if|if
condition|(
name|i
condition|)
name|radius_attr_print
argument_list|(
operator|(
operator|(
name|u_char
operator|*
operator|)
operator|(
name|rad
operator|+
literal|1
operator|)
operator|)
argument_list|,
name|i
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

