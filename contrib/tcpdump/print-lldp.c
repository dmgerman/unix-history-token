begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (c) 1998-2007 The TCPDUMP project  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that: (1) source code  * distributions retain the above copyright notice and this paragraph  * in its entirety, and (2) distributions including binary code include  * the above copyright notice and this paragraph in its entirety in  * the documentation or other materials provided with the distribution.  * THIS SOFTWARE IS PROVIDED ``AS IS'' AND  * WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, WITHOUT  * LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS  * FOR A PARTICULAR PURPOSE.  *  * Original code by Hannes Gredler (hannes@juniper.net)  * IEEE and TIA extensions by Carles Kishimoto<carles.kishimoto@gmail.com>  * DCBX extensions by Kaladhar Musunuru<kaladharm@sourceforge.net>  */
end_comment

begin_comment
comment|/* \summary: IEEE 802.1ab Link Layer Discovery Protocol (LLDP) printer */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|HAVE_CONFIG_H
end_ifdef

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<netdissect-stdinc.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|"netdissect.h"
end_include

begin_include
include|#
directive|include
file|"extract.h"
end_include

begin_include
include|#
directive|include
file|"addrtoname.h"
end_include

begin_include
include|#
directive|include
file|"af.h"
end_include

begin_include
include|#
directive|include
file|"oui.h"
end_include

begin_define
define|#
directive|define
name|LLDP_EXTRACT_TYPE
parameter_list|(
name|x
parameter_list|)
value|(((x)&0xfe00)>>9)
end_define

begin_define
define|#
directive|define
name|LLDP_EXTRACT_LEN
parameter_list|(
name|x
parameter_list|)
value|((x)&0x01ff)
end_define

begin_comment
comment|/*  * TLV type codes  */
end_comment

begin_define
define|#
directive|define
name|LLDP_END_TLV
value|0
end_define

begin_define
define|#
directive|define
name|LLDP_CHASSIS_ID_TLV
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_PORT_ID_TLV
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_TTL_TLV
value|3
end_define

begin_define
define|#
directive|define
name|LLDP_PORT_DESCR_TLV
value|4
end_define

begin_define
define|#
directive|define
name|LLDP_SYSTEM_NAME_TLV
value|5
end_define

begin_define
define|#
directive|define
name|LLDP_SYSTEM_DESCR_TLV
value|6
end_define

begin_define
define|#
directive|define
name|LLDP_SYSTEM_CAP_TLV
value|7
end_define

begin_define
define|#
directive|define
name|LLDP_MGMT_ADDR_TLV
value|8
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TLV
value|127
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_tlv_values
index|[]
init|=
block|{
block|{
name|LLDP_END_TLV
block|,
literal|"End"
block|}
block|,
block|{
name|LLDP_CHASSIS_ID_TLV
block|,
literal|"Chassis ID"
block|}
block|,
block|{
name|LLDP_PORT_ID_TLV
block|,
literal|"Port ID"
block|}
block|,
block|{
name|LLDP_TTL_TLV
block|,
literal|"Time to Live"
block|}
block|,
block|{
name|LLDP_PORT_DESCR_TLV
block|,
literal|"Port Description"
block|}
block|,
block|{
name|LLDP_SYSTEM_NAME_TLV
block|,
literal|"System Name"
block|}
block|,
block|{
name|LLDP_SYSTEM_DESCR_TLV
block|,
literal|"System Description"
block|}
block|,
block|{
name|LLDP_SYSTEM_CAP_TLV
block|,
literal|"System Capabilities"
block|}
block|,
block|{
name|LLDP_MGMT_ADDR_TLV
block|,
literal|"Management Address"
block|}
block|,
block|{
name|LLDP_PRIVATE_TLV
block|,
literal|"Organization specific"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Chassis ID subtypes  */
end_comment

begin_define
define|#
directive|define
name|LLDP_CHASSIS_CHASSIS_COMP_SUBTYPE
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_CHASSIS_INTF_ALIAS_SUBTYPE
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_CHASSIS_PORT_COMP_SUBTYPE
value|3
end_define

begin_define
define|#
directive|define
name|LLDP_CHASSIS_MAC_ADDR_SUBTYPE
value|4
end_define

begin_define
define|#
directive|define
name|LLDP_CHASSIS_NETWORK_ADDR_SUBTYPE
value|5
end_define

begin_define
define|#
directive|define
name|LLDP_CHASSIS_INTF_NAME_SUBTYPE
value|6
end_define

begin_define
define|#
directive|define
name|LLDP_CHASSIS_LOCAL_SUBTYPE
value|7
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_chassis_subtype_values
index|[]
init|=
block|{
block|{
name|LLDP_CHASSIS_CHASSIS_COMP_SUBTYPE
block|,
literal|"Chassis component"
block|}
block|,
block|{
name|LLDP_CHASSIS_INTF_ALIAS_SUBTYPE
block|,
literal|"Interface alias"
block|}
block|,
block|{
name|LLDP_CHASSIS_PORT_COMP_SUBTYPE
block|,
literal|"Port component"
block|}
block|,
block|{
name|LLDP_CHASSIS_MAC_ADDR_SUBTYPE
block|,
literal|"MAC address"
block|}
block|,
block|{
name|LLDP_CHASSIS_NETWORK_ADDR_SUBTYPE
block|,
literal|"Network address"
block|}
block|,
block|{
name|LLDP_CHASSIS_INTF_NAME_SUBTYPE
block|,
literal|"Interface name"
block|}
block|,
block|{
name|LLDP_CHASSIS_LOCAL_SUBTYPE
block|,
literal|"Local"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Port ID subtypes  */
end_comment

begin_define
define|#
directive|define
name|LLDP_PORT_INTF_ALIAS_SUBTYPE
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_PORT_PORT_COMP_SUBTYPE
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_PORT_MAC_ADDR_SUBTYPE
value|3
end_define

begin_define
define|#
directive|define
name|LLDP_PORT_NETWORK_ADDR_SUBTYPE
value|4
end_define

begin_define
define|#
directive|define
name|LLDP_PORT_INTF_NAME_SUBTYPE
value|5
end_define

begin_define
define|#
directive|define
name|LLDP_PORT_AGENT_CIRC_ID_SUBTYPE
value|6
end_define

begin_define
define|#
directive|define
name|LLDP_PORT_LOCAL_SUBTYPE
value|7
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_port_subtype_values
index|[]
init|=
block|{
block|{
name|LLDP_PORT_INTF_ALIAS_SUBTYPE
block|,
literal|"Interface alias"
block|}
block|,
block|{
name|LLDP_PORT_PORT_COMP_SUBTYPE
block|,
literal|"Port component"
block|}
block|,
block|{
name|LLDP_PORT_MAC_ADDR_SUBTYPE
block|,
literal|"MAC address"
block|}
block|,
block|{
name|LLDP_PORT_NETWORK_ADDR_SUBTYPE
block|,
literal|"Network Address"
block|}
block|,
block|{
name|LLDP_PORT_INTF_NAME_SUBTYPE
block|,
literal|"Interface Name"
block|}
block|,
block|{
name|LLDP_PORT_AGENT_CIRC_ID_SUBTYPE
block|,
literal|"Agent circuit ID"
block|}
block|,
block|{
name|LLDP_PORT_LOCAL_SUBTYPE
block|,
literal|"Local"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * System Capabilities  */
end_comment

begin_define
define|#
directive|define
name|LLDP_CAP_OTHER
value|(1<<  0)
end_define

begin_define
define|#
directive|define
name|LLDP_CAP_REPEATER
value|(1<<  1)
end_define

begin_define
define|#
directive|define
name|LLDP_CAP_BRIDGE
value|(1<<  2)
end_define

begin_define
define|#
directive|define
name|LLDP_CAP_WLAN_AP
value|(1<<  3)
end_define

begin_define
define|#
directive|define
name|LLDP_CAP_ROUTER
value|(1<<  4)
end_define

begin_define
define|#
directive|define
name|LLDP_CAP_PHONE
value|(1<<  5)
end_define

begin_define
define|#
directive|define
name|LLDP_CAP_DOCSIS
value|(1<<  6)
end_define

begin_define
define|#
directive|define
name|LLDP_CAP_STATION_ONLY
value|(1<<  7)
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_cap_values
index|[]
init|=
block|{
block|{
name|LLDP_CAP_OTHER
block|,
literal|"Other"
block|}
block|,
block|{
name|LLDP_CAP_REPEATER
block|,
literal|"Repeater"
block|}
block|,
block|{
name|LLDP_CAP_BRIDGE
block|,
literal|"Bridge"
block|}
block|,
block|{
name|LLDP_CAP_WLAN_AP
block|,
literal|"WLAN AP"
block|}
block|,
block|{
name|LLDP_CAP_ROUTER
block|,
literal|"Router"
block|}
block|,
block|{
name|LLDP_CAP_PHONE
block|,
literal|"Telephone"
block|}
block|,
block|{
name|LLDP_CAP_DOCSIS
block|,
literal|"Docsis"
block|}
block|,
block|{
name|LLDP_CAP_STATION_ONLY
block|,
literal|"Station Only"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_PORT_VLAN_ID
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_PROTOCOL_VLAN_ID
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_VLAN_NAME
value|3
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_PROTOCOL_IDENTITY
value|4
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_CONGESTION_NOTIFICATION
value|8
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_ETS_CONFIGURATION
value|9
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_ETS_RECOMMENDATION
value|10
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_PFC_CONFIGURATION
value|11
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_APPLICATION_PRIORITY
value|12
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_EVB
value|13
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_CDCP
value|14
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_8021_subtype_values
index|[]
init|=
block|{
block|{
name|LLDP_PRIVATE_8021_SUBTYPE_PORT_VLAN_ID
block|,
literal|"Port VLAN Id"
block|}
block|,
block|{
name|LLDP_PRIVATE_8021_SUBTYPE_PROTOCOL_VLAN_ID
block|,
literal|"Port and Protocol VLAN ID"
block|}
block|,
block|{
name|LLDP_PRIVATE_8021_SUBTYPE_VLAN_NAME
block|,
literal|"VLAN name"
block|}
block|,
block|{
name|LLDP_PRIVATE_8021_SUBTYPE_PROTOCOL_IDENTITY
block|,
literal|"Protocol Identity"
block|}
block|,
block|{
name|LLDP_PRIVATE_8021_SUBTYPE_CONGESTION_NOTIFICATION
block|,
literal|"Congestion Notification"
block|}
block|,
block|{
name|LLDP_PRIVATE_8021_SUBTYPE_ETS_CONFIGURATION
block|,
literal|"ETS Configuration"
block|}
block|,
block|{
name|LLDP_PRIVATE_8021_SUBTYPE_ETS_RECOMMENDATION
block|,
literal|"ETS Recommendation"
block|}
block|,
block|{
name|LLDP_PRIVATE_8021_SUBTYPE_PFC_CONFIGURATION
block|,
literal|"Priority Flow Control Configuration"
block|}
block|,
block|{
name|LLDP_PRIVATE_8021_SUBTYPE_APPLICATION_PRIORITY
block|,
literal|"Application Priority"
block|}
block|,
block|{
name|LLDP_PRIVATE_8021_SUBTYPE_EVB
block|,
literal|"EVB"
block|}
block|,
block|{
name|LLDP_PRIVATE_8021_SUBTYPE_CDCP
block|,
literal|"CDCP"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_8021_PORT_PROTOCOL_VLAN_SUPPORT
value|(1<<  1)
end_define

begin_define
define|#
directive|define
name|LLDP_8021_PORT_PROTOCOL_VLAN_STATUS
value|(1<<  2)
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_8021_port_protocol_id_values
index|[]
init|=
block|{
block|{
name|LLDP_8021_PORT_PROTOCOL_VLAN_SUPPORT
block|,
literal|"supported"
block|}
block|,
block|{
name|LLDP_8021_PORT_PROTOCOL_VLAN_STATUS
block|,
literal|"enabled"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8023_SUBTYPE_MACPHY
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8023_SUBTYPE_MDIPOWER
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8023_SUBTYPE_LINKAGGR
value|3
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8023_SUBTYPE_MTU
value|4
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_8023_subtype_values
index|[]
init|=
block|{
block|{
name|LLDP_PRIVATE_8023_SUBTYPE_MACPHY
block|,
literal|"MAC/PHY configuration/status"
block|}
block|,
block|{
name|LLDP_PRIVATE_8023_SUBTYPE_MDIPOWER
block|,
literal|"Power via MDI"
block|}
block|,
block|{
name|LLDP_PRIVATE_8023_SUBTYPE_LINKAGGR
block|,
literal|"Link aggregation"
block|}
block|,
block|{
name|LLDP_PRIVATE_8023_SUBTYPE_MTU
block|,
literal|"Max frame size"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_SUBTYPE_CAPABILITIES
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_SUBTYPE_NETWORK_POLICY
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_SUBTYPE_LOCAL_ID
value|3
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_SUBTYPE_EXTENDED_POWER_MDI
value|4
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_HARDWARE_REV
value|5
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_FIRMWARE_REV
value|6
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_SOFTWARE_REV
value|7
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_SERIAL_NUMBER
value|8
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_MANUFACTURER_NAME
value|9
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_MODEL_NAME
value|10
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_ASSET_ID
value|11
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_tia_subtype_values
index|[]
init|=
block|{
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_CAPABILITIES
block|,
literal|"LLDP-MED Capabilities"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_NETWORK_POLICY
block|,
literal|"Network policy"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_LOCAL_ID
block|,
literal|"Location identification"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_EXTENDED_POWER_MDI
block|,
literal|"Extended power-via-MDI"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_HARDWARE_REV
block|,
literal|"Inventory - hardware revision"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_FIRMWARE_REV
block|,
literal|"Inventory - firmware revision"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_SOFTWARE_REV
block|,
literal|"Inventory - software revision"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_SERIAL_NUMBER
block|,
literal|"Inventory - serial number"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_MANUFACTURER_NAME
block|,
literal|"Inventory - manufacturer name"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_MODEL_NAME
block|,
literal|"Inventory - model name"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_ASSET_ID
block|,
literal|"Inventory - asset ID"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_LOCATION_ALTITUDE_METERS
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_LOCATION_ALTITUDE_FLOORS
value|2
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_tia_location_altitude_type_values
index|[]
init|=
block|{
block|{
name|LLDP_PRIVATE_TIA_LOCATION_ALTITUDE_METERS
block|,
literal|"meters"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_LOCATION_ALTITUDE_FLOORS
block|,
literal|"floors"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ANSI/TIA-1057 - Annex B */
end_comment

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_LOCATION_LCI_CATYPE_A1
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_LOCATION_LCI_CATYPE_A2
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_LOCATION_LCI_CATYPE_A3
value|3
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_LOCATION_LCI_CATYPE_A4
value|4
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_LOCATION_LCI_CATYPE_A5
value|5
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_TIA_LOCATION_LCI_CATYPE_A6
value|6
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_tia_location_lci_catype_values
index|[]
init|=
block|{
block|{
name|LLDP_PRIVATE_TIA_LOCATION_LCI_CATYPE_A1
block|,
literal|"national subdivisions (state,canton,region,province,prefecture)"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_LOCATION_LCI_CATYPE_A2
block|,
literal|"county, parish, gun, district"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_LOCATION_LCI_CATYPE_A3
block|,
literal|"city, township, shi"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_LOCATION_LCI_CATYPE_A4
block|,
literal|"city division, borough, city district, ward chou"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_LOCATION_LCI_CATYPE_A5
block|,
literal|"neighborhood, block"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_LOCATION_LCI_CATYPE_A6
block|,
literal|"street"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_tia_location_lci_what_values
index|[]
init|=
block|{
block|{
literal|0
block|,
literal|"location of DHCP server"
block|}
block|,
block|{
literal|1
block|,
literal|"location of the network element believed to be closest to the client"
block|}
block|,
block|{
literal|2
block|,
literal|"location of the client"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * From RFC 3636 - dot3MauType  */
end_comment

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_UNKNOWN
value|0
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_AUI
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10BASE_5
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_FOIRL
value|3
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10BASE_2
value|4
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10BASE_T
value|5
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10BASE_FP
value|6
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10BASE_FB
value|7
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10BASE_FL
value|8
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10BROAD36
value|9
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10BASE_T_HD
value|10
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10BASE_T_FD
value|11
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10BASE_FL_HD
value|12
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10BASE_FL_FD
value|13
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_100BASE_T4
value|14
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_100BASE_TX_HD
value|15
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_100BASE_TX_FD
value|16
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_100BASE_FX_HD
value|17
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_100BASE_FX_FD
value|18
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_100BASE_T2_HD
value|19
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_100BASE_T2_FD
value|20
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_1000BASE_X_HD
value|21
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_1000BASE_X_FD
value|22
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_1000BASE_LX_HD
value|23
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_1000BASE_LX_FD
value|24
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_1000BASE_SX_HD
value|25
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_1000BASE_SX_FD
value|26
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_1000BASE_CX_HD
value|27
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_1000BASE_CX_FD
value|28
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_1000BASE_T_HD
value|29
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_1000BASE_T_FD
value|30
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10GBASE_X
value|31
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10GBASE_LX4
value|32
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10GBASE_R
value|33
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10GBASE_ER
value|34
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10GBASE_LR
value|35
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10GBASE_SR
value|36
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10GBASE_W
value|37
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10GBASE_EW
value|38
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10GBASE_LW
value|39
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_TYPE_10GBASE_SW
value|40
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_mau_types_values
index|[]
init|=
block|{
block|{
name|LLDP_MAU_TYPE_UNKNOWN
block|,
literal|"Unknown"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_AUI
block|,
literal|"AUI"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10BASE_5
block|,
literal|"10BASE_5"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_FOIRL
block|,
literal|"FOIRL"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10BASE_2
block|,
literal|"10BASE2"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10BASE_T
block|,
literal|"10BASET duplex mode unknown"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10BASE_FP
block|,
literal|"10BASEFP"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10BASE_FB
block|,
literal|"10BASEFB"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10BASE_FL
block|,
literal|"10BASEFL duplex mode unknown"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10BROAD36
block|,
literal|"10BROAD36"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10BASE_T_HD
block|,
literal|"10BASET hdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10BASE_T_FD
block|,
literal|"10BASET fdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10BASE_FL_HD
block|,
literal|"10BASEFL hdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10BASE_FL_FD
block|,
literal|"10BASEFL fdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_100BASE_T4
block|,
literal|"100BASET4"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_100BASE_TX_HD
block|,
literal|"100BASETX hdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_100BASE_TX_FD
block|,
literal|"100BASETX fdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_100BASE_FX_HD
block|,
literal|"100BASEFX hdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_100BASE_FX_FD
block|,
literal|"100BASEFX fdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_100BASE_T2_HD
block|,
literal|"100BASET2 hdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_100BASE_T2_FD
block|,
literal|"100BASET2 fdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_1000BASE_X_HD
block|,
literal|"1000BASEX hdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_1000BASE_X_FD
block|,
literal|"1000BASEX fdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_1000BASE_LX_HD
block|,
literal|"1000BASELX hdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_1000BASE_LX_FD
block|,
literal|"1000BASELX fdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_1000BASE_SX_HD
block|,
literal|"1000BASESX hdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_1000BASE_SX_FD
block|,
literal|"1000BASESX fdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_1000BASE_CX_HD
block|,
literal|"1000BASECX hdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_1000BASE_CX_FD
block|,
literal|"1000BASECX fdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_1000BASE_T_HD
block|,
literal|"1000BASET hdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_1000BASE_T_FD
block|,
literal|"1000BASET fdx"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10GBASE_X
block|,
literal|"10GBASEX"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10GBASE_LX4
block|,
literal|"10GBASELX4"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10GBASE_R
block|,
literal|"10GBASER"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10GBASE_ER
block|,
literal|"10GBASEER"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10GBASE_LR
block|,
literal|"10GBASELR"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10GBASE_SR
block|,
literal|"10GBASESR"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10GBASE_W
block|,
literal|"10GBASEW"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10GBASE_EW
block|,
literal|"10GBASEEW"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10GBASE_LW
block|,
literal|"10GBASELW"
block|}
block|,
block|{
name|LLDP_MAU_TYPE_10GBASE_SW
block|,
literal|"10GBASESW"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_8023_AUTONEGOTIATION_SUPPORT
value|(1<<  0)
end_define

begin_define
define|#
directive|define
name|LLDP_8023_AUTONEGOTIATION_STATUS
value|(1<<  1)
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_8023_autonegotiation_values
index|[]
init|=
block|{
block|{
name|LLDP_8023_AUTONEGOTIATION_SUPPORT
block|,
literal|"supported"
block|}
block|,
block|{
name|LLDP_8023_AUTONEGOTIATION_STATUS
block|,
literal|"enabled"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_TIA_CAPABILITY_MED
value|(1<<  0)
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_CAPABILITY_NETWORK_POLICY
value|(1<<  1)
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_CAPABILITY_LOCATION_IDENTIFICATION
value|(1<<  2)
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_CAPABILITY_EXTENDED_POWER_MDI_PSE
value|(1<<  3)
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_CAPABILITY_EXTENDED_POWER_MDI_PD
value|(1<<  4)
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_CAPABILITY_INVENTORY
value|(1<<  5)
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_tia_capabilities_values
index|[]
init|=
block|{
block|{
name|LLDP_TIA_CAPABILITY_MED
block|,
literal|"LLDP-MED capabilities"
block|}
block|,
block|{
name|LLDP_TIA_CAPABILITY_NETWORK_POLICY
block|,
literal|"network policy"
block|}
block|,
block|{
name|LLDP_TIA_CAPABILITY_LOCATION_IDENTIFICATION
block|,
literal|"location identification"
block|}
block|,
block|{
name|LLDP_TIA_CAPABILITY_EXTENDED_POWER_MDI_PSE
block|,
literal|"extended power via MDI-PSE"
block|}
block|,
block|{
name|LLDP_TIA_CAPABILITY_EXTENDED_POWER_MDI_PD
block|,
literal|"extended power via MDI-PD"
block|}
block|,
block|{
name|LLDP_TIA_CAPABILITY_INVENTORY
block|,
literal|"Inventory"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_TIA_DEVICE_TYPE_ENDPOINT_CLASS_1
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_DEVICE_TYPE_ENDPOINT_CLASS_2
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_DEVICE_TYPE_ENDPOINT_CLASS_3
value|3
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_DEVICE_TYPE_NETWORK_CONNECTIVITY
value|4
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_tia_device_type_values
index|[]
init|=
block|{
block|{
name|LLDP_TIA_DEVICE_TYPE_ENDPOINT_CLASS_1
block|,
literal|"endpoint class 1"
block|}
block|,
block|{
name|LLDP_TIA_DEVICE_TYPE_ENDPOINT_CLASS_2
block|,
literal|"endpoint class 2"
block|}
block|,
block|{
name|LLDP_TIA_DEVICE_TYPE_ENDPOINT_CLASS_3
block|,
literal|"endpoint class 3"
block|}
block|,
block|{
name|LLDP_TIA_DEVICE_TYPE_NETWORK_CONNECTIVITY
block|,
literal|"network connectivity"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_TIA_APPLICATION_TYPE_VOICE
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_APPLICATION_TYPE_VOICE_SIGNALING
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_APPLICATION_TYPE_GUEST_VOICE
value|3
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_APPLICATION_TYPE_GUEST_VOICE_SIGNALING
value|4
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_APPLICATION_TYPE_SOFTPHONE_VOICE
value|5
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_APPLICATION_TYPE_VIDEO_CONFERENCING
value|6
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_APPLICATION_TYPE_STREAMING_VIDEO
value|7
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_APPLICATION_TYPE_VIDEO_SIGNALING
value|8
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_tia_application_type_values
index|[]
init|=
block|{
block|{
name|LLDP_TIA_APPLICATION_TYPE_VOICE
block|,
literal|"voice"
block|}
block|,
block|{
name|LLDP_TIA_APPLICATION_TYPE_VOICE_SIGNALING
block|,
literal|"voice signaling"
block|}
block|,
block|{
name|LLDP_TIA_APPLICATION_TYPE_GUEST_VOICE
block|,
literal|"guest voice"
block|}
block|,
block|{
name|LLDP_TIA_APPLICATION_TYPE_GUEST_VOICE_SIGNALING
block|,
literal|"guest voice signaling"
block|}
block|,
block|{
name|LLDP_TIA_APPLICATION_TYPE_SOFTPHONE_VOICE
block|,
literal|"softphone voice"
block|}
block|,
block|{
name|LLDP_TIA_APPLICATION_TYPE_VIDEO_CONFERENCING
block|,
literal|"video conferencing"
block|}
block|,
block|{
name|LLDP_TIA_APPLICATION_TYPE_STREAMING_VIDEO
block|,
literal|"streaming video"
block|}
block|,
block|{
name|LLDP_TIA_APPLICATION_TYPE_VIDEO_SIGNALING
block|,
literal|"video signaling"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_TIA_NETWORK_POLICY_X_BIT
value|(1<< 5)
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_NETWORK_POLICY_T_BIT
value|(1<< 6)
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_NETWORK_POLICY_U_BIT
value|(1<< 7)
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_tia_network_policy_bits_values
index|[]
init|=
block|{
block|{
name|LLDP_TIA_NETWORK_POLICY_U_BIT
block|,
literal|"Unknown"
block|}
block|,
block|{
name|LLDP_TIA_NETWORK_POLICY_T_BIT
block|,
literal|"Tagged"
block|}
block|,
block|{
name|LLDP_TIA_NETWORK_POLICY_X_BIT
block|,
literal|"reserved"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_EXTRACT_NETWORK_POLICY_VLAN
parameter_list|(
name|x
parameter_list|)
value|(((x)&0x1ffe)>>1)
end_define

begin_define
define|#
directive|define
name|LLDP_EXTRACT_NETWORK_POLICY_L2_PRIORITY
parameter_list|(
name|x
parameter_list|)
value|(((x)&0x01ff)>>6)
end_define

begin_define
define|#
directive|define
name|LLDP_EXTRACT_NETWORK_POLICY_DSCP
parameter_list|(
name|x
parameter_list|)
value|((x)&0x003f)
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_LOCATION_DATA_FORMAT_COORDINATE_BASED
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_LOCATION_DATA_FORMAT_CIVIC_ADDRESS
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_LOCATION_DATA_FORMAT_ECS_ELIN
value|3
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_tia_location_data_format_values
index|[]
init|=
block|{
block|{
name|LLDP_TIA_LOCATION_DATA_FORMAT_COORDINATE_BASED
block|,
literal|"coordinate-based LCI"
block|}
block|,
block|{
name|LLDP_TIA_LOCATION_DATA_FORMAT_CIVIC_ADDRESS
block|,
literal|"civic address LCI"
block|}
block|,
block|{
name|LLDP_TIA_LOCATION_DATA_FORMAT_ECS_ELIN
block|,
literal|"ECS ELIN"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_TIA_LOCATION_DATUM_WGS_84
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_LOCATION_DATUM_NAD_83_NAVD_88
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_LOCATION_DATUM_NAD_83_MLLW
value|3
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_tia_location_datum_type_values
index|[]
init|=
block|{
block|{
name|LLDP_TIA_LOCATION_DATUM_WGS_84
block|,
literal|"World Geodesic System 1984"
block|}
block|,
block|{
name|LLDP_TIA_LOCATION_DATUM_NAD_83_NAVD_88
block|,
literal|"North American Datum 1983 (NAVD88)"
block|}
block|,
block|{
name|LLDP_TIA_LOCATION_DATUM_NAD_83_MLLW
block|,
literal|"North American Datum 1983 (MLLW)"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_TIA_POWER_SOURCE_PSE
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_POWER_SOURCE_LOCAL
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_POWER_SOURCE_PSE_AND_LOCAL
value|3
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_tia_power_source_values
index|[]
init|=
block|{
block|{
name|LLDP_TIA_POWER_SOURCE_PSE
block|,
literal|"PSE - primary power source"
block|}
block|,
block|{
name|LLDP_TIA_POWER_SOURCE_LOCAL
block|,
literal|"local - backup power source"
block|}
block|,
block|{
name|LLDP_TIA_POWER_SOURCE_PSE_AND_LOCAL
block|,
literal|"PSE+local - reserved"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_TIA_POWER_PRIORITY_CRITICAL
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_POWER_PRIORITY_HIGH
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_TIA_POWER_PRIORITY_LOW
value|3
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_tia_power_priority_values
index|[]
init|=
block|{
block|{
name|LLDP_TIA_POWER_PRIORITY_CRITICAL
block|,
literal|"critical"
block|}
block|,
block|{
name|LLDP_TIA_POWER_PRIORITY_HIGH
block|,
literal|"high"
block|}
block|,
block|{
name|LLDP_TIA_POWER_PRIORITY_LOW
block|,
literal|"low"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_TIA_POWER_VAL_MAX
value|1024
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_tia_inventory_values
index|[]
init|=
block|{
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_HARDWARE_REV
block|,
literal|"Hardware revision"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_FIRMWARE_REV
block|,
literal|"Firmware revision"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_SOFTWARE_REV
block|,
literal|"Software revision"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_SERIAL_NUMBER
block|,
literal|"Serial number"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_MANUFACTURER_NAME
block|,
literal|"Manufacturer name"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_MODEL_NAME
block|,
literal|"Model name"
block|}
block|,
block|{
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_ASSET_ID
block|,
literal|"Asset ID"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * From RFC 3636 - ifMauAutoNegCapAdvertisedBits  */
end_comment

begin_define
define|#
directive|define
name|LLDP_MAU_PMD_OTHER
value|(1<<  15)
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_PMD_10BASE_T
value|(1<<  14)
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_PMD_10BASE_T_FD
value|(1<<  13)
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_PMD_100BASE_T4
value|(1<<  12)
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_PMD_100BASE_TX
value|(1<<  11)
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_PMD_100BASE_TX_FD
value|(1<<  10)
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_PMD_100BASE_T2
value|(1<<  9)
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_PMD_100BASE_T2_FD
value|(1<<  8)
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_PMD_FDXPAUSE
value|(1<<  7)
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_PMD_FDXAPAUSE
value|(1<<  6)
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_PMD_FDXSPAUSE
value|(1<<  5)
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_PMD_FDXBPAUSE
value|(1<<  4)
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_PMD_1000BASE_X
value|(1<<  3)
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_PMD_1000BASE_X_FD
value|(1<<  2)
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_PMD_1000BASE_T
value|(1<<  1)
end_define

begin_define
define|#
directive|define
name|LLDP_MAU_PMD_1000BASE_T_FD
value|(1<<  0)
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_pmd_capability_values
index|[]
init|=
block|{
block|{
name|LLDP_MAU_PMD_10BASE_T
block|,
literal|"10BASE-T hdx"
block|}
block|,
block|{
name|LLDP_MAU_PMD_10BASE_T_FD
block|,
literal|"10BASE-T fdx"
block|}
block|,
block|{
name|LLDP_MAU_PMD_100BASE_T4
block|,
literal|"100BASE-T4"
block|}
block|,
block|{
name|LLDP_MAU_PMD_100BASE_TX
block|,
literal|"100BASE-TX hdx"
block|}
block|,
block|{
name|LLDP_MAU_PMD_100BASE_TX_FD
block|,
literal|"100BASE-TX fdx"
block|}
block|,
block|{
name|LLDP_MAU_PMD_100BASE_T2
block|,
literal|"100BASE-T2 hdx"
block|}
block|,
block|{
name|LLDP_MAU_PMD_100BASE_T2_FD
block|,
literal|"100BASE-T2 fdx"
block|}
block|,
block|{
name|LLDP_MAU_PMD_FDXPAUSE
block|,
literal|"Pause for fdx links"
block|}
block|,
block|{
name|LLDP_MAU_PMD_FDXAPAUSE
block|,
literal|"Asym PAUSE for fdx"
block|}
block|,
block|{
name|LLDP_MAU_PMD_FDXSPAUSE
block|,
literal|"Sym PAUSE for fdx"
block|}
block|,
block|{
name|LLDP_MAU_PMD_FDXBPAUSE
block|,
literal|"Asym and Sym PAUSE for fdx"
block|}
block|,
block|{
name|LLDP_MAU_PMD_1000BASE_X
block|,
literal|"1000BASE-{X LX SX CX} hdx"
block|}
block|,
block|{
name|LLDP_MAU_PMD_1000BASE_X_FD
block|,
literal|"1000BASE-{X LX SX CX} fdx"
block|}
block|,
block|{
name|LLDP_MAU_PMD_1000BASE_T
block|,
literal|"1000BASE-T hdx"
block|}
block|,
block|{
name|LLDP_MAU_PMD_1000BASE_T_FD
block|,
literal|"1000BASE-T fdx"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_MDI_PORT_CLASS
value|(1<<  0)
end_define

begin_define
define|#
directive|define
name|LLDP_MDI_POWER_SUPPORT
value|(1<<  1)
end_define

begin_define
define|#
directive|define
name|LLDP_MDI_POWER_STATE
value|(1<<  2)
end_define

begin_define
define|#
directive|define
name|LLDP_MDI_PAIR_CONTROL_ABILITY
value|(1<<  3)
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_mdi_values
index|[]
init|=
block|{
block|{
name|LLDP_MDI_PORT_CLASS
block|,
literal|"PSE"
block|}
block|,
block|{
name|LLDP_MDI_POWER_SUPPORT
block|,
literal|"supported"
block|}
block|,
block|{
name|LLDP_MDI_POWER_STATE
block|,
literal|"enabled"
block|}
block|,
block|{
name|LLDP_MDI_PAIR_CONTROL_ABILITY
block|,
literal|"can be controlled"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_MDI_PSE_PORT_POWER_PAIRS_SIGNAL
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_MDI_PSE_PORT_POWER_PAIRS_SPARE
value|2
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_mdi_power_pairs_values
index|[]
init|=
block|{
block|{
name|LLDP_MDI_PSE_PORT_POWER_PAIRS_SIGNAL
block|,
literal|"signal"
block|}
block|,
block|{
name|LLDP_MDI_PSE_PORT_POWER_PAIRS_SPARE
block|,
literal|"spare"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_MDI_POWER_CLASS0
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_MDI_POWER_CLASS1
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_MDI_POWER_CLASS2
value|3
end_define

begin_define
define|#
directive|define
name|LLDP_MDI_POWER_CLASS3
value|4
end_define

begin_define
define|#
directive|define
name|LLDP_MDI_POWER_CLASS4
value|5
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_mdi_power_class_values
index|[]
init|=
block|{
block|{
name|LLDP_MDI_POWER_CLASS0
block|,
literal|"class0"
block|}
block|,
block|{
name|LLDP_MDI_POWER_CLASS1
block|,
literal|"class1"
block|}
block|,
block|{
name|LLDP_MDI_POWER_CLASS2
block|,
literal|"class2"
block|}
block|,
block|{
name|LLDP_MDI_POWER_CLASS3
block|,
literal|"class3"
block|}
block|,
block|{
name|LLDP_MDI_POWER_CLASS4
block|,
literal|"class4"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_AGGREGATION_CAPABILTIY
value|(1<<  0)
end_define

begin_define
define|#
directive|define
name|LLDP_AGGREGATION_STATUS
value|(1<<  1)
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_aggregation_values
index|[]
init|=
block|{
block|{
name|LLDP_AGGREGATION_CAPABILTIY
block|,
literal|"supported"
block|}
block|,
block|{
name|LLDP_AGGREGATION_STATUS
block|,
literal|"enabled"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * DCBX protocol subtypes.  */
end_comment

begin_define
define|#
directive|define
name|LLDP_DCBX_SUBTYPE_1
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_DCBX_SUBTYPE_2
value|2
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_dcbx_subtype_values
index|[]
init|=
block|{
block|{
name|LLDP_DCBX_SUBTYPE_1
block|,
literal|"DCB Capability Exchange Protocol Rev 1"
block|}
block|,
block|{
name|LLDP_DCBX_SUBTYPE_2
block|,
literal|"DCB Capability Exchange Protocol Rev 1.01"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_DCBX_CONTROL_TLV
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_DCBX_PRIORITY_GROUPS_TLV
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_DCBX_PRIORITY_FLOW_CONTROL_TLV
value|3
end_define

begin_define
define|#
directive|define
name|LLDP_DCBX_APPLICATION_TLV
value|4
end_define

begin_comment
comment|/*  * Interface numbering subtypes.  */
end_comment

begin_define
define|#
directive|define
name|LLDP_INTF_NUMB_IFX_SUBTYPE
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_INTF_NUMB_SYSPORT_SUBTYPE
value|3
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_intf_numb_subtype_values
index|[]
init|=
block|{
block|{
name|LLDP_INTF_NUMB_IFX_SUBTYPE
block|,
literal|"Interface Index"
block|}
block|,
block|{
name|LLDP_INTF_NUMB_SYSPORT_SUBTYPE
block|,
literal|"System Port Number"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|LLDP_INTF_NUM_LEN
value|5
end_define

begin_define
define|#
directive|define
name|LLDP_EVB_MODE_NOT_SUPPORTED
value|0
end_define

begin_define
define|#
directive|define
name|LLDP_EVB_MODE_EVB_BRIDGE
value|1
end_define

begin_define
define|#
directive|define
name|LLDP_EVB_MODE_EVB_STATION
value|2
end_define

begin_define
define|#
directive|define
name|LLDP_EVB_MODE_RESERVED
value|3
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_evb_mode_values
index|[]
init|=
block|{
block|{
name|LLDP_EVB_MODE_NOT_SUPPORTED
block|,
literal|"Not Supported"
block|}
block|,
block|{
name|LLDP_EVB_MODE_EVB_BRIDGE
block|,
literal|"EVB Bridge"
block|}
block|,
block|{
name|LLDP_EVB_MODE_EVB_STATION
block|,
literal|"EVB Staion"
block|}
block|,
block|{
name|LLDP_EVB_MODE_RESERVED
block|,
literal|"Reserved for future Standardization"
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|NO_OF_BITS
value|8
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_CONGESTION_NOTIFICATION_LENGTH
value|6
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_ETS_CONFIGURATION_LENGTH
value|25
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_ETS_RECOMMENDATION_LENGTH
value|25
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_PFC_CONFIGURATION_LENGTH
value|6
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_APPLICATION_PRIORITY_MIN_LENGTH
value|5
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_EVB_LENGTH
value|9
end_define

begin_define
define|#
directive|define
name|LLDP_PRIVATE_8021_SUBTYPE_CDCP_MIN_LENGTH
value|8
end_define

begin_define
define|#
directive|define
name|LLDP_IANA_SUBTYPE_MUDURL
value|1
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|lldp_iana_subtype_values
index|[]
init|=
block|{
block|{
name|LLDP_IANA_SUBTYPE_MUDURL
block|,
literal|"MUD-URL"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
name|print_ets_priority_assignment_table
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|ptr
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Priority Assignment Table"
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t     Priority : 0   1   2   3   4   5   6   7"
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t     Value    : %-3d %-3d %-3d %-3d %-3d %-3d %-3d %-3d"
operator|,
name|ptr
index|[
literal|0
index|]
operator|>>
literal|4
operator|,
name|ptr
index|[
literal|0
index|]
operator|&
literal|0x0f
operator|,
name|ptr
index|[
literal|1
index|]
operator|>>
literal|4
operator|,
name|ptr
index|[
literal|1
index|]
operator|&
literal|0x0f
operator|,
name|ptr
index|[
literal|2
index|]
operator|>>
literal|4
operator|,
name|ptr
index|[
literal|2
index|]
operator|&
literal|0x0f
operator|,
name|ptr
index|[
literal|3
index|]
operator|>>
literal|4
operator|,
name|ptr
index|[
literal|3
index|]
operator|&
literal|0x0f
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|print_tc_bandwidth_table
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|ptr
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    TC Bandwidth Table"
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t     TC%%   : 0   1   2   3   4   5   6   7"
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t     Value : %-3d %-3d %-3d %-3d %-3d %-3d %-3d %-3d"
operator|,
name|ptr
index|[
literal|0
index|]
operator|,
name|ptr
index|[
literal|1
index|]
operator|,
name|ptr
index|[
literal|2
index|]
operator|,
name|ptr
index|[
literal|3
index|]
operator|,
name|ptr
index|[
literal|4
index|]
operator|,
name|ptr
index|[
literal|5
index|]
operator|,
name|ptr
index|[
literal|6
index|]
operator|,
name|ptr
index|[
literal|7
index|]
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|print_tsa_assignment_table
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|ptr
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    TSA Assignment Table"
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t     Traffic Class: 0   1   2   3   4   5   6   7"
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t     Value        : %-3d %-3d %-3d %-3d %-3d %-3d %-3d %-3d"
operator|,
name|ptr
index|[
literal|0
index|]
operator|,
name|ptr
index|[
literal|1
index|]
operator|,
name|ptr
index|[
literal|2
index|]
operator|,
name|ptr
index|[
literal|3
index|]
operator|,
name|ptr
index|[
literal|4
index|]
operator|,
name|ptr
index|[
literal|5
index|]
operator|,
name|ptr
index|[
literal|6
index|]
operator|,
name|ptr
index|[
literal|7
index|]
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Print IEEE 802.1 private extensions. (802.1AB annex E)  */
end_comment

begin_function
specifier|static
name|int
name|lldp_private_8021_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|tptr
parameter_list|,
name|u_int
name|tlv_len
parameter_list|)
block|{
name|int
name|subtype
decl_stmt|,
name|hexdump
init|=
name|FALSE
decl_stmt|;
name|u_int
name|sublen
decl_stmt|;
name|u_int
name|tval
decl_stmt|;
name|uint8_t
name|i
decl_stmt|;
if|if
condition|(
name|tlv_len
operator|<
literal|4
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|subtype
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|3
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t  %s Subtype (%u)"
operator|,
name|tok2str
argument_list|(
name|lldp_8021_subtype_values
argument_list|,
literal|"unknown"
argument_list|,
name|subtype
argument_list|)
operator|,
name|subtype
operator|)
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|subtype
condition|)
block|{
case|case
name|LLDP_PRIVATE_8021_SUBTYPE_PORT_VLAN_ID
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|6
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    port vlan id (PVID): %u"
operator|,
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
literal|4
argument_list|)
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_PRIVATE_8021_SUBTYPE_PROTOCOL_VLAN_ID
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|7
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    port and protocol vlan id (PPVID): %u, flags [%s] (0x%02x)"
operator|,
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
literal|5
argument_list|)
operator|,
name|bittok2str
argument_list|(
name|lldp_8021_port_protocol_id_values
argument_list|,
literal|"none"
argument_list|,
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
argument_list|)
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_PRIVATE_8021_SUBTYPE_VLAN_NAME
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|6
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    vlan id (VID): %u"
operator|,
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
literal|4
argument_list|)
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|tlv_len
operator|<
literal|7
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|sublen
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|6
operator|)
expr_stmt|;
if|if
condition|(
name|tlv_len
operator|<
literal|7
operator|+
name|sublen
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    vlan name: "
operator|)
argument_list|)
expr_stmt|;
name|safeputs
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|7
argument_list|,
name|sublen
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_PRIVATE_8021_SUBTYPE_PROTOCOL_IDENTITY
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|5
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|sublen
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
expr_stmt|;
if|if
condition|(
name|tlv_len
operator|<
literal|5
operator|+
name|sublen
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    protocol identity: "
operator|)
argument_list|)
expr_stmt|;
name|safeputs
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|5
argument_list|,
name|sublen
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_PRIVATE_8021_SUBTYPE_CONGESTION_NOTIFICATION
case|:
if|if
condition|(
name|tlv_len
operator|<
name|LLDP_PRIVATE_8021_SUBTYPE_CONGESTION_NOTIFICATION_LENGTH
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|tval
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Pre-Priority CNPV Indicator"
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t     Priority : 0  1  2  3  4  5  6  7"
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t     Value    : "
operator|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|NO_OF_BITS
condition|;
name|i
operator|++
control|)
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%-2d "
operator|,
operator|(
name|tval
operator|>>
name|i
operator|)
operator|&
literal|0x01
operator|)
argument_list|)
expr_stmt|;
name|tval
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|5
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Pre-Priority Ready Indicator"
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t     Priority : 0  1  2  3  4  5  6  7"
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t     Value    : "
operator|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|NO_OF_BITS
condition|;
name|i
operator|++
control|)
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%-2d "
operator|,
operator|(
name|tval
operator|>>
name|i
operator|)
operator|&
literal|0x01
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_PRIVATE_8021_SUBTYPE_ETS_CONFIGURATION
case|:
if|if
condition|(
name|tlv_len
operator|<
name|LLDP_PRIVATE_8021_SUBTYPE_ETS_CONFIGURATION_LENGTH
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|tval
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Willing:%d, CBS:%d, RES:%d, Max TCs:%d"
operator|,
name|tval
operator|>>
literal|7
operator|,
operator|(
name|tval
operator|>>
literal|6
operator|)
operator|&
literal|0x02
operator|,
operator|(
name|tval
operator|>>
literal|3
operator|)
operator|&
literal|0x07
operator|,
name|tval
operator|&
literal|0x07
operator|)
argument_list|)
expr_stmt|;
comment|/*Print Priority Assignment Table*/
name|print_ets_priority_assignment_table
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|5
argument_list|)
expr_stmt|;
comment|/*Print TC Bandwidth Table*/
name|print_tc_bandwidth_table
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|9
argument_list|)
expr_stmt|;
comment|/* Print TSA Assignment Table */
name|print_tsa_assignment_table
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|17
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_PRIVATE_8021_SUBTYPE_ETS_RECOMMENDATION
case|:
if|if
condition|(
name|tlv_len
operator|<
name|LLDP_PRIVATE_8021_SUBTYPE_ETS_RECOMMENDATION_LENGTH
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    RES: %d"
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
operator|)
argument_list|)
expr_stmt|;
comment|/*Print Priority Assignment Table */
name|print_ets_priority_assignment_table
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|5
argument_list|)
expr_stmt|;
comment|/*Print TC Bandwidth Table */
name|print_tc_bandwidth_table
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|9
argument_list|)
expr_stmt|;
comment|/* Print TSA Assignment Table */
name|print_tsa_assignment_table
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|17
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_PRIVATE_8021_SUBTYPE_PFC_CONFIGURATION
case|:
if|if
condition|(
name|tlv_len
operator|<
name|LLDP_PRIVATE_8021_SUBTYPE_PFC_CONFIGURATION_LENGTH
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|tval
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Willing: %d, MBC: %d, RES: %d, PFC cap:%d "
operator|,
name|tval
operator|>>
literal|7
operator|,
operator|(
name|tval
operator|>>
literal|6
operator|)
operator|&
literal|0x01
operator|,
operator|(
name|tval
operator|>>
literal|4
operator|)
operator|&
literal|0x03
operator|,
operator|(
name|tval
operator|&
literal|0x0f
operator|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    PFC Enable"
operator|)
argument_list|)
expr_stmt|;
name|tval
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|5
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t     Priority : 0  1  2  3  4  5  6  7"
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t     Value    : "
operator|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|NO_OF_BITS
condition|;
name|i
operator|++
control|)
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%-2d "
operator|,
operator|(
name|tval
operator|>>
name|i
operator|)
operator|&
literal|0x01
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_PRIVATE_8021_SUBTYPE_APPLICATION_PRIORITY
case|:
if|if
condition|(
name|tlv_len
operator|<
name|LLDP_PRIVATE_8021_SUBTYPE_APPLICATION_PRIORITY_MIN_LENGTH
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    RES: %d"
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|tlv_len
operator|<=
name|LLDP_PRIVATE_8021_SUBTYPE_APPLICATION_PRIORITY_MIN_LENGTH
condition|)
block|{
return|return
name|hexdump
return|;
block|}
comment|/*  Length of Application Priority Table */
name|sublen
operator|=
name|tlv_len
operator|-
literal|5
expr_stmt|;
if|if
condition|(
name|sublen
operator|%
literal|3
operator|!=
literal|0
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|i
operator|=
literal|0
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Application Priority Table"
operator|)
argument_list|)
expr_stmt|;
while|while
condition|(
name|i
operator|<
name|sublen
condition|)
block|{
name|tval
operator|=
operator|*
operator|(
name|tptr
operator|+
name|i
operator|+
literal|5
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      Priority: %d, RES: %d, Sel: %d"
operator|,
name|tval
operator|>>
literal|5
operator|,
operator|(
name|tval
operator|>>
literal|3
operator|)
operator|&
literal|0x03
operator|,
operator|(
name|tval
operator|&
literal|0x07
operator|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"Protocol ID: %d"
operator|,
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
name|i
operator|+
literal|5
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|i
operator|=
name|i
operator|+
literal|3
expr_stmt|;
block|}
break|break;
case|case
name|LLDP_PRIVATE_8021_SUBTYPE_EVB
case|:
if|if
condition|(
name|tlv_len
operator|<
name|LLDP_PRIVATE_8021_SUBTYPE_EVB_LENGTH
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    EVB Bridge Status"
operator|)
argument_list|)
expr_stmt|;
name|tval
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      RES: %d, BGID: %d, RRCAP: %d, RRCTR: %d"
operator|,
name|tval
operator|>>
literal|3
operator|,
operator|(
name|tval
operator|>>
literal|2
operator|)
operator|&
literal|0x01
operator|,
operator|(
name|tval
operator|>>
literal|1
operator|)
operator|&
literal|0x01
operator|,
name|tval
operator|&
literal|0x01
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    EVB Station Status"
operator|)
argument_list|)
expr_stmt|;
name|tval
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|5
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      RES: %d, SGID: %d, RRREQ: %d,RRSTAT: %d"
operator|,
name|tval
operator|>>
literal|4
operator|,
operator|(
name|tval
operator|>>
literal|3
operator|)
operator|&
literal|0x01
operator|,
operator|(
name|tval
operator|>>
literal|2
operator|)
operator|&
literal|0x01
operator|,
name|tval
operator|&
literal|0x03
operator|)
argument_list|)
expr_stmt|;
name|tval
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|6
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    R: %d, RTE: %d, "
operator|,
name|tval
operator|>>
literal|5
operator|,
name|tval
operator|&
literal|0x1f
operator|)
argument_list|)
expr_stmt|;
name|tval
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|7
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"EVB Mode: %s [%d]"
operator|,
name|tok2str
argument_list|(
name|lldp_evb_mode_values
argument_list|,
literal|"unknown"
argument_list|,
name|tval
operator|>>
literal|6
argument_list|)
operator|,
name|tval
operator|>>
literal|6
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    ROL: %d, RWD: %d, "
operator|,
operator|(
name|tval
operator|>>
literal|5
operator|)
operator|&
literal|0x01
operator|,
name|tval
operator|&
literal|0x1f
operator|)
argument_list|)
expr_stmt|;
name|tval
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|8
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"RES: %d, ROL: %d, RKA: %d"
operator|,
name|tval
operator|>>
literal|6
operator|,
operator|(
name|tval
operator|>>
literal|5
operator|)
operator|&
literal|0x01
operator|,
name|tval
operator|&
literal|0x1f
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_PRIVATE_8021_SUBTYPE_CDCP
case|:
if|if
condition|(
name|tlv_len
operator|<
name|LLDP_PRIVATE_8021_SUBTYPE_CDCP_MIN_LENGTH
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|tval
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Role: %d, RES: %d, Scomp: %d "
operator|,
name|tval
operator|>>
literal|7
operator|,
operator|(
name|tval
operator|>>
literal|4
operator|)
operator|&
literal|0x07
operator|,
operator|(
name|tval
operator|>>
literal|3
operator|)
operator|&
literal|0x01
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"ChnCap: %d"
operator|,
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
literal|6
argument_list|)
operator|&
literal|0x0fff
operator|)
argument_list|)
expr_stmt|;
name|sublen
operator|=
name|tlv_len
operator|-
literal|8
expr_stmt|;
if|if
condition|(
name|sublen
operator|%
literal|3
operator|!=
literal|0
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|i
operator|=
literal|0
expr_stmt|;
while|while
condition|(
name|i
operator|<
name|sublen
condition|)
block|{
name|tval
operator|=
name|EXTRACT_24BITS
argument_list|(
name|tptr
operator|+
name|i
operator|+
literal|8
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    SCID: %d, SVID: %d"
operator|,
name|tval
operator|>>
literal|12
operator|,
name|tval
operator|&
literal|0x000fff
operator|)
argument_list|)
expr_stmt|;
name|i
operator|=
name|i
operator|+
literal|3
expr_stmt|;
block|}
break|break;
default|default:
name|hexdump
operator|=
name|TRUE
expr_stmt|;
break|break;
block|}
return|return
name|hexdump
return|;
block|}
end_function

begin_comment
comment|/*  * Print IEEE 802.3 private extensions. (802.3bc)  */
end_comment

begin_function
specifier|static
name|int
name|lldp_private_8023_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|tptr
parameter_list|,
name|u_int
name|tlv_len
parameter_list|)
block|{
name|int
name|subtype
decl_stmt|,
name|hexdump
init|=
name|FALSE
decl_stmt|;
if|if
condition|(
name|tlv_len
operator|<
literal|4
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|subtype
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|3
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t  %s Subtype (%u)"
operator|,
name|tok2str
argument_list|(
name|lldp_8023_subtype_values
argument_list|,
literal|"unknown"
argument_list|,
name|subtype
argument_list|)
operator|,
name|subtype
operator|)
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|subtype
condition|)
block|{
case|case
name|LLDP_PRIVATE_8023_SUBTYPE_MACPHY
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|9
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    autonegotiation [%s] (0x%02x)"
operator|,
name|bittok2str
argument_list|(
name|lldp_8023_autonegotiation_values
argument_list|,
literal|"none"
argument_list|,
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
argument_list|)
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    PMD autoneg capability [%s] (0x%04x)"
operator|,
name|bittok2str
argument_list|(
name|lldp_pmd_capability_values
argument_list|,
literal|"unknown"
argument_list|,
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
literal|5
argument_list|)
argument_list|)
operator|,
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
literal|5
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    MAU type %s (0x%04x)"
operator|,
name|tok2str
argument_list|(
name|lldp_mau_types_values
argument_list|,
literal|"unknown"
argument_list|,
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
literal|7
argument_list|)
argument_list|)
operator|,
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
literal|7
argument_list|)
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_PRIVATE_8023_SUBTYPE_MDIPOWER
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|7
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    MDI power support [%s], power pair %s, power class %s"
operator|,
name|bittok2str
argument_list|(
name|lldp_mdi_values
argument_list|,
literal|"none"
argument_list|,
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
argument_list|)
operator|,
name|tok2str
argument_list|(
name|lldp_mdi_power_pairs_values
argument_list|,
literal|"unknown"
argument_list|,
operator|*
operator|(
name|tptr
operator|+
literal|5
operator|)
argument_list|)
operator|,
name|tok2str
argument_list|(
name|lldp_mdi_power_class_values
argument_list|,
literal|"unknown"
argument_list|,
operator|*
operator|(
name|tptr
operator|+
literal|6
operator|)
argument_list|)
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_PRIVATE_8023_SUBTYPE_LINKAGGR
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|9
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    aggregation status [%s], aggregation port ID %u"
operator|,
name|bittok2str
argument_list|(
name|lldp_aggregation_values
argument_list|,
literal|"none"
argument_list|,
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
argument_list|)
operator|,
name|EXTRACT_32BITS
argument_list|(
name|tptr
operator|+
literal|5
argument_list|)
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_PRIVATE_8023_SUBTYPE_MTU
case|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    MTU size %u"
operator|,
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
literal|4
argument_list|)
operator|)
argument_list|)
expr_stmt|;
break|break;
default|default:
name|hexdump
operator|=
name|TRUE
expr_stmt|;
break|break;
block|}
return|return
name|hexdump
return|;
block|}
end_function

begin_comment
comment|/*  * Extract 34bits of latitude/longitude coordinates.  */
end_comment

begin_function
specifier|static
name|uint64_t
name|lldp_extract_latlon
parameter_list|(
specifier|const
name|u_char
modifier|*
name|tptr
parameter_list|)
block|{
name|uint64_t
name|latlon
decl_stmt|;
name|latlon
operator|=
operator|*
name|tptr
operator|&
literal|0x3
expr_stmt|;
name|latlon
operator|=
operator|(
name|latlon
operator|<<
literal|32
operator|)
operator||
name|EXTRACT_32BITS
argument_list|(
name|tptr
operator|+
literal|1
argument_list|)
expr_stmt|;
return|return
name|latlon
return|;
block|}
end_function

begin_comment
comment|/* objects defined in IANA subtype 00 00 5e  * (right now there is only one)  */
end_comment

begin_function
specifier|static
name|int
name|lldp_private_iana_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|tptr
parameter_list|,
name|u_int
name|tlv_len
parameter_list|)
block|{
name|int
name|subtype
decl_stmt|,
name|hexdump
init|=
name|FALSE
decl_stmt|;
if|if
condition|(
name|tlv_len
operator|<
literal|8
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|subtype
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|3
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t  %s Subtype (%u)"
operator|,
name|tok2str
argument_list|(
name|lldp_iana_subtype_values
argument_list|,
literal|"unknown"
argument_list|,
name|subtype
argument_list|)
operator|,
name|subtype
operator|)
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|subtype
condition|)
block|{
case|case
name|LLDP_IANA_SUBTYPE_MUDURL
case|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t  MUD-URL="
operator|)
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|fn_printn
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|4
argument_list|,
name|tlv_len
operator|-
literal|4
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
break|break;
default|default:
name|hexdump
operator|=
name|TRUE
expr_stmt|;
block|}
return|return
name|hexdump
return|;
block|}
end_function

begin_comment
comment|/*  * Print private TIA extensions.  */
end_comment

begin_function
specifier|static
name|int
name|lldp_private_tia_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|tptr
parameter_list|,
name|u_int
name|tlv_len
parameter_list|)
block|{
name|int
name|subtype
decl_stmt|,
name|hexdump
init|=
name|FALSE
decl_stmt|;
name|uint8_t
name|location_format
decl_stmt|;
name|uint16_t
name|power_val
decl_stmt|;
name|u_int
name|lci_len
decl_stmt|;
name|uint8_t
name|ca_type
decl_stmt|,
name|ca_len
decl_stmt|;
if|if
condition|(
name|tlv_len
operator|<
literal|4
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|subtype
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|3
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t  %s Subtype (%u)"
operator|,
name|tok2str
argument_list|(
name|lldp_tia_subtype_values
argument_list|,
literal|"unknown"
argument_list|,
name|subtype
argument_list|)
operator|,
name|subtype
operator|)
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|subtype
condition|)
block|{
case|case
name|LLDP_PRIVATE_TIA_SUBTYPE_CAPABILITIES
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|7
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Media capabilities [%s] (0x%04x)"
operator|,
name|bittok2str
argument_list|(
name|lldp_tia_capabilities_values
argument_list|,
literal|"none"
argument_list|,
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
literal|4
argument_list|)
argument_list|)
operator|,
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
literal|4
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Device type [%s] (0x%02x)"
operator|,
name|tok2str
argument_list|(
name|lldp_tia_device_type_values
argument_list|,
literal|"unknown"
argument_list|,
operator|*
operator|(
name|tptr
operator|+
literal|6
operator|)
argument_list|)
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|6
operator|)
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_PRIVATE_TIA_SUBTYPE_NETWORK_POLICY
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|8
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Application type [%s] (0x%02x)"
operator|,
name|tok2str
argument_list|(
name|lldp_tia_application_type_values
argument_list|,
literal|"none"
argument_list|,
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
argument_list|)
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|", Flags [%s]"
operator|,
name|bittok2str
argument_list|(
name|lldp_tia_network_policy_bits_values
argument_list|,
literal|"none"
argument_list|,
operator|*
operator|(
name|tptr
operator|+
literal|5
operator|)
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Vlan id %u"
operator|,
name|LLDP_EXTRACT_NETWORK_POLICY_VLAN
argument_list|(
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
literal|5
argument_list|)
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|", L2 priority %u"
operator|,
name|LLDP_EXTRACT_NETWORK_POLICY_L2_PRIORITY
argument_list|(
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
literal|6
argument_list|)
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|", DSCP value %u"
operator|,
name|LLDP_EXTRACT_NETWORK_POLICY_DSCP
argument_list|(
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
literal|6
argument_list|)
argument_list|)
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_PRIVATE_TIA_SUBTYPE_LOCAL_ID
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|5
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|location_format
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Location data format %s (0x%02x)"
operator|,
name|tok2str
argument_list|(
name|lldp_tia_location_data_format_values
argument_list|,
literal|"unknown"
argument_list|,
name|location_format
argument_list|)
operator|,
name|location_format
operator|)
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|location_format
condition|)
block|{
case|case
name|LLDP_TIA_LOCATION_DATA_FORMAT_COORDINATE_BASED
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|21
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Latitude resolution %u, latitude value %"
name|PRIu64
operator|,
operator|(
operator|*
operator|(
name|tptr
operator|+
literal|5
operator|)
operator|>>
literal|2
operator|)
operator|,
name|lldp_extract_latlon
argument_list|(
name|tptr
operator|+
literal|5
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Longitude resolution %u, longitude value %"
name|PRIu64
operator|,
operator|(
operator|*
operator|(
name|tptr
operator|+
literal|10
operator|)
operator|>>
literal|2
operator|)
operator|,
name|lldp_extract_latlon
argument_list|(
name|tptr
operator|+
literal|10
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Altitude type %s (%u)"
operator|,
name|tok2str
argument_list|(
name|lldp_tia_location_altitude_type_values
argument_list|,
literal|"unknown"
argument_list|,
operator|(
operator|*
operator|(
name|tptr
operator|+
literal|15
operator|)
operator|>>
literal|4
operator|)
argument_list|)
operator|,
operator|(
operator|*
operator|(
name|tptr
operator|+
literal|15
operator|)
operator|>>
literal|4
operator|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Altitude resolution %u, altitude value 0x%x"
operator|,
operator|(
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
literal|15
argument_list|)
operator|>>
literal|6
operator|)
operator|&
literal|0x3f
operator|,
operator|(
operator|(
name|EXTRACT_32BITS
argument_list|(
name|tptr
operator|+
literal|16
argument_list|)
operator|&
literal|0x3fffffff
operator|)
operator|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Datum %s (0x%02x)"
operator|,
name|tok2str
argument_list|(
name|lldp_tia_location_datum_type_values
argument_list|,
literal|"unknown"
argument_list|,
operator|*
operator|(
name|tptr
operator|+
literal|20
operator|)
argument_list|)
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|20
operator|)
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_TIA_LOCATION_DATA_FORMAT_CIVIC_ADDRESS
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|6
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|lci_len
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|5
operator|)
expr_stmt|;
if|if
condition|(
name|lci_len
operator|<
literal|3
condition|)
block|{
return|return
name|hexdump
return|;
block|}
if|if
condition|(
name|tlv_len
operator|<
literal|7
operator|+
name|lci_len
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    LCI length %u, LCI what %s (0x%02x), Country-code "
operator|,
name|lci_len
operator|,
name|tok2str
argument_list|(
name|lldp_tia_location_lci_what_values
argument_list|,
literal|"unknown"
argument_list|,
operator|*
operator|(
name|tptr
operator|+
literal|6
operator|)
argument_list|)
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|6
operator|)
operator|)
argument_list|)
expr_stmt|;
comment|/* Country code */
name|safeputs
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|7
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|lci_len
operator|=
name|lci_len
operator|-
literal|3
expr_stmt|;
name|tptr
operator|=
name|tptr
operator|+
literal|9
expr_stmt|;
comment|/* Decode each civic address element */
while|while
condition|(
name|lci_len
operator|>
literal|0
condition|)
block|{
if|if
condition|(
name|lci_len
operator|<
literal|2
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|ca_type
operator|=
operator|*
operator|(
name|tptr
operator|)
expr_stmt|;
name|ca_len
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|1
operator|)
expr_stmt|;
name|tptr
operator|+=
literal|2
expr_stmt|;
name|lci_len
operator|-=
literal|2
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      CA type \'%s\' (%u), length %u: "
operator|,
name|tok2str
argument_list|(
name|lldp_tia_location_lci_catype_values
argument_list|,
literal|"unknown"
argument_list|,
name|ca_type
argument_list|)
operator|,
name|ca_type
operator|,
name|ca_len
operator|)
argument_list|)
expr_stmt|;
comment|/* basic sanity check */
if|if
condition|(
name|ca_type
operator|==
literal|0
operator|||
name|ca_len
operator|==
literal|0
condition|)
block|{
return|return
name|hexdump
return|;
block|}
if|if
condition|(
name|lci_len
operator|<
name|ca_len
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|safeputs
argument_list|(
name|ndo
argument_list|,
name|tptr
argument_list|,
name|ca_len
argument_list|)
expr_stmt|;
name|tptr
operator|+=
name|ca_len
expr_stmt|;
name|lci_len
operator|-=
name|ca_len
expr_stmt|;
block|}
break|break;
case|case
name|LLDP_TIA_LOCATION_DATA_FORMAT_ECS_ELIN
case|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    ECS ELIN id "
operator|)
argument_list|)
expr_stmt|;
name|safeputs
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|5
argument_list|,
name|tlv_len
operator|-
literal|5
argument_list|)
expr_stmt|;
break|break;
default|default:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Location ID "
operator|)
argument_list|)
expr_stmt|;
name|print_unknown_data
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|5
argument_list|,
literal|"\n\t      "
argument_list|,
name|tlv_len
operator|-
literal|5
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|LLDP_PRIVATE_TIA_SUBTYPE_EXTENDED_POWER_MDI
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|7
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Power type [%s]"
operator|,
operator|(
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
operator|&
literal|0xC0
operator|>>
literal|6
operator|)
condition|?
literal|"PD device"
else|:
literal|"PSE device"
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|", Power source [%s]"
operator|,
name|tok2str
argument_list|(
name|lldp_tia_power_source_values
argument_list|,
literal|"none"
argument_list|,
operator|(
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
operator|&
literal|0x30
operator|)
operator|>>
literal|4
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Power priority [%s] (0x%02x)"
operator|,
name|tok2str
argument_list|(
name|lldp_tia_power_priority_values
argument_list|,
literal|"none"
argument_list|,
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
operator|&
literal|0x0f
argument_list|)
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
operator|&
literal|0x0f
operator|)
argument_list|)
expr_stmt|;
name|power_val
operator|=
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
literal|5
argument_list|)
expr_stmt|;
if|if
condition|(
name|power_val
operator|<
name|LLDP_TIA_POWER_VAL_MAX
condition|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|", Power %.1f Watts"
operator|,
operator|(
operator|(
name|float
operator|)
name|power_val
operator|)
operator|/
literal|10
operator|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|", Power %u (Reserved)"
operator|,
name|power_val
operator|)
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_HARDWARE_REV
case|:
case|case
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_FIRMWARE_REV
case|:
case|case
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_SOFTWARE_REV
case|:
case|case
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_SERIAL_NUMBER
case|:
case|case
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_MANUFACTURER_NAME
case|:
case|case
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_MODEL_NAME
case|:
case|case
name|LLDP_PRIVATE_TIA_SUBTYPE_INVENTORY_ASSET_ID
case|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t  %s "
operator|,
name|tok2str
argument_list|(
name|lldp_tia_inventory_values
argument_list|,
literal|"unknown"
argument_list|,
name|subtype
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|safeputs
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|4
argument_list|,
name|tlv_len
operator|-
literal|4
argument_list|)
expr_stmt|;
break|break;
default|default:
name|hexdump
operator|=
name|TRUE
expr_stmt|;
break|break;
block|}
return|return
name|hexdump
return|;
block|}
end_function

begin_comment
comment|/*  * Print DCBX Protocol fields (V 1.01).  */
end_comment

begin_function
specifier|static
name|int
name|lldp_private_dcbx_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|pptr
parameter_list|,
name|u_int
name|len
parameter_list|)
block|{
name|int
name|subtype
decl_stmt|,
name|hexdump
init|=
name|FALSE
decl_stmt|;
name|uint8_t
name|tval
decl_stmt|;
name|uint16_t
name|tlv
decl_stmt|;
name|uint32_t
name|i
decl_stmt|,
name|pgval
decl_stmt|,
name|uval
decl_stmt|;
name|u_int
name|tlen
decl_stmt|,
name|tlv_type
decl_stmt|,
name|tlv_len
decl_stmt|;
specifier|const
name|u_char
modifier|*
name|tptr
decl_stmt|,
modifier|*
name|mptr
decl_stmt|;
if|if
condition|(
name|len
operator|<
literal|4
condition|)
block|{
return|return
name|hexdump
return|;
block|}
name|subtype
operator|=
operator|*
operator|(
name|pptr
operator|+
literal|3
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t  %s Subtype (%u)"
operator|,
name|tok2str
argument_list|(
name|lldp_dcbx_subtype_values
argument_list|,
literal|"unknown"
argument_list|,
name|subtype
argument_list|)
operator|,
name|subtype
operator|)
argument_list|)
expr_stmt|;
comment|/* by passing old version */
if|if
condition|(
name|subtype
operator|==
name|LLDP_DCBX_SUBTYPE_1
condition|)
return|return
name|TRUE
return|;
name|tptr
operator|=
name|pptr
operator|+
literal|4
expr_stmt|;
name|tlen
operator|=
name|len
operator|-
literal|4
expr_stmt|;
while|while
condition|(
name|tlen
operator|>=
sizeof|sizeof
argument_list|(
name|tlv
argument_list|)
condition|)
block|{
name|ND_TCHECK2
argument_list|(
operator|*
name|tptr
argument_list|,
sizeof|sizeof
argument_list|(
name|tlv
argument_list|)
argument_list|)
expr_stmt|;
name|tlv
operator|=
name|EXTRACT_16BITS
argument_list|(
name|tptr
argument_list|)
expr_stmt|;
name|tlv_type
operator|=
name|LLDP_EXTRACT_TYPE
argument_list|(
name|tlv
argument_list|)
expr_stmt|;
name|tlv_len
operator|=
name|LLDP_EXTRACT_LEN
argument_list|(
name|tlv
argument_list|)
expr_stmt|;
name|hexdump
operator|=
name|FALSE
expr_stmt|;
name|tlen
operator|-=
sizeof|sizeof
argument_list|(
name|tlv
argument_list|)
expr_stmt|;
name|tptr
operator|+=
sizeof|sizeof
argument_list|(
name|tlv
argument_list|)
expr_stmt|;
comment|/* loop check */
if|if
condition|(
operator|!
name|tlv_type
operator|||
operator|!
name|tlv_len
condition|)
block|{
break|break;
block|}
name|ND_TCHECK2
argument_list|(
operator|*
name|tptr
argument_list|,
name|tlv_len
argument_list|)
expr_stmt|;
if|if
condition|(
name|tlen
operator|<
name|tlv_len
condition|)
block|{
goto|goto
name|trunc
goto|;
block|}
comment|/* decode every tlv */
switch|switch
condition|(
name|tlv_type
condition|)
block|{
case|case
name|LLDP_DCBX_CONTROL_TLV
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|10
condition|)
block|{
goto|goto
name|trunc
goto|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Control - Protocol Control (type 0x%x, length %d)"
operator|,
name|LLDP_DCBX_CONTROL_TLV
operator|,
name|tlv_len
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      Oper_Version: %d"
operator|,
operator|*
name|tptr
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      Max_Version: %d"
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|1
operator|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      Sequence Number: %d"
operator|,
name|EXTRACT_32BITS
argument_list|(
name|tptr
operator|+
literal|2
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      Acknowledgement Number: %d"
operator|,
name|EXTRACT_32BITS
argument_list|(
name|tptr
operator|+
literal|6
argument_list|)
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_DCBX_PRIORITY_GROUPS_TLV
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|17
condition|)
block|{
goto|goto
name|trunc
goto|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Feature - Priority Group (type 0x%x, length %d)"
operator|,
name|LLDP_DCBX_PRIORITY_GROUPS_TLV
operator|,
name|tlv_len
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      Oper_Version: %d"
operator|,
operator|*
name|tptr
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      Max_Version: %d"
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|1
operator|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      Info block(0x%02X): "
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|2
operator|)
operator|)
argument_list|)
expr_stmt|;
name|tval
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|2
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"Enable bit: %d, Willing bit: %d, Error Bit: %d"
operator|,
operator|(
name|tval
operator|&
literal|0x80
operator|)
condition|?
literal|1
else|:
literal|0
operator|,
operator|(
name|tval
operator|&
literal|0x40
operator|)
condition|?
literal|1
else|:
literal|0
operator|,
operator|(
name|tval
operator|&
literal|0x20
operator|)
condition|?
literal|1
else|:
literal|0
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      SubType: %d"
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|3
operator|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      Priority Allocation"
operator|)
argument_list|)
expr_stmt|;
comment|/* 	     * Array of 8 4-bit priority group ID values; we fetch all 	     * 32 bits and extract each nibble. 	     */
name|pgval
operator|=
name|EXTRACT_32BITS
argument_list|(
name|tptr
operator|+
literal|4
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<=
literal|7
condition|;
name|i
operator|++
control|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t          PgId_%d: %d"
operator|,
name|i
operator|,
operator|(
name|pgval
operator|>>
operator|(
literal|28
operator|-
literal|4
operator|*
name|i
operator|)
operator|)
operator|&
literal|0xF
operator|)
argument_list|)
expr_stmt|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      Priority Group Allocation"
operator|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<=
literal|7
condition|;
name|i
operator|++
control|)
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t          Pg percentage[%d]: %d"
operator|,
name|i
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|8
operator|+
name|i
operator|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      NumTCsSupported: %d"
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|8
operator|+
literal|8
operator|)
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_DCBX_PRIORITY_FLOW_CONTROL_TLV
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|6
condition|)
block|{
goto|goto
name|trunc
goto|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Feature - Priority Flow Control"
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" (type 0x%x, length %d)"
operator|,
name|LLDP_DCBX_PRIORITY_FLOW_CONTROL_TLV
operator|,
name|tlv_len
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      Oper_Version: %d"
operator|,
operator|*
name|tptr
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      Max_Version: %d"
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|1
operator|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      Info block(0x%02X): "
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|2
operator|)
operator|)
argument_list|)
expr_stmt|;
name|tval
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|2
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"Enable bit: %d, Willing bit: %d, Error Bit: %d"
operator|,
operator|(
name|tval
operator|&
literal|0x80
operator|)
condition|?
literal|1
else|:
literal|0
operator|,
operator|(
name|tval
operator|&
literal|0x40
operator|)
condition|?
literal|1
else|:
literal|0
operator|,
operator|(
name|tval
operator|&
literal|0x20
operator|)
condition|?
literal|1
else|:
literal|0
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      SubType: %d"
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|3
operator|)
operator|)
argument_list|)
expr_stmt|;
name|tval
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      PFC Config (0x%02X)"
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|4
operator|)
operator|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<=
literal|7
condition|;
name|i
operator|++
control|)
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t          Priority Bit %d: %s"
operator|,
name|i
operator|,
operator|(
name|tval
operator|&
operator|(
literal|1
operator|<<
name|i
operator|)
operator|)
condition|?
literal|"Enabled"
else|:
literal|"Disabled"
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      NumTCPFCSupported: %d"
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|5
operator|)
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_DCBX_APPLICATION_TLV
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|4
condition|)
block|{
goto|goto
name|trunc
goto|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t    Feature - Application (type 0x%x, length %d)"
operator|,
name|LLDP_DCBX_APPLICATION_TLV
operator|,
name|tlv_len
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      Oper_Version: %d"
operator|,
operator|*
name|tptr
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      Max_Version: %d"
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|1
operator|)
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      Info block(0x%02X): "
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|2
operator|)
operator|)
argument_list|)
expr_stmt|;
name|tval
operator|=
operator|*
operator|(
name|tptr
operator|+
literal|2
operator|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"Enable bit: %d, Willing bit: %d, Error Bit: %d"
operator|,
operator|(
name|tval
operator|&
literal|0x80
operator|)
condition|?
literal|1
else|:
literal|0
operator|,
operator|(
name|tval
operator|&
literal|0x40
operator|)
condition|?
literal|1
else|:
literal|0
operator|,
operator|(
name|tval
operator|&
literal|0x20
operator|)
condition|?
literal|1
else|:
literal|0
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      SubType: %d"
operator|,
operator|*
operator|(
name|tptr
operator|+
literal|3
operator|)
operator|)
argument_list|)
expr_stmt|;
name|tval
operator|=
name|tlv_len
operator|-
literal|4
expr_stmt|;
name|mptr
operator|=
name|tptr
operator|+
literal|4
expr_stmt|;
while|while
condition|(
name|tval
operator|>=
literal|6
condition|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t      Application Value"
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t          Application Protocol ID: 0x%04x"
operator|,
name|EXTRACT_16BITS
argument_list|(
name|mptr
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|uval
operator|=
name|EXTRACT_24BITS
argument_list|(
name|mptr
operator|+
literal|2
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t          SF (0x%x) Application Protocol ID is %s"
operator|,
operator|(
name|uval
operator|>>
literal|22
operator|)
operator|,
operator|(
name|uval
operator|>>
literal|22
operator|)
condition|?
literal|"Socket Number"
else|:
literal|"L2 EtherType"
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t          OUI: 0x%06x"
operator|,
name|uval
operator|&
literal|0x3fffff
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t          User Priority Map: 0x%02x"
operator|,
operator|*
operator|(
name|mptr
operator|+
literal|5
operator|)
operator|)
argument_list|)
expr_stmt|;
name|tval
operator|=
name|tval
operator|-
literal|6
expr_stmt|;
name|mptr
operator|=
name|mptr
operator|+
literal|6
expr_stmt|;
block|}
break|break;
default|default:
name|hexdump
operator|=
name|TRUE
expr_stmt|;
break|break;
block|}
comment|/* do we also want to see a hex dump ? */
if|if
condition|(
name|ndo
operator|->
name|ndo_vflag
operator|>
literal|1
operator|||
operator|(
name|ndo
operator|->
name|ndo_vflag
operator|&&
name|hexdump
operator|)
condition|)
block|{
name|print_unknown_data
argument_list|(
name|ndo
argument_list|,
name|tptr
argument_list|,
literal|"\n\t    "
argument_list|,
name|tlv_len
argument_list|)
expr_stmt|;
block|}
name|tlen
operator|-=
name|tlv_len
expr_stmt|;
name|tptr
operator|+=
name|tlv_len
expr_stmt|;
block|}
name|trunc
label|:
return|return
name|hexdump
return|;
block|}
end_function

begin_function
specifier|static
name|char
modifier|*
name|lldp_network_addr_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|tptr
parameter_list|,
name|u_int
name|len
parameter_list|)
block|{
name|uint8_t
name|af
decl_stmt|;
specifier|static
name|char
name|buf
index|[
name|BUFSIZE
index|]
decl_stmt|;
specifier|const
name|char
modifier|*
function_decl|(
modifier|*
name|pfunc
function_decl|)
parameter_list|(
name|netdissect_options
modifier|*
parameter_list|,
specifier|const
name|u_char
modifier|*
parameter_list|)
function_decl|;
if|if
condition|(
name|len
operator|<
literal|1
condition|)
return|return
name|NULL
return|;
name|len
operator|--
expr_stmt|;
name|af
operator|=
operator|*
name|tptr
expr_stmt|;
switch|switch
condition|(
name|af
condition|)
block|{
case|case
name|AFNUM_INET
case|:
if|if
condition|(
name|len
operator|<
literal|4
condition|)
return|return
name|NULL
return|;
comment|/* This cannot be assigned to ipaddr_string(), which is a macro. */
name|pfunc
operator|=
name|getname
expr_stmt|;
break|break;
case|case
name|AFNUM_INET6
case|:
if|if
condition|(
name|len
operator|<
literal|16
condition|)
return|return
name|NULL
return|;
comment|/* This cannot be assigned to ip6addr_string(), which is a macro. */
name|pfunc
operator|=
name|getname6
expr_stmt|;
break|break;
case|case
name|AFNUM_802
case|:
if|if
condition|(
name|len
operator|<
literal|6
condition|)
return|return
name|NULL
return|;
name|pfunc
operator|=
name|etheraddr_string
expr_stmt|;
break|break;
default|default:
name|pfunc
operator|=
name|NULL
expr_stmt|;
break|break;
block|}
if|if
condition|(
operator|!
name|pfunc
condition|)
block|{
name|snprintf
argument_list|(
name|buf
argument_list|,
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|,
literal|"AFI %s (%u), no AF printer !"
argument_list|,
name|tok2str
argument_list|(
name|af_values
argument_list|,
literal|"Unknown"
argument_list|,
name|af
argument_list|)
argument_list|,
name|af
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|snprintf
argument_list|(
name|buf
argument_list|,
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|,
literal|"AFI %s (%u): %s"
argument_list|,
name|tok2str
argument_list|(
name|af_values
argument_list|,
literal|"Unknown"
argument_list|,
name|af
argument_list|)
argument_list|,
name|af
argument_list|,
call|(
modifier|*
name|pfunc
call|)
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|1
argument_list|)
argument_list|)
expr_stmt|;
block|}
return|return
name|buf
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|lldp_mgmt_addr_tlv_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|pptr
parameter_list|,
name|u_int
name|len
parameter_list|)
block|{
name|uint8_t
name|mgmt_addr_len
decl_stmt|,
name|intf_num_subtype
decl_stmt|,
name|oid_len
decl_stmt|;
specifier|const
name|u_char
modifier|*
name|tptr
decl_stmt|;
name|u_int
name|tlen
decl_stmt|;
name|char
modifier|*
name|mgmt_addr
decl_stmt|;
name|tlen
operator|=
name|len
expr_stmt|;
name|tptr
operator|=
name|pptr
expr_stmt|;
if|if
condition|(
name|tlen
operator|<
literal|1
condition|)
block|{
return|return
literal|0
return|;
block|}
name|mgmt_addr_len
operator|=
operator|*
name|tptr
operator|++
expr_stmt|;
name|tlen
operator|--
expr_stmt|;
if|if
condition|(
name|tlen
operator|<
name|mgmt_addr_len
condition|)
block|{
return|return
literal|0
return|;
block|}
name|mgmt_addr
operator|=
name|lldp_network_addr_print
argument_list|(
name|ndo
argument_list|,
name|tptr
argument_list|,
name|mgmt_addr_len
argument_list|)
expr_stmt|;
if|if
condition|(
name|mgmt_addr
operator|==
name|NULL
condition|)
block|{
return|return
literal|0
return|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t  Management Address length %u, %s"
operator|,
name|mgmt_addr_len
operator|,
name|mgmt_addr
operator|)
argument_list|)
expr_stmt|;
name|tptr
operator|+=
name|mgmt_addr_len
expr_stmt|;
name|tlen
operator|-=
name|mgmt_addr_len
expr_stmt|;
if|if
condition|(
name|tlen
operator|<
name|LLDP_INTF_NUM_LEN
condition|)
block|{
return|return
literal|0
return|;
block|}
name|intf_num_subtype
operator|=
operator|*
name|tptr
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t  %s Interface Numbering (%u): %u"
operator|,
name|tok2str
argument_list|(
name|lldp_intf_numb_subtype_values
argument_list|,
literal|"Unknown"
argument_list|,
name|intf_num_subtype
argument_list|)
operator|,
name|intf_num_subtype
operator|,
name|EXTRACT_32BITS
argument_list|(
name|tptr
operator|+
literal|1
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|tptr
operator|+=
name|LLDP_INTF_NUM_LEN
expr_stmt|;
name|tlen
operator|-=
name|LLDP_INTF_NUM_LEN
expr_stmt|;
comment|/*      * The OID is optional.      */
if|if
condition|(
name|tlen
condition|)
block|{
name|oid_len
operator|=
operator|*
name|tptr
expr_stmt|;
if|if
condition|(
name|tlen
operator|<
name|oid_len
condition|)
block|{
return|return
literal|0
return|;
block|}
if|if
condition|(
name|oid_len
condition|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t  OID length %u"
operator|,
name|oid_len
operator|)
argument_list|)
expr_stmt|;
name|safeputs
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|1
argument_list|,
name|oid_len
argument_list|)
expr_stmt|;
block|}
block|}
return|return
literal|1
return|;
block|}
end_function

begin_function
name|void
name|lldp_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|register
specifier|const
name|u_char
modifier|*
name|pptr
parameter_list|,
specifier|register
name|u_int
name|len
parameter_list|)
block|{
name|uint8_t
name|subtype
decl_stmt|;
name|uint16_t
name|tlv
decl_stmt|,
name|cap
decl_stmt|,
name|ena_cap
decl_stmt|;
name|u_int
name|oui
decl_stmt|,
name|tlen
decl_stmt|,
name|hexdump
decl_stmt|,
name|tlv_type
decl_stmt|,
name|tlv_len
decl_stmt|;
specifier|const
name|u_char
modifier|*
name|tptr
decl_stmt|;
name|char
modifier|*
name|network_addr
decl_stmt|;
name|tptr
operator|=
name|pptr
expr_stmt|;
name|tlen
operator|=
name|len
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"LLDP, length %u"
operator|,
name|len
operator|)
argument_list|)
expr_stmt|;
while|while
condition|(
name|tlen
operator|>=
sizeof|sizeof
argument_list|(
name|tlv
argument_list|)
condition|)
block|{
name|ND_TCHECK2
argument_list|(
operator|*
name|tptr
argument_list|,
sizeof|sizeof
argument_list|(
name|tlv
argument_list|)
argument_list|)
expr_stmt|;
name|tlv
operator|=
name|EXTRACT_16BITS
argument_list|(
name|tptr
argument_list|)
expr_stmt|;
name|tlv_type
operator|=
name|LLDP_EXTRACT_TYPE
argument_list|(
name|tlv
argument_list|)
expr_stmt|;
name|tlv_len
operator|=
name|LLDP_EXTRACT_LEN
argument_list|(
name|tlv
argument_list|)
expr_stmt|;
name|hexdump
operator|=
name|FALSE
expr_stmt|;
name|tlen
operator|-=
sizeof|sizeof
argument_list|(
name|tlv
argument_list|)
expr_stmt|;
name|tptr
operator|+=
sizeof|sizeof
argument_list|(
name|tlv
argument_list|)
expr_stmt|;
if|if
condition|(
name|ndo
operator|->
name|ndo_vflag
condition|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t%s TLV (%u), length %u"
operator|,
name|tok2str
argument_list|(
name|lldp_tlv_values
argument_list|,
literal|"Unknown"
argument_list|,
name|tlv_type
argument_list|)
operator|,
name|tlv_type
operator|,
name|tlv_len
operator|)
argument_list|)
expr_stmt|;
block|}
comment|/* infinite loop check */
if|if
condition|(
operator|!
name|tlv_type
operator|||
operator|!
name|tlv_len
condition|)
block|{
break|break;
block|}
name|ND_TCHECK2
argument_list|(
operator|*
name|tptr
argument_list|,
name|tlv_len
argument_list|)
expr_stmt|;
if|if
condition|(
name|tlen
operator|<
name|tlv_len
condition|)
block|{
goto|goto
name|trunc
goto|;
block|}
switch|switch
condition|(
name|tlv_type
condition|)
block|{
case|case
name|LLDP_CHASSIS_ID_TLV
case|:
if|if
condition|(
name|ndo
operator|->
name|ndo_vflag
condition|)
block|{
if|if
condition|(
name|tlv_len
operator|<
literal|2
condition|)
block|{
goto|goto
name|trunc
goto|;
block|}
name|subtype
operator|=
operator|*
name|tptr
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t  Subtype %s (%u): "
operator|,
name|tok2str
argument_list|(
name|lldp_chassis_subtype_values
argument_list|,
literal|"Unknown"
argument_list|,
name|subtype
argument_list|)
operator|,
name|subtype
operator|)
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|subtype
condition|)
block|{
case|case
name|LLDP_CHASSIS_MAC_ADDR_SUBTYPE
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|1
operator|+
literal|6
condition|)
block|{
goto|goto
name|trunc
goto|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|etheraddr_string
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|1
argument_list|)
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_CHASSIS_INTF_NAME_SUBTYPE
case|:
comment|/* fall through */
case|case
name|LLDP_CHASSIS_LOCAL_SUBTYPE
case|:
case|case
name|LLDP_CHASSIS_CHASSIS_COMP_SUBTYPE
case|:
case|case
name|LLDP_CHASSIS_INTF_ALIAS_SUBTYPE
case|:
case|case
name|LLDP_CHASSIS_PORT_COMP_SUBTYPE
case|:
name|safeputs
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|1
argument_list|,
name|tlv_len
operator|-
literal|1
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_CHASSIS_NETWORK_ADDR_SUBTYPE
case|:
name|network_addr
operator|=
name|lldp_network_addr_print
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|1
argument_list|,
name|tlv_len
operator|-
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|network_addr
operator|==
name|NULL
condition|)
block|{
goto|goto
name|trunc
goto|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|network_addr
operator|)
argument_list|)
expr_stmt|;
break|break;
default|default:
name|hexdump
operator|=
name|TRUE
expr_stmt|;
break|break;
block|}
block|}
break|break;
case|case
name|LLDP_PORT_ID_TLV
case|:
if|if
condition|(
name|ndo
operator|->
name|ndo_vflag
condition|)
block|{
if|if
condition|(
name|tlv_len
operator|<
literal|2
condition|)
block|{
goto|goto
name|trunc
goto|;
block|}
name|subtype
operator|=
operator|*
name|tptr
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t  Subtype %s (%u): "
operator|,
name|tok2str
argument_list|(
name|lldp_port_subtype_values
argument_list|,
literal|"Unknown"
argument_list|,
name|subtype
argument_list|)
operator|,
name|subtype
operator|)
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|subtype
condition|)
block|{
case|case
name|LLDP_PORT_MAC_ADDR_SUBTYPE
case|:
if|if
condition|(
name|tlv_len
operator|<
literal|1
operator|+
literal|6
condition|)
block|{
goto|goto
name|trunc
goto|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|etheraddr_string
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|1
argument_list|)
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_PORT_INTF_NAME_SUBTYPE
case|:
comment|/* fall through */
case|case
name|LLDP_PORT_LOCAL_SUBTYPE
case|:
case|case
name|LLDP_PORT_AGENT_CIRC_ID_SUBTYPE
case|:
case|case
name|LLDP_PORT_INTF_ALIAS_SUBTYPE
case|:
case|case
name|LLDP_PORT_PORT_COMP_SUBTYPE
case|:
name|safeputs
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|1
argument_list|,
name|tlv_len
operator|-
literal|1
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_PORT_NETWORK_ADDR_SUBTYPE
case|:
name|network_addr
operator|=
name|lldp_network_addr_print
argument_list|(
name|ndo
argument_list|,
name|tptr
operator|+
literal|1
argument_list|,
name|tlv_len
operator|-
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|network_addr
operator|==
name|NULL
condition|)
block|{
goto|goto
name|trunc
goto|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|network_addr
operator|)
argument_list|)
expr_stmt|;
break|break;
default|default:
name|hexdump
operator|=
name|TRUE
expr_stmt|;
break|break;
block|}
block|}
break|break;
case|case
name|LLDP_TTL_TLV
case|:
if|if
condition|(
name|ndo
operator|->
name|ndo_vflag
condition|)
block|{
if|if
condition|(
name|tlv_len
operator|<
literal|2
condition|)
block|{
goto|goto
name|trunc
goto|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|": TTL %us"
operator|,
name|EXTRACT_16BITS
argument_list|(
name|tptr
argument_list|)
operator|)
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|LLDP_PORT_DESCR_TLV
case|:
if|if
condition|(
name|ndo
operator|->
name|ndo_vflag
condition|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|": "
operator|)
argument_list|)
expr_stmt|;
name|safeputs
argument_list|(
name|ndo
argument_list|,
name|tptr
argument_list|,
name|tlv_len
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|LLDP_SYSTEM_NAME_TLV
case|:
comment|/*              * The system name is also print in non-verbose mode              * similar to the CDP printer.              */
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|": "
operator|)
argument_list|)
expr_stmt|;
name|safeputs
argument_list|(
name|ndo
argument_list|,
name|tptr
argument_list|,
name|tlv_len
argument_list|)
expr_stmt|;
break|break;
case|case
name|LLDP_SYSTEM_DESCR_TLV
case|:
if|if
condition|(
name|ndo
operator|->
name|ndo_vflag
condition|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t  "
operator|)
argument_list|)
expr_stmt|;
name|safeputs
argument_list|(
name|ndo
argument_list|,
name|tptr
argument_list|,
name|tlv_len
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|LLDP_SYSTEM_CAP_TLV
case|:
if|if
condition|(
name|ndo
operator|->
name|ndo_vflag
condition|)
block|{
comment|/*                  * XXX - IEEE Std 802.1AB-2009 says the first octet                  * if a chassis ID subtype, with the system                  * capabilities and enabled capabilities following                  * it.                  */
if|if
condition|(
name|tlv_len
operator|<
literal|4
condition|)
block|{
goto|goto
name|trunc
goto|;
block|}
name|cap
operator|=
name|EXTRACT_16BITS
argument_list|(
name|tptr
argument_list|)
expr_stmt|;
name|ena_cap
operator|=
name|EXTRACT_16BITS
argument_list|(
name|tptr
operator|+
literal|2
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t  System  Capabilities [%s] (0x%04x)"
operator|,
name|bittok2str
argument_list|(
name|lldp_cap_values
argument_list|,
literal|"none"
argument_list|,
name|cap
argument_list|)
operator|,
name|cap
operator|)
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t  Enabled Capabilities [%s] (0x%04x)"
operator|,
name|bittok2str
argument_list|(
name|lldp_cap_values
argument_list|,
literal|"none"
argument_list|,
name|ena_cap
argument_list|)
operator|,
name|ena_cap
operator|)
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|LLDP_MGMT_ADDR_TLV
case|:
if|if
condition|(
name|ndo
operator|->
name|ndo_vflag
condition|)
block|{
if|if
condition|(
operator|!
name|lldp_mgmt_addr_tlv_print
argument_list|(
name|ndo
argument_list|,
name|tptr
argument_list|,
name|tlv_len
argument_list|)
condition|)
block|{
goto|goto
name|trunc
goto|;
block|}
block|}
break|break;
case|case
name|LLDP_PRIVATE_TLV
case|:
if|if
condition|(
name|ndo
operator|->
name|ndo_vflag
condition|)
block|{
if|if
condition|(
name|tlv_len
operator|<
literal|3
condition|)
block|{
goto|goto
name|trunc
goto|;
block|}
name|oui
operator|=
name|EXTRACT_24BITS
argument_list|(
name|tptr
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|": OUI %s (0x%06x)"
operator|,
name|tok2str
argument_list|(
name|oui_values
argument_list|,
literal|"Unknown"
argument_list|,
name|oui
argument_list|)
operator|,
name|oui
operator|)
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|oui
condition|)
block|{
case|case
name|OUI_IEEE_8021_PRIVATE
case|:
name|hexdump
operator|=
name|lldp_private_8021_print
argument_list|(
name|ndo
argument_list|,
name|tptr
argument_list|,
name|tlv_len
argument_list|)
expr_stmt|;
break|break;
case|case
name|OUI_IEEE_8023_PRIVATE
case|:
name|hexdump
operator|=
name|lldp_private_8023_print
argument_list|(
name|ndo
argument_list|,
name|tptr
argument_list|,
name|tlv_len
argument_list|)
expr_stmt|;
break|break;
case|case
name|OUI_IANA
case|:
name|hexdump
operator|=
name|lldp_private_iana_print
argument_list|(
name|ndo
argument_list|,
name|tptr
argument_list|,
name|tlv_len
argument_list|)
expr_stmt|;
break|break;
case|case
name|OUI_TIA
case|:
name|hexdump
operator|=
name|lldp_private_tia_print
argument_list|(
name|ndo
argument_list|,
name|tptr
argument_list|,
name|tlv_len
argument_list|)
expr_stmt|;
break|break;
case|case
name|OUI_DCBX
case|:
name|hexdump
operator|=
name|lldp_private_dcbx_print
argument_list|(
name|ndo
argument_list|,
name|tptr
argument_list|,
name|tlv_len
argument_list|)
expr_stmt|;
break|break;
default|default:
name|hexdump
operator|=
name|TRUE
expr_stmt|;
break|break;
block|}
block|}
break|break;
default|default:
name|hexdump
operator|=
name|TRUE
expr_stmt|;
break|break;
block|}
comment|/* do we also want to see a hex dump ? */
if|if
condition|(
name|ndo
operator|->
name|ndo_vflag
operator|>
literal|1
operator|||
operator|(
name|ndo
operator|->
name|ndo_vflag
operator|&&
name|hexdump
operator|)
condition|)
block|{
name|print_unknown_data
argument_list|(
name|ndo
argument_list|,
name|tptr
argument_list|,
literal|"\n\t  "
argument_list|,
name|tlv_len
argument_list|)
expr_stmt|;
block|}
name|tlen
operator|-=
name|tlv_len
expr_stmt|;
name|tptr
operator|+=
name|tlv_len
expr_stmt|;
block|}
return|return;
name|trunc
label|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"\n\t[|LLDP]"
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Local Variables:  * c-style: whitesmith  * c-basic-offset: 4  * End:  */
end_comment

end_unit

