begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (c) 1991, 1993, 1994, 1995, 1996, 1997  *      The Regents of the University of California.  All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that: (1) source code distributions  * retain the above copyright notice and this paragraph in its entirety, (2)  * distributions including binary code include the above copyright notice and  * this paragraph in its entirety in the documentation or other materials  * provided with the distribution, and (3) all advertising materials mentioning  * features or use of this software display the following acknowledgement:  * ``This product includes software developed by the University of California,  * Lawrence Berkeley Laboratory and its contributors.'' Neither the name of  * the University nor the names of its contributors may be used to endorse  * or promote products derived from this software without specific prior  * written permission.  * THIS SOFTWARE IS PROVIDED ``AS IS'' AND WITHOUT ANY EXPRESS OR IMPLIED  * WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF  * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  *  * PPTP support contributed by Motonori Shindo (mshindo@mshindo.net)  */
end_comment

begin_define
define|#
directive|define
name|NETDISSECT_REWORKED
end_define

begin_ifdef
ifdef|#
directive|ifdef
name|HAVE_CONFIG_H
end_ifdef

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<tcpdump-stdinc.h>
end_include

begin_include
include|#
directive|include
file|"interface.h"
end_include

begin_include
include|#
directive|include
file|"extract.h"
end_include

begin_decl_stmt
specifier|static
specifier|const
name|char
name|tstr
index|[]
init|=
literal|" [|pptp]"
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|PPTP_MSG_TYPE_CTRL
value|1
end_define

begin_comment
comment|/* Control Message */
end_comment

begin_define
define|#
directive|define
name|PPTP_MSG_TYPE_MGMT
value|2
end_define

begin_comment
comment|/* Management Message (currently not used */
end_comment

begin_define
define|#
directive|define
name|PPTP_MAGIC_COOKIE
value|0x1a2b3c4d
end_define

begin_comment
comment|/* for sanity check */
end_comment

begin_define
define|#
directive|define
name|PPTP_CTRL_MSG_TYPE_SCCRQ
value|1
end_define

begin_define
define|#
directive|define
name|PPTP_CTRL_MSG_TYPE_SCCRP
value|2
end_define

begin_define
define|#
directive|define
name|PPTP_CTRL_MSG_TYPE_StopCCRQ
value|3
end_define

begin_define
define|#
directive|define
name|PPTP_CTRL_MSG_TYPE_StopCCRP
value|4
end_define

begin_define
define|#
directive|define
name|PPTP_CTRL_MSG_TYPE_ECHORQ
value|5
end_define

begin_define
define|#
directive|define
name|PPTP_CTRL_MSG_TYPE_ECHORP
value|6
end_define

begin_define
define|#
directive|define
name|PPTP_CTRL_MSG_TYPE_OCRQ
value|7
end_define

begin_define
define|#
directive|define
name|PPTP_CTRL_MSG_TYPE_OCRP
value|8
end_define

begin_define
define|#
directive|define
name|PPTP_CTRL_MSG_TYPE_ICRQ
value|9
end_define

begin_define
define|#
directive|define
name|PPTP_CTRL_MSG_TYPE_ICRP
value|10
end_define

begin_define
define|#
directive|define
name|PPTP_CTRL_MSG_TYPE_ICCN
value|11
end_define

begin_define
define|#
directive|define
name|PPTP_CTRL_MSG_TYPE_CCRQ
value|12
end_define

begin_define
define|#
directive|define
name|PPTP_CTRL_MSG_TYPE_CDN
value|13
end_define

begin_define
define|#
directive|define
name|PPTP_CTRL_MSG_TYPE_WEN
value|14
end_define

begin_define
define|#
directive|define
name|PPTP_CTRL_MSG_TYPE_SLI
value|15
end_define

begin_define
define|#
directive|define
name|PPTP_FRAMING_CAP_ASYNC_MASK
value|0x00000001
end_define

begin_comment
comment|/* Aynchronous */
end_comment

begin_define
define|#
directive|define
name|PPTP_FRAMING_CAP_SYNC_MASK
value|0x00000002
end_define

begin_comment
comment|/* Synchronous */
end_comment

begin_define
define|#
directive|define
name|PPTP_BEARER_CAP_ANALOG_MASK
value|0x00000001
end_define

begin_comment
comment|/* Analog */
end_comment

begin_define
define|#
directive|define
name|PPTP_BEARER_CAP_DIGITAL_MASK
value|0x00000002
end_define

begin_comment
comment|/* Digital */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|pptp_message_type_string
index|[]
init|=
block|{
literal|"NOT_DEFINED"
block|,
comment|/* 0  Not defined in the RFC2637 */
literal|"SCCRQ"
block|,
comment|/* 1  Start-Control-Connection-Request */
literal|"SCCRP"
block|,
comment|/* 2  Start-Control-Connection-Reply */
literal|"StopCCRQ"
block|,
comment|/* 3  Stop-Control-Connection-Request */
literal|"StopCCRP"
block|,
comment|/* 4  Stop-Control-Connection-Reply */
literal|"ECHORQ"
block|,
comment|/* 5  Echo Request */
literal|"ECHORP"
block|,
comment|/* 6  Echo Reply */
literal|"OCRQ"
block|,
comment|/* 7  Outgoing-Call-Request */
literal|"OCRP"
block|,
comment|/* 8  Outgoing-Call-Reply */
literal|"ICRQ"
block|,
comment|/* 9  Incoming-Call-Request */
literal|"ICRP"
block|,
comment|/* 10 Incoming-Call-Reply */
literal|"ICCN"
block|,
comment|/* 11 Incoming-Call-Connected */
literal|"CCRQ"
block|,
comment|/* 12 Call-Clear-Request */
literal|"CDN"
block|,
comment|/* 13 Call-Disconnect-Notify */
literal|"WEN"
block|,
comment|/* 14 WAN-Error-Notify */
literal|"SLI"
comment|/* 15 Set-Link-Info */
define|#
directive|define
name|PPTP_MAX_MSGTYPE_INDEX
value|16
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* common for all PPTP control messages */
end_comment

begin_struct
struct|struct
name|pptp_hdr
block|{
name|uint16_t
name|length
decl_stmt|;
name|uint16_t
name|msg_type
decl_stmt|;
name|uint32_t
name|magic_cookie
decl_stmt|;
name|uint16_t
name|ctrl_msg_type
decl_stmt|;
name|uint16_t
name|reserved0
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|pptp_msg_sccrq
block|{
name|uint16_t
name|proto_ver
decl_stmt|;
name|uint16_t
name|reserved1
decl_stmt|;
name|uint32_t
name|framing_cap
decl_stmt|;
name|uint32_t
name|bearer_cap
decl_stmt|;
name|uint16_t
name|max_channel
decl_stmt|;
name|uint16_t
name|firm_rev
decl_stmt|;
name|u_char
name|hostname
index|[
literal|64
index|]
decl_stmt|;
name|u_char
name|vendor
index|[
literal|64
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|pptp_msg_sccrp
block|{
name|uint16_t
name|proto_ver
decl_stmt|;
name|uint8_t
name|result_code
decl_stmt|;
name|uint8_t
name|err_code
decl_stmt|;
name|uint32_t
name|framing_cap
decl_stmt|;
name|uint32_t
name|bearer_cap
decl_stmt|;
name|uint16_t
name|max_channel
decl_stmt|;
name|uint16_t
name|firm_rev
decl_stmt|;
name|u_char
name|hostname
index|[
literal|64
index|]
decl_stmt|;
name|u_char
name|vendor
index|[
literal|64
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|pptp_msg_stopccrq
block|{
name|uint8_t
name|reason
decl_stmt|;
name|uint8_t
name|reserved1
decl_stmt|;
name|uint16_t
name|reserved2
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|pptp_msg_stopccrp
block|{
name|uint8_t
name|result_code
decl_stmt|;
name|uint8_t
name|err_code
decl_stmt|;
name|uint16_t
name|reserved1
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|pptp_msg_echorq
block|{
name|uint32_t
name|id
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|pptp_msg_echorp
block|{
name|uint32_t
name|id
decl_stmt|;
name|uint8_t
name|result_code
decl_stmt|;
name|uint8_t
name|err_code
decl_stmt|;
name|uint16_t
name|reserved1
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|pptp_msg_ocrq
block|{
name|uint16_t
name|call_id
decl_stmt|;
name|uint16_t
name|call_ser
decl_stmt|;
name|uint32_t
name|min_bps
decl_stmt|;
name|uint32_t
name|max_bps
decl_stmt|;
name|uint32_t
name|bearer_type
decl_stmt|;
name|uint32_t
name|framing_type
decl_stmt|;
name|uint16_t
name|recv_winsiz
decl_stmt|;
name|uint16_t
name|pkt_proc_delay
decl_stmt|;
name|uint16_t
name|phone_no_len
decl_stmt|;
name|uint16_t
name|reserved1
decl_stmt|;
name|u_char
name|phone_no
index|[
literal|64
index|]
decl_stmt|;
name|u_char
name|subaddr
index|[
literal|64
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|pptp_msg_ocrp
block|{
name|uint16_t
name|call_id
decl_stmt|;
name|uint16_t
name|peer_call_id
decl_stmt|;
name|uint8_t
name|result_code
decl_stmt|;
name|uint8_t
name|err_code
decl_stmt|;
name|uint16_t
name|cause_code
decl_stmt|;
name|uint32_t
name|conn_speed
decl_stmt|;
name|uint16_t
name|recv_winsiz
decl_stmt|;
name|uint16_t
name|pkt_proc_delay
decl_stmt|;
name|uint32_t
name|phy_chan_id
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|pptp_msg_icrq
block|{
name|uint16_t
name|call_id
decl_stmt|;
name|uint16_t
name|call_ser
decl_stmt|;
name|uint32_t
name|bearer_type
decl_stmt|;
name|uint32_t
name|phy_chan_id
decl_stmt|;
name|uint16_t
name|dialed_no_len
decl_stmt|;
name|uint16_t
name|dialing_no_len
decl_stmt|;
name|u_char
name|dialed_no
index|[
literal|64
index|]
decl_stmt|;
comment|/* DNIS */
name|u_char
name|dialing_no
index|[
literal|64
index|]
decl_stmt|;
comment|/* CLID */
name|u_char
name|subaddr
index|[
literal|64
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|pptp_msg_icrp
block|{
name|uint16_t
name|call_id
decl_stmt|;
name|uint16_t
name|peer_call_id
decl_stmt|;
name|uint8_t
name|result_code
decl_stmt|;
name|uint8_t
name|err_code
decl_stmt|;
name|uint16_t
name|recv_winsiz
decl_stmt|;
name|uint16_t
name|pkt_proc_delay
decl_stmt|;
name|uint16_t
name|reserved1
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|pptp_msg_iccn
block|{
name|uint16_t
name|peer_call_id
decl_stmt|;
name|uint16_t
name|reserved1
decl_stmt|;
name|uint32_t
name|conn_speed
decl_stmt|;
name|uint16_t
name|recv_winsiz
decl_stmt|;
name|uint16_t
name|pkt_proc_delay
decl_stmt|;
name|uint32_t
name|framing_type
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|pptp_msg_ccrq
block|{
name|uint16_t
name|call_id
decl_stmt|;
name|uint16_t
name|reserved1
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|pptp_msg_cdn
block|{
name|uint16_t
name|call_id
decl_stmt|;
name|uint8_t
name|result_code
decl_stmt|;
name|uint8_t
name|err_code
decl_stmt|;
name|uint16_t
name|cause_code
decl_stmt|;
name|uint16_t
name|reserved1
decl_stmt|;
name|u_char
name|call_stats
index|[
literal|128
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|pptp_msg_wen
block|{
name|uint16_t
name|peer_call_id
decl_stmt|;
name|uint16_t
name|reserved1
decl_stmt|;
name|uint32_t
name|crc_err
decl_stmt|;
name|uint32_t
name|framing_err
decl_stmt|;
name|uint32_t
name|hardware_overrun
decl_stmt|;
name|uint32_t
name|buffer_overrun
decl_stmt|;
name|uint32_t
name|timeout_err
decl_stmt|;
name|uint32_t
name|align_err
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|pptp_msg_sli
block|{
name|uint16_t
name|peer_call_id
decl_stmt|;
name|uint16_t
name|reserved1
decl_stmt|;
name|uint32_t
name|send_accm
decl_stmt|;
name|uint32_t
name|recv_accm
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/* attributes that appear more than once in above messages:     Number of    occurence    attributes   --------------------------------------       2         uint32_t bearer_cap;       2         uint32_t bearer_type;       6         uint16_t call_id;       2         uint16_t call_ser;       2         uint16_t cause_code;       2         uint32_t conn_speed;       6         uint8_t err_code;       2         uint16_t firm_rev;       2         uint32_t framing_cap;       2         uint32_t framing_type;       2         u_char hostname[64];       2         uint32_t id;       2         uint16_t max_channel;       5         uint16_t peer_call_id;       2         uint32_t phy_chan_id;       4         uint16_t pkt_proc_delay;       2         uint16_t proto_ver;       4         uint16_t recv_winsiz;       2         uint8_t reserved1;       9         uint16_t reserved1;       6         uint8_t result_code;       2         u_char subaddr[64];       2         u_char vendor[64];    so I will prepare print out functions for these attributes (except for   reserved*). */
end_comment

begin_comment
comment|/******************************************/
end_comment

begin_comment
comment|/* Attribute-specific print out functions */
end_comment

begin_comment
comment|/******************************************/
end_comment

begin_comment
comment|/* In these attribute-specific print-out functions, it't not necessary    to do ND_TCHECK because they are already checked in the caller of    these functions. */
end_comment

begin_function
specifier|static
name|void
name|pptp_bearer_cap_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint32_t
modifier|*
name|bearer_cap
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" BEARER_CAP(%s%s)"
operator|,
name|EXTRACT_32BITS
argument_list|(
name|bearer_cap
argument_list|)
operator|&
name|PPTP_BEARER_CAP_DIGITAL_MASK
condition|?
literal|"D"
else|:
literal|""
operator|,
name|EXTRACT_32BITS
argument_list|(
name|bearer_cap
argument_list|)
operator|&
name|PPTP_BEARER_CAP_ANALOG_MASK
condition|?
literal|"A"
else|:
literal|""
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|pptp_btype_str
index|[]
init|=
block|{
block|{
literal|1
block|,
literal|"A"
block|}
block|,
comment|/* Analog */
block|{
literal|2
block|,
literal|"D"
block|}
block|,
comment|/* Digital */
block|{
literal|3
block|,
literal|"Any"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
name|pptp_bearer_type_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint32_t
modifier|*
name|bearer_type
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" BEARER_TYPE(%s)"
operator|,
name|tok2str
argument_list|(
name|pptp_btype_str
argument_list|,
literal|"?"
argument_list|,
name|EXTRACT_32BITS
argument_list|(
name|bearer_type
argument_list|)
argument_list|)
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_call_id_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint16_t
modifier|*
name|call_id
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" CALL_ID(%u)"
operator|,
name|EXTRACT_16BITS
argument_list|(
name|call_id
argument_list|)
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_call_ser_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint16_t
modifier|*
name|call_ser
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" CALL_SER_NUM(%u)"
operator|,
name|EXTRACT_16BITS
argument_list|(
name|call_ser
argument_list|)
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_cause_code_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint16_t
modifier|*
name|cause_code
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" CAUSE_CODE(%u)"
operator|,
name|EXTRACT_16BITS
argument_list|(
name|cause_code
argument_list|)
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_conn_speed_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint32_t
modifier|*
name|conn_speed
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" CONN_SPEED(%u)"
operator|,
name|EXTRACT_32BITS
argument_list|(
name|conn_speed
argument_list|)
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|pptp_errcode_str
index|[]
init|=
block|{
block|{
literal|0
block|,
literal|"None"
block|}
block|,
block|{
literal|1
block|,
literal|"Not-Connected"
block|}
block|,
block|{
literal|2
block|,
literal|"Bad-Format"
block|}
block|,
block|{
literal|3
block|,
literal|"Bad-Value"
block|}
block|,
block|{
literal|4
block|,
literal|"No-Resource"
block|}
block|,
block|{
literal|5
block|,
literal|"Bad-Call-ID"
block|}
block|,
block|{
literal|6
block|,
literal|"PAC-Error"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
name|pptp_err_code_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint8_t
modifier|*
name|err_code
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" ERR_CODE(%u"
operator|,
operator|*
name|err_code
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|ndo
operator|->
name|ndo_vflag
condition|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|":%s"
operator|,
name|tok2str
argument_list|(
name|pptp_errcode_str
argument_list|,
literal|"?"
argument_list|,
operator|*
name|err_code
argument_list|)
operator|)
argument_list|)
expr_stmt|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|")"
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_firm_rev_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint16_t
modifier|*
name|firm_rev
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" FIRM_REV(%u)"
operator|,
name|EXTRACT_16BITS
argument_list|(
name|firm_rev
argument_list|)
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_framing_cap_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint32_t
modifier|*
name|framing_cap
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" FRAME_CAP("
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|EXTRACT_32BITS
argument_list|(
name|framing_cap
argument_list|)
operator|&
name|PPTP_FRAMING_CAP_ASYNC_MASK
condition|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"A"
operator|)
argument_list|)
expr_stmt|;
comment|/* Async */
block|}
if|if
condition|(
name|EXTRACT_32BITS
argument_list|(
name|framing_cap
argument_list|)
operator|&
name|PPTP_FRAMING_CAP_SYNC_MASK
condition|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"S"
operator|)
argument_list|)
expr_stmt|;
comment|/* Sync */
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|")"
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|pptp_ftype_str
index|[]
init|=
block|{
block|{
literal|1
block|,
literal|"A"
block|}
block|,
comment|/* Async */
block|{
literal|2
block|,
literal|"S"
block|}
block|,
comment|/* Sync */
block|{
literal|3
block|,
literal|"E"
block|}
block|,
comment|/* Either */
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
name|pptp_framing_type_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint32_t
modifier|*
name|framing_type
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" FRAME_TYPE(%s)"
operator|,
name|tok2str
argument_list|(
name|pptp_ftype_str
argument_list|,
literal|"?"
argument_list|,
name|EXTRACT_32BITS
argument_list|(
name|framing_type
argument_list|)
argument_list|)
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_hostname_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|hostname
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" HOSTNAME(%.64s)"
operator|,
name|hostname
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_id_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint32_t
modifier|*
name|id
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" ID(%u)"
operator|,
name|EXTRACT_32BITS
argument_list|(
name|id
argument_list|)
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_max_channel_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint16_t
modifier|*
name|max_channel
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" MAX_CHAN(%u)"
operator|,
name|EXTRACT_16BITS
argument_list|(
name|max_channel
argument_list|)
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_peer_call_id_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint16_t
modifier|*
name|peer_call_id
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" PEER_CALL_ID(%u)"
operator|,
name|EXTRACT_16BITS
argument_list|(
name|peer_call_id
argument_list|)
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_phy_chan_id_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint32_t
modifier|*
name|phy_chan_id
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" PHY_CHAN_ID(%u)"
operator|,
name|EXTRACT_32BITS
argument_list|(
name|phy_chan_id
argument_list|)
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_pkt_proc_delay_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint16_t
modifier|*
name|pkt_proc_delay
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" PROC_DELAY(%u)"
operator|,
name|EXTRACT_16BITS
argument_list|(
name|pkt_proc_delay
argument_list|)
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_proto_ver_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint16_t
modifier|*
name|proto_ver
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" PROTO_VER(%u.%u)"
operator|,
comment|/* Version.Revision */
name|EXTRACT_16BITS
argument_list|(
name|proto_ver
argument_list|)
operator|>>
literal|8
operator|,
name|EXTRACT_16BITS
argument_list|(
name|proto_ver
argument_list|)
operator|&
literal|0xff
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_recv_winsiz_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint16_t
modifier|*
name|recv_winsiz
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" RECV_WIN(%u)"
operator|,
name|EXTRACT_16BITS
argument_list|(
name|recv_winsiz
argument_list|)
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|pptp_scrrp_str
index|[]
init|=
block|{
block|{
literal|1
block|,
literal|"Successful channel establishment"
block|}
block|,
block|{
literal|2
block|,
literal|"General error"
block|}
block|,
block|{
literal|3
block|,
literal|"Command channel already exists"
block|}
block|,
block|{
literal|4
block|,
literal|"Requester is not authorized to establish a command channel"
block|}
block|,
block|{
literal|5
block|,
literal|"The protocol version of the requester is not supported"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|pptp_echorp_str
index|[]
init|=
block|{
block|{
literal|1
block|,
literal|"OK"
block|}
block|,
block|{
literal|2
block|,
literal|"General Error"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|pptp_ocrp_str
index|[]
init|=
block|{
block|{
literal|1
block|,
literal|"Connected"
block|}
block|,
block|{
literal|2
block|,
literal|"General Error"
block|}
block|,
block|{
literal|3
block|,
literal|"No Carrier"
block|}
block|,
block|{
literal|4
block|,
literal|"Busy"
block|}
block|,
block|{
literal|5
block|,
literal|"No Dial Tone"
block|}
block|,
block|{
literal|6
block|,
literal|"Time-out"
block|}
block|,
block|{
literal|7
block|,
literal|"Do Not Accept"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|pptp_icrp_str
index|[]
init|=
block|{
block|{
literal|1
block|,
literal|"Connect"
block|}
block|,
block|{
literal|2
block|,
literal|"General Error"
block|}
block|,
block|{
literal|3
block|,
literal|"Do Not Accept"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|tok
name|pptp_cdn_str
index|[]
init|=
block|{
block|{
literal|1
block|,
literal|"Lost Carrier"
block|}
block|,
block|{
literal|2
block|,
literal|"General Error"
block|}
block|,
block|{
literal|3
block|,
literal|"Admin Shutdown"
block|}
block|,
block|{
literal|4
block|,
literal|"Request"
block|}
block|,
block|{
literal|0
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
name|pptp_result_code_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|uint8_t
modifier|*
name|result_code
parameter_list|,
name|int
name|ctrl_msg_type
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" RESULT_CODE(%u"
operator|,
operator|*
name|result_code
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|ndo
operator|->
name|ndo_vflag
condition|)
block|{
specifier|const
name|struct
name|tok
modifier|*
name|dict
init|=
name|ctrl_msg_type
operator|==
name|PPTP_CTRL_MSG_TYPE_SCCRP
condition|?
name|pptp_scrrp_str
else|:
name|ctrl_msg_type
operator|==
name|PPTP_CTRL_MSG_TYPE_StopCCRP
condition|?
name|pptp_echorp_str
else|:
name|ctrl_msg_type
operator|==
name|PPTP_CTRL_MSG_TYPE_ECHORP
condition|?
name|pptp_echorp_str
else|:
name|ctrl_msg_type
operator|==
name|PPTP_CTRL_MSG_TYPE_OCRP
condition|?
name|pptp_ocrp_str
else|:
name|ctrl_msg_type
operator|==
name|PPTP_CTRL_MSG_TYPE_ICRP
condition|?
name|pptp_icrp_str
else|:
name|ctrl_msg_type
operator|==
name|PPTP_CTRL_MSG_TYPE_CDN
condition|?
name|pptp_cdn_str
else|:
name|NULL
decl_stmt|;
comment|/* assertion error */
if|if
condition|(
name|dict
operator|!=
name|NULL
condition|)
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|":%s"
operator|,
name|tok2str
argument_list|(
name|dict
argument_list|,
literal|"?"
argument_list|,
operator|*
name|result_code
argument_list|)
operator|)
argument_list|)
expr_stmt|;
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|")"
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_subaddr_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|subaddr
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" SUB_ADDR(%.64s)"
operator|,
name|subaddr
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_vendor_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|vendor
parameter_list|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" VENDOR(%.64s)"
operator|,
name|vendor
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/************************************/
end_comment

begin_comment
comment|/* PPTP message print out functions */
end_comment

begin_comment
comment|/************************************/
end_comment

begin_function
specifier|static
name|void
name|pptp_sccrq_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|dat
parameter_list|)
block|{
name|struct
name|pptp_msg_sccrq
modifier|*
name|ptr
init|=
operator|(
expr|struct
name|pptp_msg_sccrq
operator|*
operator|)
name|dat
decl_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|proto_ver
argument_list|)
expr_stmt|;
name|pptp_proto_ver_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|proto_ver
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|reserved1
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|framing_cap
argument_list|)
expr_stmt|;
name|pptp_framing_cap_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|framing_cap
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|bearer_cap
argument_list|)
expr_stmt|;
name|pptp_bearer_cap_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|bearer_cap
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|max_channel
argument_list|)
expr_stmt|;
name|pptp_max_channel_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|max_channel
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|firm_rev
argument_list|)
expr_stmt|;
name|pptp_firm_rev_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|firm_rev
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|hostname
argument_list|)
expr_stmt|;
name|pptp_hostname_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|hostname
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|vendor
argument_list|)
expr_stmt|;
name|pptp_vendor_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|vendor
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
return|return;
name|trunc
label|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|tstr
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_sccrp_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|dat
parameter_list|)
block|{
name|struct
name|pptp_msg_sccrp
modifier|*
name|ptr
init|=
operator|(
expr|struct
name|pptp_msg_sccrp
operator|*
operator|)
name|dat
decl_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|proto_ver
argument_list|)
expr_stmt|;
name|pptp_proto_ver_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|proto_ver
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|result_code
argument_list|)
expr_stmt|;
name|pptp_result_code_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|result_code
argument_list|,
name|PPTP_CTRL_MSG_TYPE_SCCRP
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|err_code
argument_list|)
expr_stmt|;
name|pptp_err_code_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|err_code
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|framing_cap
argument_list|)
expr_stmt|;
name|pptp_framing_cap_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|framing_cap
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|bearer_cap
argument_list|)
expr_stmt|;
name|pptp_bearer_cap_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|bearer_cap
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|max_channel
argument_list|)
expr_stmt|;
name|pptp_max_channel_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|max_channel
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|firm_rev
argument_list|)
expr_stmt|;
name|pptp_firm_rev_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|firm_rev
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|hostname
argument_list|)
expr_stmt|;
name|pptp_hostname_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|hostname
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|vendor
argument_list|)
expr_stmt|;
name|pptp_vendor_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|vendor
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
return|return;
name|trunc
label|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|tstr
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_stopccrq_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|dat
parameter_list|)
block|{
name|struct
name|pptp_msg_stopccrq
modifier|*
name|ptr
init|=
operator|(
expr|struct
name|pptp_msg_stopccrq
operator|*
operator|)
name|dat
decl_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|reason
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" REASON(%u"
operator|,
name|ptr
operator|->
name|reason
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|ndo
operator|->
name|ndo_vflag
condition|)
block|{
switch|switch
condition|(
name|ptr
operator|->
name|reason
condition|)
block|{
case|case
literal|1
case|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|":None"
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|":Stop-Protocol"
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|3
case|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|":Stop-Local-Shutdown"
operator|)
argument_list|)
expr_stmt|;
break|break;
default|default:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|":?"
operator|)
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|")"
operator|)
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|reserved1
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|reserved2
argument_list|)
expr_stmt|;
return|return;
name|trunc
label|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|tstr
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_stopccrp_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|dat
parameter_list|)
block|{
name|struct
name|pptp_msg_stopccrp
modifier|*
name|ptr
init|=
operator|(
expr|struct
name|pptp_msg_stopccrp
operator|*
operator|)
name|dat
decl_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|result_code
argument_list|)
expr_stmt|;
name|pptp_result_code_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|result_code
argument_list|,
name|PPTP_CTRL_MSG_TYPE_StopCCRP
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|err_code
argument_list|)
expr_stmt|;
name|pptp_err_code_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|err_code
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|reserved1
argument_list|)
expr_stmt|;
return|return;
name|trunc
label|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|tstr
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_echorq_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|dat
parameter_list|)
block|{
name|struct
name|pptp_msg_echorq
modifier|*
name|ptr
init|=
operator|(
expr|struct
name|pptp_msg_echorq
operator|*
operator|)
name|dat
decl_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|id
argument_list|)
expr_stmt|;
name|pptp_id_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|id
argument_list|)
expr_stmt|;
return|return;
name|trunc
label|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|tstr
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_echorp_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|dat
parameter_list|)
block|{
name|struct
name|pptp_msg_echorp
modifier|*
name|ptr
init|=
operator|(
expr|struct
name|pptp_msg_echorp
operator|*
operator|)
name|dat
decl_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|id
argument_list|)
expr_stmt|;
name|pptp_id_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|id
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|result_code
argument_list|)
expr_stmt|;
name|pptp_result_code_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|result_code
argument_list|,
name|PPTP_CTRL_MSG_TYPE_ECHORP
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|err_code
argument_list|)
expr_stmt|;
name|pptp_err_code_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|err_code
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|reserved1
argument_list|)
expr_stmt|;
return|return;
name|trunc
label|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|tstr
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_ocrq_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|dat
parameter_list|)
block|{
name|struct
name|pptp_msg_ocrq
modifier|*
name|ptr
init|=
operator|(
expr|struct
name|pptp_msg_ocrq
operator|*
operator|)
name|dat
decl_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|call_id
argument_list|)
expr_stmt|;
name|pptp_call_id_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|call_id
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|call_ser
argument_list|)
expr_stmt|;
name|pptp_call_ser_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|call_ser
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|min_bps
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" MIN_BPS(%u)"
operator|,
name|EXTRACT_32BITS
argument_list|(
operator|&
name|ptr
operator|->
name|min_bps
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|max_bps
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" MAX_BPS(%u)"
operator|,
name|EXTRACT_32BITS
argument_list|(
operator|&
name|ptr
operator|->
name|max_bps
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|bearer_type
argument_list|)
expr_stmt|;
name|pptp_bearer_type_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|bearer_type
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|framing_type
argument_list|)
expr_stmt|;
name|pptp_framing_type_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|framing_type
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|recv_winsiz
argument_list|)
expr_stmt|;
name|pptp_recv_winsiz_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|recv_winsiz
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|pkt_proc_delay
argument_list|)
expr_stmt|;
name|pptp_pkt_proc_delay_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|pkt_proc_delay
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|phone_no_len
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" PHONE_NO_LEN(%u)"
operator|,
name|EXTRACT_16BITS
argument_list|(
operator|&
name|ptr
operator|->
name|phone_no_len
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|reserved1
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|phone_no
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" PHONE_NO(%.64s)"
operator|,
name|ptr
operator|->
name|phone_no
operator|)
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|subaddr
argument_list|)
expr_stmt|;
name|pptp_subaddr_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|subaddr
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
return|return;
name|trunc
label|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|tstr
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_ocrp_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|dat
parameter_list|)
block|{
name|struct
name|pptp_msg_ocrp
modifier|*
name|ptr
init|=
operator|(
expr|struct
name|pptp_msg_ocrp
operator|*
operator|)
name|dat
decl_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|call_id
argument_list|)
expr_stmt|;
name|pptp_call_id_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|call_id
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|peer_call_id
argument_list|)
expr_stmt|;
name|pptp_peer_call_id_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|peer_call_id
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|result_code
argument_list|)
expr_stmt|;
name|pptp_result_code_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|result_code
argument_list|,
name|PPTP_CTRL_MSG_TYPE_OCRP
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|err_code
argument_list|)
expr_stmt|;
name|pptp_err_code_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|err_code
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|cause_code
argument_list|)
expr_stmt|;
name|pptp_cause_code_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|cause_code
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|conn_speed
argument_list|)
expr_stmt|;
name|pptp_conn_speed_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|conn_speed
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|recv_winsiz
argument_list|)
expr_stmt|;
name|pptp_recv_winsiz_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|recv_winsiz
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|pkt_proc_delay
argument_list|)
expr_stmt|;
name|pptp_pkt_proc_delay_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|pkt_proc_delay
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|phy_chan_id
argument_list|)
expr_stmt|;
name|pptp_phy_chan_id_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|phy_chan_id
argument_list|)
expr_stmt|;
return|return;
name|trunc
label|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|tstr
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_icrq_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|dat
parameter_list|)
block|{
name|struct
name|pptp_msg_icrq
modifier|*
name|ptr
init|=
operator|(
expr|struct
name|pptp_msg_icrq
operator|*
operator|)
name|dat
decl_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|call_id
argument_list|)
expr_stmt|;
name|pptp_call_id_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|call_id
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|call_ser
argument_list|)
expr_stmt|;
name|pptp_call_ser_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|call_ser
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|bearer_type
argument_list|)
expr_stmt|;
name|pptp_bearer_type_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|bearer_type
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|phy_chan_id
argument_list|)
expr_stmt|;
name|pptp_phy_chan_id_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|phy_chan_id
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|dialed_no_len
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" DIALED_NO_LEN(%u)"
operator|,
name|EXTRACT_16BITS
argument_list|(
operator|&
name|ptr
operator|->
name|dialed_no_len
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|dialing_no_len
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" DIALING_NO_LEN(%u)"
operator|,
name|EXTRACT_16BITS
argument_list|(
operator|&
name|ptr
operator|->
name|dialing_no_len
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|dialed_no
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" DIALED_NO(%.64s)"
operator|,
name|ptr
operator|->
name|dialed_no
operator|)
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|dialing_no
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" DIALING_NO(%.64s)"
operator|,
name|ptr
operator|->
name|dialing_no
operator|)
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|subaddr
argument_list|)
expr_stmt|;
name|pptp_subaddr_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|subaddr
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
return|return;
name|trunc
label|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|tstr
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_icrp_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|dat
parameter_list|)
block|{
name|struct
name|pptp_msg_icrp
modifier|*
name|ptr
init|=
operator|(
expr|struct
name|pptp_msg_icrp
operator|*
operator|)
name|dat
decl_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|call_id
argument_list|)
expr_stmt|;
name|pptp_call_id_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|call_id
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|peer_call_id
argument_list|)
expr_stmt|;
name|pptp_peer_call_id_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|peer_call_id
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|result_code
argument_list|)
expr_stmt|;
name|pptp_result_code_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|result_code
argument_list|,
name|PPTP_CTRL_MSG_TYPE_ICRP
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|err_code
argument_list|)
expr_stmt|;
name|pptp_err_code_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|err_code
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|recv_winsiz
argument_list|)
expr_stmt|;
name|pptp_recv_winsiz_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|recv_winsiz
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|pkt_proc_delay
argument_list|)
expr_stmt|;
name|pptp_pkt_proc_delay_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|pkt_proc_delay
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|reserved1
argument_list|)
expr_stmt|;
return|return;
name|trunc
label|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|tstr
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_iccn_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|dat
parameter_list|)
block|{
name|struct
name|pptp_msg_iccn
modifier|*
name|ptr
init|=
operator|(
expr|struct
name|pptp_msg_iccn
operator|*
operator|)
name|dat
decl_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|peer_call_id
argument_list|)
expr_stmt|;
name|pptp_peer_call_id_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|peer_call_id
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|reserved1
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|conn_speed
argument_list|)
expr_stmt|;
name|pptp_conn_speed_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|conn_speed
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|recv_winsiz
argument_list|)
expr_stmt|;
name|pptp_recv_winsiz_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|recv_winsiz
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|pkt_proc_delay
argument_list|)
expr_stmt|;
name|pptp_pkt_proc_delay_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|pkt_proc_delay
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|framing_type
argument_list|)
expr_stmt|;
name|pptp_framing_type_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|framing_type
argument_list|)
expr_stmt|;
return|return;
name|trunc
label|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|tstr
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_ccrq_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|dat
parameter_list|)
block|{
name|struct
name|pptp_msg_ccrq
modifier|*
name|ptr
init|=
operator|(
expr|struct
name|pptp_msg_ccrq
operator|*
operator|)
name|dat
decl_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|call_id
argument_list|)
expr_stmt|;
name|pptp_call_id_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|call_id
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|reserved1
argument_list|)
expr_stmt|;
return|return;
name|trunc
label|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|tstr
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_cdn_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|dat
parameter_list|)
block|{
name|struct
name|pptp_msg_cdn
modifier|*
name|ptr
init|=
operator|(
expr|struct
name|pptp_msg_cdn
operator|*
operator|)
name|dat
decl_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|call_id
argument_list|)
expr_stmt|;
name|pptp_call_id_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|call_id
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|result_code
argument_list|)
expr_stmt|;
name|pptp_result_code_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|result_code
argument_list|,
name|PPTP_CTRL_MSG_TYPE_CDN
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|err_code
argument_list|)
expr_stmt|;
name|pptp_err_code_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|err_code
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|cause_code
argument_list|)
expr_stmt|;
name|pptp_cause_code_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|cause_code
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|reserved1
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|call_stats
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" CALL_STATS(%.128s)"
operator|,
name|ptr
operator|->
name|call_stats
operator|)
argument_list|)
expr_stmt|;
return|return;
name|trunc
label|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|tstr
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_wen_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|dat
parameter_list|)
block|{
name|struct
name|pptp_msg_wen
modifier|*
name|ptr
init|=
operator|(
expr|struct
name|pptp_msg_wen
operator|*
operator|)
name|dat
decl_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|peer_call_id
argument_list|)
expr_stmt|;
name|pptp_peer_call_id_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|peer_call_id
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|reserved1
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|crc_err
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" CRC_ERR(%u)"
operator|,
name|EXTRACT_32BITS
argument_list|(
operator|&
name|ptr
operator|->
name|crc_err
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|framing_err
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" FRAMING_ERR(%u)"
operator|,
name|EXTRACT_32BITS
argument_list|(
operator|&
name|ptr
operator|->
name|framing_err
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|hardware_overrun
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" HARDWARE_OVERRUN(%u)"
operator|,
name|EXTRACT_32BITS
argument_list|(
operator|&
name|ptr
operator|->
name|hardware_overrun
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|buffer_overrun
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" BUFFER_OVERRUN(%u)"
operator|,
name|EXTRACT_32BITS
argument_list|(
operator|&
name|ptr
operator|->
name|buffer_overrun
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|timeout_err
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" TIMEOUT_ERR(%u)"
operator|,
name|EXTRACT_32BITS
argument_list|(
operator|&
name|ptr
operator|->
name|timeout_err
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|align_err
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" ALIGN_ERR(%u)"
operator|,
name|EXTRACT_32BITS
argument_list|(
operator|&
name|ptr
operator|->
name|align_err
argument_list|)
operator|)
argument_list|)
expr_stmt|;
return|return;
name|trunc
label|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|tstr
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|pptp_sli_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|dat
parameter_list|)
block|{
name|struct
name|pptp_msg_sli
modifier|*
name|ptr
init|=
operator|(
expr|struct
name|pptp_msg_sli
operator|*
operator|)
name|dat
decl_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|peer_call_id
argument_list|)
expr_stmt|;
name|pptp_peer_call_id_print
argument_list|(
name|ndo
argument_list|,
operator|&
name|ptr
operator|->
name|peer_call_id
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|reserved1
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|send_accm
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" SEND_ACCM(0x%08x)"
operator|,
name|EXTRACT_32BITS
argument_list|(
operator|&
name|ptr
operator|->
name|send_accm
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|ptr
operator|->
name|recv_accm
argument_list|)
expr_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" RECV_ACCM(0x%08x)"
operator|,
name|EXTRACT_32BITS
argument_list|(
operator|&
name|ptr
operator|->
name|recv_accm
argument_list|)
operator|)
argument_list|)
expr_stmt|;
return|return;
name|trunc
label|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|tstr
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|pptp_print
parameter_list|(
name|netdissect_options
modifier|*
name|ndo
parameter_list|,
specifier|const
name|u_char
modifier|*
name|dat
parameter_list|)
block|{
specifier|const
name|struct
name|pptp_hdr
modifier|*
name|hdr
decl_stmt|;
name|uint32_t
name|mc
decl_stmt|;
name|uint16_t
name|ctrl_msg_type
decl_stmt|;
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|": pptp"
operator|)
argument_list|)
expr_stmt|;
name|hdr
operator|=
operator|(
expr|struct
name|pptp_hdr
operator|*
operator|)
name|dat
expr_stmt|;
name|ND_TCHECK
argument_list|(
name|hdr
operator|->
name|length
argument_list|)
expr_stmt|;
if|if
condition|(
name|ndo
operator|->
name|ndo_vflag
condition|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" Length=%u"
operator|,
name|EXTRACT_16BITS
argument_list|(
operator|&
name|hdr
operator|->
name|length
argument_list|)
operator|)
argument_list|)
expr_stmt|;
block|}
name|ND_TCHECK
argument_list|(
name|hdr
operator|->
name|msg_type
argument_list|)
expr_stmt|;
if|if
condition|(
name|ndo
operator|->
name|ndo_vflag
condition|)
block|{
switch|switch
condition|(
name|EXTRACT_16BITS
argument_list|(
operator|&
name|hdr
operator|->
name|msg_type
argument_list|)
condition|)
block|{
case|case
name|PPTP_MSG_TYPE_CTRL
case|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" CTRL-MSG"
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|PPTP_MSG_TYPE_MGMT
case|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" MGMT-MSG"
operator|)
argument_list|)
expr_stmt|;
break|break;
default|default:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" UNKNOWN-MSG-TYPE"
operator|)
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
name|ND_TCHECK
argument_list|(
name|hdr
operator|->
name|magic_cookie
argument_list|)
expr_stmt|;
name|mc
operator|=
name|EXTRACT_32BITS
argument_list|(
operator|&
name|hdr
operator|->
name|magic_cookie
argument_list|)
expr_stmt|;
if|if
condition|(
name|mc
operator|!=
name|PPTP_MAGIC_COOKIE
condition|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" UNEXPECTED Magic-Cookie!!(%08x)"
operator|,
name|mc
operator|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|ndo
operator|->
name|ndo_vflag
operator|||
name|mc
operator|!=
name|PPTP_MAGIC_COOKIE
condition|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" Magic-Cookie=%08x"
operator|,
name|mc
operator|)
argument_list|)
expr_stmt|;
block|}
name|ND_TCHECK
argument_list|(
name|hdr
operator|->
name|ctrl_msg_type
argument_list|)
expr_stmt|;
name|ctrl_msg_type
operator|=
name|EXTRACT_16BITS
argument_list|(
operator|&
name|hdr
operator|->
name|ctrl_msg_type
argument_list|)
expr_stmt|;
if|if
condition|(
name|ctrl_msg_type
operator|<
name|PPTP_MAX_MSGTYPE_INDEX
condition|)
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" CTRL_MSGTYPE=%s"
operator|,
name|pptp_message_type_string
index|[
name|ctrl_msg_type
index|]
operator|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|" UNKNOWN_CTRL_MSGTYPE(%u)"
operator|,
name|ctrl_msg_type
operator|)
argument_list|)
expr_stmt|;
block|}
name|ND_TCHECK
argument_list|(
name|hdr
operator|->
name|reserved0
argument_list|)
expr_stmt|;
name|dat
operator|+=
literal|12
expr_stmt|;
switch|switch
condition|(
name|ctrl_msg_type
condition|)
block|{
case|case
name|PPTP_CTRL_MSG_TYPE_SCCRQ
case|:
name|pptp_sccrq_print
argument_list|(
name|ndo
argument_list|,
name|dat
argument_list|)
expr_stmt|;
break|break;
case|case
name|PPTP_CTRL_MSG_TYPE_SCCRP
case|:
name|pptp_sccrp_print
argument_list|(
name|ndo
argument_list|,
name|dat
argument_list|)
expr_stmt|;
break|break;
case|case
name|PPTP_CTRL_MSG_TYPE_StopCCRQ
case|:
name|pptp_stopccrq_print
argument_list|(
name|ndo
argument_list|,
name|dat
argument_list|)
expr_stmt|;
break|break;
case|case
name|PPTP_CTRL_MSG_TYPE_StopCCRP
case|:
name|pptp_stopccrp_print
argument_list|(
name|ndo
argument_list|,
name|dat
argument_list|)
expr_stmt|;
break|break;
case|case
name|PPTP_CTRL_MSG_TYPE_ECHORQ
case|:
name|pptp_echorq_print
argument_list|(
name|ndo
argument_list|,
name|dat
argument_list|)
expr_stmt|;
break|break;
case|case
name|PPTP_CTRL_MSG_TYPE_ECHORP
case|:
name|pptp_echorp_print
argument_list|(
name|ndo
argument_list|,
name|dat
argument_list|)
expr_stmt|;
break|break;
case|case
name|PPTP_CTRL_MSG_TYPE_OCRQ
case|:
name|pptp_ocrq_print
argument_list|(
name|ndo
argument_list|,
name|dat
argument_list|)
expr_stmt|;
break|break;
case|case
name|PPTP_CTRL_MSG_TYPE_OCRP
case|:
name|pptp_ocrp_print
argument_list|(
name|ndo
argument_list|,
name|dat
argument_list|)
expr_stmt|;
break|break;
case|case
name|PPTP_CTRL_MSG_TYPE_ICRQ
case|:
name|pptp_icrq_print
argument_list|(
name|ndo
argument_list|,
name|dat
argument_list|)
expr_stmt|;
break|break;
case|case
name|PPTP_CTRL_MSG_TYPE_ICRP
case|:
name|pptp_icrp_print
argument_list|(
name|ndo
argument_list|,
name|dat
argument_list|)
expr_stmt|;
break|break;
case|case
name|PPTP_CTRL_MSG_TYPE_ICCN
case|:
name|pptp_iccn_print
argument_list|(
name|ndo
argument_list|,
name|dat
argument_list|)
expr_stmt|;
break|break;
case|case
name|PPTP_CTRL_MSG_TYPE_CCRQ
case|:
name|pptp_ccrq_print
argument_list|(
name|ndo
argument_list|,
name|dat
argument_list|)
expr_stmt|;
break|break;
case|case
name|PPTP_CTRL_MSG_TYPE_CDN
case|:
name|pptp_cdn_print
argument_list|(
name|ndo
argument_list|,
name|dat
argument_list|)
expr_stmt|;
break|break;
case|case
name|PPTP_CTRL_MSG_TYPE_WEN
case|:
name|pptp_wen_print
argument_list|(
name|ndo
argument_list|,
name|dat
argument_list|)
expr_stmt|;
break|break;
case|case
name|PPTP_CTRL_MSG_TYPE_SLI
case|:
name|pptp_sli_print
argument_list|(
name|ndo
argument_list|,
name|dat
argument_list|)
expr_stmt|;
break|break;
default|default:
comment|/* do nothing */
break|break;
block|}
return|return;
name|trunc
label|:
name|ND_PRINT
argument_list|(
operator|(
name|ndo
operator|,
literal|"%s"
operator|,
name|tstr
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

