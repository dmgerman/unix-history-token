begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (C) 2012 by Darren Reed.  *  * See the IPFILTER.LICENCE file for details on licencing.  *  * $Id: printnatside.c,v 1.2.2.6 2012/07/22 08:04:24 darren_r Exp $  */
end_comment

begin_include
include|#
directive|include
file|"ipf.h"
end_include

begin_function
name|void
name|printnatside
parameter_list|(
name|side
parameter_list|,
name|ns
parameter_list|)
name|char
modifier|*
name|side
decl_stmt|;
name|nat_stat_side_t
modifier|*
name|ns
decl_stmt|;
block|{
name|PRINTF
argument_list|(
literal|"%lu\tproxy create fail %s\n"
argument_list|,
name|ns
operator|->
name|ns_appr_fail
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tproxy fail %s\n"
argument_list|,
name|ns
operator|->
name|ns_ipf_proxy_fail
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tbad nat %s\n"
argument_list|,
name|ns
operator|->
name|ns_badnat
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tbad nat new %s\n"
argument_list|,
name|ns
operator|->
name|ns_badnatnew
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tbad next addr %s\n"
argument_list|,
name|ns
operator|->
name|ns_badnextaddr
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tbucket max %s\n"
argument_list|,
name|ns
operator|->
name|ns_bucket_max
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tclone nomem %s\n"
argument_list|,
name|ns
operator|->
name|ns_clone_nomem
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tdecap bad %s\n"
argument_list|,
name|ns
operator|->
name|ns_decap_bad
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tdecap fail %s\n"
argument_list|,
name|ns
operator|->
name|ns_decap_fail
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tdecap pullup %s\n"
argument_list|,
name|ns
operator|->
name|ns_decap_pullup
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tdivert dup %s\n"
argument_list|,
name|ns
operator|->
name|ns_divert_dup
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tdivert exist %s\n"
argument_list|,
name|ns
operator|->
name|ns_divert_exist
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tdrop %s\n"
argument_list|,
name|ns
operator|->
name|ns_drop
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\texhausted %s\n"
argument_list|,
name|ns
operator|->
name|ns_exhausted
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\ticmp address %s\n"
argument_list|,
name|ns
operator|->
name|ns_icmp_address
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\ticmp basic %s\n"
argument_list|,
name|ns
operator|->
name|ns_icmp_basic
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tinuse %s\n"
argument_list|,
name|ns
operator|->
name|ns_inuse
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\ticmp mbuf wrong size %s\n"
argument_list|,
name|ns
operator|->
name|ns_icmp_mbuf
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\ticmp header unmatched %s\n"
argument_list|,
name|ns
operator|->
name|ns_icmp_notfound
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\ticmp rebuild failures %s\n"
argument_list|,
name|ns
operator|->
name|ns_icmp_rebuild
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\ticmp short %s\n"
argument_list|,
name|ns
operator|->
name|ns_icmp_short
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\ticmp packet size wrong %s\n"
argument_list|,
name|ns
operator|->
name|ns_icmp_size
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tIFP address fetch failures %s\n"
argument_list|,
name|ns
operator|->
name|ns_ifpaddrfail
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tpackets untranslated %s\n"
argument_list|,
name|ns
operator|->
name|ns_ignored
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tNAT insert failures %s\n"
argument_list|,
name|ns
operator|->
name|ns_insert_fail
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tNAT lookup misses %s\n"
argument_list|,
name|ns
operator|->
name|ns_lookup_miss
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tNAT lookup nowild %s\n"
argument_list|,
name|ns
operator|->
name|ns_lookup_nowild
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tnew ifpaddr failed %s\n"
argument_list|,
name|ns
operator|->
name|ns_new_ifpaddr
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tmemory requests failed %s\n"
argument_list|,
name|ns
operator|->
name|ns_memfail
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\ttable max reached %s\n"
argument_list|,
name|ns
operator|->
name|ns_table_max
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tpackets translated %s\n"
argument_list|,
name|ns
operator|->
name|ns_translated
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tfinalised failed %s\n"
argument_list|,
name|ns
operator|->
name|ns_unfinalised
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tsearch wraps %s\n"
argument_list|,
name|ns
operator|->
name|ns_wrap
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tnull translations %s\n"
argument_list|,
name|ns
operator|->
name|ns_xlate_null
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\ttranslation exists %s\n"
argument_list|,
name|ns
operator|->
name|ns_xlate_exists
argument_list|,
name|side
argument_list|)
expr_stmt|;
name|PRINTF
argument_list|(
literal|"%lu\tno memory %s\n"
argument_list|,
name|ns
operator|->
name|ns_memfail
argument_list|,
name|side
argument_list|)
expr_stmt|;
if|if
condition|(
name|opts
operator|&
name|OPT_VERBOSE
condition|)
name|PRINTF
argument_list|(
literal|"%p table %s\n"
argument_list|,
name|ns
operator|->
name|ns_table
argument_list|,
name|side
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

