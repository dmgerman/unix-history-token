begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (C) 1993-2001 by Darren Reed.  *  * See the IPFILTER.LICENCE file for details on licencing.  *  * $Id: printportcmp.c,v 1.7 2003/02/16 02:31:05 darrenr Exp $  */
end_comment

begin_include
include|#
directive|include
file|"ipf.h"
end_include

begin_function
name|void
name|printportcmp
parameter_list|(
name|pr
parameter_list|,
name|frp
parameter_list|)
name|int
name|pr
decl_stmt|;
name|frpcmp_t
modifier|*
name|frp
decl_stmt|;
block|{
specifier|static
name|char
modifier|*
name|pcmp1
index|[]
init|=
block|{
literal|"*"
block|,
literal|"="
block|,
literal|"!="
block|,
literal|"<"
block|,
literal|">"
block|,
literal|"<="
block|,
literal|">="
block|,
literal|"<>"
block|,
literal|"><"
block|,
literal|":"
block|}
decl_stmt|;
if|if
condition|(
name|frp
operator|->
name|frp_cmp
operator|==
name|FR_INRANGE
operator|||
name|frp
operator|->
name|frp_cmp
operator|==
name|FR_OUTRANGE
condition|)
name|printf
argument_list|(
literal|" port %d %s %d"
argument_list|,
name|frp
operator|->
name|frp_port
argument_list|,
name|pcmp1
index|[
name|frp
operator|->
name|frp_cmp
index|]
argument_list|,
name|frp
operator|->
name|frp_top
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|frp
operator|->
name|frp_cmp
operator|==
name|FR_INCRANGE
condition|)
name|printf
argument_list|(
literal|" port %d:%d"
argument_list|,
name|frp
operator|->
name|frp_port
argument_list|,
name|frp
operator|->
name|frp_top
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|" port %s %s"
argument_list|,
name|pcmp1
index|[
name|frp
operator|->
name|frp_cmp
index|]
argument_list|,
name|portname
argument_list|(
name|pr
argument_list|,
name|frp
operator|->
name|frp_port
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

