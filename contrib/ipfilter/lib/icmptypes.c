begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (C) 2012 by Darren Reed.  *  * See the IPFILTER.LICENCE file for details on licencing.  *  * $Id$  */
end_comment

begin_include
include|#
directive|include
file|"ipf.h"
end_include

begin_ifndef
ifndef|#
directive|ifndef
name|USE_INET6
end_ifndef

begin_undef
undef|#
directive|undef
name|ICMP6_ECHO_REQUEST
end_undef

begin_define
define|#
directive|define
name|ICMP6_ECHO_REQUEST
value|0
end_define

begin_undef
undef|#
directive|undef
name|ICMP6_ECHO_REPLY
end_undef

begin_define
define|#
directive|define
name|ICMP6_ECHO_REPLY
value|0
end_define

begin_undef
undef|#
directive|undef
name|ICMP6_NI_QUERY
end_undef

begin_define
define|#
directive|define
name|ICMP6_NI_QUERY
value|0
end_define

begin_undef
undef|#
directive|undef
name|ICMP6_NI_REPLY
end_undef

begin_define
define|#
directive|define
name|ICMP6_NI_REPLY
value|0
end_define

begin_undef
undef|#
directive|undef
name|ICMP6_PARAM_PROB
end_undef

begin_define
define|#
directive|define
name|ICMP6_PARAM_PROB
value|0
end_define

begin_undef
undef|#
directive|undef
name|ND_ROUTER_ADVERT
end_undef

begin_define
define|#
directive|define
name|ND_ROUTER_ADVERT
value|0
end_define

begin_undef
undef|#
directive|undef
name|ND_ROUTER_SOLICIT
end_undef

begin_define
define|#
directive|define
name|ND_ROUTER_SOLICIT
value|0
end_define

begin_undef
undef|#
directive|undef
name|ICMP6_TIME_EXCEEDED
end_undef

begin_define
define|#
directive|define
name|ICMP6_TIME_EXCEEDED
value|0
end_define

begin_undef
undef|#
directive|undef
name|ICMP6_DST_UNREACH
end_undef

begin_define
define|#
directive|define
name|ICMP6_DST_UNREACH
value|0
end_define

begin_undef
undef|#
directive|undef
name|ICMP6_PACKET_TOO_BIG
end_undef

begin_define
define|#
directive|define
name|ICMP6_PACKET_TOO_BIG
value|0
end_define

begin_undef
undef|#
directive|undef
name|MLD_LISTENER_QUERY
end_undef

begin_define
define|#
directive|define
name|MLD_LISTENER_QUERY
value|0
end_define

begin_undef
undef|#
directive|undef
name|MLD_LISTENER_REPORT
end_undef

begin_define
define|#
directive|define
name|MLD_LISTENER_REPORT
value|0
end_define

begin_undef
undef|#
directive|undef
name|MLD_LISTENER_DONE
end_undef

begin_define
define|#
directive|define
name|MLD_LISTENER_DONE
value|0
end_define

begin_undef
undef|#
directive|undef
name|ICMP6_MEMBERSHIP_QUERY
end_undef

begin_define
define|#
directive|define
name|ICMP6_MEMBERSHIP_QUERY
value|0
end_define

begin_undef
undef|#
directive|undef
name|ICMP6_MEMBERSHIP_REPORT
end_undef

begin_define
define|#
directive|define
name|ICMP6_MEMBERSHIP_REPORT
value|0
end_define

begin_undef
undef|#
directive|undef
name|ICMP6_MEMBERSHIP_REDUCTION
end_undef

begin_define
define|#
directive|define
name|ICMP6_MEMBERSHIP_REDUCTION
value|0
end_define

begin_undef
undef|#
directive|undef
name|ND_NEIGHBOR_ADVERT
end_undef

begin_define
define|#
directive|define
name|ND_NEIGHBOR_ADVERT
value|0
end_define

begin_undef
undef|#
directive|undef
name|ND_NEIGHBOR_SOLICIT
end_undef

begin_define
define|#
directive|define
name|ND_NEIGHBOR_SOLICIT
value|0
end_define

begin_undef
undef|#
directive|undef
name|ICMP6_ROUTER_RENUMBERING
end_undef

begin_define
define|#
directive|define
name|ICMP6_ROUTER_RENUMBERING
value|0
end_define

begin_undef
undef|#
directive|undef
name|ICMP6_WRUREQUEST
end_undef

begin_define
define|#
directive|define
name|ICMP6_WRUREQUEST
value|0
end_define

begin_undef
undef|#
directive|undef
name|ICMP6_WRUREPLY
end_undef

begin_define
define|#
directive|define
name|ICMP6_WRUREPLY
value|0
end_define

begin_undef
undef|#
directive|undef
name|ICMP6_FQDN_QUERY
end_undef

begin_define
define|#
directive|define
name|ICMP6_FQDN_QUERY
value|0
end_define

begin_undef
undef|#
directive|undef
name|ICMP6_FQDN_REPLY
end_undef

begin_define
define|#
directive|define
name|ICMP6_FQDN_REPLY
value|0
end_define

begin_else
else|#
directive|else
end_else

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|MLD_LISTENER_QUERY
argument_list|)
end_if

begin_define
define|#
directive|define
name|MLD_LISTENER_QUERY
value|130
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|MLD_LISTENER_REPORT
argument_list|)
end_if

begin_define
define|#
directive|define
name|MLD_LISTENER_REPORT
value|131
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|MLD_LISTENER_DONE
argument_list|)
end_if

begin_define
define|#
directive|define
name|MLD_LISTENER_DONE
value|132
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
name|defined
argument_list|(
name|MLD_LISTENER_REDUCTION
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|MLD_LISTENER_DONE
argument_list|)
end_if

begin_define
define|#
directive|define
name|MLD_LISTENER_DONE
value|MLD_LISTENER_REDUCTION
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
name|icmptype_t
name|icmptypelist
index|[]
init|=
block|{
block|{
literal|"echo"
block|,
name|ICMP_ECHO
block|,
name|ICMP6_ECHO_REQUEST
block|}
block|,
block|{
literal|"echorep"
block|,
name|ICMP_ECHOREPLY
block|,
name|ICMP6_ECHO_REPLY
block|}
block|,
block|{
literal|"fqdnquery"
block|,
operator|-
literal|1
block|,
name|ICMP6_FQDN_QUERY
block|}
block|,
block|{
literal|"fqdnreply"
block|,
operator|-
literal|1
block|,
name|ICMP6_FQDN_REPLY
block|}
block|,
block|{
literal|"infoqry"
block|,
operator|-
literal|1
block|,
name|ICMP6_NI_QUERY
block|}
block|,
block|{
literal|"inforeq"
block|,
name|ICMP_IREQ
block|,
name|ICMP6_NI_QUERY
block|}
block|,
block|{
literal|"inforep"
block|,
name|ICMP_IREQREPLY
block|,
name|ICMP6_NI_REPLY
block|}
block|,
block|{
literal|"listendone"
block|,
operator|-
literal|1
block|,
name|MLD_LISTENER_DONE
block|}
block|,
block|{
literal|"listenqry"
block|,
operator|-
literal|1
block|,
name|MLD_LISTENER_QUERY
block|}
block|,
block|{
literal|"listenrep"
block|,
operator|-
literal|1
block|,
name|MLD_LISTENER_REPORT
block|}
block|,
block|{
literal|"maskrep"
block|,
name|ICMP_MASKREPLY
block|,
operator|-
literal|1
block|}
block|,
block|{
literal|"maskreq"
block|,
name|ICMP_MASKREQ
block|,
operator|-
literal|1
block|}
block|,
block|{
literal|"memberqry"
block|,
operator|-
literal|1
block|,
name|ICMP6_MEMBERSHIP_QUERY
block|}
block|,
block|{
literal|"memberred"
block|,
operator|-
literal|1
block|,
name|ICMP6_MEMBERSHIP_REDUCTION
block|}
block|,
block|{
literal|"memberreply"
block|,
operator|-
literal|1
block|,
name|ICMP6_MEMBERSHIP_REPORT
block|}
block|,
block|{
literal|"neighadvert"
block|,
operator|-
literal|1
block|,
name|ND_NEIGHBOR_ADVERT
block|}
block|,
block|{
literal|"neighborsol"
block|,
operator|-
literal|1
block|,
name|ND_NEIGHBOR_SOLICIT
block|}
block|,
block|{
literal|"neighborsolicit"
block|,
operator|-
literal|1
block|,
name|ND_NEIGHBOR_SOLICIT
block|}
block|,
block|{
literal|"paramprob"
block|,
name|ICMP_PARAMPROB
block|,
name|ICMP6_PARAM_PROB
block|}
block|,
block|{
literal|"redir"
block|,
name|ICMP_REDIRECT
block|,
name|ND_REDIRECT
block|}
block|,
block|{
literal|"renumber"
block|,
operator|-
literal|1
block|,
name|ICMP6_ROUTER_RENUMBERING
block|}
block|,
block|{
literal|"routerad"
block|,
name|ICMP_ROUTERADVERT
block|,
name|ND_ROUTER_ADVERT
block|}
block|,
block|{
literal|"routeradvert"
block|,
name|ICMP_ROUTERADVERT
block|,
name|ND_ROUTER_ADVERT
block|}
block|,
block|{
literal|"routersol"
block|,
name|ICMP_ROUTERSOLICIT
block|,
name|ND_ROUTER_SOLICIT
block|}
block|,
block|{
literal|"routersolcit"
block|,
name|ICMP_ROUTERSOLICIT
block|,
name|ND_ROUTER_SOLICIT
block|}
block|,
block|{
literal|"squench"
block|,
name|ICMP_SOURCEQUENCH
block|,
operator|-
literal|1
block|}
block|,
block|{
literal|"timest"
block|,
name|ICMP_TSTAMP
block|,
operator|-
literal|1
block|}
block|,
block|{
literal|"timestrep"
block|,
name|ICMP_TSTAMPREPLY
block|,
operator|-
literal|1
block|}
block|,
block|{
literal|"timex"
block|,
name|ICMP_TIMXCEED
block|,
name|ICMP6_TIME_EXCEEDED
block|}
block|,
block|{
literal|"toobig"
block|,
operator|-
literal|1
block|,
name|ICMP6_PACKET_TOO_BIG
block|}
block|,
block|{
literal|"unreach"
block|,
name|ICMP_UNREACH
block|,
name|ICMP6_DST_UNREACH
block|}
block|,
block|{
literal|"whorep"
block|,
operator|-
literal|1
block|,
name|ICMP6_WRUREPLY
block|}
block|,
block|{
literal|"whoreq"
block|,
operator|-
literal|1
block|,
name|ICMP6_WRUREQUEST
block|}
block|,
block|{
name|NULL
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|}
block|}
decl_stmt|;
end_decl_stmt

end_unit

