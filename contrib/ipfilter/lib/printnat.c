begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*	$FreeBSD$	*/
end_comment

begin_comment
comment|/*  * Copyright (C) 1993-2001 by Darren Reed.  *  * See the IPFILTER.LICENCE file for details on licencing.  *  * Added redirect stuff and a variety of bug fixes. (mcn@EnGarde.com)  */
end_comment

begin_include
include|#
directive|include
file|"ipf.h"
end_include

begin_include
include|#
directive|include
file|"kmem.h"
end_include

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|lint
argument_list|)
end_if

begin_decl_stmt
specifier|static
specifier|const
name|char
name|rcsid
index|[]
init|=
literal|"@(#)Id: printnat.c,v 1.22.2.8 2005/01/12 03:39:04 darrenr Exp"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
specifier|static
name|void
name|printproto
name|__P
argument_list|(
operator|(
name|ipnat_t
operator|*
operator|,
expr|struct
name|protoent
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Print out a NAT rule  */
end_comment

begin_function
name|void
name|printnat
parameter_list|(
name|np
parameter_list|,
name|opts
parameter_list|)
name|ipnat_t
modifier|*
name|np
decl_stmt|;
name|int
name|opts
decl_stmt|;
block|{
name|struct
name|protoent
modifier|*
name|pr
decl_stmt|;
name|int
name|bits
decl_stmt|;
name|pr
operator|=
name|getprotobynumber
argument_list|(
name|np
operator|->
name|in_p
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|np
operator|->
name|in_redir
condition|)
block|{
case|case
name|NAT_REDIRECT
case|:
name|printf
argument_list|(
literal|"rdr"
argument_list|)
expr_stmt|;
break|break;
case|case
name|NAT_MAP
case|:
name|printf
argument_list|(
literal|"map"
argument_list|)
expr_stmt|;
break|break;
case|case
name|NAT_MAPBLK
case|:
name|printf
argument_list|(
literal|"map-block"
argument_list|)
expr_stmt|;
break|break;
case|case
name|NAT_BIMAP
case|:
name|printf
argument_list|(
literal|"bimap"
argument_list|)
expr_stmt|;
break|break;
default|default :
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"unknown value for in_redir: %#x\n"
argument_list|,
name|np
operator|->
name|in_redir
argument_list|)
expr_stmt|;
break|break;
block|}
name|printf
argument_list|(
literal|" %s"
argument_list|,
name|np
operator|->
name|in_ifnames
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|np
operator|->
name|in_ifnames
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|!=
literal|'\0'
operator|)
operator|&&
operator|(
name|strncmp
argument_list|(
name|np
operator|->
name|in_ifnames
index|[
literal|0
index|]
argument_list|,
name|np
operator|->
name|in_ifnames
index|[
literal|1
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
operator|!=
literal|0
operator|)
condition|)
block|{
name|printf
argument_list|(
literal|",%s "
argument_list|,
name|np
operator|->
name|in_ifnames
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
block|}
name|putchar
argument_list|(
literal|' '
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_FILTER
condition|)
block|{
if|if
condition|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_NOTSRC
condition|)
name|printf
argument_list|(
literal|"! "
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"from "
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_redir
operator|==
name|NAT_REDIRECT
condition|)
block|{
name|printhostmask
argument_list|(
literal|4
argument_list|,
operator|(
name|u_32_t
operator|*
operator|)
operator|&
name|np
operator|->
name|in_srcip
argument_list|,
operator|(
name|u_32_t
operator|*
operator|)
operator|&
name|np
operator|->
name|in_srcmsk
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|printhostmask
argument_list|(
literal|4
argument_list|,
operator|(
name|u_32_t
operator|*
operator|)
operator|&
name|np
operator|->
name|in_inip
argument_list|,
operator|(
name|u_32_t
operator|*
operator|)
operator|&
name|np
operator|->
name|in_inmsk
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|np
operator|->
name|in_scmp
condition|)
name|printportcmp
argument_list|(
name|np
operator|->
name|in_p
argument_list|,
operator|&
name|np
operator|->
name|in_tuc
operator|.
name|ftu_src
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_NOTDST
condition|)
name|printf
argument_list|(
literal|" !"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|" to "
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_redir
operator|==
name|NAT_REDIRECT
condition|)
block|{
name|printhostmask
argument_list|(
literal|4
argument_list|,
operator|(
name|u_32_t
operator|*
operator|)
operator|&
name|np
operator|->
name|in_outip
argument_list|,
operator|(
name|u_32_t
operator|*
operator|)
operator|&
name|np
operator|->
name|in_outmsk
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|printhostmask
argument_list|(
literal|4
argument_list|,
operator|(
name|u_32_t
operator|*
operator|)
operator|&
name|np
operator|->
name|in_srcip
argument_list|,
operator|(
name|u_32_t
operator|*
operator|)
operator|&
name|np
operator|->
name|in_srcmsk
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|np
operator|->
name|in_dcmp
condition|)
name|printportcmp
argument_list|(
name|np
operator|->
name|in_p
argument_list|,
operator|&
name|np
operator|->
name|in_tuc
operator|.
name|ftu_dst
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|np
operator|->
name|in_redir
operator|==
name|NAT_REDIRECT
condition|)
block|{
if|if
condition|(
operator|!
operator|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_FILTER
operator|)
condition|)
block|{
name|printf
argument_list|(
literal|"%s"
argument_list|,
name|inet_ntoa
argument_list|(
name|np
operator|->
name|in_out
index|[
literal|0
index|]
operator|.
name|in4
argument_list|)
argument_list|)
expr_stmt|;
name|bits
operator|=
name|count4bits
argument_list|(
name|np
operator|->
name|in_outmsk
argument_list|)
expr_stmt|;
if|if
condition|(
name|bits
operator|!=
operator|-
literal|1
condition|)
name|printf
argument_list|(
literal|"/%d"
argument_list|,
name|bits
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"/%s"
argument_list|,
name|inet_ntoa
argument_list|(
name|np
operator|->
name|in_out
index|[
literal|1
index|]
operator|.
name|in4
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_TCPUDP
condition|)
block|{
name|printf
argument_list|(
literal|" port %d"
argument_list|,
name|ntohs
argument_list|(
name|np
operator|->
name|in_pmin
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_pmax
operator|!=
name|np
operator|->
name|in_pmin
condition|)
name|printf
argument_list|(
literal|"-%d"
argument_list|,
name|ntohs
argument_list|(
name|np
operator|->
name|in_pmax
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
name|printf
argument_list|(
literal|" -> %s"
argument_list|,
name|inet_ntoa
argument_list|(
name|np
operator|->
name|in_in
index|[
literal|0
index|]
operator|.
name|in4
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_SPLIT
condition|)
name|printf
argument_list|(
literal|",%s"
argument_list|,
name|inet_ntoa
argument_list|(
name|np
operator|->
name|in_in
index|[
literal|1
index|]
operator|.
name|in4
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_TCPUDP
condition|)
block|{
if|if
condition|(
operator|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_FIXEDDPORT
operator|)
operator|!=
literal|0
condition|)
name|printf
argument_list|(
literal|" port = %d"
argument_list|,
name|ntohs
argument_list|(
name|np
operator|->
name|in_pnext
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|" port %d"
argument_list|,
name|ntohs
argument_list|(
name|np
operator|->
name|in_pnext
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|printproto
argument_list|(
name|np
argument_list|,
name|pr
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_ROUNDR
condition|)
name|printf
argument_list|(
literal|" round-robin"
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_FRAG
condition|)
name|printf
argument_list|(
literal|" frag"
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_age
index|[
literal|0
index|]
operator|!=
literal|0
operator|||
name|np
operator|->
name|in_age
index|[
literal|1
index|]
operator|!=
literal|0
condition|)
block|{
name|printf
argument_list|(
literal|" age %d/%d"
argument_list|,
name|np
operator|->
name|in_age
index|[
literal|0
index|]
argument_list|,
name|np
operator|->
name|in_age
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_STICKY
condition|)
name|printf
argument_list|(
literal|" sticky"
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_mssclamp
operator|!=
literal|0
condition|)
name|printf
argument_list|(
literal|" mssclamp %d"
argument_list|,
name|np
operator|->
name|in_mssclamp
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
name|np
operator|->
name|in_plabel
operator|!=
literal|'\0'
condition|)
name|printf
argument_list|(
literal|" proxy %.*s"
argument_list|,
operator|(
name|int
operator|)
sizeof|sizeof
argument_list|(
name|np
operator|->
name|in_plabel
argument_list|)
argument_list|,
name|np
operator|->
name|in_plabel
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_tag
operator|.
name|ipt_tag
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
name|printf
argument_list|(
literal|" tag %-.*s"
argument_list|,
name|IPFTAG_LEN
argument_list|,
name|np
operator|->
name|in_tag
operator|.
name|ipt_tag
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
if|if
condition|(
name|opts
operator|&
name|OPT_DEBUG
condition|)
name|printf
argument_list|(
literal|"\tpmax %u\n"
argument_list|,
name|np
operator|->
name|in_pmax
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
operator|!
operator|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_FILTER
operator|)
condition|)
block|{
name|printf
argument_list|(
literal|"%s/"
argument_list|,
name|inet_ntoa
argument_list|(
name|np
operator|->
name|in_in
index|[
literal|0
index|]
operator|.
name|in4
argument_list|)
argument_list|)
expr_stmt|;
name|bits
operator|=
name|count4bits
argument_list|(
name|np
operator|->
name|in_inmsk
argument_list|)
expr_stmt|;
if|if
condition|(
name|bits
operator|!=
operator|-
literal|1
condition|)
name|printf
argument_list|(
literal|"%d"
argument_list|,
name|bits
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"%s"
argument_list|,
name|inet_ntoa
argument_list|(
name|np
operator|->
name|in_in
index|[
literal|1
index|]
operator|.
name|in4
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|printf
argument_list|(
literal|" -> "
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_IPRANGE
condition|)
block|{
name|printf
argument_list|(
literal|"range %s-"
argument_list|,
name|inet_ntoa
argument_list|(
name|np
operator|->
name|in_out
index|[
literal|0
index|]
operator|.
name|in4
argument_list|)
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"%s"
argument_list|,
name|inet_ntoa
argument_list|(
name|np
operator|->
name|in_out
index|[
literal|1
index|]
operator|.
name|in4
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|printf
argument_list|(
literal|"%s/"
argument_list|,
name|inet_ntoa
argument_list|(
name|np
operator|->
name|in_out
index|[
literal|0
index|]
operator|.
name|in4
argument_list|)
argument_list|)
expr_stmt|;
name|bits
operator|=
name|count4bits
argument_list|(
name|np
operator|->
name|in_outmsk
argument_list|)
expr_stmt|;
if|if
condition|(
name|bits
operator|!=
operator|-
literal|1
condition|)
name|printf
argument_list|(
literal|"%d"
argument_list|,
name|bits
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"%s"
argument_list|,
name|inet_ntoa
argument_list|(
name|np
operator|->
name|in_out
index|[
literal|1
index|]
operator|.
name|in4
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|*
name|np
operator|->
name|in_plabel
operator|!=
literal|'\0'
condition|)
block|{
name|printf
argument_list|(
literal|" proxy port "
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_dcmp
operator|!=
literal|0
condition|)
name|np
operator|->
name|in_dport
operator|=
name|htons
argument_list|(
name|np
operator|->
name|in_dport
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_dport
operator|!=
literal|0
condition|)
block|{
name|char
modifier|*
name|s
decl_stmt|;
name|s
operator|=
name|portname
argument_list|(
name|np
operator|->
name|in_p
argument_list|,
name|ntohs
argument_list|(
name|np
operator|->
name|in_dport
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|s
operator|!=
name|NULL
condition|)
name|fputs
argument_list|(
name|s
argument_list|,
name|stdout
argument_list|)
expr_stmt|;
else|else
name|fputs
argument_list|(
literal|"???"
argument_list|,
name|stdout
argument_list|)
expr_stmt|;
block|}
name|printf
argument_list|(
literal|" %.*s/"
argument_list|,
operator|(
name|int
operator|)
sizeof|sizeof
argument_list|(
name|np
operator|->
name|in_plabel
argument_list|)
argument_list|,
name|np
operator|->
name|in_plabel
argument_list|)
expr_stmt|;
if|if
condition|(
name|pr
operator|!=
name|NULL
condition|)
name|fputs
argument_list|(
name|pr
operator|->
name|p_name
argument_list|,
name|stdout
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"%d"
argument_list|,
name|np
operator|->
name|in_p
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|np
operator|->
name|in_redir
operator|==
name|NAT_MAPBLK
condition|)
block|{
if|if
condition|(
operator|(
name|np
operator|->
name|in_pmin
operator|==
literal|0
operator|)
operator|&&
operator|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_AUTOPORTMAP
operator|)
condition|)
name|printf
argument_list|(
literal|" ports auto"
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|" ports %d"
argument_list|,
name|np
operator|->
name|in_pmin
argument_list|)
expr_stmt|;
if|if
condition|(
name|opts
operator|&
name|OPT_DEBUG
condition|)
name|printf
argument_list|(
literal|"\n\tip modulous %d"
argument_list|,
name|np
operator|->
name|in_pmax
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|np
operator|->
name|in_pmin
operator|||
name|np
operator|->
name|in_pmax
condition|)
block|{
if|if
condition|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_ICMPQUERY
condition|)
block|{
name|printf
argument_list|(
literal|" icmpidmap"
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|printf
argument_list|(
literal|" portmap"
argument_list|)
expr_stmt|;
block|}
name|printproto
argument_list|(
name|np
argument_list|,
name|pr
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_AUTOPORTMAP
condition|)
block|{
name|printf
argument_list|(
literal|" auto"
argument_list|)
expr_stmt|;
if|if
condition|(
name|opts
operator|&
name|OPT_DEBUG
condition|)
name|printf
argument_list|(
literal|" [%d:%d %d %d]"
argument_list|,
name|ntohs
argument_list|(
name|np
operator|->
name|in_pmin
argument_list|)
argument_list|,
name|ntohs
argument_list|(
name|np
operator|->
name|in_pmax
argument_list|)
argument_list|,
name|np
operator|->
name|in_ippip
argument_list|,
name|np
operator|->
name|in_ppip
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|printf
argument_list|(
literal|" %d:%d"
argument_list|,
name|ntohs
argument_list|(
name|np
operator|->
name|in_pmin
argument_list|)
argument_list|,
name|ntohs
argument_list|(
name|np
operator|->
name|in_pmax
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_TCPUDP
operator|||
name|np
operator|->
name|in_p
condition|)
name|printproto
argument_list|(
name|np
argument_list|,
name|pr
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_FRAG
condition|)
name|printf
argument_list|(
literal|" frag"
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_age
index|[
literal|0
index|]
operator|!=
literal|0
operator|||
name|np
operator|->
name|in_age
index|[
literal|1
index|]
operator|!=
literal|0
condition|)
block|{
name|printf
argument_list|(
literal|" age %d/%d"
argument_list|,
name|np
operator|->
name|in_age
index|[
literal|0
index|]
argument_list|,
name|np
operator|->
name|in_age
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|np
operator|->
name|in_mssclamp
operator|!=
literal|0
condition|)
name|printf
argument_list|(
literal|" mssclamp %d"
argument_list|,
name|np
operator|->
name|in_mssclamp
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_tag
operator|.
name|ipt_tag
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
name|printf
argument_list|(
literal|" tag %s"
argument_list|,
name|np
operator|->
name|in_tag
operator|.
name|ipt_tag
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
if|if
condition|(
name|opts
operator|&
name|OPT_DEBUG
condition|)
block|{
name|struct
name|in_addr
name|nip
decl_stmt|;
name|nip
operator|.
name|s_addr
operator|=
name|htonl
argument_list|(
name|np
operator|->
name|in_nextip
operator|.
name|s_addr
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\tnextip %s pnext %d\n"
argument_list|,
name|inet_ntoa
argument_list|(
name|nip
argument_list|)
argument_list|,
name|np
operator|->
name|in_pnext
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|opts
operator|&
name|OPT_DEBUG
condition|)
block|{
name|printf
argument_list|(
literal|"\tspace %lu use %u hits %lu flags %#x proto %d hv %d\n"
argument_list|,
name|np
operator|->
name|in_space
argument_list|,
name|np
operator|->
name|in_use
argument_list|,
name|np
operator|->
name|in_hits
argument_list|,
name|np
operator|->
name|in_flags
argument_list|,
name|np
operator|->
name|in_p
argument_list|,
name|np
operator|->
name|in_hv
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\tifp[0] %p ifp[1] %p apr %p\n"
argument_list|,
name|np
operator|->
name|in_ifps
index|[
literal|0
index|]
argument_list|,
name|np
operator|->
name|in_ifps
index|[
literal|1
index|]
argument_list|,
name|np
operator|->
name|in_apr
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\ttqehead %p/%p comment %p\n"
argument_list|,
name|np
operator|->
name|in_tqehead
index|[
literal|0
index|]
argument_list|,
name|np
operator|->
name|in_tqehead
index|[
literal|1
index|]
argument_list|,
name|np
operator|->
name|in_comment
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|printproto
parameter_list|(
name|np
parameter_list|,
name|pr
parameter_list|)
name|ipnat_t
modifier|*
name|np
decl_stmt|;
name|struct
name|protoent
modifier|*
name|pr
decl_stmt|;
block|{
if|if
condition|(
operator|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_TCPUDP
operator|)
operator|==
name|IPN_TCPUDP
condition|)
name|printf
argument_list|(
literal|" tcp/udp"
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_TCP
condition|)
name|printf
argument_list|(
literal|" tcp"
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_UDP
condition|)
name|printf
argument_list|(
literal|" udp"
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|np
operator|->
name|in_flags
operator|&
name|IPN_ICMPQUERY
condition|)
name|printf
argument_list|(
literal|" icmp"
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|pr
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|" %s"
argument_list|,
name|pr
operator|->
name|p_name
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|" %d"
argument_list|,
name|np
operator|->
name|in_p
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

