begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (C) 2012 by Darren Reed.  *  * See the IPFILTER.LICENCE file for details on licencing.  *  * $Id: ip_dstlist.h,v 1.5.2.6 2012/07/22 08:04:23 darren_r Exp $  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|__IP_DSTLIST_H__
end_ifndef

begin_define
define|#
directive|define
name|__IP_DSTLIST_H__
end_define

begin_typedef
typedef|typedef
struct|struct
name|ipf_dstnode
block|{
name|struct
name|ipf_dstnode
modifier|*
name|ipfd_next
decl_stmt|;
name|struct
name|ipf_dstnode
modifier|*
modifier|*
name|ipfd_pnext
decl_stmt|;
name|ipfmutex_t
name|ipfd_lock
decl_stmt|;
name|frdest_t
name|ipfd_dest
decl_stmt|;
name|u_long
name|ipfd_syncat
decl_stmt|;
name|int
name|ipfd_flags
decl_stmt|;
name|int
name|ipfd_size
decl_stmt|;
name|int
name|ipfd_states
decl_stmt|;
name|int
name|ipfd_ref
decl_stmt|;
name|int
name|ipfd_uid
decl_stmt|;
name|char
name|ipfd_names
index|[
literal|1
index|]
decl_stmt|;
block|}
name|ipf_dstnode_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
enum|enum
name|ippool_policy_e
block|{
name|IPLDP_NONE
init|=
literal|0
block|,
name|IPLDP_ROUNDROBIN
block|,
name|IPLDP_CONNECTION
block|,
name|IPLDP_RANDOM
block|,
name|IPLDP_HASHED
block|,
name|IPLDP_SRCHASH
block|,
name|IPLDP_DSTHASH
block|}
name|ippool_policy_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|ippool_dst
block|{
name|struct
name|ippool_dst
modifier|*
name|ipld_next
decl_stmt|;
name|struct
name|ippool_dst
modifier|*
modifier|*
name|ipld_pnext
decl_stmt|;
name|ipfmutex_t
name|ipld_lock
decl_stmt|;
name|int
name|ipld_seed
decl_stmt|;
name|int
name|ipld_unit
decl_stmt|;
name|int
name|ipld_ref
decl_stmt|;
name|int
name|ipld_flags
decl_stmt|;
name|int
name|ipld_nodes
decl_stmt|;
name|int
name|ipld_maxnodes
decl_stmt|;
name|ippool_policy_t
name|ipld_policy
decl_stmt|;
name|ipf_dstnode_t
modifier|*
modifier|*
name|ipld_dests
decl_stmt|;
name|ipf_dstnode_t
modifier|*
name|ipld_selected
decl_stmt|;
name|char
name|ipld_name
index|[
name|FR_GROUPLEN
index|]
decl_stmt|;
block|}
name|ippool_dst_t
typedef|;
end_typedef

begin_define
define|#
directive|define
name|IPDST_DELETE
value|0x01
end_define

begin_typedef
typedef|typedef
struct|struct
name|dstlist_stat_s
block|{
name|void
modifier|*
name|ipls_list
index|[
name|LOOKUP_POOL_SZ
index|]
decl_stmt|;
name|int
name|ipls_numlists
decl_stmt|;
name|u_long
name|ipls_nomem
decl_stmt|;
name|int
name|ipls_numnodes
decl_stmt|;
name|int
name|ipls_numdereflists
decl_stmt|;
name|int
name|ipls_numderefnodes
decl_stmt|;
block|}
name|ipf_dstl_stat_t
typedef|;
end_typedef

begin_decl_stmt
specifier|extern
name|ipf_lookup_t
name|ipf_dstlist_backend
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ipf_dstlist_select_node
name|__P
argument_list|(
operator|(
name|fr_info_t
operator|*
operator|,
name|void
operator|*
operator|,
name|u_32_t
operator|*
operator|,
name|frdest_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* __IP_DSTLIST_H__ */
end_comment

end_unit

