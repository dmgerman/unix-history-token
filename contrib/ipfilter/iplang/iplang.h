begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (C) 1997-1998 by Darren Reed.  *  * See the IPFILTER.LICENCE file for details on licencing.  */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|iface
block|{
name|int
name|if_MTU
decl_stmt|;
name|char
modifier|*
name|if_name
decl_stmt|;
name|struct
name|in_addr
name|if_addr
decl_stmt|;
name|struct
name|ether_addr
name|if_eaddr
decl_stmt|;
name|struct
name|iface
modifier|*
name|if_next
decl_stmt|;
name|int
name|if_fd
decl_stmt|;
block|}
name|iface_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|send
block|{
name|struct
name|iface
modifier|*
name|snd_if
decl_stmt|;
name|struct
name|in_addr
name|snd_gw
decl_stmt|;
block|}
name|send_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|arp
block|{
name|struct
name|in_addr
name|arp_addr
decl_stmt|;
name|struct
name|ether_addr
name|arp_eaddr
decl_stmt|;
name|struct
name|arp
modifier|*
name|arp_next
decl_stmt|;
block|}
name|arp_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|aniphdr
block|{
union|union
block|{
name|ip_t
modifier|*
name|ahu_ip
decl_stmt|;
name|char
modifier|*
name|ahu_data
decl_stmt|;
name|tcphdr_t
modifier|*
name|ahu_tcp
decl_stmt|;
name|udphdr_t
modifier|*
name|ahu_udp
decl_stmt|;
name|icmphdr_t
modifier|*
name|ahu_icmp
decl_stmt|;
block|}
name|ah_un
union|;
name|int
name|ah_optlen
decl_stmt|;
name|int
name|ah_lastopt
decl_stmt|;
name|int
name|ah_p
decl_stmt|;
name|size_t
name|ah_len
decl_stmt|;
name|struct
name|aniphdr
modifier|*
name|ah_next
decl_stmt|;
name|struct
name|aniphdr
modifier|*
name|ah_prev
decl_stmt|;
block|}
name|aniphdr_t
typedef|;
end_typedef

begin_define
define|#
directive|define
name|ah_ip
value|ah_un.ahu_ip
end_define

begin_define
define|#
directive|define
name|ah_data
value|ah_un.ahu_data
end_define

begin_define
define|#
directive|define
name|ah_tcp
value|ah_un.ahu_tcp
end_define

begin_define
define|#
directive|define
name|ah_udp
value|ah_un.ahu_udp
end_define

begin_define
define|#
directive|define
name|ah_icmp
value|ah_un.ahu_icmp
end_define

begin_decl_stmt
specifier|extern
name|int
name|get_arpipv4
name|__P
argument_list|(
operator|(
name|char
operator|*
operator|,
name|char
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

end_unit

