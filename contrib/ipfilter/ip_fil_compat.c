begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (C) 2002-2012 by Darren Reed.  *  * See the IPFILTER.LICENCE file for details on licencing.  */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|KERNEL
argument_list|)
operator|||
name|defined
argument_list|(
name|_KERNEL
argument_list|)
end_if

begin_undef
undef|#
directive|undef
name|KERNEL
end_undef

begin_undef
undef|#
directive|undef
name|_KERNEL
end_undef

begin_define
define|#
directive|define
name|KERNEL
value|1
end_define

begin_define
define|#
directive|define
name|_KERNEL
value|1
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__osf__
argument_list|)
end_if

begin_define
define|#
directive|define
name|_PROTO_NET_H_
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<sys/errno.h>
end_include

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|<sys/time.h>
end_include

begin_include
include|#
directive|include
file|<sys/file.h>
end_include

begin_if
if|#
directive|if
name|__FreeBSD_version
operator|>=
literal|220000
operator|&&
name|defined
argument_list|(
name|_KERNEL
argument_list|)
end_if

begin_include
include|#
directive|include
file|<sys/fcntl.h>
end_include

begin_include
include|#
directive|include
file|<sys/filio.h>
end_include

begin_else
else|#
directive|else
end_else

begin_include
include|#
directive|include
file|<sys/ioctl.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|_KERNEL
argument_list|)
end_if

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_define
define|#
directive|define
name|_KERNEL
end_define

begin_ifdef
ifdef|#
directive|ifdef
name|__OpenBSD__
end_ifdef

begin_struct_decl
struct_decl|struct
name|file
struct_decl|;
end_struct_decl

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<sys/uio.h>
end_include

begin_undef
undef|#
directive|undef
name|_KERNEL
end_undef

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<sys/socket.h>
end_include

begin_if
if|#
directive|if
operator|(
name|defined
argument_list|(
name|__osf__
argument_list|)
operator|||
name|defined
argument_list|(
name|AIX
argument_list|)
operator|||
name|defined
argument_list|(
name|__hpux
argument_list|)
operator|||
name|defined
argument_list|(
name|__sgi
argument_list|)
operator|)
operator|&&
name|defined
argument_list|(
name|_KERNEL
argument_list|)
end_if

begin_include
include|#
directive|include
file|"radix_ipf_local.h"
end_include

begin_define
define|#
directive|define
name|_RADIX_H_
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<net/if.h>
end_include

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__FreeBSD__
argument_list|)
end_if

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_include
include|#
directive|include
file|<sys/proc.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
name|defined
argument_list|(
name|_KERNEL
argument_list|)
end_if

begin_include
include|#
directive|include
file|<sys/systm.h>
end_include

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|__SVR4
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|__svr4__
argument_list|)
end_if

begin_include
include|#
directive|include
file|<sys/mbuf.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<netinet/in.h>
end_include

begin_include
include|#
directive|include
file|"netinet/ip_compat.h"
end_include

begin_include
include|#
directive|include
file|"netinet/ip_fil.h"
end_include

begin_include
include|#
directive|include
file|"netinet/ip_pool.h"
end_include

begin_include
include|#
directive|include
file|"netinet/ip_htable.h"
end_include

begin_include
include|#
directive|include
file|"netinet/ip_lookup.h"
end_include

begin_include
include|#
directive|include
file|"netinet/ip_nat.h"
end_include

begin_include
include|#
directive|include
file|"netinet/ip_state.h"
end_include

begin_include
include|#
directive|include
file|"netinet/ip_proxy.h"
end_include

begin_include
include|#
directive|include
file|"netinet/ip_auth.h"
end_include

begin_comment
comment|/* END OF INCLUDES */
end_comment

begin_comment
comment|/*  * NetBSD has moved to 64bit time_t for all architectures.  * For some, such as sparc64, there is no change because long is already  * 64bit, but for others (i386), there is...  */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|IPFILTER_COMPAT
end_ifdef

begin_ifdef
ifdef|#
directive|ifdef
name|__NetBSD__
end_ifdef

begin_typedef
typedef|typedef
struct|struct
name|timeval_l
block|{
name|long
name|tv_sec
decl_stmt|;
name|long
name|tv_usec
decl_stmt|;
block|}
name|timeval_l_t
typedef|;
end_typedef

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|tcpinfo4
block|{
name|u_short
name|ts_sport
decl_stmt|;
name|u_short
name|ts_dport
decl_stmt|;
name|tcpdata_t
name|ts_data
index|[
literal|2
index|]
decl_stmt|;
block|}
name|tcpinfo4_t
typedef|;
end_typedef

begin_decl_stmt
specifier|static
name|void
name|ipf_v5tcpinfoto4
name|__P
argument_list|(
operator|(
name|tcpinfo_t
operator|*
operator|,
name|tcpinfo4_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
name|ipf_v5tcpinfoto4
parameter_list|(
name|v5
parameter_list|,
name|v4
parameter_list|)
name|tcpinfo_t
modifier|*
name|v5
decl_stmt|;
name|tcpinfo4_t
modifier|*
name|v4
decl_stmt|;
block|{
name|v4
operator|->
name|ts_sport
operator|=
name|v5
operator|->
name|ts_sport
expr_stmt|;
name|v4
operator|->
name|ts_dport
operator|=
name|v5
operator|->
name|ts_dport
expr_stmt|;
name|v4
operator|->
name|ts_data
index|[
literal|0
index|]
operator|=
name|v5
operator|->
name|ts_data
index|[
literal|0
index|]
expr_stmt|;
name|v4
operator|->
name|ts_data
index|[
literal|1
index|]
operator|=
name|v5
operator|->
name|ts_data
index|[
literal|1
index|]
expr_stmt|;
block|}
end_function

begin_typedef
typedef|typedef
struct|struct
name|fr_ip4
block|{
name|u_32_t
name|fi_v
range|:
literal|4
decl_stmt|;
name|u_32_t
name|fi_xx
range|:
literal|4
decl_stmt|;
name|u_32_t
name|fi_tos
range|:
literal|8
decl_stmt|;
name|u_32_t
name|fi_ttl
range|:
literal|8
decl_stmt|;
name|u_32_t
name|fi_p
range|:
literal|8
decl_stmt|;
name|u_32_t
name|fi_optmsk
decl_stmt|;
name|i6addr_t
name|fi_src
decl_stmt|;
name|i6addr_t
name|fi_dst
decl_stmt|;
name|u_short
name|ofi_secmsk
decl_stmt|;
name|u_short
name|ofi_auth
decl_stmt|;
name|u_32_t
name|fi_flx
decl_stmt|;
name|u_32_t
name|fi_tcpmsk
decl_stmt|;
name|u_32_t
name|fi_res1
decl_stmt|;
block|}
name|frip4_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|frpcmp4
block|{
name|int
name|frp_cmp
decl_stmt|;
name|u_short
name|frp_port
decl_stmt|;
name|u_short
name|frp_top
decl_stmt|;
block|}
name|frpcmp4_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|frtuc4
block|{
name|u_char
name|ftu_tcpfm
decl_stmt|;
name|u_char
name|ftu_tcpf
decl_stmt|;
name|frpcmp4_t
name|ftu_src
decl_stmt|;
name|frpcmp4_t
name|ftu_dst
decl_stmt|;
block|}
name|frtuc4_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|fripf4
block|{
name|frip4_t
name|fri_ip
decl_stmt|;
name|frip4_t
name|fri_mip
decl_stmt|;
name|u_short
name|fri_icmpm
decl_stmt|;
name|u_short
name|fri_icmp
decl_stmt|;
name|frtuc4_t
name|fri_tuc
decl_stmt|;
name|int
name|fri_satype
decl_stmt|;
name|int
name|fri_datype
decl_stmt|;
name|int
name|fri_sifpidx
decl_stmt|;
name|int
name|fri_difpidx
decl_stmt|;
block|}
name|fripf4_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|frdest_4
block|{
name|void
modifier|*
name|fd_ifp
decl_stmt|;
name|i6addr_t
name|ofd_ip6
decl_stmt|;
name|char
name|fd_ifname
index|[
name|LIFNAMSIZ
index|]
decl_stmt|;
block|}
name|frdest_4_t
typedef|;
end_typedef

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_comment
comment|/* 5.1.0 new release (current)  * 4.1.34 changed the size of the time structure used for pps  * 4.1.16 moved the location of fr_flineno  * 4.1.0 base version  */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|frentry_4_1_34
block|{
name|ipfmutex_t
name|fr_lock
decl_stmt|;
name|struct
name|frentry
modifier|*
name|fr_next
decl_stmt|;
name|struct
name|frentry
modifier|*
modifier|*
name|fr_grp
decl_stmt|;
name|struct
name|ipscan
modifier|*
name|fr_isc
decl_stmt|;
name|void
modifier|*
name|fr_ifas
index|[
literal|4
index|]
decl_stmt|;
name|void
modifier|*
name|fr_ptr
decl_stmt|;
comment|/* for use with fr_arg */
name|char
modifier|*
name|fr_comment
decl_stmt|;
comment|/* text comment for rule */
name|int
name|fr_ref
decl_stmt|;
comment|/* reference count - for grouping */
name|int
name|fr_statecnt
decl_stmt|;
comment|/* state count - for limit rules */
name|int
name|fr_flineno
decl_stmt|;
comment|/* line number from conf file */
name|U_QUAD_T
name|fr_hits
decl_stmt|;
name|U_QUAD_T
name|fr_bytes
decl_stmt|;
union|union
block|{
name|struct
name|timeval
name|frp_lastpkt
decl_stmt|;
name|char
name|frp_bytes
index|[
literal|12
index|]
decl_stmt|;
block|}
name|fr_lpu
union|;
name|int
name|fr_curpps
decl_stmt|;
union|union
block|{
name|void
modifier|*
name|fru_data
decl_stmt|;
name|char
modifier|*
name|fru_caddr
decl_stmt|;
name|fripf4_t
modifier|*
name|fru_ipf
decl_stmt|;
name|frentfunc_t
name|fru_func
decl_stmt|;
block|}
name|fr_dun
union|;
name|ipfunc_t
name|fr_func
decl_stmt|;
comment|/* call this function */
name|int
name|fr_dsize
decl_stmt|;
name|int
name|fr_pps
decl_stmt|;
name|int
name|fr_statemax
decl_stmt|;
comment|/* max reference count */
name|u_32_t
name|fr_type
decl_stmt|;
name|u_32_t
name|fr_flags
decl_stmt|;
comment|/* per-rule flags&& options (see below) */
name|u_32_t
name|fr_logtag
decl_stmt|;
comment|/* user defined log tag # */
name|u_32_t
name|fr_collect
decl_stmt|;
comment|/* collection number */
name|u_int
name|fr_arg
decl_stmt|;
comment|/* misc. numeric arg for rule */
name|u_int
name|fr_loglevel
decl_stmt|;
comment|/* syslog log facility + priority */
name|u_int
name|fr_age
index|[
literal|2
index|]
decl_stmt|;
comment|/* non-TCP timeouts */
name|u_char
name|fr_v
decl_stmt|;
name|u_char
name|fr_icode
decl_stmt|;
comment|/* return ICMP code */
name|char
name|fr_group
index|[
name|FR_GROUPLEN
index|]
decl_stmt|;
comment|/* group to which this rule belongs */
name|char
name|fr_grhead
index|[
name|FR_GROUPLEN
index|]
decl_stmt|;
comment|/* group # which this rule starts */
name|ipftag_t
name|fr_nattag
decl_stmt|;
name|char
name|fr_ifnames
index|[
literal|4
index|]
index|[
name|LIFNAMSIZ
index|]
decl_stmt|;
name|char
name|fr_isctag
index|[
literal|16
index|]
decl_stmt|;
name|frdest_4_t
name|fr_tifs
index|[
literal|2
index|]
decl_stmt|;
comment|/* "to"/"reply-to" interface */
name|frdest_4_t
name|fr_dif
decl_stmt|;
comment|/* duplicate packet interface */
name|u_int
name|fr_cksum
decl_stmt|;
comment|/* checksum on filter rules for performance */
block|}
name|frentry_4_1_34_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|frentry_4_1_16
block|{
name|ipfmutex_t
name|fr_lock
decl_stmt|;
name|struct
name|frentry
modifier|*
name|fr_next
decl_stmt|;
name|struct
name|frentry
modifier|*
modifier|*
name|fr_grp
decl_stmt|;
name|struct
name|ipscan
modifier|*
name|fr_isc
decl_stmt|;
name|void
modifier|*
name|fr_ifas
index|[
literal|4
index|]
decl_stmt|;
name|void
modifier|*
name|fr_ptr
decl_stmt|;
name|char
modifier|*
name|fr_comment
decl_stmt|;
name|int
name|fr_ref
decl_stmt|;
name|int
name|fr_statecnt
decl_stmt|;
name|int
name|fr_flineno
decl_stmt|;
name|U_QUAD_T
name|fr_hits
decl_stmt|;
name|U_QUAD_T
name|fr_bytes
decl_stmt|;
union|union
block|{
ifdef|#
directive|ifdef
name|__NetBSD__
name|timeval_l_t
name|frp_lastpkt
decl_stmt|;
else|#
directive|else
name|struct
name|timeval
name|frp_lastpkt
decl_stmt|;
endif|#
directive|endif
block|}
name|fr_lpu
union|;
name|int
name|fr_curpps
decl_stmt|;
union|union
block|{
name|void
modifier|*
name|fru_data
decl_stmt|;
name|caddr_t
name|fru_caddr
decl_stmt|;
name|fripf4_t
modifier|*
name|fru_ipf
decl_stmt|;
name|frentfunc_t
name|fru_func
decl_stmt|;
block|}
name|fr_dun
union|;
name|ipfunc_t
name|fr_func
decl_stmt|;
name|int
name|fr_dsize
decl_stmt|;
name|int
name|fr_pps
decl_stmt|;
name|int
name|fr_statemax
decl_stmt|;
name|u_32_t
name|fr_type
decl_stmt|;
name|u_32_t
name|fr_flags
decl_stmt|;
name|u_32_t
name|fr_logtag
decl_stmt|;
name|u_32_t
name|fr_collect
decl_stmt|;
name|u_int
name|fr_arg
decl_stmt|;
name|u_int
name|fr_loglevel
decl_stmt|;
name|u_int
name|fr_age
index|[
literal|2
index|]
decl_stmt|;
name|u_char
name|fr_v
decl_stmt|;
name|u_char
name|fr_icode
decl_stmt|;
name|char
name|fr_group
index|[
name|FR_GROUPLEN
index|]
decl_stmt|;
name|char
name|fr_grhead
index|[
name|FR_GROUPLEN
index|]
decl_stmt|;
name|ipftag_t
name|fr_nattag
decl_stmt|;
name|char
name|fr_ifnames
index|[
literal|4
index|]
index|[
name|LIFNAMSIZ
index|]
decl_stmt|;
name|char
name|fr_isctag
index|[
literal|16
index|]
decl_stmt|;
name|frdest_4_t
name|fr_tifs
index|[
literal|2
index|]
decl_stmt|;
name|frdest_4_t
name|fr_dif
decl_stmt|;
name|u_int
name|fr_cksum
decl_stmt|;
block|}
name|frentry_4_1_16_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|frentry_4_1_0
block|{
name|ipfmutex_t
name|fr_lock
decl_stmt|;
name|struct
name|frentry
modifier|*
name|fr_next
decl_stmt|;
name|struct
name|frentry
modifier|*
modifier|*
name|fr_grp
decl_stmt|;
name|struct
name|ipscan
modifier|*
name|fr_isc
decl_stmt|;
name|void
modifier|*
name|fr_ifas
index|[
literal|4
index|]
decl_stmt|;
name|void
modifier|*
name|fr_ptr
decl_stmt|;
name|char
modifier|*
name|fr_comment
decl_stmt|;
name|int
name|fr_ref
decl_stmt|;
name|int
name|fr_statecnt
decl_stmt|;
name|U_QUAD_T
name|fr_hits
decl_stmt|;
name|U_QUAD_T
name|fr_bytes
decl_stmt|;
union|union
block|{
ifdef|#
directive|ifdef
name|__NetBSD__
name|timeval_l_t
name|frp_lastpkt
decl_stmt|;
else|#
directive|else
name|struct
name|timeval
name|frp_lastpkt
decl_stmt|;
endif|#
directive|endif
block|}
name|fr_lpu
union|;
name|int
name|fr_curpps
decl_stmt|;
union|union
block|{
name|void
modifier|*
name|fru_data
decl_stmt|;
name|caddr_t
name|fru_caddr
decl_stmt|;
name|fripf4_t
modifier|*
name|fru_ipf
decl_stmt|;
name|frentfunc_t
name|fru_func
decl_stmt|;
block|}
name|fr_dun
union|;
comment|/* 	 * Fields after this may not change whilst in the kernel. 	 */
name|ipfunc_t
name|fr_func
decl_stmt|;
name|int
name|fr_dsize
decl_stmt|;
name|int
name|fr_pps
decl_stmt|;
name|int
name|fr_statemax
decl_stmt|;
name|int
name|fr_flineno
decl_stmt|;
name|u_32_t
name|fr_type
decl_stmt|;
name|u_32_t
name|fr_flags
decl_stmt|;
name|u_32_t
name|fr_logtag
decl_stmt|;
name|u_32_t
name|fr_collect
decl_stmt|;
name|u_int
name|fr_arg
decl_stmt|;
name|u_int
name|fr_loglevel
decl_stmt|;
name|u_int
name|fr_age
index|[
literal|2
index|]
decl_stmt|;
name|u_char
name|fr_v
decl_stmt|;
name|u_char
name|fr_icode
decl_stmt|;
name|char
name|fr_group
index|[
name|FR_GROUPLEN
index|]
decl_stmt|;
name|char
name|fr_grhead
index|[
name|FR_GROUPLEN
index|]
decl_stmt|;
name|ipftag_t
name|fr_nattag
decl_stmt|;
name|char
name|fr_ifnames
index|[
literal|4
index|]
index|[
name|LIFNAMSIZ
index|]
decl_stmt|;
name|char
name|fr_isctag
index|[
literal|16
index|]
decl_stmt|;
name|frdest_4_t
name|fr_tifs
index|[
literal|2
index|]
decl_stmt|;
name|frdest_4_t
name|fr_dif
decl_stmt|;
name|u_int
name|fr_cksum
decl_stmt|;
block|}
name|frentry_4_1_0_t
typedef|;
end_typedef

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_comment
comment|/*  * 5.1.0  new release (current)  * 4.1.32 removed both fin_state and fin_nat, added fin_pktnum  * 4.1.24 added fin_cksum  * 4.1.23 added fin_exthdr  * 4.1.11 added fin_ifname  * 4.1.4  added fin_hbuf  */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|fr_info_4_1_32
block|{
name|void
modifier|*
name|fin_ifp
decl_stmt|;
comment|/* interface packet is `on' */
name|frip4_t
name|fin_fi
decl_stmt|;
comment|/* IP Packet summary */
union|union
block|{
name|u_short
name|fid_16
index|[
literal|2
index|]
decl_stmt|;
comment|/* TCP/UDP ports, ICMP code/type */
name|u_32_t
name|fid_32
decl_stmt|;
block|}
name|fin_dat
union|;
name|int
name|fin_out
decl_stmt|;
comment|/* in or out ? 1 == out, 0 == in */
name|int
name|fin_rev
decl_stmt|;
comment|/* state only: 1 = reverse */
name|u_short
name|fin_hlen
decl_stmt|;
comment|/* length of IP header in bytes */
name|u_char
name|ofin_tcpf
decl_stmt|;
comment|/* TCP header flags (SYN, ACK, etc) */
name|u_char
name|fin_icode
decl_stmt|;
comment|/* ICMP error to return */
name|u_32_t
name|fin_rule
decl_stmt|;
comment|/* rule # last matched */
name|char
name|fin_group
index|[
name|FR_GROUPLEN
index|]
decl_stmt|;
comment|/* group number, -1 for none */
name|struct
name|frentry
modifier|*
name|fin_fr
decl_stmt|;
comment|/* last matching rule */
name|void
modifier|*
name|fin_dp
decl_stmt|;
comment|/* start of data past IP header */
name|int
name|fin_dlen
decl_stmt|;
comment|/* length of data portion of packet */
name|int
name|fin_plen
decl_stmt|;
name|int
name|fin_ipoff
decl_stmt|;
comment|/* # bytes from buffer start to hdr */
name|u_short
name|fin_id
decl_stmt|;
comment|/* IP packet id field */
name|u_short
name|fin_off
decl_stmt|;
name|int
name|fin_depth
decl_stmt|;
comment|/* Group nesting depth */
name|int
name|fin_error
decl_stmt|;
comment|/* Error code to return */
name|int
name|fin_cksum
decl_stmt|;
comment|/* -1 bad, 1 good, 0 not done */
name|u_int
name|fin_pktnum
decl_stmt|;
name|void
modifier|*
name|fin_nattag
decl_stmt|;
name|void
modifier|*
name|fin_exthdr
decl_stmt|;
name|ip_t
modifier|*
name|ofin_ip
decl_stmt|;
name|mb_t
modifier|*
modifier|*
name|fin_mp
decl_stmt|;
comment|/* pointer to pointer to mbuf */
name|mb_t
modifier|*
name|fin_m
decl_stmt|;
comment|/* pointer to mbuf */
ifdef|#
directive|ifdef
name|MENTAT
name|mb_t
modifier|*
name|fin_qfm
decl_stmt|;
comment|/* pointer to mblk where pkt starts */
name|void
modifier|*
name|fin_qpi
decl_stmt|;
name|char
name|fin_ifname
index|[
name|LIFNAMSIZ
index|]
decl_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|__sgi
name|void
modifier|*
name|fin_hbuf
decl_stmt|;
endif|#
directive|endif
block|}
name|fr_info_4_1_32_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|fr_info_4_1_24
block|{
name|void
modifier|*
name|fin_ifp
decl_stmt|;
name|frip4_t
name|fin_fi
decl_stmt|;
union|union
block|{
name|u_short
name|fid_16
index|[
literal|2
index|]
decl_stmt|;
name|u_32_t
name|fid_32
decl_stmt|;
block|}
name|fin_dat
union|;
name|int
name|fin_out
decl_stmt|;
name|int
name|fin_rev
decl_stmt|;
name|u_short
name|fin_hlen
decl_stmt|;
name|u_char
name|ofin_tcpf
decl_stmt|;
name|u_char
name|fin_icode
decl_stmt|;
name|u_32_t
name|fin_rule
decl_stmt|;
name|char
name|fin_group
index|[
name|FR_GROUPLEN
index|]
decl_stmt|;
name|struct
name|frentry
modifier|*
name|fin_fr
decl_stmt|;
name|void
modifier|*
name|fin_dp
decl_stmt|;
name|int
name|fin_dlen
decl_stmt|;
name|int
name|fin_plen
decl_stmt|;
name|int
name|fin_ipoff
decl_stmt|;
name|u_short
name|fin_id
decl_stmt|;
name|u_short
name|fin_off
decl_stmt|;
name|int
name|fin_depth
decl_stmt|;
name|int
name|fin_error
decl_stmt|;
name|int
name|fin_cksum
decl_stmt|;
name|void
modifier|*
name|fin_state
decl_stmt|;
name|void
modifier|*
name|fin_nat
decl_stmt|;
name|void
modifier|*
name|fin_nattag
decl_stmt|;
name|void
modifier|*
name|fin_exthdr
decl_stmt|;
name|ip_t
modifier|*
name|ofin_ip
decl_stmt|;
name|mb_t
modifier|*
modifier|*
name|fin_mp
decl_stmt|;
name|mb_t
modifier|*
name|fin_m
decl_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|mb_t
modifier|*
name|fin_qfm
decl_stmt|;
name|void
modifier|*
name|fin_qpi
decl_stmt|;
name|char
name|fin_ifname
index|[
name|LIFNAMSIZ
index|]
decl_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|__sgi
name|void
modifier|*
name|fin_hbuf
decl_stmt|;
endif|#
directive|endif
block|}
name|fr_info_4_1_24_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|fr_info_4_1_23
block|{
name|void
modifier|*
name|fin_ifp
decl_stmt|;
name|frip4_t
name|fin_fi
decl_stmt|;
union|union
block|{
name|u_short
name|fid_16
index|[
literal|2
index|]
decl_stmt|;
name|u_32_t
name|fid_32
decl_stmt|;
block|}
name|fin_dat
union|;
name|int
name|fin_out
decl_stmt|;
name|int
name|fin_rev
decl_stmt|;
name|u_short
name|fin_hlen
decl_stmt|;
name|u_char
name|ofin_tcpf
decl_stmt|;
name|u_char
name|fin_icode
decl_stmt|;
name|u_32_t
name|fin_rule
decl_stmt|;
name|char
name|fin_group
index|[
name|FR_GROUPLEN
index|]
decl_stmt|;
name|struct
name|frentry
modifier|*
name|fin_fr
decl_stmt|;
name|void
modifier|*
name|fin_dp
decl_stmt|;
name|int
name|fin_dlen
decl_stmt|;
name|int
name|fin_plen
decl_stmt|;
name|int
name|fin_ipoff
decl_stmt|;
name|u_short
name|fin_id
decl_stmt|;
name|u_short
name|fin_off
decl_stmt|;
name|int
name|fin_depth
decl_stmt|;
name|int
name|fin_error
decl_stmt|;
name|void
modifier|*
name|fin_state
decl_stmt|;
name|void
modifier|*
name|fin_nat
decl_stmt|;
name|void
modifier|*
name|fin_nattag
decl_stmt|;
name|void
modifier|*
name|fin_exthdr
decl_stmt|;
name|ip_t
modifier|*
name|ofin_ip
decl_stmt|;
name|mb_t
modifier|*
modifier|*
name|fin_mp
decl_stmt|;
name|mb_t
modifier|*
name|fin_m
decl_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|mb_t
modifier|*
name|fin_qfm
decl_stmt|;
name|void
modifier|*
name|fin_qpi
decl_stmt|;
name|char
name|fin_ifname
index|[
name|LIFNAMSIZ
index|]
decl_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|__sgi
name|void
modifier|*
name|fin_hbuf
decl_stmt|;
endif|#
directive|endif
block|}
name|fr_info_4_1_23_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|fr_info_4_1_11
block|{
name|void
modifier|*
name|fin_ifp
decl_stmt|;
name|frip4_t
name|fin_fi
decl_stmt|;
union|union
block|{
name|u_short
name|fid_16
index|[
literal|2
index|]
decl_stmt|;
name|u_32_t
name|fid_32
decl_stmt|;
block|}
name|fin_dat
union|;
name|int
name|fin_out
decl_stmt|;
name|int
name|fin_rev
decl_stmt|;
name|u_short
name|fin_hlen
decl_stmt|;
name|u_char
name|ofin_tcpf
decl_stmt|;
name|u_char
name|fin_icode
decl_stmt|;
name|u_32_t
name|fin_rule
decl_stmt|;
name|char
name|fin_group
index|[
name|FR_GROUPLEN
index|]
decl_stmt|;
name|struct
name|frentry
modifier|*
name|fin_fr
decl_stmt|;
name|void
modifier|*
name|fin_dp
decl_stmt|;
name|int
name|fin_dlen
decl_stmt|;
name|int
name|fin_plen
decl_stmt|;
name|int
name|fin_ipoff
decl_stmt|;
name|u_short
name|fin_id
decl_stmt|;
name|u_short
name|fin_off
decl_stmt|;
name|int
name|fin_depth
decl_stmt|;
name|int
name|fin_error
decl_stmt|;
name|void
modifier|*
name|fin_state
decl_stmt|;
name|void
modifier|*
name|fin_nat
decl_stmt|;
name|void
modifier|*
name|fin_nattag
decl_stmt|;
name|ip_t
modifier|*
name|ofin_ip
decl_stmt|;
name|mb_t
modifier|*
modifier|*
name|fin_mp
decl_stmt|;
name|mb_t
modifier|*
name|fin_m
decl_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|mb_t
modifier|*
name|fin_qfm
decl_stmt|;
name|void
modifier|*
name|fin_qpi
decl_stmt|;
name|char
name|fin_ifname
index|[
name|LIFNAMSIZ
index|]
decl_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|__sgi
name|void
modifier|*
name|fin_hbuf
decl_stmt|;
endif|#
directive|endif
block|}
name|fr_info_4_1_11_t
typedef|;
end_typedef

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|filterstats_4_1
block|{
name|u_long
name|fr_pass
decl_stmt|;
comment|/* packets allowed */
name|u_long
name|fr_block
decl_stmt|;
comment|/* packets denied */
name|u_long
name|fr_nom
decl_stmt|;
comment|/* packets which don't match any rule */
name|u_long
name|fr_short
decl_stmt|;
comment|/* packets which are short */
name|u_long
name|fr_ppkl
decl_stmt|;
comment|/* packets allowed and logged */
name|u_long
name|fr_bpkl
decl_stmt|;
comment|/* packets denied and logged */
name|u_long
name|fr_npkl
decl_stmt|;
comment|/* packets unmatched and logged */
name|u_long
name|fr_pkl
decl_stmt|;
comment|/* packets logged */
name|u_long
name|fr_skip
decl_stmt|;
comment|/* packets to be logged but buffer full */
name|u_long
name|fr_ret
decl_stmt|;
comment|/* packets for which a return is sent */
name|u_long
name|fr_acct
decl_stmt|;
comment|/* packets for which counting was performed */
name|u_long
name|fr_bnfr
decl_stmt|;
comment|/* bad attempts to allocate fragment state */
name|u_long
name|fr_nfr
decl_stmt|;
comment|/* new fragment state kept */
name|u_long
name|fr_cfr
decl_stmt|;
comment|/* add new fragment state but complete pkt */
name|u_long
name|fr_bads
decl_stmt|;
comment|/* bad attempts to allocate packet state */
name|u_long
name|fr_ads
decl_stmt|;
comment|/* new packet state kept */
name|u_long
name|fr_chit
decl_stmt|;
comment|/* cached hit */
name|u_long
name|fr_tcpbad
decl_stmt|;
comment|/* TCP checksum check failures */
name|u_long
name|fr_pull
index|[
literal|2
index|]
decl_stmt|;
comment|/* good and bad pullup attempts */
name|u_long
name|fr_badsrc
decl_stmt|;
comment|/* source received doesn't match route */
name|u_long
name|fr_badttl
decl_stmt|;
comment|/* TTL in packet doesn't reach minimum */
name|u_long
name|fr_bad
decl_stmt|;
comment|/* bad IP packets to the filter */
name|u_long
name|fr_ipv6
decl_stmt|;
comment|/* IPv6 packets in/out */
name|u_long
name|fr_ppshit
decl_stmt|;
comment|/* dropped because of pps ceiling */
name|u_long
name|fr_ipud
decl_stmt|;
comment|/* IP id update failures */
block|}
name|filterstats_4_1_t
typedef|;
end_typedef

begin_comment
comment|/*  * 5.1.0  new release (current)  * 4.1.33 changed the size of f_locks from IPL_LOGMAX to IPL_LOGSIZE  */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|friostat_4_1_33
block|{
name|struct
name|filterstats_4_1
name|of_st
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|frentry
modifier|*
name|f_ipf
index|[
literal|2
index|]
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|frentry
modifier|*
name|f_acct
index|[
literal|2
index|]
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|frentry
modifier|*
name|f_ipf6
index|[
literal|2
index|]
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|frentry
modifier|*
name|f_acct6
index|[
literal|2
index|]
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|frentry
modifier|*
name|f_auth
decl_stmt|;
name|struct
name|frgroup
modifier|*
name|f_groups
index|[
name|IPL_LOGSIZE
index|]
index|[
literal|2
index|]
decl_stmt|;
name|u_long
name|f_froute
index|[
literal|2
index|]
decl_stmt|;
name|u_long
name|f_ticks
decl_stmt|;
name|int
name|f_locks
index|[
name|IPL_LOGSIZE
index|]
decl_stmt|;
name|size_t
name|f_kmutex_sz
decl_stmt|;
name|size_t
name|f_krwlock_sz
decl_stmt|;
name|int
name|f_defpass
decl_stmt|;
comment|/* default pass - from fr_pass */
name|int
name|f_active
decl_stmt|;
comment|/* 1 or 0 - active rule set */
name|int
name|f_running
decl_stmt|;
comment|/* 1 if running, else 0 */
name|int
name|f_logging
decl_stmt|;
comment|/* 1 if enabled, else 0 */
name|int
name|f_features
decl_stmt|;
name|char
name|f_version
index|[
literal|32
index|]
decl_stmt|;
comment|/* version string */
block|}
name|friostat_4_1_33_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|friostat_4_1_0
block|{
name|struct
name|filterstats_4_1
name|of_st
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|frentry
modifier|*
name|f_ipf
index|[
literal|2
index|]
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|frentry
modifier|*
name|f_acct
index|[
literal|2
index|]
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|frentry
modifier|*
name|f_ipf6
index|[
literal|2
index|]
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|frentry
modifier|*
name|f_acct6
index|[
literal|2
index|]
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|frentry
modifier|*
name|f_auth
decl_stmt|;
name|struct
name|frgroup
modifier|*
name|f_groups
index|[
name|IPL_LOGSIZE
index|]
index|[
literal|2
index|]
decl_stmt|;
name|u_long
name|f_froute
index|[
literal|2
index|]
decl_stmt|;
name|u_long
name|f_ticks
decl_stmt|;
name|int
name|f_locks
index|[
name|IPL_LOGMAX
index|]
decl_stmt|;
name|size_t
name|f_kmutex_sz
decl_stmt|;
name|size_t
name|f_krwlock_sz
decl_stmt|;
name|int
name|f_defpass
decl_stmt|;
name|int
name|f_active
decl_stmt|;
name|int
name|f_running
decl_stmt|;
name|int
name|f_logging
decl_stmt|;
name|int
name|f_features
decl_stmt|;
name|char
name|f_version
index|[
literal|32
index|]
decl_stmt|;
block|}
name|friostat_4_1_0_t
typedef|;
end_typedef

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_comment
comment|/*  * 5.1.0  new release (current)  * 4.1.14 added in_lock  */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|ipnat_4_1_14
block|{
name|ipfmutex_t
name|in_lock
decl_stmt|;
name|struct
name|ipnat
modifier|*
name|in_next
decl_stmt|;
comment|/* NAT rule list next */
name|struct
name|ipnat
modifier|*
name|in_rnext
decl_stmt|;
comment|/* rdr rule hash next */
name|struct
name|ipnat
modifier|*
modifier|*
name|in_prnext
decl_stmt|;
comment|/* prior rdr next ptr */
name|struct
name|ipnat
modifier|*
name|in_mnext
decl_stmt|;
comment|/* map rule hash next */
name|struct
name|ipnat
modifier|*
modifier|*
name|in_pmnext
decl_stmt|;
comment|/* prior map next ptr */
name|struct
name|ipftq
modifier|*
name|in_tqehead
index|[
literal|2
index|]
decl_stmt|;
name|void
modifier|*
name|in_ifps
index|[
literal|2
index|]
decl_stmt|;
name|void
modifier|*
name|in_apr
decl_stmt|;
name|char
modifier|*
name|in_comment
decl_stmt|;
name|i6addr_t
name|in_next6
decl_stmt|;
name|u_long
name|in_space
decl_stmt|;
name|u_long
name|in_hits
decl_stmt|;
name|u_int
name|in_use
decl_stmt|;
name|u_int
name|in_hv
decl_stmt|;
name|int
name|in_flineno
decl_stmt|;
comment|/* conf. file line number */
name|u_short
name|in_pnext
decl_stmt|;
name|u_char
name|in_v
decl_stmt|;
name|u_char
name|in_xxx
decl_stmt|;
comment|/* From here to the end is covered by IPN_CMPSIZ */
name|u_32_t
name|in_flags
decl_stmt|;
name|u_32_t
name|in_mssclamp
decl_stmt|;
comment|/* if != 0 clamp MSS to this */
name|u_int
name|in_age
index|[
literal|2
index|]
decl_stmt|;
name|int
name|in_redir
decl_stmt|;
comment|/* see below for values */
name|int
name|in_p
decl_stmt|;
comment|/* protocol. */
name|i6addr_t
name|in_in
index|[
literal|2
index|]
decl_stmt|;
name|i6addr_t
name|in_out
index|[
literal|2
index|]
decl_stmt|;
name|i6addr_t
name|in_src
index|[
literal|2
index|]
decl_stmt|;
name|frtuc4_t
name|in_tuc
decl_stmt|;
name|u_short
name|in_port
index|[
literal|2
index|]
decl_stmt|;
name|u_short
name|in_ppip
decl_stmt|;
comment|/* ports per IP. */
name|u_short
name|in_ippip
decl_stmt|;
comment|/* IP #'s per IP# */
name|char
name|in_ifnames
index|[
literal|2
index|]
index|[
name|LIFNAMSIZ
index|]
decl_stmt|;
name|char
name|in_plabel
index|[
name|APR_LABELLEN
index|]
decl_stmt|;
comment|/* proxy label. */
name|ipftag_t
name|in_tag
decl_stmt|;
block|}
name|ipnat_4_1_14_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|ipnat_4_1_0
block|{
name|struct
name|ipnat
modifier|*
name|in_next
decl_stmt|;
name|struct
name|ipnat
modifier|*
name|in_rnext
decl_stmt|;
name|struct
name|ipnat
modifier|*
modifier|*
name|in_prnext
decl_stmt|;
name|struct
name|ipnat
modifier|*
name|in_mnext
decl_stmt|;
name|struct
name|ipnat
modifier|*
modifier|*
name|in_pmnext
decl_stmt|;
name|struct
name|ipftq
modifier|*
name|in_tqehead
index|[
literal|2
index|]
decl_stmt|;
name|void
modifier|*
name|in_ifps
index|[
literal|2
index|]
decl_stmt|;
name|void
modifier|*
name|in_apr
decl_stmt|;
name|char
modifier|*
name|in_comment
decl_stmt|;
name|i6addr_t
name|in_next6
decl_stmt|;
name|u_long
name|in_space
decl_stmt|;
name|u_long
name|in_hits
decl_stmt|;
name|u_int
name|in_use
decl_stmt|;
name|u_int
name|in_hv
decl_stmt|;
name|int
name|in_flineno
decl_stmt|;
name|u_short
name|in_pnext
decl_stmt|;
name|u_char
name|in_v
decl_stmt|;
name|u_char
name|in_xxx
decl_stmt|;
name|u_32_t
name|in_flags
decl_stmt|;
name|u_32_t
name|in_mssclamp
decl_stmt|;
name|u_int
name|in_age
index|[
literal|2
index|]
decl_stmt|;
name|int
name|in_redir
decl_stmt|;
name|int
name|in_p
decl_stmt|;
name|i6addr_t
name|in_in
index|[
literal|2
index|]
decl_stmt|;
name|i6addr_t
name|in_out
index|[
literal|2
index|]
decl_stmt|;
name|i6addr_t
name|in_src
index|[
literal|2
index|]
decl_stmt|;
name|frtuc4_t
name|in_tuc
decl_stmt|;
name|u_short
name|in_port
index|[
literal|2
index|]
decl_stmt|;
name|u_short
name|in_ppip
decl_stmt|;
name|u_short
name|in_ippip
decl_stmt|;
name|char
name|in_ifnames
index|[
literal|2
index|]
index|[
name|LIFNAMSIZ
index|]
decl_stmt|;
name|char
name|in_plabel
index|[
name|APR_LABELLEN
index|]
decl_stmt|;
name|ipftag_t
name|in_tag
decl_stmt|;
block|}
name|ipnat_4_1_0_t
typedef|;
end_typedef

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|natlookup_4_1_1
block|{
name|struct
name|in_addr
name|onl_inip
decl_stmt|;
name|struct
name|in_addr
name|onl_outip
decl_stmt|;
name|struct
name|in_addr
name|onl_realip
decl_stmt|;
name|int
name|nl_flags
decl_stmt|;
name|u_short
name|nl_inport
decl_stmt|;
name|u_short
name|nl_outport
decl_stmt|;
name|u_short
name|nl_realport
decl_stmt|;
block|}
name|natlookup_4_1_1_t
typedef|;
end_typedef

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_comment
comment|/*  * 4.1.25 added nat_seqnext (current)  * 4.1.14 added nat_redir  * 4.1.3  moved nat_rev  * 4.1.2  added nat_rev  */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|nat_4_1_25
block|{
name|ipfmutex_t
name|nat_lock
decl_stmt|;
name|struct
name|nat_4_1_25
modifier|*
name|nat_next
decl_stmt|;
name|struct
name|nat_4_1_25
modifier|*
modifier|*
name|nat_pnext
decl_stmt|;
name|struct
name|nat_4_1_25
modifier|*
name|nat_hnext
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|nat_4_1_25
modifier|*
modifier|*
name|nat_phnext
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|hostmap
modifier|*
name|nat_hm
decl_stmt|;
name|void
modifier|*
name|nat_data
decl_stmt|;
name|struct
name|nat_4_1_25
modifier|*
modifier|*
name|nat_me
decl_stmt|;
name|struct
name|ipstate
modifier|*
name|nat_state
decl_stmt|;
name|struct
name|ap_session
modifier|*
name|nat_aps
decl_stmt|;
name|frentry_t
modifier|*
name|nat_fr
decl_stmt|;
name|struct
name|ipnat_4_1_14
modifier|*
name|nat_ptr
decl_stmt|;
name|void
modifier|*
name|nat_ifps
index|[
literal|2
index|]
decl_stmt|;
name|void
modifier|*
name|nat_sync
decl_stmt|;
name|ipftqent_t
name|nat_tqe
decl_stmt|;
name|u_32_t
name|nat_flags
decl_stmt|;
name|u_32_t
name|nat_sumd
index|[
literal|2
index|]
decl_stmt|;
name|u_32_t
name|nat_ipsumd
decl_stmt|;
name|u_32_t
name|nat_mssclamp
decl_stmt|;
name|i6addr_t
name|nat_inip6
decl_stmt|;
name|i6addr_t
name|nat_outip6
decl_stmt|;
name|i6addr_t
name|nat_oip6
decl_stmt|;
name|U_QUAD_T
name|nat_pkts
index|[
literal|2
index|]
decl_stmt|;
name|U_QUAD_T
name|nat_bytes
index|[
literal|2
index|]
decl_stmt|;
union|union
block|{
name|udpinfo_t
name|nat_unu
decl_stmt|;
name|tcpinfo4_t
name|nat_unt
decl_stmt|;
name|icmpinfo_t
name|nat_uni
decl_stmt|;
name|greinfo_t
name|nat_ugre
decl_stmt|;
block|}
name|nat_un
union|;
name|u_short
name|nat_oport
decl_stmt|;
name|u_short
name|nat_use
decl_stmt|;
name|u_char
name|nat_p
decl_stmt|;
name|int
name|nat_dir
decl_stmt|;
name|int
name|nat_ref
decl_stmt|;
name|int
name|nat_hv
index|[
literal|2
index|]
decl_stmt|;
name|char
name|nat_ifnames
index|[
literal|2
index|]
index|[
name|LIFNAMSIZ
index|]
decl_stmt|;
name|int
name|nat_rev
decl_stmt|;
name|int
name|nat_redir
decl_stmt|;
name|u_32_t
name|nat_seqnext
index|[
literal|2
index|]
decl_stmt|;
block|}
name|nat_4_1_25_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|nat_4_1_14
block|{
name|ipfmutex_t
name|nat_lock
decl_stmt|;
name|struct
name|nat
modifier|*
name|nat_next
decl_stmt|;
name|struct
name|nat
modifier|*
modifier|*
name|nat_pnext
decl_stmt|;
name|struct
name|nat
modifier|*
name|nat_hnext
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|nat
modifier|*
modifier|*
name|nat_phnext
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|hostmap
modifier|*
name|nat_hm
decl_stmt|;
name|void
modifier|*
name|nat_data
decl_stmt|;
name|struct
name|nat
modifier|*
modifier|*
name|nat_me
decl_stmt|;
name|struct
name|ipstate
modifier|*
name|nat_state
decl_stmt|;
name|struct
name|ap_session
modifier|*
name|nat_aps
decl_stmt|;
name|frentry_t
modifier|*
name|nat_fr
decl_stmt|;
name|struct
name|ipnat
modifier|*
name|nat_ptr
decl_stmt|;
name|void
modifier|*
name|nat_ifps
index|[
literal|2
index|]
decl_stmt|;
name|void
modifier|*
name|nat_sync
decl_stmt|;
name|ipftqent_t
name|nat_tqe
decl_stmt|;
name|u_32_t
name|nat_flags
decl_stmt|;
name|u_32_t
name|nat_sumd
index|[
literal|2
index|]
decl_stmt|;
name|u_32_t
name|nat_ipsumd
decl_stmt|;
name|u_32_t
name|nat_mssclamp
decl_stmt|;
name|i6addr_t
name|nat_inip6
decl_stmt|;
name|i6addr_t
name|nat_outip6
decl_stmt|;
name|i6addr_t
name|nat_oip6
decl_stmt|;
name|U_QUAD_T
name|nat_pkts
index|[
literal|2
index|]
decl_stmt|;
name|U_QUAD_T
name|nat_bytes
index|[
literal|2
index|]
decl_stmt|;
union|union
block|{
name|udpinfo_t
name|nat_unu
decl_stmt|;
name|tcpinfo4_t
name|nat_unt
decl_stmt|;
name|icmpinfo_t
name|nat_uni
decl_stmt|;
name|greinfo_t
name|nat_ugre
decl_stmt|;
block|}
name|nat_un
union|;
name|u_short
name|nat_oport
decl_stmt|;
name|u_short
name|nat_use
decl_stmt|;
name|u_char
name|nat_p
decl_stmt|;
name|int
name|nat_dir
decl_stmt|;
name|int
name|nat_ref
decl_stmt|;
name|int
name|nat_hv
index|[
literal|2
index|]
decl_stmt|;
name|char
name|nat_ifnames
index|[
literal|2
index|]
index|[
name|LIFNAMSIZ
index|]
decl_stmt|;
name|int
name|nat_rev
decl_stmt|;
name|int
name|nat_redir
decl_stmt|;
block|}
name|nat_4_1_14_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|nat_4_1_3
block|{
name|ipfmutex_t
name|nat_lock
decl_stmt|;
name|struct
name|nat
modifier|*
name|nat_next
decl_stmt|;
name|struct
name|nat
modifier|*
modifier|*
name|nat_pnext
decl_stmt|;
name|struct
name|nat
modifier|*
name|nat_hnext
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|nat
modifier|*
modifier|*
name|nat_phnext
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|hostmap
modifier|*
name|nat_hm
decl_stmt|;
name|void
modifier|*
name|nat_data
decl_stmt|;
name|struct
name|nat
modifier|*
modifier|*
name|nat_me
decl_stmt|;
name|struct
name|ipstate
modifier|*
name|nat_state
decl_stmt|;
name|struct
name|ap_session
modifier|*
name|nat_aps
decl_stmt|;
name|frentry_t
modifier|*
name|nat_fr
decl_stmt|;
name|struct
name|ipnat
modifier|*
name|nat_ptr
decl_stmt|;
name|void
modifier|*
name|nat_ifps
index|[
literal|2
index|]
decl_stmt|;
name|void
modifier|*
name|nat_sync
decl_stmt|;
name|ipftqent_t
name|nat_tqe
decl_stmt|;
name|u_32_t
name|nat_flags
decl_stmt|;
name|u_32_t
name|nat_sumd
index|[
literal|2
index|]
decl_stmt|;
name|u_32_t
name|nat_ipsumd
decl_stmt|;
name|u_32_t
name|nat_mssclamp
decl_stmt|;
name|i6addr_t
name|nat_inip6
decl_stmt|;
name|i6addr_t
name|nat_outip6
decl_stmt|;
name|i6addr_t
name|nat_oip6
decl_stmt|;
name|U_QUAD_T
name|nat_pkts
index|[
literal|2
index|]
decl_stmt|;
name|U_QUAD_T
name|nat_bytes
index|[
literal|2
index|]
decl_stmt|;
union|union
block|{
name|udpinfo_t
name|nat_unu
decl_stmt|;
name|tcpinfo4_t
name|nat_unt
decl_stmt|;
name|icmpinfo_t
name|nat_uni
decl_stmt|;
name|greinfo_t
name|nat_ugre
decl_stmt|;
block|}
name|nat_un
union|;
name|u_short
name|nat_oport
decl_stmt|;
name|u_short
name|nat_use
decl_stmt|;
name|u_char
name|nat_p
decl_stmt|;
name|int
name|nat_dir
decl_stmt|;
name|int
name|nat_ref
decl_stmt|;
name|int
name|nat_hv
index|[
literal|2
index|]
decl_stmt|;
name|char
name|nat_ifnames
index|[
literal|2
index|]
index|[
name|LIFNAMSIZ
index|]
decl_stmt|;
name|int
name|nat_rev
decl_stmt|;
block|}
name|nat_4_1_3_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|nat_save_4_1_34
block|{
name|void
modifier|*
name|ipn_next
decl_stmt|;
name|struct
name|nat_4_1_25
name|ipn_nat
decl_stmt|;
name|struct
name|ipnat_4_1_14
name|ipn_ipnat
decl_stmt|;
name|struct
name|frentry_4_1_34
name|ipn_fr
decl_stmt|;
name|int
name|ipn_dsize
decl_stmt|;
name|char
name|ipn_data
index|[
literal|4
index|]
decl_stmt|;
block|}
name|nat_save_4_1_34_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|nat_save_4_1_16
block|{
name|void
modifier|*
name|ipn_next
decl_stmt|;
name|nat_4_1_14_t
name|ipn_nat
decl_stmt|;
name|ipnat_t
name|ipn_ipnat
decl_stmt|;
name|frentry_4_1_16_t
name|ipn_fr
decl_stmt|;
name|int
name|ipn_dsize
decl_stmt|;
name|char
name|ipn_data
index|[
literal|4
index|]
decl_stmt|;
block|}
name|nat_save_4_1_16_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|nat_save_4_1_14
block|{
name|void
modifier|*
name|ipn_next
decl_stmt|;
name|nat_4_1_14_t
name|ipn_nat
decl_stmt|;
name|ipnat_t
name|ipn_ipnat
decl_stmt|;
name|frentry_4_1_0_t
name|ipn_fr
decl_stmt|;
name|int
name|ipn_dsize
decl_stmt|;
name|char
name|ipn_data
index|[
literal|4
index|]
decl_stmt|;
block|}
name|nat_save_4_1_14_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|nat_save_4_1_3
block|{
name|void
modifier|*
name|ipn_next
decl_stmt|;
name|nat_4_1_3_t
name|ipn_nat
decl_stmt|;
name|ipnat_4_1_0_t
name|ipn_ipnat
decl_stmt|;
name|frentry_4_1_0_t
name|ipn_fr
decl_stmt|;
name|int
name|ipn_dsize
decl_stmt|;
name|char
name|ipn_data
index|[
literal|4
index|]
decl_stmt|;
block|}
name|nat_save_4_1_3_t
typedef|;
end_typedef

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_comment
comment|/*  * 5.1.0  new release (current)  * 4.1.32 added ns_uncreate  * 4.1.27 added ns_orphans  * 4.1.16 added ns_ticks  */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|natstat_4_1_32
block|{
name|u_long
name|ns_mapped
index|[
literal|2
index|]
decl_stmt|;
name|u_long
name|ns_rules
decl_stmt|;
name|u_long
name|ns_added
decl_stmt|;
name|u_long
name|ns_expire
decl_stmt|;
name|u_long
name|ns_inuse
decl_stmt|;
name|u_long
name|ns_logged
decl_stmt|;
name|u_long
name|ns_logfail
decl_stmt|;
name|u_long
name|ns_memfail
decl_stmt|;
name|u_long
name|ns_badnat
decl_stmt|;
name|u_long
name|ns_addtrpnt
decl_stmt|;
name|nat_t
modifier|*
modifier|*
name|ns_table
index|[
literal|2
index|]
decl_stmt|;
name|hostmap_t
modifier|*
modifier|*
name|ns_maptable
decl_stmt|;
name|ipnat_t
modifier|*
name|ns_list
decl_stmt|;
name|void
modifier|*
name|ns_apslist
decl_stmt|;
name|u_int
name|ns_wilds
decl_stmt|;
name|u_int
name|ns_nattab_sz
decl_stmt|;
name|u_int
name|ns_nattab_max
decl_stmt|;
name|u_int
name|ns_rultab_sz
decl_stmt|;
name|u_int
name|ns_rdrtab_sz
decl_stmt|;
name|u_int
name|ns_trpntab_sz
decl_stmt|;
name|u_int
name|ns_hostmap_sz
decl_stmt|;
name|nat_t
modifier|*
name|ns_instances
decl_stmt|;
name|hostmap_t
modifier|*
name|ns_maplist
decl_stmt|;
name|u_long
modifier|*
name|ns_bucketlen
index|[
literal|2
index|]
decl_stmt|;
name|u_long
name|ns_ticks
decl_stmt|;
name|u_int
name|ns_orphans
decl_stmt|;
name|u_long
name|ns_uncreate
index|[
literal|2
index|]
index|[
literal|2
index|]
decl_stmt|;
block|}
name|natstat_4_1_32_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|natstat_4_1_27
block|{
name|u_long
name|ns_mapped
index|[
literal|2
index|]
decl_stmt|;
name|u_long
name|ns_rules
decl_stmt|;
name|u_long
name|ns_added
decl_stmt|;
name|u_long
name|ns_expire
decl_stmt|;
name|u_long
name|ns_inuse
decl_stmt|;
name|u_long
name|ns_logged
decl_stmt|;
name|u_long
name|ns_logfail
decl_stmt|;
name|u_long
name|ns_memfail
decl_stmt|;
name|u_long
name|ns_badnat
decl_stmt|;
name|u_long
name|ns_addtrpnt
decl_stmt|;
name|nat_t
modifier|*
modifier|*
name|ns_table
index|[
literal|2
index|]
decl_stmt|;
name|hostmap_t
modifier|*
modifier|*
name|ns_maptable
decl_stmt|;
name|ipnat_t
modifier|*
name|ns_list
decl_stmt|;
name|void
modifier|*
name|ns_apslist
decl_stmt|;
name|u_int
name|ns_wilds
decl_stmt|;
name|u_int
name|ns_nattab_sz
decl_stmt|;
name|u_int
name|ns_nattab_max
decl_stmt|;
name|u_int
name|ns_rultab_sz
decl_stmt|;
name|u_int
name|ns_rdrtab_sz
decl_stmt|;
name|u_int
name|ns_trpntab_sz
decl_stmt|;
name|u_int
name|ns_hostmap_sz
decl_stmt|;
name|nat_t
modifier|*
name|ns_instances
decl_stmt|;
name|hostmap_t
modifier|*
name|ns_maplist
decl_stmt|;
name|u_long
modifier|*
name|ns_bucketlen
index|[
literal|2
index|]
decl_stmt|;
name|u_long
name|ns_ticks
decl_stmt|;
name|u_int
name|ns_orphans
decl_stmt|;
block|}
name|natstat_4_1_27_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|natstat_4_1_16
block|{
name|u_long
name|ns_mapped
index|[
literal|2
index|]
decl_stmt|;
name|u_long
name|ns_rules
decl_stmt|;
name|u_long
name|ns_added
decl_stmt|;
name|u_long
name|ns_expire
decl_stmt|;
name|u_long
name|ns_inuse
decl_stmt|;
name|u_long
name|ns_logged
decl_stmt|;
name|u_long
name|ns_logfail
decl_stmt|;
name|u_long
name|ns_memfail
decl_stmt|;
name|u_long
name|ns_badnat
decl_stmt|;
name|u_long
name|ns_addtrpnt
decl_stmt|;
name|nat_t
modifier|*
modifier|*
name|ns_table
index|[
literal|2
index|]
decl_stmt|;
name|hostmap_t
modifier|*
modifier|*
name|ns_maptable
decl_stmt|;
name|ipnat_t
modifier|*
name|ns_list
decl_stmt|;
name|void
modifier|*
name|ns_apslist
decl_stmt|;
name|u_int
name|ns_wilds
decl_stmt|;
name|u_int
name|ns_nattab_sz
decl_stmt|;
name|u_int
name|ns_nattab_max
decl_stmt|;
name|u_int
name|ns_rultab_sz
decl_stmt|;
name|u_int
name|ns_rdrtab_sz
decl_stmt|;
name|u_int
name|ns_trpntab_sz
decl_stmt|;
name|u_int
name|ns_hostmap_sz
decl_stmt|;
name|nat_t
modifier|*
name|ns_instances
decl_stmt|;
name|hostmap_t
modifier|*
name|ns_maplist
decl_stmt|;
name|u_long
modifier|*
name|ns_bucketlen
index|[
literal|2
index|]
decl_stmt|;
name|u_long
name|ns_ticks
decl_stmt|;
block|}
name|natstat_4_1_16_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|natstat_4_1_0
block|{
name|u_long
name|ns_mapped
index|[
literal|2
index|]
decl_stmt|;
name|u_long
name|ns_rules
decl_stmt|;
name|u_long
name|ns_added
decl_stmt|;
name|u_long
name|ns_expire
decl_stmt|;
name|u_long
name|ns_inuse
decl_stmt|;
name|u_long
name|ns_logged
decl_stmt|;
name|u_long
name|ns_logfail
decl_stmt|;
name|u_long
name|ns_memfail
decl_stmt|;
name|u_long
name|ns_badnat
decl_stmt|;
name|u_long
name|ns_addtrpnt
decl_stmt|;
name|nat_t
modifier|*
modifier|*
name|ns_table
index|[
literal|2
index|]
decl_stmt|;
name|hostmap_t
modifier|*
modifier|*
name|ns_maptable
decl_stmt|;
name|ipnat_t
modifier|*
name|ns_list
decl_stmt|;
name|void
modifier|*
name|ns_apslist
decl_stmt|;
name|u_int
name|ns_wilds
decl_stmt|;
name|u_int
name|ns_nattab_sz
decl_stmt|;
name|u_int
name|ns_nattab_max
decl_stmt|;
name|u_int
name|ns_rultab_sz
decl_stmt|;
name|u_int
name|ns_rdrtab_sz
decl_stmt|;
name|u_int
name|ns_trpntab_sz
decl_stmt|;
name|u_int
name|ns_hostmap_sz
decl_stmt|;
name|nat_t
modifier|*
name|ns_instances
decl_stmt|;
name|hostmap_t
modifier|*
name|ns_maplist
decl_stmt|;
name|u_long
modifier|*
name|ns_bucketlen
index|[
literal|2
index|]
decl_stmt|;
block|}
name|natstat_4_1_0_t
typedef|;
end_typedef

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_comment
comment|/*  * 5.1.0  new release (current)  * 4.1.32 fra_info:removed both fin_state& fin_nat, added fin_pktnum  * 4.1.29 added fra_flx  * 4.1.24 fra_info:added fin_cksum  * 4.1.23 fra_info:added fin_exthdr  * 4.1.11 fra_info:added fin_ifname  * 4.1.4  fra_info:added fin_hbuf  */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|frauth_4_1_32
block|{
name|int
name|fra_age
decl_stmt|;
name|int
name|fra_len
decl_stmt|;
name|int
name|fra_index
decl_stmt|;
name|u_32_t
name|fra_pass
decl_stmt|;
name|fr_info_4_1_32_t
name|fra_info
decl_stmt|;
name|char
modifier|*
name|fra_buf
decl_stmt|;
name|u_32_t
name|fra_flx
decl_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|queue_t
modifier|*
name|fra_q
decl_stmt|;
name|mb_t
modifier|*
name|fra_m
decl_stmt|;
endif|#
directive|endif
block|}
name|frauth_4_1_32_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|frauth_4_1_29
block|{
name|int
name|fra_age
decl_stmt|;
name|int
name|fra_len
decl_stmt|;
name|int
name|fra_index
decl_stmt|;
name|u_32_t
name|fra_pass
decl_stmt|;
name|fr_info_4_1_24_t
name|fra_info
decl_stmt|;
name|char
modifier|*
name|fra_buf
decl_stmt|;
name|u_32_t
name|fra_flx
decl_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|queue_t
modifier|*
name|fra_q
decl_stmt|;
name|mb_t
modifier|*
name|fra_m
decl_stmt|;
endif|#
directive|endif
block|}
name|frauth_4_1_29_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|frauth_4_1_24
block|{
name|int
name|fra_age
decl_stmt|;
name|int
name|fra_len
decl_stmt|;
name|int
name|fra_index
decl_stmt|;
name|u_32_t
name|fra_pass
decl_stmt|;
name|fr_info_4_1_24_t
name|fra_info
decl_stmt|;
name|char
modifier|*
name|fra_buf
decl_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|queue_t
modifier|*
name|fra_q
decl_stmt|;
name|mb_t
modifier|*
name|fra_m
decl_stmt|;
endif|#
directive|endif
block|}
name|frauth_4_1_24_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|frauth_4_1_23
block|{
name|int
name|fra_age
decl_stmt|;
name|int
name|fra_len
decl_stmt|;
name|int
name|fra_index
decl_stmt|;
name|u_32_t
name|fra_pass
decl_stmt|;
name|fr_info_4_1_23_t
name|fra_info
decl_stmt|;
name|char
modifier|*
name|fra_buf
decl_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|queue_t
modifier|*
name|fra_q
decl_stmt|;
name|mb_t
modifier|*
name|fra_m
decl_stmt|;
endif|#
directive|endif
block|}
name|frauth_4_1_23_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|frauth_4_1_11
block|{
name|int
name|fra_age
decl_stmt|;
name|int
name|fra_len
decl_stmt|;
name|int
name|fra_index
decl_stmt|;
name|u_32_t
name|fra_pass
decl_stmt|;
name|fr_info_4_1_11_t
name|fra_info
decl_stmt|;
name|char
modifier|*
name|fra_buf
decl_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|queue_t
modifier|*
name|fra_q
decl_stmt|;
name|mb_t
modifier|*
name|fra_m
decl_stmt|;
endif|#
directive|endif
block|}
name|frauth_4_1_11_t
typedef|;
end_typedef

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_comment
comment|/*  * 5.1.0  new release (current)  * 4.1.16 removed is_nat  */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|ipstate_4_1_16
block|{
name|ipfmutex_t
name|is_lock
decl_stmt|;
name|struct
name|ipstate
modifier|*
name|is_next
decl_stmt|;
name|struct
name|ipstate
modifier|*
modifier|*
name|is_pnext
decl_stmt|;
name|struct
name|ipstate
modifier|*
name|is_hnext
decl_stmt|;
name|struct
name|ipstate
modifier|*
modifier|*
name|is_phnext
decl_stmt|;
name|struct
name|ipstate
modifier|*
modifier|*
name|is_me
decl_stmt|;
name|void
modifier|*
name|is_ifp
index|[
literal|4
index|]
decl_stmt|;
name|void
modifier|*
name|is_sync
decl_stmt|;
name|frentry_t
modifier|*
name|is_rule
decl_stmt|;
name|struct
name|ipftq
modifier|*
name|is_tqehead
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|ipscan
modifier|*
name|is_isc
decl_stmt|;
name|U_QUAD_T
name|is_pkts
index|[
literal|4
index|]
decl_stmt|;
name|U_QUAD_T
name|is_bytes
index|[
literal|4
index|]
decl_stmt|;
name|U_QUAD_T
name|is_icmppkts
index|[
literal|4
index|]
decl_stmt|;
name|struct
name|ipftqent
name|is_sti
decl_stmt|;
name|u_int
name|is_frage
index|[
literal|2
index|]
decl_stmt|;
name|int
name|is_ref
decl_stmt|;
comment|/* reference count */
name|int
name|is_isninc
index|[
literal|2
index|]
decl_stmt|;
name|u_short
name|is_sumd
index|[
literal|2
index|]
decl_stmt|;
name|i6addr_t
name|is_src
decl_stmt|;
name|i6addr_t
name|is_dst
decl_stmt|;
name|u_int
name|is_pass
decl_stmt|;
name|u_char
name|is_p
decl_stmt|;
comment|/* Protocol */
name|u_char
name|is_v
decl_stmt|;
name|u_32_t
name|is_hv
decl_stmt|;
name|u_32_t
name|is_tag
decl_stmt|;
name|u_32_t
name|is_opt
index|[
literal|2
index|]
decl_stmt|;
comment|/* packet options set */
name|u_32_t
name|is_optmsk
index|[
literal|2
index|]
decl_stmt|;
comment|/*    "      "    mask */
name|u_short
name|is_sec
decl_stmt|;
comment|/* security options set */
name|u_short
name|is_secmsk
decl_stmt|;
comment|/*    "        "    mask */
name|u_short
name|is_auth
decl_stmt|;
comment|/* authentication options set */
name|u_short
name|is_authmsk
decl_stmt|;
comment|/*    "              "    mask */
union|union
block|{
name|icmpinfo_t
name|is_ics
decl_stmt|;
name|tcpinfo4_t
name|is_ts
decl_stmt|;
name|udpinfo_t
name|is_us
decl_stmt|;
name|greinfo_t
name|is_ug
decl_stmt|;
block|}
name|is_ps
union|;
name|u_32_t
name|is_flags
decl_stmt|;
name|int
name|is_flx
index|[
literal|2
index|]
index|[
literal|2
index|]
decl_stmt|;
name|u_32_t
name|is_rulen
decl_stmt|;
comment|/* rule number when created */
name|u_32_t
name|is_s0
index|[
literal|2
index|]
decl_stmt|;
name|u_short
name|is_smsk
index|[
literal|2
index|]
decl_stmt|;
name|char
name|is_group
index|[
name|FR_GROUPLEN
index|]
decl_stmt|;
name|char
name|is_sbuf
index|[
literal|2
index|]
index|[
literal|16
index|]
decl_stmt|;
name|char
name|is_ifname
index|[
literal|4
index|]
index|[
name|LIFNAMSIZ
index|]
decl_stmt|;
block|}
name|ipstate_4_1_16_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|ipstate_4_1_0
block|{
name|ipfmutex_t
name|is_lock
decl_stmt|;
name|struct
name|ipstate
modifier|*
name|is_next
decl_stmt|;
name|struct
name|ipstate
modifier|*
modifier|*
name|is_pnext
decl_stmt|;
name|struct
name|ipstate
modifier|*
name|is_hnext
decl_stmt|;
name|struct
name|ipstate
modifier|*
modifier|*
name|is_phnext
decl_stmt|;
name|struct
name|ipstate
modifier|*
modifier|*
name|is_me
decl_stmt|;
name|void
modifier|*
name|is_ifp
index|[
literal|4
index|]
decl_stmt|;
name|void
modifier|*
name|is_sync
decl_stmt|;
name|void
modifier|*
name|is_nat
index|[
literal|2
index|]
decl_stmt|;
name|frentry_t
modifier|*
name|is_rule
decl_stmt|;
name|struct
name|ipftq
modifier|*
name|is_tqehead
index|[
literal|2
index|]
decl_stmt|;
name|struct
name|ipscan
modifier|*
name|is_isc
decl_stmt|;
name|U_QUAD_T
name|is_pkts
index|[
literal|4
index|]
decl_stmt|;
name|U_QUAD_T
name|is_bytes
index|[
literal|4
index|]
decl_stmt|;
name|U_QUAD_T
name|is_icmppkts
index|[
literal|4
index|]
decl_stmt|;
name|struct
name|ipftqent
name|is_sti
decl_stmt|;
name|u_int
name|is_frage
index|[
literal|2
index|]
decl_stmt|;
name|int
name|is_ref
decl_stmt|;
name|int
name|is_isninc
index|[
literal|2
index|]
decl_stmt|;
name|u_short
name|is_sumd
index|[
literal|2
index|]
decl_stmt|;
name|i6addr_t
name|is_src
decl_stmt|;
name|i6addr_t
name|is_dst
decl_stmt|;
name|u_int
name|is_pass
decl_stmt|;
name|u_char
name|is_p
decl_stmt|;
name|u_char
name|is_v
decl_stmt|;
name|u_32_t
name|is_hv
decl_stmt|;
name|u_32_t
name|is_tag
decl_stmt|;
name|u_32_t
name|is_opt
index|[
literal|2
index|]
decl_stmt|;
name|u_32_t
name|is_optmsk
index|[
literal|2
index|]
decl_stmt|;
name|u_short
name|is_sec
decl_stmt|;
name|u_short
name|is_secmsk
decl_stmt|;
name|u_short
name|is_auth
decl_stmt|;
name|u_short
name|is_authmsk
decl_stmt|;
union|union
block|{
name|icmpinfo_t
name|is_ics
decl_stmt|;
name|tcpinfo4_t
name|is_ts
decl_stmt|;
name|udpinfo_t
name|is_us
decl_stmt|;
name|greinfo_t
name|is_ug
decl_stmt|;
block|}
name|is_ps
union|;
name|u_32_t
name|is_flags
decl_stmt|;
name|int
name|is_flx
index|[
literal|2
index|]
index|[
literal|2
index|]
decl_stmt|;
name|u_32_t
name|is_rulen
decl_stmt|;
name|u_32_t
name|is_s0
index|[
literal|2
index|]
decl_stmt|;
name|u_short
name|is_smsk
index|[
literal|2
index|]
decl_stmt|;
name|char
name|is_group
index|[
name|FR_GROUPLEN
index|]
decl_stmt|;
name|char
name|is_sbuf
index|[
literal|2
index|]
index|[
literal|16
index|]
decl_stmt|;
name|char
name|is_ifname
index|[
literal|4
index|]
index|[
name|LIFNAMSIZ
index|]
decl_stmt|;
block|}
name|ipstate_4_1_0_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|ipstate_save_4_1_34
block|{
name|void
modifier|*
name|ips_next
decl_stmt|;
name|struct
name|ipstate_4_1_16
name|ips_is
decl_stmt|;
name|struct
name|frentry_4_1_34
name|ips_fr
decl_stmt|;
block|}
name|ipstate_save_4_1_34_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|ipstate_save_4_1_16
block|{
name|void
modifier|*
name|ips_next
decl_stmt|;
name|ipstate_4_1_0_t
name|ips_is
decl_stmt|;
name|frentry_4_1_16_t
name|ips_fr
decl_stmt|;
block|}
name|ipstate_save_4_1_16_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|ipstate_save_4_1_0
block|{
name|void
modifier|*
name|ips_next
decl_stmt|;
name|ipstate_4_1_0_t
name|ips_is
decl_stmt|;
name|frentry_4_1_0_t
name|ips_fr
decl_stmt|;
block|}
name|ipstate_save_4_1_0_t
typedef|;
end_typedef

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_comment
comment|/*  * 5.1.0  new release (current)  * 4.1.21 added iss_tcptab  */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|ips_stat_4_1_21
block|{
name|u_long
name|iss_hits
decl_stmt|;
name|u_long
name|iss_miss
decl_stmt|;
name|u_long
name|iss_max
decl_stmt|;
name|u_long
name|iss_maxref
decl_stmt|;
name|u_long
name|iss_tcp
decl_stmt|;
name|u_long
name|iss_udp
decl_stmt|;
name|u_long
name|iss_icmp
decl_stmt|;
name|u_long
name|iss_nomem
decl_stmt|;
name|u_long
name|iss_expire
decl_stmt|;
name|u_long
name|iss_fin
decl_stmt|;
name|u_long
name|iss_active
decl_stmt|;
name|u_long
name|iss_logged
decl_stmt|;
name|u_long
name|iss_logfail
decl_stmt|;
name|u_long
name|iss_inuse
decl_stmt|;
name|u_long
name|iss_wild
decl_stmt|;
name|u_long
name|iss_killed
decl_stmt|;
name|u_long
name|iss_ticks
decl_stmt|;
name|u_long
name|iss_bucketfull
decl_stmt|;
name|int
name|iss_statesize
decl_stmt|;
name|int
name|iss_statemax
decl_stmt|;
name|ipstate_t
modifier|*
modifier|*
name|iss_table
decl_stmt|;
name|ipstate_t
modifier|*
name|iss_list
decl_stmt|;
name|u_long
modifier|*
name|iss_bucketlen
decl_stmt|;
name|ipftq_t
modifier|*
name|iss_tcptab
decl_stmt|;
block|}
name|ips_stat_4_1_21_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|ips_stat_4_1_0
block|{
name|u_long
name|iss_hits
decl_stmt|;
name|u_long
name|iss_miss
decl_stmt|;
name|u_long
name|iss_max
decl_stmt|;
name|u_long
name|iss_maxref
decl_stmt|;
name|u_long
name|iss_tcp
decl_stmt|;
name|u_long
name|iss_udp
decl_stmt|;
name|u_long
name|iss_icmp
decl_stmt|;
name|u_long
name|iss_nomem
decl_stmt|;
name|u_long
name|iss_expire
decl_stmt|;
name|u_long
name|iss_fin
decl_stmt|;
name|u_long
name|iss_active
decl_stmt|;
name|u_long
name|iss_logged
decl_stmt|;
name|u_long
name|iss_logfail
decl_stmt|;
name|u_long
name|iss_inuse
decl_stmt|;
name|u_long
name|iss_wild
decl_stmt|;
name|u_long
name|iss_killed
decl_stmt|;
name|u_long
name|iss_ticks
decl_stmt|;
name|u_long
name|iss_bucketfull
decl_stmt|;
name|int
name|iss_statesize
decl_stmt|;
name|int
name|iss_statemax
decl_stmt|;
name|ipstate_t
modifier|*
modifier|*
name|iss_table
decl_stmt|;
name|ipstate_t
modifier|*
name|iss_list
decl_stmt|;
name|u_long
modifier|*
name|iss_bucketlen
decl_stmt|;
block|}
name|ips_stat_4_1_0_t
typedef|;
end_typedef

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|ipfrstat_4_1_1
block|{
name|u_long
name|ifs_exists
decl_stmt|;
comment|/* add& already exists */
name|u_long
name|ifs_nomem
decl_stmt|;
name|u_long
name|ifs_new
decl_stmt|;
name|u_long
name|ifs_hits
decl_stmt|;
name|u_long
name|ifs_expire
decl_stmt|;
name|u_long
name|ifs_inuse
decl_stmt|;
name|u_long
name|ifs_retrans0
decl_stmt|;
name|u_long
name|ifs_short
decl_stmt|;
name|struct
name|ipfr
modifier|*
modifier|*
name|ifs_table
decl_stmt|;
name|struct
name|ipfr
modifier|*
modifier|*
name|ifs_nattab
decl_stmt|;
block|}
name|ipfrstat_4_1_1_t
typedef|;
end_typedef

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_decl_stmt
specifier|static
name|int
name|ipf_addfrstr
name|__P
argument_list|(
operator|(
name|char
operator|*
operator|,
name|int
operator|,
name|char
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ipf_v4iptov5
name|__P
argument_list|(
operator|(
name|frip4_t
operator|*
operator|,
name|fr_ip_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ipf_v5iptov4
name|__P
argument_list|(
operator|(
name|fr_ip_t
operator|*
operator|,
name|frip4_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ipfv4tuctov5
name|__P
argument_list|(
operator|(
name|frtuc4_t
operator|*
operator|,
name|frtuc_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ipfv5tuctov4
name|__P
argument_list|(
operator|(
name|frtuc_t
operator|*
operator|,
name|frtuc4_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|ipf_v4fripftov5
name|__P
argument_list|(
operator|(
name|fripf4_t
operator|*
operator|,
name|char
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ipf_v5fripftov4
name|__P
argument_list|(
operator|(
name|fripf_t
operator|*
operator|,
name|fripf4_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|fr_frflags4to5
name|__P
argument_list|(
operator|(
name|u_32_t
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|fr_frflags5to4
name|__P
argument_list|(
operator|(
name|u_32_t
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|friostat_current_to_4_1_0
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|friostat_4_1_0_t
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|friostat_current_to_4_1_33
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|friostat_4_1_33_t
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ipstate_current_to_4_1_0
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|ipstate_4_1_0_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ipstate_current_to_4_1_16
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|ipstate_4_1_16_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ipnat_current_to_4_1_0
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|ipnat_4_1_0_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ipnat_current_to_4_1_14
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|ipnat_4_1_14_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|frauth_current_to_4_1_11
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|frauth_4_1_11_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|frauth_current_to_4_1_23
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|frauth_4_1_23_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|frauth_current_to_4_1_24
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|frauth_4_1_24_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|frauth_current_to_4_1_29
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|frauth_4_1_29_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|frentry_current_to_4_1_0
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|frentry_4_1_0_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|frentry_current_to_4_1_16
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|frentry_4_1_16_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|frentry_current_to_4_1_34
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|frentry_4_1_34_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|fr_info_current_to_4_1_11
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|fr_info_4_1_11_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|fr_info_current_to_4_1_23
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|fr_info_4_1_23_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|fr_info_current_to_4_1_24
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|fr_info_4_1_24_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|nat_save_current_to_4_1_3
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|nat_save_4_1_3_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|nat_save_current_to_4_1_14
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|nat_save_4_1_14_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|nat_save_current_to_4_1_16
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|nat_save_4_1_16_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ipstate_save_current_to_4_1_0
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|ipstate_save_4_1_0_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ipstate_save_current_to_4_1_16
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|ipstate_save_4_1_16_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ips_stat_current_to_4_1_0
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|ips_stat_4_1_0_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ips_stat_current_to_4_1_21
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|ips_stat_4_1_21_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|natstat_current_to_4_1_0
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|natstat_4_1_0_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|natstat_current_to_4_1_16
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|natstat_4_1_16_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|natstat_current_to_4_1_27
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|natstat_4_1_27_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|natstat_current_to_4_1_32
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|natstat_4_1_32_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|nat_current_to_4_1_3
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|nat_4_1_3_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|nat_current_to_4_1_14
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|nat_4_1_14_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|nat_current_to_4_1_25
name|__P
argument_list|(
operator|(
name|void
operator|*
operator|,
name|nat_4_1_25_t
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|friostat_4_1_0_to_current
name|__P
argument_list|(
operator|(
name|friostat_4_1_0_t
operator|*
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|friostat_4_1_33_to_current
name|__P
argument_list|(
operator|(
name|friostat_4_1_33_t
operator|*
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ipnat_4_1_0_to_current
name|__P
argument_list|(
operator|(
name|ipnat_4_1_0_t
operator|*
operator|,
name|void
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ipnat_4_1_14_to_current
name|__P
argument_list|(
operator|(
name|ipnat_4_1_14_t
operator|*
operator|,
name|void
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|frauth_4_1_11_to_current
name|__P
argument_list|(
operator|(
name|frauth_4_1_11_t
operator|*
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|frauth_4_1_23_to_current
name|__P
argument_list|(
operator|(
name|frauth_4_1_23_t
operator|*
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|frauth_4_1_24_to_current
name|__P
argument_list|(
operator|(
name|frauth_4_1_24_t
operator|*
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|frauth_4_1_29_to_current
name|__P
argument_list|(
operator|(
name|frauth_4_1_29_t
operator|*
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|frauth_4_1_32_to_current
name|__P
argument_list|(
operator|(
name|frauth_4_1_32_t
operator|*
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|frentry_4_1_0_to_current
name|__P
argument_list|(
operator|(
name|ipf_main_softc_t
operator|*
operator|,
name|frentry_4_1_0_t
operator|*
operator|,
name|void
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|frentry_4_1_16_to_current
name|__P
argument_list|(
operator|(
name|ipf_main_softc_t
operator|*
operator|,
name|frentry_4_1_16_t
operator|*
operator|,
name|void
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|frentry_4_1_34_to_current
name|__P
argument_list|(
operator|(
name|ipf_main_softc_t
operator|*
operator|,
name|frentry_4_1_34_t
operator|*
operator|,
name|void
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|fr_info_4_1_11_to_current
name|__P
argument_list|(
operator|(
name|fr_info_4_1_11_t
operator|*
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|fr_info_4_1_23_to_current
name|__P
argument_list|(
operator|(
name|fr_info_4_1_23_t
operator|*
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|fr_info_4_1_24_to_current
name|__P
argument_list|(
operator|(
name|fr_info_4_1_24_t
operator|*
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|fr_info_4_1_32_to_current
name|__P
argument_list|(
operator|(
name|fr_info_4_1_32_t
operator|*
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|nat_save_4_1_3_to_current
name|__P
argument_list|(
operator|(
name|ipf_main_softc_t
operator|*
operator|,
name|nat_save_4_1_3_t
operator|*
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|nat_save_4_1_14_to_current
name|__P
argument_list|(
operator|(
name|ipf_main_softc_t
operator|*
operator|,
name|nat_save_4_1_14_t
operator|*
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|nat_save_4_1_16_to_current
name|__P
argument_list|(
operator|(
name|ipf_main_softc_t
operator|*
operator|,
name|nat_save_4_1_16_t
operator|*
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_comment
comment|/* In this section is a series of short routines that deal with translating */
end_comment

begin_comment
comment|/* the smaller data structures used above as their internal changes make    */
end_comment

begin_comment
comment|/* them inappropriate for simple assignment.                                */
end_comment

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_function
specifier|static
name|int
name|ipf_addfrstr
parameter_list|(
name|char
modifier|*
name|names
parameter_list|,
name|int
name|namelen
parameter_list|,
name|char
modifier|*
name|str
parameter_list|,
name|int
name|maxlen
parameter_list|)
block|{
name|char
modifier|*
name|t
decl_stmt|;
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
name|maxlen
operator|,
name|t
operator|=
name|str
init|;
operator|(
operator|*
name|t
operator|!=
literal|'\0'
operator|)
operator|&&
operator|(
name|i
operator|>
literal|0
operator|)
condition|;
name|i
operator|--
control|)
block|{
name|names
index|[
name|namelen
operator|++
index|]
operator|=
operator|*
name|t
operator|++
expr_stmt|;
block|}
name|names
index|[
name|namelen
operator|++
index|]
operator|=
literal|'\0'
expr_stmt|;
return|return
name|namelen
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|ipf_v4iptov5
parameter_list|(
name|v4
parameter_list|,
name|v5
parameter_list|)
name|frip4_t
modifier|*
name|v4
decl_stmt|;
name|fr_ip_t
modifier|*
name|v5
decl_stmt|;
block|{
name|v5
operator|->
name|fi_v
operator|=
name|v4
operator|->
name|fi_v
expr_stmt|;
name|v5
operator|->
name|fi_p
operator|=
name|v4
operator|->
name|fi_p
expr_stmt|;
name|v5
operator|->
name|fi_xx
operator|=
name|v4
operator|->
name|fi_xx
expr_stmt|;
name|v5
operator|->
name|fi_tos
operator|=
name|v4
operator|->
name|fi_tos
expr_stmt|;
name|v5
operator|->
name|fi_ttl
operator|=
name|v4
operator|->
name|fi_ttl
expr_stmt|;
name|v5
operator|->
name|fi_p
operator|=
name|v4
operator|->
name|fi_p
expr_stmt|;
name|v5
operator|->
name|fi_optmsk
operator|=
name|v4
operator|->
name|fi_optmsk
expr_stmt|;
name|v5
operator|->
name|fi_src
operator|=
name|v4
operator|->
name|fi_src
expr_stmt|;
name|v5
operator|->
name|fi_dst
operator|=
name|v4
operator|->
name|fi_dst
expr_stmt|;
name|v5
operator|->
name|fi_secmsk
operator|=
name|v4
operator|->
name|ofi_secmsk
expr_stmt|;
name|v5
operator|->
name|fi_auth
operator|=
name|v4
operator|->
name|ofi_auth
expr_stmt|;
name|v5
operator|->
name|fi_flx
operator|=
name|v4
operator|->
name|fi_flx
expr_stmt|;
name|v5
operator|->
name|fi_tcpmsk
operator|=
name|v4
operator|->
name|fi_tcpmsk
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|ipf_v5iptov4
parameter_list|(
name|v5
parameter_list|,
name|v4
parameter_list|)
name|fr_ip_t
modifier|*
name|v5
decl_stmt|;
name|frip4_t
modifier|*
name|v4
decl_stmt|;
block|{
name|v4
operator|->
name|fi_v
operator|=
name|v5
operator|->
name|fi_v
expr_stmt|;
name|v4
operator|->
name|fi_p
operator|=
name|v5
operator|->
name|fi_p
expr_stmt|;
name|v4
operator|->
name|fi_xx
operator|=
name|v5
operator|->
name|fi_xx
expr_stmt|;
name|v4
operator|->
name|fi_tos
operator|=
name|v5
operator|->
name|fi_tos
expr_stmt|;
name|v4
operator|->
name|fi_ttl
operator|=
name|v5
operator|->
name|fi_ttl
expr_stmt|;
name|v4
operator|->
name|fi_p
operator|=
name|v5
operator|->
name|fi_p
expr_stmt|;
name|v4
operator|->
name|fi_optmsk
operator|=
name|v5
operator|->
name|fi_optmsk
expr_stmt|;
name|v4
operator|->
name|fi_src
operator|=
name|v5
operator|->
name|fi_src
expr_stmt|;
name|v4
operator|->
name|fi_dst
operator|=
name|v5
operator|->
name|fi_dst
expr_stmt|;
name|v4
operator|->
name|ofi_secmsk
operator|=
name|v5
operator|->
name|fi_secmsk
expr_stmt|;
name|v4
operator|->
name|ofi_auth
operator|=
name|v5
operator|->
name|fi_auth
expr_stmt|;
name|v4
operator|->
name|fi_flx
operator|=
name|v5
operator|->
name|fi_flx
expr_stmt|;
name|v4
operator|->
name|fi_tcpmsk
operator|=
name|v5
operator|->
name|fi_tcpmsk
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|ipfv4tuctov5
parameter_list|(
name|v4
parameter_list|,
name|v5
parameter_list|)
name|frtuc4_t
modifier|*
name|v4
decl_stmt|;
name|frtuc_t
modifier|*
name|v5
decl_stmt|;
block|{
name|v5
operator|->
name|ftu_src
operator|.
name|frp_cmp
operator|=
name|v4
operator|->
name|ftu_src
operator|.
name|frp_cmp
expr_stmt|;
name|v5
operator|->
name|ftu_src
operator|.
name|frp_port
operator|=
name|v4
operator|->
name|ftu_src
operator|.
name|frp_port
expr_stmt|;
name|v5
operator|->
name|ftu_src
operator|.
name|frp_top
operator|=
name|v4
operator|->
name|ftu_src
operator|.
name|frp_top
expr_stmt|;
name|v5
operator|->
name|ftu_dst
operator|.
name|frp_cmp
operator|=
name|v4
operator|->
name|ftu_dst
operator|.
name|frp_cmp
expr_stmt|;
name|v5
operator|->
name|ftu_dst
operator|.
name|frp_port
operator|=
name|v4
operator|->
name|ftu_dst
operator|.
name|frp_port
expr_stmt|;
name|v5
operator|->
name|ftu_dst
operator|.
name|frp_top
operator|=
name|v4
operator|->
name|ftu_dst
operator|.
name|frp_top
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|ipfv5tuctov4
parameter_list|(
name|v5
parameter_list|,
name|v4
parameter_list|)
name|frtuc_t
modifier|*
name|v5
decl_stmt|;
name|frtuc4_t
modifier|*
name|v4
decl_stmt|;
block|{
name|v4
operator|->
name|ftu_src
operator|.
name|frp_cmp
operator|=
name|v5
operator|->
name|ftu_src
operator|.
name|frp_cmp
expr_stmt|;
name|v4
operator|->
name|ftu_src
operator|.
name|frp_port
operator|=
name|v5
operator|->
name|ftu_src
operator|.
name|frp_port
expr_stmt|;
name|v4
operator|->
name|ftu_src
operator|.
name|frp_top
operator|=
name|v5
operator|->
name|ftu_src
operator|.
name|frp_top
expr_stmt|;
name|v4
operator|->
name|ftu_dst
operator|.
name|frp_cmp
operator|=
name|v5
operator|->
name|ftu_dst
operator|.
name|frp_cmp
expr_stmt|;
name|v4
operator|->
name|ftu_dst
operator|.
name|frp_port
operator|=
name|v5
operator|->
name|ftu_dst
operator|.
name|frp_port
expr_stmt|;
name|v4
operator|->
name|ftu_dst
operator|.
name|frp_top
operator|=
name|v5
operator|->
name|ftu_dst
operator|.
name|frp_top
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|int
name|ipf_v4fripftov5
parameter_list|(
name|frp4
parameter_list|,
name|dst
parameter_list|)
name|fripf4_t
modifier|*
name|frp4
decl_stmt|;
name|char
modifier|*
name|dst
decl_stmt|;
block|{
name|fripf_t
modifier|*
name|frp
decl_stmt|;
name|frp
operator|=
operator|(
name|fripf_t
operator|*
operator|)
name|dst
expr_stmt|;
name|ipf_v4iptov5
argument_list|(
operator|&
name|frp4
operator|->
name|fri_ip
argument_list|,
operator|&
name|frp
operator|->
name|fri_ip
argument_list|)
expr_stmt|;
name|ipf_v4iptov5
argument_list|(
operator|&
name|frp4
operator|->
name|fri_mip
argument_list|,
operator|&
name|frp
operator|->
name|fri_mip
argument_list|)
expr_stmt|;
name|frp
operator|->
name|fri_icmpm
operator|=
name|frp4
operator|->
name|fri_icmpm
expr_stmt|;
name|frp
operator|->
name|fri_icmp
operator|=
name|frp4
operator|->
name|fri_icmp
expr_stmt|;
name|frp
operator|->
name|fri_tuc
operator|.
name|ftu_tcpfm
operator|=
name|frp4
operator|->
name|fri_tuc
operator|.
name|ftu_tcpfm
expr_stmt|;
name|frp
operator|->
name|fri_tuc
operator|.
name|ftu_tcpf
operator|=
name|frp4
operator|->
name|fri_tuc
operator|.
name|ftu_tcpf
expr_stmt|;
name|ipfv4tuctov5
argument_list|(
operator|&
name|frp4
operator|->
name|fri_tuc
argument_list|,
operator|&
name|frp
operator|->
name|fri_tuc
argument_list|)
expr_stmt|;
name|frp
operator|->
name|fri_satype
operator|=
name|frp4
operator|->
name|fri_satype
expr_stmt|;
name|frp
operator|->
name|fri_datype
operator|=
name|frp4
operator|->
name|fri_datype
expr_stmt|;
name|frp
operator|->
name|fri_sifpidx
operator|=
name|frp4
operator|->
name|fri_sifpidx
expr_stmt|;
name|frp
operator|->
name|fri_difpidx
operator|=
name|frp4
operator|->
name|fri_difpidx
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|ipf_v5fripftov4
parameter_list|(
name|frp
parameter_list|,
name|frp4
parameter_list|)
name|fripf_t
modifier|*
name|frp
decl_stmt|;
name|fripf4_t
modifier|*
name|frp4
decl_stmt|;
block|{
name|ipf_v5iptov4
argument_list|(
operator|&
name|frp
operator|->
name|fri_ip
argument_list|,
operator|&
name|frp4
operator|->
name|fri_ip
argument_list|)
expr_stmt|;
name|ipf_v5iptov4
argument_list|(
operator|&
name|frp
operator|->
name|fri_mip
argument_list|,
operator|&
name|frp4
operator|->
name|fri_mip
argument_list|)
expr_stmt|;
name|frp4
operator|->
name|fri_icmpm
operator|=
name|frp
operator|->
name|fri_icmpm
expr_stmt|;
name|frp4
operator|->
name|fri_icmp
operator|=
name|frp
operator|->
name|fri_icmp
expr_stmt|;
name|frp4
operator|->
name|fri_tuc
operator|.
name|ftu_tcpfm
operator|=
name|frp
operator|->
name|fri_tuc
operator|.
name|ftu_tcpfm
expr_stmt|;
name|frp4
operator|->
name|fri_tuc
operator|.
name|ftu_tcpf
operator|=
name|frp
operator|->
name|fri_tuc
operator|.
name|ftu_tcpf
expr_stmt|;
name|ipfv5tuctov4
argument_list|(
operator|&
name|frp
operator|->
name|fri_tuc
argument_list|,
operator|&
name|frp4
operator|->
name|fri_tuc
argument_list|)
expr_stmt|;
name|frp4
operator|->
name|fri_satype
operator|=
name|frp
operator|->
name|fri_satype
expr_stmt|;
name|frp4
operator|->
name|fri_datype
operator|=
name|frp
operator|->
name|fri_datype
expr_stmt|;
name|frp4
operator|->
name|fri_sifpidx
operator|=
name|frp
operator|->
name|fri_sifpidx
expr_stmt|;
name|frp4
operator|->
name|fri_difpidx
operator|=
name|frp
operator|->
name|fri_difpidx
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_comment
comment|/* ipf_in_compat is the first of two service routines. It is responsible for*/
end_comment

begin_comment
comment|/* converting data structures from user space into what's required by the   */
end_comment

begin_comment
comment|/* kernel module.                                                           */
end_comment

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_function
name|int
name|ipf_in_compat
parameter_list|(
name|softc
parameter_list|,
name|obj
parameter_list|,
name|ptr
parameter_list|,
name|size
parameter_list|)
name|ipf_main_softc_t
modifier|*
name|softc
decl_stmt|;
name|ipfobj_t
modifier|*
name|obj
decl_stmt|;
name|void
modifier|*
name|ptr
decl_stmt|;
name|int
name|size
decl_stmt|;
block|{
name|int
name|error
decl_stmt|;
name|int
name|sz
decl_stmt|;
name|IPFERROR
argument_list|(
literal|140000
argument_list|)
expr_stmt|;
name|error
operator|=
name|EINVAL
expr_stmt|;
switch|switch
condition|(
name|obj
operator|->
name|ipfo_type
condition|)
block|{
default|default :
break|break;
case|case
name|IPFOBJ_FRENTRY
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4013400
condition|)
block|{
name|frentry_4_1_34_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|frentry_4_1_34_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140001
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|old
operator|->
name|fr_type
operator|!=
name|FR_T_NONE
operator|&&
name|old
operator|->
name|fr_type
operator|!=
name|FR_T_IPF
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140002
argument_list|)
expr_stmt|;
name|error
operator|=
name|EINVAL
expr_stmt|;
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
break|break;
block|}
name|frentry_4_1_34_to_current
argument_list|(
name|softc
argument_list|,
name|old
argument_list|,
name|ptr
argument_list|,
name|size
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|IPFERROR
argument_list|(
literal|140003
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4011600
condition|)
block|{
name|frentry_4_1_16_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|frentry_4_1_16_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140004
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|old
operator|->
name|fr_type
operator|!=
name|FR_T_NONE
operator|&&
name|old
operator|->
name|fr_type
operator|!=
name|FR_T_IPF
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140005
argument_list|)
expr_stmt|;
name|error
operator|=
name|EINVAL
expr_stmt|;
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
break|break;
block|}
name|frentry_4_1_16_to_current
argument_list|(
name|softc
argument_list|,
name|old
argument_list|,
name|ptr
argument_list|,
name|size
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|IPFERROR
argument_list|(
literal|140006
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|frentry_4_1_0_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|frentry_4_1_0_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140007
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|old
operator|->
name|fr_type
operator|!=
name|FR_T_NONE
operator|&&
name|old
operator|->
name|fr_type
operator|!=
name|FR_T_IPF
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140008
argument_list|)
expr_stmt|;
name|error
operator|=
name|EINVAL
expr_stmt|;
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
break|break;
block|}
name|frentry_4_1_0_to_current
argument_list|(
name|softc
argument_list|,
name|old
argument_list|,
name|ptr
argument_list|,
name|size
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|IPFERROR
argument_list|(
literal|140009
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|IPFOBJ_IPFSTAT
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4013300
condition|)
block|{
name|friostat_4_1_33_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|friostat_4_1_33_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140010
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|friostat_4_1_33_to_current
argument_list|(
name|old
argument_list|,
name|ptr
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|IPFERROR
argument_list|(
literal|140011
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
name|friostat_4_1_0_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|friostat_4_1_0_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140012
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|friostat_4_1_0_to_current
argument_list|(
name|old
argument_list|,
name|ptr
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|IPFERROR
argument_list|(
literal|140013
argument_list|)
expr_stmt|;
block|}
block|}
break|break;
case|case
name|IPFOBJ_IPFINFO
case|:
comment|/* unused */
break|break;
case|case
name|IPFOBJ_IPNAT
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4011400
condition|)
block|{
name|ipnat_4_1_14_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|ipnat_4_1_14_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140014
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|ipnat_4_1_14_to_current
argument_list|(
name|old
argument_list|,
name|ptr
argument_list|,
name|size
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|IPFERROR
argument_list|(
literal|140015
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|ipnat_4_1_0_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|ipnat_4_1_0_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140016
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|ipnat_4_1_0_to_current
argument_list|(
name|old
argument_list|,
name|ptr
argument_list|,
name|size
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|IPFERROR
argument_list|(
literal|140017
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|IPFOBJ_NATSTAT
case|:
comment|/* 		 * Statistics are not copied in. 		 */
break|break;
case|case
name|IPFOBJ_NATSAVE
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4011600
condition|)
block|{
name|nat_save_4_1_16_t
modifier|*
name|old16
decl_stmt|;
name|KMALLOC
argument_list|(
name|old16
argument_list|,
name|nat_save_4_1_16_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old16
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140018
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old16
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old16
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|nat_save_4_1_16_to_current
argument_list|(
name|softc
argument_list|,
name|old16
argument_list|,
name|ptr
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|IPFERROR
argument_list|(
literal|140019
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old16
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4011400
condition|)
block|{
name|nat_save_4_1_14_t
modifier|*
name|old14
decl_stmt|;
name|KMALLOC
argument_list|(
name|old14
argument_list|,
name|nat_save_4_1_14_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old14
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140020
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old14
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old14
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|nat_save_4_1_14_to_current
argument_list|(
name|softc
argument_list|,
name|old14
argument_list|,
name|ptr
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|IPFERROR
argument_list|(
literal|140021
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old14
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4010300
condition|)
block|{
name|nat_save_4_1_3_t
modifier|*
name|old3
decl_stmt|;
name|KMALLOC
argument_list|(
name|old3
argument_list|,
name|nat_save_4_1_3_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old3
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140022
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old3
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old3
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|nat_save_4_1_3_to_current
argument_list|(
name|softc
argument_list|,
name|old3
argument_list|,
name|ptr
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|IPFERROR
argument_list|(
literal|140023
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old3
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|IPFOBJ_STATESAVE
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4013400
condition|)
block|{
name|ipstate_save_4_1_34_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|ipstate_save_4_1_34_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140024
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140025
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4011600
condition|)
block|{
name|ipstate_save_4_1_16_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|ipstate_save_4_1_16_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140026
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140027
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|ipstate_save_4_1_0_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|ipstate_save_4_1_0_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140028
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140029
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|IPFOBJ_IPSTATE
case|:
comment|/* 		 * This structure is not copied in by itself. 		 */
break|break;
case|case
name|IPFOBJ_STATESTAT
case|:
comment|/* 		 * Statistics are not copied in. 		 */
break|break;
case|case
name|IPFOBJ_FRAUTH
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4013200
condition|)
block|{
name|frauth_4_1_32_t
modifier|*
name|old32
decl_stmt|;
name|KMALLOC
argument_list|(
name|old32
argument_list|,
name|frauth_4_1_32_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old32
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140030
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old32
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old32
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|frauth_4_1_32_to_current
argument_list|(
name|old32
argument_list|,
name|ptr
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|IPFERROR
argument_list|(
literal|140031
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old32
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4012900
condition|)
block|{
name|frauth_4_1_29_t
modifier|*
name|old29
decl_stmt|;
name|KMALLOC
argument_list|(
name|old29
argument_list|,
name|frauth_4_1_29_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old29
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140032
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old29
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old29
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|frauth_4_1_29_to_current
argument_list|(
name|old29
argument_list|,
name|ptr
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|IPFERROR
argument_list|(
literal|140033
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old29
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4012400
condition|)
block|{
name|frauth_4_1_24_t
modifier|*
name|old24
decl_stmt|;
name|KMALLOC
argument_list|(
name|old24
argument_list|,
name|frauth_4_1_24_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old24
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140034
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old24
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old24
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|frauth_4_1_24_to_current
argument_list|(
name|old24
argument_list|,
name|ptr
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|IPFERROR
argument_list|(
literal|140035
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old24
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4012300
condition|)
block|{
name|frauth_4_1_23_t
modifier|*
name|old23
decl_stmt|;
name|KMALLOC
argument_list|(
name|old23
argument_list|,
name|frauth_4_1_23_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old23
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140036
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old23
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old23
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
name|frauth_4_1_23_to_current
argument_list|(
name|old23
argument_list|,
name|ptr
argument_list|)
expr_stmt|;
name|KFREE
argument_list|(
name|old23
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4011100
condition|)
block|{
name|frauth_4_1_11_t
modifier|*
name|old11
decl_stmt|;
name|KMALLOC
argument_list|(
name|old11
argument_list|,
name|frauth_4_1_11_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old11
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140037
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old11
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old11
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|frauth_4_1_11_to_current
argument_list|(
name|old11
argument_list|,
name|ptr
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|IPFERROR
argument_list|(
literal|140038
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old11
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|IPFOBJ_NAT
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4011400
condition|)
block|{
name|sz
operator|=
sizeof|sizeof
argument_list|(
name|nat_4_1_14_t
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4010300
condition|)
block|{
name|sz
operator|=
sizeof|sizeof
argument_list|(
name|nat_4_1_3_t
argument_list|)
expr_stmt|;
block|}
else|else
block|{
break|break;
block|}
name|bzero
argument_list|(
name|ptr
argument_list|,
sizeof|sizeof
argument_list|(
name|nat_t
argument_list|)
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|ptr
argument_list|,
name|sz
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140039
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|IPFOBJ_FRIPF
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|<
literal|5000000
condition|)
block|{
name|fripf4_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|fripf4_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140040
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|error
operator|=
name|COPYIN
argument_list|(
name|obj
operator|->
name|ipfo_ptr
argument_list|,
name|old
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|ipf_v4fripftov5
argument_list|(
name|old
argument_list|,
name|ptr
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|IPFERROR
argument_list|(
literal|140041
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
break|break;
block|}
return|return
name|error
return|;
block|}
end_function

begin_comment
comment|/* ------------------------------------------------------------------------ */
end_comment

begin_comment
comment|/*  * flags is v4 flags, returns v5 flags.  */
end_comment

begin_function
specifier|static
name|int
name|fr_frflags4to5
parameter_list|(
name|flags
parameter_list|)
name|u_32_t
name|flags
decl_stmt|;
block|{
name|u_32_t
name|nflags
init|=
literal|0
decl_stmt|;
switch|switch
condition|(
name|flags
operator|&
literal|0xf
condition|)
block|{
case|case
literal|0x0
case|:
name|nflags
operator||=
name|FR_CALL
expr_stmt|;
break|break;
case|case
literal|0x1
case|:
name|nflags
operator||=
name|FR_BLOCK
expr_stmt|;
break|break;
case|case
literal|0x2
case|:
name|nflags
operator||=
name|FR_PASS
expr_stmt|;
break|break;
case|case
literal|0x3
case|:
name|nflags
operator||=
name|FR_AUTH
expr_stmt|;
break|break;
case|case
literal|0x4
case|:
name|nflags
operator||=
name|FR_PREAUTH
expr_stmt|;
break|break;
case|case
literal|0x5
case|:
name|nflags
operator||=
name|FR_ACCOUNT
expr_stmt|;
break|break;
case|case
literal|0x6
case|:
name|nflags
operator||=
name|FR_SKIP
expr_stmt|;
break|break;
default|default :
break|break;
block|}
if|if
condition|(
name|flags
operator|&
literal|0x00010
condition|)
name|nflags
operator||=
name|FR_LOG
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x00020
condition|)
name|nflags
operator||=
name|FR_CALLNOW
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x00080
condition|)
name|nflags
operator||=
name|FR_NOTSRCIP
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x00040
condition|)
name|nflags
operator||=
name|FR_NOTDSTIP
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x00100
condition|)
name|nflags
operator||=
name|FR_QUICK
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x00200
condition|)
name|nflags
operator||=
name|FR_KEEPFRAG
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x00400
condition|)
name|nflags
operator||=
name|FR_KEEPSTATE
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x00800
condition|)
name|nflags
operator||=
name|FR_FASTROUTE
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x01000
condition|)
name|nflags
operator||=
name|FR_RETRST
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x02000
condition|)
name|nflags
operator||=
name|FR_RETICMP
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x03000
condition|)
name|nflags
operator||=
name|FR_FAKEICMP
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x04000
condition|)
name|nflags
operator||=
name|FR_OUTQUE
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x08000
condition|)
name|nflags
operator||=
name|FR_INQUE
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x10000
condition|)
name|nflags
operator||=
name|FR_LOGBODY
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x20000
condition|)
name|nflags
operator||=
name|FR_LOGFIRST
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x40000
condition|)
name|nflags
operator||=
name|FR_LOGORBLOCK
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x100000
condition|)
name|nflags
operator||=
name|FR_FRSTRICT
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x200000
condition|)
name|nflags
operator||=
name|FR_STSTRICT
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x400000
condition|)
name|nflags
operator||=
name|FR_NEWISN
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x800000
condition|)
name|nflags
operator||=
name|FR_NOICMPERR
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x1000000
condition|)
name|nflags
operator||=
name|FR_STATESYNC
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x8000000
condition|)
name|nflags
operator||=
name|FR_NOMATCH
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x40000000
condition|)
name|nflags
operator||=
name|FR_COPIED
expr_stmt|;
if|if
condition|(
name|flags
operator|&
literal|0x80000000
condition|)
name|nflags
operator||=
name|FR_INACTIVE
expr_stmt|;
return|return
name|nflags
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|frentry_4_1_34_to_current
parameter_list|(
name|softc
parameter_list|,
name|old
parameter_list|,
name|current
parameter_list|,
name|size
parameter_list|)
name|ipf_main_softc_t
modifier|*
name|softc
decl_stmt|;
name|frentry_4_1_34_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
name|int
name|size
decl_stmt|;
block|{
name|frentry_t
modifier|*
name|fr
init|=
operator|(
name|frentry_t
operator|*
operator|)
name|current
decl_stmt|;
name|fr
operator|->
name|fr_comment
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_ref
operator|=
name|old
operator|->
name|fr_ref
expr_stmt|;
name|fr
operator|->
name|fr_statecnt
operator|=
name|old
operator|->
name|fr_statecnt
expr_stmt|;
name|fr
operator|->
name|fr_hits
operator|=
name|old
operator|->
name|fr_hits
expr_stmt|;
name|fr
operator|->
name|fr_bytes
operator|=
name|old
operator|->
name|fr_bytes
expr_stmt|;
name|fr
operator|->
name|fr_lastpkt
operator|.
name|tv_sec
operator|=
name|old
operator|->
name|fr_lastpkt
operator|.
name|tv_sec
expr_stmt|;
name|fr
operator|->
name|fr_lastpkt
operator|.
name|tv_usec
operator|=
name|old
operator|->
name|fr_lastpkt
operator|.
name|tv_usec
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|fr_dun
argument_list|,
operator|&
name|fr
operator|->
name|fr_dun
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|fr_dun
argument_list|)
argument_list|)
expr_stmt|;
name|fr
operator|->
name|fr_func
operator|=
name|old
operator|->
name|fr_func
expr_stmt|;
name|fr
operator|->
name|fr_dsize
operator|=
name|old
operator|->
name|fr_dsize
expr_stmt|;
name|fr
operator|->
name|fr_pps
operator|=
name|old
operator|->
name|fr_pps
expr_stmt|;
name|fr
operator|->
name|fr_statemax
operator|=
name|old
operator|->
name|fr_statemax
expr_stmt|;
name|fr
operator|->
name|fr_flineno
operator|=
name|old
operator|->
name|fr_flineno
expr_stmt|;
name|fr
operator|->
name|fr_type
operator|=
name|old
operator|->
name|fr_type
expr_stmt|;
name|fr
operator|->
name|fr_flags
operator|=
name|fr_frflags4to5
argument_list|(
name|old
operator|->
name|fr_flags
argument_list|)
expr_stmt|;
name|fr
operator|->
name|fr_logtag
operator|=
name|old
operator|->
name|fr_logtag
expr_stmt|;
name|fr
operator|->
name|fr_collect
operator|=
name|old
operator|->
name|fr_collect
expr_stmt|;
name|fr
operator|->
name|fr_arg
operator|=
name|old
operator|->
name|fr_arg
expr_stmt|;
name|fr
operator|->
name|fr_loglevel
operator|=
name|old
operator|->
name|fr_loglevel
expr_stmt|;
name|fr
operator|->
name|fr_age
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|fr_age
index|[
literal|0
index|]
expr_stmt|;
name|fr
operator|->
name|fr_age
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|fr_age
index|[
literal|1
index|]
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ip6
operator|=
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|ofd_ip6
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_type
operator|=
name|FRD_NORMAL
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_ip6
operator|=
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|ofd_ip6
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_type
operator|=
name|FRD_NORMAL
expr_stmt|;
name|fr
operator|->
name|fr_dif
operator|.
name|fd_ip6
operator|=
name|old
operator|->
name|fr_dif
operator|.
name|ofd_ip6
expr_stmt|;
name|fr
operator|->
name|fr_dif
operator|.
name|fd_type
operator|=
name|FRD_NORMAL
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|fr_v
operator|==
literal|4
condition|)
name|fr
operator|->
name|fr_family
operator|=
name|AF_INET
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|fr_v
operator|==
literal|6
condition|)
name|fr
operator|->
name|fr_family
operator|=
name|AF_INET6
expr_stmt|;
name|fr
operator|->
name|fr_icode
operator|=
name|old
operator|->
name|fr_icode
expr_stmt|;
name|fr
operator|->
name|fr_cksum
operator|=
name|old
operator|->
name|fr_cksum
expr_stmt|;
name|fr
operator|->
name|fr_namelen
operator|=
literal|0
expr_stmt|;
name|fr
operator|->
name|fr_ifnames
index|[
literal|0
index|]
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_ifnames
index|[
literal|1
index|]
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_ifnames
index|[
literal|2
index|]
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_ifnames
index|[
literal|3
index|]
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_dif
operator|.
name|fd_name
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_name
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_name
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_group
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_grhead
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_icmphead
operator|=
operator|-
literal|1
expr_stmt|;
if|if
condition|(
name|size
operator|==
literal|0
condition|)
block|{
name|fr
operator|->
name|fr_size
operator|=
sizeof|sizeof
argument_list|(
operator|*
name|fr
argument_list|)
operator|+
name|LIFNAMSIZ
operator|*
literal|7
operator|+
name|FR_GROUPLEN
operator|*
literal|2
expr_stmt|;
name|fr
operator|->
name|fr_size
operator|+=
sizeof|sizeof
argument_list|(
name|fripf_t
argument_list|)
operator|+
literal|16
expr_stmt|;
name|fr
operator|->
name|fr_size
operator|+=
literal|9
expr_stmt|;
comment|/* room for \0's */
block|}
else|else
block|{
name|char
modifier|*
name|names
init|=
name|fr
operator|->
name|fr_names
decl_stmt|;
name|int
name|nlen
init|=
name|fr
operator|->
name|fr_namelen
decl_stmt|;
name|fr
operator|->
name|fr_size
operator|=
name|size
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|fr_ifnames
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_ifnames
index|[
literal|0
index|]
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_ifnames
index|[
literal|0
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_ifnames
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_ifnames
index|[
literal|1
index|]
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_ifnames
index|[
literal|1
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_ifnames
index|[
literal|2
index|]
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_ifnames
index|[
literal|2
index|]
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_ifnames
index|[
literal|2
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_ifnames
index|[
literal|3
index|]
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_ifnames
index|[
literal|3
index|]
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_ifnames
index|[
literal|3
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ifname
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_name
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ifname
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_ifname
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_name
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_ifname
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_dif
operator|.
name|fd_ifname
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_dif
operator|.
name|fd_name
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_dif
operator|.
name|fd_ifname
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_group
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_group
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_group
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_grhead
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_grhead
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_grhead
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
name|fr
operator|->
name|fr_namelen
operator|=
name|nlen
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|fr_type
operator|==
name|FR_T_IPF
condition|)
block|{
name|int
name|offset
init|=
name|fr
operator|->
name|fr_namelen
decl_stmt|;
name|ipfobj_t
name|obj
decl_stmt|;
name|int
name|error
decl_stmt|;
name|obj
operator|.
name|ipfo_type
operator|=
name|IPFOBJ_FRIPF
expr_stmt|;
name|obj
operator|.
name|ipfo_rev
operator|=
literal|4010100
expr_stmt|;
name|obj
operator|.
name|ipfo_ptr
operator|=
name|old
operator|->
name|fr_data
expr_stmt|;
if|if
condition|(
operator|(
name|offset
operator|&
literal|7
operator|)
operator|!=
literal|0
condition|)
name|offset
operator|+=
literal|8
operator|-
operator|(
name|offset
operator|&
literal|7
operator|)
expr_stmt|;
name|error
operator|=
name|ipf_in_compat
argument_list|(
name|softc
argument_list|,
operator|&
name|obj
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|offset
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|fr
operator|->
name|fr_data
operator|=
name|fr
operator|->
name|fr_names
operator|+
name|offset
expr_stmt|;
name|fr
operator|->
name|fr_dsize
operator|=
sizeof|sizeof
argument_list|(
name|fripf_t
argument_list|)
expr_stmt|;
block|}
block|}
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|frentry_4_1_16_to_current
parameter_list|(
name|softc
parameter_list|,
name|old
parameter_list|,
name|current
parameter_list|,
name|size
parameter_list|)
name|ipf_main_softc_t
modifier|*
name|softc
decl_stmt|;
name|frentry_4_1_16_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
name|int
name|size
decl_stmt|;
block|{
name|frentry_t
modifier|*
name|fr
init|=
operator|(
name|frentry_t
operator|*
operator|)
name|current
decl_stmt|;
name|fr
operator|->
name|fr_comment
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_ref
operator|=
name|old
operator|->
name|fr_ref
expr_stmt|;
name|fr
operator|->
name|fr_statecnt
operator|=
name|old
operator|->
name|fr_statecnt
expr_stmt|;
name|fr
operator|->
name|fr_hits
operator|=
name|old
operator|->
name|fr_hits
expr_stmt|;
name|fr
operator|->
name|fr_bytes
operator|=
name|old
operator|->
name|fr_bytes
expr_stmt|;
name|fr
operator|->
name|fr_lastpkt
operator|.
name|tv_sec
operator|=
name|old
operator|->
name|fr_lastpkt
operator|.
name|tv_sec
expr_stmt|;
name|fr
operator|->
name|fr_lastpkt
operator|.
name|tv_usec
operator|=
name|old
operator|->
name|fr_lastpkt
operator|.
name|tv_usec
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|fr_dun
argument_list|,
operator|&
name|fr
operator|->
name|fr_dun
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|fr_dun
argument_list|)
argument_list|)
expr_stmt|;
name|fr
operator|->
name|fr_func
operator|=
name|old
operator|->
name|fr_func
expr_stmt|;
name|fr
operator|->
name|fr_dsize
operator|=
name|old
operator|->
name|fr_dsize
expr_stmt|;
name|fr
operator|->
name|fr_pps
operator|=
name|old
operator|->
name|fr_pps
expr_stmt|;
name|fr
operator|->
name|fr_statemax
operator|=
name|old
operator|->
name|fr_statemax
expr_stmt|;
name|fr
operator|->
name|fr_flineno
operator|=
name|old
operator|->
name|fr_flineno
expr_stmt|;
name|fr
operator|->
name|fr_type
operator|=
name|old
operator|->
name|fr_type
expr_stmt|;
name|fr
operator|->
name|fr_flags
operator|=
name|fr_frflags4to5
argument_list|(
name|old
operator|->
name|fr_flags
argument_list|)
expr_stmt|;
name|fr
operator|->
name|fr_logtag
operator|=
name|old
operator|->
name|fr_logtag
expr_stmt|;
name|fr
operator|->
name|fr_collect
operator|=
name|old
operator|->
name|fr_collect
expr_stmt|;
name|fr
operator|->
name|fr_arg
operator|=
name|old
operator|->
name|fr_arg
expr_stmt|;
name|fr
operator|->
name|fr_loglevel
operator|=
name|old
operator|->
name|fr_loglevel
expr_stmt|;
name|fr
operator|->
name|fr_age
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|fr_age
index|[
literal|0
index|]
expr_stmt|;
name|fr
operator|->
name|fr_age
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|fr_age
index|[
literal|1
index|]
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ip6
operator|=
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|ofd_ip6
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_type
operator|=
name|FRD_NORMAL
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_ip6
operator|=
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|ofd_ip6
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_type
operator|=
name|FRD_NORMAL
expr_stmt|;
name|fr
operator|->
name|fr_dif
operator|.
name|fd_ip6
operator|=
name|old
operator|->
name|fr_dif
operator|.
name|ofd_ip6
expr_stmt|;
name|fr
operator|->
name|fr_dif
operator|.
name|fd_type
operator|=
name|FRD_NORMAL
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|fr_v
operator|==
literal|4
condition|)
name|fr
operator|->
name|fr_family
operator|=
name|AF_INET
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|fr_v
operator|==
literal|6
condition|)
name|fr
operator|->
name|fr_family
operator|=
name|AF_INET6
expr_stmt|;
name|fr
operator|->
name|fr_icode
operator|=
name|old
operator|->
name|fr_icode
expr_stmt|;
name|fr
operator|->
name|fr_cksum
operator|=
name|old
operator|->
name|fr_cksum
expr_stmt|;
name|fr
operator|->
name|fr_namelen
operator|=
literal|0
expr_stmt|;
name|fr
operator|->
name|fr_ifnames
index|[
literal|0
index|]
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_ifnames
index|[
literal|1
index|]
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_ifnames
index|[
literal|2
index|]
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_ifnames
index|[
literal|3
index|]
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_dif
operator|.
name|fd_name
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_name
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_name
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_group
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_grhead
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_icmphead
operator|=
operator|-
literal|1
expr_stmt|;
if|if
condition|(
name|size
operator|==
literal|0
condition|)
block|{
name|fr
operator|->
name|fr_size
operator|=
sizeof|sizeof
argument_list|(
operator|*
name|fr
argument_list|)
operator|+
name|LIFNAMSIZ
operator|*
literal|7
operator|+
name|FR_GROUPLEN
operator|*
literal|2
expr_stmt|;
name|fr
operator|->
name|fr_size
operator|+=
literal|9
expr_stmt|;
comment|/* room for \0's */
block|}
else|else
block|{
name|char
modifier|*
name|names
init|=
name|fr
operator|->
name|fr_names
decl_stmt|;
name|int
name|nlen
init|=
name|fr
operator|->
name|fr_namelen
decl_stmt|;
name|fr
operator|->
name|fr_size
operator|=
name|size
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|fr_ifnames
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_ifnames
index|[
literal|0
index|]
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_ifnames
index|[
literal|0
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_ifnames
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_ifnames
index|[
literal|1
index|]
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_ifnames
index|[
literal|1
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_ifnames
index|[
literal|2
index|]
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_ifnames
index|[
literal|2
index|]
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_ifnames
index|[
literal|2
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_ifnames
index|[
literal|3
index|]
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_ifnames
index|[
literal|3
index|]
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_ifnames
index|[
literal|3
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ifname
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_name
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ifname
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_ifname
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_name
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_ifname
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_dif
operator|.
name|fd_ifname
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_dif
operator|.
name|fd_name
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_dif
operator|.
name|fd_ifname
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_group
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_group
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_group
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_grhead
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_grhead
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_grhead
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
name|fr
operator|->
name|fr_namelen
operator|=
name|nlen
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|fr_type
operator|==
name|FR_T_IPF
condition|)
block|{
name|int
name|offset
init|=
name|fr
operator|->
name|fr_namelen
decl_stmt|;
name|ipfobj_t
name|obj
decl_stmt|;
name|int
name|error
decl_stmt|;
name|obj
operator|.
name|ipfo_type
operator|=
name|IPFOBJ_FRIPF
expr_stmt|;
name|obj
operator|.
name|ipfo_rev
operator|=
literal|4010100
expr_stmt|;
name|obj
operator|.
name|ipfo_ptr
operator|=
name|old
operator|->
name|fr_data
expr_stmt|;
if|if
condition|(
operator|(
name|offset
operator|&
literal|7
operator|)
operator|!=
literal|0
condition|)
name|offset
operator|+=
literal|8
operator|-
operator|(
name|offset
operator|&
literal|7
operator|)
expr_stmt|;
name|error
operator|=
name|ipf_in_compat
argument_list|(
name|softc
argument_list|,
operator|&
name|obj
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|offset
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|fr
operator|->
name|fr_data
operator|=
name|fr
operator|->
name|fr_names
operator|+
name|offset
expr_stmt|;
name|fr
operator|->
name|fr_dsize
operator|=
sizeof|sizeof
argument_list|(
name|fripf_t
argument_list|)
expr_stmt|;
block|}
block|}
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|frentry_4_1_0_to_current
parameter_list|(
name|softc
parameter_list|,
name|old
parameter_list|,
name|current
parameter_list|,
name|size
parameter_list|)
name|ipf_main_softc_t
modifier|*
name|softc
decl_stmt|;
name|frentry_4_1_0_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
name|int
name|size
decl_stmt|;
block|{
name|frentry_t
modifier|*
name|fr
init|=
operator|(
name|frentry_t
operator|*
operator|)
name|current
decl_stmt|;
name|fr
operator|->
name|fr_size
operator|=
sizeof|sizeof
argument_list|(
operator|*
name|fr
argument_list|)
expr_stmt|;
name|fr
operator|->
name|fr_comment
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_ref
operator|=
name|old
operator|->
name|fr_ref
expr_stmt|;
name|fr
operator|->
name|fr_statecnt
operator|=
name|old
operator|->
name|fr_statecnt
expr_stmt|;
name|fr
operator|->
name|fr_hits
operator|=
name|old
operator|->
name|fr_hits
expr_stmt|;
name|fr
operator|->
name|fr_bytes
operator|=
name|old
operator|->
name|fr_bytes
expr_stmt|;
name|fr
operator|->
name|fr_lastpkt
operator|.
name|tv_sec
operator|=
name|old
operator|->
name|fr_lastpkt
operator|.
name|tv_sec
expr_stmt|;
name|fr
operator|->
name|fr_lastpkt
operator|.
name|tv_usec
operator|=
name|old
operator|->
name|fr_lastpkt
operator|.
name|tv_usec
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|fr_dun
argument_list|,
operator|&
name|fr
operator|->
name|fr_dun
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|fr_dun
argument_list|)
argument_list|)
expr_stmt|;
name|fr
operator|->
name|fr_func
operator|=
name|old
operator|->
name|fr_func
expr_stmt|;
name|fr
operator|->
name|fr_dsize
operator|=
name|old
operator|->
name|fr_dsize
expr_stmt|;
name|fr
operator|->
name|fr_pps
operator|=
name|old
operator|->
name|fr_pps
expr_stmt|;
name|fr
operator|->
name|fr_statemax
operator|=
name|old
operator|->
name|fr_statemax
expr_stmt|;
name|fr
operator|->
name|fr_flineno
operator|=
name|old
operator|->
name|fr_flineno
expr_stmt|;
name|fr
operator|->
name|fr_type
operator|=
name|old
operator|->
name|fr_type
expr_stmt|;
name|fr
operator|->
name|fr_flags
operator|=
name|fr_frflags4to5
argument_list|(
name|old
operator|->
name|fr_flags
argument_list|)
expr_stmt|;
name|fr
operator|->
name|fr_logtag
operator|=
name|old
operator|->
name|fr_logtag
expr_stmt|;
name|fr
operator|->
name|fr_collect
operator|=
name|old
operator|->
name|fr_collect
expr_stmt|;
name|fr
operator|->
name|fr_arg
operator|=
name|old
operator|->
name|fr_arg
expr_stmt|;
name|fr
operator|->
name|fr_loglevel
operator|=
name|old
operator|->
name|fr_loglevel
expr_stmt|;
name|fr
operator|->
name|fr_age
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|fr_age
index|[
literal|0
index|]
expr_stmt|;
name|fr
operator|->
name|fr_age
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|fr_age
index|[
literal|1
index|]
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ip6
operator|=
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|ofd_ip6
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_type
operator|=
name|FRD_NORMAL
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_ip6
operator|=
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|ofd_ip6
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_type
operator|=
name|FRD_NORMAL
expr_stmt|;
name|fr
operator|->
name|fr_dif
operator|.
name|fd_ip6
operator|=
name|old
operator|->
name|fr_dif
operator|.
name|ofd_ip6
expr_stmt|;
name|fr
operator|->
name|fr_dif
operator|.
name|fd_type
operator|=
name|FRD_NORMAL
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|fr_v
operator|==
literal|4
condition|)
name|fr
operator|->
name|fr_family
operator|=
name|AF_INET
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|fr_v
operator|==
literal|6
condition|)
name|fr
operator|->
name|fr_family
operator|=
name|AF_INET6
expr_stmt|;
name|fr
operator|->
name|fr_icode
operator|=
name|old
operator|->
name|fr_icode
expr_stmt|;
name|fr
operator|->
name|fr_cksum
operator|=
name|old
operator|->
name|fr_cksum
expr_stmt|;
name|fr
operator|->
name|fr_namelen
operator|=
literal|0
expr_stmt|;
name|fr
operator|->
name|fr_ifnames
index|[
literal|0
index|]
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_ifnames
index|[
literal|1
index|]
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_ifnames
index|[
literal|2
index|]
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_ifnames
index|[
literal|3
index|]
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_dif
operator|.
name|fd_name
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_name
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_name
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_group
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_grhead
operator|=
operator|-
literal|1
expr_stmt|;
name|fr
operator|->
name|fr_icmphead
operator|=
operator|-
literal|1
expr_stmt|;
if|if
condition|(
name|size
operator|==
literal|0
condition|)
block|{
name|fr
operator|->
name|fr_size
operator|=
sizeof|sizeof
argument_list|(
operator|*
name|fr
argument_list|)
operator|+
name|LIFNAMSIZ
operator|*
literal|7
operator|+
name|FR_GROUPLEN
operator|*
literal|2
expr_stmt|;
name|fr
operator|->
name|fr_size
operator|+=
literal|9
expr_stmt|;
comment|/* room for \0's */
block|}
else|else
block|{
name|char
modifier|*
name|names
init|=
name|fr
operator|->
name|fr_names
decl_stmt|;
name|int
name|nlen
init|=
name|fr
operator|->
name|fr_namelen
decl_stmt|;
name|fr
operator|->
name|fr_size
operator|=
name|size
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|fr_ifnames
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_ifnames
index|[
literal|0
index|]
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_ifnames
index|[
literal|0
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_ifnames
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_ifnames
index|[
literal|1
index|]
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_ifnames
index|[
literal|1
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_ifnames
index|[
literal|2
index|]
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_ifnames
index|[
literal|2
index|]
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_ifnames
index|[
literal|2
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_ifnames
index|[
literal|3
index|]
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_ifnames
index|[
literal|3
index|]
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_ifnames
index|[
literal|3
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ifname
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_name
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ifname
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_ifname
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_name
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_ifname
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_dif
operator|.
name|fd_ifname
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_dif
operator|.
name|fd_name
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_dif
operator|.
name|fd_ifname
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_group
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_group
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_group
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|fr_grhead
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|fr
operator|->
name|fr_grhead
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|fr_grhead
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
name|fr
operator|->
name|fr_namelen
operator|=
name|nlen
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|fr_type
operator|==
name|FR_T_IPF
condition|)
block|{
name|int
name|offset
init|=
name|fr
operator|->
name|fr_namelen
decl_stmt|;
name|ipfobj_t
name|obj
decl_stmt|;
name|int
name|error
decl_stmt|;
name|obj
operator|.
name|ipfo_type
operator|=
name|IPFOBJ_FRIPF
expr_stmt|;
name|obj
operator|.
name|ipfo_rev
operator|=
literal|4010100
expr_stmt|;
name|obj
operator|.
name|ipfo_ptr
operator|=
name|old
operator|->
name|fr_data
expr_stmt|;
if|if
condition|(
operator|(
name|offset
operator|&
literal|7
operator|)
operator|!=
literal|0
condition|)
name|offset
operator|+=
literal|8
operator|-
operator|(
name|offset
operator|&
literal|7
operator|)
expr_stmt|;
name|offset
operator|+=
literal|8
operator|-
operator|(
name|offset
operator|&
literal|7
operator|)
expr_stmt|;
name|error
operator|=
name|ipf_in_compat
argument_list|(
name|softc
argument_list|,
operator|&
name|obj
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|offset
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
condition|)
block|{
name|fr
operator|->
name|fr_data
operator|=
name|fr
operator|->
name|fr_names
operator|+
name|offset
expr_stmt|;
name|fr
operator|->
name|fr_dsize
operator|=
sizeof|sizeof
argument_list|(
name|fripf_t
argument_list|)
expr_stmt|;
block|}
block|}
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|friostat_4_1_33_to_current
parameter_list|(
name|old
parameter_list|,
name|current
parameter_list|)
name|friostat_4_1_33_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
block|{
name|friostat_t
modifier|*
name|fiop
init|=
operator|(
name|friostat_t
operator|*
operator|)
name|current
decl_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|of_st
index|[
literal|0
index|]
argument_list|,
operator|&
name|fiop
operator|->
name|f_st
index|[
literal|0
index|]
operator|.
name|fr_pass
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|of_st
index|[
literal|0
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|of_st
index|[
literal|1
index|]
argument_list|,
operator|&
name|fiop
operator|->
name|f_st
index|[
literal|1
index|]
operator|.
name|fr_pass
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|of_st
index|[
literal|1
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|fiop
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|0
index|]
expr_stmt|;
name|fiop
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|1
index|]
expr_stmt|;
name|fiop
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|0
index|]
expr_stmt|;
name|fiop
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|1
index|]
expr_stmt|;
name|fiop
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|0
index|]
expr_stmt|;
name|fiop
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|1
index|]
expr_stmt|;
name|fiop
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|0
index|]
expr_stmt|;
name|fiop
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|1
index|]
expr_stmt|;
name|fiop
operator|->
name|f_auth
operator|=
name|fiop
operator|->
name|f_auth
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|f_groups
argument_list|,
operator|&
name|fiop
operator|->
name|f_groups
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|f_groups
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|f_froute
argument_list|,
operator|&
name|fiop
operator|->
name|f_froute
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|f_froute
argument_list|)
argument_list|)
expr_stmt|;
name|fiop
operator|->
name|f_ticks
operator|=
name|old
operator|->
name|f_ticks
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|f_locks
argument_list|,
operator|&
name|fiop
operator|->
name|f_locks
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|f_locks
argument_list|)
argument_list|)
expr_stmt|;
name|fiop
operator|->
name|f_defpass
operator|=
name|old
operator|->
name|f_defpass
expr_stmt|;
name|fiop
operator|->
name|f_active
operator|=
name|old
operator|->
name|f_active
expr_stmt|;
name|fiop
operator|->
name|f_running
operator|=
name|old
operator|->
name|f_running
expr_stmt|;
name|fiop
operator|->
name|f_logging
operator|=
name|old
operator|->
name|f_logging
expr_stmt|;
name|fiop
operator|->
name|f_features
operator|=
name|old
operator|->
name|f_features
expr_stmt|;
name|bcopy
argument_list|(
name|old
operator|->
name|f_version
argument_list|,
name|fiop
operator|->
name|f_version
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|f_version
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|friostat_4_1_0_to_current
parameter_list|(
name|old
parameter_list|,
name|current
parameter_list|)
name|friostat_4_1_0_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
block|{
name|friostat_t
modifier|*
name|fiop
init|=
operator|(
name|friostat_t
operator|*
operator|)
name|current
decl_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|of_st
index|[
literal|0
index|]
argument_list|,
operator|&
name|fiop
operator|->
name|f_st
index|[
literal|0
index|]
operator|.
name|fr_pass
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|of_st
index|[
literal|0
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|of_st
index|[
literal|1
index|]
argument_list|,
operator|&
name|fiop
operator|->
name|f_st
index|[
literal|1
index|]
operator|.
name|fr_pass
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|of_st
index|[
literal|1
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|fiop
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|0
index|]
expr_stmt|;
name|fiop
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|1
index|]
expr_stmt|;
name|fiop
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|0
index|]
expr_stmt|;
name|fiop
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|1
index|]
expr_stmt|;
name|fiop
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|0
index|]
expr_stmt|;
name|fiop
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|1
index|]
expr_stmt|;
name|fiop
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|0
index|]
expr_stmt|;
name|fiop
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|1
index|]
expr_stmt|;
name|fiop
operator|->
name|f_auth
operator|=
name|fiop
operator|->
name|f_auth
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|f_groups
argument_list|,
operator|&
name|fiop
operator|->
name|f_groups
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|f_groups
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|f_froute
argument_list|,
operator|&
name|fiop
operator|->
name|f_froute
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|f_froute
argument_list|)
argument_list|)
expr_stmt|;
name|fiop
operator|->
name|f_ticks
operator|=
name|old
operator|->
name|f_ticks
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|f_locks
argument_list|,
operator|&
name|fiop
operator|->
name|f_locks
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|f_locks
argument_list|)
argument_list|)
expr_stmt|;
name|fiop
operator|->
name|f_defpass
operator|=
name|old
operator|->
name|f_defpass
expr_stmt|;
name|fiop
operator|->
name|f_active
operator|=
name|old
operator|->
name|f_active
expr_stmt|;
name|fiop
operator|->
name|f_running
operator|=
name|old
operator|->
name|f_running
expr_stmt|;
name|fiop
operator|->
name|f_logging
operator|=
name|old
operator|->
name|f_logging
expr_stmt|;
name|fiop
operator|->
name|f_features
operator|=
name|old
operator|->
name|f_features
expr_stmt|;
name|bcopy
argument_list|(
name|old
operator|->
name|f_version
argument_list|,
name|fiop
operator|->
name|f_version
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|f_version
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|ipnat_4_1_14_to_current
parameter_list|(
name|old
parameter_list|,
name|current
parameter_list|,
name|size
parameter_list|)
name|ipnat_4_1_14_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
name|int
name|size
decl_stmt|;
block|{
name|ipnat_t
modifier|*
name|np
init|=
operator|(
name|ipnat_t
operator|*
operator|)
name|current
decl_stmt|;
name|np
operator|->
name|in_space
operator|=
name|old
operator|->
name|in_space
expr_stmt|;
name|np
operator|->
name|in_hv
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|in_hv
expr_stmt|;
name|np
operator|->
name|in_hv
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|in_hv
expr_stmt|;
name|np
operator|->
name|in_flineno
operator|=
name|old
operator|->
name|in_flineno
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|in_redir
operator|==
name|NAT_REDIRECT
condition|)
name|np
operator|->
name|in_dpnext
operator|=
name|old
operator|->
name|in_pnext
expr_stmt|;
else|else
name|np
operator|->
name|in_spnext
operator|=
name|old
operator|->
name|in_pnext
expr_stmt|;
name|np
operator|->
name|in_v
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|in_v
expr_stmt|;
name|np
operator|->
name|in_v
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|in_v
expr_stmt|;
name|np
operator|->
name|in_flags
operator|=
name|old
operator|->
name|in_flags
expr_stmt|;
name|np
operator|->
name|in_mssclamp
operator|=
name|old
operator|->
name|in_mssclamp
expr_stmt|;
name|np
operator|->
name|in_age
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|in_age
index|[
literal|0
index|]
expr_stmt|;
name|np
operator|->
name|in_age
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|in_age
index|[
literal|1
index|]
expr_stmt|;
name|np
operator|->
name|in_redir
operator|=
name|old
operator|->
name|in_redir
expr_stmt|;
name|np
operator|->
name|in_pr
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|in_p
expr_stmt|;
name|np
operator|->
name|in_pr
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|in_p
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_redir
operator|==
name|NAT_REDIRECT
condition|)
block|{
name|np
operator|->
name|in_ndst
operator|.
name|na_nextaddr
operator|=
name|old
operator|->
name|in_next6
expr_stmt|;
name|np
operator|->
name|in_ndst
operator|.
name|na_addr
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|in_in
index|[
literal|0
index|]
expr_stmt|;
name|np
operator|->
name|in_ndst
operator|.
name|na_addr
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|in_in
index|[
literal|1
index|]
expr_stmt|;
name|np
operator|->
name|in_ndst
operator|.
name|na_atype
operator|=
name|FRI_NORMAL
expr_stmt|;
name|np
operator|->
name|in_odst
operator|.
name|na_addr
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|in_out
index|[
literal|0
index|]
expr_stmt|;
name|np
operator|->
name|in_odst
operator|.
name|na_addr
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|in_out
index|[
literal|1
index|]
expr_stmt|;
name|np
operator|->
name|in_odst
operator|.
name|na_atype
operator|=
name|FRI_NORMAL
expr_stmt|;
name|np
operator|->
name|in_osrc
operator|.
name|na_addr
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|in_src
index|[
literal|0
index|]
expr_stmt|;
name|np
operator|->
name|in_osrc
operator|.
name|na_addr
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|in_src
index|[
literal|1
index|]
expr_stmt|;
name|np
operator|->
name|in_osrc
operator|.
name|na_atype
operator|=
name|FRI_NORMAL
expr_stmt|;
block|}
else|else
block|{
name|np
operator|->
name|in_nsrc
operator|.
name|na_nextaddr
operator|=
name|old
operator|->
name|in_next6
expr_stmt|;
name|np
operator|->
name|in_nsrc
operator|.
name|na_addr
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|in_out
index|[
literal|0
index|]
expr_stmt|;
name|np
operator|->
name|in_nsrc
operator|.
name|na_addr
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|in_out
index|[
literal|1
index|]
expr_stmt|;
name|np
operator|->
name|in_nsrc
operator|.
name|na_atype
operator|=
name|FRI_NORMAL
expr_stmt|;
name|np
operator|->
name|in_osrc
operator|.
name|na_addr
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|in_in
index|[
literal|0
index|]
expr_stmt|;
name|np
operator|->
name|in_osrc
operator|.
name|na_addr
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|in_in
index|[
literal|1
index|]
expr_stmt|;
name|np
operator|->
name|in_osrc
operator|.
name|na_atype
operator|=
name|FRI_NORMAL
expr_stmt|;
name|np
operator|->
name|in_odst
operator|.
name|na_addr
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|in_src
index|[
literal|0
index|]
expr_stmt|;
name|np
operator|->
name|in_odst
operator|.
name|na_addr
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|in_src
index|[
literal|1
index|]
expr_stmt|;
name|np
operator|->
name|in_odst
operator|.
name|na_atype
operator|=
name|FRI_NORMAL
expr_stmt|;
block|}
name|ipfv4tuctov5
argument_list|(
operator|&
name|old
operator|->
name|in_tuc
argument_list|,
operator|&
name|np
operator|->
name|in_tuc
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_redir
operator|==
name|NAT_REDIRECT
condition|)
block|{
name|np
operator|->
name|in_dpmin
operator|=
name|old
operator|->
name|in_port
index|[
literal|0
index|]
expr_stmt|;
name|np
operator|->
name|in_dpmax
operator|=
name|old
operator|->
name|in_port
index|[
literal|1
index|]
expr_stmt|;
block|}
else|else
block|{
name|np
operator|->
name|in_spmin
operator|=
name|old
operator|->
name|in_port
index|[
literal|0
index|]
expr_stmt|;
name|np
operator|->
name|in_spmax
operator|=
name|old
operator|->
name|in_port
index|[
literal|1
index|]
expr_stmt|;
block|}
name|np
operator|->
name|in_ppip
operator|=
name|old
operator|->
name|in_ppip
expr_stmt|;
name|np
operator|->
name|in_ippip
operator|=
name|old
operator|->
name|in_ippip
expr_stmt|;
name|np
operator|->
name|in_tag
operator|=
name|old
operator|->
name|in_tag
expr_stmt|;
name|np
operator|->
name|in_namelen
operator|=
literal|0
expr_stmt|;
name|np
operator|->
name|in_plabel
operator|=
operator|-
literal|1
expr_stmt|;
name|np
operator|->
name|in_ifnames
index|[
literal|0
index|]
operator|=
operator|-
literal|1
expr_stmt|;
name|np
operator|->
name|in_ifnames
index|[
literal|1
index|]
operator|=
operator|-
literal|1
expr_stmt|;
if|if
condition|(
name|size
operator|==
literal|0
condition|)
block|{
name|np
operator|->
name|in_size
operator|=
sizeof|sizeof
argument_list|(
operator|*
name|np
argument_list|)
expr_stmt|;
name|np
operator|->
name|in_size
operator|+=
name|LIFNAMSIZ
operator|*
literal|2
operator|+
name|APR_LABELLEN
expr_stmt|;
name|np
operator|->
name|in_size
operator|+=
literal|3
expr_stmt|;
block|}
else|else
block|{
name|int
name|nlen
init|=
name|np
operator|->
name|in_namelen
decl_stmt|;
name|char
modifier|*
name|names
init|=
name|np
operator|->
name|in_names
decl_stmt|;
if|if
condition|(
name|old
operator|->
name|in_ifnames
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|np
operator|->
name|in_ifnames
index|[
literal|0
index|]
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|in_ifnames
index|[
literal|0
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|in_ifnames
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|np
operator|->
name|in_ifnames
index|[
literal|0
index|]
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|in_ifnames
index|[
literal|1
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|in_plabel
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|np
operator|->
name|in_plabel
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|in_plabel
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
name|np
operator|->
name|in_namelen
operator|=
name|nlen
expr_stmt|;
name|np
operator|->
name|in_size
operator|=
name|size
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|ipnat_4_1_0_to_current
parameter_list|(
name|old
parameter_list|,
name|current
parameter_list|,
name|size
parameter_list|)
name|ipnat_4_1_0_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
name|int
name|size
decl_stmt|;
block|{
name|ipnat_t
modifier|*
name|np
init|=
operator|(
name|ipnat_t
operator|*
operator|)
name|current
decl_stmt|;
name|np
operator|->
name|in_space
operator|=
name|old
operator|->
name|in_space
expr_stmt|;
name|np
operator|->
name|in_hv
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|in_hv
expr_stmt|;
name|np
operator|->
name|in_hv
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|in_hv
expr_stmt|;
name|np
operator|->
name|in_flineno
operator|=
name|old
operator|->
name|in_flineno
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|in_redir
operator|==
name|NAT_REDIRECT
condition|)
name|np
operator|->
name|in_dpnext
operator|=
name|old
operator|->
name|in_pnext
expr_stmt|;
else|else
name|np
operator|->
name|in_spnext
operator|=
name|old
operator|->
name|in_pnext
expr_stmt|;
name|np
operator|->
name|in_v
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|in_v
expr_stmt|;
name|np
operator|->
name|in_v
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|in_v
expr_stmt|;
name|np
operator|->
name|in_flags
operator|=
name|old
operator|->
name|in_flags
expr_stmt|;
name|np
operator|->
name|in_mssclamp
operator|=
name|old
operator|->
name|in_mssclamp
expr_stmt|;
name|np
operator|->
name|in_age
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|in_age
index|[
literal|0
index|]
expr_stmt|;
name|np
operator|->
name|in_age
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|in_age
index|[
literal|1
index|]
expr_stmt|;
name|np
operator|->
name|in_redir
operator|=
name|old
operator|->
name|in_redir
expr_stmt|;
name|np
operator|->
name|in_pr
index|[
literal|0
index|]
operator|=
name|old
operator|->
name|in_p
expr_stmt|;
name|np
operator|->
name|in_pr
index|[
literal|1
index|]
operator|=
name|old
operator|->
name|in_p
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_redir
operator|==
name|NAT_REDIRECT
condition|)
block|{
name|np
operator|->
name|in_ndst
operator|.
name|na_nextaddr
operator|=
name|old
operator|->
name|in_next6
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|in_in
argument_list|,
operator|&
name|np
operator|->
name|in_ndst
operator|.
name|na_addr
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|in_in
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|in_out
argument_list|,
operator|&
name|np
operator|->
name|in_odst
operator|.
name|na_addr
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|in_out
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|in_src
argument_list|,
operator|&
name|np
operator|->
name|in_osrc
operator|.
name|na_addr
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|in_src
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|np
operator|->
name|in_nsrc
operator|.
name|na_nextaddr
operator|=
name|old
operator|->
name|in_next6
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|in_in
argument_list|,
operator|&
name|np
operator|->
name|in_osrc
operator|.
name|na_addr
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|in_in
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|in_out
argument_list|,
operator|&
name|np
operator|->
name|in_nsrc
operator|.
name|na_addr
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|in_out
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|in_src
argument_list|,
operator|&
name|np
operator|->
name|in_odst
operator|.
name|na_addr
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|in_src
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|ipfv4tuctov5
argument_list|(
operator|&
name|old
operator|->
name|in_tuc
argument_list|,
operator|&
name|np
operator|->
name|in_tuc
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_redir
operator|==
name|NAT_REDIRECT
condition|)
block|{
name|np
operator|->
name|in_dpmin
operator|=
name|old
operator|->
name|in_port
index|[
literal|0
index|]
expr_stmt|;
name|np
operator|->
name|in_dpmax
operator|=
name|old
operator|->
name|in_port
index|[
literal|1
index|]
expr_stmt|;
block|}
else|else
block|{
name|np
operator|->
name|in_spmin
operator|=
name|old
operator|->
name|in_port
index|[
literal|0
index|]
expr_stmt|;
name|np
operator|->
name|in_spmax
operator|=
name|old
operator|->
name|in_port
index|[
literal|1
index|]
expr_stmt|;
block|}
name|np
operator|->
name|in_ppip
operator|=
name|old
operator|->
name|in_ppip
expr_stmt|;
name|np
operator|->
name|in_ippip
operator|=
name|old
operator|->
name|in_ippip
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|in_tag
argument_list|,
operator|&
name|np
operator|->
name|in_tag
argument_list|,
sizeof|sizeof
argument_list|(
name|np
operator|->
name|in_tag
argument_list|)
argument_list|)
expr_stmt|;
name|np
operator|->
name|in_namelen
operator|=
literal|0
expr_stmt|;
name|np
operator|->
name|in_plabel
operator|=
operator|-
literal|1
expr_stmt|;
name|np
operator|->
name|in_ifnames
index|[
literal|0
index|]
operator|=
operator|-
literal|1
expr_stmt|;
name|np
operator|->
name|in_ifnames
index|[
literal|1
index|]
operator|=
operator|-
literal|1
expr_stmt|;
if|if
condition|(
name|size
operator|==
literal|0
condition|)
block|{
name|np
operator|->
name|in_size
operator|=
sizeof|sizeof
argument_list|(
operator|*
name|np
argument_list|)
expr_stmt|;
name|np
operator|->
name|in_size
operator|+=
name|LIFNAMSIZ
operator|*
literal|2
operator|+
name|APR_LABELLEN
expr_stmt|;
name|np
operator|->
name|in_size
operator|+=
literal|3
expr_stmt|;
block|}
else|else
block|{
name|int
name|nlen
init|=
name|np
operator|->
name|in_namelen
decl_stmt|;
name|char
modifier|*
name|names
init|=
name|np
operator|->
name|in_names
decl_stmt|;
if|if
condition|(
name|old
operator|->
name|in_ifnames
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|np
operator|->
name|in_ifnames
index|[
literal|0
index|]
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|in_ifnames
index|[
literal|0
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|in_ifnames
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|np
operator|->
name|in_ifnames
index|[
literal|0
index|]
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|in_ifnames
index|[
literal|1
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|old
operator|->
name|in_plabel
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|np
operator|->
name|in_plabel
operator|=
name|nlen
expr_stmt|;
name|nlen
operator|=
name|ipf_addfrstr
argument_list|(
name|names
argument_list|,
name|nlen
argument_list|,
name|old
operator|->
name|in_plabel
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
block|}
name|np
operator|->
name|in_namelen
operator|=
name|nlen
expr_stmt|;
name|np
operator|->
name|in_size
operator|=
name|size
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|frauth_4_1_32_to_current
parameter_list|(
name|old
parameter_list|,
name|current
parameter_list|)
name|frauth_4_1_32_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
block|{
name|frauth_t
modifier|*
name|fra
init|=
operator|(
name|frauth_t
operator|*
operator|)
name|current
decl_stmt|;
name|fra
operator|->
name|fra_age
operator|=
name|old
operator|->
name|fra_age
expr_stmt|;
name|fra
operator|->
name|fra_len
operator|=
name|old
operator|->
name|fra_len
expr_stmt|;
name|fra
operator|->
name|fra_index
operator|=
name|old
operator|->
name|fra_index
expr_stmt|;
name|fra
operator|->
name|fra_pass
operator|=
name|old
operator|->
name|fra_pass
expr_stmt|;
name|fr_info_4_1_32_to_current
argument_list|(
operator|&
name|old
operator|->
name|fra_info
argument_list|,
operator|&
name|fra
operator|->
name|fra_info
argument_list|)
expr_stmt|;
name|fra
operator|->
name|fra_buf
operator|=
name|old
operator|->
name|fra_buf
expr_stmt|;
name|fra
operator|->
name|fra_flx
operator|=
name|old
operator|->
name|fra_flx
expr_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|fra
operator|->
name|fra_q
operator|=
name|old
operator|->
name|fra_q
expr_stmt|;
name|fra
operator|->
name|fra_m
operator|=
name|old
operator|->
name|fra_m
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|frauth_4_1_29_to_current
parameter_list|(
name|old
parameter_list|,
name|current
parameter_list|)
name|frauth_4_1_29_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
block|{
name|frauth_t
modifier|*
name|fra
init|=
operator|(
name|frauth_t
operator|*
operator|)
name|current
decl_stmt|;
name|fra
operator|->
name|fra_age
operator|=
name|old
operator|->
name|fra_age
expr_stmt|;
name|fra
operator|->
name|fra_len
operator|=
name|old
operator|->
name|fra_len
expr_stmt|;
name|fra
operator|->
name|fra_index
operator|=
name|old
operator|->
name|fra_index
expr_stmt|;
name|fra
operator|->
name|fra_pass
operator|=
name|old
operator|->
name|fra_pass
expr_stmt|;
name|fr_info_4_1_24_to_current
argument_list|(
operator|&
name|old
operator|->
name|fra_info
argument_list|,
operator|&
name|fra
operator|->
name|fra_info
argument_list|)
expr_stmt|;
name|fra
operator|->
name|fra_buf
operator|=
name|old
operator|->
name|fra_buf
expr_stmt|;
name|fra
operator|->
name|fra_flx
operator|=
name|old
operator|->
name|fra_flx
expr_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|fra
operator|->
name|fra_q
operator|=
name|old
operator|->
name|fra_q
expr_stmt|;
name|fra
operator|->
name|fra_m
operator|=
name|old
operator|->
name|fra_m
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|frauth_4_1_24_to_current
parameter_list|(
name|old
parameter_list|,
name|current
parameter_list|)
name|frauth_4_1_24_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
block|{
name|frauth_t
modifier|*
name|fra
init|=
operator|(
name|frauth_t
operator|*
operator|)
name|current
decl_stmt|;
name|fra
operator|->
name|fra_age
operator|=
name|old
operator|->
name|fra_age
expr_stmt|;
name|fra
operator|->
name|fra_len
operator|=
name|old
operator|->
name|fra_len
expr_stmt|;
name|fra
operator|->
name|fra_index
operator|=
name|old
operator|->
name|fra_index
expr_stmt|;
name|fra
operator|->
name|fra_pass
operator|=
name|old
operator|->
name|fra_pass
expr_stmt|;
name|fr_info_4_1_24_to_current
argument_list|(
operator|&
name|old
operator|->
name|fra_info
argument_list|,
operator|&
name|fra
operator|->
name|fra_info
argument_list|)
expr_stmt|;
name|fra
operator|->
name|fra_buf
operator|=
name|old
operator|->
name|fra_buf
expr_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|fra
operator|->
name|fra_q
operator|=
name|old
operator|->
name|fra_q
expr_stmt|;
name|fra
operator|->
name|fra_m
operator|=
name|old
operator|->
name|fra_m
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|frauth_4_1_23_to_current
parameter_list|(
name|old
parameter_list|,
name|current
parameter_list|)
name|frauth_4_1_23_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
block|{
name|frauth_t
modifier|*
name|fra
init|=
operator|(
name|frauth_t
operator|*
operator|)
name|current
decl_stmt|;
name|fra
operator|->
name|fra_age
operator|=
name|old
operator|->
name|fra_age
expr_stmt|;
name|fra
operator|->
name|fra_len
operator|=
name|old
operator|->
name|fra_len
expr_stmt|;
name|fra
operator|->
name|fra_index
operator|=
name|old
operator|->
name|fra_index
expr_stmt|;
name|fra
operator|->
name|fra_pass
operator|=
name|old
operator|->
name|fra_pass
expr_stmt|;
name|fr_info_4_1_23_to_current
argument_list|(
operator|&
name|old
operator|->
name|fra_info
argument_list|,
operator|&
name|fra
operator|->
name|fra_info
argument_list|)
expr_stmt|;
name|fra
operator|->
name|fra_buf
operator|=
name|old
operator|->
name|fra_buf
expr_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|fra
operator|->
name|fra_q
operator|=
name|old
operator|->
name|fra_q
expr_stmt|;
name|fra
operator|->
name|fra_m
operator|=
name|old
operator|->
name|fra_m
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|frauth_4_1_11_to_current
parameter_list|(
name|old
parameter_list|,
name|current
parameter_list|)
name|frauth_4_1_11_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
block|{
name|frauth_t
modifier|*
name|fra
init|=
operator|(
name|frauth_t
operator|*
operator|)
name|current
decl_stmt|;
name|fra
operator|->
name|fra_age
operator|=
name|old
operator|->
name|fra_age
expr_stmt|;
name|fra
operator|->
name|fra_len
operator|=
name|old
operator|->
name|fra_len
expr_stmt|;
name|fra
operator|->
name|fra_index
operator|=
name|old
operator|->
name|fra_index
expr_stmt|;
name|fra
operator|->
name|fra_pass
operator|=
name|old
operator|->
name|fra_pass
expr_stmt|;
name|fr_info_4_1_11_to_current
argument_list|(
operator|&
name|old
operator|->
name|fra_info
argument_list|,
operator|&
name|fra
operator|->
name|fra_info
argument_list|)
expr_stmt|;
name|fra
operator|->
name|fra_buf
operator|=
name|old
operator|->
name|fra_buf
expr_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|fra
operator|->
name|fra_q
operator|=
name|old
operator|->
name|fra_q
expr_stmt|;
name|fra
operator|->
name|fra_m
operator|=
name|old
operator|->
name|fra_m
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|fr_info_4_1_32_to_current
parameter_list|(
name|old
parameter_list|,
name|current
parameter_list|)
name|fr_info_4_1_32_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
block|{
name|fr_info_t
modifier|*
name|fin
init|=
operator|(
name|fr_info_t
operator|*
operator|)
name|current
decl_stmt|;
name|fin
operator|->
name|fin_ifp
operator|=
name|old
operator|->
name|fin_ifp
expr_stmt|;
name|ipf_v4iptov5
argument_list|(
operator|&
name|old
operator|->
name|fin_fi
argument_list|,
operator|&
name|fin
operator|->
name|fin_fi
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|fin_dat
argument_list|,
operator|&
name|fin
operator|->
name|fin_dat
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|fin_dat
argument_list|)
argument_list|)
expr_stmt|;
name|fin
operator|->
name|fin_out
operator|=
name|old
operator|->
name|fin_out
expr_stmt|;
name|fin
operator|->
name|fin_rev
operator|=
name|old
operator|->
name|fin_rev
expr_stmt|;
name|fin
operator|->
name|fin_hlen
operator|=
name|old
operator|->
name|fin_hlen
expr_stmt|;
name|fin
operator|->
name|fin_tcpf
operator|=
name|old
operator|->
name|ofin_tcpf
expr_stmt|;
name|fin
operator|->
name|fin_icode
operator|=
name|old
operator|->
name|fin_icode
expr_stmt|;
name|fin
operator|->
name|fin_rule
operator|=
name|old
operator|->
name|fin_rule
expr_stmt|;
name|bcopy
argument_list|(
name|old
operator|->
name|fin_group
argument_list|,
name|fin
operator|->
name|fin_group
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|fin_group
argument_list|)
argument_list|)
expr_stmt|;
name|fin
operator|->
name|fin_fr
operator|=
name|old
operator|->
name|fin_fr
expr_stmt|;
name|fin
operator|->
name|fin_dp
operator|=
name|old
operator|->
name|fin_dp
expr_stmt|;
name|fin
operator|->
name|fin_dlen
operator|=
name|old
operator|->
name|fin_dlen
expr_stmt|;
name|fin
operator|->
name|fin_plen
operator|=
name|old
operator|->
name|fin_plen
expr_stmt|;
name|fin
operator|->
name|fin_ipoff
operator|=
name|old
operator|->
name|fin_ipoff
expr_stmt|;
name|fin
operator|->
name|fin_id
operator|=
name|old
operator|->
name|fin_id
expr_stmt|;
name|fin
operator|->
name|fin_off
operator|=
name|old
operator|->
name|fin_off
expr_stmt|;
name|fin
operator|->
name|fin_depth
operator|=
name|old
operator|->
name|fin_depth
expr_stmt|;
name|fin
operator|->
name|fin_error
operator|=
name|old
operator|->
name|fin_error
expr_stmt|;
name|fin
operator|->
name|fin_cksum
operator|=
name|old
operator|->
name|fin_cksum
expr_stmt|;
name|fin
operator|->
name|fin_nattag
operator|=
name|old
operator|->
name|fin_nattag
expr_stmt|;
name|fin
operator|->
name|fin_ip
operator|=
name|old
operator|->
name|ofin_ip
expr_stmt|;
name|fin
operator|->
name|fin_mp
operator|=
name|old
operator|->
name|fin_mp
expr_stmt|;
name|fin
operator|->
name|fin_m
operator|=
name|old
operator|->
name|fin_m
expr_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|fin
operator|->
name|fin_qfm
operator|=
name|old
operator|->
name|fin_qfm
expr_stmt|;
name|fin
operator|->
name|fin_qpi
operator|=
name|old
operator|->
name|fin_qpi
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|__sgi
name|fin
operator|->
name|fin_hbuf
operator|=
name|old
operator|->
name|fin_hbuf
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|fr_info_4_1_24_to_current
parameter_list|(
name|old
parameter_list|,
name|current
parameter_list|)
name|fr_info_4_1_24_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
block|{
name|fr_info_t
modifier|*
name|fin
init|=
operator|(
name|fr_info_t
operator|*
operator|)
name|current
decl_stmt|;
name|fin
operator|->
name|fin_ifp
operator|=
name|old
operator|->
name|fin_ifp
expr_stmt|;
name|ipf_v4iptov5
argument_list|(
operator|&
name|old
operator|->
name|fin_fi
argument_list|,
operator|&
name|fin
operator|->
name|fin_fi
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|fin_dat
argument_list|,
operator|&
name|fin
operator|->
name|fin_dat
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|fin_dat
argument_list|)
argument_list|)
expr_stmt|;
name|fin
operator|->
name|fin_out
operator|=
name|old
operator|->
name|fin_out
expr_stmt|;
name|fin
operator|->
name|fin_rev
operator|=
name|old
operator|->
name|fin_rev
expr_stmt|;
name|fin
operator|->
name|fin_hlen
operator|=
name|old
operator|->
name|fin_hlen
expr_stmt|;
name|fin
operator|->
name|fin_tcpf
operator|=
name|old
operator|->
name|ofin_tcpf
expr_stmt|;
name|fin
operator|->
name|fin_icode
operator|=
name|old
operator|->
name|fin_icode
expr_stmt|;
name|fin
operator|->
name|fin_rule
operator|=
name|old
operator|->
name|fin_rule
expr_stmt|;
name|bcopy
argument_list|(
name|old
operator|->
name|fin_group
argument_list|,
name|fin
operator|->
name|fin_group
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|fin_group
argument_list|)
argument_list|)
expr_stmt|;
name|fin
operator|->
name|fin_fr
operator|=
name|old
operator|->
name|fin_fr
expr_stmt|;
name|fin
operator|->
name|fin_dp
operator|=
name|old
operator|->
name|fin_dp
expr_stmt|;
name|fin
operator|->
name|fin_dlen
operator|=
name|old
operator|->
name|fin_dlen
expr_stmt|;
name|fin
operator|->
name|fin_plen
operator|=
name|old
operator|->
name|fin_plen
expr_stmt|;
name|fin
operator|->
name|fin_ipoff
operator|=
name|old
operator|->
name|fin_ipoff
expr_stmt|;
name|fin
operator|->
name|fin_id
operator|=
name|old
operator|->
name|fin_id
expr_stmt|;
name|fin
operator|->
name|fin_off
operator|=
name|old
operator|->
name|fin_off
expr_stmt|;
name|fin
operator|->
name|fin_depth
operator|=
name|old
operator|->
name|fin_depth
expr_stmt|;
name|fin
operator|->
name|fin_error
operator|=
name|old
operator|->
name|fin_error
expr_stmt|;
name|fin
operator|->
name|fin_cksum
operator|=
name|old
operator|->
name|fin_cksum
expr_stmt|;
name|fin
operator|->
name|fin_nattag
operator|=
name|old
operator|->
name|fin_nattag
expr_stmt|;
name|fin
operator|->
name|fin_ip
operator|=
name|old
operator|->
name|ofin_ip
expr_stmt|;
name|fin
operator|->
name|fin_mp
operator|=
name|old
operator|->
name|fin_mp
expr_stmt|;
name|fin
operator|->
name|fin_m
operator|=
name|old
operator|->
name|fin_m
expr_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|fin
operator|->
name|fin_qfm
operator|=
name|old
operator|->
name|fin_qfm
expr_stmt|;
name|fin
operator|->
name|fin_qpi
operator|=
name|old
operator|->
name|fin_qpi
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|__sgi
name|fin
operator|->
name|fin_hbuf
operator|=
name|old
operator|->
name|fin_hbuf
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|fr_info_4_1_23_to_current
parameter_list|(
name|old
parameter_list|,
name|current
parameter_list|)
name|fr_info_4_1_23_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
block|{
name|fr_info_t
modifier|*
name|fin
init|=
operator|(
name|fr_info_t
operator|*
operator|)
name|current
decl_stmt|;
name|fin
operator|->
name|fin_ifp
operator|=
name|old
operator|->
name|fin_ifp
expr_stmt|;
name|ipf_v4iptov5
argument_list|(
operator|&
name|old
operator|->
name|fin_fi
argument_list|,
operator|&
name|fin
operator|->
name|fin_fi
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|fin_dat
argument_list|,
operator|&
name|fin
operator|->
name|fin_dat
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|fin_dat
argument_list|)
argument_list|)
expr_stmt|;
name|fin
operator|->
name|fin_out
operator|=
name|old
operator|->
name|fin_out
expr_stmt|;
name|fin
operator|->
name|fin_rev
operator|=
name|old
operator|->
name|fin_rev
expr_stmt|;
name|fin
operator|->
name|fin_hlen
operator|=
name|old
operator|->
name|fin_hlen
expr_stmt|;
name|fin
operator|->
name|fin_tcpf
operator|=
name|old
operator|->
name|ofin_tcpf
expr_stmt|;
name|fin
operator|->
name|fin_icode
operator|=
name|old
operator|->
name|fin_icode
expr_stmt|;
name|fin
operator|->
name|fin_rule
operator|=
name|old
operator|->
name|fin_rule
expr_stmt|;
name|bcopy
argument_list|(
name|old
operator|->
name|fin_group
argument_list|,
name|fin
operator|->
name|fin_group
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|fin_group
argument_list|)
argument_list|)
expr_stmt|;
name|fin
operator|->
name|fin_fr
operator|=
name|old
operator|->
name|fin_fr
expr_stmt|;
name|fin
operator|->
name|fin_dp
operator|=
name|old
operator|->
name|fin_dp
expr_stmt|;
name|fin
operator|->
name|fin_dlen
operator|=
name|old
operator|->
name|fin_dlen
expr_stmt|;
name|fin
operator|->
name|fin_plen
operator|=
name|old
operator|->
name|fin_plen
expr_stmt|;
name|fin
operator|->
name|fin_ipoff
operator|=
name|old
operator|->
name|fin_ipoff
expr_stmt|;
name|fin
operator|->
name|fin_id
operator|=
name|old
operator|->
name|fin_id
expr_stmt|;
name|fin
operator|->
name|fin_off
operator|=
name|old
operator|->
name|fin_off
expr_stmt|;
name|fin
operator|->
name|fin_depth
operator|=
name|old
operator|->
name|fin_depth
expr_stmt|;
name|fin
operator|->
name|fin_error
operator|=
name|old
operator|->
name|fin_error
expr_stmt|;
name|fin
operator|->
name|fin_nattag
operator|=
name|old
operator|->
name|fin_nattag
expr_stmt|;
name|fin
operator|->
name|fin_ip
operator|=
name|old
operator|->
name|ofin_ip
expr_stmt|;
name|fin
operator|->
name|fin_mp
operator|=
name|old
operator|->
name|fin_mp
expr_stmt|;
name|fin
operator|->
name|fin_m
operator|=
name|old
operator|->
name|fin_m
expr_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|fin
operator|->
name|fin_qfm
operator|=
name|old
operator|->
name|fin_qfm
expr_stmt|;
name|fin
operator|->
name|fin_qpi
operator|=
name|old
operator|->
name|fin_qpi
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|__sgi
name|fin
operator|->
name|fin_hbuf
operator|=
name|fin
operator|->
name|fin_hbuf
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|fr_info_4_1_11_to_current
parameter_list|(
name|old
parameter_list|,
name|current
parameter_list|)
name|fr_info_4_1_11_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
block|{
name|fr_info_t
modifier|*
name|fin
init|=
operator|(
name|fr_info_t
operator|*
operator|)
name|current
decl_stmt|;
name|fin
operator|->
name|fin_ifp
operator|=
name|old
operator|->
name|fin_ifp
expr_stmt|;
name|ipf_v4iptov5
argument_list|(
operator|&
name|old
operator|->
name|fin_fi
argument_list|,
operator|&
name|fin
operator|->
name|fin_fi
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|fin_dat
argument_list|,
operator|&
name|fin
operator|->
name|fin_dat
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|fin_dat
argument_list|)
argument_list|)
expr_stmt|;
name|fin
operator|->
name|fin_out
operator|=
name|old
operator|->
name|fin_out
expr_stmt|;
name|fin
operator|->
name|fin_rev
operator|=
name|old
operator|->
name|fin_rev
expr_stmt|;
name|fin
operator|->
name|fin_hlen
operator|=
name|old
operator|->
name|fin_hlen
expr_stmt|;
name|fin
operator|->
name|fin_tcpf
operator|=
name|old
operator|->
name|ofin_tcpf
expr_stmt|;
name|fin
operator|->
name|fin_icode
operator|=
name|old
operator|->
name|fin_icode
expr_stmt|;
name|fin
operator|->
name|fin_rule
operator|=
name|old
operator|->
name|fin_rule
expr_stmt|;
name|bcopy
argument_list|(
name|old
operator|->
name|fin_group
argument_list|,
name|fin
operator|->
name|fin_group
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|fin_group
argument_list|)
argument_list|)
expr_stmt|;
name|fin
operator|->
name|fin_fr
operator|=
name|old
operator|->
name|fin_fr
expr_stmt|;
name|fin
operator|->
name|fin_dp
operator|=
name|old
operator|->
name|fin_dp
expr_stmt|;
name|fin
operator|->
name|fin_dlen
operator|=
name|old
operator|->
name|fin_dlen
expr_stmt|;
name|fin
operator|->
name|fin_plen
operator|=
name|old
operator|->
name|fin_plen
expr_stmt|;
name|fin
operator|->
name|fin_ipoff
operator|=
name|old
operator|->
name|fin_ipoff
expr_stmt|;
name|fin
operator|->
name|fin_id
operator|=
name|old
operator|->
name|fin_id
expr_stmt|;
name|fin
operator|->
name|fin_off
operator|=
name|old
operator|->
name|fin_off
expr_stmt|;
name|fin
operator|->
name|fin_depth
operator|=
name|old
operator|->
name|fin_depth
expr_stmt|;
name|fin
operator|->
name|fin_error
operator|=
name|old
operator|->
name|fin_error
expr_stmt|;
name|fin
operator|->
name|fin_nattag
operator|=
name|old
operator|->
name|fin_nattag
expr_stmt|;
name|fin
operator|->
name|fin_ip
operator|=
name|old
operator|->
name|ofin_ip
expr_stmt|;
name|fin
operator|->
name|fin_mp
operator|=
name|old
operator|->
name|fin_mp
expr_stmt|;
name|fin
operator|->
name|fin_m
operator|=
name|old
operator|->
name|fin_m
expr_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|fin
operator|->
name|fin_qfm
operator|=
name|old
operator|->
name|fin_qfm
expr_stmt|;
name|fin
operator|->
name|fin_qpi
operator|=
name|old
operator|->
name|fin_qpi
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|__sgi
name|fin
operator|->
name|fin_hbuf
operator|=
name|fin
operator|->
name|fin_hbuf
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|nat_4_1_3_to_current
parameter_list|(
name|nat_4_1_3_t
modifier|*
name|old
parameter_list|,
name|nat_t
modifier|*
name|current
parameter_list|)
block|{
name|bzero
argument_list|(
operator|(
name|void
operator|*
operator|)
name|current
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|current
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|(
name|void
operator|*
operator|)
name|old
argument_list|,
operator|(
name|void
operator|*
operator|)
name|current
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|nat_4_1_14_to_current
parameter_list|(
name|nat_4_1_14_t
modifier|*
name|old
parameter_list|,
name|nat_t
modifier|*
name|current
parameter_list|)
block|{
name|bzero
argument_list|(
operator|(
name|void
operator|*
operator|)
name|current
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|current
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|(
name|void
operator|*
operator|)
name|old
argument_list|,
operator|(
name|void
operator|*
operator|)
name|current
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|nat_save_4_1_16_to_current
parameter_list|(
name|softc
parameter_list|,
name|old
parameter_list|,
name|current
parameter_list|)
name|ipf_main_softc_t
modifier|*
name|softc
decl_stmt|;
name|nat_save_4_1_16_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
block|{
name|nat_save_t
modifier|*
name|nats
init|=
operator|(
name|nat_save_t
operator|*
operator|)
name|current
decl_stmt|;
name|nats
operator|->
name|ipn_next
operator|=
name|old
operator|->
name|ipn_next
expr_stmt|;
name|nat_4_1_14_to_current
argument_list|(
operator|&
name|old
operator|->
name|ipn_nat
argument_list|,
operator|&
name|nats
operator|->
name|ipn_nat
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|ipn_ipnat
argument_list|,
operator|&
name|nats
operator|->
name|ipn_ipnat
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|ipn_ipnat
argument_list|)
argument_list|)
expr_stmt|;
name|frentry_4_1_16_to_current
argument_list|(
name|softc
argument_list|,
operator|&
name|old
operator|->
name|ipn_fr
argument_list|,
operator|&
name|nats
operator|->
name|ipn_fr
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|nats
operator|->
name|ipn_dsize
operator|=
name|old
operator|->
name|ipn_dsize
expr_stmt|;
name|bcopy
argument_list|(
name|old
operator|->
name|ipn_data
argument_list|,
name|nats
operator|->
name|ipn_data
argument_list|,
sizeof|sizeof
argument_list|(
name|nats
operator|->
name|ipn_data
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|nat_save_4_1_14_to_current
parameter_list|(
name|softc
parameter_list|,
name|old
parameter_list|,
name|current
parameter_list|)
name|ipf_main_softc_t
modifier|*
name|softc
decl_stmt|;
name|nat_save_4_1_14_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
block|{
name|nat_save_t
modifier|*
name|nats
init|=
operator|(
name|nat_save_t
operator|*
operator|)
name|current
decl_stmt|;
name|nats
operator|->
name|ipn_next
operator|=
name|old
operator|->
name|ipn_next
expr_stmt|;
name|nat_4_1_14_to_current
argument_list|(
operator|&
name|old
operator|->
name|ipn_nat
argument_list|,
operator|&
name|nats
operator|->
name|ipn_nat
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|old
operator|->
name|ipn_ipnat
argument_list|,
operator|&
name|nats
operator|->
name|ipn_ipnat
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|ipn_ipnat
argument_list|)
argument_list|)
expr_stmt|;
name|frentry_4_1_0_to_current
argument_list|(
name|softc
argument_list|,
operator|&
name|old
operator|->
name|ipn_fr
argument_list|,
operator|&
name|nats
operator|->
name|ipn_fr
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|nats
operator|->
name|ipn_dsize
operator|=
name|old
operator|->
name|ipn_dsize
expr_stmt|;
name|bcopy
argument_list|(
name|old
operator|->
name|ipn_data
argument_list|,
name|nats
operator|->
name|ipn_data
argument_list|,
sizeof|sizeof
argument_list|(
name|nats
operator|->
name|ipn_data
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|nat_save_4_1_3_to_current
parameter_list|(
name|softc
parameter_list|,
name|old
parameter_list|,
name|current
parameter_list|)
name|ipf_main_softc_t
modifier|*
name|softc
decl_stmt|;
name|nat_save_4_1_3_t
modifier|*
name|old
decl_stmt|;
name|void
modifier|*
name|current
decl_stmt|;
block|{
name|nat_save_t
modifier|*
name|nats
init|=
operator|(
name|nat_save_t
operator|*
operator|)
name|current
decl_stmt|;
name|nats
operator|->
name|ipn_next
operator|=
name|old
operator|->
name|ipn_next
expr_stmt|;
name|nat_4_1_3_to_current
argument_list|(
operator|&
name|old
operator|->
name|ipn_nat
argument_list|,
operator|&
name|nats
operator|->
name|ipn_nat
argument_list|)
expr_stmt|;
name|ipnat_4_1_0_to_current
argument_list|(
operator|&
name|old
operator|->
name|ipn_ipnat
argument_list|,
operator|&
name|nats
operator|->
name|ipn_ipnat
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|frentry_4_1_0_to_current
argument_list|(
name|softc
argument_list|,
operator|&
name|old
operator|->
name|ipn_fr
argument_list|,
operator|&
name|nats
operator|->
name|ipn_fr
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|nats
operator|->
name|ipn_dsize
operator|=
name|old
operator|->
name|ipn_dsize
expr_stmt|;
name|bcopy
argument_list|(
name|old
operator|->
name|ipn_data
argument_list|,
name|nats
operator|->
name|ipn_data
argument_list|,
sizeof|sizeof
argument_list|(
name|nats
operator|->
name|ipn_data
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|natstat_current_to_4_1_32
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|natstat_4_1_32_t
modifier|*
name|old
decl_stmt|;
block|{
name|natstat_t
modifier|*
name|ns
init|=
operator|(
name|natstat_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|ns_mapped
index|[
literal|0
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_translated
expr_stmt|;
name|old
operator|->
name|ns_mapped
index|[
literal|1
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_translated
expr_stmt|;
name|old
operator|->
name|ns_rules
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_inuse
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_inuse
expr_stmt|;
name|old
operator|->
name|ns_added
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_added
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_added
expr_stmt|;
name|old
operator|->
name|ns_expire
operator|=
name|ns
operator|->
name|ns_expire
expr_stmt|;
name|old
operator|->
name|ns_inuse
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_inuse
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_inuse
expr_stmt|;
name|old
operator|->
name|ns_logged
operator|=
name|ns
operator|->
name|ns_log_ok
expr_stmt|;
name|old
operator|->
name|ns_logfail
operator|=
name|ns
operator|->
name|ns_log_fail
expr_stmt|;
name|old
operator|->
name|ns_memfail
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_memfail
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_memfail
expr_stmt|;
name|old
operator|->
name|ns_badnat
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_badnat
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_badnat
expr_stmt|;
name|old
operator|->
name|ns_addtrpnt
operator|=
name|ns
operator|->
name|ns_addtrpnt
expr_stmt|;
name|old
operator|->
name|ns_table
index|[
literal|0
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_table
expr_stmt|;
name|old
operator|->
name|ns_table
index|[
literal|1
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_table
expr_stmt|;
name|old
operator|->
name|ns_maptable
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|ns_list
operator|=
name|ns
operator|->
name|ns_list
expr_stmt|;
name|old
operator|->
name|ns_apslist
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|ns_wilds
operator|=
name|ns
operator|->
name|ns_wilds
expr_stmt|;
name|old
operator|->
name|ns_nattab_sz
operator|=
name|ns
operator|->
name|ns_nattab_sz
expr_stmt|;
name|old
operator|->
name|ns_nattab_max
operator|=
name|ns
operator|->
name|ns_nattab_max
expr_stmt|;
name|old
operator|->
name|ns_rultab_sz
operator|=
name|ns
operator|->
name|ns_rultab_sz
expr_stmt|;
name|old
operator|->
name|ns_rdrtab_sz
operator|=
name|ns
operator|->
name|ns_rdrtab_sz
expr_stmt|;
name|old
operator|->
name|ns_trpntab_sz
operator|=
name|ns
operator|->
name|ns_trpntab_sz
expr_stmt|;
name|old
operator|->
name|ns_hostmap_sz
operator|=
literal|0
expr_stmt|;
name|old
operator|->
name|ns_instances
operator|=
name|ns
operator|->
name|ns_instances
expr_stmt|;
name|old
operator|->
name|ns_maplist
operator|=
name|ns
operator|->
name|ns_maplist
expr_stmt|;
name|old
operator|->
name|ns_bucketlen
index|[
literal|0
index|]
operator|=
operator|(
name|u_long
operator|*
operator|)
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_bucketlen
expr_stmt|;
name|old
operator|->
name|ns_bucketlen
index|[
literal|1
index|]
operator|=
operator|(
name|u_long
operator|*
operator|)
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_bucketlen
expr_stmt|;
name|old
operator|->
name|ns_ticks
operator|=
name|ns
operator|->
name|ns_ticks
expr_stmt|;
name|old
operator|->
name|ns_orphans
operator|=
name|ns
operator|->
name|ns_orphans
expr_stmt|;
name|old
operator|->
name|ns_uncreate
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_uncreate
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|ns_uncreate
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_uncreate
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|ns_uncreate
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_uncreate
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|ns_uncreate
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_uncreate
index|[
literal|1
index|]
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|natstat_current_to_4_1_27
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|natstat_4_1_27_t
modifier|*
name|old
decl_stmt|;
block|{
name|natstat_t
modifier|*
name|ns
init|=
operator|(
name|natstat_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|ns_mapped
index|[
literal|0
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_translated
expr_stmt|;
name|old
operator|->
name|ns_mapped
index|[
literal|1
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_translated
expr_stmt|;
name|old
operator|->
name|ns_rules
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_inuse
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_inuse
expr_stmt|;
name|old
operator|->
name|ns_added
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_added
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_added
expr_stmt|;
name|old
operator|->
name|ns_expire
operator|=
name|ns
operator|->
name|ns_expire
expr_stmt|;
name|old
operator|->
name|ns_inuse
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_inuse
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_inuse
expr_stmt|;
name|old
operator|->
name|ns_logged
operator|=
name|ns
operator|->
name|ns_log_ok
expr_stmt|;
name|old
operator|->
name|ns_logfail
operator|=
name|ns
operator|->
name|ns_log_fail
expr_stmt|;
name|old
operator|->
name|ns_memfail
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_memfail
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_memfail
expr_stmt|;
name|old
operator|->
name|ns_badnat
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_badnat
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_badnat
expr_stmt|;
name|old
operator|->
name|ns_addtrpnt
operator|=
name|ns
operator|->
name|ns_addtrpnt
expr_stmt|;
name|old
operator|->
name|ns_table
index|[
literal|0
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_table
expr_stmt|;
name|old
operator|->
name|ns_table
index|[
literal|1
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_table
expr_stmt|;
name|old
operator|->
name|ns_maptable
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|ns_list
operator|=
name|ns
operator|->
name|ns_list
expr_stmt|;
name|old
operator|->
name|ns_apslist
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|ns_wilds
operator|=
name|ns
operator|->
name|ns_wilds
expr_stmt|;
name|old
operator|->
name|ns_nattab_sz
operator|=
name|ns
operator|->
name|ns_nattab_sz
expr_stmt|;
name|old
operator|->
name|ns_nattab_max
operator|=
name|ns
operator|->
name|ns_nattab_max
expr_stmt|;
name|old
operator|->
name|ns_rultab_sz
operator|=
name|ns
operator|->
name|ns_rultab_sz
expr_stmt|;
name|old
operator|->
name|ns_rdrtab_sz
operator|=
name|ns
operator|->
name|ns_rdrtab_sz
expr_stmt|;
name|old
operator|->
name|ns_trpntab_sz
operator|=
name|ns
operator|->
name|ns_trpntab_sz
expr_stmt|;
name|old
operator|->
name|ns_hostmap_sz
operator|=
literal|0
expr_stmt|;
name|old
operator|->
name|ns_instances
operator|=
name|ns
operator|->
name|ns_instances
expr_stmt|;
name|old
operator|->
name|ns_maplist
operator|=
name|ns
operator|->
name|ns_maplist
expr_stmt|;
name|old
operator|->
name|ns_bucketlen
index|[
literal|0
index|]
operator|=
operator|(
name|u_long
operator|*
operator|)
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_bucketlen
expr_stmt|;
name|old
operator|->
name|ns_bucketlen
index|[
literal|1
index|]
operator|=
operator|(
name|u_long
operator|*
operator|)
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_bucketlen
expr_stmt|;
name|old
operator|->
name|ns_ticks
operator|=
name|ns
operator|->
name|ns_ticks
expr_stmt|;
name|old
operator|->
name|ns_orphans
operator|=
name|ns
operator|->
name|ns_orphans
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|natstat_current_to_4_1_16
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|natstat_4_1_16_t
modifier|*
name|old
decl_stmt|;
block|{
name|natstat_t
modifier|*
name|ns
init|=
operator|(
name|natstat_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|ns_mapped
index|[
literal|0
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_translated
expr_stmt|;
name|old
operator|->
name|ns_mapped
index|[
literal|1
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_translated
expr_stmt|;
name|old
operator|->
name|ns_rules
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_inuse
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_inuse
expr_stmt|;
name|old
operator|->
name|ns_added
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_added
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_added
expr_stmt|;
name|old
operator|->
name|ns_expire
operator|=
name|ns
operator|->
name|ns_expire
expr_stmt|;
name|old
operator|->
name|ns_inuse
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_inuse
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_inuse
expr_stmt|;
name|old
operator|->
name|ns_logged
operator|=
name|ns
operator|->
name|ns_log_ok
expr_stmt|;
name|old
operator|->
name|ns_logfail
operator|=
name|ns
operator|->
name|ns_log_fail
expr_stmt|;
name|old
operator|->
name|ns_memfail
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_memfail
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_memfail
expr_stmt|;
name|old
operator|->
name|ns_badnat
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_badnat
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_badnat
expr_stmt|;
name|old
operator|->
name|ns_addtrpnt
operator|=
name|ns
operator|->
name|ns_addtrpnt
expr_stmt|;
name|old
operator|->
name|ns_table
index|[
literal|0
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_table
expr_stmt|;
name|old
operator|->
name|ns_table
index|[
literal|1
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_table
expr_stmt|;
name|old
operator|->
name|ns_maptable
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|ns_list
operator|=
name|ns
operator|->
name|ns_list
expr_stmt|;
name|old
operator|->
name|ns_apslist
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|ns_wilds
operator|=
name|ns
operator|->
name|ns_wilds
expr_stmt|;
name|old
operator|->
name|ns_nattab_sz
operator|=
name|ns
operator|->
name|ns_nattab_sz
expr_stmt|;
name|old
operator|->
name|ns_nattab_max
operator|=
name|ns
operator|->
name|ns_nattab_max
expr_stmt|;
name|old
operator|->
name|ns_rultab_sz
operator|=
name|ns
operator|->
name|ns_rultab_sz
expr_stmt|;
name|old
operator|->
name|ns_rdrtab_sz
operator|=
name|ns
operator|->
name|ns_rdrtab_sz
expr_stmt|;
name|old
operator|->
name|ns_trpntab_sz
operator|=
name|ns
operator|->
name|ns_trpntab_sz
expr_stmt|;
name|old
operator|->
name|ns_hostmap_sz
operator|=
literal|0
expr_stmt|;
name|old
operator|->
name|ns_instances
operator|=
name|ns
operator|->
name|ns_instances
expr_stmt|;
name|old
operator|->
name|ns_maplist
operator|=
name|ns
operator|->
name|ns_maplist
expr_stmt|;
name|old
operator|->
name|ns_bucketlen
index|[
literal|0
index|]
operator|=
operator|(
name|u_long
operator|*
operator|)
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_bucketlen
expr_stmt|;
name|old
operator|->
name|ns_bucketlen
index|[
literal|1
index|]
operator|=
operator|(
name|u_long
operator|*
operator|)
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_bucketlen
expr_stmt|;
name|old
operator|->
name|ns_ticks
operator|=
name|ns
operator|->
name|ns_ticks
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|natstat_current_to_4_1_0
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|natstat_4_1_0_t
modifier|*
name|old
decl_stmt|;
block|{
name|natstat_t
modifier|*
name|ns
init|=
operator|(
name|natstat_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|ns_mapped
index|[
literal|0
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_translated
expr_stmt|;
name|old
operator|->
name|ns_mapped
index|[
literal|1
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_translated
expr_stmt|;
name|old
operator|->
name|ns_rules
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_inuse
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_inuse
expr_stmt|;
name|old
operator|->
name|ns_added
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_added
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_added
expr_stmt|;
name|old
operator|->
name|ns_expire
operator|=
name|ns
operator|->
name|ns_expire
expr_stmt|;
name|old
operator|->
name|ns_inuse
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_inuse
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_inuse
expr_stmt|;
name|old
operator|->
name|ns_logged
operator|=
name|ns
operator|->
name|ns_log_ok
expr_stmt|;
name|old
operator|->
name|ns_logfail
operator|=
name|ns
operator|->
name|ns_log_fail
expr_stmt|;
name|old
operator|->
name|ns_memfail
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_memfail
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_memfail
expr_stmt|;
name|old
operator|->
name|ns_badnat
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_badnat
operator|+
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_badnat
expr_stmt|;
name|old
operator|->
name|ns_addtrpnt
operator|=
name|ns
operator|->
name|ns_addtrpnt
expr_stmt|;
name|old
operator|->
name|ns_table
index|[
literal|0
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_table
expr_stmt|;
name|old
operator|->
name|ns_table
index|[
literal|1
index|]
operator|=
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_table
expr_stmt|;
name|old
operator|->
name|ns_maptable
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|ns_list
operator|=
name|ns
operator|->
name|ns_list
expr_stmt|;
name|old
operator|->
name|ns_apslist
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|ns_wilds
operator|=
name|ns
operator|->
name|ns_wilds
expr_stmt|;
name|old
operator|->
name|ns_nattab_sz
operator|=
name|ns
operator|->
name|ns_nattab_sz
expr_stmt|;
name|old
operator|->
name|ns_nattab_max
operator|=
name|ns
operator|->
name|ns_nattab_max
expr_stmt|;
name|old
operator|->
name|ns_rultab_sz
operator|=
name|ns
operator|->
name|ns_rultab_sz
expr_stmt|;
name|old
operator|->
name|ns_rdrtab_sz
operator|=
name|ns
operator|->
name|ns_rdrtab_sz
expr_stmt|;
name|old
operator|->
name|ns_trpntab_sz
operator|=
name|ns
operator|->
name|ns_trpntab_sz
expr_stmt|;
name|old
operator|->
name|ns_hostmap_sz
operator|=
literal|0
expr_stmt|;
name|old
operator|->
name|ns_instances
operator|=
name|ns
operator|->
name|ns_instances
expr_stmt|;
name|old
operator|->
name|ns_maplist
operator|=
name|ns
operator|->
name|ns_maplist
expr_stmt|;
name|old
operator|->
name|ns_bucketlen
index|[
literal|0
index|]
operator|=
operator|(
name|u_long
operator|*
operator|)
name|ns
operator|->
name|ns_side
index|[
literal|0
index|]
operator|.
name|ns_bucketlen
expr_stmt|;
name|old
operator|->
name|ns_bucketlen
index|[
literal|1
index|]
operator|=
operator|(
name|u_long
operator|*
operator|)
name|ns
operator|->
name|ns_side
index|[
literal|1
index|]
operator|.
name|ns_bucketlen
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|ipstate_save_current_to_4_1_16
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|ipstate_save_4_1_16_t
modifier|*
name|old
decl_stmt|;
block|{
name|ipstate_save_t
modifier|*
name|ips
init|=
operator|(
name|ipstate_save_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|ips_next
operator|=
name|ips
operator|->
name|ips_next
expr_stmt|;
name|ipstate_current_to_4_1_0
argument_list|(
operator|&
name|ips
operator|->
name|ips_is
argument_list|,
operator|&
name|old
operator|->
name|ips_is
argument_list|)
expr_stmt|;
name|frentry_current_to_4_1_16
argument_list|(
operator|&
name|ips
operator|->
name|ips_fr
argument_list|,
operator|&
name|old
operator|->
name|ips_fr
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|ipstate_save_current_to_4_1_0
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|ipstate_save_4_1_0_t
modifier|*
name|old
decl_stmt|;
block|{
name|ipstate_save_t
modifier|*
name|ips
init|=
operator|(
name|ipstate_save_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|ips_next
operator|=
name|ips
operator|->
name|ips_next
expr_stmt|;
name|ipstate_current_to_4_1_0
argument_list|(
operator|&
name|ips
operator|->
name|ips_is
argument_list|,
operator|&
name|old
operator|->
name|ips_is
argument_list|)
expr_stmt|;
name|frentry_current_to_4_1_0
argument_list|(
operator|&
name|ips
operator|->
name|ips_fr
argument_list|,
operator|&
name|old
operator|->
name|ips_fr
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|int
name|ipf_out_compat
parameter_list|(
name|softc
parameter_list|,
name|obj
parameter_list|,
name|ptr
parameter_list|)
name|ipf_main_softc_t
modifier|*
name|softc
decl_stmt|;
name|ipfobj_t
modifier|*
name|obj
decl_stmt|;
name|void
modifier|*
name|ptr
decl_stmt|;
block|{
name|frentry_t
modifier|*
name|fr
decl_stmt|;
name|int
name|error
decl_stmt|;
name|IPFERROR
argument_list|(
literal|140042
argument_list|)
expr_stmt|;
name|error
operator|=
name|EINVAL
expr_stmt|;
switch|switch
condition|(
name|obj
operator|->
name|ipfo_type
condition|)
block|{
default|default :
break|break;
case|case
name|IPFOBJ_FRENTRY
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4013400
condition|)
block|{
name|frentry_4_1_34_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|frentry_4_1_34_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140043
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|frentry_current_to_4_1_34
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|==
literal|0
operator|&&
name|old
operator|->
name|fr_dsize
operator|>
literal|0
condition|)
block|{
name|char
modifier|*
name|dst
init|=
name|obj
operator|->
name|ipfo_ptr
decl_stmt|;
name|fr
operator|=
name|ptr
expr_stmt|;
name|dst
operator|+=
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|fr
operator|->
name|fr_data
argument_list|,
name|dst
argument_list|,
name|old
operator|->
name|fr_dsize
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140044
argument_list|)
expr_stmt|;
block|}
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
name|obj
operator|->
name|ipfo_size
operator|=
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4011600
condition|)
block|{
name|frentry_4_1_16_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|frentry_4_1_16_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140045
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|frentry_current_to_4_1_16
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140046
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
name|obj
operator|->
name|ipfo_size
operator|=
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|frentry_4_1_0_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|frentry_4_1_0_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140047
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|frentry_current_to_4_1_0
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140048
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
name|obj
operator|->
name|ipfo_size
operator|=
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|IPFOBJ_IPFSTAT
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4013300
condition|)
block|{
name|friostat_4_1_33_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|friostat_4_1_33_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140049
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|friostat_current_to_4_1_33
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|,
name|obj
operator|->
name|ipfo_rev
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140050
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|friostat_4_1_0_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|friostat_4_1_0_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140051
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|friostat_current_to_4_1_0
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|,
name|obj
operator|->
name|ipfo_rev
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140052
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|IPFOBJ_IPFINFO
case|:
comment|/* unused */
break|break;
case|case
name|IPFOBJ_IPNAT
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4011400
condition|)
block|{
name|ipnat_4_1_14_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|ipnat_4_1_14_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140053
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|ipnat_current_to_4_1_14
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140054
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|ipnat_4_1_0_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|ipnat_4_1_0_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140055
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|ipnat_current_to_4_1_0
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140056
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|IPFOBJ_NATSTAT
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4013200
condition|)
block|{
name|natstat_4_1_32_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|natstat_4_1_32_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140057
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|natstat_current_to_4_1_32
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140058
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4012700
condition|)
block|{
name|natstat_4_1_27_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|natstat_4_1_27_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140059
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|natstat_current_to_4_1_27
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140060
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4011600
condition|)
block|{
name|natstat_4_1_16_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|natstat_4_1_16_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140061
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|natstat_current_to_4_1_16
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140062
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|natstat_4_1_0_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|natstat_4_1_0_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140063
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|natstat_current_to_4_1_0
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140064
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|IPFOBJ_STATESAVE
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4011600
condition|)
block|{
name|ipstate_save_4_1_16_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|ipstate_save_4_1_16_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140065
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|ipstate_save_current_to_4_1_16
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140066
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|ipstate_save_4_1_0_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|ipstate_save_4_1_0_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140067
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|ipstate_save_current_to_4_1_0
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140068
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|IPFOBJ_NATSAVE
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4011600
condition|)
block|{
name|nat_save_4_1_16_t
modifier|*
name|old16
decl_stmt|;
name|KMALLOC
argument_list|(
name|old16
argument_list|,
name|nat_save_4_1_16_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old16
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140069
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|nat_save_current_to_4_1_16
argument_list|(
name|ptr
argument_list|,
name|old16
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
operator|&
name|old16
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old16
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140070
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old16
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4011400
condition|)
block|{
name|nat_save_4_1_14_t
modifier|*
name|old14
decl_stmt|;
name|KMALLOC
argument_list|(
name|old14
argument_list|,
name|nat_save_4_1_14_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old14
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140071
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|nat_save_current_to_4_1_14
argument_list|(
name|ptr
argument_list|,
name|old14
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
operator|&
name|old14
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old14
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140072
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old14
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4010300
condition|)
block|{
name|nat_save_4_1_3_t
modifier|*
name|old3
decl_stmt|;
name|KMALLOC
argument_list|(
name|old3
argument_list|,
name|nat_save_4_1_3_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old3
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140073
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|nat_save_current_to_4_1_3
argument_list|(
name|ptr
argument_list|,
name|old3
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
operator|&
name|old3
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old3
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140074
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old3
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|IPFOBJ_IPSTATE
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4011600
condition|)
block|{
name|ipstate_4_1_16_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|ipstate_4_1_16_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140075
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|ipstate_current_to_4_1_16
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140076
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|ipstate_4_1_0_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|ipstate_4_1_0_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140077
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|ipstate_current_to_4_1_0
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140078
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|IPFOBJ_STATESTAT
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4012100
condition|)
block|{
name|ips_stat_4_1_21_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|ips_stat_4_1_21_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140079
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|ips_stat_current_to_4_1_21
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140080
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|ips_stat_4_1_0_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|ips_stat_4_1_0_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140081
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|ips_stat_current_to_4_1_0
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140082
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|IPFOBJ_FRAUTH
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4012900
condition|)
block|{
name|frauth_4_1_29_t
modifier|*
name|old29
decl_stmt|;
name|KMALLOC
argument_list|(
name|old29
argument_list|,
name|frauth_4_1_29_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old29
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140083
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|frauth_current_to_4_1_29
argument_list|(
name|ptr
argument_list|,
name|old29
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old29
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old29
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140084
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old29
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4012400
condition|)
block|{
name|frauth_4_1_24_t
modifier|*
name|old24
decl_stmt|;
name|KMALLOC
argument_list|(
name|old24
argument_list|,
name|frauth_4_1_24_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old24
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140085
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|frauth_current_to_4_1_24
argument_list|(
name|ptr
argument_list|,
name|old24
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old24
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old24
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140086
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old24
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4012300
condition|)
block|{
name|frauth_4_1_23_t
modifier|*
name|old23
decl_stmt|;
name|KMALLOC
argument_list|(
name|old23
argument_list|,
name|frauth_4_1_23_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old23
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140087
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|frauth_current_to_4_1_23
argument_list|(
name|ptr
argument_list|,
name|old23
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old23
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old23
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140088
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old23
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4011100
condition|)
block|{
name|frauth_4_1_11_t
modifier|*
name|old11
decl_stmt|;
name|KMALLOC
argument_list|(
name|old11
argument_list|,
name|frauth_4_1_11_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old11
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140089
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|frauth_current_to_4_1_11
argument_list|(
name|ptr
argument_list|,
name|old11
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old11
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old11
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140090
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old11
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|IPFOBJ_NAT
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4012500
condition|)
block|{
name|nat_4_1_25_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|nat_4_1_25_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140091
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|nat_current_to_4_1_25
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140092
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4011400
condition|)
block|{
name|nat_4_1_14_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|nat_4_1_14_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140093
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|nat_current_to_4_1_14
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140094
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|>=
literal|4010300
condition|)
block|{
name|nat_4_1_3_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|nat_4_1_3_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140095
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|nat_current_to_4_1_3
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140096
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|IPFOBJ_FRIPF
case|:
if|if
condition|(
name|obj
operator|->
name|ipfo_rev
operator|<
literal|5000000
condition|)
block|{
name|fripf4_t
modifier|*
name|old
decl_stmt|;
name|KMALLOC
argument_list|(
name|old
argument_list|,
name|fripf4_t
operator|*
argument_list|)
expr_stmt|;
if|if
condition|(
name|old
operator|==
name|NULL
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140097
argument_list|)
expr_stmt|;
name|error
operator|=
name|ENOMEM
expr_stmt|;
break|break;
block|}
name|ipf_v5fripftov4
argument_list|(
name|ptr
argument_list|,
name|old
argument_list|)
expr_stmt|;
name|error
operator|=
name|COPYOUT
argument_list|(
name|old
argument_list|,
name|obj
operator|->
name|ipfo_ptr
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|old
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|error
operator|!=
literal|0
condition|)
block|{
name|IPFERROR
argument_list|(
literal|140098
argument_list|)
expr_stmt|;
block|}
name|KFREE
argument_list|(
name|old
argument_list|)
expr_stmt|;
block|}
break|break;
block|}
return|return
name|error
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|friostat_current_to_4_1_33
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|,
name|rev
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|friostat_4_1_33_t
modifier|*
name|old
decl_stmt|;
name|int
name|rev
decl_stmt|;
block|{
name|friostat_t
modifier|*
name|fiop
init|=
operator|(
name|friostat_t
operator|*
operator|)
name|current
decl_stmt|;
name|bcopy
argument_list|(
operator|&
name|fiop
operator|->
name|f_st
index|[
literal|0
index|]
operator|.
name|fr_pass
argument_list|,
operator|&
name|old
operator|->
name|of_st
index|[
literal|0
index|]
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|of_st
index|[
literal|0
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|fiop
operator|->
name|f_st
index|[
literal|1
index|]
operator|.
name|fr_pass
argument_list|,
operator|&
name|old
operator|->
name|of_st
index|[
literal|1
index|]
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|of_st
index|[
literal|1
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|old
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|fiop
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|fiop
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|fiop
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|fiop
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|fiop
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|fiop
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|fiop
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|fiop
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|f_ipf6
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_ipf6
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_ipf6
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_ipf6
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_acct6
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_acct6
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_acct6
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_acct6
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_auth
operator|=
name|fiop
operator|->
name|f_auth
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|fiop
operator|->
name|f_groups
argument_list|,
operator|&
name|old
operator|->
name|f_groups
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|f_groups
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|fiop
operator|->
name|f_froute
argument_list|,
operator|&
name|old
operator|->
name|f_froute
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|f_froute
argument_list|)
argument_list|)
expr_stmt|;
name|old
operator|->
name|f_ticks
operator|=
name|fiop
operator|->
name|f_ticks
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|fiop
operator|->
name|f_locks
argument_list|,
operator|&
name|old
operator|->
name|f_locks
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|f_locks
argument_list|)
argument_list|)
expr_stmt|;
name|old
operator|->
name|f_kmutex_sz
operator|=
literal|0
expr_stmt|;
name|old
operator|->
name|f_krwlock_sz
operator|=
literal|0
expr_stmt|;
name|old
operator|->
name|f_defpass
operator|=
name|fiop
operator|->
name|f_defpass
expr_stmt|;
name|old
operator|->
name|f_active
operator|=
name|fiop
operator|->
name|f_active
expr_stmt|;
name|old
operator|->
name|f_running
operator|=
name|fiop
operator|->
name|f_running
expr_stmt|;
name|old
operator|->
name|f_logging
operator|=
name|fiop
operator|->
name|f_logging
expr_stmt|;
name|old
operator|->
name|f_features
operator|=
name|fiop
operator|->
name|f_features
expr_stmt|;
name|sprintf
argument_list|(
name|old
operator|->
name|f_version
argument_list|,
literal|"IP Filter: v%d.%d.%d"
argument_list|,
operator|(
name|rev
operator|/
literal|1000000
operator|)
operator|%
literal|100
argument_list|,
operator|(
name|rev
operator|/
literal|10000
operator|)
operator|%
literal|100
argument_list|,
operator|(
name|rev
operator|/
literal|100
operator|)
operator|%
literal|100
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|friostat_current_to_4_1_0
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|,
name|rev
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|friostat_4_1_0_t
modifier|*
name|old
decl_stmt|;
name|int
name|rev
decl_stmt|;
block|{
name|friostat_t
modifier|*
name|fiop
init|=
operator|(
name|friostat_t
operator|*
operator|)
name|current
decl_stmt|;
name|bcopy
argument_list|(
operator|&
name|fiop
operator|->
name|f_st
index|[
literal|0
index|]
operator|.
name|fr_pass
argument_list|,
operator|&
name|old
operator|->
name|of_st
index|[
literal|0
index|]
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|of_st
index|[
literal|0
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|fiop
operator|->
name|f_st
index|[
literal|1
index|]
operator|.
name|fr_pass
argument_list|,
operator|&
name|old
operator|->
name|of_st
index|[
literal|1
index|]
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|of_st
index|[
literal|1
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|old
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|fiop
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|fiop
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|fiop
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|fiop
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|fiop
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|fiop
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|fiop
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|fiop
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|f_ipf6
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_ipf6
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_ipf6
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_ipf6
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_acct6
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_acct6
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_acct6
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_acct6
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_auth
operator|=
name|fiop
operator|->
name|f_auth
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|fiop
operator|->
name|f_groups
argument_list|,
operator|&
name|old
operator|->
name|f_groups
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|f_groups
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|fiop
operator|->
name|f_froute
argument_list|,
operator|&
name|old
operator|->
name|f_froute
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|f_froute
argument_list|)
argument_list|)
expr_stmt|;
name|old
operator|->
name|f_ticks
operator|=
name|fiop
operator|->
name|f_ticks
expr_stmt|;
name|old
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|fiop
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|fiop
operator|->
name|f_ipf
index|[
literal|0
index|]
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|fiop
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|fiop
operator|->
name|f_ipf
index|[
literal|1
index|]
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|fiop
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|fiop
operator|->
name|f_acct
index|[
literal|0
index|]
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|fiop
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|fiop
operator|->
name|f_acct
index|[
literal|1
index|]
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|f_ipf6
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_ipf6
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_ipf6
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_ipf6
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_acct6
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_acct6
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_acct6
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_acct6
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|f_auth
operator|=
name|fiop
operator|->
name|f_auth
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|fiop
operator|->
name|f_groups
argument_list|,
operator|&
name|old
operator|->
name|f_groups
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|f_groups
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|fiop
operator|->
name|f_froute
argument_list|,
operator|&
name|old
operator|->
name|f_froute
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|f_froute
argument_list|)
argument_list|)
expr_stmt|;
name|old
operator|->
name|f_ticks
operator|=
name|fiop
operator|->
name|f_ticks
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|fiop
operator|->
name|f_locks
argument_list|,
operator|&
name|old
operator|->
name|f_locks
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|f_locks
argument_list|)
argument_list|)
expr_stmt|;
name|old
operator|->
name|f_kmutex_sz
operator|=
literal|0
expr_stmt|;
name|old
operator|->
name|f_krwlock_sz
operator|=
literal|0
expr_stmt|;
name|old
operator|->
name|f_defpass
operator|=
name|fiop
operator|->
name|f_defpass
expr_stmt|;
name|old
operator|->
name|f_active
operator|=
name|fiop
operator|->
name|f_active
expr_stmt|;
name|old
operator|->
name|f_running
operator|=
name|fiop
operator|->
name|f_running
expr_stmt|;
name|old
operator|->
name|f_logging
operator|=
name|fiop
operator|->
name|f_logging
expr_stmt|;
name|old
operator|->
name|f_features
operator|=
name|fiop
operator|->
name|f_features
expr_stmt|;
name|sprintf
argument_list|(
name|old
operator|->
name|f_version
argument_list|,
literal|"IP Filter: v%d.%d.%d"
argument_list|,
operator|(
name|rev
operator|/
literal|1000000
operator|)
operator|%
literal|100
argument_list|,
operator|(
name|rev
operator|/
literal|10000
operator|)
operator|%
literal|100
argument_list|,
operator|(
name|rev
operator|/
literal|100
operator|)
operator|%
literal|100
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * nflags is v5 flags, returns v4 flags.  */
end_comment

begin_function
specifier|static
name|int
name|fr_frflags5to4
parameter_list|(
name|nflags
parameter_list|)
name|u_32_t
name|nflags
decl_stmt|;
block|{
name|u_32_t
name|oflags
init|=
literal|0
decl_stmt|;
switch|switch
condition|(
name|nflags
operator|&
name|FR_CMDMASK
condition|)
block|{
case|case
name|FR_CALL
case|:
name|oflags
operator|=
literal|0x0
expr_stmt|;
break|break;
case|case
name|FR_BLOCK
case|:
name|oflags
operator|=
literal|0x1
expr_stmt|;
break|break;
case|case
name|FR_PASS
case|:
name|oflags
operator|=
literal|0x2
expr_stmt|;
break|break;
case|case
name|FR_AUTH
case|:
name|oflags
operator|=
literal|0x3
expr_stmt|;
break|break;
case|case
name|FR_PREAUTH
case|:
name|oflags
operator|=
literal|0x4
expr_stmt|;
break|break;
case|case
name|FR_ACCOUNT
case|:
name|oflags
operator|=
literal|0x5
expr_stmt|;
break|break;
case|case
name|FR_SKIP
case|:
name|oflags
operator|=
literal|0x6
expr_stmt|;
break|break;
default|default :
break|break;
block|}
if|if
condition|(
name|nflags
operator|&
name|FR_LOG
condition|)
name|oflags
operator||=
literal|0x00010
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_CALLNOW
condition|)
name|oflags
operator||=
literal|0x00020
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_NOTSRCIP
condition|)
name|oflags
operator||=
literal|0x00080
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_NOTDSTIP
condition|)
name|oflags
operator||=
literal|0x00040
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_QUICK
condition|)
name|oflags
operator||=
literal|0x00100
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_KEEPFRAG
condition|)
name|oflags
operator||=
literal|0x00200
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_KEEPSTATE
condition|)
name|oflags
operator||=
literal|0x00400
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_FASTROUTE
condition|)
name|oflags
operator||=
literal|0x00800
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_RETRST
condition|)
name|oflags
operator||=
literal|0x01000
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_RETICMP
condition|)
name|oflags
operator||=
literal|0x02000
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_FAKEICMP
condition|)
name|oflags
operator||=
literal|0x03000
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_OUTQUE
condition|)
name|oflags
operator||=
literal|0x04000
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_INQUE
condition|)
name|oflags
operator||=
literal|0x08000
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_LOGBODY
condition|)
name|oflags
operator||=
literal|0x10000
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_LOGFIRST
condition|)
name|oflags
operator||=
literal|0x20000
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_LOGORBLOCK
condition|)
name|oflags
operator||=
literal|0x40000
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_FRSTRICT
condition|)
name|oflags
operator||=
literal|0x100000
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_STSTRICT
condition|)
name|oflags
operator||=
literal|0x200000
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_NEWISN
condition|)
name|oflags
operator||=
literal|0x400000
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_NOICMPERR
condition|)
name|oflags
operator||=
literal|0x800000
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_STATESYNC
condition|)
name|oflags
operator||=
literal|0x1000000
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_NOMATCH
condition|)
name|oflags
operator||=
literal|0x8000000
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_COPIED
condition|)
name|oflags
operator||=
literal|0x40000000
expr_stmt|;
if|if
condition|(
name|nflags
operator|&
name|FR_INACTIVE
condition|)
name|oflags
operator||=
literal|0x80000000
expr_stmt|;
return|return
name|oflags
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|frentry_current_to_4_1_34
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|frentry_4_1_34_t
modifier|*
name|old
decl_stmt|;
block|{
name|frentry_t
modifier|*
name|fr
init|=
operator|(
name|frentry_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|fr_lock
operator|=
name|fr
operator|->
name|fr_lock
expr_stmt|;
name|old
operator|->
name|fr_next
operator|=
name|fr
operator|->
name|fr_next
expr_stmt|;
name|old
operator|->
name|fr_grp
operator|=
operator|(
name|void
operator|*
operator|)
name|fr
operator|->
name|fr_grp
expr_stmt|;
name|old
operator|->
name|fr_isc
operator|=
name|fr
operator|->
name|fr_isc
expr_stmt|;
name|old
operator|->
name|fr_ifas
index|[
literal|0
index|]
operator|=
name|fr
operator|->
name|fr_ifas
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|fr_ifas
index|[
literal|1
index|]
operator|=
name|fr
operator|->
name|fr_ifas
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|fr_ifas
index|[
literal|2
index|]
operator|=
name|fr
operator|->
name|fr_ifas
index|[
literal|2
index|]
expr_stmt|;
name|old
operator|->
name|fr_ifas
index|[
literal|3
index|]
operator|=
name|fr
operator|->
name|fr_ifas
index|[
literal|3
index|]
expr_stmt|;
name|old
operator|->
name|fr_ptr
operator|=
name|fr
operator|->
name|fr_ptr
expr_stmt|;
name|old
operator|->
name|fr_comment
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|fr_ref
operator|=
name|fr
operator|->
name|fr_ref
expr_stmt|;
name|old
operator|->
name|fr_statecnt
operator|=
name|fr
operator|->
name|fr_statecnt
expr_stmt|;
name|old
operator|->
name|fr_hits
operator|=
name|fr
operator|->
name|fr_hits
expr_stmt|;
name|old
operator|->
name|fr_bytes
operator|=
name|fr
operator|->
name|fr_bytes
expr_stmt|;
name|old
operator|->
name|fr_lastpkt
operator|.
name|tv_sec
operator|=
name|fr
operator|->
name|fr_lastpkt
operator|.
name|tv_sec
expr_stmt|;
name|old
operator|->
name|fr_lastpkt
operator|.
name|tv_usec
operator|=
name|fr
operator|->
name|fr_lastpkt
operator|.
name|tv_usec
expr_stmt|;
name|old
operator|->
name|fr_curpps
operator|=
name|fr
operator|->
name|fr_curpps
expr_stmt|;
name|old
operator|->
name|fr_dun
operator|.
name|fru_data
operator|=
name|fr
operator|->
name|fr_dun
operator|.
name|fru_data
expr_stmt|;
name|old
operator|->
name|fr_func
operator|=
name|fr
operator|->
name|fr_func
expr_stmt|;
name|old
operator|->
name|fr_dsize
operator|=
name|fr
operator|->
name|fr_dsize
expr_stmt|;
name|old
operator|->
name|fr_pps
operator|=
name|fr
operator|->
name|fr_pps
expr_stmt|;
name|old
operator|->
name|fr_statemax
operator|=
name|fr
operator|->
name|fr_statemax
expr_stmt|;
name|old
operator|->
name|fr_flineno
operator|=
name|fr
operator|->
name|fr_flineno
expr_stmt|;
name|old
operator|->
name|fr_type
operator|=
name|fr
operator|->
name|fr_type
expr_stmt|;
name|old
operator|->
name|fr_flags
operator|=
name|fr_frflags5to4
argument_list|(
name|fr
operator|->
name|fr_flags
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_logtag
operator|=
name|fr
operator|->
name|fr_logtag
expr_stmt|;
name|old
operator|->
name|fr_collect
operator|=
name|fr
operator|->
name|fr_collect
expr_stmt|;
name|old
operator|->
name|fr_arg
operator|=
name|fr
operator|->
name|fr_arg
expr_stmt|;
name|old
operator|->
name|fr_loglevel
operator|=
name|fr
operator|->
name|fr_loglevel
expr_stmt|;
name|old
operator|->
name|fr_age
index|[
literal|0
index|]
operator|=
name|fr
operator|->
name|fr_age
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|fr_age
index|[
literal|1
index|]
operator|=
name|fr
operator|->
name|fr_age
index|[
literal|1
index|]
expr_stmt|;
if|if
condition|(
name|fr
operator|->
name|fr_family
operator|==
name|AF_INET
condition|)
name|old
operator|->
name|fr_v
operator|=
literal|4
expr_stmt|;
if|if
condition|(
name|fr
operator|->
name|fr_family
operator|==
name|AF_INET6
condition|)
name|old
operator|->
name|fr_v
operator|=
literal|6
expr_stmt|;
name|old
operator|->
name|fr_icode
operator|=
name|fr
operator|->
name|fr_icode
expr_stmt|;
name|old
operator|->
name|fr_cksum
operator|=
name|fr
operator|->
name|fr_cksum
expr_stmt|;
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|ofd_ip6
operator|=
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ip6
expr_stmt|;
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|ofd_ip6
operator|=
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ip6
expr_stmt|;
name|old
operator|->
name|fr_dif
operator|.
name|ofd_ip6
operator|=
name|fr
operator|->
name|fr_dif
operator|.
name|fd_ip6
expr_stmt|;
if|if
condition|(
name|fr
operator|->
name|fr_ifnames
index|[
literal|0
index|]
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_ifnames
index|[
literal|0
index|]
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_ifnames
index|[
literal|0
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_ifnames
index|[
literal|0
index|]
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_ifnames
index|[
literal|1
index|]
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_ifnames
index|[
literal|1
index|]
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_ifnames
index|[
literal|1
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_ifnames
index|[
literal|1
index|]
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_ifnames
index|[
literal|2
index|]
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_ifnames
index|[
literal|2
index|]
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_ifnames
index|[
literal|2
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_ifnames
index|[
literal|2
index|]
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_ifnames
index|[
literal|3
index|]
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_ifnames
index|[
literal|3
index|]
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_ifnames
index|[
literal|3
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_ifnames
index|[
literal|3
index|]
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_name
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ifname
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_name
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ifname
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_name
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_ifname
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_name
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_ifname
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_dif
operator|.
name|fd_name
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_dif
operator|.
name|fd_ifname
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_dif
operator|.
name|fd_name
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_dif
operator|.
name|fd_ifname
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_group
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_group
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_group
argument_list|,
name|FR_GROUPLEN
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_group
index|[
name|FR_GROUPLEN
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_grhead
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_grhead
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_grhead
argument_list|,
name|FR_GROUPLEN
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_grhead
index|[
name|FR_GROUPLEN
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|frentry_current_to_4_1_16
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|frentry_4_1_16_t
modifier|*
name|old
decl_stmt|;
block|{
name|frentry_t
modifier|*
name|fr
init|=
operator|(
name|frentry_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|fr_lock
operator|=
name|fr
operator|->
name|fr_lock
expr_stmt|;
name|old
operator|->
name|fr_next
operator|=
name|fr
operator|->
name|fr_next
expr_stmt|;
name|old
operator|->
name|fr_grp
operator|=
operator|(
name|void
operator|*
operator|)
name|fr
operator|->
name|fr_grp
expr_stmt|;
name|old
operator|->
name|fr_isc
operator|=
name|fr
operator|->
name|fr_isc
expr_stmt|;
name|old
operator|->
name|fr_ifas
index|[
literal|0
index|]
operator|=
name|fr
operator|->
name|fr_ifas
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|fr_ifas
index|[
literal|1
index|]
operator|=
name|fr
operator|->
name|fr_ifas
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|fr_ifas
index|[
literal|2
index|]
operator|=
name|fr
operator|->
name|fr_ifas
index|[
literal|2
index|]
expr_stmt|;
name|old
operator|->
name|fr_ifas
index|[
literal|3
index|]
operator|=
name|fr
operator|->
name|fr_ifas
index|[
literal|3
index|]
expr_stmt|;
name|old
operator|->
name|fr_ptr
operator|=
name|fr
operator|->
name|fr_ptr
expr_stmt|;
name|old
operator|->
name|fr_comment
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|fr_ref
operator|=
name|fr
operator|->
name|fr_ref
expr_stmt|;
name|old
operator|->
name|fr_statecnt
operator|=
name|fr
operator|->
name|fr_statecnt
expr_stmt|;
name|old
operator|->
name|fr_hits
operator|=
name|fr
operator|->
name|fr_hits
expr_stmt|;
name|old
operator|->
name|fr_bytes
operator|=
name|fr
operator|->
name|fr_bytes
expr_stmt|;
name|old
operator|->
name|fr_lastpkt
operator|.
name|tv_sec
operator|=
name|fr
operator|->
name|fr_lastpkt
operator|.
name|tv_sec
expr_stmt|;
name|old
operator|->
name|fr_lastpkt
operator|.
name|tv_usec
operator|=
name|fr
operator|->
name|fr_lastpkt
operator|.
name|tv_usec
expr_stmt|;
name|old
operator|->
name|fr_curpps
operator|=
name|fr
operator|->
name|fr_curpps
expr_stmt|;
name|old
operator|->
name|fr_dun
operator|.
name|fru_data
operator|=
name|fr
operator|->
name|fr_dun
operator|.
name|fru_data
expr_stmt|;
name|old
operator|->
name|fr_func
operator|=
name|fr
operator|->
name|fr_func
expr_stmt|;
name|old
operator|->
name|fr_dsize
operator|=
name|fr
operator|->
name|fr_dsize
expr_stmt|;
name|old
operator|->
name|fr_pps
operator|=
name|fr
operator|->
name|fr_pps
expr_stmt|;
name|old
operator|->
name|fr_statemax
operator|=
name|fr
operator|->
name|fr_statemax
expr_stmt|;
name|old
operator|->
name|fr_flineno
operator|=
name|fr
operator|->
name|fr_flineno
expr_stmt|;
name|old
operator|->
name|fr_type
operator|=
name|fr
operator|->
name|fr_type
expr_stmt|;
name|old
operator|->
name|fr_flags
operator|=
name|fr_frflags5to4
argument_list|(
name|fr
operator|->
name|fr_flags
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_logtag
operator|=
name|fr
operator|->
name|fr_logtag
expr_stmt|;
name|old
operator|->
name|fr_collect
operator|=
name|fr
operator|->
name|fr_collect
expr_stmt|;
name|old
operator|->
name|fr_arg
operator|=
name|fr
operator|->
name|fr_arg
expr_stmt|;
name|old
operator|->
name|fr_loglevel
operator|=
name|fr
operator|->
name|fr_loglevel
expr_stmt|;
name|old
operator|->
name|fr_age
index|[
literal|0
index|]
operator|=
name|fr
operator|->
name|fr_age
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|fr_age
index|[
literal|1
index|]
operator|=
name|fr
operator|->
name|fr_age
index|[
literal|1
index|]
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|fr_v
operator|==
literal|4
condition|)
name|fr
operator|->
name|fr_family
operator|=
name|AF_INET
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|fr_v
operator|==
literal|6
condition|)
name|fr
operator|->
name|fr_family
operator|=
name|AF_INET6
expr_stmt|;
name|old
operator|->
name|fr_icode
operator|=
name|fr
operator|->
name|fr_icode
expr_stmt|;
name|old
operator|->
name|fr_cksum
operator|=
name|fr
operator|->
name|fr_cksum
expr_stmt|;
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|ofd_ip6
operator|=
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ip6
expr_stmt|;
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|ofd_ip6
operator|=
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ip6
expr_stmt|;
name|old
operator|->
name|fr_dif
operator|.
name|ofd_ip6
operator|=
name|fr
operator|->
name|fr_dif
operator|.
name|fd_ip6
expr_stmt|;
if|if
condition|(
name|fr
operator|->
name|fr_ifnames
index|[
literal|0
index|]
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_ifnames
index|[
literal|0
index|]
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_ifnames
index|[
literal|0
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_ifnames
index|[
literal|0
index|]
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_ifnames
index|[
literal|1
index|]
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_ifnames
index|[
literal|1
index|]
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_ifnames
index|[
literal|1
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_ifnames
index|[
literal|1
index|]
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_ifnames
index|[
literal|2
index|]
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_ifnames
index|[
literal|2
index|]
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_ifnames
index|[
literal|2
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_ifnames
index|[
literal|2
index|]
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_ifnames
index|[
literal|3
index|]
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_ifnames
index|[
literal|3
index|]
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_ifnames
index|[
literal|3
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_ifnames
index|[
literal|3
index|]
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_name
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ifname
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_name
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ifname
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_name
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_ifname
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_name
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_ifname
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_dif
operator|.
name|fd_name
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_dif
operator|.
name|fd_ifname
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_dif
operator|.
name|fd_name
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_dif
operator|.
name|fd_ifname
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_group
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_group
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_group
argument_list|,
name|FR_GROUPLEN
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_group
index|[
name|FR_GROUPLEN
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_grhead
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_grhead
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_grhead
argument_list|,
name|FR_GROUPLEN
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_grhead
index|[
name|FR_GROUPLEN
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|frentry_current_to_4_1_0
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|frentry_4_1_0_t
modifier|*
name|old
decl_stmt|;
block|{
name|frentry_t
modifier|*
name|fr
init|=
operator|(
name|frentry_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|fr_lock
operator|=
name|fr
operator|->
name|fr_lock
expr_stmt|;
name|old
operator|->
name|fr_next
operator|=
name|fr
operator|->
name|fr_next
expr_stmt|;
name|old
operator|->
name|fr_grp
operator|=
operator|(
name|void
operator|*
operator|)
name|fr
operator|->
name|fr_grp
expr_stmt|;
name|old
operator|->
name|fr_isc
operator|=
name|fr
operator|->
name|fr_isc
expr_stmt|;
name|old
operator|->
name|fr_ifas
index|[
literal|0
index|]
operator|=
name|fr
operator|->
name|fr_ifas
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|fr_ifas
index|[
literal|1
index|]
operator|=
name|fr
operator|->
name|fr_ifas
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|fr_ifas
index|[
literal|2
index|]
operator|=
name|fr
operator|->
name|fr_ifas
index|[
literal|2
index|]
expr_stmt|;
name|old
operator|->
name|fr_ifas
index|[
literal|3
index|]
operator|=
name|fr
operator|->
name|fr_ifas
index|[
literal|3
index|]
expr_stmt|;
name|old
operator|->
name|fr_ptr
operator|=
name|fr
operator|->
name|fr_ptr
expr_stmt|;
name|old
operator|->
name|fr_comment
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|fr_ref
operator|=
name|fr
operator|->
name|fr_ref
expr_stmt|;
name|old
operator|->
name|fr_statecnt
operator|=
name|fr
operator|->
name|fr_statecnt
expr_stmt|;
name|old
operator|->
name|fr_hits
operator|=
name|fr
operator|->
name|fr_hits
expr_stmt|;
name|old
operator|->
name|fr_bytes
operator|=
name|fr
operator|->
name|fr_bytes
expr_stmt|;
name|old
operator|->
name|fr_lastpkt
operator|.
name|tv_sec
operator|=
name|fr
operator|->
name|fr_lastpkt
operator|.
name|tv_sec
expr_stmt|;
name|old
operator|->
name|fr_lastpkt
operator|.
name|tv_usec
operator|=
name|fr
operator|->
name|fr_lastpkt
operator|.
name|tv_usec
expr_stmt|;
name|old
operator|->
name|fr_curpps
operator|=
name|fr
operator|->
name|fr_curpps
expr_stmt|;
name|old
operator|->
name|fr_dun
operator|.
name|fru_data
operator|=
name|fr
operator|->
name|fr_dun
operator|.
name|fru_data
expr_stmt|;
name|old
operator|->
name|fr_func
operator|=
name|fr
operator|->
name|fr_func
expr_stmt|;
name|old
operator|->
name|fr_dsize
operator|=
name|fr
operator|->
name|fr_dsize
expr_stmt|;
name|old
operator|->
name|fr_pps
operator|=
name|fr
operator|->
name|fr_pps
expr_stmt|;
name|old
operator|->
name|fr_statemax
operator|=
name|fr
operator|->
name|fr_statemax
expr_stmt|;
name|old
operator|->
name|fr_flineno
operator|=
name|fr
operator|->
name|fr_flineno
expr_stmt|;
name|old
operator|->
name|fr_type
operator|=
name|fr
operator|->
name|fr_type
expr_stmt|;
name|old
operator|->
name|fr_flags
operator|=
name|fr_frflags5to4
argument_list|(
name|fr
operator|->
name|fr_flags
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_logtag
operator|=
name|fr
operator|->
name|fr_logtag
expr_stmt|;
name|old
operator|->
name|fr_collect
operator|=
name|fr
operator|->
name|fr_collect
expr_stmt|;
name|old
operator|->
name|fr_arg
operator|=
name|fr
operator|->
name|fr_arg
expr_stmt|;
name|old
operator|->
name|fr_loglevel
operator|=
name|fr
operator|->
name|fr_loglevel
expr_stmt|;
name|old
operator|->
name|fr_age
index|[
literal|0
index|]
operator|=
name|fr
operator|->
name|fr_age
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|fr_age
index|[
literal|1
index|]
operator|=
name|fr
operator|->
name|fr_age
index|[
literal|1
index|]
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|fr_v
operator|==
literal|4
condition|)
name|fr
operator|->
name|fr_family
operator|=
name|AF_INET
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|fr_v
operator|==
literal|6
condition|)
name|fr
operator|->
name|fr_family
operator|=
name|AF_INET6
expr_stmt|;
name|old
operator|->
name|fr_icode
operator|=
name|fr
operator|->
name|fr_icode
expr_stmt|;
name|old
operator|->
name|fr_cksum
operator|=
name|fr
operator|->
name|fr_cksum
expr_stmt|;
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|ofd_ip6
operator|=
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ip6
expr_stmt|;
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|ofd_ip6
operator|=
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ip6
expr_stmt|;
name|old
operator|->
name|fr_dif
operator|.
name|ofd_ip6
operator|=
name|fr
operator|->
name|fr_dif
operator|.
name|fd_ip6
expr_stmt|;
if|if
condition|(
name|fr
operator|->
name|fr_ifnames
index|[
literal|0
index|]
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_ifnames
index|[
literal|0
index|]
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_ifnames
index|[
literal|0
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_ifnames
index|[
literal|0
index|]
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_ifnames
index|[
literal|1
index|]
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_ifnames
index|[
literal|1
index|]
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_ifnames
index|[
literal|1
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_ifnames
index|[
literal|1
index|]
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_ifnames
index|[
literal|2
index|]
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_ifnames
index|[
literal|2
index|]
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_ifnames
index|[
literal|2
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_ifnames
index|[
literal|2
index|]
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_ifnames
index|[
literal|3
index|]
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_ifnames
index|[
literal|3
index|]
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_ifnames
index|[
literal|3
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_ifnames
index|[
literal|3
index|]
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_name
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ifname
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_name
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_tifs
index|[
literal|0
index|]
operator|.
name|fd_ifname
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_name
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_ifname
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_name
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_tifs
index|[
literal|1
index|]
operator|.
name|fd_ifname
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_dif
operator|.
name|fd_name
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_dif
operator|.
name|fd_ifname
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_dif
operator|.
name|fd_name
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_dif
operator|.
name|fd_ifname
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_group
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_group
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_group
argument_list|,
name|FR_GROUPLEN
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_group
index|[
name|FR_GROUPLEN
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|fr
operator|->
name|fr_grhead
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|fr_grhead
argument_list|,
name|fr
operator|->
name|fr_names
operator|+
name|fr
operator|->
name|fr_grhead
argument_list|,
name|FR_GROUPLEN
argument_list|)
expr_stmt|;
name|old
operator|->
name|fr_grhead
index|[
name|FR_GROUPLEN
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|fr_info_current_to_4_1_24
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|fr_info_4_1_24_t
modifier|*
name|old
decl_stmt|;
block|{
name|fr_info_t
modifier|*
name|fin
init|=
operator|(
name|fr_info_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|fin_ifp
operator|=
name|fin
operator|->
name|fin_ifp
expr_stmt|;
name|ipf_v5iptov4
argument_list|(
operator|&
name|fin
operator|->
name|fin_fi
argument_list|,
operator|&
name|old
operator|->
name|fin_fi
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|fin
operator|->
name|fin_dat
argument_list|,
operator|&
name|old
operator|->
name|fin_dat
argument_list|,
sizeof|sizeof
argument_list|(
name|fin
operator|->
name|fin_dat
argument_list|)
argument_list|)
expr_stmt|;
name|old
operator|->
name|fin_out
operator|=
name|fin
operator|->
name|fin_out
expr_stmt|;
name|old
operator|->
name|fin_rev
operator|=
name|fin
operator|->
name|fin_rev
expr_stmt|;
name|old
operator|->
name|fin_hlen
operator|=
name|fin
operator|->
name|fin_hlen
expr_stmt|;
name|old
operator|->
name|ofin_tcpf
operator|=
name|fin
operator|->
name|fin_tcpf
expr_stmt|;
name|old
operator|->
name|fin_icode
operator|=
name|fin
operator|->
name|fin_icode
expr_stmt|;
name|old
operator|->
name|fin_rule
operator|=
name|fin
operator|->
name|fin_rule
expr_stmt|;
name|bcopy
argument_list|(
name|fin
operator|->
name|fin_group
argument_list|,
name|old
operator|->
name|fin_group
argument_list|,
sizeof|sizeof
argument_list|(
name|fin
operator|->
name|fin_group
argument_list|)
argument_list|)
expr_stmt|;
name|old
operator|->
name|fin_fr
operator|=
name|fin
operator|->
name|fin_fr
expr_stmt|;
name|old
operator|->
name|fin_dp
operator|=
name|fin
operator|->
name|fin_dp
expr_stmt|;
name|old
operator|->
name|fin_dlen
operator|=
name|fin
operator|->
name|fin_dlen
expr_stmt|;
name|old
operator|->
name|fin_plen
operator|=
name|fin
operator|->
name|fin_plen
expr_stmt|;
name|old
operator|->
name|fin_ipoff
operator|=
name|fin
operator|->
name|fin_ipoff
expr_stmt|;
name|old
operator|->
name|fin_id
operator|=
name|fin
operator|->
name|fin_id
expr_stmt|;
name|old
operator|->
name|fin_off
operator|=
name|fin
operator|->
name|fin_off
expr_stmt|;
name|old
operator|->
name|fin_depth
operator|=
name|fin
operator|->
name|fin_depth
expr_stmt|;
name|old
operator|->
name|fin_error
operator|=
name|fin
operator|->
name|fin_error
expr_stmt|;
name|old
operator|->
name|fin_cksum
operator|=
name|fin
operator|->
name|fin_cksum
expr_stmt|;
name|old
operator|->
name|fin_state
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|fin_nat
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|fin_nattag
operator|=
name|fin
operator|->
name|fin_nattag
expr_stmt|;
name|old
operator|->
name|fin_exthdr
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|ofin_ip
operator|=
name|fin
operator|->
name|fin_ip
expr_stmt|;
name|old
operator|->
name|fin_mp
operator|=
name|fin
operator|->
name|fin_mp
expr_stmt|;
name|old
operator|->
name|fin_m
operator|=
name|fin
operator|->
name|fin_m
expr_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|old
operator|->
name|fin_qfm
operator|=
name|fin
operator|->
name|fin_qfm
expr_stmt|;
name|old
operator|->
name|fin_qpi
operator|=
name|fin
operator|->
name|fin_qpi
expr_stmt|;
name|old
operator|->
name|fin_ifname
index|[
literal|0
index|]
operator|=
literal|'\0'
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|__sgi
name|old
operator|->
name|fin_hbuf
operator|=
name|fin
operator|->
name|fin_hbuf
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|fr_info_current_to_4_1_23
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|fr_info_4_1_23_t
modifier|*
name|old
decl_stmt|;
block|{
name|fr_info_t
modifier|*
name|fin
init|=
operator|(
name|fr_info_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|fin_ifp
operator|=
name|fin
operator|->
name|fin_ifp
expr_stmt|;
name|ipf_v5iptov4
argument_list|(
operator|&
name|fin
operator|->
name|fin_fi
argument_list|,
operator|&
name|old
operator|->
name|fin_fi
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|fin
operator|->
name|fin_dat
argument_list|,
operator|&
name|old
operator|->
name|fin_dat
argument_list|,
sizeof|sizeof
argument_list|(
name|fin
operator|->
name|fin_dat
argument_list|)
argument_list|)
expr_stmt|;
name|old
operator|->
name|fin_out
operator|=
name|fin
operator|->
name|fin_out
expr_stmt|;
name|old
operator|->
name|fin_rev
operator|=
name|fin
operator|->
name|fin_rev
expr_stmt|;
name|old
operator|->
name|fin_hlen
operator|=
name|fin
operator|->
name|fin_hlen
expr_stmt|;
name|old
operator|->
name|ofin_tcpf
operator|=
name|fin
operator|->
name|fin_tcpf
expr_stmt|;
name|old
operator|->
name|fin_icode
operator|=
name|fin
operator|->
name|fin_icode
expr_stmt|;
name|old
operator|->
name|fin_rule
operator|=
name|fin
operator|->
name|fin_rule
expr_stmt|;
name|bcopy
argument_list|(
name|fin
operator|->
name|fin_group
argument_list|,
name|old
operator|->
name|fin_group
argument_list|,
sizeof|sizeof
argument_list|(
name|fin
operator|->
name|fin_group
argument_list|)
argument_list|)
expr_stmt|;
name|old
operator|->
name|fin_fr
operator|=
name|fin
operator|->
name|fin_fr
expr_stmt|;
name|old
operator|->
name|fin_dp
operator|=
name|fin
operator|->
name|fin_dp
expr_stmt|;
name|old
operator|->
name|fin_dlen
operator|=
name|fin
operator|->
name|fin_dlen
expr_stmt|;
name|old
operator|->
name|fin_plen
operator|=
name|fin
operator|->
name|fin_plen
expr_stmt|;
name|old
operator|->
name|fin_ipoff
operator|=
name|fin
operator|->
name|fin_ipoff
expr_stmt|;
name|old
operator|->
name|fin_id
operator|=
name|fin
operator|->
name|fin_id
expr_stmt|;
name|old
operator|->
name|fin_off
operator|=
name|fin
operator|->
name|fin_off
expr_stmt|;
name|old
operator|->
name|fin_depth
operator|=
name|fin
operator|->
name|fin_depth
expr_stmt|;
name|old
operator|->
name|fin_error
operator|=
name|fin
operator|->
name|fin_error
expr_stmt|;
name|old
operator|->
name|fin_state
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|fin_nat
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|fin_nattag
operator|=
name|fin
operator|->
name|fin_nattag
expr_stmt|;
name|old
operator|->
name|ofin_ip
operator|=
name|fin
operator|->
name|fin_ip
expr_stmt|;
name|old
operator|->
name|fin_mp
operator|=
name|fin
operator|->
name|fin_mp
expr_stmt|;
name|old
operator|->
name|fin_m
operator|=
name|fin
operator|->
name|fin_m
expr_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|old
operator|->
name|fin_qfm
operator|=
name|fin
operator|->
name|fin_qfm
expr_stmt|;
name|old
operator|->
name|fin_qpi
operator|=
name|fin
operator|->
name|fin_qpi
expr_stmt|;
name|old
operator|->
name|fin_ifname
index|[
literal|0
index|]
operator|=
literal|'\0'
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|__sgi
name|old
operator|->
name|fin_hbuf
operator|=
name|fin
operator|->
name|fin_hbuf
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|fr_info_current_to_4_1_11
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|fr_info_4_1_11_t
modifier|*
name|old
decl_stmt|;
block|{
name|fr_info_t
modifier|*
name|fin
init|=
operator|(
name|fr_info_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|fin_ifp
operator|=
name|fin
operator|->
name|fin_ifp
expr_stmt|;
name|ipf_v5iptov4
argument_list|(
operator|&
name|fin
operator|->
name|fin_fi
argument_list|,
operator|&
name|old
operator|->
name|fin_fi
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|fin
operator|->
name|fin_dat
argument_list|,
operator|&
name|old
operator|->
name|fin_dat
argument_list|,
sizeof|sizeof
argument_list|(
name|fin
operator|->
name|fin_dat
argument_list|)
argument_list|)
expr_stmt|;
name|old
operator|->
name|fin_out
operator|=
name|fin
operator|->
name|fin_out
expr_stmt|;
name|old
operator|->
name|fin_rev
operator|=
name|fin
operator|->
name|fin_rev
expr_stmt|;
name|old
operator|->
name|fin_hlen
operator|=
name|fin
operator|->
name|fin_hlen
expr_stmt|;
name|old
operator|->
name|ofin_tcpf
operator|=
name|fin
operator|->
name|fin_tcpf
expr_stmt|;
name|old
operator|->
name|fin_icode
operator|=
name|fin
operator|->
name|fin_icode
expr_stmt|;
name|old
operator|->
name|fin_rule
operator|=
name|fin
operator|->
name|fin_rule
expr_stmt|;
name|bcopy
argument_list|(
name|fin
operator|->
name|fin_group
argument_list|,
name|old
operator|->
name|fin_group
argument_list|,
sizeof|sizeof
argument_list|(
name|fin
operator|->
name|fin_group
argument_list|)
argument_list|)
expr_stmt|;
name|old
operator|->
name|fin_fr
operator|=
name|fin
operator|->
name|fin_fr
expr_stmt|;
name|old
operator|->
name|fin_dp
operator|=
name|fin
operator|->
name|fin_dp
expr_stmt|;
name|old
operator|->
name|fin_dlen
operator|=
name|fin
operator|->
name|fin_dlen
expr_stmt|;
name|old
operator|->
name|fin_plen
operator|=
name|fin
operator|->
name|fin_plen
expr_stmt|;
name|old
operator|->
name|fin_ipoff
operator|=
name|fin
operator|->
name|fin_ipoff
expr_stmt|;
name|old
operator|->
name|fin_id
operator|=
name|fin
operator|->
name|fin_id
expr_stmt|;
name|old
operator|->
name|fin_off
operator|=
name|fin
operator|->
name|fin_off
expr_stmt|;
name|old
operator|->
name|fin_depth
operator|=
name|fin
operator|->
name|fin_depth
expr_stmt|;
name|old
operator|->
name|fin_error
operator|=
name|fin
operator|->
name|fin_error
expr_stmt|;
name|old
operator|->
name|fin_state
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|fin_nat
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|fin_nattag
operator|=
name|fin
operator|->
name|fin_nattag
expr_stmt|;
name|old
operator|->
name|ofin_ip
operator|=
name|fin
operator|->
name|fin_ip
expr_stmt|;
name|old
operator|->
name|fin_mp
operator|=
name|fin
operator|->
name|fin_mp
expr_stmt|;
name|old
operator|->
name|fin_m
operator|=
name|fin
operator|->
name|fin_m
expr_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|old
operator|->
name|fin_qfm
operator|=
name|fin
operator|->
name|fin_qfm
expr_stmt|;
name|old
operator|->
name|fin_qpi
operator|=
name|fin
operator|->
name|fin_qpi
expr_stmt|;
name|old
operator|->
name|fin_ifname
index|[
literal|0
index|]
operator|=
literal|'\0'
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|__sgi
name|old
operator|->
name|fin_hbuf
operator|=
name|fin
operator|->
name|fin_hbuf
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|frauth_current_to_4_1_29
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|frauth_4_1_29_t
modifier|*
name|old
decl_stmt|;
block|{
name|frauth_t
modifier|*
name|fra
init|=
operator|(
name|frauth_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|fra_age
operator|=
name|fra
operator|->
name|fra_age
expr_stmt|;
name|old
operator|->
name|fra_len
operator|=
name|fra
operator|->
name|fra_len
expr_stmt|;
name|old
operator|->
name|fra_index
operator|=
name|fra
operator|->
name|fra_index
expr_stmt|;
name|old
operator|->
name|fra_pass
operator|=
name|fra
operator|->
name|fra_pass
expr_stmt|;
name|fr_info_current_to_4_1_24
argument_list|(
operator|&
name|fra
operator|->
name|fra_info
argument_list|,
operator|&
name|old
operator|->
name|fra_info
argument_list|)
expr_stmt|;
name|old
operator|->
name|fra_buf
operator|=
name|fra
operator|->
name|fra_buf
expr_stmt|;
name|old
operator|->
name|fra_flx
operator|=
name|fra
operator|->
name|fra_flx
expr_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|old
operator|->
name|fra_q
operator|=
name|fra
operator|->
name|fra_q
expr_stmt|;
name|old
operator|->
name|fra_m
operator|=
name|fra
operator|->
name|fra_m
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|frauth_current_to_4_1_24
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|frauth_4_1_24_t
modifier|*
name|old
decl_stmt|;
block|{
name|frauth_t
modifier|*
name|fra
init|=
operator|(
name|frauth_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|fra_age
operator|=
name|fra
operator|->
name|fra_age
expr_stmt|;
name|old
operator|->
name|fra_len
operator|=
name|fra
operator|->
name|fra_len
expr_stmt|;
name|old
operator|->
name|fra_index
operator|=
name|fra
operator|->
name|fra_index
expr_stmt|;
name|old
operator|->
name|fra_pass
operator|=
name|fra
operator|->
name|fra_pass
expr_stmt|;
name|fr_info_current_to_4_1_24
argument_list|(
operator|&
name|fra
operator|->
name|fra_info
argument_list|,
operator|&
name|old
operator|->
name|fra_info
argument_list|)
expr_stmt|;
name|old
operator|->
name|fra_buf
operator|=
name|fra
operator|->
name|fra_buf
expr_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|old
operator|->
name|fra_q
operator|=
name|fra
operator|->
name|fra_q
expr_stmt|;
name|old
operator|->
name|fra_m
operator|=
name|fra
operator|->
name|fra_m
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|frauth_current_to_4_1_23
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|frauth_4_1_23_t
modifier|*
name|old
decl_stmt|;
block|{
name|frauth_t
modifier|*
name|fra
init|=
operator|(
name|frauth_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|fra_age
operator|=
name|fra
operator|->
name|fra_age
expr_stmt|;
name|old
operator|->
name|fra_len
operator|=
name|fra
operator|->
name|fra_len
expr_stmt|;
name|old
operator|->
name|fra_index
operator|=
name|fra
operator|->
name|fra_index
expr_stmt|;
name|old
operator|->
name|fra_pass
operator|=
name|fra
operator|->
name|fra_pass
expr_stmt|;
name|fr_info_current_to_4_1_23
argument_list|(
operator|&
name|fra
operator|->
name|fra_info
argument_list|,
operator|&
name|old
operator|->
name|fra_info
argument_list|)
expr_stmt|;
name|old
operator|->
name|fra_buf
operator|=
name|fra
operator|->
name|fra_buf
expr_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|old
operator|->
name|fra_q
operator|=
name|fra
operator|->
name|fra_q
expr_stmt|;
name|old
operator|->
name|fra_m
operator|=
name|fra
operator|->
name|fra_m
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|frauth_current_to_4_1_11
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|frauth_4_1_11_t
modifier|*
name|old
decl_stmt|;
block|{
name|frauth_t
modifier|*
name|fra
init|=
operator|(
name|frauth_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|fra_age
operator|=
name|fra
operator|->
name|fra_age
expr_stmt|;
name|old
operator|->
name|fra_len
operator|=
name|fra
operator|->
name|fra_len
expr_stmt|;
name|old
operator|->
name|fra_index
operator|=
name|fra
operator|->
name|fra_index
expr_stmt|;
name|old
operator|->
name|fra_pass
operator|=
name|fra
operator|->
name|fra_pass
expr_stmt|;
name|fr_info_current_to_4_1_11
argument_list|(
operator|&
name|fra
operator|->
name|fra_info
argument_list|,
operator|&
name|old
operator|->
name|fra_info
argument_list|)
expr_stmt|;
name|old
operator|->
name|fra_buf
operator|=
name|fra
operator|->
name|fra_buf
expr_stmt|;
ifdef|#
directive|ifdef
name|MENTAT
name|old
operator|->
name|fra_q
operator|=
name|fra
operator|->
name|fra_q
expr_stmt|;
name|old
operator|->
name|fra_m
operator|=
name|fra
operator|->
name|fra_m
expr_stmt|;
endif|#
directive|endif
block|}
end_function

begin_function
specifier|static
name|void
name|ipnat_current_to_4_1_14
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|ipnat_4_1_14_t
modifier|*
name|old
decl_stmt|;
block|{
name|ipnat_t
modifier|*
name|np
init|=
operator|(
name|ipnat_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|in_next
operator|=
name|np
operator|->
name|in_next
expr_stmt|;
name|old
operator|->
name|in_rnext
operator|=
name|np
operator|->
name|in_rnext
expr_stmt|;
name|old
operator|->
name|in_prnext
operator|=
name|np
operator|->
name|in_prnext
expr_stmt|;
name|old
operator|->
name|in_mnext
operator|=
name|np
operator|->
name|in_mnext
expr_stmt|;
name|old
operator|->
name|in_pmnext
operator|=
name|np
operator|->
name|in_pmnext
expr_stmt|;
name|old
operator|->
name|in_tqehead
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_tqehead
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_tqehead
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_tqehead
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|in_ifps
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_ifps
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_ifps
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_ifps
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|in_apr
operator|=
name|np
operator|->
name|in_apr
expr_stmt|;
name|old
operator|->
name|in_comment
operator|=
name|np
operator|->
name|in_comment
expr_stmt|;
name|old
operator|->
name|in_space
operator|=
name|np
operator|->
name|in_space
expr_stmt|;
name|old
operator|->
name|in_hits
operator|=
name|np
operator|->
name|in_hits
expr_stmt|;
name|old
operator|->
name|in_use
operator|=
name|np
operator|->
name|in_use
expr_stmt|;
name|old
operator|->
name|in_hv
operator|=
name|np
operator|->
name|in_hv
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_flineno
operator|=
name|np
operator|->
name|in_flineno
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|in_redir
operator|==
name|NAT_REDIRECT
condition|)
name|old
operator|->
name|in_pnext
operator|=
name|np
operator|->
name|in_dpnext
expr_stmt|;
else|else
name|old
operator|->
name|in_pnext
operator|=
name|np
operator|->
name|in_spnext
expr_stmt|;
name|old
operator|->
name|in_v
operator|=
name|np
operator|->
name|in_v
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_flags
operator|=
name|np
operator|->
name|in_flags
expr_stmt|;
name|old
operator|->
name|in_mssclamp
operator|=
name|np
operator|->
name|in_mssclamp
expr_stmt|;
name|old
operator|->
name|in_age
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_age
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_age
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_age
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|in_redir
operator|=
name|np
operator|->
name|in_redir
expr_stmt|;
name|old
operator|->
name|in_p
operator|=
name|np
operator|->
name|in_pr
index|[
literal|0
index|]
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_redir
operator|==
name|NAT_REDIRECT
condition|)
block|{
name|old
operator|->
name|in_next6
operator|=
name|np
operator|->
name|in_ndst
operator|.
name|na_nextaddr
expr_stmt|;
name|old
operator|->
name|in_in
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_ndst
operator|.
name|na_addr
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_in
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_ndst
operator|.
name|na_addr
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|in_out
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_odst
operator|.
name|na_addr
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_out
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_odst
operator|.
name|na_addr
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|in_src
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_osrc
operator|.
name|na_addr
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_src
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_osrc
operator|.
name|na_addr
index|[
literal|1
index|]
expr_stmt|;
block|}
else|else
block|{
name|old
operator|->
name|in_next6
operator|=
name|np
operator|->
name|in_nsrc
operator|.
name|na_nextaddr
expr_stmt|;
name|old
operator|->
name|in_out
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_nsrc
operator|.
name|na_addr
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_out
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_nsrc
operator|.
name|na_addr
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|in_in
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_osrc
operator|.
name|na_addr
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_in
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_osrc
operator|.
name|na_addr
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|in_src
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_odst
operator|.
name|na_addr
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_src
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_odst
operator|.
name|na_addr
index|[
literal|1
index|]
expr_stmt|;
block|}
name|ipfv5tuctov4
argument_list|(
operator|&
name|np
operator|->
name|in_tuc
argument_list|,
operator|&
name|old
operator|->
name|in_tuc
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_redir
operator|==
name|NAT_REDIRECT
condition|)
block|{
name|old
operator|->
name|in_port
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_dpmin
expr_stmt|;
name|old
operator|->
name|in_port
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_dpmax
expr_stmt|;
block|}
else|else
block|{
name|old
operator|->
name|in_port
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_spmin
expr_stmt|;
name|old
operator|->
name|in_port
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_spmax
expr_stmt|;
block|}
name|old
operator|->
name|in_ppip
operator|=
name|np
operator|->
name|in_ppip
expr_stmt|;
name|old
operator|->
name|in_ippip
operator|=
name|np
operator|->
name|in_ippip
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|np
operator|->
name|in_tag
argument_list|,
operator|&
name|old
operator|->
name|in_tag
argument_list|,
sizeof|sizeof
argument_list|(
name|np
operator|->
name|in_tag
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_ifnames
index|[
literal|0
index|]
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|in_ifnames
index|[
literal|0
index|]
argument_list|,
name|np
operator|->
name|in_names
operator|+
name|np
operator|->
name|in_ifnames
index|[
literal|0
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|in_ifnames
index|[
literal|0
index|]
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|np
operator|->
name|in_ifnames
index|[
literal|1
index|]
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|in_ifnames
index|[
literal|1
index|]
argument_list|,
name|np
operator|->
name|in_names
operator|+
name|np
operator|->
name|in_ifnames
index|[
literal|1
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|in_ifnames
index|[
literal|1
index|]
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|np
operator|->
name|in_plabel
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|in_plabel
argument_list|,
name|np
operator|->
name|in_names
operator|+
name|np
operator|->
name|in_plabel
argument_list|,
name|APR_LABELLEN
argument_list|)
expr_stmt|;
name|old
operator|->
name|in_plabel
index|[
name|APR_LABELLEN
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|ipnat_current_to_4_1_0
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|ipnat_4_1_0_t
modifier|*
name|old
decl_stmt|;
block|{
name|ipnat_t
modifier|*
name|np
init|=
operator|(
name|ipnat_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|in_next
operator|=
name|np
operator|->
name|in_next
expr_stmt|;
name|old
operator|->
name|in_rnext
operator|=
name|np
operator|->
name|in_rnext
expr_stmt|;
name|old
operator|->
name|in_prnext
operator|=
name|np
operator|->
name|in_prnext
expr_stmt|;
name|old
operator|->
name|in_mnext
operator|=
name|np
operator|->
name|in_mnext
expr_stmt|;
name|old
operator|->
name|in_pmnext
operator|=
name|np
operator|->
name|in_pmnext
expr_stmt|;
name|old
operator|->
name|in_tqehead
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_tqehead
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_tqehead
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_tqehead
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|in_ifps
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_ifps
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_ifps
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_ifps
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|in_apr
operator|=
name|np
operator|->
name|in_apr
expr_stmt|;
name|old
operator|->
name|in_comment
operator|=
name|np
operator|->
name|in_comment
expr_stmt|;
name|old
operator|->
name|in_space
operator|=
name|np
operator|->
name|in_space
expr_stmt|;
name|old
operator|->
name|in_hits
operator|=
name|np
operator|->
name|in_hits
expr_stmt|;
name|old
operator|->
name|in_use
operator|=
name|np
operator|->
name|in_use
expr_stmt|;
name|old
operator|->
name|in_hv
operator|=
name|np
operator|->
name|in_hv
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_flineno
operator|=
name|np
operator|->
name|in_flineno
expr_stmt|;
if|if
condition|(
name|old
operator|->
name|in_redir
operator|==
name|NAT_REDIRECT
condition|)
name|old
operator|->
name|in_pnext
operator|=
name|np
operator|->
name|in_dpnext
expr_stmt|;
else|else
name|old
operator|->
name|in_pnext
operator|=
name|np
operator|->
name|in_spnext
expr_stmt|;
name|old
operator|->
name|in_v
operator|=
name|np
operator|->
name|in_v
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_flags
operator|=
name|np
operator|->
name|in_flags
expr_stmt|;
name|old
operator|->
name|in_mssclamp
operator|=
name|np
operator|->
name|in_mssclamp
expr_stmt|;
name|old
operator|->
name|in_age
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_age
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_age
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_age
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|in_redir
operator|=
name|np
operator|->
name|in_redir
expr_stmt|;
name|old
operator|->
name|in_p
operator|=
name|np
operator|->
name|in_pr
index|[
literal|0
index|]
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_redir
operator|==
name|NAT_REDIRECT
condition|)
block|{
name|old
operator|->
name|in_next6
operator|=
name|np
operator|->
name|in_ndst
operator|.
name|na_nextaddr
expr_stmt|;
name|old
operator|->
name|in_in
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_ndst
operator|.
name|na_addr
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_in
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_ndst
operator|.
name|na_addr
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|in_out
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_odst
operator|.
name|na_addr
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_out
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_odst
operator|.
name|na_addr
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|in_src
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_osrc
operator|.
name|na_addr
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_src
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_osrc
operator|.
name|na_addr
index|[
literal|1
index|]
expr_stmt|;
block|}
else|else
block|{
name|old
operator|->
name|in_next6
operator|=
name|np
operator|->
name|in_nsrc
operator|.
name|na_nextaddr
expr_stmt|;
name|old
operator|->
name|in_out
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_nsrc
operator|.
name|na_addr
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_out
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_nsrc
operator|.
name|na_addr
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|in_in
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_osrc
operator|.
name|na_addr
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_in
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_osrc
operator|.
name|na_addr
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|in_src
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_odst
operator|.
name|na_addr
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|in_src
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_odst
operator|.
name|na_addr
index|[
literal|1
index|]
expr_stmt|;
block|}
name|ipfv5tuctov4
argument_list|(
operator|&
name|np
operator|->
name|in_tuc
argument_list|,
operator|&
name|old
operator|->
name|in_tuc
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_redir
operator|==
name|NAT_REDIRECT
condition|)
block|{
name|old
operator|->
name|in_port
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_dpmin
expr_stmt|;
name|old
operator|->
name|in_port
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_dpmax
expr_stmt|;
block|}
else|else
block|{
name|old
operator|->
name|in_port
index|[
literal|0
index|]
operator|=
name|np
operator|->
name|in_spmin
expr_stmt|;
name|old
operator|->
name|in_port
index|[
literal|1
index|]
operator|=
name|np
operator|->
name|in_spmax
expr_stmt|;
block|}
name|old
operator|->
name|in_ppip
operator|=
name|np
operator|->
name|in_ppip
expr_stmt|;
name|old
operator|->
name|in_ippip
operator|=
name|np
operator|->
name|in_ippip
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|np
operator|->
name|in_tag
argument_list|,
operator|&
name|old
operator|->
name|in_tag
argument_list|,
sizeof|sizeof
argument_list|(
name|np
operator|->
name|in_tag
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|np
operator|->
name|in_ifnames
index|[
literal|0
index|]
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|in_ifnames
index|[
literal|0
index|]
argument_list|,
name|np
operator|->
name|in_names
operator|+
name|np
operator|->
name|in_ifnames
index|[
literal|0
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|in_ifnames
index|[
literal|0
index|]
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|np
operator|->
name|in_ifnames
index|[
literal|1
index|]
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|in_ifnames
index|[
literal|1
index|]
argument_list|,
name|np
operator|->
name|in_names
operator|+
name|np
operator|->
name|in_ifnames
index|[
literal|1
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|old
operator|->
name|in_ifnames
index|[
literal|1
index|]
index|[
name|LIFNAMSIZ
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
if|if
condition|(
name|np
operator|->
name|in_plabel
operator|>=
literal|0
condition|)
block|{
name|strncpy
argument_list|(
name|old
operator|->
name|in_plabel
argument_list|,
name|np
operator|->
name|in_names
operator|+
name|np
operator|->
name|in_plabel
argument_list|,
name|APR_LABELLEN
argument_list|)
expr_stmt|;
name|old
operator|->
name|in_plabel
index|[
name|APR_LABELLEN
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|ipstate_current_to_4_1_16
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|ipstate_4_1_16_t
modifier|*
name|old
decl_stmt|;
block|{
name|ipstate_t
modifier|*
name|is
init|=
operator|(
name|ipstate_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|is_lock
operator|=
name|is
operator|->
name|is_lock
expr_stmt|;
name|old
operator|->
name|is_next
operator|=
name|is
operator|->
name|is_next
expr_stmt|;
name|old
operator|->
name|is_pnext
operator|=
name|is
operator|->
name|is_pnext
expr_stmt|;
name|old
operator|->
name|is_hnext
operator|=
name|is
operator|->
name|is_hnext
expr_stmt|;
name|old
operator|->
name|is_phnext
operator|=
name|is
operator|->
name|is_phnext
expr_stmt|;
name|old
operator|->
name|is_me
operator|=
name|is
operator|->
name|is_me
expr_stmt|;
name|old
operator|->
name|is_ifp
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_ifp
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_ifp
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_ifp
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_sync
operator|=
name|is
operator|->
name|is_sync
expr_stmt|;
name|old
operator|->
name|is_rule
operator|=
name|is
operator|->
name|is_rule
expr_stmt|;
name|old
operator|->
name|is_tqehead
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_tqehead
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_tqehead
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_tqehead
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_isc
operator|=
name|is
operator|->
name|is_isc
expr_stmt|;
name|old
operator|->
name|is_pkts
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_pkts
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_pkts
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_pkts
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_pkts
index|[
literal|2
index|]
operator|=
name|is
operator|->
name|is_pkts
index|[
literal|2
index|]
expr_stmt|;
name|old
operator|->
name|is_pkts
index|[
literal|3
index|]
operator|=
name|is
operator|->
name|is_pkts
index|[
literal|3
index|]
expr_stmt|;
name|old
operator|->
name|is_bytes
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_bytes
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_bytes
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_bytes
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_bytes
index|[
literal|2
index|]
operator|=
name|is
operator|->
name|is_bytes
index|[
literal|2
index|]
expr_stmt|;
name|old
operator|->
name|is_bytes
index|[
literal|3
index|]
operator|=
name|is
operator|->
name|is_bytes
index|[
literal|3
index|]
expr_stmt|;
name|old
operator|->
name|is_icmppkts
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_icmppkts
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_icmppkts
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_icmppkts
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_icmppkts
index|[
literal|2
index|]
operator|=
name|is
operator|->
name|is_icmppkts
index|[
literal|2
index|]
expr_stmt|;
name|old
operator|->
name|is_icmppkts
index|[
literal|3
index|]
operator|=
name|is
operator|->
name|is_icmppkts
index|[
literal|3
index|]
expr_stmt|;
name|old
operator|->
name|is_sti
operator|=
name|is
operator|->
name|is_sti
expr_stmt|;
name|old
operator|->
name|is_frage
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_frage
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_frage
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_frage
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_ref
operator|=
name|is
operator|->
name|is_ref
expr_stmt|;
name|old
operator|->
name|is_isninc
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_isninc
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_isninc
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_isninc
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_sumd
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_sumd
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_sumd
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_sumd
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_src
operator|=
name|is
operator|->
name|is_src
expr_stmt|;
name|old
operator|->
name|is_dst
operator|=
name|is
operator|->
name|is_dst
expr_stmt|;
name|old
operator|->
name|is_pass
operator|=
name|is
operator|->
name|is_pass
expr_stmt|;
name|old
operator|->
name|is_p
operator|=
name|is
operator|->
name|is_p
expr_stmt|;
name|old
operator|->
name|is_v
operator|=
name|is
operator|->
name|is_v
expr_stmt|;
name|old
operator|->
name|is_hv
operator|=
name|is
operator|->
name|is_hv
expr_stmt|;
name|old
operator|->
name|is_tag
operator|=
name|is
operator|->
name|is_tag
expr_stmt|;
name|old
operator|->
name|is_opt
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_opt
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_opt
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_opt
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_optmsk
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_optmsk
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_optmsk
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_optmsk
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_sec
operator|=
name|is
operator|->
name|is_sec
expr_stmt|;
name|old
operator|->
name|is_secmsk
operator|=
name|is
operator|->
name|is_secmsk
expr_stmt|;
name|old
operator|->
name|is_auth
operator|=
name|is
operator|->
name|is_auth
expr_stmt|;
name|old
operator|->
name|is_authmsk
operator|=
name|is
operator|->
name|is_authmsk
expr_stmt|;
name|ipf_v5tcpinfoto4
argument_list|(
operator|&
name|is
operator|->
name|is_tcp
argument_list|,
operator|&
name|old
operator|->
name|is_tcp
argument_list|)
expr_stmt|;
name|old
operator|->
name|is_flags
operator|=
name|is
operator|->
name|is_flags
expr_stmt|;
name|old
operator|->
name|is_flx
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_flx
index|[
literal|0
index|]
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_flx
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_flx
index|[
literal|0
index|]
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_flx
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_flx
index|[
literal|1
index|]
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_flx
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_flx
index|[
literal|1
index|]
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_rulen
operator|=
name|is
operator|->
name|is_rulen
expr_stmt|;
name|old
operator|->
name|is_s0
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_s0
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_s0
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_s0
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_smsk
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_smsk
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_smsk
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_smsk
index|[
literal|1
index|]
expr_stmt|;
name|bcopy
argument_list|(
name|is
operator|->
name|is_group
argument_list|,
name|old
operator|->
name|is_group
argument_list|,
sizeof|sizeof
argument_list|(
name|is
operator|->
name|is_group
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
name|is
operator|->
name|is_sbuf
argument_list|,
name|old
operator|->
name|is_sbuf
argument_list|,
sizeof|sizeof
argument_list|(
name|is
operator|->
name|is_sbuf
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
name|is
operator|->
name|is_ifname
argument_list|,
name|old
operator|->
name|is_ifname
argument_list|,
sizeof|sizeof
argument_list|(
name|is
operator|->
name|is_ifname
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|ipstate_current_to_4_1_0
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|ipstate_4_1_0_t
modifier|*
name|old
decl_stmt|;
block|{
name|ipstate_t
modifier|*
name|is
init|=
operator|(
name|ipstate_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|is_lock
operator|=
name|is
operator|->
name|is_lock
expr_stmt|;
name|old
operator|->
name|is_next
operator|=
name|is
operator|->
name|is_next
expr_stmt|;
name|old
operator|->
name|is_pnext
operator|=
name|is
operator|->
name|is_pnext
expr_stmt|;
name|old
operator|->
name|is_hnext
operator|=
name|is
operator|->
name|is_hnext
expr_stmt|;
name|old
operator|->
name|is_phnext
operator|=
name|is
operator|->
name|is_phnext
expr_stmt|;
name|old
operator|->
name|is_me
operator|=
name|is
operator|->
name|is_me
expr_stmt|;
name|old
operator|->
name|is_ifp
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_ifp
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_ifp
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_ifp
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_sync
operator|=
name|is
operator|->
name|is_sync
expr_stmt|;
name|bzero
argument_list|(
operator|&
name|old
operator|->
name|is_nat
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|is_nat
argument_list|)
argument_list|)
expr_stmt|;
name|old
operator|->
name|is_rule
operator|=
name|is
operator|->
name|is_rule
expr_stmt|;
name|old
operator|->
name|is_tqehead
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_tqehead
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_tqehead
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_tqehead
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_isc
operator|=
name|is
operator|->
name|is_isc
expr_stmt|;
name|old
operator|->
name|is_pkts
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_pkts
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_pkts
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_pkts
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_pkts
index|[
literal|2
index|]
operator|=
name|is
operator|->
name|is_pkts
index|[
literal|2
index|]
expr_stmt|;
name|old
operator|->
name|is_pkts
index|[
literal|3
index|]
operator|=
name|is
operator|->
name|is_pkts
index|[
literal|3
index|]
expr_stmt|;
name|old
operator|->
name|is_bytes
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_bytes
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_bytes
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_bytes
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_bytes
index|[
literal|2
index|]
operator|=
name|is
operator|->
name|is_bytes
index|[
literal|2
index|]
expr_stmt|;
name|old
operator|->
name|is_bytes
index|[
literal|3
index|]
operator|=
name|is
operator|->
name|is_bytes
index|[
literal|3
index|]
expr_stmt|;
name|old
operator|->
name|is_icmppkts
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_icmppkts
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_icmppkts
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_icmppkts
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_icmppkts
index|[
literal|2
index|]
operator|=
name|is
operator|->
name|is_icmppkts
index|[
literal|2
index|]
expr_stmt|;
name|old
operator|->
name|is_icmppkts
index|[
literal|3
index|]
operator|=
name|is
operator|->
name|is_icmppkts
index|[
literal|3
index|]
expr_stmt|;
name|old
operator|->
name|is_sti
operator|=
name|is
operator|->
name|is_sti
expr_stmt|;
name|old
operator|->
name|is_frage
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_frage
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_frage
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_frage
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_ref
operator|=
name|is
operator|->
name|is_ref
expr_stmt|;
name|old
operator|->
name|is_isninc
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_isninc
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_isninc
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_isninc
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_sumd
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_sumd
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_sumd
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_sumd
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_src
operator|=
name|is
operator|->
name|is_src
expr_stmt|;
name|old
operator|->
name|is_dst
operator|=
name|is
operator|->
name|is_dst
expr_stmt|;
name|old
operator|->
name|is_pass
operator|=
name|is
operator|->
name|is_pass
expr_stmt|;
name|old
operator|->
name|is_p
operator|=
name|is
operator|->
name|is_p
expr_stmt|;
name|old
operator|->
name|is_v
operator|=
name|is
operator|->
name|is_v
expr_stmt|;
name|old
operator|->
name|is_hv
operator|=
name|is
operator|->
name|is_hv
expr_stmt|;
name|old
operator|->
name|is_tag
operator|=
name|is
operator|->
name|is_tag
expr_stmt|;
name|old
operator|->
name|is_opt
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_opt
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_opt
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_opt
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_optmsk
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_optmsk
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_optmsk
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_optmsk
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_sec
operator|=
name|is
operator|->
name|is_sec
expr_stmt|;
name|old
operator|->
name|is_secmsk
operator|=
name|is
operator|->
name|is_secmsk
expr_stmt|;
name|old
operator|->
name|is_auth
operator|=
name|is
operator|->
name|is_auth
expr_stmt|;
name|old
operator|->
name|is_authmsk
operator|=
name|is
operator|->
name|is_authmsk
expr_stmt|;
name|ipf_v5tcpinfoto4
argument_list|(
operator|&
name|is
operator|->
name|is_tcp
argument_list|,
operator|&
name|old
operator|->
name|is_tcp
argument_list|)
expr_stmt|;
name|old
operator|->
name|is_flags
operator|=
name|is
operator|->
name|is_flags
expr_stmt|;
name|old
operator|->
name|is_flx
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_flx
index|[
literal|0
index|]
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_flx
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_flx
index|[
literal|0
index|]
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_flx
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_flx
index|[
literal|1
index|]
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_flx
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_flx
index|[
literal|1
index|]
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_rulen
operator|=
name|is
operator|->
name|is_rulen
expr_stmt|;
name|old
operator|->
name|is_s0
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_s0
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_s0
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_s0
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|is_smsk
index|[
literal|0
index|]
operator|=
name|is
operator|->
name|is_smsk
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|is_smsk
index|[
literal|1
index|]
operator|=
name|is
operator|->
name|is_smsk
index|[
literal|1
index|]
expr_stmt|;
name|bcopy
argument_list|(
name|is
operator|->
name|is_group
argument_list|,
name|old
operator|->
name|is_group
argument_list|,
sizeof|sizeof
argument_list|(
name|is
operator|->
name|is_group
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
name|is
operator|->
name|is_sbuf
argument_list|,
name|old
operator|->
name|is_sbuf
argument_list|,
sizeof|sizeof
argument_list|(
name|is
operator|->
name|is_sbuf
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
name|is
operator|->
name|is_ifname
argument_list|,
name|old
operator|->
name|is_ifname
argument_list|,
sizeof|sizeof
argument_list|(
name|is
operator|->
name|is_ifname
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|ips_stat_current_to_4_1_21
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|ips_stat_4_1_21_t
modifier|*
name|old
decl_stmt|;
block|{
name|ips_stat_t
modifier|*
name|st
init|=
operator|(
name|ips_stat_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|iss_hits
operator|=
name|st
operator|->
name|iss_hits
expr_stmt|;
name|old
operator|->
name|iss_miss
operator|=
name|st
operator|->
name|iss_check_miss
expr_stmt|;
name|old
operator|->
name|iss_max
operator|=
name|st
operator|->
name|iss_max
expr_stmt|;
name|old
operator|->
name|iss_maxref
operator|=
name|st
operator|->
name|iss_max_ref
expr_stmt|;
name|old
operator|->
name|iss_tcp
operator|=
name|st
operator|->
name|iss_proto
index|[
name|IPPROTO_TCP
index|]
expr_stmt|;
name|old
operator|->
name|iss_udp
operator|=
name|st
operator|->
name|iss_proto
index|[
name|IPPROTO_UDP
index|]
expr_stmt|;
name|old
operator|->
name|iss_icmp
operator|=
name|st
operator|->
name|iss_proto
index|[
name|IPPROTO_ICMP
index|]
expr_stmt|;
name|old
operator|->
name|iss_nomem
operator|=
name|st
operator|->
name|iss_nomem
expr_stmt|;
name|old
operator|->
name|iss_expire
operator|=
name|st
operator|->
name|iss_expire
expr_stmt|;
name|old
operator|->
name|iss_fin
operator|=
name|st
operator|->
name|iss_fin
expr_stmt|;
name|old
operator|->
name|iss_active
operator|=
name|st
operator|->
name|iss_active
expr_stmt|;
name|old
operator|->
name|iss_logged
operator|=
name|st
operator|->
name|iss_log_ok
expr_stmt|;
name|old
operator|->
name|iss_logfail
operator|=
name|st
operator|->
name|iss_log_fail
expr_stmt|;
name|old
operator|->
name|iss_inuse
operator|=
name|st
operator|->
name|iss_inuse
expr_stmt|;
name|old
operator|->
name|iss_wild
operator|=
name|st
operator|->
name|iss_wild
expr_stmt|;
name|old
operator|->
name|iss_ticks
operator|=
name|st
operator|->
name|iss_ticks
expr_stmt|;
name|old
operator|->
name|iss_bucketfull
operator|=
name|st
operator|->
name|iss_bucket_full
expr_stmt|;
name|old
operator|->
name|iss_statesize
operator|=
name|st
operator|->
name|iss_state_size
expr_stmt|;
name|old
operator|->
name|iss_statemax
operator|=
name|st
operator|->
name|iss_state_max
expr_stmt|;
name|old
operator|->
name|iss_table
operator|=
name|st
operator|->
name|iss_table
expr_stmt|;
name|old
operator|->
name|iss_list
operator|=
name|st
operator|->
name|iss_list
expr_stmt|;
name|old
operator|->
name|iss_bucketlen
operator|=
operator|(
name|void
operator|*
operator|)
name|st
operator|->
name|iss_bucketlen
expr_stmt|;
name|old
operator|->
name|iss_tcptab
operator|=
name|st
operator|->
name|iss_tcptab
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|ips_stat_current_to_4_1_0
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|ips_stat_4_1_0_t
modifier|*
name|old
decl_stmt|;
block|{
name|ips_stat_t
modifier|*
name|st
init|=
operator|(
name|ips_stat_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|iss_hits
operator|=
name|st
operator|->
name|iss_hits
expr_stmt|;
name|old
operator|->
name|iss_miss
operator|=
name|st
operator|->
name|iss_check_miss
expr_stmt|;
name|old
operator|->
name|iss_max
operator|=
name|st
operator|->
name|iss_max
expr_stmt|;
name|old
operator|->
name|iss_maxref
operator|=
name|st
operator|->
name|iss_max_ref
expr_stmt|;
name|old
operator|->
name|iss_tcp
operator|=
name|st
operator|->
name|iss_proto
index|[
name|IPPROTO_TCP
index|]
expr_stmt|;
name|old
operator|->
name|iss_udp
operator|=
name|st
operator|->
name|iss_proto
index|[
name|IPPROTO_UDP
index|]
expr_stmt|;
name|old
operator|->
name|iss_icmp
operator|=
name|st
operator|->
name|iss_proto
index|[
name|IPPROTO_ICMP
index|]
expr_stmt|;
name|old
operator|->
name|iss_nomem
operator|=
name|st
operator|->
name|iss_nomem
expr_stmt|;
name|old
operator|->
name|iss_expire
operator|=
name|st
operator|->
name|iss_expire
expr_stmt|;
name|old
operator|->
name|iss_fin
operator|=
name|st
operator|->
name|iss_fin
expr_stmt|;
name|old
operator|->
name|iss_active
operator|=
name|st
operator|->
name|iss_active
expr_stmt|;
name|old
operator|->
name|iss_logged
operator|=
name|st
operator|->
name|iss_log_ok
expr_stmt|;
name|old
operator|->
name|iss_logfail
operator|=
name|st
operator|->
name|iss_log_fail
expr_stmt|;
name|old
operator|->
name|iss_inuse
operator|=
name|st
operator|->
name|iss_inuse
expr_stmt|;
name|old
operator|->
name|iss_wild
operator|=
name|st
operator|->
name|iss_wild
expr_stmt|;
name|old
operator|->
name|iss_ticks
operator|=
name|st
operator|->
name|iss_ticks
expr_stmt|;
name|old
operator|->
name|iss_bucketfull
operator|=
name|st
operator|->
name|iss_bucket_full
expr_stmt|;
name|old
operator|->
name|iss_statesize
operator|=
name|st
operator|->
name|iss_state_size
expr_stmt|;
name|old
operator|->
name|iss_statemax
operator|=
name|st
operator|->
name|iss_state_max
expr_stmt|;
name|old
operator|->
name|iss_table
operator|=
name|st
operator|->
name|iss_table
expr_stmt|;
name|old
operator|->
name|iss_list
operator|=
name|st
operator|->
name|iss_list
expr_stmt|;
name|old
operator|->
name|iss_bucketlen
operator|=
operator|(
name|void
operator|*
operator|)
name|st
operator|->
name|iss_bucketlen
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|nat_save_current_to_4_1_16
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|nat_save_4_1_16_t
modifier|*
name|old
decl_stmt|;
block|{
name|nat_save_t
modifier|*
name|nats
init|=
operator|(
name|nat_save_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|ipn_next
operator|=
name|nats
operator|->
name|ipn_next
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|nats
operator|->
name|ipn_nat
argument_list|,
operator|&
name|old
operator|->
name|ipn_nat
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|ipn_nat
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|nats
operator|->
name|ipn_ipnat
argument_list|,
operator|&
name|old
operator|->
name|ipn_ipnat
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|ipn_ipnat
argument_list|)
argument_list|)
expr_stmt|;
name|frentry_current_to_4_1_16
argument_list|(
operator|&
name|nats
operator|->
name|ipn_fr
argument_list|,
operator|&
name|old
operator|->
name|ipn_fr
argument_list|)
expr_stmt|;
name|old
operator|->
name|ipn_dsize
operator|=
name|nats
operator|->
name|ipn_dsize
expr_stmt|;
name|bcopy
argument_list|(
name|nats
operator|->
name|ipn_data
argument_list|,
name|old
operator|->
name|ipn_data
argument_list|,
sizeof|sizeof
argument_list|(
name|nats
operator|->
name|ipn_data
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|nat_save_current_to_4_1_14
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|nat_save_4_1_14_t
modifier|*
name|old
decl_stmt|;
block|{
name|nat_save_t
modifier|*
name|nats
init|=
operator|(
name|nat_save_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|ipn_next
operator|=
name|nats
operator|->
name|ipn_next
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|nats
operator|->
name|ipn_nat
argument_list|,
operator|&
name|old
operator|->
name|ipn_nat
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|ipn_nat
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|nats
operator|->
name|ipn_ipnat
argument_list|,
operator|&
name|old
operator|->
name|ipn_ipnat
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|ipn_ipnat
argument_list|)
argument_list|)
expr_stmt|;
name|frentry_current_to_4_1_0
argument_list|(
operator|&
name|nats
operator|->
name|ipn_fr
argument_list|,
operator|&
name|old
operator|->
name|ipn_fr
argument_list|)
expr_stmt|;
name|old
operator|->
name|ipn_dsize
operator|=
name|nats
operator|->
name|ipn_dsize
expr_stmt|;
name|bcopy
argument_list|(
name|nats
operator|->
name|ipn_data
argument_list|,
name|old
operator|->
name|ipn_data
argument_list|,
sizeof|sizeof
argument_list|(
name|nats
operator|->
name|ipn_data
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|nat_save_current_to_4_1_3
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|nat_save_4_1_3_t
modifier|*
name|old
decl_stmt|;
block|{
name|nat_save_t
modifier|*
name|nats
init|=
operator|(
name|nat_save_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|ipn_next
operator|=
name|nats
operator|->
name|ipn_next
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|nats
operator|->
name|ipn_nat
argument_list|,
operator|&
name|old
operator|->
name|ipn_nat
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|ipn_nat
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|&
name|nats
operator|->
name|ipn_ipnat
argument_list|,
operator|&
name|old
operator|->
name|ipn_ipnat
argument_list|,
sizeof|sizeof
argument_list|(
name|old
operator|->
name|ipn_ipnat
argument_list|)
argument_list|)
expr_stmt|;
name|frentry_current_to_4_1_0
argument_list|(
operator|&
name|nats
operator|->
name|ipn_fr
argument_list|,
operator|&
name|old
operator|->
name|ipn_fr
argument_list|)
expr_stmt|;
name|old
operator|->
name|ipn_dsize
operator|=
name|nats
operator|->
name|ipn_dsize
expr_stmt|;
name|bcopy
argument_list|(
name|nats
operator|->
name|ipn_data
argument_list|,
name|old
operator|->
name|ipn_data
argument_list|,
sizeof|sizeof
argument_list|(
name|nats
operator|->
name|ipn_data
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|nat_current_to_4_1_25
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|nat_4_1_25_t
modifier|*
name|old
decl_stmt|;
block|{
name|nat_t
modifier|*
name|nat
init|=
operator|(
name|nat_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|nat_lock
operator|=
name|nat
operator|->
name|nat_lock
expr_stmt|;
name|old
operator|->
name|nat_next
operator|=
operator|(
name|void
operator|*
operator|)
name|nat
operator|->
name|nat_next
expr_stmt|;
name|old
operator|->
name|nat_pnext
operator|=
operator|(
name|void
operator|*
operator|)
name|nat
operator|->
name|nat_pnext
expr_stmt|;
name|old
operator|->
name|nat_hnext
index|[
literal|0
index|]
operator|=
operator|(
name|void
operator|*
operator|)
name|nat
operator|->
name|nat_hnext
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_hnext
index|[
literal|1
index|]
operator|=
operator|(
name|void
operator|*
operator|)
name|nat
operator|->
name|nat_hnext
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|nat_phnext
index|[
literal|0
index|]
operator|=
operator|(
name|void
operator|*
operator|)
name|nat
operator|->
name|nat_phnext
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_phnext
index|[
literal|1
index|]
operator|=
operator|(
name|void
operator|*
operator|)
name|nat
operator|->
name|nat_phnext
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|nat_hm
operator|=
name|nat
operator|->
name|nat_hm
expr_stmt|;
name|old
operator|->
name|nat_data
operator|=
name|nat
operator|->
name|nat_data
expr_stmt|;
name|old
operator|->
name|nat_me
operator|=
operator|(
name|void
operator|*
operator|)
name|nat
operator|->
name|nat_me
expr_stmt|;
name|old
operator|->
name|nat_state
operator|=
name|nat
operator|->
name|nat_state
expr_stmt|;
name|old
operator|->
name|nat_aps
operator|=
name|nat
operator|->
name|nat_aps
expr_stmt|;
name|old
operator|->
name|nat_fr
operator|=
name|nat
operator|->
name|nat_fr
expr_stmt|;
name|old
operator|->
name|nat_ptr
operator|=
operator|(
name|void
operator|*
operator|)
name|nat
operator|->
name|nat_ptr
expr_stmt|;
name|old
operator|->
name|nat_ifps
index|[
literal|0
index|]
operator|=
name|nat
operator|->
name|nat_ifps
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_ifps
index|[
literal|1
index|]
operator|=
name|nat
operator|->
name|nat_ifps
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|nat_sync
operator|=
name|nat
operator|->
name|nat_sync
expr_stmt|;
name|old
operator|->
name|nat_tqe
operator|=
name|nat
operator|->
name|nat_tqe
expr_stmt|;
name|old
operator|->
name|nat_flags
operator|=
name|nat
operator|->
name|nat_flags
expr_stmt|;
name|old
operator|->
name|nat_sumd
index|[
literal|0
index|]
operator|=
name|nat
operator|->
name|nat_sumd
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_sumd
index|[
literal|1
index|]
operator|=
name|nat
operator|->
name|nat_sumd
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|nat_ipsumd
operator|=
name|nat
operator|->
name|nat_ipsumd
expr_stmt|;
name|old
operator|->
name|nat_mssclamp
operator|=
name|nat
operator|->
name|nat_mssclamp
expr_stmt|;
name|old
operator|->
name|nat_pkts
index|[
literal|0
index|]
operator|=
name|nat
operator|->
name|nat_pkts
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_pkts
index|[
literal|1
index|]
operator|=
name|nat
operator|->
name|nat_pkts
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|nat_bytes
index|[
literal|0
index|]
operator|=
name|nat
operator|->
name|nat_bytes
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_bytes
index|[
literal|1
index|]
operator|=
name|nat
operator|->
name|nat_bytes
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|nat_ref
operator|=
name|nat
operator|->
name|nat_ref
expr_stmt|;
name|old
operator|->
name|nat_dir
operator|=
name|nat
operator|->
name|nat_dir
expr_stmt|;
name|old
operator|->
name|nat_p
operator|=
name|nat
operator|->
name|nat_pr
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_use
operator|=
name|nat
operator|->
name|nat_use
expr_stmt|;
name|old
operator|->
name|nat_hv
index|[
literal|0
index|]
operator|=
name|nat
operator|->
name|nat_hv
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_hv
index|[
literal|1
index|]
operator|=
name|nat
operator|->
name|nat_hv
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|nat_rev
operator|=
name|nat
operator|->
name|nat_rev
expr_stmt|;
name|old
operator|->
name|nat_redir
operator|=
name|nat
operator|->
name|nat_redir
expr_stmt|;
name|bcopy
argument_list|(
name|nat
operator|->
name|nat_ifnames
index|[
literal|0
index|]
argument_list|,
name|old
operator|->
name|nat_ifnames
index|[
literal|0
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
name|nat
operator|->
name|nat_ifnames
index|[
literal|1
index|]
argument_list|,
name|old
operator|->
name|nat_ifnames
index|[
literal|1
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
if|if
condition|(
name|nat
operator|->
name|nat_redir
operator|==
name|NAT_REDIRECT
condition|)
block|{
name|old
operator|->
name|nat_inip6
operator|=
name|nat
operator|->
name|nat_ndst6
expr_stmt|;
name|old
operator|->
name|nat_outip6
operator|=
name|nat
operator|->
name|nat_odst6
expr_stmt|;
name|old
operator|->
name|nat_oip6
operator|=
name|nat
operator|->
name|nat_osrc6
expr_stmt|;
name|old
operator|->
name|nat_un
operator|.
name|nat_unt
operator|.
name|ts_sport
operator|=
name|nat
operator|->
name|nat_ndport
expr_stmt|;
name|old
operator|->
name|nat_un
operator|.
name|nat_unt
operator|.
name|ts_dport
operator|=
name|nat
operator|->
name|nat_odport
expr_stmt|;
block|}
else|else
block|{
name|old
operator|->
name|nat_inip6
operator|=
name|nat
operator|->
name|nat_osrc6
expr_stmt|;
name|old
operator|->
name|nat_outip6
operator|=
name|nat
operator|->
name|nat_nsrc6
expr_stmt|;
name|old
operator|->
name|nat_oip6
operator|=
name|nat
operator|->
name|nat_odst6
expr_stmt|;
name|old
operator|->
name|nat_un
operator|.
name|nat_unt
operator|.
name|ts_sport
operator|=
name|nat
operator|->
name|nat_osport
expr_stmt|;
name|old
operator|->
name|nat_un
operator|.
name|nat_unt
operator|.
name|ts_dport
operator|=
name|nat
operator|->
name|nat_nsport
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|nat_current_to_4_1_14
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|nat_4_1_14_t
modifier|*
name|old
decl_stmt|;
block|{
name|nat_t
modifier|*
name|nat
init|=
operator|(
name|nat_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|nat_lock
operator|=
name|nat
operator|->
name|nat_lock
expr_stmt|;
name|old
operator|->
name|nat_next
operator|=
name|nat
operator|->
name|nat_next
expr_stmt|;
name|old
operator|->
name|nat_pnext
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|nat_hnext
index|[
literal|0
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|nat_hnext
index|[
literal|1
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|nat_phnext
index|[
literal|0
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|nat_phnext
index|[
literal|1
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|nat_hm
operator|=
name|nat
operator|->
name|nat_hm
expr_stmt|;
name|old
operator|->
name|nat_data
operator|=
name|nat
operator|->
name|nat_data
expr_stmt|;
name|old
operator|->
name|nat_me
operator|=
operator|(
name|void
operator|*
operator|)
name|nat
operator|->
name|nat_me
expr_stmt|;
name|old
operator|->
name|nat_state
operator|=
name|nat
operator|->
name|nat_state
expr_stmt|;
name|old
operator|->
name|nat_aps
operator|=
name|nat
operator|->
name|nat_aps
expr_stmt|;
name|old
operator|->
name|nat_fr
operator|=
name|nat
operator|->
name|nat_fr
expr_stmt|;
name|old
operator|->
name|nat_ptr
operator|=
name|nat
operator|->
name|nat_ptr
expr_stmt|;
name|old
operator|->
name|nat_ifps
index|[
literal|0
index|]
operator|=
name|nat
operator|->
name|nat_ifps
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_ifps
index|[
literal|1
index|]
operator|=
name|nat
operator|->
name|nat_ifps
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|nat_sync
operator|=
name|nat
operator|->
name|nat_sync
expr_stmt|;
name|old
operator|->
name|nat_tqe
operator|=
name|nat
operator|->
name|nat_tqe
expr_stmt|;
name|old
operator|->
name|nat_flags
operator|=
name|nat
operator|->
name|nat_flags
expr_stmt|;
name|old
operator|->
name|nat_sumd
index|[
literal|0
index|]
operator|=
name|nat
operator|->
name|nat_sumd
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_sumd
index|[
literal|1
index|]
operator|=
name|nat
operator|->
name|nat_sumd
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|nat_ipsumd
operator|=
name|nat
operator|->
name|nat_ipsumd
expr_stmt|;
name|old
operator|->
name|nat_mssclamp
operator|=
name|nat
operator|->
name|nat_mssclamp
expr_stmt|;
name|old
operator|->
name|nat_pkts
index|[
literal|0
index|]
operator|=
name|nat
operator|->
name|nat_pkts
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_pkts
index|[
literal|1
index|]
operator|=
name|nat
operator|->
name|nat_pkts
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|nat_bytes
index|[
literal|0
index|]
operator|=
name|nat
operator|->
name|nat_bytes
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_bytes
index|[
literal|1
index|]
operator|=
name|nat
operator|->
name|nat_bytes
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|nat_ref
operator|=
name|nat
operator|->
name|nat_ref
expr_stmt|;
name|old
operator|->
name|nat_dir
operator|=
name|nat
operator|->
name|nat_dir
expr_stmt|;
name|old
operator|->
name|nat_p
operator|=
name|nat
operator|->
name|nat_pr
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_use
operator|=
name|nat
operator|->
name|nat_use
expr_stmt|;
name|old
operator|->
name|nat_hv
index|[
literal|0
index|]
operator|=
name|nat
operator|->
name|nat_hv
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_hv
index|[
literal|1
index|]
operator|=
name|nat
operator|->
name|nat_hv
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|nat_rev
operator|=
name|nat
operator|->
name|nat_rev
expr_stmt|;
name|bcopy
argument_list|(
name|nat
operator|->
name|nat_ifnames
index|[
literal|0
index|]
argument_list|,
name|old
operator|->
name|nat_ifnames
index|[
literal|0
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
name|nat
operator|->
name|nat_ifnames
index|[
literal|1
index|]
argument_list|,
name|old
operator|->
name|nat_ifnames
index|[
literal|1
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
if|if
condition|(
name|nat
operator|->
name|nat_redir
operator|==
name|NAT_REDIRECT
condition|)
block|{
name|old
operator|->
name|nat_inip6
operator|=
name|nat
operator|->
name|nat_ndst6
expr_stmt|;
name|old
operator|->
name|nat_outip6
operator|=
name|nat
operator|->
name|nat_odst6
expr_stmt|;
name|old
operator|->
name|nat_oip6
operator|=
name|nat
operator|->
name|nat_osrc6
expr_stmt|;
name|old
operator|->
name|nat_un
operator|.
name|nat_unt
operator|.
name|ts_sport
operator|=
name|nat
operator|->
name|nat_ndport
expr_stmt|;
name|old
operator|->
name|nat_un
operator|.
name|nat_unt
operator|.
name|ts_dport
operator|=
name|nat
operator|->
name|nat_odport
expr_stmt|;
block|}
else|else
block|{
name|old
operator|->
name|nat_inip6
operator|=
name|nat
operator|->
name|nat_osrc6
expr_stmt|;
name|old
operator|->
name|nat_outip6
operator|=
name|nat
operator|->
name|nat_nsrc6
expr_stmt|;
name|old
operator|->
name|nat_oip6
operator|=
name|nat
operator|->
name|nat_odst6
expr_stmt|;
name|old
operator|->
name|nat_un
operator|.
name|nat_unt
operator|.
name|ts_sport
operator|=
name|nat
operator|->
name|nat_osport
expr_stmt|;
name|old
operator|->
name|nat_un
operator|.
name|nat_unt
operator|.
name|ts_dport
operator|=
name|nat
operator|->
name|nat_nsport
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|nat_current_to_4_1_3
parameter_list|(
name|current
parameter_list|,
name|old
parameter_list|)
name|void
modifier|*
name|current
decl_stmt|;
name|nat_4_1_3_t
modifier|*
name|old
decl_stmt|;
block|{
name|nat_t
modifier|*
name|nat
init|=
operator|(
name|nat_t
operator|*
operator|)
name|current
decl_stmt|;
name|old
operator|->
name|nat_lock
operator|=
name|nat
operator|->
name|nat_lock
expr_stmt|;
name|old
operator|->
name|nat_next
operator|=
name|nat
operator|->
name|nat_next
expr_stmt|;
name|old
operator|->
name|nat_pnext
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|nat_hnext
index|[
literal|0
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|nat_hnext
index|[
literal|1
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|nat_phnext
index|[
literal|0
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|nat_phnext
index|[
literal|1
index|]
operator|=
name|NULL
expr_stmt|;
name|old
operator|->
name|nat_hm
operator|=
name|nat
operator|->
name|nat_hm
expr_stmt|;
name|old
operator|->
name|nat_data
operator|=
name|nat
operator|->
name|nat_data
expr_stmt|;
name|old
operator|->
name|nat_me
operator|=
operator|(
name|void
operator|*
operator|)
name|nat
operator|->
name|nat_me
expr_stmt|;
name|old
operator|->
name|nat_state
operator|=
name|nat
operator|->
name|nat_state
expr_stmt|;
name|old
operator|->
name|nat_aps
operator|=
name|nat
operator|->
name|nat_aps
expr_stmt|;
name|old
operator|->
name|nat_fr
operator|=
name|nat
operator|->
name|nat_fr
expr_stmt|;
name|old
operator|->
name|nat_ptr
operator|=
name|nat
operator|->
name|nat_ptr
expr_stmt|;
name|old
operator|->
name|nat_ifps
index|[
literal|0
index|]
operator|=
name|nat
operator|->
name|nat_ifps
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_ifps
index|[
literal|1
index|]
operator|=
name|nat
operator|->
name|nat_ifps
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|nat_sync
operator|=
name|nat
operator|->
name|nat_sync
expr_stmt|;
name|old
operator|->
name|nat_tqe
operator|=
name|nat
operator|->
name|nat_tqe
expr_stmt|;
name|old
operator|->
name|nat_flags
operator|=
name|nat
operator|->
name|nat_flags
expr_stmt|;
name|old
operator|->
name|nat_sumd
index|[
literal|0
index|]
operator|=
name|nat
operator|->
name|nat_sumd
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_sumd
index|[
literal|1
index|]
operator|=
name|nat
operator|->
name|nat_sumd
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|nat_ipsumd
operator|=
name|nat
operator|->
name|nat_ipsumd
expr_stmt|;
name|old
operator|->
name|nat_mssclamp
operator|=
name|nat
operator|->
name|nat_mssclamp
expr_stmt|;
name|old
operator|->
name|nat_pkts
index|[
literal|0
index|]
operator|=
name|nat
operator|->
name|nat_pkts
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_pkts
index|[
literal|1
index|]
operator|=
name|nat
operator|->
name|nat_pkts
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|nat_bytes
index|[
literal|0
index|]
operator|=
name|nat
operator|->
name|nat_bytes
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_bytes
index|[
literal|1
index|]
operator|=
name|nat
operator|->
name|nat_bytes
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|nat_ref
operator|=
name|nat
operator|->
name|nat_ref
expr_stmt|;
name|old
operator|->
name|nat_dir
operator|=
name|nat
operator|->
name|nat_dir
expr_stmt|;
name|old
operator|->
name|nat_p
operator|=
name|nat
operator|->
name|nat_pr
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_use
operator|=
name|nat
operator|->
name|nat_use
expr_stmt|;
name|old
operator|->
name|nat_hv
index|[
literal|0
index|]
operator|=
name|nat
operator|->
name|nat_hv
index|[
literal|0
index|]
expr_stmt|;
name|old
operator|->
name|nat_hv
index|[
literal|1
index|]
operator|=
name|nat
operator|->
name|nat_hv
index|[
literal|1
index|]
expr_stmt|;
name|old
operator|->
name|nat_rev
operator|=
name|nat
operator|->
name|nat_rev
expr_stmt|;
name|bcopy
argument_list|(
name|nat
operator|->
name|nat_ifnames
index|[
literal|0
index|]
argument_list|,
name|old
operator|->
name|nat_ifnames
index|[
literal|0
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
name|nat
operator|->
name|nat_ifnames
index|[
literal|1
index|]
argument_list|,
name|old
operator|->
name|nat_ifnames
index|[
literal|1
index|]
argument_list|,
name|LIFNAMSIZ
argument_list|)
expr_stmt|;
if|if
condition|(
name|nat
operator|->
name|nat_redir
operator|==
name|NAT_REDIRECT
condition|)
block|{
name|old
operator|->
name|nat_inip6
operator|=
name|nat
operator|->
name|nat_ndst6
expr_stmt|;
name|old
operator|->
name|nat_outip6
operator|=
name|nat
operator|->
name|nat_odst6
expr_stmt|;
name|old
operator|->
name|nat_oip6
operator|=
name|nat
operator|->
name|nat_osrc6
expr_stmt|;
name|old
operator|->
name|nat_un
operator|.
name|nat_unt
operator|.
name|ts_sport
operator|=
name|nat
operator|->
name|nat_ndport
expr_stmt|;
name|old
operator|->
name|nat_un
operator|.
name|nat_unt
operator|.
name|ts_dport
operator|=
name|nat
operator|->
name|nat_odport
expr_stmt|;
block|}
else|else
block|{
name|old
operator|->
name|nat_inip6
operator|=
name|nat
operator|->
name|nat_osrc6
expr_stmt|;
name|old
operator|->
name|nat_outip6
operator|=
name|nat
operator|->
name|nat_nsrc6
expr_stmt|;
name|old
operator|->
name|nat_oip6
operator|=
name|nat
operator|->
name|nat_odst6
expr_stmt|;
name|old
operator|->
name|nat_un
operator|.
name|nat_unt
operator|.
name|ts_sport
operator|=
name|nat
operator|->
name|nat_osport
expr_stmt|;
name|old
operator|->
name|nat_un
operator|.
name|nat_unt
operator|.
name|ts_dport
operator|=
name|nat
operator|->
name|nat_nsport
expr_stmt|;
block|}
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* IPFILTER_COMPAT */
end_comment

end_unit

