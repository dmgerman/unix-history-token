begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|"gmp.h"
end_include

begin_include
include|#
directive|include
file|"gmp-impl.h"
end_include

begin_include
include|#
directive|include
file|"longlong.h"
end_include

begin_ifndef
ifndef|#
directive|ifndef
name|USG
end_ifndef

begin_include
include|#
directive|include
file|<sys/time.h>
end_include

begin_include
include|#
directive|include
file|<sys/resource.h>
end_include

begin_function
name|unsigned
name|long
name|cputime
parameter_list|()
block|{
name|struct
name|rusage
name|rus
decl_stmt|;
name|getrusage
argument_list|(
literal|0
argument_list|,
operator|&
name|rus
argument_list|)
expr_stmt|;
return|return
name|rus
operator|.
name|ru_utime
operator|.
name|tv_sec
operator|*
literal|1000
operator|+
name|rus
operator|.
name|ru_utime
operator|.
name|tv_usec
operator|/
literal|1000
return|;
block|}
end_function

begin_else
else|#
directive|else
end_else

begin_include
include|#
directive|include
file|<time.h>
end_include

begin_ifndef
ifndef|#
directive|ifndef
name|CLOCKS_PER_SEC
end_ifndef

begin_define
define|#
directive|define
name|CLOCKS_PER_SEC
value|1000000
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
name|CLOCKS_PER_SEC
operator|>=
literal|10000
end_if

begin_define
define|#
directive|define
name|CLOCK_TO_MILLISEC
parameter_list|(
name|cl
parameter_list|)
value|((cl) / (CLOCKS_PER_SEC / 1000))
end_define

begin_else
else|#
directive|else
end_else

begin_define
define|#
directive|define
name|CLOCK_TO_MILLISEC
parameter_list|(
name|cl
parameter_list|)
value|((cl) * 1000 / CLOCKS_PER_SEC)
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_function
name|unsigned
name|long
name|cputime
parameter_list|()
block|{
return|return
name|CLOCK_TO_MILLISEC
argument_list|(
name|clock
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_define
define|#
directive|define
name|M
value|* 1000000
end_define

begin_ifndef
ifndef|#
directive|ifndef
name|CLOCK
end_ifndef

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__m88k__
argument_list|)
end_if

begin_define
define|#
directive|define
name|CLOCK
value|20 M
end_define

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|__i386__
argument_list|)
end_elif

begin_define
define|#
directive|define
name|CLOCK
value|(16.666667 M)
end_define

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|__m68k__
argument_list|)
end_elif

begin_define
define|#
directive|define
name|CLOCK
value|(20 M)
end_define

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|_IBMR2
argument_list|)
end_elif

begin_define
define|#
directive|define
name|CLOCK
value|(25 M)
end_define

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|__sparc__
argument_list|)
end_elif

begin_define
define|#
directive|define
name|CLOCK
value|(20 M)
end_define

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|__sun__
argument_list|)
end_elif

begin_define
define|#
directive|define
name|CLOCK
value|(20 M)
end_define

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|__mips
argument_list|)
end_elif

begin_define
define|#
directive|define
name|CLOCK
value|(40 M)
end_define

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|__hppa__
argument_list|)
end_elif

begin_define
define|#
directive|define
name|CLOCK
value|(50 M)
end_define

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|__alpha
argument_list|)
end_elif

begin_define
define|#
directive|define
name|CLOCK
value|(133 M)
end_define

begin_else
else|#
directive|else
end_else

begin_error
error|#
directive|error
literal|"Don't know CLOCK of your machine"
end_error

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|OPS
end_ifndef

begin_define
define|#
directive|define
name|OPS
value|20000000
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|SIZE
end_ifndef

begin_define
define|#
directive|define
name|SIZE
value|100
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|TIMES
end_ifndef

begin_define
define|#
directive|define
name|TIMES
value|OPS/SIZE
end_define

begin_else
else|#
directive|else
end_else

begin_undef
undef|#
directive|undef
name|OPS
end_undef

begin_define
define|#
directive|define
name|OPS
value|(SIZE*TIMES)
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_function
name|main
parameter_list|()
block|{
name|mp_limb_t
name|nptr
index|[
literal|2
operator|*
name|SIZE
index|]
decl_stmt|;
name|mp_limb_t
name|dptr
index|[
name|SIZE
index|]
decl_stmt|;
name|mp_limb_t
name|qptr
index|[
literal|2
operator|*
name|SIZE
index|]
decl_stmt|;
name|mp_limb_t
name|pptr
index|[
literal|2
operator|*
name|SIZE
index|]
decl_stmt|;
name|mp_limb_t
name|rptr
index|[
literal|2
operator|*
name|SIZE
index|]
decl_stmt|;
name|mp_size_t
name|nsize
decl_stmt|,
name|dsize
decl_stmt|,
name|qsize
decl_stmt|,
name|rsize
decl_stmt|,
name|psize
decl_stmt|;
name|int
name|test
decl_stmt|;
name|mp_limb_t
name|qlimb
decl_stmt|;
for|for
control|(
name|test
operator|=
literal|0
init|;
condition|;
name|test
operator|++
control|)
block|{
ifdef|#
directive|ifdef
name|RANDOM
name|nsize
operator|=
name|random
argument_list|()
operator|%
operator|(
literal|2
operator|*
name|SIZE
operator|)
operator|+
literal|1
expr_stmt|;
name|dsize
operator|=
name|random
argument_list|()
operator|%
name|nsize
operator|+
literal|1
expr_stmt|;
else|#
directive|else
name|nsize
operator|=
literal|2
operator|*
name|SIZE
expr_stmt|;
name|dsize
operator|=
name|SIZE
expr_stmt|;
endif|#
directive|endif
name|mpn_random2
argument_list|(
name|nptr
argument_list|,
name|nsize
argument_list|)
expr_stmt|;
name|mpn_random2
argument_list|(
name|dptr
argument_list|,
name|dsize
argument_list|)
expr_stmt|;
name|dptr
index|[
name|dsize
operator|-
literal|1
index|]
operator||=
operator|(
name|mp_limb_t
operator|)
literal|1
operator|<<
operator|(
name|BITS_PER_MP_LIMB
operator|-
literal|1
operator|)
expr_stmt|;
name|MPN_COPY
argument_list|(
name|rptr
argument_list|,
name|nptr
argument_list|,
name|nsize
argument_list|)
expr_stmt|;
name|qlimb
operator|=
name|mpn_divrem
argument_list|(
name|qptr
argument_list|,
operator|(
name|mp_size_t
operator|)
literal|0
argument_list|,
name|rptr
argument_list|,
name|nsize
argument_list|,
name|dptr
argument_list|,
name|dsize
argument_list|)
expr_stmt|;
name|rsize
operator|=
name|dsize
expr_stmt|;
name|qsize
operator|=
name|nsize
operator|-
name|dsize
expr_stmt|;
name|qptr
index|[
name|qsize
index|]
operator|=
name|qlimb
expr_stmt|;
name|qsize
operator|+=
name|qlimb
expr_stmt|;
if|if
condition|(
name|qsize
operator|==
literal|0
operator|||
name|qsize
operator|>
literal|2
operator|*
name|SIZE
condition|)
block|{
continue|continue;
comment|/* bogus */
block|}
else|else
block|{
name|mp_limb_t
name|cy
decl_stmt|;
if|if
condition|(
name|qsize
operator|>
name|dsize
condition|)
name|mpn_mul
argument_list|(
name|pptr
argument_list|,
name|qptr
argument_list|,
name|qsize
argument_list|,
name|dptr
argument_list|,
name|dsize
argument_list|)
expr_stmt|;
else|else
name|mpn_mul
argument_list|(
name|pptr
argument_list|,
name|dptr
argument_list|,
name|dsize
argument_list|,
name|qptr
argument_list|,
name|qsize
argument_list|)
expr_stmt|;
name|psize
operator|=
name|qsize
operator|+
name|dsize
expr_stmt|;
name|psize
operator|-=
name|pptr
index|[
name|psize
operator|-
literal|1
index|]
operator|==
literal|0
expr_stmt|;
name|cy
operator|=
name|mpn_add
argument_list|(
name|pptr
argument_list|,
name|pptr
argument_list|,
name|psize
argument_list|,
name|rptr
argument_list|,
name|rsize
argument_list|)
expr_stmt|;
name|pptr
index|[
name|psize
index|]
operator|=
name|cy
expr_stmt|;
name|psize
operator|+=
name|cy
expr_stmt|;
block|}
if|if
condition|(
name|nsize
operator|!=
name|psize
operator|||
name|mpn_cmp
argument_list|(
name|nptr
argument_list|,
name|pptr
argument_list|,
name|nsize
argument_list|)
operator|!=
literal|0
condition|)
name|abort
argument_list|()
expr_stmt|;
block|}
block|}
end_function

end_unit

