begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (c) 2004 Marcel Moolenaar  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  *  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR  * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES  * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,  * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT  * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,  * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY  * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF  * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  */
end_comment

begin_include
include|#
directive|include
file|"defs.h"
end_include

begin_include
include|#
directive|include
file|"gdb_string.h"
end_include

begin_include
include|#
directive|include
file|"regcache.h"
end_include

begin_include
include|#
directive|include
file|"regset.h"
end_include

begin_include
include|#
directive|include
file|"solib-svr4.h"
end_include

begin_include
include|#
directive|include
file|"value.h"
end_include

begin_include
include|#
directive|include
file|"ia64-tdep.h"
end_include

begin_define
define|#
directive|define
name|FPREG_SUPPLIES
parameter_list|(
name|r
parameter_list|)
value|((r)>= IA64_FR0_REGNUM&& (r)<= IA64_FR127_REGNUM)
end_define

begin_define
define|#
directive|define
name|GREG_SUPPLIES
parameter_list|(
name|r
parameter_list|)
value|(!FPREG_SUPPLIES(r))
end_define

begin_decl_stmt
specifier|static
name|int
name|reg_offset
index|[
literal|462
index|]
init|=
block|{
operator|-
literal|1
block|,
literal|96
block|,
literal|248
block|,
literal|256
block|,
literal|152
block|,
literal|160
block|,
literal|168
block|,
literal|176
block|,
comment|/* Regs 0-7. */
literal|264
block|,
literal|272
block|,
literal|280
block|,
literal|288
block|,
literal|0
block|,
literal|64
block|,
literal|296
block|,
literal|304
block|,
comment|/* Regs 8-15. */
literal|312
block|,
literal|320
block|,
literal|328
block|,
literal|336
block|,
literal|344
block|,
literal|352
block|,
literal|360
block|,
literal|368
block|,
comment|/* Regs 16-23. */
literal|376
block|,
literal|384
block|,
literal|392
block|,
literal|400
block|,
literal|408
block|,
literal|416
block|,
literal|424
block|,
literal|432
block|,
comment|/* Regs 24-31. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 32-39. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 40-47. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 48-55. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 56-63. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 64-71. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 72-79. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 80-87. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 88-95. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 96-103. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 104-111. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 112-119. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 120-127. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|0
block|,
literal|16
block|,
literal|32
block|,
literal|48
block|,
literal|320
block|,
literal|336
block|,
comment|/* Regs 128-135. */
literal|352
block|,
literal|368
block|,
literal|384
block|,
literal|400
block|,
literal|416
block|,
literal|432
block|,
literal|448
block|,
literal|464
block|,
comment|/* Regs 136-143. */
literal|64
block|,
literal|80
block|,
literal|96
block|,
literal|112
block|,
literal|128
block|,
literal|144
block|,
literal|160
block|,
literal|176
block|,
comment|/* Regs 144-151. */
literal|192
block|,
literal|208
block|,
literal|224
block|,
literal|240
block|,
literal|256
block|,
literal|272
block|,
literal|288
block|,
literal|304
block|,
comment|/* Regs 152-159. */
literal|480
block|,
literal|496
block|,
literal|512
block|,
literal|528
block|,
literal|544
block|,
literal|560
block|,
literal|576
block|,
literal|592
block|,
comment|/* Regs 160-167. */
literal|608
block|,
literal|624
block|,
literal|640
block|,
literal|656
block|,
literal|672
block|,
literal|688
block|,
literal|704
block|,
literal|720
block|,
comment|/* Regs 168-175. */
literal|736
block|,
literal|752
block|,
literal|768
block|,
literal|784
block|,
literal|800
block|,
literal|816
block|,
literal|832
block|,
literal|848
block|,
comment|/* Regs 176-183. */
literal|864
block|,
literal|880
block|,
literal|896
block|,
literal|912
block|,
literal|928
block|,
literal|944
block|,
literal|960
block|,
literal|976
block|,
comment|/* Regs 184-191. */
literal|992
block|,
literal|1008
block|,
literal|1024
block|,
literal|1040
block|,
literal|1056
block|,
literal|1072
block|,
literal|1088
block|,
literal|1104
block|,
comment|/* Regs 192-199. */
literal|1120
block|,
literal|1136
block|,
literal|1152
block|,
literal|1168
block|,
literal|1184
block|,
literal|1200
block|,
literal|1216
block|,
literal|1232
block|,
comment|/* Regs 200-207. */
literal|1248
block|,
literal|1264
block|,
literal|1280
block|,
literal|1296
block|,
literal|1312
block|,
literal|1328
block|,
literal|1344
block|,
literal|1360
block|,
comment|/* Regs 208-215. */
literal|1376
block|,
literal|1392
block|,
literal|1408
block|,
literal|1424
block|,
literal|1440
block|,
literal|1456
block|,
literal|1472
block|,
literal|1488
block|,
comment|/* Regs 216-223. */
literal|1504
block|,
literal|1520
block|,
literal|1536
block|,
literal|1552
block|,
literal|1568
block|,
literal|1584
block|,
literal|1600
block|,
literal|1616
block|,
comment|/* Regs 224-231. */
literal|1632
block|,
literal|1648
block|,
literal|1664
block|,
literal|1680
block|,
literal|1696
block|,
literal|1712
block|,
literal|1728
block|,
literal|1744
block|,
comment|/* Regs 232-239. */
literal|1760
block|,
literal|1776
block|,
literal|1792
block|,
literal|1808
block|,
literal|1824
block|,
literal|1840
block|,
literal|1856
block|,
literal|1872
block|,
comment|/* Regs 240-247. */
literal|1888
block|,
literal|1904
block|,
literal|1920
block|,
literal|1936
block|,
literal|1952
block|,
literal|1968
block|,
literal|1984
block|,
literal|2000
block|,
comment|/* Regs 248-255. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 256-263. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 264-271. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 272-279. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 280-287. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 288-295. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 296-303. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 304-311. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 312-319. */
literal|16
block|,
literal|184
block|,
literal|192
block|,
literal|200
block|,
literal|208
block|,
literal|216
block|,
literal|440
block|,
literal|448
block|,
comment|/* Regs 320-327. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|24
block|,
literal|120
block|,
literal|88
block|,
literal|112
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 328-335. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 336-343. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|72
block|,
literal|104
block|,
comment|/* Regs 344-351. */
literal|40
block|,
literal|48
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|464
block|,
comment|/* Regs 352-359. */
literal|472
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|456
block|,
operator|-
literal|1
block|,
comment|/* Regs 360-367. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|8
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|80
block|,
operator|-
literal|1
block|,
comment|/* Regs 368-375. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 376-383. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 384-391. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|32
block|,
literal|224
block|,
comment|/* Regs 392-399. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 400-407. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 408-415. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 416-423. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 424-431. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 432-439. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 440-447. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
comment|/* Regs 448-455. */
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
name|ia64_fbsd_regcache_collect
parameter_list|(
name|struct
name|regcache
modifier|*
name|regcache
parameter_list|,
name|int
name|regno
parameter_list|,
name|void
modifier|*
name|regs
parameter_list|)
block|{
name|int
name|ofs
decl_stmt|;
if|if
condition|(
name|regno
operator|<
literal|0
operator|||
name|regno
operator|>=
name|NUM_REGS
condition|)
return|return;
name|ofs
operator|=
name|reg_offset
index|[
name|regno
index|]
expr_stmt|;
if|if
condition|(
name|ofs
operator|>=
literal|0
condition|)
name|regcache_raw_collect
argument_list|(
name|regcache
argument_list|,
name|regno
argument_list|,
operator|(
name|char
operator|*
operator|)
name|regs
operator|+
name|ofs
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|ia64_fbsd_regcache_supply
parameter_list|(
name|struct
name|regcache
modifier|*
name|regcache
parameter_list|,
name|int
name|regno
parameter_list|,
specifier|const
name|void
modifier|*
name|regs
parameter_list|)
block|{
name|int
name|ofs
decl_stmt|;
if|if
condition|(
name|regno
operator|<
literal|0
operator|||
name|regno
operator|>=
name|NUM_REGS
condition|)
return|return;
name|ofs
operator|=
name|reg_offset
index|[
name|regno
index|]
expr_stmt|;
if|if
condition|(
name|regno
operator|==
name|IA64_BSP_REGNUM
condition|)
block|{
comment|/* BSP is synthesized. It's not actually present in struct reg, 	 but can be derived from bspstore and ndirty. The offset of 	 IA64_BSP_REGNUM in the reg_offset array above is that of the 	 ndirty field in struct reg. */
name|uint64_t
name|bsp
decl_stmt|;
name|bsp
operator|=
operator|*
operator|(
operator|(
name|uint64_t
operator|*
operator|)
operator|(
operator|(
name|char
operator|*
operator|)
name|regs
operator|+
name|ofs
operator|)
operator|)
expr_stmt|;
comment|/* ndirty */
name|bsp
operator|+=
operator|*
operator|(
operator|(
name|uint64_t
operator|*
operator|)
operator|(
operator|(
name|char
operator|*
operator|)
name|regs
operator|+
name|reg_offset
index|[
name|IA64_BSPSTORE_REGNUM
index|]
operator|)
operator|)
expr_stmt|;
name|regcache_raw_supply
argument_list|(
name|regcache
argument_list|,
name|regno
argument_list|,
operator|&
name|bsp
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|ofs
operator|<
literal|0
condition|)
name|regcache_raw_supply
argument_list|(
name|regcache
argument_list|,
name|regno
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
else|else
name|regcache_raw_supply
argument_list|(
name|regcache
argument_list|,
name|regno
argument_list|,
operator|(
name|char
operator|*
operator|)
name|regs
operator|+
name|ofs
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|fill_fpregset
parameter_list|(
name|void
modifier|*
name|fpregs
parameter_list|,
name|int
name|regno
parameter_list|)
block|{
if|if
condition|(
name|regno
operator|==
operator|-
literal|1
condition|)
block|{
for|for
control|(
name|regno
operator|=
literal|0
init|;
name|regno
operator|<
name|NUM_REGS
condition|;
name|regno
operator|++
control|)
block|{
if|if
condition|(
name|FPREG_SUPPLIES
argument_list|(
name|regno
argument_list|)
condition|)
name|ia64_fbsd_regcache_collect
argument_list|(
name|current_regcache
argument_list|,
name|regno
argument_list|,
name|fpregs
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
if|if
condition|(
name|FPREG_SUPPLIES
argument_list|(
name|regno
argument_list|)
condition|)
name|ia64_fbsd_regcache_collect
argument_list|(
name|current_regcache
argument_list|,
name|regno
argument_list|,
name|fpregs
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|fill_gregset
parameter_list|(
name|void
modifier|*
name|gregs
parameter_list|,
name|int
name|regno
parameter_list|)
block|{
if|if
condition|(
name|regno
operator|==
operator|-
literal|1
condition|)
block|{
for|for
control|(
name|regno
operator|=
literal|0
init|;
name|regno
operator|<
name|NUM_REGS
condition|;
name|regno
operator|++
control|)
block|{
if|if
condition|(
name|GREG_SUPPLIES
argument_list|(
name|regno
argument_list|)
condition|)
name|ia64_fbsd_regcache_collect
argument_list|(
name|current_regcache
argument_list|,
name|regno
argument_list|,
name|gregs
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
if|if
condition|(
name|GREG_SUPPLIES
argument_list|(
name|regno
argument_list|)
condition|)
name|ia64_fbsd_regcache_collect
argument_list|(
name|current_regcache
argument_list|,
name|regno
argument_list|,
name|gregs
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|ia64_fbsd_supply_fpregs
parameter_list|(
specifier|const
name|void
modifier|*
name|fpregs
parameter_list|,
name|int
name|regno
parameter_list|)
block|{
if|if
condition|(
name|regno
operator|==
operator|-
literal|1
condition|)
block|{
for|for
control|(
name|regno
operator|=
literal|0
init|;
name|regno
operator|<
name|NUM_REGS
condition|;
name|regno
operator|++
control|)
block|{
if|if
condition|(
name|FPREG_SUPPLIES
argument_list|(
name|regno
argument_list|)
condition|)
name|ia64_fbsd_regcache_supply
argument_list|(
name|current_regcache
argument_list|,
name|regno
argument_list|,
name|fpregs
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
if|if
condition|(
name|FPREG_SUPPLIES
argument_list|(
name|regno
argument_list|)
condition|)
name|ia64_fbsd_regcache_supply
argument_list|(
name|current_regcache
argument_list|,
name|regno
argument_list|,
name|fpregs
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|ia64_fbsd_supply_gregs
parameter_list|(
specifier|const
name|void
modifier|*
name|gregs
parameter_list|,
name|int
name|regno
parameter_list|)
block|{
if|if
condition|(
name|regno
operator|==
operator|-
literal|1
condition|)
block|{
for|for
control|(
name|regno
operator|=
literal|0
init|;
name|regno
operator|<
name|NUM_REGS
condition|;
name|regno
operator|++
control|)
block|{
if|if
condition|(
name|GREG_SUPPLIES
argument_list|(
name|regno
argument_list|)
condition|)
name|ia64_fbsd_regcache_supply
argument_list|(
name|current_regcache
argument_list|,
name|regno
argument_list|,
name|gregs
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
if|if
condition|(
name|GREG_SUPPLIES
argument_list|(
name|regno
argument_list|)
condition|)
name|ia64_fbsd_regcache_supply
argument_list|(
name|current_regcache
argument_list|,
name|regno
argument_list|,
name|gregs
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|ia64_fbsd_supply_gregset
parameter_list|(
specifier|const
name|struct
name|regset
modifier|*
name|regset
parameter_list|,
name|struct
name|regcache
modifier|*
name|regcache
parameter_list|,
name|int
name|regno
parameter_list|,
specifier|const
name|void
modifier|*
name|gregs
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
if|if
condition|(
name|regno
operator|==
operator|-
literal|1
condition|)
block|{
for|for
control|(
name|regno
operator|=
literal|0
init|;
name|regno
operator|<
name|NUM_REGS
condition|;
name|regno
operator|++
control|)
block|{
if|if
condition|(
name|GREG_SUPPLIES
argument_list|(
name|regno
argument_list|)
condition|)
name|ia64_fbsd_regcache_supply
argument_list|(
name|regcache
argument_list|,
name|regno
argument_list|,
name|gregs
argument_list|)
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|GREG_SUPPLIES
argument_list|(
name|regno
argument_list|)
condition|)
name|ia64_fbsd_regcache_supply
argument_list|(
name|regcache
argument_list|,
name|regno
argument_list|,
name|gregs
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|ia64_fbsd_supply_fpregset
parameter_list|(
specifier|const
name|struct
name|regset
modifier|*
name|regset
parameter_list|,
name|struct
name|regcache
modifier|*
name|regcache
parameter_list|,
name|int
name|regno
parameter_list|,
specifier|const
name|void
modifier|*
name|fpregs
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
if|if
condition|(
name|regno
operator|==
operator|-
literal|1
condition|)
block|{
for|for
control|(
name|regno
operator|=
literal|0
init|;
name|regno
operator|<
name|NUM_REGS
condition|;
name|regno
operator|++
control|)
block|{
if|if
condition|(
name|FPREG_SUPPLIES
argument_list|(
name|regno
argument_list|)
condition|)
name|ia64_fbsd_regcache_supply
argument_list|(
name|regcache
argument_list|,
name|regno
argument_list|,
name|fpregs
argument_list|)
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|FPREG_SUPPLIES
argument_list|(
name|regno
argument_list|)
condition|)
name|ia64_fbsd_regcache_supply
argument_list|(
name|regcache
argument_list|,
name|regno
argument_list|,
name|fpregs
argument_list|)
expr_stmt|;
block|}
end_function

begin_decl_stmt
specifier|static
name|struct
name|regset
name|gregset
init|=
block|{
name|NULL
block|,
name|ia64_fbsd_supply_gregset
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|regset
name|fpregset
init|=
block|{
name|NULL
block|,
name|ia64_fbsd_supply_fpregset
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
specifier|const
name|struct
name|regset
modifier|*
name|ia64_fbsd_regset_from_core_section
parameter_list|(
name|struct
name|gdbarch
modifier|*
name|gdbarch
parameter_list|,
specifier|const
name|char
modifier|*
name|sect_name
parameter_list|,
name|size_t
name|sect_size
parameter_list|)
block|{
if|if
condition|(
name|strcmp
argument_list|(
name|sect_name
argument_list|,
literal|".reg"
argument_list|)
operator|==
literal|0
condition|)
return|return
operator|(
operator|&
name|gregset
operator|)
return|;
if|if
condition|(
name|strcmp
argument_list|(
name|sect_name
argument_list|,
literal|".reg2"
argument_list|)
operator|==
literal|0
condition|)
return|return
operator|(
operator|&
name|fpregset
operator|)
return|;
return|return
operator|(
name|NULL
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|ia64_fbsd_pc_in_sigtramp
parameter_list|(
name|CORE_ADDR
name|pc
parameter_list|,
name|char
modifier|*
name|func_name
parameter_list|)
block|{
name|uint64_t
name|gwpage
init|=
literal|5ULL
operator|<<
literal|61
decl_stmt|;
return|return
operator|(
name|pc
operator|>=
name|gwpage
operator|&&
name|pc
operator|<
operator|(
name|gwpage
operator|+
literal|8192
operator|)
operator|)
condition|?
literal|1
else|:
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|ia64_fbsd_init_abi
parameter_list|(
name|struct
name|gdbarch_info
name|info
parameter_list|,
name|struct
name|gdbarch
modifier|*
name|gdbarch
parameter_list|)
block|{
name|struct
name|gdbarch_tdep
modifier|*
name|tdep
init|=
name|gdbarch_tdep
argument_list|(
name|gdbarch
argument_list|)
decl_stmt|;
name|set_gdbarch_pc_in_sigtramp
argument_list|(
name|gdbarch
argument_list|,
name|ia64_fbsd_pc_in_sigtramp
argument_list|)
expr_stmt|;
name|set_gdbarch_regset_from_core_section
argument_list|(
name|gdbarch
argument_list|,
name|ia64_fbsd_regset_from_core_section
argument_list|)
expr_stmt|;
name|set_solib_svr4_fetch_link_map_offsets
argument_list|(
name|gdbarch
argument_list|,
name|svr4_lp64_fetch_link_map_offsets
argument_list|)
expr_stmt|;
name|tdep
operator|->
name|find_global_pointer
operator|=
name|ia64_generic_find_global_pointer
expr_stmt|;
block|}
end_function

begin_function
name|void
name|_initialize_ia64_fbsd_tdep
parameter_list|(
name|void
parameter_list|)
block|{
name|gdbarch_register_osabi
argument_list|(
name|bfd_arch_ia64
argument_list|,
literal|0ul
argument_list|,
name|GDB_OSABI_FREEBSD_ELF
argument_list|,
name|ia64_fbsd_init_abi
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

