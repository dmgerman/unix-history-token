begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* ** TuiGeneralWin.c ** This module supports general window behavior */
end_comment

begin_include
include|#
directive|include
file|<curses.h>
end_include

begin_include
include|#
directive|include
file|"defs.h"
end_include

begin_include
include|#
directive|include
file|"tui.h"
end_include

begin_include
include|#
directive|include
file|"tuiData.h"
end_include

begin_include
include|#
directive|include
file|"tuiGeneralWin.h"
end_include

begin_comment
comment|/* ** local support functions */
end_comment

begin_decl_stmt
specifier|static
name|void
name|_winResize
name|PARAMS
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*********************** ** PUBLIC FUNCTIONS ***********************/
end_comment

begin_comment
comment|/* ** tuiRefreshWin() **        Refresh the window */
end_comment

begin_function
name|void
ifdef|#
directive|ifdef
name|__STDC__
name|tuiRefreshWin
parameter_list|(
name|TuiGenWinInfoPtr
name|winInfo
parameter_list|)
else|#
directive|else
function|tuiRefreshWin
parameter_list|(
name|winInfo
parameter_list|)
name|TuiGenWinInfoPtr
name|winInfo
decl_stmt|;
endif|#
directive|endif
block|{
if|if
condition|(
name|winInfo
operator|->
name|type
operator|==
name|DATA_WIN
operator|&&
name|winInfo
operator|->
name|contentSize
operator|>
literal|0
condition|)
block|{
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
operator|(
name|i
operator|<
name|winInfo
operator|->
name|contentSize
operator|)
condition|;
name|i
operator|++
control|)
block|{
name|TuiGenWinInfoPtr
name|dataItemWinPtr
decl_stmt|;
name|dataItemWinPtr
operator|=
operator|&
operator|(
operator|(
name|TuiWinContent
operator|)
name|winInfo
operator|->
name|content
operator|)
index|[
name|i
index|]
operator|->
name|whichElement
operator|.
name|dataWindow
expr_stmt|;
if|if
condition|(
name|m_genWinPtrNotNull
argument_list|(
name|dataItemWinPtr
argument_list|)
operator|&&
name|dataItemWinPtr
operator|->
name|handle
operator|!=
operator|(
name|WINDOW
operator|*
operator|)
name|NULL
condition|)
name|wrefresh
argument_list|(
name|dataItemWinPtr
operator|->
name|handle
argument_list|)
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|winInfo
operator|->
name|type
operator|==
name|CMD_WIN
condition|)
block|{
comment|/* Do nothing */
block|}
else|else
block|{
if|if
condition|(
name|winInfo
operator|->
name|handle
operator|!=
operator|(
name|WINDOW
operator|*
operator|)
name|NULL
condition|)
name|wrefresh
argument_list|(
name|winInfo
operator|->
name|handle
argument_list|)
expr_stmt|;
block|}
return|return;
block|}
end_function

begin_comment
comment|/* tuiRefreshWin */
end_comment

begin_comment
comment|/* ** tuiDelwin() **        Function to delete the curses window, checking for null */
end_comment

begin_function
name|void
ifdef|#
directive|ifdef
name|__STDC__
name|tuiDelwin
parameter_list|(
name|WINDOW
modifier|*
name|window
parameter_list|)
else|#
directive|else
function|tuiDelwin
parameter_list|(
name|window
parameter_list|)
name|WINDOW
modifier|*
name|window
decl_stmt|;
endif|#
directive|endif
block|{
if|if
condition|(
name|window
operator|!=
operator|(
name|WINDOW
operator|*
operator|)
name|NULL
condition|)
name|delwin
argument_list|(
name|window
argument_list|)
expr_stmt|;
return|return;
block|}
end_function

begin_comment
comment|/* tuiDelwin */
end_comment

begin_comment
comment|/* ** boxWin(). */
end_comment

begin_function
name|void
ifdef|#
directive|ifdef
name|__STDC__
name|boxWin
parameter_list|(
name|TuiGenWinInfoPtr
name|winInfo
parameter_list|,
name|int
name|highlightFlag
parameter_list|)
else|#
directive|else
function|boxWin
parameter_list|(
name|winInfo
parameter_list|,
name|highlightFlag
parameter_list|)
name|TuiGenWinInfoPtr
name|winInfo
decl_stmt|;
name|int
name|highlightFlag
decl_stmt|;
endif|#
directive|endif
block|{
if|if
condition|(
name|m_genWinPtrNotNull
argument_list|(
name|winInfo
argument_list|)
operator|&&
name|winInfo
operator|->
name|handle
operator|!=
operator|(
name|WINDOW
operator|*
operator|)
name|NULL
condition|)
block|{
if|if
condition|(
name|highlightFlag
operator|==
name|HILITE
condition|)
name|box
argument_list|(
name|winInfo
operator|->
name|handle
argument_list|,
literal|'|'
argument_list|,
literal|'-'
argument_list|)
expr_stmt|;
else|else
block|{
comment|/*            wattron(winInfo->handle, A_DIM);*/
name|box
argument_list|(
name|winInfo
operator|->
name|handle
argument_list|,
literal|':'
argument_list|,
literal|'.'
argument_list|)
expr_stmt|;
comment|/*            wattroff(winInfo->handle, A_DIM);*/
block|}
block|}
return|return;
block|}
end_function

begin_comment
comment|/* boxWin */
end_comment

begin_comment
comment|/* ** unhighlightWin(). */
end_comment

begin_function
name|void
ifdef|#
directive|ifdef
name|__STDC__
name|unhighlightWin
parameter_list|(
name|TuiWinInfoPtr
name|winInfo
parameter_list|)
else|#
directive|else
function|unhighlightWin
parameter_list|(
name|winInfo
parameter_list|)
name|TuiWinInfoPtr
name|winInfo
decl_stmt|;
endif|#
directive|endif
block|{
if|if
condition|(
name|m_winPtrNotNull
argument_list|(
name|winInfo
argument_list|)
operator|&&
name|winInfo
operator|->
name|generic
operator|.
name|handle
operator|!=
operator|(
name|WINDOW
operator|*
operator|)
name|NULL
condition|)
block|{
name|boxWin
argument_list|(
operator|(
name|TuiGenWinInfoPtr
operator|)
name|winInfo
argument_list|,
name|NO_HILITE
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|winInfo
operator|->
name|generic
operator|.
name|handle
argument_list|)
expr_stmt|;
name|m_setWinHighlightOff
argument_list|(
name|winInfo
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* unhighlightWin */
end_comment

begin_comment
comment|/* ** highlightWin(). */
end_comment

begin_function
name|void
ifdef|#
directive|ifdef
name|__STDC__
name|highlightWin
parameter_list|(
name|TuiWinInfoPtr
name|winInfo
parameter_list|)
else|#
directive|else
function|highlightWin
parameter_list|(
name|winInfo
parameter_list|)
name|TuiWinInfoPtr
name|winInfo
decl_stmt|;
endif|#
directive|endif
block|{
if|if
condition|(
name|m_winPtrNotNull
argument_list|(
name|winInfo
argument_list|)
operator|&&
name|winInfo
operator|->
name|canHighlight
operator|&&
name|winInfo
operator|->
name|generic
operator|.
name|handle
operator|!=
operator|(
name|WINDOW
operator|*
operator|)
name|NULL
condition|)
block|{
name|boxWin
argument_list|(
operator|(
name|TuiGenWinInfoPtr
operator|)
name|winInfo
argument_list|,
name|HILITE
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|winInfo
operator|->
name|generic
operator|.
name|handle
argument_list|)
expr_stmt|;
name|m_setWinHighlightOn
argument_list|(
name|winInfo
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* highlightWin */
end_comment

begin_comment
comment|/* ** checkAndDisplayHighlightIfNecessay */
end_comment

begin_function
name|void
ifdef|#
directive|ifdef
name|__STDC__
name|checkAndDisplayHighlightIfNeeded
parameter_list|(
name|TuiWinInfoPtr
name|winInfo
parameter_list|)
else|#
directive|else
function|checkAndDisplayHighlightIfNeeded
parameter_list|(
name|winInfo
parameter_list|)
name|TuiWinInfoPtr
name|winInfo
decl_stmt|;
endif|#
directive|endif
block|{
if|if
condition|(
name|m_winPtrNotNull
argument_list|(
name|winInfo
argument_list|)
operator|&&
name|winInfo
operator|->
name|generic
operator|.
name|type
operator|!=
name|CMD_WIN
condition|)
block|{
if|if
condition|(
name|winInfo
operator|->
name|isHighlighted
condition|)
name|highlightWin
argument_list|(
name|winInfo
argument_list|)
expr_stmt|;
else|else
name|unhighlightWin
argument_list|(
name|winInfo
argument_list|)
expr_stmt|;
block|}
return|return;
block|}
end_function

begin_comment
comment|/* checkAndDisplayHighlightIfNeeded */
end_comment

begin_comment
comment|/* ** makeWindow(). */
end_comment

begin_function
name|void
ifdef|#
directive|ifdef
name|__STDC__
name|makeWindow
parameter_list|(
name|TuiGenWinInfoPtr
name|winInfo
parameter_list|,
name|int
name|boxIt
parameter_list|)
else|#
directive|else
function|makeWindow
parameter_list|(
name|winInfo
parameter_list|,
name|boxIt
parameter_list|)
name|TuiGenWinInfoPtr
name|winInfo
decl_stmt|;
name|int
name|boxIt
decl_stmt|;
endif|#
directive|endif
block|{
name|WINDOW
modifier|*
name|handle
decl_stmt|;
name|handle
operator|=
name|newwin
argument_list|(
name|winInfo
operator|->
name|height
argument_list|,
name|winInfo
operator|->
name|width
argument_list|,
name|winInfo
operator|->
name|origin
operator|.
name|y
argument_list|,
name|winInfo
operator|->
name|origin
operator|.
name|x
argument_list|)
expr_stmt|;
name|winInfo
operator|->
name|handle
operator|=
name|handle
expr_stmt|;
if|if
condition|(
name|handle
operator|!=
operator|(
name|WINDOW
operator|*
operator|)
name|NULL
condition|)
block|{
if|if
condition|(
name|boxIt
operator|==
name|BOX_WINDOW
condition|)
name|boxWin
argument_list|(
name|winInfo
argument_list|,
name|NO_HILITE
argument_list|)
expr_stmt|;
name|winInfo
operator|->
name|isVisible
operator|=
name|TRUE
expr_stmt|;
name|scrollok
argument_list|(
name|handle
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|tuiRefreshWin
argument_list|(
name|winInfo
argument_list|)
expr_stmt|;
ifndef|#
directive|ifndef
name|FOR_TEST
if|if
condition|(
comment|/*!m_WinIsAuxillary(winInfo->type)&& */
operator|(
name|winInfo
operator|->
name|type
operator|!=
name|CMD_WIN
operator|)
operator|&&
operator|(
name|winInfo
operator|->
name|content
operator|==
operator|(
name|OpaquePtr
operator|)
name|NULL
operator|)
condition|)
block|{
name|mvwaddstr
argument_list|(
name|handle
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
name|winName
argument_list|(
name|winInfo
argument_list|)
argument_list|)
expr_stmt|;
name|tuiRefreshWin
argument_list|(
name|winInfo
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
comment|/*FOR_TEST*/
block|}
return|return;
block|}
end_function

begin_comment
comment|/* makeWindow */
end_comment

begin_comment
comment|/* ** tuiClearWin(). **        Clear the window of all contents without calling wclear. */
end_comment

begin_function
name|void
ifdef|#
directive|ifdef
name|__STDC__
name|tuiClearWin
parameter_list|(
name|TuiGenWinInfoPtr
name|winInfo
parameter_list|)
else|#
directive|else
function|tuiClearWin
parameter_list|(
name|winInfo
parameter_list|)
name|TuiGenWinInfoPtr
name|winInfo
decl_stmt|;
endif|#
directive|endif
block|{
if|if
condition|(
name|m_genWinPtrNotNull
argument_list|(
name|winInfo
argument_list|)
operator|&&
name|winInfo
operator|->
name|handle
operator|!=
operator|(
name|WINDOW
operator|*
operator|)
name|NULL
condition|)
block|{
name|int
name|curRow
decl_stmt|,
name|curCol
decl_stmt|;
for|for
control|(
name|curRow
operator|=
literal|0
init|;
operator|(
name|curRow
operator|<
name|winInfo
operator|->
name|height
operator|)
condition|;
name|curRow
operator|++
control|)
for|for
control|(
name|curCol
operator|=
literal|0
init|;
operator|(
name|curCol
operator|<
name|winInfo
operator|->
name|width
operator|)
condition|;
name|curCol
operator|++
control|)
name|mvwaddch
argument_list|(
name|winInfo
operator|->
name|handle
argument_list|,
name|curRow
argument_list|,
name|curCol
argument_list|,
literal|' '
argument_list|)
expr_stmt|;
name|tuiRefreshWin
argument_list|(
name|winInfo
argument_list|)
expr_stmt|;
block|}
return|return;
block|}
end_function

begin_comment
comment|/* tuiClearWin */
end_comment

begin_comment
comment|/* ** makeVisible(). **        We can't really make windows visible, or invisible.  So we **        have to delete the entire window when making it visible, **        and create it again when making it visible. */
end_comment

begin_function
name|void
ifdef|#
directive|ifdef
name|__STDC__
name|makeVisible
parameter_list|(
name|TuiGenWinInfoPtr
name|winInfo
parameter_list|,
name|int
name|visible
parameter_list|)
else|#
directive|else
function|makeVisible
parameter_list|(
name|winInfo
parameter_list|,
name|visible
parameter_list|)
name|TuiGenWinInfoPtr
name|winInfo
decl_stmt|;
name|int
name|visible
decl_stmt|;
endif|#
directive|endif
block|{
comment|/* Don't tear down/recreate command window */
if|if
condition|(
name|winInfo
operator|->
name|type
operator|==
name|CMD_WIN
condition|)
return|return;
if|if
condition|(
name|visible
condition|)
block|{
if|if
condition|(
operator|!
name|winInfo
operator|->
name|isVisible
condition|)
block|{
name|makeWindow
argument_list|(
name|winInfo
argument_list|,
operator|(
name|winInfo
operator|->
name|type
operator|!=
name|CMD_WIN
operator|&&
operator|!
name|m_winIsAuxillary
argument_list|(
name|winInfo
operator|->
name|type
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|winInfo
operator|->
name|isVisible
operator|=
name|TRUE
expr_stmt|;
block|}
name|tuiRefreshWin
argument_list|(
name|winInfo
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|!
name|visible
operator|&&
name|winInfo
operator|->
name|isVisible
operator|&&
name|winInfo
operator|->
name|handle
operator|!=
operator|(
name|WINDOW
operator|*
operator|)
name|NULL
condition|)
block|{
name|winInfo
operator|->
name|isVisible
operator|=
name|FALSE
expr_stmt|;
name|tuiClearWin
argument_list|(
name|winInfo
argument_list|)
expr_stmt|;
name|tuiDelwin
argument_list|(
name|winInfo
operator|->
name|handle
argument_list|)
expr_stmt|;
name|winInfo
operator|->
name|handle
operator|=
operator|(
name|WINDOW
operator|*
operator|)
name|NULL
expr_stmt|;
block|}
return|return;
block|}
end_function

begin_comment
comment|/* makeVisible */
end_comment

begin_comment
comment|/* ** makeAllVisible(). **        Makes all windows invisible (except the command and locator windows) */
end_comment

begin_function
name|void
ifdef|#
directive|ifdef
name|__STDC__
name|makeAllVisible
parameter_list|(
name|int
name|visible
parameter_list|)
else|#
directive|else
function|makeAllVisible
parameter_list|(
name|visible
parameter_list|)
name|int
name|visible
decl_stmt|;
endif|#
directive|endif
block|{
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|MAX_MAJOR_WINDOWS
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|m_winPtrNotNull
argument_list|(
name|winList
index|[
name|i
index|]
argument_list|)
operator|&&
operator|(
operator|(
name|winList
index|[
name|i
index|]
operator|)
operator|->
name|generic
operator|.
name|type
operator|)
operator|!=
name|CMD_WIN
condition|)
block|{
if|if
condition|(
name|m_winIsSourceType
argument_list|(
operator|(
name|winList
index|[
name|i
index|]
operator|)
operator|->
name|generic
operator|.
name|type
argument_list|)
condition|)
name|makeVisible
argument_list|(
operator|(
name|winList
index|[
name|i
index|]
operator|)
operator|->
name|detail
operator|.
name|sourceInfo
operator|.
name|executionInfo
argument_list|,
name|visible
argument_list|)
expr_stmt|;
name|makeVisible
argument_list|(
operator|(
name|TuiGenWinInfoPtr
operator|)
name|winList
index|[
name|i
index|]
argument_list|,
name|visible
argument_list|)
expr_stmt|;
block|}
block|}
return|return;
block|}
end_function

begin_comment
comment|/* makeAllVisible */
end_comment

begin_comment
comment|/* ** scrollWinForward */
end_comment

begin_function
name|void
ifdef|#
directive|ifdef
name|__STDC__
name|scrollWinForward
parameter_list|(
name|TuiGenWinInfoPtr
name|winInfo
parameter_list|,
name|int
name|numLines
parameter_list|)
else|#
directive|else
function|scrollWinForward
parameter_list|(
name|winInfo
parameter_list|,
name|numLines
parameter_list|)
name|TuiGenWinInfoPtr
name|winInfo
decl_stmt|;
name|int
name|numLines
decl_stmt|;
endif|#
directive|endif
block|{
if|if
condition|(
name|winInfo
operator|->
name|content
operator|!=
operator|(
name|OpaquePtr
operator|)
name|NULL
operator|&&
name|winInfo
operator|->
name|lastVisibleLine
operator|<
name|winInfo
operator|->
name|contentSize
operator|-
literal|1
condition|)
block|{
name|int
name|i
decl_stmt|,
name|firstLine
decl_stmt|,
name|newLastLine
decl_stmt|;
name|firstLine
operator|=
name|winInfo
operator|->
name|lastVisibleLine
operator|-
name|winInfo
operator|->
name|viewportHeight
operator|+
literal|1
expr_stmt|;
if|if
condition|(
name|winInfo
operator|->
name|lastVisibleLine
operator|+
name|numLines
operator|>
name|winInfo
operator|->
name|contentSize
condition|)
name|newLastLine
operator|=
name|winInfo
operator|->
name|contentSize
operator|-
literal|1
expr_stmt|;
else|else
name|newLastLine
operator|=
name|winInfo
operator|->
name|lastVisibleLine
operator|+
name|numLines
operator|-
literal|1
expr_stmt|;
for|for
control|(
name|i
operator|=
operator|(
name|newLastLine
operator|-
name|winInfo
operator|->
name|viewportHeight
operator|)
init|;
operator|(
name|i
operator|<=
name|newLastLine
operator|)
condition|;
name|i
operator|++
control|)
block|{
name|TuiWinElementPtr
name|line
decl_stmt|;
name|int
name|lineHeight
decl_stmt|;
name|line
operator|=
operator|(
name|TuiWinElementPtr
operator|)
name|winInfo
operator|->
name|content
index|[
name|i
index|]
expr_stmt|;
if|if
condition|(
name|line
operator|->
name|highlight
condition|)
name|wstandout
argument_list|(
name|winInfo
operator|->
name|handle
argument_list|)
expr_stmt|;
name|mvwaddstr
argument_list|(
name|winInfo
operator|->
name|handle
argument_list|,
name|i
operator|-
operator|(
name|newLastLine
operator|-
name|winInfo
operator|->
name|viewportHeight
operator|)
argument_list|,
literal|1
argument_list|,
name|displayableWinContentOf
argument_list|(
name|winInfo
argument_list|,
name|line
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|line
operator|->
name|highlight
condition|)
name|wstandend
argument_list|(
name|winInfo
operator|->
name|handle
argument_list|)
expr_stmt|;
name|lineHeight
operator|=
name|winElementHeight
argument_list|(
name|winInfo
argument_list|,
name|line
argument_list|)
expr_stmt|;
name|newLastLine
operator|+=
operator|(
name|lineHeight
operator|-
literal|1
operator|)
expr_stmt|;
block|}
name|winInfo
operator|->
name|lastVisibleLine
operator|=
name|newLastLine
expr_stmt|;
block|}
return|return;
block|}
end_function

begin_comment
comment|/* scrollWinForward */
end_comment

begin_comment
comment|/* ** scrollWinBackward */
end_comment

begin_function
name|void
ifdef|#
directive|ifdef
name|__STDC__
name|scrollWinBackward
parameter_list|(
name|TuiGenWinInfoPtr
name|winInfo
parameter_list|,
name|int
name|numLines
parameter_list|)
else|#
directive|else
function|scrollWinBackward
parameter_list|(
name|winInfo
parameter_list|,
name|numLines
parameter_list|)
name|TuiGenWinInfoPtr
name|winInfo
decl_stmt|;
name|int
name|numLines
decl_stmt|;
endif|#
directive|endif
block|{
if|if
condition|(
name|winInfo
operator|->
name|content
operator|!=
operator|(
name|OpaquePtr
operator|)
name|NULL
operator|&&
operator|(
name|winInfo
operator|->
name|lastVisibleLine
operator|-
name|winInfo
operator|->
name|viewportHeight
operator|)
operator|>
literal|0
condition|)
block|{
name|int
name|i
decl_stmt|,
name|newLastLine
decl_stmt|,
name|firstLine
decl_stmt|;
name|firstLine
operator|=
name|winInfo
operator|->
name|lastVisibleLine
operator|-
name|winInfo
operator|->
name|viewportHeight
operator|+
literal|1
expr_stmt|;
if|if
condition|(
operator|(
name|firstLine
operator|-
name|numLines
operator|)
operator|<
literal|0
condition|)
name|newLastLine
operator|=
name|winInfo
operator|->
name|viewportHeight
operator|-
literal|1
expr_stmt|;
else|else
name|newLastLine
operator|=
name|winInfo
operator|->
name|lastVisibleLine
operator|-
name|numLines
operator|+
literal|1
expr_stmt|;
for|for
control|(
name|i
operator|=
name|newLastLine
operator|-
name|winInfo
operator|->
name|viewportHeight
init|;
operator|(
name|i
operator|<=
name|newLastLine
operator|)
condition|;
name|i
operator|++
control|)
block|{
name|TuiWinElementPtr
name|line
decl_stmt|;
name|int
name|lineHeight
decl_stmt|;
name|line
operator|=
operator|(
name|TuiWinElementPtr
operator|)
name|winInfo
operator|->
name|content
index|[
name|i
index|]
expr_stmt|;
if|if
condition|(
name|line
operator|->
name|highlight
condition|)
name|wstandout
argument_list|(
name|winInfo
operator|->
name|handle
argument_list|)
expr_stmt|;
name|mvwaddstr
argument_list|(
name|winInfo
operator|->
name|handle
argument_list|,
name|i
operator|-
operator|(
name|newLastLine
operator|-
name|winInfo
operator|->
name|viewportHeight
operator|)
argument_list|,
literal|1
argument_list|,
name|displayableWinContentOf
argument_list|(
name|winInfo
argument_list|,
name|line
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|line
operator|->
name|highlight
condition|)
name|wstandend
argument_list|(
name|winInfo
operator|->
name|handle
argument_list|)
expr_stmt|;
name|lineHeight
operator|=
name|winElementHeight
argument_list|(
name|winInfo
argument_list|,
name|line
argument_list|)
expr_stmt|;
name|newLastLine
operator|+=
operator|(
name|lineHeight
operator|-
literal|1
operator|)
expr_stmt|;
block|}
name|winInfo
operator|->
name|lastVisibleLine
operator|=
name|newLastLine
expr_stmt|;
block|}
return|return;
block|}
end_function

begin_comment
comment|/* scrollWinBackward */
end_comment

begin_comment
comment|/* ** refreshAll(). **        Function to refresh all the windows currently displayed */
end_comment

begin_function
name|void
ifdef|#
directive|ifdef
name|__STDC__
name|refreshAll
parameter_list|(
name|TuiWinInfoPtr
modifier|*
name|list
parameter_list|)
else|#
directive|else
function|refreshAll
parameter_list|(
name|list
parameter_list|)
name|TuiWinInfoPtr
modifier|*
name|list
decl_stmt|;
endif|#
directive|endif
block|{
name|TuiWinType
name|type
decl_stmt|;
name|TuiGenWinInfoPtr
name|locator
init|=
name|locatorWinInfoPtr
argument_list|()
decl_stmt|;
for|for
control|(
name|type
operator|=
name|SRC_WIN
init|;
operator|(
name|type
operator|<
name|MAX_MAJOR_WINDOWS
operator|)
condition|;
name|type
operator|++
control|)
block|{
if|if
condition|(
name|list
index|[
name|type
index|]
operator|->
name|generic
operator|.
name|isVisible
condition|)
block|{
if|if
condition|(
name|type
operator|==
name|SRC_WIN
operator|||
name|type
operator|==
name|DISASSEM_WIN
condition|)
block|{
name|touchwin
argument_list|(
name|list
index|[
name|type
index|]
operator|->
name|detail
operator|.
name|sourceInfo
operator|.
name|executionInfo
operator|->
name|handle
argument_list|)
expr_stmt|;
name|tuiRefreshWin
argument_list|(
name|list
index|[
name|type
index|]
operator|->
name|detail
operator|.
name|sourceInfo
operator|.
name|executionInfo
argument_list|)
expr_stmt|;
block|}
name|touchwin
argument_list|(
name|list
index|[
name|type
index|]
operator|->
name|generic
operator|.
name|handle
argument_list|)
expr_stmt|;
name|tuiRefreshWin
argument_list|(
operator|&
name|list
index|[
name|type
index|]
operator|->
name|generic
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|locator
operator|->
name|isVisible
condition|)
block|{
name|touchwin
argument_list|(
name|locator
operator|->
name|handle
argument_list|)
expr_stmt|;
name|tuiRefreshWin
argument_list|(
name|locator
argument_list|)
expr_stmt|;
block|}
return|return;
block|}
end_function

begin_comment
comment|/* refreshAll */
end_comment

begin_comment
comment|/********************************* ** Local Static Functions *********************************/
end_comment

end_unit

