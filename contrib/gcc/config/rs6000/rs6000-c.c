begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* Subroutines for the C front end on the POWER and PowerPC architectures.    Copyright (C) 2002    Free Software Foundation, Inc.     Contributed by Zack Weinberg<zack@codesourcery.com>  This file is part of GNU CC.  GNU CC is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2, or (at your option) any later version.  GNU CC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with GNU CC; see the file COPYING.  If not, write to the Free Software Foundation, 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|"system.h"
end_include

begin_include
include|#
directive|include
file|"cpplib.h"
end_include

begin_include
include|#
directive|include
file|"tree.h"
end_include

begin_include
include|#
directive|include
file|"c-pragma.h"
end_include

begin_include
include|#
directive|include
file|"errors.h"
end_include

begin_include
include|#
directive|include
file|"tm_p.h"
end_include

begin_comment
comment|/* Handle the machine specific pragma longcall.  Its syntax is     # pragma longcall ( TOGGLE )     where TOGGLE is either 0 or 1.     rs6000_default_long_calls is set to the value of TOGGLE, changing    whether or not new function declarations receive a longcall    attribute by default.  */
end_comment

begin_define
define|#
directive|define
name|SYNTAX_ERROR
parameter_list|(
name|msgid
parameter_list|)
value|do {					\   warning (msgid);					\   warning ("ignoring malformed #pragma longcall");	\   return;						\ } while (0)
end_define

begin_function
name|void
name|rs6000_pragma_longcall
parameter_list|(
name|pfile
parameter_list|)
name|cpp_reader
modifier|*
name|pfile
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|tree
name|x
decl_stmt|,
name|n
decl_stmt|;
comment|/* If we get here, generic code has already scanned the directive      leader and the word "longcall".  */
if|if
condition|(
name|c_lex
argument_list|(
operator|&
name|x
argument_list|)
operator|!=
name|CPP_OPEN_PAREN
condition|)
name|SYNTAX_ERROR
argument_list|(
literal|"missing open paren"
argument_list|)
expr_stmt|;
if|if
condition|(
name|c_lex
argument_list|(
operator|&
name|n
argument_list|)
operator|!=
name|CPP_NUMBER
condition|)
name|SYNTAX_ERROR
argument_list|(
literal|"missing number"
argument_list|)
expr_stmt|;
if|if
condition|(
name|c_lex
argument_list|(
operator|&
name|x
argument_list|)
operator|!=
name|CPP_CLOSE_PAREN
condition|)
name|SYNTAX_ERROR
argument_list|(
literal|"missing close paren"
argument_list|)
expr_stmt|;
if|if
condition|(
name|n
operator|!=
name|integer_zero_node
operator|&&
name|n
operator|!=
name|integer_one_node
condition|)
name|SYNTAX_ERROR
argument_list|(
literal|"number must be 0 or 1"
argument_list|)
expr_stmt|;
if|if
condition|(
name|c_lex
argument_list|(
operator|&
name|x
argument_list|)
operator|!=
name|CPP_EOF
condition|)
name|warning
argument_list|(
literal|"junk at end of #pragma longcall"
argument_list|)
expr_stmt|;
name|rs6000_default_long_calls
operator|=
operator|(
name|n
operator|==
name|integer_one_node
operator|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* Handle defining many CPP flags based on TARGET_xxx.  As a general    policy, rather than trying to guess what flags a user might want a    #define for, it's better to define a flag for everything.  */
end_comment

begin_define
define|#
directive|define
name|builtin_define
parameter_list|(
name|TXT
parameter_list|)
value|cpp_define (pfile, TXT)
end_define

begin_define
define|#
directive|define
name|builtin_assert
parameter_list|(
name|TXT
parameter_list|)
value|cpp_assert (pfile, TXT)
end_define

begin_function
name|void
name|rs6000_cpu_cpp_builtins
parameter_list|(
name|pfile
parameter_list|)
name|cpp_reader
modifier|*
name|pfile
decl_stmt|;
block|{
if|if
condition|(
name|TARGET_POWER2
condition|)
name|builtin_define
argument_list|(
literal|"_ARCH_PWR2"
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|TARGET_POWER
condition|)
name|builtin_define
argument_list|(
literal|"_ARCH_PWR"
argument_list|)
expr_stmt|;
if|if
condition|(
name|TARGET_POWERPC
condition|)
name|builtin_define
argument_list|(
literal|"_ARCH_PPC"
argument_list|)
expr_stmt|;
if|if
condition|(
name|TARGET_POWERPC64
condition|)
name|builtin_define
argument_list|(
literal|"_ARCH_PPC64"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|TARGET_POWER
operator|&&
operator|!
name|TARGET_POWER2
operator|&&
operator|!
name|TARGET_POWERPC
condition|)
name|builtin_define
argument_list|(
literal|"_ARCH_COM"
argument_list|)
expr_stmt|;
if|if
condition|(
name|TARGET_ALTIVEC
condition|)
name|builtin_define
argument_list|(
literal|"__ALTIVEC__"
argument_list|)
expr_stmt|;
if|if
condition|(
name|TARGET_SPE
condition|)
name|builtin_define
argument_list|(
literal|"__SPE__"
argument_list|)
expr_stmt|;
if|if
condition|(
name|TARGET_SOFT_FLOAT
condition|)
name|builtin_define
argument_list|(
literal|"_SOFT_FLOAT"
argument_list|)
expr_stmt|;
comment|/* Used by lwarx/stwcx. errata work-around.  */
if|if
condition|(
name|rs6000_cpu
operator|==
name|PROCESSOR_PPC405
condition|)
name|builtin_define
argument_list|(
literal|"__PPC405__"
argument_list|)
expr_stmt|;
comment|/* May be overridden by target configuration.  */
name|RS6000_CPU_CPP_ENDIAN_BUILTINS
argument_list|()
expr_stmt|;
if|if
condition|(
name|TARGET_LONG_DOUBLE_128
condition|)
name|builtin_define
argument_list|(
literal|"__LONG_DOUBLE_128__"
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|rs6000_current_abi
condition|)
block|{
case|case
name|ABI_V4
case|:
name|builtin_define
argument_list|(
literal|"_CALL_SYSV"
argument_list|)
expr_stmt|;
break|break;
case|case
name|ABI_AIX_NODESC
case|:
name|builtin_define
argument_list|(
literal|"_CALL_AIX"
argument_list|)
expr_stmt|;
break|break;
case|case
name|ABI_AIX
case|:
name|builtin_define
argument_list|(
literal|"_CALL_AIXDESC"
argument_list|)
expr_stmt|;
name|builtin_define
argument_list|(
literal|"_CALL_AIX"
argument_list|)
expr_stmt|;
break|break;
case|case
name|ABI_DARWIN
case|:
name|builtin_define
argument_list|(
literal|"_CALL_DARWIN"
argument_list|)
expr_stmt|;
break|break;
default|default:
break|break;
block|}
block|}
end_function

end_unit

