begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* Functions needed for soft-float on powerpc64-linux, copied from    libgcc2.c with macros expanded to force the use of specific types.      Copyright (C) 1989, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,    2000, 2001, 2002, 2003, 2004, 2006  Free Software Foundation, Inc.  This file is part of GCC.  GCC is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2, or (at your option) any later version.  In addition to the permissions in the GNU General Public License, the Free Software Foundation gives you unlimited permission to link the compiled version of this file into combinations with other programs, and to distribute those combinations without any restriction coming from the use of this file.  (The General Public License restrictions do apply in other respects; for example, they cover modification of the file, and distribution when not linked into a combine executable.)  GCC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with GCC; see the file COPYING.  If not, write to the Free Software Foundation, 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.  */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__powerpc64__
argument_list|)
operator|||
name|defined
argument_list|(
name|__64BIT__
argument_list|)
operator|||
name|defined
argument_list|(
name|__ppc64__
argument_list|)
end_if

begin_define
define|#
directive|define
name|TMODES
end_define

begin_include
include|#
directive|include
file|"config/fp-bit.h"
end_include

begin_function_decl
specifier|extern
name|DItype
name|__fixtfdi
parameter_list|(
name|TFtype
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|DItype
name|__fixdfdi
parameter_list|(
name|DFtype
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|DItype
name|__fixsfdi
parameter_list|(
name|SFtype
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|USItype
name|__fixunsdfsi
parameter_list|(
name|DFtype
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|USItype
name|__fixunssfsi
parameter_list|(
name|SFtype
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|TFtype
name|__floatditf
parameter_list|(
name|DItype
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|TFtype
name|__floatunditf
parameter_list|(
name|UDItype
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|DFtype
name|__floatdidf
parameter_list|(
name|DItype
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|DFtype
name|__floatundidf
parameter_list|(
name|UDItype
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|SFtype
name|__floatdisf
parameter_list|(
name|DItype
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|SFtype
name|__floatundisf
parameter_list|(
name|UDItype
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|DItype
name|__fixunstfdi
parameter_list|(
name|TFtype
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|DItype
name|local_fixunssfdi
parameter_list|(
name|SFtype
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|DItype
name|local_fixunsdfdi
parameter_list|(
name|DFtype
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|DItype
name|__fixtfdi
parameter_list|(
name|TFtype
name|a
parameter_list|)
block|{
if|if
condition|(
name|a
operator|<
literal|0
condition|)
return|return
operator|-
name|__fixunstfdi
argument_list|(
operator|-
name|a
argument_list|)
return|;
return|return
name|__fixunstfdi
argument_list|(
name|a
argument_list|)
return|;
block|}
end_function

begin_function
name|DItype
name|__fixdfdi
parameter_list|(
name|DFtype
name|a
parameter_list|)
block|{
if|if
condition|(
name|a
operator|<
literal|0
condition|)
return|return
operator|-
name|local_fixunsdfdi
argument_list|(
operator|-
name|a
argument_list|)
return|;
return|return
name|local_fixunsdfdi
argument_list|(
name|a
argument_list|)
return|;
block|}
end_function

begin_function
name|DItype
name|__fixsfdi
parameter_list|(
name|SFtype
name|a
parameter_list|)
block|{
if|if
condition|(
name|a
operator|<
literal|0
condition|)
return|return
operator|-
name|local_fixunssfdi
argument_list|(
operator|-
name|a
argument_list|)
return|;
return|return
name|local_fixunssfdi
argument_list|(
name|a
argument_list|)
return|;
block|}
end_function

begin_function
name|USItype
name|__fixunsdfsi
parameter_list|(
name|DFtype
name|a
parameter_list|)
block|{
if|if
condition|(
name|a
operator|>=
operator|-
call|(
name|DFtype
call|)
argument_list|(
operator|-
operator|(
call|(
name|SItype
call|)
argument_list|(
operator|(
operator|(
name|USItype
operator|)
literal|1
operator|<<
operator|(
operator|(
literal|4
operator|*
literal|8
operator|)
operator|-
literal|1
operator|)
operator|)
operator|-
literal|1
argument_list|)
operator|)
operator|-
literal|1
argument_list|)
condition|)
return|return
call|(
name|SItype
call|)
argument_list|(
name|a
operator|+
operator|(
operator|-
operator|(
call|(
name|SItype
call|)
argument_list|(
operator|(
operator|(
name|USItype
operator|)
literal|1
operator|<<
operator|(
operator|(
literal|4
operator|*
literal|8
operator|)
operator|-
literal|1
operator|)
operator|)
operator|-
literal|1
argument_list|)
operator|)
operator|-
literal|1
operator|)
argument_list|)
operator|-
operator|(
operator|-
operator|(
call|(
name|SItype
call|)
argument_list|(
operator|(
operator|(
name|USItype
operator|)
literal|1
operator|<<
operator|(
operator|(
literal|4
operator|*
literal|8
operator|)
operator|-
literal|1
operator|)
operator|)
operator|-
literal|1
argument_list|)
operator|)
operator|-
literal|1
operator|)
return|;
return|return
operator|(
name|SItype
operator|)
name|a
return|;
block|}
end_function

begin_function
name|USItype
name|__fixunssfsi
parameter_list|(
name|SFtype
name|a
parameter_list|)
block|{
if|if
condition|(
name|a
operator|>=
operator|-
call|(
name|SFtype
call|)
argument_list|(
operator|-
operator|(
call|(
name|SItype
call|)
argument_list|(
operator|(
operator|(
name|USItype
operator|)
literal|1
operator|<<
operator|(
operator|(
literal|4
operator|*
literal|8
operator|)
operator|-
literal|1
operator|)
operator|)
operator|-
literal|1
argument_list|)
operator|)
operator|-
literal|1
argument_list|)
condition|)
return|return
call|(
name|SItype
call|)
argument_list|(
name|a
operator|+
operator|(
operator|-
operator|(
call|(
name|SItype
call|)
argument_list|(
operator|(
operator|(
name|USItype
operator|)
literal|1
operator|<<
operator|(
operator|(
literal|4
operator|*
literal|8
operator|)
operator|-
literal|1
operator|)
operator|)
operator|-
literal|1
argument_list|)
operator|)
operator|-
literal|1
operator|)
argument_list|)
operator|-
operator|(
operator|-
operator|(
call|(
name|SItype
call|)
argument_list|(
operator|(
operator|(
name|USItype
operator|)
literal|1
operator|<<
operator|(
operator|(
literal|4
operator|*
literal|8
operator|)
operator|-
literal|1
operator|)
operator|)
operator|-
literal|1
argument_list|)
operator|)
operator|-
literal|1
operator|)
return|;
return|return
operator|(
name|SItype
operator|)
name|a
return|;
block|}
end_function

begin_function
name|TFtype
name|__floatditf
parameter_list|(
name|DItype
name|u
parameter_list|)
block|{
name|DFtype
name|dh
decl_stmt|,
name|dl
decl_stmt|;
name|dh
operator|=
call|(
name|SItype
call|)
argument_list|(
name|u
operator|>>
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
argument_list|)
expr_stmt|;
name|dh
operator|*=
literal|2.0
operator|*
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|)
operator|<<
operator|(
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|-
literal|1
operator|)
operator|)
expr_stmt|;
name|dl
operator|=
call|(
name|USItype
call|)
argument_list|(
name|u
operator|&
operator|(
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|)
operator|<<
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|)
operator|-
literal|1
operator|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|TFtype
operator|)
name|dh
operator|+
operator|(
name|TFtype
operator|)
name|dl
return|;
block|}
end_function

begin_function
name|TFtype
name|__floatunditf
parameter_list|(
name|UDItype
name|u
parameter_list|)
block|{
name|DFtype
name|dh
decl_stmt|,
name|dl
decl_stmt|;
name|dh
operator|=
call|(
name|USItype
call|)
argument_list|(
name|u
operator|>>
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
argument_list|)
expr_stmt|;
name|dh
operator|*=
literal|2.0
operator|*
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|)
operator|<<
operator|(
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|-
literal|1
operator|)
operator|)
expr_stmt|;
name|dl
operator|=
call|(
name|USItype
call|)
argument_list|(
name|u
operator|&
operator|(
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|)
operator|<<
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|)
operator|-
literal|1
operator|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|TFtype
operator|)
name|dh
operator|+
operator|(
name|TFtype
operator|)
name|dl
return|;
block|}
end_function

begin_function
name|DFtype
name|__floatdidf
parameter_list|(
name|DItype
name|u
parameter_list|)
block|{
name|DFtype
name|d
decl_stmt|;
name|d
operator|=
call|(
name|SItype
call|)
argument_list|(
name|u
operator|>>
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
argument_list|)
expr_stmt|;
name|d
operator|*=
literal|2.0
operator|*
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|)
operator|<<
operator|(
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|-
literal|1
operator|)
operator|)
expr_stmt|;
name|d
operator|+=
call|(
name|USItype
call|)
argument_list|(
name|u
operator|&
operator|(
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|)
operator|<<
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|)
operator|-
literal|1
operator|)
argument_list|)
expr_stmt|;
return|return
name|d
return|;
block|}
end_function

begin_function
name|DFtype
name|__floatundidf
parameter_list|(
name|UDItype
name|u
parameter_list|)
block|{
name|DFtype
name|d
decl_stmt|;
name|d
operator|=
call|(
name|USItype
call|)
argument_list|(
name|u
operator|>>
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
argument_list|)
expr_stmt|;
name|d
operator|*=
literal|2.0
operator|*
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|)
operator|<<
operator|(
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|-
literal|1
operator|)
operator|)
expr_stmt|;
name|d
operator|+=
call|(
name|USItype
call|)
argument_list|(
name|u
operator|&
operator|(
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|)
operator|<<
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|)
operator|-
literal|1
operator|)
argument_list|)
expr_stmt|;
return|return
name|d
return|;
block|}
end_function

begin_function
name|SFtype
name|__floatdisf
parameter_list|(
name|DItype
name|u
parameter_list|)
block|{
name|DFtype
name|f
decl_stmt|;
if|if
condition|(
literal|53
operator|<
operator|(
sizeof|sizeof
argument_list|(
name|DItype
argument_list|)
operator|*
literal|8
operator|)
operator|&&
literal|53
operator|>
operator|(
operator|(
sizeof|sizeof
argument_list|(
name|DItype
argument_list|)
operator|*
literal|8
operator|)
operator|-
literal|53
operator|+
literal|24
operator|)
condition|)
block|{
if|if
condition|(
operator|!
operator|(
operator|-
operator|(
operator|(
name|DItype
operator|)
literal|1
operator|<<
literal|53
operator|)
operator|<
name|u
operator|&&
name|u
operator|<
operator|(
operator|(
name|DItype
operator|)
literal|1
operator|<<
literal|53
operator|)
operator|)
condition|)
block|{
if|if
condition|(
operator|(
name|UDItype
operator|)
name|u
operator|&
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|<<
operator|(
operator|(
sizeof|sizeof
argument_list|(
name|DItype
argument_list|)
operator|*
literal|8
operator|)
operator|-
literal|53
operator|)
operator|)
operator|-
literal|1
operator|)
condition|)
block|{
name|u
operator|&=
operator|~
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|<<
operator|(
operator|(
sizeof|sizeof
argument_list|(
name|DItype
argument_list|)
operator|*
literal|8
operator|)
operator|-
literal|53
operator|)
operator|)
operator|-
literal|1
operator|)
expr_stmt|;
name|u
operator||=
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|<<
operator|(
operator|(
sizeof|sizeof
argument_list|(
name|DItype
argument_list|)
operator|*
literal|8
operator|)
operator|-
literal|53
operator|)
operator|)
expr_stmt|;
block|}
block|}
block|}
name|f
operator|=
call|(
name|SItype
call|)
argument_list|(
name|u
operator|>>
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
argument_list|)
expr_stmt|;
name|f
operator|*=
literal|2.0
operator|*
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|)
operator|<<
operator|(
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|-
literal|1
operator|)
operator|)
expr_stmt|;
name|f
operator|+=
call|(
name|USItype
call|)
argument_list|(
name|u
operator|&
operator|(
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|)
operator|<<
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|)
operator|-
literal|1
operator|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|SFtype
operator|)
name|f
return|;
block|}
end_function

begin_function
name|SFtype
name|__floatundisf
parameter_list|(
name|UDItype
name|u
parameter_list|)
block|{
name|DFtype
name|f
decl_stmt|;
if|if
condition|(
literal|53
operator|<
operator|(
sizeof|sizeof
argument_list|(
name|DItype
argument_list|)
operator|*
literal|8
operator|)
operator|&&
literal|53
operator|>
operator|(
operator|(
sizeof|sizeof
argument_list|(
name|DItype
argument_list|)
operator|*
literal|8
operator|)
operator|-
literal|53
operator|+
literal|24
operator|)
condition|)
block|{
if|if
condition|(
name|u
operator|>=
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|<<
literal|53
operator|)
condition|)
block|{
if|if
condition|(
operator|(
name|UDItype
operator|)
name|u
operator|&
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|<<
operator|(
operator|(
sizeof|sizeof
argument_list|(
name|DItype
argument_list|)
operator|*
literal|8
operator|)
operator|-
literal|53
operator|)
operator|)
operator|-
literal|1
operator|)
condition|)
block|{
name|u
operator|&=
operator|~
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|<<
operator|(
operator|(
sizeof|sizeof
argument_list|(
name|DItype
argument_list|)
operator|*
literal|8
operator|)
operator|-
literal|53
operator|)
operator|)
operator|-
literal|1
operator|)
expr_stmt|;
name|u
operator||=
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|<<
operator|(
operator|(
sizeof|sizeof
argument_list|(
name|DItype
argument_list|)
operator|*
literal|8
operator|)
operator|-
literal|53
operator|)
operator|)
expr_stmt|;
block|}
block|}
block|}
name|f
operator|=
call|(
name|USItype
call|)
argument_list|(
name|u
operator|>>
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
argument_list|)
expr_stmt|;
name|f
operator|*=
literal|2.0
operator|*
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|)
operator|<<
operator|(
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|-
literal|1
operator|)
operator|)
expr_stmt|;
name|f
operator|+=
call|(
name|USItype
call|)
argument_list|(
name|u
operator|&
operator|(
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|)
operator|<<
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|)
operator|-
literal|1
operator|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|SFtype
operator|)
name|f
return|;
block|}
end_function

begin_function
name|DItype
name|__fixunstfdi
parameter_list|(
name|TFtype
name|a
parameter_list|)
block|{
if|if
condition|(
name|a
operator|<
literal|0
condition|)
return|return
literal|0
return|;
comment|/* Compute high word of result, as a flonum.  */
specifier|const
name|TFtype
name|b
init|=
operator|(
name|a
operator|/
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|)
operator|<<
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|)
operator|)
decl_stmt|;
comment|/* Convert that to fixed (but not to DItype!),      and shift it into the high word.  */
name|UDItype
name|v
init|=
operator|(
name|USItype
operator|)
name|b
decl_stmt|;
name|v
operator|<<=
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
expr_stmt|;
comment|/* Remove high part from the TFtype, leaving the low part as flonum.  */
name|a
operator|-=
operator|(
name|TFtype
operator|)
name|v
expr_stmt|;
comment|/* Convert that to fixed (but not to DItype!) and add it in.      Sometimes A comes out negative.  This is significant, since      A has more bits than a long int does.  */
if|if
condition|(
name|a
operator|<
literal|0
condition|)
name|v
operator|-=
call|(
name|USItype
call|)
argument_list|(
operator|-
name|a
argument_list|)
expr_stmt|;
else|else
name|v
operator|+=
operator|(
name|USItype
operator|)
name|a
expr_stmt|;
return|return
name|v
return|;
block|}
end_function

begin_comment
comment|/* This version is needed to prevent recursion; fixunsdfdi in libgcc    calls fixdfdi, which in turn calls calls fixunsdfdi.  */
end_comment

begin_function
specifier|static
name|DItype
name|local_fixunsdfdi
parameter_list|(
name|DFtype
name|a
parameter_list|)
block|{
name|USItype
name|hi
decl_stmt|,
name|lo
decl_stmt|;
name|hi
operator|=
name|a
operator|/
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|)
operator|<<
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|)
expr_stmt|;
name|lo
operator|=
operator|(
name|a
operator|-
operator|(
operator|(
name|DFtype
operator|)
name|hi
operator|)
operator|*
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|)
operator|<<
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|)
operator|)
expr_stmt|;
return|return
operator|(
operator|(
name|UDItype
operator|)
name|hi
operator|<<
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|)
operator||
name|lo
return|;
block|}
end_function

begin_comment
comment|/* This version is needed to prevent recursion; fixunssfdi in libgcc    calls fixsfdi, which in turn calls calls fixunssfdi.  */
end_comment

begin_function
specifier|static
name|DItype
name|local_fixunssfdi
parameter_list|(
name|SFtype
name|original_a
parameter_list|)
block|{
name|DFtype
name|a
init|=
name|original_a
decl_stmt|;
name|USItype
name|hi
decl_stmt|,
name|lo
decl_stmt|;
name|hi
operator|=
name|a
operator|/
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|)
operator|<<
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|)
expr_stmt|;
name|lo
operator|=
operator|(
name|a
operator|-
operator|(
operator|(
name|DFtype
operator|)
name|hi
operator|)
operator|*
operator|(
operator|(
operator|(
name|UDItype
operator|)
literal|1
operator|)
operator|<<
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|)
operator|)
expr_stmt|;
return|return
operator|(
operator|(
name|UDItype
operator|)
name|hi
operator|<<
operator|(
sizeof|sizeof
argument_list|(
name|SItype
argument_list|)
operator|*
literal|8
operator|)
operator|)
operator||
name|lo
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* __powerpc64__ */
end_comment

end_unit

