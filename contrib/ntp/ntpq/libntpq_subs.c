begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*****************************************************************************  *  *  libntpq_subs.c  *  *  This is the second part of the wrapper library for ntpq, the NTP query utility.   *  This library reuses the sourcecode from ntpq and exports a number  *  of useful functions in a library that can be linked against applications  *  that need to query the status of a running ntpd. The whole   *  communcation is based on mode 6 packets.  *  *  This source file exports the (private) functions from ntpq-subs.c   *  ****************************************************************************/
end_comment

begin_include
include|#
directive|include
file|"ntpq-subs.c"
end_include

begin_include
include|#
directive|include
file|"libntpq.h"
end_include

begin_function
name|int
name|ntpq_dogetassoc
parameter_list|(
name|void
parameter_list|)
block|{
if|if
condition|(
name|dogetassoc
argument_list|(
name|NULL
argument_list|)
condition|)
return|return
name|numassoc
return|;
else|else
return|return
literal|0
return|;
block|}
end_function

begin_comment
comment|/* the following functions are required internally by a number of libntpq functions   * and since they are defined as static in ntpq-subs.c, they need to be exported here  */
end_comment

begin_function
name|char
name|ntpq_decodeaddrtype
parameter_list|(
name|sockaddr_u
modifier|*
name|sock
parameter_list|)
block|{
return|return
name|decodeaddrtype
argument_list|(
name|sock
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|ntpq_doquerylist
parameter_list|(
name|struct
name|ntpq_varlist
modifier|*
name|vlist
parameter_list|,
name|int
name|op
parameter_list|,
name|associd_t
name|associd
parameter_list|,
name|int
name|auth
parameter_list|,
name|u_short
modifier|*
name|rstatus
parameter_list|,
name|int
modifier|*
name|dsize
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|datap
parameter_list|)
block|{
return|return
name|doquerylist
argument_list|(
operator|(
expr|struct
name|varlist
operator|*
operator|)
name|vlist
argument_list|,
name|op
argument_list|,
name|associd
argument_list|,
name|auth
argument_list|,
name|rstatus
argument_list|,
name|dsize
argument_list|,
name|datap
argument_list|)
return|;
block|}
end_function

end_unit

