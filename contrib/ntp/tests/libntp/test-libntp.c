begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_include
include|#
directive|include
file|<config.h>
end_include

begin_include
include|#
directive|include
file|"ntp_stdlib.h"
end_include

begin_include
include|#
directive|include
file|"ntp_calendar.h"
end_include

begin_include
include|#
directive|include
file|"test-libntp.h"
end_include

begin_decl_stmt
name|time_t
name|nowtime
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_function
name|time_t
name|timefunc
parameter_list|(
name|time_t
modifier|*
name|ptr
parameter_list|)
block|{
if|if
condition|(
name|ptr
condition|)
operator|*
name|ptr
operator|=
name|nowtime
expr_stmt|;
return|return
name|nowtime
return|;
block|}
end_function

begin_function
name|void
name|settime
parameter_list|(
name|int
name|y
parameter_list|,
name|int
name|m
parameter_list|,
name|int
name|d
parameter_list|,
name|int
name|H
parameter_list|,
name|int
name|M
parameter_list|,
name|int
name|S
parameter_list|)
block|{
name|time_t
name|days
init|=
name|ntpcal_edate_to_eradays
argument_list|(
name|y
operator|-
literal|1
argument_list|,
name|m
operator|-
literal|1
argument_list|,
name|d
operator|-
literal|1
argument_list|)
operator|+
literal|1
operator|-
name|DAY_UNIX_STARTS
decl_stmt|;
name|time_t
name|secs
init|=
name|ntpcal_etime_to_seconds
argument_list|(
name|H
argument_list|,
name|M
argument_list|,
name|S
argument_list|)
decl_stmt|;
name|nowtime
operator|=
name|days
operator|*
name|SECSPERDAY
operator|+
name|secs
expr_stmt|;
block|}
end_function

end_unit

