begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (C) 2011, 2012  Internet Systems Consortium, Inc. ("ISC")  *  * Permission to use, copy, modify, and/or distribute this software for any  * purpose with or without fee is hereby granted, provided that the above  * copyright notice and this permission notice appear in all copies.  *  * THE SOFTWARE IS PROVIDED "AS IS" AND ISC DISCLAIMS ALL WARRANTIES WITH  * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY  * AND FITNESS.  IN NO EVENT SHALL ISC BE LIABLE FOR ANY SPECIAL, DIRECT,  * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM  * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE  * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR  * PERFORMANCE OF THIS SOFTWARE.  */
end_comment

begin_comment
comment|/* $Id$ */
end_comment

begin_comment
comment|/* ! \file */
end_comment

begin_include
include|#
directive|include
file|<config.h>
end_include

begin_include
include|#
directive|include
file|<atf-c.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<isc/hmacmd5.h>
end_include

begin_include
include|#
directive|include
file|<isc/hmacsha.h>
end_include

begin_include
include|#
directive|include
file|<isc/md5.h>
end_include

begin_include
include|#
directive|include
file|<isc/sha1.h>
end_include

begin_include
include|#
directive|include
file|<isc/util.h>
end_include

begin_include
include|#
directive|include
file|<isc/string.h>
end_include

begin_comment
comment|/*  * Test data from RFC6234  */
end_comment

begin_decl_stmt
name|unsigned
name|char
name|digest
index|[
name|ISC_SHA512_DIGESTLENGTH
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|unsigned
name|char
name|buffer
index|[
literal|1024
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
name|s
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
name|str
index|[
name|ISC_SHA512_DIGESTLENGTH
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|unsigned
name|char
name|key
index|[
literal|20
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|i
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_function_decl
name|isc_result_t
name|tohexstr
parameter_list|(
name|unsigned
name|char
modifier|*
name|d
parameter_list|,
name|unsigned
name|int
name|len
parameter_list|,
name|char
modifier|*
name|out
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/*  * Precondition: a hexadecimal number in *d, the length of that number in len,  *   and a pointer to a character array to put the output (*out).  * Postcondition: A String representation of the given hexadecimal number is  *   placed into the array *out  *  * 'out' MUST point to an array of at least len / 2 + 1  *  * Return values: ISC_R_SUCCESS if the operation is sucessful  */
end_comment

begin_function
name|isc_result_t
name|tohexstr
parameter_list|(
name|unsigned
name|char
modifier|*
name|d
parameter_list|,
name|unsigned
name|int
name|len
parameter_list|,
name|char
modifier|*
name|out
parameter_list|)
block|{
name|out
index|[
literal|0
index|]
operator|=
literal|'\0'
expr_stmt|;
name|char
name|c_ret
index|[]
init|=
literal|"AA"
decl_stmt|;
name|unsigned
name|int
name|i
decl_stmt|;
name|strcat
argument_list|(
name|out
argument_list|,
literal|"0x"
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
name|i
operator|++
control|)
block|{
name|sprintf
argument_list|(
name|c_ret
argument_list|,
literal|"%02X"
argument_list|,
name|d
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|out
argument_list|,
name|c_ret
argument_list|)
expr_stmt|;
block|}
name|strcat
argument_list|(
name|out
argument_list|,
literal|"\0"
argument_list|)
expr_stmt|;
return|return
operator|(
name|ISC_R_SUCCESS
operator|)
return|;
block|}
end_function

begin_define
define|#
directive|define
name|TEST_INPUT
parameter_list|(
name|x
parameter_list|)
value|(x), sizeof(x)-1
end_define

begin_typedef
typedef|typedef
struct|struct
name|hash_testcase
block|{
specifier|const
name|char
modifier|*
name|input
decl_stmt|;
name|size_t
name|input_len
decl_stmt|;
specifier|const
name|char
modifier|*
name|result
decl_stmt|;
name|int
name|repeats
decl_stmt|;
block|}
name|hash_testcase_t
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|hash_test_key
block|{
specifier|const
name|char
modifier|*
name|key
decl_stmt|;
specifier|const
name|int
name|len
decl_stmt|;
block|}
name|hash_test_key_t
typedef|;
end_typedef

begin_comment
comment|/* non-hmac tests */
end_comment

begin_expr_stmt
name|ATF_TC
argument_list|(
name|isc_sha1
argument_list|)
expr_stmt|;
end_expr_stmt

begin_macro
name|ATF_TC_HEAD
argument_list|(
argument|isc_sha1
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|atf_tc_set_md_var
argument_list|(
name|tc
argument_list|,
literal|"descr"
argument_list|,
literal|"sha1 examples from RFC4634"
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|ATF_TC_BODY
argument_list|(
argument|isc_sha1
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|isc_sha1_t
name|sha1
decl_stmt|;
name|UNUSED
argument_list|(
name|tc
argument_list|)
expr_stmt|;
comment|/* 	 * These are the various test vectors.  All of these are passed 	 * through the hash function and the results are compared to the 	 * result specified here. 	 */
name|hash_testcase_t
name|testcases
index|[]
init|=
block|{
comment|/* Test 1 */
block|{
name|TEST_INPUT
argument_list|(
literal|"abc"
argument_list|)
block|,
literal|"0xA9993E364706816ABA3E25717850C26C9CD0D89D"
block|,
literal|1
block|}
block|,
comment|/* Test 2 */
block|{
name|TEST_INPUT
argument_list|(
literal|"abcdbcdecdefdefgefghfghighijhijkijk"
literal|"ljklmklmnlmnomnopnopq"
argument_list|)
block|,
literal|"0x84983E441C3BD26EBAAE4AA1F95129E5E54670F1"
block|,
literal|1
block|}
block|,
comment|/* Test 3 */
block|{
name|TEST_INPUT
argument_list|(
literal|"a"
argument_list|)
comment|/* times 1000000 */
block|,
literal|"0x34AA973CD4C4DAA4F61EEB2BDBAD27316534016F"
block|,
literal|1000000
block|}
block|,
comment|/* Test 4 -- exact multiple of 512 bits */
block|{
name|TEST_INPUT
argument_list|(
literal|"01234567012345670123456701234567"
argument_list|)
block|,
literal|"0xDEA356A2CDDD90C7A7ECEDC5EBB563934F460452"
block|,
literal|20
comment|/* 20 times */
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 5 -- optional feature, not implemented */
block|{ 			TEST_INPUT(""),
comment|/* "extrabits": 0x98 , "numberextrabits": 5 */
block|"0x29826B003B906E660EFF4027CE98AF3531AC75BA", 			1 		},
endif|#
directive|endif
comment|/* Test 6 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x5e"
argument_list|)
block|,
literal|"0x5E6F80A34A9798CAFC6A5DB96CC57BA4C4DB59C2"
block|,
literal|1
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 7 -- optional feature, not implemented */
block|{ 			TEST_INPUT("\x49\xb2\xae\xc2\x59\x4b\xbe\x3a" 				   "\x3b\x11\x75\x42\xd9\x4a\xc8"),
comment|/* "extrabits": 0x80, "numberextrabits": 3 */
block|"0x6239781E03729919C01955B3FFA8ACB60B988340", 1 },
endif|#
directive|endif
comment|/* Test 8 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x9a\x7d\xfd\xf1\xec\xea\xd0\x6e\xd6\x46"
literal|"\xaa\x55\xfe\x75\x71\x46"
argument_list|)
block|,
literal|"0x82ABFF6605DBE1C17DEF12A394FA22A82B544A35"
block|,
literal|1
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 9 -- optional feature, not implemented */
block|{ 			TEST_INPUT("\x65\xf9\x32\x99\x5b\xa4\xce\x2c\xb1\xb4" 				   "\xa2\xe7\x1a\xe7\x02\x20\xaa\xce\xc8\x96" 				   "\x2d\xd4\x49\x9c\xbd\x7c\x88\x7a\x94\xea" 				   "\xaa\x10\x1e\xa5\xaa\xbc\x52\x9b\x4e\x7e" 				   "\x43\x66\x5a\x5a\xf2\xcd\x03\xfe\x67\x8e" 				   "\xa6\xa5\x00\x5b\xba\x3b\x08\x22\x04\xc2" 				   "\x8b\x91\x09\xf4\x69\xda\xc9\x2a\xaa\xb3" 				   "\xaa\x7c\x11\xa1\xb3\x2a"),
comment|/* "extrabits": 0xE0 , "numberextrabits": 3 */
block|"0x8C5B2A5DDAE5A97FC7F9D85661C672ADBF7933D4", 			1 		},
endif|#
directive|endif
comment|/* Test 10 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xf7\x8f\x92\x14\x1b\xcd\x17\x0a\xe8\x9b"
literal|"\x4f\xba\x15\xa1\xd5\x9f\x3f\xd8\x4d\x22"
literal|"\x3c\x92\x51\xbd\xac\xbb\xae\x61\xd0\x5e"
literal|"\xd1\x15\xa0\x6a\x7c\xe1\x17\xb7\xbe\xea"
literal|"\xd2\x44\x21\xde\xd9\xc3\x25\x92\xbd\x57"
literal|"\xed\xea\xe3\x9c\x39\xfa\x1f\xe8\x94\x6a"
literal|"\x84\xd0\xcf\x1f\x7b\xee\xad\x17\x13\xe2"
literal|"\xe0\x95\x98\x97\x34\x7f\x67\xc8\x0b\x04"
literal|"\x00\xc2\x09\x81\x5d\x6b\x10\xa6\x83\x83"
literal|"\x6f\xd5\x56\x2a\x56\xca\xb1\xa2\x8e\x81"
literal|"\xb6\x57\x66\x54\x63\x1c\xf1\x65\x66\xb8"
literal|"\x6e\x3b\x33\xa1\x08\xb0\x53\x07\xc0\x0a"
literal|"\xff\x14\xa7\x68\xed\x73\x50\x60\x6a\x0f"
literal|"\x85\xe6\xa9\x1d\x39\x6f\x5b\x5c\xbe\x57"
literal|"\x7f\x9b\x38\x80\x7c\x7d\x52\x3d\x6d\x79"
literal|"\x2f\x6e\xbc\x24\xa4\xec\xf2\xb3\xa4\x27"
literal|"\xcd\xbb\xfb"
argument_list|)
block|,
literal|"0xCB0082C8F197D260991BA6A460E76E202BAD27B3"
block|,
literal|1
block|}
block|,
block|{
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
literal|1
block|}
block|}
decl_stmt|;
name|hash_testcase_t
modifier|*
name|testcase
init|=
name|testcases
decl_stmt|;
while|while
condition|(
name|testcase
operator|->
name|input
operator|!=
name|NULL
operator|&&
name|testcase
operator|->
name|result
operator|!=
name|NULL
condition|)
block|{
name|isc_sha1_init
argument_list|(
operator|&
name|sha1
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|testcase
operator|->
name|repeats
condition|;
name|i
operator|++
control|)
block|{
name|isc_sha1_update
argument_list|(
operator|&
name|sha1
argument_list|,
operator|(
specifier|const
name|isc_uint8_t
operator|*
operator|)
name|testcase
operator|->
name|input
argument_list|,
name|testcase
operator|->
name|input_len
argument_list|)
expr_stmt|;
block|}
name|isc_sha1_final
argument_list|(
operator|&
name|sha1
argument_list|,
name|digest
argument_list|)
expr_stmt|;
name|tohexstr
argument_list|(
name|digest
argument_list|,
name|ISC_SHA1_DIGESTLENGTH
argument_list|,
name|str
argument_list|)
expr_stmt|;
name|ATF_CHECK_STREQ
argument_list|(
name|str
argument_list|,
name|testcase
operator|->
name|result
argument_list|)
expr_stmt|;
name|testcase
operator|++
expr_stmt|;
block|}
block|}
end_block

begin_expr_stmt
name|ATF_TC
argument_list|(
name|isc_sha224
argument_list|)
expr_stmt|;
end_expr_stmt

begin_macro
name|ATF_TC_HEAD
argument_list|(
argument|isc_sha224
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|atf_tc_set_md_var
argument_list|(
name|tc
argument_list|,
literal|"descr"
argument_list|,
literal|"sha224 examples from RFC4634"
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|ATF_TC_BODY
argument_list|(
argument|isc_sha224
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|isc_sha224_t
name|sha224
decl_stmt|;
name|UNUSED
argument_list|(
name|tc
argument_list|)
expr_stmt|;
comment|/* 	 * These are the various test vectors.  All of these are passed 	 * through the hash function and the results are compared to the 	 * result specified here. 	 */
name|hash_testcase_t
name|testcases
index|[]
init|=
block|{
comment|/* Test 1 */
block|{
name|TEST_INPUT
argument_list|(
literal|"abc"
argument_list|)
block|,
literal|"0x23097D223405D8228642A477BDA255B32AADBCE4BDA0B3F7"
literal|"E36C9DA7"
block|,
literal|1
block|}
block|,
comment|/* Test 2 */
block|{
name|TEST_INPUT
argument_list|(
literal|"abcdbcdecdefdefgefghfghighijhijkijklj"
literal|"klmklmnlmnomnopnopq"
argument_list|)
block|,
literal|"0x75388B16512776CC5DBA5DA1FD890150B0C6455CB4F58B"
literal|"1952522525"
block|,
literal|1
block|}
block|,
comment|/* Test 3 */
block|{
name|TEST_INPUT
argument_list|(
literal|"a"
argument_list|)
block|,
literal|"0x20794655980C91D8BBB4C1EA97618A4BF03F42581948B2"
literal|"EE4EE7AD67"
block|,
literal|1000000
block|}
block|,
comment|/* Test 4 */
block|{
name|TEST_INPUT
argument_list|(
literal|"01234567012345670123456701234567"
argument_list|)
block|,
literal|"0x567F69F168CD7844E65259CE658FE7AADFA25216E68ECA"
literal|"0EB7AB8262"
block|,
literal|20
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 5 -- unimplemented optional functionality */
block|{ 			TEST_INPUT(""), 			"0xXXX", 			1 		},
endif|#
directive|endif
comment|/* Test 6 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x07"
argument_list|)
block|,
literal|"0x00ECD5F138422B8AD74C9799FD826C531BAD2FCABC7450"
literal|"BEE2AA8C2A"
block|,
literal|1
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 7 -- unimplemented optional functionality */
block|{ 			TEST_INPUT(""), 			"0xXXX", 			1 		},
endif|#
directive|endif
comment|/* Test 8 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x18\x80\x40\x05\xdd\x4f\xbd\x15\x56\x29"
literal|"\x9d\x6f\x9d\x93\xdf\x62"
argument_list|)
block|,
literal|"0xDF90D78AA78821C99B40BA4C966921ACCD8FFB1E98AC38"
literal|"8E56191DB1"
block|,
literal|1
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 9 */
block|{ 			TEST_INPUT(""), 			"0xXXX", 			1 		},
endif|#
directive|endif
comment|/* Test 10 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x55\xb2\x10\x07\x9c\x61\xb5\x3a\xdd\x52"
literal|"\x06\x22\xd1\xac\x97\xd5\xcd\xbe\x8c\xb3"
literal|"\x3a\xa0\xae\x34\x45\x17\xbe\xe4\xd7\xba"
literal|"\x09\xab\xc8\x53\x3c\x52\x50\x88\x7a\x43"
literal|"\xbe\xbb\xac\x90\x6c\x2e\x18\x37\xf2\x6b"
literal|"\x36\xa5\x9a\xe3\xbe\x78\x14\xd5\x06\x89"
literal|"\x6b\x71\x8b\x2a\x38\x3e\xcd\xac\x16\xb9"
literal|"\x61\x25\x55\x3f\x41\x6f\xf3\x2c\x66\x74"
literal|"\xc7\x45\x99\xa9\x00\x53\x86\xd9\xce\x11"
literal|"\x12\x24\x5f\x48\xee\x47\x0d\x39\x6c\x1e"
literal|"\xd6\x3b\x92\x67\x0c\xa5\x6e\xc8\x4d\xee"
literal|"\xa8\x14\xb6\x13\x5e\xca\x54\x39\x2b\xde"
literal|"\xdb\x94\x89\xbc\x9b\x87\x5a\x8b\xaf\x0d"
literal|"\xc1\xae\x78\x57\x36\x91\x4a\xb7\xda\xa2"
literal|"\x64\xbc\x07\x9d\x26\x9f\x2c\x0d\x7e\xdd"
literal|"\xd8\x10\xa4\x26\x14\x5a\x07\x76\xf6\x7c"
literal|"\x87\x82\x73"
argument_list|)
block|,
literal|"0x0B31894EC8937AD9B91BDFBCBA294D9ADEFAA18E09305E"
literal|"9F20D5C3A4"
block|,
literal|1
block|}
block|,
block|{
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
literal|1
block|}
block|}
decl_stmt|;
name|hash_testcase_t
modifier|*
name|testcase
init|=
name|testcases
decl_stmt|;
while|while
condition|(
name|testcase
operator|->
name|input
operator|!=
name|NULL
operator|&&
name|testcase
operator|->
name|result
operator|!=
name|NULL
condition|)
block|{
name|isc_sha224_init
argument_list|(
operator|&
name|sha224
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|testcase
operator|->
name|repeats
condition|;
name|i
operator|++
control|)
block|{
name|isc_sha224_update
argument_list|(
operator|&
name|sha224
argument_list|,
operator|(
specifier|const
name|isc_uint8_t
operator|*
operator|)
name|testcase
operator|->
name|input
argument_list|,
name|testcase
operator|->
name|input_len
argument_list|)
expr_stmt|;
block|}
name|isc_sha224_final
argument_list|(
name|digest
argument_list|,
operator|&
name|sha224
argument_list|)
expr_stmt|;
comment|/* 		*API inconsistency BUG HERE 		* in order to be consistant with the other isc_hash_final 		* functions the call should be 		* isc_sha224_final(&sha224, digest); 		 */
name|tohexstr
argument_list|(
name|digest
argument_list|,
name|ISC_SHA224_DIGESTLENGTH
argument_list|,
name|str
argument_list|)
expr_stmt|;
name|ATF_CHECK_STREQ
argument_list|(
name|str
argument_list|,
name|testcase
operator|->
name|result
argument_list|)
expr_stmt|;
name|testcase
operator|++
expr_stmt|;
block|}
block|}
end_block

begin_expr_stmt
name|ATF_TC
argument_list|(
name|isc_sha256
argument_list|)
expr_stmt|;
end_expr_stmt

begin_macro
name|ATF_TC_HEAD
argument_list|(
argument|isc_sha256
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|atf_tc_set_md_var
argument_list|(
name|tc
argument_list|,
literal|"descr"
argument_list|,
literal|"sha224 examples from RFC4634"
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|ATF_TC_BODY
argument_list|(
argument|isc_sha256
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|isc_sha256_t
name|sha256
decl_stmt|;
name|UNUSED
argument_list|(
name|tc
argument_list|)
expr_stmt|;
comment|/* 	 * These are the various test vectors.  All of these are passed 	 * through the hash function and the results are compared to the 	 * result specified here. 	 */
name|hash_testcase_t
name|testcases
index|[]
init|=
block|{
comment|/* Test 1 */
block|{
name|TEST_INPUT
argument_list|(
literal|"abc"
argument_list|)
block|,
literal|"0xBA7816BF8F01CFEA414140DE5DAE2223B00361A396177A"
literal|"9CB410FF61F20015AD"
block|,
literal|1
block|}
block|,
comment|/* Test 2 */
block|{
name|TEST_INPUT
argument_list|(
literal|"abcdbcdecdefdefgefghfghighijhijkijkljk"
literal|"lmklmnlmnomnopnopq"
argument_list|)
block|,
literal|"0x248D6A61D20638B8E5C026930C3E6039A33CE45964FF21"
literal|"67F6ECEDD419DB06C1"
block|,
literal|1
block|}
block|,
comment|/* Test 3 */
block|{
name|TEST_INPUT
argument_list|(
literal|"a"
argument_list|)
block|,
literal|"0xCDC76E5C9914FB9281A1C7E284D73E67F1809A48A49720"
literal|"0E046D39CCC7112CD0"
block|,
literal|1000000
block|}
block|,
comment|/* Test 4 */
block|{
name|TEST_INPUT
argument_list|(
literal|"01234567012345670123456701234567"
argument_list|)
block|,
literal|"0x594847328451BDFA85056225462CC1D867D877FB388DF0"
literal|"CE35F25AB5562BFBB5"
block|,
literal|20
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 5 -- unimplemented optional functionality */
block|{ 			TEST_INPUT(""), 			"0xXXX", 			1 		},
endif|#
directive|endif
comment|/* Test 6 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x19"
argument_list|)
block|,
literal|"0x68AA2E2EE5DFF96E3355E6C7EE373E3D6A4E17F75F9518"
literal|"D843709C0C9BC3E3D4"
block|,
literal|1
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 7 -- unimplemented optional functionality */
block|{ 			TEST_INPUT(""), 			"0xXXX", 			1 		},
endif|#
directive|endif
comment|/* Test 8 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xe3\xd7\x25\x70\xdc\xdd\x78\x7c\xe3"
literal|"\x88\x7a\xb2\xcd\x68\x46\x52"
argument_list|)
block|,
literal|"0x175EE69B02BA9B58E2B0A5FD13819CEA573F3940A94F82"
literal|"5128CF4209BEABB4E8"
block|,
literal|1
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 9 -- unimplemented optional functionality */
block|{ 			TEST_INPUT(""), 			"0xXXX", 			1 		},
endif|#
directive|endif
comment|/* Test 10 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x83\x26\x75\x4e\x22\x77\x37\x2f\x4f\xc1"
literal|"\x2b\x20\x52\x7a\xfe\xf0\x4d\x8a\x05\x69"
literal|"\x71\xb1\x1a\xd5\x71\x23\xa7\xc1\x37\x76"
literal|"\x00\x00\xd7\xbe\xf6\xf3\xc1\xf7\xa9\x08"
literal|"\x3a\xa3\x9d\x81\x0d\xb3\x10\x77\x7d\xab"
literal|"\x8b\x1e\x7f\x02\xb8\x4a\x26\xc7\x73\x32"
literal|"\x5f\x8b\x23\x74\xde\x7a\x4b\x5a\x58\xcb"
literal|"\x5c\x5c\xf3\x5b\xce\xe6\xfb\x94\x6e\x5b"
literal|"\xd6\x94\xfa\x59\x3a\x8b\xeb\x3f\x9d\x65"
literal|"\x92\xec\xed\xaa\x66\xca\x82\xa2\x9d\x0c"
literal|"\x51\xbc\xf9\x33\x62\x30\xe5\xd7\x84\xe4"
literal|"\xc0\xa4\x3f\x8d\x79\xa3\x0a\x16\x5c\xba"
literal|"\xbe\x45\x2b\x77\x4b\x9c\x71\x09\xa9\x7d"
literal|"\x13\x8f\x12\x92\x28\x96\x6f\x6c\x0a\xdc"
literal|"\x10\x6a\xad\x5a\x9f\xdd\x30\x82\x57\x69"
literal|"\xb2\xc6\x71\xaf\x67\x59\xdf\x28\xeb\x39"
literal|"\x3d\x54\xd6"
argument_list|)
block|,
literal|"0x97DBCA7DF46D62C8A422C941DD7E835B8AD3361763F7E9"
literal|"B2D95F4F0DA6E1CCBC"
block|,
literal|1
block|}
block|,
block|{
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
literal|1
block|}
block|}
decl_stmt|;
name|hash_testcase_t
modifier|*
name|testcase
init|=
name|testcases
decl_stmt|;
while|while
condition|(
name|testcase
operator|->
name|input
operator|!=
name|NULL
operator|&&
name|testcase
operator|->
name|result
operator|!=
name|NULL
condition|)
block|{
name|isc_sha256_init
argument_list|(
operator|&
name|sha256
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|testcase
operator|->
name|repeats
condition|;
name|i
operator|++
control|)
block|{
name|isc_sha256_update
argument_list|(
operator|&
name|sha256
argument_list|,
operator|(
specifier|const
name|isc_uint8_t
operator|*
operator|)
name|testcase
operator|->
name|input
argument_list|,
name|testcase
operator|->
name|input_len
argument_list|)
expr_stmt|;
block|}
name|isc_sha256_final
argument_list|(
name|digest
argument_list|,
operator|&
name|sha256
argument_list|)
expr_stmt|;
comment|/* 		*API inconsistency BUG HERE 		* in order to be consistant with the other isc_hash_final 		* functions the call should be 		* isc_sha224_final(&sha224, digest); 		 */
name|tohexstr
argument_list|(
name|digest
argument_list|,
name|ISC_SHA256_DIGESTLENGTH
argument_list|,
name|str
argument_list|)
expr_stmt|;
name|ATF_CHECK_STREQ
argument_list|(
name|str
argument_list|,
name|testcase
operator|->
name|result
argument_list|)
expr_stmt|;
name|testcase
operator|++
expr_stmt|;
block|}
block|}
end_block

begin_expr_stmt
name|ATF_TC
argument_list|(
name|isc_sha384
argument_list|)
expr_stmt|;
end_expr_stmt

begin_macro
name|ATF_TC_HEAD
argument_list|(
argument|isc_sha384
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|atf_tc_set_md_var
argument_list|(
name|tc
argument_list|,
literal|"descr"
argument_list|,
literal|"sha224 examples from RFC4634"
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|ATF_TC_BODY
argument_list|(
argument|isc_sha384
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|isc_sha384_t
name|sha384
decl_stmt|;
name|UNUSED
argument_list|(
name|tc
argument_list|)
expr_stmt|;
comment|/* 	 * These are the various test vectors.  All of these are passed 	 * through the hash function and the results are compared to the 	 * result specified here. 	 */
name|hash_testcase_t
name|testcases
index|[]
init|=
block|{
comment|/* Test 1 */
block|{
name|TEST_INPUT
argument_list|(
literal|"abc"
argument_list|)
block|,
literal|"0xCB00753F45A35E8BB5A03D699AC65007272C32AB0EDED1"
literal|"631A8B605A43FF5BED8086072BA1E7CC2358BAEC"
literal|"A134C825A7"
block|,
literal|1
block|}
block|,
comment|/* Test 2 */
block|{
name|TEST_INPUT
argument_list|(
literal|"abcdefghbcdefghicdefghijdefghijkefghijkl"
literal|"fghijklmghijklmnhijklmnoijklmnopjklmnopq"
literal|"klmnopqrlmnopqrsmnopqrstnopqrstu"
argument_list|)
block|,
literal|"0x09330C33F71147E83D192FC782CD1B4753111B173B3B05"
literal|"D22FA08086E3B0F712FCC7C71A557E2DB966C3E9"
literal|"FA91746039"
block|,
literal|1
block|}
block|,
comment|/* Test 3 */
block|{
name|TEST_INPUT
argument_list|(
literal|"a"
argument_list|)
block|,
literal|"0x9D0E1809716474CB086E834E310A4A1CED149E9C00F248"
literal|"527972CEC5704C2A5B07B8B3DC38ECC4EBAE97DD"
literal|"D87F3D8985"
block|,
literal|1000000
block|}
block|,
comment|/* Test 4 */
block|{
name|TEST_INPUT
argument_list|(
literal|"01234567012345670123456701234567"
argument_list|)
block|,
literal|"0x2FC64A4F500DDB6828F6A3430B8DD72A368EB7F3A8322A"
literal|"70BC84275B9C0B3AB00D27A5CC3C2D224AA6B61A"
literal|"0D79FB4596"
block|,
literal|20
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 5 -- unimplemented optional functionality */
block|{ 			TEST_INPUT(""), 			"0xXXX", 			1 		},
endif|#
directive|endif
comment|/* Test 6 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xb9"
argument_list|)
block|,
literal|"0xBC8089A19007C0B14195F4ECC74094FEC64F01F9092928"
literal|"2C2FB392881578208AD466828B1C6C283D2722CF"
literal|"0AD1AB6938"
block|,
literal|1
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 7 -- unimplemented optional functionality */
block|{ 			TEST_INPUT(""), 			"0xXXX", 			1 		},
endif|#
directive|endif
comment|/* Test 8 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xa4\x1c\x49\x77\x79\xc0\x37\x5f\xf1"
literal|"\x0a\x7f\x4e\x08\x59\x17\x39"
argument_list|)
block|,
literal|"0xC9A68443A005812256B8EC76B00516F0DBB74FAB26D665"
literal|"913F194B6FFB0E91EA9967566B58109CBC675CC2"
literal|"08E4C823F7"
block|,
literal|1
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 9 -- unimplemented optional functionality */
block|{ 			TEST_INPUT(""), 			"0xXXX", 			1 		},
endif|#
directive|endif
comment|/* Test 10 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x39\x96\x69\xe2\x8f\x6b\x9c\x6d\xbc\xbb"
literal|"\x69\x12\xec\x10\xff\xcf\x74\x79\x03\x49"
literal|"\xb7\xdc\x8f\xbe\x4a\x8e\x7b\x3b\x56\x21"
literal|"\xdb\x0f\x3e\x7d\xc8\x7f\x82\x32\x64\xbb"
literal|"\xe4\x0d\x18\x11\xc9\xea\x20\x61\xe1\xc8"
literal|"\x4a\xd1\x0a\x23\xfa\xc1\x72\x7e\x72\x02"
literal|"\xfc\x3f\x50\x42\xe6\xbf\x58\xcb\xa8\xa2"
literal|"\x74\x6e\x1f\x64\xf9\xb9\xea\x35\x2c\x71"
literal|"\x15\x07\x05\x3c\xf4\xe5\x33\x9d\x52\x86"
literal|"\x5f\x25\xcc\x22\xb5\xe8\x77\x84\xa1\x2f"
literal|"\xc9\x61\xd6\x6c\xb6\xe8\x95\x73\x19\x9a"
literal|"\x2c\xe6\x56\x5c\xbd\xf1\x3d\xca\x40\x38"
literal|"\x32\xcf\xcb\x0e\x8b\x72\x11\xe8\x3a\xf3"
literal|"\x2a\x11\xac\x17\x92\x9f\xf1\xc0\x73\xa5"
literal|"\x1c\xc0\x27\xaa\xed\xef\xf8\x5a\xad\x7c"
literal|"\x2b\x7c\x5a\x80\x3e\x24\x04\xd9\x6d\x2a"
literal|"\x77\x35\x7b\xda\x1a\x6d\xae\xed\x17\x15"
literal|"\x1c\xb9\xbc\x51\x25\xa4\x22\xe9\x41\xde"
literal|"\x0c\xa0\xfc\x50\x11\xc2\x3e\xcf\xfe\xfd"
literal|"\xd0\x96\x76\x71\x1c\xf3\xdb\x0a\x34\x40"
literal|"\x72\x0e\x16\x15\xc1\xf2\x2f\xbc\x3c\x72"
literal|"\x1d\xe5\x21\xe1\xb9\x9b\xa1\xbd\x55\x77"
literal|"\x40\x86\x42\x14\x7e\xd0\x96"
argument_list|)
block|,
literal|"0x4F440DB1E6EDD2899FA335F09515AA025EE177A79F4B4A"
literal|"AF38E42B5C4DE660F5DE8FB2A5B2FBD2A3CBFFD2"
literal|"0CFF1288C0"
block|,
literal|1
block|}
block|,
block|{
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
literal|1
block|}
block|}
decl_stmt|;
name|hash_testcase_t
modifier|*
name|testcase
init|=
name|testcases
decl_stmt|;
while|while
condition|(
name|testcase
operator|->
name|input
operator|!=
name|NULL
operator|&&
name|testcase
operator|->
name|result
operator|!=
name|NULL
condition|)
block|{
name|isc_sha384_init
argument_list|(
operator|&
name|sha384
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|testcase
operator|->
name|repeats
condition|;
name|i
operator|++
control|)
block|{
name|isc_sha384_update
argument_list|(
operator|&
name|sha384
argument_list|,
operator|(
specifier|const
name|isc_uint8_t
operator|*
operator|)
name|testcase
operator|->
name|input
argument_list|,
name|testcase
operator|->
name|input_len
argument_list|)
expr_stmt|;
block|}
name|isc_sha384_final
argument_list|(
name|digest
argument_list|,
operator|&
name|sha384
argument_list|)
expr_stmt|;
comment|/* 		*API inconsistency BUG HERE 		* in order to be consistant with the other isc_hash_final 		* functions the call should be 		* isc_sha224_final(&sha224, digest); 		 */
name|tohexstr
argument_list|(
name|digest
argument_list|,
name|ISC_SHA384_DIGESTLENGTH
argument_list|,
name|str
argument_list|)
expr_stmt|;
name|ATF_CHECK_STREQ
argument_list|(
name|str
argument_list|,
name|testcase
operator|->
name|result
argument_list|)
expr_stmt|;
name|testcase
operator|++
expr_stmt|;
block|}
block|}
end_block

begin_expr_stmt
name|ATF_TC
argument_list|(
name|isc_sha512
argument_list|)
expr_stmt|;
end_expr_stmt

begin_macro
name|ATF_TC_HEAD
argument_list|(
argument|isc_sha512
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|atf_tc_set_md_var
argument_list|(
name|tc
argument_list|,
literal|"descr"
argument_list|,
literal|"sha224 examples from RFC4634"
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|ATF_TC_BODY
argument_list|(
argument|isc_sha512
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|isc_sha512_t
name|sha512
decl_stmt|;
name|UNUSED
argument_list|(
name|tc
argument_list|)
expr_stmt|;
comment|/* 	 * These are the various test vectors.  All of these are passed 	 * through the hash function and the results are compared to the 	 * result specified here. 	 */
name|hash_testcase_t
name|testcases
index|[]
init|=
block|{
comment|/* Test 1 */
block|{
name|TEST_INPUT
argument_list|(
literal|"abc"
argument_list|)
block|,
literal|"0xDDAF35A193617ABACC417349AE20413112E6FA4E89A97E"
literal|"A20A9EEEE64B55D39A2192992A274FC1A836BA3C"
literal|"23A3FEEBBD454D4423643CE80E2A9AC94FA54CA49F"
block|,
literal|1
block|}
block|,
comment|/* Test 2 */
block|{
name|TEST_INPUT
argument_list|(
literal|"abcdefghbcdefghicdefghijdefghijkefghijkl"
literal|"fghijklmghijklmnhijklmnoijklmnopjklmnopq"
literal|"klmnopqrlmnopqrsmnopqrstnopqrstu"
argument_list|)
block|,
literal|"0x8E959B75DAE313DA8CF4F72814FC143F8F7779C6EB9F7F"
literal|"A17299AEADB6889018501D289E4900F7E4331B99"
literal|"DEC4B5433AC7D329EEB6DD26545E96E55B874BE909"
block|,
literal|1
block|}
block|,
comment|/* Test 3 */
block|{
name|TEST_INPUT
argument_list|(
literal|"a"
argument_list|)
block|,
literal|"0xE718483D0CE769644E2E42C7BC15B4638E1F98B13B2044"
literal|"285632A803AFA973EBDE0FF244877EA60A4CB043"
literal|"2CE577C31BEB009C5C2C49AA2E4EADB217AD8CC09B"
block|,
literal|1000000
block|}
block|,
comment|/* Test 4 */
block|{
name|TEST_INPUT
argument_list|(
literal|"01234567012345670123456701234567"
argument_list|)
block|,
literal|"0x89D05BA632C699C31231DED4FFC127D5A894DAD412C0E0"
literal|"24DB872D1ABD2BA8141A0F85072A9BE1E2AA04CF"
literal|"33C765CB510813A39CD5A84C4ACAA64D3F3FB7BAE9"
block|,
literal|20
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 5 -- unimplemented optional functionality */
block|{ 			TEST_INPUT(""), 			"0xXXX", 			1 		},
endif|#
directive|endif
comment|/* Test 6 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xD0"
argument_list|)
block|,
literal|"0x9992202938E882E73E20F6B69E68A0A7149090423D93C8"
literal|"1BAB3F21678D4ACEEEE50E4E8CAFADA4C85A54EA"
literal|"8306826C4AD6E74CECE9631BFA8A549B4AB3FBBA15"
block|,
literal|1
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 7 -- unimplemented optional functionality */
block|{ 			TEST_INPUT(""), 			"0xXXX", 			1 		},
endif|#
directive|endif
comment|/* Test 8 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x8d\x4e\x3c\x0e\x38\x89\x19\x14\x91\x81"
literal|"\x6e\x9d\x98\xbf\xf0\xa0"
argument_list|)
block|,
literal|"0xCB0B67A4B8712CD73C9AABC0B199E9269B20844AFB75AC"
literal|"BDD1C153C9828924C3DDEDAAFE669C5FDD0BC66F"
literal|"630F6773988213EB1B16F517AD0DE4B2F0C95C90F8"
block|,
literal|1
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 9 -- unimplemented optional functionality */
block|{ 			TEST_INPUT(""), 			"0xXXX", 			1 		},
endif|#
directive|endif
comment|/* Test 10 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xa5\x5f\x20\xc4\x11\xaa\xd1\x32\x80\x7a"
literal|"\x50\x2d\x65\x82\x4e\x31\xa2\x30\x54\x32"
literal|"\xaa\x3d\x06\xd3\xe2\x82\xa8\xd8\x4e\x0d"
literal|"\xe1\xde\x69\x74\xbf\x49\x54\x69\xfc\x7f"
literal|"\x33\x8f\x80\x54\xd5\x8c\x26\xc4\x93\x60"
literal|"\xc3\xe8\x7a\xf5\x65\x23\xac\xf6\xd8\x9d"
literal|"\x03\xe5\x6f\xf2\xf8\x68\x00\x2b\xc3\xe4"
literal|"\x31\xed\xc4\x4d\xf2\xf0\x22\x3d\x4b\xb3"
literal|"\xb2\x43\x58\x6e\x1a\x7d\x92\x49\x36\x69"
literal|"\x4f\xcb\xba\xf8\x8d\x95\x19\xe4\xeb\x50"
literal|"\xa6\x44\xf8\xe4\xf9\x5e\xb0\xea\x95\xbc"
literal|"\x44\x65\xc8\x82\x1a\xac\xd2\xfe\x15\xab"
literal|"\x49\x81\x16\x4b\xbb\x6d\xc3\x2f\x96\x90"
literal|"\x87\xa1\x45\xb0\xd9\xcc\x9c\x67\xc2\x2b"
literal|"\x76\x32\x99\x41\x9c\xc4\x12\x8b\xe9\xa0"
literal|"\x77\xb3\xac\xe6\x34\x06\x4e\x6d\x99\x28"
literal|"\x35\x13\xdc\x06\xe7\x51\x5d\x0d\x73\x13"
literal|"\x2e\x9a\x0d\xc6\xd3\xb1\xf8\xb2\x46\xf1"
literal|"\xa9\x8a\x3f\xc7\x29\x41\xb1\xe3\xbb\x20"
literal|"\x98\xe8\xbf\x16\xf2\x68\xd6\x4f\x0b\x0f"
literal|"\x47\x07\xfe\x1e\xa1\xa1\x79\x1b\xa2\xf3"
literal|"\xc0\xc7\x58\xe5\xf5\x51\x86\x3a\x96\xc9"
literal|"\x49\xad\x47\xd7\xfb\x40\xd2"
argument_list|)
block|,
literal|"0xC665BEFB36DA189D78822D10528CBF3B12B3EEF7260399"
literal|"09C1A16A270D48719377966B957A878E72058477"
literal|"9A62825C18DA26415E49A7176A894E7510FD1451F5"
block|,
literal|1
block|}
block|,
block|{
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
literal|1
block|}
block|}
decl_stmt|;
name|hash_testcase_t
modifier|*
name|testcase
init|=
name|testcases
decl_stmt|;
while|while
condition|(
name|testcase
operator|->
name|input
operator|!=
name|NULL
operator|&&
name|testcase
operator|->
name|result
operator|!=
name|NULL
condition|)
block|{
name|isc_sha512_init
argument_list|(
operator|&
name|sha512
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|testcase
operator|->
name|repeats
condition|;
name|i
operator|++
control|)
block|{
name|isc_sha512_update
argument_list|(
operator|&
name|sha512
argument_list|,
operator|(
specifier|const
name|isc_uint8_t
operator|*
operator|)
name|testcase
operator|->
name|input
argument_list|,
name|testcase
operator|->
name|input_len
argument_list|)
expr_stmt|;
block|}
name|isc_sha512_final
argument_list|(
name|digest
argument_list|,
operator|&
name|sha512
argument_list|)
expr_stmt|;
comment|/* 		*API inconsistency BUG HERE 		* in order to be consistant with the other isc_hash_final 		* functions the call should be 		* isc_sha224_final(&sha224, digest); 		 */
name|tohexstr
argument_list|(
name|digest
argument_list|,
name|ISC_SHA512_DIGESTLENGTH
argument_list|,
name|str
argument_list|)
expr_stmt|;
name|ATF_CHECK_STREQ
argument_list|(
name|str
argument_list|,
name|testcase
operator|->
name|result
argument_list|)
expr_stmt|;
name|testcase
operator|++
expr_stmt|;
block|}
block|}
end_block

begin_expr_stmt
name|ATF_TC
argument_list|(
name|isc_md5
argument_list|)
expr_stmt|;
end_expr_stmt

begin_macro
name|ATF_TC_HEAD
argument_list|(
argument|isc_md5
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|atf_tc_set_md_var
argument_list|(
name|tc
argument_list|,
literal|"descr"
argument_list|,
literal|"md5 example from RFC1321"
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|ATF_TC_BODY
argument_list|(
argument|isc_md5
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|isc_md5_t
name|md5
decl_stmt|;
name|UNUSED
argument_list|(
name|tc
argument_list|)
expr_stmt|;
comment|/* 	 * These are the various test vectors.  All of these are passed 	 * through the hash function and the results are compared to the 	 * result specified here. 	 */
name|hash_testcase_t
name|testcases
index|[]
init|=
block|{
block|{
name|TEST_INPUT
argument_list|(
literal|""
argument_list|)
block|,
literal|"0xD41D8CD98F00B204E9800998ECF8427E"
block|,
literal|1
block|}
block|,
block|{
name|TEST_INPUT
argument_list|(
literal|"a"
argument_list|)
block|,
literal|"0x0CC175B9C0F1B6A831C399E269772661"
block|,
literal|1
block|}
block|,
block|{
name|TEST_INPUT
argument_list|(
literal|"abc"
argument_list|)
block|,
literal|"0x900150983CD24FB0D6963F7D28E17F72"
block|,
literal|1
block|}
block|,
block|{
name|TEST_INPUT
argument_list|(
literal|"message digest"
argument_list|)
block|,
literal|"0xF96B697D7CB7938D525A2F31AAF161D0"
block|,
literal|1
block|}
block|,
block|{
name|TEST_INPUT
argument_list|(
literal|"abcdefghijklmnopqrstuvwxyz"
argument_list|)
block|,
literal|"0xC3FCD3D76192E4007DFB496CCA67E13B"
block|,
literal|1
block|}
block|,
block|{
name|TEST_INPUT
argument_list|(
literal|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklm"
literal|"nopqrstuvwxyz0123456789"
argument_list|)
block|,
literal|"0xD174AB98D277D9F5A5611C2C9F419D9F"
block|,
literal|1
block|}
block|,
block|{
name|TEST_INPUT
argument_list|(
literal|"123456789012345678901234567890123456789"
literal|"01234567890123456789012345678901234567890"
argument_list|)
block|,
literal|"0x57EDF4A22BE3C955AC49DA2E2107B67A"
block|,
literal|1
block|}
block|,
block|{
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
literal|1
block|}
block|}
decl_stmt|;
name|hash_testcase_t
modifier|*
name|testcase
init|=
name|testcases
decl_stmt|;
while|while
condition|(
name|testcase
operator|->
name|input
operator|!=
name|NULL
operator|&&
name|testcase
operator|->
name|result
operator|!=
name|NULL
condition|)
block|{
name|isc_md5_init
argument_list|(
operator|&
name|md5
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|testcase
operator|->
name|repeats
condition|;
name|i
operator|++
control|)
block|{
name|isc_md5_update
argument_list|(
operator|&
name|md5
argument_list|,
operator|(
specifier|const
name|isc_uint8_t
operator|*
operator|)
name|testcase
operator|->
name|input
argument_list|,
name|testcase
operator|->
name|input_len
argument_list|)
expr_stmt|;
block|}
name|isc_md5_final
argument_list|(
operator|&
name|md5
argument_list|,
name|digest
argument_list|)
expr_stmt|;
name|tohexstr
argument_list|(
name|digest
argument_list|,
name|ISC_MD5_DIGESTLENGTH
argument_list|,
name|str
argument_list|)
expr_stmt|;
name|ATF_CHECK_STREQ
argument_list|(
name|str
argument_list|,
name|testcase
operator|->
name|result
argument_list|)
expr_stmt|;
name|testcase
operator|++
expr_stmt|;
block|}
block|}
end_block

begin_comment
comment|/* HMAC-SHA1 test */
end_comment

begin_expr_stmt
name|ATF_TC
argument_list|(
name|isc_hmacsha1
argument_list|)
expr_stmt|;
end_expr_stmt

begin_macro
name|ATF_TC_HEAD
argument_list|(
argument|isc_hmacsha1
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|atf_tc_set_md_var
argument_list|(
name|tc
argument_list|,
literal|"descr"
argument_list|,
literal|"HMAC-SHA1 examples from RFC2104"
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|ATF_TC_BODY
argument_list|(
argument|isc_hmacsha1
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|isc_hmacsha1_t
name|hmacsha1
decl_stmt|;
name|UNUSED
argument_list|(
name|tc
argument_list|)
expr_stmt|;
comment|/* 	 * These are the various test vectors.  All of these are passed 	 * through the hash function and the results are compared to the 	 * result specified here. 	 */
name|hash_testcase_t
name|testcases
index|[]
init|=
block|{
comment|/* Test 1 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x48\x69\x20\x54\x68\x65\x72\x65"
argument_list|)
block|,
literal|"0xB617318655057264E28BC0B6FB378C8EF146BE00"
block|,
literal|1
block|}
block|,
comment|/* Test 2 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x77\x68\x61\x74\x20\x64\x6f\x20\x79\x61"
literal|"\x20\x77\x61\x6e\x74\x20\x66\x6f\x72\x20"
literal|"\x6e\x6f\x74\x68\x69\x6e\x67\x3f"
argument_list|)
block|,
literal|"0xEFFCDF6AE5EB2FA2D27416D5F184DF9C259A7C79"
block|,
literal|1
block|}
block|,
comment|/* Test 3 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
argument_list|)
block|,
literal|"0x125D7342B9AC11CD91A39AF48AA17B4F63F175D3"
block|,
literal|1
block|}
block|,
comment|/* Test 4 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
argument_list|)
block|,
literal|"0x4C9007F4026250C6BC8414F9BF50C86C2D7235DA"
block|,
literal|1
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 5 -- unimplemented optional functionality */
block|{ 			TEST_INPUT("Test With Truncation"), 			"0x4C1A03424B55E07FE7F27BE1", 			1 		},
endif|#
directive|endif
comment|/* Test 6 */
block|{
name|TEST_INPUT
argument_list|(
literal|"Test Using Larger Than Block-Size Key - "
literal|"Hash Key First"
argument_list|)
block|,
literal|"0xAA4AE5E15272D00E95705637CE8A3B55ED402112"
block|,
literal|1
block|}
block|,
comment|/* Test 7 */
block|{
name|TEST_INPUT
argument_list|(
literal|"Test Using Larger Than Block-Size Key and "
literal|"Larger Than One Block-Size Data"
argument_list|)
block|,
literal|"0xE8E99D0F45237D786D6BBAA7965C7808BBFF1A91"
block|,
literal|1
block|}
block|,
block|{
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
literal|1
block|}
block|}
decl_stmt|;
name|hash_testcase_t
modifier|*
name|testcase
init|=
name|testcases
decl_stmt|;
name|hash_test_key_t
name|test_keys
index|[]
init|=
block|{
comment|/* Key 1 */
block|{
literal|"\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b"
literal|"\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b"
block|,
literal|20
block|}
block|,
comment|/* Key 2 */
block|{
literal|"Jefe"
block|,
literal|4
block|}
block|,
comment|/* Key 3 */
block|{
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
block|,
literal|20
block|}
block|,
comment|/* Key 4 */
block|{
literal|"\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a"
literal|"\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14"
literal|"\x15\x16\x17\x18\x19"
block|,
literal|25
block|}
block|,
if|#
directive|if
literal|0
comment|/* Key 5 */
block|{ "\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c" 		  "\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c", 20 },
endif|#
directive|endif
comment|/* Key 6 */
block|{
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
block|,
literal|80
block|}
block|,
comment|/* Key 7 */
block|{
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
block|,
literal|80
block|}
block|,
block|{
literal|""
block|,
literal|0
block|}
block|}
decl_stmt|;
name|hash_test_key_t
modifier|*
name|test_key
init|=
name|test_keys
decl_stmt|;
while|while
condition|(
name|testcase
operator|->
name|input
operator|!=
name|NULL
operator|&&
name|testcase
operator|->
name|result
operator|!=
name|NULL
condition|)
block|{
name|memcpy
argument_list|(
name|buffer
argument_list|,
name|test_key
operator|->
name|key
argument_list|,
name|test_key
operator|->
name|len
argument_list|)
expr_stmt|;
name|isc_hmacsha1_init
argument_list|(
operator|&
name|hmacsha1
argument_list|,
name|buffer
argument_list|,
name|test_key
operator|->
name|len
argument_list|)
expr_stmt|;
name|isc_hmacsha1_update
argument_list|(
operator|&
name|hmacsha1
argument_list|,
operator|(
specifier|const
name|isc_uint8_t
operator|*
operator|)
name|testcase
operator|->
name|input
argument_list|,
name|testcase
operator|->
name|input_len
argument_list|)
expr_stmt|;
name|isc_hmacsha1_sign
argument_list|(
operator|&
name|hmacsha1
argument_list|,
name|digest
argument_list|,
name|ISC_SHA1_DIGESTLENGTH
argument_list|)
expr_stmt|;
name|tohexstr
argument_list|(
name|digest
argument_list|,
name|ISC_SHA1_DIGESTLENGTH
argument_list|,
name|str
argument_list|)
expr_stmt|;
name|ATF_CHECK_STREQ
argument_list|(
name|str
argument_list|,
name|testcase
operator|->
name|result
argument_list|)
expr_stmt|;
name|testcase
operator|++
expr_stmt|;
name|test_key
operator|++
expr_stmt|;
block|}
block|}
end_block

begin_comment
comment|/* HMAC-SHA224 test */
end_comment

begin_expr_stmt
name|ATF_TC
argument_list|(
name|isc_hmacsha224
argument_list|)
expr_stmt|;
end_expr_stmt

begin_macro
name|ATF_TC_HEAD
argument_list|(
argument|isc_hmacsha224
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|atf_tc_set_md_var
argument_list|(
name|tc
argument_list|,
literal|"descr"
argument_list|,
literal|"HMAC-SHA224 examples from RFC4634"
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|ATF_TC_BODY
argument_list|(
argument|isc_hmacsha224
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|isc_hmacsha224_t
name|hmacsha224
decl_stmt|;
name|UNUSED
argument_list|(
name|tc
argument_list|)
expr_stmt|;
comment|/* 	 * These are the various test vectors.  All of these are passed 	 * through the hash function and the results are compared to the 	 * result specified here. 	 */
name|hash_testcase_t
name|testcases
index|[]
init|=
block|{
comment|/* Test 1 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x48\x69\x20\x54\x68\x65\x72\x65"
argument_list|)
block|,
literal|"0x896FB1128ABBDF196832107CD49DF33F47B4B1169912BA"
literal|"4F53684B22"
block|,
literal|1
block|}
block|,
comment|/* Test 2 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x77\x68\x61\x74\x20\x64\x6f\x20\x79\x61"
literal|"\x20\x77\x61\x6e\x74\x20\x66\x6f\x72\x20"
literal|"\x6e\x6f\x74\x68\x69\x6e\x67\x3f"
argument_list|)
block|,
literal|"0xA30E01098BC6DBBF45690F3A7E9E6D0F8BBEA2A39E61480"
literal|"08FD05E44"
block|,
literal|1
block|}
block|,
comment|/* Test 3 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
argument_list|)
block|,
literal|"0x7FB3CB3588C6C1F6FFA9694D7D6AD2649365B0C1F65D69"
literal|"D1EC8333EA"
block|,
literal|1
block|}
block|,
comment|/* Test 4 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
argument_list|)
block|,
literal|"0x6C11506874013CAC6A2ABC1BB382627CEC6A90D86EFC01"
literal|"2DE7AFEC5A"
block|,
literal|1
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 5 -- unimplemented optional functionality */
block|{ 			TEST_INPUT("Test With Truncation"), 			"0x4C1A03424B55E07FE7F27BE1", 			1 		},
endif|#
directive|endif
comment|/* Test 6 */
block|{
name|TEST_INPUT
argument_list|(
literal|"Test Using Larger Than Block-Size Key - "
literal|"Hash Key First"
argument_list|)
block|,
literal|"0x95E9A0DB962095ADAEBE9B2D6F0DBCE2D499F112F2D2B7"
literal|"273FA6870E"
block|,
literal|1
block|}
block|,
comment|/* Test 7 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x54\x68\x69\x73\x20\x69\x73\x20\x61\x20"
literal|"\x74\x65\x73\x74\x20\x75\x73\x69\x6e\x67"
literal|"\x20\x61\x20\x6c\x61\x72\x67\x65\x72\x20"
literal|"\x74\x68\x61\x6e\x20\x62\x6c\x6f\x63\x6b"
literal|"\x2d\x73\x69\x7a\x65\x20\x6b\x65\x79\x20"
literal|"\x61\x6e\x64\x20\x61\x20\x6c\x61\x72\x67"
literal|"\x65\x72\x20\x74\x68\x61\x6e\x20\x62\x6c"
literal|"\x6f\x63\x6b\x2d\x73\x69\x7a\x65\x20\x64"
literal|"\x61\x74\x61\x2e\x20\x54\x68\x65\x20\x6b"
literal|"\x65\x79\x20\x6e\x65\x65\x64\x73\x20\x74"
literal|"\x6f\x20\x62\x65\x20\x68\x61\x73\x68\x65"
literal|"\x64\x20\x62\x65\x66\x6f\x72\x65\x20\x62"
literal|"\x65\x69\x6e\x67\x20\x75\x73\x65\x64\x20"
literal|"\x62\x79\x20\x74\x68\x65\x20\x48\x4d\x41"
literal|"\x43\x20\x61\x6c\x67\x6f\x72\x69\x74\x68"
literal|"\x6d\x2e"
argument_list|)
block|,
literal|"0x3A854166AC5D9F023F54D517D0B39DBD946770DB9C2B95"
literal|"C9F6F565D1"
block|,
literal|1
block|}
block|,
block|{
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
literal|1
block|}
block|}
decl_stmt|;
name|hash_testcase_t
modifier|*
name|testcase
init|=
name|testcases
decl_stmt|;
name|hash_test_key_t
name|test_keys
index|[]
init|=
block|{
comment|/* Key 1 */
block|{
literal|"\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b"
literal|"\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b"
block|,
literal|20
block|}
block|,
comment|/* Key 2 */
block|{
literal|"Jefe"
block|,
literal|4
block|}
block|,
comment|/* Key 3 */
block|{
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
block|,
literal|20
block|}
block|,
comment|/* Key 4 */
block|{
literal|"\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a"
literal|"\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14"
literal|"\x15\x16\x17\x18\x19"
block|,
literal|25
block|}
block|,
if|#
directive|if
literal|0
comment|/* Key 5 */
block|{ "\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c" 		  "\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c", 20 },
endif|#
directive|endif
comment|/* Key 6 */
block|{
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
block|,
literal|131
block|}
block|,
comment|/* Key 7 */
block|{
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
block|,
literal|131
block|}
block|,
block|{
literal|""
block|,
literal|0
block|}
block|}
decl_stmt|;
name|hash_test_key_t
modifier|*
name|test_key
init|=
name|test_keys
decl_stmt|;
while|while
condition|(
name|testcase
operator|->
name|input
operator|!=
name|NULL
operator|&&
name|testcase
operator|->
name|result
operator|!=
name|NULL
condition|)
block|{
name|memcpy
argument_list|(
name|buffer
argument_list|,
name|test_key
operator|->
name|key
argument_list|,
name|test_key
operator|->
name|len
argument_list|)
expr_stmt|;
name|isc_hmacsha224_init
argument_list|(
operator|&
name|hmacsha224
argument_list|,
name|buffer
argument_list|,
name|test_key
operator|->
name|len
argument_list|)
expr_stmt|;
name|isc_hmacsha224_update
argument_list|(
operator|&
name|hmacsha224
argument_list|,
operator|(
specifier|const
name|isc_uint8_t
operator|*
operator|)
name|testcase
operator|->
name|input
argument_list|,
name|testcase
operator|->
name|input_len
argument_list|)
expr_stmt|;
name|isc_hmacsha224_sign
argument_list|(
operator|&
name|hmacsha224
argument_list|,
name|digest
argument_list|,
name|ISC_SHA224_DIGESTLENGTH
argument_list|)
expr_stmt|;
name|tohexstr
argument_list|(
name|digest
argument_list|,
name|ISC_SHA224_DIGESTLENGTH
argument_list|,
name|str
argument_list|)
expr_stmt|;
name|ATF_CHECK_STREQ
argument_list|(
name|str
argument_list|,
name|testcase
operator|->
name|result
argument_list|)
expr_stmt|;
name|testcase
operator|++
expr_stmt|;
name|test_key
operator|++
expr_stmt|;
block|}
block|}
end_block

begin_comment
comment|/* HMAC-SHA256 test */
end_comment

begin_expr_stmt
name|ATF_TC
argument_list|(
name|isc_hmacsha256
argument_list|)
expr_stmt|;
end_expr_stmt

begin_macro
name|ATF_TC_HEAD
argument_list|(
argument|isc_hmacsha256
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|atf_tc_set_md_var
argument_list|(
name|tc
argument_list|,
literal|"descr"
argument_list|,
literal|"HMAC-SHA256 examples from RFC4634"
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|ATF_TC_BODY
argument_list|(
argument|isc_hmacsha256
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|isc_hmacsha256_t
name|hmacsha256
decl_stmt|;
name|UNUSED
argument_list|(
name|tc
argument_list|)
expr_stmt|;
comment|/* 	 * These are the various test vectors.  All of these are passed 	 * through the hash function and the results are compared to the 	 * result specified here. 	 */
name|hash_testcase_t
name|testcases
index|[]
init|=
block|{
comment|/* Test 1 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x48\x69\x20\x54\x68\x65\x72\x65"
argument_list|)
block|,
literal|"0xB0344C61D8DB38535CA8AFCEAF0BF12B881DC200C9833D"
literal|"A726E9376C2E32CFF7"
block|,
literal|1
block|}
block|,
comment|/* Test 2 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x77\x68\x61\x74\x20\x64\x6f\x20\x79\x61"
literal|"\x20\x77\x61\x6e\x74\x20\x66\x6f\x72\x20"
literal|"\x6e\x6f\x74\x68\x69\x6e\x67\x3f"
argument_list|)
block|,
literal|"0x5BDCC146BF60754E6A042426089575C75A003F089D2739"
literal|"839DEC58B964EC3843"
block|,
literal|1
block|}
block|,
comment|/* Test 3 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
argument_list|)
block|,
literal|"0x773EA91E36800E46854DB8EBD09181A72959098B3EF8C1"
literal|"22D9635514CED565FE"
block|,
literal|1
block|}
block|,
comment|/* Test 4 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
argument_list|)
block|,
literal|"0x82558A389A443C0EA4CC819899F2083A85F0FAA3E578F8"
literal|"077A2E3FF46729665B"
block|,
literal|1
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 5 -- unimplemented optional functionality */
block|{ 			TEST_INPUT("Test With Truncation"), 			"0x4C1A03424B55E07FE7F27BE1", 			1 		},
endif|#
directive|endif
comment|/* Test 6 */
block|{
name|TEST_INPUT
argument_list|(
literal|"Test Using Larger Than Block-Size Key - "
literal|"Hash Key First"
argument_list|)
block|,
literal|"0x60E431591EE0B67F0D8A26AACBF5B77F8E0BC6213728C5"
literal|"140546040F0EE37F54"
block|,
literal|1
block|}
block|,
comment|/* Test 7 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x54\x68\x69\x73\x20\x69\x73\x20\x61\x20"
literal|"\x74\x65\x73\x74\x20\x75\x73\x69\x6e\x67"
literal|"\x20\x61\x20\x6c\x61\x72\x67\x65\x72\x20"
literal|"\x74\x68\x61\x6e\x20\x62\x6c\x6f\x63\x6b"
literal|"\x2d\x73\x69\x7a\x65\x20\x6b\x65\x79\x20"
literal|"\x61\x6e\x64\x20\x61\x20\x6c\x61\x72\x67"
literal|"\x65\x72\x20\x74\x68\x61\x6e\x20\x62\x6c"
literal|"\x6f\x63\x6b\x2d\x73\x69\x7a\x65\x20\x64"
literal|"\x61\x74\x61\x2e\x20\x54\x68\x65\x20\x6b"
literal|"\x65\x79\x20\x6e\x65\x65\x64\x73\x20\x74"
literal|"\x6f\x20\x62\x65\x20\x68\x61\x73\x68\x65"
literal|"\x64\x20\x62\x65\x66\x6f\x72\x65\x20\x62"
literal|"\x65\x69\x6e\x67\x20\x75\x73\x65\x64\x20"
literal|"\x62\x79\x20\x74\x68\x65\x20\x48\x4d\x41"
literal|"\x43\x20\x61\x6c\x67\x6f\x72\x69\x74\x68"
literal|"\x6d\x2e"
argument_list|)
block|,
literal|"0x9B09FFA71B942FCB27635FBCD5B0E944BFDC63644F0713"
literal|"938A7F51535C3A35E2"
block|,
literal|1
block|}
block|,
block|{
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
literal|1
block|}
block|}
decl_stmt|;
name|hash_testcase_t
modifier|*
name|testcase
init|=
name|testcases
decl_stmt|;
name|hash_test_key_t
name|test_keys
index|[]
init|=
block|{
comment|/* Key 1 */
block|{
literal|"\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b"
literal|"\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b"
block|,
literal|20
block|}
block|,
comment|/* Key 2 */
block|{
literal|"Jefe"
block|,
literal|4
block|}
block|,
comment|/* Key 3 */
block|{
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
block|,
literal|20
block|}
block|,
comment|/* Key 4 */
block|{
literal|"\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a"
literal|"\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14"
literal|"\x15\x16\x17\x18\x19"
block|,
literal|25
block|}
block|,
if|#
directive|if
literal|0
comment|/* Key 5 */
block|{ "\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c" 		  "\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c", 20 },
endif|#
directive|endif
comment|/* Key 6 */
block|{
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
block|,
literal|131
block|}
block|,
comment|/* Key 7 */
block|{
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
block|,
literal|131
block|}
block|,
block|{
literal|""
block|,
literal|0
block|}
block|}
decl_stmt|;
name|hash_test_key_t
modifier|*
name|test_key
init|=
name|test_keys
decl_stmt|;
while|while
condition|(
name|testcase
operator|->
name|input
operator|!=
name|NULL
operator|&&
name|testcase
operator|->
name|result
operator|!=
name|NULL
condition|)
block|{
name|memcpy
argument_list|(
name|buffer
argument_list|,
name|test_key
operator|->
name|key
argument_list|,
name|test_key
operator|->
name|len
argument_list|)
expr_stmt|;
name|isc_hmacsha256_init
argument_list|(
operator|&
name|hmacsha256
argument_list|,
name|buffer
argument_list|,
name|test_key
operator|->
name|len
argument_list|)
expr_stmt|;
name|isc_hmacsha256_update
argument_list|(
operator|&
name|hmacsha256
argument_list|,
operator|(
specifier|const
name|isc_uint8_t
operator|*
operator|)
name|testcase
operator|->
name|input
argument_list|,
name|testcase
operator|->
name|input_len
argument_list|)
expr_stmt|;
name|isc_hmacsha256_sign
argument_list|(
operator|&
name|hmacsha256
argument_list|,
name|digest
argument_list|,
name|ISC_SHA256_DIGESTLENGTH
argument_list|)
expr_stmt|;
name|tohexstr
argument_list|(
name|digest
argument_list|,
name|ISC_SHA256_DIGESTLENGTH
argument_list|,
name|str
argument_list|)
expr_stmt|;
name|ATF_CHECK_STREQ
argument_list|(
name|str
argument_list|,
name|testcase
operator|->
name|result
argument_list|)
expr_stmt|;
name|testcase
operator|++
expr_stmt|;
name|test_key
operator|++
expr_stmt|;
block|}
block|}
end_block

begin_comment
comment|/* HMAC-SHA384 test */
end_comment

begin_expr_stmt
name|ATF_TC
argument_list|(
name|isc_hmacsha384
argument_list|)
expr_stmt|;
end_expr_stmt

begin_macro
name|ATF_TC_HEAD
argument_list|(
argument|isc_hmacsha384
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|atf_tc_set_md_var
argument_list|(
name|tc
argument_list|,
literal|"descr"
argument_list|,
literal|"HMAC-SHA384 examples from RFC4634"
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|ATF_TC_BODY
argument_list|(
argument|isc_hmacsha384
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|isc_hmacsha384_t
name|hmacsha384
decl_stmt|;
name|UNUSED
argument_list|(
name|tc
argument_list|)
expr_stmt|;
comment|/* 	 * These are the various test vectors.  All of these are passed 	 * through the hash function and the results are compared to the 	 * result specified here. 	 */
name|hash_testcase_t
name|testcases
index|[]
init|=
block|{
comment|/* Test 1 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x48\x69\x20\x54\x68\x65\x72\x65"
argument_list|)
block|,
literal|"0xAFD03944D84895626B0825F4AB46907F15F9DADBE4101E"
literal|"C682AA034C7CEBC59CFAEA9EA9076EDE7F4AF152"
literal|"E8B2FA9CB6"
block|,
literal|1
block|}
block|,
comment|/* Test 2 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x77\x68\x61\x74\x20\x64\x6f\x20\x79\x61"
literal|"\x20\x77\x61\x6e\x74\x20\x66\x6f\x72\x20"
literal|"\x6e\x6f\x74\x68\x69\x6e\x67\x3f"
argument_list|)
block|,
literal|"0xAF45D2E376484031617F78D2B58A6B1B9C7EF464F5A01B"
literal|"47E42EC3736322445E8E2240CA5E69E2C78B3239"
literal|"ECFAB21649"
block|,
literal|1
block|}
block|,
comment|/* Test 3 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
argument_list|)
block|,
literal|"0x88062608D3E6AD8A0AA2ACE014C8A86F0AA635D947AC9F"
literal|"EBE83EF4E55966144B2A5AB39DC13814B94E3AB6"
literal|"E101A34F27"
block|,
literal|1
block|}
block|,
comment|/* Test 4 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
argument_list|)
block|,
literal|"0x3E8A69B7783C25851933AB6290AF6CA77A998148085000"
literal|"9CC5577C6E1F573B4E6801DD23C4A7D679CCF8A3"
literal|"86C674CFFB"
block|,
literal|1
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 5 -- unimplemented optional functionality */
block|{ 			TEST_INPUT("Test With Truncation"), 			"0x4C1A03424B55E07FE7F27BE1", 			1 		},
endif|#
directive|endif
comment|/* Test 6 */
block|{
name|TEST_INPUT
argument_list|(
literal|"Test Using Larger Than Block-Size Key - "
literal|"Hash Key First"
argument_list|)
block|,
literal|"0x4ECE084485813E9088D2C63A041BC5B44F9EF1012A2B58"
literal|"8F3CD11F05033AC4C60C2EF6AB4030FE8296248D"
literal|"F163F44952"
block|,
literal|1
block|}
block|,
comment|/* Test 7 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x54\x68\x69\x73\x20\x69\x73\x20\x61\x20"
literal|"\x74\x65\x73\x74\x20\x75\x73\x69\x6e\x67"
literal|"\x20\x61\x20\x6c\x61\x72\x67\x65\x72\x20"
literal|"\x74\x68\x61\x6e\x20\x62\x6c\x6f\x63\x6b"
literal|"\x2d\x73\x69\x7a\x65\x20\x6b\x65\x79\x20"
literal|"\x61\x6e\x64\x20\x61\x20\x6c\x61\x72\x67"
literal|"\x65\x72\x20\x74\x68\x61\x6e\x20\x62\x6c"
literal|"\x6f\x63\x6b\x2d\x73\x69\x7a\x65\x20\x64"
literal|"\x61\x74\x61\x2e\x20\x54\x68\x65\x20\x6b"
literal|"\x65\x79\x20\x6e\x65\x65\x64\x73\x20\x74"
literal|"\x6f\x20\x62\x65\x20\x68\x61\x73\x68\x65"
literal|"\x64\x20\x62\x65\x66\x6f\x72\x65\x20\x62"
literal|"\x65\x69\x6e\x67\x20\x75\x73\x65\x64\x20"
literal|"\x62\x79\x20\x74\x68\x65\x20\x48\x4d\x41"
literal|"\x43\x20\x61\x6c\x67\x6f\x72\x69\x74\x68"
literal|"\x6d\x2e"
argument_list|)
block|,
literal|"0x6617178E941F020D351E2F254E8FD32C602420FEB0B8FB"
literal|"9ADCCEBB82461E99C5A678CC31E799176D3860E6"
literal|"110C46523E"
block|,
literal|1
block|}
block|,
block|{
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
literal|1
block|}
block|}
decl_stmt|;
name|hash_testcase_t
modifier|*
name|testcase
init|=
name|testcases
decl_stmt|;
name|hash_test_key_t
name|test_keys
index|[]
init|=
block|{
comment|/* Key 1 */
block|{
literal|"\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b"
literal|"\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b"
block|,
literal|20
block|}
block|,
comment|/* Key 2 */
block|{
literal|"Jefe"
block|,
literal|4
block|}
block|,
comment|/* Key 3 */
block|{
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
block|,
literal|20
block|}
block|,
comment|/* Key 4 */
block|{
literal|"\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a"
literal|"\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14"
literal|"\x15\x16\x17\x18\x19"
block|,
literal|25
block|}
block|,
if|#
directive|if
literal|0
comment|/* Key 5 */
block|{ "\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c" 		  "\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c", 20 },
endif|#
directive|endif
comment|/* Key 6 */
block|{
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
block|,
literal|131
block|}
block|,
comment|/* Key 7 */
block|{
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
block|,
literal|131
block|}
block|,
block|{
literal|""
block|,
literal|0
block|}
block|}
decl_stmt|;
name|hash_test_key_t
modifier|*
name|test_key
init|=
name|test_keys
decl_stmt|;
while|while
condition|(
name|testcase
operator|->
name|input
operator|!=
name|NULL
operator|&&
name|testcase
operator|->
name|result
operator|!=
name|NULL
condition|)
block|{
name|memcpy
argument_list|(
name|buffer
argument_list|,
name|test_key
operator|->
name|key
argument_list|,
name|test_key
operator|->
name|len
argument_list|)
expr_stmt|;
name|isc_hmacsha384_init
argument_list|(
operator|&
name|hmacsha384
argument_list|,
name|buffer
argument_list|,
name|test_key
operator|->
name|len
argument_list|)
expr_stmt|;
name|isc_hmacsha384_update
argument_list|(
operator|&
name|hmacsha384
argument_list|,
operator|(
specifier|const
name|isc_uint8_t
operator|*
operator|)
name|testcase
operator|->
name|input
argument_list|,
name|testcase
operator|->
name|input_len
argument_list|)
expr_stmt|;
name|isc_hmacsha384_sign
argument_list|(
operator|&
name|hmacsha384
argument_list|,
name|digest
argument_list|,
name|ISC_SHA384_DIGESTLENGTH
argument_list|)
expr_stmt|;
name|tohexstr
argument_list|(
name|digest
argument_list|,
name|ISC_SHA384_DIGESTLENGTH
argument_list|,
name|str
argument_list|)
expr_stmt|;
name|ATF_CHECK_STREQ
argument_list|(
name|str
argument_list|,
name|testcase
operator|->
name|result
argument_list|)
expr_stmt|;
name|testcase
operator|++
expr_stmt|;
name|test_key
operator|++
expr_stmt|;
block|}
block|}
end_block

begin_comment
comment|/* HMAC-SHA512 test */
end_comment

begin_expr_stmt
name|ATF_TC
argument_list|(
name|isc_hmacsha512
argument_list|)
expr_stmt|;
end_expr_stmt

begin_macro
name|ATF_TC_HEAD
argument_list|(
argument|isc_hmacsha512
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|atf_tc_set_md_var
argument_list|(
name|tc
argument_list|,
literal|"descr"
argument_list|,
literal|"HMAC-SHA512 examples from RFC4634"
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|ATF_TC_BODY
argument_list|(
argument|isc_hmacsha512
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|isc_hmacsha512_t
name|hmacsha512
decl_stmt|;
name|UNUSED
argument_list|(
name|tc
argument_list|)
expr_stmt|;
comment|/* 	 * These are the various test vectors.  All of these are passed 	 * through the hash function and the results are compared to the 	 * result specified here. 	 */
name|hash_testcase_t
name|testcases
index|[]
init|=
block|{
comment|/* Test 1 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x48\x69\x20\x54\x68\x65\x72\x65"
argument_list|)
block|,
literal|"0x87AA7CDEA5EF619D4FF0B4241A1D6CB02379F4E2CE4EC2"
literal|"787AD0B30545E17CDEDAA833B7D6B8A702038B27"
literal|"4EAEA3F4E4BE9D914EEB61F1702E696C203A126854"
block|,
literal|1
block|}
block|,
comment|/* Test 2 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x77\x68\x61\x74\x20\x64\x6f\x20\x79\x61"
literal|"\x20\x77\x61\x6e\x74\x20\x66\x6f\x72\x20"
literal|"\x6e\x6f\x74\x68\x69\x6e\x67\x3f"
argument_list|)
block|,
literal|"0x164B7A7BFCF819E2E395FBE73B56E0A387BD64222E831F"
literal|"D610270CD7EA2505549758BF75C05A994A6D034F"
literal|"65F8F0E6FDCAEAB1A34D4A6B4B636E070A38BCE737"
block|,
literal|1
block|}
block|,
comment|/* Test 3 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
argument_list|)
block|,
literal|"0xFA73B0089D56A284EFB0F0756C890BE9B1B5DBDD8EE81A"
literal|"3655F83E33B2279D39BF3E848279A722C806B485"
literal|"A47E67C807B946A337BEE8942674278859E13292FB"
block|,
literal|1
block|}
block|,
comment|/* Test 4 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
argument_list|)
block|,
literal|"0xB0BA465637458C6990E5A8C5F61D4AF7E576D97FF94B87"
literal|"2DE76F8050361EE3DBA91CA5C11AA25EB4D67927"
literal|"5CC5788063A5F19741120C4F2DE2ADEBEB10A298DD"
block|,
literal|1
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 5 -- unimplemented optional functionality */
block|{ 			TEST_INPUT("Test With Truncation"), 			"0x4C1A03424B55E07FE7F27BE1", 			1 		},
endif|#
directive|endif
comment|/* Test 6 */
block|{
name|TEST_INPUT
argument_list|(
literal|"Test Using Larger Than Block-Size Key - "
literal|"Hash Key First"
argument_list|)
block|,
literal|"0x80B24263C7C1A3EBB71493C1DD7BE8B49B46D1F41B4AEE"
literal|"C1121B013783F8F3526B56D037E05F2598BD0FD2"
literal|"215D6A1E5295E64F73F63F0AEC8B915A985D786598"
block|,
literal|1
block|}
block|,
comment|/* Test 7 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x54\x68\x69\x73\x20\x69\x73\x20\x61\x20"
literal|"\x74\x65\x73\x74\x20\x75\x73\x69\x6e\x67"
literal|"\x20\x61\x20\x6c\x61\x72\x67\x65\x72\x20"
literal|"\x74\x68\x61\x6e\x20\x62\x6c\x6f\x63\x6b"
literal|"\x2d\x73\x69\x7a\x65\x20\x6b\x65\x79\x20"
literal|"\x61\x6e\x64\x20\x61\x20\x6c\x61\x72\x67"
literal|"\x65\x72\x20\x74\x68\x61\x6e\x20\x62\x6c"
literal|"\x6f\x63\x6b\x2d\x73\x69\x7a\x65\x20\x64"
literal|"\x61\x74\x61\x2e\x20\x54\x68\x65\x20\x6b"
literal|"\x65\x79\x20\x6e\x65\x65\x64\x73\x20\x74"
literal|"\x6f\x20\x62\x65\x20\x68\x61\x73\x68\x65"
literal|"\x64\x20\x62\x65\x66\x6f\x72\x65\x20\x62"
literal|"\x65\x69\x6e\x67\x20\x75\x73\x65\x64\x20"
literal|"\x62\x79\x20\x74\x68\x65\x20\x48\x4d\x41"
literal|"\x43\x20\x61\x6c\x67\x6f\x72\x69\x74\x68"
literal|"\x6d\x2e"
argument_list|)
block|,
literal|"0xE37B6A775DC87DBAA4DFA9F96E5E3FFDDEBD71F8867289"
literal|"865DF5A32D20CDC944B6022CAC3C4982B10D5EEB"
literal|"55C3E4DE15134676FB6DE0446065C97440FA8C6A58"
block|,
literal|1
block|}
block|,
block|{
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
literal|1
block|}
block|}
decl_stmt|;
name|hash_testcase_t
modifier|*
name|testcase
init|=
name|testcases
decl_stmt|;
name|hash_test_key_t
name|test_keys
index|[]
init|=
block|{
comment|/* Key 1 */
block|{
literal|"\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b"
literal|"\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b"
block|,
literal|20
block|}
block|,
comment|/* Key 2 */
block|{
literal|"Jefe"
block|,
literal|4
block|}
block|,
comment|/* Key 3 */
block|{
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
block|,
literal|20
block|}
block|,
comment|/* Key 4 */
block|{
literal|"\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a"
literal|"\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14"
literal|"\x15\x16\x17\x18\x19"
block|,
literal|25
block|}
block|,
if|#
directive|if
literal|0
comment|/* Key 5 */
block|{ "\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c" 		  "\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c", 20 },
endif|#
directive|endif
comment|/* Key 6 */
block|{
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
block|,
literal|131
block|}
block|,
comment|/* Key 7 */
block|{
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
block|,
literal|131
block|}
block|,
block|{
literal|""
block|,
literal|0
block|}
block|}
decl_stmt|;
name|hash_test_key_t
modifier|*
name|test_key
init|=
name|test_keys
decl_stmt|;
while|while
condition|(
name|testcase
operator|->
name|input
operator|!=
name|NULL
operator|&&
name|testcase
operator|->
name|result
operator|!=
name|NULL
condition|)
block|{
name|memcpy
argument_list|(
name|buffer
argument_list|,
name|test_key
operator|->
name|key
argument_list|,
name|test_key
operator|->
name|len
argument_list|)
expr_stmt|;
name|isc_hmacsha512_init
argument_list|(
operator|&
name|hmacsha512
argument_list|,
name|buffer
argument_list|,
name|test_key
operator|->
name|len
argument_list|)
expr_stmt|;
name|isc_hmacsha512_update
argument_list|(
operator|&
name|hmacsha512
argument_list|,
operator|(
specifier|const
name|isc_uint8_t
operator|*
operator|)
name|testcase
operator|->
name|input
argument_list|,
name|testcase
operator|->
name|input_len
argument_list|)
expr_stmt|;
name|isc_hmacsha512_sign
argument_list|(
operator|&
name|hmacsha512
argument_list|,
name|digest
argument_list|,
name|ISC_SHA512_DIGESTLENGTH
argument_list|)
expr_stmt|;
name|tohexstr
argument_list|(
name|digest
argument_list|,
name|ISC_SHA512_DIGESTLENGTH
argument_list|,
name|str
argument_list|)
expr_stmt|;
name|ATF_CHECK_STREQ
argument_list|(
name|str
argument_list|,
name|testcase
operator|->
name|result
argument_list|)
expr_stmt|;
name|testcase
operator|++
expr_stmt|;
name|test_key
operator|++
expr_stmt|;
block|}
block|}
end_block

begin_comment
comment|/* HMAC-MD5 Test */
end_comment

begin_expr_stmt
name|ATF_TC
argument_list|(
name|isc_hmacmd5
argument_list|)
expr_stmt|;
end_expr_stmt

begin_macro
name|ATF_TC_HEAD
argument_list|(
argument|isc_hmacmd5
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|atf_tc_set_md_var
argument_list|(
name|tc
argument_list|,
literal|"descr"
argument_list|,
literal|"HMAC-MD5 examples from RFC2104"
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|ATF_TC_BODY
argument_list|(
argument|isc_hmacmd5
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|isc_hmacmd5_t
name|hmacmd5
decl_stmt|;
name|UNUSED
argument_list|(
name|tc
argument_list|)
expr_stmt|;
comment|/* 	 * These are the various test vectors.  All of these are passed 	 * through the hash function and the results are compared to the 	 * result specified here. 	 */
name|hash_testcase_t
name|testcases
index|[]
init|=
block|{
comment|/* Test 1 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x48\x69\x20\x54\x68\x65\x72\x65"
argument_list|)
block|,
literal|"0x9294727A3638BB1C13F48EF8158BFC9D"
block|,
literal|1
block|}
block|,
comment|/* Test 2 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\x77\x68\x61\x74\x20\x64\x6f\x20\x79"
literal|"\x61\x20\x77\x61\x6e\x74\x20\x66\x6f"
literal|"\x72\x20\x6e\x6f\x74\x68\x69\x6e\x67\x3f"
argument_list|)
block|,
literal|"0x750C783E6AB0B503EAA86E310A5DB738"
block|,
literal|1
block|}
block|,
comment|/* Test 3 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
literal|"\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD\xDD"
argument_list|)
block|,
literal|"0x56BE34521D144C88DBB8C733F0E8B3F6"
block|,
literal|1
block|}
block|,
comment|/* Test 4 */
block|{
name|TEST_INPUT
argument_list|(
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
literal|"\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd\xcd"
argument_list|)
block|,
literal|"0x697EAF0ACA3A3AEA3A75164746FFAA79"
block|,
literal|1
block|}
block|,
if|#
directive|if
literal|0
comment|/* Test 5 -- unimplemented optional functionality */
block|{ 			TEST_INPUT("Test With Truncation"), 			"0x4C1A03424B55E07FE7F27BE1", 			1 		},
comment|/* Test 6 -- unimplemented optional functionality */
block|{ 			TEST_INPUT("Test Using Larger Than Block-Size Key - " 				   "Hash Key First"), 			"0xAA4AE5E15272D00E95705637CE8A3B55ED402112", 			1 		 },
comment|/* Test 7 -- unimplemented optional functionality */
block|{ 			TEST_INPUT("Test Using Larger Than Block-Size Key and " 				   "Larger Than One Block-Size Data"), 			"0xE8E99D0F45237D786D6BBAA7965C7808BBFF1A91", 			1 		},
endif|#
directive|endif
block|{
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
literal|1
block|}
block|}
decl_stmt|;
name|hash_testcase_t
modifier|*
name|testcase
init|=
name|testcases
decl_stmt|;
name|hash_test_key_t
name|test_keys
index|[]
init|=
block|{
comment|/* Key 1 */
block|{
literal|"\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b"
literal|"\x0b\x0b\x0b\x0b\x0b\x0b"
block|,
literal|16
block|}
block|,
comment|/* Key 2 */
block|{
literal|"Jefe"
block|,
literal|4
block|}
block|,
comment|/* Key 3 */
block|{
literal|"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
literal|"\xaa\xaa\xaa\xaa\xaa\xaa"
block|,
literal|16
block|}
block|,
comment|/* Key 4 */
block|{
literal|"\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a"
literal|"\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14"
literal|"\x15\x16\x17\x18\x19"
block|,
literal|25
block|}
block|,
if|#
directive|if
literal|0
comment|/* Key 5 */
block|{ "\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c" 		  "\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c", 20 },
comment|/* Key 6 */
block|{ "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa", 131 },
comment|/* Key 7 */
block|{ "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa" 		  "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa", 131 },
endif|#
directive|endif
block|{
literal|""
block|,
literal|0
block|}
block|}
decl_stmt|;
name|hash_test_key_t
modifier|*
name|test_key
init|=
name|test_keys
decl_stmt|;
while|while
condition|(
name|testcase
operator|->
name|input
operator|!=
name|NULL
operator|&&
name|testcase
operator|->
name|result
operator|!=
name|NULL
condition|)
block|{
name|memcpy
argument_list|(
name|buffer
argument_list|,
name|test_key
operator|->
name|key
argument_list|,
name|test_key
operator|->
name|len
argument_list|)
expr_stmt|;
name|isc_hmacmd5_init
argument_list|(
operator|&
name|hmacmd5
argument_list|,
name|buffer
argument_list|,
name|test_key
operator|->
name|len
argument_list|)
expr_stmt|;
name|isc_hmacmd5_update
argument_list|(
operator|&
name|hmacmd5
argument_list|,
operator|(
specifier|const
name|isc_uint8_t
operator|*
operator|)
name|testcase
operator|->
name|input
argument_list|,
name|testcase
operator|->
name|input_len
argument_list|)
expr_stmt|;
name|isc_hmacmd5_sign
argument_list|(
operator|&
name|hmacmd5
argument_list|,
name|digest
argument_list|)
expr_stmt|;
name|tohexstr
argument_list|(
name|digest
argument_list|,
name|ISC_MD5_DIGESTLENGTH
argument_list|,
name|str
argument_list|)
expr_stmt|;
name|ATF_CHECK_STREQ
argument_list|(
name|str
argument_list|,
name|testcase
operator|->
name|result
argument_list|)
expr_stmt|;
name|testcase
operator|++
expr_stmt|;
name|test_key
operator|++
expr_stmt|;
block|}
block|}
end_block

begin_comment
comment|/*  * Main  */
end_comment

begin_macro
name|ATF_TP_ADD_TCS
argument_list|(
argument|tp
argument_list|)
end_macro

begin_block
block|{
name|ATF_TP_ADD_TC
argument_list|(
name|tp
argument_list|,
name|isc_hmacmd5
argument_list|)
expr_stmt|;
name|ATF_TP_ADD_TC
argument_list|(
name|tp
argument_list|,
name|isc_hmacsha1
argument_list|)
expr_stmt|;
name|ATF_TP_ADD_TC
argument_list|(
name|tp
argument_list|,
name|isc_hmacsha224
argument_list|)
expr_stmt|;
name|ATF_TP_ADD_TC
argument_list|(
name|tp
argument_list|,
name|isc_hmacsha256
argument_list|)
expr_stmt|;
name|ATF_TP_ADD_TC
argument_list|(
name|tp
argument_list|,
name|isc_hmacsha384
argument_list|)
expr_stmt|;
name|ATF_TP_ADD_TC
argument_list|(
name|tp
argument_list|,
name|isc_hmacsha512
argument_list|)
expr_stmt|;
name|ATF_TP_ADD_TC
argument_list|(
name|tp
argument_list|,
name|isc_md5
argument_list|)
expr_stmt|;
name|ATF_TP_ADD_TC
argument_list|(
name|tp
argument_list|,
name|isc_sha1
argument_list|)
expr_stmt|;
name|ATF_TP_ADD_TC
argument_list|(
name|tp
argument_list|,
name|isc_sha224
argument_list|)
expr_stmt|;
name|ATF_TP_ADD_TC
argument_list|(
name|tp
argument_list|,
name|isc_sha256
argument_list|)
expr_stmt|;
name|ATF_TP_ADD_TC
argument_list|(
name|tp
argument_list|,
name|isc_sha384
argument_list|)
expr_stmt|;
name|ATF_TP_ADD_TC
argument_list|(
name|tp
argument_list|,
name|isc_sha512
argument_list|)
expr_stmt|;
return|return
operator|(
name|atf_no_error
argument_list|()
operator|)
return|;
block|}
end_block

end_unit

