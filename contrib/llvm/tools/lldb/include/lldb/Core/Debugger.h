begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|//===-- Debugger.h ----------------------------------------------*- C++ -*-===//
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|//                     The LLVM Compiler Infrastructure
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// This file is distributed under the University of Illinois Open Source
end_comment

begin_comment
comment|// License. See LICENSE.TXT for details.
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|//===----------------------------------------------------------------------===//
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|liblldb_Debugger_h_
end_ifndef

begin_define
define|#
directive|define
name|liblldb_Debugger_h_
end_define

begin_comment
comment|// C Includes
end_comment

begin_include
include|#
directive|include
file|<stdint.h>
end_include

begin_comment
comment|// C++ Includes
end_comment

begin_include
include|#
directive|include
file|<memory>
end_include

begin_include
include|#
directive|include
file|<map>
end_include

begin_include
include|#
directive|include
file|<vector>
end_include

begin_comment
comment|// Other libraries and framework includes
end_comment

begin_comment
comment|// Project includes
end_comment

begin_include
include|#
directive|include
file|"lldb/lldb-public.h"
end_include

begin_include
include|#
directive|include
file|"lldb/Core/Broadcaster.h"
end_include

begin_include
include|#
directive|include
file|"lldb/Core/FormatEntity.h"
end_include

begin_include
include|#
directive|include
file|"lldb/Core/IOHandler.h"
end_include

begin_include
include|#
directive|include
file|"lldb/Core/Listener.h"
end_include

begin_include
include|#
directive|include
file|"lldb/Core/SourceManager.h"
end_include

begin_include
include|#
directive|include
file|"lldb/Core/UserID.h"
end_include

begin_include
include|#
directive|include
file|"lldb/Core/UserSettingsController.h"
end_include

begin_include
include|#
directive|include
file|"lldb/Host/HostThread.h"
end_include

begin_include
include|#
directive|include
file|"lldb/Host/Terminal.h"
end_include

begin_include
include|#
directive|include
file|"lldb/Target/Platform.h"
end_include

begin_include
include|#
directive|include
file|"lldb/Target/TargetList.h"
end_include

begin_decl_stmt
name|namespace
name|llvm
block|{
name|namespace
name|sys
block|{
name|class
name|DynamicLibrary
decl_stmt|;
block|}
comment|// namespace sys
block|}
end_decl_stmt

begin_comment
comment|// namespace llvm
end_comment

begin_decl_stmt
name|namespace
name|lldb_private
block|{
comment|//----------------------------------------------------------------------
comment|/// @class Debugger Debugger.h "lldb/Core/Debugger.h"
comment|/// @brief A class to manage flag bits.
comment|///
comment|/// Provides a global root objects for the debugger core.
comment|//----------------------------------------------------------------------
name|class
name|Debugger
range|:
name|public
name|std
operator|::
name|enable_shared_from_this
operator|<
name|Debugger
operator|>
decl_stmt|,
name|public
name|UserID
decl_stmt|,
name|public
name|Properties
decl_stmt|,
name|public
name|BroadcasterManager
block|{
name|friend
name|class
name|SourceManager
decl_stmt|;
comment|// For GetSourceFileCache.
name|public
label|:
operator|~
name|Debugger
argument_list|()
name|override
expr_stmt|;
specifier|static
name|lldb
operator|::
name|DebuggerSP
name|CreateInstance
argument_list|(
argument|lldb::LogOutputCallback log_callback = nullptr
argument_list|,
argument|void *baton = nullptr
argument_list|)
expr_stmt|;
specifier|static
name|lldb
operator|::
name|TargetSP
name|FindTargetWithProcessID
argument_list|(
argument|lldb::pid_t pid
argument_list|)
expr_stmt|;
specifier|static
name|lldb
operator|::
name|TargetSP
name|FindTargetWithProcess
argument_list|(
name|Process
operator|*
name|process
argument_list|)
expr_stmt|;
specifier|static
name|void
name|Initialize
parameter_list|(
name|LoadPluginCallbackType
name|load_plugin_callback
parameter_list|)
function_decl|;
specifier|static
name|void
name|Terminate
parameter_list|()
function_decl|;
specifier|static
name|void
name|SettingsInitialize
parameter_list|()
function_decl|;
specifier|static
name|void
name|SettingsTerminate
parameter_list|()
function_decl|;
specifier|static
name|void
name|Destroy
argument_list|(
name|lldb
operator|::
name|DebuggerSP
operator|&
name|debugger_sp
argument_list|)
decl_stmt|;
specifier|static
name|lldb
operator|::
name|DebuggerSP
name|FindDebuggerWithID
argument_list|(
argument|lldb::user_id_t id
argument_list|)
expr_stmt|;
specifier|static
name|lldb
operator|::
name|DebuggerSP
name|FindDebuggerWithInstanceName
argument_list|(
specifier|const
name|ConstString
operator|&
name|instance_name
argument_list|)
expr_stmt|;
specifier|static
name|size_t
name|GetNumDebuggers
parameter_list|()
function_decl|;
specifier|static
name|lldb
operator|::
name|DebuggerSP
name|GetDebuggerAtIndex
argument_list|(
argument|size_t index
argument_list|)
expr_stmt|;
specifier|static
name|bool
name|FormatDisassemblerAddress
argument_list|(
specifier|const
name|FormatEntity
operator|::
name|Entry
operator|*
name|format
argument_list|,
specifier|const
name|SymbolContext
operator|*
name|sc
argument_list|,
specifier|const
name|SymbolContext
operator|*
name|prev_sc
argument_list|,
specifier|const
name|ExecutionContext
operator|*
name|exe_ctx
argument_list|,
specifier|const
name|Address
operator|*
name|addr
argument_list|,
name|Stream
operator|&
name|s
argument_list|)
decl_stmt|;
name|void
name|Clear
parameter_list|()
function_decl|;
name|bool
name|GetAsyncExecution
parameter_list|()
function_decl|;
name|void
name|SetAsyncExecution
parameter_list|(
name|bool
name|async
parameter_list|)
function_decl|;
name|lldb
operator|::
name|StreamFileSP
name|GetInputFile
argument_list|()
block|{
return|return
name|m_input_file_sp
return|;
block|}
name|lldb
operator|::
name|StreamFileSP
name|GetOutputFile
argument_list|()
block|{
return|return
name|m_output_file_sp
return|;
block|}
name|lldb
operator|::
name|StreamFileSP
name|GetErrorFile
argument_list|()
block|{
return|return
name|m_error_file_sp
return|;
block|}
name|void
name|SetInputFileHandle
parameter_list|(
name|FILE
modifier|*
name|fh
parameter_list|,
name|bool
name|tranfer_ownership
parameter_list|)
function_decl|;
name|void
name|SetOutputFileHandle
parameter_list|(
name|FILE
modifier|*
name|fh
parameter_list|,
name|bool
name|tranfer_ownership
parameter_list|)
function_decl|;
name|void
name|SetErrorFileHandle
parameter_list|(
name|FILE
modifier|*
name|fh
parameter_list|,
name|bool
name|tranfer_ownership
parameter_list|)
function_decl|;
name|void
name|SaveInputTerminalState
parameter_list|()
function_decl|;
name|void
name|RestoreInputTerminalState
parameter_list|()
function_decl|;
name|lldb
operator|::
name|StreamSP
name|GetAsyncOutputStream
argument_list|()
expr_stmt|;
name|lldb
operator|::
name|StreamSP
name|GetAsyncErrorStream
argument_list|()
expr_stmt|;
name|CommandInterpreter
modifier|&
name|GetCommandInterpreter
parameter_list|()
block|{
name|assert
argument_list|(
name|m_command_interpreter_ap
operator|.
name|get
argument_list|()
argument_list|)
expr_stmt|;
return|return
operator|*
name|m_command_interpreter_ap
return|;
block|}
name|Listener
modifier|&
name|GetListener
parameter_list|()
block|{
return|return
name|m_listener
return|;
block|}
comment|// This returns the Debugger's scratch source manager.  It won't be able to look up files in debug
comment|// information, but it can look up files by absolute path and display them to you.
comment|// To get the target's source manager, call GetSourceManager on the target instead.
name|SourceManager
modifier|&
name|GetSourceManager
parameter_list|()
function_decl|;
name|lldb
operator|::
name|TargetSP
name|GetSelectedTarget
argument_list|()
block|{
return|return
name|m_target_list
operator|.
name|GetSelectedTarget
argument_list|()
return|;
block|}
name|ExecutionContext
name|GetSelectedExecutionContext
parameter_list|()
function_decl|;
comment|//------------------------------------------------------------------
comment|/// Get accessor for the target list.
comment|///
comment|/// The target list is part of the global debugger object. This
comment|/// the single debugger shared instance to control where targets
comment|/// get created and to allow for tracking and searching for targets
comment|/// based on certain criteria.
comment|///
comment|/// @return
comment|///     A global shared target list.
comment|//------------------------------------------------------------------
name|TargetList
modifier|&
name|GetTargetList
parameter_list|()
block|{
return|return
name|m_target_list
return|;
block|}
name|PlatformList
modifier|&
name|GetPlatformList
parameter_list|()
block|{
return|return
name|m_platform_list
return|;
block|}
name|void
name|DispatchInputInterrupt
parameter_list|()
function_decl|;
name|void
name|DispatchInputEndOfFile
parameter_list|()
function_decl|;
comment|//------------------------------------------------------------------
comment|// If any of the streams are not set, set them to the in/out/err
comment|// stream of the top most input reader to ensure they at least have
comment|// something
comment|//------------------------------------------------------------------
name|void
name|AdoptTopIOHandlerFilesIfInvalid
argument_list|(
name|lldb
operator|::
name|StreamFileSP
operator|&
name|in
argument_list|,
name|lldb
operator|::
name|StreamFileSP
operator|&
name|out
argument_list|,
name|lldb
operator|::
name|StreamFileSP
operator|&
name|err
argument_list|)
decl_stmt|;
name|void
name|PushIOHandler
argument_list|(
specifier|const
name|lldb
operator|::
name|IOHandlerSP
operator|&
name|reader_sp
argument_list|)
decl_stmt|;
name|bool
name|PopIOHandler
argument_list|(
specifier|const
name|lldb
operator|::
name|IOHandlerSP
operator|&
name|reader_sp
argument_list|)
decl_stmt|;
comment|// Synchronously run an input reader until it is done
name|void
name|RunIOHandler
argument_list|(
specifier|const
name|lldb
operator|::
name|IOHandlerSP
operator|&
name|reader_sp
argument_list|)
decl_stmt|;
name|bool
name|IsTopIOHandler
argument_list|(
specifier|const
name|lldb
operator|::
name|IOHandlerSP
operator|&
name|reader_sp
argument_list|)
decl_stmt|;
name|bool
name|CheckTopIOHandlerTypes
argument_list|(
name|IOHandler
operator|::
name|Type
name|top_type
argument_list|,
name|IOHandler
operator|::
name|Type
name|second_top_type
argument_list|)
decl_stmt|;
name|void
name|PrintAsync
parameter_list|(
specifier|const
name|char
modifier|*
name|s
parameter_list|,
name|size_t
name|len
parameter_list|,
name|bool
name|is_stdout
parameter_list|)
function_decl|;
name|ConstString
name|GetTopIOHandlerControlSequence
parameter_list|(
name|char
name|ch
parameter_list|)
function_decl|;
specifier|const
name|char
modifier|*
name|GetIOHandlerCommandPrefix
parameter_list|()
function_decl|;
specifier|const
name|char
modifier|*
name|GetIOHandlerHelpPrologue
parameter_list|()
function_decl|;
name|void
name|ClearIOHandlers
parameter_list|()
function_decl|;
name|bool
name|GetCloseInputOnEOF
argument_list|()
specifier|const
expr_stmt|;
name|void
name|SetCloseInputOnEOF
parameter_list|(
name|bool
name|b
parameter_list|)
function_decl|;
name|bool
name|EnableLog
parameter_list|(
specifier|const
name|char
modifier|*
name|channel
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|categories
parameter_list|,
specifier|const
name|char
modifier|*
name|log_file
parameter_list|,
name|uint32_t
name|log_options
parameter_list|,
name|Stream
modifier|&
name|error_stream
parameter_list|)
function_decl|;
name|void
name|SetLoggingCallback
argument_list|(
name|lldb
operator|::
name|LogOutputCallback
name|log_callback
argument_list|,
name|void
operator|*
name|baton
argument_list|)
decl_stmt|;
comment|//----------------------------------------------------------------------
comment|// Properties Functions
comment|//----------------------------------------------------------------------
enum|enum
name|StopDisassemblyType
block|{
name|eStopDisassemblyTypeNever
init|=
literal|0
block|,
name|eStopDisassemblyTypeNoDebugInfo
block|,
name|eStopDisassemblyTypeNoSource
block|,
name|eStopDisassemblyTypeAlways
block|}
enum|;
name|Error
name|SetPropertyValue
argument_list|(
specifier|const
name|ExecutionContext
operator|*
name|exe_ctx
argument_list|,
name|VarSetOperationType
name|op
argument_list|,
specifier|const
name|char
operator|*
name|property_path
argument_list|,
specifier|const
name|char
operator|*
name|value
argument_list|)
name|override
decl_stmt|;
name|bool
name|GetAutoConfirm
argument_list|()
specifier|const
expr_stmt|;
specifier|const
name|FormatEntity
operator|::
name|Entry
operator|*
name|GetDisassemblyFormat
argument_list|()
specifier|const
expr_stmt|;
specifier|const
name|FormatEntity
operator|::
name|Entry
operator|*
name|GetFrameFormat
argument_list|()
specifier|const
expr_stmt|;
specifier|const
name|FormatEntity
operator|::
name|Entry
operator|*
name|GetThreadFormat
argument_list|()
specifier|const
expr_stmt|;
name|lldb
operator|::
name|ScriptLanguage
name|GetScriptLanguage
argument_list|()
specifier|const
expr_stmt|;
name|bool
name|SetScriptLanguage
argument_list|(
name|lldb
operator|::
name|ScriptLanguage
name|script_lang
argument_list|)
decl_stmt|;
name|uint32_t
name|GetTerminalWidth
argument_list|()
specifier|const
expr_stmt|;
name|bool
name|SetTerminalWidth
parameter_list|(
name|uint32_t
name|term_width
parameter_list|)
function_decl|;
specifier|const
name|char
operator|*
name|GetPrompt
argument_list|()
specifier|const
expr_stmt|;
name|void
name|SetPrompt
parameter_list|(
specifier|const
name|char
modifier|*
name|p
parameter_list|)
function_decl|;
name|bool
name|GetUseExternalEditor
argument_list|()
specifier|const
expr_stmt|;
name|bool
name|SetUseExternalEditor
parameter_list|(
name|bool
name|use_external_editor_p
parameter_list|)
function_decl|;
name|bool
name|GetUseColor
argument_list|()
specifier|const
expr_stmt|;
name|bool
name|SetUseColor
parameter_list|(
name|bool
name|use_color
parameter_list|)
function_decl|;
name|uint32_t
name|GetStopSourceLineCount
argument_list|(
name|bool
name|before
argument_list|)
decl|const
decl_stmt|;
name|StopDisassemblyType
name|GetStopDisassemblyDisplay
argument_list|()
specifier|const
expr_stmt|;
name|uint32_t
name|GetDisassemblyLineCount
argument_list|()
specifier|const
expr_stmt|;
name|bool
name|GetAutoOneLineSummaries
argument_list|()
specifier|const
expr_stmt|;
name|bool
name|GetAutoIndent
argument_list|()
specifier|const
expr_stmt|;
name|bool
name|SetAutoIndent
parameter_list|(
name|bool
name|b
parameter_list|)
function_decl|;
name|bool
name|GetPrintDecls
argument_list|()
specifier|const
expr_stmt|;
name|bool
name|SetPrintDecls
parameter_list|(
name|bool
name|b
parameter_list|)
function_decl|;
name|uint32_t
name|GetTabSize
argument_list|()
specifier|const
expr_stmt|;
name|bool
name|SetTabSize
parameter_list|(
name|uint32_t
name|tab_size
parameter_list|)
function_decl|;
name|bool
name|GetEscapeNonPrintables
argument_list|()
specifier|const
expr_stmt|;
name|bool
name|GetNotifyVoid
argument_list|()
specifier|const
expr_stmt|;
specifier|const
name|ConstString
modifier|&
name|GetInstanceName
parameter_list|()
block|{
return|return
name|m_instance_name
return|;
block|}
name|bool
name|LoadPlugin
parameter_list|(
specifier|const
name|FileSpec
modifier|&
name|spec
parameter_list|,
name|Error
modifier|&
name|error
parameter_list|)
function_decl|;
name|void
name|ExecuteIOHandlers
parameter_list|()
function_decl|;
name|bool
name|IsForwardingEvents
parameter_list|()
function_decl|;
name|void
name|EnableForwardEvents
argument_list|(
specifier|const
name|lldb
operator|::
name|ListenerSP
operator|&
name|listener_sp
argument_list|)
decl_stmt|;
name|void
name|CancelForwardEvents
argument_list|(
specifier|const
name|lldb
operator|::
name|ListenerSP
operator|&
name|listener_sp
argument_list|)
decl_stmt|;
name|bool
name|IsHandlingEvents
argument_list|()
specifier|const
block|{
return|return
name|m_event_handler_thread
operator|.
name|IsJoinable
argument_list|()
return|;
block|}
name|Error
name|RunREPL
argument_list|(
name|lldb
operator|::
name|LanguageType
name|language
argument_list|,
specifier|const
name|char
operator|*
name|repl_options
argument_list|)
decl_stmt|;
comment|// This is for use in the command interpreter, when you either want the selected target, or if no target
comment|// is present you want to prime the dummy target with entities that will be copied over to new targets.
name|Target
modifier|*
name|GetSelectedOrDummyTarget
parameter_list|(
name|bool
name|prefer_dummy
init|=
name|false
parameter_list|)
function_decl|;
name|Target
modifier|*
name|GetDummyTarget
parameter_list|()
function_decl|;
name|protected
label|:
name|friend
name|class
name|CommandInterpreter
decl_stmt|;
name|friend
name|class
name|REPL
decl_stmt|;
name|bool
name|StartEventHandlerThread
parameter_list|()
function_decl|;
name|void
name|StopEventHandlerThread
parameter_list|()
function_decl|;
specifier|static
name|lldb
operator|::
name|thread_result_t
name|EventHandlerThread
argument_list|(
argument|lldb::thread_arg_t arg
argument_list|)
expr_stmt|;
name|bool
name|HasIOHandlerThread
parameter_list|()
function_decl|;
name|bool
name|StartIOHandlerThread
parameter_list|()
function_decl|;
name|void
name|StopIOHandlerThread
parameter_list|()
function_decl|;
name|void
name|JoinIOHandlerThread
parameter_list|()
function_decl|;
specifier|static
name|lldb
operator|::
name|thread_result_t
name|IOHandlerThread
argument_list|(
argument|lldb::thread_arg_t arg
argument_list|)
expr_stmt|;
name|void
name|DefaultEventHandler
parameter_list|()
function_decl|;
name|void
name|HandleBreakpointEvent
argument_list|(
specifier|const
name|lldb
operator|::
name|EventSP
operator|&
name|event_sp
argument_list|)
decl_stmt|;
name|void
name|HandleProcessEvent
argument_list|(
specifier|const
name|lldb
operator|::
name|EventSP
operator|&
name|event_sp
argument_list|)
decl_stmt|;
name|void
name|HandleThreadEvent
argument_list|(
specifier|const
name|lldb
operator|::
name|EventSP
operator|&
name|event_sp
argument_list|)
decl_stmt|;
name|size_t
name|GetProcessSTDOUT
parameter_list|(
name|Process
modifier|*
name|process
parameter_list|,
name|Stream
modifier|*
name|stream
parameter_list|)
function_decl|;
name|size_t
name|GetProcessSTDERR
parameter_list|(
name|Process
modifier|*
name|process
parameter_list|,
name|Stream
modifier|*
name|stream
parameter_list|)
function_decl|;
name|SourceManager
operator|::
name|SourceFileCache
operator|&
name|GetSourceFileCache
argument_list|()
block|{
return|return
name|m_source_file_cache
return|;
block|}
name|void
name|InstanceInitialize
parameter_list|()
function_decl|;
name|lldb
operator|::
name|StreamFileSP
name|m_input_file_sp
expr_stmt|;
name|lldb
operator|::
name|StreamFileSP
name|m_output_file_sp
expr_stmt|;
name|lldb
operator|::
name|StreamFileSP
name|m_error_file_sp
expr_stmt|;
name|TerminalState
name|m_terminal_state
decl_stmt|;
name|TargetList
name|m_target_list
decl_stmt|;
name|PlatformList
name|m_platform_list
decl_stmt|;
name|Listener
name|m_listener
decl_stmt|;
name|std
operator|::
name|unique_ptr
operator|<
name|SourceManager
operator|>
name|m_source_manager_ap
expr_stmt|;
comment|// This is a scratch source manager that we return if we have no targets.
name|SourceManager
operator|::
name|SourceFileCache
name|m_source_file_cache
expr_stmt|;
comment|// All the source managers for targets created in this debugger used this shared
comment|// source file cache.
name|std
operator|::
name|unique_ptr
operator|<
name|CommandInterpreter
operator|>
name|m_command_interpreter_ap
expr_stmt|;
name|IOHandlerStack
name|m_input_reader_stack
decl_stmt|;
typedef|typedef
name|std
operator|::
name|map
operator|<
name|std
operator|::
name|string
operator|,
name|lldb
operator|::
name|StreamWP
operator|>
name|LogStreamMap
expr_stmt|;
name|LogStreamMap
name|m_log_streams
decl_stmt|;
name|lldb
operator|::
name|StreamSP
name|m_log_callback_stream_sp
expr_stmt|;
name|ConstString
name|m_instance_name
decl_stmt|;
specifier|static
name|LoadPluginCallbackType
name|g_load_plugin_callback
decl_stmt|;
typedef|typedef
name|std
operator|::
name|vector
operator|<
name|llvm
operator|::
name|sys
operator|::
name|DynamicLibrary
operator|>
name|LoadedPluginsList
expr_stmt|;
name|LoadedPluginsList
name|m_loaded_plugins
decl_stmt|;
name|HostThread
name|m_event_handler_thread
decl_stmt|;
name|HostThread
name|m_io_handler_thread
decl_stmt|;
name|Broadcaster
name|m_sync_broadcaster
decl_stmt|;
name|lldb
operator|::
name|ListenerSP
name|m_forward_listener_sp
expr_stmt|;
comment|//----------------------------------------------------------------------
comment|// Events for m_sync_broadcaster
comment|//----------------------------------------------------------------------
enum|enum
block|{
name|eBroadcastBitEventThreadIsListening
init|=
operator|(
literal|1
operator|<<
literal|0
operator|)
block|,     }
enum|;
name|private
label|:
comment|// Use Debugger::CreateInstance() to get a shared pointer to a new
comment|// debugger object
name|Debugger
argument_list|(
argument|lldb::LogOutputCallback m_log_callback
argument_list|,
argument|void *baton
argument_list|)
empty_stmt|;
name|DISALLOW_COPY_AND_ASSIGN
argument_list|(
name|Debugger
argument_list|)
expr_stmt|;
block|}
empty_stmt|;
block|}
end_decl_stmt

begin_comment
comment|// namespace lldb_private
end_comment

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|// liblldb_Debugger_h_
end_comment

end_unit

