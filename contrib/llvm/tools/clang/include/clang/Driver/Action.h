begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|//===--- Action.h - Abstract compilation steps ------------------*- C++ -*-===//
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|//                     The LLVM Compiler Infrastructure
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// This file is distributed under the University of Illinois Open Source
end_comment

begin_comment
comment|// License. See LICENSE.TXT for details.
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|//===----------------------------------------------------------------------===//
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|CLANG_DRIVER_ACTION_H_
end_ifndef

begin_define
define|#
directive|define
name|CLANG_DRIVER_ACTION_H_
end_define

begin_include
include|#
directive|include
file|"clang/Driver/Types.h"
end_include

begin_include
include|#
directive|include
file|"clang/Driver/Util.h"
end_include

begin_include
include|#
directive|include
file|"llvm/ADT/SmallVector.h"
end_include

begin_decl_stmt
name|namespace
name|clang
block|{
name|namespace
name|driver
block|{
name|class
name|Arg
decl_stmt|;
comment|/// Action - Represent an abstract compilation step to perform.
comment|///
comment|/// An action represents an edge in the compilation graph; typically
comment|/// it is a job to transform an input using some tool.
comment|///
comment|/// The current driver is hard wired to expect actions which produce a
comment|/// single primary output, at least in terms of controlling the
comment|/// compilation. Actions can produce auxiliary files, but can only
comment|/// produce a single output to feed into subsequent actions.
name|class
name|Action
block|{
name|public
label|:
typedef|typedef
name|ActionList
operator|::
name|size_type
name|size_type
expr_stmt|;
typedef|typedef
name|ActionList
operator|::
name|iterator
name|iterator
expr_stmt|;
typedef|typedef
name|ActionList
operator|::
name|const_iterator
name|const_iterator
expr_stmt|;
enum|enum
name|ActionClass
block|{
name|InputClass
init|=
literal|0
block|,
name|BindArchClass
block|,
name|PreprocessJobClass
block|,
name|PrecompileJobClass
block|,
name|AnalyzeJobClass
block|,
name|CompileJobClass
block|,
name|AssembleJobClass
block|,
name|LinkJobClass
block|,
name|LipoJobClass
block|,
name|DsymutilJobClass
block|,
name|VerifyJobClass
block|,
name|JobClassFirst
init|=
name|PreprocessJobClass
block|,
name|JobClassLast
init|=
name|VerifyJobClass
block|}
enum|;
specifier|static
specifier|const
name|char
modifier|*
name|getClassName
parameter_list|(
name|ActionClass
name|AC
parameter_list|)
function_decl|;
name|private
label|:
name|ActionClass
name|Kind
decl_stmt|;
comment|/// The output type of this action.
name|types
operator|::
name|ID
name|Type
expr_stmt|;
name|ActionList
name|Inputs
decl_stmt|;
name|unsigned
name|OwnsInputs
range|:
literal|1
decl_stmt|;
name|protected
label|:
name|Action
argument_list|(
argument|ActionClass _Kind
argument_list|,
argument|types::ID _Type
argument_list|)
block|:
name|Kind
argument_list|(
name|_Kind
argument_list|)
operator|,
name|Type
argument_list|(
name|_Type
argument_list|)
operator|,
name|OwnsInputs
argument_list|(
argument|true
argument_list|)
block|{}
name|Action
argument_list|(
argument|ActionClass _Kind
argument_list|,
argument|Action *Input
argument_list|,
argument|types::ID _Type
argument_list|)
operator|:
name|Kind
argument_list|(
name|_Kind
argument_list|)
operator|,
name|Type
argument_list|(
name|_Type
argument_list|)
operator|,
name|Inputs
argument_list|(
operator|&
name|Input
argument_list|,
operator|&
name|Input
operator|+
literal|1
argument_list|)
operator|,
name|OwnsInputs
argument_list|(
argument|true
argument_list|)
block|{}
name|Action
argument_list|(
argument|ActionClass _Kind
argument_list|,
argument|const ActionList&_Inputs
argument_list|,
argument|types::ID _Type
argument_list|)
operator|:
name|Kind
argument_list|(
name|_Kind
argument_list|)
operator|,
name|Type
argument_list|(
name|_Type
argument_list|)
operator|,
name|Inputs
argument_list|(
name|_Inputs
argument_list|)
operator|,
name|OwnsInputs
argument_list|(
argument|true
argument_list|)
block|{}
name|public
operator|:
name|virtual
operator|~
name|Action
argument_list|()
expr_stmt|;
specifier|const
name|char
operator|*
name|getClassName
argument_list|()
specifier|const
block|{
return|return
name|Action
operator|::
name|getClassName
argument_list|(
name|getKind
argument_list|()
argument_list|)
return|;
block|}
name|bool
name|getOwnsInputs
parameter_list|()
block|{
return|return
name|OwnsInputs
return|;
block|}
name|void
name|setOwnsInputs
parameter_list|(
name|bool
name|Value
parameter_list|)
block|{
name|OwnsInputs
operator|=
name|Value
expr_stmt|;
block|}
name|ActionClass
name|getKind
argument_list|()
specifier|const
block|{
return|return
name|Kind
return|;
block|}
name|types
operator|::
name|ID
name|getType
argument_list|()
specifier|const
block|{
return|return
name|Type
return|;
block|}
name|ActionList
modifier|&
name|getInputs
parameter_list|()
block|{
return|return
name|Inputs
return|;
block|}
specifier|const
name|ActionList
operator|&
name|getInputs
argument_list|()
specifier|const
block|{
return|return
name|Inputs
return|;
block|}
name|size_type
name|size
argument_list|()
specifier|const
block|{
return|return
name|Inputs
operator|.
name|size
argument_list|()
return|;
block|}
name|iterator
name|begin
parameter_list|()
block|{
return|return
name|Inputs
operator|.
name|begin
argument_list|()
return|;
block|}
name|iterator
name|end
parameter_list|()
block|{
return|return
name|Inputs
operator|.
name|end
argument_list|()
return|;
block|}
name|const_iterator
name|begin
argument_list|()
specifier|const
block|{
return|return
name|Inputs
operator|.
name|begin
argument_list|()
return|;
block|}
name|const_iterator
name|end
argument_list|()
specifier|const
block|{
return|return
name|Inputs
operator|.
name|end
argument_list|()
return|;
block|}
specifier|static
name|bool
name|classof
parameter_list|(
specifier|const
name|Action
modifier|*
parameter_list|)
block|{
return|return
name|true
return|;
block|}
block|}
empty_stmt|;
name|class
name|InputAction
range|:
name|public
name|Action
block|{
specifier|const
name|Arg
operator|&
name|Input
block|;
name|public
operator|:
name|InputAction
argument_list|(
argument|const Arg&_Input
argument_list|,
argument|types::ID _Type
argument_list|)
block|;
specifier|const
name|Arg
operator|&
name|getInputArg
argument_list|()
specifier|const
block|{
return|return
name|Input
return|;
block|}
specifier|static
name|bool
name|classof
argument_list|(
argument|const Action *A
argument_list|)
block|{
return|return
name|A
operator|->
name|getKind
argument_list|()
operator|==
name|InputClass
return|;
block|}
specifier|static
name|bool
name|classof
argument_list|(
argument|const InputAction *
argument_list|)
block|{
return|return
name|true
return|;
block|}
expr|}
block|;
name|class
name|BindArchAction
operator|:
name|public
name|Action
block|{
comment|/// The architecture to bind, or 0 if the default architecture
comment|/// should be bound.
specifier|const
name|char
operator|*
name|ArchName
block|;
name|public
operator|:
name|BindArchAction
argument_list|(
name|Action
operator|*
name|Input
argument_list|,
specifier|const
name|char
operator|*
name|_ArchName
argument_list|)
block|;
specifier|const
name|char
operator|*
name|getArchName
argument_list|()
specifier|const
block|{
return|return
name|ArchName
return|;
block|}
specifier|static
name|bool
name|classof
argument_list|(
argument|const Action *A
argument_list|)
block|{
return|return
name|A
operator|->
name|getKind
argument_list|()
operator|==
name|BindArchClass
return|;
block|}
specifier|static
name|bool
name|classof
argument_list|(
argument|const BindArchAction *
argument_list|)
block|{
return|return
name|true
return|;
block|}
expr|}
block|;
name|class
name|JobAction
operator|:
name|public
name|Action
block|{
name|protected
operator|:
name|JobAction
argument_list|(
argument|ActionClass Kind
argument_list|,
argument|Action *Input
argument_list|,
argument|types::ID Type
argument_list|)
block|;
name|JobAction
argument_list|(
argument|ActionClass Kind
argument_list|,
argument|const ActionList&Inputs
argument_list|,
argument|types::ID Type
argument_list|)
block|;
name|public
operator|:
specifier|static
name|bool
name|classof
argument_list|(
argument|const Action *A
argument_list|)
block|{
return|return
operator|(
name|A
operator|->
name|getKind
argument_list|()
operator|>=
name|JobClassFirst
operator|&&
name|A
operator|->
name|getKind
argument_list|()
operator|<=
name|JobClassLast
operator|)
return|;
block|}
specifier|static
name|bool
name|classof
argument_list|(
argument|const JobAction *
argument_list|)
block|{
return|return
name|true
return|;
block|}
expr|}
block|;
name|class
name|PreprocessJobAction
operator|:
name|public
name|JobAction
block|{
name|public
operator|:
name|PreprocessJobAction
argument_list|(
argument|Action *Input
argument_list|,
argument|types::ID OutputType
argument_list|)
block|;
specifier|static
name|bool
name|classof
argument_list|(
argument|const Action *A
argument_list|)
block|{
return|return
name|A
operator|->
name|getKind
argument_list|()
operator|==
name|PreprocessJobClass
return|;
block|}
specifier|static
name|bool
name|classof
argument_list|(
argument|const PreprocessJobAction *
argument_list|)
block|{
return|return
name|true
return|;
block|}
expr|}
block|;
name|class
name|PrecompileJobAction
operator|:
name|public
name|JobAction
block|{
name|public
operator|:
name|PrecompileJobAction
argument_list|(
argument|Action *Input
argument_list|,
argument|types::ID OutputType
argument_list|)
block|;
specifier|static
name|bool
name|classof
argument_list|(
argument|const Action *A
argument_list|)
block|{
return|return
name|A
operator|->
name|getKind
argument_list|()
operator|==
name|PrecompileJobClass
return|;
block|}
specifier|static
name|bool
name|classof
argument_list|(
argument|const PrecompileJobAction *
argument_list|)
block|{
return|return
name|true
return|;
block|}
expr|}
block|;
name|class
name|AnalyzeJobAction
operator|:
name|public
name|JobAction
block|{
name|public
operator|:
name|AnalyzeJobAction
argument_list|(
argument|Action *Input
argument_list|,
argument|types::ID OutputType
argument_list|)
block|;
specifier|static
name|bool
name|classof
argument_list|(
argument|const Action *A
argument_list|)
block|{
return|return
name|A
operator|->
name|getKind
argument_list|()
operator|==
name|AnalyzeJobClass
return|;
block|}
specifier|static
name|bool
name|classof
argument_list|(
argument|const AnalyzeJobAction *
argument_list|)
block|{
return|return
name|true
return|;
block|}
expr|}
block|;
name|class
name|CompileJobAction
operator|:
name|public
name|JobAction
block|{
name|public
operator|:
name|CompileJobAction
argument_list|(
argument|Action *Input
argument_list|,
argument|types::ID OutputType
argument_list|)
block|;
specifier|static
name|bool
name|classof
argument_list|(
argument|const Action *A
argument_list|)
block|{
return|return
name|A
operator|->
name|getKind
argument_list|()
operator|==
name|CompileJobClass
return|;
block|}
specifier|static
name|bool
name|classof
argument_list|(
argument|const CompileJobAction *
argument_list|)
block|{
return|return
name|true
return|;
block|}
expr|}
block|;
name|class
name|AssembleJobAction
operator|:
name|public
name|JobAction
block|{
name|public
operator|:
name|AssembleJobAction
argument_list|(
argument|Action *Input
argument_list|,
argument|types::ID OutputType
argument_list|)
block|;
specifier|static
name|bool
name|classof
argument_list|(
argument|const Action *A
argument_list|)
block|{
return|return
name|A
operator|->
name|getKind
argument_list|()
operator|==
name|AssembleJobClass
return|;
block|}
specifier|static
name|bool
name|classof
argument_list|(
argument|const AssembleJobAction *
argument_list|)
block|{
return|return
name|true
return|;
block|}
expr|}
block|;
name|class
name|LinkJobAction
operator|:
name|public
name|JobAction
block|{
name|public
operator|:
name|LinkJobAction
argument_list|(
argument|ActionList&Inputs
argument_list|,
argument|types::ID Type
argument_list|)
block|;
specifier|static
name|bool
name|classof
argument_list|(
argument|const Action *A
argument_list|)
block|{
return|return
name|A
operator|->
name|getKind
argument_list|()
operator|==
name|LinkJobClass
return|;
block|}
specifier|static
name|bool
name|classof
argument_list|(
argument|const LinkJobAction *
argument_list|)
block|{
return|return
name|true
return|;
block|}
expr|}
block|;
name|class
name|LipoJobAction
operator|:
name|public
name|JobAction
block|{
name|public
operator|:
name|LipoJobAction
argument_list|(
argument|ActionList&Inputs
argument_list|,
argument|types::ID Type
argument_list|)
block|;
specifier|static
name|bool
name|classof
argument_list|(
argument|const Action *A
argument_list|)
block|{
return|return
name|A
operator|->
name|getKind
argument_list|()
operator|==
name|LipoJobClass
return|;
block|}
specifier|static
name|bool
name|classof
argument_list|(
argument|const LipoJobAction *
argument_list|)
block|{
return|return
name|true
return|;
block|}
expr|}
block|;
name|class
name|DsymutilJobAction
operator|:
name|public
name|JobAction
block|{
name|public
operator|:
name|DsymutilJobAction
argument_list|(
argument|ActionList&Inputs
argument_list|,
argument|types::ID Type
argument_list|)
block|;
specifier|static
name|bool
name|classof
argument_list|(
argument|const Action *A
argument_list|)
block|{
return|return
name|A
operator|->
name|getKind
argument_list|()
operator|==
name|DsymutilJobClass
return|;
block|}
specifier|static
name|bool
name|classof
argument_list|(
argument|const DsymutilJobAction *
argument_list|)
block|{
return|return
name|true
return|;
block|}
expr|}
block|;
name|class
name|VerifyJobAction
operator|:
name|public
name|JobAction
block|{
name|public
operator|:
name|VerifyJobAction
argument_list|(
argument|ActionList&Inputs
argument_list|,
argument|types::ID Type
argument_list|)
block|;
specifier|static
name|bool
name|classof
argument_list|(
argument|const Action *A
argument_list|)
block|{
return|return
name|A
operator|->
name|getKind
argument_list|()
operator|==
name|VerifyJobClass
return|;
block|}
specifier|static
name|bool
name|classof
argument_list|(
argument|const VerifyJobAction *
argument_list|)
block|{
return|return
name|true
return|;
block|}
expr|}
block|;  }
comment|// end namespace driver
block|}
end_decl_stmt

begin_comment
comment|// end namespace clang
end_comment

begin_endif
endif|#
directive|endif
end_endif

end_unit

