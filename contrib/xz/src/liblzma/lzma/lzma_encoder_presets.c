begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|///////////////////////////////////////////////////////////////////////////////
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|/// \file       lzma_encoder_presets.c
end_comment

begin_comment
comment|/// \brief      Encoder presets
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|//  Author:     Lasse Collin
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|//  This file has been put into the public domain.
end_comment

begin_comment
comment|//  You can do whatever you want with this file.
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|///////////////////////////////////////////////////////////////////////////////
end_comment

begin_include
include|#
directive|include
file|"common.h"
end_include

begin_extern
extern|extern LZMA_API(lzma_bool
end_extern

begin_macro
unit|)
name|lzma_lzma_preset
argument_list|(
argument|lzma_options_lzma *options
argument_list|,
argument|uint32_t preset
argument_list|)
end_macro

begin_block
block|{
specifier|const
name|uint32_t
name|level
init|=
name|preset
operator|&
name|LZMA_PRESET_LEVEL_MASK
decl_stmt|;
specifier|const
name|uint32_t
name|flags
init|=
name|preset
operator|&
operator|~
name|LZMA_PRESET_LEVEL_MASK
decl_stmt|;
specifier|const
name|uint32_t
name|supported_flags
init|=
name|LZMA_PRESET_EXTREME
decl_stmt|;
if|if
condition|(
name|level
operator|>
literal|9
operator|||
operator|(
name|flags
operator|&
operator|~
name|supported_flags
operator|)
condition|)
return|return
name|true
return|;
name|options
operator|->
name|preset_dict
operator|=
name|NULL
expr_stmt|;
name|options
operator|->
name|preset_dict_size
operator|=
literal|0
expr_stmt|;
name|options
operator|->
name|lc
operator|=
name|LZMA_LC_DEFAULT
expr_stmt|;
name|options
operator|->
name|lp
operator|=
name|LZMA_LP_DEFAULT
expr_stmt|;
name|options
operator|->
name|pb
operator|=
name|LZMA_PB_DEFAULT
expr_stmt|;
specifier|static
specifier|const
name|uint8_t
name|dict_pow2
index|[]
init|=
block|{
literal|18
block|,
literal|20
block|,
literal|21
block|,
literal|22
block|,
literal|22
block|,
literal|23
block|,
literal|23
block|,
literal|24
block|,
literal|25
block|,
literal|26
block|}
decl_stmt|;
name|options
operator|->
name|dict_size
operator|=
name|UINT32_C
argument_list|(
literal|1
argument_list|)
operator|<<
name|dict_pow2
index|[
name|level
index|]
expr_stmt|;
if|if
condition|(
name|level
operator|<=
literal|3
condition|)
block|{
name|options
operator|->
name|mode
operator|=
name|LZMA_MODE_FAST
expr_stmt|;
name|options
operator|->
name|mf
operator|=
name|level
operator|==
literal|0
condition|?
name|LZMA_MF_HC3
else|:
name|LZMA_MF_HC4
expr_stmt|;
name|options
operator|->
name|nice_len
operator|=
name|level
operator|<=
literal|1
condition|?
literal|128
else|:
literal|273
expr_stmt|;
specifier|static
specifier|const
name|uint8_t
name|depths
index|[]
init|=
block|{
literal|4
block|,
literal|8
block|,
literal|24
block|,
literal|48
block|}
decl_stmt|;
name|options
operator|->
name|depth
operator|=
name|depths
index|[
name|level
index|]
expr_stmt|;
block|}
else|else
block|{
name|options
operator|->
name|mode
operator|=
name|LZMA_MODE_NORMAL
expr_stmt|;
name|options
operator|->
name|mf
operator|=
name|LZMA_MF_BT4
expr_stmt|;
name|options
operator|->
name|nice_len
operator|=
name|level
operator|==
literal|4
condition|?
literal|16
else|:
name|level
operator|==
literal|5
condition|?
literal|32
else|:
literal|64
expr_stmt|;
name|options
operator|->
name|depth
operator|=
literal|0
expr_stmt|;
block|}
if|if
condition|(
name|flags
operator|&
name|LZMA_PRESET_EXTREME
condition|)
block|{
name|options
operator|->
name|mode
operator|=
name|LZMA_MODE_NORMAL
expr_stmt|;
name|options
operator|->
name|mf
operator|=
name|LZMA_MF_BT4
expr_stmt|;
if|if
condition|(
name|level
operator|==
literal|3
operator|||
name|level
operator|==
literal|5
condition|)
block|{
name|options
operator|->
name|nice_len
operator|=
literal|192
expr_stmt|;
name|options
operator|->
name|depth
operator|=
literal|0
expr_stmt|;
block|}
else|else
block|{
name|options
operator|->
name|nice_len
operator|=
literal|273
expr_stmt|;
name|options
operator|->
name|depth
operator|=
literal|512
expr_stmt|;
block|}
block|}
return|return
name|false
return|;
block|}
end_block

end_unit

