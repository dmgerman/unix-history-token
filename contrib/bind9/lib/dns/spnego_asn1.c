begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (C) 2006, 2007, 2012, 2013, 2015  Internet Systems Consortium, Inc. ("ISC")  *  * Permission to use, copy, modify, and/or distribute this software for any  * purpose with or without fee is hereby granted, provided that the above  * copyright notice and this permission notice appear in all copies.  *  * THE SOFTWARE IS PROVIDED "AS IS" AND ISC DISCLAIMS ALL WARRANTIES WITH  * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY  * AND FITNESS.  IN NO EVENT SHALL ISC BE LIABLE FOR ANY SPECIAL, DIRECT,  * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM  * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE  * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR  * PERFORMANCE OF THIS SOFTWARE.  */
end_comment

begin_comment
comment|/* $Id: spnego_asn1.c,v 1.4 2007/06/19 23:47:16 tbox Exp $ */
end_comment

begin_comment
comment|/*! \file  * \brief Method routines generated from SPNEGO ASN.1 module.  * See spnego_asn1.pl for details.  Do not edit.  */
end_comment

begin_comment
comment|/* Generated from spnego.asn1 */
end_comment

begin_comment
comment|/* Do not edit */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|__asn1_h__
end_ifndef

begin_define
define|#
directive|define
name|__asn1_h__
end_define

begin_ifndef
ifndef|#
directive|ifndef
name|__asn1_common_definitions__
end_ifndef

begin_define
define|#
directive|define
name|__asn1_common_definitions__
end_define

begin_typedef
typedef|typedef
struct|struct
name|octet_string
block|{
name|size_t
name|length
decl_stmt|;
name|void
modifier|*
name|data
decl_stmt|;
block|}
name|octet_string
typedef|;
end_typedef

begin_typedef
typedef|typedef
name|char
modifier|*
name|general_string
typedef|;
end_typedef

begin_typedef
typedef|typedef
name|char
modifier|*
name|utf8_string
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|oid
block|{
name|size_t
name|length
decl_stmt|;
name|unsigned
modifier|*
name|components
decl_stmt|;
block|}
name|oid
typedef|;
end_typedef

begin_define
define|#
directive|define
name|ASN1_MALLOC_ENCODE
parameter_list|(
name|T
parameter_list|,
name|B
parameter_list|,
name|BL
parameter_list|,
name|S
parameter_list|,
name|L
parameter_list|,
name|R
parameter_list|)
define|\
value|do {                                                         \     (BL) = length_##T((S));                                    \     (B) = malloc((BL));                                        \     if((B) == NULL) {                                          \       (R) = ENOMEM;                                            \     } else {                                                   \       (R) = encode_##T(((unsigned char*)(B)) + (BL) - 1, (BL), \ 		       (S), (L));                              \       if((R) != 0) {                                           \ 	free((B));                                             \ 	(B) = NULL;                                            \       }                                                        \     }                                                          \   } while (0)
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/*  * MechType ::= OBJECT IDENTIFIER  */
end_comment

begin_typedef
typedef|typedef
name|oid
name|MechType
typedef|;
end_typedef

begin_function_decl
specifier|static
name|int
name|encode_MechType
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|,
specifier|const
name|MechType
modifier|*
parameter_list|,
name|size_t
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|decode_MechType
parameter_list|(
specifier|const
name|unsigned
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|,
name|MechType
modifier|*
parameter_list|,
name|size_t
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|free_MechType
parameter_list|(
name|MechType
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* unused declaration: length_MechType */
end_comment

begin_comment
comment|/* unused declaration: copy_MechType */
end_comment

begin_comment
comment|/*  * MechTypeList ::= SEQUENCE OF MechType  */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|MechTypeList
block|{
name|unsigned
name|int
name|len
decl_stmt|;
name|MechType
modifier|*
name|val
decl_stmt|;
block|}
name|MechTypeList
typedef|;
end_typedef

begin_function_decl
specifier|static
name|int
name|encode_MechTypeList
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|,
specifier|const
name|MechTypeList
modifier|*
parameter_list|,
name|size_t
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|decode_MechTypeList
parameter_list|(
specifier|const
name|unsigned
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|,
name|MechTypeList
modifier|*
parameter_list|,
name|size_t
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|free_MechTypeList
parameter_list|(
name|MechTypeList
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* unused declaration: length_MechTypeList */
end_comment

begin_comment
comment|/* unused declaration: copy_MechTypeList */
end_comment

begin_comment
comment|/*  * ContextFlags ::= BIT STRING { delegFlag(0), mutualFlag(1), replayFlag(2),  * sequenceFlag(3), anonFlag(4), confFlag(5), integFlag(6) }  */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|ContextFlags
block|{
name|unsigned
name|int
name|delegFlag
range|:
literal|1
decl_stmt|;
name|unsigned
name|int
name|mutualFlag
range|:
literal|1
decl_stmt|;
name|unsigned
name|int
name|replayFlag
range|:
literal|1
decl_stmt|;
name|unsigned
name|int
name|sequenceFlag
range|:
literal|1
decl_stmt|;
name|unsigned
name|int
name|anonFlag
range|:
literal|1
decl_stmt|;
name|unsigned
name|int
name|confFlag
range|:
literal|1
decl_stmt|;
name|unsigned
name|int
name|integFlag
range|:
literal|1
decl_stmt|;
block|}
name|ContextFlags
typedef|;
end_typedef

begin_function_decl
specifier|static
name|int
name|encode_ContextFlags
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|,
specifier|const
name|ContextFlags
modifier|*
parameter_list|,
name|size_t
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|decode_ContextFlags
parameter_list|(
specifier|const
name|unsigned
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|,
name|ContextFlags
modifier|*
parameter_list|,
name|size_t
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|free_ContextFlags
parameter_list|(
name|ContextFlags
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* unused declaration: length_ContextFlags */
end_comment

begin_comment
comment|/* unused declaration: copy_ContextFlags */
end_comment

begin_comment
comment|/* unused declaration: ContextFlags2int */
end_comment

begin_comment
comment|/* unused declaration: int2ContextFlags */
end_comment

begin_comment
comment|/* unused declaration: asn1_ContextFlags_units */
end_comment

begin_comment
comment|/*  * NegTokenInit ::= SEQUENCE { mechTypes[0]    MechTypeList, reqFlags[1]  * ContextFlags OPTIONAL, mechToken[2]    OCTET STRING OPTIONAL,  * mechListMIC[3]  OCTET STRING OPTIONAL }  */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|NegTokenInit
block|{
name|MechTypeList
name|mechTypes
decl_stmt|;
name|ContextFlags
modifier|*
name|reqFlags
decl_stmt|;
name|octet_string
modifier|*
name|mechToken
decl_stmt|;
name|octet_string
modifier|*
name|mechListMIC
decl_stmt|;
block|}
name|NegTokenInit
typedef|;
end_typedef

begin_function_decl
specifier|static
name|int
name|encode_NegTokenInit
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|,
specifier|const
name|NegTokenInit
modifier|*
parameter_list|,
name|size_t
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|decode_NegTokenInit
parameter_list|(
specifier|const
name|unsigned
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|,
name|NegTokenInit
modifier|*
parameter_list|,
name|size_t
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|free_NegTokenInit
parameter_list|(
name|NegTokenInit
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* unused declaration: length_NegTokenInit */
end_comment

begin_comment
comment|/* unused declaration: copy_NegTokenInit */
end_comment

begin_comment
comment|/*  * NegTokenResp ::= SEQUENCE { negState[0]       ENUMERATED {  * accept-completed(0), accept-incomplete(1), reject(2), request-mic(3) }  * OPTIONAL, supportedMech[1]  MechType OPTIONAL, responseToken[2]  OCTET  * STRING OPTIONAL, mechListMIC[3]    OCTET STRING OPTIONAL }  */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|NegTokenResp
block|{
enum|enum
block|{
name|accept_completed
init|=
literal|0
block|,
name|accept_incomplete
init|=
literal|1
block|,
name|reject
init|=
literal|2
block|,
name|request_mic
init|=
literal|3
block|}
modifier|*
name|negState
enum|;
name|MechType
modifier|*
name|supportedMech
decl_stmt|;
name|octet_string
modifier|*
name|responseToken
decl_stmt|;
name|octet_string
modifier|*
name|mechListMIC
decl_stmt|;
block|}
name|NegTokenResp
typedef|;
end_typedef

begin_function_decl
specifier|static
name|int
name|encode_NegTokenResp
parameter_list|(
name|unsigned
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|,
specifier|const
name|NegTokenResp
modifier|*
parameter_list|,
name|size_t
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|decode_NegTokenResp
parameter_list|(
specifier|const
name|unsigned
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|,
name|NegTokenResp
modifier|*
parameter_list|,
name|size_t
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|free_NegTokenResp
parameter_list|(
name|NegTokenResp
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* unused declaration: length_NegTokenResp */
end_comment

begin_comment
comment|/* unused declaration: copy_NegTokenResp */
end_comment

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* __asn1_h__ */
end_comment

begin_comment
comment|/* Generated from spnego.asn1 */
end_comment

begin_comment
comment|/* Do not edit */
end_comment

begin_define
define|#
directive|define
name|BACK
value|if (e) return e; p -= l; len -= l; ret += l; POST(p); POST(len); POST(ret)
end_define

begin_function
specifier|static
name|int
name|encode_MechType
parameter_list|(
name|unsigned
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|len
parameter_list|,
specifier|const
name|MechType
modifier|*
name|data
parameter_list|,
name|size_t
modifier|*
name|size
parameter_list|)
block|{
name|size_t
name|ret
init|=
literal|0
decl_stmt|;
name|size_t
name|l
decl_stmt|;
name|int
name|e
decl_stmt|;
name|e
operator|=
name|encode_oid
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|data
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
operator|*
name|size
operator|=
name|ret
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_define
define|#
directive|define
name|FORW
value|if(e) goto fail; p += l; len -= l; ret += l; POST(p); POST(len); POST(ret)
end_define

begin_function
specifier|static
name|int
name|decode_MechType
parameter_list|(
specifier|const
name|unsigned
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|len
parameter_list|,
name|MechType
modifier|*
name|data
parameter_list|,
name|size_t
modifier|*
name|size
parameter_list|)
block|{
name|size_t
name|ret
init|=
literal|0
decl_stmt|;
name|size_t
name|l
decl_stmt|;
name|int
name|e
decl_stmt|;
name|memset
argument_list|(
name|data
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|data
argument_list|)
argument_list|)
expr_stmt|;
name|e
operator|=
name|decode_oid
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|data
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
if|if
condition|(
name|size
condition|)
operator|*
name|size
operator|=
name|ret
expr_stmt|;
return|return
literal|0
return|;
name|fail
label|:
name|free_MechType
argument_list|(
name|data
argument_list|)
expr_stmt|;
return|return
name|e
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|free_MechType
parameter_list|(
name|MechType
modifier|*
name|data
parameter_list|)
block|{
name|free_oid
argument_list|(
name|data
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* unused function: length_MechType */
end_comment

begin_comment
comment|/* unused function: copy_MechType */
end_comment

begin_comment
comment|/* Generated from spnego.asn1 */
end_comment

begin_comment
comment|/* Do not edit */
end_comment

begin_function
specifier|static
name|int
name|encode_MechTypeList
parameter_list|(
name|unsigned
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|len
parameter_list|,
specifier|const
name|MechTypeList
modifier|*
name|data
parameter_list|,
name|size_t
modifier|*
name|size
parameter_list|)
block|{
name|size_t
name|ret
init|=
literal|0
decl_stmt|;
name|size_t
name|l
decl_stmt|;
name|int
name|i
decl_stmt|,
name|e
decl_stmt|;
for|for
control|(
name|i
operator|=
operator|(
name|data
operator|)
operator|->
name|len
operator|-
literal|1
init|;
name|i
operator|>=
literal|0
condition|;
operator|--
name|i
control|)
block|{
name|size_t
name|oldret
init|=
name|ret
decl_stmt|;
name|ret
operator|=
literal|0
expr_stmt|;
name|e
operator|=
name|encode_MechType
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|&
operator|(
name|data
operator|)
operator|->
name|val
index|[
name|i
index|]
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
name|ret
operator|+=
name|oldret
expr_stmt|;
block|}
name|e
operator|=
name|der_put_length_and_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ret
argument_list|,
name|ASN1_C_UNIV
argument_list|,
name|CONS
argument_list|,
name|UT_Sequence
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
operator|*
name|size
operator|=
name|ret
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|decode_MechTypeList
parameter_list|(
specifier|const
name|unsigned
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|len
parameter_list|,
name|MechTypeList
modifier|*
name|data
parameter_list|,
name|size_t
modifier|*
name|size
parameter_list|)
block|{
name|size_t
name|ret
init|=
literal|0
decl_stmt|,
name|reallen
decl_stmt|;
name|size_t
name|l
decl_stmt|;
name|int
name|e
decl_stmt|;
name|memset
argument_list|(
name|data
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|data
argument_list|)
argument_list|)
expr_stmt|;
name|reallen
operator|=
literal|0
expr_stmt|;
name|e
operator|=
name|der_match_tag_and_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ASN1_C_UNIV
argument_list|,
name|CONS
argument_list|,
name|UT_Sequence
argument_list|,
operator|&
name|reallen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
if|if
condition|(
name|len
operator|<
name|reallen
condition|)
return|return
name|ASN1_OVERRUN
return|;
name|len
operator|=
name|reallen
expr_stmt|;
block|{
name|size_t
name|origlen
init|=
name|len
decl_stmt|;
name|size_t
name|oldret
init|=
name|ret
decl_stmt|;
name|ret
operator|=
literal|0
expr_stmt|;
operator|(
name|data
operator|)
operator|->
name|len
operator|=
literal|0
expr_stmt|;
operator|(
name|data
operator|)
operator|->
name|val
operator|=
name|NULL
expr_stmt|;
while|while
condition|(
name|ret
operator|<
name|origlen
condition|)
block|{
name|void
modifier|*
name|old
init|=
operator|(
name|data
operator|)
operator|->
name|val
decl_stmt|;
operator|(
name|data
operator|)
operator|->
name|len
operator|++
expr_stmt|;
operator|(
name|data
operator|)
operator|->
name|val
operator|=
name|realloc
argument_list|(
operator|(
name|data
operator|)
operator|->
name|val
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
operator|(
operator|(
name|data
operator|)
operator|->
name|val
operator|)
argument_list|)
operator|*
operator|(
name|data
operator|)
operator|->
name|len
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|val
operator|==
name|NULL
condition|)
block|{
operator|(
name|data
operator|)
operator|->
name|val
operator|=
name|old
expr_stmt|;
operator|(
name|data
operator|)
operator|->
name|len
operator|--
expr_stmt|;
return|return
name|ENOMEM
return|;
block|}
name|e
operator|=
name|decode_MechType
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|&
operator|(
name|data
operator|)
operator|->
name|val
index|[
operator|(
name|data
operator|)
operator|->
name|len
operator|-
literal|1
index|]
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
name|len
operator|=
name|origlen
operator|-
name|ret
expr_stmt|;
block|}
name|ret
operator|+=
name|oldret
expr_stmt|;
block|}
if|if
condition|(
name|size
condition|)
operator|*
name|size
operator|=
name|ret
expr_stmt|;
return|return
literal|0
return|;
name|fail
label|:
name|free_MechTypeList
argument_list|(
name|data
argument_list|)
expr_stmt|;
return|return
name|e
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|free_MechTypeList
parameter_list|(
name|MechTypeList
modifier|*
name|data
parameter_list|)
block|{
while|while
condition|(
operator|(
name|data
operator|)
operator|->
name|len
condition|)
block|{
name|free_MechType
argument_list|(
operator|&
operator|(
name|data
operator|)
operator|->
name|val
index|[
operator|(
name|data
operator|)
operator|->
name|len
operator|-
literal|1
index|]
argument_list|)
expr_stmt|;
operator|(
name|data
operator|)
operator|->
name|len
operator|--
expr_stmt|;
block|}
name|free
argument_list|(
operator|(
name|data
operator|)
operator|->
name|val
argument_list|)
expr_stmt|;
operator|(
name|data
operator|)
operator|->
name|val
operator|=
name|NULL
expr_stmt|;
block|}
end_function

begin_comment
comment|/* unused function: length_MechTypeList */
end_comment

begin_comment
comment|/* unused function: copy_MechTypeList */
end_comment

begin_comment
comment|/* Generated from spnego.asn1 */
end_comment

begin_comment
comment|/* Do not edit */
end_comment

begin_function
specifier|static
name|int
name|encode_ContextFlags
parameter_list|(
name|unsigned
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|len
parameter_list|,
specifier|const
name|ContextFlags
modifier|*
name|data
parameter_list|,
name|size_t
modifier|*
name|size
parameter_list|)
block|{
name|size_t
name|ret
init|=
literal|0
decl_stmt|;
name|size_t
name|l
decl_stmt|;
name|int
name|e
decl_stmt|;
block|{
name|unsigned
name|char
name|c
init|=
literal|0
decl_stmt|;
operator|*
name|p
operator|--
operator|=
name|c
expr_stmt|;
name|len
operator|--
expr_stmt|;
name|ret
operator|++
expr_stmt|;
name|c
operator|=
literal|0
expr_stmt|;
operator|*
name|p
operator|--
operator|=
name|c
expr_stmt|;
name|len
operator|--
expr_stmt|;
name|ret
operator|++
expr_stmt|;
name|c
operator|=
literal|0
expr_stmt|;
operator|*
name|p
operator|--
operator|=
name|c
expr_stmt|;
name|len
operator|--
expr_stmt|;
name|ret
operator|++
expr_stmt|;
name|c
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|data
operator|->
name|integFlag
condition|)
name|c
operator||=
literal|1
operator|<<
literal|1
expr_stmt|;
if|if
condition|(
name|data
operator|->
name|confFlag
condition|)
name|c
operator||=
literal|1
operator|<<
literal|2
expr_stmt|;
if|if
condition|(
name|data
operator|->
name|anonFlag
condition|)
name|c
operator||=
literal|1
operator|<<
literal|3
expr_stmt|;
if|if
condition|(
name|data
operator|->
name|sequenceFlag
condition|)
name|c
operator||=
literal|1
operator|<<
literal|4
expr_stmt|;
if|if
condition|(
name|data
operator|->
name|replayFlag
condition|)
name|c
operator||=
literal|1
operator|<<
literal|5
expr_stmt|;
if|if
condition|(
name|data
operator|->
name|mutualFlag
condition|)
name|c
operator||=
literal|1
operator|<<
literal|6
expr_stmt|;
if|if
condition|(
name|data
operator|->
name|delegFlag
condition|)
name|c
operator||=
literal|1
operator|<<
literal|7
expr_stmt|;
operator|*
name|p
operator|--
operator|=
name|c
expr_stmt|;
operator|*
name|p
operator|--
operator|=
literal|0
expr_stmt|;
name|len
operator|-=
literal|2
expr_stmt|;
name|ret
operator|+=
literal|2
expr_stmt|;
block|}
name|e
operator|=
name|der_put_length_and_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ret
argument_list|,
name|ASN1_C_UNIV
argument_list|,
name|PRIM
argument_list|,
name|UT_BitString
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
operator|*
name|size
operator|=
name|ret
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|decode_ContextFlags
parameter_list|(
specifier|const
name|unsigned
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|len
parameter_list|,
name|ContextFlags
modifier|*
name|data
parameter_list|,
name|size_t
modifier|*
name|size
parameter_list|)
block|{
name|size_t
name|ret
init|=
literal|0
decl_stmt|,
name|reallen
decl_stmt|;
name|size_t
name|l
decl_stmt|;
name|int
name|e
decl_stmt|;
name|memset
argument_list|(
name|data
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|data
argument_list|)
argument_list|)
expr_stmt|;
name|reallen
operator|=
literal|0
expr_stmt|;
name|e
operator|=
name|der_match_tag_and_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ASN1_C_UNIV
argument_list|,
name|PRIM
argument_list|,
name|UT_BitString
argument_list|,
operator|&
name|reallen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
if|if
condition|(
name|len
operator|<
name|reallen
condition|)
return|return
name|ASN1_OVERRUN
return|;
name|p
operator|++
expr_stmt|;
name|len
operator|--
expr_stmt|;
name|reallen
operator|--
expr_stmt|;
name|ret
operator|++
expr_stmt|;
name|data
operator|->
name|delegFlag
operator|=
operator|(
operator|*
name|p
operator|>>
literal|7
operator|)
operator|&
literal|1
expr_stmt|;
name|data
operator|->
name|mutualFlag
operator|=
operator|(
operator|*
name|p
operator|>>
literal|6
operator|)
operator|&
literal|1
expr_stmt|;
name|data
operator|->
name|replayFlag
operator|=
operator|(
operator|*
name|p
operator|>>
literal|5
operator|)
operator|&
literal|1
expr_stmt|;
name|data
operator|->
name|sequenceFlag
operator|=
operator|(
operator|*
name|p
operator|>>
literal|4
operator|)
operator|&
literal|1
expr_stmt|;
name|data
operator|->
name|anonFlag
operator|=
operator|(
operator|*
name|p
operator|>>
literal|3
operator|)
operator|&
literal|1
expr_stmt|;
name|data
operator|->
name|confFlag
operator|=
operator|(
operator|*
name|p
operator|>>
literal|2
operator|)
operator|&
literal|1
expr_stmt|;
name|data
operator|->
name|integFlag
operator|=
operator|(
operator|*
name|p
operator|>>
literal|1
operator|)
operator|&
literal|1
expr_stmt|;
name|ret
operator|+=
name|reallen
expr_stmt|;
if|if
condition|(
name|size
condition|)
operator|*
name|size
operator|=
name|ret
expr_stmt|;
return|return
literal|0
return|;
name|fail
label|:
name|free_ContextFlags
argument_list|(
name|data
argument_list|)
expr_stmt|;
return|return
name|e
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|free_ContextFlags
parameter_list|(
name|ContextFlags
modifier|*
name|data
parameter_list|)
block|{
operator|(
name|void
operator|)
name|data
expr_stmt|;
block|}
end_function

begin_comment
comment|/* unused function: length_ContextFlags */
end_comment

begin_comment
comment|/* unused function: copy_ContextFlags */
end_comment

begin_comment
comment|/* unused function: ContextFlags2int */
end_comment

begin_comment
comment|/* unused function: int2ContextFlags */
end_comment

begin_comment
comment|/* unused variable: ContextFlags_units */
end_comment

begin_comment
comment|/* unused function: asn1_ContextFlags_units */
end_comment

begin_comment
comment|/* Generated from spnego.asn1 */
end_comment

begin_comment
comment|/* Do not edit */
end_comment

begin_function
specifier|static
name|int
name|encode_NegTokenInit
parameter_list|(
name|unsigned
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|len
parameter_list|,
specifier|const
name|NegTokenInit
modifier|*
name|data
parameter_list|,
name|size_t
modifier|*
name|size
parameter_list|)
block|{
name|size_t
name|ret
init|=
literal|0
decl_stmt|;
name|size_t
name|l
decl_stmt|;
name|int
name|e
decl_stmt|;
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|mechListMIC
condition|)
block|{
name|size_t
name|oldret
init|=
name|ret
decl_stmt|;
name|ret
operator|=
literal|0
expr_stmt|;
name|e
operator|=
name|encode_octet_string
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|data
operator|)
operator|->
name|mechListMIC
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
name|e
operator|=
name|der_put_length_and_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ret
argument_list|,
name|ASN1_C_CONTEXT
argument_list|,
name|CONS
argument_list|,
literal|3
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
name|ret
operator|+=
name|oldret
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|mechToken
condition|)
block|{
name|size_t
name|oldret
init|=
name|ret
decl_stmt|;
name|ret
operator|=
literal|0
expr_stmt|;
name|e
operator|=
name|encode_octet_string
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|data
operator|)
operator|->
name|mechToken
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
name|e
operator|=
name|der_put_length_and_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ret
argument_list|,
name|ASN1_C_CONTEXT
argument_list|,
name|CONS
argument_list|,
literal|2
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
name|ret
operator|+=
name|oldret
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|reqFlags
condition|)
block|{
name|size_t
name|oldret
init|=
name|ret
decl_stmt|;
name|ret
operator|=
literal|0
expr_stmt|;
name|e
operator|=
name|encode_ContextFlags
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|data
operator|)
operator|->
name|reqFlags
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
name|e
operator|=
name|der_put_length_and_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ret
argument_list|,
name|ASN1_C_CONTEXT
argument_list|,
name|CONS
argument_list|,
literal|1
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
name|ret
operator|+=
name|oldret
expr_stmt|;
block|}
block|{
name|size_t
name|oldret
init|=
name|ret
decl_stmt|;
name|ret
operator|=
literal|0
expr_stmt|;
name|e
operator|=
name|encode_MechTypeList
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|&
operator|(
name|data
operator|)
operator|->
name|mechTypes
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
name|e
operator|=
name|der_put_length_and_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ret
argument_list|,
name|ASN1_C_CONTEXT
argument_list|,
name|CONS
argument_list|,
literal|0
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
name|ret
operator|+=
name|oldret
expr_stmt|;
block|}
name|e
operator|=
name|der_put_length_and_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ret
argument_list|,
name|ASN1_C_UNIV
argument_list|,
name|CONS
argument_list|,
name|UT_Sequence
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
operator|*
name|size
operator|=
name|ret
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|decode_NegTokenInit
parameter_list|(
specifier|const
name|unsigned
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|len
parameter_list|,
name|NegTokenInit
modifier|*
name|data
parameter_list|,
name|size_t
modifier|*
name|size
parameter_list|)
block|{
name|size_t
name|ret
init|=
literal|0
decl_stmt|,
name|reallen
decl_stmt|;
name|size_t
name|l
decl_stmt|;
name|int
name|e
decl_stmt|;
name|memset
argument_list|(
name|data
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|data
argument_list|)
argument_list|)
expr_stmt|;
name|reallen
operator|=
literal|0
expr_stmt|;
name|e
operator|=
name|der_match_tag_and_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ASN1_C_UNIV
argument_list|,
name|CONS
argument_list|,
name|UT_Sequence
argument_list|,
operator|&
name|reallen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|{
name|int
name|dce_fix
decl_stmt|;
if|if
condition|(
operator|(
name|dce_fix
operator|=
name|fix_dce
argument_list|(
name|reallen
argument_list|,
operator|&
name|len
argument_list|)
operator|)
operator|<
literal|0
condition|)
return|return
name|ASN1_BAD_FORMAT
return|;
block|{
name|size_t
name|newlen
decl_stmt|,
name|oldlen
decl_stmt|;
name|e
operator|=
name|der_match_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ASN1_C_CONTEXT
argument_list|,
name|CONS
argument_list|,
literal|0
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
if|if
condition|(
name|e
condition|)
return|return
name|e
return|;
else|else
block|{
name|p
operator|+=
name|l
expr_stmt|;
name|len
operator|-=
name|l
expr_stmt|;
name|ret
operator|+=
name|l
expr_stmt|;
name|e
operator|=
name|der_get_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|&
name|newlen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|{
name|int
name|mydce_fix
decl_stmt|;
name|oldlen
operator|=
name|len
expr_stmt|;
if|if
condition|(
operator|(
name|mydce_fix
operator|=
name|fix_dce
argument_list|(
name|newlen
argument_list|,
operator|&
name|len
argument_list|)
operator|)
operator|<
literal|0
condition|)
return|return
name|ASN1_BAD_FORMAT
return|;
name|e
operator|=
name|decode_MechTypeList
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|&
operator|(
name|data
operator|)
operator|->
name|mechTypes
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
if|if
condition|(
name|mydce_fix
condition|)
block|{
name|e
operator|=
name|der_match_tag_and_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|Der_class
operator|)
literal|0
argument_list|,
operator|(
name|Der_type
operator|)
literal|0
argument_list|,
literal|0
argument_list|,
operator|&
name|reallen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|}
else|else
name|len
operator|=
name|oldlen
operator|-
name|newlen
expr_stmt|;
block|}
block|}
block|}
block|{
name|size_t
name|newlen
decl_stmt|,
name|oldlen
decl_stmt|;
name|e
operator|=
name|der_match_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ASN1_C_CONTEXT
argument_list|,
name|CONS
argument_list|,
literal|1
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
if|if
condition|(
name|e
condition|)
operator|(
name|data
operator|)
operator|->
name|reqFlags
operator|=
name|NULL
expr_stmt|;
else|else
block|{
name|p
operator|+=
name|l
expr_stmt|;
name|len
operator|-=
name|l
expr_stmt|;
name|ret
operator|+=
name|l
expr_stmt|;
name|e
operator|=
name|der_get_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|&
name|newlen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|{
name|int
name|mydce_fix
decl_stmt|;
name|oldlen
operator|=
name|len
expr_stmt|;
if|if
condition|(
operator|(
name|mydce_fix
operator|=
name|fix_dce
argument_list|(
name|newlen
argument_list|,
operator|&
name|len
argument_list|)
operator|)
operator|<
literal|0
condition|)
return|return
name|ASN1_BAD_FORMAT
return|;
operator|(
name|data
operator|)
operator|->
name|reqFlags
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
operator|*
operator|(
name|data
operator|)
operator|->
name|reqFlags
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|reqFlags
operator|==
name|NULL
condition|)
return|return
name|ENOMEM
return|;
name|e
operator|=
name|decode_ContextFlags
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|data
operator|)
operator|->
name|reqFlags
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
if|if
condition|(
name|mydce_fix
condition|)
block|{
name|e
operator|=
name|der_match_tag_and_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|Der_class
operator|)
literal|0
argument_list|,
operator|(
name|Der_type
operator|)
literal|0
argument_list|,
literal|0
argument_list|,
operator|&
name|reallen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|}
else|else
name|len
operator|=
name|oldlen
operator|-
name|newlen
expr_stmt|;
block|}
block|}
block|}
block|{
name|size_t
name|newlen
decl_stmt|,
name|oldlen
decl_stmt|;
name|e
operator|=
name|der_match_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ASN1_C_CONTEXT
argument_list|,
name|CONS
argument_list|,
literal|2
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
if|if
condition|(
name|e
condition|)
operator|(
name|data
operator|)
operator|->
name|mechToken
operator|=
name|NULL
expr_stmt|;
else|else
block|{
name|p
operator|+=
name|l
expr_stmt|;
name|len
operator|-=
name|l
expr_stmt|;
name|ret
operator|+=
name|l
expr_stmt|;
name|e
operator|=
name|der_get_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|&
name|newlen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|{
name|int
name|mydce_fix
decl_stmt|;
name|oldlen
operator|=
name|len
expr_stmt|;
if|if
condition|(
operator|(
name|mydce_fix
operator|=
name|fix_dce
argument_list|(
name|newlen
argument_list|,
operator|&
name|len
argument_list|)
operator|)
operator|<
literal|0
condition|)
return|return
name|ASN1_BAD_FORMAT
return|;
operator|(
name|data
operator|)
operator|->
name|mechToken
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
operator|*
operator|(
name|data
operator|)
operator|->
name|mechToken
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|mechToken
operator|==
name|NULL
condition|)
return|return
name|ENOMEM
return|;
name|e
operator|=
name|decode_octet_string
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|data
operator|)
operator|->
name|mechToken
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
if|if
condition|(
name|mydce_fix
condition|)
block|{
name|e
operator|=
name|der_match_tag_and_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|Der_class
operator|)
literal|0
argument_list|,
operator|(
name|Der_type
operator|)
literal|0
argument_list|,
literal|0
argument_list|,
operator|&
name|reallen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|}
else|else
name|len
operator|=
name|oldlen
operator|-
name|newlen
expr_stmt|;
block|}
block|}
block|}
block|{
name|size_t
name|newlen
decl_stmt|,
name|oldlen
decl_stmt|;
name|e
operator|=
name|der_match_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ASN1_C_CONTEXT
argument_list|,
name|CONS
argument_list|,
literal|3
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
if|if
condition|(
name|e
condition|)
operator|(
name|data
operator|)
operator|->
name|mechListMIC
operator|=
name|NULL
expr_stmt|;
else|else
block|{
name|p
operator|+=
name|l
expr_stmt|;
name|len
operator|-=
name|l
expr_stmt|;
name|ret
operator|+=
name|l
expr_stmt|;
name|e
operator|=
name|der_get_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|&
name|newlen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|{
name|int
name|mydce_fix
decl_stmt|;
name|oldlen
operator|=
name|len
expr_stmt|;
if|if
condition|(
operator|(
name|mydce_fix
operator|=
name|fix_dce
argument_list|(
name|newlen
argument_list|,
operator|&
name|len
argument_list|)
operator|)
operator|<
literal|0
condition|)
return|return
name|ASN1_BAD_FORMAT
return|;
operator|(
name|data
operator|)
operator|->
name|mechListMIC
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
operator|*
operator|(
name|data
operator|)
operator|->
name|mechListMIC
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|mechListMIC
operator|==
name|NULL
condition|)
return|return
name|ENOMEM
return|;
name|e
operator|=
name|decode_octet_string
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|data
operator|)
operator|->
name|mechListMIC
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
if|if
condition|(
name|mydce_fix
condition|)
block|{
name|e
operator|=
name|der_match_tag_and_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|Der_class
operator|)
literal|0
argument_list|,
operator|(
name|Der_type
operator|)
literal|0
argument_list|,
literal|0
argument_list|,
operator|&
name|reallen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|}
else|else
name|len
operator|=
name|oldlen
operator|-
name|newlen
expr_stmt|;
block|}
block|}
block|}
if|if
condition|(
name|dce_fix
condition|)
block|{
name|e
operator|=
name|der_match_tag_and_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|Der_class
operator|)
literal|0
argument_list|,
operator|(
name|Der_type
operator|)
literal|0
argument_list|,
literal|0
argument_list|,
operator|&
name|reallen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|}
block|}
if|if
condition|(
name|size
condition|)
operator|*
name|size
operator|=
name|ret
expr_stmt|;
return|return
literal|0
return|;
name|fail
label|:
name|free_NegTokenInit
argument_list|(
name|data
argument_list|)
expr_stmt|;
return|return
name|e
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|free_NegTokenInit
parameter_list|(
name|NegTokenInit
modifier|*
name|data
parameter_list|)
block|{
name|free_MechTypeList
argument_list|(
operator|&
operator|(
name|data
operator|)
operator|->
name|mechTypes
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|reqFlags
condition|)
block|{
name|free_ContextFlags
argument_list|(
operator|(
name|data
operator|)
operator|->
name|reqFlags
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|data
operator|)
operator|->
name|reqFlags
argument_list|)
expr_stmt|;
operator|(
name|data
operator|)
operator|->
name|reqFlags
operator|=
name|NULL
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|mechToken
condition|)
block|{
name|free_octet_string
argument_list|(
operator|(
name|data
operator|)
operator|->
name|mechToken
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|data
operator|)
operator|->
name|mechToken
argument_list|)
expr_stmt|;
operator|(
name|data
operator|)
operator|->
name|mechToken
operator|=
name|NULL
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|mechListMIC
condition|)
block|{
name|free_octet_string
argument_list|(
operator|(
name|data
operator|)
operator|->
name|mechListMIC
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|data
operator|)
operator|->
name|mechListMIC
argument_list|)
expr_stmt|;
operator|(
name|data
operator|)
operator|->
name|mechListMIC
operator|=
name|NULL
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* unused function: length_NegTokenInit */
end_comment

begin_comment
comment|/* unused function: copy_NegTokenInit */
end_comment

begin_comment
comment|/* Generated from spnego.asn1 */
end_comment

begin_comment
comment|/* Do not edit */
end_comment

begin_function
specifier|static
name|int
name|encode_NegTokenResp
parameter_list|(
name|unsigned
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|len
parameter_list|,
specifier|const
name|NegTokenResp
modifier|*
name|data
parameter_list|,
name|size_t
modifier|*
name|size
parameter_list|)
block|{
name|size_t
name|ret
init|=
literal|0
decl_stmt|;
name|size_t
name|l
decl_stmt|;
name|int
name|e
decl_stmt|;
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|mechListMIC
condition|)
block|{
name|size_t
name|oldret
init|=
name|ret
decl_stmt|;
name|ret
operator|=
literal|0
expr_stmt|;
name|e
operator|=
name|encode_octet_string
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|data
operator|)
operator|->
name|mechListMIC
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
name|e
operator|=
name|der_put_length_and_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ret
argument_list|,
name|ASN1_C_CONTEXT
argument_list|,
name|CONS
argument_list|,
literal|3
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
name|ret
operator|+=
name|oldret
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|responseToken
condition|)
block|{
name|size_t
name|oldret
init|=
name|ret
decl_stmt|;
name|ret
operator|=
literal|0
expr_stmt|;
name|e
operator|=
name|encode_octet_string
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|data
operator|)
operator|->
name|responseToken
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
name|e
operator|=
name|der_put_length_and_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ret
argument_list|,
name|ASN1_C_CONTEXT
argument_list|,
name|CONS
argument_list|,
literal|2
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
name|ret
operator|+=
name|oldret
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|supportedMech
condition|)
block|{
name|size_t
name|oldret
init|=
name|ret
decl_stmt|;
name|ret
operator|=
literal|0
expr_stmt|;
name|e
operator|=
name|encode_MechType
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|data
operator|)
operator|->
name|supportedMech
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
name|e
operator|=
name|der_put_length_and_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ret
argument_list|,
name|ASN1_C_CONTEXT
argument_list|,
name|CONS
argument_list|,
literal|1
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
name|ret
operator|+=
name|oldret
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|negState
condition|)
block|{
name|size_t
name|oldret
init|=
name|ret
decl_stmt|;
name|ret
operator|=
literal|0
expr_stmt|;
name|e
operator|=
name|encode_enumerated
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|data
operator|)
operator|->
name|negState
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
name|e
operator|=
name|der_put_length_and_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ret
argument_list|,
name|ASN1_C_CONTEXT
argument_list|,
name|CONS
argument_list|,
literal|0
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
name|ret
operator|+=
name|oldret
expr_stmt|;
block|}
name|e
operator|=
name|der_put_length_and_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ret
argument_list|,
name|ASN1_C_UNIV
argument_list|,
name|CONS
argument_list|,
name|UT_Sequence
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|BACK
expr_stmt|;
operator|*
name|size
operator|=
name|ret
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|decode_NegTokenResp
parameter_list|(
specifier|const
name|unsigned
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|len
parameter_list|,
name|NegTokenResp
modifier|*
name|data
parameter_list|,
name|size_t
modifier|*
name|size
parameter_list|)
block|{
name|size_t
name|ret
init|=
literal|0
decl_stmt|,
name|reallen
decl_stmt|;
name|size_t
name|l
decl_stmt|;
name|int
name|e
decl_stmt|;
name|memset
argument_list|(
name|data
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|data
argument_list|)
argument_list|)
expr_stmt|;
name|reallen
operator|=
literal|0
expr_stmt|;
name|e
operator|=
name|der_match_tag_and_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ASN1_C_UNIV
argument_list|,
name|CONS
argument_list|,
name|UT_Sequence
argument_list|,
operator|&
name|reallen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|{
name|int
name|dce_fix
decl_stmt|;
if|if
condition|(
operator|(
name|dce_fix
operator|=
name|fix_dce
argument_list|(
name|reallen
argument_list|,
operator|&
name|len
argument_list|)
operator|)
operator|<
literal|0
condition|)
return|return
name|ASN1_BAD_FORMAT
return|;
block|{
name|size_t
name|newlen
decl_stmt|,
name|oldlen
decl_stmt|;
name|e
operator|=
name|der_match_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ASN1_C_CONTEXT
argument_list|,
name|CONS
argument_list|,
literal|0
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
if|if
condition|(
name|e
condition|)
operator|(
name|data
operator|)
operator|->
name|negState
operator|=
name|NULL
expr_stmt|;
else|else
block|{
name|p
operator|+=
name|l
expr_stmt|;
name|len
operator|-=
name|l
expr_stmt|;
name|ret
operator|+=
name|l
expr_stmt|;
name|e
operator|=
name|der_get_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|&
name|newlen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|{
name|int
name|mydce_fix
decl_stmt|;
name|oldlen
operator|=
name|len
expr_stmt|;
if|if
condition|(
operator|(
name|mydce_fix
operator|=
name|fix_dce
argument_list|(
name|newlen
argument_list|,
operator|&
name|len
argument_list|)
operator|)
operator|<
literal|0
condition|)
return|return
name|ASN1_BAD_FORMAT
return|;
operator|(
name|data
operator|)
operator|->
name|negState
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
operator|*
operator|(
name|data
operator|)
operator|->
name|negState
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|negState
operator|==
name|NULL
condition|)
return|return
name|ENOMEM
return|;
name|e
operator|=
name|decode_enumerated
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|data
operator|)
operator|->
name|negState
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
if|if
condition|(
name|mydce_fix
condition|)
block|{
name|e
operator|=
name|der_match_tag_and_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|Der_class
operator|)
literal|0
argument_list|,
operator|(
name|Der_type
operator|)
literal|0
argument_list|,
literal|0
argument_list|,
operator|&
name|reallen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|}
else|else
name|len
operator|=
name|oldlen
operator|-
name|newlen
expr_stmt|;
block|}
block|}
block|}
block|{
name|size_t
name|newlen
decl_stmt|,
name|oldlen
decl_stmt|;
name|e
operator|=
name|der_match_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ASN1_C_CONTEXT
argument_list|,
name|CONS
argument_list|,
literal|1
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
if|if
condition|(
name|e
condition|)
operator|(
name|data
operator|)
operator|->
name|supportedMech
operator|=
name|NULL
expr_stmt|;
else|else
block|{
name|p
operator|+=
name|l
expr_stmt|;
name|len
operator|-=
name|l
expr_stmt|;
name|ret
operator|+=
name|l
expr_stmt|;
name|e
operator|=
name|der_get_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|&
name|newlen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|{
name|int
name|mydce_fix
decl_stmt|;
name|oldlen
operator|=
name|len
expr_stmt|;
if|if
condition|(
operator|(
name|mydce_fix
operator|=
name|fix_dce
argument_list|(
name|newlen
argument_list|,
operator|&
name|len
argument_list|)
operator|)
operator|<
literal|0
condition|)
return|return
name|ASN1_BAD_FORMAT
return|;
operator|(
name|data
operator|)
operator|->
name|supportedMech
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
operator|*
operator|(
name|data
operator|)
operator|->
name|supportedMech
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|supportedMech
operator|==
name|NULL
condition|)
return|return
name|ENOMEM
return|;
name|e
operator|=
name|decode_MechType
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|data
operator|)
operator|->
name|supportedMech
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
if|if
condition|(
name|mydce_fix
condition|)
block|{
name|e
operator|=
name|der_match_tag_and_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|Der_class
operator|)
literal|0
argument_list|,
operator|(
name|Der_type
operator|)
literal|0
argument_list|,
literal|0
argument_list|,
operator|&
name|reallen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|}
else|else
name|len
operator|=
name|oldlen
operator|-
name|newlen
expr_stmt|;
block|}
block|}
block|}
block|{
name|size_t
name|newlen
decl_stmt|,
name|oldlen
decl_stmt|;
name|e
operator|=
name|der_match_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ASN1_C_CONTEXT
argument_list|,
name|CONS
argument_list|,
literal|2
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
if|if
condition|(
name|e
condition|)
operator|(
name|data
operator|)
operator|->
name|responseToken
operator|=
name|NULL
expr_stmt|;
else|else
block|{
name|p
operator|+=
name|l
expr_stmt|;
name|len
operator|-=
name|l
expr_stmt|;
name|ret
operator|+=
name|l
expr_stmt|;
name|e
operator|=
name|der_get_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|&
name|newlen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|{
name|int
name|mydce_fix
decl_stmt|;
name|oldlen
operator|=
name|len
expr_stmt|;
if|if
condition|(
operator|(
name|mydce_fix
operator|=
name|fix_dce
argument_list|(
name|newlen
argument_list|,
operator|&
name|len
argument_list|)
operator|)
operator|<
literal|0
condition|)
return|return
name|ASN1_BAD_FORMAT
return|;
operator|(
name|data
operator|)
operator|->
name|responseToken
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
operator|*
operator|(
name|data
operator|)
operator|->
name|responseToken
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|responseToken
operator|==
name|NULL
condition|)
return|return
name|ENOMEM
return|;
name|e
operator|=
name|decode_octet_string
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|data
operator|)
operator|->
name|responseToken
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
if|if
condition|(
name|mydce_fix
condition|)
block|{
name|e
operator|=
name|der_match_tag_and_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|Der_class
operator|)
literal|0
argument_list|,
operator|(
name|Der_type
operator|)
literal|0
argument_list|,
literal|0
argument_list|,
operator|&
name|reallen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|}
else|else
name|len
operator|=
name|oldlen
operator|-
name|newlen
expr_stmt|;
block|}
block|}
block|}
block|{
name|size_t
name|newlen
decl_stmt|,
name|oldlen
decl_stmt|;
name|e
operator|=
name|der_match_tag
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
name|ASN1_C_CONTEXT
argument_list|,
name|CONS
argument_list|,
literal|3
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
if|if
condition|(
name|e
condition|)
operator|(
name|data
operator|)
operator|->
name|mechListMIC
operator|=
name|NULL
expr_stmt|;
else|else
block|{
name|p
operator|+=
name|l
expr_stmt|;
name|len
operator|-=
name|l
expr_stmt|;
name|ret
operator|+=
name|l
expr_stmt|;
name|e
operator|=
name|der_get_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|&
name|newlen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|{
name|int
name|mydce_fix
decl_stmt|;
name|oldlen
operator|=
name|len
expr_stmt|;
if|if
condition|(
operator|(
name|mydce_fix
operator|=
name|fix_dce
argument_list|(
name|newlen
argument_list|,
operator|&
name|len
argument_list|)
operator|)
operator|<
literal|0
condition|)
return|return
name|ASN1_BAD_FORMAT
return|;
operator|(
name|data
operator|)
operator|->
name|mechListMIC
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
operator|*
operator|(
name|data
operator|)
operator|->
name|mechListMIC
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|mechListMIC
operator|==
name|NULL
condition|)
return|return
name|ENOMEM
return|;
name|e
operator|=
name|decode_octet_string
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|data
operator|)
operator|->
name|mechListMIC
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
if|if
condition|(
name|mydce_fix
condition|)
block|{
name|e
operator|=
name|der_match_tag_and_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|Der_class
operator|)
literal|0
argument_list|,
operator|(
name|Der_type
operator|)
literal|0
argument_list|,
literal|0
argument_list|,
operator|&
name|reallen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|}
else|else
name|len
operator|=
name|oldlen
operator|-
name|newlen
expr_stmt|;
block|}
block|}
block|}
if|if
condition|(
name|dce_fix
condition|)
block|{
name|e
operator|=
name|der_match_tag_and_length
argument_list|(
name|p
argument_list|,
name|len
argument_list|,
operator|(
name|Der_class
operator|)
literal|0
argument_list|,
operator|(
name|Der_type
operator|)
literal|0
argument_list|,
literal|0
argument_list|,
operator|&
name|reallen
argument_list|,
operator|&
name|l
argument_list|)
expr_stmt|;
name|FORW
expr_stmt|;
block|}
block|}
if|if
condition|(
name|size
condition|)
operator|*
name|size
operator|=
name|ret
expr_stmt|;
return|return
literal|0
return|;
name|fail
label|:
name|free_NegTokenResp
argument_list|(
name|data
argument_list|)
expr_stmt|;
return|return
name|e
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|free_NegTokenResp
parameter_list|(
name|NegTokenResp
modifier|*
name|data
parameter_list|)
block|{
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|negState
condition|)
block|{
name|free
argument_list|(
operator|(
name|data
operator|)
operator|->
name|negState
argument_list|)
expr_stmt|;
operator|(
name|data
operator|)
operator|->
name|negState
operator|=
name|NULL
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|supportedMech
condition|)
block|{
name|free_MechType
argument_list|(
operator|(
name|data
operator|)
operator|->
name|supportedMech
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|data
operator|)
operator|->
name|supportedMech
argument_list|)
expr_stmt|;
operator|(
name|data
operator|)
operator|->
name|supportedMech
operator|=
name|NULL
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|responseToken
condition|)
block|{
name|free_octet_string
argument_list|(
operator|(
name|data
operator|)
operator|->
name|responseToken
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|data
operator|)
operator|->
name|responseToken
argument_list|)
expr_stmt|;
operator|(
name|data
operator|)
operator|->
name|responseToken
operator|=
name|NULL
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|data
operator|)
operator|->
name|mechListMIC
condition|)
block|{
name|free_octet_string
argument_list|(
operator|(
name|data
operator|)
operator|->
name|mechListMIC
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|data
operator|)
operator|->
name|mechListMIC
argument_list|)
expr_stmt|;
operator|(
name|data
operator|)
operator|->
name|mechListMIC
operator|=
name|NULL
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* unused function: length_NegTokenResp */
end_comment

begin_comment
comment|/* unused function: copy_NegTokenResp */
end_comment

begin_comment
comment|/* Generated from spnego.asn1 */
end_comment

begin_comment
comment|/* Do not edit */
end_comment

begin_comment
comment|/* CHOICE */
end_comment

begin_comment
comment|/* unused variable: asn1_NegotiationToken_dummy_holder */
end_comment

end_unit

