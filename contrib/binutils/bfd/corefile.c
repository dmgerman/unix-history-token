begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* Core file generic interface routines for BFD.    Copyright 1990, 1991, 1992, 1993, 1994, 2000, 2001    Free Software Foundation, Inc.    Written by Cygnus Support.  This file is part of BFD, the Binary File Descriptor library.  This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_comment
comment|/* SECTION 	Core files  DESCRIPTION 	These are functions pertaining to core files. */
end_comment

begin_include
include|#
directive|include
file|"bfd.h"
end_include

begin_include
include|#
directive|include
file|"sysdep.h"
end_include

begin_include
include|#
directive|include
file|"libbfd.h"
end_include

begin_comment
comment|/* FUNCTION 	bfd_core_file_failing_command  SYNOPSIS 	const char *bfd_core_file_failing_command(bfd *abfd);  DESCRIPTION 	Return a read-only string explaining which program was running 	when it failed and produced the core file @var{abfd}.  */
end_comment

begin_function
name|CONST
name|char
modifier|*
name|bfd_core_file_failing_command
parameter_list|(
name|abfd
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
block|{
if|if
condition|(
name|abfd
operator|->
name|format
operator|!=
name|bfd_core
condition|)
block|{
name|bfd_set_error
argument_list|(
name|bfd_error_invalid_operation
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
return|return
name|BFD_SEND
argument_list|(
name|abfd
argument_list|,
name|_core_file_failing_command
argument_list|,
operator|(
name|abfd
operator|)
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/* FUNCTION 	bfd_core_file_failing_signal  SYNOPSIS 	int bfd_core_file_failing_signal(bfd *abfd);  DESCRIPTION 	Returns the signal number which caused the core dump which 	generated the file the BFD @var{abfd} is attached to. */
end_comment

begin_function
name|int
name|bfd_core_file_failing_signal
parameter_list|(
name|abfd
parameter_list|)
name|bfd
modifier|*
name|abfd
decl_stmt|;
block|{
if|if
condition|(
name|abfd
operator|->
name|format
operator|!=
name|bfd_core
condition|)
block|{
name|bfd_set_error
argument_list|(
name|bfd_error_invalid_operation
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
return|return
name|BFD_SEND
argument_list|(
name|abfd
argument_list|,
name|_core_file_failing_signal
argument_list|,
operator|(
name|abfd
operator|)
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/* FUNCTION 	core_file_matches_executable_p  SYNOPSIS 	boolean core_file_matches_executable_p 		(bfd *core_bfd, bfd *exec_bfd);  DESCRIPTION 	Return<<true>> if the core file attached to @var{core_bfd} 	was generated by a run of the executable file attached to 	@var{exec_bfd},<<false>> otherwise. */
end_comment

begin_function
name|boolean
name|core_file_matches_executable_p
parameter_list|(
name|core_bfd
parameter_list|,
name|exec_bfd
parameter_list|)
name|bfd
modifier|*
name|core_bfd
decl_stmt|,
decl|*
name|exec_bfd
decl_stmt|;
end_function

begin_block
block|{
if|if
condition|(
operator|(
name|core_bfd
operator|->
name|format
operator|!=
name|bfd_core
operator|)
operator|||
operator|(
name|exec_bfd
operator|->
name|format
operator|!=
name|bfd_object
operator|)
condition|)
block|{
name|bfd_set_error
argument_list|(
name|bfd_error_wrong_format
argument_list|)
expr_stmt|;
return|return
name|false
return|;
block|}
return|return
name|BFD_SEND
argument_list|(
name|core_bfd
argument_list|,
name|_core_file_matches_executable_p
argument_list|,
operator|(
name|core_bfd
operator|,
name|exec_bfd
operator|)
argument_list|)
return|;
block|}
end_block

end_unit

