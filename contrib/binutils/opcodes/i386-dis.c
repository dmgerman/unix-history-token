begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* Print i386 instructions for GDB, the GNU debugger.    Copyright (C) 1988, 89, 91, 93, 94, 95, 96, 1997    Free Software Foundation, Inc.  This file is part of GDB.  This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_comment
comment|/*  * 80386 instruction printer by Pace Willisson (pace@prep.ai.mit.edu)  * July 1988  *  modified by John Hassey (hassey@dg-rtp.dg.com)  */
end_comment

begin_comment
comment|/*  * The main tables describing the instructions is essentially a copy  * of the "Opcode Map" chapter (Appendix A) of the Intel 80386  * Programmers Manual.  Usually, there is a capital letter, followed  * by a small letter.  The capital letter tell the addressing mode,  * and the small letter tells about the operand size.  Refer to   * the Intel manual for details.  */
end_comment

begin_include
include|#
directive|include
file|"dis-asm.h"
end_include

begin_include
include|#
directive|include
file|"sysdep.h"
end_include

begin_define
define|#
directive|define
name|MAXLEN
value|20
end_define

begin_include
include|#
directive|include
file|<setjmp.h>
end_include

begin_decl_stmt
specifier|static
name|int
name|fetch_data
name|PARAMS
argument_list|(
operator|(
expr|struct
name|disassemble_info
operator|*
operator|,
name|bfd_byte
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_struct
struct|struct
name|dis_private
block|{
comment|/* Points to first byte not fetched.  */
name|bfd_byte
modifier|*
name|max_fetched
decl_stmt|;
name|bfd_byte
name|the_buffer
index|[
name|MAXLEN
index|]
decl_stmt|;
name|bfd_vma
name|insn_start
decl_stmt|;
name|jmp_buf
name|bailout
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/* Make sure that bytes from INFO->PRIVATE_DATA->BUFFER (inclusive)    to ADDR (exclusive) are valid.  Returns 1 for success, longjmps    on error.  */
end_comment

begin_define
define|#
directive|define
name|FETCH_DATA
parameter_list|(
name|info
parameter_list|,
name|addr
parameter_list|)
define|\
value|((addr)<= ((struct dis_private *)(info->private_data))->max_fetched \    ? 1 : fetch_data ((info), (addr)))
end_define

begin_function
specifier|static
name|int
name|fetch_data
parameter_list|(
name|info
parameter_list|,
name|addr
parameter_list|)
name|struct
name|disassemble_info
modifier|*
name|info
decl_stmt|;
name|bfd_byte
modifier|*
name|addr
decl_stmt|;
block|{
name|int
name|status
decl_stmt|;
name|struct
name|dis_private
modifier|*
name|priv
init|=
operator|(
expr|struct
name|dis_private
operator|*
operator|)
name|info
operator|->
name|private_data
decl_stmt|;
name|bfd_vma
name|start
init|=
name|priv
operator|->
name|insn_start
operator|+
operator|(
name|priv
operator|->
name|max_fetched
operator|-
name|priv
operator|->
name|the_buffer
operator|)
decl_stmt|;
name|status
operator|=
call|(
modifier|*
name|info
operator|->
name|read_memory_func
call|)
argument_list|(
name|start
argument_list|,
name|priv
operator|->
name|max_fetched
argument_list|,
name|addr
operator|-
name|priv
operator|->
name|max_fetched
argument_list|,
name|info
argument_list|)
expr_stmt|;
if|if
condition|(
name|status
operator|!=
literal|0
condition|)
block|{
call|(
modifier|*
name|info
operator|->
name|memory_error_func
call|)
argument_list|(
name|status
argument_list|,
name|start
argument_list|,
name|info
argument_list|)
expr_stmt|;
name|longjmp
argument_list|(
name|priv
operator|->
name|bailout
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
name|priv
operator|->
name|max_fetched
operator|=
name|addr
expr_stmt|;
return|return
literal|1
return|;
block|}
end_function

begin_define
define|#
directive|define
name|Eb
value|OP_E, b_mode
end_define

begin_define
define|#
directive|define
name|indirEb
value|OP_indirE, b_mode
end_define

begin_define
define|#
directive|define
name|Gb
value|OP_G, b_mode
end_define

begin_define
define|#
directive|define
name|Ev
value|OP_E, v_mode
end_define

begin_define
define|#
directive|define
name|indirEv
value|OP_indirE, v_mode
end_define

begin_define
define|#
directive|define
name|Ew
value|OP_E, w_mode
end_define

begin_define
define|#
directive|define
name|Ma
value|OP_E, v_mode
end_define

begin_define
define|#
directive|define
name|M
value|OP_E, 0
end_define

begin_define
define|#
directive|define
name|Mp
value|OP_E, 0
end_define

begin_comment
comment|/* ? */
end_comment

begin_define
define|#
directive|define
name|Gv
value|OP_G, v_mode
end_define

begin_define
define|#
directive|define
name|Gw
value|OP_G, w_mode
end_define

begin_define
define|#
directive|define
name|Rw
value|OP_rm, w_mode
end_define

begin_define
define|#
directive|define
name|Rd
value|OP_rm, d_mode
end_define

begin_define
define|#
directive|define
name|Ib
value|OP_I, b_mode
end_define

begin_define
define|#
directive|define
name|sIb
value|OP_sI, b_mode
end_define

begin_comment
comment|/* sign extened byte */
end_comment

begin_define
define|#
directive|define
name|Iv
value|OP_I, v_mode
end_define

begin_define
define|#
directive|define
name|Iw
value|OP_I, w_mode
end_define

begin_define
define|#
directive|define
name|Jb
value|OP_J, b_mode
end_define

begin_define
define|#
directive|define
name|Jv
value|OP_J, v_mode
end_define

begin_if
if|#
directive|if
literal|0
end_if

begin_define
define|#
directive|define
name|ONE
value|OP_ONE, 0
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_define
define|#
directive|define
name|Cd
value|OP_C, d_mode
end_define

begin_define
define|#
directive|define
name|Dd
value|OP_D, d_mode
end_define

begin_define
define|#
directive|define
name|Td
value|OP_T, d_mode
end_define

begin_define
define|#
directive|define
name|eAX
value|OP_REG, eAX_reg
end_define

begin_define
define|#
directive|define
name|eBX
value|OP_REG, eBX_reg
end_define

begin_define
define|#
directive|define
name|eCX
value|OP_REG, eCX_reg
end_define

begin_define
define|#
directive|define
name|eDX
value|OP_REG, eDX_reg
end_define

begin_define
define|#
directive|define
name|eSP
value|OP_REG, eSP_reg
end_define

begin_define
define|#
directive|define
name|eBP
value|OP_REG, eBP_reg
end_define

begin_define
define|#
directive|define
name|eSI
value|OP_REG, eSI_reg
end_define

begin_define
define|#
directive|define
name|eDI
value|OP_REG, eDI_reg
end_define

begin_define
define|#
directive|define
name|AL
value|OP_REG, al_reg
end_define

begin_define
define|#
directive|define
name|CL
value|OP_REG, cl_reg
end_define

begin_define
define|#
directive|define
name|DL
value|OP_REG, dl_reg
end_define

begin_define
define|#
directive|define
name|BL
value|OP_REG, bl_reg
end_define

begin_define
define|#
directive|define
name|AH
value|OP_REG, ah_reg
end_define

begin_define
define|#
directive|define
name|CH
value|OP_REG, ch_reg
end_define

begin_define
define|#
directive|define
name|DH
value|OP_REG, dh_reg
end_define

begin_define
define|#
directive|define
name|BH
value|OP_REG, bh_reg
end_define

begin_define
define|#
directive|define
name|AX
value|OP_REG, ax_reg
end_define

begin_define
define|#
directive|define
name|DX
value|OP_REG, dx_reg
end_define

begin_define
define|#
directive|define
name|indirDX
value|OP_REG, indir_dx_reg
end_define

begin_define
define|#
directive|define
name|Sw
value|OP_SEG, w_mode
end_define

begin_define
define|#
directive|define
name|Ap
value|OP_DIR, lptr
end_define

begin_define
define|#
directive|define
name|Av
value|OP_DIR, v_mode
end_define

begin_define
define|#
directive|define
name|Ob
value|OP_OFF, b_mode
end_define

begin_define
define|#
directive|define
name|Ov
value|OP_OFF, v_mode
end_define

begin_define
define|#
directive|define
name|Xb
value|OP_DSSI, b_mode
end_define

begin_define
define|#
directive|define
name|Xv
value|OP_DSSI, v_mode
end_define

begin_define
define|#
directive|define
name|Yb
value|OP_ESDI, b_mode
end_define

begin_define
define|#
directive|define
name|Yv
value|OP_ESDI, v_mode
end_define

begin_define
define|#
directive|define
name|es
value|OP_REG, es_reg
end_define

begin_define
define|#
directive|define
name|ss
value|OP_REG, ss_reg
end_define

begin_define
define|#
directive|define
name|cs
value|OP_REG, cs_reg
end_define

begin_define
define|#
directive|define
name|ds
value|OP_REG, ds_reg
end_define

begin_define
define|#
directive|define
name|fs
value|OP_REG, fs_reg
end_define

begin_define
define|#
directive|define
name|gs
value|OP_REG, gs_reg
end_define

begin_define
define|#
directive|define
name|MX
value|OP_MMX, 0
end_define

begin_define
define|#
directive|define
name|EM
value|OP_EM, v_mode
end_define

begin_define
define|#
directive|define
name|MS
value|OP_MS, b_mode
end_define

begin_typedef
typedef|typedef
name|int
argument_list|(
argument|*op_rtn
argument_list|)
name|PARAMS
argument_list|(
operator|(
name|int
name|bytemode
operator|,
name|int
name|aflag
operator|,
name|int
name|dflag
operator|)
argument_list|)
expr_stmt|;
end_typedef

begin_decl_stmt
specifier|static
name|int
name|OP_E
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_G
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_I
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_indirE
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_sI
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_REG
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_J
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_DIR
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_OFF
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_ESDI
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_DSSI
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_SEG
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_C
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_D
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_T
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_rm
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_ST
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_STi
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_if
if|#
directive|if
literal|0
end_if

begin_endif
unit|static int OP_ONE PARAMS ((int, int, int));
endif|#
directive|endif
end_endif

begin_decl_stmt
specifier|static
name|int
name|OP_MMX
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_EM
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|OP_MS
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|append_prefix
name|PARAMS
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|set_op
name|PARAMS
argument_list|(
operator|(
name|int
name|op
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|putop
name|PARAMS
argument_list|(
operator|(
name|char
operator|*
name|template
operator|,
name|int
name|aflag
operator|,
name|int
name|dflag
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|dofloat
name|PARAMS
argument_list|(
operator|(
name|int
name|aflag
operator|,
name|int
name|dflag
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|get16
name|PARAMS
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|get32
name|PARAMS
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ckprefix
name|PARAMS
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|b_mode
value|1
end_define

begin_define
define|#
directive|define
name|v_mode
value|2
end_define

begin_define
define|#
directive|define
name|w_mode
value|3
end_define

begin_define
define|#
directive|define
name|d_mode
value|4
end_define

begin_define
define|#
directive|define
name|es_reg
value|100
end_define

begin_define
define|#
directive|define
name|cs_reg
value|101
end_define

begin_define
define|#
directive|define
name|ss_reg
value|102
end_define

begin_define
define|#
directive|define
name|ds_reg
value|103
end_define

begin_define
define|#
directive|define
name|fs_reg
value|104
end_define

begin_define
define|#
directive|define
name|gs_reg
value|105
end_define

begin_define
define|#
directive|define
name|eAX_reg
value|107
end_define

begin_define
define|#
directive|define
name|eCX_reg
value|108
end_define

begin_define
define|#
directive|define
name|eDX_reg
value|109
end_define

begin_define
define|#
directive|define
name|eBX_reg
value|110
end_define

begin_define
define|#
directive|define
name|eSP_reg
value|111
end_define

begin_define
define|#
directive|define
name|eBP_reg
value|112
end_define

begin_define
define|#
directive|define
name|eSI_reg
value|113
end_define

begin_define
define|#
directive|define
name|eDI_reg
value|114
end_define

begin_define
define|#
directive|define
name|lptr
value|115
end_define

begin_define
define|#
directive|define
name|al_reg
value|116
end_define

begin_define
define|#
directive|define
name|cl_reg
value|117
end_define

begin_define
define|#
directive|define
name|dl_reg
value|118
end_define

begin_define
define|#
directive|define
name|bl_reg
value|119
end_define

begin_define
define|#
directive|define
name|ah_reg
value|120
end_define

begin_define
define|#
directive|define
name|ch_reg
value|121
end_define

begin_define
define|#
directive|define
name|dh_reg
value|122
end_define

begin_define
define|#
directive|define
name|bh_reg
value|123
end_define

begin_define
define|#
directive|define
name|ax_reg
value|124
end_define

begin_define
define|#
directive|define
name|cx_reg
value|125
end_define

begin_define
define|#
directive|define
name|dx_reg
value|126
end_define

begin_define
define|#
directive|define
name|bx_reg
value|127
end_define

begin_define
define|#
directive|define
name|sp_reg
value|128
end_define

begin_define
define|#
directive|define
name|bp_reg
value|129
end_define

begin_define
define|#
directive|define
name|si_reg
value|130
end_define

begin_define
define|#
directive|define
name|di_reg
value|131
end_define

begin_define
define|#
directive|define
name|indir_dx_reg
value|150
end_define

begin_define
define|#
directive|define
name|GRP1b
value|NULL, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP1S
value|NULL, NULL, 1
end_define

begin_define
define|#
directive|define
name|GRP1Ss
value|NULL, NULL, 2
end_define

begin_define
define|#
directive|define
name|GRP2b
value|NULL, NULL, 3
end_define

begin_define
define|#
directive|define
name|GRP2S
value|NULL, NULL, 4
end_define

begin_define
define|#
directive|define
name|GRP2b_one
value|NULL, NULL, 5
end_define

begin_define
define|#
directive|define
name|GRP2S_one
value|NULL, NULL, 6
end_define

begin_define
define|#
directive|define
name|GRP2b_cl
value|NULL, NULL, 7
end_define

begin_define
define|#
directive|define
name|GRP2S_cl
value|NULL, NULL, 8
end_define

begin_define
define|#
directive|define
name|GRP3b
value|NULL, NULL, 9
end_define

begin_define
define|#
directive|define
name|GRP3S
value|NULL, NULL, 10
end_define

begin_define
define|#
directive|define
name|GRP4
value|NULL, NULL, 11
end_define

begin_define
define|#
directive|define
name|GRP5
value|NULL, NULL, 12
end_define

begin_define
define|#
directive|define
name|GRP6
value|NULL, NULL, 13
end_define

begin_define
define|#
directive|define
name|GRP7
value|NULL, NULL, 14
end_define

begin_define
define|#
directive|define
name|GRP8
value|NULL, NULL, 15
end_define

begin_define
define|#
directive|define
name|GRP9
value|NULL, NULL, 16
end_define

begin_define
define|#
directive|define
name|GRP10
value|NULL, NULL, 17
end_define

begin_define
define|#
directive|define
name|GRP11
value|NULL, NULL, 18
end_define

begin_define
define|#
directive|define
name|GRP12
value|NULL, NULL, 19
end_define

begin_define
define|#
directive|define
name|FLOATCODE
value|50
end_define

begin_define
define|#
directive|define
name|FLOAT
value|NULL, NULL, FLOATCODE
end_define

begin_struct
struct|struct
name|dis386
block|{
name|char
modifier|*
name|name
decl_stmt|;
name|op_rtn
name|op1
decl_stmt|;
name|int
name|bytemode1
decl_stmt|;
name|op_rtn
name|op2
decl_stmt|;
name|int
name|bytemode2
decl_stmt|;
name|op_rtn
name|op3
decl_stmt|;
name|int
name|bytemode3
decl_stmt|;
block|}
struct|;
end_struct

begin_decl_stmt
specifier|static
name|struct
name|dis386
name|dis386
index|[]
init|=
block|{
comment|/* 00 */
block|{
literal|"addb"
block|,
name|Eb
block|,
name|Gb
block|}
block|,
block|{
literal|"addS"
block|,
name|Ev
block|,
name|Gv
block|}
block|,
block|{
literal|"addb"
block|,
name|Gb
block|,
name|Eb
block|}
block|,
block|{
literal|"addS"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"addb"
block|,
name|AL
block|,
name|Ib
block|}
block|,
block|{
literal|"addS"
block|,
name|eAX
block|,
name|Iv
block|}
block|,
block|{
literal|"pushl"
block|,
name|es
block|}
block|,
block|{
literal|"popl"
block|,
name|es
block|}
block|,
comment|/* 08 */
block|{
literal|"orb"
block|,
name|Eb
block|,
name|Gb
block|}
block|,
block|{
literal|"orS"
block|,
name|Ev
block|,
name|Gv
block|}
block|,
block|{
literal|"orb"
block|,
name|Gb
block|,
name|Eb
block|}
block|,
block|{
literal|"orS"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"orb"
block|,
name|AL
block|,
name|Ib
block|}
block|,
block|{
literal|"orS"
block|,
name|eAX
block|,
name|Iv
block|}
block|,
block|{
literal|"pushl"
block|,
name|cs
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* 0x0f extended opcode escape */
comment|/* 10 */
block|{
literal|"adcb"
block|,
name|Eb
block|,
name|Gb
block|}
block|,
block|{
literal|"adcS"
block|,
name|Ev
block|,
name|Gv
block|}
block|,
block|{
literal|"adcb"
block|,
name|Gb
block|,
name|Eb
block|}
block|,
block|{
literal|"adcS"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"adcb"
block|,
name|AL
block|,
name|Ib
block|}
block|,
block|{
literal|"adcS"
block|,
name|eAX
block|,
name|Iv
block|}
block|,
block|{
literal|"pushl"
block|,
name|ss
block|}
block|,
block|{
literal|"popl"
block|,
name|ss
block|}
block|,
comment|/* 18 */
block|{
literal|"sbbb"
block|,
name|Eb
block|,
name|Gb
block|}
block|,
block|{
literal|"sbbS"
block|,
name|Ev
block|,
name|Gv
block|}
block|,
block|{
literal|"sbbb"
block|,
name|Gb
block|,
name|Eb
block|}
block|,
block|{
literal|"sbbS"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"sbbb"
block|,
name|AL
block|,
name|Ib
block|}
block|,
block|{
literal|"sbbS"
block|,
name|eAX
block|,
name|Iv
block|}
block|,
block|{
literal|"pushl"
block|,
name|ds
block|}
block|,
block|{
literal|"popl"
block|,
name|ds
block|}
block|,
comment|/* 20 */
block|{
literal|"andb"
block|,
name|Eb
block|,
name|Gb
block|}
block|,
block|{
literal|"andS"
block|,
name|Ev
block|,
name|Gv
block|}
block|,
block|{
literal|"andb"
block|,
name|Gb
block|,
name|Eb
block|}
block|,
block|{
literal|"andS"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"andb"
block|,
name|AL
block|,
name|Ib
block|}
block|,
block|{
literal|"andS"
block|,
name|eAX
block|,
name|Iv
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* SEG ES prefix */
block|{
literal|"daa"
block|}
block|,
comment|/* 28 */
block|{
literal|"subb"
block|,
name|Eb
block|,
name|Gb
block|}
block|,
block|{
literal|"subS"
block|,
name|Ev
block|,
name|Gv
block|}
block|,
block|{
literal|"subb"
block|,
name|Gb
block|,
name|Eb
block|}
block|,
block|{
literal|"subS"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"subb"
block|,
name|AL
block|,
name|Ib
block|}
block|,
block|{
literal|"subS"
block|,
name|eAX
block|,
name|Iv
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* SEG CS prefix */
block|{
literal|"das"
block|}
block|,
comment|/* 30 */
block|{
literal|"xorb"
block|,
name|Eb
block|,
name|Gb
block|}
block|,
block|{
literal|"xorS"
block|,
name|Ev
block|,
name|Gv
block|}
block|,
block|{
literal|"xorb"
block|,
name|Gb
block|,
name|Eb
block|}
block|,
block|{
literal|"xorS"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"xorb"
block|,
name|AL
block|,
name|Ib
block|}
block|,
block|{
literal|"xorS"
block|,
name|eAX
block|,
name|Iv
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* SEG SS prefix */
block|{
literal|"aaa"
block|}
block|,
comment|/* 38 */
block|{
literal|"cmpb"
block|,
name|Eb
block|,
name|Gb
block|}
block|,
block|{
literal|"cmpS"
block|,
name|Ev
block|,
name|Gv
block|}
block|,
block|{
literal|"cmpb"
block|,
name|Gb
block|,
name|Eb
block|}
block|,
block|{
literal|"cmpS"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"cmpb"
block|,
name|AL
block|,
name|Ib
block|}
block|,
block|{
literal|"cmpS"
block|,
name|eAX
block|,
name|Iv
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* SEG DS prefix */
block|{
literal|"aas"
block|}
block|,
comment|/* 40 */
block|{
literal|"incS"
block|,
name|eAX
block|}
block|,
block|{
literal|"incS"
block|,
name|eCX
block|}
block|,
block|{
literal|"incS"
block|,
name|eDX
block|}
block|,
block|{
literal|"incS"
block|,
name|eBX
block|}
block|,
block|{
literal|"incS"
block|,
name|eSP
block|}
block|,
block|{
literal|"incS"
block|,
name|eBP
block|}
block|,
block|{
literal|"incS"
block|,
name|eSI
block|}
block|,
block|{
literal|"incS"
block|,
name|eDI
block|}
block|,
comment|/* 48 */
block|{
literal|"decS"
block|,
name|eAX
block|}
block|,
block|{
literal|"decS"
block|,
name|eCX
block|}
block|,
block|{
literal|"decS"
block|,
name|eDX
block|}
block|,
block|{
literal|"decS"
block|,
name|eBX
block|}
block|,
block|{
literal|"decS"
block|,
name|eSP
block|}
block|,
block|{
literal|"decS"
block|,
name|eBP
block|}
block|,
block|{
literal|"decS"
block|,
name|eSI
block|}
block|,
block|{
literal|"decS"
block|,
name|eDI
block|}
block|,
comment|/* 50 */
block|{
literal|"pushS"
block|,
name|eAX
block|}
block|,
block|{
literal|"pushS"
block|,
name|eCX
block|}
block|,
block|{
literal|"pushS"
block|,
name|eDX
block|}
block|,
block|{
literal|"pushS"
block|,
name|eBX
block|}
block|,
block|{
literal|"pushS"
block|,
name|eSP
block|}
block|,
block|{
literal|"pushS"
block|,
name|eBP
block|}
block|,
block|{
literal|"pushS"
block|,
name|eSI
block|}
block|,
block|{
literal|"pushS"
block|,
name|eDI
block|}
block|,
comment|/* 58 */
block|{
literal|"popS"
block|,
name|eAX
block|}
block|,
block|{
literal|"popS"
block|,
name|eCX
block|}
block|,
block|{
literal|"popS"
block|,
name|eDX
block|}
block|,
block|{
literal|"popS"
block|,
name|eBX
block|}
block|,
block|{
literal|"popS"
block|,
name|eSP
block|}
block|,
block|{
literal|"popS"
block|,
name|eBP
block|}
block|,
block|{
literal|"popS"
block|,
name|eSI
block|}
block|,
block|{
literal|"popS"
block|,
name|eDI
block|}
block|,
comment|/* 60 */
block|{
literal|"pusha"
block|}
block|,
block|{
literal|"popa"
block|}
block|,
block|{
literal|"boundS"
block|,
name|Gv
block|,
name|Ma
block|}
block|,
block|{
literal|"arpl"
block|,
name|Ew
block|,
name|Gw
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* seg fs */
block|{
literal|"(bad)"
block|}
block|,
comment|/* seg gs */
block|{
literal|"(bad)"
block|}
block|,
comment|/* op size prefix */
block|{
literal|"(bad)"
block|}
block|,
comment|/* adr size prefix */
comment|/* 68 */
block|{
literal|"pushS"
block|,
name|Iv
block|}
block|,
comment|/* 386 book wrong */
block|{
literal|"imulS"
block|,
name|Gv
block|,
name|Ev
block|,
name|Iv
block|}
block|,
block|{
literal|"pushl"
block|,
name|sIb
block|}
block|,
comment|/* push of byte really pushes 4 bytes */
block|{
literal|"imulS"
block|,
name|Gv
block|,
name|Ev
block|,
name|Ib
block|}
block|,
block|{
literal|"insb"
block|,
name|Yb
block|,
name|indirDX
block|}
block|,
block|{
literal|"insS"
block|,
name|Yv
block|,
name|indirDX
block|}
block|,
block|{
literal|"outsb"
block|,
name|indirDX
block|,
name|Xb
block|}
block|,
block|{
literal|"outsS"
block|,
name|indirDX
block|,
name|Xv
block|}
block|,
comment|/* 70 */
block|{
literal|"jo"
block|,
name|Jb
block|}
block|,
block|{
literal|"jno"
block|,
name|Jb
block|}
block|,
block|{
literal|"jb"
block|,
name|Jb
block|}
block|,
block|{
literal|"jae"
block|,
name|Jb
block|}
block|,
block|{
literal|"je"
block|,
name|Jb
block|}
block|,
block|{
literal|"jne"
block|,
name|Jb
block|}
block|,
block|{
literal|"jbe"
block|,
name|Jb
block|}
block|,
block|{
literal|"ja"
block|,
name|Jb
block|}
block|,
comment|/* 78 */
block|{
literal|"js"
block|,
name|Jb
block|}
block|,
block|{
literal|"jns"
block|,
name|Jb
block|}
block|,
block|{
literal|"jp"
block|,
name|Jb
block|}
block|,
block|{
literal|"jnp"
block|,
name|Jb
block|}
block|,
block|{
literal|"jl"
block|,
name|Jb
block|}
block|,
block|{
literal|"jnl"
block|,
name|Jb
block|}
block|,
block|{
literal|"jle"
block|,
name|Jb
block|}
block|,
block|{
literal|"jg"
block|,
name|Jb
block|}
block|,
comment|/* 80 */
block|{
name|GRP1b
block|}
block|,
block|{
name|GRP1S
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
name|GRP1Ss
block|}
block|,
block|{
literal|"testb"
block|,
name|Eb
block|,
name|Gb
block|}
block|,
block|{
literal|"testS"
block|,
name|Ev
block|,
name|Gv
block|}
block|,
block|{
literal|"xchgb"
block|,
name|Eb
block|,
name|Gb
block|}
block|,
block|{
literal|"xchgS"
block|,
name|Ev
block|,
name|Gv
block|}
block|,
comment|/* 88 */
block|{
literal|"movb"
block|,
name|Eb
block|,
name|Gb
block|}
block|,
block|{
literal|"movS"
block|,
name|Ev
block|,
name|Gv
block|}
block|,
block|{
literal|"movb"
block|,
name|Gb
block|,
name|Eb
block|}
block|,
block|{
literal|"movS"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"movw"
block|,
name|Ew
block|,
name|Sw
block|}
block|,
block|{
literal|"leaS"
block|,
name|Gv
block|,
name|M
block|}
block|,
block|{
literal|"movw"
block|,
name|Sw
block|,
name|Ew
block|}
block|,
block|{
literal|"popS"
block|,
name|Ev
block|}
block|,
comment|/* 90 */
block|{
literal|"nop"
block|}
block|,
block|{
literal|"xchgS"
block|,
name|eCX
block|,
name|eAX
block|}
block|,
block|{
literal|"xchgS"
block|,
name|eDX
block|,
name|eAX
block|}
block|,
block|{
literal|"xchgS"
block|,
name|eBX
block|,
name|eAX
block|}
block|,
block|{
literal|"xchgS"
block|,
name|eSP
block|,
name|eAX
block|}
block|,
block|{
literal|"xchgS"
block|,
name|eBP
block|,
name|eAX
block|}
block|,
block|{
literal|"xchgS"
block|,
name|eSI
block|,
name|eAX
block|}
block|,
block|{
literal|"xchgS"
block|,
name|eDI
block|,
name|eAX
block|}
block|,
comment|/* 98 */
block|{
literal|"cwtl"
block|}
block|,
block|{
literal|"cltd"
block|}
block|,
block|{
literal|"lcall"
block|,
name|Ap
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* fwait */
block|{
literal|"pushf"
block|}
block|,
block|{
literal|"popf"
block|}
block|,
block|{
literal|"sahf"
block|}
block|,
block|{
literal|"lahf"
block|}
block|,
comment|/* a0 */
block|{
literal|"movb"
block|,
name|AL
block|,
name|Ob
block|}
block|,
block|{
literal|"movS"
block|,
name|eAX
block|,
name|Ov
block|}
block|,
block|{
literal|"movb"
block|,
name|Ob
block|,
name|AL
block|}
block|,
block|{
literal|"movS"
block|,
name|Ov
block|,
name|eAX
block|}
block|,
block|{
literal|"movsb"
block|,
name|Yb
block|,
name|Xb
block|}
block|,
block|{
literal|"movsS"
block|,
name|Yv
block|,
name|Xv
block|}
block|,
block|{
literal|"cmpsb"
block|,
name|Yb
block|,
name|Xb
block|}
block|,
block|{
literal|"cmpsS"
block|,
name|Yv
block|,
name|Xv
block|}
block|,
comment|/* a8 */
block|{
literal|"testb"
block|,
name|AL
block|,
name|Ib
block|}
block|,
block|{
literal|"testS"
block|,
name|eAX
block|,
name|Iv
block|}
block|,
block|{
literal|"stosb"
block|,
name|Yb
block|,
name|AL
block|}
block|,
block|{
literal|"stosS"
block|,
name|Yv
block|,
name|eAX
block|}
block|,
block|{
literal|"lodsb"
block|,
name|AL
block|,
name|Xb
block|}
block|,
block|{
literal|"lodsS"
block|,
name|eAX
block|,
name|Xv
block|}
block|,
block|{
literal|"scasb"
block|,
name|AL
block|,
name|Yb
block|}
block|,
block|{
literal|"scasS"
block|,
name|eAX
block|,
name|Yv
block|}
block|,
comment|/* b0 */
block|{
literal|"movb"
block|,
name|AL
block|,
name|Ib
block|}
block|,
block|{
literal|"movb"
block|,
name|CL
block|,
name|Ib
block|}
block|,
block|{
literal|"movb"
block|,
name|DL
block|,
name|Ib
block|}
block|,
block|{
literal|"movb"
block|,
name|BL
block|,
name|Ib
block|}
block|,
block|{
literal|"movb"
block|,
name|AH
block|,
name|Ib
block|}
block|,
block|{
literal|"movb"
block|,
name|CH
block|,
name|Ib
block|}
block|,
block|{
literal|"movb"
block|,
name|DH
block|,
name|Ib
block|}
block|,
block|{
literal|"movb"
block|,
name|BH
block|,
name|Ib
block|}
block|,
comment|/* b8 */
block|{
literal|"movS"
block|,
name|eAX
block|,
name|Iv
block|}
block|,
block|{
literal|"movS"
block|,
name|eCX
block|,
name|Iv
block|}
block|,
block|{
literal|"movS"
block|,
name|eDX
block|,
name|Iv
block|}
block|,
block|{
literal|"movS"
block|,
name|eBX
block|,
name|Iv
block|}
block|,
block|{
literal|"movS"
block|,
name|eSP
block|,
name|Iv
block|}
block|,
block|{
literal|"movS"
block|,
name|eBP
block|,
name|Iv
block|}
block|,
block|{
literal|"movS"
block|,
name|eSI
block|,
name|Iv
block|}
block|,
block|{
literal|"movS"
block|,
name|eDI
block|,
name|Iv
block|}
block|,
comment|/* c0 */
block|{
name|GRP2b
block|}
block|,
block|{
name|GRP2S
block|}
block|,
block|{
literal|"ret"
block|,
name|Iw
block|}
block|,
block|{
literal|"ret"
block|}
block|,
block|{
literal|"lesS"
block|,
name|Gv
block|,
name|Mp
block|}
block|,
block|{
literal|"ldsS"
block|,
name|Gv
block|,
name|Mp
block|}
block|,
block|{
literal|"movb"
block|,
name|Eb
block|,
name|Ib
block|}
block|,
block|{
literal|"movS"
block|,
name|Ev
block|,
name|Iv
block|}
block|,
comment|/* c8 */
block|{
literal|"enter"
block|,
name|Iw
block|,
name|Ib
block|}
block|,
block|{
literal|"leave"
block|}
block|,
block|{
literal|"lret"
block|,
name|Iw
block|}
block|,
block|{
literal|"lret"
block|}
block|,
block|{
literal|"int3"
block|}
block|,
block|{
literal|"int"
block|,
name|Ib
block|}
block|,
block|{
literal|"into"
block|}
block|,
block|{
literal|"iret"
block|}
block|,
comment|/* d0 */
block|{
name|GRP2b_one
block|}
block|,
block|{
name|GRP2S_one
block|}
block|,
block|{
name|GRP2b_cl
block|}
block|,
block|{
name|GRP2S_cl
block|}
block|,
block|{
literal|"aam"
block|,
name|Ib
block|}
block|,
block|{
literal|"aad"
block|,
name|Ib
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"xlat"
block|}
block|,
comment|/* d8 */
block|{
name|FLOAT
block|}
block|,
block|{
name|FLOAT
block|}
block|,
block|{
name|FLOAT
block|}
block|,
block|{
name|FLOAT
block|}
block|,
block|{
name|FLOAT
block|}
block|,
block|{
name|FLOAT
block|}
block|,
block|{
name|FLOAT
block|}
block|,
block|{
name|FLOAT
block|}
block|,
comment|/* e0 */
block|{
literal|"loopne"
block|,
name|Jb
block|}
block|,
block|{
literal|"loope"
block|,
name|Jb
block|}
block|,
block|{
literal|"loop"
block|,
name|Jb
block|}
block|,
block|{
literal|"jCcxz"
block|,
name|Jb
block|}
block|,
block|{
literal|"inb"
block|,
name|AL
block|,
name|Ib
block|}
block|,
block|{
literal|"inS"
block|,
name|eAX
block|,
name|Ib
block|}
block|,
block|{
literal|"outb"
block|,
name|Ib
block|,
name|AL
block|}
block|,
block|{
literal|"outS"
block|,
name|Ib
block|,
name|eAX
block|}
block|,
comment|/* e8 */
block|{
literal|"call"
block|,
name|Av
block|}
block|,
block|{
literal|"jmp"
block|,
name|Jv
block|}
block|,
block|{
literal|"ljmp"
block|,
name|Ap
block|}
block|,
block|{
literal|"jmp"
block|,
name|Jb
block|}
block|,
block|{
literal|"inb"
block|,
name|AL
block|,
name|indirDX
block|}
block|,
block|{
literal|"inS"
block|,
name|eAX
block|,
name|indirDX
block|}
block|,
block|{
literal|"outb"
block|,
name|indirDX
block|,
name|AL
block|}
block|,
block|{
literal|"outS"
block|,
name|indirDX
block|,
name|eAX
block|}
block|,
comment|/* f0 */
block|{
literal|"(bad)"
block|}
block|,
comment|/* lock prefix */
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* repne */
block|{
literal|"(bad)"
block|}
block|,
comment|/* repz */
block|{
literal|"hlt"
block|}
block|,
block|{
literal|"cmc"
block|}
block|,
block|{
name|GRP3b
block|}
block|,
block|{
name|GRP3S
block|}
block|,
comment|/* f8 */
block|{
literal|"clc"
block|}
block|,
block|{
literal|"stc"
block|}
block|,
block|{
literal|"cli"
block|}
block|,
block|{
literal|"sti"
block|}
block|,
block|{
literal|"cld"
block|}
block|,
block|{
literal|"std"
block|}
block|,
block|{
name|GRP4
block|}
block|,
block|{
name|GRP5
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|dis386
name|dis386_twobyte
index|[]
init|=
block|{
comment|/* 00 */
block|{
name|GRP6
block|}
block|,
block|{
name|GRP7
block|}
block|,
block|{
literal|"larS"
block|,
name|Gv
block|,
name|Ew
block|}
block|,
block|{
literal|"lslS"
block|,
name|Gv
block|,
name|Ew
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"clts"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* 08 */
block|{
literal|"invd"
block|}
block|,
block|{
literal|"wbinvd"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"ud2a"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* 10 */
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* 18 */
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* 20 */
comment|/* these are all backward in appendix A of the intel book */
block|{
literal|"movl"
block|,
name|Rd
block|,
name|Cd
block|}
block|,
block|{
literal|"movl"
block|,
name|Rd
block|,
name|Dd
block|}
block|,
block|{
literal|"movl"
block|,
name|Cd
block|,
name|Rd
block|}
block|,
block|{
literal|"movl"
block|,
name|Dd
block|,
name|Rd
block|}
block|,
block|{
literal|"movl"
block|,
name|Rd
block|,
name|Td
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"movl"
block|,
name|Td
block|,
name|Rd
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* 28 */
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* 30 */
block|{
literal|"wrmsr"
block|}
block|,
block|{
literal|"rdtsc"
block|}
block|,
block|{
literal|"rdmsr"
block|}
block|,
block|{
literal|"rdpmc"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* 38 */
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* 40 */
block|{
literal|"cmovo"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"cmovno"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"cmovb"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"cmovae"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"cmove"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"cmovne"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"cmovbe"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"cmova"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
comment|/* 48 */
block|{
literal|"cmovs"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"cmovns"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"cmovp"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"cmovnp"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"cmovl"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"cmovge"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"cmovle"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"cmovg"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
comment|/* 50 */
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* 58 */
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* 60 */
block|{
literal|"punpcklbw"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"punpcklwd"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"punpckldq"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"packsswb"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"pcmpgtb"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"pcmpgtw"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"pcmpgtd"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"packuswb"
block|,
name|MX
block|,
name|EM
block|}
block|,
comment|/* 68 */
block|{
literal|"punpckhbw"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"punpckhwd"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"punpckhdq"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"packssdw"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"movd"
block|,
name|MX
block|,
name|Ev
block|}
block|,
block|{
literal|"movq"
block|,
name|MX
block|,
name|EM
block|}
block|,
comment|/* 70 */
block|{
literal|"(bad)"
block|}
block|,
block|{
name|GRP10
block|}
block|,
block|{
name|GRP11
block|}
block|,
block|{
name|GRP12
block|}
block|,
block|{
literal|"pcmpeqb"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"pcmpeqw"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"pcmpeqd"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"emms"
block|}
block|,
comment|/* 78 */
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"movd"
block|,
name|Ev
block|,
name|MX
block|}
block|,
block|{
literal|"movq"
block|,
name|EM
block|,
name|MX
block|}
block|,
comment|/* 80 */
block|{
literal|"jo"
block|,
name|Jv
block|}
block|,
block|{
literal|"jno"
block|,
name|Jv
block|}
block|,
block|{
literal|"jb"
block|,
name|Jv
block|}
block|,
block|{
literal|"jae"
block|,
name|Jv
block|}
block|,
block|{
literal|"je"
block|,
name|Jv
block|}
block|,
block|{
literal|"jne"
block|,
name|Jv
block|}
block|,
block|{
literal|"jbe"
block|,
name|Jv
block|}
block|,
block|{
literal|"ja"
block|,
name|Jv
block|}
block|,
comment|/* 88 */
block|{
literal|"js"
block|,
name|Jv
block|}
block|,
block|{
literal|"jns"
block|,
name|Jv
block|}
block|,
block|{
literal|"jp"
block|,
name|Jv
block|}
block|,
block|{
literal|"jnp"
block|,
name|Jv
block|}
block|,
block|{
literal|"jl"
block|,
name|Jv
block|}
block|,
block|{
literal|"jge"
block|,
name|Jv
block|}
block|,
block|{
literal|"jle"
block|,
name|Jv
block|}
block|,
block|{
literal|"jg"
block|,
name|Jv
block|}
block|,
comment|/* 90 */
block|{
literal|"seto"
block|,
name|Eb
block|}
block|,
block|{
literal|"setno"
block|,
name|Eb
block|}
block|,
block|{
literal|"setb"
block|,
name|Eb
block|}
block|,
block|{
literal|"setae"
block|,
name|Eb
block|}
block|,
block|{
literal|"sete"
block|,
name|Eb
block|}
block|,
block|{
literal|"setne"
block|,
name|Eb
block|}
block|,
block|{
literal|"setbe"
block|,
name|Eb
block|}
block|,
block|{
literal|"seta"
block|,
name|Eb
block|}
block|,
comment|/* 98 */
block|{
literal|"sets"
block|,
name|Eb
block|}
block|,
block|{
literal|"setns"
block|,
name|Eb
block|}
block|,
block|{
literal|"setp"
block|,
name|Eb
block|}
block|,
block|{
literal|"setnp"
block|,
name|Eb
block|}
block|,
block|{
literal|"setl"
block|,
name|Eb
block|}
block|,
block|{
literal|"setge"
block|,
name|Eb
block|}
block|,
block|{
literal|"setle"
block|,
name|Eb
block|}
block|,
block|{
literal|"setg"
block|,
name|Eb
block|}
block|,
comment|/* a0 */
block|{
literal|"pushl"
block|,
name|fs
block|}
block|,
block|{
literal|"popl"
block|,
name|fs
block|}
block|,
block|{
literal|"cpuid"
block|}
block|,
block|{
literal|"btS"
block|,
name|Ev
block|,
name|Gv
block|}
block|,
block|{
literal|"shldS"
block|,
name|Ev
block|,
name|Gv
block|,
name|Ib
block|}
block|,
block|{
literal|"shldS"
block|,
name|Ev
block|,
name|Gv
block|,
name|CL
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* a8 */
block|{
literal|"pushl"
block|,
name|gs
block|}
block|,
block|{
literal|"popl"
block|,
name|gs
block|}
block|,
block|{
literal|"rsm"
block|}
block|,
block|{
literal|"btsS"
block|,
name|Ev
block|,
name|Gv
block|}
block|,
block|{
literal|"shrdS"
block|,
name|Ev
block|,
name|Gv
block|,
name|Ib
block|}
block|,
block|{
literal|"shrdS"
block|,
name|Ev
block|,
name|Gv
block|,
name|CL
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"imulS"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
comment|/* b0 */
block|{
literal|"cmpxchgb"
block|,
name|Eb
block|,
name|Gb
block|}
block|,
block|{
literal|"cmpxchgS"
block|,
name|Ev
block|,
name|Gv
block|}
block|,
block|{
literal|"lssS"
block|,
name|Gv
block|,
name|Mp
block|}
block|,
comment|/* 386 lists only Mp */
block|{
literal|"btrS"
block|,
name|Ev
block|,
name|Gv
block|}
block|,
block|{
literal|"lfsS"
block|,
name|Gv
block|,
name|Mp
block|}
block|,
comment|/* 386 lists only Mp */
block|{
literal|"lgsS"
block|,
name|Gv
block|,
name|Mp
block|}
block|,
comment|/* 386 lists only Mp */
block|{
literal|"movzbS"
block|,
name|Gv
block|,
name|Eb
block|}
block|,
block|{
literal|"movzwS"
block|,
name|Gv
block|,
name|Ew
block|}
block|,
comment|/* b8 */
block|{
literal|"ud2b"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
name|GRP8
block|}
block|,
block|{
literal|"btcS"
block|,
name|Ev
block|,
name|Gv
block|}
block|,
block|{
literal|"bsfS"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"bsrS"
block|,
name|Gv
block|,
name|Ev
block|}
block|,
block|{
literal|"movsbS"
block|,
name|Gv
block|,
name|Eb
block|}
block|,
block|{
literal|"movswS"
block|,
name|Gv
block|,
name|Ew
block|}
block|,
comment|/* c0 */
block|{
literal|"xaddb"
block|,
name|Eb
block|,
name|Gb
block|}
block|,
block|{
literal|"xaddS"
block|,
name|Ev
block|,
name|Gv
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
name|GRP9
block|}
block|,
comment|/* c8 */
block|{
literal|"bswap"
block|,
name|eAX
block|}
block|,
block|{
literal|"bswap"
block|,
name|eCX
block|}
block|,
block|{
literal|"bswap"
block|,
name|eDX
block|}
block|,
block|{
literal|"bswap"
block|,
name|eBX
block|}
block|,
block|{
literal|"bswap"
block|,
name|eSP
block|}
block|,
block|{
literal|"bswap"
block|,
name|eBP
block|}
block|,
block|{
literal|"bswap"
block|,
name|eSI
block|}
block|,
block|{
literal|"bswap"
block|,
name|eDI
block|}
block|,
comment|/* d0 */
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"psrlw"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"psrld"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"psrlq"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"pmullw"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* d8 */
block|{
literal|"psubusb"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"psubusw"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"pand"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"paddusb"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"paddusw"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"pand"
block|,
name|MX
block|,
name|EM
block|}
block|,
comment|/* e0 */
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"psraw"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"psrad"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"pmulhw"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* e8 */
block|{
literal|"psubsb"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"psubsw"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"por"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"paddsb"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"paddsw"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"pxor"
block|,
name|MX
block|,
name|EM
block|}
block|,
comment|/* f0 */
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"psllw"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"pslld"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"psllq"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"pmaddwd"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
comment|/* f8 */
block|{
literal|"psubb"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"psubw"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"psubd"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"paddb"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"paddw"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"paddd"
block|,
name|MX
block|,
name|EM
block|}
block|,
block|{
literal|"(bad)"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
name|onebyte_has_modrm
index|[
literal|256
index|]
init|=
block|{
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
name|twobyte_has_modrm
index|[
literal|256
index|]
init|=
block|{
comment|/* 00 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 0f */
comment|/* 10 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 1f */
comment|/* 20 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 2f */
comment|/* 30 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 3f */
comment|/* 40 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
comment|/* 4f */
comment|/* 50 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 5f */
comment|/* 60 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
comment|/* 6f */
comment|/* 70 */
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
comment|/* 7f */
comment|/* 80 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 8f */
comment|/* 90 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
comment|/* 9f */
comment|/* a0 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
comment|/* af */
comment|/* b0 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
comment|/* bf */
comment|/* c0 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* cf */
comment|/* d0 */
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|1
block|,
comment|/* df */
comment|/* e0 */
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|1
block|,
comment|/* ef */
comment|/* f0 */
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
comment|/* ff */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
name|obuf
index|[
literal|100
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|obufp
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
name|scratchbuf
index|[
literal|100
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|unsigned
name|char
modifier|*
name|start_codep
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|unsigned
name|char
modifier|*
name|codep
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|disassemble_info
modifier|*
name|the_info
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|mod
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|rm
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|reg
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|oappend
name|PARAMS
argument_list|(
operator|(
name|char
operator|*
name|s
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|names32
index|[]
init|=
block|{
literal|"%eax"
block|,
literal|"%ecx"
block|,
literal|"%edx"
block|,
literal|"%ebx"
block|,
literal|"%esp"
block|,
literal|"%ebp"
block|,
literal|"%esi"
block|,
literal|"%edi"
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|names16
index|[]
init|=
block|{
literal|"%ax"
block|,
literal|"%cx"
block|,
literal|"%dx"
block|,
literal|"%bx"
block|,
literal|"%sp"
block|,
literal|"%bp"
block|,
literal|"%si"
block|,
literal|"%di"
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|names8
index|[]
init|=
block|{
literal|"%al"
block|,
literal|"%cl"
block|,
literal|"%dl"
block|,
literal|"%bl"
block|,
literal|"%ah"
block|,
literal|"%ch"
block|,
literal|"%dh"
block|,
literal|"%bh"
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|names_seg
index|[]
init|=
block|{
literal|"%es"
block|,
literal|"%cs"
block|,
literal|"%ss"
block|,
literal|"%ds"
block|,
literal|"%fs"
block|,
literal|"%gs"
block|,
literal|"%?"
block|,
literal|"%?"
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|index16
index|[]
init|=
block|{
literal|"bx+si"
block|,
literal|"bx+di"
block|,
literal|"bp+si"
block|,
literal|"bp+di"
block|,
literal|"si"
block|,
literal|"di"
block|,
literal|"bp"
block|,
literal|"bx"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|dis386
name|grps
index|[]
index|[
literal|8
index|]
init|=
block|{
comment|/* GRP1b */
block|{
block|{
literal|"addb"
block|,
name|Eb
block|,
name|Ib
block|}
block|,
block|{
literal|"orb"
block|,
name|Eb
block|,
name|Ib
block|}
block|,
block|{
literal|"adcb"
block|,
name|Eb
block|,
name|Ib
block|}
block|,
block|{
literal|"sbbb"
block|,
name|Eb
block|,
name|Ib
block|}
block|,
block|{
literal|"andb"
block|,
name|Eb
block|,
name|Ib
block|}
block|,
block|{
literal|"subb"
block|,
name|Eb
block|,
name|Ib
block|}
block|,
block|{
literal|"xorb"
block|,
name|Eb
block|,
name|Ib
block|}
block|,
block|{
literal|"cmpb"
block|,
name|Eb
block|,
name|Ib
block|}
block|}
block|,
comment|/* GRP1S */
block|{
block|{
literal|"addS"
block|,
name|Ev
block|,
name|Iv
block|}
block|,
block|{
literal|"orS"
block|,
name|Ev
block|,
name|Iv
block|}
block|,
block|{
literal|"adcS"
block|,
name|Ev
block|,
name|Iv
block|}
block|,
block|{
literal|"sbbS"
block|,
name|Ev
block|,
name|Iv
block|}
block|,
block|{
literal|"andS"
block|,
name|Ev
block|,
name|Iv
block|}
block|,
block|{
literal|"subS"
block|,
name|Ev
block|,
name|Iv
block|}
block|,
block|{
literal|"xorS"
block|,
name|Ev
block|,
name|Iv
block|}
block|,
block|{
literal|"cmpS"
block|,
name|Ev
block|,
name|Iv
block|}
block|}
block|,
comment|/* GRP1Ss */
block|{
block|{
literal|"addS"
block|,
name|Ev
block|,
name|sIb
block|}
block|,
block|{
literal|"orS"
block|,
name|Ev
block|,
name|sIb
block|}
block|,
block|{
literal|"adcS"
block|,
name|Ev
block|,
name|sIb
block|}
block|,
block|{
literal|"sbbS"
block|,
name|Ev
block|,
name|sIb
block|}
block|,
block|{
literal|"andS"
block|,
name|Ev
block|,
name|sIb
block|}
block|,
block|{
literal|"subS"
block|,
name|Ev
block|,
name|sIb
block|}
block|,
block|{
literal|"xorS"
block|,
name|Ev
block|,
name|sIb
block|}
block|,
block|{
literal|"cmpS"
block|,
name|Ev
block|,
name|sIb
block|}
block|}
block|,
comment|/* GRP2b */
block|{
block|{
literal|"rolb"
block|,
name|Eb
block|,
name|Ib
block|}
block|,
block|{
literal|"rorb"
block|,
name|Eb
block|,
name|Ib
block|}
block|,
block|{
literal|"rclb"
block|,
name|Eb
block|,
name|Ib
block|}
block|,
block|{
literal|"rcrb"
block|,
name|Eb
block|,
name|Ib
block|}
block|,
block|{
literal|"shlb"
block|,
name|Eb
block|,
name|Ib
block|}
block|,
block|{
literal|"shrb"
block|,
name|Eb
block|,
name|Ib
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"sarb"
block|,
name|Eb
block|,
name|Ib
block|}
block|,   }
block|,
comment|/* GRP2S */
block|{
block|{
literal|"rolS"
block|,
name|Ev
block|,
name|Ib
block|}
block|,
block|{
literal|"rorS"
block|,
name|Ev
block|,
name|Ib
block|}
block|,
block|{
literal|"rclS"
block|,
name|Ev
block|,
name|Ib
block|}
block|,
block|{
literal|"rcrS"
block|,
name|Ev
block|,
name|Ib
block|}
block|,
block|{
literal|"shlS"
block|,
name|Ev
block|,
name|Ib
block|}
block|,
block|{
literal|"shrS"
block|,
name|Ev
block|,
name|Ib
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"sarS"
block|,
name|Ev
block|,
name|Ib
block|}
block|,   }
block|,
comment|/* GRP2b_one */
block|{
block|{
literal|"rolb"
block|,
name|Eb
block|}
block|,
block|{
literal|"rorb"
block|,
name|Eb
block|}
block|,
block|{
literal|"rclb"
block|,
name|Eb
block|}
block|,
block|{
literal|"rcrb"
block|,
name|Eb
block|}
block|,
block|{
literal|"shlb"
block|,
name|Eb
block|}
block|,
block|{
literal|"shrb"
block|,
name|Eb
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"sarb"
block|,
name|Eb
block|}
block|,   }
block|,
comment|/* GRP2S_one */
block|{
block|{
literal|"rolS"
block|,
name|Ev
block|}
block|,
block|{
literal|"rorS"
block|,
name|Ev
block|}
block|,
block|{
literal|"rclS"
block|,
name|Ev
block|}
block|,
block|{
literal|"rcrS"
block|,
name|Ev
block|}
block|,
block|{
literal|"shlS"
block|,
name|Ev
block|}
block|,
block|{
literal|"shrS"
block|,
name|Ev
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"sarS"
block|,
name|Ev
block|}
block|,   }
block|,
comment|/* GRP2b_cl */
block|{
block|{
literal|"rolb"
block|,
name|Eb
block|,
name|CL
block|}
block|,
block|{
literal|"rorb"
block|,
name|Eb
block|,
name|CL
block|}
block|,
block|{
literal|"rclb"
block|,
name|Eb
block|,
name|CL
block|}
block|,
block|{
literal|"rcrb"
block|,
name|Eb
block|,
name|CL
block|}
block|,
block|{
literal|"shlb"
block|,
name|Eb
block|,
name|CL
block|}
block|,
block|{
literal|"shrb"
block|,
name|Eb
block|,
name|CL
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"sarb"
block|,
name|Eb
block|,
name|CL
block|}
block|,   }
block|,
comment|/* GRP2S_cl */
block|{
block|{
literal|"rolS"
block|,
name|Ev
block|,
name|CL
block|}
block|,
block|{
literal|"rorS"
block|,
name|Ev
block|,
name|CL
block|}
block|,
block|{
literal|"rclS"
block|,
name|Ev
block|,
name|CL
block|}
block|,
block|{
literal|"rcrS"
block|,
name|Ev
block|,
name|CL
block|}
block|,
block|{
literal|"shlS"
block|,
name|Ev
block|,
name|CL
block|}
block|,
block|{
literal|"shrS"
block|,
name|Ev
block|,
name|CL
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"sarS"
block|,
name|Ev
block|,
name|CL
block|}
block|}
block|,
comment|/* GRP3b */
block|{
block|{
literal|"testb"
block|,
name|Eb
block|,
name|Ib
block|}
block|,
block|{
literal|"(bad)"
block|,
name|Eb
block|}
block|,
block|{
literal|"notb"
block|,
name|Eb
block|}
block|,
block|{
literal|"negb"
block|,
name|Eb
block|}
block|,
block|{
literal|"mulb"
block|,
name|AL
block|,
name|Eb
block|}
block|,
block|{
literal|"imulb"
block|,
name|AL
block|,
name|Eb
block|}
block|,
block|{
literal|"divb"
block|,
name|AL
block|,
name|Eb
block|}
block|,
block|{
literal|"idivb"
block|,
name|AL
block|,
name|Eb
block|}
block|}
block|,
comment|/* GRP3S */
block|{
block|{
literal|"testS"
block|,
name|Ev
block|,
name|Iv
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"notS"
block|,
name|Ev
block|}
block|,
block|{
literal|"negS"
block|,
name|Ev
block|}
block|,
block|{
literal|"mulS"
block|,
name|eAX
block|,
name|Ev
block|}
block|,
block|{
literal|"imulS"
block|,
name|eAX
block|,
name|Ev
block|}
block|,
block|{
literal|"divS"
block|,
name|eAX
block|,
name|Ev
block|}
block|,
block|{
literal|"idivS"
block|,
name|eAX
block|,
name|Ev
block|}
block|,   }
block|,
comment|/* GRP4 */
block|{
block|{
literal|"incb"
block|,
name|Eb
block|}
block|,
block|{
literal|"decb"
block|,
name|Eb
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,   }
block|,
comment|/* GRP5 */
block|{
block|{
literal|"incS"
block|,
name|Ev
block|}
block|,
block|{
literal|"decS"
block|,
name|Ev
block|}
block|,
block|{
literal|"call"
block|,
name|indirEv
block|}
block|,
block|{
literal|"lcall"
block|,
name|indirEv
block|}
block|,
block|{
literal|"jmp"
block|,
name|indirEv
block|}
block|,
block|{
literal|"ljmp"
block|,
name|indirEv
block|}
block|,
block|{
literal|"pushS"
block|,
name|Ev
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,   }
block|,
comment|/* GRP6 */
block|{
block|{
literal|"sldt"
block|,
name|Ew
block|}
block|,
block|{
literal|"str"
block|,
name|Ew
block|}
block|,
block|{
literal|"lldt"
block|,
name|Ew
block|}
block|,
block|{
literal|"ltr"
block|,
name|Ew
block|}
block|,
block|{
literal|"verr"
block|,
name|Ew
block|}
block|,
block|{
literal|"verw"
block|,
name|Ew
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|}
block|,
comment|/* GRP7 */
block|{
block|{
literal|"sgdt"
block|,
name|Ew
block|}
block|,
block|{
literal|"sidt"
block|,
name|Ew
block|}
block|,
block|{
literal|"lgdt"
block|,
name|Ew
block|}
block|,
block|{
literal|"lidt"
block|,
name|Ew
block|}
block|,
block|{
literal|"smsw"
block|,
name|Ew
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"lmsw"
block|,
name|Ew
block|}
block|,
block|{
literal|"invlpg"
block|,
name|Ew
block|}
block|,   }
block|,
comment|/* GRP8 */
block|{
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"btS"
block|,
name|Ev
block|,
name|Ib
block|}
block|,
block|{
literal|"btsS"
block|,
name|Ev
block|,
name|Ib
block|}
block|,
block|{
literal|"btrS"
block|,
name|Ev
block|,
name|Ib
block|}
block|,
block|{
literal|"btcS"
block|,
name|Ev
block|,
name|Ib
block|}
block|,   }
block|,
comment|/* GRP9 */
block|{
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"cmpxchg8b"
block|,
name|Ev
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,   }
block|,
comment|/* GRP10 */
block|{
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"psrlw"
block|,
name|MS
block|,
name|Ib
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"psraw"
block|,
name|MS
block|,
name|Ib
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"psllw"
block|,
name|MS
block|,
name|Ib
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,   }
block|,
comment|/* GRP11 */
block|{
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"psrld"
block|,
name|MS
block|,
name|Ib
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"psrad"
block|,
name|MS
block|,
name|Ib
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"pslld"
block|,
name|MS
block|,
name|Ib
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,   }
block|,
comment|/* GRP12 */
block|{
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"psrlq"
block|,
name|MS
block|,
name|Ib
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"psllq"
block|,
name|MS
block|,
name|Ib
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,   }
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|PREFIX_REPZ
value|1
end_define

begin_define
define|#
directive|define
name|PREFIX_REPNZ
value|2
end_define

begin_define
define|#
directive|define
name|PREFIX_LOCK
value|4
end_define

begin_define
define|#
directive|define
name|PREFIX_CS
value|8
end_define

begin_define
define|#
directive|define
name|PREFIX_SS
value|0x10
end_define

begin_define
define|#
directive|define
name|PREFIX_DS
value|0x20
end_define

begin_define
define|#
directive|define
name|PREFIX_ES
value|0x40
end_define

begin_define
define|#
directive|define
name|PREFIX_FS
value|0x80
end_define

begin_define
define|#
directive|define
name|PREFIX_GS
value|0x100
end_define

begin_define
define|#
directive|define
name|PREFIX_DATA
value|0x200
end_define

begin_define
define|#
directive|define
name|PREFIX_ADR
value|0x400
end_define

begin_define
define|#
directive|define
name|PREFIX_FWAIT
value|0x800
end_define

begin_decl_stmt
specifier|static
name|int
name|prefixes
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
name|ckprefix
parameter_list|()
block|{
name|prefixes
operator|=
literal|0
expr_stmt|;
while|while
condition|(
literal|1
condition|)
block|{
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
switch|switch
condition|(
operator|*
name|codep
condition|)
block|{
case|case
literal|0xf3
case|:
name|prefixes
operator||=
name|PREFIX_REPZ
expr_stmt|;
break|break;
case|case
literal|0xf2
case|:
name|prefixes
operator||=
name|PREFIX_REPNZ
expr_stmt|;
break|break;
case|case
literal|0xf0
case|:
name|prefixes
operator||=
name|PREFIX_LOCK
expr_stmt|;
break|break;
case|case
literal|0x2e
case|:
name|prefixes
operator||=
name|PREFIX_CS
expr_stmt|;
break|break;
case|case
literal|0x36
case|:
name|prefixes
operator||=
name|PREFIX_SS
expr_stmt|;
break|break;
case|case
literal|0x3e
case|:
name|prefixes
operator||=
name|PREFIX_DS
expr_stmt|;
break|break;
case|case
literal|0x26
case|:
name|prefixes
operator||=
name|PREFIX_ES
expr_stmt|;
break|break;
case|case
literal|0x64
case|:
name|prefixes
operator||=
name|PREFIX_FS
expr_stmt|;
break|break;
case|case
literal|0x65
case|:
name|prefixes
operator||=
name|PREFIX_GS
expr_stmt|;
break|break;
case|case
literal|0x66
case|:
name|prefixes
operator||=
name|PREFIX_DATA
expr_stmt|;
break|break;
case|case
literal|0x67
case|:
name|prefixes
operator||=
name|PREFIX_ADR
expr_stmt|;
break|break;
case|case
literal|0x9b
case|:
name|prefixes
operator||=
name|PREFIX_FWAIT
expr_stmt|;
break|break;
default|default:
return|return;
block|}
name|codep
operator|++
expr_stmt|;
block|}
block|}
end_function

begin_decl_stmt
specifier|static
name|char
name|op1out
index|[
literal|100
index|]
decl_stmt|,
name|op2out
index|[
literal|100
index|]
decl_stmt|,
name|op3out
index|[
literal|100
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|op_address
index|[
literal|3
index|]
decl_stmt|,
name|op_ad
decl_stmt|,
name|op_index
index|[
literal|3
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|start_pc
decl_stmt|;
end_decl_stmt

begin_escape
end_escape

begin_comment
comment|/*  *   On the 386's of 1988, the maximum length of an instruction is 15 bytes.  *   (see topic "Redundant prefixes" in the "Differences from 8086"  *   section of the "Virtual 8086 Mode" chapter.)  * 'pc' should be the address of this instruction, it will  *   be used to print the target address if this is a relative jump or call  * The function returns the length of this instruction in bytes.  */
end_comment

begin_decl_stmt
name|int
name|print_insn_x86
name|PARAMS
argument_list|(
operator|(
name|bfd_vma
name|pc
operator|,
name|disassemble_info
operator|*
name|info
operator|,
name|int
name|aflag
operator|,
name|int
name|dflag
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_function
name|int
name|print_insn_i386
parameter_list|(
name|pc
parameter_list|,
name|info
parameter_list|)
name|bfd_vma
name|pc
decl_stmt|;
name|disassemble_info
modifier|*
name|info
decl_stmt|;
block|{
if|if
condition|(
name|info
operator|->
name|mach
operator|==
name|bfd_mach_i386_i386
condition|)
return|return
name|print_insn_x86
argument_list|(
name|pc
argument_list|,
name|info
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
return|;
elseif|else
if|if
condition|(
name|info
operator|->
name|mach
operator|==
name|bfd_mach_i386_i8086
condition|)
return|return
name|print_insn_x86
argument_list|(
name|pc
argument_list|,
name|info
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
return|;
else|else
name|abort
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
name|int
name|print_insn_x86
parameter_list|(
name|pc
parameter_list|,
name|info
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|bfd_vma
name|pc
decl_stmt|;
name|disassemble_info
modifier|*
name|info
decl_stmt|;
block|{
name|struct
name|dis386
modifier|*
name|dp
decl_stmt|;
name|int
name|i
decl_stmt|;
name|int
name|enter_instruction
decl_stmt|;
name|char
modifier|*
name|first
decl_stmt|,
modifier|*
name|second
decl_stmt|,
modifier|*
name|third
decl_stmt|;
name|int
name|needcomma
decl_stmt|;
name|unsigned
name|char
name|need_modrm
decl_stmt|;
name|struct
name|dis_private
name|priv
decl_stmt|;
name|bfd_byte
modifier|*
name|inbuf
init|=
name|priv
operator|.
name|the_buffer
decl_stmt|;
comment|/* The output looks better if we put 5 bytes on a line, since that      puts long word instructions on a single line.  */
name|info
operator|->
name|bytes_per_line
operator|=
literal|5
expr_stmt|;
name|info
operator|->
name|private_data
operator|=
operator|(
name|PTR
operator|)
operator|&
name|priv
expr_stmt|;
name|priv
operator|.
name|max_fetched
operator|=
name|priv
operator|.
name|the_buffer
expr_stmt|;
name|priv
operator|.
name|insn_start
operator|=
name|pc
expr_stmt|;
if|if
condition|(
name|setjmp
argument_list|(
name|priv
operator|.
name|bailout
argument_list|)
operator|!=
literal|0
condition|)
comment|/* Error return.  */
return|return
operator|-
literal|1
return|;
name|obuf
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|op1out
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|op2out
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|op3out
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|op_index
index|[
literal|0
index|]
operator|=
name|op_index
index|[
literal|1
index|]
operator|=
name|op_index
index|[
literal|2
index|]
operator|=
operator|-
literal|1
expr_stmt|;
name|the_info
operator|=
name|info
expr_stmt|;
name|start_pc
operator|=
name|pc
expr_stmt|;
name|start_codep
operator|=
name|inbuf
expr_stmt|;
name|codep
operator|=
name|inbuf
expr_stmt|;
name|ckprefix
argument_list|()
expr_stmt|;
name|FETCH_DATA
argument_list|(
name|info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
name|codep
operator|==
literal|0xc8
condition|)
name|enter_instruction
operator|=
literal|1
expr_stmt|;
else|else
name|enter_instruction
operator|=
literal|0
expr_stmt|;
name|obufp
operator|=
name|obuf
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_REPZ
condition|)
name|oappend
argument_list|(
literal|"repz "
argument_list|)
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_REPNZ
condition|)
name|oappend
argument_list|(
literal|"repnz "
argument_list|)
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_LOCK
condition|)
name|oappend
argument_list|(
literal|"lock "
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|prefixes
operator|&
name|PREFIX_FWAIT
operator|)
operator|&&
operator|(
operator|(
operator|*
name|codep
operator|<
literal|0xd8
operator|)
operator|||
operator|(
operator|*
name|codep
operator|>
literal|0xdf
operator|)
operator|)
condition|)
block|{
comment|/* fwait not followed by floating point instruction */
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|"fwait"
argument_list|)
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_DATA
condition|)
name|dflag
operator|^=
literal|1
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_ADR
condition|)
block|{
name|aflag
operator|^=
literal|1
expr_stmt|;
name|oappend
argument_list|(
literal|"addr16 "
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|*
name|codep
operator|==
literal|0x0f
condition|)
block|{
name|FETCH_DATA
argument_list|(
name|info
argument_list|,
name|codep
operator|+
literal|2
argument_list|)
expr_stmt|;
name|dp
operator|=
operator|&
name|dis386_twobyte
index|[
operator|*
operator|++
name|codep
index|]
expr_stmt|;
name|need_modrm
operator|=
name|twobyte_has_modrm
index|[
operator|*
name|codep
index|]
expr_stmt|;
block|}
else|else
block|{
name|dp
operator|=
operator|&
name|dis386
index|[
operator|*
name|codep
index|]
expr_stmt|;
name|need_modrm
operator|=
name|onebyte_has_modrm
index|[
operator|*
name|codep
index|]
expr_stmt|;
block|}
name|codep
operator|++
expr_stmt|;
if|if
condition|(
name|need_modrm
condition|)
block|{
name|FETCH_DATA
argument_list|(
name|info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|mod
operator|=
operator|(
operator|*
name|codep
operator|>>
literal|6
operator|)
operator|&
literal|3
expr_stmt|;
name|reg
operator|=
operator|(
operator|*
name|codep
operator|>>
literal|3
operator|)
operator|&
literal|7
expr_stmt|;
name|rm
operator|=
operator|*
name|codep
operator|&
literal|7
expr_stmt|;
block|}
if|if
condition|(
name|dp
operator|->
name|name
operator|==
name|NULL
operator|&&
name|dp
operator|->
name|bytemode1
operator|==
name|FLOATCODE
condition|)
block|{
name|dofloat
argument_list|(
name|aflag
argument_list|,
name|dflag
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|dp
operator|->
name|name
operator|==
name|NULL
condition|)
name|dp
operator|=
operator|&
name|grps
index|[
name|dp
operator|->
name|bytemode1
index|]
index|[
name|reg
index|]
expr_stmt|;
name|putop
argument_list|(
name|dp
operator|->
name|name
argument_list|,
name|aflag
argument_list|,
name|dflag
argument_list|)
expr_stmt|;
name|obufp
operator|=
name|op1out
expr_stmt|;
name|op_ad
operator|=
literal|2
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|op1
condition|)
call|(
modifier|*
name|dp
operator|->
name|op1
call|)
argument_list|(
name|dp
operator|->
name|bytemode1
argument_list|,
name|aflag
argument_list|,
name|dflag
argument_list|)
expr_stmt|;
name|obufp
operator|=
name|op2out
expr_stmt|;
name|op_ad
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|op2
condition|)
call|(
modifier|*
name|dp
operator|->
name|op2
call|)
argument_list|(
name|dp
operator|->
name|bytemode2
argument_list|,
name|aflag
argument_list|,
name|dflag
argument_list|)
expr_stmt|;
name|obufp
operator|=
name|op3out
expr_stmt|;
name|op_ad
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|op3
condition|)
call|(
modifier|*
name|dp
operator|->
name|op3
call|)
argument_list|(
name|dp
operator|->
name|bytemode3
argument_list|,
name|aflag
argument_list|,
name|dflag
argument_list|)
expr_stmt|;
block|}
name|obufp
operator|=
name|obuf
operator|+
name|strlen
argument_list|(
name|obuf
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
name|strlen
argument_list|(
name|obuf
argument_list|)
init|;
name|i
operator|<
literal|6
condition|;
name|i
operator|++
control|)
name|oappend
argument_list|(
literal|" "
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
literal|" "
argument_list|)
expr_stmt|;
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|"%s"
argument_list|,
name|obuf
argument_list|)
expr_stmt|;
comment|/* enter instruction is printed with operands in the    * same order as the intel book; everything else    * is printed in reverse order     */
if|if
condition|(
name|enter_instruction
condition|)
block|{
name|first
operator|=
name|op1out
expr_stmt|;
name|second
operator|=
name|op2out
expr_stmt|;
name|third
operator|=
name|op3out
expr_stmt|;
name|op_ad
operator|=
name|op_index
index|[
literal|0
index|]
expr_stmt|;
name|op_index
index|[
literal|0
index|]
operator|=
name|op_index
index|[
literal|2
index|]
expr_stmt|;
name|op_index
index|[
literal|2
index|]
operator|=
name|op_ad
expr_stmt|;
block|}
else|else
block|{
name|first
operator|=
name|op3out
expr_stmt|;
name|second
operator|=
name|op2out
expr_stmt|;
name|third
operator|=
name|op1out
expr_stmt|;
block|}
name|needcomma
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|*
name|first
condition|)
block|{
if|if
condition|(
name|op_index
index|[
literal|0
index|]
operator|!=
operator|-
literal|1
condition|)
call|(
modifier|*
name|info
operator|->
name|print_address_func
call|)
argument_list|(
name|op_address
index|[
name|op_index
index|[
literal|0
index|]
index|]
argument_list|,
name|info
argument_list|)
expr_stmt|;
else|else
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|"%s"
argument_list|,
name|first
argument_list|)
expr_stmt|;
name|needcomma
operator|=
literal|1
expr_stmt|;
block|}
if|if
condition|(
operator|*
name|second
condition|)
block|{
if|if
condition|(
name|needcomma
condition|)
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|","
argument_list|)
expr_stmt|;
if|if
condition|(
name|op_index
index|[
literal|1
index|]
operator|!=
operator|-
literal|1
condition|)
call|(
modifier|*
name|info
operator|->
name|print_address_func
call|)
argument_list|(
name|op_address
index|[
name|op_index
index|[
literal|1
index|]
index|]
argument_list|,
name|info
argument_list|)
expr_stmt|;
else|else
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|"%s"
argument_list|,
name|second
argument_list|)
expr_stmt|;
name|needcomma
operator|=
literal|1
expr_stmt|;
block|}
if|if
condition|(
operator|*
name|third
condition|)
block|{
if|if
condition|(
name|needcomma
condition|)
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|","
argument_list|)
expr_stmt|;
if|if
condition|(
name|op_index
index|[
literal|2
index|]
operator|!=
operator|-
literal|1
condition|)
call|(
modifier|*
name|info
operator|->
name|print_address_func
call|)
argument_list|(
name|op_address
index|[
name|op_index
index|[
literal|2
index|]
index|]
argument_list|,
name|info
argument_list|)
expr_stmt|;
else|else
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|"%s"
argument_list|,
name|third
argument_list|)
expr_stmt|;
block|}
return|return
operator|(
name|codep
operator|-
name|inbuf
operator|)
return|;
block|}
end_function

begin_decl_stmt
specifier|static
name|char
modifier|*
name|float_mem
index|[]
init|=
block|{
comment|/* d8 */
literal|"fadds"
block|,
literal|"fmuls"
block|,
literal|"fcoms"
block|,
literal|"fcomps"
block|,
literal|"fsubs"
block|,
literal|"fsubrs"
block|,
literal|"fdivs"
block|,
literal|"fdivrs"
block|,
comment|/*  d9 */
literal|"flds"
block|,
literal|"(bad)"
block|,
literal|"fsts"
block|,
literal|"fstps"
block|,
literal|"fldenv"
block|,
literal|"fldcw"
block|,
literal|"fNstenv"
block|,
literal|"fNstcw"
block|,
comment|/* da */
literal|"fiaddl"
block|,
literal|"fimull"
block|,
literal|"ficoml"
block|,
literal|"ficompl"
block|,
literal|"fisubl"
block|,
literal|"fisubrl"
block|,
literal|"fidivl"
block|,
literal|"fidivrl"
block|,
comment|/* db */
literal|"fildl"
block|,
literal|"(bad)"
block|,
literal|"fistl"
block|,
literal|"fistpl"
block|,
literal|"(bad)"
block|,
literal|"fldt"
block|,
literal|"(bad)"
block|,
literal|"fstpt"
block|,
comment|/* dc */
literal|"faddl"
block|,
literal|"fmull"
block|,
literal|"fcoml"
block|,
literal|"fcompl"
block|,
literal|"fsubl"
block|,
literal|"fsubrl"
block|,
literal|"fdivl"
block|,
literal|"fdivrl"
block|,
comment|/* dd */
literal|"fldl"
block|,
literal|"(bad)"
block|,
literal|"fstl"
block|,
literal|"fstpl"
block|,
literal|"frstor"
block|,
literal|"(bad)"
block|,
literal|"fNsave"
block|,
literal|"fNstsw"
block|,
comment|/* de */
literal|"fiadd"
block|,
literal|"fimul"
block|,
literal|"ficom"
block|,
literal|"ficomp"
block|,
literal|"fisub"
block|,
literal|"fisubr"
block|,
literal|"fidiv"
block|,
literal|"fidivr"
block|,
comment|/* df */
literal|"fild"
block|,
literal|"(bad)"
block|,
literal|"fist"
block|,
literal|"fistp"
block|,
literal|"fbld"
block|,
literal|"fildll"
block|,
literal|"fbstp"
block|,
literal|"fistpll"
block|, }
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|ST
value|OP_ST, 0
end_define

begin_define
define|#
directive|define
name|STi
value|OP_STi, 0
end_define

begin_define
define|#
directive|define
name|FGRPd9_2
value|NULL, NULL, 0
end_define

begin_define
define|#
directive|define
name|FGRPd9_4
value|NULL, NULL, 1
end_define

begin_define
define|#
directive|define
name|FGRPd9_5
value|NULL, NULL, 2
end_define

begin_define
define|#
directive|define
name|FGRPd9_6
value|NULL, NULL, 3
end_define

begin_define
define|#
directive|define
name|FGRPd9_7
value|NULL, NULL, 4
end_define

begin_define
define|#
directive|define
name|FGRPda_5
value|NULL, NULL, 5
end_define

begin_define
define|#
directive|define
name|FGRPdb_4
value|NULL, NULL, 6
end_define

begin_define
define|#
directive|define
name|FGRPde_3
value|NULL, NULL, 7
end_define

begin_define
define|#
directive|define
name|FGRPdf_4
value|NULL, NULL, 8
end_define

begin_decl_stmt
specifier|static
name|struct
name|dis386
name|float_reg
index|[]
index|[
literal|8
index|]
init|=
block|{
comment|/* d8 */
block|{
block|{
literal|"fadd"
block|,
name|ST
block|,
name|STi
block|}
block|,
block|{
literal|"fmul"
block|,
name|ST
block|,
name|STi
block|}
block|,
block|{
literal|"fcom"
block|,
name|STi
block|}
block|,
block|{
literal|"fcomp"
block|,
name|STi
block|}
block|,
block|{
literal|"fsub"
block|,
name|ST
block|,
name|STi
block|}
block|,
block|{
literal|"fsubr"
block|,
name|ST
block|,
name|STi
block|}
block|,
block|{
literal|"fdiv"
block|,
name|ST
block|,
name|STi
block|}
block|,
block|{
literal|"fdivr"
block|,
name|ST
block|,
name|STi
block|}
block|,   }
block|,
comment|/* d9 */
block|{
block|{
literal|"fld"
block|,
name|STi
block|}
block|,
block|{
literal|"fxch"
block|,
name|STi
block|}
block|,
block|{
name|FGRPd9_2
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
name|FGRPd9_4
block|}
block|,
block|{
name|FGRPd9_5
block|}
block|,
block|{
name|FGRPd9_6
block|}
block|,
block|{
name|FGRPd9_7
block|}
block|,   }
block|,
comment|/* da */
block|{
block|{
literal|"fcmovb"
block|,
name|ST
block|,
name|STi
block|}
block|,
block|{
literal|"fcmove"
block|,
name|ST
block|,
name|STi
block|}
block|,
block|{
literal|"fcmovbe"
block|,
name|ST
block|,
name|STi
block|}
block|,
block|{
literal|"fcmovu"
block|,
name|ST
block|,
name|STi
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
name|FGRPda_5
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,   }
block|,
comment|/* db */
block|{
block|{
literal|"fcmovnb"
block|,
name|ST
block|,
name|STi
block|}
block|,
block|{
literal|"fcmovne"
block|,
name|ST
block|,
name|STi
block|}
block|,
block|{
literal|"fcmovnbe"
block|,
name|ST
block|,
name|STi
block|}
block|,
block|{
literal|"fcmovnu"
block|,
name|ST
block|,
name|STi
block|}
block|,
block|{
name|FGRPdb_4
block|}
block|,
block|{
literal|"fucomi"
block|,
name|ST
block|,
name|STi
block|}
block|,
block|{
literal|"fcomi"
block|,
name|ST
block|,
name|STi
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,   }
block|,
comment|/* dc */
block|{
block|{
literal|"fadd"
block|,
name|STi
block|,
name|ST
block|}
block|,
block|{
literal|"fmul"
block|,
name|STi
block|,
name|ST
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"fsub"
block|,
name|STi
block|,
name|ST
block|}
block|,
block|{
literal|"fsubr"
block|,
name|STi
block|,
name|ST
block|}
block|,
block|{
literal|"fdiv"
block|,
name|STi
block|,
name|ST
block|}
block|,
block|{
literal|"fdivr"
block|,
name|STi
block|,
name|ST
block|}
block|,   }
block|,
comment|/* dd */
block|{
block|{
literal|"ffree"
block|,
name|STi
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"fst"
block|,
name|STi
block|}
block|,
block|{
literal|"fstp"
block|,
name|STi
block|}
block|,
block|{
literal|"fucom"
block|,
name|STi
block|}
block|,
block|{
literal|"fucomp"
block|,
name|STi
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,   }
block|,
comment|/* de */
block|{
block|{
literal|"faddp"
block|,
name|STi
block|,
name|ST
block|}
block|,
block|{
literal|"fmulp"
block|,
name|STi
block|,
name|ST
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
name|FGRPde_3
block|}
block|,
block|{
literal|"fsubp"
block|,
name|STi
block|,
name|ST
block|}
block|,
block|{
literal|"fsubrp"
block|,
name|STi
block|,
name|ST
block|}
block|,
block|{
literal|"fdivp"
block|,
name|STi
block|,
name|ST
block|}
block|,
block|{
literal|"fdivrp"
block|,
name|STi
block|,
name|ST
block|}
block|,   }
block|,
comment|/* df */
block|{
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,
block|{
name|FGRPdf_4
block|}
block|,
block|{
literal|"fucomip"
block|,
name|ST
block|,
name|STi
block|}
block|,
block|{
literal|"fcomip"
block|,
name|ST
block|,
name|STi
block|}
block|,
block|{
literal|"(bad)"
block|}
block|,   }
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|fgrps
index|[]
index|[
literal|8
index|]
init|=
block|{
comment|/* d9_2  0 */
block|{
literal|"fnop"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,   }
block|,
comment|/* d9_4  1 */
block|{
literal|"fchs"
block|,
literal|"fabs"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"ftst"
block|,
literal|"fxam"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,   }
block|,
comment|/* d9_5  2 */
block|{
literal|"fld1"
block|,
literal|"fldl2t"
block|,
literal|"fldl2e"
block|,
literal|"fldpi"
block|,
literal|"fldlg2"
block|,
literal|"fldln2"
block|,
literal|"fldz"
block|,
literal|"(bad)"
block|,   }
block|,
comment|/* d9_6  3 */
block|{
literal|"f2xm1"
block|,
literal|"fyl2x"
block|,
literal|"fptan"
block|,
literal|"fpatan"
block|,
literal|"fxtract"
block|,
literal|"fprem1"
block|,
literal|"fdecstp"
block|,
literal|"fincstp"
block|,   }
block|,
comment|/* d9_7  4 */
block|{
literal|"fprem"
block|,
literal|"fyl2xp1"
block|,
literal|"fsqrt"
block|,
literal|"fsincos"
block|,
literal|"frndint"
block|,
literal|"fscale"
block|,
literal|"fsin"
block|,
literal|"fcos"
block|,   }
block|,
comment|/* da_5  5 */
block|{
literal|"(bad)"
block|,
literal|"fucompp"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,   }
block|,
comment|/* db_4  6 */
block|{
literal|"feni(287 only)"
block|,
literal|"fdisi(287 only)"
block|,
literal|"fNclex"
block|,
literal|"fNinit"
block|,
literal|"fNsetpm(287 only)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,   }
block|,
comment|/* de_3  7 */
block|{
literal|"(bad)"
block|,
literal|"fcompp"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,   }
block|,
comment|/* df_4  8 */
block|{
literal|"fNstsw"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,   }
block|, }
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
name|dofloat
parameter_list|(
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|struct
name|dis386
modifier|*
name|dp
decl_stmt|;
name|unsigned
name|char
name|floatop
decl_stmt|;
name|floatop
operator|=
name|codep
index|[
operator|-
literal|1
index|]
expr_stmt|;
if|if
condition|(
name|mod
operator|!=
literal|3
condition|)
block|{
name|putop
argument_list|(
name|float_mem
index|[
operator|(
name|floatop
operator|-
literal|0xd8
operator|)
operator|*
literal|8
operator|+
name|reg
index|]
argument_list|,
name|aflag
argument_list|,
name|dflag
argument_list|)
expr_stmt|;
name|obufp
operator|=
name|op1out
expr_stmt|;
name|OP_E
argument_list|(
name|v_mode
argument_list|,
name|aflag
argument_list|,
name|dflag
argument_list|)
expr_stmt|;
return|return;
block|}
name|codep
operator|++
expr_stmt|;
name|dp
operator|=
operator|&
name|float_reg
index|[
name|floatop
operator|-
literal|0xd8
index|]
index|[
name|reg
index|]
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|name
operator|==
name|NULL
condition|)
block|{
name|putop
argument_list|(
name|fgrps
index|[
name|dp
operator|->
name|bytemode1
index|]
index|[
name|rm
index|]
argument_list|,
name|aflag
argument_list|,
name|dflag
argument_list|)
expr_stmt|;
comment|/* instruction fnstsw is only one with strange arg */
if|if
condition|(
name|floatop
operator|==
literal|0xdf
operator|&&
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
operator|&&
operator|*
name|codep
operator|==
literal|0xe0
condition|)
name|strcpy
argument_list|(
name|op1out
argument_list|,
literal|"%eax"
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|putop
argument_list|(
name|dp
operator|->
name|name
argument_list|,
name|aflag
argument_list|,
name|dflag
argument_list|)
expr_stmt|;
name|obufp
operator|=
name|op1out
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|op1
condition|)
call|(
modifier|*
name|dp
operator|->
name|op1
call|)
argument_list|(
name|dp
operator|->
name|bytemode1
argument_list|,
name|aflag
argument_list|,
name|dflag
argument_list|)
expr_stmt|;
name|obufp
operator|=
name|op2out
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|op2
condition|)
call|(
modifier|*
name|dp
operator|->
name|op2
call|)
argument_list|(
name|dp
operator|->
name|bytemode2
argument_list|,
name|aflag
argument_list|,
name|dflag
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* ARGSUSED */
end_comment

begin_function
specifier|static
name|int
name|OP_ST
parameter_list|(
name|ignore
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|ignore
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|oappend
argument_list|(
literal|"%st"
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/* ARGSUSED */
end_comment

begin_function
specifier|static
name|int
name|OP_STi
parameter_list|(
name|ignore
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|ignore
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%%st(%d)"
argument_list|,
name|rm
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/* capital letters in template are macros */
end_comment

begin_function
specifier|static
name|void
name|putop
parameter_list|(
name|template
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|char
modifier|*
name|template
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|char
modifier|*
name|p
decl_stmt|;
for|for
control|(
name|p
operator|=
name|template
init|;
operator|*
name|p
condition|;
name|p
operator|++
control|)
block|{
switch|switch
condition|(
operator|*
name|p
condition|)
block|{
default|default:
operator|*
name|obufp
operator|++
operator|=
operator|*
name|p
expr_stmt|;
break|break;
case|case
literal|'C'
case|:
comment|/* For jcxz/jecxz */
if|if
condition|(
name|aflag
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'e'
expr_stmt|;
break|break;
case|case
literal|'N'
case|:
if|if
condition|(
operator|(
name|prefixes
operator|&
name|PREFIX_FWAIT
operator|)
operator|==
literal|0
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'n'
expr_stmt|;
break|break;
case|case
literal|'S'
case|:
comment|/* operand size flag */
if|if
condition|(
name|dflag
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'l'
expr_stmt|;
else|else
operator|*
name|obufp
operator|++
operator|=
literal|'w'
expr_stmt|;
break|break;
block|}
block|}
operator|*
name|obufp
operator|=
literal|0
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|oappend
parameter_list|(
name|s
parameter_list|)
name|char
modifier|*
name|s
decl_stmt|;
block|{
name|strcpy
argument_list|(
name|obufp
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|obufp
operator|+=
name|strlen
argument_list|(
name|s
argument_list|)
expr_stmt|;
operator|*
name|obufp
operator|=
literal|0
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|append_prefix
parameter_list|()
block|{
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_CS
condition|)
name|oappend
argument_list|(
literal|"%cs:"
argument_list|)
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_DS
condition|)
name|oappend
argument_list|(
literal|"%ds:"
argument_list|)
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_SS
condition|)
name|oappend
argument_list|(
literal|"%ss:"
argument_list|)
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_ES
condition|)
name|oappend
argument_list|(
literal|"%es:"
argument_list|)
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_FS
condition|)
name|oappend
argument_list|(
literal|"%fs:"
argument_list|)
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_GS
condition|)
name|oappend
argument_list|(
literal|"%gs:"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|int
name|OP_indirE
parameter_list|(
name|bytemode
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|oappend
argument_list|(
literal|"*"
argument_list|)
expr_stmt|;
return|return
name|OP_E
argument_list|(
name|bytemode
argument_list|,
name|aflag
argument_list|,
name|dflag
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|OP_E
parameter_list|(
name|bytemode
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|int
name|disp
decl_stmt|;
comment|/* skip mod/rm byte */
name|codep
operator|++
expr_stmt|;
if|if
condition|(
name|mod
operator|==
literal|3
condition|)
block|{
switch|switch
condition|(
name|bytemode
condition|)
block|{
case|case
name|b_mode
case|:
name|oappend
argument_list|(
name|names8
index|[
name|rm
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|w_mode
case|:
name|oappend
argument_list|(
name|names16
index|[
name|rm
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|v_mode
case|:
if|if
condition|(
name|dflag
condition|)
name|oappend
argument_list|(
name|names32
index|[
name|rm
index|]
argument_list|)
expr_stmt|;
else|else
name|oappend
argument_list|(
name|names16
index|[
name|rm
index|]
argument_list|)
expr_stmt|;
break|break;
default|default:
name|oappend
argument_list|(
literal|"<bad dis table>"
argument_list|)
expr_stmt|;
break|break;
block|}
return|return
literal|0
return|;
block|}
name|disp
operator|=
literal|0
expr_stmt|;
name|append_prefix
argument_list|()
expr_stmt|;
if|if
condition|(
name|aflag
condition|)
comment|/* 32 bit address mode */
block|{
name|int
name|havesib
decl_stmt|;
name|int
name|havebase
decl_stmt|;
name|int
name|base
decl_stmt|;
name|int
name|index
decl_stmt|;
name|int
name|scale
decl_stmt|;
name|havesib
operator|=
literal|0
expr_stmt|;
name|havebase
operator|=
literal|1
expr_stmt|;
name|base
operator|=
name|rm
expr_stmt|;
if|if
condition|(
name|base
operator|==
literal|4
condition|)
block|{
name|havesib
operator|=
literal|1
expr_stmt|;
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|scale
operator|=
operator|(
operator|*
name|codep
operator|>>
literal|6
operator|)
operator|&
literal|3
expr_stmt|;
name|index
operator|=
operator|(
operator|*
name|codep
operator|>>
literal|3
operator|)
operator|&
literal|7
expr_stmt|;
name|base
operator|=
operator|*
name|codep
operator|&
literal|7
expr_stmt|;
name|codep
operator|++
expr_stmt|;
block|}
switch|switch
condition|(
name|mod
condition|)
block|{
case|case
literal|0
case|:
if|if
condition|(
name|base
operator|==
literal|5
condition|)
block|{
name|havebase
operator|=
literal|0
expr_stmt|;
name|disp
operator|=
name|get32
argument_list|()
expr_stmt|;
block|}
break|break;
case|case
literal|1
case|:
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|disp
operator|=
operator|*
operator|(
name|char
operator|*
operator|)
name|codep
operator|++
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|disp
operator|=
name|get32
argument_list|()
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|mod
operator|!=
literal|0
operator|||
name|base
operator|==
literal|5
condition|)
block|{
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"0x%x"
argument_list|,
name|disp
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|havebase
operator|||
operator|(
name|havesib
operator|&&
operator|(
name|index
operator|!=
literal|4
operator|||
name|scale
operator|!=
literal|0
operator|)
operator|)
condition|)
block|{
name|oappend
argument_list|(
literal|"("
argument_list|)
expr_stmt|;
if|if
condition|(
name|havebase
condition|)
name|oappend
argument_list|(
name|names32
index|[
name|base
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|havesib
condition|)
block|{
if|if
condition|(
name|index
operator|!=
literal|4
condition|)
block|{
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|",%s"
argument_list|,
name|names32
index|[
name|index
index|]
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
block|}
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|",%d"
argument_list|,
literal|1
operator|<<
name|scale
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
block|}
name|oappend
argument_list|(
literal|")"
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
comment|/* 16 bit address mode */
switch|switch
condition|(
name|mod
condition|)
block|{
case|case
literal|0
case|:
if|if
condition|(
name|rm
operator|==
literal|6
condition|)
name|disp
operator|=
operator|(
name|short
operator|)
name|get16
argument_list|()
expr_stmt|;
break|break;
case|case
literal|1
case|:
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|disp
operator|=
operator|*
operator|(
name|char
operator|*
operator|)
name|codep
operator|++
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|disp
operator|=
operator|(
name|short
operator|)
name|get16
argument_list|()
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|mod
operator|!=
literal|0
operator|||
name|rm
operator|==
literal|6
condition|)
block|{
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"0x%x"
argument_list|,
name|disp
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|mod
operator|!=
literal|0
operator|||
name|rm
operator|!=
literal|6
condition|)
block|{
name|oappend
argument_list|(
literal|"("
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|index16
index|[
name|rm
index|]
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
literal|")"
argument_list|)
expr_stmt|;
block|}
block|}
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|OP_G
parameter_list|(
name|bytemode
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
switch|switch
condition|(
name|bytemode
condition|)
block|{
case|case
name|b_mode
case|:
name|oappend
argument_list|(
name|names8
index|[
name|reg
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|w_mode
case|:
name|oappend
argument_list|(
name|names16
index|[
name|reg
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|d_mode
case|:
name|oappend
argument_list|(
name|names32
index|[
name|reg
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|v_mode
case|:
if|if
condition|(
name|dflag
condition|)
name|oappend
argument_list|(
name|names32
index|[
name|reg
index|]
argument_list|)
expr_stmt|;
else|else
name|oappend
argument_list|(
name|names16
index|[
name|reg
index|]
argument_list|)
expr_stmt|;
break|break;
default|default:
name|oappend
argument_list|(
literal|"<internal disassembler error>"
argument_list|)
expr_stmt|;
break|break;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|get32
parameter_list|()
block|{
name|int
name|x
init|=
literal|0
decl_stmt|;
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|4
argument_list|)
expr_stmt|;
name|x
operator|=
operator|*
name|codep
operator|++
operator|&
literal|0xff
expr_stmt|;
name|x
operator||=
operator|(
operator|*
name|codep
operator|++
operator|&
literal|0xff
operator|)
operator|<<
literal|8
expr_stmt|;
name|x
operator||=
operator|(
operator|*
name|codep
operator|++
operator|&
literal|0xff
operator|)
operator|<<
literal|16
expr_stmt|;
name|x
operator||=
operator|(
operator|*
name|codep
operator|++
operator|&
literal|0xff
operator|)
operator|<<
literal|24
expr_stmt|;
return|return
operator|(
name|x
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|get16
parameter_list|()
block|{
name|int
name|x
init|=
literal|0
decl_stmt|;
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|2
argument_list|)
expr_stmt|;
name|x
operator|=
operator|*
name|codep
operator|++
operator|&
literal|0xff
expr_stmt|;
name|x
operator||=
operator|(
operator|*
name|codep
operator|++
operator|&
literal|0xff
operator|)
operator|<<
literal|8
expr_stmt|;
return|return
operator|(
name|x
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|set_op
parameter_list|(
name|op
parameter_list|)
name|int
name|op
decl_stmt|;
block|{
name|op_index
index|[
name|op_ad
index|]
operator|=
name|op_ad
expr_stmt|;
name|op_address
index|[
name|op_ad
index|]
operator|=
name|op
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|int
name|OP_REG
parameter_list|(
name|code
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|code
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|char
modifier|*
name|s
decl_stmt|;
switch|switch
condition|(
name|code
condition|)
block|{
case|case
name|indir_dx_reg
case|:
name|s
operator|=
literal|"(%dx)"
expr_stmt|;
break|break;
case|case
name|ax_reg
case|:
case|case
name|cx_reg
case|:
case|case
name|dx_reg
case|:
case|case
name|bx_reg
case|:
case|case
name|sp_reg
case|:
case|case
name|bp_reg
case|:
case|case
name|si_reg
case|:
case|case
name|di_reg
case|:
name|s
operator|=
name|names16
index|[
name|code
operator|-
name|ax_reg
index|]
expr_stmt|;
break|break;
case|case
name|es_reg
case|:
case|case
name|ss_reg
case|:
case|case
name|cs_reg
case|:
case|case
name|ds_reg
case|:
case|case
name|fs_reg
case|:
case|case
name|gs_reg
case|:
name|s
operator|=
name|names_seg
index|[
name|code
operator|-
name|es_reg
index|]
expr_stmt|;
break|break;
case|case
name|al_reg
case|:
case|case
name|ah_reg
case|:
case|case
name|cl_reg
case|:
case|case
name|ch_reg
case|:
case|case
name|dl_reg
case|:
case|case
name|dh_reg
case|:
case|case
name|bl_reg
case|:
case|case
name|bh_reg
case|:
name|s
operator|=
name|names8
index|[
name|code
operator|-
name|al_reg
index|]
expr_stmt|;
break|break;
case|case
name|eAX_reg
case|:
case|case
name|eCX_reg
case|:
case|case
name|eDX_reg
case|:
case|case
name|eBX_reg
case|:
case|case
name|eSP_reg
case|:
case|case
name|eBP_reg
case|:
case|case
name|eSI_reg
case|:
case|case
name|eDI_reg
case|:
if|if
condition|(
name|dflag
condition|)
name|s
operator|=
name|names32
index|[
name|code
operator|-
name|eAX_reg
index|]
expr_stmt|;
else|else
name|s
operator|=
name|names16
index|[
name|code
operator|-
name|eAX_reg
index|]
expr_stmt|;
break|break;
default|default:
name|s
operator|=
literal|"<internal disassembler error>"
expr_stmt|;
break|break;
block|}
name|oappend
argument_list|(
name|s
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|OP_I
parameter_list|(
name|bytemode
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|int
name|op
decl_stmt|;
switch|switch
condition|(
name|bytemode
condition|)
block|{
case|case
name|b_mode
case|:
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|op
operator|=
operator|*
name|codep
operator|++
operator|&
literal|0xff
expr_stmt|;
break|break;
case|case
name|v_mode
case|:
if|if
condition|(
name|dflag
condition|)
name|op
operator|=
name|get32
argument_list|()
expr_stmt|;
else|else
name|op
operator|=
name|get16
argument_list|()
expr_stmt|;
break|break;
case|case
name|w_mode
case|:
name|op
operator|=
name|get16
argument_list|()
expr_stmt|;
break|break;
default|default:
name|oappend
argument_list|(
literal|"<internal disassembler error>"
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"$0x%x"
argument_list|,
name|op
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|OP_sI
parameter_list|(
name|bytemode
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|int
name|op
decl_stmt|;
switch|switch
condition|(
name|bytemode
condition|)
block|{
case|case
name|b_mode
case|:
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|op
operator|=
operator|*
operator|(
name|char
operator|*
operator|)
name|codep
operator|++
expr_stmt|;
break|break;
case|case
name|v_mode
case|:
if|if
condition|(
name|dflag
condition|)
name|op
operator|=
name|get32
argument_list|()
expr_stmt|;
else|else
name|op
operator|=
operator|(
name|short
operator|)
name|get16
argument_list|()
expr_stmt|;
break|break;
case|case
name|w_mode
case|:
name|op
operator|=
operator|(
name|short
operator|)
name|get16
argument_list|()
expr_stmt|;
break|break;
default|default:
name|oappend
argument_list|(
literal|"<internal disassembler error>"
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"$0x%x"
argument_list|,
name|op
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|OP_J
parameter_list|(
name|bytemode
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|int
name|disp
decl_stmt|;
name|int
name|mask
init|=
operator|-
literal|1
decl_stmt|;
switch|switch
condition|(
name|bytemode
condition|)
block|{
case|case
name|b_mode
case|:
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|disp
operator|=
operator|*
operator|(
name|char
operator|*
operator|)
name|codep
operator|++
expr_stmt|;
break|break;
case|case
name|v_mode
case|:
if|if
condition|(
name|dflag
condition|)
name|disp
operator|=
name|get32
argument_list|()
expr_stmt|;
else|else
block|{
name|disp
operator|=
operator|(
name|short
operator|)
name|get16
argument_list|()
expr_stmt|;
comment|/* for some reason, a data16 prefix on a jump instruction 	     means that the pc is masked to 16 bits after the 	     displacement is added!  */
name|mask
operator|=
literal|0xffff
expr_stmt|;
block|}
break|break;
default|default:
name|oappend
argument_list|(
literal|"<internal disassembler error>"
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
name|disp
operator|=
operator|(
name|start_pc
operator|+
name|codep
operator|-
name|start_codep
operator|+
name|disp
operator|)
operator|&
name|mask
expr_stmt|;
name|set_op
argument_list|(
name|disp
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"0x%x"
argument_list|,
name|disp
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/* ARGSUSED */
end_comment

begin_function
specifier|static
name|int
name|OP_SEG
parameter_list|(
name|dummy
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|dummy
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
specifier|static
name|char
modifier|*
name|sreg
index|[]
init|=
block|{
literal|"%es"
block|,
literal|"%cs"
block|,
literal|"%ss"
block|,
literal|"%ds"
block|,
literal|"%fs"
block|,
literal|"%gs"
block|,
literal|"%?"
block|,
literal|"%?"
block|,   }
decl_stmt|;
name|oappend
argument_list|(
name|sreg
index|[
name|reg
index|]
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|OP_DIR
parameter_list|(
name|size
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|size
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|int
name|seg
decl_stmt|,
name|offset
decl_stmt|;
switch|switch
condition|(
name|size
condition|)
block|{
case|case
name|lptr
case|:
if|if
condition|(
name|aflag
condition|)
block|{
name|offset
operator|=
name|get32
argument_list|()
expr_stmt|;
name|seg
operator|=
name|get16
argument_list|()
expr_stmt|;
block|}
else|else
block|{
name|offset
operator|=
name|get16
argument_list|()
expr_stmt|;
name|seg
operator|=
name|get16
argument_list|()
expr_stmt|;
block|}
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"0x%x,0x%x"
argument_list|,
name|seg
argument_list|,
name|offset
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
break|break;
case|case
name|v_mode
case|:
if|if
condition|(
name|aflag
condition|)
name|offset
operator|=
name|get32
argument_list|()
expr_stmt|;
else|else
name|offset
operator|=
operator|(
name|short
operator|)
name|get16
argument_list|()
expr_stmt|;
name|offset
operator|=
name|start_pc
operator|+
name|codep
operator|-
name|start_codep
operator|+
name|offset
expr_stmt|;
name|set_op
argument_list|(
name|offset
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"0x%x"
argument_list|,
name|offset
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
break|break;
default|default:
name|oappend
argument_list|(
literal|"<internal disassembler error>"
argument_list|)
expr_stmt|;
break|break;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/* ARGSUSED */
end_comment

begin_function
specifier|static
name|int
name|OP_OFF
parameter_list|(
name|bytemode
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|int
name|off
decl_stmt|;
name|append_prefix
argument_list|()
expr_stmt|;
if|if
condition|(
name|aflag
condition|)
name|off
operator|=
name|get32
argument_list|()
expr_stmt|;
else|else
name|off
operator|=
name|get16
argument_list|()
expr_stmt|;
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"0x%x"
argument_list|,
name|off
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/* ARGSUSED */
end_comment

begin_function
specifier|static
name|int
name|OP_ESDI
parameter_list|(
name|dummy
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|dummy
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|oappend
argument_list|(
literal|"%es:("
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|aflag
condition|?
literal|"%edi"
else|:
literal|"%di"
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
literal|")"
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/* ARGSUSED */
end_comment

begin_function
specifier|static
name|int
name|OP_DSSI
parameter_list|(
name|dummy
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|dummy
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|oappend
argument_list|(
literal|"%ds:("
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|aflag
condition|?
literal|"%esi"
else|:
literal|"%si"
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
literal|")"
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_if
if|#
directive|if
literal|0
end_if

begin_comment
comment|/* Not used.  */
end_comment

begin_comment
comment|/* ARGSUSED */
end_comment

begin_endif
unit|static int OP_ONE (dummy, aflag, dflag)      int dummy;      int aflag;      int dflag; {   oappend ("1");   return (0); }
endif|#
directive|endif
end_endif

begin_comment
comment|/* ARGSUSED */
end_comment

begin_function
specifier|static
name|int
name|OP_C
parameter_list|(
name|dummy
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|dummy
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|codep
operator|++
expr_stmt|;
comment|/* skip mod/rm */
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%%cr%d"
argument_list|,
name|reg
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/* ARGSUSED */
end_comment

begin_function
specifier|static
name|int
name|OP_D
parameter_list|(
name|dummy
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|dummy
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|codep
operator|++
expr_stmt|;
comment|/* skip mod/rm */
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%%db%d"
argument_list|,
name|reg
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/* ARGSUSED */
end_comment

begin_function
specifier|static
name|int
name|OP_T
parameter_list|(
name|dummy
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|dummy
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|codep
operator|++
expr_stmt|;
comment|/* skip mod/rm */
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%%tr%d"
argument_list|,
name|reg
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|OP_rm
parameter_list|(
name|bytemode
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
switch|switch
condition|(
name|bytemode
condition|)
block|{
case|case
name|d_mode
case|:
name|oappend
argument_list|(
name|names32
index|[
name|rm
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|w_mode
case|:
name|oappend
argument_list|(
name|names16
index|[
name|rm
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|OP_MMX
parameter_list|(
name|bytemode
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%%mm%d"
argument_list|,
name|reg
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|OP_EM
parameter_list|(
name|bytemode
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
if|if
condition|(
name|mod
operator|!=
literal|3
condition|)
return|return
name|OP_E
argument_list|(
name|bytemode
argument_list|,
name|aflag
argument_list|,
name|dflag
argument_list|)
return|;
name|codep
operator|++
expr_stmt|;
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%%mm%d"
argument_list|,
name|rm
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|OP_MS
parameter_list|(
name|bytemode
parameter_list|,
name|aflag
parameter_list|,
name|dflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|aflag
decl_stmt|;
name|int
name|dflag
decl_stmt|;
block|{
operator|++
name|codep
expr_stmt|;
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%%mm%d"
argument_list|,
name|rm
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

end_unit

