begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* Print i386 instructions for GDB, the GNU debugger.    Copyright 1988, 1989, 1991, 1993, 1994, 1995, 1996, 1997, 1998, 1999,    2001    Free Software Foundation, Inc.  This file is part of GDB.  This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_comment
comment|/*  * 80386 instruction printer by Pace Willisson (pace@prep.ai.mit.edu)  * July 1988  *  modified by John Hassey (hassey@dg-rtp.dg.com)  *  x86-64 support added by Jan Hubicka (jh@suse.cz)  */
end_comment

begin_comment
comment|/*  * The main tables describing the instructions is essentially a copy  * of the "Opcode Map" chapter (Appendix A) of the Intel 80386  * Programmers Manual.  Usually, there is a capital letter, followed  * by a small letter.  The capital letter tell the addressing mode,  * and the small letter tells about the operand size.  Refer to  * the Intel manual for details.  */
end_comment

begin_include
include|#
directive|include
file|"dis-asm.h"
end_include

begin_include
include|#
directive|include
file|"sysdep.h"
end_include

begin_include
include|#
directive|include
file|"opintl.h"
end_include

begin_define
define|#
directive|define
name|MAXLEN
value|20
end_define

begin_include
include|#
directive|include
file|<setjmp.h>
end_include

begin_ifndef
ifndef|#
directive|ifndef
name|UNIXWARE_COMPAT
end_ifndef

begin_comment
comment|/* Set non-zero for broken, compatible instructions.  Set to zero for    non-broken opcodes.  */
end_comment

begin_define
define|#
directive|define
name|UNIXWARE_COMPAT
value|1
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
specifier|static
name|int
name|fetch_data
name|PARAMS
argument_list|(
operator|(
expr|struct
name|disassemble_info
operator|*
operator|,
name|bfd_byte
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ckprefix
name|PARAMS
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|prefix_name
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|print_insn
name|PARAMS
argument_list|(
operator|(
name|bfd_vma
operator|,
name|disassemble_info
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|dofloat
name|PARAMS
argument_list|(
operator|(
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_ST
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_STi
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|putop
name|PARAMS
argument_list|(
operator|(
specifier|const
name|char
operator|*
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|oappend
name|PARAMS
argument_list|(
operator|(
specifier|const
name|char
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|append_seg
name|PARAMS
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_indirE
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|print_operand_value
name|PARAMS
argument_list|(
operator|(
name|char
operator|*
operator|,
name|int
operator|,
name|bfd_vma
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_E
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_G
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|bfd_vma
name|get64
name|PARAMS
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|bfd_signed_vma
name|get32
name|PARAMS
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|bfd_signed_vma
name|get32s
name|PARAMS
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|get16
name|PARAMS
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|set_op
name|PARAMS
argument_list|(
operator|(
name|bfd_vma
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_REG
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_IMREG
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_I
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_I64
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_sI
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_J
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_SEG
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_DIR
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_OFF
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_OFF64
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ptr_reg
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_ESreg
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_DSreg
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_C
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_D
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_T
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_Rd
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_MMX
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_XMM
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_EM
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_EX
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_MS
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_XS
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_3DNowSuffix
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|OP_SIMD_Suffix
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|SIMD_Fixup
name|PARAMS
argument_list|(
operator|(
name|int
operator|,
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|BadOp
name|PARAMS
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_struct
struct|struct
name|dis_private
block|{
comment|/* Points to first byte not fetched.  */
name|bfd_byte
modifier|*
name|max_fetched
decl_stmt|;
name|bfd_byte
name|the_buffer
index|[
name|MAXLEN
index|]
decl_stmt|;
name|bfd_vma
name|insn_start
decl_stmt|;
name|int
name|orig_sizeflag
decl_stmt|;
name|jmp_buf
name|bailout
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/* The opcode for the fwait instruction, which we treat as a prefix    when we can.  */
end_comment

begin_define
define|#
directive|define
name|FWAIT_OPCODE
value|(0x9b)
end_define

begin_comment
comment|/* Set to 1 for 64bit mode disassembly.  */
end_comment

begin_decl_stmt
specifier|static
name|int
name|mode_64bit
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Flags for the prefixes for the current instruction.  See below.  */
end_comment

begin_decl_stmt
specifier|static
name|int
name|prefixes
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* REX prefix the current instruction.  See below.  */
end_comment

begin_decl_stmt
specifier|static
name|int
name|rex
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Bits of REX we've already used.  */
end_comment

begin_decl_stmt
specifier|static
name|int
name|rex_used
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|REX_MODE64
value|8
end_define

begin_define
define|#
directive|define
name|REX_EXTX
value|4
end_define

begin_define
define|#
directive|define
name|REX_EXTY
value|2
end_define

begin_define
define|#
directive|define
name|REX_EXTZ
value|1
end_define

begin_comment
comment|/* Mark parts used in the REX prefix.  When we are testing for    empty prefix (for 8bit register REX extension), just mask it    out.  Otherwise test for REX bit is excuse for existence of REX    only in case value is nonzero.  */
end_comment

begin_define
define|#
directive|define
name|USED_REX
parameter_list|(
name|value
parameter_list|)
define|\
value|{							\     if (value)						\       rex_used |= (rex& value) ? (value) | 0x40 : 0;	\     else						\       rex_used |= 0x40;					\   }
end_define

begin_comment
comment|/* Flags for prefixes which we somehow handled when printing the    current instruction.  */
end_comment

begin_decl_stmt
specifier|static
name|int
name|used_prefixes
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Flags stored in PREFIXES.  */
end_comment

begin_define
define|#
directive|define
name|PREFIX_REPZ
value|1
end_define

begin_define
define|#
directive|define
name|PREFIX_REPNZ
value|2
end_define

begin_define
define|#
directive|define
name|PREFIX_LOCK
value|4
end_define

begin_define
define|#
directive|define
name|PREFIX_CS
value|8
end_define

begin_define
define|#
directive|define
name|PREFIX_SS
value|0x10
end_define

begin_define
define|#
directive|define
name|PREFIX_DS
value|0x20
end_define

begin_define
define|#
directive|define
name|PREFIX_ES
value|0x40
end_define

begin_define
define|#
directive|define
name|PREFIX_FS
value|0x80
end_define

begin_define
define|#
directive|define
name|PREFIX_GS
value|0x100
end_define

begin_define
define|#
directive|define
name|PREFIX_DATA
value|0x200
end_define

begin_define
define|#
directive|define
name|PREFIX_ADDR
value|0x400
end_define

begin_define
define|#
directive|define
name|PREFIX_FWAIT
value|0x800
end_define

begin_comment
comment|/* Make sure that bytes from INFO->PRIVATE_DATA->BUFFER (inclusive)    to ADDR (exclusive) are valid.  Returns 1 for success, longjmps    on error.  */
end_comment

begin_define
define|#
directive|define
name|FETCH_DATA
parameter_list|(
name|info
parameter_list|,
name|addr
parameter_list|)
define|\
value|((addr)<= ((struct dis_private *) (info->private_data))->max_fetched \    ? 1 : fetch_data ((info), (addr)))
end_define

begin_function
specifier|static
name|int
name|fetch_data
parameter_list|(
name|info
parameter_list|,
name|addr
parameter_list|)
name|struct
name|disassemble_info
modifier|*
name|info
decl_stmt|;
name|bfd_byte
modifier|*
name|addr
decl_stmt|;
block|{
name|int
name|status
decl_stmt|;
name|struct
name|dis_private
modifier|*
name|priv
init|=
operator|(
expr|struct
name|dis_private
operator|*
operator|)
name|info
operator|->
name|private_data
decl_stmt|;
name|bfd_vma
name|start
init|=
name|priv
operator|->
name|insn_start
operator|+
operator|(
name|priv
operator|->
name|max_fetched
operator|-
name|priv
operator|->
name|the_buffer
operator|)
decl_stmt|;
name|status
operator|=
call|(
modifier|*
name|info
operator|->
name|read_memory_func
call|)
argument_list|(
name|start
argument_list|,
name|priv
operator|->
name|max_fetched
argument_list|,
name|addr
operator|-
name|priv
operator|->
name|max_fetched
argument_list|,
name|info
argument_list|)
expr_stmt|;
if|if
condition|(
name|status
operator|!=
literal|0
condition|)
block|{
comment|/* If we did manage to read at least one byte, then          print_insn_i386 will do something sensible.  Otherwise, print          an error.  We do that here because this is where we know          STATUS.  */
if|if
condition|(
name|priv
operator|->
name|max_fetched
operator|==
name|priv
operator|->
name|the_buffer
condition|)
call|(
modifier|*
name|info
operator|->
name|memory_error_func
call|)
argument_list|(
name|status
argument_list|,
name|start
argument_list|,
name|info
argument_list|)
expr_stmt|;
name|longjmp
argument_list|(
name|priv
operator|->
name|bailout
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
name|priv
operator|->
name|max_fetched
operator|=
name|addr
expr_stmt|;
return|return
literal|1
return|;
block|}
end_function

begin_define
define|#
directive|define
name|XX
value|NULL, 0
end_define

begin_define
define|#
directive|define
name|Eb
value|OP_E, b_mode
end_define

begin_define
define|#
directive|define
name|Ev
value|OP_E, v_mode
end_define

begin_define
define|#
directive|define
name|Ed
value|OP_E, d_mode
end_define

begin_define
define|#
directive|define
name|indirEb
value|OP_indirE, b_mode
end_define

begin_define
define|#
directive|define
name|indirEv
value|OP_indirE, v_mode
end_define

begin_define
define|#
directive|define
name|Ew
value|OP_E, w_mode
end_define

begin_define
define|#
directive|define
name|Ma
value|OP_E, v_mode
end_define

begin_define
define|#
directive|define
name|M
value|OP_E, 0
end_define

begin_comment
comment|/* lea, lgdt, etc. */
end_comment

begin_define
define|#
directive|define
name|Mp
value|OP_E, 0
end_define

begin_comment
comment|/* 32 or 48 bit memory operand for LDS, LES etc */
end_comment

begin_define
define|#
directive|define
name|Gb
value|OP_G, b_mode
end_define

begin_define
define|#
directive|define
name|Gv
value|OP_G, v_mode
end_define

begin_define
define|#
directive|define
name|Gd
value|OP_G, d_mode
end_define

begin_define
define|#
directive|define
name|Gw
value|OP_G, w_mode
end_define

begin_define
define|#
directive|define
name|Rd
value|OP_Rd, d_mode
end_define

begin_define
define|#
directive|define
name|Rm
value|OP_Rd, m_mode
end_define

begin_define
define|#
directive|define
name|Ib
value|OP_I, b_mode
end_define

begin_define
define|#
directive|define
name|sIb
value|OP_sI, b_mode
end_define

begin_comment
comment|/* sign extened byte */
end_comment

begin_define
define|#
directive|define
name|Iv
value|OP_I, v_mode
end_define

begin_define
define|#
directive|define
name|Iq
value|OP_I, q_mode
end_define

begin_define
define|#
directive|define
name|Iv64
value|OP_I64, v_mode
end_define

begin_define
define|#
directive|define
name|Iw
value|OP_I, w_mode
end_define

begin_define
define|#
directive|define
name|Jb
value|OP_J, b_mode
end_define

begin_define
define|#
directive|define
name|Jv
value|OP_J, v_mode
end_define

begin_define
define|#
directive|define
name|Cm
value|OP_C, m_mode
end_define

begin_define
define|#
directive|define
name|Dm
value|OP_D, m_mode
end_define

begin_define
define|#
directive|define
name|Td
value|OP_T, d_mode
end_define

begin_define
define|#
directive|define
name|RMeAX
value|OP_REG, eAX_reg
end_define

begin_define
define|#
directive|define
name|RMeBX
value|OP_REG, eBX_reg
end_define

begin_define
define|#
directive|define
name|RMeCX
value|OP_REG, eCX_reg
end_define

begin_define
define|#
directive|define
name|RMeDX
value|OP_REG, eDX_reg
end_define

begin_define
define|#
directive|define
name|RMeSP
value|OP_REG, eSP_reg
end_define

begin_define
define|#
directive|define
name|RMeBP
value|OP_REG, eBP_reg
end_define

begin_define
define|#
directive|define
name|RMeSI
value|OP_REG, eSI_reg
end_define

begin_define
define|#
directive|define
name|RMeDI
value|OP_REG, eDI_reg
end_define

begin_define
define|#
directive|define
name|RMrAX
value|OP_REG, rAX_reg
end_define

begin_define
define|#
directive|define
name|RMrBX
value|OP_REG, rBX_reg
end_define

begin_define
define|#
directive|define
name|RMrCX
value|OP_REG, rCX_reg
end_define

begin_define
define|#
directive|define
name|RMrDX
value|OP_REG, rDX_reg
end_define

begin_define
define|#
directive|define
name|RMrSP
value|OP_REG, rSP_reg
end_define

begin_define
define|#
directive|define
name|RMrBP
value|OP_REG, rBP_reg
end_define

begin_define
define|#
directive|define
name|RMrSI
value|OP_REG, rSI_reg
end_define

begin_define
define|#
directive|define
name|RMrDI
value|OP_REG, rDI_reg
end_define

begin_define
define|#
directive|define
name|RMAL
value|OP_REG, al_reg
end_define

begin_define
define|#
directive|define
name|RMAL
value|OP_REG, al_reg
end_define

begin_define
define|#
directive|define
name|RMCL
value|OP_REG, cl_reg
end_define

begin_define
define|#
directive|define
name|RMDL
value|OP_REG, dl_reg
end_define

begin_define
define|#
directive|define
name|RMBL
value|OP_REG, bl_reg
end_define

begin_define
define|#
directive|define
name|RMAH
value|OP_REG, ah_reg
end_define

begin_define
define|#
directive|define
name|RMCH
value|OP_REG, ch_reg
end_define

begin_define
define|#
directive|define
name|RMDH
value|OP_REG, dh_reg
end_define

begin_define
define|#
directive|define
name|RMBH
value|OP_REG, bh_reg
end_define

begin_define
define|#
directive|define
name|RMAX
value|OP_REG, ax_reg
end_define

begin_define
define|#
directive|define
name|RMDX
value|OP_REG, dx_reg
end_define

begin_define
define|#
directive|define
name|eAX
value|OP_IMREG, eAX_reg
end_define

begin_define
define|#
directive|define
name|eBX
value|OP_IMREG, eBX_reg
end_define

begin_define
define|#
directive|define
name|eCX
value|OP_IMREG, eCX_reg
end_define

begin_define
define|#
directive|define
name|eDX
value|OP_IMREG, eDX_reg
end_define

begin_define
define|#
directive|define
name|eSP
value|OP_IMREG, eSP_reg
end_define

begin_define
define|#
directive|define
name|eBP
value|OP_IMREG, eBP_reg
end_define

begin_define
define|#
directive|define
name|eSI
value|OP_IMREG, eSI_reg
end_define

begin_define
define|#
directive|define
name|eDI
value|OP_IMREG, eDI_reg
end_define

begin_define
define|#
directive|define
name|AL
value|OP_IMREG, al_reg
end_define

begin_define
define|#
directive|define
name|AL
value|OP_IMREG, al_reg
end_define

begin_define
define|#
directive|define
name|CL
value|OP_IMREG, cl_reg
end_define

begin_define
define|#
directive|define
name|DL
value|OP_IMREG, dl_reg
end_define

begin_define
define|#
directive|define
name|BL
value|OP_IMREG, bl_reg
end_define

begin_define
define|#
directive|define
name|AH
value|OP_IMREG, ah_reg
end_define

begin_define
define|#
directive|define
name|CH
value|OP_IMREG, ch_reg
end_define

begin_define
define|#
directive|define
name|DH
value|OP_IMREG, dh_reg
end_define

begin_define
define|#
directive|define
name|BH
value|OP_IMREG, bh_reg
end_define

begin_define
define|#
directive|define
name|AX
value|OP_IMREG, ax_reg
end_define

begin_define
define|#
directive|define
name|DX
value|OP_IMREG, dx_reg
end_define

begin_define
define|#
directive|define
name|indirDX
value|OP_IMREG, indir_dx_reg
end_define

begin_define
define|#
directive|define
name|Sw
value|OP_SEG, w_mode
end_define

begin_define
define|#
directive|define
name|Ap
value|OP_DIR, 0
end_define

begin_define
define|#
directive|define
name|Ob
value|OP_OFF, b_mode
end_define

begin_define
define|#
directive|define
name|Ob64
value|OP_OFF64, b_mode
end_define

begin_define
define|#
directive|define
name|Ov
value|OP_OFF, v_mode
end_define

begin_define
define|#
directive|define
name|Ov64
value|OP_OFF64, v_mode
end_define

begin_define
define|#
directive|define
name|Xb
value|OP_DSreg, eSI_reg
end_define

begin_define
define|#
directive|define
name|Xv
value|OP_DSreg, eSI_reg
end_define

begin_define
define|#
directive|define
name|Yb
value|OP_ESreg, eDI_reg
end_define

begin_define
define|#
directive|define
name|Yv
value|OP_ESreg, eDI_reg
end_define

begin_define
define|#
directive|define
name|DSBX
value|OP_DSreg, eBX_reg
end_define

begin_define
define|#
directive|define
name|es
value|OP_REG, es_reg
end_define

begin_define
define|#
directive|define
name|ss
value|OP_REG, ss_reg
end_define

begin_define
define|#
directive|define
name|cs
value|OP_REG, cs_reg
end_define

begin_define
define|#
directive|define
name|ds
value|OP_REG, ds_reg
end_define

begin_define
define|#
directive|define
name|fs
value|OP_REG, fs_reg
end_define

begin_define
define|#
directive|define
name|gs
value|OP_REG, gs_reg
end_define

begin_define
define|#
directive|define
name|MX
value|OP_MMX, 0
end_define

begin_define
define|#
directive|define
name|XM
value|OP_XMM, 0
end_define

begin_define
define|#
directive|define
name|EM
value|OP_EM, v_mode
end_define

begin_define
define|#
directive|define
name|EX
value|OP_EX, v_mode
end_define

begin_define
define|#
directive|define
name|MS
value|OP_MS, v_mode
end_define

begin_define
define|#
directive|define
name|XS
value|OP_XS, v_mode
end_define

begin_define
define|#
directive|define
name|None
value|OP_E, 0
end_define

begin_define
define|#
directive|define
name|OPSUF
value|OP_3DNowSuffix, 0
end_define

begin_define
define|#
directive|define
name|OPSIMD
value|OP_SIMD_Suffix, 0
end_define

begin_define
define|#
directive|define
name|cond_jump_flag
value|NULL, cond_jump_mode
end_define

begin_define
define|#
directive|define
name|loop_jcxz_flag
value|NULL, loop_jcxz_mode
end_define

begin_comment
comment|/* bits in sizeflag */
end_comment

begin_define
define|#
directive|define
name|SUFFIX_ALWAYS
value|4
end_define

begin_define
define|#
directive|define
name|AFLAG
value|2
end_define

begin_define
define|#
directive|define
name|DFLAG
value|1
end_define

begin_define
define|#
directive|define
name|b_mode
value|1
end_define

begin_comment
comment|/* byte operand */
end_comment

begin_define
define|#
directive|define
name|v_mode
value|2
end_define

begin_comment
comment|/* operand size depends on prefixes */
end_comment

begin_define
define|#
directive|define
name|w_mode
value|3
end_define

begin_comment
comment|/* word operand */
end_comment

begin_define
define|#
directive|define
name|d_mode
value|4
end_define

begin_comment
comment|/* double word operand  */
end_comment

begin_define
define|#
directive|define
name|q_mode
value|5
end_define

begin_comment
comment|/* quad word operand */
end_comment

begin_define
define|#
directive|define
name|x_mode
value|6
end_define

begin_define
define|#
directive|define
name|m_mode
value|7
end_define

begin_comment
comment|/* d_mode in 32bit, q_mode in 64bit mode.  */
end_comment

begin_define
define|#
directive|define
name|cond_jump_mode
value|8
end_define

begin_define
define|#
directive|define
name|loop_jcxz_mode
value|9
end_define

begin_define
define|#
directive|define
name|es_reg
value|100
end_define

begin_define
define|#
directive|define
name|cs_reg
value|101
end_define

begin_define
define|#
directive|define
name|ss_reg
value|102
end_define

begin_define
define|#
directive|define
name|ds_reg
value|103
end_define

begin_define
define|#
directive|define
name|fs_reg
value|104
end_define

begin_define
define|#
directive|define
name|gs_reg
value|105
end_define

begin_define
define|#
directive|define
name|eAX_reg
value|108
end_define

begin_define
define|#
directive|define
name|eCX_reg
value|109
end_define

begin_define
define|#
directive|define
name|eDX_reg
value|110
end_define

begin_define
define|#
directive|define
name|eBX_reg
value|111
end_define

begin_define
define|#
directive|define
name|eSP_reg
value|112
end_define

begin_define
define|#
directive|define
name|eBP_reg
value|113
end_define

begin_define
define|#
directive|define
name|eSI_reg
value|114
end_define

begin_define
define|#
directive|define
name|eDI_reg
value|115
end_define

begin_define
define|#
directive|define
name|al_reg
value|116
end_define

begin_define
define|#
directive|define
name|cl_reg
value|117
end_define

begin_define
define|#
directive|define
name|dl_reg
value|118
end_define

begin_define
define|#
directive|define
name|bl_reg
value|119
end_define

begin_define
define|#
directive|define
name|ah_reg
value|120
end_define

begin_define
define|#
directive|define
name|ch_reg
value|121
end_define

begin_define
define|#
directive|define
name|dh_reg
value|122
end_define

begin_define
define|#
directive|define
name|bh_reg
value|123
end_define

begin_define
define|#
directive|define
name|ax_reg
value|124
end_define

begin_define
define|#
directive|define
name|cx_reg
value|125
end_define

begin_define
define|#
directive|define
name|dx_reg
value|126
end_define

begin_define
define|#
directive|define
name|bx_reg
value|127
end_define

begin_define
define|#
directive|define
name|sp_reg
value|128
end_define

begin_define
define|#
directive|define
name|bp_reg
value|129
end_define

begin_define
define|#
directive|define
name|si_reg
value|130
end_define

begin_define
define|#
directive|define
name|di_reg
value|131
end_define

begin_define
define|#
directive|define
name|rAX_reg
value|132
end_define

begin_define
define|#
directive|define
name|rCX_reg
value|133
end_define

begin_define
define|#
directive|define
name|rDX_reg
value|134
end_define

begin_define
define|#
directive|define
name|rBX_reg
value|135
end_define

begin_define
define|#
directive|define
name|rSP_reg
value|136
end_define

begin_define
define|#
directive|define
name|rBP_reg
value|137
end_define

begin_define
define|#
directive|define
name|rSI_reg
value|138
end_define

begin_define
define|#
directive|define
name|rDI_reg
value|139
end_define

begin_define
define|#
directive|define
name|indir_dx_reg
value|150
end_define

begin_define
define|#
directive|define
name|FLOATCODE
value|1
end_define

begin_define
define|#
directive|define
name|USE_GROUPS
value|2
end_define

begin_define
define|#
directive|define
name|USE_PREFIX_USER_TABLE
value|3
end_define

begin_define
define|#
directive|define
name|X86_64_SPECIAL
value|4
end_define

begin_define
define|#
directive|define
name|FLOAT
value|NULL, NULL, FLOATCODE, NULL, 0, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP1b
value|NULL, NULL, USE_GROUPS, NULL,  0, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP1S
value|NULL, NULL, USE_GROUPS, NULL,  1, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP1Ss
value|NULL, NULL, USE_GROUPS, NULL,  2, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP2b
value|NULL, NULL, USE_GROUPS, NULL,  3, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP2S
value|NULL, NULL, USE_GROUPS, NULL,  4, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP2b_one
value|NULL, NULL, USE_GROUPS, NULL,  5, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP2S_one
value|NULL, NULL, USE_GROUPS, NULL,  6, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP2b_cl
value|NULL, NULL, USE_GROUPS, NULL,  7, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP2S_cl
value|NULL, NULL, USE_GROUPS, NULL,  8, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP3b
value|NULL, NULL, USE_GROUPS, NULL,  9, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP3S
value|NULL, NULL, USE_GROUPS, NULL, 10, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP4
value|NULL, NULL, USE_GROUPS, NULL, 11, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP5
value|NULL, NULL, USE_GROUPS, NULL, 12, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP6
value|NULL, NULL, USE_GROUPS, NULL, 13, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP7
value|NULL, NULL, USE_GROUPS, NULL, 14, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP8
value|NULL, NULL, USE_GROUPS, NULL, 15, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP9
value|NULL, NULL, USE_GROUPS, NULL, 16, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP10
value|NULL, NULL, USE_GROUPS, NULL, 17, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP11
value|NULL, NULL, USE_GROUPS, NULL, 18, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP12
value|NULL, NULL, USE_GROUPS, NULL, 19, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP13
value|NULL, NULL, USE_GROUPS, NULL, 20, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRP14
value|NULL, NULL, USE_GROUPS, NULL, 21, NULL, 0
end_define

begin_define
define|#
directive|define
name|GRPAMD
value|NULL, NULL, USE_GROUPS, NULL, 22, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP0
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  0, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP1
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  1, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP2
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  2, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP3
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  3, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP4
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  4, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP5
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  5, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP6
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  6, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP7
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  7, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP8
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  8, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP9
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL,  9, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP10
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 10, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP11
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 11, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP12
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 12, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP13
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 13, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP14
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 14, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP15
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 15, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP16
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 16, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP17
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 17, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP18
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 18, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP19
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 19, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP20
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 20, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP21
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 21, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP22
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 22, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP23
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 23, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP24
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 24, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP25
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 25, NULL, 0
end_define

begin_define
define|#
directive|define
name|PREGRP26
value|NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 26, NULL, 0
end_define

begin_define
define|#
directive|define
name|X86_64_0
value|NULL, NULL, X86_64_SPECIAL, NULL,  0, NULL, 0
end_define

begin_typedef
typedef|typedef
name|void
argument_list|(
argument|*op_rtn
argument_list|)
name|PARAMS
argument_list|(
operator|(
name|int
name|bytemode
operator|,
name|int
name|sizeflag
operator|)
argument_list|)
expr_stmt|;
end_typedef

begin_struct
struct|struct
name|dis386
block|{
specifier|const
name|char
modifier|*
name|name
decl_stmt|;
name|op_rtn
name|op1
decl_stmt|;
name|int
name|bytemode1
decl_stmt|;
name|op_rtn
name|op2
decl_stmt|;
name|int
name|bytemode2
decl_stmt|;
name|op_rtn
name|op3
decl_stmt|;
name|int
name|bytemode3
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/* Upper case letters in the instruction names here are macros.    'A' => print 'b' if no register operands or suffix_always is true    'B' => print 'b' if suffix_always is true    'E' => print 'e' if 32-bit form of jcxz    'F' => print 'w' or 'l' depending on address size prefix (loop insns)    'H' => print ",pt" or ",pn" branch hint    'L' => print 'l' if suffix_always is true    'N' => print 'n' if instruction has no wait "prefix"    'O' => print 'd', or 'o'    'P' => print 'w', 'l' or 'q' if instruction has an operand size prefix,    .      or suffix_always is true.  print 'q' if rex prefix is present.    'Q' => print 'w', 'l' or 'q' if no register operands or suffix_always    .      is true    'R' => print 'w', 'l' or 'q' ("wd" or "dq" in intel mode)    'S' => print 'w', 'l' or 'q' if suffix_always is true    'T' => print 'q' in 64bit mode and behave as 'P' otherwise    'U' => print 'q' in 64bit mode and behave as 'Q' otherwise    'X' => print 's', 'd' depending on data16 prefix (for XMM)    'W' => print 'b' or 'w' ("w" or "de" in intel mode)    'Y' => 'q' if instruction has an REX 64bit overwrite prefix     Many of the above letters print nothing in Intel mode.  See "putop"    for the details.     Braces '{' and '}', and vertical bars '|', indicate alternative    mnemonic strings for AT&T, Intel, X86_64 AT&T, and X86_64 Intel    modes.  In cases where there are only two alternatives, the X86_64    instruction is reserved, and "(bad)" is printed. */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|dis386
name|dis386
index|[]
init|=
block|{
comment|/* 00 */
block|{
literal|"addB"
block|,
name|Eb
block|,
name|Gb
block|,
name|XX
block|}
block|,
block|{
literal|"addS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
block|{
literal|"addB"
block|,
name|Gb
block|,
name|Eb
block|,
name|XX
block|}
block|,
block|{
literal|"addS"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"addB"
block|,
name|AL
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"addS"
block|,
name|eAX
block|,
name|Iv
block|,
name|XX
block|}
block|,
block|{
literal|"push{T|}"
block|,
name|es
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"pop{T|}"
block|,
name|es
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 08 */
block|{
literal|"orB"
block|,
name|Eb
block|,
name|Gb
block|,
name|XX
block|}
block|,
block|{
literal|"orS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
block|{
literal|"orB"
block|,
name|Gb
block|,
name|Eb
block|,
name|XX
block|}
block|,
block|{
literal|"orS"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"orB"
block|,
name|AL
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"orS"
block|,
name|eAX
block|,
name|Iv
block|,
name|XX
block|}
block|,
block|{
literal|"push{T|}"
block|,
name|cs
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 0x0f extended opcode escape */
comment|/* 10 */
block|{
literal|"adcB"
block|,
name|Eb
block|,
name|Gb
block|,
name|XX
block|}
block|,
block|{
literal|"adcS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
block|{
literal|"adcB"
block|,
name|Gb
block|,
name|Eb
block|,
name|XX
block|}
block|,
block|{
literal|"adcS"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"adcB"
block|,
name|AL
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"adcS"
block|,
name|eAX
block|,
name|Iv
block|,
name|XX
block|}
block|,
block|{
literal|"push{T|}"
block|,
name|ss
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"popT|}"
block|,
name|ss
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 18 */
block|{
literal|"sbbB"
block|,
name|Eb
block|,
name|Gb
block|,
name|XX
block|}
block|,
block|{
literal|"sbbS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
block|{
literal|"sbbB"
block|,
name|Gb
block|,
name|Eb
block|,
name|XX
block|}
block|,
block|{
literal|"sbbS"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"sbbB"
block|,
name|AL
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"sbbS"
block|,
name|eAX
block|,
name|Iv
block|,
name|XX
block|}
block|,
block|{
literal|"push{T|}"
block|,
name|ds
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"pop{T|}"
block|,
name|ds
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 20 */
block|{
literal|"andB"
block|,
name|Eb
block|,
name|Gb
block|,
name|XX
block|}
block|,
block|{
literal|"andS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
block|{
literal|"andB"
block|,
name|Gb
block|,
name|Eb
block|,
name|XX
block|}
block|,
block|{
literal|"andS"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"andB"
block|,
name|AL
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"andS"
block|,
name|eAX
block|,
name|Iv
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* SEG ES prefix */
block|{
literal|"daa{|}"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 28 */
block|{
literal|"subB"
block|,
name|Eb
block|,
name|Gb
block|,
name|XX
block|}
block|,
block|{
literal|"subS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
block|{
literal|"subB"
block|,
name|Gb
block|,
name|Eb
block|,
name|XX
block|}
block|,
block|{
literal|"subS"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"subB"
block|,
name|AL
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"subS"
block|,
name|eAX
block|,
name|Iv
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* SEG CS prefix */
block|{
literal|"das{|}"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 30 */
block|{
literal|"xorB"
block|,
name|Eb
block|,
name|Gb
block|,
name|XX
block|}
block|,
block|{
literal|"xorS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
block|{
literal|"xorB"
block|,
name|Gb
block|,
name|Eb
block|,
name|XX
block|}
block|,
block|{
literal|"xorS"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"xorB"
block|,
name|AL
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"xorS"
block|,
name|eAX
block|,
name|Iv
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* SEG SS prefix */
block|{
literal|"aaa{|}"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 38 */
block|{
literal|"cmpB"
block|,
name|Eb
block|,
name|Gb
block|,
name|XX
block|}
block|,
block|{
literal|"cmpS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
block|{
literal|"cmpB"
block|,
name|Gb
block|,
name|Eb
block|,
name|XX
block|}
block|,
block|{
literal|"cmpS"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"cmpB"
block|,
name|AL
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"cmpS"
block|,
name|eAX
block|,
name|Iv
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* SEG DS prefix */
block|{
literal|"aas{|}"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 40 */
block|{
literal|"inc{S|}"
block|,
name|RMeAX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"inc{S|}"
block|,
name|RMeCX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"inc{S|}"
block|,
name|RMeDX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"inc{S|}"
block|,
name|RMeBX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"inc{S|}"
block|,
name|RMeSP
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"inc{S|}"
block|,
name|RMeBP
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"inc{S|}"
block|,
name|RMeSI
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"inc{S|}"
block|,
name|RMeDI
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 48 */
block|{
literal|"dec{S|}"
block|,
name|RMeAX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"dec{S|}"
block|,
name|RMeCX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"dec{S|}"
block|,
name|RMeDX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"dec{S|}"
block|,
name|RMeBX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"dec{S|}"
block|,
name|RMeSP
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"dec{S|}"
block|,
name|RMeBP
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"dec{S|}"
block|,
name|RMeSI
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"dec{S|}"
block|,
name|RMeDI
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 50 */
block|{
literal|"pushS"
block|,
name|RMrAX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"pushS"
block|,
name|RMrCX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"pushS"
block|,
name|RMrDX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"pushS"
block|,
name|RMrBX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"pushS"
block|,
name|RMrSP
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"pushS"
block|,
name|RMrBP
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"pushS"
block|,
name|RMrSI
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"pushS"
block|,
name|RMrDI
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 58 */
block|{
literal|"popS"
block|,
name|RMrAX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"popS"
block|,
name|RMrCX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"popS"
block|,
name|RMrDX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"popS"
block|,
name|RMrBX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"popS"
block|,
name|RMrSP
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"popS"
block|,
name|RMrBP
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"popS"
block|,
name|RMrSI
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"popS"
block|,
name|RMrDI
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 60 */
block|{
literal|"pusha{P|}"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"popa{P|}"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"bound{S|}"
block|,
name|Gv
block|,
name|Ma
block|,
name|XX
block|}
block|,
block|{
name|X86_64_0
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* seg fs */
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* seg gs */
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* op size prefix */
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* adr size prefix */
comment|/* 68 */
block|{
literal|"pushT"
block|,
name|Iq
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"imulS"
block|,
name|Gv
block|,
name|Ev
block|,
name|Iv
block|}
block|,
block|{
literal|"pushT"
block|,
name|sIb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"imulS"
block|,
name|Gv
block|,
name|Ev
block|,
name|sIb
block|}
block|,
block|{
literal|"ins{b||b|}"
block|,
name|Yb
block|,
name|indirDX
block|,
name|XX
block|}
block|,
block|{
literal|"ins{R||R|}"
block|,
name|Yv
block|,
name|indirDX
block|,
name|XX
block|}
block|,
block|{
literal|"outs{b||b|}"
block|,
name|indirDX
block|,
name|Xb
block|,
name|XX
block|}
block|,
block|{
literal|"outs{R||R|}"
block|,
name|indirDX
block|,
name|Xv
block|,
name|XX
block|}
block|,
comment|/* 70 */
block|{
literal|"joH"
block|,
name|Jb
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jnoH"
block|,
name|Jb
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jbH"
block|,
name|Jb
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jaeH"
block|,
name|Jb
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jeH"
block|,
name|Jb
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jneH"
block|,
name|Jb
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jbeH"
block|,
name|Jb
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jaH"
block|,
name|Jb
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
comment|/* 78 */
block|{
literal|"jsH"
block|,
name|Jb
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jnsH"
block|,
name|Jb
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jpH"
block|,
name|Jb
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jnpH"
block|,
name|Jb
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jlH"
block|,
name|Jb
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jgeH"
block|,
name|Jb
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jleH"
block|,
name|Jb
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jgH"
block|,
name|Jb
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
comment|/* 80 */
block|{
name|GRP1b
block|}
block|,
block|{
name|GRP1S
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
name|GRP1Ss
block|}
block|,
block|{
literal|"testB"
block|,
name|Eb
block|,
name|Gb
block|,
name|XX
block|}
block|,
block|{
literal|"testS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
block|{
literal|"xchgB"
block|,
name|Eb
block|,
name|Gb
block|,
name|XX
block|}
block|,
block|{
literal|"xchgS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
comment|/* 88 */
block|{
literal|"movB"
block|,
name|Eb
block|,
name|Gb
block|,
name|XX
block|}
block|,
block|{
literal|"movS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
block|{
literal|"movB"
block|,
name|Gb
block|,
name|Eb
block|,
name|XX
block|}
block|,
block|{
literal|"movS"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"movQ"
block|,
name|Ev
block|,
name|Sw
block|,
name|XX
block|}
block|,
block|{
literal|"leaS"
block|,
name|Gv
block|,
name|M
block|,
name|XX
block|}
block|,
block|{
literal|"movQ"
block|,
name|Sw
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"popU"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 90 */
block|{
literal|"nop"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* FIXME: NOP with REPz prefix is called PAUSE.  */
block|{
literal|"xchgS"
block|,
name|RMeCX
block|,
name|eAX
block|,
name|XX
block|}
block|,
block|{
literal|"xchgS"
block|,
name|RMeDX
block|,
name|eAX
block|,
name|XX
block|}
block|,
block|{
literal|"xchgS"
block|,
name|RMeBX
block|,
name|eAX
block|,
name|XX
block|}
block|,
block|{
literal|"xchgS"
block|,
name|RMeSP
block|,
name|eAX
block|,
name|XX
block|}
block|,
block|{
literal|"xchgS"
block|,
name|RMeBP
block|,
name|eAX
block|,
name|XX
block|}
block|,
block|{
literal|"xchgS"
block|,
name|RMeSI
block|,
name|eAX
block|,
name|XX
block|}
block|,
block|{
literal|"xchgS"
block|,
name|RMeDI
block|,
name|eAX
block|,
name|XX
block|}
block|,
comment|/* 98 */
block|{
literal|"cW{tR||tR|}"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"cR{tO||tO|}"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"lcall{T|}"
block|,
name|Ap
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* fwait */
block|{
literal|"pushfT"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"popfT"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"sahf{|}"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"lahf{|}"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* a0 */
block|{
literal|"movB"
block|,
name|AL
block|,
name|Ob64
block|,
name|XX
block|}
block|,
block|{
literal|"movS"
block|,
name|eAX
block|,
name|Ov64
block|,
name|XX
block|}
block|,
block|{
literal|"movB"
block|,
name|Ob64
block|,
name|AL
block|,
name|XX
block|}
block|,
block|{
literal|"movS"
block|,
name|Ov64
block|,
name|eAX
block|,
name|XX
block|}
block|,
block|{
literal|"movs{b||b|}"
block|,
name|Yb
block|,
name|Xb
block|,
name|XX
block|}
block|,
block|{
literal|"movs{R||R|}"
block|,
name|Yv
block|,
name|Xv
block|,
name|XX
block|}
block|,
block|{
literal|"cmps{b||b|}"
block|,
name|Xb
block|,
name|Yb
block|,
name|XX
block|}
block|,
block|{
literal|"cmps{R||R|}"
block|,
name|Xv
block|,
name|Yv
block|,
name|XX
block|}
block|,
comment|/* a8 */
block|{
literal|"testB"
block|,
name|AL
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"testS"
block|,
name|eAX
block|,
name|Iv
block|,
name|XX
block|}
block|,
block|{
literal|"stosB"
block|,
name|Yb
block|,
name|AL
block|,
name|XX
block|}
block|,
block|{
literal|"stosS"
block|,
name|Yv
block|,
name|eAX
block|,
name|XX
block|}
block|,
block|{
literal|"lodsB"
block|,
name|AL
block|,
name|Xb
block|,
name|XX
block|}
block|,
block|{
literal|"lodsS"
block|,
name|eAX
block|,
name|Xv
block|,
name|XX
block|}
block|,
block|{
literal|"scasB"
block|,
name|AL
block|,
name|Yb
block|,
name|XX
block|}
block|,
block|{
literal|"scasS"
block|,
name|eAX
block|,
name|Yv
block|,
name|XX
block|}
block|,
comment|/* b0 */
block|{
literal|"movB"
block|,
name|RMAL
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"movB"
block|,
name|RMCL
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"movB"
block|,
name|RMDL
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"movB"
block|,
name|RMBL
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"movB"
block|,
name|RMAH
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"movB"
block|,
name|RMCH
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"movB"
block|,
name|RMDH
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"movB"
block|,
name|RMBH
block|,
name|Ib
block|,
name|XX
block|}
block|,
comment|/* b8 */
block|{
literal|"movS"
block|,
name|RMeAX
block|,
name|Iv64
block|,
name|XX
block|}
block|,
block|{
literal|"movS"
block|,
name|RMeCX
block|,
name|Iv64
block|,
name|XX
block|}
block|,
block|{
literal|"movS"
block|,
name|RMeDX
block|,
name|Iv64
block|,
name|XX
block|}
block|,
block|{
literal|"movS"
block|,
name|RMeBX
block|,
name|Iv64
block|,
name|XX
block|}
block|,
block|{
literal|"movS"
block|,
name|RMeSP
block|,
name|Iv64
block|,
name|XX
block|}
block|,
block|{
literal|"movS"
block|,
name|RMeBP
block|,
name|Iv64
block|,
name|XX
block|}
block|,
block|{
literal|"movS"
block|,
name|RMeSI
block|,
name|Iv64
block|,
name|XX
block|}
block|,
block|{
literal|"movS"
block|,
name|RMeDI
block|,
name|Iv64
block|,
name|XX
block|}
block|,
comment|/* c0 */
block|{
name|GRP2b
block|}
block|,
block|{
name|GRP2S
block|}
block|,
block|{
literal|"retT"
block|,
name|Iw
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"retT"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"les{S|}"
block|,
name|Gv
block|,
name|Mp
block|,
name|XX
block|}
block|,
block|{
literal|"ldsS"
block|,
name|Gv
block|,
name|Mp
block|,
name|XX
block|}
block|,
block|{
literal|"movA"
block|,
name|Eb
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"movQ"
block|,
name|Ev
block|,
name|Iv
block|,
name|XX
block|}
block|,
comment|/* c8 */
block|{
literal|"enterT"
block|,
name|Iw
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"leaveT"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"lretP"
block|,
name|Iw
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"lretP"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"int3"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"int"
block|,
name|Ib
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"into{|}"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"iretP"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* d0 */
block|{
name|GRP2b_one
block|}
block|,
block|{
name|GRP2S_one
block|}
block|,
block|{
name|GRP2b_cl
block|}
block|,
block|{
name|GRP2S_cl
block|}
block|,
block|{
literal|"aam{|}"
block|,
name|sIb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"aad{|}"
block|,
name|sIb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"xlat"
block|,
name|DSBX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* d8 */
block|{
name|FLOAT
block|}
block|,
block|{
name|FLOAT
block|}
block|,
block|{
name|FLOAT
block|}
block|,
block|{
name|FLOAT
block|}
block|,
block|{
name|FLOAT
block|}
block|,
block|{
name|FLOAT
block|}
block|,
block|{
name|FLOAT
block|}
block|,
block|{
name|FLOAT
block|}
block|,
comment|/* e0 */
block|{
literal|"loopneFH"
block|,
name|Jb
block|,
name|XX
block|,
name|loop_jcxz_flag
block|}
block|,
block|{
literal|"loopeFH"
block|,
name|Jb
block|,
name|XX
block|,
name|loop_jcxz_flag
block|}
block|,
block|{
literal|"loopFH"
block|,
name|Jb
block|,
name|XX
block|,
name|loop_jcxz_flag
block|}
block|,
block|{
literal|"jEcxzH"
block|,
name|Jb
block|,
name|XX
block|,
name|loop_jcxz_flag
block|}
block|,
block|{
literal|"inB"
block|,
name|AL
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"inS"
block|,
name|eAX
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"outB"
block|,
name|Ib
block|,
name|AL
block|,
name|XX
block|}
block|,
block|{
literal|"outS"
block|,
name|Ib
block|,
name|eAX
block|,
name|XX
block|}
block|,
comment|/* e8 */
block|{
literal|"callT"
block|,
name|Jv
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"jmpT"
block|,
name|Jv
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"ljmp{T|}"
block|,
name|Ap
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"jmp"
block|,
name|Jb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"inB"
block|,
name|AL
block|,
name|indirDX
block|,
name|XX
block|}
block|,
block|{
literal|"inS"
block|,
name|eAX
block|,
name|indirDX
block|,
name|XX
block|}
block|,
block|{
literal|"outB"
block|,
name|indirDX
block|,
name|AL
block|,
name|XX
block|}
block|,
block|{
literal|"outS"
block|,
name|indirDX
block|,
name|eAX
block|,
name|XX
block|}
block|,
comment|/* f0 */
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* lock prefix */
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* repne */
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* repz */
block|{
literal|"hlt"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"cmc"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
name|GRP3b
block|}
block|,
block|{
name|GRP3S
block|}
block|,
comment|/* f8 */
block|{
literal|"clc"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"stc"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"cli"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"sti"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"cld"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"std"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
name|GRP4
block|}
block|,
block|{
name|GRP5
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|dis386
name|dis386_twobyte
index|[]
init|=
block|{
comment|/* 00 */
block|{
name|GRP6
block|}
block|,
block|{
name|GRP7
block|}
block|,
block|{
literal|"larS"
block|,
name|Gv
block|,
name|Ew
block|,
name|XX
block|}
block|,
block|{
literal|"lslS"
block|,
name|Gv
block|,
name|Ew
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"syscall"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"clts"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"sysretP"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 08 */
block|{
literal|"invd"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"wbinvd"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"ud2a"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
name|GRPAMD
block|}
block|,
block|{
literal|"femms"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|""
block|,
name|MX
block|,
name|EM
block|,
name|OPSUF
block|}
block|,
comment|/* See OP_3DNowSuffix.  */
comment|/* 10 */
block|{
name|PREGRP8
block|}
block|,
block|{
name|PREGRP9
block|}
block|,
block|{
literal|"movlpX"
block|,
name|XM
block|,
name|EX
block|,
name|SIMD_Fixup
block|,
literal|'h'
block|}
block|,
comment|/* really only 2 operands */
block|{
literal|"movlpX"
block|,
name|EX
block|,
name|XM
block|,
name|SIMD_Fixup
block|,
literal|'h'
block|}
block|,
block|{
literal|"unpcklpX"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"unpckhpX"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"movhpX"
block|,
name|XM
block|,
name|EX
block|,
name|SIMD_Fixup
block|,
literal|'l'
block|}
block|,
block|{
literal|"movhpX"
block|,
name|EX
block|,
name|XM
block|,
name|SIMD_Fixup
block|,
literal|'l'
block|}
block|,
comment|/* 18 */
block|{
name|GRP14
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 20 */
block|{
literal|"movL"
block|,
name|Rm
block|,
name|Cm
block|,
name|XX
block|}
block|,
block|{
literal|"movL"
block|,
name|Rm
block|,
name|Dm
block|,
name|XX
block|}
block|,
block|{
literal|"movL"
block|,
name|Cm
block|,
name|Rm
block|,
name|XX
block|}
block|,
block|{
literal|"movL"
block|,
name|Dm
block|,
name|Rm
block|,
name|XX
block|}
block|,
block|{
literal|"movL"
block|,
name|Rd
block|,
name|Td
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"movL"
block|,
name|Td
block|,
name|Rd
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 28 */
block|{
literal|"movapX"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"movapX"
block|,
name|EX
block|,
name|XM
block|,
name|XX
block|}
block|,
block|{
name|PREGRP2
block|}
block|,
block|{
literal|"movntpX"
block|,
name|Ev
block|,
name|XM
block|,
name|XX
block|}
block|,
block|{
name|PREGRP4
block|}
block|,
block|{
name|PREGRP3
block|}
block|,
block|{
literal|"ucomisX"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"comisX"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
comment|/* 30 */
block|{
literal|"wrmsr"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"rdtsc"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"rdmsr"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"rdpmc"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"sysenter"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"sysexit"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 38 */
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 40 */
block|{
literal|"cmovo"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"cmovno"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"cmovb"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"cmovae"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"cmove"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"cmovne"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"cmovbe"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"cmova"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
comment|/* 48 */
block|{
literal|"cmovs"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"cmovns"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"cmovp"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"cmovnp"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"cmovl"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"cmovge"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"cmovle"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"cmovg"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
comment|/* 50 */
block|{
literal|"movmskpX"
block|,
name|Gd
block|,
name|XS
block|,
name|XX
block|}
block|,
block|{
name|PREGRP13
block|}
block|,
block|{
name|PREGRP12
block|}
block|,
block|{
name|PREGRP11
block|}
block|,
block|{
literal|"andpX"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"andnpX"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"orpX"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"xorpX"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
comment|/* 58 */
block|{
name|PREGRP0
block|}
block|,
block|{
name|PREGRP10
block|}
block|,
block|{
name|PREGRP17
block|}
block|,
block|{
name|PREGRP16
block|}
block|,
block|{
name|PREGRP14
block|}
block|,
block|{
name|PREGRP7
block|}
block|,
block|{
name|PREGRP5
block|}
block|,
block|{
name|PREGRP6
block|}
block|,
comment|/* 60 */
block|{
literal|"punpcklbw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"punpcklwd"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"punpckldq"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"packsswb"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pcmpgtb"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pcmpgtw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pcmpgtd"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"packuswb"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
comment|/* 68 */
block|{
literal|"punpckhbw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"punpckhwd"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"punpckhdq"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"packssdw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
name|PREGRP26
block|}
block|,
block|{
name|PREGRP24
block|}
block|,
block|{
literal|"movd"
block|,
name|MX
block|,
name|Ed
block|,
name|XX
block|}
block|,
block|{
name|PREGRP19
block|}
block|,
comment|/* 70 */
block|{
name|PREGRP22
block|}
block|,
block|{
name|GRP10
block|}
block|,
block|{
name|GRP11
block|}
block|,
block|{
name|GRP12
block|}
block|,
block|{
literal|"pcmpeqb"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pcmpeqw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pcmpeqd"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"emms"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 78 */
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
name|PREGRP23
block|}
block|,
block|{
name|PREGRP20
block|}
block|,
comment|/* 80 */
block|{
literal|"joH"
block|,
name|Jv
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jnoH"
block|,
name|Jv
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jbH"
block|,
name|Jv
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jaeH"
block|,
name|Jv
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jeH"
block|,
name|Jv
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jneH"
block|,
name|Jv
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jbeH"
block|,
name|Jv
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jaH"
block|,
name|Jv
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
comment|/* 88 */
block|{
literal|"jsH"
block|,
name|Jv
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jnsH"
block|,
name|Jv
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jpH"
block|,
name|Jv
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jnpH"
block|,
name|Jv
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jlH"
block|,
name|Jv
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jgeH"
block|,
name|Jv
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jleH"
block|,
name|Jv
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
block|{
literal|"jgH"
block|,
name|Jv
block|,
name|XX
block|,
name|cond_jump_flag
block|}
block|,
comment|/* 90 */
block|{
literal|"seto"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"setno"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"setb"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"setae"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"sete"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"setne"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"setbe"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"seta"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* 98 */
block|{
literal|"sets"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"setns"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"setp"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"setnp"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"setl"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"setge"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"setle"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"setg"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* a0 */
block|{
literal|"pushT"
block|,
name|fs
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"popT"
block|,
name|fs
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"cpuid"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"btS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
block|{
literal|"shldS"
block|,
name|Ev
block|,
name|Gv
block|,
name|Ib
block|}
block|,
block|{
literal|"shldS"
block|,
name|Ev
block|,
name|Gv
block|,
name|CL
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* a8 */
block|{
literal|"pushT"
block|,
name|gs
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"popT"
block|,
name|gs
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"rsm"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"btsS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
block|{
literal|"shrdS"
block|,
name|Ev
block|,
name|Gv
block|,
name|Ib
block|}
block|,
block|{
literal|"shrdS"
block|,
name|Ev
block|,
name|Gv
block|,
name|CL
block|}
block|,
block|{
name|GRP13
block|}
block|,
block|{
literal|"imulS"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
comment|/* b0 */
block|{
literal|"cmpxchgB"
block|,
name|Eb
block|,
name|Gb
block|,
name|XX
block|}
block|,
block|{
literal|"cmpxchgS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
block|{
literal|"lssS"
block|,
name|Gv
block|,
name|Mp
block|,
name|XX
block|}
block|,
block|{
literal|"btrS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
block|{
literal|"lfsS"
block|,
name|Gv
block|,
name|Mp
block|,
name|XX
block|}
block|,
block|{
literal|"lgsS"
block|,
name|Gv
block|,
name|Mp
block|,
name|XX
block|}
block|,
block|{
literal|"movz{bR|x|bR|x}"
block|,
name|Gv
block|,
name|Eb
block|,
name|XX
block|}
block|,
block|{
literal|"movz{wR|x|wR|x}"
block|,
name|Gv
block|,
name|Ew
block|,
name|XX
block|}
block|,
comment|/* yes, there really is movzww ! */
comment|/* b8 */
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"ud2b"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
name|GRP8
block|}
block|,
block|{
literal|"btcS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
block|{
literal|"bsfS"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"bsrS"
block|,
name|Gv
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"movs{bR|x|bR|x}"
block|,
name|Gv
block|,
name|Eb
block|,
name|XX
block|}
block|,
block|{
literal|"movs{wR|x|wR|x}"
block|,
name|Gv
block|,
name|Ew
block|,
name|XX
block|}
block|,
comment|/* yes, there really is movsww ! */
comment|/* c0 */
block|{
literal|"xaddB"
block|,
name|Eb
block|,
name|Gb
block|,
name|XX
block|}
block|,
block|{
literal|"xaddS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
block|{
name|PREGRP1
block|}
block|,
block|{
literal|"movntiS"
block|,
name|Ev
block|,
name|Gv
block|,
name|XX
block|}
block|,
block|{
literal|"pinsrw"
block|,
name|MX
block|,
name|Ed
block|,
name|Ib
block|}
block|,
block|{
literal|"pextrw"
block|,
name|Gd
block|,
name|MS
block|,
name|Ib
block|}
block|,
block|{
literal|"shufpX"
block|,
name|XM
block|,
name|EX
block|,
name|Ib
block|}
block|,
block|{
name|GRP9
block|}
block|,
comment|/* c8 */
block|{
literal|"bswap"
block|,
name|RMeAX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"bswap"
block|,
name|RMeCX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"bswap"
block|,
name|RMeDX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"bswap"
block|,
name|RMeBX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"bswap"
block|,
name|RMeSP
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"bswap"
block|,
name|RMeBP
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"bswap"
block|,
name|RMeSI
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"bswap"
block|,
name|RMeDI
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* d0 */
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"psrlw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"psrld"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"psrlq"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"paddq"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pmullw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
name|PREGRP21
block|}
block|,
block|{
literal|"pmovmskb"
block|,
name|Gd
block|,
name|MS
block|,
name|XX
block|}
block|,
comment|/* d8 */
block|{
literal|"psubusb"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"psubusw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pminub"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pand"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"paddusb"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"paddusw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pmaxub"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pandn"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
comment|/* e0 */
block|{
literal|"pavgb"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"psraw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"psrad"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pavgw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pmulhuw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pmulhw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
name|PREGRP15
block|}
block|,
block|{
name|PREGRP25
block|}
block|,
comment|/* e8 */
block|{
literal|"psubsb"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"psubsw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pminsw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"por"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"paddsb"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"paddsw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pmaxsw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pxor"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
comment|/* f0 */
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"psllw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pslld"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"psllq"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pmuludq"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"pmaddwd"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"psadbw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
name|PREGRP18
block|}
block|,
comment|/* f8 */
block|{
literal|"psubb"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"psubw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"psubd"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"psubq"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"paddb"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"paddw"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"paddd"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
name|onebyte_has_modrm
index|[
literal|256
index|]
init|=
block|{
comment|/*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
comment|/*       -------------------------------        */
comment|/* 00 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 00 */
comment|/* 10 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 10 */
comment|/* 20 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 20 */
comment|/* 30 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 30 */
comment|/* 40 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 40 */
comment|/* 50 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 50 */
comment|/* 60 */
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 60 */
comment|/* 70 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 70 */
comment|/* 80 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
comment|/* 80 */
comment|/* 90 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 90 */
comment|/* a0 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* a0 */
comment|/* b0 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* b0 */
comment|/* c0 */
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* c0 */
comment|/* d0 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
comment|/* d0 */
comment|/* e0 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* e0 */
comment|/* f0 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
comment|/* f0 */
comment|/*       -------------------------------        */
comment|/*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
name|twobyte_has_modrm
index|[
literal|256
index|]
init|=
block|{
comment|/*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
comment|/*       -------------------------------        */
comment|/* 00 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
literal|1
block|,
comment|/* 0f */
comment|/* 10 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 1f */
comment|/* 20 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
comment|/* 2f */
comment|/* 30 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 3f */
comment|/* 40 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
comment|/* 4f */
comment|/* 50 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
comment|/* 5f */
comment|/* 60 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
comment|/* 6f */
comment|/* 70 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
comment|/* 7f */
comment|/* 80 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 8f */
comment|/* 90 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
comment|/* 9f */
comment|/* a0 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
comment|/* af */
comment|/* b0 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
comment|/* bf */
comment|/* c0 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* cf */
comment|/* d0 */
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
comment|/* df */
comment|/* e0 */
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
comment|/* ef */
comment|/* f0 */
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
comment|/* ff */
comment|/*       -------------------------------        */
comment|/*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
name|twobyte_uses_SSE_prefix
index|[
literal|256
index|]
init|=
block|{
comment|/*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
comment|/*       -------------------------------        */
comment|/* 00 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 0f */
comment|/* 10 */
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 1f */
comment|/* 20 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
comment|/* 2f */
comment|/* 30 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 3f */
comment|/* 40 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 4f */
comment|/* 50 */
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|,
comment|/* 5f */
comment|/* 60 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
literal|1
block|,
comment|/* 6f */
comment|/* 70 */
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|1
block|,
comment|/* 7f */
comment|/* 80 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 8f */
comment|/* 90 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* 9f */
comment|/* a0 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* af */
comment|/* b0 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* bf */
comment|/* c0 */
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* cf */
comment|/* d0 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* df */
comment|/* e0 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* ef */
comment|/* f0 */
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
comment|/* ff */
comment|/*       -------------------------------        */
comment|/*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
name|obuf
index|[
literal|100
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|obufp
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
name|scratchbuf
index|[
literal|100
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|unsigned
name|char
modifier|*
name|start_codep
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|unsigned
name|char
modifier|*
name|insn_codep
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|unsigned
name|char
modifier|*
name|codep
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|disassemble_info
modifier|*
name|the_info
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|mod
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|rm
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|reg
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|unsigned
name|char
name|need_modrm
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* If we are accessing mod/rm/reg without need_modrm set, then the    values are stale.  Hitting this abort likely indicates that you    need to update onebyte_has_modrm or twobyte_has_modrm.  */
end_comment

begin_define
define|#
directive|define
name|MODRM_CHECK
value|if (!need_modrm) abort ()
end_define

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
modifier|*
name|names64
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
modifier|*
name|names32
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
modifier|*
name|names16
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
modifier|*
name|names8
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
modifier|*
name|names8rex
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
modifier|*
name|names_seg
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
modifier|*
name|index16
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|intel_names64
index|[]
init|=
block|{
literal|"rax"
block|,
literal|"rcx"
block|,
literal|"rdx"
block|,
literal|"rbx"
block|,
literal|"rsp"
block|,
literal|"rbp"
block|,
literal|"rsi"
block|,
literal|"rdi"
block|,
literal|"r8"
block|,
literal|"r9"
block|,
literal|"r10"
block|,
literal|"r11"
block|,
literal|"r12"
block|,
literal|"r13"
block|,
literal|"r14"
block|,
literal|"r15"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|intel_names32
index|[]
init|=
block|{
literal|"eax"
block|,
literal|"ecx"
block|,
literal|"edx"
block|,
literal|"ebx"
block|,
literal|"esp"
block|,
literal|"ebp"
block|,
literal|"esi"
block|,
literal|"edi"
block|,
literal|"r8d"
block|,
literal|"r9d"
block|,
literal|"r10d"
block|,
literal|"r11d"
block|,
literal|"r12d"
block|,
literal|"r13d"
block|,
literal|"r14d"
block|,
literal|"r15d"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|intel_names16
index|[]
init|=
block|{
literal|"ax"
block|,
literal|"cx"
block|,
literal|"dx"
block|,
literal|"bx"
block|,
literal|"sp"
block|,
literal|"bp"
block|,
literal|"si"
block|,
literal|"di"
block|,
literal|"r8w"
block|,
literal|"r9w"
block|,
literal|"r10w"
block|,
literal|"r11w"
block|,
literal|"r12w"
block|,
literal|"r13w"
block|,
literal|"r14w"
block|,
literal|"r15w"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|intel_names8
index|[]
init|=
block|{
literal|"al"
block|,
literal|"cl"
block|,
literal|"dl"
block|,
literal|"bl"
block|,
literal|"ah"
block|,
literal|"ch"
block|,
literal|"dh"
block|,
literal|"bh"
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|intel_names8rex
index|[]
init|=
block|{
literal|"al"
block|,
literal|"cl"
block|,
literal|"dl"
block|,
literal|"bl"
block|,
literal|"spl"
block|,
literal|"bpl"
block|,
literal|"sil"
block|,
literal|"dil"
block|,
literal|"r8b"
block|,
literal|"r9b"
block|,
literal|"r10b"
block|,
literal|"r11b"
block|,
literal|"r12b"
block|,
literal|"r13b"
block|,
literal|"r14b"
block|,
literal|"r15b"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|intel_names_seg
index|[]
init|=
block|{
literal|"es"
block|,
literal|"cs"
block|,
literal|"ss"
block|,
literal|"ds"
block|,
literal|"fs"
block|,
literal|"gs"
block|,
literal|"?"
block|,
literal|"?"
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|intel_index16
index|[]
init|=
block|{
literal|"bx+si"
block|,
literal|"bx+di"
block|,
literal|"bp+si"
block|,
literal|"bp+di"
block|,
literal|"si"
block|,
literal|"di"
block|,
literal|"bp"
block|,
literal|"bx"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|att_names64
index|[]
init|=
block|{
literal|"%rax"
block|,
literal|"%rcx"
block|,
literal|"%rdx"
block|,
literal|"%rbx"
block|,
literal|"%rsp"
block|,
literal|"%rbp"
block|,
literal|"%rsi"
block|,
literal|"%rdi"
block|,
literal|"%r8"
block|,
literal|"%r9"
block|,
literal|"%r10"
block|,
literal|"%r11"
block|,
literal|"%r12"
block|,
literal|"%r13"
block|,
literal|"%r14"
block|,
literal|"%r15"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|att_names32
index|[]
init|=
block|{
literal|"%eax"
block|,
literal|"%ecx"
block|,
literal|"%edx"
block|,
literal|"%ebx"
block|,
literal|"%esp"
block|,
literal|"%ebp"
block|,
literal|"%esi"
block|,
literal|"%edi"
block|,
literal|"%r8d"
block|,
literal|"%r9d"
block|,
literal|"%r10d"
block|,
literal|"%r11d"
block|,
literal|"%r12d"
block|,
literal|"%r13d"
block|,
literal|"%r14d"
block|,
literal|"%r15d"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|att_names16
index|[]
init|=
block|{
literal|"%ax"
block|,
literal|"%cx"
block|,
literal|"%dx"
block|,
literal|"%bx"
block|,
literal|"%sp"
block|,
literal|"%bp"
block|,
literal|"%si"
block|,
literal|"%di"
block|,
literal|"%r8w"
block|,
literal|"%r9w"
block|,
literal|"%r10w"
block|,
literal|"%r11w"
block|,
literal|"%r12w"
block|,
literal|"%r13w"
block|,
literal|"%r14w"
block|,
literal|"%r15w"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|att_names8
index|[]
init|=
block|{
literal|"%al"
block|,
literal|"%cl"
block|,
literal|"%dl"
block|,
literal|"%bl"
block|,
literal|"%ah"
block|,
literal|"%ch"
block|,
literal|"%dh"
block|,
literal|"%bh"
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|att_names8rex
index|[]
init|=
block|{
literal|"%al"
block|,
literal|"%cl"
block|,
literal|"%dl"
block|,
literal|"%bl"
block|,
literal|"%spl"
block|,
literal|"%bpl"
block|,
literal|"%sil"
block|,
literal|"%dil"
block|,
literal|"%r8b"
block|,
literal|"%r9b"
block|,
literal|"%r10b"
block|,
literal|"%r11b"
block|,
literal|"%r12b"
block|,
literal|"%r13b"
block|,
literal|"%r14b"
block|,
literal|"%r15b"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|att_names_seg
index|[]
init|=
block|{
literal|"%es"
block|,
literal|"%cs"
block|,
literal|"%ss"
block|,
literal|"%ds"
block|,
literal|"%fs"
block|,
literal|"%gs"
block|,
literal|"%?"
block|,
literal|"%?"
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|att_index16
index|[]
init|=
block|{
literal|"%bx,%si"
block|,
literal|"%bx,%di"
block|,
literal|"%bp,%si"
block|,
literal|"%bp,%di"
block|,
literal|"%si"
block|,
literal|"%di"
block|,
literal|"%bp"
block|,
literal|"%bx"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|dis386
name|grps
index|[]
index|[
literal|8
index|]
init|=
block|{
comment|/* GRP1b */
block|{
block|{
literal|"addA"
block|,
name|Eb
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"orA"
block|,
name|Eb
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"adcA"
block|,
name|Eb
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"sbbA"
block|,
name|Eb
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"andA"
block|,
name|Eb
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"subA"
block|,
name|Eb
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"xorA"
block|,
name|Eb
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"cmpA"
block|,
name|Eb
block|,
name|Ib
block|,
name|XX
block|}
block|}
block|,
comment|/* GRP1S */
block|{
block|{
literal|"addQ"
block|,
name|Ev
block|,
name|Iv
block|,
name|XX
block|}
block|,
block|{
literal|"orQ"
block|,
name|Ev
block|,
name|Iv
block|,
name|XX
block|}
block|,
block|{
literal|"adcQ"
block|,
name|Ev
block|,
name|Iv
block|,
name|XX
block|}
block|,
block|{
literal|"sbbQ"
block|,
name|Ev
block|,
name|Iv
block|,
name|XX
block|}
block|,
block|{
literal|"andQ"
block|,
name|Ev
block|,
name|Iv
block|,
name|XX
block|}
block|,
block|{
literal|"subQ"
block|,
name|Ev
block|,
name|Iv
block|,
name|XX
block|}
block|,
block|{
literal|"xorQ"
block|,
name|Ev
block|,
name|Iv
block|,
name|XX
block|}
block|,
block|{
literal|"cmpQ"
block|,
name|Ev
block|,
name|Iv
block|,
name|XX
block|}
block|}
block|,
comment|/* GRP1Ss */
block|{
block|{
literal|"addQ"
block|,
name|Ev
block|,
name|sIb
block|,
name|XX
block|}
block|,
block|{
literal|"orQ"
block|,
name|Ev
block|,
name|sIb
block|,
name|XX
block|}
block|,
block|{
literal|"adcQ"
block|,
name|Ev
block|,
name|sIb
block|,
name|XX
block|}
block|,
block|{
literal|"sbbQ"
block|,
name|Ev
block|,
name|sIb
block|,
name|XX
block|}
block|,
block|{
literal|"andQ"
block|,
name|Ev
block|,
name|sIb
block|,
name|XX
block|}
block|,
block|{
literal|"subQ"
block|,
name|Ev
block|,
name|sIb
block|,
name|XX
block|}
block|,
block|{
literal|"xorQ"
block|,
name|Ev
block|,
name|sIb
block|,
name|XX
block|}
block|,
block|{
literal|"cmpQ"
block|,
name|Ev
block|,
name|sIb
block|,
name|XX
block|}
block|}
block|,
comment|/* GRP2b */
block|{
block|{
literal|"rolA"
block|,
name|Eb
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"rorA"
block|,
name|Eb
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"rclA"
block|,
name|Eb
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"rcrA"
block|,
name|Eb
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"shlA"
block|,
name|Eb
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"shrA"
block|,
name|Eb
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"sarA"
block|,
name|Eb
block|,
name|Ib
block|,
name|XX
block|}
block|,   }
block|,
comment|/* GRP2S */
block|{
block|{
literal|"rolQ"
block|,
name|Ev
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"rorQ"
block|,
name|Ev
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"rclQ"
block|,
name|Ev
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"rcrQ"
block|,
name|Ev
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"shlQ"
block|,
name|Ev
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"shrQ"
block|,
name|Ev
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"sarQ"
block|,
name|Ev
block|,
name|Ib
block|,
name|XX
block|}
block|,   }
block|,
comment|/* GRP2b_one */
block|{
block|{
literal|"rolA"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"rorA"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"rclA"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"rcrA"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"shlA"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"shrA"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"sarA"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* GRP2S_one */
block|{
block|{
literal|"rolQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"rorQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"rclQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"rcrQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"shlQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"shrQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"sarQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* GRP2b_cl */
block|{
block|{
literal|"rolA"
block|,
name|Eb
block|,
name|CL
block|,
name|XX
block|}
block|,
block|{
literal|"rorA"
block|,
name|Eb
block|,
name|CL
block|,
name|XX
block|}
block|,
block|{
literal|"rclA"
block|,
name|Eb
block|,
name|CL
block|,
name|XX
block|}
block|,
block|{
literal|"rcrA"
block|,
name|Eb
block|,
name|CL
block|,
name|XX
block|}
block|,
block|{
literal|"shlA"
block|,
name|Eb
block|,
name|CL
block|,
name|XX
block|}
block|,
block|{
literal|"shrA"
block|,
name|Eb
block|,
name|CL
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"sarA"
block|,
name|Eb
block|,
name|CL
block|,
name|XX
block|}
block|,   }
block|,
comment|/* GRP2S_cl */
block|{
block|{
literal|"rolQ"
block|,
name|Ev
block|,
name|CL
block|,
name|XX
block|}
block|,
block|{
literal|"rorQ"
block|,
name|Ev
block|,
name|CL
block|,
name|XX
block|}
block|,
block|{
literal|"rclQ"
block|,
name|Ev
block|,
name|CL
block|,
name|XX
block|}
block|,
block|{
literal|"rcrQ"
block|,
name|Ev
block|,
name|CL
block|,
name|XX
block|}
block|,
block|{
literal|"shlQ"
block|,
name|Ev
block|,
name|CL
block|,
name|XX
block|}
block|,
block|{
literal|"shrQ"
block|,
name|Ev
block|,
name|CL
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"sarQ"
block|,
name|Ev
block|,
name|CL
block|,
name|XX
block|}
block|}
block|,
comment|/* GRP3b */
block|{
block|{
literal|"testA"
block|,
name|Eb
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"notA"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"negA"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"mulA"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* Don't print the implicit %al register,  */
block|{
literal|"imulA"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* to distinguish these opcodes from other */
block|{
literal|"divA"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* mul/imul opcodes.  Do the same for div  */
block|{
literal|"idivA"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
comment|/* and idiv for consistency.		   */
block|}
block|,
comment|/* GRP3S */
block|{
block|{
literal|"testQ"
block|,
name|Ev
block|,
name|Iv
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"notQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"negQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"mulQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* Don't print the implicit register.  */
block|{
literal|"imulQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"divQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"idivQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* GRP4 */
block|{
block|{
literal|"incA"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"decA"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* GRP5 */
block|{
block|{
literal|"incQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"decQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"callT"
block|,
name|indirEv
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"lcallT"
block|,
name|indirEv
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"jmpT"
block|,
name|indirEv
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"ljmpT"
block|,
name|indirEv
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"pushU"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* GRP6 */
block|{
block|{
literal|"sldtQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"strQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"lldt"
block|,
name|Ew
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"ltr"
block|,
name|Ew
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"verr"
block|,
name|Ew
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"verw"
block|,
name|Ew
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|}
block|,
comment|/* GRP7 */
block|{
block|{
literal|"sgdtQ"
block|,
name|M
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"sidtQ"
block|,
name|M
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"lgdtQ"
block|,
name|M
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"lidtQ"
block|,
name|M
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"smswQ"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"lmsw"
block|,
name|Ew
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"invlpg"
block|,
name|Ew
block|,
name|XX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* GRP8 */
block|{
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"btQ"
block|,
name|Ev
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"btsQ"
block|,
name|Ev
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"btrQ"
block|,
name|Ev
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"btcQ"
block|,
name|Ev
block|,
name|Ib
block|,
name|XX
block|}
block|,   }
block|,
comment|/* GRP9 */
block|{
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"cmpxchg8b"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* GRP10 */
block|{
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"psrlw"
block|,
name|MS
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"psraw"
block|,
name|MS
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"psllw"
block|,
name|MS
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* GRP11 */
block|{
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"psrld"
block|,
name|MS
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"psrad"
block|,
name|MS
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"pslld"
block|,
name|MS
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* GRP12 */
block|{
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"psrlq"
block|,
name|MS
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"psrldq"
block|,
name|MS
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"psllq"
block|,
name|MS
block|,
name|Ib
block|,
name|XX
block|}
block|,
block|{
literal|"pslldq"
block|,
name|MS
block|,
name|Ib
block|,
name|XX
block|}
block|,   }
block|,
comment|/* GRP13 */
block|{
block|{
literal|"fxsave"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"fxrstor"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"ldmxcsr"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"stmxcsr"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"lfence"
block|,
name|None
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"mfence"
block|,
name|None
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"sfence"
block|,
name|None
block|,
name|XX
block|,
name|XX
block|}
block|,
comment|/* FIXME: the sfence with memory operand is clflush!  */
block|}
block|,
comment|/* GRP14 */
block|{
block|{
literal|"prefetchnta"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"prefetcht0"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"prefetcht1"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"prefetcht2"
block|,
name|Ev
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* GRPAMD */
block|{
block|{
literal|"prefetch"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"prefetchw"
block|,
name|Eb
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,   }
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|dis386
name|prefix_user_table
index|[]
index|[
literal|4
index|]
init|=
block|{
comment|/* PREGRP0 */
block|{
block|{
literal|"addps"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"addss"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"addpd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"addsd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP1 */
block|{
block|{
literal|""
block|,
name|XM
block|,
name|EX
block|,
name|OPSIMD
block|}
block|,
comment|/* See OP_SIMD_SUFFIX.  */
block|{
literal|""
block|,
name|XM
block|,
name|EX
block|,
name|OPSIMD
block|}
block|,
block|{
literal|""
block|,
name|XM
block|,
name|EX
block|,
name|OPSIMD
block|}
block|,
block|{
literal|""
block|,
name|XM
block|,
name|EX
block|,
name|OPSIMD
block|}
block|,   }
block|,
comment|/* PREGRP2 */
block|{
block|{
literal|"cvtpi2ps"
block|,
name|XM
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"cvtsi2ssY"
block|,
name|XM
block|,
name|Ev
block|,
name|XX
block|}
block|,
block|{
literal|"cvtpi2pd"
block|,
name|XM
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"cvtsi2sdY"
block|,
name|XM
block|,
name|Ev
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP3 */
block|{
block|{
literal|"cvtps2pi"
block|,
name|MX
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"cvtss2siY"
block|,
name|Gv
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"cvtpd2pi"
block|,
name|MX
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"cvtsd2siY"
block|,
name|Gv
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP4 */
block|{
block|{
literal|"cvttps2pi"
block|,
name|MX
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"cvttss2siY"
block|,
name|Gv
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"cvttpd2pi"
block|,
name|MX
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"cvttsd2siY"
block|,
name|Gv
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP5 */
block|{
block|{
literal|"divps"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"divss"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"divpd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"divsd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP6 */
block|{
block|{
literal|"maxps"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"maxss"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"maxpd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"maxsd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP7 */
block|{
block|{
literal|"minps"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"minss"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"minpd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"minsd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP8 */
block|{
block|{
literal|"movups"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"movss"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"movupd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"movsd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP9 */
block|{
block|{
literal|"movups"
block|,
name|EX
block|,
name|XM
block|,
name|XX
block|}
block|,
block|{
literal|"movss"
block|,
name|EX
block|,
name|XM
block|,
name|XX
block|}
block|,
block|{
literal|"movupd"
block|,
name|EX
block|,
name|XM
block|,
name|XX
block|}
block|,
block|{
literal|"movsd"
block|,
name|EX
block|,
name|XM
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP10 */
block|{
block|{
literal|"mulps"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"mulss"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"mulpd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"mulsd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP11 */
block|{
block|{
literal|"rcpps"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"rcpss"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP12 */
block|{
block|{
literal|"rsqrtps"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"rsqrtss"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP13 */
block|{
block|{
literal|"sqrtps"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"sqrtss"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"sqrtpd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"sqrtsd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP14 */
block|{
block|{
literal|"subps"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"subss"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"subpd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"subsd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP15 */
block|{
block|{
literal|"(bad)"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"cvtdq2pd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"cvttpd2dq"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"cvtpd2dq"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP16 */
block|{
block|{
literal|"cvtdq2ps"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"cvttps2dq"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"cvtps2dq"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP17 */
block|{
block|{
literal|"cvtps2pd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"cvtss2sd"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"cvtpd2ps"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"cvtsd2ss"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP18 */
block|{
block|{
literal|"maskmovq"
block|,
name|MX
block|,
name|MS
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"maskmovdqu"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP19 */
block|{
block|{
literal|"movq"
block|,
name|MX
block|,
name|EM
block|,
name|XX
block|}
block|,
block|{
literal|"movdqu"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"movdqa"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP20 */
block|{
block|{
literal|"movq"
block|,
name|EM
block|,
name|MX
block|,
name|XX
block|}
block|,
block|{
literal|"movdqu"
block|,
name|EX
block|,
name|XM
block|,
name|XX
block|}
block|,
block|{
literal|"movdqa"
block|,
name|EX
block|,
name|XM
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|EX
block|,
name|XM
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP21 */
block|{
block|{
literal|"(bad)"
block|,
name|EX
block|,
name|XM
block|,
name|XX
block|}
block|,
block|{
literal|"movq2dq"
block|,
name|XM
block|,
name|MS
block|,
name|XX
block|}
block|,
block|{
literal|"movq"
block|,
name|EX
block|,
name|XM
block|,
name|XX
block|}
block|,
block|{
literal|"movdq2q"
block|,
name|MX
block|,
name|XS
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP22 */
block|{
block|{
literal|"pshufw"
block|,
name|MX
block|,
name|EM
block|,
name|Ib
block|}
block|,
block|{
literal|"pshufhw"
block|,
name|XM
block|,
name|EX
block|,
name|Ib
block|}
block|,
block|{
literal|"pshufd"
block|,
name|XM
block|,
name|EX
block|,
name|Ib
block|}
block|,
block|{
literal|"pshuflw"
block|,
name|XM
block|,
name|EX
block|,
name|Ib
block|}
block|,   }
block|,
comment|/* PREGRP23 */
block|{
block|{
literal|"movd"
block|,
name|Ed
block|,
name|MX
block|,
name|XX
block|}
block|,
block|{
literal|"movq"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"movd"
block|,
name|Ed
block|,
name|XM
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|Ed
block|,
name|XM
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP24 */
block|{
block|{
literal|"(bad)"
block|,
name|MX
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"punpckhqdq"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP25 */
block|{
block|{
literal|"movntq"
block|,
name|Ev
block|,
name|MX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|Ev
block|,
name|XM
block|,
name|XX
block|}
block|,
block|{
literal|"movntdq"
block|,
name|Ev
block|,
name|XM
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|Ev
block|,
name|XM
block|,
name|XX
block|}
block|,   }
block|,
comment|/* PREGRP26 */
block|{
block|{
literal|"(bad)"
block|,
name|MX
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"punpcklqdq"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XM
block|,
name|EX
block|,
name|XX
block|}
block|,   }
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|dis386
name|x86_64_table
index|[]
index|[
literal|2
index|]
init|=
block|{
block|{
block|{
literal|"arpl"
block|,
name|Ew
block|,
name|Gw
block|,
name|XX
block|}
block|,
block|{
literal|"movs{||lq|xd}"
block|,
name|Gv
block|,
name|Ed
block|,
name|XX
block|}
block|,   }
block|, }
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|INTERNAL_DISASSEMBLER_ERROR
value|_("<internal disassembler error>")
end_define

begin_function
specifier|static
name|void
name|ckprefix
parameter_list|()
block|{
name|int
name|newrex
decl_stmt|;
name|rex
operator|=
literal|0
expr_stmt|;
name|prefixes
operator|=
literal|0
expr_stmt|;
name|used_prefixes
operator|=
literal|0
expr_stmt|;
name|rex_used
operator|=
literal|0
expr_stmt|;
while|while
condition|(
literal|1
condition|)
block|{
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|newrex
operator|=
literal|0
expr_stmt|;
switch|switch
condition|(
operator|*
name|codep
condition|)
block|{
comment|/* REX prefixes family.  */
case|case
literal|0x40
case|:
case|case
literal|0x41
case|:
case|case
literal|0x42
case|:
case|case
literal|0x43
case|:
case|case
literal|0x44
case|:
case|case
literal|0x45
case|:
case|case
literal|0x46
case|:
case|case
literal|0x47
case|:
case|case
literal|0x48
case|:
case|case
literal|0x49
case|:
case|case
literal|0x4a
case|:
case|case
literal|0x4b
case|:
case|case
literal|0x4c
case|:
case|case
literal|0x4d
case|:
case|case
literal|0x4e
case|:
case|case
literal|0x4f
case|:
if|if
condition|(
name|mode_64bit
condition|)
name|newrex
operator|=
operator|*
name|codep
expr_stmt|;
else|else
return|return;
break|break;
case|case
literal|0xf3
case|:
name|prefixes
operator||=
name|PREFIX_REPZ
expr_stmt|;
break|break;
case|case
literal|0xf2
case|:
name|prefixes
operator||=
name|PREFIX_REPNZ
expr_stmt|;
break|break;
case|case
literal|0xf0
case|:
name|prefixes
operator||=
name|PREFIX_LOCK
expr_stmt|;
break|break;
case|case
literal|0x2e
case|:
name|prefixes
operator||=
name|PREFIX_CS
expr_stmt|;
break|break;
case|case
literal|0x36
case|:
name|prefixes
operator||=
name|PREFIX_SS
expr_stmt|;
break|break;
case|case
literal|0x3e
case|:
name|prefixes
operator||=
name|PREFIX_DS
expr_stmt|;
break|break;
case|case
literal|0x26
case|:
name|prefixes
operator||=
name|PREFIX_ES
expr_stmt|;
break|break;
case|case
literal|0x64
case|:
name|prefixes
operator||=
name|PREFIX_FS
expr_stmt|;
break|break;
case|case
literal|0x65
case|:
name|prefixes
operator||=
name|PREFIX_GS
expr_stmt|;
break|break;
case|case
literal|0x66
case|:
name|prefixes
operator||=
name|PREFIX_DATA
expr_stmt|;
break|break;
case|case
literal|0x67
case|:
name|prefixes
operator||=
name|PREFIX_ADDR
expr_stmt|;
break|break;
case|case
name|FWAIT_OPCODE
case|:
comment|/* fwait is really an instruction.  If there are prefixes 	     before the fwait, they belong to the fwait, *not* to the 	     following instruction.  */
if|if
condition|(
name|prefixes
condition|)
block|{
name|prefixes
operator||=
name|PREFIX_FWAIT
expr_stmt|;
name|codep
operator|++
expr_stmt|;
return|return;
block|}
name|prefixes
operator|=
name|PREFIX_FWAIT
expr_stmt|;
break|break;
default|default:
return|return;
block|}
comment|/* Rex is ignored when followed by another prefix.  */
if|if
condition|(
name|rex
condition|)
block|{
name|oappend
argument_list|(
name|prefix_name
argument_list|(
name|rex
argument_list|,
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
literal|" "
argument_list|)
expr_stmt|;
block|}
name|rex
operator|=
name|newrex
expr_stmt|;
name|codep
operator|++
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* Return the name of the prefix byte PREF, or NULL if PREF is not a    prefix byte.  */
end_comment

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|prefix_name
parameter_list|(
name|pref
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|pref
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
switch|switch
condition|(
name|pref
condition|)
block|{
comment|/* REX prefixes family.  */
case|case
literal|0x40
case|:
return|return
literal|"rex"
return|;
case|case
literal|0x41
case|:
return|return
literal|"rexZ"
return|;
case|case
literal|0x42
case|:
return|return
literal|"rexY"
return|;
case|case
literal|0x43
case|:
return|return
literal|"rexYZ"
return|;
case|case
literal|0x44
case|:
return|return
literal|"rexX"
return|;
case|case
literal|0x45
case|:
return|return
literal|"rexXZ"
return|;
case|case
literal|0x46
case|:
return|return
literal|"rexXY"
return|;
case|case
literal|0x47
case|:
return|return
literal|"rexXYZ"
return|;
case|case
literal|0x48
case|:
return|return
literal|"rex64"
return|;
case|case
literal|0x49
case|:
return|return
literal|"rex64Z"
return|;
case|case
literal|0x4a
case|:
return|return
literal|"rex64Y"
return|;
case|case
literal|0x4b
case|:
return|return
literal|"rex64YZ"
return|;
case|case
literal|0x4c
case|:
return|return
literal|"rex64X"
return|;
case|case
literal|0x4d
case|:
return|return
literal|"rex64XZ"
return|;
case|case
literal|0x4e
case|:
return|return
literal|"rex64XY"
return|;
case|case
literal|0x4f
case|:
return|return
literal|"rex64XYZ"
return|;
case|case
literal|0xf3
case|:
return|return
literal|"repz"
return|;
case|case
literal|0xf2
case|:
return|return
literal|"repnz"
return|;
case|case
literal|0xf0
case|:
return|return
literal|"lock"
return|;
case|case
literal|0x2e
case|:
return|return
literal|"cs"
return|;
case|case
literal|0x36
case|:
return|return
literal|"ss"
return|;
case|case
literal|0x3e
case|:
return|return
literal|"ds"
return|;
case|case
literal|0x26
case|:
return|return
literal|"es"
return|;
case|case
literal|0x64
case|:
return|return
literal|"fs"
return|;
case|case
literal|0x65
case|:
return|return
literal|"gs"
return|;
case|case
literal|0x66
case|:
return|return
operator|(
name|sizeflag
operator|&
name|DFLAG
operator|)
condition|?
literal|"data16"
else|:
literal|"data32"
return|;
case|case
literal|0x67
case|:
return|return
operator|(
name|sizeflag
operator|&
name|AFLAG
operator|)
condition|?
literal|"addr16"
else|:
literal|"addr32"
return|;
case|case
name|FWAIT_OPCODE
case|:
return|return
literal|"fwait"
return|;
default|default:
return|return
name|NULL
return|;
block|}
block|}
end_function

begin_decl_stmt
specifier|static
name|char
name|op1out
index|[
literal|100
index|]
decl_stmt|,
name|op2out
index|[
literal|100
index|]
decl_stmt|,
name|op3out
index|[
literal|100
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|op_ad
decl_stmt|,
name|op_index
index|[
literal|3
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|bfd_vma
name|op_address
index|[
literal|3
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|bfd_vma
name|op_riprel
index|[
literal|3
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|bfd_vma
name|start_pc
decl_stmt|;
end_decl_stmt

begin_escape
end_escape

begin_comment
comment|/*  *   On the 386's of 1988, the maximum length of an instruction is 15 bytes.  *   (see topic "Redundant prefixes" in the "Differences from 8086"  *   section of the "Virtual 8086 Mode" chapter.)  * 'pc' should be the address of this instruction, it will  *   be used to print the target address if this is a relative jump or call  * The function returns the length of this instruction in bytes.  */
end_comment

begin_decl_stmt
specifier|static
name|char
name|intel_syntax
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
name|open_char
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
name|close_char
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
name|separator_char
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
name|scale_char
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Here for backwards compatibility.  When gdb stops using    print_insn_i386_att and print_insn_i386_intel these functions can    disappear, and print_insn_i386 be merged into print_insn.  */
end_comment

begin_function
name|int
name|print_insn_i386_att
parameter_list|(
name|pc
parameter_list|,
name|info
parameter_list|)
name|bfd_vma
name|pc
decl_stmt|;
name|disassemble_info
modifier|*
name|info
decl_stmt|;
block|{
name|intel_syntax
operator|=
literal|0
expr_stmt|;
return|return
name|print_insn
argument_list|(
name|pc
argument_list|,
name|info
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|print_insn_i386_intel
parameter_list|(
name|pc
parameter_list|,
name|info
parameter_list|)
name|bfd_vma
name|pc
decl_stmt|;
name|disassemble_info
modifier|*
name|info
decl_stmt|;
block|{
name|intel_syntax
operator|=
literal|1
expr_stmt|;
return|return
name|print_insn
argument_list|(
name|pc
argument_list|,
name|info
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|print_insn_i386
parameter_list|(
name|pc
parameter_list|,
name|info
parameter_list|)
name|bfd_vma
name|pc
decl_stmt|;
name|disassemble_info
modifier|*
name|info
decl_stmt|;
block|{
name|intel_syntax
operator|=
operator|-
literal|1
expr_stmt|;
return|return
name|print_insn
argument_list|(
name|pc
argument_list|,
name|info
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|print_insn
parameter_list|(
name|pc
parameter_list|,
name|info
parameter_list|)
name|bfd_vma
name|pc
decl_stmt|;
name|disassemble_info
modifier|*
name|info
decl_stmt|;
block|{
specifier|const
name|struct
name|dis386
modifier|*
name|dp
decl_stmt|;
name|int
name|i
decl_stmt|;
name|int
name|two_source_ops
decl_stmt|;
name|char
modifier|*
name|first
decl_stmt|,
modifier|*
name|second
decl_stmt|,
modifier|*
name|third
decl_stmt|;
name|int
name|needcomma
decl_stmt|;
name|unsigned
name|char
name|uses_SSE_prefix
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
specifier|const
name|char
modifier|*
name|p
decl_stmt|;
name|struct
name|dis_private
name|priv
decl_stmt|;
name|mode_64bit
operator|=
operator|(
name|info
operator|->
name|mach
operator|==
name|bfd_mach_x86_64_intel_syntax
operator|||
name|info
operator|->
name|mach
operator|==
name|bfd_mach_x86_64
operator|)
expr_stmt|;
if|if
condition|(
name|intel_syntax
operator|==
operator|-
literal|1
condition|)
name|intel_syntax
operator|=
operator|(
name|info
operator|->
name|mach
operator|==
name|bfd_mach_i386_i386_intel_syntax
operator|||
name|info
operator|->
name|mach
operator|==
name|bfd_mach_x86_64_intel_syntax
operator|)
expr_stmt|;
if|if
condition|(
name|info
operator|->
name|mach
operator|==
name|bfd_mach_i386_i386
operator|||
name|info
operator|->
name|mach
operator|==
name|bfd_mach_x86_64
operator|||
name|info
operator|->
name|mach
operator|==
name|bfd_mach_i386_i386_intel_syntax
operator|||
name|info
operator|->
name|mach
operator|==
name|bfd_mach_x86_64_intel_syntax
condition|)
name|priv
operator|.
name|orig_sizeflag
operator|=
name|AFLAG
operator||
name|DFLAG
expr_stmt|;
elseif|else
if|if
condition|(
name|info
operator|->
name|mach
operator|==
name|bfd_mach_i386_i8086
condition|)
name|priv
operator|.
name|orig_sizeflag
operator|=
literal|0
expr_stmt|;
else|else
name|abort
argument_list|()
expr_stmt|;
for|for
control|(
name|p
operator|=
name|info
operator|->
name|disassembler_options
init|;
name|p
operator|!=
name|NULL
condition|;
control|)
block|{
if|if
condition|(
name|strncmp
argument_list|(
name|p
argument_list|,
literal|"x86-64"
argument_list|,
literal|6
argument_list|)
operator|==
literal|0
condition|)
block|{
name|mode_64bit
operator|=
literal|1
expr_stmt|;
name|priv
operator|.
name|orig_sizeflag
operator|=
name|AFLAG
operator||
name|DFLAG
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|strncmp
argument_list|(
name|p
argument_list|,
literal|"i386"
argument_list|,
literal|4
argument_list|)
operator|==
literal|0
condition|)
block|{
name|mode_64bit
operator|=
literal|0
expr_stmt|;
name|priv
operator|.
name|orig_sizeflag
operator|=
name|AFLAG
operator||
name|DFLAG
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|strncmp
argument_list|(
name|p
argument_list|,
literal|"i8086"
argument_list|,
literal|5
argument_list|)
operator|==
literal|0
condition|)
block|{
name|mode_64bit
operator|=
literal|0
expr_stmt|;
name|priv
operator|.
name|orig_sizeflag
operator|=
literal|0
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|strncmp
argument_list|(
name|p
argument_list|,
literal|"intel"
argument_list|,
literal|5
argument_list|)
operator|==
literal|0
condition|)
block|{
name|intel_syntax
operator|=
literal|1
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|strncmp
argument_list|(
name|p
argument_list|,
literal|"att"
argument_list|,
literal|3
argument_list|)
operator|==
literal|0
condition|)
block|{
name|intel_syntax
operator|=
literal|0
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|strncmp
argument_list|(
name|p
argument_list|,
literal|"addr"
argument_list|,
literal|4
argument_list|)
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|p
index|[
literal|4
index|]
operator|==
literal|'1'
operator|&&
name|p
index|[
literal|5
index|]
operator|==
literal|'6'
condition|)
name|priv
operator|.
name|orig_sizeflag
operator|&=
operator|~
name|AFLAG
expr_stmt|;
elseif|else
if|if
condition|(
name|p
index|[
literal|4
index|]
operator|==
literal|'3'
operator|&&
name|p
index|[
literal|5
index|]
operator|==
literal|'2'
condition|)
name|priv
operator|.
name|orig_sizeflag
operator||=
name|AFLAG
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|strncmp
argument_list|(
name|p
argument_list|,
literal|"data"
argument_list|,
literal|4
argument_list|)
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|p
index|[
literal|4
index|]
operator|==
literal|'1'
operator|&&
name|p
index|[
literal|5
index|]
operator|==
literal|'6'
condition|)
name|priv
operator|.
name|orig_sizeflag
operator|&=
operator|~
name|DFLAG
expr_stmt|;
elseif|else
if|if
condition|(
name|p
index|[
literal|4
index|]
operator|==
literal|'3'
operator|&&
name|p
index|[
literal|5
index|]
operator|==
literal|'2'
condition|)
name|priv
operator|.
name|orig_sizeflag
operator||=
name|DFLAG
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|strncmp
argument_list|(
name|p
argument_list|,
literal|"suffix"
argument_list|,
literal|6
argument_list|)
operator|==
literal|0
condition|)
name|priv
operator|.
name|orig_sizeflag
operator||=
name|SUFFIX_ALWAYS
expr_stmt|;
name|p
operator|=
name|strchr
argument_list|(
name|p
argument_list|,
literal|','
argument_list|)
expr_stmt|;
if|if
condition|(
name|p
operator|!=
name|NULL
condition|)
name|p
operator|++
expr_stmt|;
block|}
if|if
condition|(
name|intel_syntax
condition|)
block|{
name|names64
operator|=
name|intel_names64
expr_stmt|;
name|names32
operator|=
name|intel_names32
expr_stmt|;
name|names16
operator|=
name|intel_names16
expr_stmt|;
name|names8
operator|=
name|intel_names8
expr_stmt|;
name|names8rex
operator|=
name|intel_names8rex
expr_stmt|;
name|names_seg
operator|=
name|intel_names_seg
expr_stmt|;
name|index16
operator|=
name|intel_index16
expr_stmt|;
name|open_char
operator|=
literal|'['
expr_stmt|;
name|close_char
operator|=
literal|']'
expr_stmt|;
name|separator_char
operator|=
literal|'+'
expr_stmt|;
name|scale_char
operator|=
literal|'*'
expr_stmt|;
block|}
else|else
block|{
name|names64
operator|=
name|att_names64
expr_stmt|;
name|names32
operator|=
name|att_names32
expr_stmt|;
name|names16
operator|=
name|att_names16
expr_stmt|;
name|names8
operator|=
name|att_names8
expr_stmt|;
name|names8rex
operator|=
name|att_names8rex
expr_stmt|;
name|names_seg
operator|=
name|att_names_seg
expr_stmt|;
name|index16
operator|=
name|att_index16
expr_stmt|;
name|open_char
operator|=
literal|'('
expr_stmt|;
name|close_char
operator|=
literal|')'
expr_stmt|;
name|separator_char
operator|=
literal|','
expr_stmt|;
name|scale_char
operator|=
literal|','
expr_stmt|;
block|}
comment|/* The output looks better if we put 7 bytes on a line, since that      puts most long word instructions on a single line.  */
name|info
operator|->
name|bytes_per_line
operator|=
literal|7
expr_stmt|;
name|info
operator|->
name|private_data
operator|=
operator|(
name|PTR
operator|)
operator|&
name|priv
expr_stmt|;
name|priv
operator|.
name|max_fetched
operator|=
name|priv
operator|.
name|the_buffer
expr_stmt|;
name|priv
operator|.
name|insn_start
operator|=
name|pc
expr_stmt|;
name|obuf
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|op1out
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|op2out
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|op3out
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|op_index
index|[
literal|0
index|]
operator|=
name|op_index
index|[
literal|1
index|]
operator|=
name|op_index
index|[
literal|2
index|]
operator|=
operator|-
literal|1
expr_stmt|;
name|the_info
operator|=
name|info
expr_stmt|;
name|start_pc
operator|=
name|pc
expr_stmt|;
name|start_codep
operator|=
name|priv
operator|.
name|the_buffer
expr_stmt|;
name|codep
operator|=
name|priv
operator|.
name|the_buffer
expr_stmt|;
if|if
condition|(
name|setjmp
argument_list|(
name|priv
operator|.
name|bailout
argument_list|)
operator|!=
literal|0
condition|)
block|{
specifier|const
name|char
modifier|*
name|name
decl_stmt|;
comment|/* Getting here means we tried for data but didn't get it.  That 	 means we have an incomplete instruction of some sort.  Just 	 print the first byte as a prefix or a .byte pseudo-op.  */
if|if
condition|(
name|codep
operator|>
name|priv
operator|.
name|the_buffer
condition|)
block|{
name|name
operator|=
name|prefix_name
argument_list|(
name|priv
operator|.
name|the_buffer
index|[
literal|0
index|]
argument_list|,
name|priv
operator|.
name|orig_sizeflag
argument_list|)
expr_stmt|;
if|if
condition|(
name|name
operator|!=
name|NULL
condition|)
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|"%s"
argument_list|,
name|name
argument_list|)
expr_stmt|;
else|else
block|{
comment|/* Just print the first byte as a .byte instruction.  */
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|".byte 0x%x"
argument_list|,
operator|(
name|unsigned
name|int
operator|)
name|priv
operator|.
name|the_buffer
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
block|}
return|return
literal|1
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
name|obufp
operator|=
name|obuf
expr_stmt|;
name|ckprefix
argument_list|()
expr_stmt|;
name|insn_codep
operator|=
name|codep
expr_stmt|;
name|sizeflag
operator|=
name|priv
operator|.
name|orig_sizeflag
expr_stmt|;
name|FETCH_DATA
argument_list|(
name|info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|two_source_ops
operator|=
operator|(
operator|*
name|codep
operator|==
literal|0x62
operator|)
operator|||
operator|(
operator|*
name|codep
operator|==
literal|0xc8
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|prefixes
operator|&
name|PREFIX_FWAIT
operator|)
operator|&&
operator|(
operator|(
operator|*
name|codep
operator|<
literal|0xd8
operator|)
operator|||
operator|(
operator|*
name|codep
operator|>
literal|0xdf
operator|)
operator|)
condition|)
block|{
specifier|const
name|char
modifier|*
name|name
decl_stmt|;
comment|/* fwait not followed by floating point instruction.  Print the          first prefix, which is probably fwait itself.  */
name|name
operator|=
name|prefix_name
argument_list|(
name|priv
operator|.
name|the_buffer
index|[
literal|0
index|]
argument_list|,
name|priv
operator|.
name|orig_sizeflag
argument_list|)
expr_stmt|;
if|if
condition|(
name|name
operator|==
name|NULL
condition|)
name|name
operator|=
name|INTERNAL_DISASSEMBLER_ERROR
expr_stmt|;
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|"%s"
argument_list|,
name|name
argument_list|)
expr_stmt|;
return|return
literal|1
return|;
block|}
if|if
condition|(
operator|*
name|codep
operator|==
literal|0x0f
condition|)
block|{
name|FETCH_DATA
argument_list|(
name|info
argument_list|,
name|codep
operator|+
literal|2
argument_list|)
expr_stmt|;
name|dp
operator|=
operator|&
name|dis386_twobyte
index|[
operator|*
operator|++
name|codep
index|]
expr_stmt|;
name|need_modrm
operator|=
name|twobyte_has_modrm
index|[
operator|*
name|codep
index|]
expr_stmt|;
name|uses_SSE_prefix
operator|=
name|twobyte_uses_SSE_prefix
index|[
operator|*
name|codep
index|]
expr_stmt|;
block|}
else|else
block|{
name|dp
operator|=
operator|&
name|dis386
index|[
operator|*
name|codep
index|]
expr_stmt|;
name|need_modrm
operator|=
name|onebyte_has_modrm
index|[
operator|*
name|codep
index|]
expr_stmt|;
name|uses_SSE_prefix
operator|=
literal|0
expr_stmt|;
block|}
name|codep
operator|++
expr_stmt|;
if|if
condition|(
operator|!
name|uses_SSE_prefix
operator|&&
operator|(
name|prefixes
operator|&
name|PREFIX_REPZ
operator|)
condition|)
block|{
name|oappend
argument_list|(
literal|"repz "
argument_list|)
expr_stmt|;
name|used_prefixes
operator||=
name|PREFIX_REPZ
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|uses_SSE_prefix
operator|&&
operator|(
name|prefixes
operator|&
name|PREFIX_REPNZ
operator|)
condition|)
block|{
name|oappend
argument_list|(
literal|"repnz "
argument_list|)
expr_stmt|;
name|used_prefixes
operator||=
name|PREFIX_REPNZ
expr_stmt|;
block|}
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_LOCK
condition|)
block|{
name|oappend
argument_list|(
literal|"lock "
argument_list|)
expr_stmt|;
name|used_prefixes
operator||=
name|PREFIX_LOCK
expr_stmt|;
block|}
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_ADDR
condition|)
block|{
name|sizeflag
operator|^=
name|AFLAG
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|bytemode3
operator|!=
name|loop_jcxz_mode
operator|||
name|intel_syntax
condition|)
block|{
if|if
condition|(
name|sizeflag
operator|&
name|AFLAG
condition|)
name|oappend
argument_list|(
literal|"addr32 "
argument_list|)
expr_stmt|;
else|else
name|oappend
argument_list|(
literal|"addr16 "
argument_list|)
expr_stmt|;
name|used_prefixes
operator||=
name|PREFIX_ADDR
expr_stmt|;
block|}
block|}
if|if
condition|(
operator|!
name|uses_SSE_prefix
operator|&&
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
condition|)
block|{
name|sizeflag
operator|^=
name|DFLAG
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|bytemode3
operator|==
name|cond_jump_mode
operator|&&
name|dp
operator|->
name|bytemode1
operator|==
name|v_mode
operator|&&
operator|!
name|intel_syntax
condition|)
block|{
if|if
condition|(
name|sizeflag
operator|&
name|DFLAG
condition|)
name|oappend
argument_list|(
literal|"data32 "
argument_list|)
expr_stmt|;
else|else
name|oappend
argument_list|(
literal|"data16 "
argument_list|)
expr_stmt|;
name|used_prefixes
operator||=
name|PREFIX_DATA
expr_stmt|;
block|}
block|}
if|if
condition|(
name|need_modrm
condition|)
block|{
name|FETCH_DATA
argument_list|(
name|info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|mod
operator|=
operator|(
operator|*
name|codep
operator|>>
literal|6
operator|)
operator|&
literal|3
expr_stmt|;
name|reg
operator|=
operator|(
operator|*
name|codep
operator|>>
literal|3
operator|)
operator|&
literal|7
expr_stmt|;
name|rm
operator|=
operator|*
name|codep
operator|&
literal|7
expr_stmt|;
block|}
if|if
condition|(
name|dp
operator|->
name|name
operator|==
name|NULL
operator|&&
name|dp
operator|->
name|bytemode1
operator|==
name|FLOATCODE
condition|)
block|{
name|dofloat
argument_list|(
name|sizeflag
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|int
name|index
decl_stmt|;
if|if
condition|(
name|dp
operator|->
name|name
operator|==
name|NULL
condition|)
block|{
switch|switch
condition|(
name|dp
operator|->
name|bytemode1
condition|)
block|{
case|case
name|USE_GROUPS
case|:
name|dp
operator|=
operator|&
name|grps
index|[
name|dp
operator|->
name|bytemode2
index|]
index|[
name|reg
index|]
expr_stmt|;
break|break;
case|case
name|USE_PREFIX_USER_TABLE
case|:
name|index
operator|=
literal|0
expr_stmt|;
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_REPZ
operator|)
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_REPZ
condition|)
name|index
operator|=
literal|1
expr_stmt|;
else|else
block|{
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_DATA
condition|)
name|index
operator|=
literal|2
expr_stmt|;
else|else
block|{
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_REPNZ
operator|)
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_REPNZ
condition|)
name|index
operator|=
literal|3
expr_stmt|;
block|}
block|}
name|dp
operator|=
operator|&
name|prefix_user_table
index|[
name|dp
operator|->
name|bytemode2
index|]
index|[
name|index
index|]
expr_stmt|;
break|break;
case|case
name|X86_64_SPECIAL
case|:
name|dp
operator|=
operator|&
name|x86_64_table
index|[
name|dp
operator|->
name|bytemode2
index|]
index|[
name|mode_64bit
index|]
expr_stmt|;
break|break;
default|default:
name|oappend
argument_list|(
name|INTERNAL_DISASSEMBLER_ERROR
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
if|if
condition|(
name|putop
argument_list|(
name|dp
operator|->
name|name
argument_list|,
name|sizeflag
argument_list|)
operator|==
literal|0
condition|)
block|{
name|obufp
operator|=
name|op1out
expr_stmt|;
name|op_ad
operator|=
literal|2
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|op1
condition|)
call|(
modifier|*
name|dp
operator|->
name|op1
call|)
argument_list|(
name|dp
operator|->
name|bytemode1
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
name|obufp
operator|=
name|op2out
expr_stmt|;
name|op_ad
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|op2
condition|)
call|(
modifier|*
name|dp
operator|->
name|op2
call|)
argument_list|(
name|dp
operator|->
name|bytemode2
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
name|obufp
operator|=
name|op3out
expr_stmt|;
name|op_ad
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|op3
condition|)
call|(
modifier|*
name|dp
operator|->
name|op3
call|)
argument_list|(
name|dp
operator|->
name|bytemode3
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
block|}
block|}
comment|/* See if any prefixes were not used.  If so, print the first one      separately.  If we don't do this, we'll wind up printing an      instruction stream which does not precisely correspond to the      bytes we are disassembling.  */
if|if
condition|(
operator|(
name|prefixes
operator|&
operator|~
name|used_prefixes
operator|)
operator|!=
literal|0
condition|)
block|{
specifier|const
name|char
modifier|*
name|name
decl_stmt|;
name|name
operator|=
name|prefix_name
argument_list|(
name|priv
operator|.
name|the_buffer
index|[
literal|0
index|]
argument_list|,
name|priv
operator|.
name|orig_sizeflag
argument_list|)
expr_stmt|;
if|if
condition|(
name|name
operator|==
name|NULL
condition|)
name|name
operator|=
name|INTERNAL_DISASSEMBLER_ERROR
expr_stmt|;
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|"%s"
argument_list|,
name|name
argument_list|)
expr_stmt|;
return|return
literal|1
return|;
block|}
if|if
condition|(
name|rex
operator|&
operator|~
name|rex_used
condition|)
block|{
specifier|const
name|char
modifier|*
name|name
decl_stmt|;
name|name
operator|=
name|prefix_name
argument_list|(
name|rex
operator||
literal|0x40
argument_list|,
name|priv
operator|.
name|orig_sizeflag
argument_list|)
expr_stmt|;
if|if
condition|(
name|name
operator|==
name|NULL
condition|)
name|name
operator|=
name|INTERNAL_DISASSEMBLER_ERROR
expr_stmt|;
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|"%s "
argument_list|,
name|name
argument_list|)
expr_stmt|;
block|}
name|obufp
operator|=
name|obuf
operator|+
name|strlen
argument_list|(
name|obuf
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
name|strlen
argument_list|(
name|obuf
argument_list|)
init|;
name|i
operator|<
literal|6
condition|;
name|i
operator|++
control|)
name|oappend
argument_list|(
literal|" "
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
literal|" "
argument_list|)
expr_stmt|;
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|"%s"
argument_list|,
name|obuf
argument_list|)
expr_stmt|;
comment|/* The enter and bound instructions are printed with operands in the same      order as the intel book; everything else is printed in reverse order.  */
if|if
condition|(
name|intel_syntax
operator|||
name|two_source_ops
condition|)
block|{
name|first
operator|=
name|op1out
expr_stmt|;
name|second
operator|=
name|op2out
expr_stmt|;
name|third
operator|=
name|op3out
expr_stmt|;
name|op_ad
operator|=
name|op_index
index|[
literal|0
index|]
expr_stmt|;
name|op_index
index|[
literal|0
index|]
operator|=
name|op_index
index|[
literal|2
index|]
expr_stmt|;
name|op_index
index|[
literal|2
index|]
operator|=
name|op_ad
expr_stmt|;
block|}
else|else
block|{
name|first
operator|=
name|op3out
expr_stmt|;
name|second
operator|=
name|op2out
expr_stmt|;
name|third
operator|=
name|op1out
expr_stmt|;
block|}
name|needcomma
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|*
name|first
condition|)
block|{
if|if
condition|(
name|op_index
index|[
literal|0
index|]
operator|!=
operator|-
literal|1
operator|&&
operator|!
name|op_riprel
index|[
literal|0
index|]
condition|)
call|(
modifier|*
name|info
operator|->
name|print_address_func
call|)
argument_list|(
operator|(
name|bfd_vma
operator|)
name|op_address
index|[
name|op_index
index|[
literal|0
index|]
index|]
argument_list|,
name|info
argument_list|)
expr_stmt|;
else|else
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|"%s"
argument_list|,
name|first
argument_list|)
expr_stmt|;
name|needcomma
operator|=
literal|1
expr_stmt|;
block|}
if|if
condition|(
operator|*
name|second
condition|)
block|{
if|if
condition|(
name|needcomma
condition|)
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|","
argument_list|)
expr_stmt|;
if|if
condition|(
name|op_index
index|[
literal|1
index|]
operator|!=
operator|-
literal|1
operator|&&
operator|!
name|op_riprel
index|[
literal|1
index|]
condition|)
call|(
modifier|*
name|info
operator|->
name|print_address_func
call|)
argument_list|(
operator|(
name|bfd_vma
operator|)
name|op_address
index|[
name|op_index
index|[
literal|1
index|]
index|]
argument_list|,
name|info
argument_list|)
expr_stmt|;
else|else
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|"%s"
argument_list|,
name|second
argument_list|)
expr_stmt|;
name|needcomma
operator|=
literal|1
expr_stmt|;
block|}
if|if
condition|(
operator|*
name|third
condition|)
block|{
if|if
condition|(
name|needcomma
condition|)
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|","
argument_list|)
expr_stmt|;
if|if
condition|(
name|op_index
index|[
literal|2
index|]
operator|!=
operator|-
literal|1
operator|&&
operator|!
name|op_riprel
index|[
literal|2
index|]
condition|)
call|(
modifier|*
name|info
operator|->
name|print_address_func
call|)
argument_list|(
operator|(
name|bfd_vma
operator|)
name|op_address
index|[
name|op_index
index|[
literal|2
index|]
index|]
argument_list|,
name|info
argument_list|)
expr_stmt|;
else|else
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|"%s"
argument_list|,
name|third
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|3
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|op_index
index|[
name|i
index|]
operator|!=
operator|-
literal|1
operator|&&
name|op_riprel
index|[
name|i
index|]
condition|)
block|{
call|(
modifier|*
name|info
operator|->
name|fprintf_func
call|)
argument_list|(
name|info
operator|->
name|stream
argument_list|,
literal|"        # "
argument_list|)
expr_stmt|;
call|(
modifier|*
name|info
operator|->
name|print_address_func
call|)
argument_list|(
call|(
name|bfd_vma
call|)
argument_list|(
name|start_pc
operator|+
name|codep
operator|-
name|start_codep
operator|+
name|op_address
index|[
name|op_index
index|[
name|i
index|]
index|]
argument_list|)
argument_list|,
name|info
argument_list|)
expr_stmt|;
block|}
return|return
name|codep
operator|-
name|priv
operator|.
name|the_buffer
return|;
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|float_mem
index|[]
init|=
block|{
comment|/* d8 */
literal|"fadd{s||s|}"
block|,
literal|"fmul{s||s|}"
block|,
literal|"fcom{s||s|}"
block|,
literal|"fcomp{s||s|}"
block|,
literal|"fsub{s||s|}"
block|,
literal|"fsubr{s||s|}"
block|,
literal|"fdiv{s||s|}"
block|,
literal|"fdivr{s||s|}"
block|,
comment|/*  d9 */
literal|"fld{s||s|}"
block|,
literal|"(bad)"
block|,
literal|"fst{s||s|}"
block|,
literal|"fstp{s||s|}"
block|,
literal|"fldenv"
block|,
literal|"fldcw"
block|,
literal|"fNstenv"
block|,
literal|"fNstcw"
block|,
comment|/* da */
literal|"fiadd{l||l|}"
block|,
literal|"fimul{l||l|}"
block|,
literal|"ficom{l||l|}"
block|,
literal|"ficomp{l||l|}"
block|,
literal|"fisub{l||l|}"
block|,
literal|"fisubr{l||l|}"
block|,
literal|"fidiv{l||l|}"
block|,
literal|"fidivr{l||l|}"
block|,
comment|/* db */
literal|"fild{l||l|}"
block|,
literal|"(bad)"
block|,
literal|"fist{l||l|}"
block|,
literal|"fistp{l||l|}"
block|,
literal|"(bad)"
block|,
literal|"fld{t||t|}"
block|,
literal|"(bad)"
block|,
literal|"fstp{t||t|}"
block|,
comment|/* dc */
literal|"fadd{l||l|}"
block|,
literal|"fmul{l||l|}"
block|,
literal|"fcom{l||l|}"
block|,
literal|"fcomp{l||l|}"
block|,
literal|"fsub{l||l|}"
block|,
literal|"fsubr{l||l|}"
block|,
literal|"fdiv{l||l|}"
block|,
literal|"fdivr{l||l|}"
block|,
comment|/* dd */
literal|"fld{l||l|}"
block|,
literal|"(bad)"
block|,
literal|"fst{l||l|}"
block|,
literal|"fstp{l||l|}"
block|,
literal|"frstor"
block|,
literal|"(bad)"
block|,
literal|"fNsave"
block|,
literal|"fNstsw"
block|,
comment|/* de */
literal|"fiadd"
block|,
literal|"fimul"
block|,
literal|"ficom"
block|,
literal|"ficomp"
block|,
literal|"fisub"
block|,
literal|"fisubr"
block|,
literal|"fidiv"
block|,
literal|"fidivr"
block|,
comment|/* df */
literal|"fild"
block|,
literal|"(bad)"
block|,
literal|"fist"
block|,
literal|"fistp"
block|,
literal|"fbld"
block|,
literal|"fild{ll||ll|}"
block|,
literal|"fbstp"
block|,
literal|"fistpll"
block|, }
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|ST
value|OP_ST, 0
end_define

begin_define
define|#
directive|define
name|STi
value|OP_STi, 0
end_define

begin_define
define|#
directive|define
name|FGRPd9_2
value|NULL, NULL, 0, NULL, 0, NULL, 0
end_define

begin_define
define|#
directive|define
name|FGRPd9_4
value|NULL, NULL, 1, NULL, 0, NULL, 0
end_define

begin_define
define|#
directive|define
name|FGRPd9_5
value|NULL, NULL, 2, NULL, 0, NULL, 0
end_define

begin_define
define|#
directive|define
name|FGRPd9_6
value|NULL, NULL, 3, NULL, 0, NULL, 0
end_define

begin_define
define|#
directive|define
name|FGRPd9_7
value|NULL, NULL, 4, NULL, 0, NULL, 0
end_define

begin_define
define|#
directive|define
name|FGRPda_5
value|NULL, NULL, 5, NULL, 0, NULL, 0
end_define

begin_define
define|#
directive|define
name|FGRPdb_4
value|NULL, NULL, 6, NULL, 0, NULL, 0
end_define

begin_define
define|#
directive|define
name|FGRPde_3
value|NULL, NULL, 7, NULL, 0, NULL, 0
end_define

begin_define
define|#
directive|define
name|FGRPdf_4
value|NULL, NULL, 8, NULL, 0, NULL, 0
end_define

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|dis386
name|float_reg
index|[]
index|[
literal|8
index|]
init|=
block|{
comment|/* d8 */
block|{
block|{
literal|"fadd"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,
block|{
literal|"fmul"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,
block|{
literal|"fcom"
block|,
name|STi
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"fcomp"
block|,
name|STi
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"fsub"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,
block|{
literal|"fsubr"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,
block|{
literal|"fdiv"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,
block|{
literal|"fdivr"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,   }
block|,
comment|/* d9 */
block|{
block|{
literal|"fld"
block|,
name|STi
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"fxch"
block|,
name|STi
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
name|FGRPd9_2
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
name|FGRPd9_4
block|}
block|,
block|{
name|FGRPd9_5
block|}
block|,
block|{
name|FGRPd9_6
block|}
block|,
block|{
name|FGRPd9_7
block|}
block|,   }
block|,
comment|/* da */
block|{
block|{
literal|"fcmovb"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,
block|{
literal|"fcmove"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,
block|{
literal|"fcmovbe"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,
block|{
literal|"fcmovu"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
name|FGRPda_5
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* db */
block|{
block|{
literal|"fcmovnb"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,
block|{
literal|"fcmovne"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,
block|{
literal|"fcmovnbe"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,
block|{
literal|"fcmovnu"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,
block|{
name|FGRPdb_4
block|}
block|,
block|{
literal|"fucomi"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,
block|{
literal|"fcomi"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* dc */
block|{
block|{
literal|"fadd"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
block|{
literal|"fmul"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
if|#
directive|if
name|UNIXWARE_COMPAT
block|{
literal|"fsub"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
block|{
literal|"fsubr"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
block|{
literal|"fdiv"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
block|{
literal|"fdivr"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
else|#
directive|else
block|{
literal|"fsubr"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
block|{
literal|"fsub"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
block|{
literal|"fdivr"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
block|{
literal|"fdiv"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
endif|#
directive|endif
block|}
block|,
comment|/* dd */
block|{
block|{
literal|"ffree"
block|,
name|STi
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"fst"
block|,
name|STi
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"fstp"
block|,
name|STi
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"fucom"
block|,
name|STi
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"fucomp"
block|,
name|STi
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,   }
block|,
comment|/* de */
block|{
block|{
literal|"faddp"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
block|{
literal|"fmulp"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
name|FGRPde_3
block|}
block|,
if|#
directive|if
name|UNIXWARE_COMPAT
block|{
literal|"fsubp"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
block|{
literal|"fsubrp"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
block|{
literal|"fdivp"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
block|{
literal|"fdivrp"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
else|#
directive|else
block|{
literal|"fsubrp"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
block|{
literal|"fsubp"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
block|{
literal|"fdivrp"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
block|{
literal|"fdivp"
block|,
name|STi
block|,
name|ST
block|,
name|XX
block|}
block|,
endif|#
directive|endif
block|}
block|,
comment|/* df */
block|{
block|{
literal|"ffreep"
block|,
name|STi
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,
block|{
name|FGRPdf_4
block|}
block|,
block|{
literal|"fucomip"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,
block|{
literal|"fcomip"
block|,
name|ST
block|,
name|STi
block|,
name|XX
block|}
block|,
block|{
literal|"(bad)"
block|,
name|XX
block|,
name|XX
block|,
name|XX
block|}
block|,   }
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
modifier|*
name|fgrps
index|[]
index|[
literal|8
index|]
init|=
block|{
comment|/* d9_2  0 */
block|{
literal|"fnop"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,   }
block|,
comment|/* d9_4  1 */
block|{
literal|"fchs"
block|,
literal|"fabs"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"ftst"
block|,
literal|"fxam"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,   }
block|,
comment|/* d9_5  2 */
block|{
literal|"fld1"
block|,
literal|"fldl2t"
block|,
literal|"fldl2e"
block|,
literal|"fldpi"
block|,
literal|"fldlg2"
block|,
literal|"fldln2"
block|,
literal|"fldz"
block|,
literal|"(bad)"
block|,   }
block|,
comment|/* d9_6  3 */
block|{
literal|"f2xm1"
block|,
literal|"fyl2x"
block|,
literal|"fptan"
block|,
literal|"fpatan"
block|,
literal|"fxtract"
block|,
literal|"fprem1"
block|,
literal|"fdecstp"
block|,
literal|"fincstp"
block|,   }
block|,
comment|/* d9_7  4 */
block|{
literal|"fprem"
block|,
literal|"fyl2xp1"
block|,
literal|"fsqrt"
block|,
literal|"fsincos"
block|,
literal|"frndint"
block|,
literal|"fscale"
block|,
literal|"fsin"
block|,
literal|"fcos"
block|,   }
block|,
comment|/* da_5  5 */
block|{
literal|"(bad)"
block|,
literal|"fucompp"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,   }
block|,
comment|/* db_4  6 */
block|{
literal|"feni(287 only)"
block|,
literal|"fdisi(287 only)"
block|,
literal|"fNclex"
block|,
literal|"fNinit"
block|,
literal|"fNsetpm(287 only)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,   }
block|,
comment|/* de_3  7 */
block|{
literal|"(bad)"
block|,
literal|"fcompp"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,   }
block|,
comment|/* df_4  8 */
block|{
literal|"fNstsw"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,
literal|"(bad)"
block|,   }
block|, }
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
name|dofloat
parameter_list|(
name|sizeflag
parameter_list|)
name|int
name|sizeflag
decl_stmt|;
block|{
specifier|const
name|struct
name|dis386
modifier|*
name|dp
decl_stmt|;
name|unsigned
name|char
name|floatop
decl_stmt|;
name|floatop
operator|=
name|codep
index|[
operator|-
literal|1
index|]
expr_stmt|;
if|if
condition|(
name|mod
operator|!=
literal|3
condition|)
block|{
name|putop
argument_list|(
name|float_mem
index|[
operator|(
name|floatop
operator|-
literal|0xd8
operator|)
operator|*
literal|8
operator|+
name|reg
index|]
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
name|obufp
operator|=
name|op1out
expr_stmt|;
if|if
condition|(
name|floatop
operator|==
literal|0xdb
condition|)
name|OP_E
argument_list|(
name|x_mode
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|floatop
operator|==
literal|0xdd
condition|)
name|OP_E
argument_list|(
name|d_mode
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
else|else
name|OP_E
argument_list|(
name|v_mode
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
return|return;
block|}
comment|/* Skip mod/rm byte.  */
name|MODRM_CHECK
expr_stmt|;
name|codep
operator|++
expr_stmt|;
name|dp
operator|=
operator|&
name|float_reg
index|[
name|floatop
operator|-
literal|0xd8
index|]
index|[
name|reg
index|]
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|name
operator|==
name|NULL
condition|)
block|{
name|putop
argument_list|(
name|fgrps
index|[
name|dp
operator|->
name|bytemode1
index|]
index|[
name|rm
index|]
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
comment|/* Instruction fnstsw is only one with strange arg.  */
if|if
condition|(
name|floatop
operator|==
literal|0xdf
operator|&&
name|codep
index|[
operator|-
literal|1
index|]
operator|==
literal|0xe0
condition|)
name|strcpy
argument_list|(
name|op1out
argument_list|,
name|names16
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|putop
argument_list|(
name|dp
operator|->
name|name
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
name|obufp
operator|=
name|op1out
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|op1
condition|)
call|(
modifier|*
name|dp
operator|->
name|op1
call|)
argument_list|(
name|dp
operator|->
name|bytemode1
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
name|obufp
operator|=
name|op2out
expr_stmt|;
if|if
condition|(
name|dp
operator|->
name|op2
condition|)
call|(
modifier|*
name|dp
operator|->
name|op2
call|)
argument_list|(
name|dp
operator|->
name|bytemode2
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|OP_ST
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|int
name|sizeflag
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|oappend
argument_list|(
literal|"%st"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_STi
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|int
name|sizeflag
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%%st(%d)"
argument_list|,
name|rm
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
operator|+
name|intel_syntax
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* Capital letters in template are macros.  */
end_comment

begin_function
specifier|static
name|int
name|putop
parameter_list|(
name|template
parameter_list|,
name|sizeflag
parameter_list|)
specifier|const
name|char
modifier|*
name|template
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
specifier|const
name|char
modifier|*
name|p
decl_stmt|;
name|int
name|alt
decl_stmt|;
for|for
control|(
name|p
operator|=
name|template
init|;
operator|*
name|p
condition|;
name|p
operator|++
control|)
block|{
switch|switch
condition|(
operator|*
name|p
condition|)
block|{
default|default:
operator|*
name|obufp
operator|++
operator|=
operator|*
name|p
expr_stmt|;
break|break;
case|case
literal|'{'
case|:
name|alt
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|intel_syntax
condition|)
name|alt
operator|+=
literal|1
expr_stmt|;
if|if
condition|(
name|mode_64bit
condition|)
name|alt
operator|+=
literal|2
expr_stmt|;
while|while
condition|(
name|alt
operator|!=
literal|0
condition|)
block|{
while|while
condition|(
operator|*
operator|++
name|p
operator|!=
literal|'|'
condition|)
block|{
if|if
condition|(
operator|*
name|p
operator|==
literal|'}'
condition|)
block|{
comment|/* Alternative not valid.  */
name|strcpy
argument_list|(
name|obuf
argument_list|,
literal|"(bad)"
argument_list|)
expr_stmt|;
name|obufp
operator|=
name|obuf
operator|+
literal|5
expr_stmt|;
return|return
literal|1
return|;
block|}
elseif|else
if|if
condition|(
operator|*
name|p
operator|==
literal|'\0'
condition|)
name|abort
argument_list|()
expr_stmt|;
block|}
name|alt
operator|--
expr_stmt|;
block|}
break|break;
case|case
literal|'|'
case|:
while|while
condition|(
operator|*
operator|++
name|p
operator|!=
literal|'}'
condition|)
block|{
if|if
condition|(
operator|*
name|p
operator|==
literal|'\0'
condition|)
name|abort
argument_list|()
expr_stmt|;
block|}
break|break;
case|case
literal|'}'
case|:
break|break;
case|case
literal|'A'
case|:
if|if
condition|(
name|intel_syntax
condition|)
break|break;
if|if
condition|(
name|mod
operator|!=
literal|3
operator|||
operator|(
name|sizeflag
operator|&
name|SUFFIX_ALWAYS
operator|)
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'b'
expr_stmt|;
break|break;
case|case
literal|'B'
case|:
if|if
condition|(
name|intel_syntax
condition|)
break|break;
if|if
condition|(
name|sizeflag
operator|&
name|SUFFIX_ALWAYS
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'b'
expr_stmt|;
break|break;
case|case
literal|'E'
case|:
comment|/* For jcxz/jecxz */
if|if
condition|(
name|sizeflag
operator|&
name|AFLAG
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'e'
expr_stmt|;
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_ADDR
operator|)
expr_stmt|;
break|break;
case|case
literal|'F'
case|:
if|if
condition|(
name|intel_syntax
condition|)
break|break;
if|if
condition|(
operator|(
name|prefixes
operator|&
name|PREFIX_ADDR
operator|)
operator|||
operator|(
name|sizeflag
operator|&
name|SUFFIX_ALWAYS
operator|)
condition|)
block|{
if|if
condition|(
name|sizeflag
operator|&
name|AFLAG
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'l'
expr_stmt|;
else|else
operator|*
name|obufp
operator|++
operator|=
literal|'w'
expr_stmt|;
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_ADDR
operator|)
expr_stmt|;
block|}
break|break;
case|case
literal|'H'
case|:
if|if
condition|(
name|intel_syntax
condition|)
break|break;
if|if
condition|(
operator|(
name|prefixes
operator|&
operator|(
name|PREFIX_CS
operator||
name|PREFIX_DS
operator|)
operator|)
operator|==
name|PREFIX_CS
operator|||
operator|(
name|prefixes
operator|&
operator|(
name|PREFIX_CS
operator||
name|PREFIX_DS
operator|)
operator|)
operator|==
name|PREFIX_DS
condition|)
block|{
name|used_prefixes
operator||=
name|prefixes
operator|&
operator|(
name|PREFIX_CS
operator||
name|PREFIX_DS
operator|)
expr_stmt|;
operator|*
name|obufp
operator|++
operator|=
literal|','
expr_stmt|;
operator|*
name|obufp
operator|++
operator|=
literal|'p'
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_DS
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'t'
expr_stmt|;
else|else
operator|*
name|obufp
operator|++
operator|=
literal|'n'
expr_stmt|;
block|}
break|break;
case|case
literal|'L'
case|:
if|if
condition|(
name|intel_syntax
condition|)
break|break;
if|if
condition|(
name|sizeflag
operator|&
name|SUFFIX_ALWAYS
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'l'
expr_stmt|;
break|break;
case|case
literal|'N'
case|:
if|if
condition|(
operator|(
name|prefixes
operator|&
name|PREFIX_FWAIT
operator|)
operator|==
literal|0
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'n'
expr_stmt|;
else|else
name|used_prefixes
operator||=
name|PREFIX_FWAIT
expr_stmt|;
break|break;
case|case
literal|'O'
case|:
name|USED_REX
argument_list|(
name|REX_MODE64
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_MODE64
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'o'
expr_stmt|;
else|else
operator|*
name|obufp
operator|++
operator|=
literal|'d'
expr_stmt|;
break|break;
case|case
literal|'T'
case|:
if|if
condition|(
name|intel_syntax
condition|)
break|break;
if|if
condition|(
name|mode_64bit
condition|)
block|{
operator|*
name|obufp
operator|++
operator|=
literal|'q'
expr_stmt|;
break|break;
block|}
comment|/* Fall through.  */
case|case
literal|'P'
case|:
if|if
condition|(
name|intel_syntax
condition|)
break|break;
if|if
condition|(
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
operator|||
operator|(
name|rex
operator|&
name|REX_MODE64
operator|)
operator|||
operator|(
name|sizeflag
operator|&
name|SUFFIX_ALWAYS
operator|)
condition|)
block|{
name|USED_REX
argument_list|(
name|REX_MODE64
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_MODE64
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'q'
expr_stmt|;
else|else
block|{
if|if
condition|(
name|sizeflag
operator|&
name|DFLAG
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'l'
expr_stmt|;
else|else
operator|*
name|obufp
operator|++
operator|=
literal|'w'
expr_stmt|;
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
block|}
block|}
break|break;
case|case
literal|'U'
case|:
if|if
condition|(
name|intel_syntax
condition|)
break|break;
if|if
condition|(
name|mode_64bit
condition|)
block|{
operator|*
name|obufp
operator|++
operator|=
literal|'q'
expr_stmt|;
break|break;
block|}
comment|/* Fall through.  */
case|case
literal|'Q'
case|:
if|if
condition|(
name|intel_syntax
condition|)
break|break;
name|USED_REX
argument_list|(
name|REX_MODE64
argument_list|)
expr_stmt|;
if|if
condition|(
name|mod
operator|!=
literal|3
operator|||
operator|(
name|sizeflag
operator|&
name|SUFFIX_ALWAYS
operator|)
condition|)
block|{
if|if
condition|(
name|rex
operator|&
name|REX_MODE64
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'q'
expr_stmt|;
else|else
block|{
if|if
condition|(
name|sizeflag
operator|&
name|DFLAG
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'l'
expr_stmt|;
else|else
operator|*
name|obufp
operator|++
operator|=
literal|'w'
expr_stmt|;
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
block|}
block|}
break|break;
case|case
literal|'R'
case|:
name|USED_REX
argument_list|(
name|REX_MODE64
argument_list|)
expr_stmt|;
if|if
condition|(
name|intel_syntax
condition|)
block|{
if|if
condition|(
name|rex
operator|&
name|REX_MODE64
condition|)
block|{
operator|*
name|obufp
operator|++
operator|=
literal|'q'
expr_stmt|;
operator|*
name|obufp
operator|++
operator|=
literal|'t'
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|sizeflag
operator|&
name|DFLAG
condition|)
block|{
operator|*
name|obufp
operator|++
operator|=
literal|'d'
expr_stmt|;
operator|*
name|obufp
operator|++
operator|=
literal|'q'
expr_stmt|;
block|}
else|else
block|{
operator|*
name|obufp
operator|++
operator|=
literal|'w'
expr_stmt|;
operator|*
name|obufp
operator|++
operator|=
literal|'d'
expr_stmt|;
block|}
block|}
else|else
block|{
if|if
condition|(
name|rex
operator|&
name|REX_MODE64
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'q'
expr_stmt|;
elseif|else
if|if
condition|(
name|sizeflag
operator|&
name|DFLAG
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'l'
expr_stmt|;
else|else
operator|*
name|obufp
operator|++
operator|=
literal|'w'
expr_stmt|;
block|}
if|if
condition|(
operator|!
operator|(
name|rex
operator|&
name|REX_MODE64
operator|)
condition|)
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
break|break;
case|case
literal|'S'
case|:
if|if
condition|(
name|intel_syntax
condition|)
break|break;
if|if
condition|(
name|sizeflag
operator|&
name|SUFFIX_ALWAYS
condition|)
block|{
if|if
condition|(
name|rex
operator|&
name|REX_MODE64
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'q'
expr_stmt|;
else|else
block|{
if|if
condition|(
name|sizeflag
operator|&
name|DFLAG
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'l'
expr_stmt|;
else|else
operator|*
name|obufp
operator|++
operator|=
literal|'w'
expr_stmt|;
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
block|}
block|}
break|break;
case|case
literal|'X'
case|:
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_DATA
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'d'
expr_stmt|;
else|else
operator|*
name|obufp
operator|++
operator|=
literal|'s'
expr_stmt|;
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
break|break;
case|case
literal|'Y'
case|:
if|if
condition|(
name|intel_syntax
condition|)
break|break;
if|if
condition|(
name|rex
operator|&
name|REX_MODE64
condition|)
block|{
name|USED_REX
argument_list|(
name|REX_MODE64
argument_list|)
expr_stmt|;
operator|*
name|obufp
operator|++
operator|=
literal|'q'
expr_stmt|;
block|}
break|break;
comment|/* implicit operand size 'l' for i386 or 'q' for x86-64 */
case|case
literal|'W'
case|:
comment|/* operand size flag for cwtl, cbtw */
name|USED_REX
argument_list|(
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'l'
expr_stmt|;
elseif|else
if|if
condition|(
name|sizeflag
operator|&
name|DFLAG
condition|)
operator|*
name|obufp
operator|++
operator|=
literal|'w'
expr_stmt|;
else|else
operator|*
name|obufp
operator|++
operator|=
literal|'b'
expr_stmt|;
if|if
condition|(
name|intel_syntax
condition|)
block|{
if|if
condition|(
name|rex
condition|)
block|{
operator|*
name|obufp
operator|++
operator|=
literal|'q'
expr_stmt|;
operator|*
name|obufp
operator|++
operator|=
literal|'e'
expr_stmt|;
block|}
if|if
condition|(
name|sizeflag
operator|&
name|DFLAG
condition|)
block|{
operator|*
name|obufp
operator|++
operator|=
literal|'d'
expr_stmt|;
operator|*
name|obufp
operator|++
operator|=
literal|'e'
expr_stmt|;
block|}
else|else
block|{
operator|*
name|obufp
operator|++
operator|=
literal|'w'
expr_stmt|;
block|}
block|}
if|if
condition|(
operator|!
name|rex
condition|)
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
break|break;
block|}
block|}
operator|*
name|obufp
operator|=
literal|0
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|oappend
parameter_list|(
name|s
parameter_list|)
specifier|const
name|char
modifier|*
name|s
decl_stmt|;
block|{
name|strcpy
argument_list|(
name|obufp
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|obufp
operator|+=
name|strlen
argument_list|(
name|s
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|append_seg
parameter_list|()
block|{
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_CS
condition|)
block|{
name|used_prefixes
operator||=
name|PREFIX_CS
expr_stmt|;
name|oappend
argument_list|(
literal|"%cs:"
operator|+
name|intel_syntax
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_DS
condition|)
block|{
name|used_prefixes
operator||=
name|PREFIX_DS
expr_stmt|;
name|oappend
argument_list|(
literal|"%ds:"
operator|+
name|intel_syntax
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_SS
condition|)
block|{
name|used_prefixes
operator||=
name|PREFIX_SS
expr_stmt|;
name|oappend
argument_list|(
literal|"%ss:"
operator|+
name|intel_syntax
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_ES
condition|)
block|{
name|used_prefixes
operator||=
name|PREFIX_ES
expr_stmt|;
name|oappend
argument_list|(
literal|"%es:"
operator|+
name|intel_syntax
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_FS
condition|)
block|{
name|used_prefixes
operator||=
name|PREFIX_FS
expr_stmt|;
name|oappend
argument_list|(
literal|"%fs:"
operator|+
name|intel_syntax
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_GS
condition|)
block|{
name|used_prefixes
operator||=
name|PREFIX_GS
expr_stmt|;
name|oappend
argument_list|(
literal|"%gs:"
operator|+
name|intel_syntax
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|OP_indirE
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|intel_syntax
condition|)
name|oappend
argument_list|(
literal|"*"
argument_list|)
expr_stmt|;
name|OP_E
argument_list|(
name|bytemode
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|print_operand_value
parameter_list|(
name|buf
parameter_list|,
name|hex
parameter_list|,
name|disp
parameter_list|)
name|char
modifier|*
name|buf
decl_stmt|;
name|int
name|hex
decl_stmt|;
name|bfd_vma
name|disp
decl_stmt|;
block|{
if|if
condition|(
name|mode_64bit
condition|)
block|{
if|if
condition|(
name|hex
condition|)
block|{
name|char
name|tmp
index|[
literal|30
index|]
decl_stmt|;
name|int
name|i
decl_stmt|;
name|buf
index|[
literal|0
index|]
operator|=
literal|'0'
expr_stmt|;
name|buf
index|[
literal|1
index|]
operator|=
literal|'x'
expr_stmt|;
name|sprintf_vma
argument_list|(
name|tmp
argument_list|,
name|disp
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|tmp
index|[
name|i
index|]
operator|==
literal|'0'
operator|&&
name|tmp
index|[
name|i
operator|+
literal|1
index|]
condition|;
name|i
operator|++
control|)
empty_stmt|;
name|strcpy
argument_list|(
name|buf
operator|+
literal|2
argument_list|,
name|tmp
operator|+
name|i
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|bfd_signed_vma
name|v
init|=
name|disp
decl_stmt|;
name|char
name|tmp
index|[
literal|30
index|]
decl_stmt|;
name|int
name|i
decl_stmt|;
if|if
condition|(
name|v
operator|<
literal|0
condition|)
block|{
operator|*
operator|(
name|buf
operator|++
operator|)
operator|=
literal|'-'
expr_stmt|;
name|v
operator|=
operator|-
name|disp
expr_stmt|;
comment|/* Check for possible overflow on 0x8000000000000000.  */
if|if
condition|(
name|v
operator|<
literal|0
condition|)
block|{
name|strcpy
argument_list|(
name|buf
argument_list|,
literal|"9223372036854775808"
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
if|if
condition|(
operator|!
name|v
condition|)
block|{
name|strcpy
argument_list|(
name|buf
argument_list|,
literal|"0"
argument_list|)
expr_stmt|;
return|return;
block|}
name|i
operator|=
literal|0
expr_stmt|;
name|tmp
index|[
literal|29
index|]
operator|=
literal|0
expr_stmt|;
while|while
condition|(
name|v
condition|)
block|{
name|tmp
index|[
literal|28
operator|-
name|i
index|]
operator|=
operator|(
name|v
operator|%
literal|10
operator|)
operator|+
literal|'0'
expr_stmt|;
name|v
operator|/=
literal|10
expr_stmt|;
name|i
operator|++
expr_stmt|;
block|}
name|strcpy
argument_list|(
name|buf
argument_list|,
name|tmp
operator|+
literal|29
operator|-
name|i
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
if|if
condition|(
name|hex
condition|)
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"0x%x"
argument_list|,
operator|(
name|unsigned
name|int
operator|)
name|disp
argument_list|)
expr_stmt|;
else|else
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"%d"
argument_list|,
operator|(
name|int
operator|)
name|disp
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|OP_E
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
name|bfd_vma
name|disp
decl_stmt|;
name|int
name|add
init|=
literal|0
decl_stmt|;
name|int
name|riprel
init|=
literal|0
decl_stmt|;
name|USED_REX
argument_list|(
name|REX_EXTZ
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_EXTZ
condition|)
name|add
operator|+=
literal|8
expr_stmt|;
comment|/* Skip mod/rm byte.  */
name|MODRM_CHECK
expr_stmt|;
name|codep
operator|++
expr_stmt|;
if|if
condition|(
name|mod
operator|==
literal|3
condition|)
block|{
switch|switch
condition|(
name|bytemode
condition|)
block|{
case|case
name|b_mode
case|:
name|USED_REX
argument_list|(
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
condition|)
name|oappend
argument_list|(
name|names8rex
index|[
name|rm
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
else|else
name|oappend
argument_list|(
name|names8
index|[
name|rm
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|w_mode
case|:
name|oappend
argument_list|(
name|names16
index|[
name|rm
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|d_mode
case|:
name|oappend
argument_list|(
name|names32
index|[
name|rm
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|q_mode
case|:
name|oappend
argument_list|(
name|names64
index|[
name|rm
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|m_mode
case|:
if|if
condition|(
name|mode_64bit
condition|)
name|oappend
argument_list|(
name|names64
index|[
name|rm
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
else|else
name|oappend
argument_list|(
name|names32
index|[
name|rm
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|v_mode
case|:
name|USED_REX
argument_list|(
name|REX_MODE64
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_MODE64
condition|)
name|oappend
argument_list|(
name|names64
index|[
name|rm
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|sizeflag
operator|&
name|DFLAG
condition|)
name|oappend
argument_list|(
name|names32
index|[
name|rm
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
else|else
name|oappend
argument_list|(
name|names16
index|[
name|rm
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
break|break;
case|case
literal|0
case|:
if|if
condition|(
operator|!
operator|(
name|codep
index|[
operator|-
literal|2
index|]
operator|==
literal|0xAE
operator|&&
name|codep
index|[
operator|-
literal|1
index|]
operator|==
literal|0xF8
comment|/* sfence */
operator|)
operator|&&
operator|!
operator|(
name|codep
index|[
operator|-
literal|2
index|]
operator|==
literal|0xAE
operator|&&
name|codep
index|[
operator|-
literal|1
index|]
operator|==
literal|0xF0
comment|/* mfence */
operator|)
operator|&&
operator|!
operator|(
name|codep
index|[
operator|-
literal|2
index|]
operator|==
literal|0xAE
operator|&&
name|codep
index|[
operator|-
literal|1
index|]
operator|==
literal|0xe8
comment|/* lfence */
operator|)
condition|)
name|BadOp
argument_list|()
expr_stmt|;
comment|/* bad sfence,lea,lds,les,lfs,lgs,lss modrm */
break|break;
default|default:
name|oappend
argument_list|(
name|INTERNAL_DISASSEMBLER_ERROR
argument_list|)
expr_stmt|;
break|break;
block|}
return|return;
block|}
name|disp
operator|=
literal|0
expr_stmt|;
name|append_seg
argument_list|()
expr_stmt|;
if|if
condition|(
name|sizeflag
operator|&
name|AFLAG
condition|)
comment|/* 32 bit address mode */
block|{
name|int
name|havesib
decl_stmt|;
name|int
name|havebase
decl_stmt|;
name|int
name|base
decl_stmt|;
name|int
name|index
init|=
literal|0
decl_stmt|;
name|int
name|scale
init|=
literal|0
decl_stmt|;
name|havesib
operator|=
literal|0
expr_stmt|;
name|havebase
operator|=
literal|1
expr_stmt|;
name|base
operator|=
name|rm
expr_stmt|;
if|if
condition|(
name|base
operator|==
literal|4
condition|)
block|{
name|havesib
operator|=
literal|1
expr_stmt|;
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|scale
operator|=
operator|(
operator|*
name|codep
operator|>>
literal|6
operator|)
operator|&
literal|3
expr_stmt|;
name|index
operator|=
operator|(
operator|*
name|codep
operator|>>
literal|3
operator|)
operator|&
literal|7
expr_stmt|;
name|base
operator|=
operator|*
name|codep
operator|&
literal|7
expr_stmt|;
name|USED_REX
argument_list|(
name|REX_EXTY
argument_list|)
expr_stmt|;
name|USED_REX
argument_list|(
name|REX_EXTZ
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_EXTY
condition|)
name|index
operator|+=
literal|8
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_EXTZ
condition|)
name|base
operator|+=
literal|8
expr_stmt|;
name|codep
operator|++
expr_stmt|;
block|}
switch|switch
condition|(
name|mod
condition|)
block|{
case|case
literal|0
case|:
if|if
condition|(
operator|(
name|base
operator|&
literal|7
operator|)
operator|==
literal|5
condition|)
block|{
name|havebase
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|mode_64bit
operator|&&
operator|!
name|havesib
condition|)
name|riprel
operator|=
literal|1
expr_stmt|;
name|disp
operator|=
name|get32s
argument_list|()
expr_stmt|;
block|}
break|break;
case|case
literal|1
case|:
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|disp
operator|=
operator|*
name|codep
operator|++
expr_stmt|;
if|if
condition|(
operator|(
name|disp
operator|&
literal|0x80
operator|)
operator|!=
literal|0
condition|)
name|disp
operator|-=
literal|0x100
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|disp
operator|=
name|get32s
argument_list|()
expr_stmt|;
break|break;
block|}
if|if
condition|(
operator|!
name|intel_syntax
condition|)
if|if
condition|(
name|mod
operator|!=
literal|0
operator|||
operator|(
name|base
operator|&
literal|7
operator|)
operator|==
literal|5
condition|)
block|{
name|print_operand_value
argument_list|(
name|scratchbuf
argument_list|,
operator|!
name|riprel
argument_list|,
name|disp
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
if|if
condition|(
name|riprel
condition|)
block|{
name|set_op
argument_list|(
name|disp
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
literal|"(%rip)"
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|havebase
operator|||
operator|(
name|havesib
operator|&&
operator|(
name|index
operator|!=
literal|4
operator|||
name|scale
operator|!=
literal|0
operator|)
operator|)
condition|)
block|{
if|if
condition|(
name|intel_syntax
condition|)
block|{
switch|switch
condition|(
name|bytemode
condition|)
block|{
case|case
name|b_mode
case|:
name|oappend
argument_list|(
literal|"BYTE PTR "
argument_list|)
expr_stmt|;
break|break;
case|case
name|w_mode
case|:
name|oappend
argument_list|(
literal|"WORD PTR "
argument_list|)
expr_stmt|;
break|break;
case|case
name|v_mode
case|:
name|oappend
argument_list|(
literal|"DWORD PTR "
argument_list|)
expr_stmt|;
break|break;
case|case
name|d_mode
case|:
name|oappend
argument_list|(
literal|"QWORD PTR "
argument_list|)
expr_stmt|;
break|break;
case|case
name|m_mode
case|:
if|if
condition|(
name|mode_64bit
condition|)
name|oappend
argument_list|(
literal|"DWORD PTR "
argument_list|)
expr_stmt|;
else|else
name|oappend
argument_list|(
literal|"QWORD PTR "
argument_list|)
expr_stmt|;
break|break;
case|case
name|x_mode
case|:
name|oappend
argument_list|(
literal|"XWORD PTR "
argument_list|)
expr_stmt|;
break|break;
default|default:
break|break;
block|}
block|}
operator|*
name|obufp
operator|++
operator|=
name|open_char
expr_stmt|;
if|if
condition|(
name|intel_syntax
operator|&&
name|riprel
condition|)
name|oappend
argument_list|(
literal|"rip + "
argument_list|)
expr_stmt|;
operator|*
name|obufp
operator|=
literal|'\0'
expr_stmt|;
name|USED_REX
argument_list|(
name|REX_EXTZ
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|havesib
operator|&&
operator|(
name|rex
operator|&
name|REX_EXTZ
operator|)
condition|)
name|base
operator|+=
literal|8
expr_stmt|;
if|if
condition|(
name|havebase
condition|)
name|oappend
argument_list|(
name|mode_64bit
condition|?
name|names64
index|[
name|base
index|]
else|:
name|names32
index|[
name|base
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|havesib
condition|)
block|{
if|if
condition|(
name|index
operator|!=
literal|4
condition|)
block|{
if|if
condition|(
name|intel_syntax
condition|)
block|{
if|if
condition|(
name|havebase
condition|)
block|{
operator|*
name|obufp
operator|++
operator|=
name|separator_char
expr_stmt|;
operator|*
name|obufp
operator|=
literal|'\0'
expr_stmt|;
block|}
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%s"
argument_list|,
name|mode_64bit
condition|?
name|names64
index|[
name|index
index|]
else|:
name|names32
index|[
name|index
index|]
argument_list|)
expr_stmt|;
block|}
else|else
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|",%s"
argument_list|,
name|mode_64bit
condition|?
name|names64
index|[
name|index
index|]
else|:
name|names32
index|[
name|index
index|]
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|intel_syntax
operator|||
operator|(
name|intel_syntax
operator|&&
name|bytemode
operator|!=
name|b_mode
operator|&&
name|bytemode
operator|!=
name|w_mode
operator|&&
name|bytemode
operator|!=
name|v_mode
operator|)
condition|)
block|{
operator|*
name|obufp
operator|++
operator|=
name|scale_char
expr_stmt|;
operator|*
name|obufp
operator|=
literal|'\0'
expr_stmt|;
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%d"
argument_list|,
literal|1
operator|<<
name|scale
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|intel_syntax
condition|)
if|if
condition|(
name|mod
operator|!=
literal|0
operator|||
operator|(
name|base
operator|&
literal|7
operator|)
operator|==
literal|5
condition|)
block|{
comment|/* Don't print zero displacements.  */
if|if
condition|(
name|disp
operator|!=
literal|0
condition|)
block|{
if|if
condition|(
operator|(
name|bfd_signed_vma
operator|)
name|disp
operator|>
literal|0
condition|)
block|{
operator|*
name|obufp
operator|++
operator|=
literal|'+'
expr_stmt|;
operator|*
name|obufp
operator|=
literal|'\0'
expr_stmt|;
block|}
name|print_operand_value
argument_list|(
name|scratchbuf
argument_list|,
literal|0
argument_list|,
name|disp
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
block|}
block|}
operator|*
name|obufp
operator|++
operator|=
name|close_char
expr_stmt|;
operator|*
name|obufp
operator|=
literal|'\0'
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|intel_syntax
condition|)
block|{
if|if
condition|(
name|mod
operator|!=
literal|0
operator|||
operator|(
name|base
operator|&
literal|7
operator|)
operator|==
literal|5
condition|)
block|{
if|if
condition|(
name|prefixes
operator|&
operator|(
name|PREFIX_CS
operator||
name|PREFIX_SS
operator||
name|PREFIX_DS
operator||
name|PREFIX_ES
operator||
name|PREFIX_FS
operator||
name|PREFIX_GS
operator|)
condition|)
empty_stmt|;
else|else
block|{
name|oappend
argument_list|(
name|names_seg
index|[
name|ds_reg
operator|-
name|es_reg
index|]
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
literal|":"
argument_list|)
expr_stmt|;
block|}
name|print_operand_value
argument_list|(
name|scratchbuf
argument_list|,
literal|1
argument_list|,
name|disp
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
block|}
block|}
block|}
else|else
block|{
comment|/* 16 bit address mode */
switch|switch
condition|(
name|mod
condition|)
block|{
case|case
literal|0
case|:
if|if
condition|(
operator|(
name|rm
operator|&
literal|7
operator|)
operator|==
literal|6
condition|)
block|{
name|disp
operator|=
name|get16
argument_list|()
expr_stmt|;
if|if
condition|(
operator|(
name|disp
operator|&
literal|0x8000
operator|)
operator|!=
literal|0
condition|)
name|disp
operator|-=
literal|0x10000
expr_stmt|;
block|}
break|break;
case|case
literal|1
case|:
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|disp
operator|=
operator|*
name|codep
operator|++
expr_stmt|;
if|if
condition|(
operator|(
name|disp
operator|&
literal|0x80
operator|)
operator|!=
literal|0
condition|)
name|disp
operator|-=
literal|0x100
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|disp
operator|=
name|get16
argument_list|()
expr_stmt|;
if|if
condition|(
operator|(
name|disp
operator|&
literal|0x8000
operator|)
operator|!=
literal|0
condition|)
name|disp
operator|-=
literal|0x10000
expr_stmt|;
break|break;
block|}
if|if
condition|(
operator|!
name|intel_syntax
condition|)
if|if
condition|(
name|mod
operator|!=
literal|0
operator|||
operator|(
name|rm
operator|&
literal|7
operator|)
operator|==
literal|6
condition|)
block|{
name|print_operand_value
argument_list|(
name|scratchbuf
argument_list|,
literal|0
argument_list|,
name|disp
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|mod
operator|!=
literal|0
operator|||
operator|(
name|rm
operator|&
literal|7
operator|)
operator|!=
literal|6
condition|)
block|{
operator|*
name|obufp
operator|++
operator|=
name|open_char
expr_stmt|;
operator|*
name|obufp
operator|=
literal|'\0'
expr_stmt|;
name|oappend
argument_list|(
name|index16
index|[
name|rm
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
operator|*
name|obufp
operator|++
operator|=
name|close_char
expr_stmt|;
operator|*
name|obufp
operator|=
literal|'\0'
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|OP_G
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
name|int
name|add
init|=
literal|0
decl_stmt|;
name|USED_REX
argument_list|(
name|REX_EXTX
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_EXTX
condition|)
name|add
operator|+=
literal|8
expr_stmt|;
switch|switch
condition|(
name|bytemode
condition|)
block|{
case|case
name|b_mode
case|:
name|USED_REX
argument_list|(
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
condition|)
name|oappend
argument_list|(
name|names8rex
index|[
name|reg
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
else|else
name|oappend
argument_list|(
name|names8
index|[
name|reg
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|w_mode
case|:
name|oappend
argument_list|(
name|names16
index|[
name|reg
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|d_mode
case|:
name|oappend
argument_list|(
name|names32
index|[
name|reg
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|q_mode
case|:
name|oappend
argument_list|(
name|names64
index|[
name|reg
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|v_mode
case|:
name|USED_REX
argument_list|(
name|REX_MODE64
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_MODE64
condition|)
name|oappend
argument_list|(
name|names64
index|[
name|reg
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|sizeflag
operator|&
name|DFLAG
condition|)
name|oappend
argument_list|(
name|names32
index|[
name|reg
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
else|else
name|oappend
argument_list|(
name|names16
index|[
name|reg
operator|+
name|add
index|]
argument_list|)
expr_stmt|;
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
break|break;
default|default:
name|oappend
argument_list|(
name|INTERNAL_DISASSEMBLER_ERROR
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
end_function

begin_function
specifier|static
name|bfd_vma
name|get64
parameter_list|()
block|{
name|bfd_vma
name|x
decl_stmt|;
ifdef|#
directive|ifdef
name|BFD64
name|unsigned
name|int
name|a
decl_stmt|;
name|unsigned
name|int
name|b
decl_stmt|;
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|8
argument_list|)
expr_stmt|;
name|a
operator|=
operator|*
name|codep
operator|++
operator|&
literal|0xff
expr_stmt|;
name|a
operator||=
operator|(
operator|*
name|codep
operator|++
operator|&
literal|0xff
operator|)
operator|<<
literal|8
expr_stmt|;
name|a
operator||=
operator|(
operator|*
name|codep
operator|++
operator|&
literal|0xff
operator|)
operator|<<
literal|16
expr_stmt|;
name|a
operator||=
operator|(
operator|*
name|codep
operator|++
operator|&
literal|0xff
operator|)
operator|<<
literal|24
expr_stmt|;
name|b
operator|=
operator|*
name|codep
operator|++
operator|&
literal|0xff
expr_stmt|;
name|b
operator||=
operator|(
operator|*
name|codep
operator|++
operator|&
literal|0xff
operator|)
operator|<<
literal|8
expr_stmt|;
name|b
operator||=
operator|(
operator|*
name|codep
operator|++
operator|&
literal|0xff
operator|)
operator|<<
literal|16
expr_stmt|;
name|b
operator||=
operator|(
operator|*
name|codep
operator|++
operator|&
literal|0xff
operator|)
operator|<<
literal|24
expr_stmt|;
name|x
operator|=
name|a
operator|+
operator|(
operator|(
name|bfd_vma
operator|)
name|b
operator|<<
literal|32
operator|)
expr_stmt|;
else|#
directive|else
name|abort
argument_list|()
expr_stmt|;
name|x
operator|=
literal|0
expr_stmt|;
endif|#
directive|endif
return|return
name|x
return|;
block|}
end_function

begin_function
specifier|static
name|bfd_signed_vma
name|get32
parameter_list|()
block|{
name|bfd_signed_vma
name|x
init|=
literal|0
decl_stmt|;
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|4
argument_list|)
expr_stmt|;
name|x
operator|=
operator|*
name|codep
operator|++
operator|&
operator|(
name|bfd_signed_vma
operator|)
literal|0xff
expr_stmt|;
name|x
operator||=
operator|(
operator|*
name|codep
operator|++
operator|&
operator|(
name|bfd_signed_vma
operator|)
literal|0xff
operator|)
operator|<<
literal|8
expr_stmt|;
name|x
operator||=
operator|(
operator|*
name|codep
operator|++
operator|&
operator|(
name|bfd_signed_vma
operator|)
literal|0xff
operator|)
operator|<<
literal|16
expr_stmt|;
name|x
operator||=
operator|(
operator|*
name|codep
operator|++
operator|&
operator|(
name|bfd_signed_vma
operator|)
literal|0xff
operator|)
operator|<<
literal|24
expr_stmt|;
return|return
name|x
return|;
block|}
end_function

begin_function
specifier|static
name|bfd_signed_vma
name|get32s
parameter_list|()
block|{
name|bfd_signed_vma
name|x
init|=
literal|0
decl_stmt|;
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|4
argument_list|)
expr_stmt|;
name|x
operator|=
operator|*
name|codep
operator|++
operator|&
operator|(
name|bfd_signed_vma
operator|)
literal|0xff
expr_stmt|;
name|x
operator||=
operator|(
operator|*
name|codep
operator|++
operator|&
operator|(
name|bfd_signed_vma
operator|)
literal|0xff
operator|)
operator|<<
literal|8
expr_stmt|;
name|x
operator||=
operator|(
operator|*
name|codep
operator|++
operator|&
operator|(
name|bfd_signed_vma
operator|)
literal|0xff
operator|)
operator|<<
literal|16
expr_stmt|;
name|x
operator||=
operator|(
operator|*
name|codep
operator|++
operator|&
operator|(
name|bfd_signed_vma
operator|)
literal|0xff
operator|)
operator|<<
literal|24
expr_stmt|;
name|x
operator|=
operator|(
name|x
operator|^
operator|(
operator|(
name|bfd_signed_vma
operator|)
literal|1
operator|<<
literal|31
operator|)
operator|)
operator|-
operator|(
operator|(
name|bfd_signed_vma
operator|)
literal|1
operator|<<
literal|31
operator|)
expr_stmt|;
return|return
name|x
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|get16
parameter_list|()
block|{
name|int
name|x
init|=
literal|0
decl_stmt|;
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|2
argument_list|)
expr_stmt|;
name|x
operator|=
operator|*
name|codep
operator|++
operator|&
literal|0xff
expr_stmt|;
name|x
operator||=
operator|(
operator|*
name|codep
operator|++
operator|&
literal|0xff
operator|)
operator|<<
literal|8
expr_stmt|;
return|return
name|x
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|set_op
parameter_list|(
name|op
parameter_list|,
name|riprel
parameter_list|)
name|bfd_vma
name|op
decl_stmt|;
name|int
name|riprel
decl_stmt|;
block|{
name|op_index
index|[
name|op_ad
index|]
operator|=
name|op_ad
expr_stmt|;
if|if
condition|(
name|mode_64bit
condition|)
block|{
name|op_address
index|[
name|op_ad
index|]
operator|=
name|op
expr_stmt|;
name|op_riprel
index|[
name|op_ad
index|]
operator|=
name|riprel
expr_stmt|;
block|}
else|else
block|{
comment|/* Mask to get a 32-bit address.  */
name|op_address
index|[
name|op_ad
index|]
operator|=
name|op
operator|&
literal|0xffffffff
expr_stmt|;
name|op_riprel
index|[
name|op_ad
index|]
operator|=
name|riprel
operator|&
literal|0xffffffff
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|OP_REG
parameter_list|(
name|code
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|code
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
specifier|const
name|char
modifier|*
name|s
decl_stmt|;
name|int
name|add
init|=
literal|0
decl_stmt|;
name|USED_REX
argument_list|(
name|REX_EXTZ
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_EXTZ
condition|)
name|add
operator|=
literal|8
expr_stmt|;
switch|switch
condition|(
name|code
condition|)
block|{
case|case
name|indir_dx_reg
case|:
if|if
condition|(
name|intel_syntax
condition|)
name|s
operator|=
literal|"[dx]"
expr_stmt|;
else|else
name|s
operator|=
literal|"(%dx)"
expr_stmt|;
break|break;
case|case
name|ax_reg
case|:
case|case
name|cx_reg
case|:
case|case
name|dx_reg
case|:
case|case
name|bx_reg
case|:
case|case
name|sp_reg
case|:
case|case
name|bp_reg
case|:
case|case
name|si_reg
case|:
case|case
name|di_reg
case|:
name|s
operator|=
name|names16
index|[
name|code
operator|-
name|ax_reg
operator|+
name|add
index|]
expr_stmt|;
break|break;
case|case
name|es_reg
case|:
case|case
name|ss_reg
case|:
case|case
name|cs_reg
case|:
case|case
name|ds_reg
case|:
case|case
name|fs_reg
case|:
case|case
name|gs_reg
case|:
name|s
operator|=
name|names_seg
index|[
name|code
operator|-
name|es_reg
operator|+
name|add
index|]
expr_stmt|;
break|break;
case|case
name|al_reg
case|:
case|case
name|ah_reg
case|:
case|case
name|cl_reg
case|:
case|case
name|ch_reg
case|:
case|case
name|dl_reg
case|:
case|case
name|dh_reg
case|:
case|case
name|bl_reg
case|:
case|case
name|bh_reg
case|:
name|USED_REX
argument_list|(
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
condition|)
name|s
operator|=
name|names8rex
index|[
name|code
operator|-
name|al_reg
operator|+
name|add
index|]
expr_stmt|;
else|else
name|s
operator|=
name|names8
index|[
name|code
operator|-
name|al_reg
index|]
expr_stmt|;
break|break;
case|case
name|rAX_reg
case|:
case|case
name|rCX_reg
case|:
case|case
name|rDX_reg
case|:
case|case
name|rBX_reg
case|:
case|case
name|rSP_reg
case|:
case|case
name|rBP_reg
case|:
case|case
name|rSI_reg
case|:
case|case
name|rDI_reg
case|:
if|if
condition|(
name|mode_64bit
condition|)
block|{
name|s
operator|=
name|names64
index|[
name|code
operator|-
name|rAX_reg
operator|+
name|add
index|]
expr_stmt|;
break|break;
block|}
name|code
operator|+=
name|eAX_reg
operator|-
name|rAX_reg
expr_stmt|;
comment|/* Fall through.  */
case|case
name|eAX_reg
case|:
case|case
name|eCX_reg
case|:
case|case
name|eDX_reg
case|:
case|case
name|eBX_reg
case|:
case|case
name|eSP_reg
case|:
case|case
name|eBP_reg
case|:
case|case
name|eSI_reg
case|:
case|case
name|eDI_reg
case|:
name|USED_REX
argument_list|(
name|REX_MODE64
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_MODE64
condition|)
name|s
operator|=
name|names64
index|[
name|code
operator|-
name|eAX_reg
operator|+
name|add
index|]
expr_stmt|;
elseif|else
if|if
condition|(
name|sizeflag
operator|&
name|DFLAG
condition|)
name|s
operator|=
name|names32
index|[
name|code
operator|-
name|eAX_reg
operator|+
name|add
index|]
expr_stmt|;
else|else
name|s
operator|=
name|names16
index|[
name|code
operator|-
name|eAX_reg
operator|+
name|add
index|]
expr_stmt|;
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
break|break;
default|default:
name|s
operator|=
name|INTERNAL_DISASSEMBLER_ERROR
expr_stmt|;
break|break;
block|}
name|oappend
argument_list|(
name|s
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_IMREG
parameter_list|(
name|code
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|code
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
specifier|const
name|char
modifier|*
name|s
decl_stmt|;
switch|switch
condition|(
name|code
condition|)
block|{
case|case
name|indir_dx_reg
case|:
if|if
condition|(
name|intel_syntax
condition|)
name|s
operator|=
literal|"[dx]"
expr_stmt|;
else|else
name|s
operator|=
literal|"(%dx)"
expr_stmt|;
break|break;
case|case
name|ax_reg
case|:
case|case
name|cx_reg
case|:
case|case
name|dx_reg
case|:
case|case
name|bx_reg
case|:
case|case
name|sp_reg
case|:
case|case
name|bp_reg
case|:
case|case
name|si_reg
case|:
case|case
name|di_reg
case|:
name|s
operator|=
name|names16
index|[
name|code
operator|-
name|ax_reg
index|]
expr_stmt|;
break|break;
case|case
name|es_reg
case|:
case|case
name|ss_reg
case|:
case|case
name|cs_reg
case|:
case|case
name|ds_reg
case|:
case|case
name|fs_reg
case|:
case|case
name|gs_reg
case|:
name|s
operator|=
name|names_seg
index|[
name|code
operator|-
name|es_reg
index|]
expr_stmt|;
break|break;
case|case
name|al_reg
case|:
case|case
name|ah_reg
case|:
case|case
name|cl_reg
case|:
case|case
name|ch_reg
case|:
case|case
name|dl_reg
case|:
case|case
name|dh_reg
case|:
case|case
name|bl_reg
case|:
case|case
name|bh_reg
case|:
name|USED_REX
argument_list|(
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
condition|)
name|s
operator|=
name|names8rex
index|[
name|code
operator|-
name|al_reg
index|]
expr_stmt|;
else|else
name|s
operator|=
name|names8
index|[
name|code
operator|-
name|al_reg
index|]
expr_stmt|;
break|break;
case|case
name|eAX_reg
case|:
case|case
name|eCX_reg
case|:
case|case
name|eDX_reg
case|:
case|case
name|eBX_reg
case|:
case|case
name|eSP_reg
case|:
case|case
name|eBP_reg
case|:
case|case
name|eSI_reg
case|:
case|case
name|eDI_reg
case|:
name|USED_REX
argument_list|(
name|REX_MODE64
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_MODE64
condition|)
name|s
operator|=
name|names64
index|[
name|code
operator|-
name|eAX_reg
index|]
expr_stmt|;
elseif|else
if|if
condition|(
name|sizeflag
operator|&
name|DFLAG
condition|)
name|s
operator|=
name|names32
index|[
name|code
operator|-
name|eAX_reg
index|]
expr_stmt|;
else|else
name|s
operator|=
name|names16
index|[
name|code
operator|-
name|eAX_reg
index|]
expr_stmt|;
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
break|break;
default|default:
name|s
operator|=
name|INTERNAL_DISASSEMBLER_ERROR
expr_stmt|;
break|break;
block|}
name|oappend
argument_list|(
name|s
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_I
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
name|bfd_signed_vma
name|op
decl_stmt|;
name|bfd_signed_vma
name|mask
init|=
operator|-
literal|1
decl_stmt|;
switch|switch
condition|(
name|bytemode
condition|)
block|{
case|case
name|b_mode
case|:
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|op
operator|=
operator|*
name|codep
operator|++
expr_stmt|;
name|mask
operator|=
literal|0xff
expr_stmt|;
break|break;
case|case
name|q_mode
case|:
if|if
condition|(
name|mode_64bit
condition|)
block|{
name|op
operator|=
name|get32s
argument_list|()
expr_stmt|;
break|break;
block|}
comment|/* Fall through.  */
case|case
name|v_mode
case|:
name|USED_REX
argument_list|(
name|REX_MODE64
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_MODE64
condition|)
name|op
operator|=
name|get32s
argument_list|()
expr_stmt|;
elseif|else
if|if
condition|(
name|sizeflag
operator|&
name|DFLAG
condition|)
block|{
name|op
operator|=
name|get32
argument_list|()
expr_stmt|;
name|mask
operator|=
literal|0xffffffff
expr_stmt|;
block|}
else|else
block|{
name|op
operator|=
name|get16
argument_list|()
expr_stmt|;
name|mask
operator|=
literal|0xfffff
expr_stmt|;
block|}
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
break|break;
case|case
name|w_mode
case|:
name|mask
operator|=
literal|0xfffff
expr_stmt|;
name|op
operator|=
name|get16
argument_list|()
expr_stmt|;
break|break;
default|default:
name|oappend
argument_list|(
name|INTERNAL_DISASSEMBLER_ERROR
argument_list|)
expr_stmt|;
return|return;
block|}
name|op
operator|&=
name|mask
expr_stmt|;
name|scratchbuf
index|[
literal|0
index|]
operator|=
literal|'$'
expr_stmt|;
name|print_operand_value
argument_list|(
name|scratchbuf
operator|+
literal|1
argument_list|,
literal|1
argument_list|,
name|op
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
operator|+
name|intel_syntax
argument_list|)
expr_stmt|;
name|scratchbuf
index|[
literal|0
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_I64
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
name|bfd_signed_vma
name|op
decl_stmt|;
name|bfd_signed_vma
name|mask
init|=
operator|-
literal|1
decl_stmt|;
if|if
condition|(
operator|!
name|mode_64bit
condition|)
block|{
name|OP_I
argument_list|(
name|bytemode
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
return|return;
block|}
switch|switch
condition|(
name|bytemode
condition|)
block|{
case|case
name|b_mode
case|:
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|op
operator|=
operator|*
name|codep
operator|++
expr_stmt|;
name|mask
operator|=
literal|0xff
expr_stmt|;
break|break;
case|case
name|v_mode
case|:
name|USED_REX
argument_list|(
name|REX_MODE64
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_MODE64
condition|)
name|op
operator|=
name|get64
argument_list|()
expr_stmt|;
elseif|else
if|if
condition|(
name|sizeflag
operator|&
name|DFLAG
condition|)
block|{
name|op
operator|=
name|get32
argument_list|()
expr_stmt|;
name|mask
operator|=
literal|0xffffffff
expr_stmt|;
block|}
else|else
block|{
name|op
operator|=
name|get16
argument_list|()
expr_stmt|;
name|mask
operator|=
literal|0xfffff
expr_stmt|;
block|}
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
break|break;
case|case
name|w_mode
case|:
name|mask
operator|=
literal|0xfffff
expr_stmt|;
name|op
operator|=
name|get16
argument_list|()
expr_stmt|;
break|break;
default|default:
name|oappend
argument_list|(
name|INTERNAL_DISASSEMBLER_ERROR
argument_list|)
expr_stmt|;
return|return;
block|}
name|op
operator|&=
name|mask
expr_stmt|;
name|scratchbuf
index|[
literal|0
index|]
operator|=
literal|'$'
expr_stmt|;
name|print_operand_value
argument_list|(
name|scratchbuf
operator|+
literal|1
argument_list|,
literal|1
argument_list|,
name|op
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
operator|+
name|intel_syntax
argument_list|)
expr_stmt|;
name|scratchbuf
index|[
literal|0
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_sI
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
name|bfd_signed_vma
name|op
decl_stmt|;
name|bfd_signed_vma
name|mask
init|=
operator|-
literal|1
decl_stmt|;
switch|switch
condition|(
name|bytemode
condition|)
block|{
case|case
name|b_mode
case|:
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|op
operator|=
operator|*
name|codep
operator|++
expr_stmt|;
if|if
condition|(
operator|(
name|op
operator|&
literal|0x80
operator|)
operator|!=
literal|0
condition|)
name|op
operator|-=
literal|0x100
expr_stmt|;
name|mask
operator|=
literal|0xffffffff
expr_stmt|;
break|break;
case|case
name|v_mode
case|:
name|USED_REX
argument_list|(
name|REX_MODE64
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_MODE64
condition|)
name|op
operator|=
name|get32s
argument_list|()
expr_stmt|;
elseif|else
if|if
condition|(
name|sizeflag
operator|&
name|DFLAG
condition|)
block|{
name|op
operator|=
name|get32s
argument_list|()
expr_stmt|;
name|mask
operator|=
literal|0xffffffff
expr_stmt|;
block|}
else|else
block|{
name|mask
operator|=
literal|0xffffffff
expr_stmt|;
name|op
operator|=
name|get16
argument_list|()
expr_stmt|;
if|if
condition|(
operator|(
name|op
operator|&
literal|0x8000
operator|)
operator|!=
literal|0
condition|)
name|op
operator|-=
literal|0x10000
expr_stmt|;
block|}
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
break|break;
case|case
name|w_mode
case|:
name|op
operator|=
name|get16
argument_list|()
expr_stmt|;
name|mask
operator|=
literal|0xffffffff
expr_stmt|;
if|if
condition|(
operator|(
name|op
operator|&
literal|0x8000
operator|)
operator|!=
literal|0
condition|)
name|op
operator|-=
literal|0x10000
expr_stmt|;
break|break;
default|default:
name|oappend
argument_list|(
name|INTERNAL_DISASSEMBLER_ERROR
argument_list|)
expr_stmt|;
return|return;
block|}
name|scratchbuf
index|[
literal|0
index|]
operator|=
literal|'$'
expr_stmt|;
name|print_operand_value
argument_list|(
name|scratchbuf
operator|+
literal|1
argument_list|,
literal|1
argument_list|,
name|op
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
operator|+
name|intel_syntax
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_J
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
name|bfd_vma
name|disp
decl_stmt|;
name|bfd_vma
name|mask
init|=
operator|-
literal|1
decl_stmt|;
switch|switch
condition|(
name|bytemode
condition|)
block|{
case|case
name|b_mode
case|:
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|disp
operator|=
operator|*
name|codep
operator|++
expr_stmt|;
if|if
condition|(
operator|(
name|disp
operator|&
literal|0x80
operator|)
operator|!=
literal|0
condition|)
name|disp
operator|-=
literal|0x100
expr_stmt|;
break|break;
case|case
name|v_mode
case|:
if|if
condition|(
name|sizeflag
operator|&
name|DFLAG
condition|)
name|disp
operator|=
name|get32s
argument_list|()
expr_stmt|;
else|else
block|{
name|disp
operator|=
name|get16
argument_list|()
expr_stmt|;
comment|/* For some reason, a data16 prefix on a jump instruction 	     means that the pc is masked to 16 bits after the 	     displacement is added!  */
name|mask
operator|=
literal|0xffff
expr_stmt|;
block|}
break|break;
default|default:
name|oappend
argument_list|(
name|INTERNAL_DISASSEMBLER_ERROR
argument_list|)
expr_stmt|;
return|return;
block|}
name|disp
operator|=
operator|(
name|start_pc
operator|+
name|codep
operator|-
name|start_codep
operator|+
name|disp
operator|)
operator|&
name|mask
expr_stmt|;
name|set_op
argument_list|(
name|disp
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|print_operand_value
argument_list|(
name|scratchbuf
argument_list|,
literal|1
argument_list|,
name|disp
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_SEG
parameter_list|(
name|dummy
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|dummy
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|int
name|sizeflag
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|oappend
argument_list|(
name|names_seg
index|[
name|reg
index|]
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_DIR
parameter_list|(
name|dummy
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|dummy
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
name|int
name|seg
decl_stmt|,
name|offset
decl_stmt|;
if|if
condition|(
name|sizeflag
operator|&
name|DFLAG
condition|)
block|{
name|offset
operator|=
name|get32
argument_list|()
expr_stmt|;
name|seg
operator|=
name|get16
argument_list|()
expr_stmt|;
block|}
else|else
block|{
name|offset
operator|=
name|get16
argument_list|()
expr_stmt|;
name|seg
operator|=
name|get16
argument_list|()
expr_stmt|;
block|}
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
if|if
condition|(
name|intel_syntax
condition|)
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"0x%x,0x%x"
argument_list|,
name|seg
argument_list|,
name|offset
argument_list|)
expr_stmt|;
else|else
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"$0x%x,$0x%x"
argument_list|,
name|seg
argument_list|,
name|offset
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_OFF
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
name|bfd_vma
name|off
decl_stmt|;
name|append_seg
argument_list|()
expr_stmt|;
if|if
condition|(
name|sizeflag
operator|&
name|AFLAG
condition|)
name|off
operator|=
name|get32
argument_list|()
expr_stmt|;
else|else
name|off
operator|=
name|get16
argument_list|()
expr_stmt|;
if|if
condition|(
name|intel_syntax
condition|)
block|{
if|if
condition|(
operator|!
operator|(
name|prefixes
operator|&
operator|(
name|PREFIX_CS
operator||
name|PREFIX_SS
operator||
name|PREFIX_DS
operator||
name|PREFIX_ES
operator||
name|PREFIX_FS
operator||
name|PREFIX_GS
operator|)
operator|)
condition|)
block|{
name|oappend
argument_list|(
name|names_seg
index|[
name|ds_reg
operator|-
name|es_reg
index|]
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
literal|":"
argument_list|)
expr_stmt|;
block|}
block|}
name|print_operand_value
argument_list|(
name|scratchbuf
argument_list|,
literal|1
argument_list|,
name|off
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_OFF64
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|int
name|sizeflag
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|bfd_vma
name|off
decl_stmt|;
if|if
condition|(
operator|!
name|mode_64bit
condition|)
block|{
name|OP_OFF
argument_list|(
name|bytemode
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
return|return;
block|}
name|append_seg
argument_list|()
expr_stmt|;
name|off
operator|=
name|get64
argument_list|()
expr_stmt|;
if|if
condition|(
name|intel_syntax
condition|)
block|{
if|if
condition|(
operator|!
operator|(
name|prefixes
operator|&
operator|(
name|PREFIX_CS
operator||
name|PREFIX_SS
operator||
name|PREFIX_DS
operator||
name|PREFIX_ES
operator||
name|PREFIX_FS
operator||
name|PREFIX_GS
operator|)
operator|)
condition|)
block|{
name|oappend
argument_list|(
name|names_seg
index|[
name|ds_reg
operator|-
name|es_reg
index|]
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
literal|":"
argument_list|)
expr_stmt|;
block|}
block|}
name|print_operand_value
argument_list|(
name|scratchbuf
argument_list|,
literal|1
argument_list|,
name|off
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|ptr_reg
parameter_list|(
name|code
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|code
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
specifier|const
name|char
modifier|*
name|s
decl_stmt|;
if|if
condition|(
name|intel_syntax
condition|)
name|oappend
argument_list|(
literal|"["
argument_list|)
expr_stmt|;
else|else
name|oappend
argument_list|(
literal|"("
argument_list|)
expr_stmt|;
name|USED_REX
argument_list|(
name|REX_MODE64
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_MODE64
condition|)
name|s
operator|=
name|names64
index|[
name|code
operator|-
name|eAX_reg
index|]
expr_stmt|;
elseif|else
if|if
condition|(
name|sizeflag
operator|&
name|AFLAG
condition|)
name|s
operator|=
name|names32
index|[
name|code
operator|-
name|eAX_reg
index|]
expr_stmt|;
else|else
name|s
operator|=
name|names16
index|[
name|code
operator|-
name|eAX_reg
index|]
expr_stmt|;
name|oappend
argument_list|(
name|s
argument_list|)
expr_stmt|;
if|if
condition|(
name|intel_syntax
condition|)
name|oappend
argument_list|(
literal|"]"
argument_list|)
expr_stmt|;
else|else
name|oappend
argument_list|(
literal|")"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_ESreg
parameter_list|(
name|code
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|code
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
name|oappend
argument_list|(
literal|"%es:"
operator|+
name|intel_syntax
argument_list|)
expr_stmt|;
name|ptr_reg
argument_list|(
name|code
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_DSreg
parameter_list|(
name|code
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|code
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
if|if
condition|(
operator|(
name|prefixes
operator|&
operator|(
name|PREFIX_CS
operator||
name|PREFIX_DS
operator||
name|PREFIX_SS
operator||
name|PREFIX_ES
operator||
name|PREFIX_FS
operator||
name|PREFIX_GS
operator|)
operator|)
operator|==
literal|0
condition|)
name|prefixes
operator||=
name|PREFIX_DS
expr_stmt|;
name|append_seg
argument_list|()
expr_stmt|;
name|ptr_reg
argument_list|(
name|code
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_C
parameter_list|(
name|dummy
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|dummy
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|int
name|sizeflag
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|int
name|add
init|=
literal|0
decl_stmt|;
name|USED_REX
argument_list|(
name|REX_EXTX
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_EXTX
condition|)
name|add
operator|=
literal|8
expr_stmt|;
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%%cr%d"
argument_list|,
name|reg
operator|+
name|add
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
operator|+
name|intel_syntax
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_D
parameter_list|(
name|dummy
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|dummy
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|int
name|sizeflag
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|int
name|add
init|=
literal|0
decl_stmt|;
name|USED_REX
argument_list|(
name|REX_EXTX
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_EXTX
condition|)
name|add
operator|=
literal|8
expr_stmt|;
if|if
condition|(
name|intel_syntax
condition|)
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"db%d"
argument_list|,
name|reg
operator|+
name|add
argument_list|)
expr_stmt|;
else|else
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%%db%d"
argument_list|,
name|reg
operator|+
name|add
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_T
parameter_list|(
name|dummy
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|dummy
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|int
name|sizeflag
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%%tr%d"
argument_list|,
name|reg
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
operator|+
name|intel_syntax
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_Rd
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
if|if
condition|(
name|mod
operator|==
literal|3
condition|)
name|OP_E
argument_list|(
name|bytemode
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
else|else
name|BadOp
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_MMX
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|int
name|sizeflag
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|int
name|add
init|=
literal|0
decl_stmt|;
name|USED_REX
argument_list|(
name|REX_EXTX
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_EXTX
condition|)
name|add
operator|=
literal|8
expr_stmt|;
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_DATA
condition|)
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%%xmm%d"
argument_list|,
name|reg
operator|+
name|add
argument_list|)
expr_stmt|;
else|else
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%%mm%d"
argument_list|,
name|reg
operator|+
name|add
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
operator|+
name|intel_syntax
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_XMM
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|int
name|sizeflag
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|int
name|add
init|=
literal|0
decl_stmt|;
name|USED_REX
argument_list|(
name|REX_EXTX
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_EXTX
condition|)
name|add
operator|=
literal|8
expr_stmt|;
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%%xmm%d"
argument_list|,
name|reg
operator|+
name|add
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
operator|+
name|intel_syntax
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_EM
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
name|int
name|add
init|=
literal|0
decl_stmt|;
if|if
condition|(
name|mod
operator|!=
literal|3
condition|)
block|{
name|OP_E
argument_list|(
name|bytemode
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
return|return;
block|}
name|USED_REX
argument_list|(
name|REX_EXTZ
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_EXTZ
condition|)
name|add
operator|=
literal|8
expr_stmt|;
comment|/* Skip mod/rm byte.  */
name|MODRM_CHECK
expr_stmt|;
name|codep
operator|++
expr_stmt|;
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_DATA
condition|)
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%%xmm%d"
argument_list|,
name|rm
operator|+
name|add
argument_list|)
expr_stmt|;
else|else
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%%mm%d"
argument_list|,
name|rm
operator|+
name|add
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
operator|+
name|intel_syntax
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_EX
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
name|int
name|add
init|=
literal|0
decl_stmt|;
if|if
condition|(
name|mod
operator|!=
literal|3
condition|)
block|{
name|OP_E
argument_list|(
name|bytemode
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
return|return;
block|}
name|USED_REX
argument_list|(
name|REX_EXTZ
argument_list|)
expr_stmt|;
if|if
condition|(
name|rex
operator|&
name|REX_EXTZ
condition|)
name|add
operator|=
literal|8
expr_stmt|;
comment|/* Skip mod/rm byte.  */
name|MODRM_CHECK
expr_stmt|;
name|codep
operator|++
expr_stmt|;
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"%%xmm%d"
argument_list|,
name|rm
operator|+
name|add
argument_list|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
operator|+
name|intel_syntax
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_MS
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
if|if
condition|(
name|mod
operator|==
literal|3
condition|)
name|OP_EM
argument_list|(
name|bytemode
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
else|else
name|BadOp
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|OP_XS
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
decl_stmt|;
name|int
name|sizeflag
decl_stmt|;
block|{
if|if
condition|(
name|mod
operator|==
literal|3
condition|)
name|OP_EX
argument_list|(
name|bytemode
argument_list|,
name|sizeflag
argument_list|)
expr_stmt|;
else|else
name|BadOp
argument_list|()
expr_stmt|;
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|Suffix3DNow
index|[]
init|=
block|{
comment|/* 00 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 04 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 08 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 0C */
literal|"pi2fw"
block|,
literal|"pi2fd"
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 10 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 14 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 18 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 1C */
literal|"pf2iw"
block|,
literal|"pf2id"
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 20 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 24 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 28 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 2C */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 30 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 34 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 38 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 3C */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 40 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 44 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 48 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 4C */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 50 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 54 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 58 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 5C */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 60 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 64 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 68 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 6C */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 70 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 74 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 78 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 7C */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 80 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 84 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 88 */
name|NULL
block|,
name|NULL
block|,
literal|"pfnacc"
block|,
name|NULL
block|,
comment|/* 8C */
name|NULL
block|,
name|NULL
block|,
literal|"pfpnacc"
block|,
name|NULL
block|,
comment|/* 90 */
literal|"pfcmpge"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* 94 */
literal|"pfmin"
block|,
name|NULL
block|,
literal|"pfrcp"
block|,
literal|"pfrsqrt"
block|,
comment|/* 98 */
name|NULL
block|,
name|NULL
block|,
literal|"pfsub"
block|,
name|NULL
block|,
comment|/* 9C */
name|NULL
block|,
name|NULL
block|,
literal|"pfadd"
block|,
name|NULL
block|,
comment|/* A0 */
literal|"pfcmpgt"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* A4 */
literal|"pfmax"
block|,
name|NULL
block|,
literal|"pfrcpit1"
block|,
literal|"pfrsqit1"
block|,
comment|/* A8 */
name|NULL
block|,
name|NULL
block|,
literal|"pfsubr"
block|,
name|NULL
block|,
comment|/* AC */
name|NULL
block|,
name|NULL
block|,
literal|"pfacc"
block|,
name|NULL
block|,
comment|/* B0 */
literal|"pfcmpeq"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* B4 */
literal|"pfmul"
block|,
name|NULL
block|,
literal|"pfrcpit2"
block|,
literal|"pfmulhrw"
block|,
comment|/* B8 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
literal|"pswapd"
block|,
comment|/* BC */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
literal|"pavgusb"
block|,
comment|/* C0 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* C4 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* C8 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* CC */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* D0 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* D4 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* D8 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* DC */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* E0 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* E4 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* E8 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* EC */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* F0 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* F4 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* F8 */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
comment|/* FC */
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|, }
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
name|OP_3DNowSuffix
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|int
name|sizeflag
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
specifier|const
name|char
modifier|*
name|mnemonic
decl_stmt|;
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
comment|/* AMD 3DNow! instructions are specified by an opcode suffix in the      place where an 8-bit immediate would normally go.  ie. the last      byte of the instruction.  */
name|obufp
operator|=
name|obuf
operator|+
name|strlen
argument_list|(
name|obuf
argument_list|)
expr_stmt|;
name|mnemonic
operator|=
name|Suffix3DNow
index|[
operator|*
name|codep
operator|++
operator|&
literal|0xff
index|]
expr_stmt|;
if|if
condition|(
name|mnemonic
condition|)
name|oappend
argument_list|(
name|mnemonic
argument_list|)
expr_stmt|;
else|else
block|{
comment|/* Since a variable sized modrm/sib chunk is between the start 	 of the opcode (0x0f0f) and the opcode suffix, we need to do 	 all the modrm processing first, and don't know until now that 	 we have a bad opcode.  This necessitates some cleaning up.  */
name|op1out
index|[
literal|0
index|]
operator|=
literal|'\0'
expr_stmt|;
name|op2out
index|[
literal|0
index|]
operator|=
literal|'\0'
expr_stmt|;
name|BadOp
argument_list|()
expr_stmt|;
block|}
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|simd_cmp_op
index|[]
init|=
block|{
literal|"eq"
block|,
literal|"lt"
block|,
literal|"le"
block|,
literal|"unord"
block|,
literal|"neq"
block|,
literal|"nlt"
block|,
literal|"nle"
block|,
literal|"ord"
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
name|OP_SIMD_Suffix
parameter_list|(
name|bytemode
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|bytemode
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|int
name|sizeflag
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|unsigned
name|int
name|cmp_type
decl_stmt|;
name|FETCH_DATA
argument_list|(
name|the_info
argument_list|,
name|codep
operator|+
literal|1
argument_list|)
expr_stmt|;
name|obufp
operator|=
name|obuf
operator|+
name|strlen
argument_list|(
name|obuf
argument_list|)
expr_stmt|;
name|cmp_type
operator|=
operator|*
name|codep
operator|++
operator|&
literal|0xff
expr_stmt|;
if|if
condition|(
name|cmp_type
operator|<
literal|8
condition|)
block|{
name|char
name|suffix1
init|=
literal|'p'
decl_stmt|,
name|suffix2
init|=
literal|'s'
decl_stmt|;
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_REPZ
operator|)
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_REPZ
condition|)
name|suffix1
operator|=
literal|'s'
expr_stmt|;
else|else
block|{
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_DATA
operator|)
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_DATA
condition|)
name|suffix2
operator|=
literal|'d'
expr_stmt|;
else|else
block|{
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_REPNZ
operator|)
expr_stmt|;
if|if
condition|(
name|prefixes
operator|&
name|PREFIX_REPNZ
condition|)
name|suffix1
operator|=
literal|'s'
operator|,
name|suffix2
operator|=
literal|'d'
expr_stmt|;
block|}
block|}
name|sprintf
argument_list|(
name|scratchbuf
argument_list|,
literal|"cmp%s%c%c"
argument_list|,
name|simd_cmp_op
index|[
name|cmp_type
index|]
argument_list|,
name|suffix1
argument_list|,
name|suffix2
argument_list|)
expr_stmt|;
name|used_prefixes
operator||=
operator|(
name|prefixes
operator|&
name|PREFIX_REPZ
operator|)
expr_stmt|;
name|oappend
argument_list|(
name|scratchbuf
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|/* We have a bad extension byte.  Clean up.  */
name|op1out
index|[
literal|0
index|]
operator|=
literal|'\0'
expr_stmt|;
name|op2out
index|[
literal|0
index|]
operator|=
literal|'\0'
expr_stmt|;
name|BadOp
argument_list|()
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|SIMD_Fixup
parameter_list|(
name|extrachar
parameter_list|,
name|sizeflag
parameter_list|)
name|int
name|extrachar
decl_stmt|;
name|int
name|sizeflag
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
comment|/* Change movlps/movhps to movhlps/movlhps for 2 register operand      forms of these instructions.  */
if|if
condition|(
name|mod
operator|==
literal|3
condition|)
block|{
name|char
modifier|*
name|p
init|=
name|obuf
operator|+
name|strlen
argument_list|(
name|obuf
argument_list|)
decl_stmt|;
operator|*
operator|(
name|p
operator|+
literal|1
operator|)
operator|=
literal|'\0'
expr_stmt|;
operator|*
name|p
operator|=
operator|*
operator|(
name|p
operator|-
literal|1
operator|)
expr_stmt|;
operator|*
operator|(
name|p
operator|-
literal|1
operator|)
operator|=
operator|*
operator|(
name|p
operator|-
literal|2
operator|)
expr_stmt|;
operator|*
operator|(
name|p
operator|-
literal|2
operator|)
operator|=
operator|*
operator|(
name|p
operator|-
literal|3
operator|)
expr_stmt|;
operator|*
operator|(
name|p
operator|-
literal|3
operator|)
operator|=
name|extrachar
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|BadOp
parameter_list|(
name|void
parameter_list|)
block|{
comment|/* Throw away prefixes and 1st. opcode byte.  */
name|codep
operator|=
name|insn_codep
operator|+
literal|1
expr_stmt|;
name|oappend
argument_list|(
literal|"(bad)"
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

