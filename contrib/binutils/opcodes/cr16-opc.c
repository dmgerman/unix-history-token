begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* cr16-opc.c -- Table of opcodes for the CR16 processor.    Copyright 2007 Free Software Foundation, Inc.    Contributed by M R Swami Reddy (MR.Swami.Reddy@nsc.com)     This file is part of GAS, GDB and the GNU binutils.     GAS, GDB, and GNU binutils is free software; you can redistribute it    and/or modify it under the terms of the GNU General Public License as    published by the Free Software Foundation; either version 2, or (at your    option) any later version.     GAS, GDB, and GNU binutils are distributed in the hope that they will be    useful, but WITHOUT ANY WARRANTY; without even the implied warranty of    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    GNU General Public License for more details.     You should have received a copy of the GNU General Public License    along with this program; if not, write to the Free Software Foundation,    Inc., 51 Franklin Street - Fifth Floor, Boston, MA 02110-1301, USA.  */
end_comment

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|"libiberty.h"
end_include

begin_include
include|#
directive|include
file|"symcat.h"
end_include

begin_include
include|#
directive|include
file|"opcode/cr16.h"
end_include

begin_decl_stmt
specifier|const
name|inst
name|cr16_instruction
index|[]
init|=
block|{
comment|/* Create an arithmetic instruction - INST[bw].  */
define|#
directive|define
name|ARITH_BYTE_INST
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|,
name|OP1
parameter_list|)
define|\
comment|/* opc8 imm4 r */
define|\
value|{NAME, 1, OPC, 24, ARITH_BYTE_INS, {{uimm4_1,20}, {regr,16}}},     \
comment|/* opc8 imm16 r */
value|\   {NAME, 2, (OPC<<4)+0xB, 20, ARITH_BYTE_INS, {{OP1,0}, {regr,16}}}, \
comment|/* opc8 r r */
value|\   {NAME, 1, OPC+0x1, 24, ARITH_BYTE_INS, {{regr,20}, {regr,16}}}
comment|/* for Logincal operations, allow unsinged imm16 also */
define|#
directive|define
name|ARITH1_BYTE_INST
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|,
name|OP1
parameter_list|)
define|\
comment|/* opc8 imm16 r */
define|\
value|{NAME, 2, (OPC<<4)+0xB, 20, ARITH_BYTE_INS, {{OP1,0}, {regr,16}}}
name|ARITH_BYTE_INST
argument_list|(
literal|"andb"
argument_list|,
literal|0x20
argument_list|,
name|uimm16
argument_list|)
block|,
name|ARITH1_BYTE_INST
argument_list|(
literal|"andb"
argument_list|,
literal|0x20
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"andw"
argument_list|,
literal|0x22
argument_list|,
name|uimm16
argument_list|)
block|,
name|ARITH1_BYTE_INST
argument_list|(
literal|"andw"
argument_list|,
literal|0x22
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"orb"
argument_list|,
literal|0x24
argument_list|,
name|uimm16
argument_list|)
block|,
name|ARITH1_BYTE_INST
argument_list|(
literal|"orb"
argument_list|,
literal|0x24
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"orw"
argument_list|,
literal|0x26
argument_list|,
name|uimm16
argument_list|)
block|,
name|ARITH1_BYTE_INST
argument_list|(
literal|"orw"
argument_list|,
literal|0x26
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"xorb"
argument_list|,
literal|0x28
argument_list|,
name|uimm16
argument_list|)
block|,
name|ARITH1_BYTE_INST
argument_list|(
literal|"xorb"
argument_list|,
literal|0x28
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"xorw"
argument_list|,
literal|0x2A
argument_list|,
name|uimm16
argument_list|)
block|,
name|ARITH1_BYTE_INST
argument_list|(
literal|"xorw"
argument_list|,
literal|0x2A
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"addub"
argument_list|,
literal|0x2C
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"adduw"
argument_list|,
literal|0x2E
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"addb"
argument_list|,
literal|0x30
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"addw"
argument_list|,
literal|0x32
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"addcb"
argument_list|,
literal|0x34
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"addcw"
argument_list|,
literal|0x36
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"subb"
argument_list|,
literal|0x38
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"subw"
argument_list|,
literal|0x3A
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"subcb"
argument_list|,
literal|0x3C
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"subcw"
argument_list|,
literal|0x3E
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"cmpb"
argument_list|,
literal|0x50
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"cmpw"
argument_list|,
literal|0x52
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"movb"
argument_list|,
literal|0x58
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"movw"
argument_list|,
literal|0x5A
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"mulb"
argument_list|,
literal|0x64
argument_list|,
name|imm16
argument_list|)
block|,
name|ARITH_BYTE_INST
argument_list|(
literal|"mulw"
argument_list|,
literal|0x66
argument_list|,
name|imm16
argument_list|)
block|,
define|#
directive|define
name|ARITH_BYTE_INST1
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|)
define|\
comment|/* opc8 r r */
define|\
value|{NAME, 1, OPC, 24, ARITH_BYTE_INS, {{regr,20}, {regr,16}}}
name|ARITH_BYTE_INST1
argument_list|(
literal|"movxb"
argument_list|,
literal|0x5C
argument_list|)
block|,
name|ARITH_BYTE_INST1
argument_list|(
literal|"movzb"
argument_list|,
literal|0x5D
argument_list|)
block|,
name|ARITH_BYTE_INST1
argument_list|(
literal|"mulsb"
argument_list|,
literal|0x0B
argument_list|)
block|,
define|#
directive|define
name|ARITH_BYTE_INST2
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|)
define|\
comment|/* opc8 r rp */
define|\
value|{NAME, 1, OPC, 24, ARITH_BYTE_INS, {{regr,20}, {regp,16}}}
name|ARITH_BYTE_INST2
argument_list|(
literal|"movxw"
argument_list|,
literal|0x5E
argument_list|)
block|,
name|ARITH_BYTE_INST2
argument_list|(
literal|"movzw"
argument_list|,
literal|0x5F
argument_list|)
block|,
name|ARITH_BYTE_INST2
argument_list|(
literal|"mulsw"
argument_list|,
literal|0x62
argument_list|)
block|,
name|ARITH_BYTE_INST2
argument_list|(
literal|"muluw"
argument_list|,
literal|0x63
argument_list|)
block|,
comment|/* Create an arithmetic instruction - INST[d]- with 3 types.  */
define|#
directive|define
name|ARITH_INST_D
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|)
define|\
comment|/* opc8 imm4 rp */
define|\
value|{NAME, 1, OPC, 24, ARITH_INS, {{uimm4_1,20}, {regp,16}}},          \
comment|/* opc8 imm16 rp */
value|\   {NAME, 2, (OPC<<4)+0xB, 20, ARITH_INS, {{imm16,0}, {regp,16}}},    \
comment|/* opc8 rp rp */
value|\   {NAME, 1, OPC+1, 24, ARITH_INS, {{regp,20}, {regp,16}}}
comment|/* Create an arithmetic instruction - INST[d]-20 bit types.  */
define|#
directive|define
name|ARITH_INST20
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|)
define|\
comment|/* opc8 uimm20 rp */
define|\
value|{NAME, 2, OPC, 24, ARITH_INS, {{uimm20,0},  {regp,20}}}
comment|/* Create an arithmetic instruction - INST[d]-32 bit types.  */
define|#
directive|define
name|ARITH_INST32
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|,
name|OP1
parameter_list|)
define|\
comment|/* opc12 imm32 rp */
define|\
value|{NAME, 3, OPC, 20, ARITH_INS, {{OP1,0},  {regp,16}}}
comment|/* Create an arithmetic instruction - INST[d]-32bit types(reg pairs).*/
define|#
directive|define
name|ARITH_INST32RP
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|)
define|\
comment|/* opc24 rp rp */
define|\
value|{NAME, 2, OPC, 12, ARITH_INS, {{regp,4},  {regp,0}}}
name|ARITH_INST_D
argument_list|(
literal|"movd"
argument_list|,
literal|0x54
argument_list|)
block|,
name|ARITH_INST20
argument_list|(
literal|"movd"
argument_list|,
literal|0x05
argument_list|)
block|,
name|ARITH_INST32
argument_list|(
literal|"movd"
argument_list|,
literal|0x007
argument_list|,
name|imm32
argument_list|)
block|,
name|ARITH_INST_D
argument_list|(
literal|"addd"
argument_list|,
literal|0x60
argument_list|)
block|,
name|ARITH_INST20
argument_list|(
literal|"addd"
argument_list|,
literal|0x04
argument_list|)
block|,
name|ARITH_INST32
argument_list|(
literal|"addd"
argument_list|,
literal|0x002
argument_list|,
name|imm32
argument_list|)
block|,
name|ARITH_INST32
argument_list|(
literal|"subd"
argument_list|,
literal|0x003
argument_list|,
name|imm32
argument_list|)
block|,
name|ARITH_INST32RP
argument_list|(
literal|"subd"
argument_list|,
literal|0x0014C
argument_list|)
block|,
name|ARITH_INST_D
argument_list|(
literal|"cmpd"
argument_list|,
literal|0x56
argument_list|)
block|,
name|ARITH_INST32
argument_list|(
literal|"cmpd"
argument_list|,
literal|0x009
argument_list|,
name|imm32
argument_list|)
block|,
name|ARITH_INST32
argument_list|(
literal|"andd"
argument_list|,
literal|0x004
argument_list|,
name|uimm32
argument_list|)
block|,
name|ARITH_INST32RP
argument_list|(
literal|"andd"
argument_list|,
literal|0x0014B
argument_list|)
block|,
name|ARITH_INST32
argument_list|(
literal|"ord"
argument_list|,
literal|0x005
argument_list|,
name|uimm32
argument_list|)
block|,
name|ARITH_INST32RP
argument_list|(
literal|"ord"
argument_list|,
literal|0x00149
argument_list|)
block|,
name|ARITH_INST32
argument_list|(
literal|"xord"
argument_list|,
literal|0x006
argument_list|,
name|uimm32
argument_list|)
block|,
name|ARITH_INST32RP
argument_list|(
literal|"xord"
argument_list|,
literal|0x0014A
argument_list|)
block|,
comment|/* Create a shift instruction.  */
define|#
directive|define
name|SHIFT_INST_A
parameter_list|(
name|NAME
parameter_list|,
name|OPC1
parameter_list|,
name|OPC2
parameter_list|,
name|SHIFT
parameter_list|,
name|OP1
parameter_list|,
name|OP2
parameter_list|)
define|\
comment|/* opc imm r */
define|\
value|{NAME, 1, OPC1, SHIFT, SHIFT_INS, {{OP1,20}, {OP2,16}}},  \
comment|/* opc imm r */
value|\   {NAME, 1, OPC1+1, SHIFT, SHIFT_INS, {{OP1,20}, {OP2,16}}},\
comment|/* opc r r */
value|\   {NAME, 1, OPC2, 24, SHIFT_INS, {{regr,20}, {OP2,16}}}
name|SHIFT_INST_A
argument_list|(
literal|"ashub"
argument_list|,
literal|0x80
argument_list|,
literal|0x41
argument_list|,
literal|23
argument_list|,
name|imm4
argument_list|,
name|regr
argument_list|)
block|,
name|SHIFT_INST_A
argument_list|(
literal|"ashud"
argument_list|,
literal|0x26
argument_list|,
literal|0x48
argument_list|,
literal|25
argument_list|,
name|imm6
argument_list|,
name|regp
argument_list|)
block|,
name|SHIFT_INST_A
argument_list|(
literal|"ashuw"
argument_list|,
literal|0x42
argument_list|,
literal|0x45
argument_list|,
literal|24
argument_list|,
name|imm5
argument_list|,
name|regr
argument_list|)
block|,
define|#
directive|define
name|SHIFT_INST_L
parameter_list|(
name|NAME
parameter_list|,
name|OPC1
parameter_list|,
name|OPC2
parameter_list|,
name|SHIFT
parameter_list|,
name|OP1
parameter_list|,
name|OP2
parameter_list|)
define|\
comment|/* opc imm r */
define|\
value|{NAME, 1, OPC1, SHIFT, SHIFT_INS, {{OP1,20}, {OP2,16}}},  \
comment|/* opc r r */
value|\   {NAME, 1, OPC2, 24, SHIFT_INS, {{regr,20}, {OP2,16}}}
name|SHIFT_INST_L
argument_list|(
literal|"lshb"
argument_list|,
literal|0x13
argument_list|,
literal|0x44
argument_list|,
literal|23
argument_list|,
name|imm4
argument_list|,
name|regr
argument_list|)
block|,
name|SHIFT_INST_L
argument_list|(
literal|"lshd"
argument_list|,
literal|0x25
argument_list|,
literal|0x47
argument_list|,
literal|25
argument_list|,
name|imm6
argument_list|,
name|regp
argument_list|)
block|,
name|SHIFT_INST_L
argument_list|(
literal|"lshw"
argument_list|,
literal|0x49
argument_list|,
literal|0x46
argument_list|,
literal|24
argument_list|,
name|imm5
argument_list|,
name|regr
argument_list|)
block|,
comment|/* Create a conditional branch instruction.  */
define|#
directive|define
name|BRANCH_INST
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|)
define|\
comment|/* opc4 c4 dispe9 */
define|\
value|{NAME,  1, OPC, 28, BRANCH_INS, {{cc,20}, {dispe9,16}}},            \
comment|/* opc4 c4 disps17 */
value|\   {NAME,  2, ((OPC<<4)+0x8), 24, BRANCH_INS, {{cc,20}, {disps17,0}}}, \
comment|/* opc4 c4 disps25 */
value|\   {NAME,  3, (OPC<<4), 16 , BRANCH_INS, {{cc,4}, {disps25,16}}}
name|BRANCH_INST
argument_list|(
literal|"b"
argument_list|,
literal|0x1
argument_list|)
block|,
comment|/* Create a 'Branch if Equal to 0' instruction.  */
define|#
directive|define
name|BRANCH_NEQ_INST
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|)
define|\
comment|/* opc8 disps5 r */
define|\
value|{NAME,  1, OPC, 24, BRANCH_NEQ_INS, {{regr,16}, {disps5,20}}}
name|BRANCH_NEQ_INST
argument_list|(
literal|"beq0b"
argument_list|,
literal|0x0C
argument_list|)
block|,
name|BRANCH_NEQ_INST
argument_list|(
literal|"bne0b"
argument_list|,
literal|0x0D
argument_list|)
block|,
name|BRANCH_NEQ_INST
argument_list|(
literal|"beq0w"
argument_list|,
literal|0x0E
argument_list|)
block|,
name|BRANCH_NEQ_INST
argument_list|(
literal|"bne0w"
argument_list|,
literal|0x0F
argument_list|)
block|,
comment|/* Create an instruction using a single register operand.  */
define|#
directive|define
name|REG1_INST
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|)
define|\
comment|/* opc8 c4 r */
define|\
value|{NAME,  1, OPC, 20, NO_TYPE_INS, {{regr,16}}}
define|#
directive|define
name|REGP1_INST
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|)
define|\
comment|/* opc8 c4 r */
define|\
value|{NAME,  1, OPC, 20, NO_TYPE_INS, {{regp,16}}}
comment|/* Same as REG1_INST, with additional FLAGS.  */
define|#
directive|define
name|REG1_FLAG_INST
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|,
name|FLAGS
parameter_list|)
define|\
comment|/* opc8 c4 r */
define|\
value|{NAME,  1, OPC, 20, NO_TYPE_INS | FLAGS, {{regp,16}}}
comment|/* JCond instructions */
name|REGP1_INST
argument_list|(
literal|"jeq"
argument_list|,
literal|0x0A0
argument_list|)
block|,
name|REGP1_INST
argument_list|(
literal|"jne"
argument_list|,
literal|0x0A1
argument_list|)
block|,
name|REGP1_INST
argument_list|(
literal|"jcs"
argument_list|,
literal|0x0A2
argument_list|)
block|,
name|REGP1_INST
argument_list|(
literal|"jcc"
argument_list|,
literal|0x0A3
argument_list|)
block|,
name|REGP1_INST
argument_list|(
literal|"jhi"
argument_list|,
literal|0x0A4
argument_list|)
block|,
name|REGP1_INST
argument_list|(
literal|"jls"
argument_list|,
literal|0x0A5
argument_list|)
block|,
name|REGP1_INST
argument_list|(
literal|"jgt"
argument_list|,
literal|0x0A6
argument_list|)
block|,
name|REGP1_INST
argument_list|(
literal|"jle"
argument_list|,
literal|0x0A7
argument_list|)
block|,
name|REGP1_INST
argument_list|(
literal|"jfs"
argument_list|,
literal|0x0A8
argument_list|)
block|,
name|REGP1_INST
argument_list|(
literal|"jfc"
argument_list|,
literal|0x0A9
argument_list|)
block|,
name|REGP1_INST
argument_list|(
literal|"jlo"
argument_list|,
literal|0x0AA
argument_list|)
block|,
name|REGP1_INST
argument_list|(
literal|"jhs"
argument_list|,
literal|0x0AB
argument_list|)
block|,
name|REGP1_INST
argument_list|(
literal|"jlt"
argument_list|,
literal|0x0AC
argument_list|)
block|,
name|REGP1_INST
argument_list|(
literal|"jge"
argument_list|,
literal|0x0AD
argument_list|)
block|,
name|REGP1_INST
argument_list|(
literal|"jump"
argument_list|,
literal|0x0AE
argument_list|)
block|,
name|REGP1_INST
argument_list|(
literal|"jusr"
argument_list|,
literal|0x0AF
argument_list|)
block|,
comment|/* SCond instructions */
name|REG1_INST
argument_list|(
literal|"seq"
argument_list|,
literal|0x080
argument_list|)
block|,
name|REG1_INST
argument_list|(
literal|"sne"
argument_list|,
literal|0x081
argument_list|)
block|,
name|REG1_INST
argument_list|(
literal|"scs"
argument_list|,
literal|0x082
argument_list|)
block|,
name|REG1_INST
argument_list|(
literal|"scc"
argument_list|,
literal|0x083
argument_list|)
block|,
name|REG1_INST
argument_list|(
literal|"shi"
argument_list|,
literal|0x084
argument_list|)
block|,
name|REG1_INST
argument_list|(
literal|"sls"
argument_list|,
literal|0x085
argument_list|)
block|,
name|REG1_INST
argument_list|(
literal|"sgt"
argument_list|,
literal|0x086
argument_list|)
block|,
name|REG1_INST
argument_list|(
literal|"sle"
argument_list|,
literal|0x087
argument_list|)
block|,
name|REG1_INST
argument_list|(
literal|"sfs"
argument_list|,
literal|0x088
argument_list|)
block|,
name|REG1_INST
argument_list|(
literal|"sfc"
argument_list|,
literal|0x089
argument_list|)
block|,
name|REG1_INST
argument_list|(
literal|"slo"
argument_list|,
literal|0x08A
argument_list|)
block|,
name|REG1_INST
argument_list|(
literal|"shs"
argument_list|,
literal|0x08B
argument_list|)
block|,
name|REG1_INST
argument_list|(
literal|"slt"
argument_list|,
literal|0x08C
argument_list|)
block|,
name|REG1_INST
argument_list|(
literal|"sge"
argument_list|,
literal|0x08D
argument_list|)
block|,
comment|/* Create an instruction using two register operands.  */
define|#
directive|define
name|REG3_INST
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|)
define|\
comment|/* opc24 r r rp  */
define|\
value|{NAME,  2, OPC,  12, NO_TYPE_INS, {{regr,4}, {regr,0}, {regp,8}}}
comment|/* MULTIPLY INSTRUCTIONS */
name|REG3_INST
argument_list|(
literal|"macqw"
argument_list|,
literal|0x0014d
argument_list|)
block|,
name|REG3_INST
argument_list|(
literal|"macuw"
argument_list|,
literal|0x0014e
argument_list|)
block|,
name|REG3_INST
argument_list|(
literal|"macsw"
argument_list|,
literal|0x0014f
argument_list|)
block|,
comment|/* Create a branch instruction.  */
define|#
directive|define
name|BR_INST
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|)
define|\
comment|/* opc12 ra disps25 */
define|\
value|{NAME,  2, OPC,  24, NO_TYPE_INS, {{rra,0}, {disps25,0}}}
define|#
directive|define
name|BR_INST_RP
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|)
define|\
comment|/* opc8 rp disps25 */
define|\
value|{NAME,  3, OPC,  12, NO_TYPE_INS, {{regp,4}, {disps25,16}}}
name|BR_INST
argument_list|(
literal|"bal"
argument_list|,
literal|0xC0
argument_list|)
block|,
name|BR_INST_RP
argument_list|(
literal|"bal"
argument_list|,
literal|0x00102
argument_list|)
block|,
define|#
directive|define
name|REGPP2_INST
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|)
define|\
comment|/* opc16 rp rp  */
define|\
value|{NAME,  2, OPC,  12, NO_TYPE_INS, {{regp,0}, {regp,4}}}
comment|/* Jump and link instructions.  */
name|REGP1_INST
argument_list|(
literal|"jal"
argument_list|,
literal|0x00D
argument_list|)
block|,
name|REGPP2_INST
argument_list|(
literal|"jal"
argument_list|,
literal|0x00148
argument_list|)
block|,
comment|/* Instructions including a register list (opcode is represented as a mask). */
define|#
directive|define
name|REGLIST_INST
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|,
name|TYPE
parameter_list|)
define|\
comment|/* opc7 r count3 RA */
define|\
value|{NAME,1, (OPC<<1)+1, 23, TYPE, {{uimm3_1,20},{regr,16},{regr,0}}}, \
comment|/* opc8 r count3 */
value|\   {NAME,  1, OPC, 24, TYPE, {{uimm3_1,20}, {regr,16}}},              \
comment|/* opc12 RA  */
value|\   {NAME,  1, (OPC<<8)+0x1E, 16, TYPE, {{regr,0}}}
name|REGLIST_INST
argument_list|(
literal|"push"
argument_list|,
literal|0x01
argument_list|,
operator|(
name|NO_TYPE_INS
operator||
name|REG_LIST
operator|)
argument_list|)
block|,
name|REGLIST_INST
argument_list|(
literal|"pop"
argument_list|,
literal|0x02
argument_list|,
operator|(
name|NO_TYPE_INS
operator||
name|REG_LIST
operator|)
argument_list|)
block|,
name|REGLIST_INST
argument_list|(
literal|"popret"
argument_list|,
literal|0x03
argument_list|,
operator|(
name|NO_TYPE_INS
operator||
name|REG_LIST
operator|)
argument_list|)
block|,
block|{
literal|"loadm"
block|,
literal|1
block|,
literal|0x14
block|,
literal|19
block|,
name|NO_TYPE_INS
operator||
name|REG_LIST
block|,
block|{
block|{
name|uimm3_1
block|,
literal|16
block|}
block|}
block|}
block|,
block|{
literal|"loadmp"
block|,
literal|1
block|,
literal|0x15
block|,
literal|19
block|,
name|NO_TYPE_INS
operator||
name|REG_LIST
block|,
block|{
block|{
name|uimm3_1
block|,
literal|16
block|}
block|}
block|}
block|,
block|{
literal|"storm"
block|,
literal|1
block|,
literal|0x16
block|,
literal|19
block|,
name|NO_TYPE_INS
operator||
name|REG_LIST
block|,
block|{
block|{
name|uimm3_1
block|,
literal|16
block|}
block|}
block|}
block|,
block|{
literal|"stormp"
block|,
literal|1
block|,
literal|0x17
block|,
literal|19
block|,
name|NO_TYPE_INS
operator||
name|REG_LIST
block|,
block|{
block|{
name|uimm3_1
block|,
literal|16
block|}
block|}
block|}
block|,
comment|/* Processor Regsiter Manipulation instructions  */
comment|/* opc16 reg, preg */
block|{
literal|"lpr"
block|,
literal|2
block|,
literal|0x00140
block|,
literal|12
block|,
name|NO_TYPE_INS
block|,
block|{
block|{
name|regr
block|,
literal|0
block|}
block|,
block|{
name|pregr
block|,
literal|4
block|}
block|}
block|}
block|,
comment|/* opc16 regp, pregp */
block|{
literal|"lprd"
block|,
literal|2
block|,
literal|0x00141
block|,
literal|12
block|,
name|NO_TYPE_INS
block|,
block|{
block|{
name|regp
block|,
literal|0
block|}
block|,
block|{
name|pregrp
block|,
literal|4
block|}
block|}
block|}
block|,
comment|/* opc16 preg, reg */
block|{
literal|"spr"
block|,
literal|2
block|,
literal|0x00142
block|,
literal|12
block|,
name|NO_TYPE_INS
block|,
block|{
block|{
name|pregr
block|,
literal|4
block|}
block|,
block|{
name|regr
block|,
literal|0
block|}
block|}
block|}
block|,
comment|/* opc16 pregp, regp */
block|{
literal|"sprd"
block|,
literal|2
block|,
literal|0x00143
block|,
literal|12
block|,
name|NO_TYPE_INS
block|,
block|{
block|{
name|pregrp
block|,
literal|4
block|}
block|,
block|{
name|regp
block|,
literal|0
block|}
block|}
block|}
block|,
comment|/* Miscellaneous.  */
comment|/* opc12 ui4 */
block|{
literal|"excp"
block|,
literal|1
block|,
literal|0x00C
block|,
literal|20
block|,
name|NO_TYPE_INS
block|,
block|{
block|{
name|uimm4
block|,
literal|16
block|}
block|}
block|}
block|,
comment|/* Create a bit-b instruction.  */
define|#
directive|define
name|CSTBIT_INST_B
parameter_list|(
name|NAME
parameter_list|,
name|OP
parameter_list|,
name|OPC1
parameter_list|,
name|OPC2
parameter_list|,
name|OPC3
parameter_list|,
name|OPC4
parameter_list|)
define|\
comment|/* opcNN iN abs20 */
define|\
value|{NAME,  2, (OPC3+1), 23, CSTBIT_INS, {{OP,20},{abs20,0}}},           \
comment|/* opcNN iN abs24 */
value|\   {NAME,  3, (OPC2+3), 12, CSTBIT_INS, {{OP,4},{abs24,16}}},           \
comment|/* opcNN iN (Rindex)abs20 */
value|\   {NAME,  2, OPC1, 24, CSTBIT_INS, {{OP,20}, {rindex7_abs20,0}}},      \
comment|/* opcNN iN (prp) disps14(RPbase) */
value|\   {NAME,  2, OPC4, 22, CSTBIT_INS, {{OP,4},{rpindex_disps14,0}}},      \
comment|/* opcNN iN disps20(Rbase) */
value|\   {NAME,  3, OPC2, 12, CSTBIT_INS, {{OP,4}, {rbase_disps20,16}}},      \
comment|/* opcNN iN (rp) disps0(RPbase) */
value|\   {NAME,  1, OPC3-2, 23, CSTBIT_INS, {{OP,20}, {rpbase_disps0,16}}},   \
comment|/* opcNN iN (rp) disps16(RPBase) */
value|\   {NAME,  2, OPC3,  23, CSTBIT_INS, {{OP,20}, {rpbase_disps16,0}}},    \
comment|/* opcNN iN (rp) disps20(RPBase) */
value|\   {NAME,  3, (OPC2+1), 12, CSTBIT_INS, {{OP,4}, {rpbase_disps20,16}}}, \
comment|/* opcNN iN rrp (Rindex)disps20(RPbase) */
value|\   {NAME,  3, (OPC2+2), 12, CSTBIT_INS, {{OP,4}, {rpindex_disps20,16}}}
name|CSTBIT_INST_B
argument_list|(
literal|"cbitb"
argument_list|,
name|uimm3
argument_list|,
literal|0x68
argument_list|,
literal|0x00104
argument_list|,
literal|0xD6
argument_list|,
literal|0x1AA
argument_list|)
block|,
name|CSTBIT_INST_B
argument_list|(
literal|"sbitb"
argument_list|,
name|uimm3
argument_list|,
literal|0x70
argument_list|,
literal|0x00108
argument_list|,
literal|0xE6
argument_list|,
literal|0x1CA
argument_list|)
block|,
name|CSTBIT_INST_B
argument_list|(
literal|"tbitb"
argument_list|,
name|uimm3
argument_list|,
literal|0x78
argument_list|,
literal|0x0010C
argument_list|,
literal|0xF6
argument_list|,
literal|0x1EA
argument_list|)
block|,
comment|/* Create a bit-w instruction.  */
define|#
directive|define
name|CSTBIT_INST_W
parameter_list|(
name|NAME
parameter_list|,
name|OP
parameter_list|,
name|OPC1
parameter_list|,
name|OPC2
parameter_list|,
name|OPC3
parameter_list|,
name|OPC4
parameter_list|)
define|\
comment|/* opcNN iN abs20 */
define|\
value|{NAME,  2, OPC1+6, 24, CSTBIT_INS, {{OP,20},{abs20,0}}},             \
comment|/* opcNN iN abs24 */
value|\   {NAME,  3, OPC2+3, 12, CSTBIT_INS, {{OP,4},{abs24,16}}},             \
comment|/* opcNN iN (Rindex)abs20 */
value|\   {NAME,  2, OPC3, 25, CSTBIT_INS, {{OP,20}, {rindex8_abs20,0}}},      \
comment|/* opcNN iN (prp) disps14(RPbase) */
value|\   {NAME,  2, OPC4, 22, CSTBIT_INS, {{OP,4},{rpindex_disps14,0}}},      \
comment|/* opcNN iN disps20(Rbase) */
value|\   {NAME,  3, OPC2, 12, CSTBIT_INS, {{OP,4}, {rbase_disps20,16}}},      \
comment|/* opcNN iN (rp) disps0(RPbase) */
value|\   {NAME,  1, OPC1+5, 24, CSTBIT_INS, {{OP,20}, {rpbase_disps0,16}}},   \
comment|/* opcNN iN (rp) disps16(RPBase) */
value|\   {NAME,  2, OPC1,  24, CSTBIT_INS, {{OP,20}, {rpbase_disps16,0}}},    \
comment|/* opcNN iN (rp) disps20(RPBase) */
value|\   {NAME,  3, OPC2+1, 12, CSTBIT_INS, {{OP,4}, {rpbase_disps20,16}}},   \
comment|/* opcNN iN rrp (Rindex)disps20(RPbase) */
value|\   {NAME,  3, OPC2+2, 12, CSTBIT_INS, {{OP,4}, {rpindex_disps20,16}}}
name|CSTBIT_INST_W
argument_list|(
literal|"cbitw"
argument_list|,
name|uimm4
argument_list|,
literal|0x69
argument_list|,
literal|0x00114
argument_list|,
literal|0x36
argument_list|,
literal|0x1AB
argument_list|)
block|,
name|CSTBIT_INST_W
argument_list|(
literal|"sbitw"
argument_list|,
name|uimm4
argument_list|,
literal|0x71
argument_list|,
literal|0x00118
argument_list|,
literal|0x3A
argument_list|,
literal|0x1CB
argument_list|)
block|,
name|CSTBIT_INST_W
argument_list|(
literal|"tbitw"
argument_list|,
name|uimm4
argument_list|,
literal|0x79
argument_list|,
literal|0x0011C
argument_list|,
literal|0x3E
argument_list|,
literal|0x1EB
argument_list|)
block|,
comment|/* tbit cnt */
block|{
literal|"tbit"
block|,
literal|1
block|,
literal|0x06
block|,
literal|24
block|,
name|CSTBIT_INS
block|,
block|{
block|{
name|uimm4
block|,
literal|20
block|}
block|,
block|{
name|regr
block|,
literal|16
block|}
block|}
block|}
block|,
comment|/* tbit reg reg */
block|{
literal|"tbit"
block|,
literal|1
block|,
literal|0x07
block|,
literal|24
block|,
name|CSTBIT_INS
block|,
block|{
block|{
name|regr
block|,
literal|20
block|}
block|,
block|{
name|regr
block|,
literal|16
block|}
block|}
block|}
block|,
comment|/* Load instructions (from memory to register).  */
define|#
directive|define
name|LD_REG_INST
parameter_list|(
name|NAME
parameter_list|,
name|OPC1
parameter_list|,
name|OPC2
parameter_list|,
name|OPC3
parameter_list|,
name|OPC4
parameter_list|,
name|OPC5
parameter_list|,
name|OP_S
parameter_list|,
name|OP_D
parameter_list|)
define|\
comment|/* opc8 reg abs20 */
define|\
value|{NAME, 2, OPC3,  24, LD_STOR_INS, {{abs20,0}, {OP_D,20}}},              \
comment|/* opc20 reg abs24 */
value|\  {NAME, 3, OPC1+3, 12, LD_STOR_INS, {{abs24,16}, {OP_D,4}}},             \
comment|/* opc7 reg rindex8_abs20 */
value|\  {NAME, 2, OPC5, 25, LD_STOR_INS, {{rindex8_abs20,0}, {OP_D,20}}},       \
comment|/* opc4 reg  disps4(RPbase) */
value|\  {NAME, 1, (OPC2>>4), 28, LD_STOR_INS, {{OP_S,24}, {OP_D,20}}},          \
comment|/* opcNN reg  disps0(RPbase) */
value|\  {NAME, 1, OPC2, 24, LD_STOR_INS, {{rpindex_disps0,0}, {OP_D,20}}},      \
comment|/* opc reg  disps14(RPbase) */
value|\  {NAME, 2, OPC4, 22, LD_STOR_INS, {{rpindex_disps14,0}, {OP_D,20}}},     \
comment|/* opc reg -disps20(Rbase) */
value|\  {NAME, 3, OPC1+0x60, 12, LD_STOR_INS, {{rbase_dispe20,16}, {OP_D,4}}},  \
comment|/* opc reg disps20(Rbase) */
value|\  {NAME, 3, OPC1, 12, LD_STOR_INS, {{rbase_disps20,16}, {OP_D,4}}},       \
comment|/* opc reg (rp) disps16(RPbase) */
value|\  {NAME, 2, OPC2+1, 24, LD_STOR_INS, {{rpbase_disps16,0}, {OP_D,20}}},    \
comment|/* opc16 reg (rp) disps20(RPbase) */
value|\  {NAME, 3, OPC1+1, 12, LD_STOR_INS, {{rpbase_disps20,16}, {OP_D,4}}},    \
comment|/* op reg (rp) -disps20(RPbase) */
value|\  {NAME, 3, OPC1+0x61, 12, LD_STOR_INS, {{rpbase_dispe20,16}, {OP_D,4}}}, \
comment|/* opc reg rrp (Rindex)disps20(RPbase) */
value|\  {NAME, 3, (OPC1+2), 12, LD_STOR_INS, {{rpindex_disps20,16}, {OP_D,4}}}
name|LD_REG_INST
argument_list|(
literal|"loadb"
argument_list|,
literal|0x00124
argument_list|,
literal|0xBE
argument_list|,
literal|0x88
argument_list|,
literal|0x219
argument_list|,
literal|0x45
argument_list|,
name|rpbase_disps4
argument_list|,
name|regr
argument_list|)
block|,
name|LD_REG_INST
argument_list|(
literal|"loadd"
argument_list|,
literal|0x00128
argument_list|,
literal|0xAE
argument_list|,
literal|0x87
argument_list|,
literal|0x21A
argument_list|,
literal|0x46
argument_list|,
name|rpbase_dispe4
argument_list|,
name|regp
argument_list|)
block|,
name|LD_REG_INST
argument_list|(
literal|"loadw"
argument_list|,
literal|0x0012C
argument_list|,
literal|0x9E
argument_list|,
literal|0x89
argument_list|,
literal|0x21B
argument_list|,
literal|0x47
argument_list|,
name|rpbase_dispe4
argument_list|,
name|regr
argument_list|)
block|,
comment|/* Store instructions (from reg to memory).  */
define|#
directive|define
name|ST_REG_INST
parameter_list|(
name|NAME
parameter_list|,
name|OPC1
parameter_list|,
name|OPC2
parameter_list|,
name|OPC3
parameter_list|,
name|OPC4
parameter_list|,
name|OPC5
parameter_list|,
name|OP_D
parameter_list|,
name|OP_S
parameter_list|)
define|\
comment|/* opc8 reg abs20 */
define|\
value|{NAME, 2, OPC3,  24, LD_STOR_INS, {{OP_S,20}, {abs20,0}}},              \
comment|/* opc20 reg abs24 */
value|\  {NAME, 3, OPC1+3, 12, LD_STOR_INS, {{OP_S,4}, {abs24,16}}},             \
comment|/* opc7 reg rindex8_abs20 */
value|\  {NAME, 2, OPC5, 25, LD_STOR_INS, {{OP_S,20}, {rindex8_abs20,0}}},       \
comment|/* opc4 reg disps4(RPbase) */
value|\  {NAME, 1, (OPC2>>4), 28, LD_STOR_INS, {{OP_S,20}, {OP_D,24}}},          \
comment|/* opcNN reg  disps0(RPbase) */
value|\  {NAME, 1, OPC2, 24, LD_STOR_INS, {{OP_S,20}, {rpindex_disps0,0}}},      \
comment|/* opc reg  disps14(RPbase) */
value|\  {NAME, 2, OPC4, 22, LD_STOR_INS, {{OP_S,20}, {rpindex_disps14,0}}},     \
comment|/* opc reg -disps20(Rbase) */
value|\  {NAME, 3, OPC1+0x60, 12, LD_STOR_INS, {{OP_S,4}, {rbase_dispe20,16}}},  \
comment|/* opc reg disps20(Rbase) */
value|\  {NAME, 3, OPC1, 12, LD_STOR_INS, {{OP_S,4}, {rbase_disps20,16}}},       \
comment|/* opc reg  disps16(RPbase) */
value|\  {NAME, 2, OPC2+1, 24, LD_STOR_INS, {{OP_S,20}, {rpbase_disps16,0}}},    \
comment|/* opc16 reg disps20(RPbase) */
value|\  {NAME, 3, OPC1+1, 12, LD_STOR_INS, {{OP_S,4}, {rpbase_disps20,16}}},    \
comment|/* op reg (rp) -disps20(RPbase) */
value|\  {NAME, 3, OPC1+0x61, 12, LD_STOR_INS, {{OP_S,4}, {rpbase_dispe20,16}}}, \
comment|/* opc reg rrp (Rindex)disps20(RPbase) */
value|\  {NAME, 3, OPC1+2, 12, LD_STOR_INS, {{OP_S,4}, {rpindex_disps20,16}}}
comment|/* Store instructions (from imm to memory).  */
define|#
directive|define
name|ST_IMM_INST
parameter_list|(
name|NAME
parameter_list|,
name|OPC1
parameter_list|,
name|OPC2
parameter_list|,
name|OPC3
parameter_list|,
name|OPC4
parameter_list|)
define|\
comment|/* opcNN iN abs20 */
define|\
value|{NAME,  2, OPC1, 24, LD_STOR_INS, {{uimm4,20},{abs20,0}}},             \
comment|/* opcNN iN abs24 */
value|\   {NAME,  3, OPC2+3, 12, LD_STOR_INS, {{uimm4,4},{abs24,16}}},           \
comment|/* opcNN iN (Rindex)abs20 */
value|\   {NAME,  2, OPC3, 25, LD_STOR_INS, {{uimm4,20}, {rindex8_abs20,0}}},    \
comment|/* opcNN iN (prp) disps14(RPbase) */
value|\   {NAME,  2, OPC4, 22, LD_STOR_INS, {{uimm4,4},{rpindex_disps14,0}}},    \
comment|/* opcNN iN (rp) disps0(RPbase) */
value|\   {NAME,  1, OPC1+1, 24, LD_STOR_INS, {{uimm4,20}, {rpbase_disps0,16}}}, \
comment|/* opcNN iN disps20(Rbase) */
value|\   {NAME,  3, OPC2, 12, LD_STOR_INS, {{uimm4,4}, {rbase_disps20,16}}},    \
comment|/* opcNN iN (rp) disps16(RPBase) */
value|\   {NAME,  2, OPC1+2, 24, LD_STOR_INS, {{uimm4,20}, {rpbase_disps16,0}}}, \
comment|/* opcNN iN (rp) disps20(RPBase) */
value|\   {NAME,  3, OPC2+1, 12, LD_STOR_INS, {{uimm4,4}, {rpbase_disps20,16}}}, \
comment|/* opcNN iN rrp (Rindex)disps20(RPbase) */
value|\   {NAME,  3, OPC2+2, 12, LD_STOR_INS, {{uimm4,4}, {rpindex_disps20,16}}}
name|ST_REG_INST
argument_list|(
literal|"storb"
argument_list|,
literal|0x00134
argument_list|,
literal|0xFE
argument_list|,
literal|0xC8
argument_list|,
literal|0x319
argument_list|,
literal|0x65
argument_list|,
name|rpbase_disps4
argument_list|,
name|regr
argument_list|)
block|,
name|ST_IMM_INST
argument_list|(
literal|"storb"
argument_list|,
literal|0x81
argument_list|,
literal|0x00120
argument_list|,
literal|0x42
argument_list|,
literal|0x218
argument_list|)
block|,
name|ST_REG_INST
argument_list|(
literal|"stord"
argument_list|,
literal|0x00138
argument_list|,
literal|0xEE
argument_list|,
literal|0xC7
argument_list|,
literal|0x31A
argument_list|,
literal|0x66
argument_list|,
name|rpbase_dispe4
argument_list|,
name|regp
argument_list|)
block|,
name|ST_REG_INST
argument_list|(
literal|"storw"
argument_list|,
literal|0x0013C
argument_list|,
literal|0xDE
argument_list|,
literal|0xC9
argument_list|,
literal|0x31B
argument_list|,
literal|0x67
argument_list|,
name|rpbase_dispe4
argument_list|,
name|regr
argument_list|)
block|,
name|ST_IMM_INST
argument_list|(
literal|"storw"
argument_list|,
literal|0xC1
argument_list|,
literal|0x00130
argument_list|,
literal|0x62
argument_list|,
literal|0x318
argument_list|)
block|,
comment|/* Create instruction with no operands.  */
define|#
directive|define
name|NO_OP_INST
parameter_list|(
name|NAME
parameter_list|,
name|OPC
parameter_list|)
define|\
comment|/* opc16 */
define|\
value|{NAME,  1, OPC, 16, 0, {{0, 0}}}
name|NO_OP_INST
argument_list|(
literal|"cinv[i]"
argument_list|,
literal|0x000A
argument_list|)
block|,
name|NO_OP_INST
argument_list|(
literal|"cinv[i,u]"
argument_list|,
literal|0x000B
argument_list|)
block|,
name|NO_OP_INST
argument_list|(
literal|"cinv[d]"
argument_list|,
literal|0x000C
argument_list|)
block|,
name|NO_OP_INST
argument_list|(
literal|"cinv[d,u]"
argument_list|,
literal|0x000D
argument_list|)
block|,
name|NO_OP_INST
argument_list|(
literal|"cinv[d,i]"
argument_list|,
literal|0x000E
argument_list|)
block|,
name|NO_OP_INST
argument_list|(
literal|"cinv[d,i,u]"
argument_list|,
literal|0x000F
argument_list|)
block|,
name|NO_OP_INST
argument_list|(
literal|"nop"
argument_list|,
literal|0x2C00
argument_list|)
block|,
name|NO_OP_INST
argument_list|(
literal|"retx"
argument_list|,
literal|0x0003
argument_list|)
block|,
name|NO_OP_INST
argument_list|(
literal|"di"
argument_list|,
literal|0x0004
argument_list|)
block|,
name|NO_OP_INST
argument_list|(
literal|"ei"
argument_list|,
literal|0x0005
argument_list|)
block|,
name|NO_OP_INST
argument_list|(
literal|"wait"
argument_list|,
literal|0x0006
argument_list|)
block|,
name|NO_OP_INST
argument_list|(
literal|"eiwait"
argument_list|,
literal|0x0007
argument_list|)
block|,
block|{
name|NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
block|{
block|{
literal|0
block|,
literal|0
block|}
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|unsigned
name|int
name|cr16_num_opcodes
init|=
name|ARRAY_SIZE
argument_list|(
name|cr16_instruction
argument_list|)
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Macro to build a reg_entry, which have an opcode image :    For example :       REG(u4, 0x84, CR16_U_REGTYPE)    is interpreted as :       {"u4",  u4, 0x84, CR16_U_REGTYPE}  */
end_comment

begin_define
define|#
directive|define
name|REG
parameter_list|(
name|NAME
parameter_list|,
name|N
parameter_list|,
name|TYPE
parameter_list|)
value|{STRINGX(NAME), {NAME}, N, TYPE}
end_define

begin_define
define|#
directive|define
name|REGP
parameter_list|(
name|NAME
parameter_list|,
name|BNAME
parameter_list|,
name|N
parameter_list|,
name|TYPE
parameter_list|)
value|{STRINGX(NAME), {BNAME}, N, TYPE}
end_define

begin_decl_stmt
specifier|const
name|reg_entry
name|cr16_regtab
index|[]
init|=
block|{
comment|/* Build a general purpose register r<N>.  */
define|#
directive|define
name|REG_R
parameter_list|(
name|N
parameter_list|)
value|REG(CONCAT2(r,N), N, CR16_R_REGTYPE)
name|REG_R
argument_list|(
literal|0
argument_list|)
block|,
name|REG_R
argument_list|(
literal|1
argument_list|)
block|,
name|REG_R
argument_list|(
literal|2
argument_list|)
block|,
name|REG_R
argument_list|(
literal|3
argument_list|)
block|,
name|REG_R
argument_list|(
literal|4
argument_list|)
block|,
name|REG_R
argument_list|(
literal|5
argument_list|)
block|,
name|REG_R
argument_list|(
literal|6
argument_list|)
block|,
name|REG_R
argument_list|(
literal|7
argument_list|)
block|,
name|REG_R
argument_list|(
literal|8
argument_list|)
block|,
name|REG_R
argument_list|(
literal|9
argument_list|)
block|,
name|REG_R
argument_list|(
literal|10
argument_list|)
block|,
name|REG_R
argument_list|(
literal|11
argument_list|)
block|,
name|REG_R
argument_list|(
literal|12
argument_list|)
block|,
name|REG_R
argument_list|(
literal|13
argument_list|)
block|,
name|REG_R
argument_list|(
literal|14
argument_list|)
block|,
name|REG_R
argument_list|(
literal|15
argument_list|)
block|,
name|REG
argument_list|(
name|r12_L
argument_list|,
literal|12
argument_list|,
name|CR16_R_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|r13_L
argument_list|,
literal|13
argument_list|,
name|CR16_R_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|ra
argument_list|,
literal|0xe
argument_list|,
name|CR16_R_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|sp
argument_list|,
literal|0xf
argument_list|,
name|CR16_R_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|sp_L
argument_list|,
literal|0xf
argument_list|,
name|CR16_R_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|RA
argument_list|,
literal|0xe
argument_list|,
name|CR16_R_REGTYPE
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|reg_entry
name|cr16_regptab
index|[]
init|=
block|{
comment|/* Build a general purpose register r<N>.  */
define|#
directive|define
name|REG_RP
parameter_list|(
name|M
parameter_list|,
name|N
parameter_list|)
value|REGP((CONCAT2(r,M),CONCAT2(r,N)), CONCAT2(r,N), N, CR16_RP_REGTYPE)
name|REG_RP
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
block|,
name|REG_RP
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|)
block|,
name|REG_RP
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|)
block|,
name|REG_RP
argument_list|(
literal|4
argument_list|,
literal|3
argument_list|)
block|,
name|REG_RP
argument_list|(
literal|5
argument_list|,
literal|4
argument_list|)
block|,
name|REG_RP
argument_list|(
literal|6
argument_list|,
literal|5
argument_list|)
block|,
name|REG_RP
argument_list|(
literal|7
argument_list|,
literal|6
argument_list|)
block|,
name|REG_RP
argument_list|(
literal|8
argument_list|,
literal|7
argument_list|)
block|,
name|REG_RP
argument_list|(
literal|9
argument_list|,
literal|8
argument_list|)
block|,
name|REG_RP
argument_list|(
literal|10
argument_list|,
literal|9
argument_list|)
block|,
name|REG_RP
argument_list|(
literal|11
argument_list|,
literal|10
argument_list|)
block|,
name|REG_RP
argument_list|(
literal|12
argument_list|,
literal|11
argument_list|)
block|,
name|REG
argument_list|(
operator|(
name|r12
operator|)
argument_list|,
literal|0xc
argument_list|,
name|CR16_RP_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
operator|(
name|r13
operator|)
argument_list|,
literal|0xd
argument_list|,
name|CR16_RP_REGTYPE
argument_list|)
block|,
comment|//REG((r14), 0xe, CR16_RP_REGTYPE),
name|REG
argument_list|(
operator|(
name|ra
operator|)
argument_list|,
literal|0xe
argument_list|,
name|CR16_RP_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
operator|(
name|sp
operator|)
argument_list|,
literal|0xf
argument_list|,
name|CR16_RP_REGTYPE
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|unsigned
name|int
name|cr16_num_regs
init|=
name|ARRAY_SIZE
argument_list|(
name|cr16_regtab
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|unsigned
name|int
name|cr16_num_regps
init|=
name|ARRAY_SIZE
argument_list|(
name|cr16_regptab
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|reg_entry
name|cr16_pregtab
index|[]
init|=
block|{
comment|/* Build a processor register.  */
name|REG
argument_list|(
name|dbs
argument_list|,
literal|0x0
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|dsr
argument_list|,
literal|0x1
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|dcrl
argument_list|,
literal|0x2
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|dcrh
argument_list|,
literal|0x3
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|car0l
argument_list|,
literal|0x4
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|car0h
argument_list|,
literal|0x5
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|car1l
argument_list|,
literal|0x6
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|car1h
argument_list|,
literal|0x7
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|cfg
argument_list|,
literal|0x8
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|psr
argument_list|,
literal|0x9
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|intbasel
argument_list|,
literal|0xa
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|intbaseh
argument_list|,
literal|0xb
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|ispl
argument_list|,
literal|0xc
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|isph
argument_list|,
literal|0xd
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|uspl
argument_list|,
literal|0xe
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|usph
argument_list|,
literal|0xf
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|reg_entry
name|cr16_pregptab
index|[]
init|=
block|{
name|REG
argument_list|(
name|dbs
argument_list|,
literal|0
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|dsr
argument_list|,
literal|1
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|dcr
argument_list|,
literal|2
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|car0
argument_list|,
literal|4
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|car1
argument_list|,
literal|6
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|cfg
argument_list|,
literal|8
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|psr
argument_list|,
literal|9
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|intbase
argument_list|,
literal|10
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|isp
argument_list|,
literal|12
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|,
name|REG
argument_list|(
name|usp
argument_list|,
literal|14
argument_list|,
name|CR16_P_REGTYPE
argument_list|)
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|unsigned
name|int
name|cr16_num_pregs
init|=
name|ARRAY_SIZE
argument_list|(
name|cr16_pregtab
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|unsigned
name|int
name|cr16_num_pregps
init|=
name|ARRAY_SIZE
argument_list|(
name|cr16_pregptab
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|char
modifier|*
name|cr16_b_cond_tab
index|[]
init|=
block|{
literal|"eq"
block|,
literal|"ne"
block|,
literal|"cs"
block|,
literal|"cc"
block|,
literal|"hi"
block|,
literal|"ls"
block|,
literal|"gt"
block|,
literal|"le"
block|,
literal|"fs"
block|,
literal|"fc"
block|,
literal|"lo"
block|,
literal|"hs"
block|,
literal|"lt"
block|,
literal|"ge"
block|,
literal|"r"
block|,
literal|"???"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|unsigned
name|int
name|cr16_num_cc
init|=
name|ARRAY_SIZE
argument_list|(
name|cr16_b_cond_tab
argument_list|)
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* CR16 operands table.  */
end_comment

begin_decl_stmt
specifier|const
name|operand_entry
name|cr16_optab
index|[]
init|=
block|{
comment|/* Index 0 is dummy, so we can count the instruction's operands.  */
block|{
literal|0
block|,
name|nullargs
block|,
literal|0
block|}
block|,
comment|/* dummy */
block|{
literal|3
block|,
name|arg_ic
block|,
name|OP_SIGNED
block|}
block|,
comment|/* imm3 */
block|{
literal|4
block|,
name|arg_ic
block|,
name|OP_SIGNED
block|}
block|,
comment|/* imm4 */
block|{
literal|5
block|,
name|arg_ic
block|,
name|OP_SIGNED
block|}
block|,
comment|/* imm5 */
block|{
literal|6
block|,
name|arg_ic
block|,
name|OP_SIGNED
block|}
block|,
comment|/* imm6 */
block|{
literal|16
block|,
name|arg_ic
block|,
name|OP_SIGNED
block|}
block|,
comment|/* imm16 */
block|{
literal|20
block|,
name|arg_ic
block|,
name|OP_SIGNED
block|}
block|,
comment|/* imm20 */
block|{
literal|32
block|,
name|arg_ic
block|,
name|OP_SIGNED
block|}
block|,
comment|/* imm32 */
block|{
literal|3
block|,
name|arg_ic
block|,
name|OP_UNSIGNED
block|}
block|,
comment|/* uimm3 */
block|{
literal|3
block|,
name|arg_ic
block|,
name|OP_UNSIGNED
operator||
name|OP_DEC
block|}
block|,
comment|/* uimm3_1 */
block|{
literal|4
block|,
name|arg_ic
block|,
name|OP_UNSIGNED
block|}
block|,
comment|/* uimm4 */
block|{
literal|4
block|,
name|arg_ic
block|,
name|OP_UNSIGNED
operator||
name|OP_ESC
block|}
block|,
comment|/* uimm4_1 */
block|{
literal|5
block|,
name|arg_ic
block|,
name|OP_UNSIGNED
block|}
block|,
comment|/* uimm5 */
block|{
literal|16
block|,
name|arg_ic
block|,
name|OP_UNSIGNED
block|}
block|,
comment|/* uimm16 */
block|{
literal|20
block|,
name|arg_ic
block|,
name|OP_UNSIGNED
block|}
block|,
comment|/* uimm20 */
block|{
literal|32
block|,
name|arg_ic
block|,
name|OP_UNSIGNED
block|}
block|,
comment|/* uimm32 */
block|{
literal|5
block|,
name|arg_c
block|,
name|OP_EVEN
operator||
name|OP_SHIFT_DEC
operator||
name|OP_SIGNED
block|}
block|,
comment|/* disps5 */
block|{
literal|16
block|,
name|arg_c
block|,
name|OP_EVEN
operator||
name|OP_UNSIGNED
block|}
block|,
comment|/* disps17 */
block|{
literal|24
block|,
name|arg_c
block|,
name|OP_EVEN
operator||
name|OP_UNSIGNED
block|}
block|,
comment|/* disps25 */
block|{
literal|8
block|,
name|arg_c
block|,
name|OP_EVEN
operator||
name|OP_UNSIGNED
block|}
block|,
comment|/* dispe9 */
block|{
literal|20
block|,
name|arg_c
block|,
name|OP_UNSIGNED
operator||
name|OP_ABS20
block|}
block|,
comment|/* abs20 */
block|{
literal|24
block|,
name|arg_c
block|,
name|OP_UNSIGNED
operator||
name|OP_ABS24
block|}
block|,
comment|/* abs24 */
block|{
literal|4
block|,
name|arg_rp
block|,
literal|0
block|}
block|,
comment|/* rra */
block|{
literal|4
block|,
name|arg_rbase
block|,
literal|0
block|}
block|,
comment|/* rbase */
block|{
literal|20
block|,
name|arg_cr
block|,
name|OP_UNSIGNED
block|}
block|,
comment|/* rbase_disps20 */
block|{
literal|21
block|,
name|arg_cr
block|,
name|OP_NEG
block|}
block|,
comment|/* rbase_dispe20 */
block|{
literal|0
block|,
name|arg_crp
block|,
literal|0
block|}
block|,
comment|/* rpbase_disps0 */
block|{
literal|4
block|,
name|arg_crp
block|,
name|OP_EVEN
operator||
name|OP_SHIFT
operator||
name|OP_UNSIGNED
operator||
name|OP_ESC1
block|}
block|,
comment|/* rpbase_dispe4 */
block|{
literal|4
block|,
name|arg_crp
block|,
name|OP_UNSIGNED
operator||
name|OP_ESC1
block|}
block|,
comment|/* rpbase_disps4 */
block|{
literal|16
block|,
name|arg_crp
block|,
name|OP_UNSIGNED
block|}
block|,
comment|/* rpbase_disps16 */
block|{
literal|20
block|,
name|arg_crp
block|,
name|OP_UNSIGNED
block|}
block|,
comment|/* rpbase_disps20 */
block|{
literal|21
block|,
name|arg_crp
block|,
name|OP_NEG
block|}
block|,
comment|/* rpbase_dispe20 */
block|{
literal|20
block|,
name|arg_idxr
block|,
name|OP_UNSIGNED
block|}
block|,
comment|/* rindex7_abs20  */
block|{
literal|20
block|,
name|arg_idxr
block|,
name|OP_UNSIGNED
block|}
block|,
comment|/* rindex8_abs20  */
block|{
literal|0
block|,
name|arg_idxrp
block|,
name|OP_UNSIGNED
block|}
block|,
comment|/* rpindex_disps0 */
block|{
literal|14
block|,
name|arg_idxrp
block|,
name|OP_UNSIGNED
block|}
block|,
comment|/* rpindex_disps14 */
block|{
literal|20
block|,
name|arg_idxrp
block|,
name|OP_UNSIGNED
block|}
block|,
comment|/* rpindex_disps20 */
block|{
literal|4
block|,
name|arg_r
block|,
literal|0
block|}
block|,
comment|/* regr */
block|{
literal|4
block|,
name|arg_rp
block|,
literal|0
block|}
block|,
comment|/* reg pair */
block|{
literal|4
block|,
name|arg_pr
block|,
literal|0
block|}
block|,
comment|/* proc reg */
block|{
literal|4
block|,
name|arg_prp
block|,
literal|0
block|}
block|,
comment|/* 32 bit proc reg  */
block|{
literal|4
block|,
name|arg_cc
block|,
name|OP_UNSIGNED
block|}
comment|/* cc - code */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* CR16 traps/interrupts.  */
end_comment

begin_decl_stmt
specifier|const
name|trap_entry
name|cr16_traps
index|[]
init|=
block|{
block|{
literal|"svc"
block|,
literal|5
block|}
block|,
block|{
literal|"dvz"
block|,
literal|6
block|}
block|,
block|{
literal|"flg"
block|,
literal|7
block|}
block|,
block|{
literal|"bpt"
block|,
literal|8
block|}
block|,
block|{
literal|"trc"
block|,
literal|9
block|}
block|,
block|{
literal|"und"
block|,
literal|10
block|}
block|,
block|{
literal|"iad"
block|,
literal|12
block|}
block|,
block|{
literal|"dbg"
block|,
literal|14
block|}
block|,
block|{
literal|"ise"
block|,
literal|15
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|const
name|unsigned
name|int
name|cr16_num_traps
init|=
name|ARRAY_SIZE
argument_list|(
name|cr16_traps
argument_list|)
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* CR16 instructions that don't have arguments.  */
end_comment

begin_decl_stmt
specifier|const
name|char
modifier|*
name|cr16_no_op_insn
index|[]
init|=
block|{
literal|"cinv[i]"
block|,
literal|"cinv[i,u]"
block|,
literal|"cinv[d]"
block|,
literal|"cinv[d,u]"
block|,
literal|"cinv[d,i]"
block|,
literal|"cinv[d,i,u]"
block|,
literal|"di"
block|,
literal|"ei"
block|,
literal|"eiwait"
block|,
literal|"nop"
block|,
literal|"retx"
block|,
literal|"wait"
block|,
name|NULL
block|}
decl_stmt|;
end_decl_stmt

end_unit

