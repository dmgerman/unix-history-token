begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* unwind-ia64.c -- utility routines to dump IA-64 unwind info for readelf.    Copyright 2000, 2001 Free Software Foundation, Inc. 	Contributed by David Mosberger-Tang<davidm@hpl.hp.com>  This file is part of GNU Binutils.  This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_include
include|#
directive|include
file|"unwind-ia64.h"
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_if
if|#
directive|if
name|__GNUC__
operator|>=
literal|2
end_if

begin_comment
comment|/* Define BFD64 here, even if our default architecture is 32 bit ELF    as this will allow us to read in and parse 64bit and 32bit ELF files.    Only do this if we belive that the compiler can support a 64 bit    data type.  For now we only rely on GCC being able to do this.  */
end_comment

begin_define
define|#
directive|define
name|BFD64
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|"bfd.h"
end_include

begin_decl_stmt
specifier|static
name|bfd_vma
name|unw_rlen
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|unw_print_brmask
name|PARAMS
argument_list|(
operator|(
name|char
operator|*
operator|,
name|unsigned
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|unw_print_grmask
name|PARAMS
argument_list|(
operator|(
name|char
operator|*
operator|,
name|unsigned
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|unw_print_frmask
name|PARAMS
argument_list|(
operator|(
name|char
operator|*
operator|,
name|unsigned
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|unw_print_abreg
name|PARAMS
argument_list|(
operator|(
name|char
operator|*
operator|,
name|unsigned
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|unw_print_xyreg
name|PARAMS
argument_list|(
operator|(
name|char
operator|*
operator|,
name|unsigned
name|int
operator|,
name|unsigned
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
name|unw_print_brmask
parameter_list|(
name|cp
parameter_list|,
name|mask
parameter_list|)
name|char
modifier|*
name|cp
decl_stmt|;
name|unsigned
name|int
name|mask
decl_stmt|;
block|{
name|int
name|sep
init|=
literal|0
decl_stmt|;
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|mask
operator|&&
operator|(
name|i
operator|<
literal|5
operator|)
condition|;
operator|++
name|i
control|)
block|{
if|if
condition|(
name|mask
operator|&
literal|1
condition|)
block|{
if|if
condition|(
name|sep
condition|)
operator|*
name|cp
operator|++
operator|=
literal|','
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
literal|'b'
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
name|i
operator|+
literal|1
operator|+
literal|'0'
expr_stmt|;
name|sep
operator|=
literal|1
expr_stmt|;
block|}
name|mask
operator|>>=
literal|1
expr_stmt|;
block|}
operator|*
name|cp
operator|=
literal|'\0'
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|unw_print_grmask
parameter_list|(
name|cp
parameter_list|,
name|mask
parameter_list|)
name|char
modifier|*
name|cp
decl_stmt|;
name|unsigned
name|int
name|mask
decl_stmt|;
block|{
name|int
name|sep
init|=
literal|0
decl_stmt|;
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|4
condition|;
operator|++
name|i
control|)
block|{
if|if
condition|(
name|mask
operator|&
literal|1
condition|)
block|{
if|if
condition|(
name|sep
condition|)
operator|*
name|cp
operator|++
operator|=
literal|','
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
literal|'r'
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
name|i
operator|+
literal|4
operator|+
literal|'0'
expr_stmt|;
name|sep
operator|=
literal|1
expr_stmt|;
block|}
name|mask
operator|>>=
literal|1
expr_stmt|;
block|}
operator|*
name|cp
operator|=
literal|'\0'
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|unw_print_frmask
parameter_list|(
name|cp
parameter_list|,
name|mask
parameter_list|)
name|char
modifier|*
name|cp
decl_stmt|;
name|unsigned
name|int
name|mask
decl_stmt|;
block|{
name|int
name|sep
init|=
literal|0
decl_stmt|;
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|20
condition|;
operator|++
name|i
control|)
block|{
if|if
condition|(
name|mask
operator|&
literal|1
condition|)
block|{
if|if
condition|(
name|sep
condition|)
operator|*
name|cp
operator|++
operator|=
literal|','
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
literal|'f'
expr_stmt|;
if|if
condition|(
name|i
operator|<
literal|4
condition|)
operator|*
name|cp
operator|++
operator|=
name|i
operator|+
literal|2
operator|+
literal|'0'
expr_stmt|;
else|else
block|{
operator|*
name|cp
operator|++
operator|=
operator|(
name|i
operator|+
literal|2
operator|)
operator|/
literal|10
operator|+
literal|1
operator|+
literal|'0'
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
operator|(
name|i
operator|+
literal|2
operator|)
operator|%
literal|10
operator|+
literal|'0'
expr_stmt|;
block|}
name|sep
operator|=
literal|1
expr_stmt|;
block|}
name|mask
operator|>>=
literal|1
expr_stmt|;
block|}
operator|*
name|cp
operator|=
literal|'\0'
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|unw_print_abreg
parameter_list|(
name|cp
parameter_list|,
name|abreg
parameter_list|)
name|char
modifier|*
name|cp
decl_stmt|;
name|unsigned
name|int
name|abreg
decl_stmt|;
block|{
specifier|static
specifier|const
name|char
modifier|*
name|special_reg
index|[
literal|16
index|]
init|=
block|{
literal|"pr"
block|,
literal|"psp"
block|,
literal|"@priunat"
block|,
literal|"rp"
block|,
literal|"ar.bsp"
block|,
literal|"ar.bspstore"
block|,
literal|"ar.rnat"
block|,
literal|"ar.unat"
block|,
literal|"ar.fpsr"
block|,
literal|"ar.pfs"
block|,
literal|"ar.lc"
block|,
literal|"Unknown11"
block|,
literal|"Unknown12"
block|,
literal|"Unknown13"
block|,
literal|"Unknown14"
block|,
literal|"Unknown15"
block|}
decl_stmt|;
switch|switch
condition|(
operator|(
name|abreg
operator|>>
literal|5
operator|)
operator|&
literal|0x3
condition|)
block|{
case|case
literal|0
case|:
comment|/* gr */
name|sprintf
argument_list|(
name|cp
argument_list|,
literal|"r%u"
argument_list|,
operator|(
name|abreg
operator|&
literal|0x1f
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|1
case|:
comment|/* fr */
name|sprintf
argument_list|(
name|cp
argument_list|,
literal|"f%u"
argument_list|,
operator|(
name|abreg
operator|&
literal|0x1f
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
comment|/* br */
name|sprintf
argument_list|(
name|cp
argument_list|,
literal|"b%u"
argument_list|,
operator|(
name|abreg
operator|&
literal|0x1f
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|3
case|:
comment|/* special */
name|strcpy
argument_list|(
name|cp
argument_list|,
name|special_reg
index|[
name|abreg
operator|&
literal|0xf
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|unw_print_xyreg
parameter_list|(
name|cp
parameter_list|,
name|x
parameter_list|,
name|ytreg
parameter_list|)
name|char
modifier|*
name|cp
decl_stmt|;
name|unsigned
name|int
name|x
decl_stmt|;
name|unsigned
name|int
name|ytreg
decl_stmt|;
block|{
switch|switch
condition|(
operator|(
name|x
operator|<<
literal|1
operator|)
operator||
operator|(
operator|(
name|ytreg
operator|>>
literal|7
operator|)
operator|&
literal|1
operator|)
condition|)
block|{
case|case
literal|0
case|:
comment|/* gr */
name|sprintf
argument_list|(
name|cp
argument_list|,
literal|"r%u"
argument_list|,
operator|(
name|ytreg
operator|&
literal|0x1f
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|1
case|:
comment|/* fr */
name|sprintf
argument_list|(
name|cp
argument_list|,
literal|"f%u"
argument_list|,
operator|(
name|ytreg
operator|&
literal|0x1f
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
comment|/* br */
name|sprintf
argument_list|(
name|cp
argument_list|,
literal|"b%u"
argument_list|,
operator|(
name|ytreg
operator|&
literal|0x1f
operator|)
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
end_function

begin_define
define|#
directive|define
name|UNW_REG_BSP
value|"bsp"
end_define

begin_define
define|#
directive|define
name|UNW_REG_BSPSTORE
value|"bspstore"
end_define

begin_define
define|#
directive|define
name|UNW_REG_FPSR
value|"fpsr"
end_define

begin_define
define|#
directive|define
name|UNW_REG_LC
value|"lc"
end_define

begin_define
define|#
directive|define
name|UNW_REG_PFS
value|"pfs"
end_define

begin_define
define|#
directive|define
name|UNW_REG_PR
value|"pr"
end_define

begin_define
define|#
directive|define
name|UNW_REG_PSP
value|"psp"
end_define

begin_define
define|#
directive|define
name|UNW_REG_RNAT
value|"rnat"
end_define

begin_define
define|#
directive|define
name|UNW_REG_RP
value|"rp"
end_define

begin_define
define|#
directive|define
name|UNW_REG_UNAT
value|"unat"
end_define

begin_typedef
typedef|typedef
name|bfd_vma
name|unw_word
typedef|;
end_typedef

begin_define
define|#
directive|define
name|UNW_DEC_BAD_CODE
parameter_list|(
name|code
parameter_list|)
define|\
value|printf ("Unknown code 0x%02x\n", code)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_PROLOGUE
parameter_list|(
name|fmt
parameter_list|,
name|body
parameter_list|,
name|rlen
parameter_list|,
name|arg
parameter_list|)
define|\
value|do										\     {										\       unw_rlen = rlen;								\       *(int *)arg = body;							\       printf ("    %s:%s(rlen=%lu)\n",						\ 	      fmt, body ? "body" : "prologue", (unsigned long) rlen);		\     }										\   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_PROLOGUE_GR
parameter_list|(
name|fmt
parameter_list|,
name|rlen
parameter_list|,
name|mask
parameter_list|,
name|grsave
parameter_list|,
name|arg
parameter_list|)
define|\
value|do										\     {										\       char regname[16], maskstr[64], *sep;					\ 										\       unw_rlen = rlen;								\       *(int *)arg = 0;								\ 										\       maskstr[0] = '\0';							\       sep = "";									\       if (mask& 0x8)								\ 	{									\ 	  strcat (maskstr, "rp");						\ 	  sep = ",";								\ 	}									\       if (mask& 0x4)								\ 	{									\ 	  strcat (maskstr, sep);						\ 	  strcat (maskstr, "ar.pfs");						\ 	  sep = ",";								\ 	}									\       if (mask& 0x2)								\ 	{									\ 	  strcat (maskstr, sep);						\ 	  strcat (maskstr, "psp");						\ 	  sep = ",";								\ 	}									\       if (mask& 0x1)								\ 	{									\ 	  strcat (maskstr, sep);						\ 	  strcat (maskstr, "pr");						\ 	}									\       sprintf (regname, "r%u", grsave);						\       printf ("    %s:prologue_gr(mask=[%s],grsave=%s,rlen=%lu)\n",		\ 	      fmt, maskstr, regname, (unsigned long) rlen);			\     }										\   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_FR_MEM
parameter_list|(
name|fmt
parameter_list|,
name|frmask
parameter_list|,
name|arg
parameter_list|)
define|\
value|do								\     {								\       char frstr[200];						\ 								\       unw_print_frmask (frstr, frmask);				\       printf ("\t%s:fr_mem(frmask=[%s])\n", fmt, frstr);	\     }								\   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_GR_MEM
parameter_list|(
name|fmt
parameter_list|,
name|grmask
parameter_list|,
name|arg
parameter_list|)
define|\
value|do								\     {								\       char grstr[200];						\ 								\       unw_print_grmask (grstr, grmask);				\       printf ("\t%s:gr_mem(grmask=[%s])\n", fmt, grstr);	\     }								\   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_FRGR_MEM
parameter_list|(
name|fmt
parameter_list|,
name|grmask
parameter_list|,
name|frmask
parameter_list|,
name|arg
parameter_list|)
define|\
value|do										\     {									     	\       char frstr[200], grstr[20];						\ 									     	\       unw_print_grmask (grstr, grmask);					     	\       unw_print_frmask (frstr, frmask);					     	\       printf ("\t%s:frgr_mem(grmask=[%s],frmask=[%s])\n", fmt, grstr, frstr);	\     }										\   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_BR_MEM
parameter_list|(
name|fmt
parameter_list|,
name|brmask
parameter_list|,
name|arg
parameter_list|)
define|\
value|do									\     {									\       char brstr[20];							\ 									\       unw_print_brmask (brstr, brmask);					\       printf ("\t%s:br_mem(brmask=[%s])\n", fmt, brstr);		\     }									\   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_BR_GR
parameter_list|(
name|fmt
parameter_list|,
name|brmask
parameter_list|,
name|gr
parameter_list|,
name|arg
parameter_list|)
define|\
value|do									\     {									\       char brstr[20];							\ 									\       unw_print_brmask (brstr, brmask);					\       printf ("\t%s:br_gr(brmask=[%s],gr=r%u)\n", fmt, brstr, gr);	\     }									\   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_REG_GR
parameter_list|(
name|fmt
parameter_list|,
name|src
parameter_list|,
name|dst
parameter_list|,
name|arg
parameter_list|)
define|\
value|printf ("\t%s:%s_gr(reg=r%u)\n", fmt, src, dst)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_RP_BR
parameter_list|(
name|fmt
parameter_list|,
name|dst
parameter_list|,
name|arg
parameter_list|)
define|\
value|printf ("\t%s:rp_br(reg=b%u)\n", fmt, dst)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_REG_WHEN
parameter_list|(
name|fmt
parameter_list|,
name|reg
parameter_list|,
name|t
parameter_list|,
name|arg
parameter_list|)
define|\
value|printf ("\t%s:%s_when(t=%lu)\n", fmt, reg, (unsigned long) t)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_REG_SPREL
parameter_list|(
name|fmt
parameter_list|,
name|reg
parameter_list|,
name|spoff
parameter_list|,
name|arg
parameter_list|)
define|\
value|printf ("\t%s:%s_sprel(spoff=0x%lx)\n",		\ 	  fmt, reg, 4*(unsigned long)spoff)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_REG_PSPREL
parameter_list|(
name|fmt
parameter_list|,
name|reg
parameter_list|,
name|pspoff
parameter_list|,
name|arg
parameter_list|)
define|\
value|printf ("\t%s:%s_psprel(pspoff=0x10-0x%lx)\n",		\ 	  fmt, reg, 4*(unsigned long)pspoff)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_GR_GR
parameter_list|(
name|fmt
parameter_list|,
name|grmask
parameter_list|,
name|gr
parameter_list|,
name|arg
parameter_list|)
define|\
value|do									\     {									\       char grstr[20];							\ 									\       unw_print_grmask (grstr, grmask);					\       printf ("\t%s:gr_gr(grmask=[%s],r%u)\n", fmt, grstr, gr);		\     }									\   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_ABI
parameter_list|(
name|fmt
parameter_list|,
name|abi
parameter_list|,
name|context
parameter_list|,
name|arg
parameter_list|)
define|\
value|do								\     {								\       static const char *abiname[] =				\       {								\ 	"@svr4", "@hpux", "@nt"					\       };							\       char buf[20];						\       const char *abistr = buf;					\ 								\       if (abi< 3)						\ 	abistr = abiname[abi];					\       else							\ 	sprintf (buf, "0x%x", abi);				\       printf ("\t%s:unwabi(abi=%s,context=0x%02x)\n",		\ 	      fmt, abistr, context);				\     }								\   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_PRIUNAT_GR
parameter_list|(
name|fmt
parameter_list|,
name|r
parameter_list|,
name|arg
parameter_list|)
define|\
value|printf ("\t%s:priunat_gr(reg=r%u)\n", fmt, r)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_PRIUNAT_WHEN_GR
parameter_list|(
name|fmt
parameter_list|,
name|t
parameter_list|,
name|arg
parameter_list|)
define|\
value|printf ("\t%s:priunat_when_gr(t=%lu)\n", fmt, (unsigned long) t)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_PRIUNAT_WHEN_MEM
parameter_list|(
name|fmt
parameter_list|,
name|t
parameter_list|,
name|arg
parameter_list|)
define|\
value|printf ("\t%s:priunat_when_mem(t=%lu)\n", fmt, (unsigned long) t)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_PRIUNAT_PSPREL
parameter_list|(
name|fmt
parameter_list|,
name|pspoff
parameter_list|,
name|arg
parameter_list|)
define|\
value|printf ("\t%s:priunat_psprel(pspoff=0x10-0x%lx)\n",		\ 	  fmt, 4*(unsigned long)pspoff)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_PRIUNAT_SPREL
parameter_list|(
name|fmt
parameter_list|,
name|spoff
parameter_list|,
name|arg
parameter_list|)
define|\
value|printf ("\t%s:priunat_sprel(spoff=0x%lx)\n",		\ 	  fmt, 4*(unsigned long)spoff)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_MEM_STACK_F
parameter_list|(
name|fmt
parameter_list|,
name|t
parameter_list|,
name|size
parameter_list|,
name|arg
parameter_list|)
define|\
value|printf ("\t%s:mem_stack_f(t=%lu,size=%lu)\n",		\ 	  fmt, (unsigned long) t, 16*(unsigned long)size)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_MEM_STACK_V
parameter_list|(
name|fmt
parameter_list|,
name|t
parameter_list|,
name|arg
parameter_list|)
define|\
value|printf ("\t%s:mem_stack_v(t=%lu)\n", fmt, (unsigned long) t)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_SPILL_BASE
parameter_list|(
name|fmt
parameter_list|,
name|pspoff
parameter_list|,
name|arg
parameter_list|)
define|\
value|printf ("\t%s:spill_base(pspoff=0x10-0x%lx)\n",		\ 	  fmt, 4*(unsigned long)pspoff)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_SPILL_MASK
parameter_list|(
name|fmt
parameter_list|,
name|dp
parameter_list|,
name|arg
parameter_list|)
define|\
value|do										\     {										\       static const char * spill_type = "-frb";					\       unsigned const char * imaskp = dp;					\       unsigned char mask = 0;							\       bfd_vma insn = 0;								\ 										\       printf ("\t%s:spill_mask(imask=[", fmt);					\       for (insn = 0; insn< unw_rlen; ++insn)					\ 	{									\ 	  if ((insn % 4) == 0)							\ 	    mask = *imaskp++;							\ 	  if (insn> 0&& (insn % 3) == 0)					\ 	    putchar (',');							\ 	  putchar (spill_type[(mask>> (2 * (3 - (insn& 0x3))))& 0x3]);	\ 	}									\       printf ("])\n");								\       dp = imaskp;								\     }										\   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_SPILL_SPREL
parameter_list|(
name|fmt
parameter_list|,
name|t
parameter_list|,
name|abreg
parameter_list|,
name|spoff
parameter_list|,
name|arg
parameter_list|)
define|\
value|do										\     {										\       char regname[10];								\ 										\       unw_print_abreg (regname, abreg);						\       printf ("\t%s:spill_sprel(reg=%s,t=%lu,spoff=0x%lx)\n",			\ 	      fmt, regname, (unsigned long) t, 4*(unsigned long)off);		\     }										\   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_SPILL_PSPREL
parameter_list|(
name|fmt
parameter_list|,
name|t
parameter_list|,
name|abreg
parameter_list|,
name|pspoff
parameter_list|,
name|arg
parameter_list|)
define|\
value|do										\     {									 	\       char regname[10];							 	\ 									 	\       unw_print_abreg (regname, abreg);					 	\       printf ("\t%s:spill_psprel(reg=%s,t=%lu,pspoff=0x10-0x%lx)\n", 		\ 	      fmt, regname, (unsigned long) t, 4*(unsigned long)pspoff);	\     }										\   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_RESTORE
parameter_list|(
name|fmt
parameter_list|,
name|t
parameter_list|,
name|abreg
parameter_list|,
name|arg
parameter_list|)
define|\
value|do								\     {								\       char regname[10];						\ 								\       unw_print_abreg (regname, abreg);				\       printf ("\t%s:restore(t=%lu,reg=%s)\n",			\ 	      fmt, (unsigned long) t, regname);			\     }								\   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_SPILL_REG
parameter_list|(
name|fmt
parameter_list|,
name|t
parameter_list|,
name|abreg
parameter_list|,
name|x
parameter_list|,
name|ytreg
parameter_list|,
name|arg
parameter_list|)
define|\
value|do								\     {								\       char abregname[10], tregname[10];				\ 								\       unw_print_abreg (abregname, abreg);			\       unw_print_xyreg (tregname, x, ytreg);			\       printf ("\t%s:spill_reg(t=%lu,reg=%s,treg=%s)\n",		\ 	      fmt, (unsigned long) t, abregname, tregname);	\     }								\   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_SPILL_SPREL_P
parameter_list|(
name|fmt
parameter_list|,
name|qp
parameter_list|,
name|t
parameter_list|,
name|abreg
parameter_list|,
name|spoff
parameter_list|,
name|arg
parameter_list|)
define|\
value|do										    \     {									   	    \       char regname[20];							   	    \ 									   	    \       unw_print_abreg (regname, abreg);					   	    \       printf ("\t%s:spill_sprel_p(qp=p%u,t=%lu,reg=%s,spoff=0x%lx)\n",		    \ 	      fmt, qp, (unsigned long) t, regname, 4 * (unsigned long)spoff);	    \     }										    \   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_SPILL_PSPREL_P
parameter_list|(
name|fmt
parameter_list|,
name|qp
parameter_list|,
name|t
parameter_list|,
name|abreg
parameter_list|,
name|pspoff
parameter_list|,
name|arg
parameter_list|)
define|\
value|do									\     {									\       char regname[20];							\ 									\       unw_print_abreg (regname, abreg);					\       printf ("\t%s:spill_psprel_p(qp=p%u,t=%lu,reg=%s,pspoff=0x10-0x%lx)\n",\ 	      fmt, qp, (unsigned long) t, regname, 4*(unsigned long)pspoff);\     }									\   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_RESTORE_P
parameter_list|(
name|fmt
parameter_list|,
name|qp
parameter_list|,
name|t
parameter_list|,
name|abreg
parameter_list|,
name|arg
parameter_list|)
define|\
value|do									\     {									\       char regname[20];							\ 									\       unw_print_abreg (regname, abreg);					\       printf ("\t%s:restore_p(qp=p%u,t=%lu,reg=%s)\n",			\ 	      fmt, qp, (unsigned long) t, regname);			\     }									\   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_SPILL_REG_P
parameter_list|(
name|fmt
parameter_list|,
name|qp
parameter_list|,
name|t
parameter_list|,
name|abreg
parameter_list|,
name|x
parameter_list|,
name|ytreg
parameter_list|,
name|arg
parameter_list|)
define|\
value|do									\     {									\       char regname[20], tregname[20];					\ 									\       unw_print_abreg (regname, abreg);					\       unw_print_xyreg (tregname, x, ytreg);				\       printf ("\t%s:spill_reg_p(qp=p%u,t=%lu,reg=%s,treg=%s)\n",	\ 	      fmt, qp, (unsigned long) t, regname, tregname);		\     }									\   while (0)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_LABEL_STATE
parameter_list|(
name|fmt
parameter_list|,
name|label
parameter_list|,
name|arg
parameter_list|)
define|\
value|printf ("\t%s:label_state(label=%lu)\n", fmt, (unsigned long) label)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_COPY_STATE
parameter_list|(
name|fmt
parameter_list|,
name|label
parameter_list|,
name|arg
parameter_list|)
define|\
value|printf ("\t%s:copy_state(label=%lu)\n", fmt, (unsigned long) label)
end_define

begin_define
define|#
directive|define
name|UNW_DEC_EPILOGUE
parameter_list|(
name|fmt
parameter_list|,
name|t
parameter_list|,
name|ecount
parameter_list|,
name|arg
parameter_list|)
define|\
value|printf ("\t%s:epilogue(t=%lu,ecount=%lu)\n",		\ 	  fmt, (unsigned long) t, (unsigned long) ecount)
end_define

begin_comment
comment|/*  * Generic IA-64 unwind info decoder.  *  * This file is used both by the Linux kernel and objdump.  Please  * keep the two copies of this file in sync (modulo differences in the  * prototypes...).  *  * You need to customize the decoder by defining the following  * macros/constants before including this file:  *  *  Types:  *	unw_word	Unsigned integer type with at least 64 bits  *  *  Register names:  *	UNW_REG_BSP  *	UNW_REG_BSPSTORE  *	UNW_REG_FPSR  *	UNW_REG_LC  *	UNW_REG_PFS  *	UNW_REG_PR  *	UNW_REG_RNAT  *	UNW_REG_PSP  *	UNW_REG_RP  *	UNW_REG_UNAT  *  *  Decoder action macros:  *	UNW_DEC_BAD_CODE(code)  *	UNW_DEC_ABI(fmt,abi,context,arg)  *	UNW_DEC_BR_GR(fmt,brmask,gr,arg)  *	UNW_DEC_BR_MEM(fmt,brmask,arg)  *	UNW_DEC_COPY_STATE(fmt,label,arg)  *	UNW_DEC_EPILOGUE(fmt,t,ecount,arg)  *	UNW_DEC_FRGR_MEM(fmt,grmask,frmask,arg)  *	UNW_DEC_FR_MEM(fmt,frmask,arg)  *	UNW_DEC_GR_GR(fmt,grmask,gr,arg)  *	UNW_DEC_GR_MEM(fmt,grmask,arg)  *	UNW_DEC_LABEL_STATE(fmt,label,arg)  *	UNW_DEC_MEM_STACK_F(fmt,t,size,arg)  *	UNW_DEC_MEM_STACK_V(fmt,t,arg)  *	UNW_DEC_PRIUNAT_GR(fmt,r,arg)  *	UNW_DEC_PRIUNAT_WHEN_GR(fmt,t,arg)  *	UNW_DEC_PRIUNAT_WHEN_MEM(fmt,t,arg)  *	UNW_DEC_PRIUNAT_WHEN_PSPREL(fmt,pspoff,arg)  *	UNW_DEC_PRIUNAT_WHEN_SPREL(fmt,spoff,arg)  *	UNW_DEC_PROLOGUE(fmt,body,rlen,arg)  *	UNW_DEC_PROLOGUE_GR(fmt,rlen,mask,grsave,arg)  *	UNW_DEC_REG_PSPREL(fmt,reg,pspoff,arg)  *	UNW_DEC_REG_REG(fmt,src,dst,arg)  *	UNW_DEC_REG_SPREL(fmt,reg,spoff,arg)  *	UNW_DEC_REG_WHEN(fmt,reg,t,arg)  *	UNW_DEC_RESTORE(fmt,t,abreg,arg)  *	UNW_DEC_RESTORE_P(fmt,qp,t,abreg,arg)  *	UNW_DEC_SPILL_BASE(fmt,pspoff,arg)  *	UNW_DEC_SPILL_MASK(fmt,imaskp,arg)  *	UNW_DEC_SPILL_PSPREL(fmt,t,abreg,pspoff,arg)  *	UNW_DEC_SPILL_PSPREL_P(fmt,qp,t,abreg,pspoff,arg)  *	UNW_DEC_SPILL_REG(fmt,t,abreg,x,ytreg,arg)  *	UNW_DEC_SPILL_REG_P(fmt,qp,t,abreg,x,ytreg,arg)  *	UNW_DEC_SPILL_SPREL(fmt,t,abreg,spoff,arg)  *	UNW_DEC_SPILL_SPREL_P(fmt,qp,t,abreg,pspoff,arg)  */
end_comment

begin_decl_stmt
specifier|static
name|unw_word
name|unw_decode_uleb128
name|PARAMS
argument_list|(
operator|(
specifier|const
name|unsigned
name|char
operator|*
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_x1
name|PARAMS
argument_list|(
operator|(
specifier|const
name|unsigned
name|char
operator|*
operator|,
name|unsigned
name|int
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_x2
name|PARAMS
argument_list|(
operator|(
specifier|const
name|unsigned
name|char
operator|*
operator|,
name|unsigned
name|int
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_x3
name|PARAMS
argument_list|(
operator|(
specifier|const
name|unsigned
name|char
operator|*
operator|,
name|unsigned
name|int
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_x4
name|PARAMS
argument_list|(
operator|(
specifier|const
name|unsigned
name|char
operator|*
operator|,
name|unsigned
name|int
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_r1
name|PARAMS
argument_list|(
operator|(
specifier|const
name|unsigned
name|char
operator|*
operator|,
name|unsigned
name|int
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_r2
name|PARAMS
argument_list|(
operator|(
specifier|const
name|unsigned
name|char
operator|*
operator|,
name|unsigned
name|int
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_r3
name|PARAMS
argument_list|(
operator|(
specifier|const
name|unsigned
name|char
operator|*
operator|,
name|unsigned
name|int
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_p1
name|PARAMS
argument_list|(
operator|(
specifier|const
name|unsigned
name|char
operator|*
operator|,
name|unsigned
name|int
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_p2_p5
name|PARAMS
argument_list|(
operator|(
specifier|const
name|unsigned
name|char
operator|*
operator|,
name|unsigned
name|int
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_p6
name|PARAMS
argument_list|(
operator|(
specifier|const
name|unsigned
name|char
operator|*
operator|,
name|unsigned
name|int
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_p7_p10
name|PARAMS
argument_list|(
operator|(
specifier|const
name|unsigned
name|char
operator|*
operator|,
name|unsigned
name|int
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_b1
name|PARAMS
argument_list|(
operator|(
specifier|const
name|unsigned
name|char
operator|*
operator|,
name|unsigned
name|int
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_b2
name|PARAMS
argument_list|(
operator|(
specifier|const
name|unsigned
name|char
operator|*
operator|,
name|unsigned
name|int
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_b3_x4
name|PARAMS
argument_list|(
operator|(
specifier|const
name|unsigned
name|char
operator|*
operator|,
name|unsigned
name|int
operator|,
name|void
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|unw_word
name|unw_decode_uleb128
parameter_list|(
name|dpp
parameter_list|)
specifier|const
name|unsigned
name|char
modifier|*
modifier|*
name|dpp
decl_stmt|;
block|{
name|unsigned
name|shift
init|=
literal|0
decl_stmt|;
name|unw_word
name|byte
decl_stmt|,
name|result
init|=
literal|0
decl_stmt|;
specifier|const
name|unsigned
name|char
modifier|*
name|bp
init|=
operator|*
name|dpp
decl_stmt|;
while|while
condition|(
literal|1
condition|)
block|{
name|byte
operator|=
operator|*
name|bp
operator|++
expr_stmt|;
name|result
operator||=
operator|(
name|byte
operator|&
literal|0x7f
operator|)
operator|<<
name|shift
expr_stmt|;
if|if
condition|(
operator|(
name|byte
operator|&
literal|0x80
operator|)
operator|==
literal|0
condition|)
break|break;
name|shift
operator|+=
literal|7
expr_stmt|;
block|}
operator|*
name|dpp
operator|=
name|bp
expr_stmt|;
return|return
name|result
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_x1
parameter_list|(
name|dp
parameter_list|,
name|code
parameter_list|,
name|arg
parameter_list|)
specifier|const
name|unsigned
name|char
modifier|*
name|dp
decl_stmt|;
name|unsigned
name|int
name|code
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|void
modifier|*
name|arg
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|unsigned
name|char
name|byte1
decl_stmt|,
name|abreg
decl_stmt|;
name|unw_word
name|t
decl_stmt|,
name|off
decl_stmt|;
name|byte1
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|t
operator|=
name|unw_decode_uleb128
argument_list|(
operator|&
name|dp
argument_list|)
expr_stmt|;
name|off
operator|=
name|unw_decode_uleb128
argument_list|(
operator|&
name|dp
argument_list|)
expr_stmt|;
name|abreg
operator|=
operator|(
name|byte1
operator|&
literal|0x7f
operator|)
expr_stmt|;
if|if
condition|(
name|byte1
operator|&
literal|0x80
condition|)
name|UNW_DEC_SPILL_SPREL
argument_list|(
literal|"X1"
argument_list|,
name|t
argument_list|,
name|abreg
argument_list|,
name|off
argument_list|,
name|arg
argument_list|)
expr_stmt|;
else|else
name|UNW_DEC_SPILL_PSPREL
argument_list|(
literal|"X1"
argument_list|,
name|t
argument_list|,
name|abreg
argument_list|,
name|off
argument_list|,
name|arg
argument_list|)
expr_stmt|;
return|return
name|dp
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_x2
parameter_list|(
name|dp
parameter_list|,
name|code
parameter_list|,
name|arg
parameter_list|)
specifier|const
name|unsigned
name|char
modifier|*
name|dp
decl_stmt|;
name|unsigned
name|int
name|code
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|void
modifier|*
name|arg
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|unsigned
name|char
name|byte1
decl_stmt|,
name|byte2
decl_stmt|,
name|abreg
decl_stmt|,
name|x
decl_stmt|,
name|ytreg
decl_stmt|;
name|unw_word
name|t
decl_stmt|;
name|byte1
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|byte2
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|t
operator|=
name|unw_decode_uleb128
argument_list|(
operator|&
name|dp
argument_list|)
expr_stmt|;
name|abreg
operator|=
operator|(
name|byte1
operator|&
literal|0x7f
operator|)
expr_stmt|;
name|ytreg
operator|=
name|byte2
expr_stmt|;
name|x
operator|=
operator|(
name|byte1
operator|>>
literal|7
operator|)
operator|&
literal|1
expr_stmt|;
if|if
condition|(
operator|(
name|byte1
operator|&
literal|0x80
operator|)
operator|==
literal|0
operator|&&
name|ytreg
operator|==
literal|0
condition|)
name|UNW_DEC_RESTORE
argument_list|(
literal|"X2"
argument_list|,
name|t
argument_list|,
name|abreg
argument_list|,
name|arg
argument_list|)
expr_stmt|;
else|else
name|UNW_DEC_SPILL_REG
argument_list|(
literal|"X2"
argument_list|,
name|t
argument_list|,
name|abreg
argument_list|,
name|x
argument_list|,
name|ytreg
argument_list|,
name|arg
argument_list|)
expr_stmt|;
return|return
name|dp
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_x3
parameter_list|(
name|dp
parameter_list|,
name|code
parameter_list|,
name|arg
parameter_list|)
specifier|const
name|unsigned
name|char
modifier|*
name|dp
decl_stmt|;
name|unsigned
name|int
name|code
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|void
modifier|*
name|arg
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|unsigned
name|char
name|byte1
decl_stmt|,
name|byte2
decl_stmt|,
name|abreg
decl_stmt|,
name|qp
decl_stmt|;
name|unw_word
name|t
decl_stmt|,
name|off
decl_stmt|;
name|byte1
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|byte2
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|t
operator|=
name|unw_decode_uleb128
argument_list|(
operator|&
name|dp
argument_list|)
expr_stmt|;
name|off
operator|=
name|unw_decode_uleb128
argument_list|(
operator|&
name|dp
argument_list|)
expr_stmt|;
name|qp
operator|=
operator|(
name|byte1
operator|&
literal|0x3f
operator|)
expr_stmt|;
name|abreg
operator|=
operator|(
name|byte2
operator|&
literal|0x7f
operator|)
expr_stmt|;
if|if
condition|(
name|byte1
operator|&
literal|0x80
condition|)
name|UNW_DEC_SPILL_SPREL_P
argument_list|(
literal|"X3"
argument_list|,
name|qp
argument_list|,
name|t
argument_list|,
name|abreg
argument_list|,
name|off
argument_list|,
name|arg
argument_list|)
expr_stmt|;
else|else
name|UNW_DEC_SPILL_PSPREL_P
argument_list|(
literal|"X3"
argument_list|,
name|qp
argument_list|,
name|t
argument_list|,
name|abreg
argument_list|,
name|off
argument_list|,
name|arg
argument_list|)
expr_stmt|;
return|return
name|dp
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_x4
parameter_list|(
name|dp
parameter_list|,
name|code
parameter_list|,
name|arg
parameter_list|)
specifier|const
name|unsigned
name|char
modifier|*
name|dp
decl_stmt|;
name|unsigned
name|int
name|code
name|ATTRIBUTE_UNUSED
decl_stmt|;
name|void
modifier|*
name|arg
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|unsigned
name|char
name|byte1
decl_stmt|,
name|byte2
decl_stmt|,
name|byte3
decl_stmt|,
name|qp
decl_stmt|,
name|abreg
decl_stmt|,
name|x
decl_stmt|,
name|ytreg
decl_stmt|;
name|unw_word
name|t
decl_stmt|;
name|byte1
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|byte2
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|byte3
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|t
operator|=
name|unw_decode_uleb128
argument_list|(
operator|&
name|dp
argument_list|)
expr_stmt|;
name|qp
operator|=
operator|(
name|byte1
operator|&
literal|0x3f
operator|)
expr_stmt|;
name|abreg
operator|=
operator|(
name|byte2
operator|&
literal|0x7f
operator|)
expr_stmt|;
name|x
operator|=
operator|(
name|byte2
operator|>>
literal|7
operator|)
operator|&
literal|1
expr_stmt|;
name|ytreg
operator|=
name|byte3
expr_stmt|;
if|if
condition|(
operator|(
name|byte2
operator|&
literal|0x80
operator|)
operator|==
literal|0
operator|&&
name|byte3
operator|==
literal|0
condition|)
name|UNW_DEC_RESTORE_P
argument_list|(
literal|"X4"
argument_list|,
name|qp
argument_list|,
name|t
argument_list|,
name|abreg
argument_list|,
name|arg
argument_list|)
expr_stmt|;
else|else
name|UNW_DEC_SPILL_REG_P
argument_list|(
literal|"X4"
argument_list|,
name|qp
argument_list|,
name|t
argument_list|,
name|abreg
argument_list|,
name|x
argument_list|,
name|ytreg
argument_list|,
name|arg
argument_list|)
expr_stmt|;
return|return
name|dp
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_r1
parameter_list|(
name|dp
parameter_list|,
name|code
parameter_list|,
name|arg
parameter_list|)
specifier|const
name|unsigned
name|char
modifier|*
name|dp
decl_stmt|;
name|unsigned
name|int
name|code
decl_stmt|;
name|void
modifier|*
name|arg
decl_stmt|;
block|{
name|int
name|body
init|=
operator|(
name|code
operator|&
literal|0x20
operator|)
operator|!=
literal|0
decl_stmt|;
name|unw_word
name|rlen
decl_stmt|;
name|rlen
operator|=
operator|(
name|code
operator|&
literal|0x1f
operator|)
expr_stmt|;
name|UNW_DEC_PROLOGUE
argument_list|(
literal|"R1"
argument_list|,
name|body
argument_list|,
name|rlen
argument_list|,
name|arg
argument_list|)
expr_stmt|;
return|return
name|dp
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_r2
parameter_list|(
name|dp
parameter_list|,
name|code
parameter_list|,
name|arg
parameter_list|)
specifier|const
name|unsigned
name|char
modifier|*
name|dp
decl_stmt|;
name|unsigned
name|int
name|code
decl_stmt|;
name|void
modifier|*
name|arg
decl_stmt|;
block|{
name|unsigned
name|char
name|byte1
decl_stmt|,
name|mask
decl_stmt|,
name|grsave
decl_stmt|;
name|unw_word
name|rlen
decl_stmt|;
name|byte1
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|mask
operator|=
operator|(
operator|(
name|code
operator|&
literal|0x7
operator|)
operator|<<
literal|1
operator|)
operator||
operator|(
operator|(
name|byte1
operator|>>
literal|7
operator|)
operator|&
literal|1
operator|)
expr_stmt|;
name|grsave
operator|=
operator|(
name|byte1
operator|&
literal|0x7f
operator|)
expr_stmt|;
name|rlen
operator|=
name|unw_decode_uleb128
argument_list|(
operator|&
name|dp
argument_list|)
expr_stmt|;
name|UNW_DEC_PROLOGUE_GR
argument_list|(
literal|"R2"
argument_list|,
name|rlen
argument_list|,
name|mask
argument_list|,
name|grsave
argument_list|,
name|arg
argument_list|)
expr_stmt|;
return|return
name|dp
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_r3
parameter_list|(
name|dp
parameter_list|,
name|code
parameter_list|,
name|arg
parameter_list|)
specifier|const
name|unsigned
name|char
modifier|*
name|dp
decl_stmt|;
name|unsigned
name|int
name|code
decl_stmt|;
name|void
modifier|*
name|arg
decl_stmt|;
block|{
name|unw_word
name|rlen
decl_stmt|;
name|rlen
operator|=
name|unw_decode_uleb128
argument_list|(
operator|&
name|dp
argument_list|)
expr_stmt|;
name|UNW_DEC_PROLOGUE
argument_list|(
literal|"R3"
argument_list|,
operator|(
operator|(
name|code
operator|&
literal|0x3
operator|)
operator|==
literal|1
operator|)
argument_list|,
name|rlen
argument_list|,
name|arg
argument_list|)
expr_stmt|;
return|return
name|dp
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_p1
parameter_list|(
name|dp
parameter_list|,
name|code
parameter_list|,
name|arg
parameter_list|)
specifier|const
name|unsigned
name|char
modifier|*
name|dp
decl_stmt|;
name|unsigned
name|int
name|code
decl_stmt|;
name|void
modifier|*
name|arg
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|unsigned
name|char
name|brmask
init|=
operator|(
name|code
operator|&
literal|0x1f
operator|)
decl_stmt|;
name|UNW_DEC_BR_MEM
argument_list|(
literal|"P1"
argument_list|,
name|brmask
argument_list|,
name|arg
argument_list|)
expr_stmt|;
return|return
name|dp
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_p2_p5
parameter_list|(
name|dp
parameter_list|,
name|code
parameter_list|,
name|arg
parameter_list|)
specifier|const
name|unsigned
name|char
modifier|*
name|dp
decl_stmt|;
name|unsigned
name|int
name|code
decl_stmt|;
name|void
modifier|*
name|arg
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
if|if
condition|(
operator|(
name|code
operator|&
literal|0x10
operator|)
operator|==
literal|0
condition|)
block|{
name|unsigned
name|char
name|byte1
init|=
operator|*
name|dp
operator|++
decl_stmt|;
name|UNW_DEC_BR_GR
argument_list|(
literal|"P2"
argument_list|,
operator|(
operator|(
name|code
operator|&
literal|0xf
operator|)
operator|<<
literal|1
operator|)
operator||
operator|(
operator|(
name|byte1
operator|>>
literal|7
operator|)
operator|&
literal|1
operator|)
argument_list|,
operator|(
name|byte1
operator|&
literal|0x7f
operator|)
argument_list|,
name|arg
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|(
name|code
operator|&
literal|0x08
operator|)
operator|==
literal|0
condition|)
block|{
name|unsigned
name|char
name|byte1
init|=
operator|*
name|dp
operator|++
decl_stmt|,
name|r
decl_stmt|,
name|dst
decl_stmt|;
name|r
operator|=
operator|(
operator|(
name|code
operator|&
literal|0x7
operator|)
operator|<<
literal|1
operator|)
operator||
operator|(
operator|(
name|byte1
operator|>>
literal|7
operator|)
operator|&
literal|1
operator|)
expr_stmt|;
name|dst
operator|=
operator|(
name|byte1
operator|&
literal|0x7f
operator|)
expr_stmt|;
switch|switch
condition|(
name|r
condition|)
block|{
case|case
literal|0
case|:
name|UNW_DEC_REG_GR
argument_list|(
literal|"P3"
argument_list|,
name|UNW_REG_PSP
argument_list|,
name|dst
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|1
case|:
name|UNW_DEC_REG_GR
argument_list|(
literal|"P3"
argument_list|,
name|UNW_REG_RP
argument_list|,
name|dst
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|UNW_DEC_REG_GR
argument_list|(
literal|"P3"
argument_list|,
name|UNW_REG_PFS
argument_list|,
name|dst
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|3
case|:
name|UNW_DEC_REG_GR
argument_list|(
literal|"P3"
argument_list|,
name|UNW_REG_PR
argument_list|,
name|dst
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|4
case|:
name|UNW_DEC_REG_GR
argument_list|(
literal|"P3"
argument_list|,
name|UNW_REG_UNAT
argument_list|,
name|dst
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|5
case|:
name|UNW_DEC_REG_GR
argument_list|(
literal|"P3"
argument_list|,
name|UNW_REG_LC
argument_list|,
name|dst
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|6
case|:
name|UNW_DEC_RP_BR
argument_list|(
literal|"P3"
argument_list|,
name|dst
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|7
case|:
name|UNW_DEC_REG_GR
argument_list|(
literal|"P3"
argument_list|,
name|UNW_REG_RNAT
argument_list|,
name|dst
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|8
case|:
name|UNW_DEC_REG_GR
argument_list|(
literal|"P3"
argument_list|,
name|UNW_REG_BSP
argument_list|,
name|dst
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|9
case|:
name|UNW_DEC_REG_GR
argument_list|(
literal|"P3"
argument_list|,
name|UNW_REG_BSPSTORE
argument_list|,
name|dst
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|10
case|:
name|UNW_DEC_REG_GR
argument_list|(
literal|"P3"
argument_list|,
name|UNW_REG_FPSR
argument_list|,
name|dst
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|11
case|:
name|UNW_DEC_PRIUNAT_GR
argument_list|(
literal|"P3"
argument_list|,
name|dst
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
default|default:
name|UNW_DEC_BAD_CODE
argument_list|(
name|r
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
elseif|else
if|if
condition|(
operator|(
name|code
operator|&
literal|0x7
operator|)
operator|==
literal|0
condition|)
name|UNW_DEC_SPILL_MASK
argument_list|(
literal|"P4"
argument_list|,
name|dp
argument_list|,
name|arg
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
operator|(
name|code
operator|&
literal|0x7
operator|)
operator|==
literal|1
condition|)
block|{
name|unw_word
name|grmask
decl_stmt|,
name|frmask
decl_stmt|,
name|byte1
decl_stmt|,
name|byte2
decl_stmt|,
name|byte3
decl_stmt|;
name|byte1
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|byte2
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|byte3
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|grmask
operator|=
operator|(
operator|(
name|byte1
operator|>>
literal|4
operator|)
operator|&
literal|0xf
operator|)
expr_stmt|;
name|frmask
operator|=
operator|(
operator|(
name|byte1
operator|&
literal|0xf
operator|)
operator|<<
literal|16
operator|)
operator||
operator|(
name|byte2
operator|<<
literal|8
operator|)
operator||
name|byte3
expr_stmt|;
name|UNW_DEC_FRGR_MEM
argument_list|(
literal|"P5"
argument_list|,
name|grmask
argument_list|,
name|frmask
argument_list|,
name|arg
argument_list|)
expr_stmt|;
block|}
else|else
name|UNW_DEC_BAD_CODE
argument_list|(
name|code
argument_list|)
expr_stmt|;
return|return
name|dp
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_p6
parameter_list|(
name|dp
parameter_list|,
name|code
parameter_list|,
name|arg
parameter_list|)
specifier|const
name|unsigned
name|char
modifier|*
name|dp
decl_stmt|;
name|unsigned
name|int
name|code
decl_stmt|;
name|void
modifier|*
name|arg
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|int
name|gregs
init|=
operator|(
name|code
operator|&
literal|0x10
operator|)
operator|!=
literal|0
decl_stmt|;
name|unsigned
name|char
name|mask
init|=
operator|(
name|code
operator|&
literal|0x0f
operator|)
decl_stmt|;
if|if
condition|(
name|gregs
condition|)
name|UNW_DEC_GR_MEM
argument_list|(
literal|"P6"
argument_list|,
name|mask
argument_list|,
name|arg
argument_list|)
expr_stmt|;
else|else
name|UNW_DEC_FR_MEM
argument_list|(
literal|"P6"
argument_list|,
name|mask
argument_list|,
name|arg
argument_list|)
expr_stmt|;
return|return
name|dp
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_p7_p10
parameter_list|(
name|dp
parameter_list|,
name|code
parameter_list|,
name|arg
parameter_list|)
specifier|const
name|unsigned
name|char
modifier|*
name|dp
decl_stmt|;
name|unsigned
name|int
name|code
decl_stmt|;
name|void
modifier|*
name|arg
decl_stmt|;
block|{
name|unsigned
name|char
name|r
decl_stmt|,
name|byte1
decl_stmt|,
name|byte2
decl_stmt|;
name|unw_word
name|t
decl_stmt|,
name|size
decl_stmt|;
if|if
condition|(
operator|(
name|code
operator|&
literal|0x10
operator|)
operator|==
literal|0
condition|)
block|{
name|r
operator|=
operator|(
name|code
operator|&
literal|0xf
operator|)
expr_stmt|;
name|t
operator|=
name|unw_decode_uleb128
argument_list|(
operator|&
name|dp
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|r
condition|)
block|{
case|case
literal|0
case|:
name|size
operator|=
name|unw_decode_uleb128
argument_list|(
operator|&
name|dp
argument_list|)
expr_stmt|;
name|UNW_DEC_MEM_STACK_F
argument_list|(
literal|"P7"
argument_list|,
name|t
argument_list|,
name|size
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|1
case|:
name|UNW_DEC_MEM_STACK_V
argument_list|(
literal|"P7"
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|UNW_DEC_SPILL_BASE
argument_list|(
literal|"P7"
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|3
case|:
name|UNW_DEC_REG_SPREL
argument_list|(
literal|"P7"
argument_list|,
name|UNW_REG_PSP
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|4
case|:
name|UNW_DEC_REG_WHEN
argument_list|(
literal|"P7"
argument_list|,
name|UNW_REG_RP
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|5
case|:
name|UNW_DEC_REG_PSPREL
argument_list|(
literal|"P7"
argument_list|,
name|UNW_REG_RP
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|6
case|:
name|UNW_DEC_REG_WHEN
argument_list|(
literal|"P7"
argument_list|,
name|UNW_REG_PFS
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|7
case|:
name|UNW_DEC_REG_PSPREL
argument_list|(
literal|"P7"
argument_list|,
name|UNW_REG_PFS
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|8
case|:
name|UNW_DEC_REG_WHEN
argument_list|(
literal|"P7"
argument_list|,
name|UNW_REG_PR
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|9
case|:
name|UNW_DEC_REG_PSPREL
argument_list|(
literal|"P7"
argument_list|,
name|UNW_REG_PR
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|10
case|:
name|UNW_DEC_REG_WHEN
argument_list|(
literal|"P7"
argument_list|,
name|UNW_REG_LC
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|11
case|:
name|UNW_DEC_REG_PSPREL
argument_list|(
literal|"P7"
argument_list|,
name|UNW_REG_LC
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|12
case|:
name|UNW_DEC_REG_WHEN
argument_list|(
literal|"P7"
argument_list|,
name|UNW_REG_UNAT
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|13
case|:
name|UNW_DEC_REG_PSPREL
argument_list|(
literal|"P7"
argument_list|,
name|UNW_REG_UNAT
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|14
case|:
name|UNW_DEC_REG_WHEN
argument_list|(
literal|"P7"
argument_list|,
name|UNW_REG_FPSR
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|15
case|:
name|UNW_DEC_REG_PSPREL
argument_list|(
literal|"P7"
argument_list|,
name|UNW_REG_FPSR
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
default|default:
name|UNW_DEC_BAD_CODE
argument_list|(
name|r
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
else|else
block|{
switch|switch
condition|(
name|code
operator|&
literal|0xf
condition|)
block|{
case|case
literal|0x0
case|:
comment|/* p8 */
block|{
name|r
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|t
operator|=
name|unw_decode_uleb128
argument_list|(
operator|&
name|dp
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|r
condition|)
block|{
case|case
literal|1
case|:
name|UNW_DEC_REG_SPREL
argument_list|(
literal|"P8"
argument_list|,
name|UNW_REG_RP
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|UNW_DEC_REG_SPREL
argument_list|(
literal|"P8"
argument_list|,
name|UNW_REG_PFS
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|3
case|:
name|UNW_DEC_REG_SPREL
argument_list|(
literal|"P8"
argument_list|,
name|UNW_REG_PR
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|4
case|:
name|UNW_DEC_REG_SPREL
argument_list|(
literal|"P8"
argument_list|,
name|UNW_REG_LC
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|5
case|:
name|UNW_DEC_REG_SPREL
argument_list|(
literal|"P8"
argument_list|,
name|UNW_REG_UNAT
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|6
case|:
name|UNW_DEC_REG_SPREL
argument_list|(
literal|"P8"
argument_list|,
name|UNW_REG_FPSR
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|7
case|:
name|UNW_DEC_REG_WHEN
argument_list|(
literal|"P8"
argument_list|,
name|UNW_REG_BSP
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|8
case|:
name|UNW_DEC_REG_PSPREL
argument_list|(
literal|"P8"
argument_list|,
name|UNW_REG_BSP
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|9
case|:
name|UNW_DEC_REG_SPREL
argument_list|(
literal|"P8"
argument_list|,
name|UNW_REG_BSP
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|10
case|:
name|UNW_DEC_REG_WHEN
argument_list|(
literal|"P8"
argument_list|,
name|UNW_REG_BSPSTORE
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|11
case|:
name|UNW_DEC_REG_PSPREL
argument_list|(
literal|"P8"
argument_list|,
name|UNW_REG_BSPSTORE
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|12
case|:
name|UNW_DEC_REG_SPREL
argument_list|(
literal|"P8"
argument_list|,
name|UNW_REG_BSPSTORE
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|13
case|:
name|UNW_DEC_REG_WHEN
argument_list|(
literal|"P8"
argument_list|,
name|UNW_REG_RNAT
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|14
case|:
name|UNW_DEC_REG_PSPREL
argument_list|(
literal|"P8"
argument_list|,
name|UNW_REG_RNAT
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|15
case|:
name|UNW_DEC_REG_SPREL
argument_list|(
literal|"P8"
argument_list|,
name|UNW_REG_RNAT
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|16
case|:
name|UNW_DEC_PRIUNAT_WHEN_GR
argument_list|(
literal|"P8"
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|17
case|:
name|UNW_DEC_PRIUNAT_PSPREL
argument_list|(
literal|"P8"
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|18
case|:
name|UNW_DEC_PRIUNAT_SPREL
argument_list|(
literal|"P8"
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|19
case|:
name|UNW_DEC_PRIUNAT_WHEN_MEM
argument_list|(
literal|"P8"
argument_list|,
name|t
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
default|default:
name|UNW_DEC_BAD_CODE
argument_list|(
name|r
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
break|break;
case|case
literal|0x1
case|:
name|byte1
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|byte2
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|UNW_DEC_GR_GR
argument_list|(
literal|"P9"
argument_list|,
operator|(
name|byte1
operator|&
literal|0xf
operator|)
argument_list|,
operator|(
name|byte2
operator|&
literal|0x7f
operator|)
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0xf
case|:
comment|/* p10 */
name|byte1
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|byte2
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|UNW_DEC_ABI
argument_list|(
literal|"P10"
argument_list|,
name|byte1
argument_list|,
name|byte2
argument_list|,
name|arg
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0x9
case|:
return|return
name|unw_decode_x1
argument_list|(
name|dp
argument_list|,
name|code
argument_list|,
name|arg
argument_list|)
return|;
case|case
literal|0xa
case|:
return|return
name|unw_decode_x2
argument_list|(
name|dp
argument_list|,
name|code
argument_list|,
name|arg
argument_list|)
return|;
case|case
literal|0xb
case|:
return|return
name|unw_decode_x3
argument_list|(
name|dp
argument_list|,
name|code
argument_list|,
name|arg
argument_list|)
return|;
case|case
literal|0xc
case|:
return|return
name|unw_decode_x4
argument_list|(
name|dp
argument_list|,
name|code
argument_list|,
name|arg
argument_list|)
return|;
default|default:
name|UNW_DEC_BAD_CODE
argument_list|(
name|code
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
return|return
name|dp
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_b1
parameter_list|(
name|dp
parameter_list|,
name|code
parameter_list|,
name|arg
parameter_list|)
specifier|const
name|unsigned
name|char
modifier|*
name|dp
decl_stmt|;
name|unsigned
name|int
name|code
decl_stmt|;
name|void
modifier|*
name|arg
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|unw_word
name|label
init|=
operator|(
name|code
operator|&
literal|0x1f
operator|)
decl_stmt|;
if|if
condition|(
operator|(
name|code
operator|&
literal|0x20
operator|)
operator|!=
literal|0
condition|)
name|UNW_DEC_COPY_STATE
argument_list|(
literal|"B1"
argument_list|,
name|label
argument_list|,
name|arg
argument_list|)
expr_stmt|;
else|else
name|UNW_DEC_LABEL_STATE
argument_list|(
literal|"B1"
argument_list|,
name|label
argument_list|,
name|arg
argument_list|)
expr_stmt|;
return|return
name|dp
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_b2
parameter_list|(
name|dp
parameter_list|,
name|code
parameter_list|,
name|arg
parameter_list|)
specifier|const
name|unsigned
name|char
modifier|*
name|dp
decl_stmt|;
name|unsigned
name|int
name|code
decl_stmt|;
name|void
modifier|*
name|arg
name|ATTRIBUTE_UNUSED
decl_stmt|;
block|{
name|unw_word
name|t
decl_stmt|;
name|t
operator|=
name|unw_decode_uleb128
argument_list|(
operator|&
name|dp
argument_list|)
expr_stmt|;
name|UNW_DEC_EPILOGUE
argument_list|(
literal|"B2"
argument_list|,
name|t
argument_list|,
operator|(
name|code
operator|&
literal|0x1f
operator|)
argument_list|,
name|arg
argument_list|)
expr_stmt|;
return|return
name|dp
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode_b3_x4
parameter_list|(
name|dp
parameter_list|,
name|code
parameter_list|,
name|arg
parameter_list|)
specifier|const
name|unsigned
name|char
modifier|*
name|dp
decl_stmt|;
name|unsigned
name|int
name|code
decl_stmt|;
name|void
modifier|*
name|arg
decl_stmt|;
block|{
name|unw_word
name|t
decl_stmt|,
name|ecount
decl_stmt|,
name|label
decl_stmt|;
if|if
condition|(
operator|(
name|code
operator|&
literal|0x10
operator|)
operator|==
literal|0
condition|)
block|{
name|t
operator|=
name|unw_decode_uleb128
argument_list|(
operator|&
name|dp
argument_list|)
expr_stmt|;
name|ecount
operator|=
name|unw_decode_uleb128
argument_list|(
operator|&
name|dp
argument_list|)
expr_stmt|;
name|UNW_DEC_EPILOGUE
argument_list|(
literal|"B3"
argument_list|,
name|t
argument_list|,
name|ecount
argument_list|,
name|arg
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|(
name|code
operator|&
literal|0x07
operator|)
operator|==
literal|0
condition|)
block|{
name|label
operator|=
name|unw_decode_uleb128
argument_list|(
operator|&
name|dp
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|code
operator|&
literal|0x08
operator|)
operator|!=
literal|0
condition|)
name|UNW_DEC_COPY_STATE
argument_list|(
literal|"B4"
argument_list|,
name|label
argument_list|,
name|arg
argument_list|)
expr_stmt|;
else|else
name|UNW_DEC_LABEL_STATE
argument_list|(
literal|"B4"
argument_list|,
name|label
argument_list|,
name|arg
argument_list|)
expr_stmt|;
block|}
else|else
switch|switch
condition|(
name|code
operator|&
literal|0x7
condition|)
block|{
case|case
literal|1
case|:
return|return
name|unw_decode_x1
argument_list|(
name|dp
argument_list|,
name|code
argument_list|,
name|arg
argument_list|)
return|;
case|case
literal|2
case|:
return|return
name|unw_decode_x2
argument_list|(
name|dp
argument_list|,
name|code
argument_list|,
name|arg
argument_list|)
return|;
case|case
literal|3
case|:
return|return
name|unw_decode_x3
argument_list|(
name|dp
argument_list|,
name|code
argument_list|,
name|arg
argument_list|)
return|;
case|case
literal|4
case|:
return|return
name|unw_decode_x4
argument_list|(
name|dp
argument_list|,
name|code
argument_list|,
name|arg
argument_list|)
return|;
default|default:
name|UNW_DEC_BAD_CODE
argument_list|(
name|code
argument_list|)
expr_stmt|;
break|break;
block|}
return|return
name|dp
return|;
block|}
end_function

begin_typedef
typedef|typedef
specifier|const
name|unsigned
name|char
modifier|*
typedef|(
modifier|*
name|unw_decoder
typedef|)
name|PARAMS
argument_list|(
argument|(const unsigned char *, unsigned int, void *)
argument_list|)
typedef|;
end_typedef

begin_decl_stmt
specifier|static
name|unw_decoder
name|unw_decode_table
index|[
literal|2
index|]
index|[
literal|8
index|]
init|=
block|{
comment|/* prologue table: */
block|{
name|unw_decode_r1
block|,
comment|/* 0 */
name|unw_decode_r1
block|,
name|unw_decode_r2
block|,
name|unw_decode_r3
block|,
name|unw_decode_p1
block|,
comment|/* 4 */
name|unw_decode_p2_p5
block|,
name|unw_decode_p6
block|,
name|unw_decode_p7_p10
block|}
block|,
block|{
name|unw_decode_r1
block|,
comment|/* 0 */
name|unw_decode_r1
block|,
name|unw_decode_r2
block|,
name|unw_decode_r3
block|,
name|unw_decode_b1
block|,
comment|/* 4 */
name|unw_decode_b1
block|,
name|unw_decode_b2
block|,
name|unw_decode_b3_x4
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Decode one descriptor and return address of next descriptor.  */
end_comment

begin_function
specifier|const
name|unsigned
name|char
modifier|*
name|unw_decode
parameter_list|(
name|dp
parameter_list|,
name|inside_body
parameter_list|,
name|ptr_inside_body
parameter_list|)
specifier|const
name|unsigned
name|char
modifier|*
name|dp
decl_stmt|;
name|int
name|inside_body
decl_stmt|;
name|void
modifier|*
name|ptr_inside_body
decl_stmt|;
block|{
name|unw_decoder
name|decoder
decl_stmt|;
name|unsigned
name|char
name|code
decl_stmt|;
name|code
operator|=
operator|*
name|dp
operator|++
expr_stmt|;
name|decoder
operator|=
name|unw_decode_table
index|[
name|inside_body
index|]
index|[
name|code
operator|>>
literal|5
index|]
expr_stmt|;
return|return
call|(
modifier|*
name|decoder
call|)
argument_list|(
name|dp
argument_list|,
name|code
argument_list|,
name|ptr_inside_body
argument_list|)
return|;
block|}
end_function

end_unit

