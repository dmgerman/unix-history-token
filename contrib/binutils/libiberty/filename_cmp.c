begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* File name comparison routine.     Copyright (C) 2007 Free Software Foundation, Inc.     This program is free software; you can redistribute it and/or modify    it under the terms of the GNU General Public License as published by    the Free Software Foundation; either version 2, or (at your option)    any later version.     This program is distributed in the hope that it will be useful,    but WITHOUT ANY WARRANTY; without even the implied warranty of    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    GNU General Public License for more details.     You should have received a copy of the GNU General Public License    along with this program; if not, write to the Free Software Foundation,    Inc., 51 Franklin Street - Fifth Floor, Boston, MA 02110-1301, USA.  */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|HAVE_CONFIG_H
end_ifdef

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_ifdef
ifdef|#
directive|ifdef
name|HAVE_STRING_H
end_ifdef

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|"filenames.h"
end_include

begin_include
include|#
directive|include
file|"safe-ctype.h"
end_include

begin_comment
comment|/*  @deftypefn Extension int filename_cmp (const char *@var{s1}, const char *@var{s2})  Return zero if the two file names @var{s1} and @var{s2} are equivalent. If not equivalent, the returned value is similar to what @code{strcmp} would return.  In other words, it returns a negative value if @var{s1} is less than @var{s2}, or a positive value if @var{s2} is greater than @var{s2}.  This function does not normalize file names.  As a result, this function will treat filenames that are spelled differently as different even in the case when the two filenames point to the same underlying file. However, it does handle the fact that on DOS-like file systems, forward and backward slashes are equal.  @end deftypefn  */
end_comment

begin_function
name|int
name|filename_cmp
parameter_list|(
specifier|const
name|char
modifier|*
name|s1
parameter_list|,
specifier|const
name|char
modifier|*
name|s2
parameter_list|)
block|{
ifndef|#
directive|ifndef
name|HAVE_DOS_BASED_FILE_SYSTEM
return|return
name|strcmp
argument_list|(
name|s1
argument_list|,
name|s2
argument_list|)
return|;
else|#
directive|else
for|for
control|(
init|;
condition|;
control|)
block|{
name|int
name|c1
init|=
name|TOLOWER
argument_list|(
operator|*
name|s1
argument_list|)
decl_stmt|;
name|int
name|c2
init|=
name|TOLOWER
argument_list|(
operator|*
name|s2
argument_list|)
decl_stmt|;
comment|/* On DOS-based file systems, the '/' and the '\' are equivalent.  */
if|if
condition|(
name|c1
operator|==
literal|'/'
condition|)
name|c1
operator|=
literal|'\\'
expr_stmt|;
if|if
condition|(
name|c2
operator|==
literal|'/'
condition|)
name|c2
operator|=
literal|'\\'
expr_stmt|;
if|if
condition|(
name|c1
operator|!=
name|c2
condition|)
return|return
operator|(
name|c1
operator|-
name|c2
operator|)
return|;
if|if
condition|(
name|c1
operator|==
literal|'\0'
condition|)
return|return
literal|0
return|;
name|s1
operator|++
expr_stmt|;
name|s2
operator|++
expr_stmt|;
block|}
endif|#
directive|endif
block|}
end_function

end_unit

