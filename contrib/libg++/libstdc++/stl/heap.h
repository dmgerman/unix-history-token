begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  *  * Copyright (c) 1994  * Hewlett-Packard Company  *  * Permission to use, copy, modify, distribute and sell this software  * and its documentation for any purpose is hereby granted without fee,  * provided that the above copyright notice appear in all copies and  * that both that copyright notice and this permission notice appear  * in supporting documentation.  Hewlett-Packard Company makes no  * representations about the suitability of this software for any  * purpose.  It is provided "as is" without express or implied warranty.  *  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|HEAP_H
end_ifndef

begin_define
define|#
directive|define
name|HEAP_H
end_define

begin_expr_stmt
name|template
operator|<
name|class
name|RandomAccessIterator
operator|,
name|class
name|Distance
operator|,
name|class
name|T
operator|>
name|void
name|__push_heap
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|Distance holeIndex
argument_list|,
argument|Distance topIndex
argument_list|,
argument|T value
argument_list|)
block|{
name|Distance
name|parent
operator|=
operator|(
name|holeIndex
operator|-
literal|1
operator|)
operator|/
literal|2
block|;
while|while
condition|(
name|holeIndex
operator|>
name|topIndex
operator|&&
operator|*
operator|(
name|first
operator|+
name|parent
operator|)
operator|<
name|value
condition|)
block|{
operator|*
operator|(
name|first
operator|+
name|holeIndex
operator|)
operator|=
operator|*
operator|(
name|first
operator|+
name|parent
operator|)
expr_stmt|;
name|holeIndex
operator|=
name|parent
expr_stmt|;
name|parent
operator|=
operator|(
name|holeIndex
operator|-
literal|1
operator|)
operator|/
literal|2
expr_stmt|;
block|}
operator|*
operator|(
name|first
operator|+
name|holeIndex
operator|)
operator|=
name|value
expr_stmt|;
end_expr_stmt

begin_expr_stmt
unit|}  template
operator|<
name|class
name|RandomAccessIterator
operator|,
name|class
name|T
operator|>
specifier|inline
name|void
name|__push_heap_aux
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|RandomAccessIterator last
argument_list|,
argument|T*
argument_list|)
block|{
name|__push_heap
argument_list|(
name|first
argument_list|,
operator|(
name|last
operator|-
name|first
operator|)
operator|-
literal|1
argument_list|,
literal|0
argument_list|,
name|T
argument_list|(
operator|*
operator|(
name|last
operator|-
literal|1
operator|)
argument_list|)
argument_list|)
block|; }
name|template
operator|<
name|class
name|RandomAccessIterator
operator|>
specifier|inline
name|void
name|push_heap
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|RandomAccessIterator last
argument_list|)
block|{
name|__push_heap_aux
argument_list|(
name|first
argument_list|,
name|last
argument_list|,
name|value_type
argument_list|(
name|first
argument_list|)
argument_list|)
block|; }
name|template
operator|<
name|class
name|RandomAccessIterator
operator|,
name|class
name|Distance
operator|,
name|class
name|T
operator|,
name|class
name|Compare
operator|>
name|void
name|__push_heap
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|Distance holeIndex
argument_list|,
argument|Distance topIndex
argument_list|,
argument|T value
argument_list|,
argument|Compare comp
argument_list|)
block|{
name|Distance
name|parent
operator|=
operator|(
name|holeIndex
operator|-
literal|1
operator|)
operator|/
literal|2
block|;
while|while
condition|(
name|holeIndex
operator|>
name|topIndex
operator|&&
name|comp
argument_list|(
operator|*
operator|(
name|first
operator|+
name|parent
operator|)
argument_list|,
name|value
argument_list|)
condition|)
block|{
operator|*
operator|(
name|first
operator|+
name|holeIndex
operator|)
operator|=
operator|*
operator|(
name|first
operator|+
name|parent
operator|)
expr_stmt|;
name|holeIndex
operator|=
name|parent
expr_stmt|;
name|parent
operator|=
operator|(
name|holeIndex
operator|-
literal|1
operator|)
operator|/
literal|2
expr_stmt|;
block|}
operator|*
operator|(
name|first
operator|+
name|holeIndex
operator|)
operator|=
name|value
expr_stmt|;
end_expr_stmt

begin_expr_stmt
unit|}  template
operator|<
name|class
name|RandomAccessIterator
operator|,
name|class
name|Compare
operator|,
name|class
name|T
operator|>
specifier|inline
name|void
name|__push_heap_aux
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|RandomAccessIterator last
argument_list|,
argument|Compare comp
argument_list|,
argument|T*
argument_list|)
block|{
name|__push_heap
argument_list|(
name|first
argument_list|,
operator|(
name|last
operator|-
name|first
operator|)
operator|-
literal|1
argument_list|,
literal|0
argument_list|,
name|T
argument_list|(
operator|*
operator|(
name|last
operator|-
literal|1
operator|)
argument_list|)
argument_list|,
name|comp
argument_list|)
block|; }
name|template
operator|<
name|class
name|RandomAccessIterator
operator|,
name|class
name|Compare
operator|>
specifier|inline
name|void
name|push_heap
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|RandomAccessIterator last
argument_list|,
argument|Compare comp
argument_list|)
block|{
name|__push_heap_aux
argument_list|(
name|first
argument_list|,
name|last
argument_list|,
name|comp
argument_list|,
name|value_type
argument_list|(
name|first
argument_list|)
argument_list|)
block|; }
name|template
operator|<
name|class
name|RandomAccessIterator
operator|,
name|class
name|Distance
operator|,
name|class
name|T
operator|>
name|void
name|__adjust_heap
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|Distance holeIndex
argument_list|,
argument|Distance len
argument_list|,
argument|T value
argument_list|)
block|{
name|Distance
name|topIndex
operator|=
name|holeIndex
block|;
name|Distance
name|secondChild
operator|=
literal|2
operator|*
name|holeIndex
operator|+
literal|2
block|;
while|while
condition|(
name|secondChild
operator|<
name|len
condition|)
block|{
if|if
condition|(
operator|*
operator|(
name|first
operator|+
name|secondChild
operator|)
operator|<
operator|*
operator|(
name|first
operator|+
operator|(
name|secondChild
operator|-
literal|1
operator|)
operator|)
condition|)
name|secondChild
operator|--
expr_stmt|;
operator|*
operator|(
name|first
operator|+
name|holeIndex
operator|)
operator|=
operator|*
operator|(
name|first
operator|+
name|secondChild
operator|)
expr_stmt|;
name|holeIndex
operator|=
name|secondChild
expr_stmt|;
name|secondChild
operator|=
literal|2
operator|*
operator|(
name|secondChild
operator|+
literal|1
operator|)
expr_stmt|;
block|}
end_expr_stmt

begin_if
if|if
condition|(
name|secondChild
operator|==
name|len
condition|)
block|{
operator|*
operator|(
name|first
operator|+
name|holeIndex
operator|)
operator|=
operator|*
operator|(
name|first
operator|+
operator|(
name|secondChild
operator|-
literal|1
operator|)
operator|)
expr_stmt|;
name|holeIndex
operator|=
name|secondChild
operator|-
literal|1
expr_stmt|;
block|}
end_if

begin_expr_stmt
name|__push_heap
argument_list|(
name|first
argument_list|,
name|holeIndex
argument_list|,
name|topIndex
argument_list|,
name|value
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
unit|}  template
operator|<
name|class
name|RandomAccessIterator
operator|,
name|class
name|T
operator|,
name|class
name|Distance
operator|>
specifier|inline
name|void
name|__pop_heap
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|RandomAccessIterator last
argument_list|,
argument|RandomAccessIterator result
argument_list|,
argument|T value
argument_list|,
argument|Distance*
argument_list|)
block|{
operator|*
name|result
operator|=
operator|*
name|first
block|;
name|__adjust_heap
argument_list|(
name|first
argument_list|,
name|Distance
argument_list|(
literal|0
argument_list|)
argument_list|,
name|Distance
argument_list|(
name|last
operator|-
name|first
argument_list|)
argument_list|,
name|value
argument_list|)
block|; }
name|template
operator|<
name|class
name|RandomAccessIterator
operator|,
name|class
name|T
operator|>
specifier|inline
name|void
name|__pop_heap_aux
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|RandomAccessIterator last
argument_list|,
argument|T*
argument_list|)
block|{
name|__pop_heap
argument_list|(
name|first
argument_list|,
name|last
operator|-
literal|1
argument_list|,
name|last
operator|-
literal|1
argument_list|,
name|T
argument_list|(
operator|*
operator|(
name|last
operator|-
literal|1
operator|)
argument_list|)
argument_list|,
name|distance_type
argument_list|(
name|first
argument_list|)
argument_list|)
block|; }
name|template
operator|<
name|class
name|RandomAccessIterator
operator|>
specifier|inline
name|void
name|pop_heap
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|RandomAccessIterator last
argument_list|)
block|{
name|__pop_heap_aux
argument_list|(
name|first
argument_list|,
name|last
argument_list|,
name|value_type
argument_list|(
name|first
argument_list|)
argument_list|)
block|; }
name|template
operator|<
name|class
name|RandomAccessIterator
operator|,
name|class
name|Distance
operator|,
name|class
name|T
operator|,
name|class
name|Compare
operator|>
name|void
name|__adjust_heap
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|Distance holeIndex
argument_list|,
argument|Distance len
argument_list|,
argument|T value
argument_list|,
argument|Compare comp
argument_list|)
block|{
name|Distance
name|topIndex
operator|=
name|holeIndex
block|;
name|Distance
name|secondChild
operator|=
literal|2
operator|*
name|holeIndex
operator|+
literal|2
block|;
while|while
condition|(
name|secondChild
operator|<
name|len
condition|)
block|{
if|if
condition|(
name|comp
argument_list|(
operator|*
operator|(
name|first
operator|+
name|secondChild
operator|)
argument_list|,
operator|*
operator|(
name|first
operator|+
operator|(
name|secondChild
operator|-
literal|1
operator|)
operator|)
argument_list|)
condition|)
name|secondChild
operator|--
expr_stmt|;
operator|*
operator|(
name|first
operator|+
name|holeIndex
operator|)
operator|=
operator|*
operator|(
name|first
operator|+
name|secondChild
operator|)
expr_stmt|;
name|holeIndex
operator|=
name|secondChild
expr_stmt|;
name|secondChild
operator|=
literal|2
operator|*
operator|(
name|secondChild
operator|+
literal|1
operator|)
expr_stmt|;
block|}
end_expr_stmt

begin_if
if|if
condition|(
name|secondChild
operator|==
name|len
condition|)
block|{
operator|*
operator|(
name|first
operator|+
name|holeIndex
operator|)
operator|=
operator|*
operator|(
name|first
operator|+
operator|(
name|secondChild
operator|-
literal|1
operator|)
operator|)
expr_stmt|;
name|holeIndex
operator|=
name|secondChild
operator|-
literal|1
expr_stmt|;
block|}
end_if

begin_expr_stmt
name|__push_heap
argument_list|(
name|first
argument_list|,
name|holeIndex
argument_list|,
name|topIndex
argument_list|,
name|value
argument_list|,
name|comp
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
unit|}  template
operator|<
name|class
name|RandomAccessIterator
operator|,
name|class
name|T
operator|,
name|class
name|Compare
operator|,
name|class
name|Distance
operator|>
specifier|inline
name|void
name|__pop_heap
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|RandomAccessIterator last
argument_list|,
argument|RandomAccessIterator result
argument_list|,
argument|T value
argument_list|,
argument|Compare comp
argument_list|,
argument|Distance*
argument_list|)
block|{
operator|*
name|result
operator|=
operator|*
name|first
block|;
name|__adjust_heap
argument_list|(
name|first
argument_list|,
name|Distance
argument_list|(
literal|0
argument_list|)
argument_list|,
name|Distance
argument_list|(
name|last
operator|-
name|first
argument_list|)
argument_list|,
name|value
argument_list|,
name|comp
argument_list|)
block|; }
name|template
operator|<
name|class
name|RandomAccessIterator
operator|,
name|class
name|T
operator|,
name|class
name|Compare
operator|>
specifier|inline
name|void
name|__pop_heap_aux
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|RandomAccessIterator last
argument_list|,
argument|T*
argument_list|,
argument|Compare comp
argument_list|)
block|{
name|__pop_heap
argument_list|(
name|first
argument_list|,
name|last
operator|-
literal|1
argument_list|,
name|last
operator|-
literal|1
argument_list|,
name|T
argument_list|(
operator|*
operator|(
name|last
operator|-
literal|1
operator|)
argument_list|)
argument_list|,
name|comp
argument_list|,
name|distance_type
argument_list|(
name|first
argument_list|)
argument_list|)
block|; }
name|template
operator|<
name|class
name|RandomAccessIterator
operator|,
name|class
name|Compare
operator|>
specifier|inline
name|void
name|pop_heap
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|RandomAccessIterator last
argument_list|,
argument|Compare comp
argument_list|)
block|{
name|__pop_heap_aux
argument_list|(
name|first
argument_list|,
name|last
argument_list|,
name|value_type
argument_list|(
name|first
argument_list|)
argument_list|,
name|comp
argument_list|)
block|; }
name|template
operator|<
name|class
name|RandomAccessIterator
operator|,
name|class
name|T
operator|,
name|class
name|Distance
operator|>
name|void
name|__make_heap
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|RandomAccessIterator last
argument_list|,
argument|T*
argument_list|,
argument|Distance*
argument_list|)
block|{
if|if
condition|(
name|last
operator|-
name|first
operator|<
literal|2
condition|)
return|return;
name|Distance
name|len
operator|=
name|last
operator|-
name|first
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|Distance
name|parent
init|=
operator|(
name|len
operator|-
literal|2
operator|)
operator|/
literal|2
decl_stmt|;
end_decl_stmt

begin_while
while|while
condition|(
name|true
condition|)
block|{
name|__adjust_heap
argument_list|(
name|first
argument_list|,
name|parent
argument_list|,
name|len
argument_list|,
name|T
argument_list|(
operator|*
operator|(
name|first
operator|+
name|parent
operator|)
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|parent
operator|==
literal|0
condition|)
return|return;
name|parent
operator|--
expr_stmt|;
block|}
end_while

begin_expr_stmt
unit|}  template
operator|<
name|class
name|RandomAccessIterator
operator|>
specifier|inline
name|void
name|make_heap
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|RandomAccessIterator last
argument_list|)
block|{
name|__make_heap
argument_list|(
name|first
argument_list|,
name|last
argument_list|,
name|value_type
argument_list|(
name|first
argument_list|)
argument_list|,
name|distance_type
argument_list|(
name|first
argument_list|)
argument_list|)
block|; }
name|template
operator|<
name|class
name|RandomAccessIterator
operator|,
name|class
name|Compare
operator|,
name|class
name|T
operator|,
name|class
name|Distance
operator|>
name|void
name|__make_heap
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|RandomAccessIterator last
argument_list|,
argument|Compare comp
argument_list|,
argument|T*
argument_list|,
argument|Distance*
argument_list|)
block|{
if|if
condition|(
name|last
operator|-
name|first
operator|<
literal|2
condition|)
return|return;
name|Distance
name|len
operator|=
name|last
operator|-
name|first
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|Distance
name|parent
init|=
operator|(
name|len
operator|-
literal|2
operator|)
operator|/
literal|2
decl_stmt|;
end_decl_stmt

begin_while
while|while
condition|(
name|true
condition|)
block|{
name|__adjust_heap
argument_list|(
name|first
argument_list|,
name|parent
argument_list|,
name|len
argument_list|,
name|T
argument_list|(
operator|*
operator|(
name|first
operator|+
name|parent
operator|)
argument_list|)
argument_list|,
name|comp
argument_list|)
expr_stmt|;
if|if
condition|(
name|parent
operator|==
literal|0
condition|)
return|return;
name|parent
operator|--
expr_stmt|;
block|}
end_while

begin_expr_stmt
unit|}  template
operator|<
name|class
name|RandomAccessIterator
operator|,
name|class
name|Compare
operator|>
specifier|inline
name|void
name|make_heap
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|RandomAccessIterator last
argument_list|,
argument|Compare comp
argument_list|)
block|{
name|__make_heap
argument_list|(
name|first
argument_list|,
name|last
argument_list|,
name|comp
argument_list|,
name|value_type
argument_list|(
name|first
argument_list|)
argument_list|,
name|distance_type
argument_list|(
name|first
argument_list|)
argument_list|)
block|; }
name|template
operator|<
name|class
name|RandomAccessIterator
operator|>
name|void
name|sort_heap
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|RandomAccessIterator last
argument_list|)
block|{
while|while
condition|(
name|last
operator|-
name|first
operator|>
literal|1
condition|)
name|pop_heap
argument_list|(
name|first
argument_list|,
name|last
operator|--
argument_list|)
expr_stmt|;
block|}
end_expr_stmt

begin_expr_stmt
name|template
operator|<
name|class
name|RandomAccessIterator
operator|,
name|class
name|Compare
operator|>
name|void
name|sort_heap
argument_list|(
argument|RandomAccessIterator first
argument_list|,
argument|RandomAccessIterator last
argument_list|,
argument|Compare comp
argument_list|)
block|{
while|while
condition|(
name|last
operator|-
name|first
operator|>
literal|1
condition|)
name|pop_heap
argument_list|(
name|first
argument_list|,
name|last
operator|--
argument_list|,
name|comp
argument_list|)
expr_stmt|;
block|}
end_expr_stmt

begin_endif
endif|#
directive|endif
end_endif

end_unit

