begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * wpa_supplicant - Internal definitions  * Copyright (c) 2003-2006, Jouni Malinen<jkmaline@cc.hut.fi>  *  * This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License version 2 as  * published by the Free Software Foundation.  *  * Alternatively, this software may be distributed under the terms of BSD  * license.  *  * See README and COPYING for more details.  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|WPA_SUPPLICANT_I_H
end_ifndef

begin_define
define|#
directive|define
name|WPA_SUPPLICANT_I_H
end_define

begin_include
include|#
directive|include
file|"driver.h"
end_include

begin_struct
struct|struct
name|wpa_blacklist
block|{
name|struct
name|wpa_blacklist
modifier|*
name|next
decl_stmt|;
name|u8
name|bssid
index|[
name|ETH_ALEN
index|]
decl_stmt|;
name|int
name|count
decl_stmt|;
block|}
struct|;
end_struct

begin_struct_decl
struct_decl|struct
name|wpa_scan_result
struct_decl|;
end_struct_decl

begin_struct_decl
struct_decl|struct
name|wpa_sm
struct_decl|;
end_struct_decl

begin_struct_decl
struct_decl|struct
name|wpa_supplicant
struct_decl|;
end_struct_decl

begin_comment
comment|/**  * struct wpa_interface - Parameters for wpa_supplicant_add_iface()  */
end_comment

begin_struct
struct|struct
name|wpa_interface
block|{
comment|/** 	 * confname - Configuration name (file or profile) name 	 * 	 * This can also be %NULL when a configuration file is not used. In 	 * that case, ctrl_interface must be set to allow the interface to be 	 * configured. 	 */
specifier|const
name|char
modifier|*
name|confname
decl_stmt|;
comment|/** 	 * ctrl_interface - Control interface parameter 	 * 	 * If a configuration file is not used, this variable can be used to 	 * set the ctrl_interface parameter that would have otherwise been read 	 * from the configuration file. If both confname and ctrl_interface are 	 * set, ctrl_interface is used to override the value from configuration 	 * file. 	 */
specifier|const
name|char
modifier|*
name|ctrl_interface
decl_stmt|;
comment|/** 	 * driver - Driver interface name, or %NULL to use the default driver 	 */
specifier|const
name|char
modifier|*
name|driver
decl_stmt|;
comment|/** 	 * driver_param - Driver interface parameters 	 * 	 * If a configuration file is not used, this variable can be used to 	 * set the driver_param parameters that would have otherwise been read 	 * from the configuration file. If both confname and driver_param are 	 * set, driver_param is used to override the value from configuration 	 * file. 	 */
specifier|const
name|char
modifier|*
name|driver_param
decl_stmt|;
comment|/** 	 * ifname - Interface name 	 */
specifier|const
name|char
modifier|*
name|ifname
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/**  * struct wpa_params - Parameters for wpa_supplicant_init()  */
end_comment

begin_struct
struct|struct
name|wpa_params
block|{
comment|/** 	 * daemonize - Run %wpa_supplicant in the background 	 */
name|int
name|daemonize
decl_stmt|;
comment|/** 	 * wait_for_interface - Wait for the network interface to appear 	 * 	 * If set, %wpa_supplicant will wait until all the configured network 	 * interfaces are available before starting processing. Please note 	 * that in many cases, a better alternative would be to start 	 * %wpa_supplicant without network interfaces and add the interfaces 	 * dynamically whenever they become available. 	 */
name|int
name|wait_for_interface
decl_stmt|;
comment|/** 	 * wait_for_monitor - Wait for a monitor program before starting 	 */
name|int
name|wait_for_monitor
decl_stmt|;
comment|/** 	 * pid_file - Path to a PID (process ID) file 	 * 	 * If this and daemonize are set, process ID of the background process 	 * will be written to the specified file. 	 */
name|char
modifier|*
name|pid_file
decl_stmt|;
comment|/** 	 * wpa_debug_level - Debugging verbosity level (e.g., MSG_INFO) 	 */
name|int
name|wpa_debug_level
decl_stmt|;
comment|/** 	 * wpa_debug_show_keys - Whether keying material is included in debug 	 * 	 * This parameter can be used to allow keying material to be included 	 * in debug messages. This is a security risk and this option should 	 * not be enabled in normal configuration. If needed during 	 * development or while troubleshooting, this option can provide more 	 * details for figuring out what is happening. 	 */
name|int
name|wpa_debug_show_keys
decl_stmt|;
comment|/** 	 * wpa_debug_timestamp - Whether to include timestamp in debug messages 	 */
name|int
name|wpa_debug_timestamp
decl_stmt|;
comment|/** 	 * ctrl_interface - Global ctrl_iface path/parameter 	 */
name|char
modifier|*
name|ctrl_interface
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/**  * struct wpa_global - Internal, global data for all %wpa_supplicant interfaces  *  * This structure is initialized by calling wpa_supplicant_init() when starting  * %wpa_supplicant.  */
end_comment

begin_struct
struct|struct
name|wpa_global
block|{
name|struct
name|wpa_supplicant
modifier|*
name|ifaces
decl_stmt|;
name|struct
name|wpa_params
name|params
decl_stmt|;
name|int
name|ctrl_sock
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/**  * struct wpa_supplicant - Internal data for wpa_supplicant interface  *  * This structure contains the internal data for core wpa_supplicant code. This  * should be only used directly from the core code. However, a pointer to this  * data is used from other files as an arbitrary context pointer in calls to  * core functions.  */
end_comment

begin_struct
struct|struct
name|wpa_supplicant
block|{
name|struct
name|wpa_global
modifier|*
name|global
decl_stmt|;
name|struct
name|wpa_supplicant
modifier|*
name|next
decl_stmt|;
name|struct
name|l2_packet_data
modifier|*
name|l2
decl_stmt|;
name|unsigned
name|char
name|own_addr
index|[
name|ETH_ALEN
index|]
decl_stmt|;
name|char
name|ifname
index|[
literal|100
index|]
decl_stmt|;
name|char
modifier|*
name|confname
decl_stmt|;
name|struct
name|wpa_config
modifier|*
name|conf
decl_stmt|;
name|int
name|countermeasures
decl_stmt|;
name|time_t
name|last_michael_mic_error
decl_stmt|;
name|u8
name|bssid
index|[
name|ETH_ALEN
index|]
decl_stmt|;
name|int
name|reassociate
decl_stmt|;
comment|/* reassociation requested */
name|int
name|disconnected
decl_stmt|;
comment|/* all connections disabled; i.e., do no reassociate 			   * before this has been cleared */
name|struct
name|wpa_ssid
modifier|*
name|current_ssid
decl_stmt|;
comment|/* Selected configuration (based on Beacon/ProbeResp WPA IE) */
name|int
name|pairwise_cipher
decl_stmt|;
name|int
name|group_cipher
decl_stmt|;
name|int
name|key_mgmt
decl_stmt|;
name|void
modifier|*
name|drv_priv
decl_stmt|;
comment|/* private data used by driver_ops */
name|struct
name|wpa_ssid
modifier|*
name|prev_scan_ssid
decl_stmt|;
comment|/* previously scanned SSID; 					  * NULL = not yet initialized (start 					  * with broadcast SSID) 					  * BROADCAST_SSID_SCAN = broadcast 					  * SSID was used in the previous scan 					  */
define|#
directive|define
name|BROADCAST_SSID_SCAN
value|((struct wpa_ssid *) 1)
name|struct
name|wpa_scan_result
modifier|*
name|scan_results
decl_stmt|;
name|int
name|num_scan_results
decl_stmt|;
name|struct
name|wpa_driver_ops
modifier|*
name|driver
decl_stmt|;
name|int
name|interface_removed
decl_stmt|;
comment|/* whether the network interface has been 				* removed */
name|struct
name|wpa_sm
modifier|*
name|wpa
decl_stmt|;
name|struct
name|eapol_sm
modifier|*
name|eapol
decl_stmt|;
name|int
name|ctrl_sock
decl_stmt|;
comment|/* UNIX domain socket for control interface or -1 if 			* not used */
name|struct
name|wpa_ctrl_dst
modifier|*
name|ctrl_dst
decl_stmt|;
name|wpa_states
name|wpa_state
decl_stmt|;
name|int
name|new_connection
decl_stmt|;
name|int
name|reassociated_connection
decl_stmt|;
name|int
name|eapol_received
decl_stmt|;
comment|/* number of EAPOL packets received after the 			     * previous association event */
name|struct
name|scard_data
modifier|*
name|scard
decl_stmt|;
name|unsigned
name|char
name|last_eapol_src
index|[
name|ETH_ALEN
index|]
decl_stmt|;
name|int
name|keys_cleared
decl_stmt|;
name|struct
name|wpa_blacklist
modifier|*
name|blacklist
decl_stmt|;
name|int
name|scan_req
decl_stmt|;
comment|/* manual scan request; this forces a scan even if there 		       * are no enabled networks in the configuration */
block|}
struct|;
end_struct

begin_comment
comment|/* wpa_supplicant.c */
end_comment

begin_function_decl
name|void
name|wpa_supplicant_cancel_scan
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_supplicant_reload_configuration
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|const
name|char
modifier|*
name|wpa_supplicant_state_txt
parameter_list|(
name|int
name|state
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_supplicant_driver_init
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|int
name|wait_for_interface
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|wpa_blacklist
modifier|*
name|wpa_blacklist_get
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
specifier|const
name|u8
modifier|*
name|bssid
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_blacklist_add
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
specifier|const
name|u8
modifier|*
name|bssid
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_blacklist_del
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
specifier|const
name|u8
modifier|*
name|bssid
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_blacklist_clear
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_supplicant_set_suites
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|struct
name|wpa_scan_result
modifier|*
name|bss
parameter_list|,
name|struct
name|wpa_ssid
modifier|*
name|ssid
parameter_list|,
name|u8
modifier|*
name|wpa_ie
parameter_list|,
name|size_t
modifier|*
name|wpa_ie_len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_supplicant_associate
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|struct
name|wpa_scan_result
modifier|*
name|bss
parameter_list|,
name|struct
name|wpa_ssid
modifier|*
name|ssid
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_supplicant_set_non_wpa_policy
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|struct
name|wpa_ssid
modifier|*
name|ssid
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_supplicant_initiate_eapol
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_supplicant_get_scan_results
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_clear_keys
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_supplicant_req_auth_timeout
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|int
name|sec
parameter_list|,
name|int
name|usec
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_supplicant_set_state
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|wpa_states
name|state
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|wpa_ssid
modifier|*
name|wpa_supplicant_get_ssid
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_supplicant_cancel_auth_timeout
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_supplicant_deauthenticate
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|int
name|reason_code
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_supplicant_disassociate
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|int
name|reason_code
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_supplicant_req_scan
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|int
name|sec
parameter_list|,
name|int
name|usec
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_show_license
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|wpa_supplicant
modifier|*
name|wpa_supplicant_add_iface
parameter_list|(
name|struct
name|wpa_global
modifier|*
name|global
parameter_list|,
name|struct
name|wpa_interface
modifier|*
name|iface
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_supplicant_remove_iface
parameter_list|(
name|struct
name|wpa_global
modifier|*
name|global
parameter_list|,
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|wpa_supplicant
modifier|*
name|wpa_supplicant_get_iface
parameter_list|(
name|struct
name|wpa_global
modifier|*
name|global
parameter_list|,
specifier|const
name|char
modifier|*
name|ifname
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|wpa_global
modifier|*
name|wpa_supplicant_init
parameter_list|(
name|struct
name|wpa_params
modifier|*
name|params
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_supplicant_run
parameter_list|(
name|struct
name|wpa_global
modifier|*
name|global
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_supplicant_deinit
parameter_list|(
name|struct
name|wpa_global
modifier|*
name|global
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_supplicant_scard_init
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|struct
name|wpa_ssid
modifier|*
name|ssid
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* driver_ops */
end_comment

begin_function
specifier|static
specifier|inline
name|void
modifier|*
name|wpa_drv_init
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
specifier|const
name|char
modifier|*
name|ifname
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|init
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|init
argument_list|(
name|wpa_s
argument_list|,
name|ifname
argument_list|)
return|;
block|}
return|return
name|NULL
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|void
name|wpa_drv_deinit
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|deinit
condition|)
name|wpa_s
operator|->
name|driver
operator|->
name|deinit
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_set_param
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
specifier|const
name|char
modifier|*
name|param
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|set_param
condition|)
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|set_param
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|,
name|param
argument_list|)
return|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_set_drop_unencrypted
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|int
name|enabled
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|set_drop_unencrypted
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|set_drop_unencrypted
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|,
name|enabled
argument_list|)
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_set_countermeasures
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|int
name|enabled
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|set_countermeasures
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|set_countermeasures
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|,
name|enabled
argument_list|)
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_set_auth_alg
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|int
name|auth_alg
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|set_auth_alg
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|set_auth_alg
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|,
name|auth_alg
argument_list|)
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_set_wpa
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|int
name|enabled
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|set_wpa
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|set_wpa
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|,
name|enabled
argument_list|)
return|;
block|}
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_associate
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|struct
name|wpa_driver_associate_params
modifier|*
name|params
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|associate
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|associate
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|,
name|params
argument_list|)
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_scan
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
specifier|const
name|u8
modifier|*
name|ssid
parameter_list|,
name|size_t
name|ssid_len
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|scan
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|scan
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|,
name|ssid
argument_list|,
name|ssid_len
argument_list|)
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_get_scan_results
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|struct
name|wpa_scan_result
modifier|*
name|results
parameter_list|,
name|size_t
name|max_size
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|get_scan_results
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|get_scan_results
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|,
name|results
argument_list|,
name|max_size
argument_list|)
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_get_bssid
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|u8
modifier|*
name|bssid
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|get_bssid
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|get_bssid
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|,
name|bssid
argument_list|)
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_get_ssid
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|u8
modifier|*
name|ssid
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|get_ssid
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|get_ssid
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|,
name|ssid
argument_list|)
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_set_key
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|wpa_alg
name|alg
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|int
name|key_idx
parameter_list|,
name|int
name|set_tx
parameter_list|,
specifier|const
name|u8
modifier|*
name|seq
parameter_list|,
name|size_t
name|seq_len
parameter_list|,
specifier|const
name|u8
modifier|*
name|key
parameter_list|,
name|size_t
name|key_len
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|set_key
condition|)
block|{
name|wpa_s
operator|->
name|keys_cleared
operator|=
literal|0
expr_stmt|;
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|set_key
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|,
name|alg
argument_list|,
name|addr
argument_list|,
name|key_idx
argument_list|,
name|set_tx
argument_list|,
name|seq
argument_list|,
name|seq_len
argument_list|,
name|key
argument_list|,
name|key_len
argument_list|)
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_deauthenticate
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|int
name|reason_code
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|deauthenticate
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|deauthenticate
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|,
name|addr
argument_list|,
name|reason_code
argument_list|)
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_disassociate
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|int
name|reason_code
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|disassociate
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|disassociate
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|,
name|addr
argument_list|,
name|reason_code
argument_list|)
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_add_pmkid
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
specifier|const
name|u8
modifier|*
name|bssid
parameter_list|,
specifier|const
name|u8
modifier|*
name|pmkid
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|add_pmkid
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|add_pmkid
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|,
name|bssid
argument_list|,
name|pmkid
argument_list|)
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_remove_pmkid
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
specifier|const
name|u8
modifier|*
name|bssid
parameter_list|,
specifier|const
name|u8
modifier|*
name|pmkid
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|remove_pmkid
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|remove_pmkid
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|,
name|bssid
argument_list|,
name|pmkid
argument_list|)
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_flush_pmkid
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|flush_pmkid
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|flush_pmkid
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|)
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_get_capa
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
name|struct
name|wpa_driver_capa
modifier|*
name|capa
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|get_capa
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|get_capa
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|,
name|capa
argument_list|)
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|void
name|wpa_drv_poll
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|poll
condition|)
block|{
name|wpa_s
operator|->
name|driver
operator|->
name|poll
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
specifier|inline
specifier|const
name|char
modifier|*
name|wpa_drv_get_ifname
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|get_ifname
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|get_ifname
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|)
return|;
block|}
return|return
name|NULL
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
specifier|const
name|u8
modifier|*
name|wpa_drv_get_mac_addr
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|get_mac_addr
condition|)
block|{
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|get_mac_addr
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|)
return|;
block|}
return|return
name|NULL
return|;
block|}
end_function

begin_function
specifier|static
specifier|inline
name|int
name|wpa_drv_send_eapol
parameter_list|(
name|struct
name|wpa_supplicant
modifier|*
name|wpa_s
parameter_list|,
specifier|const
name|u8
modifier|*
name|dst
parameter_list|,
name|u16
name|proto
parameter_list|,
specifier|const
name|u8
modifier|*
name|data
parameter_list|,
name|size_t
name|data_len
parameter_list|)
block|{
if|if
condition|(
name|wpa_s
operator|->
name|driver
operator|->
name|send_eapol
condition|)
return|return
name|wpa_s
operator|->
name|driver
operator|->
name|send_eapol
argument_list|(
name|wpa_s
operator|->
name|drv_priv
argument_list|,
name|dst
argument_list|,
name|proto
argument_list|,
name|data
argument_list|,
name|data_len
argument_list|)
return|;
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* WPA_SUPPLICANT_I_H */
end_comment

end_unit

