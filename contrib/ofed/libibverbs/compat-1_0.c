begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (c) 2007 Cisco Systems, Inc.  All rights reserved.  *  * This software is available to you under a choice of one of two  * licenses.  You may choose to be licensed under the terms of the GNU  * General Public License (GPL) Version 2, available from the file  * COPYING in the main directory of this source tree, or the  * OpenIB.org BSD license below:  *  *     Redistribution and use in source and binary forms, with or  *     without modification, are permitted provided that the following  *     conditions are met:  *  *      - Redistributions of source code must retain the above  *        copyright notice, this list of conditions and the following  *        disclaimer.  *  *      - Redistributions in binary form must reproduce the above  *        copyright notice, this list of conditions and the following  *        disclaimer in the documentation and/or other materials  *        provided with the distribution.  *  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,  * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND  * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS  * BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN  * ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN  * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE  * SOFTWARE.  */
end_comment

begin_include
include|#
directive|include
file|<config.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<stddef.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<unistd.h>
end_include

begin_include
include|#
directive|include
file|<alloca.h>
end_include

begin_include
include|#
directive|include
file|"ibverbs.h"
end_include

begin_struct
struct|struct
name|ibv_pd_1_0
block|{
name|struct
name|ibv_context_1_0
modifier|*
name|context
decl_stmt|;
name|uint32_t
name|handle
decl_stmt|;
name|struct
name|ibv_pd
modifier|*
name|real_pd
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|ibv_mr_1_0
block|{
name|struct
name|ibv_context_1_0
modifier|*
name|context
decl_stmt|;
name|struct
name|ibv_pd_1_0
modifier|*
name|pd
decl_stmt|;
name|uint32_t
name|handle
decl_stmt|;
name|uint32_t
name|lkey
decl_stmt|;
name|uint32_t
name|rkey
decl_stmt|;
name|struct
name|ibv_mr
modifier|*
name|real_mr
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|ibv_srq_1_0
block|{
name|struct
name|ibv_context_1_0
modifier|*
name|context
decl_stmt|;
name|void
modifier|*
name|srq_context
decl_stmt|;
name|struct
name|ibv_pd_1_0
modifier|*
name|pd
decl_stmt|;
name|uint32_t
name|handle
decl_stmt|;
name|pthread_mutex_t
name|mutex
decl_stmt|;
name|pthread_cond_t
name|cond
decl_stmt|;
name|uint32_t
name|events_completed
decl_stmt|;
name|struct
name|ibv_srq
modifier|*
name|real_srq
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|ibv_qp_init_attr_1_0
block|{
name|void
modifier|*
name|qp_context
decl_stmt|;
name|struct
name|ibv_cq_1_0
modifier|*
name|send_cq
decl_stmt|;
name|struct
name|ibv_cq_1_0
modifier|*
name|recv_cq
decl_stmt|;
name|struct
name|ibv_srq_1_0
modifier|*
name|srq
decl_stmt|;
name|struct
name|ibv_qp_cap
name|cap
decl_stmt|;
name|enum
name|ibv_qp_type
name|qp_type
decl_stmt|;
name|int
name|sq_sig_all
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|ibv_send_wr_1_0
block|{
name|struct
name|ibv_send_wr_1_0
modifier|*
name|next
decl_stmt|;
name|uint64_t
name|wr_id
decl_stmt|;
name|struct
name|ibv_sge
modifier|*
name|sg_list
decl_stmt|;
name|int
name|num_sge
decl_stmt|;
name|enum
name|ibv_wr_opcode
name|opcode
decl_stmt|;
name|int
name|send_flags
decl_stmt|;
name|__be32
name|imm_data
decl_stmt|;
union|union
block|{
struct|struct
block|{
name|uint64_t
name|remote_addr
decl_stmt|;
name|uint32_t
name|rkey
decl_stmt|;
block|}
name|rdma
struct|;
struct|struct
block|{
name|uint64_t
name|remote_addr
decl_stmt|;
name|uint64_t
name|compare_add
decl_stmt|;
name|uint64_t
name|swap
decl_stmt|;
name|uint32_t
name|rkey
decl_stmt|;
block|}
name|atomic
struct|;
struct|struct
block|{
name|struct
name|ibv_ah_1_0
modifier|*
name|ah
decl_stmt|;
name|uint32_t
name|remote_qpn
decl_stmt|;
name|uint32_t
name|remote_qkey
decl_stmt|;
block|}
name|ud
struct|;
block|}
name|wr
union|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|ibv_recv_wr_1_0
block|{
name|struct
name|ibv_recv_wr_1_0
modifier|*
name|next
decl_stmt|;
name|uint64_t
name|wr_id
decl_stmt|;
name|struct
name|ibv_sge
modifier|*
name|sg_list
decl_stmt|;
name|int
name|num_sge
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|ibv_qp_1_0
block|{
name|struct
name|ibv_context_1_0
modifier|*
name|context
decl_stmt|;
name|void
modifier|*
name|qp_context
decl_stmt|;
name|struct
name|ibv_pd_1_0
modifier|*
name|pd
decl_stmt|;
name|struct
name|ibv_cq_1_0
modifier|*
name|send_cq
decl_stmt|;
name|struct
name|ibv_cq_1_0
modifier|*
name|recv_cq
decl_stmt|;
name|struct
name|ibv_srq_1_0
modifier|*
name|srq
decl_stmt|;
name|uint32_t
name|handle
decl_stmt|;
name|uint32_t
name|qp_num
decl_stmt|;
name|enum
name|ibv_qp_state
name|state
decl_stmt|;
name|enum
name|ibv_qp_type
name|qp_type
decl_stmt|;
name|pthread_mutex_t
name|mutex
decl_stmt|;
name|pthread_cond_t
name|cond
decl_stmt|;
name|uint32_t
name|events_completed
decl_stmt|;
name|struct
name|ibv_qp
modifier|*
name|real_qp
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|ibv_cq_1_0
block|{
name|struct
name|ibv_context_1_0
modifier|*
name|context
decl_stmt|;
name|void
modifier|*
name|cq_context
decl_stmt|;
name|uint32_t
name|handle
decl_stmt|;
name|int
name|cqe
decl_stmt|;
name|pthread_mutex_t
name|mutex
decl_stmt|;
name|pthread_cond_t
name|cond
decl_stmt|;
name|uint32_t
name|comp_events_completed
decl_stmt|;
name|uint32_t
name|async_events_completed
decl_stmt|;
name|struct
name|ibv_cq
modifier|*
name|real_cq
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|ibv_ah_1_0
block|{
name|struct
name|ibv_context_1_0
modifier|*
name|context
decl_stmt|;
name|struct
name|ibv_pd_1_0
modifier|*
name|pd
decl_stmt|;
name|uint32_t
name|handle
decl_stmt|;
name|struct
name|ibv_ah
modifier|*
name|real_ah
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|ibv_device_1_0
block|{
name|void
modifier|*
name|obsolete_sysfs_dev
decl_stmt|;
name|void
modifier|*
name|obsolete_sysfs_ibdev
decl_stmt|;
name|struct
name|ibv_device
modifier|*
name|real_device
decl_stmt|;
comment|/* was obsolete driver member */
name|struct
name|_ibv_device_ops
name|_ops
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|ibv_context_ops_1_0
block|{
name|int
function_decl|(
modifier|*
name|query_device
function_decl|)
parameter_list|(
name|struct
name|ibv_context
modifier|*
name|context
parameter_list|,
name|struct
name|ibv_device_attr
modifier|*
name|device_attr
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|query_port
function_decl|)
parameter_list|(
name|struct
name|ibv_context
modifier|*
name|context
parameter_list|,
name|uint8_t
name|port_num
parameter_list|,
name|struct
name|ibv_port_attr
modifier|*
name|port_attr
parameter_list|)
function_decl|;
name|struct
name|ibv_pd
modifier|*
function_decl|(
modifier|*
name|alloc_pd
function_decl|)
parameter_list|(
name|struct
name|ibv_context
modifier|*
name|context
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|dealloc_pd
function_decl|)
parameter_list|(
name|struct
name|ibv_pd
modifier|*
name|pd
parameter_list|)
function_decl|;
name|struct
name|ibv_mr
modifier|*
function_decl|(
modifier|*
name|reg_mr
function_decl|)
parameter_list|(
name|struct
name|ibv_pd
modifier|*
name|pd
parameter_list|,
name|void
modifier|*
name|addr
parameter_list|,
name|size_t
name|length
parameter_list|,
name|int
name|access
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|dereg_mr
function_decl|)
parameter_list|(
name|struct
name|ibv_mr
modifier|*
name|mr
parameter_list|)
function_decl|;
name|struct
name|ibv_cq
modifier|*
function_decl|(
modifier|*
name|create_cq
function_decl|)
parameter_list|(
name|struct
name|ibv_context
modifier|*
name|context
parameter_list|,
name|int
name|cqe
parameter_list|,
name|struct
name|ibv_comp_channel
modifier|*
name|channel
parameter_list|,
name|int
name|comp_vector
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|poll_cq
function_decl|)
parameter_list|(
name|struct
name|ibv_cq_1_0
modifier|*
name|cq
parameter_list|,
name|int
name|num_entries
parameter_list|,
name|struct
name|ibv_wc
modifier|*
name|wc
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|req_notify_cq
function_decl|)
parameter_list|(
name|struct
name|ibv_cq_1_0
modifier|*
name|cq
parameter_list|,
name|int
name|solicited_only
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|cq_event
function_decl|)
parameter_list|(
name|struct
name|ibv_cq
modifier|*
name|cq
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|resize_cq
function_decl|)
parameter_list|(
name|struct
name|ibv_cq
modifier|*
name|cq
parameter_list|,
name|int
name|cqe
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|destroy_cq
function_decl|)
parameter_list|(
name|struct
name|ibv_cq
modifier|*
name|cq
parameter_list|)
function_decl|;
name|struct
name|ibv_srq
modifier|*
function_decl|(
modifier|*
name|create_srq
function_decl|)
parameter_list|(
name|struct
name|ibv_pd
modifier|*
name|pd
parameter_list|,
name|struct
name|ibv_srq_init_attr
modifier|*
name|srq_init_attr
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|modify_srq
function_decl|)
parameter_list|(
name|struct
name|ibv_srq
modifier|*
name|srq
parameter_list|,
name|struct
name|ibv_srq_attr
modifier|*
name|srq_attr
parameter_list|,
name|int
name|srq_attr_mask
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|query_srq
function_decl|)
parameter_list|(
name|struct
name|ibv_srq
modifier|*
name|srq
parameter_list|,
name|struct
name|ibv_srq_attr
modifier|*
name|srq_attr
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|destroy_srq
function_decl|)
parameter_list|(
name|struct
name|ibv_srq
modifier|*
name|srq
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|post_srq_recv
function_decl|)
parameter_list|(
name|struct
name|ibv_srq_1_0
modifier|*
name|srq
parameter_list|,
name|struct
name|ibv_recv_wr_1_0
modifier|*
name|recv_wr
parameter_list|,
name|struct
name|ibv_recv_wr_1_0
modifier|*
modifier|*
name|bad_recv_wr
parameter_list|)
function_decl|;
name|struct
name|ibv_qp
modifier|*
function_decl|(
modifier|*
name|create_qp
function_decl|)
parameter_list|(
name|struct
name|ibv_pd
modifier|*
name|pd
parameter_list|,
name|struct
name|ibv_qp_init_attr
modifier|*
name|attr
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|query_qp
function_decl|)
parameter_list|(
name|struct
name|ibv_qp
modifier|*
name|qp
parameter_list|,
name|struct
name|ibv_qp_attr
modifier|*
name|attr
parameter_list|,
name|int
name|attr_mask
parameter_list|,
name|struct
name|ibv_qp_init_attr
modifier|*
name|init_attr
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|modify_qp
function_decl|)
parameter_list|(
name|struct
name|ibv_qp
modifier|*
name|qp
parameter_list|,
name|struct
name|ibv_qp_attr
modifier|*
name|attr
parameter_list|,
name|int
name|attr_mask
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|destroy_qp
function_decl|)
parameter_list|(
name|struct
name|ibv_qp
modifier|*
name|qp
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|post_send
function_decl|)
parameter_list|(
name|struct
name|ibv_qp_1_0
modifier|*
name|qp
parameter_list|,
name|struct
name|ibv_send_wr_1_0
modifier|*
name|wr
parameter_list|,
name|struct
name|ibv_send_wr_1_0
modifier|*
modifier|*
name|bad_wr
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|post_recv
function_decl|)
parameter_list|(
name|struct
name|ibv_qp_1_0
modifier|*
name|qp
parameter_list|,
name|struct
name|ibv_recv_wr_1_0
modifier|*
name|wr
parameter_list|,
name|struct
name|ibv_recv_wr_1_0
modifier|*
modifier|*
name|bad_wr
parameter_list|)
function_decl|;
name|struct
name|ibv_ah
modifier|*
function_decl|(
modifier|*
name|create_ah
function_decl|)
parameter_list|(
name|struct
name|ibv_pd
modifier|*
name|pd
parameter_list|,
name|struct
name|ibv_ah_attr
modifier|*
name|attr
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|destroy_ah
function_decl|)
parameter_list|(
name|struct
name|ibv_ah
modifier|*
name|ah
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|attach_mcast
function_decl|)
parameter_list|(
name|struct
name|ibv_qp
modifier|*
name|qp
parameter_list|,
name|union
name|ibv_gid
modifier|*
name|gid
parameter_list|,
name|uint16_t
name|lid
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|detach_mcast
function_decl|)
parameter_list|(
name|struct
name|ibv_qp
modifier|*
name|qp
parameter_list|,
name|union
name|ibv_gid
modifier|*
name|gid
parameter_list|,
name|uint16_t
name|lid
parameter_list|)
function_decl|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|ibv_context_1_0
block|{
name|struct
name|ibv_device_1_0
modifier|*
name|device
decl_stmt|;
name|struct
name|ibv_context_ops_1_0
name|ops
decl_stmt|;
name|int
name|cmd_fd
decl_stmt|;
name|int
name|async_fd
decl_stmt|;
name|int
name|num_comp_vectors
decl_stmt|;
name|struct
name|ibv_context
modifier|*
name|real_context
decl_stmt|;
comment|/* was abi_compat member */
block|}
struct|;
end_struct

begin_typedef
typedef|typedef
name|struct
name|ibv_device
modifier|*
function_decl|(
modifier|*
name|ibv_driver_init_func_1_1
function_decl|)
parameter_list|(
specifier|const
name|char
modifier|*
name|uverbs_sys_path
parameter_list|,
name|int
name|abi_version
parameter_list|)
function_decl|;
end_typedef

begin_comment
comment|/* Hack to avoid GCC's -Wmissing-prototypes and the similar error from sparse    with these prototypes. Symbol versionining requires the goofy names, the    prototype must match the version in the historical 1.0 verbs.h.  */
end_comment

begin_function_decl
name|struct
name|ibv_device_1_0
modifier|*
modifier|*
name|__ibv_get_device_list_1_0
parameter_list|(
name|int
modifier|*
name|num
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|__ibv_free_device_list_1_0
parameter_list|(
name|struct
name|ibv_device_1_0
modifier|*
modifier|*
name|list
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|const
name|char
modifier|*
name|__ibv_get_device_name_1_0
parameter_list|(
name|struct
name|ibv_device_1_0
modifier|*
name|device
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|__be64
name|__ibv_get_device_guid_1_0
parameter_list|(
name|struct
name|ibv_device_1_0
modifier|*
name|device
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|ibv_context_1_0
modifier|*
name|__ibv_open_device_1_0
parameter_list|(
name|struct
name|ibv_device_1_0
modifier|*
name|device
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_close_device_1_0
parameter_list|(
name|struct
name|ibv_context_1_0
modifier|*
name|context
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_get_async_event_1_0
parameter_list|(
name|struct
name|ibv_context_1_0
modifier|*
name|context
parameter_list|,
name|struct
name|ibv_async_event
modifier|*
name|event
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|__ibv_ack_async_event_1_0
parameter_list|(
name|struct
name|ibv_async_event
modifier|*
name|event
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_query_device_1_0
parameter_list|(
name|struct
name|ibv_context_1_0
modifier|*
name|context
parameter_list|,
name|struct
name|ibv_device_attr
modifier|*
name|device_attr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_query_port_1_0
parameter_list|(
name|struct
name|ibv_context_1_0
modifier|*
name|context
parameter_list|,
name|uint8_t
name|port_num
parameter_list|,
name|struct
name|ibv_port_attr
modifier|*
name|port_attr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_query_gid_1_0
parameter_list|(
name|struct
name|ibv_context_1_0
modifier|*
name|context
parameter_list|,
name|uint8_t
name|port_num
parameter_list|,
name|int
name|index
parameter_list|,
name|union
name|ibv_gid
modifier|*
name|gid
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_query_pkey_1_0
parameter_list|(
name|struct
name|ibv_context_1_0
modifier|*
name|context
parameter_list|,
name|uint8_t
name|port_num
parameter_list|,
name|int
name|index
parameter_list|,
name|__be16
modifier|*
name|pkey
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|ibv_pd_1_0
modifier|*
name|__ibv_alloc_pd_1_0
parameter_list|(
name|struct
name|ibv_context_1_0
modifier|*
name|context
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_dealloc_pd_1_0
parameter_list|(
name|struct
name|ibv_pd_1_0
modifier|*
name|pd
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|ibv_mr_1_0
modifier|*
name|__ibv_reg_mr_1_0
parameter_list|(
name|struct
name|ibv_pd_1_0
modifier|*
name|pd
parameter_list|,
name|void
modifier|*
name|addr
parameter_list|,
name|size_t
name|length
parameter_list|,
name|int
name|access
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_dereg_mr_1_0
parameter_list|(
name|struct
name|ibv_mr_1_0
modifier|*
name|mr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|ibv_cq_1_0
modifier|*
name|__ibv_create_cq_1_0
parameter_list|(
name|struct
name|ibv_context_1_0
modifier|*
name|context
parameter_list|,
name|int
name|cqe
parameter_list|,
name|void
modifier|*
name|cq_context
parameter_list|,
name|struct
name|ibv_comp_channel
modifier|*
name|channel
parameter_list|,
name|int
name|comp_vector
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_resize_cq_1_0
parameter_list|(
name|struct
name|ibv_cq_1_0
modifier|*
name|cq
parameter_list|,
name|int
name|cqe
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_destroy_cq_1_0
parameter_list|(
name|struct
name|ibv_cq_1_0
modifier|*
name|cq
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_get_cq_event_1_0
parameter_list|(
name|struct
name|ibv_comp_channel
modifier|*
name|channel
parameter_list|,
name|struct
name|ibv_cq_1_0
modifier|*
modifier|*
name|cq
parameter_list|,
name|void
modifier|*
modifier|*
name|cq_context
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|__ibv_ack_cq_events_1_0
parameter_list|(
name|struct
name|ibv_cq_1_0
modifier|*
name|cq
parameter_list|,
name|unsigned
name|int
name|nevents
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|ibv_srq_1_0
modifier|*
name|__ibv_create_srq_1_0
parameter_list|(
name|struct
name|ibv_pd_1_0
modifier|*
name|pd
parameter_list|,
name|struct
name|ibv_srq_init_attr
modifier|*
name|srq_init_attr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_modify_srq_1_0
parameter_list|(
name|struct
name|ibv_srq_1_0
modifier|*
name|srq
parameter_list|,
name|struct
name|ibv_srq_attr
modifier|*
name|srq_attr
parameter_list|,
name|int
name|srq_attr_mask
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_query_srq_1_0
parameter_list|(
name|struct
name|ibv_srq_1_0
modifier|*
name|srq
parameter_list|,
name|struct
name|ibv_srq_attr
modifier|*
name|srq_attr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_destroy_srq_1_0
parameter_list|(
name|struct
name|ibv_srq_1_0
modifier|*
name|srq
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|ibv_qp_1_0
modifier|*
name|__ibv_create_qp_1_0
parameter_list|(
name|struct
name|ibv_pd_1_0
modifier|*
name|pd
parameter_list|,
name|struct
name|ibv_qp_init_attr_1_0
modifier|*
name|qp_init_attr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_query_qp_1_0
parameter_list|(
name|struct
name|ibv_qp_1_0
modifier|*
name|qp
parameter_list|,
name|struct
name|ibv_qp_attr
modifier|*
name|attr
parameter_list|,
name|int
name|attr_mask
parameter_list|,
name|struct
name|ibv_qp_init_attr_1_0
modifier|*
name|init_attr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_modify_qp_1_0
parameter_list|(
name|struct
name|ibv_qp_1_0
modifier|*
name|qp
parameter_list|,
name|struct
name|ibv_qp_attr
modifier|*
name|attr
parameter_list|,
name|int
name|attr_mask
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_destroy_qp_1_0
parameter_list|(
name|struct
name|ibv_qp_1_0
modifier|*
name|qp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|ibv_ah_1_0
modifier|*
name|__ibv_create_ah_1_0
parameter_list|(
name|struct
name|ibv_pd_1_0
modifier|*
name|pd
parameter_list|,
name|struct
name|ibv_ah_attr
modifier|*
name|attr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_destroy_ah_1_0
parameter_list|(
name|struct
name|ibv_ah_1_0
modifier|*
name|ah
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_attach_mcast_1_0
parameter_list|(
name|struct
name|ibv_qp_1_0
modifier|*
name|qp
parameter_list|,
name|union
name|ibv_gid
modifier|*
name|gid
parameter_list|,
name|uint16_t
name|lid
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|__ibv_detach_mcast_1_0
parameter_list|(
name|struct
name|ibv_qp_1_0
modifier|*
name|qp
parameter_list|,
name|union
name|ibv_gid
modifier|*
name|gid
parameter_list|,
name|uint16_t
name|lid
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|__ibv_register_driver_1_1
parameter_list|(
specifier|const
name|char
modifier|*
name|name
parameter_list|,
name|ibv_driver_init_func_1_1
name|init_func
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|struct
name|ibv_device_1_0
modifier|*
modifier|*
name|__ibv_get_device_list_1_0
parameter_list|(
name|int
modifier|*
name|num
parameter_list|)
block|{
name|struct
name|ibv_device
modifier|*
modifier|*
name|real_list
decl_stmt|;
name|struct
name|ibv_device_1_0
modifier|*
modifier|*
name|l
decl_stmt|;
name|int
name|i
decl_stmt|,
name|n
decl_stmt|;
name|real_list
operator|=
name|ibv_get_device_list
argument_list|(
operator|&
name|n
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|real_list
condition|)
return|return
name|NULL
return|;
name|l
operator|=
name|calloc
argument_list|(
name|n
operator|+
literal|2
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|ibv_device_1_0
operator|*
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|l
condition|)
goto|goto
name|free_device_list
goto|;
name|l
index|[
literal|0
index|]
operator|=
operator|(
name|void
operator|*
operator|)
name|real_list
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|n
condition|;
operator|++
name|i
control|)
block|{
name|l
index|[
name|i
operator|+
literal|1
index|]
operator|=
name|calloc
argument_list|(
literal|1
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|ibv_device_1_0
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|l
index|[
name|i
operator|+
literal|1
index|]
condition|)
goto|goto
name|fail
goto|;
name|l
index|[
name|i
operator|+
literal|1
index|]
operator|->
name|real_device
operator|=
name|real_list
index|[
name|i
index|]
expr_stmt|;
block|}
if|if
condition|(
name|num
condition|)
operator|*
name|num
operator|=
name|n
expr_stmt|;
return|return
name|l
operator|+
literal|1
return|;
name|fail
label|:
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<=
name|n
condition|;
operator|++
name|i
control|)
if|if
condition|(
name|l
index|[
name|i
index|]
condition|)
name|free
argument_list|(
name|l
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|l
argument_list|)
expr_stmt|;
name|free_device_list
label|:
name|ibv_free_device_list
argument_list|(
name|real_list
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_get_device_list_1_0
argument_list|,
name|ibv_get_device_list
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|void
name|__ibv_free_device_list_1_0
parameter_list|(
name|struct
name|ibv_device_1_0
modifier|*
modifier|*
name|list
parameter_list|)
block|{
name|struct
name|ibv_device_1_0
modifier|*
modifier|*
name|l
init|=
name|list
decl_stmt|;
while|while
condition|(
operator|*
name|l
condition|)
block|{
name|free
argument_list|(
operator|*
name|l
argument_list|)
expr_stmt|;
operator|++
name|l
expr_stmt|;
block|}
name|ibv_free_device_list
argument_list|(
operator|(
name|void
operator|*
operator|)
name|list
index|[
operator|-
literal|1
index|]
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|list
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_free_device_list_1_0
argument_list|,
name|ibv_free_device_list
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
specifier|const
name|char
modifier|*
name|__ibv_get_device_name_1_0
parameter_list|(
name|struct
name|ibv_device_1_0
modifier|*
name|device
parameter_list|)
block|{
return|return
name|ibv_get_device_name
argument_list|(
name|device
operator|->
name|real_device
argument_list|)
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_get_device_name_1_0
argument_list|,
name|ibv_get_device_name
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|__be64
name|__ibv_get_device_guid_1_0
parameter_list|(
name|struct
name|ibv_device_1_0
modifier|*
name|device
parameter_list|)
block|{
return|return
name|ibv_get_device_guid
argument_list|(
name|device
operator|->
name|real_device
argument_list|)
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_get_device_guid_1_0
argument_list|,
name|ibv_get_device_guid
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
specifier|static
name|int
name|poll_cq_wrapper_1_0
parameter_list|(
name|struct
name|ibv_cq_1_0
modifier|*
name|cq
parameter_list|,
name|int
name|num_entries
parameter_list|,
name|struct
name|ibv_wc
modifier|*
name|wc
parameter_list|)
block|{
return|return
name|cq
operator|->
name|context
operator|->
name|real_context
operator|->
name|ops
operator|.
name|poll_cq
argument_list|(
name|cq
operator|->
name|real_cq
argument_list|,
name|num_entries
argument_list|,
name|wc
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|req_notify_cq_wrapper_1_0
parameter_list|(
name|struct
name|ibv_cq_1_0
modifier|*
name|cq
parameter_list|,
name|int
name|sol_only
parameter_list|)
block|{
return|return
name|cq
operator|->
name|context
operator|->
name|real_context
operator|->
name|ops
operator|.
name|req_notify_cq
argument_list|(
name|cq
operator|->
name|real_cq
argument_list|,
name|sol_only
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|post_srq_recv_wrapper_1_0
parameter_list|(
name|struct
name|ibv_srq_1_0
modifier|*
name|srq
parameter_list|,
name|struct
name|ibv_recv_wr_1_0
modifier|*
name|wr
parameter_list|,
name|struct
name|ibv_recv_wr_1_0
modifier|*
modifier|*
name|bad_wr
parameter_list|)
block|{
name|struct
name|ibv_recv_wr_1_0
modifier|*
name|w
decl_stmt|;
name|struct
name|ibv_recv_wr
modifier|*
name|real_wr
decl_stmt|,
modifier|*
name|head_wr
init|=
name|NULL
decl_stmt|,
modifier|*
name|tail_wr
init|=
name|NULL
decl_stmt|,
modifier|*
name|real_bad_wr
decl_stmt|;
name|int
name|ret
decl_stmt|;
for|for
control|(
name|w
operator|=
name|wr
init|;
name|w
condition|;
name|w
operator|=
name|w
operator|->
name|next
control|)
block|{
name|real_wr
operator|=
name|alloca
argument_list|(
sizeof|sizeof
expr|*
name|real_wr
argument_list|)
expr_stmt|;
name|real_wr
operator|->
name|wr_id
operator|=
name|w
operator|->
name|wr_id
expr_stmt|;
name|real_wr
operator|->
name|sg_list
operator|=
name|w
operator|->
name|sg_list
expr_stmt|;
name|real_wr
operator|->
name|num_sge
operator|=
name|w
operator|->
name|num_sge
expr_stmt|;
name|real_wr
operator|->
name|next
operator|=
name|NULL
expr_stmt|;
if|if
condition|(
name|tail_wr
condition|)
name|tail_wr
operator|->
name|next
operator|=
name|real_wr
expr_stmt|;
else|else
name|head_wr
operator|=
name|real_wr
expr_stmt|;
name|tail_wr
operator|=
name|real_wr
expr_stmt|;
block|}
name|ret
operator|=
name|srq
operator|->
name|context
operator|->
name|real_context
operator|->
name|ops
operator|.
name|post_srq_recv
argument_list|(
name|srq
operator|->
name|real_srq
argument_list|,
name|head_wr
argument_list|,
operator|&
name|real_bad_wr
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
condition|)
block|{
for|for
control|(
name|real_wr
operator|=
name|head_wr
operator|,
name|w
operator|=
name|wr
init|;
name|real_wr
condition|;
name|real_wr
operator|=
name|real_wr
operator|->
name|next
operator|,
name|w
operator|=
name|w
operator|->
name|next
control|)
if|if
condition|(
name|real_wr
operator|==
name|real_bad_wr
condition|)
block|{
operator|*
name|bad_wr
operator|=
name|w
expr_stmt|;
break|break;
block|}
block|}
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|post_send_wrapper_1_0
parameter_list|(
name|struct
name|ibv_qp_1_0
modifier|*
name|qp
parameter_list|,
name|struct
name|ibv_send_wr_1_0
modifier|*
name|wr
parameter_list|,
name|struct
name|ibv_send_wr_1_0
modifier|*
modifier|*
name|bad_wr
parameter_list|)
block|{
name|struct
name|ibv_send_wr_1_0
modifier|*
name|w
decl_stmt|;
name|struct
name|ibv_send_wr
modifier|*
name|real_wr
decl_stmt|,
modifier|*
name|head_wr
init|=
name|NULL
decl_stmt|,
modifier|*
name|tail_wr
init|=
name|NULL
decl_stmt|,
modifier|*
name|real_bad_wr
decl_stmt|;
name|int
name|is_ud
init|=
name|qp
operator|->
name|qp_type
operator|==
name|IBV_QPT_UD
decl_stmt|;
name|int
name|ret
decl_stmt|;
for|for
control|(
name|w
operator|=
name|wr
init|;
name|w
condition|;
name|w
operator|=
name|w
operator|->
name|next
control|)
block|{
name|real_wr
operator|=
name|alloca
argument_list|(
sizeof|sizeof
expr|*
name|real_wr
argument_list|)
expr_stmt|;
name|real_wr
operator|->
name|wr_id
operator|=
name|w
operator|->
name|wr_id
expr_stmt|;
name|real_wr
operator|->
name|next
operator|=
name|NULL
expr_stmt|;
define|#
directive|define
name|TEST_SIZE_2_POINT
parameter_list|(
name|f1
parameter_list|,
name|f2
parameter_list|)
define|\
value|((offsetof(struct ibv_send_wr, f1) - offsetof(struct ibv_send_wr, f2)) \ 		 == offsetof(struct ibv_send_wr_1_0, f1) - offsetof(struct ibv_send_wr_1_0, f2))
define|#
directive|define
name|TEST_SIZE_TO_END
parameter_list|(
name|f1
parameter_list|)
define|\
value|((sizeof(struct ibv_send_wr) - offsetof(struct ibv_send_wr, f1)) == \ 		 (sizeof(struct ibv_send_wr_1_0) - offsetof(struct ibv_send_wr_1_0, f1)))
if|if
condition|(
name|TEST_SIZE_TO_END
argument_list|(
name|sg_list
argument_list|)
condition|)
name|memcpy
argument_list|(
operator|&
name|real_wr
operator|->
name|sg_list
argument_list|,
operator|&
name|w
operator|->
name|sg_list
argument_list|,
sizeof|sizeof
expr|*
name|real_wr
operator|-
name|offsetof
argument_list|(
expr|struct
name|ibv_send_wr
argument_list|,
name|sg_list
argument_list|)
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|TEST_SIZE_2_POINT
argument_list|(
name|imm_data
argument_list|,
name|sg_list
argument_list|)
operator|&&
name|TEST_SIZE_TO_END
argument_list|(
name|wr
argument_list|)
condition|)
block|{
comment|/* we have alignment up to wr, but padding between 			 * imm_data and wr, and we know wr itself is the 			 * same size */
name|memcpy
argument_list|(
operator|&
name|real_wr
operator|->
name|sg_list
argument_list|,
operator|&
name|w
operator|->
name|sg_list
argument_list|,
name|offsetof
argument_list|(
expr|struct
name|ibv_send_wr
argument_list|,
name|imm_data
argument_list|)
operator|-
name|offsetof
argument_list|(
expr|struct
name|ibv_send_wr
argument_list|,
name|sg_list
argument_list|)
operator|+
sizeof|sizeof
name|real_wr
operator|->
name|imm_data
argument_list|)
expr_stmt|;
name|memcpy
argument_list|(
operator|&
name|real_wr
operator|->
name|wr
argument_list|,
operator|&
name|w
operator|->
name|wr
argument_list|,
sizeof|sizeof
name|real_wr
operator|->
name|wr
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|real_wr
operator|->
name|sg_list
operator|=
name|w
operator|->
name|sg_list
expr_stmt|;
name|real_wr
operator|->
name|num_sge
operator|=
name|w
operator|->
name|num_sge
expr_stmt|;
name|real_wr
operator|->
name|opcode
operator|=
name|w
operator|->
name|opcode
expr_stmt|;
name|real_wr
operator|->
name|send_flags
operator|=
name|w
operator|->
name|send_flags
expr_stmt|;
name|real_wr
operator|->
name|imm_data
operator|=
name|w
operator|->
name|imm_data
expr_stmt|;
if|if
condition|(
name|TEST_SIZE_TO_END
argument_list|(
name|wr
argument_list|)
condition|)
name|memcpy
argument_list|(
operator|&
name|real_wr
operator|->
name|wr
argument_list|,
operator|&
name|w
operator|->
name|wr
argument_list|,
sizeof|sizeof
name|real_wr
operator|->
name|wr
argument_list|)
expr_stmt|;
else|else
block|{
name|real_wr
operator|->
name|wr
operator|.
name|atomic
operator|.
name|remote_addr
operator|=
name|w
operator|->
name|wr
operator|.
name|atomic
operator|.
name|remote_addr
expr_stmt|;
name|real_wr
operator|->
name|wr
operator|.
name|atomic
operator|.
name|compare_add
operator|=
name|w
operator|->
name|wr
operator|.
name|atomic
operator|.
name|compare_add
expr_stmt|;
name|real_wr
operator|->
name|wr
operator|.
name|atomic
operator|.
name|swap
operator|=
name|w
operator|->
name|wr
operator|.
name|atomic
operator|.
name|swap
expr_stmt|;
name|real_wr
operator|->
name|wr
operator|.
name|atomic
operator|.
name|rkey
operator|=
name|w
operator|->
name|wr
operator|.
name|atomic
operator|.
name|rkey
expr_stmt|;
block|}
block|}
if|if
condition|(
name|is_ud
condition|)
name|real_wr
operator|->
name|wr
operator|.
name|ud
operator|.
name|ah
operator|=
name|w
operator|->
name|wr
operator|.
name|ud
operator|.
name|ah
operator|->
name|real_ah
expr_stmt|;
if|if
condition|(
name|tail_wr
condition|)
name|tail_wr
operator|->
name|next
operator|=
name|real_wr
expr_stmt|;
else|else
name|head_wr
operator|=
name|real_wr
expr_stmt|;
name|tail_wr
operator|=
name|real_wr
expr_stmt|;
block|}
name|ret
operator|=
name|qp
operator|->
name|context
operator|->
name|real_context
operator|->
name|ops
operator|.
name|post_send
argument_list|(
name|qp
operator|->
name|real_qp
argument_list|,
name|head_wr
argument_list|,
operator|&
name|real_bad_wr
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
condition|)
block|{
for|for
control|(
name|real_wr
operator|=
name|head_wr
operator|,
name|w
operator|=
name|wr
init|;
name|real_wr
condition|;
name|real_wr
operator|=
name|real_wr
operator|->
name|next
operator|,
name|w
operator|=
name|w
operator|->
name|next
control|)
if|if
condition|(
name|real_wr
operator|==
name|real_bad_wr
condition|)
block|{
operator|*
name|bad_wr
operator|=
name|w
expr_stmt|;
break|break;
block|}
block|}
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|post_recv_wrapper_1_0
parameter_list|(
name|struct
name|ibv_qp_1_0
modifier|*
name|qp
parameter_list|,
name|struct
name|ibv_recv_wr_1_0
modifier|*
name|wr
parameter_list|,
name|struct
name|ibv_recv_wr_1_0
modifier|*
modifier|*
name|bad_wr
parameter_list|)
block|{
name|struct
name|ibv_recv_wr_1_0
modifier|*
name|w
decl_stmt|;
name|struct
name|ibv_recv_wr
modifier|*
name|real_wr
decl_stmt|,
modifier|*
name|head_wr
init|=
name|NULL
decl_stmt|,
modifier|*
name|tail_wr
init|=
name|NULL
decl_stmt|,
modifier|*
name|real_bad_wr
decl_stmt|;
name|int
name|ret
decl_stmt|;
for|for
control|(
name|w
operator|=
name|wr
init|;
name|w
condition|;
name|w
operator|=
name|w
operator|->
name|next
control|)
block|{
name|real_wr
operator|=
name|alloca
argument_list|(
sizeof|sizeof
expr|*
name|real_wr
argument_list|)
expr_stmt|;
name|real_wr
operator|->
name|wr_id
operator|=
name|w
operator|->
name|wr_id
expr_stmt|;
name|real_wr
operator|->
name|sg_list
operator|=
name|w
operator|->
name|sg_list
expr_stmt|;
name|real_wr
operator|->
name|num_sge
operator|=
name|w
operator|->
name|num_sge
expr_stmt|;
name|real_wr
operator|->
name|next
operator|=
name|NULL
expr_stmt|;
if|if
condition|(
name|tail_wr
condition|)
name|tail_wr
operator|->
name|next
operator|=
name|real_wr
expr_stmt|;
else|else
name|head_wr
operator|=
name|real_wr
expr_stmt|;
name|tail_wr
operator|=
name|real_wr
expr_stmt|;
block|}
name|ret
operator|=
name|qp
operator|->
name|context
operator|->
name|real_context
operator|->
name|ops
operator|.
name|post_recv
argument_list|(
name|qp
operator|->
name|real_qp
argument_list|,
name|head_wr
argument_list|,
operator|&
name|real_bad_wr
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
condition|)
block|{
for|for
control|(
name|real_wr
operator|=
name|head_wr
operator|,
name|w
operator|=
name|wr
init|;
name|real_wr
condition|;
name|real_wr
operator|=
name|real_wr
operator|->
name|next
operator|,
name|w
operator|=
name|w
operator|->
name|next
control|)
if|if
condition|(
name|real_wr
operator|==
name|real_bad_wr
condition|)
block|{
operator|*
name|bad_wr
operator|=
name|w
expr_stmt|;
break|break;
block|}
block|}
return|return
name|ret
return|;
block|}
end_function

begin_function
name|struct
name|ibv_context_1_0
modifier|*
name|__ibv_open_device_1_0
parameter_list|(
name|struct
name|ibv_device_1_0
modifier|*
name|device
parameter_list|)
block|{
name|struct
name|ibv_context
modifier|*
name|real_ctx
decl_stmt|;
name|struct
name|ibv_context_1_0
modifier|*
name|ctx
decl_stmt|;
name|ctx
operator|=
name|malloc
argument_list|(
sizeof|sizeof
expr|*
name|ctx
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|ctx
condition|)
return|return
name|NULL
return|;
name|real_ctx
operator|=
name|ibv_open_device
argument_list|(
name|device
operator|->
name|real_device
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|real_ctx
condition|)
block|{
name|free
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|ctx
operator|->
name|device
operator|=
name|device
expr_stmt|;
name|ctx
operator|->
name|real_context
operator|=
name|real_ctx
expr_stmt|;
name|ctx
operator|->
name|ops
operator|.
name|poll_cq
operator|=
name|poll_cq_wrapper_1_0
expr_stmt|;
name|ctx
operator|->
name|ops
operator|.
name|req_notify_cq
operator|=
name|req_notify_cq_wrapper_1_0
expr_stmt|;
name|ctx
operator|->
name|ops
operator|.
name|post_send
operator|=
name|post_send_wrapper_1_0
expr_stmt|;
name|ctx
operator|->
name|ops
operator|.
name|post_recv
operator|=
name|post_recv_wrapper_1_0
expr_stmt|;
name|ctx
operator|->
name|ops
operator|.
name|post_srq_recv
operator|=
name|post_srq_recv_wrapper_1_0
expr_stmt|;
return|return
name|ctx
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_open_device_1_0
argument_list|,
name|ibv_open_device
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_close_device_1_0
parameter_list|(
name|struct
name|ibv_context_1_0
modifier|*
name|context
parameter_list|)
block|{
name|int
name|ret
decl_stmt|;
name|ret
operator|=
name|ibv_close_device
argument_list|(
name|context
operator|->
name|real_context
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
condition|)
return|return
name|ret
return|;
name|free
argument_list|(
name|context
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_close_device_1_0
argument_list|,
name|ibv_close_device
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_get_async_event_1_0
parameter_list|(
name|struct
name|ibv_context_1_0
modifier|*
name|context
parameter_list|,
name|struct
name|ibv_async_event
modifier|*
name|event
parameter_list|)
block|{
name|int
name|ret
decl_stmt|;
name|ret
operator|=
name|ibv_get_async_event
argument_list|(
name|context
operator|->
name|real_context
argument_list|,
name|event
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
condition|)
return|return
name|ret
return|;
switch|switch
condition|(
name|event
operator|->
name|event_type
condition|)
block|{
case|case
name|IBV_EVENT_CQ_ERR
case|:
name|event
operator|->
name|element
operator|.
name|cq
operator|=
name|event
operator|->
name|element
operator|.
name|cq
operator|->
name|cq_context
expr_stmt|;
break|break;
case|case
name|IBV_EVENT_QP_FATAL
case|:
case|case
name|IBV_EVENT_QP_REQ_ERR
case|:
case|case
name|IBV_EVENT_QP_ACCESS_ERR
case|:
case|case
name|IBV_EVENT_COMM_EST
case|:
case|case
name|IBV_EVENT_SQ_DRAINED
case|:
case|case
name|IBV_EVENT_PATH_MIG
case|:
case|case
name|IBV_EVENT_PATH_MIG_ERR
case|:
case|case
name|IBV_EVENT_QP_LAST_WQE_REACHED
case|:
name|event
operator|->
name|element
operator|.
name|qp
operator|=
name|event
operator|->
name|element
operator|.
name|qp
operator|->
name|qp_context
expr_stmt|;
break|break;
case|case
name|IBV_EVENT_SRQ_ERR
case|:
case|case
name|IBV_EVENT_SRQ_LIMIT_REACHED
case|:
name|event
operator|->
name|element
operator|.
name|srq
operator|=
name|event
operator|->
name|element
operator|.
name|srq
operator|->
name|srq_context
expr_stmt|;
break|break;
default|default:
break|break;
block|}
return|return
name|ret
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_get_async_event_1_0
argument_list|,
name|ibv_get_async_event
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|void
name|__ibv_ack_async_event_1_0
parameter_list|(
name|struct
name|ibv_async_event
modifier|*
name|event
parameter_list|)
block|{
name|struct
name|ibv_async_event
name|real_event
init|=
operator|*
name|event
decl_stmt|;
switch|switch
condition|(
name|event
operator|->
name|event_type
condition|)
block|{
case|case
name|IBV_EVENT_CQ_ERR
case|:
name|real_event
operator|.
name|element
operator|.
name|cq
operator|=
operator|(
operator|(
expr|struct
name|ibv_cq_1_0
operator|*
operator|)
name|event
operator|->
name|element
operator|.
name|cq
operator|)
operator|->
name|real_cq
expr_stmt|;
break|break;
case|case
name|IBV_EVENT_QP_FATAL
case|:
case|case
name|IBV_EVENT_QP_REQ_ERR
case|:
case|case
name|IBV_EVENT_QP_ACCESS_ERR
case|:
case|case
name|IBV_EVENT_COMM_EST
case|:
case|case
name|IBV_EVENT_SQ_DRAINED
case|:
case|case
name|IBV_EVENT_PATH_MIG
case|:
case|case
name|IBV_EVENT_PATH_MIG_ERR
case|:
case|case
name|IBV_EVENT_QP_LAST_WQE_REACHED
case|:
name|real_event
operator|.
name|element
operator|.
name|qp
operator|=
operator|(
operator|(
expr|struct
name|ibv_qp_1_0
operator|*
operator|)
name|event
operator|->
name|element
operator|.
name|qp
operator|)
operator|->
name|real_qp
expr_stmt|;
break|break;
case|case
name|IBV_EVENT_SRQ_ERR
case|:
case|case
name|IBV_EVENT_SRQ_LIMIT_REACHED
case|:
name|real_event
operator|.
name|element
operator|.
name|srq
operator|=
operator|(
operator|(
expr|struct
name|ibv_srq_1_0
operator|*
operator|)
name|event
operator|->
name|element
operator|.
name|srq
operator|)
operator|->
name|real_srq
expr_stmt|;
break|break;
default|default:
break|break;
block|}
name|ibv_ack_async_event
argument_list|(
operator|&
name|real_event
argument_list|)
expr_stmt|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_ack_async_event_1_0
argument_list|,
name|ibv_ack_async_event
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_query_device_1_0
parameter_list|(
name|struct
name|ibv_context_1_0
modifier|*
name|context
parameter_list|,
name|struct
name|ibv_device_attr
modifier|*
name|device_attr
parameter_list|)
block|{
return|return
name|ibv_query_device
argument_list|(
name|context
operator|->
name|real_context
argument_list|,
name|device_attr
argument_list|)
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_query_device_1_0
argument_list|,
name|ibv_query_device
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_query_port_1_0
parameter_list|(
name|struct
name|ibv_context_1_0
modifier|*
name|context
parameter_list|,
name|uint8_t
name|port_num
parameter_list|,
name|struct
name|ibv_port_attr
modifier|*
name|port_attr
parameter_list|)
block|{
return|return
name|ibv_query_port
argument_list|(
name|context
operator|->
name|real_context
argument_list|,
name|port_num
argument_list|,
name|port_attr
argument_list|)
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_query_port_1_0
argument_list|,
name|ibv_query_port
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_query_gid_1_0
parameter_list|(
name|struct
name|ibv_context_1_0
modifier|*
name|context
parameter_list|,
name|uint8_t
name|port_num
parameter_list|,
name|int
name|index
parameter_list|,
name|union
name|ibv_gid
modifier|*
name|gid
parameter_list|)
block|{
return|return
name|ibv_query_gid
argument_list|(
name|context
operator|->
name|real_context
argument_list|,
name|port_num
argument_list|,
name|index
argument_list|,
name|gid
argument_list|)
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_query_gid_1_0
argument_list|,
name|ibv_query_gid
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_query_pkey_1_0
parameter_list|(
name|struct
name|ibv_context_1_0
modifier|*
name|context
parameter_list|,
name|uint8_t
name|port_num
parameter_list|,
name|int
name|index
parameter_list|,
name|__be16
modifier|*
name|pkey
parameter_list|)
block|{
return|return
name|ibv_query_pkey
argument_list|(
name|context
operator|->
name|real_context
argument_list|,
name|port_num
argument_list|,
name|index
argument_list|,
name|pkey
argument_list|)
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_query_pkey_1_0
argument_list|,
name|ibv_query_pkey
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|struct
name|ibv_pd_1_0
modifier|*
name|__ibv_alloc_pd_1_0
parameter_list|(
name|struct
name|ibv_context_1_0
modifier|*
name|context
parameter_list|)
block|{
name|struct
name|ibv_pd
modifier|*
name|real_pd
decl_stmt|;
name|struct
name|ibv_pd_1_0
modifier|*
name|pd
decl_stmt|;
name|pd
operator|=
name|malloc
argument_list|(
sizeof|sizeof
expr|*
name|pd
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|pd
condition|)
return|return
name|NULL
return|;
name|real_pd
operator|=
name|ibv_alloc_pd
argument_list|(
name|context
operator|->
name|real_context
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|real_pd
condition|)
block|{
name|free
argument_list|(
name|pd
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|pd
operator|->
name|context
operator|=
name|context
expr_stmt|;
name|pd
operator|->
name|real_pd
operator|=
name|real_pd
expr_stmt|;
return|return
name|pd
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_alloc_pd_1_0
argument_list|,
name|ibv_alloc_pd
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_dealloc_pd_1_0
parameter_list|(
name|struct
name|ibv_pd_1_0
modifier|*
name|pd
parameter_list|)
block|{
name|int
name|ret
decl_stmt|;
name|ret
operator|=
name|ibv_dealloc_pd
argument_list|(
name|pd
operator|->
name|real_pd
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
condition|)
return|return
name|ret
return|;
name|free
argument_list|(
name|pd
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_dealloc_pd_1_0
argument_list|,
name|ibv_dealloc_pd
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|struct
name|ibv_mr_1_0
modifier|*
name|__ibv_reg_mr_1_0
parameter_list|(
name|struct
name|ibv_pd_1_0
modifier|*
name|pd
parameter_list|,
name|void
modifier|*
name|addr
parameter_list|,
name|size_t
name|length
parameter_list|,
name|int
name|access
parameter_list|)
block|{
name|struct
name|ibv_mr
modifier|*
name|real_mr
decl_stmt|;
name|struct
name|ibv_mr_1_0
modifier|*
name|mr
decl_stmt|;
name|mr
operator|=
name|malloc
argument_list|(
sizeof|sizeof
expr|*
name|mr
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|mr
condition|)
return|return
name|NULL
return|;
name|real_mr
operator|=
name|ibv_reg_mr
argument_list|(
name|pd
operator|->
name|real_pd
argument_list|,
name|addr
argument_list|,
name|length
argument_list|,
name|access
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|real_mr
condition|)
block|{
name|free
argument_list|(
name|mr
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|mr
operator|->
name|context
operator|=
name|pd
operator|->
name|context
expr_stmt|;
name|mr
operator|->
name|pd
operator|=
name|pd
expr_stmt|;
name|mr
operator|->
name|lkey
operator|=
name|real_mr
operator|->
name|lkey
expr_stmt|;
name|mr
operator|->
name|rkey
operator|=
name|real_mr
operator|->
name|rkey
expr_stmt|;
name|mr
operator|->
name|real_mr
operator|=
name|real_mr
expr_stmt|;
return|return
name|mr
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_reg_mr_1_0
argument_list|,
name|ibv_reg_mr
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_dereg_mr_1_0
parameter_list|(
name|struct
name|ibv_mr_1_0
modifier|*
name|mr
parameter_list|)
block|{
name|int
name|ret
decl_stmt|;
name|ret
operator|=
name|ibv_dereg_mr
argument_list|(
name|mr
operator|->
name|real_mr
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
condition|)
return|return
name|ret
return|;
name|free
argument_list|(
name|mr
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_dereg_mr_1_0
argument_list|,
name|ibv_dereg_mr
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|struct
name|ibv_cq_1_0
modifier|*
name|__ibv_create_cq_1_0
parameter_list|(
name|struct
name|ibv_context_1_0
modifier|*
name|context
parameter_list|,
name|int
name|cqe
parameter_list|,
name|void
modifier|*
name|cq_context
parameter_list|,
name|struct
name|ibv_comp_channel
modifier|*
name|channel
parameter_list|,
name|int
name|comp_vector
parameter_list|)
block|{
name|struct
name|ibv_cq
modifier|*
name|real_cq
decl_stmt|;
name|struct
name|ibv_cq_1_0
modifier|*
name|cq
decl_stmt|;
name|cq
operator|=
name|malloc
argument_list|(
sizeof|sizeof
expr|*
name|cq
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|cq
condition|)
return|return
name|NULL
return|;
name|real_cq
operator|=
name|ibv_create_cq
argument_list|(
name|context
operator|->
name|real_context
argument_list|,
name|cqe
argument_list|,
name|cq_context
argument_list|,
name|channel
argument_list|,
name|comp_vector
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|real_cq
condition|)
block|{
name|free
argument_list|(
name|cq
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|cq
operator|->
name|context
operator|=
name|context
expr_stmt|;
name|cq
operator|->
name|cq_context
operator|=
name|cq_context
expr_stmt|;
name|cq
operator|->
name|cqe
operator|=
name|cqe
expr_stmt|;
name|cq
operator|->
name|real_cq
operator|=
name|real_cq
expr_stmt|;
name|real_cq
operator|->
name|cq_context
operator|=
name|cq
expr_stmt|;
return|return
name|cq
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_create_cq_1_0
argument_list|,
name|ibv_create_cq
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_resize_cq_1_0
parameter_list|(
name|struct
name|ibv_cq_1_0
modifier|*
name|cq
parameter_list|,
name|int
name|cqe
parameter_list|)
block|{
return|return
name|ibv_resize_cq
argument_list|(
name|cq
operator|->
name|real_cq
argument_list|,
name|cqe
argument_list|)
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_resize_cq_1_0
argument_list|,
name|ibv_resize_cq
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_destroy_cq_1_0
parameter_list|(
name|struct
name|ibv_cq_1_0
modifier|*
name|cq
parameter_list|)
block|{
name|int
name|ret
decl_stmt|;
name|ret
operator|=
name|ibv_destroy_cq
argument_list|(
name|cq
operator|->
name|real_cq
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
condition|)
return|return
name|ret
return|;
name|free
argument_list|(
name|cq
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_destroy_cq_1_0
argument_list|,
name|ibv_destroy_cq
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_get_cq_event_1_0
parameter_list|(
name|struct
name|ibv_comp_channel
modifier|*
name|channel
parameter_list|,
name|struct
name|ibv_cq_1_0
modifier|*
modifier|*
name|cq
parameter_list|,
name|void
modifier|*
modifier|*
name|cq_context
parameter_list|)
block|{
name|struct
name|ibv_cq
modifier|*
name|real_cq
decl_stmt|;
name|void
modifier|*
name|cq_ptr
decl_stmt|;
name|int
name|ret
decl_stmt|;
name|ret
operator|=
name|ibv_get_cq_event
argument_list|(
name|channel
argument_list|,
operator|&
name|real_cq
argument_list|,
operator|&
name|cq_ptr
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
condition|)
return|return
name|ret
return|;
operator|*
name|cq
operator|=
name|cq_ptr
expr_stmt|;
operator|*
name|cq_context
operator|=
operator|(
operator|*
name|cq
operator|)
operator|->
name|cq_context
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_get_cq_event_1_0
argument_list|,
name|ibv_get_cq_event
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|void
name|__ibv_ack_cq_events_1_0
parameter_list|(
name|struct
name|ibv_cq_1_0
modifier|*
name|cq
parameter_list|,
name|unsigned
name|int
name|nevents
parameter_list|)
block|{
name|ibv_ack_cq_events
argument_list|(
name|cq
operator|->
name|real_cq
argument_list|,
name|nevents
argument_list|)
expr_stmt|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_ack_cq_events_1_0
argument_list|,
name|ibv_ack_cq_events
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|struct
name|ibv_srq_1_0
modifier|*
name|__ibv_create_srq_1_0
parameter_list|(
name|struct
name|ibv_pd_1_0
modifier|*
name|pd
parameter_list|,
name|struct
name|ibv_srq_init_attr
modifier|*
name|srq_init_attr
parameter_list|)
block|{
name|struct
name|ibv_srq
modifier|*
name|real_srq
decl_stmt|;
name|struct
name|ibv_srq_1_0
modifier|*
name|srq
decl_stmt|;
name|srq
operator|=
name|malloc
argument_list|(
sizeof|sizeof
expr|*
name|srq
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|srq
condition|)
return|return
name|NULL
return|;
name|real_srq
operator|=
name|ibv_create_srq
argument_list|(
name|pd
operator|->
name|real_pd
argument_list|,
name|srq_init_attr
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|real_srq
condition|)
block|{
name|free
argument_list|(
name|srq
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|srq
operator|->
name|context
operator|=
name|pd
operator|->
name|context
expr_stmt|;
name|srq
operator|->
name|srq_context
operator|=
name|srq_init_attr
operator|->
name|srq_context
expr_stmt|;
name|srq
operator|->
name|pd
operator|=
name|pd
expr_stmt|;
name|srq
operator|->
name|real_srq
operator|=
name|real_srq
expr_stmt|;
name|real_srq
operator|->
name|srq_context
operator|=
name|srq
expr_stmt|;
return|return
name|srq
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_create_srq_1_0
argument_list|,
name|ibv_create_srq
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_modify_srq_1_0
parameter_list|(
name|struct
name|ibv_srq_1_0
modifier|*
name|srq
parameter_list|,
name|struct
name|ibv_srq_attr
modifier|*
name|srq_attr
parameter_list|,
name|int
name|srq_attr_mask
parameter_list|)
block|{
return|return
name|ibv_modify_srq
argument_list|(
name|srq
operator|->
name|real_srq
argument_list|,
name|srq_attr
argument_list|,
name|srq_attr_mask
argument_list|)
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_modify_srq_1_0
argument_list|,
name|ibv_modify_srq
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_query_srq_1_0
parameter_list|(
name|struct
name|ibv_srq_1_0
modifier|*
name|srq
parameter_list|,
name|struct
name|ibv_srq_attr
modifier|*
name|srq_attr
parameter_list|)
block|{
return|return
name|ibv_query_srq
argument_list|(
name|srq
operator|->
name|real_srq
argument_list|,
name|srq_attr
argument_list|)
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_query_srq_1_0
argument_list|,
name|ibv_query_srq
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_destroy_srq_1_0
parameter_list|(
name|struct
name|ibv_srq_1_0
modifier|*
name|srq
parameter_list|)
block|{
name|int
name|ret
decl_stmt|;
name|ret
operator|=
name|ibv_destroy_srq
argument_list|(
name|srq
operator|->
name|real_srq
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
condition|)
return|return
name|ret
return|;
name|free
argument_list|(
name|srq
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_destroy_srq_1_0
argument_list|,
name|ibv_destroy_srq
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|struct
name|ibv_qp_1_0
modifier|*
name|__ibv_create_qp_1_0
parameter_list|(
name|struct
name|ibv_pd_1_0
modifier|*
name|pd
parameter_list|,
name|struct
name|ibv_qp_init_attr_1_0
modifier|*
name|qp_init_attr
parameter_list|)
block|{
name|struct
name|ibv_qp
modifier|*
name|real_qp
decl_stmt|;
name|struct
name|ibv_qp_1_0
modifier|*
name|qp
decl_stmt|;
name|struct
name|ibv_qp_init_attr
name|real_init_attr
decl_stmt|;
name|qp
operator|=
name|malloc
argument_list|(
sizeof|sizeof
expr|*
name|qp
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|qp
condition|)
return|return
name|NULL
return|;
name|real_init_attr
operator|.
name|qp_context
operator|=
name|qp_init_attr
operator|->
name|qp_context
expr_stmt|;
name|real_init_attr
operator|.
name|send_cq
operator|=
name|qp_init_attr
operator|->
name|send_cq
operator|->
name|real_cq
expr_stmt|;
name|real_init_attr
operator|.
name|recv_cq
operator|=
name|qp_init_attr
operator|->
name|recv_cq
operator|->
name|real_cq
expr_stmt|;
name|real_init_attr
operator|.
name|srq
operator|=
name|qp_init_attr
operator|->
name|srq
condition|?
name|qp_init_attr
operator|->
name|srq
operator|->
name|real_srq
else|:
name|NULL
expr_stmt|;
name|real_init_attr
operator|.
name|cap
operator|=
name|qp_init_attr
operator|->
name|cap
expr_stmt|;
name|real_init_attr
operator|.
name|qp_type
operator|=
name|qp_init_attr
operator|->
name|qp_type
expr_stmt|;
name|real_init_attr
operator|.
name|sq_sig_all
operator|=
name|qp_init_attr
operator|->
name|sq_sig_all
expr_stmt|;
name|real_qp
operator|=
name|ibv_create_qp
argument_list|(
name|pd
operator|->
name|real_pd
argument_list|,
operator|&
name|real_init_attr
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|real_qp
condition|)
block|{
name|free
argument_list|(
name|qp
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|qp
operator|->
name|context
operator|=
name|pd
operator|->
name|context
expr_stmt|;
name|qp
operator|->
name|qp_context
operator|=
name|qp_init_attr
operator|->
name|qp_context
expr_stmt|;
name|qp
operator|->
name|pd
operator|=
name|pd
expr_stmt|;
name|qp
operator|->
name|send_cq
operator|=
name|qp_init_attr
operator|->
name|send_cq
expr_stmt|;
name|qp
operator|->
name|recv_cq
operator|=
name|qp_init_attr
operator|->
name|recv_cq
expr_stmt|;
name|qp
operator|->
name|srq
operator|=
name|qp_init_attr
operator|->
name|srq
expr_stmt|;
name|qp
operator|->
name|qp_type
operator|=
name|qp_init_attr
operator|->
name|qp_type
expr_stmt|;
name|qp
operator|->
name|qp_num
operator|=
name|real_qp
operator|->
name|qp_num
expr_stmt|;
name|qp
operator|->
name|real_qp
operator|=
name|real_qp
expr_stmt|;
name|qp_init_attr
operator|->
name|cap
operator|=
name|real_init_attr
operator|.
name|cap
expr_stmt|;
name|real_qp
operator|->
name|qp_context
operator|=
name|qp
expr_stmt|;
return|return
name|qp
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_create_qp_1_0
argument_list|,
name|ibv_create_qp
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_query_qp_1_0
parameter_list|(
name|struct
name|ibv_qp_1_0
modifier|*
name|qp
parameter_list|,
name|struct
name|ibv_qp_attr
modifier|*
name|attr
parameter_list|,
name|int
name|attr_mask
parameter_list|,
name|struct
name|ibv_qp_init_attr_1_0
modifier|*
name|init_attr
parameter_list|)
block|{
name|struct
name|ibv_qp_init_attr
name|real_init_attr
decl_stmt|;
name|int
name|ret
decl_stmt|;
name|ret
operator|=
name|ibv_query_qp
argument_list|(
name|qp
operator|->
name|real_qp
argument_list|,
name|attr
argument_list|,
name|attr_mask
argument_list|,
operator|&
name|real_init_attr
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
condition|)
return|return
name|ret
return|;
name|init_attr
operator|->
name|qp_context
operator|=
name|qp
operator|->
name|qp_context
expr_stmt|;
name|init_attr
operator|->
name|send_cq
operator|=
name|real_init_attr
operator|.
name|send_cq
operator|->
name|cq_context
expr_stmt|;
name|init_attr
operator|->
name|recv_cq
operator|=
name|real_init_attr
operator|.
name|recv_cq
operator|->
name|cq_context
expr_stmt|;
name|init_attr
operator|->
name|srq
operator|=
name|real_init_attr
operator|.
name|srq
operator|->
name|srq_context
expr_stmt|;
name|init_attr
operator|->
name|qp_type
operator|=
name|real_init_attr
operator|.
name|qp_type
expr_stmt|;
name|init_attr
operator|->
name|cap
operator|=
name|real_init_attr
operator|.
name|cap
expr_stmt|;
name|init_attr
operator|->
name|sq_sig_all
operator|=
name|real_init_attr
operator|.
name|sq_sig_all
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_query_qp_1_0
argument_list|,
name|ibv_query_qp
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_modify_qp_1_0
parameter_list|(
name|struct
name|ibv_qp_1_0
modifier|*
name|qp
parameter_list|,
name|struct
name|ibv_qp_attr
modifier|*
name|attr
parameter_list|,
name|int
name|attr_mask
parameter_list|)
block|{
return|return
name|ibv_modify_qp
argument_list|(
name|qp
operator|->
name|real_qp
argument_list|,
name|attr
argument_list|,
name|attr_mask
argument_list|)
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_modify_qp_1_0
argument_list|,
name|ibv_modify_qp
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_destroy_qp_1_0
parameter_list|(
name|struct
name|ibv_qp_1_0
modifier|*
name|qp
parameter_list|)
block|{
name|int
name|ret
decl_stmt|;
name|ret
operator|=
name|ibv_destroy_qp
argument_list|(
name|qp
operator|->
name|real_qp
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
condition|)
return|return
name|ret
return|;
name|free
argument_list|(
name|qp
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_destroy_qp_1_0
argument_list|,
name|ibv_destroy_qp
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|struct
name|ibv_ah_1_0
modifier|*
name|__ibv_create_ah_1_0
parameter_list|(
name|struct
name|ibv_pd_1_0
modifier|*
name|pd
parameter_list|,
name|struct
name|ibv_ah_attr
modifier|*
name|attr
parameter_list|)
block|{
name|struct
name|ibv_ah
modifier|*
name|real_ah
decl_stmt|;
name|struct
name|ibv_ah_1_0
modifier|*
name|ah
decl_stmt|;
name|ah
operator|=
name|malloc
argument_list|(
sizeof|sizeof
expr|*
name|ah
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|ah
condition|)
return|return
name|NULL
return|;
name|real_ah
operator|=
name|ibv_create_ah
argument_list|(
name|pd
operator|->
name|real_pd
argument_list|,
name|attr
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|real_ah
condition|)
block|{
name|free
argument_list|(
name|ah
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|ah
operator|->
name|context
operator|=
name|pd
operator|->
name|context
expr_stmt|;
name|ah
operator|->
name|pd
operator|=
name|pd
expr_stmt|;
name|ah
operator|->
name|real_ah
operator|=
name|real_ah
expr_stmt|;
return|return
name|ah
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_create_ah_1_0
argument_list|,
name|ibv_create_ah
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_destroy_ah_1_0
parameter_list|(
name|struct
name|ibv_ah_1_0
modifier|*
name|ah
parameter_list|)
block|{
name|int
name|ret
decl_stmt|;
name|ret
operator|=
name|ibv_destroy_ah
argument_list|(
name|ah
operator|->
name|real_ah
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
condition|)
return|return
name|ret
return|;
name|free
argument_list|(
name|ah
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_destroy_ah_1_0
argument_list|,
name|ibv_destroy_ah
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_attach_mcast_1_0
parameter_list|(
name|struct
name|ibv_qp_1_0
modifier|*
name|qp
parameter_list|,
name|union
name|ibv_gid
modifier|*
name|gid
parameter_list|,
name|uint16_t
name|lid
parameter_list|)
block|{
return|return
name|ibv_attach_mcast
argument_list|(
name|qp
operator|->
name|real_qp
argument_list|,
name|gid
argument_list|,
name|lid
argument_list|)
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_attach_mcast_1_0
argument_list|,
name|ibv_attach_mcast
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|int
name|__ibv_detach_mcast_1_0
parameter_list|(
name|struct
name|ibv_qp_1_0
modifier|*
name|qp
parameter_list|,
name|union
name|ibv_gid
modifier|*
name|gid
parameter_list|,
name|uint16_t
name|lid
parameter_list|)
block|{
return|return
name|ibv_detach_mcast
argument_list|(
name|qp
operator|->
name|real_qp
argument_list|,
name|gid
argument_list|,
name|lid
argument_list|)
return|;
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_detach_mcast_1_0
argument_list|,
name|ibv_detach_mcast
argument_list|,
name|IBVERBS_1
literal|.0
argument_list|)
expr_stmt|;
end_expr_stmt

begin_function
name|void
name|__ibv_register_driver_1_1
parameter_list|(
specifier|const
name|char
modifier|*
name|name
parameter_list|,
name|ibv_driver_init_func_1_1
name|init_func
parameter_list|)
block|{
comment|/* The driver interface is private as of rdma-core 13. This stub is 	 * left to preserve dynamic-link compatibility with old libfabrics 	 * usnic providers which use this function only to suppress a fprintf 	 * in old versions of libibverbs. */
block|}
end_function

begin_expr_stmt
name|symver
argument_list|(
name|__ibv_register_driver_1_1
argument_list|,
name|ibv_register_driver
argument_list|,
name|IBVERBS_1
literal|.1
argument_list|)
expr_stmt|;
end_expr_stmt

end_unit

