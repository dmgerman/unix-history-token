begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (c) 2004, 2005 Topspin Communications.  All rights reserved.  * Copyright (c) 2005, 2006 Cisco Systems, Inc.  All rights reserved.  * Copyright (c) 2005 PathScale, Inc.  All rights reserved.  *  * This software is available to you under a choice of one of two  * licenses.  You may choose to be licensed under the terms of the GNU  * General Public License (GPL) Version 2, available from the file  * COPYING in the main directory of this source tree, or the  * OpenIB.org BSD license below:  *  *     Redistribution and use in source and binary forms, with or  *     without modification, are permitted provided that the following  *     conditions are met:  *  *      - Redistributions of source code must retain the above  *        copyright notice, this list of conditions and the following  *        disclaimer.  *  *      - Redistributions in binary form must reproduce the above  *        copyright notice, this list of conditions and the following  *        disclaimer in the documentation and/or other materials  *        provided with the distribution.  *  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,  * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND  * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS  * BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN  * ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN  * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE  * SOFTWARE.  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|INFINIBAND_DRIVER_H
end_ifndef

begin_define
define|#
directive|define
name|INFINIBAND_DRIVER_H
end_define

begin_include
include|#
directive|include
file|<infiniband/verbs.h>
end_include

begin_include
include|#
directive|include
file|<infiniband/kern-abi.h>
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|__cplusplus
end_ifdef

begin_define
define|#
directive|define
name|BEGIN_C_DECLS
value|extern "C" {
end_define

begin_define
define|#
directive|define
name|END_C_DECLS
value|}
end_define

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* !__cplusplus */
end_comment

begin_define
define|#
directive|define
name|BEGIN_C_DECLS
end_define

begin_define
define|#
directive|define
name|END_C_DECLS
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* __cplusplus */
end_comment

begin_comment
comment|/*  * Extension that low-level drivers should add to their .so filename  * (probably via libtool "-release" option).  For example a low-level  * driver named "libfoo" should build a plug-in named "libfoo-rdmav2.so".  */
end_comment

begin_define
define|#
directive|define
name|IBV_DEVICE_LIBRARY_EXTENSION
value|rdmav2
end_define

begin_typedef
typedef|typedef
name|struct
name|ibv_device
modifier|*
function_decl|(
modifier|*
name|ibv_driver_init_func
function_decl|)
parameter_list|(
specifier|const
name|char
modifier|*
name|uverbs_sys_path
parameter_list|,
name|int
name|abi_version
parameter_list|)
function_decl|;
end_typedef

begin_function_decl
name|void
name|ibv_register_driver
parameter_list|(
specifier|const
name|char
modifier|*
name|name
parameter_list|,
name|ibv_driver_init_func
name|init_func
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_get_context
parameter_list|(
name|struct
name|ibv_context
modifier|*
name|context
parameter_list|,
name|struct
name|ibv_get_context
modifier|*
name|cmd
parameter_list|,
name|size_t
name|cmd_size
parameter_list|,
name|struct
name|ibv_get_context_resp
modifier|*
name|resp
parameter_list|,
name|size_t
name|resp_size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_query_device
parameter_list|(
name|struct
name|ibv_context
modifier|*
name|context
parameter_list|,
name|struct
name|ibv_device_attr
modifier|*
name|device_attr
parameter_list|,
name|uint64_t
modifier|*
name|raw_fw_ver
parameter_list|,
name|struct
name|ibv_query_device
modifier|*
name|cmd
parameter_list|,
name|size_t
name|cmd_size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_query_port
parameter_list|(
name|struct
name|ibv_context
modifier|*
name|context
parameter_list|,
name|uint8_t
name|port_num
parameter_list|,
name|struct
name|ibv_port_attr
modifier|*
name|port_attr
parameter_list|,
name|struct
name|ibv_query_port
modifier|*
name|cmd
parameter_list|,
name|size_t
name|cmd_size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_query_gid
parameter_list|(
name|struct
name|ibv_context
modifier|*
name|context
parameter_list|,
name|uint8_t
name|port_num
parameter_list|,
name|int
name|index
parameter_list|,
name|union
name|ibv_gid
modifier|*
name|gid
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_query_pkey
parameter_list|(
name|struct
name|ibv_context
modifier|*
name|context
parameter_list|,
name|uint8_t
name|port_num
parameter_list|,
name|int
name|index
parameter_list|,
name|uint16_t
modifier|*
name|pkey
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_alloc_pd
parameter_list|(
name|struct
name|ibv_context
modifier|*
name|context
parameter_list|,
name|struct
name|ibv_pd
modifier|*
name|pd
parameter_list|,
name|struct
name|ibv_alloc_pd
modifier|*
name|cmd
parameter_list|,
name|size_t
name|cmd_size
parameter_list|,
name|struct
name|ibv_alloc_pd_resp
modifier|*
name|resp
parameter_list|,
name|size_t
name|resp_size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_dealloc_pd
parameter_list|(
name|struct
name|ibv_pd
modifier|*
name|pd
parameter_list|)
function_decl|;
end_function_decl

begin_define
define|#
directive|define
name|IBV_CMD_REG_MR_HAS_RESP_PARAMS
end_define

begin_function_decl
name|int
name|ibv_cmd_reg_mr
parameter_list|(
name|struct
name|ibv_pd
modifier|*
name|pd
parameter_list|,
name|void
modifier|*
name|addr
parameter_list|,
name|size_t
name|length
parameter_list|,
name|uint64_t
name|hca_va
parameter_list|,
name|int
name|access
parameter_list|,
name|struct
name|ibv_mr
modifier|*
name|mr
parameter_list|,
name|struct
name|ibv_reg_mr
modifier|*
name|cmd
parameter_list|,
name|size_t
name|cmd_size
parameter_list|,
name|struct
name|ibv_reg_mr_resp
modifier|*
name|resp
parameter_list|,
name|size_t
name|resp_size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_dereg_mr
parameter_list|(
name|struct
name|ibv_mr
modifier|*
name|mr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_create_cq
parameter_list|(
name|struct
name|ibv_context
modifier|*
name|context
parameter_list|,
name|int
name|cqe
parameter_list|,
name|struct
name|ibv_comp_channel
modifier|*
name|channel
parameter_list|,
name|int
name|comp_vector
parameter_list|,
name|struct
name|ibv_cq
modifier|*
name|cq
parameter_list|,
name|struct
name|ibv_create_cq
modifier|*
name|cmd
parameter_list|,
name|size_t
name|cmd_size
parameter_list|,
name|struct
name|ibv_create_cq_resp
modifier|*
name|resp
parameter_list|,
name|size_t
name|resp_size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_poll_cq
parameter_list|(
name|struct
name|ibv_cq
modifier|*
name|cq
parameter_list|,
name|int
name|ne
parameter_list|,
name|struct
name|ibv_wc
modifier|*
name|wc
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_req_notify_cq
parameter_list|(
name|struct
name|ibv_cq
modifier|*
name|cq
parameter_list|,
name|int
name|solicited_only
parameter_list|)
function_decl|;
end_function_decl

begin_define
define|#
directive|define
name|IBV_CMD_RESIZE_CQ_HAS_RESP_PARAMS
end_define

begin_function_decl
name|int
name|ibv_cmd_resize_cq
parameter_list|(
name|struct
name|ibv_cq
modifier|*
name|cq
parameter_list|,
name|int
name|cqe
parameter_list|,
name|struct
name|ibv_resize_cq
modifier|*
name|cmd
parameter_list|,
name|size_t
name|cmd_size
parameter_list|,
name|struct
name|ibv_resize_cq_resp
modifier|*
name|resp
parameter_list|,
name|size_t
name|resp_size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_destroy_cq
parameter_list|(
name|struct
name|ibv_cq
modifier|*
name|cq
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_create_srq
parameter_list|(
name|struct
name|ibv_pd
modifier|*
name|pd
parameter_list|,
name|struct
name|ibv_srq
modifier|*
name|srq
parameter_list|,
name|struct
name|ibv_srq_init_attr
modifier|*
name|attr
parameter_list|,
name|struct
name|ibv_create_srq
modifier|*
name|cmd
parameter_list|,
name|size_t
name|cmd_size
parameter_list|,
name|struct
name|ibv_create_srq_resp
modifier|*
name|resp
parameter_list|,
name|size_t
name|resp_size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_create_xrc_srq
parameter_list|(
name|struct
name|ibv_pd
modifier|*
name|pd
parameter_list|,
name|struct
name|ibv_srq
modifier|*
name|srq
parameter_list|,
name|struct
name|ibv_srq_init_attr
modifier|*
name|attr
parameter_list|,
name|uint32_t
name|xrc_domain
parameter_list|,
name|uint32_t
name|xrc_cq
parameter_list|,
name|struct
name|ibv_create_xrc_srq
modifier|*
name|cmd
parameter_list|,
name|size_t
name|cmd_size
parameter_list|,
name|struct
name|ibv_create_srq_resp
modifier|*
name|resp
parameter_list|,
name|size_t
name|resp_size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_modify_srq
parameter_list|(
name|struct
name|ibv_srq
modifier|*
name|srq
parameter_list|,
name|struct
name|ibv_srq_attr
modifier|*
name|srq_attr
parameter_list|,
name|int
name|srq_attr_mask
parameter_list|,
name|struct
name|ibv_modify_srq
modifier|*
name|cmd
parameter_list|,
name|size_t
name|cmd_size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_query_srq
parameter_list|(
name|struct
name|ibv_srq
modifier|*
name|srq
parameter_list|,
name|struct
name|ibv_srq_attr
modifier|*
name|srq_attr
parameter_list|,
name|struct
name|ibv_query_srq
modifier|*
name|cmd
parameter_list|,
name|size_t
name|cmd_size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_destroy_srq
parameter_list|(
name|struct
name|ibv_srq
modifier|*
name|srq
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_create_qp
parameter_list|(
name|struct
name|ibv_pd
modifier|*
name|pd
parameter_list|,
name|struct
name|ibv_qp
modifier|*
name|qp
parameter_list|,
name|struct
name|ibv_qp_init_attr
modifier|*
name|attr
parameter_list|,
name|struct
name|ibv_create_qp
modifier|*
name|cmd
parameter_list|,
name|size_t
name|cmd_size
parameter_list|,
name|struct
name|ibv_create_qp_resp
modifier|*
name|resp
parameter_list|,
name|size_t
name|resp_size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_query_qp
parameter_list|(
name|struct
name|ibv_qp
modifier|*
name|qp
parameter_list|,
name|struct
name|ibv_qp_attr
modifier|*
name|qp_attr
parameter_list|,
name|int
name|attr_mask
parameter_list|,
name|struct
name|ibv_qp_init_attr
modifier|*
name|qp_init_attr
parameter_list|,
name|struct
name|ibv_query_qp
modifier|*
name|cmd
parameter_list|,
name|size_t
name|cmd_size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_modify_qp
parameter_list|(
name|struct
name|ibv_qp
modifier|*
name|qp
parameter_list|,
name|struct
name|ibv_qp_attr
modifier|*
name|attr
parameter_list|,
name|int
name|attr_mask
parameter_list|,
name|struct
name|ibv_modify_qp
modifier|*
name|cmd
parameter_list|,
name|size_t
name|cmd_size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_destroy_qp
parameter_list|(
name|struct
name|ibv_qp
modifier|*
name|qp
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_post_send
parameter_list|(
name|struct
name|ibv_qp
modifier|*
name|ibqp
parameter_list|,
name|struct
name|ibv_send_wr
modifier|*
name|wr
parameter_list|,
name|struct
name|ibv_send_wr
modifier|*
modifier|*
name|bad_wr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_post_recv
parameter_list|(
name|struct
name|ibv_qp
modifier|*
name|ibqp
parameter_list|,
name|struct
name|ibv_recv_wr
modifier|*
name|wr
parameter_list|,
name|struct
name|ibv_recv_wr
modifier|*
modifier|*
name|bad_wr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_post_srq_recv
parameter_list|(
name|struct
name|ibv_srq
modifier|*
name|srq
parameter_list|,
name|struct
name|ibv_recv_wr
modifier|*
name|wr
parameter_list|,
name|struct
name|ibv_recv_wr
modifier|*
modifier|*
name|bad_wr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_create_ah
parameter_list|(
name|struct
name|ibv_pd
modifier|*
name|pd
parameter_list|,
name|struct
name|ibv_ah
modifier|*
name|ah
parameter_list|,
name|struct
name|ibv_ah_attr
modifier|*
name|attr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_destroy_ah
parameter_list|(
name|struct
name|ibv_ah
modifier|*
name|ah
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_attach_mcast
parameter_list|(
name|struct
name|ibv_qp
modifier|*
name|qp
parameter_list|,
specifier|const
name|union
name|ibv_gid
modifier|*
name|gid
parameter_list|,
name|uint16_t
name|lid
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_detach_mcast
parameter_list|(
name|struct
name|ibv_qp
modifier|*
name|qp
parameter_list|,
specifier|const
name|union
name|ibv_gid
modifier|*
name|gid
parameter_list|,
name|uint16_t
name|lid
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_dontfork_range
parameter_list|(
name|void
modifier|*
name|base
parameter_list|,
name|size_t
name|size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_dofork_range
parameter_list|(
name|void
modifier|*
name|base
parameter_list|,
name|size_t
name|size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_open_xrc_domain
parameter_list|(
name|struct
name|ibv_context
modifier|*
name|context
parameter_list|,
name|int
name|fd
parameter_list|,
name|int
name|oflag
parameter_list|,
name|struct
name|ibv_xrc_domain
modifier|*
name|d
parameter_list|,
name|struct
name|ibv_open_xrc_domain_resp
modifier|*
name|resp
parameter_list|,
name|size_t
name|resp_size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_close_xrc_domain
parameter_list|(
name|struct
name|ibv_xrc_domain
modifier|*
name|d
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_create_xrc_rcv_qp
parameter_list|(
name|struct
name|ibv_qp_init_attr
modifier|*
name|init_attr
parameter_list|,
name|uint32_t
modifier|*
name|xrc_rcv_qpn
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_modify_xrc_rcv_qp
parameter_list|(
name|struct
name|ibv_xrc_domain
modifier|*
name|d
parameter_list|,
name|uint32_t
name|xrc_rcv_qpn
parameter_list|,
name|struct
name|ibv_qp_attr
modifier|*
name|attr
parameter_list|,
name|int
name|attr_mask
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_query_xrc_rcv_qp
parameter_list|(
name|struct
name|ibv_xrc_domain
modifier|*
name|d
parameter_list|,
name|uint32_t
name|xrc_rcv_qpn
parameter_list|,
name|struct
name|ibv_qp_attr
modifier|*
name|attr
parameter_list|,
name|int
name|attr_mask
parameter_list|,
name|struct
name|ibv_qp_init_attr
modifier|*
name|init_attr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_reg_xrc_rcv_qp
parameter_list|(
name|struct
name|ibv_xrc_domain
modifier|*
name|xrc_domain
parameter_list|,
name|uint32_t
name|xrc_qp_num
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_cmd_unreg_xrc_rcv_qp
parameter_list|(
name|struct
name|ibv_xrc_domain
modifier|*
name|xrc_domain
parameter_list|,
name|uint32_t
name|xrc_qp_num
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/*  * sysfs helper functions  */
end_comment

begin_function_decl
specifier|const
name|char
modifier|*
name|ibv_get_sysfs_path
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_read_sysfs_file
parameter_list|(
specifier|const
name|char
modifier|*
name|dir
parameter_list|,
specifier|const
name|char
modifier|*
name|file
parameter_list|,
name|char
modifier|*
name|buf
parameter_list|,
name|size_t
name|size
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ibv_resolve_eth_gid
parameter_list|(
specifier|const
name|struct
name|ibv_pd
modifier|*
name|pd
parameter_list|,
name|uint8_t
name|port_num
parameter_list|,
name|union
name|ibv_gid
modifier|*
name|dgid
parameter_list|,
name|uint8_t
name|sgid_index
parameter_list|,
name|uint8_t
name|mac
index|[]
parameter_list|,
name|uint16_t
modifier|*
name|vlan
parameter_list|,
name|uint8_t
modifier|*
name|tagged
parameter_list|,
name|uint8_t
modifier|*
name|is_mcast
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* INFINIBAND_DRIVER_H */
end_comment

end_unit

