begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (c) 2004-2009 Voltaire, Inc. All rights reserved.  * Copyright (c) 2002-2015 Mellanox Technologies LTD. All rights reserved.  * Copyright (c) 1996-2003 Intel Corporation. All rights reserved.  * Copyright (c) 2009 HNR Consulting. All rights reserved.  * Copyright (c) 2009 Sun Microsystems, Inc. All rights reserved.  *  * This software is available to you under a choice of one of two  * licenses.  You may choose to be licensed under the terms of the GNU  * General Public License (GPL) Version 2, available from the file  * COPYING in the main directory of this source tree, or the  * OpenIB.org BSD license below:  *  *     Redistribution and use in source and binary forms, with or  *     without modification, are permitted provided that the following  *     conditions are met:  *  *      - Redistributions of source code must retain the above  *        copyright notice, this list of conditions and the following  *        disclaimer.  *  *      - Redistributions in binary form must reproduce the above  *        copyright notice, this list of conditions and the following  *        disclaimer in the documentation and/or other materials  *        provided with the distribution.  *  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,  * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF  * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND  * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS  * BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN  * ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN  * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE  * SOFTWARE.  *  */
end_comment

begin_comment
comment|/*  * Abstract:  *    Implementation of opensm helper functions.  */
end_comment

begin_if
if|#
directive|if
name|HAVE_CONFIG_H
end_if

begin_include
include|#
directive|include
file|<config.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* HAVE_CONFIG_H */
end_comment

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<arpa/inet.h>
end_include

begin_include
include|#
directive|include
file|<sys/socket.h>
end_include

begin_include
include|#
directive|include
file|<complib/cl_debug.h>
end_include

begin_include
include|#
directive|include
file|<iba/ib_types.h>
end_include

begin_include
include|#
directive|include
file|<opensm/osm_file_ids.h>
end_include

begin_define
define|#
directive|define
name|FILE_ID
value|OSM_FILE_HELPER_C
end_define

begin_include
include|#
directive|include
file|<opensm/osm_helper.h>
end_include

begin_include
include|#
directive|include
file|<opensm/osm_log.h>
end_include

begin_define
define|#
directive|define
name|LINE_LENGTH
value|256
end_define

begin_define
define|#
directive|define
name|ARR_SIZE
parameter_list|(
name|a
parameter_list|)
value|(sizeof(a)/sizeof((a)[0]))
end_define

begin_comment
comment|/* we use two tables - one for queries and one for responses */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|ib_sa_method_str
index|[]
init|=
block|{
literal|"RESERVED"
block|,
comment|/* 0 */
literal|"SubnAdmGet"
block|,
comment|/* 1 */
literal|"SubnAdmSet"
block|,
comment|/* 2 */
literal|"RESERVED"
block|,
comment|/* 3 */
literal|"RESERVED"
block|,
comment|/* 4 */
literal|"RESERVED"
block|,
comment|/* 5 */
literal|"SubnAdmReport"
block|,
comment|/* 6 */
literal|"RESERVED"
block|,
comment|/* 7 */
literal|"RESERVED"
block|,
comment|/* 8 */
literal|"RESERVED"
block|,
comment|/* 9 */
literal|"RESERVED"
block|,
comment|/* A */
literal|"RESERVED"
block|,
comment|/* B */
literal|"RESERVED"
block|,
comment|/* C */
literal|"RESERVED"
block|,
comment|/* D */
literal|"RESERVED"
block|,
comment|/* E */
literal|"RESERVED"
block|,
comment|/* F */
literal|"RESERVED"
block|,
comment|/* 10 */
literal|"RESERVED"
block|,
comment|/* 11 */
literal|"SubnAdmGetTable"
block|,
comment|/* 12 */
literal|"SubnAdmGetTraceTable"
block|,
comment|/* 13 */
literal|"SubnAdmGetMulti"
block|,
comment|/* 14 */
literal|"SubnAdmDelete"
block|,
comment|/* 15 */
literal|"UNKNOWN"
comment|/* 16 */
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|OSM_SA_METHOD_STR_UNKNOWN_VAL
value|(ARR_SIZE(ib_sa_method_str) - 1)
end_define

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|ib_sa_resp_method_str
index|[]
init|=
block|{
literal|"RESERVED"
block|,
comment|/* 80 */
literal|"SubnAdmGetResp"
block|,
comment|/* 81 */
literal|"RESERVED (SetResp?)"
block|,
comment|/* 82 */
literal|"RESERVED"
block|,
comment|/* 83 */
literal|"RESERVED"
block|,
comment|/* 84 */
literal|"RESERVED"
block|,
comment|/* 85 */
literal|"SubnAdmReportResp"
block|,
comment|/* 86 */
literal|"RESERVED"
block|,
comment|/* 87 */
literal|"RESERVED"
block|,
comment|/* 88 */
literal|"RESERVED"
block|,
comment|/* 89 */
literal|"RESERVED"
block|,
comment|/* 8A */
literal|"RESERVED"
block|,
comment|/* 8B */
literal|"RESERVED"
block|,
comment|/* 8C */
literal|"RESERVED"
block|,
comment|/* 8D */
literal|"RESERVED"
block|,
comment|/* 8E */
literal|"RESERVED"
block|,
comment|/* 8F */
literal|"RESERVED"
block|,
comment|/* 90 */
literal|"RESERVED"
block|,
comment|/* 91 */
literal|"SubnAdmGetTableResp"
block|,
comment|/* 92 */
literal|"RESERVED"
block|,
comment|/* 93 */
literal|"SubnAdmGetMultiResp"
block|,
comment|/* 94 */
literal|"SubnAdmDeleteResp"
block|,
comment|/* 95 */
literal|"UNKNOWN"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|ib_sm_method_str
index|[]
init|=
block|{
literal|"RESERVED0"
block|,
comment|/* 0 */
literal|"SubnGet"
block|,
comment|/* 1 */
literal|"SubnSet"
block|,
comment|/* 2 */
literal|"RESERVED3"
block|,
comment|/* 3 */
literal|"RESERVED4"
block|,
comment|/* 4 */
literal|"SubnTrap"
block|,
comment|/* 5 */
literal|"RESERVED6"
block|,
comment|/* 6 */
literal|"SubnTrapRepress"
block|,
comment|/* 7 */
literal|"RESERVED8"
block|,
comment|/* 8 */
literal|"RESERVED9"
block|,
comment|/* 9 */
literal|"RESERVEDA"
block|,
comment|/* A */
literal|"RESERVEDB"
block|,
comment|/* B */
literal|"RESERVEDC"
block|,
comment|/* C */
literal|"RESERVEDD"
block|,
comment|/* D */
literal|"RESERVEDE"
block|,
comment|/* E */
literal|"RESERVEDF"
block|,
comment|/* F */
literal|"RESERVED10"
block|,
comment|/* 10 */
literal|"SubnGetResp"
block|,
comment|/* 11 */
literal|"RESERVED12"
block|,
comment|/* 12 */
literal|"RESERVED13"
block|,
comment|/* 13 */
literal|"RESERVED14"
block|,
comment|/* 14 */
literal|"RESERVED15"
block|,
comment|/* 15 */
literal|"RESERVED16"
block|,
comment|/* 16 */
literal|"RESERVED17"
block|,
comment|/* 17 */
literal|"RESERVED18"
block|,
comment|/* 18 */
literal|"RESERVED19"
block|,
comment|/* 19 */
literal|"RESERVED1A"
block|,
comment|/* 1A */
literal|"RESERVED1B"
block|,
comment|/* 1B */
literal|"RESERVED1C"
block|,
comment|/* 1C */
literal|"RESERVED1D"
block|,
comment|/* 1D */
literal|"RESERVED1E"
block|,
comment|/* 1E */
literal|"RESERVED1F"
block|,
comment|/* 1F */
literal|"UNKNOWN"
comment|/* 20 */
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|OSM_SM_METHOD_STR_UNKNOWN_VAL
value|(ARR_SIZE(ib_sm_method_str) - 1)
end_define

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|ib_sm_attr_str
index|[]
init|=
block|{
literal|"RESERVED"
block|,
comment|/* 0 */
literal|"ClassPortInfo"
block|,
comment|/* 1 */
literal|"Notice"
block|,
comment|/* 2 */
literal|"InformInfo"
block|,
comment|/* 3 */
literal|"RESERVED"
block|,
comment|/* 4 */
literal|"RESERVED"
block|,
comment|/* 5 */
literal|"RESERVED"
block|,
comment|/* 6 */
literal|"RESERVED"
block|,
comment|/* 7 */
literal|"RESERVED"
block|,
comment|/* 8 */
literal|"RESERVED"
block|,
comment|/* 9 */
literal|"RESERVED"
block|,
comment|/* A */
literal|"RESERVED"
block|,
comment|/* B */
literal|"RESERVED"
block|,
comment|/* C */
literal|"RESERVED"
block|,
comment|/* D */
literal|"RESERVED"
block|,
comment|/* E */
literal|"RESERVED"
block|,
comment|/* F */
literal|"NodeDescription"
block|,
comment|/* 10 */
literal|"NodeInfo"
block|,
comment|/* 11 */
literal|"SwitchInfo"
block|,
comment|/* 12 */
literal|"UNKNOWN"
block|,
comment|/* 13 */
literal|"GUIDInfo"
block|,
comment|/* 14 */
literal|"PortInfo"
block|,
comment|/* 15 */
literal|"P_KeyTable"
block|,
comment|/* 16 */
literal|"SLtoVLMappingTable"
block|,
comment|/* 17 */
literal|"VLArbitrationTable"
block|,
comment|/* 18 */
literal|"LinearForwardingTable"
block|,
comment|/* 19 */
literal|"RandomForwardingTable"
block|,
comment|/* 1A */
literal|"MulticastForwardingTable"
block|,
comment|/* 1B */
literal|"UNKNOWN"
block|,
comment|/* 1C */
literal|"UNKNOWN"
block|,
comment|/* 1D */
literal|"UNKNOWN"
block|,
comment|/* 1E */
literal|"UNKNOWN"
block|,
comment|/* 1F */
literal|"SMInfo"
block|,
comment|/* 20 */
literal|"UNKNOWN"
comment|/* 21 - always highest value */
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|OSM_SM_ATTR_STR_UNKNOWN_VAL
value|(ARR_SIZE(ib_sm_attr_str) - 1)
end_define

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|ib_sa_attr_str
index|[]
init|=
block|{
literal|"RESERVED"
block|,
comment|/* 0 */
literal|"ClassPortInfo"
block|,
comment|/* 1 */
literal|"Notice"
block|,
comment|/* 2 */
literal|"InformInfo"
block|,
comment|/* 3 */
literal|"RESERVED"
block|,
comment|/* 4 */
literal|"RESERVED"
block|,
comment|/* 5 */
literal|"RESERVED"
block|,
comment|/* 6 */
literal|"RESERVED"
block|,
comment|/* 7 */
literal|"RESERVED"
block|,
comment|/* 8 */
literal|"RESERVED"
block|,
comment|/* 9 */
literal|"RESERVED"
block|,
comment|/* A */
literal|"RESERVED"
block|,
comment|/* B */
literal|"RESERVED"
block|,
comment|/* C */
literal|"RESERVED"
block|,
comment|/* D */
literal|"RESERVED"
block|,
comment|/* E */
literal|"RESERVED"
block|,
comment|/* F */
literal|"RESERVED"
block|,
comment|/* 10 */
literal|"NodeRecord"
block|,
comment|/* 11 */
literal|"PortInfoRecord"
block|,
comment|/* 12 */
literal|"SLtoVLMappingTableRecord"
block|,
comment|/* 13 */
literal|"SwitchInfoRecord"
block|,
comment|/* 14 */
literal|"LinearForwardingTableRecord"
block|,
comment|/* 15 */
literal|"RandomForwardingTableRecord"
block|,
comment|/* 16 */
literal|"MulticastForwardingTableRecord"
block|,
comment|/* 17 */
literal|"SMInfoRecord"
block|,
comment|/* 18 */
literal|"RESERVED"
block|,
comment|/* 19 */
literal|"RandomForwardingTable"
block|,
comment|/* 1A */
literal|"MulticastForwardingTable"
block|,
comment|/* 1B */
literal|"UNKNOWN"
block|,
comment|/* 1C */
literal|"UNKNOWN"
block|,
comment|/* 1D */
literal|"UNKNOWN"
block|,
comment|/* 1E */
literal|"UNKNOWN"
block|,
comment|/* 1F */
literal|"LinkRecord"
block|,
comment|/* 20 */
literal|"UNKNOWN"
block|,
comment|/* 21 */
literal|"UNKNOWN"
block|,
comment|/* 22 */
literal|"UNKNOWN"
block|,
comment|/* 23 */
literal|"UNKNOWN"
block|,
comment|/* 24 */
literal|"UNKNOWN"
block|,
comment|/* 25 */
literal|"UNKNOWN"
block|,
comment|/* 26 */
literal|"UNKNOWN"
block|,
comment|/* 27 */
literal|"UNKNOWN"
block|,
comment|/* 28 */
literal|"UNKNOWN"
block|,
comment|/* 29 */
literal|"UNKNOWN"
block|,
comment|/* 2A */
literal|"UNKNOWN"
block|,
comment|/* 2B */
literal|"UNKNOWN"
block|,
comment|/* 2C */
literal|"UNKNOWN"
block|,
comment|/* 2D */
literal|"UNKNOWN"
block|,
comment|/* 2E */
literal|"UNKNOWN"
block|,
comment|/* 2F */
literal|"GuidInfoRecord"
block|,
comment|/* 30 */
literal|"ServiceRecord"
block|,
comment|/* 31 */
literal|"UNKNOWN"
block|,
comment|/* 32 */
literal|"P_KeyTableRecord"
block|,
comment|/* 33 */
literal|"UNKNOWN"
block|,
comment|/* 34 */
literal|"PathRecord"
block|,
comment|/* 35 */
literal|"VLArbitrationTableRecord"
block|,
comment|/* 36 */
literal|"UNKNOWN"
block|,
comment|/* 37 */
literal|"MCMemberRecord"
block|,
comment|/* 38 */
literal|"TraceRecord"
block|,
comment|/* 39 */
literal|"MultiPathRecord"
block|,
comment|/* 3A */
literal|"ServiceAssociationRecord"
block|,
comment|/* 3B */
literal|"UNKNOWN"
block|,
comment|/* 3C */
literal|"UNKNOWN"
block|,
comment|/* 3D */
literal|"UNKNOWN"
block|,
comment|/* 3E */
literal|"UNKNOWN"
block|,
comment|/* 3F */
literal|"UNKNOWN"
block|,
comment|/* 40 */
literal|"UNKNOWN"
block|,
comment|/* 41 */
literal|"UNKNOWN"
block|,
comment|/* 42 */
literal|"UNKNOWN"
block|,
comment|/* 43 */
literal|"UNKNOWN"
block|,
comment|/* 44 */
literal|"UNKNOWN"
block|,
comment|/* 45 */
literal|"UNKNOWN"
block|,
comment|/* 46 */
literal|"UNKNOWN"
block|,
comment|/* 47 */
literal|"UNKNOWN"
block|,
comment|/* 48 */
literal|"UNKNOWN"
block|,
comment|/* 49 */
literal|"UNKNOWN"
block|,
comment|/* 4A */
literal|"UNKNOWN"
block|,
comment|/* 4B */
literal|"UNKNOWN"
block|,
comment|/* 4C */
literal|"UNKNOWN"
block|,
comment|/* 4D */
literal|"UNKNOWN"
block|,
comment|/* 4E */
literal|"UNKNOWN"
block|,
comment|/* 4F */
literal|"UNKNOWN"
block|,
comment|/* 50 */
literal|"UNKNOWN"
block|,
comment|/* 51 */
literal|"UNKNOWN"
block|,
comment|/* 52 */
literal|"UNKNOWN"
block|,
comment|/* 53 */
literal|"UNKNOWN"
block|,
comment|/* 54 */
literal|"UNKNOWN"
block|,
comment|/* 55 */
literal|"UNKNOWN"
block|,
comment|/* 56 */
literal|"UNKNOWN"
block|,
comment|/* 57 */
literal|"UNKNOWN"
block|,
comment|/* 58 */
literal|"UNKNOWN"
block|,
comment|/* 59 */
literal|"UNKNOWN"
block|,
comment|/* 5A */
literal|"UNKNOWN"
block|,
comment|/* 5B */
literal|"UNKNOWN"
block|,
comment|/* 5C */
literal|"UNKNOWN"
block|,
comment|/* 5D */
literal|"UNKNOWN"
block|,
comment|/* 5E */
literal|"UNKNOWN"
block|,
comment|/* 5F */
literal|"UNKNOWN"
block|,
comment|/* 60 */
literal|"UNKNOWN"
block|,
comment|/* 61 */
literal|"UNKNOWN"
block|,
comment|/* 62 */
literal|"UNKNOWN"
block|,
comment|/* 63 */
literal|"UNKNOWN"
block|,
comment|/* 64 */
literal|"UNKNOWN"
block|,
comment|/* 65 */
literal|"UNKNOWN"
block|,
comment|/* 66 */
literal|"UNKNOWN"
block|,
comment|/* 67 */
literal|"UNKNOWN"
block|,
comment|/* 68 */
literal|"UNKNOWN"
block|,
comment|/* 69 */
literal|"UNKNOWN"
block|,
comment|/* 6A */
literal|"UNKNOWN"
block|,
comment|/* 6B */
literal|"UNKNOWN"
block|,
comment|/* 6C */
literal|"UNKNOWN"
block|,
comment|/* 6D */
literal|"UNKNOWN"
block|,
comment|/* 6E */
literal|"UNKNOWN"
block|,
comment|/* 6F */
literal|"UNKNOWN"
block|,
comment|/* 70 */
literal|"UNKNOWN"
block|,
comment|/* 71 */
literal|"UNKNOWN"
block|,
comment|/* 72 */
literal|"UNKNOWN"
block|,
comment|/* 73 */
literal|"UNKNOWN"
block|,
comment|/* 74 */
literal|"UNKNOWN"
block|,
comment|/* 75 */
literal|"UNKNOWN"
block|,
comment|/* 76 */
literal|"UNKNOWN"
block|,
comment|/* 77 */
literal|"UNKNOWN"
block|,
comment|/* 78 */
literal|"UNKNOWN"
block|,
comment|/* 79 */
literal|"UNKNOWN"
block|,
comment|/* 7A */
literal|"UNKNOWN"
block|,
comment|/* 7B */
literal|"UNKNOWN"
block|,
comment|/* 7C */
literal|"UNKNOWN"
block|,
comment|/* 7D */
literal|"UNKNOWN"
block|,
comment|/* 7E */
literal|"UNKNOWN"
block|,
comment|/* 7F */
literal|"UNKNOWN"
block|,
comment|/* 80 */
literal|"UNKNOWN"
block|,
comment|/* 81 */
literal|"UNKNOWN"
block|,
comment|/* 82 */
literal|"UNKNOWN"
block|,
comment|/* 83 */
literal|"UNKNOWN"
block|,
comment|/* 84 */
literal|"UNKNOWN"
block|,
comment|/* 85 */
literal|"UNKNOWN"
block|,
comment|/* 86 */
literal|"UNKNOWN"
block|,
comment|/* 87 */
literal|"UNKNOWN"
block|,
comment|/* 88 */
literal|"UNKNOWN"
block|,
comment|/* 89 */
literal|"UNKNOWN"
block|,
comment|/* 8A */
literal|"UNKNOWN"
block|,
comment|/* 8B */
literal|"UNKNOWN"
block|,
comment|/* 8C */
literal|"UNKNOWN"
block|,
comment|/* 8D */
literal|"UNKNOWN"
block|,
comment|/* 8E */
literal|"UNKNOWN"
block|,
comment|/* 8F */
literal|"UNKNOWN"
block|,
comment|/* 90 */
literal|"UNKNOWN"
block|,
comment|/* 91 */
literal|"UNKNOWN"
block|,
comment|/* 92 */
literal|"UNKNOWN"
block|,
comment|/* 93 */
literal|"UNKNOWN"
block|,
comment|/* 94 */
literal|"UNKNOWN"
block|,
comment|/* 95 */
literal|"UNKNOWN"
block|,
comment|/* 96 */
literal|"UNKNOWN"
block|,
comment|/* 97 */
literal|"UNKNOWN"
block|,
comment|/* 98 */
literal|"UNKNOWN"
block|,
comment|/* 99 */
literal|"UNKNOWN"
block|,
comment|/* 9A */
literal|"UNKNOWN"
block|,
comment|/* 9B */
literal|"UNKNOWN"
block|,
comment|/* 9C */
literal|"UNKNOWN"
block|,
comment|/* 9D */
literal|"UNKNOWN"
block|,
comment|/* 9E */
literal|"UNKNOWN"
block|,
comment|/* 9F */
literal|"UNKNOWN"
block|,
comment|/* A0 */
literal|"UNKNOWN"
block|,
comment|/* A1 */
literal|"UNKNOWN"
block|,
comment|/* A2 */
literal|"UNKNOWN"
block|,
comment|/* A3 */
literal|"UNKNOWN"
block|,
comment|/* A4 */
literal|"UNKNOWN"
block|,
comment|/* A5 */
literal|"UNKNOWN"
block|,
comment|/* A6 */
literal|"UNKNOWN"
block|,
comment|/* A7 */
literal|"UNKNOWN"
block|,
comment|/* A8 */
literal|"UNKNOWN"
block|,
comment|/* A9 */
literal|"UNKNOWN"
block|,
comment|/* AA */
literal|"UNKNOWN"
block|,
comment|/* AB */
literal|"UNKNOWN"
block|,
comment|/* AC */
literal|"UNKNOWN"
block|,
comment|/* AD */
literal|"UNKNOWN"
block|,
comment|/* AE */
literal|"UNKNOWN"
block|,
comment|/* AF */
literal|"UNKNOWN"
block|,
comment|/* B0 */
literal|"UNKNOWN"
block|,
comment|/* B1 */
literal|"UNKNOWN"
block|,
comment|/* B2 */
literal|"UNKNOWN"
block|,
comment|/* B3 */
literal|"UNKNOWN"
block|,
comment|/* B4 */
literal|"UNKNOWN"
block|,
comment|/* B5 */
literal|"UNKNOWN"
block|,
comment|/* B6 */
literal|"UNKNOWN"
block|,
comment|/* B7 */
literal|"UNKNOWN"
block|,
comment|/* B8 */
literal|"UNKNOWN"
block|,
comment|/* B9 */
literal|"UNKNOWN"
block|,
comment|/* BA */
literal|"UNKNOWN"
block|,
comment|/* BB */
literal|"UNKNOWN"
block|,
comment|/* BC */
literal|"UNKNOWN"
block|,
comment|/* BD */
literal|"UNKNOWN"
block|,
comment|/* BE */
literal|"UNKNOWN"
block|,
comment|/* BF */
literal|"UNKNOWN"
block|,
comment|/* C0 */
literal|"UNKNOWN"
block|,
comment|/* C1 */
literal|"UNKNOWN"
block|,
comment|/* C2 */
literal|"UNKNOWN"
block|,
comment|/* C3 */
literal|"UNKNOWN"
block|,
comment|/* C4 */
literal|"UNKNOWN"
block|,
comment|/* C5 */
literal|"UNKNOWN"
block|,
comment|/* C6 */
literal|"UNKNOWN"
block|,
comment|/* C7 */
literal|"UNKNOWN"
block|,
comment|/* C8 */
literal|"UNKNOWN"
block|,
comment|/* C9 */
literal|"UNKNOWN"
block|,
comment|/* CA */
literal|"UNKNOWN"
block|,
comment|/* CB */
literal|"UNKNOWN"
block|,
comment|/* CC */
literal|"UNKNOWN"
block|,
comment|/* CD */
literal|"UNKNOWN"
block|,
comment|/* CE */
literal|"UNKNOWN"
block|,
comment|/* CF */
literal|"UNKNOWN"
block|,
comment|/* D0 */
literal|"UNKNOWN"
block|,
comment|/* D1 */
literal|"UNKNOWN"
block|,
comment|/* D2 */
literal|"UNKNOWN"
block|,
comment|/* D3 */
literal|"UNKNOWN"
block|,
comment|/* D4 */
literal|"UNKNOWN"
block|,
comment|/* D5 */
literal|"UNKNOWN"
block|,
comment|/* D6 */
literal|"UNKNOWN"
block|,
comment|/* D7 */
literal|"UNKNOWN"
block|,
comment|/* D8 */
literal|"UNKNOWN"
block|,
comment|/* D9 */
literal|"UNKNOWN"
block|,
comment|/* DA */
literal|"UNKNOWN"
block|,
comment|/* DB */
literal|"UNKNOWN"
block|,
comment|/* DC */
literal|"UNKNOWN"
block|,
comment|/* DD */
literal|"UNKNOWN"
block|,
comment|/* DE */
literal|"UNKNOWN"
block|,
comment|/* DF */
literal|"UNKNOWN"
block|,
comment|/* E0 */
literal|"UNKNOWN"
block|,
comment|/* E1 */
literal|"UNKNOWN"
block|,
comment|/* E2 */
literal|"UNKNOWN"
block|,
comment|/* E3 */
literal|"UNKNOWN"
block|,
comment|/* E4 */
literal|"UNKNOWN"
block|,
comment|/* E5 */
literal|"UNKNOWN"
block|,
comment|/* E6 */
literal|"UNKNOWN"
block|,
comment|/* E7 */
literal|"UNKNOWN"
block|,
comment|/* E8 */
literal|"UNKNOWN"
block|,
comment|/* E9 */
literal|"UNKNOWN"
block|,
comment|/* EA */
literal|"UNKNOWN"
block|,
comment|/* EB */
literal|"UNKNOWN"
block|,
comment|/* EC */
literal|"UNKNOWN"
block|,
comment|/* ED */
literal|"UNKNOWN"
block|,
comment|/* EE */
literal|"UNKNOWN"
block|,
comment|/* EF */
literal|"UNKNOWN"
block|,
comment|/* F0 */
literal|"UNKNOWN"
block|,
comment|/* F1 */
literal|"UNKNOWN"
block|,
comment|/* F2 */
literal|"InformInfoRecord"
block|,
comment|/* F3 */
literal|"UNKNOWN"
comment|/* F4 - always highest value */
block|}
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|OSM_SA_ATTR_STR_UNKNOWN_VAL
value|(ARR_SIZE(ib_sa_attr_str) - 1)
end_define

begin_decl_stmt
specifier|static
name|int
name|ordered_rates
index|[]
init|=
block|{
literal|0
block|,
literal|0
block|,
comment|/*  0, 1 - reserved */
literal|1
block|,
comment|/*  2 - 2.5 Gbps */
literal|3
block|,
comment|/*  3 - 10  Gbps */
literal|6
block|,
comment|/*  4 - 30  Gbps */
literal|2
block|,
comment|/*  5 - 5   Gbps */
literal|5
block|,
comment|/*  6 - 20  Gbps */
literal|9
block|,
comment|/*  7 - 40  Gbps */
literal|10
block|,
comment|/*  8 - 60  Gbps */
literal|13
block|,
comment|/*  9 - 80  Gbps */
literal|14
block|,
comment|/* 10 - 120 Gbps */
literal|4
block|,
comment|/* 11 -  14 Gbps (17 Gbps equiv) */
literal|12
block|,
comment|/* 12 -  56 Gbps (68 Gbps equiv) */
literal|16
block|,
comment|/* 13 - 112 Gbps (136 Gbps equiv) */
literal|17
block|,
comment|/* 14 - 168 Gbps (204 Gbps equiv) */
literal|7
block|,
comment|/* 15 -  25 Gbps (31.25 Gbps equiv) */
literal|15
block|,
comment|/* 16 - 100 Gbps (125 Gbps equiv) */
literal|18
block|,
comment|/* 17 - 200 Gbps (250 Gbps equiv) */
literal|19
block|,
comment|/* 18 - 300 Gbps (375 Gbps equiv) */
literal|8
block|,
comment|/* 19 -  28 Gbps (35 Gbps equiv) */
literal|11
block|,
comment|/* 20 -  50 Gbps (62.5 Gbps equiv) */
block|}
decl_stmt|;
end_decl_stmt

begin_function
name|int
name|sprint_uint8_arr
parameter_list|(
name|char
modifier|*
name|buf
parameter_list|,
name|size_t
name|size
parameter_list|,
specifier|const
name|uint8_t
modifier|*
name|arr
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
name|int
name|n
decl_stmt|;
name|unsigned
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|n
operator|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
name|i
operator|++
control|)
block|{
name|n
operator|+=
name|snprintf
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|size
operator|-
name|n
argument_list|,
literal|"%s%u"
argument_list|,
name|i
operator|==
literal|0
condition|?
literal|""
else|:
literal|","
argument_list|,
name|arr
index|[
name|i
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|n
operator|>=
name|size
condition|)
break|break;
block|}
return|return
name|n
return|;
block|}
end_function

begin_function
specifier|const
name|char
modifier|*
name|ib_get_sa_method_str
parameter_list|(
name|IN
name|uint8_t
name|method
parameter_list|)
block|{
if|if
condition|(
name|method
operator|&
literal|0x80
condition|)
block|{
name|method
operator|=
name|method
operator|&
literal|0x7f
expr_stmt|;
if|if
condition|(
name|method
operator|>
name|OSM_SA_METHOD_STR_UNKNOWN_VAL
condition|)
name|method
operator|=
name|OSM_SA_METHOD_STR_UNKNOWN_VAL
expr_stmt|;
comment|/* it is a response - use the response table */
return|return
name|ib_sa_resp_method_str
index|[
name|method
index|]
return|;
block|}
else|else
block|{
if|if
condition|(
name|method
operator|>
name|OSM_SA_METHOD_STR_UNKNOWN_VAL
condition|)
name|method
operator|=
name|OSM_SA_METHOD_STR_UNKNOWN_VAL
expr_stmt|;
return|return
name|ib_sa_method_str
index|[
name|method
index|]
return|;
block|}
block|}
end_function

begin_function
specifier|const
name|char
modifier|*
name|ib_get_sm_method_str
parameter_list|(
name|IN
name|uint8_t
name|method
parameter_list|)
block|{
if|if
condition|(
name|method
operator|&
literal|0x80
condition|)
name|method
operator|=
operator|(
name|method
operator|&
literal|0x0F
operator|)
operator||
literal|0x10
expr_stmt|;
if|if
condition|(
name|method
operator|>
name|OSM_SM_METHOD_STR_UNKNOWN_VAL
condition|)
name|method
operator|=
name|OSM_SM_METHOD_STR_UNKNOWN_VAL
expr_stmt|;
return|return
name|ib_sm_method_str
index|[
name|method
index|]
return|;
block|}
end_function

begin_function
specifier|const
name|char
modifier|*
name|ib_get_sm_attr_str
parameter_list|(
name|IN
name|ib_net16_t
name|attr
parameter_list|)
block|{
name|uint16_t
name|host_attr
init|=
name|cl_ntoh16
argument_list|(
name|attr
argument_list|)
decl_stmt|;
if|if
condition|(
name|attr
operator|==
name|IB_MAD_ATTR_MLNX_EXTENDED_PORT_INFO
condition|)
return|return
literal|"MLNXExtendedPortInfo"
return|;
if|if
condition|(
name|host_attr
operator|>
name|OSM_SM_ATTR_STR_UNKNOWN_VAL
condition|)
name|host_attr
operator|=
name|OSM_SM_ATTR_STR_UNKNOWN_VAL
expr_stmt|;
return|return
name|ib_sm_attr_str
index|[
name|host_attr
index|]
return|;
block|}
end_function

begin_function
specifier|const
name|char
modifier|*
name|ib_get_sa_attr_str
parameter_list|(
name|IN
name|ib_net16_t
name|attr
parameter_list|)
block|{
name|uint16_t
name|host_attr
init|=
name|cl_ntoh16
argument_list|(
name|attr
argument_list|)
decl_stmt|;
if|if
condition|(
name|host_attr
operator|>
name|OSM_SA_ATTR_STR_UNKNOWN_VAL
condition|)
name|host_attr
operator|=
name|OSM_SA_ATTR_STR_UNKNOWN_VAL
expr_stmt|;
return|return
name|ib_sa_attr_str
index|[
name|host_attr
index|]
return|;
block|}
end_function

begin_function
specifier|const
name|char
modifier|*
name|ib_get_trap_str
parameter_list|(
name|ib_net16_t
name|trap_num
parameter_list|)
block|{
switch|switch
condition|(
name|cl_ntoh16
argument_list|(
name|trap_num
argument_list|)
condition|)
block|{
case|case
name|SM_GID_IN_SERVICE_TRAP
case|:
comment|/* 64 */
return|return
literal|"GID in service"
return|;
case|case
name|SM_GID_OUT_OF_SERVICE_TRAP
case|:
comment|/* 65 */
return|return
literal|"GID out of service"
return|;
case|case
name|SM_MGID_CREATED_TRAP
case|:
comment|/* 66 */
return|return
literal|"New mcast group created"
return|;
case|case
name|SM_MGID_DESTROYED_TRAP
case|:
comment|/* 67 */
return|return
literal|"Mcast group deleted"
return|;
case|case
name|SM_UNPATH_TRAP
case|:
comment|/* 68 */
return|return
literal|"UnPath, Path no longer valid"
return|;
case|case
name|SM_REPATH_TRAP
case|:
comment|/* 69 */
return|return
literal|"RePath, Path recomputed"
return|;
case|case
name|SM_LINK_STATE_CHANGED_TRAP
case|:
comment|/* 128 */
return|return
literal|"Link state change"
return|;
case|case
name|SM_LINK_INTEGRITY_THRESHOLD_TRAP
case|:
comment|/* 129 */
return|return
literal|"Local Link integrity threshold reached"
return|;
case|case
name|SM_BUFFER_OVERRUN_THRESHOLD_TRAP
case|:
comment|/* 130 */
return|return
literal|"Excessive Buffer Overrun Threshold reached"
return|;
case|case
name|SM_WATCHDOG_TIMER_EXPIRED_TRAP
case|:
comment|/* 131 */
return|return
literal|"Flow Control Update watchdog timer expired"
return|;
case|case
name|SM_LOCAL_CHANGES_TRAP
case|:
comment|/* 144 */
return|return
literal|"CapabilityMask, NodeDescription, Link [Width|Speed] Enabled, SM priority changed"
return|;
case|case
name|SM_SYS_IMG_GUID_CHANGED_TRAP
case|:
comment|/* 145 */
return|return
literal|"System Image GUID changed"
return|;
case|case
name|SM_BAD_MKEY_TRAP
case|:
comment|/* 256 */
return|return
literal|"Bad M_Key"
return|;
case|case
name|SM_BAD_PKEY_TRAP
case|:
comment|/* 257 */
return|return
literal|"Bad P_Key"
return|;
case|case
name|SM_BAD_QKEY_TRAP
case|:
comment|/* 258 */
return|return
literal|"Bad Q_Key"
return|;
case|case
name|SM_BAD_SWITCH_PKEY_TRAP
case|:
comment|/* 259 */
return|return
literal|"Bad P_Key (switch external port)"
return|;
default|default:
break|break;
block|}
return|return
literal|"Unknown"
return|;
block|}
end_function

begin_decl_stmt
specifier|const
name|ib_gid_t
name|ib_zero_gid
init|=
block|{
block|{
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|ib_api_status_t
name|dbg_do_line
parameter_list|(
name|IN
name|char
modifier|*
modifier|*
name|pp_local
parameter_list|,
name|IN
name|uint32_t
name|buf_size
parameter_list|,
name|IN
specifier|const
name|char
modifier|*
name|p_prefix_str
parameter_list|,
name|IN
specifier|const
name|char
modifier|*
name|p_new_str
parameter_list|,
name|IN
name|uint32_t
modifier|*
name|p_total_len
parameter_list|)
block|{
name|char
name|line
index|[
name|LINE_LENGTH
index|]
decl_stmt|;
name|uint32_t
name|len
decl_stmt|;
name|sprintf
argument_list|(
name|line
argument_list|,
literal|"%s%s"
argument_list|,
name|p_prefix_str
argument_list|,
name|p_new_str
argument_list|)
expr_stmt|;
name|len
operator|=
operator|(
name|uint32_t
operator|)
name|strlen
argument_list|(
name|line
argument_list|)
expr_stmt|;
operator|*
name|p_total_len
operator|+=
name|len
expr_stmt|;
if|if
condition|(
operator|*
name|p_total_len
operator|+
sizeof|sizeof
argument_list|(
literal|'\0'
argument_list|)
operator|>
name|buf_size
condition|)
return|return
name|IB_INSUFFICIENT_MEMORY
return|;
name|strcpy
argument_list|(
operator|*
name|pp_local
argument_list|,
name|line
argument_list|)
expr_stmt|;
operator|*
name|pp_local
operator|+=
name|len
expr_stmt|;
return|return
name|IB_SUCCESS
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|dbg_get_capabilities_str
parameter_list|(
name|IN
name|char
modifier|*
name|p_buf
parameter_list|,
name|IN
name|uint32_t
name|buf_size
parameter_list|,
name|IN
specifier|const
name|char
modifier|*
name|p_prefix_str
parameter_list|,
name|IN
specifier|const
name|ib_port_info_t
modifier|*
name|p_pi
parameter_list|)
block|{
name|uint32_t
name|total_len
init|=
literal|0
decl_stmt|;
name|char
modifier|*
name|p_local
init|=
name|p_buf
decl_stmt|;
name|strcpy
argument_list|(
name|p_local
argument_list|,
literal|"Capability Mask:\n"
argument_list|)
expr_stmt|;
name|p_local
operator|+=
name|strlen
argument_list|(
name|p_local
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_RESV0
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_RESV0\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_IS_SM
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_IS_SM\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_NOTICE
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_NOTICE\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_TRAP
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_TRAP\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_IPD
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_IPD\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_AUTO_MIG
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_AUTO_MIG\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_SL_MAP
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_SL_MAP\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_NV_MKEY
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_NV_MKEY\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_NV_PKEY
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_NV_PKEY\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_LED_INFO
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_LED_INFO\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_SM_DISAB
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_SM_DISAB\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_SYS_IMG_GUID
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_SYS_IMG_GUID\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_PKEY_SW_EXT_PORT_TRAP
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_PKEY_SW_EXT_PORT_TRAP\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_CABLE_INFO
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_CABLE_INFO\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_EXT_SPEEDS
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_EXT_SPEEDS\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_CAP_MASK2
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_CAP_MASK2\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_COM_MGT
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_COM_MGT\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_SNMP
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_SNMP\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_REINIT
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_REINIT\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_DEV_MGT
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_DEV_MGT\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_VEND_CLS
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_VEND_CLS\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_DR_NTC
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_DR_NTC\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_CAP_NTC
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_CAP_NTC\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_BM
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_BM\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_LINK_RT_LATENCY
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_LINK_RT_LATENCY\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_CLIENT_REREG
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_CLIENT_REREG\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_OTHER_LOCAL_CHANGES_NTC
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_OTHER_LOCAL_CHANGES_NTC\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_LINK_SPEED_WIDTH_PAIRS_TBL
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_LINK_SPEED_WIDTH_PAIRS_TBL\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_VEND_MADS
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_VEND_MADS\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_MCAST_PKEY_TRAP_SUPPRESS
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_MCAST_PKEY_TRAP_SUPPRESS\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_MCAST_FDB_TOP
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_MCAST_FDB_TOP\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_HIER_INFO
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP_HAS_HIER_INFO\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|dbg_get_capabilities2_str
parameter_list|(
name|IN
name|char
modifier|*
name|p_buf
parameter_list|,
name|IN
name|uint32_t
name|buf_size
parameter_list|,
name|IN
specifier|const
name|char
modifier|*
name|p_prefix_str
parameter_list|,
name|IN
specifier|const
name|ib_port_info_t
modifier|*
name|p_pi
parameter_list|)
block|{
name|uint32_t
name|total_len
init|=
literal|0
decl_stmt|;
name|char
modifier|*
name|p_local
init|=
name|p_buf
decl_stmt|;
name|strcpy
argument_list|(
name|p_local
argument_list|,
literal|"Capability Mask2:\n"
argument_list|)
expr_stmt|;
name|p_local
operator|+=
name|strlen
argument_list|(
name|p_local
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_pi
operator|->
name|capability_mask2
operator|&
name|IB_PORT_CAP2_IS_SET_NODE_DESC_SUPPORTED
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP2_IS_SET_NODE_DESC_SUPPORTED\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask2
operator|&
name|IB_PORT_CAP2_IS_PORT_INFO_EXT_SUPPORTED
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP2_IS_PORT_INFO_EXT_SUPPORTED\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask2
operator|&
name|IB_PORT_CAP2_IS_VIRT_SUPPORTED
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP2_IS_VIRT_SUPPORTED\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask2
operator|&
name|IB_PORT_CAP2_IS_SWITCH_PORT_STATE_TBL_SUPP
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP2_IS_SWITCH_PORT_STATE_TBL_SUPP\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
if|if
condition|(
name|p_pi
operator|->
name|capability_mask2
operator|&
name|IB_PORT_CAP2_IS_LINK_WIDTH_2X_SUPPORTED
condition|)
block|{
if|if
condition|(
name|dbg_do_line
argument_list|(
operator|&
name|p_local
argument_list|,
name|buf_size
argument_list|,
name|p_prefix_str
argument_list|,
literal|"IB_PORT_CAP2_IS_LINK_WIDTH_2X_SUPPORTED\n"
argument_list|,
operator|&
name|total_len
argument_list|)
operator|!=
name|IB_SUCCESS
condition|)
return|return;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_port_info_to_buf
parameter_list|(
name|IN
name|ib_net64_t
name|node_guid
parameter_list|,
name|IN
name|ib_net64_t
name|port_guid
parameter_list|,
name|IN
name|uint8_t
name|port_num
parameter_list|,
name|IN
specifier|const
name|ib_port_info_t
modifier|*
name|p_pi
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_pi
condition|)
return|return;
else|else
block|{
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"PortInfo dump:\n"
literal|"\t\t\t\tport number..............%u\n"
literal|"\t\t\t\tnode_guid................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tport_guid................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tm_key....................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tsubnet_prefix............0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tbase_lid.................%u\n"
literal|"\t\t\t\tmaster_sm_base_lid.......%u\n"
literal|"\t\t\t\tcapability_mask..........0x%X\n"
literal|"\t\t\t\tdiag_code................0x%X\n"
literal|"\t\t\t\tm_key_lease_period.......0x%X\n"
literal|"\t\t\t\tlocal_port_num...........%u\n"
literal|"\t\t\t\tlink_width_enabled.......0x%X\n"
literal|"\t\t\t\tlink_width_supported.....0x%X\n"
literal|"\t\t\t\tlink_width_active........0x%X\n"
literal|"\t\t\t\tlink_speed_supported.....0x%X\n"
literal|"\t\t\t\tport_state...............%s\n"
literal|"\t\t\t\tstate_info2..............0x%X\n"
literal|"\t\t\t\tm_key_protect_bits.......0x%X\n"
literal|"\t\t\t\tlmc......................0x%X\n"
literal|"\t\t\t\tlink_speed...............0x%X\n"
literal|"\t\t\t\tmtu_smsl.................0x%X\n"
literal|"\t\t\t\tvl_cap_init_type.........0x%X\n"
literal|"\t\t\t\tvl_high_limit............0x%X\n"
literal|"\t\t\t\tvl_arb_high_cap..........0x%X\n"
literal|"\t\t\t\tvl_arb_low_cap...........0x%X\n"
literal|"\t\t\t\tinit_rep_mtu_cap.........0x%X\n"
literal|"\t\t\t\tvl_stall_life............0x%X\n"
literal|"\t\t\t\tvl_enforce...............0x%X\n"
literal|"\t\t\t\tm_key_violations.........0x%X\n"
literal|"\t\t\t\tp_key_violations.........0x%X\n"
literal|"\t\t\t\tq_key_violations.........0x%X\n"
literal|"\t\t\t\tguid_cap.................0x%X\n"
literal|"\t\t\t\tclient_reregister........0x%X\n"
literal|"\t\t\t\tmcast_pkey_trap_suppr....0x%X\n"
literal|"\t\t\t\tsubnet_timeout...........0x%X\n"
literal|"\t\t\t\tresp_time_value..........0x%X\n"
literal|"\t\t\t\terror_threshold..........0x%X\n"
literal|"\t\t\t\tmax_credit_hint..........0x%X\n"
literal|"\t\t\t\tlink_round_trip_latency..0x%X\n"
literal|"\t\t\t\tcapability_mask2.........0x%X\n"
literal|"\t\t\t\tlink_speed_ext_active....0x%X\n"
literal|"\t\t\t\tlink_speed_ext_supported.0x%X\n"
literal|"\t\t\t\tlink_speed_ext_enabled...0x%X\n"
argument_list|,
name|port_num
argument_list|,
name|cl_ntoh64
argument_list|(
name|node_guid
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|port_guid
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_pi
operator|->
name|m_key
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_pi
operator|->
name|subnet_prefix
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|base_lid
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|master_sm_base_lid
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_pi
operator|->
name|capability_mask
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|diag_code
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|m_key_lease_period
argument_list|)
argument_list|,
name|p_pi
operator|->
name|local_port_num
argument_list|,
name|p_pi
operator|->
name|link_width_enabled
argument_list|,
name|p_pi
operator|->
name|link_width_supported
argument_list|,
name|p_pi
operator|->
name|link_width_active
argument_list|,
name|ib_port_info_get_link_speed_sup
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|ib_get_port_state_str
argument_list|(
name|ib_port_info_get_port_state
argument_list|(
name|p_pi
argument_list|)
argument_list|)
argument_list|,
name|p_pi
operator|->
name|state_info2
argument_list|,
name|ib_port_info_get_mpb
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|ib_port_info_get_lmc
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|p_pi
operator|->
name|link_speed
argument_list|,
name|p_pi
operator|->
name|mtu_smsl
argument_list|,
name|p_pi
operator|->
name|vl_cap
argument_list|,
name|p_pi
operator|->
name|vl_high_limit
argument_list|,
name|p_pi
operator|->
name|vl_arb_high_cap
argument_list|,
name|p_pi
operator|->
name|vl_arb_low_cap
argument_list|,
name|p_pi
operator|->
name|mtu_cap
argument_list|,
name|p_pi
operator|->
name|vl_stall_life
argument_list|,
name|p_pi
operator|->
name|vl_enforce
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|m_key_violations
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|p_key_violations
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|q_key_violations
argument_list|)
argument_list|,
name|p_pi
operator|->
name|guid_cap
argument_list|,
name|ib_port_info_get_client_rereg
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|ib_port_info_get_mcast_pkey_trap_suppress
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|ib_port_info_get_timeout
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|ib_port_info_get_resp_time_value
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|p_pi
operator|->
name|error_threshold
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|max_credit_hint
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_pi
operator|->
name|link_rt_latency
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|capability_mask2
argument_list|)
argument_list|,
name|ib_port_info_get_link_speed_ext_active
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|ib_port_info_get_link_speed_ext_sup
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|p_pi
operator|->
name|link_speed_ext_enabled
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_port_info
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
name|ib_net64_t
name|node_guid
parameter_list|,
name|IN
name|ib_net64_t
name|port_guid
parameter_list|,
name|IN
name|uint8_t
name|port_num
parameter_list|,
name|IN
specifier|const
name|ib_port_info_t
modifier|*
name|p_pi
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_port_info_to_buf
argument_list|(
name|node_guid
argument_list|,
name|port_guid
argument_list|,
name|port_num
argument_list|,
name|p_pi
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
comment|/*  show the capabilities masks */
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
condition|)
block|{
name|dbg_get_capabilities_str
argument_list|(
name|buf
argument_list|,
name|BUF_SIZE
argument_list|,
literal|"\t\t\t\t"
argument_list|,
name|p_pi
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_CAP_MASK2
operator|)
operator|&&
name|p_pi
operator|->
name|capability_mask2
condition|)
block|{
name|dbg_get_capabilities2_str
argument_list|(
name|buf
argument_list|,
name|BUF_SIZE
argument_list|,
literal|"\t\t\t\t"
argument_list|,
name|p_pi
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_port_info_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
name|ib_net64_t
name|node_guid
parameter_list|,
name|IN
name|ib_net64_t
name|port_guid
parameter_list|,
name|IN
name|uint8_t
name|port_num
parameter_list|,
name|IN
specifier|const
name|ib_port_info_t
modifier|*
name|p_pi
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_port_info_to_buf
argument_list|(
name|node_guid
argument_list|,
name|port_guid
argument_list|,
name|port_num
argument_list|,
name|p_pi
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
comment|/*  show the capabilities masks */
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
condition|)
block|{
name|dbg_get_capabilities_str
argument_list|(
name|buf
argument_list|,
name|BUF_SIZE
argument_list|,
literal|"\t\t\t\t"
argument_list|,
name|p_pi
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_CAP_MASK2
operator|)
operator|&&
name|p_pi
operator|->
name|capability_mask2
condition|)
block|{
name|dbg_get_capabilities2_str
argument_list|(
name|buf
argument_list|,
name|BUF_SIZE
argument_list|,
literal|"\t\t\t\t"
argument_list|,
name|p_pi
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_mlnx_ext_port_info_to_buf
parameter_list|(
name|IN
name|ib_net64_t
name|node_guid
parameter_list|,
name|IN
name|ib_net64_t
name|port_guid
parameter_list|,
name|IN
name|uint8_t
name|port_num
parameter_list|,
name|IN
specifier|const
name|ib_mlnx_ext_port_info_t
modifier|*
name|p_pi
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_pi
condition|)
return|return;
else|else
block|{
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"MLNX ExtendedPortInfo dump:\n"
literal|"\t\t\t\tport number..............%u\n"
literal|"\t\t\t\tnode_guid................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tport_guid................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tStateChangeEnable........0x%X\n"
literal|"\t\t\t\tLinkSpeedSupported.......0x%X\n"
literal|"\t\t\t\tLinkSpeedEnabled.........0x%X\n"
literal|"\t\t\t\tLinkSpeedActive..........0x%X\n"
argument_list|,
name|port_num
argument_list|,
name|cl_ntoh64
argument_list|(
name|node_guid
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|port_guid
argument_list|)
argument_list|,
name|p_pi
operator|->
name|state_change_enable
argument_list|,
name|p_pi
operator|->
name|link_speed_supported
argument_list|,
name|p_pi
operator|->
name|link_speed_enabled
argument_list|,
name|p_pi
operator|->
name|link_speed_active
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_mlnx_ext_port_info
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
name|ib_net64_t
name|node_guid
parameter_list|,
name|IN
name|ib_net64_t
name|port_guid
parameter_list|,
name|IN
name|uint8_t
name|port_num
parameter_list|,
name|IN
specifier|const
name|ib_mlnx_ext_port_info_t
modifier|*
name|p_pi
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_mlnx_ext_port_info_to_buf
argument_list|(
name|node_guid
argument_list|,
name|port_guid
argument_list|,
name|port_num
argument_list|,
name|p_pi
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_mlnx_ext_port_info_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
name|ib_net64_t
name|node_guid
parameter_list|,
name|IN
name|ib_net64_t
name|port_guid
parameter_list|,
name|IN
name|uint8_t
name|port_num
parameter_list|,
name|IN
specifier|const
name|ib_mlnx_ext_port_info_t
modifier|*
name|p_pi
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_mlnx_ext_port_info_to_buf
argument_list|(
name|node_guid
argument_list|,
name|port_guid
argument_list|,
name|port_num
argument_list|,
name|p_pi
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_portinfo_record_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_portinfo_record_t
modifier|*
name|p_pir
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_pir
condition|)
return|return;
else|else
block|{
specifier|const
name|ib_port_info_t
modifier|*
name|p_pi
init|=
operator|&
name|p_pir
operator|->
name|port_info
decl_stmt|;
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"PortInfo Record dump:\n"
literal|"\t\t\t\tRID\n"
literal|"\t\t\t\tEndPortLid...............%u\n"
literal|"\t\t\t\tPortNum..................%u\n"
literal|"\t\t\t\tOptions..................0x%X\n"
literal|"\t\t\t\tPortInfo dump:\n"
literal|"\t\t\t\tm_key....................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tsubnet_prefix............0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tbase_lid.................%u\n"
literal|"\t\t\t\tmaster_sm_base_lid.......%u\n"
literal|"\t\t\t\tcapability_mask..........0x%X\n"
literal|"\t\t\t\tdiag_code................0x%X\n"
literal|"\t\t\t\tm_key_lease_period.......0x%X\n"
literal|"\t\t\t\tlocal_port_num...........%u\n"
literal|"\t\t\t\tlink_width_enabled.......0x%X\n"
literal|"\t\t\t\tlink_width_supported.....0x%X\n"
literal|"\t\t\t\tlink_width_active........0x%X\n"
literal|"\t\t\t\tlink_speed_supported.....0x%X\n"
literal|"\t\t\t\tport_state...............%s\n"
literal|"\t\t\t\tstate_info2..............0x%X\n"
literal|"\t\t\t\tm_key_protect_bits.......0x%X\n"
literal|"\t\t\t\tlmc......................0x%X\n"
literal|"\t\t\t\tlink_speed...............0x%X\n"
literal|"\t\t\t\tmtu_smsl.................0x%X\n"
literal|"\t\t\t\tvl_cap_init_type.........0x%X\n"
literal|"\t\t\t\tvl_high_limit............0x%X\n"
literal|"\t\t\t\tvl_arb_high_cap..........0x%X\n"
literal|"\t\t\t\tvl_arb_low_cap...........0x%X\n"
literal|"\t\t\t\tinit_rep_mtu_cap.........0x%X\n"
literal|"\t\t\t\tvl_stall_life............0x%X\n"
literal|"\t\t\t\tvl_enforce...............0x%X\n"
literal|"\t\t\t\tm_key_violations.........0x%X\n"
literal|"\t\t\t\tp_key_violations.........0x%X\n"
literal|"\t\t\t\tq_key_violations.........0x%X\n"
literal|"\t\t\t\tguid_cap.................0x%X\n"
literal|"\t\t\t\tclient_reregister........0x%X\n"
literal|"\t\t\t\tmcast_pkey_trap_suppr....0x%X\n"
literal|"\t\t\t\tsubnet_timeout...........0x%X\n"
literal|"\t\t\t\tresp_time_value..........0x%X\n"
literal|"\t\t\t\terror_threshold..........0x%X\n"
literal|"\t\t\t\tmax_credit_hint..........0x%X\n"
literal|"\t\t\t\tlink_round_trip_latency..0x%X\n"
literal|"\t\t\t\tcapability_mask2.........0x%X\n"
literal|"\t\t\t\tlink_speed_ext_active....0x%X\n"
literal|"\t\t\t\tlink_speed_ext_supported.0x%X\n"
literal|"\t\t\t\tlink_speed_ext_enabled...0x%X\n"
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pir
operator|->
name|lid
argument_list|)
argument_list|,
name|p_pir
operator|->
name|port_num
argument_list|,
name|p_pir
operator|->
name|options
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_pi
operator|->
name|m_key
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_pi
operator|->
name|subnet_prefix
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|base_lid
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|master_sm_base_lid
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_pi
operator|->
name|capability_mask
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|diag_code
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|m_key_lease_period
argument_list|)
argument_list|,
name|p_pi
operator|->
name|local_port_num
argument_list|,
name|p_pi
operator|->
name|link_width_enabled
argument_list|,
name|p_pi
operator|->
name|link_width_supported
argument_list|,
name|p_pi
operator|->
name|link_width_active
argument_list|,
name|ib_port_info_get_link_speed_sup
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|ib_get_port_state_str
argument_list|(
name|ib_port_info_get_port_state
argument_list|(
name|p_pi
argument_list|)
argument_list|)
argument_list|,
name|p_pi
operator|->
name|state_info2
argument_list|,
name|ib_port_info_get_mpb
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|ib_port_info_get_lmc
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|p_pi
operator|->
name|link_speed
argument_list|,
name|p_pi
operator|->
name|mtu_smsl
argument_list|,
name|p_pi
operator|->
name|vl_cap
argument_list|,
name|p_pi
operator|->
name|vl_high_limit
argument_list|,
name|p_pi
operator|->
name|vl_arb_high_cap
argument_list|,
name|p_pi
operator|->
name|vl_arb_low_cap
argument_list|,
name|p_pi
operator|->
name|mtu_cap
argument_list|,
name|p_pi
operator|->
name|vl_stall_life
argument_list|,
name|p_pi
operator|->
name|vl_enforce
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|m_key_violations
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|p_key_violations
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|q_key_violations
argument_list|)
argument_list|,
name|p_pi
operator|->
name|guid_cap
argument_list|,
name|ib_port_info_get_client_rereg
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|ib_port_info_get_mcast_pkey_trap_suppress
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|ib_port_info_get_timeout
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|ib_port_info_get_resp_time_value
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|p_pi
operator|->
name|error_threshold
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|max_credit_hint
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_pi
operator|->
name|link_rt_latency
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pi
operator|->
name|capability_mask2
argument_list|)
argument_list|,
name|ib_port_info_get_link_speed_ext_active
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|ib_port_info_get_link_speed_ext_sup
argument_list|(
name|p_pi
argument_list|)
argument_list|,
name|p_pi
operator|->
name|link_speed_ext_enabled
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_portinfo_record
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_portinfo_record_t
modifier|*
name|p_pir
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
specifier|const
name|ib_port_info_t
modifier|*
name|p_pi
init|=
operator|&
name|p_pir
operator|->
name|port_info
decl_stmt|;
name|osm_dump_portinfo_record_to_buf
argument_list|(
name|p_pir
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
comment|/*  show the capabilities masks */
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
condition|)
block|{
name|dbg_get_capabilities_str
argument_list|(
name|buf
argument_list|,
name|BUF_SIZE
argument_list|,
literal|"\t\t\t\t"
argument_list|,
name|p_pi
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_CAP_MASK2
operator|)
operator|&&
name|p_pi
operator|->
name|capability_mask2
condition|)
block|{
name|dbg_get_capabilities2_str
argument_list|(
name|buf
argument_list|,
name|BUF_SIZE
argument_list|,
literal|"\t\t\t\t"
argument_list|,
name|p_pi
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_portinfo_record_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_portinfo_record_t
modifier|*
name|p_pir
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
specifier|const
name|ib_port_info_t
modifier|*
name|p_pi
init|=
operator|&
name|p_pir
operator|->
name|port_info
decl_stmt|;
name|osm_dump_portinfo_record_to_buf
argument_list|(
name|p_pir
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
comment|/*  show the capabilities masks */
if|if
condition|(
name|p_pi
operator|->
name|capability_mask
condition|)
block|{
name|dbg_get_capabilities_str
argument_list|(
name|buf
argument_list|,
name|BUF_SIZE
argument_list|,
literal|"\t\t\t\t"
argument_list|,
name|p_pi
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|p_pi
operator|->
name|capability_mask
operator|&
name|IB_PORT_CAP_HAS_CAP_MASK2
operator|)
operator|&&
name|p_pi
operator|->
name|capability_mask2
condition|)
block|{
name|dbg_get_capabilities2_str
argument_list|(
name|buf
argument_list|,
name|BUF_SIZE
argument_list|,
literal|"\t\t\t\t"
argument_list|,
name|p_pi
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_guid_info_to_buf
parameter_list|(
name|IN
name|ib_net64_t
name|node_guid
parameter_list|,
name|IN
name|ib_net64_t
name|port_guid
parameter_list|,
name|IN
name|uint8_t
name|block_num
parameter_list|,
name|IN
specifier|const
name|ib_guid_info_t
modifier|*
name|p_gi
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_gi
condition|)
return|return;
else|else
block|{
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"GUIDInfo dump:\n"
literal|"\t\t\t\tblock number............%u\n"
literal|"\t\t\t\tnode_guid...............0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tport_guid...............0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tGUID 0..................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tGUID 1..................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tGUID 2..................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tGUID 3..................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tGUID 4..................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tGUID 5..................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tGUID 6..................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tGUID 7..................0x%016"
name|PRIx64
literal|"\n"
argument_list|,
name|block_num
argument_list|,
name|cl_ntoh64
argument_list|(
name|node_guid
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|port_guid
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_gi
operator|->
name|guid
index|[
literal|0
index|]
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_gi
operator|->
name|guid
index|[
literal|1
index|]
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_gi
operator|->
name|guid
index|[
literal|2
index|]
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_gi
operator|->
name|guid
index|[
literal|3
index|]
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_gi
operator|->
name|guid
index|[
literal|4
index|]
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_gi
operator|->
name|guid
index|[
literal|5
index|]
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_gi
operator|->
name|guid
index|[
literal|6
index|]
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_gi
operator|->
name|guid
index|[
literal|7
index|]
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_guid_info
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
name|ib_net64_t
name|node_guid
parameter_list|,
name|IN
name|ib_net64_t
name|port_guid
parameter_list|,
name|IN
name|uint8_t
name|block_num
parameter_list|,
name|IN
specifier|const
name|ib_guid_info_t
modifier|*
name|p_gi
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_guid_info_to_buf
argument_list|(
name|node_guid
argument_list|,
name|port_guid
argument_list|,
name|block_num
argument_list|,
name|p_gi
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_guid_info_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
name|ib_net64_t
name|node_guid
parameter_list|,
name|IN
name|ib_net64_t
name|port_guid
parameter_list|,
name|IN
name|uint8_t
name|block_num
parameter_list|,
name|IN
specifier|const
name|ib_guid_info_t
modifier|*
name|p_gi
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_guid_info_to_buf
argument_list|(
name|node_guid
argument_list|,
name|port_guid
argument_list|,
name|block_num
argument_list|,
name|p_gi
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_guidinfo_record_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_guidinfo_record_t
modifier|*
name|p_gir
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_gir
condition|)
return|return;
else|else
block|{
specifier|const
name|ib_guid_info_t
modifier|*
name|p_gi
init|=
operator|&
name|p_gir
operator|->
name|guid_info
decl_stmt|;
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"GUIDInfo Record dump:\n"
literal|"\t\t\t\tRID\n"
literal|"\t\t\t\tLid.....................%u\n"
literal|"\t\t\t\tBlockNum................0x%X\n"
literal|"\t\t\t\tReserved................0x%X\n"
literal|"\t\t\t\tGUIDInfo dump:\n"
literal|"\t\t\t\tReserved................0x%X\n"
literal|"\t\t\t\tGUID 0..................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tGUID 1..................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tGUID 2..................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tGUID 3..................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tGUID 4..................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tGUID 5..................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tGUID 6..................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tGUID 7..................0x%016"
name|PRIx64
literal|"\n"
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_gir
operator|->
name|lid
argument_list|)
argument_list|,
name|p_gir
operator|->
name|block_num
argument_list|,
name|p_gir
operator|->
name|resv
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_gir
operator|->
name|reserved
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_gi
operator|->
name|guid
index|[
literal|0
index|]
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_gi
operator|->
name|guid
index|[
literal|1
index|]
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_gi
operator|->
name|guid
index|[
literal|2
index|]
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_gi
operator|->
name|guid
index|[
literal|3
index|]
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_gi
operator|->
name|guid
index|[
literal|4
index|]
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_gi
operator|->
name|guid
index|[
literal|5
index|]
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_gi
operator|->
name|guid
index|[
literal|6
index|]
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_gi
operator|->
name|guid
index|[
literal|7
index|]
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_guidinfo_record
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_guidinfo_record_t
modifier|*
name|p_gir
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_guidinfo_record_to_buf
argument_list|(
name|p_gir
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_guidinfo_record_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_guidinfo_record_t
modifier|*
name|p_gir
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_guidinfo_record_to_buf
argument_list|(
name|p_gir
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_node_info_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_node_info_t
modifier|*
name|p_ni
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_ni
condition|)
return|return;
else|else
block|{
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"NodeInfo dump:\n"
literal|"\t\t\t\tbase_version............0x%X\n"
literal|"\t\t\t\tclass_version...........0x%X\n"
literal|"\t\t\t\tnode_type...............%s\n"
literal|"\t\t\t\tnum_ports...............%u\n"
literal|"\t\t\t\tsys_guid................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tnode_guid...............0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tport_guid...............0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tpartition_cap...........0x%X\n"
literal|"\t\t\t\tdevice_id...............0x%X\n"
literal|"\t\t\t\trevision................0x%X\n"
literal|"\t\t\t\tport_num................%u\n"
literal|"\t\t\t\tvendor_id...............0x%X\n"
argument_list|,
name|p_ni
operator|->
name|base_version
argument_list|,
name|p_ni
operator|->
name|class_version
argument_list|,
name|ib_get_node_type_str
argument_list|(
name|p_ni
operator|->
name|node_type
argument_list|)
argument_list|,
name|p_ni
operator|->
name|num_ports
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_ni
operator|->
name|sys_guid
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_ni
operator|->
name|node_guid
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_ni
operator|->
name|port_guid
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ni
operator|->
name|partition_cap
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ni
operator|->
name|device_id
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_ni
operator|->
name|revision
argument_list|)
argument_list|,
name|ib_node_info_get_local_port_num
argument_list|(
name|p_ni
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|ib_node_info_get_vendor_id
argument_list|(
name|p_ni
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_node_info
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_node_info_t
modifier|*
name|p_ni
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_node_info_to_buf
argument_list|(
name|p_ni
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_node_info_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_node_info_t
modifier|*
name|p_ni
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_node_info_to_buf
argument_list|(
name|p_ni
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_node_record_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_node_record_t
modifier|*
name|p_nr
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_nr
condition|)
return|return;
else|else
block|{
name|char
name|desc
index|[
sizeof|sizeof
argument_list|(
name|p_nr
operator|->
name|node_desc
operator|.
name|description
argument_list|)
operator|+
literal|1
index|]
decl_stmt|;
specifier|const
name|ib_node_info_t
modifier|*
name|p_ni
init|=
operator|&
name|p_nr
operator|->
name|node_info
decl_stmt|;
name|memcpy
argument_list|(
name|desc
argument_list|,
name|p_nr
operator|->
name|node_desc
operator|.
name|description
argument_list|,
sizeof|sizeof
argument_list|(
name|p_nr
operator|->
name|node_desc
operator|.
name|description
argument_list|)
argument_list|)
expr_stmt|;
name|desc
index|[
sizeof|sizeof
argument_list|(
name|desc
argument_list|)
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"Node Record dump:\n"
literal|"\t\t\t\tRID\n"
literal|"\t\t\t\tLid.....................%u\n"
literal|"\t\t\t\tReserved................0x%X\n"
literal|"\t\t\t\tNodeInfo dump:\n"
literal|"\t\t\t\tbase_version............0x%X\n"
literal|"\t\t\t\tclass_version...........0x%X\n"
literal|"\t\t\t\tnode_type...............%s\n"
literal|"\t\t\t\tnum_ports...............%u\n"
literal|"\t\t\t\tsys_guid................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tnode_guid...............0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tport_guid...............0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tpartition_cap...........0x%X\n"
literal|"\t\t\t\tdevice_id...............0x%X\n"
literal|"\t\t\t\trevision................0x%X\n"
literal|"\t\t\t\tport_num................%u\n"
literal|"\t\t\t\tvendor_id...............0x%X\n"
literal|"\t\t\t\tNodeDescription\n"
literal|"\t\t\t\t%s\n"
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_nr
operator|->
name|lid
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_nr
operator|->
name|resv
argument_list|)
argument_list|,
name|p_ni
operator|->
name|base_version
argument_list|,
name|p_ni
operator|->
name|class_version
argument_list|,
name|ib_get_node_type_str
argument_list|(
name|p_ni
operator|->
name|node_type
argument_list|)
argument_list|,
name|p_ni
operator|->
name|num_ports
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_ni
operator|->
name|sys_guid
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_ni
operator|->
name|node_guid
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_ni
operator|->
name|port_guid
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ni
operator|->
name|partition_cap
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ni
operator|->
name|device_id
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_ni
operator|->
name|revision
argument_list|)
argument_list|,
name|ib_node_info_get_local_port_num
argument_list|(
name|p_ni
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|ib_node_info_get_vendor_id
argument_list|(
name|p_ni
argument_list|)
argument_list|)
argument_list|,
name|desc
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_node_record
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_node_record_t
modifier|*
name|p_nr
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_node_record_to_buf
argument_list|(
name|p_nr
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_node_record_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_node_record_t
modifier|*
name|p_nr
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_node_record_to_buf
argument_list|(
name|p_nr
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_path_record_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_path_rec_t
modifier|*
name|p_pr
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_pr
condition|)
return|return;
else|else
block|{
name|char
name|gid_str
index|[
name|INET6_ADDRSTRLEN
index|]
decl_stmt|;
name|char
name|gid_str2
index|[
name|INET6_ADDRSTRLEN
index|]
decl_stmt|;
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"PathRecord dump:\n"
literal|"\t\t\t\tservice_id..............0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tdgid....................%s\n"
literal|"\t\t\t\tsgid....................%s\n"
literal|"\t\t\t\tdlid....................%u\n"
literal|"\t\t\t\tslid....................%u\n"
literal|"\t\t\t\thop_flow_raw............0x%X\n"
literal|"\t\t\t\ttclass..................0x%X\n"
literal|"\t\t\t\tnum_path_revers.........0x%X\n"
literal|"\t\t\t\tpkey....................0x%X\n"
literal|"\t\t\t\tqos_class...............0x%X\n"
literal|"\t\t\t\tsl......................0x%X\n"
literal|"\t\t\t\tmtu.....................0x%X\n"
literal|"\t\t\t\trate....................0x%X\n"
literal|"\t\t\t\tpkt_life................0x%X\n"
literal|"\t\t\t\tpreference..............0x%X\n"
literal|"\t\t\t\tresv2...................0x%02X%02X%02X%02X%02X%02X\n"
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_pr
operator|->
name|service_id
argument_list|)
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_pr
operator|->
name|dgid
operator|.
name|raw
argument_list|,
name|gid_str
argument_list|,
sizeof|sizeof
name|gid_str
argument_list|)
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_pr
operator|->
name|sgid
operator|.
name|raw
argument_list|,
name|gid_str2
argument_list|,
sizeof|sizeof
name|gid_str2
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pr
operator|->
name|dlid
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pr
operator|->
name|slid
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_pr
operator|->
name|hop_flow_raw
argument_list|)
argument_list|,
name|p_pr
operator|->
name|tclass
argument_list|,
name|p_pr
operator|->
name|num_path
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pr
operator|->
name|pkey
argument_list|)
argument_list|,
name|ib_path_rec_qos_class
argument_list|(
name|p_pr
argument_list|)
argument_list|,
name|ib_path_rec_sl
argument_list|(
name|p_pr
argument_list|)
argument_list|,
name|p_pr
operator|->
name|mtu
argument_list|,
name|p_pr
operator|->
name|rate
argument_list|,
name|p_pr
operator|->
name|pkt_life
argument_list|,
name|p_pr
operator|->
name|preference
argument_list|,
name|p_pr
operator|->
name|resv2
index|[
literal|0
index|]
argument_list|,
name|p_pr
operator|->
name|resv2
index|[
literal|1
index|]
argument_list|,
name|p_pr
operator|->
name|resv2
index|[
literal|2
index|]
argument_list|,
name|p_pr
operator|->
name|resv2
index|[
literal|3
index|]
argument_list|,
name|p_pr
operator|->
name|resv2
index|[
literal|4
index|]
argument_list|,
name|p_pr
operator|->
name|resv2
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_path_record
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_path_rec_t
modifier|*
name|p_pr
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_path_record_to_buf
argument_list|(
name|p_pr
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_path_record_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_path_rec_t
modifier|*
name|p_pr
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_path_record_to_buf
argument_list|(
name|p_pr
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_multipath_record_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_multipath_rec_t
modifier|*
name|p_mpr
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_mpr
condition|)
return|return;
else|else
block|{
name|char
name|gid_str
index|[
name|INET6_ADDRSTRLEN
index|]
decl_stmt|;
name|char
name|buf_line
index|[
literal|1024
index|]
decl_stmt|;
name|ib_gid_t
specifier|const
modifier|*
name|p_gid
init|=
name|p_mpr
operator|->
name|gids
decl_stmt|;
name|int
name|i
decl_stmt|,
name|n
init|=
literal|0
decl_stmt|;
if|if
condition|(
name|p_mpr
operator|->
name|sgid_count
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|p_mpr
operator|->
name|sgid_count
condition|;
name|i
operator|++
control|)
block|{
name|n
operator|+=
name|sprintf
argument_list|(
name|buf_line
operator|+
name|n
argument_list|,
literal|"\t\t\t\tsgid%02d.................."
literal|"%s\n"
argument_list|,
name|i
operator|+
literal|1
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_gid
operator|->
name|raw
argument_list|,
name|gid_str
argument_list|,
sizeof|sizeof
name|gid_str
argument_list|)
argument_list|)
expr_stmt|;
name|p_gid
operator|++
expr_stmt|;
block|}
block|}
if|if
condition|(
name|p_mpr
operator|->
name|dgid_count
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|p_mpr
operator|->
name|dgid_count
condition|;
name|i
operator|++
control|)
block|{
name|n
operator|+=
name|sprintf
argument_list|(
name|buf_line
operator|+
name|n
argument_list|,
literal|"\t\t\t\tdgid%02d.................."
literal|"%s\n"
argument_list|,
name|i
operator|+
literal|1
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_gid
operator|->
name|raw
argument_list|,
name|gid_str
argument_list|,
sizeof|sizeof
name|gid_str
argument_list|)
argument_list|)
expr_stmt|;
name|p_gid
operator|++
expr_stmt|;
block|}
block|}
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"MultiPath Record dump:\n"
literal|"\t\t\t\thop_flow_raw............0x%X\n"
literal|"\t\t\t\ttclass..................0x%X\n"
literal|"\t\t\t\tnum_path_revers.........0x%X\n"
literal|"\t\t\t\tpkey....................0x%X\n"
literal|"\t\t\t\tqos_class...............0x%X\n"
literal|"\t\t\t\tsl......................0x%X\n"
literal|"\t\t\t\tmtu.....................0x%X\n"
literal|"\t\t\t\trate....................0x%X\n"
literal|"\t\t\t\tpkt_life................0x%X\n"
literal|"\t\t\t\tindependence............0x%X\n"
literal|"\t\t\t\tsgid_count..............0x%X\n"
literal|"\t\t\t\tdgid_count..............0x%X\n"
literal|"\t\t\t\tservice_id..............0x%016"
name|PRIx64
literal|"\n"
literal|"%s\n"
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_mpr
operator|->
name|hop_flow_raw
argument_list|)
argument_list|,
name|p_mpr
operator|->
name|tclass
argument_list|,
name|p_mpr
operator|->
name|num_path
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_mpr
operator|->
name|pkey
argument_list|)
argument_list|,
name|ib_multipath_rec_qos_class
argument_list|(
name|p_mpr
argument_list|)
argument_list|,
name|ib_multipath_rec_sl
argument_list|(
name|p_mpr
argument_list|)
argument_list|,
name|p_mpr
operator|->
name|mtu
argument_list|,
name|p_mpr
operator|->
name|rate
argument_list|,
name|p_mpr
operator|->
name|pkt_life
argument_list|,
name|p_mpr
operator|->
name|independence
argument_list|,
name|p_mpr
operator|->
name|sgid_count
argument_list|,
name|p_mpr
operator|->
name|dgid_count
argument_list|,
name|cl_ntoh64
argument_list|(
name|ib_multipath_rec_service_id
argument_list|(
name|p_mpr
argument_list|)
argument_list|)
argument_list|,
name|buf_line
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_multipath_record
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_multipath_rec_t
modifier|*
name|p_mpr
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_multipath_record_to_buf
argument_list|(
name|p_mpr
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_multipath_record_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_multipath_rec_t
modifier|*
name|p_mpr
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_multipath_record_to_buf
argument_list|(
name|p_mpr
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_mc_record_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_member_rec_t
modifier|*
name|p_mcmr
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_mcmr
condition|)
return|return;
else|else
block|{
name|char
name|gid_str
index|[
name|INET6_ADDRSTRLEN
index|]
decl_stmt|;
name|char
name|gid_str2
index|[
name|INET6_ADDRSTRLEN
index|]
decl_stmt|;
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"MCMember Record dump:\n"
literal|"\t\t\t\tMGID....................%s\n"
literal|"\t\t\t\tPortGid.................%s\n"
literal|"\t\t\t\tqkey....................0x%X\n"
literal|"\t\t\t\tmlid....................0x%X\n"
literal|"\t\t\t\tmtu.....................0x%X\n"
literal|"\t\t\t\tTClass..................0x%X\n"
literal|"\t\t\t\tpkey....................0x%X\n"
literal|"\t\t\t\trate....................0x%X\n"
literal|"\t\t\t\tpkt_life................0x%X\n"
literal|"\t\t\t\tSLFlowLabelHopLimit.....0x%X\n"
literal|"\t\t\t\tScopeState..............0x%X\n"
literal|"\t\t\t\tProxyJoin...............0x%X\n"
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_mcmr
operator|->
name|mgid
operator|.
name|raw
argument_list|,
name|gid_str
argument_list|,
sizeof|sizeof
name|gid_str
argument_list|)
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_mcmr
operator|->
name|port_gid
operator|.
name|raw
argument_list|,
name|gid_str2
argument_list|,
sizeof|sizeof
name|gid_str2
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_mcmr
operator|->
name|qkey
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_mcmr
operator|->
name|mlid
argument_list|)
argument_list|,
name|p_mcmr
operator|->
name|mtu
argument_list|,
name|p_mcmr
operator|->
name|tclass
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_mcmr
operator|->
name|pkey
argument_list|)
argument_list|,
name|p_mcmr
operator|->
name|rate
argument_list|,
name|p_mcmr
operator|->
name|pkt_life
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_mcmr
operator|->
name|sl_flow_hop
argument_list|)
argument_list|,
name|p_mcmr
operator|->
name|scope_state
argument_list|,
name|p_mcmr
operator|->
name|proxy_join
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_mc_record
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_member_rec_t
modifier|*
name|p_mcmr
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_mc_record_to_buf
argument_list|(
name|p_mcmr
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_mc_record_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_member_rec_t
modifier|*
name|p_mcmr
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_mc_record_to_buf
argument_list|(
name|p_mcmr
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_service_record_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_service_record_t
modifier|*
name|p_sr
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_sr
condition|)
return|return;
else|else
block|{
name|char
name|gid_str
index|[
name|INET6_ADDRSTRLEN
index|]
decl_stmt|;
name|char
name|buf_service_key
index|[
literal|35
index|]
decl_stmt|;
name|char
name|buf_service_name
index|[
literal|65
index|]
decl_stmt|;
name|sprintf
argument_list|(
name|buf_service_key
argument_list|,
literal|"0x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x"
argument_list|,
name|p_sr
operator|->
name|service_key
index|[
literal|0
index|]
argument_list|,
name|p_sr
operator|->
name|service_key
index|[
literal|1
index|]
argument_list|,
name|p_sr
operator|->
name|service_key
index|[
literal|2
index|]
argument_list|,
name|p_sr
operator|->
name|service_key
index|[
literal|3
index|]
argument_list|,
name|p_sr
operator|->
name|service_key
index|[
literal|4
index|]
argument_list|,
name|p_sr
operator|->
name|service_key
index|[
literal|5
index|]
argument_list|,
name|p_sr
operator|->
name|service_key
index|[
literal|6
index|]
argument_list|,
name|p_sr
operator|->
name|service_key
index|[
literal|7
index|]
argument_list|,
name|p_sr
operator|->
name|service_key
index|[
literal|8
index|]
argument_list|,
name|p_sr
operator|->
name|service_key
index|[
literal|9
index|]
argument_list|,
name|p_sr
operator|->
name|service_key
index|[
literal|10
index|]
argument_list|,
name|p_sr
operator|->
name|service_key
index|[
literal|11
index|]
argument_list|,
name|p_sr
operator|->
name|service_key
index|[
literal|12
index|]
argument_list|,
name|p_sr
operator|->
name|service_key
index|[
literal|13
index|]
argument_list|,
name|p_sr
operator|->
name|service_key
index|[
literal|14
index|]
argument_list|,
name|p_sr
operator|->
name|service_key
index|[
literal|15
index|]
argument_list|)
expr_stmt|;
name|strncpy
argument_list|(
name|buf_service_name
argument_list|,
operator|(
name|char
operator|*
operator|)
name|p_sr
operator|->
name|service_name
argument_list|,
literal|64
argument_list|)
expr_stmt|;
name|buf_service_name
index|[
literal|64
index|]
operator|=
literal|'\0'
expr_stmt|;
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"Service Record dump:\n"
literal|"\t\t\t\tServiceID...............0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tServiceGID..............%s\n"
literal|"\t\t\t\tServiceP_Key............0x%X\n"
literal|"\t\t\t\tServiceLease............0x%X\n"
literal|"\t\t\t\tServiceKey..............%s\n"
literal|"\t\t\t\tServiceName.............%s\n"
literal|"\t\t\t\tServiceData8.1..........0x%X\n"
literal|"\t\t\t\tServiceData8.2..........0x%X\n"
literal|"\t\t\t\tServiceData8.3..........0x%X\n"
literal|"\t\t\t\tServiceData8.4..........0x%X\n"
literal|"\t\t\t\tServiceData8.5..........0x%X\n"
literal|"\t\t\t\tServiceData8.6..........0x%X\n"
literal|"\t\t\t\tServiceData8.7..........0x%X\n"
literal|"\t\t\t\tServiceData8.8..........0x%X\n"
literal|"\t\t\t\tServiceData8.9..........0x%X\n"
literal|"\t\t\t\tServiceData8.10.........0x%X\n"
literal|"\t\t\t\tServiceData8.11.........0x%X\n"
literal|"\t\t\t\tServiceData8.12.........0x%X\n"
literal|"\t\t\t\tServiceData8.13.........0x%X\n"
literal|"\t\t\t\tServiceData8.14.........0x%X\n"
literal|"\t\t\t\tServiceData8.15.........0x%X\n"
literal|"\t\t\t\tServiceData8.16.........0x%X\n"
literal|"\t\t\t\tServiceData16.1.........0x%X\n"
literal|"\t\t\t\tServiceData16.2.........0x%X\n"
literal|"\t\t\t\tServiceData16.3.........0x%X\n"
literal|"\t\t\t\tServiceData16.4.........0x%X\n"
literal|"\t\t\t\tServiceData16.5.........0x%X\n"
literal|"\t\t\t\tServiceData16.6.........0x%X\n"
literal|"\t\t\t\tServiceData16.7.........0x%X\n"
literal|"\t\t\t\tServiceData16.8.........0x%X\n"
literal|"\t\t\t\tServiceData32.1.........0x%X\n"
literal|"\t\t\t\tServiceData32.2.........0x%X\n"
literal|"\t\t\t\tServiceData32.3.........0x%X\n"
literal|"\t\t\t\tServiceData32.4.........0x%X\n"
literal|"\t\t\t\tServiceData64.1.........0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tServiceData64.2.........0x%016"
name|PRIx64
literal|"\n"
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_sr
operator|->
name|service_id
argument_list|)
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_sr
operator|->
name|service_gid
operator|.
name|raw
argument_list|,
name|gid_str
argument_list|,
sizeof|sizeof
name|gid_str
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_sr
operator|->
name|service_pkey
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_sr
operator|->
name|service_lease
argument_list|)
argument_list|,
name|buf_service_key
argument_list|,
name|buf_service_name
argument_list|,
name|p_sr
operator|->
name|service_data8
index|[
literal|0
index|]
argument_list|,
name|p_sr
operator|->
name|service_data8
index|[
literal|1
index|]
argument_list|,
name|p_sr
operator|->
name|service_data8
index|[
literal|2
index|]
argument_list|,
name|p_sr
operator|->
name|service_data8
index|[
literal|3
index|]
argument_list|,
name|p_sr
operator|->
name|service_data8
index|[
literal|4
index|]
argument_list|,
name|p_sr
operator|->
name|service_data8
index|[
literal|5
index|]
argument_list|,
name|p_sr
operator|->
name|service_data8
index|[
literal|6
index|]
argument_list|,
name|p_sr
operator|->
name|service_data8
index|[
literal|7
index|]
argument_list|,
name|p_sr
operator|->
name|service_data8
index|[
literal|8
index|]
argument_list|,
name|p_sr
operator|->
name|service_data8
index|[
literal|9
index|]
argument_list|,
name|p_sr
operator|->
name|service_data8
index|[
literal|10
index|]
argument_list|,
name|p_sr
operator|->
name|service_data8
index|[
literal|11
index|]
argument_list|,
name|p_sr
operator|->
name|service_data8
index|[
literal|12
index|]
argument_list|,
name|p_sr
operator|->
name|service_data8
index|[
literal|13
index|]
argument_list|,
name|p_sr
operator|->
name|service_data8
index|[
literal|14
index|]
argument_list|,
name|p_sr
operator|->
name|service_data8
index|[
literal|15
index|]
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_sr
operator|->
name|service_data16
index|[
literal|0
index|]
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_sr
operator|->
name|service_data16
index|[
literal|1
index|]
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_sr
operator|->
name|service_data16
index|[
literal|2
index|]
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_sr
operator|->
name|service_data16
index|[
literal|3
index|]
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_sr
operator|->
name|service_data16
index|[
literal|4
index|]
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_sr
operator|->
name|service_data16
index|[
literal|5
index|]
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_sr
operator|->
name|service_data16
index|[
literal|6
index|]
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_sr
operator|->
name|service_data16
index|[
literal|7
index|]
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_sr
operator|->
name|service_data32
index|[
literal|0
index|]
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_sr
operator|->
name|service_data32
index|[
literal|1
index|]
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_sr
operator|->
name|service_data32
index|[
literal|2
index|]
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_sr
operator|->
name|service_data32
index|[
literal|3
index|]
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_sr
operator|->
name|service_data64
index|[
literal|0
index|]
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_sr
operator|->
name|service_data64
index|[
literal|1
index|]
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_service_record
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_service_record_t
modifier|*
name|p_sr
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_service_record_to_buf
argument_list|(
name|p_sr
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_service_record_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_service_record_t
modifier|*
name|p_sr
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_service_record_to_buf
argument_list|(
name|p_sr
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_inform_info_to_buf_generic
parameter_list|(
name|IN
specifier|const
name|ib_inform_info_t
modifier|*
name|p_ii
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_ii
condition|)
return|return;
else|else
block|{
name|uint32_t
name|qpn
decl_stmt|;
name|uint8_t
name|resp_time_val
decl_stmt|;
name|char
name|gid_str
index|[
name|INET6_ADDRSTRLEN
index|]
decl_stmt|;
name|ib_inform_info_get_qpn_resp_time
argument_list|(
name|p_ii
operator|->
name|g_or_v
operator|.
name|generic
operator|.
name|qpn_resp_time_val
argument_list|,
operator|&
name|qpn
argument_list|,
operator|&
name|resp_time_val
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"InformInfo dump:\n"
literal|"\t\t\t\tgid.....................%s\n"
literal|"\t\t\t\tlid_range_begin.........%u\n"
literal|"\t\t\t\tlid_range_end...........%u\n"
literal|"\t\t\t\tis_generic..............0x%X\n"
literal|"\t\t\t\tsubscribe...............0x%X\n"
literal|"\t\t\t\ttrap_type...............0x%X\n"
literal|"\t\t\t\ttrap_num................%u\n"
literal|"\t\t\t\tqpn.....................0x%06X\n"
literal|"\t\t\t\tresp_time_val...........0x%X\n"
literal|"\t\t\t\tnode_type...............0x%06X\n"
literal|""
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_ii
operator|->
name|gid
operator|.
name|raw
argument_list|,
name|gid_str
argument_list|,
sizeof|sizeof
name|gid_str
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ii
operator|->
name|lid_range_begin
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ii
operator|->
name|lid_range_end
argument_list|)
argument_list|,
name|p_ii
operator|->
name|is_generic
argument_list|,
name|p_ii
operator|->
name|subscribe
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ii
operator|->
name|trap_type
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ii
operator|->
name|g_or_v
operator|.
name|generic
operator|.
name|trap_num
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|qpn
argument_list|)
argument_list|,
name|resp_time_val
argument_list|,
name|cl_ntoh32
argument_list|(
name|ib_inform_info_get_prod_type
argument_list|(
name|p_ii
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_inform_info_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_inform_info_t
modifier|*
name|p_ii
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_ii
condition|)
return|return;
else|else
block|{
name|uint32_t
name|qpn
decl_stmt|;
name|uint8_t
name|resp_time_val
decl_stmt|;
name|char
name|gid_str
index|[
name|INET6_ADDRSTRLEN
index|]
decl_stmt|;
name|ib_inform_info_get_qpn_resp_time
argument_list|(
name|p_ii
operator|->
name|g_or_v
operator|.
name|generic
operator|.
name|qpn_resp_time_val
argument_list|,
operator|&
name|qpn
argument_list|,
operator|&
name|resp_time_val
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"InformInfo dump:\n"
literal|"\t\t\t\tgid.....................%s\n"
literal|"\t\t\t\tlid_range_begin.........%u\n"
literal|"\t\t\t\tlid_range_end...........%u\n"
literal|"\t\t\t\tis_generic..............0x%X\n"
literal|"\t\t\t\tsubscribe...............0x%X\n"
literal|"\t\t\t\ttrap_type...............0x%X\n"
literal|"\t\t\t\tdev_id..................0x%X\n"
literal|"\t\t\t\tqpn.....................0x%06X\n"
literal|"\t\t\t\tresp_time_val...........0x%X\n"
literal|"\t\t\t\tvendor_id...............0x%06X\n"
literal|""
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_ii
operator|->
name|gid
operator|.
name|raw
argument_list|,
name|gid_str
argument_list|,
sizeof|sizeof
name|gid_str
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ii
operator|->
name|lid_range_begin
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ii
operator|->
name|lid_range_end
argument_list|)
argument_list|,
name|p_ii
operator|->
name|is_generic
argument_list|,
name|p_ii
operator|->
name|subscribe
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ii
operator|->
name|trap_type
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ii
operator|->
name|g_or_v
operator|.
name|vend
operator|.
name|dev_id
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|qpn
argument_list|)
argument_list|,
name|resp_time_val
argument_list|,
name|cl_ntoh32
argument_list|(
name|ib_inform_info_get_prod_type
argument_list|(
name|p_ii
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_inform_info
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_inform_info_t
modifier|*
name|p_ii
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
if|if
condition|(
name|p_ii
operator|->
name|is_generic
condition|)
name|osm_dump_inform_info_to_buf_generic
argument_list|(
name|p_ii
argument_list|,
name|buf
argument_list|)
expr_stmt|;
else|else
name|osm_dump_inform_info_to_buf
argument_list|(
name|p_ii
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_inform_info_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_inform_info_t
modifier|*
name|p_ii
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
if|if
condition|(
name|p_ii
operator|->
name|is_generic
condition|)
name|osm_dump_inform_info_to_buf_generic
argument_list|(
name|p_ii
argument_list|,
name|buf
argument_list|)
expr_stmt|;
else|else
name|osm_dump_inform_info_to_buf
argument_list|(
name|p_ii
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_inform_info_record_to_buf_generic
parameter_list|(
name|IN
specifier|const
name|ib_inform_info_record_t
modifier|*
name|p_iir
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
name|p_iir
condition|)
return|return;
else|else
block|{
name|char
name|gid_str
index|[
name|INET6_ADDRSTRLEN
index|]
decl_stmt|;
name|char
name|gid_str2
index|[
name|INET6_ADDRSTRLEN
index|]
decl_stmt|;
name|uint32_t
name|qpn
decl_stmt|;
name|uint8_t
name|resp_time_val
decl_stmt|;
name|ib_inform_info_get_qpn_resp_time
argument_list|(
name|p_iir
operator|->
name|inform_info
operator|.
name|g_or_v
operator|.
name|generic
operator|.
name|qpn_resp_time_val
argument_list|,
operator|&
name|qpn
argument_list|,
operator|&
name|resp_time_val
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"InformInfo Record dump:\n"
literal|"\t\t\t\tRID\n"
literal|"\t\t\t\tSubscriberGID...........%s\n"
literal|"\t\t\t\tSubscriberEnum..........0x%X\n"
literal|"\t\t\t\tInformInfo dump:\n"
literal|"\t\t\t\tgid.....................%s\n"
literal|"\t\t\t\tlid_range_begin.........%u\n"
literal|"\t\t\t\tlid_range_end...........%u\n"
literal|"\t\t\t\tis_generic..............0x%X\n"
literal|"\t\t\t\tsubscribe...............0x%X\n"
literal|"\t\t\t\ttrap_type...............0x%X\n"
literal|"\t\t\t\ttrap_num................%u\n"
literal|"\t\t\t\tqpn.....................0x%06X\n"
literal|"\t\t\t\tresp_time_val...........0x%X\n"
literal|"\t\t\t\tnode_type...............0x%06X\n"
literal|""
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_iir
operator|->
name|subscriber_gid
operator|.
name|raw
argument_list|,
name|gid_str
argument_list|,
sizeof|sizeof
name|gid_str
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_iir
operator|->
name|subscriber_enum
argument_list|)
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_iir
operator|->
name|inform_info
operator|.
name|gid
operator|.
name|raw
argument_list|,
name|gid_str2
argument_list|,
sizeof|sizeof
name|gid_str2
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_iir
operator|->
name|inform_info
operator|.
name|lid_range_begin
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_iir
operator|->
name|inform_info
operator|.
name|lid_range_end
argument_list|)
argument_list|,
name|p_iir
operator|->
name|inform_info
operator|.
name|is_generic
argument_list|,
name|p_iir
operator|->
name|inform_info
operator|.
name|subscribe
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_iir
operator|->
name|inform_info
operator|.
name|trap_type
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_iir
operator|->
name|inform_info
operator|.
name|g_or_v
operator|.
name|generic
operator|.
name|trap_num
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|qpn
argument_list|)
argument_list|,
name|resp_time_val
argument_list|,
name|cl_ntoh32
argument_list|(
name|ib_inform_info_get_prod_type
argument_list|(
operator|&
name|p_iir
operator|->
name|inform_info
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_inform_info_record_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_inform_info_record_t
modifier|*
name|p_iir
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
name|p_iir
condition|)
return|return;
else|else
block|{
name|char
name|gid_str
index|[
name|INET6_ADDRSTRLEN
index|]
decl_stmt|;
name|char
name|gid_str2
index|[
name|INET6_ADDRSTRLEN
index|]
decl_stmt|;
name|uint32_t
name|qpn
decl_stmt|;
name|uint8_t
name|resp_time_val
decl_stmt|;
name|ib_inform_info_get_qpn_resp_time
argument_list|(
name|p_iir
operator|->
name|inform_info
operator|.
name|g_or_v
operator|.
name|generic
operator|.
name|qpn_resp_time_val
argument_list|,
operator|&
name|qpn
argument_list|,
operator|&
name|resp_time_val
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"InformInfo Record dump:\n"
literal|"\t\t\t\tRID\n"
literal|"\t\t\t\tSubscriberGID...........%s\n"
literal|"\t\t\t\tSubscriberEnum..........0x%X\n"
literal|"\t\t\t\tInformInfo dump:\n"
literal|"\t\t\t\tgid.....................%s\n"
literal|"\t\t\t\tlid_range_begin.........%u\n"
literal|"\t\t\t\tlid_range_end...........%u\n"
literal|"\t\t\t\tis_generic..............0x%X\n"
literal|"\t\t\t\tsubscribe...............0x%X\n"
literal|"\t\t\t\ttrap_type...............0x%X\n"
literal|"\t\t\t\tdev_id..................0x%X\n"
literal|"\t\t\t\tqpn.....................0x%06X\n"
literal|"\t\t\t\tresp_time_val...........0x%X\n"
literal|"\t\t\t\tvendor_id...............0x%06X\n"
literal|""
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_iir
operator|->
name|subscriber_gid
operator|.
name|raw
argument_list|,
name|gid_str
argument_list|,
sizeof|sizeof
name|gid_str
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_iir
operator|->
name|subscriber_enum
argument_list|)
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_iir
operator|->
name|inform_info
operator|.
name|gid
operator|.
name|raw
argument_list|,
name|gid_str2
argument_list|,
sizeof|sizeof
name|gid_str2
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_iir
operator|->
name|inform_info
operator|.
name|lid_range_begin
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_iir
operator|->
name|inform_info
operator|.
name|lid_range_end
argument_list|)
argument_list|,
name|p_iir
operator|->
name|inform_info
operator|.
name|is_generic
argument_list|,
name|p_iir
operator|->
name|inform_info
operator|.
name|subscribe
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_iir
operator|->
name|inform_info
operator|.
name|trap_type
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_iir
operator|->
name|inform_info
operator|.
name|g_or_v
operator|.
name|vend
operator|.
name|dev_id
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|qpn
argument_list|)
argument_list|,
name|resp_time_val
argument_list|,
name|cl_ntoh32
argument_list|(
name|ib_inform_info_get_prod_type
argument_list|(
operator|&
name|p_iir
operator|->
name|inform_info
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_inform_info_record
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_inform_info_record_t
modifier|*
name|p_iir
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
if|if
condition|(
name|p_iir
operator|->
name|inform_info
operator|.
name|is_generic
condition|)
name|osm_dump_inform_info_record_to_buf_generic
argument_list|(
name|p_iir
argument_list|,
name|buf
argument_list|)
expr_stmt|;
else|else
name|osm_dump_inform_info_record_to_buf
argument_list|(
name|p_iir
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_inform_info_record_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_inform_info_record_t
modifier|*
name|p_iir
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
if|if
condition|(
name|p_iir
operator|->
name|inform_info
operator|.
name|is_generic
condition|)
name|osm_dump_inform_info_record_to_buf_generic
argument_list|(
name|p_iir
argument_list|,
name|buf
argument_list|)
expr_stmt|;
else|else
name|osm_dump_inform_info_record_to_buf
argument_list|(
name|p_iir
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_link_record_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_link_record_t
modifier|*
name|p_lr
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_lr
condition|)
return|return;
else|else
block|{
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"Link Record dump:\n"
literal|"\t\t\t\tfrom_lid................%u\n"
literal|"\t\t\t\tfrom_port_num...........%u\n"
literal|"\t\t\t\tto_port_num.............%u\n"
literal|"\t\t\t\tto_lid..................%u\n"
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_lr
operator|->
name|from_lid
argument_list|)
argument_list|,
name|p_lr
operator|->
name|from_port_num
argument_list|,
name|p_lr
operator|->
name|to_port_num
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_lr
operator|->
name|to_lid
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_link_record
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_link_record_t
modifier|*
name|p_lr
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_link_record_to_buf
argument_list|(
name|p_lr
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_link_record_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_link_record_t
modifier|*
name|p_lr
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_link_record_to_buf
argument_list|(
name|p_lr
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_switch_info_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_switch_info_t
modifier|*
name|p_si
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_si
condition|)
return|return;
else|else
block|{
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"SwitchInfo dump:\n"
literal|"\t\t\t\tlin_cap.................0x%X\n"
literal|"\t\t\t\trand_cap................0x%X\n"
literal|"\t\t\t\tmcast_cap...............0x%X\n"
literal|"\t\t\t\tlin_top.................0x%X\n"
literal|"\t\t\t\tdef_port................%u\n"
literal|"\t\t\t\tdef_mcast_pri_port......%u\n"
literal|"\t\t\t\tdef_mcast_not_port......%u\n"
literal|"\t\t\t\tlife_state..............0x%X\n"
literal|"\t\t\t\tlids_per_port...........%u\n"
literal|"\t\t\t\tpartition_enf_cap.......0x%X\n"
literal|"\t\t\t\tflags...................0x%X\n"
literal|"\t\t\t\tmcast_top...............0x%X\n"
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_si
operator|->
name|lin_cap
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_si
operator|->
name|rand_cap
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_si
operator|->
name|mcast_cap
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_si
operator|->
name|lin_top
argument_list|)
argument_list|,
name|p_si
operator|->
name|def_port
argument_list|,
name|p_si
operator|->
name|def_mcast_pri_port
argument_list|,
name|p_si
operator|->
name|def_mcast_not_port
argument_list|,
name|p_si
operator|->
name|life_state
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_si
operator|->
name|lids_per_port
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_si
operator|->
name|enforce_cap
argument_list|)
argument_list|,
name|p_si
operator|->
name|flags
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_si
operator|->
name|mcast_top
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_switch_info
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_switch_info_t
modifier|*
name|p_si
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_switch_info_to_buf
argument_list|(
name|p_si
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|OSM_LOG_VERBOSE
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_switch_info_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_switch_info_t
modifier|*
name|p_si
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_switch_info_to_buf
argument_list|(
name|p_si
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|OSM_LOG_VERBOSE
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_switch_info_record_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_switch_info_record_t
modifier|*
name|p_sir
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_sir
condition|)
return|return;
else|else
block|{
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"SwitchInfo Record dump:\n"
literal|"\t\t\t\tRID\n"
literal|"\t\t\t\tlid.....................%u\n"
literal|"\t\t\t\tSwitchInfo dump:\n"
literal|"\t\t\t\tlin_cap.................0x%X\n"
literal|"\t\t\t\trand_cap................0x%X\n"
literal|"\t\t\t\tmcast_cap...............0x%X\n"
literal|"\t\t\t\tlin_top.................0x%X\n"
literal|"\t\t\t\tdef_port................%u\n"
literal|"\t\t\t\tdef_mcast_pri_port......%u\n"
literal|"\t\t\t\tdef_mcast_not_port......%u\n"
literal|"\t\t\t\tlife_state..............0x%X\n"
literal|"\t\t\t\tlids_per_port...........%u\n"
literal|"\t\t\t\tpartition_enf_cap.......0x%X\n"
literal|"\t\t\t\tflags...................0x%X\n"
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_sir
operator|->
name|lid
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_sir
operator|->
name|switch_info
operator|.
name|lin_cap
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_sir
operator|->
name|switch_info
operator|.
name|rand_cap
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_sir
operator|->
name|switch_info
operator|.
name|mcast_cap
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_sir
operator|->
name|switch_info
operator|.
name|lin_top
argument_list|)
argument_list|,
name|p_sir
operator|->
name|switch_info
operator|.
name|def_port
argument_list|,
name|p_sir
operator|->
name|switch_info
operator|.
name|def_mcast_pri_port
argument_list|,
name|p_sir
operator|->
name|switch_info
operator|.
name|def_mcast_not_port
argument_list|,
name|p_sir
operator|->
name|switch_info
operator|.
name|life_state
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_sir
operator|->
name|switch_info
operator|.
name|lids_per_port
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_sir
operator|->
name|switch_info
operator|.
name|enforce_cap
argument_list|)
argument_list|,
name|p_sir
operator|->
name|switch_info
operator|.
name|flags
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_switch_info_record
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_switch_info_record_t
modifier|*
name|p_sir
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_switch_info_record_to_buf
argument_list|(
name|p_sir
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_switch_info_record_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_switch_info_record_t
modifier|*
name|p_sir
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_switch_info_record_to_buf
argument_list|(
name|p_sir
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_pkey_block_to_buf
parameter_list|(
name|IN
name|uint64_t
name|port_guid
parameter_list|,
name|IN
name|uint16_t
name|block_num
parameter_list|,
name|IN
name|uint8_t
name|port_num
parameter_list|,
name|IN
specifier|const
name|ib_pkey_table_t
modifier|*
name|p_pkey_tbl
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_pkey_tbl
condition|)
return|return;
else|else
block|{
name|char
name|buf_line
index|[
literal|1024
index|]
decl_stmt|;
name|int
name|i
decl_stmt|,
name|n
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|n
operator|=
literal|0
init|;
name|i
operator|<
literal|32
condition|;
name|i
operator|++
control|)
name|n
operator|+=
name|sprintf
argument_list|(
name|buf_line
operator|+
name|n
argument_list|,
literal|" 0x%04x |"
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_pkey_tbl
operator|->
name|pkey_entry
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"P_Key table dump:\n"
literal|"\t\t\tport_guid...........0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\tblock_num...........0x%X\n"
literal|"\t\t\tport_num............%u\n\tP_Key Table: %s\n"
argument_list|,
name|cl_ntoh64
argument_list|(
name|port_guid
argument_list|)
argument_list|,
name|block_num
argument_list|,
name|port_num
argument_list|,
name|buf_line
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_pkey_block
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
name|uint64_t
name|port_guid
parameter_list|,
name|IN
name|uint16_t
name|block_num
parameter_list|,
name|IN
name|uint8_t
name|port_num
parameter_list|,
name|IN
specifier|const
name|ib_pkey_table_t
modifier|*
name|p_pkey_tbl
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_pkey_block_to_buf
argument_list|(
name|port_guid
argument_list|,
name|block_num
argument_list|,
name|port_num
argument_list|,
name|p_pkey_tbl
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_pkey_block_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
name|uint64_t
name|port_guid
parameter_list|,
name|IN
name|uint16_t
name|block_num
parameter_list|,
name|IN
name|uint8_t
name|port_num
parameter_list|,
name|IN
specifier|const
name|ib_pkey_table_t
modifier|*
name|p_pkey_tbl
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_pkey_block_to_buf
argument_list|(
name|port_guid
argument_list|,
name|block_num
argument_list|,
name|port_num
argument_list|,
name|p_pkey_tbl
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_slvl_map_table_to_buf
parameter_list|(
name|IN
name|uint64_t
name|port_guid
parameter_list|,
name|IN
name|uint8_t
name|in_port_num
parameter_list|,
name|IN
name|uint8_t
name|out_port_num
parameter_list|,
name|IN
specifier|const
name|ib_slvl_table_t
modifier|*
name|p_slvl_tbl
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_slvl_tbl
condition|)
return|return;
else|else
block|{
name|char
name|buf_line1
index|[
literal|1024
index|]
decl_stmt|,
name|buf_line2
index|[
literal|1024
index|]
decl_stmt|;
name|int
name|n
decl_stmt|;
name|uint8_t
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|n
operator|=
literal|0
init|;
name|i
operator|<
literal|16
condition|;
name|i
operator|++
control|)
name|n
operator|+=
name|sprintf
argument_list|(
name|buf_line1
operator|+
name|n
argument_list|,
literal|" %-2u |"
argument_list|,
name|i
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|n
operator|=
literal|0
init|;
name|i
operator|<
literal|16
condition|;
name|i
operator|++
control|)
name|n
operator|+=
name|sprintf
argument_list|(
name|buf_line2
operator|+
name|n
argument_list|,
literal|"0x%01X |"
argument_list|,
name|ib_slvl_table_get
argument_list|(
name|p_slvl_tbl
argument_list|,
name|i
argument_list|)
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"SLtoVL dump:\n"
literal|"\t\t\tport_guid............0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\tin_port_num..........%u\n"
literal|"\t\t\tout_port_num.........%u\n\tSL: | %s\n\tVL: | %s\n"
argument_list|,
name|cl_ntoh64
argument_list|(
name|port_guid
argument_list|)
argument_list|,
name|in_port_num
argument_list|,
name|out_port_num
argument_list|,
name|buf_line1
argument_list|,
name|buf_line2
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_slvl_map_table
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
name|uint64_t
name|port_guid
parameter_list|,
name|IN
name|uint8_t
name|in_port_num
parameter_list|,
name|IN
name|uint8_t
name|out_port_num
parameter_list|,
name|IN
specifier|const
name|ib_slvl_table_t
modifier|*
name|p_slvl_tbl
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_slvl_map_table_to_buf
argument_list|(
name|port_guid
argument_list|,
name|in_port_num
argument_list|,
name|out_port_num
argument_list|,
name|p_slvl_tbl
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_slvl_map_table_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
name|uint64_t
name|port_guid
parameter_list|,
name|IN
name|uint8_t
name|in_port_num
parameter_list|,
name|IN
name|uint8_t
name|out_port_num
parameter_list|,
name|IN
specifier|const
name|ib_slvl_table_t
modifier|*
name|p_slvl_tbl
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_slvl_map_table_to_buf
argument_list|(
name|port_guid
argument_list|,
name|in_port_num
argument_list|,
name|out_port_num
argument_list|,
name|p_slvl_tbl
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_vl_arb_table_to_buf
parameter_list|(
name|IN
name|uint64_t
name|port_guid
parameter_list|,
name|IN
name|uint8_t
name|block_num
parameter_list|,
name|IN
name|uint8_t
name|port_num
parameter_list|,
name|IN
specifier|const
name|ib_vl_arb_table_t
modifier|*
name|p_vla_tbl
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_vla_tbl
condition|)
return|return;
else|else
block|{
name|char
name|buf_line1
index|[
literal|1024
index|]
decl_stmt|,
name|buf_line2
index|[
literal|1024
index|]
decl_stmt|;
name|int
name|i
decl_stmt|,
name|n
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|n
operator|=
literal|0
init|;
name|i
operator|<
literal|32
condition|;
name|i
operator|++
control|)
name|n
operator|+=
name|sprintf
argument_list|(
name|buf_line1
operator|+
name|n
argument_list|,
literal|" 0x%01X |"
argument_list|,
name|p_vla_tbl
operator|->
name|vl_entry
index|[
name|i
index|]
operator|.
name|vl
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|n
operator|=
literal|0
init|;
name|i
operator|<
literal|32
condition|;
name|i
operator|++
control|)
name|n
operator|+=
name|sprintf
argument_list|(
name|buf_line2
operator|+
name|n
argument_list|,
literal|" 0x%01X |"
argument_list|,
name|p_vla_tbl
operator|->
name|vl_entry
index|[
name|i
index|]
operator|.
name|weight
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"VLArb dump:\n"
literal|"\t\t\tport_guid...........0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\tblock_num...........0x%X\n"
literal|"\t\t\tport_num............%u\n\tVL    : | %s\n\tWEIGHT:| %s\n"
argument_list|,
name|cl_ntoh64
argument_list|(
name|port_guid
argument_list|)
argument_list|,
name|block_num
argument_list|,
name|port_num
argument_list|,
name|buf_line1
argument_list|,
name|buf_line2
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_vl_arb_table
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
name|uint64_t
name|port_guid
parameter_list|,
name|IN
name|uint8_t
name|block_num
parameter_list|,
name|IN
name|uint8_t
name|port_num
parameter_list|,
name|IN
specifier|const
name|ib_vl_arb_table_t
modifier|*
name|p_vla_tbl
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_vl_arb_table_to_buf
argument_list|(
name|port_guid
argument_list|,
name|block_num
argument_list|,
name|port_num
argument_list|,
name|p_vla_tbl
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_vl_arb_table_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
name|uint64_t
name|port_guid
parameter_list|,
name|IN
name|uint8_t
name|block_num
parameter_list|,
name|IN
name|uint8_t
name|port_num
parameter_list|,
name|IN
specifier|const
name|ib_vl_arb_table_t
modifier|*
name|p_vla_tbl
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_vl_arb_table_to_buf
argument_list|(
name|port_guid
argument_list|,
name|block_num
argument_list|,
name|port_num
argument_list|,
name|p_vla_tbl
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_sm_info_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_sm_info_t
modifier|*
name|p_smi
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_smi
condition|)
return|return;
else|else
block|{
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"SMInfo dump:\n"
literal|"\t\t\t\tguid....................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tsm_key..................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tact_count...............%u\n"
literal|"\t\t\t\tpriority................%u\n"
literal|"\t\t\t\tsm_state................%u\n"
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_smi
operator|->
name|guid
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_smi
operator|->
name|sm_key
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_smi
operator|->
name|act_count
argument_list|)
argument_list|,
name|ib_sminfo_get_priority
argument_list|(
name|p_smi
argument_list|)
argument_list|,
name|ib_sminfo_get_state
argument_list|(
name|p_smi
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_sm_info
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_sm_info_t
modifier|*
name|p_smi
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_sm_info_to_buf
argument_list|(
name|p_smi
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|OSM_LOG_DEBUG
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_sm_info_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_sm_info_t
modifier|*
name|p_smi
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_sm_info_to_buf
argument_list|(
name|p_smi
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|OSM_LOG_DEBUG
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_sm_info_record_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_sminfo_record_t
modifier|*
name|p_smir
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_smir
condition|)
return|return;
else|else
block|{
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"SMInfo Record dump:\n"
literal|"\t\t\t\tRID\n"
literal|"\t\t\t\tLid.....................%u\n"
literal|"\t\t\t\tReserved................0x%X\n"
literal|"\t\t\t\tSMInfo dump:\n"
literal|"\t\t\t\tguid....................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tsm_key..................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tact_count...............%u\n"
literal|"\t\t\t\tpriority................%u\n"
literal|"\t\t\t\tsm_state................%u\n"
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_smir
operator|->
name|lid
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_smir
operator|->
name|resv0
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_smir
operator|->
name|sm_info
operator|.
name|guid
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_smir
operator|->
name|sm_info
operator|.
name|sm_key
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_smir
operator|->
name|sm_info
operator|.
name|act_count
argument_list|)
argument_list|,
name|ib_sminfo_get_priority
argument_list|(
operator|&
name|p_smir
operator|->
name|sm_info
argument_list|)
argument_list|,
name|ib_sminfo_get_state
argument_list|(
operator|&
name|p_smir
operator|->
name|sm_info
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_sm_info_record
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_sminfo_record_t
modifier|*
name|p_smir
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_sm_info_record_to_buf
argument_list|(
name|p_smir
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|OSM_LOG_DEBUG
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_sm_info_record_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_sminfo_record_t
modifier|*
name|p_smir
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_sm_info_record_to_buf
argument_list|(
name|p_smir
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|OSM_LOG_DEBUG
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_notice_to_buf_generic
parameter_list|(
name|IN
specifier|const
name|ib_mad_notice_attr_t
modifier|*
name|p_ntci
parameter_list|,
name|OUT
name|char
modifier|*
name|log_buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|log_buf
operator|||
operator|!
name|p_ntci
condition|)
return|return;
else|else
block|{
name|char
name|gid_str
index|[
name|INET6_ADDRSTRLEN
index|]
decl_stmt|;
name|char
name|gid_str2
index|[
name|INET6_ADDRSTRLEN
index|]
decl_stmt|;
name|char
name|buff
index|[
literal|1024
index|]
decl_stmt|;
name|int
name|n
decl_stmt|;
name|buff
index|[
literal|0
index|]
operator|=
literal|'\0'
expr_stmt|;
comment|/* immediate data based on the trap */
switch|switch
condition|(
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|g_or_v
operator|.
name|generic
operator|.
name|trap_num
argument_list|)
condition|)
block|{
case|case
name|SM_GID_IN_SERVICE_TRAP
case|:
comment|/* 64 */
case|case
name|SM_GID_OUT_OF_SERVICE_TRAP
case|:
comment|/* 65 */
case|case
name|SM_MGID_CREATED_TRAP
case|:
comment|/* 66 */
case|case
name|SM_MGID_DESTROYED_TRAP
case|:
comment|/* 67 */
name|sprintf
argument_list|(
name|buff
argument_list|,
literal|"\t\t\t\tsrc_gid..................%s\n"
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_64_67
operator|.
name|gid
operator|.
name|raw
argument_list|,
name|gid_str
argument_list|,
sizeof|sizeof
name|gid_str
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|SM_LINK_STATE_CHANGED_TRAP
case|:
comment|/* 128 */
name|sprintf
argument_list|(
name|buff
argument_list|,
literal|"\t\t\t\tsw_lid...................%u\n"
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_128
operator|.
name|sw_lid
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|SM_LINK_INTEGRITY_THRESHOLD_TRAP
case|:
comment|/* 129 */
case|case
name|SM_BUFFER_OVERRUN_THRESHOLD_TRAP
case|:
comment|/* 130 */
case|case
name|SM_WATCHDOG_TIMER_EXPIRED_TRAP
case|:
comment|/* 131 */
name|sprintf
argument_list|(
name|buff
argument_list|,
literal|"\t\t\t\tlid......................%u\n"
literal|"\t\t\t\tport_num.................%u\n"
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_129_131
operator|.
name|lid
argument_list|)
argument_list|,
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_129_131
operator|.
name|port_num
argument_list|)
expr_stmt|;
break|break;
case|case
name|SM_LOCAL_CHANGES_TRAP
case|:
comment|/* 144 */
name|sprintf
argument_list|(
name|buff
argument_list|,
literal|"\t\t\t\tlid......................%u\n"
literal|"\t\t\t\tlocal_changes............%u\n"
literal|"\t\t\t\tnew_cap_mask.............0x%08x\n"
literal|"\t\t\t\tchange_flags.............0x%x\n"
literal|"\t\t\t\tcap_mask2................0x%x\n"
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_144
operator|.
name|lid
argument_list|)
argument_list|,
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_144
operator|.
name|local_changes
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_144
operator|.
name|new_cap_mask
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_144
operator|.
name|change_flgs
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_144
operator|.
name|cap_mask2
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|SM_SYS_IMG_GUID_CHANGED_TRAP
case|:
comment|/* 145 */
name|sprintf
argument_list|(
name|buff
argument_list|,
literal|"\t\t\t\tlid......................%u\n"
literal|"\t\t\t\tnew_sys_guid.............0x%016"
name|PRIx64
literal|"\n"
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_145
operator|.
name|lid
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_145
operator|.
name|new_sys_guid
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|SM_BAD_MKEY_TRAP
case|:
comment|/* 256 */
name|n
operator|=
name|sprintf
argument_list|(
name|buff
argument_list|,
literal|"\t\t\t\tlid......................%u\n"
literal|"\t\t\t\tdrslid...................%u\n"
literal|"\t\t\t\tmethod...................0x%x\n"
literal|"\t\t\t\tattr_id..................0x%x\n"
literal|"\t\t\t\tattr_mod.................0x%x\n"
literal|"\t\t\t\tm_key....................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tdr_notice................%d\n"
literal|"\t\t\t\tdr_path_truncated........%d\n"
literal|"\t\t\t\tdr_hop_count.............%u\n"
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_256
operator|.
name|lid
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_256
operator|.
name|dr_slid
argument_list|)
argument_list|,
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_256
operator|.
name|method
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_256
operator|.
name|attr_id
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_256
operator|.
name|attr_mod
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_256
operator|.
name|mkey
argument_list|)
argument_list|,
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_256
operator|.
name|dr_trunc_hop
operator|>>
literal|7
argument_list|,
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_256
operator|.
name|dr_trunc_hop
operator|>>
literal|6
argument_list|,
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_256
operator|.
name|dr_trunc_hop
operator|&
literal|0x3f
argument_list|)
expr_stmt|;
name|n
operator|+=
name|snprintf
argument_list|(
name|buff
operator|+
name|n
argument_list|,
sizeof|sizeof
argument_list|(
name|buff
argument_list|)
operator|-
name|n
argument_list|,
literal|"Directed Path Dump of %u hop path:"
literal|"\n\t\t\t\tPath = "
argument_list|,
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_256
operator|.
name|dr_trunc_hop
operator|&
literal|0x3f
argument_list|)
expr_stmt|;
name|n
operator|+=
name|sprint_uint8_arr
argument_list|(
name|buff
operator|+
name|n
argument_list|,
sizeof|sizeof
argument_list|(
name|buff
argument_list|)
operator|-
name|n
argument_list|,
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_256
operator|.
name|dr_rtn_path
argument_list|,
operator|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_256
operator|.
name|dr_trunc_hop
operator|&
literal|0x3f
operator|)
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|n
operator|>=
sizeof|sizeof
argument_list|(
name|buff
argument_list|)
condition|)
block|{
name|n
operator|=
sizeof|sizeof
argument_list|(
name|buff
argument_list|)
operator|-
literal|2
expr_stmt|;
break|break;
block|}
name|snprintf
argument_list|(
name|buff
operator|+
name|n
argument_list|,
sizeof|sizeof
argument_list|(
name|buff
argument_list|)
operator|-
name|n
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|SM_BAD_PKEY_TRAP
case|:
comment|/* 257 */
case|case
name|SM_BAD_QKEY_TRAP
case|:
comment|/* 258 */
name|sprintf
argument_list|(
name|buff
argument_list|,
literal|"\t\t\t\tlid1.....................%u\n"
literal|"\t\t\t\tlid2.....................%u\n"
literal|"\t\t\t\tkey......................0x%x\n"
literal|"\t\t\t\tsl.......................%d\n"
literal|"\t\t\t\tqp1......................0x%x\n"
literal|"\t\t\t\tqp2......................0x%x\n"
literal|"\t\t\t\tgid1.....................%s\n"
literal|"\t\t\t\tgid2.....................%s\n"
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_257_258
operator|.
name|lid1
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_257_258
operator|.
name|lid2
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_257_258
operator|.
name|key
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_257_258
operator|.
name|qp1
argument_list|)
operator|>>
literal|28
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_257_258
operator|.
name|qp1
argument_list|)
operator|&
literal|0xffffff
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_257_258
operator|.
name|qp2
argument_list|)
operator|&
literal|0xffffff
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_257_258
operator|.
name|gid1
operator|.
name|raw
argument_list|,
name|gid_str
argument_list|,
sizeof|sizeof
name|gid_str
argument_list|)
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_257_258
operator|.
name|gid2
operator|.
name|raw
argument_list|,
name|gid_str2
argument_list|,
sizeof|sizeof
name|gid_str2
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|SM_BAD_SWITCH_PKEY_TRAP
case|:
comment|/* 259 */
name|sprintf
argument_list|(
name|buff
argument_list|,
literal|"\t\t\t\tdata_valid...............0x%x\n"
literal|"\t\t\t\tlid1.....................%u\n"
literal|"\t\t\t\tlid2.....................%u\n"
literal|"\t\t\t\tpkey.....................0x%x\n"
literal|"\t\t\t\tsl.......................%d\n"
literal|"\t\t\t\tqp1......................0x%x\n"
literal|"\t\t\t\tqp2......................0x%x\n"
literal|"\t\t\t\tgid1.....................%s\n"
literal|"\t\t\t\tgid2.....................%s\n"
literal|"\t\t\t\tsw_lid...................%u\n"
literal|"\t\t\t\tport_no..................%u\n"
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_259
operator|.
name|data_valid
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_259
operator|.
name|lid1
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_259
operator|.
name|lid2
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_259
operator|.
name|pkey
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_259
operator|.
name|sl_qp1
argument_list|)
operator|>>
literal|24
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_259
operator|.
name|sl_qp1
argument_list|)
operator|&
literal|0xffffff
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_259
operator|.
name|qp2
argument_list|)
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_259
operator|.
name|gid1
operator|.
name|raw
argument_list|,
name|gid_str
argument_list|,
sizeof|sizeof
name|gid_str
argument_list|)
argument_list|,
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_259
operator|.
name|gid2
operator|.
name|raw
argument_list|,
name|gid_str2
argument_list|,
sizeof|sizeof
name|gid_str2
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_259
operator|.
name|sw_lid
argument_list|)
argument_list|,
name|p_ntci
operator|->
name|data_details
operator|.
name|ntc_259
operator|.
name|port_no
argument_list|)
expr_stmt|;
break|break;
block|}
name|sprintf
argument_list|(
name|log_buf
argument_list|,
literal|"Generic Notice dump:\n"
literal|"\t\t\t\ttype.....................%u\n"
literal|"\t\t\t\tprod_type................%u (%s)\n"
literal|"\t\t\t\ttrap_num.................%u\n%s"
argument_list|,
name|ib_notice_get_type
argument_list|(
name|p_ntci
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|ib_notice_get_prod_type
argument_list|(
name|p_ntci
argument_list|)
argument_list|)
argument_list|,
name|ib_get_producer_type_str
argument_list|(
name|ib_notice_get_prod_type
argument_list|(
name|p_ntci
argument_list|)
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|g_or_v
operator|.
name|generic
operator|.
name|trap_num
argument_list|)
argument_list|,
name|buff
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_notice_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_mad_notice_attr_t
modifier|*
name|p_ntci
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_ntci
condition|)
return|return;
else|else
block|{
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"Vendor Notice dump:\n"
literal|"\t\t\t\ttype.....................%u\n"
literal|"\t\t\t\tvendor...................%u\n"
literal|"\t\t\t\tdevice_id................%u\n"
argument_list|,
name|cl_ntoh16
argument_list|(
name|ib_notice_get_type
argument_list|(
name|p_ntci
argument_list|)
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|ib_notice_get_vend_id
argument_list|(
name|p_ntci
argument_list|)
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_ntci
operator|->
name|g_or_v
operator|.
name|vend
operator|.
name|dev_id
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_notice
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_mad_notice_attr_t
modifier|*
name|p_ntci
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
if|if
condition|(
name|ib_notice_is_generic
argument_list|(
name|p_ntci
argument_list|)
condition|)
name|osm_dump_notice_to_buf_generic
argument_list|(
name|p_ntci
argument_list|,
name|buf
argument_list|)
expr_stmt|;
else|else
name|osm_dump_notice_to_buf
argument_list|(
name|p_ntci
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_notice_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_mad_notice_attr_t
modifier|*
name|p_ntci
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
if|if
condition|(
name|ib_notice_is_generic
argument_list|(
name|p_ntci
argument_list|)
condition|)
name|osm_dump_notice_to_buf_generic
argument_list|(
name|p_ntci
argument_list|,
name|buf
argument_list|)
expr_stmt|;
else|else
name|osm_dump_notice_to_buf
argument_list|(
name|p_ntci
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_dr_smp_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_smp_t
modifier|*
name|p_smp
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|,
name|IN
name|size_t
name|buf_size
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_smp
condition|)
return|return;
else|else
block|{
name|unsigned
name|n
decl_stmt|;
name|n
operator|=
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"SMP dump:\n"
literal|"\t\t\t\tbase_ver................0x%X\n"
literal|"\t\t\t\tmgmt_class..............0x%X\n"
literal|"\t\t\t\tclass_ver...............0x%X\n"
literal|"\t\t\t\tmethod..................0x%X (%s)\n"
argument_list|,
name|p_smp
operator|->
name|base_ver
argument_list|,
name|p_smp
operator|->
name|mgmt_class
argument_list|,
name|p_smp
operator|->
name|class_ver
argument_list|,
name|p_smp
operator|->
name|method
argument_list|,
name|ib_get_sm_method_str
argument_list|(
name|p_smp
operator|->
name|method
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_smp
operator|->
name|mgmt_class
operator|==
name|IB_MCLASS_SUBN_DIR
condition|)
block|{
name|n
operator|+=
name|snprintf
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|buf_size
operator|-
name|n
argument_list|,
literal|"\t\t\t\tD bit...................0x%X\n"
literal|"\t\t\t\tstatus..................0x%X\n"
argument_list|,
name|ib_smp_is_d
argument_list|(
name|p_smp
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|ib_smp_get_status
argument_list|(
name|p_smp
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|n
operator|+=
name|snprintf
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|buf_size
operator|-
name|n
argument_list|,
literal|"\t\t\t\tstatus..................0x%X\n"
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_smp
operator|->
name|status
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|n
operator|+=
name|snprintf
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|buf_size
operator|-
name|n
argument_list|,
literal|"\t\t\t\thop_ptr.................0x%X\n"
literal|"\t\t\t\thop_count...............0x%X\n"
literal|"\t\t\t\ttrans_id................0x%"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tattr_id.................0x%X (%s)\n"
literal|"\t\t\t\tresv....................0x%X\n"
literal|"\t\t\t\tattr_mod................0x%X\n"
literal|"\t\t\t\tm_key...................0x%016"
name|PRIx64
literal|"\n"
argument_list|,
name|p_smp
operator|->
name|hop_ptr
argument_list|,
name|p_smp
operator|->
name|hop_count
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_smp
operator|->
name|trans_id
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_smp
operator|->
name|attr_id
argument_list|)
argument_list|,
name|ib_get_sm_attr_str
argument_list|(
name|p_smp
operator|->
name|attr_id
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_smp
operator|->
name|resv
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_smp
operator|->
name|attr_mod
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_smp
operator|->
name|m_key
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|p_smp
operator|->
name|mgmt_class
operator|==
name|IB_MCLASS_SUBN_DIR
condition|)
block|{
name|uint32_t
name|i
decl_stmt|;
name|n
operator|+=
name|snprintf
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|buf_size
operator|-
name|n
argument_list|,
literal|"\t\t\t\tdr_slid.................%u\n"
literal|"\t\t\t\tdr_dlid.................%u\n"
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_smp
operator|->
name|dr_slid
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_smp
operator|->
name|dr_dlid
argument_list|)
argument_list|)
expr_stmt|;
name|n
operator|+=
name|snprintf
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|buf_size
operator|-
name|n
argument_list|,
literal|"\n\t\t\t\tInitial path: "
argument_list|)
expr_stmt|;
name|n
operator|+=
name|sprint_uint8_arr
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|buf_size
operator|-
name|n
argument_list|,
name|p_smp
operator|->
name|initial_path
argument_list|,
name|p_smp
operator|->
name|hop_count
operator|+
literal|1
argument_list|)
expr_stmt|;
name|n
operator|+=
name|snprintf
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|buf_size
operator|-
name|n
argument_list|,
literal|"\n\t\t\t\tReturn path:  "
argument_list|)
expr_stmt|;
name|n
operator|+=
name|sprint_uint8_arr
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|buf_size
operator|-
name|n
argument_list|,
name|p_smp
operator|->
name|return_path
argument_list|,
name|p_smp
operator|->
name|hop_count
operator|+
literal|1
argument_list|)
expr_stmt|;
name|n
operator|+=
name|snprintf
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|buf_size
operator|-
name|n
argument_list|,
literal|"\n\t\t\t\tReserved:     "
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|7
condition|;
name|i
operator|++
control|)
block|{
name|n
operator|+=
name|snprintf
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|buf_size
operator|-
name|n
argument_list|,
literal|"[%0X]"
argument_list|,
name|p_smp
operator|->
name|resv1
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
name|n
operator|+=
name|snprintf
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|buf_size
operator|-
name|n
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|64
condition|;
name|i
operator|+=
literal|16
control|)
block|{
name|n
operator|+=
name|snprintf
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|buf_size
operator|-
name|n
argument_list|,
literal|"\n\t\t\t\t%02X %02X %02X %02X "
literal|"%02X %02X %02X %02X"
literal|"   %02X %02X %02X %02X %02X %02X %02X %02X\n"
argument_list|,
name|p_smp
operator|->
name|data
index|[
name|i
index|]
argument_list|,
name|p_smp
operator|->
name|data
index|[
name|i
operator|+
literal|1
index|]
argument_list|,
name|p_smp
operator|->
name|data
index|[
name|i
operator|+
literal|2
index|]
argument_list|,
name|p_smp
operator|->
name|data
index|[
name|i
operator|+
literal|3
index|]
argument_list|,
name|p_smp
operator|->
name|data
index|[
name|i
operator|+
literal|4
index|]
argument_list|,
name|p_smp
operator|->
name|data
index|[
name|i
operator|+
literal|5
index|]
argument_list|,
name|p_smp
operator|->
name|data
index|[
name|i
operator|+
literal|6
index|]
argument_list|,
name|p_smp
operator|->
name|data
index|[
name|i
operator|+
literal|7
index|]
argument_list|,
name|p_smp
operator|->
name|data
index|[
name|i
operator|+
literal|8
index|]
argument_list|,
name|p_smp
operator|->
name|data
index|[
name|i
operator|+
literal|9
index|]
argument_list|,
name|p_smp
operator|->
name|data
index|[
name|i
operator|+
literal|10
index|]
argument_list|,
name|p_smp
operator|->
name|data
index|[
name|i
operator|+
literal|11
index|]
argument_list|,
name|p_smp
operator|->
name|data
index|[
name|i
operator|+
literal|12
index|]
argument_list|,
name|p_smp
operator|->
name|data
index|[
name|i
operator|+
literal|13
index|]
argument_list|,
name|p_smp
operator|->
name|data
index|[
name|i
operator|+
literal|14
index|]
argument_list|,
name|p_smp
operator|->
name|data
index|[
name|i
operator|+
literal|15
index|]
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
comment|/* not a Direct Route so provide source and destination lids */
name|n
operator|+=
name|snprintf
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|buf_size
operator|-
name|n
argument_list|,
literal|"\t\t\t\tMAD IS LID ROUTED\n"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_dr_smp
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_smp_t
modifier|*
name|p_smp
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_dr_smp_to_buf
argument_list|(
name|p_smp
argument_list|,
name|buf
argument_list|,
name|BUF_SIZE
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_dr_smp_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_smp_t
modifier|*
name|p_smp
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_dr_smp_to_buf
argument_list|(
name|p_smp
argument_list|,
name|buf
argument_list|,
name|BUF_SIZE
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_sa_mad_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_sa_mad_t
modifier|*
name|p_mad
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_mad
condition|)
return|return;
else|else
block|{
comment|/* make sure the mad is valid */
if|if
condition|(
name|p_mad
operator|==
name|NULL
condition|)
block|{
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"NULL MAD POINTER\n"
argument_list|)
expr_stmt|;
return|return;
block|}
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"SA MAD dump:\n"
literal|"\t\t\t\tbase_ver................0x%X\n"
literal|"\t\t\t\tmgmt_class..............0x%X\n"
literal|"\t\t\t\tclass_ver...............0x%X\n"
literal|"\t\t\t\tmethod..................0x%X (%s)\n"
literal|"\t\t\t\tstatus..................0x%X\n"
literal|"\t\t\t\tresv....................0x%X\n"
literal|"\t\t\t\ttrans_id................0x%"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tattr_id.................0x%X (%s)\n"
literal|"\t\t\t\tresv1...................0x%X\n"
literal|"\t\t\t\tattr_mod................0x%X\n"
literal|"\t\t\t\trmpp_version............0x%X\n"
literal|"\t\t\t\trmpp_type...............0x%X\n"
literal|"\t\t\t\trmpp_flags..............0x%X\n"
literal|"\t\t\t\trmpp_status.............0x%X\n"
literal|"\t\t\t\tseg_num.................0x%X\n"
literal|"\t\t\t\tpayload_len/new_win.....0x%X\n"
literal|"\t\t\t\tsm_key..................0x%016"
name|PRIx64
literal|"\n"
literal|"\t\t\t\tattr_offset.............0x%X\n"
literal|"\t\t\t\tresv2...................0x%X\n"
literal|"\t\t\t\tcomp_mask...............0x%016"
name|PRIx64
literal|"\n"
argument_list|,
name|p_mad
operator|->
name|base_ver
argument_list|,
name|p_mad
operator|->
name|mgmt_class
argument_list|,
name|p_mad
operator|->
name|class_ver
argument_list|,
name|p_mad
operator|->
name|method
argument_list|,
name|ib_get_sa_method_str
argument_list|(
name|p_mad
operator|->
name|method
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_mad
operator|->
name|status
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_mad
operator|->
name|resv
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_mad
operator|->
name|trans_id
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_mad
operator|->
name|attr_id
argument_list|)
argument_list|,
name|ib_get_sa_attr_str
argument_list|(
name|p_mad
operator|->
name|attr_id
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_mad
operator|->
name|resv1
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_mad
operator|->
name|attr_mod
argument_list|)
argument_list|,
name|p_mad
operator|->
name|rmpp_version
argument_list|,
name|p_mad
operator|->
name|rmpp_type
argument_list|,
name|p_mad
operator|->
name|rmpp_flags
argument_list|,
name|p_mad
operator|->
name|rmpp_status
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_mad
operator|->
name|seg_num
argument_list|)
argument_list|,
name|cl_ntoh32
argument_list|(
name|p_mad
operator|->
name|paylen_newwin
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_mad
operator|->
name|sm_key
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_mad
operator|->
name|attr_offset
argument_list|)
argument_list|,
name|cl_ntoh16
argument_list|(
name|p_mad
operator|->
name|resv3
argument_list|)
argument_list|,
name|cl_ntoh64
argument_list|(
name|p_mad
operator|->
name|comp_mask
argument_list|)
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|buf
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_sa_mad
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_sa_mad_t
modifier|*
name|p_mad
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_sa_mad_to_buf
argument_list|(
name|p_mad
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s\n"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_sa_mad_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_sa_mad_t
modifier|*
name|p_mad
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_sa_mad_to_buf
argument_list|(
name|p_mad
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_dr_path_to_buf
parameter_list|(
name|IN
specifier|const
name|osm_dr_path_t
modifier|*
name|p_path
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|,
name|IN
name|size_t
name|buf_size
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_path
condition|)
return|return;
else|else
block|{
name|unsigned
name|n
init|=
literal|0
decl_stmt|;
name|n
operator|=
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"Directed Path Dump of %u hop path: "
literal|"Path = "
argument_list|,
name|p_path
operator|->
name|hop_count
argument_list|)
expr_stmt|;
name|sprint_uint8_arr
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|buf_size
operator|-
name|n
argument_list|,
name|p_path
operator|->
name|path
argument_list|,
name|p_path
operator|->
name|hop_count
operator|+
literal|1
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_dr_path
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|osm_dr_path_t
modifier|*
name|p_path
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_dr_path_to_buf
argument_list|(
name|p_path
argument_list|,
name|buf
argument_list|,
name|BUF_SIZE
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s\n"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_dr_path_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|osm_dr_path_t
modifier|*
name|p_path
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_dr_path_to_buf
argument_list|(
name|p_path
argument_list|,
name|buf
argument_list|,
name|BUF_SIZE
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s\n"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|osm_dump_smp_dr_path_to_buf
parameter_list|(
name|IN
specifier|const
name|ib_smp_t
modifier|*
name|p_smp
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|,
name|IN
name|size_t
name|buf_size
parameter_list|)
block|{
if|if
condition|(
operator|!
name|buf
operator|||
operator|!
name|p_smp
condition|)
return|return;
else|else
block|{
name|unsigned
name|n
decl_stmt|;
name|n
operator|=
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"Received SMP on a %u hop path: "
literal|"Initial path = "
argument_list|,
name|p_smp
operator|->
name|hop_count
argument_list|)
expr_stmt|;
name|n
operator|+=
name|sprint_uint8_arr
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|buf_size
operator|-
name|n
argument_list|,
name|p_smp
operator|->
name|initial_path
argument_list|,
name|p_smp
operator|->
name|hop_count
operator|+
literal|1
argument_list|)
expr_stmt|;
name|n
operator|+=
name|snprintf
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|buf_size
operator|-
name|n
argument_list|,
literal|", Return path  = "
argument_list|)
expr_stmt|;
name|n
operator|+=
name|sprint_uint8_arr
argument_list|(
name|buf
operator|+
name|n
argument_list|,
name|buf_size
operator|-
name|n
argument_list|,
name|p_smp
operator|->
name|return_path
argument_list|,
name|p_smp
operator|->
name|hop_count
operator|+
literal|1
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_smp_dr_path
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_smp_t
modifier|*
name|p_smp
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_smp_dr_path_to_buf
argument_list|(
name|p_smp
argument_list|,
name|buf
argument_list|,
name|BUF_SIZE
argument_list|)
expr_stmt|;
name|osm_log
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
literal|"%s\n"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_smp_dr_path_v2
parameter_list|(
name|IN
name|osm_log_t
modifier|*
name|p_log
parameter_list|,
name|IN
specifier|const
name|ib_smp_t
modifier|*
name|p_smp
parameter_list|,
name|IN
specifier|const
name|int
name|file_id
parameter_list|,
name|IN
name|osm_log_level_t
name|log_level
parameter_list|)
block|{
if|if
condition|(
name|osm_log_is_active_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|BUF_SIZE
index|]
decl_stmt|;
name|osm_dump_smp_dr_path_to_buf
argument_list|(
name|p_smp
argument_list|,
name|buf
argument_list|,
name|BUF_SIZE
argument_list|)
expr_stmt|;
name|osm_log_v2
argument_list|(
name|p_log
argument_list|,
name|log_level
argument_list|,
name|file_id
argument_list|,
literal|"%s\n"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|osm_dump_dr_path_as_buf
parameter_list|(
name|IN
name|size_t
name|max_len
parameter_list|,
name|IN
specifier|const
name|osm_dr_path_t
modifier|*
name|p_path
parameter_list|,
name|OUT
name|char
modifier|*
name|buf
parameter_list|)
block|{
name|sprint_uint8_arr
argument_list|(
name|buf
argument_list|,
name|max_len
argument_list|,
name|p_path
operator|->
name|path
argument_list|,
name|p_path
operator|->
name|hop_count
operator|+
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|sm_signal_str
index|[]
init|=
block|{
literal|"OSM_SIGNAL_NONE"
block|,
comment|/* 0 */
literal|"OSM_SIGNAL_SWEEP"
block|,
comment|/* 1 */
literal|"OSM_SIGNAL_IDLE_TIME_PROCESS_REQUEST"
block|,
comment|/* 2 */
literal|"OSM_SIGNAL_PERFMGR_SWEEP"
block|,
comment|/* 3 */
literal|"OSM_SIGNAL_GUID_PROCESS_REQUEST"
block|,
comment|/* 4 */
literal|"UNKNOWN SIGNAL!!"
comment|/* 5 */
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|const
name|char
modifier|*
name|osm_get_sm_signal_str
parameter_list|(
name|IN
name|osm_signal_t
name|signal
parameter_list|)
block|{
if|if
condition|(
name|signal
operator|>
name|OSM_SIGNAL_MAX
condition|)
name|signal
operator|=
name|OSM_SIGNAL_MAX
expr_stmt|;
return|return
name|sm_signal_str
index|[
name|signal
index|]
return|;
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|disp_msg_str
index|[]
init|=
block|{
literal|"OSM_MSG_NONE"
block|,
literal|"OSM_MSG_MAD_NODE_INFO"
block|,
literal|"OSM_MSG_MAD_PORT_INFO"
block|,
literal|"OSM_MSG_MAD_SWITCH_INFO"
block|,
literal|"OSM_MSG_MAD_GUID_INFO"
block|,
literal|"OSM_MSG_MAD_NODE_DESC"
block|,
literal|"OSM_MSG_MAD_NODE_RECORD"
block|,
literal|"OSM_MSG_MAD_PORTINFO_RECORD"
block|,
literal|"OSM_MSG_MAD_SERVICE_RECORD"
block|,
literal|"OSM_MSG_MAD_PATH_RECORD"
block|,
literal|"OSM_MSG_MAD_MCMEMBER_RECORD"
block|,
literal|"OSM_MSG_MAD_LINK_RECORD"
block|,
literal|"OSM_MSG_MAD_SMINFO_RECORD"
block|,
literal|"OSM_MSG_MAD_CLASS_PORT_INFO"
block|,
literal|"OSM_MSG_MAD_INFORM_INFO"
block|,
literal|"OSM_MSG_MAD_LFT_RECORD"
block|,
literal|"OSM_MSG_MAD_LFT"
block|,
literal|"OSM_MSG_MAD_SM_INFO"
block|,
literal|"OSM_MSG_MAD_NOTICE"
block|,
literal|"OSM_MSG_LIGHT_SWEEP_FAIL"
block|,
literal|"OSM_MSG_MAD_MFT"
block|,
literal|"OSM_MSG_MAD_PKEY_TBL_RECORD"
block|,
literal|"OSM_MSG_MAD_VL_ARB_RECORD"
block|,
literal|"OSM_MSG_MAD_SLVL_TBL_RECORD"
block|,
literal|"OSM_MSG_MAD_PKEY"
block|,
literal|"OSM_MSG_MAD_VL_ARB"
block|,
literal|"OSM_MSG_MAD_SLVL"
block|,
literal|"OSM_MSG_MAD_GUIDINFO_RECORD"
block|,
literal|"OSM_MSG_MAD_INFORM_INFO_RECORD"
block|,
literal|"OSM_MSG_MAD_SWITCH_INFO_RECORD"
block|,
literal|"OSM_MSG_MAD_MFT_RECORD"
block|,
if|#
directive|if
name|defined
argument_list|(
name|VENDOR_RMPP_SUPPORT
argument_list|)
operator|&&
name|defined
argument_list|(
name|DUAL_SIDED_RMPP
argument_list|)
literal|"OSM_MSG_MAD_MULTIPATH_RECORD"
block|,
endif|#
directive|endif
literal|"OSM_MSG_MAD_PORT_COUNTERS"
block|,
literal|"OSM_MSG_MAD_MLNX_EXT_PORT_INFO"
block|,
literal|"UNKNOWN!!"
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|const
name|char
modifier|*
name|osm_get_disp_msg_str
parameter_list|(
name|IN
name|cl_disp_msgid_t
name|msg
parameter_list|)
block|{
if|if
condition|(
name|msg
operator|>=
name|OSM_MSG_MAX
condition|)
name|msg
operator|=
name|OSM_MSG_MAX
operator|-
literal|1
expr_stmt|;
return|return
name|disp_msg_str
index|[
name|msg
index|]
return|;
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|port_state_str_fixed_width
index|[]
init|=
block|{
literal|"NOC"
block|,
literal|"DWN"
block|,
literal|"INI"
block|,
literal|"ARM"
block|,
literal|"ACT"
block|,
literal|"???"
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|const
name|char
modifier|*
name|osm_get_port_state_str_fixed_width
parameter_list|(
name|IN
name|uint8_t
name|port_state
parameter_list|)
block|{
if|if
condition|(
name|port_state
operator|>
name|IB_LINK_ACTIVE
condition|)
name|port_state
operator|=
name|IB_LINK_ACTIVE
operator|+
literal|1
expr_stmt|;
return|return
name|port_state_str_fixed_width
index|[
name|port_state
index|]
return|;
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|node_type_str_fixed_width
index|[]
init|=
block|{
literal|"??"
block|,
literal|"CA"
block|,
literal|"SW"
block|,
literal|"RT"
block|, }
decl_stmt|;
end_decl_stmt

begin_function
specifier|const
name|char
modifier|*
name|osm_get_node_type_str_fixed_width
parameter_list|(
name|IN
name|uint8_t
name|node_type
parameter_list|)
block|{
if|if
condition|(
name|node_type
operator|>
name|IB_NODE_TYPE_ROUTER
condition|)
name|node_type
operator|=
literal|0
expr_stmt|;
return|return
name|node_type_str_fixed_width
index|[
name|node_type
index|]
return|;
block|}
end_function

begin_function
specifier|const
name|char
modifier|*
name|osm_get_manufacturer_str
parameter_list|(
name|IN
name|uint64_t
name|guid_ho
parameter_list|)
block|{
comment|/* note that the max vendor string length is 11 */
specifier|static
specifier|const
name|char
modifier|*
name|intel_str
init|=
literal|"Intel"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|mellanox_str
init|=
literal|"Mellanox"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|redswitch_str
init|=
literal|"Redswitch"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|silverstorm_str
init|=
literal|"SilverStorm"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|topspin_str
init|=
literal|"Topspin"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|fujitsu_str
init|=
literal|"Fujitsu"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|voltaire_str
init|=
literal|"Voltaire"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|yotta_str
init|=
literal|"YottaYotta"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|pathscale_str
init|=
literal|"PathScale"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|ibm_str
init|=
literal|"IBM"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|divergenet_str
init|=
literal|"DivergeNet"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|flextronics_str
init|=
literal|"Flextronics"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|agilent_str
init|=
literal|"Agilent"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|obsidian_str
init|=
literal|"Obsidian"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|baymicro_str
init|=
literal|"BayMicro"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|lsilogic_str
init|=
literal|"LSILogic"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|ddn_str
init|=
literal|"DataDirect"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|panta_str
init|=
literal|"Panta"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|hp_str
init|=
literal|"HP"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|rioworks_str
init|=
literal|"Rioworks"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|sun_str
init|=
literal|"Sun"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|leafntwks_str
init|=
literal|"3LeafNtwks"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|xsigo_str
init|=
literal|"Xsigo"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|dell_str
init|=
literal|"Dell"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|supermicro_str
init|=
literal|"SuperMicro"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|openib_str
init|=
literal|"OpenIB"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|unknown_str
init|=
literal|"Unknown"
decl_stmt|;
specifier|static
specifier|const
name|char
modifier|*
name|bull_str
init|=
literal|"Bull"
decl_stmt|;
switch|switch
condition|(
call|(
name|uint32_t
call|)
argument_list|(
name|guid_ho
operator|>>
operator|(
literal|5
operator|*
literal|8
operator|)
argument_list|)
condition|)
block|{
case|case
name|OSM_VENDOR_ID_INTEL
case|:
return|return
name|intel_str
return|;
case|case
name|OSM_VENDOR_ID_MELLANOX
case|:
case|case
name|OSM_VENDOR_ID_MELLANOX2
case|:
case|case
name|OSM_VENDOR_ID_MELLANOX3
case|:
case|case
name|OSM_VENDOR_ID_MELLANOX4
case|:
case|case
name|OSM_VENDOR_ID_MELLANOX5
case|:
return|return
name|mellanox_str
return|;
case|case
name|OSM_VENDOR_ID_REDSWITCH
case|:
return|return
name|redswitch_str
return|;
case|case
name|OSM_VENDOR_ID_SILVERSTORM
case|:
return|return
name|silverstorm_str
return|;
case|case
name|OSM_VENDOR_ID_TOPSPIN
case|:
return|return
name|topspin_str
return|;
case|case
name|OSM_VENDOR_ID_FUJITSU
case|:
case|case
name|OSM_VENDOR_ID_FUJITSU2
case|:
return|return
name|fujitsu_str
return|;
case|case
name|OSM_VENDOR_ID_VOLTAIRE
case|:
return|return
name|voltaire_str
return|;
case|case
name|OSM_VENDOR_ID_YOTTAYOTTA
case|:
return|return
name|yotta_str
return|;
case|case
name|OSM_VENDOR_ID_PATHSCALE
case|:
return|return
name|pathscale_str
return|;
case|case
name|OSM_VENDOR_ID_IBM
case|:
case|case
name|OSM_VENDOR_ID_IBM2
case|:
return|return
name|ibm_str
return|;
case|case
name|OSM_VENDOR_ID_DIVERGENET
case|:
return|return
name|divergenet_str
return|;
case|case
name|OSM_VENDOR_ID_FLEXTRONICS
case|:
return|return
name|flextronics_str
return|;
case|case
name|OSM_VENDOR_ID_AGILENT
case|:
return|return
name|agilent_str
return|;
case|case
name|OSM_VENDOR_ID_OBSIDIAN
case|:
return|return
name|obsidian_str
return|;
case|case
name|OSM_VENDOR_ID_BAYMICRO
case|:
return|return
name|baymicro_str
return|;
case|case
name|OSM_VENDOR_ID_LSILOGIC
case|:
return|return
name|lsilogic_str
return|;
case|case
name|OSM_VENDOR_ID_DDN
case|:
return|return
name|ddn_str
return|;
case|case
name|OSM_VENDOR_ID_PANTA
case|:
return|return
name|panta_str
return|;
case|case
name|OSM_VENDOR_ID_HP
case|:
case|case
name|OSM_VENDOR_ID_HP2
case|:
case|case
name|OSM_VENDOR_ID_HP3
case|:
case|case
name|OSM_VENDOR_ID_HP4
case|:
return|return
name|hp_str
return|;
case|case
name|OSM_VENDOR_ID_RIOWORKS
case|:
return|return
name|rioworks_str
return|;
case|case
name|OSM_VENDOR_ID_SUN
case|:
case|case
name|OSM_VENDOR_ID_SUN2
case|:
return|return
name|sun_str
return|;
case|case
name|OSM_VENDOR_ID_3LEAFNTWKS
case|:
return|return
name|leafntwks_str
return|;
case|case
name|OSM_VENDOR_ID_XSIGO
case|:
return|return
name|xsigo_str
return|;
case|case
name|OSM_VENDOR_ID_DELL
case|:
return|return
name|dell_str
return|;
case|case
name|OSM_VENDOR_ID_SUPERMICRO
case|:
return|return
name|supermicro_str
return|;
case|case
name|OSM_VENDOR_ID_OPENIB
case|:
return|return
name|openib_str
return|;
case|case
name|OSM_VENDOR_ID_BULL
case|:
return|return
name|bull_str
return|;
default|default:
return|return
name|unknown_str
return|;
block|}
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|mtu_str_fixed_width
index|[]
init|=
block|{
literal|"??? "
block|,
literal|"256 "
block|,
literal|"512 "
block|,
literal|"1024"
block|,
literal|"2048"
block|,
literal|"4096"
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|const
name|char
modifier|*
name|osm_get_mtu_str
parameter_list|(
name|IN
name|uint8_t
name|mtu
parameter_list|)
block|{
if|if
condition|(
name|mtu
operator|>
name|IB_MTU_LEN_4096
condition|)
return|return
name|mtu_str_fixed_width
index|[
literal|0
index|]
return|;
else|else
return|return
name|mtu_str_fixed_width
index|[
name|mtu
index|]
return|;
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|lwa_str_fixed_width
index|[]
init|=
block|{
literal|"???"
block|,
literal|"1x "
block|,
literal|"4x "
block|,
literal|"???"
block|,
literal|"8x "
block|,
literal|"???"
block|,
literal|"???"
block|,
literal|"???"
block|,
literal|"12x"
block|,
literal|"???"
block|,
literal|"???"
block|,
literal|"???"
block|,
literal|"???"
block|,
literal|"???"
block|,
literal|"???"
block|,
literal|"???"
block|,
literal|"2x "
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|const
name|char
modifier|*
name|osm_get_lwa_str
parameter_list|(
name|IN
name|uint8_t
name|lwa
parameter_list|)
block|{
if|if
condition|(
name|lwa
operator|>
literal|16
condition|)
return|return
name|lwa_str_fixed_width
index|[
literal|0
index|]
return|;
else|else
return|return
name|lwa_str_fixed_width
index|[
name|lwa
index|]
return|;
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|lsa_str_fixed_width
index|[]
init|=
block|{
literal|"Ext "
block|,
literal|"2.5 "
block|,
literal|"5   "
block|,
literal|"????"
block|,
literal|"10  "
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|lsea_str_fixed_width
index|[]
init|=
block|{
literal|"Std "
block|,
literal|"14  "
block|,
literal|"25  "
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|const
name|char
modifier|*
name|osm_get_lsa_str
parameter_list|(
name|IN
name|uint8_t
name|lsa
parameter_list|,
name|IN
name|uint8_t
name|lsea
parameter_list|,
name|IN
name|uint8_t
name|state
parameter_list|,
name|IN
name|uint8_t
name|fdr10
parameter_list|)
block|{
if|if
condition|(
name|lsa
operator|>
name|IB_LINK_SPEED_ACTIVE_10
operator|||
name|state
operator|==
name|IB_LINK_DOWN
condition|)
return|return
name|lsa_str_fixed_width
index|[
literal|3
index|]
return|;
if|if
condition|(
name|lsea
operator|==
name|IB_LINK_SPEED_EXT_ACTIVE_NONE
condition|)
block|{
if|if
condition|(
name|fdr10
condition|)
return|return
literal|"FDR10"
return|;
else|else
return|return
name|lsa_str_fixed_width
index|[
name|lsa
index|]
return|;
block|}
if|if
condition|(
name|lsea
operator|>
name|IB_LINK_SPEED_EXT_ACTIVE_25
condition|)
return|return
name|lsa_str_fixed_width
index|[
literal|3
index|]
return|;
return|return
name|lsea_str_fixed_width
index|[
name|lsea
index|]
return|;
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|sm_mgr_signal_str
index|[]
init|=
block|{
literal|"OSM_SM_SIGNAL_NONE"
block|,
comment|/* 0 */
literal|"OSM_SM_SIGNAL_DISCOVERY_COMPLETED"
block|,
comment|/* 1 */
literal|"OSM_SM_SIGNAL_POLLING_TIMEOUT"
block|,
comment|/* 2 */
literal|"OSM_SM_SIGNAL_DISCOVER"
block|,
comment|/* 3 */
literal|"OSM_SM_SIGNAL_DISABLE"
block|,
comment|/* 4 */
literal|"OSM_SM_SIGNAL_HANDOVER"
block|,
comment|/* 5 */
literal|"OSM_SM_SIGNAL_HANDOVER_SENT"
block|,
comment|/* 6 */
literal|"OSM_SM_SIGNAL_ACKNOWLEDGE"
block|,
comment|/* 7 */
literal|"OSM_SM_SIGNAL_STANDBY"
block|,
comment|/* 8 */
literal|"OSM_SM_SIGNAL_MASTER_OR_HIGHER_SM_DETECTED"
block|,
comment|/* 9 */
literal|"OSM_SM_SIGNAL_WAIT_FOR_HANDOVER"
block|,
comment|/* 10 */
literal|"UNKNOWN STATE!!"
comment|/* 11 */
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|const
name|char
modifier|*
name|osm_get_sm_mgr_signal_str
parameter_list|(
name|IN
name|osm_sm_signal_t
name|signal
parameter_list|)
block|{
if|if
condition|(
name|signal
operator|>
name|OSM_SM_SIGNAL_MAX
condition|)
name|signal
operator|=
name|OSM_SM_SIGNAL_MAX
expr_stmt|;
return|return
name|sm_mgr_signal_str
index|[
name|signal
index|]
return|;
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|sm_mgr_state_str
index|[]
init|=
block|{
literal|"NOTACTIVE"
block|,
comment|/* 0 */
literal|"DISCOVERING"
block|,
comment|/* 1 */
literal|"STANDBY"
block|,
comment|/* 2 */
literal|"MASTER"
block|,
comment|/* 3 */
literal|"UNKNOWN STATE!!"
comment|/* 4 */
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|const
name|char
modifier|*
name|osm_get_sm_mgr_state_str
parameter_list|(
name|IN
name|uint16_t
name|state
parameter_list|)
block|{
return|return
name|state
operator|<
name|ARR_SIZE
argument_list|(
name|sm_mgr_state_str
argument_list|)
condition|?
name|sm_mgr_state_str
index|[
name|state
index|]
else|:
name|sm_mgr_state_str
index|[
name|ARR_SIZE
argument_list|(
name|sm_mgr_state_str
argument_list|)
operator|-
literal|1
index|]
return|;
block|}
end_function

begin_function
name|int
name|ib_mtu_is_valid
parameter_list|(
name|IN
specifier|const
name|int
name|mtu
parameter_list|)
block|{
if|if
condition|(
name|mtu
operator|<
name|IB_MIN_MTU
operator|||
name|mtu
operator|>
name|IB_MAX_MTU
condition|)
return|return
literal|0
return|;
return|return
literal|1
return|;
block|}
end_function

begin_function
name|int
name|ib_rate_is_valid
parameter_list|(
name|IN
specifier|const
name|int
name|rate
parameter_list|)
block|{
if|if
condition|(
name|rate
operator|<
name|IB_MIN_RATE
operator|||
name|rate
operator|>
name|IB_MAX_RATE
condition|)
return|return
literal|0
return|;
return|return
literal|1
return|;
block|}
end_function

begin_function
name|int
name|ib_path_compare_rates
parameter_list|(
name|IN
specifier|const
name|int
name|rate1
parameter_list|,
name|IN
specifier|const
name|int
name|rate2
parameter_list|)
block|{
name|int
name|orate1
init|=
literal|0
decl_stmt|,
name|orate2
init|=
literal|0
decl_stmt|;
name|CL_ASSERT
argument_list|(
name|rate1
operator|>=
name|IB_MIN_RATE
operator|&&
name|rate1
operator|<=
name|IB_MAX_RATE
argument_list|)
expr_stmt|;
name|CL_ASSERT
argument_list|(
name|rate2
operator|>=
name|IB_MIN_RATE
operator|&&
name|rate2
operator|<=
name|IB_MAX_RATE
argument_list|)
expr_stmt|;
if|if
condition|(
name|rate1
operator|<=
name|IB_MAX_RATE
condition|)
name|orate1
operator|=
name|ordered_rates
index|[
name|rate1
index|]
expr_stmt|;
if|if
condition|(
name|rate2
operator|<=
name|IB_MAX_RATE
condition|)
name|orate2
operator|=
name|ordered_rates
index|[
name|rate2
index|]
expr_stmt|;
if|if
condition|(
name|orate1
operator|<
name|orate2
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|orate1
operator|==
name|orate2
condition|)
return|return
literal|0
return|;
return|return
literal|1
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|find_ordered_rate
parameter_list|(
name|IN
specifier|const
name|int
name|rate
parameter_list|)
block|{
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
name|IB_MIN_RATE
init|;
name|i
operator|<=
name|IB_MAX_RATE
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|ordered_rates
index|[
name|i
index|]
operator|==
name|rate
condition|)
return|return
name|i
return|;
block|}
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|ib_path_rate_get_prev
parameter_list|(
name|IN
specifier|const
name|int
name|rate
parameter_list|)
block|{
name|int
name|orate
decl_stmt|;
name|CL_ASSERT
argument_list|(
name|rate
operator|>=
name|IB_MIN_RATE
operator|&&
name|rate
operator|<=
name|IB_MAX_RATE
argument_list|)
expr_stmt|;
if|if
condition|(
name|rate
operator|<=
name|IB_MIN_RATE
condition|)
return|return
literal|0
return|;
if|if
condition|(
name|rate
operator|>
name|IB_MAX_RATE
condition|)
return|return
literal|0
return|;
name|orate
operator|=
name|ordered_rates
index|[
name|rate
index|]
expr_stmt|;
name|orate
operator|--
expr_stmt|;
return|return
name|find_ordered_rate
argument_list|(
name|orate
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|ib_path_rate_get_next
parameter_list|(
name|IN
specifier|const
name|int
name|rate
parameter_list|)
block|{
name|int
name|orate
decl_stmt|;
name|CL_ASSERT
argument_list|(
name|rate
operator|>=
name|IB_MIN_RATE
operator|&&
name|rate
operator|<=
name|IB_MAX_RATE
argument_list|)
expr_stmt|;
if|if
condition|(
name|rate
operator|<
name|IB_MIN_RATE
condition|)
return|return
literal|0
return|;
if|if
condition|(
name|rate
operator|>=
name|IB_MAX_RATE
condition|)
return|return
literal|0
return|;
name|orate
operator|=
name|ordered_rates
index|[
name|rate
index|]
expr_stmt|;
name|orate
operator|++
expr_stmt|;
return|return
name|find_ordered_rate
argument_list|(
name|orate
argument_list|)
return|;
block|}
end_function

end_unit

