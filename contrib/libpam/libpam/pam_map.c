begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* pam_map.c - PAM mapping interface  *  * $Id$  * $FreeBSD$  *  * This is based on the X/Open XSSO specification of March 1997.  * It is not implemented as it is going to change... after 1997/9/25.  *  * $Log$  */
end_comment

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|"pam_private.h"
end_include

begin_comment
comment|/* p 54 */
end_comment

begin_function_decl
name|int
name|pam_get_mapped_authtok
parameter_list|(
name|pam_handle_t
modifier|*
name|pamh
parameter_list|,
specifier|const
name|char
modifier|*
name|target_module_username
parameter_list|,
specifier|const
name|char
modifier|*
name|target_module_type
parameter_list|,
specifier|const
name|char
modifier|*
name|target_authn_domain
parameter_list|,
name|size_t
modifier|*
name|target_authtok_len
name|unsigned
name|char
modifier|*
modifier|*
name|target_module_authtok
parameter_list|)
function_decl|;
end_function_decl

begin_block
block|{
name|D
argument_list|(
operator|(
literal|"called"
operator|)
argument_list|)
expr_stmt|;
name|IF_NO_PAMH
argument_list|(
literal|"pam_get_mapped_authtok"
argument_list|,
name|pamh
argument_list|,
name|PAM_SYSTEM_ERR
argument_list|)
expr_stmt|;
return|return
name|PAM_SYSTEM_ERROR
return|;
block|}
end_block

begin_comment
comment|/* p 68 */
end_comment

begin_function
name|int
name|pam_set_mapped_authtok
parameter_list|(
name|pam_handle_t
modifier|*
name|pamh
parameter_list|,
name|char
modifier|*
name|target_module_username
parameter_list|,
name|size_t
modifier|*
name|target_authtok_len
parameter_list|,
name|unsigned
name|char
modifier|*
name|target_module_authtok
parameter_list|,
name|char
modifier|*
name|target_module_type
parameter_list|,
name|char
modifier|*
name|target_authn_domain
parameter_list|)
block|{
name|D
argument_list|(
operator|(
literal|"called"
operator|)
argument_list|)
expr_stmt|;
name|IF_NO_PAMH
argument_list|(
literal|"pam_set_mapped_authtok"
argument_list|,
name|pamh
argument_list|,
name|PAM_SYSTEM_ERR
argument_list|)
expr_stmt|;
return|return
name|PAM_SYSTEM_ERROR
return|;
block|}
end_function

begin_comment
comment|/* p 56 */
end_comment

begin_function
name|int
name|pam_get_mapped_username
parameter_list|(
name|pam_handle_t
modifier|*
name|pamh
parameter_list|,
specifier|const
name|char
modifier|*
name|src_username
parameter_list|,
specifier|const
name|char
modifier|*
name|src_module_type
parameter_list|,
specifier|const
name|char
modifier|*
name|src_authn_domain
parameter_list|,
specifier|const
name|char
modifier|*
name|target_module_type
parameter_list|,
specifier|const
name|char
modifier|*
name|target_authn_domain
parameter_list|,
name|char
modifier|*
modifier|*
name|target_module_username
parameter_list|)
block|{
name|D
argument_list|(
operator|(
literal|"called"
operator|)
argument_list|)
expr_stmt|;
name|IF_NO_PAMH
argument_list|(
literal|"pam_get_mapped_username"
argument_list|,
name|pamh
argument_list|,
name|PAM_SYSTEM_ERR
argument_list|)
expr_stmt|;
return|return
name|PAM_SYSTEM_ERROR
return|;
block|}
end_function

begin_comment
comment|/* p 70 */
end_comment

begin_function
name|int
name|pam_set_mapped_username
parameter_list|(
name|pam_handle_t
modifier|*
name|pamh
parameter_list|,
name|char
modifier|*
name|src_username
parameter_list|,
name|char
modifier|*
name|src_module_type
parameter_list|,
name|char
modifier|*
name|src_authn_domain
parameter_list|,
name|char
modifier|*
name|target_module_username
parameter_list|,
name|char
modifier|*
name|target_module_type
parameter_list|,
name|char
modifier|*
name|target_authn_domain
parameter_list|)
block|{
name|D
argument_list|(
operator|(
literal|"called"
operator|)
argument_list|)
expr_stmt|;
name|IF_NO_PAMH
argument_list|(
literal|"pam_set_mapped_username"
argument_list|,
name|pamh
argument_list|,
name|PAM_SYSTEM_ERR
argument_list|)
expr_stmt|;
return|return
name|PAM_SYSTEM_ERROR
return|;
block|}
end_function

end_unit

