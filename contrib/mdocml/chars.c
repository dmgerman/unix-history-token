begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*	$Id: chars.c,v 1.69 2017/02/17 18:28:06 schwarze Exp $ */
end_comment

begin_comment
comment|/*  * Copyright (c) 2009, 2010, 2011 Kristaps Dzonsons<kristaps@bsd.lv>  * Copyright (c) 2011, 2014, 2015 Ingo Schwarze<schwarze@openbsd.org>  *  * Permission to use, copy, modify, and distribute this software for any  * purpose with or without fee is hereby granted, provided that the above  * copyright notice and this permission notice appear in all copies.  *  * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES  * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF  * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR  * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES  * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN  * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF  * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.  */
end_comment

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|<assert.h>
end_include

begin_include
include|#
directive|include
file|<ctype.h>
end_include

begin_include
include|#
directive|include
file|<stddef.h>
end_include

begin_include
include|#
directive|include
file|<stdint.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|"mandoc.h"
end_include

begin_include
include|#
directive|include
file|"mandoc_aux.h"
end_include

begin_include
include|#
directive|include
file|"mandoc_ohash.h"
end_include

begin_include
include|#
directive|include
file|"libmandoc.h"
end_include

begin_struct
struct|struct
name|ln
block|{
specifier|const
name|char
name|roffcode
index|[
literal|16
index|]
decl_stmt|;
specifier|const
name|char
modifier|*
name|ascii
decl_stmt|;
name|int
name|unicode
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/* Special break control characters. */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
name|ascii_nbrsp
index|[
literal|2
index|]
init|=
block|{
name|ASCII_NBRSP
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|char
name|ascii_break
index|[
literal|2
index|]
init|=
block|{
name|ASCII_BREAK
block|,
literal|'\0'
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|ln
name|lines
index|[]
init|=
block|{
comment|/* Spacing. */
block|{
literal|" "
block|,
name|ascii_nbrsp
block|,
literal|0x00a0
block|}
block|,
block|{
literal|"~"
block|,
name|ascii_nbrsp
block|,
literal|0x00a0
block|}
block|,
block|{
literal|"0"
block|,
literal|" "
block|,
literal|0x2002
block|}
block|,
block|{
literal|"|"
block|,
literal|""
block|,
literal|0
block|}
block|,
block|{
literal|"^"
block|,
literal|""
block|,
literal|0
block|}
block|,
block|{
literal|"&"
block|,
literal|""
block|,
literal|0
block|}
block|,
block|{
literal|"%"
block|,
literal|""
block|,
literal|0
block|}
block|,
block|{
literal|":"
block|,
name|ascii_break
block|,
literal|0
block|}
block|,
comment|/* XXX The following three do not really belong here. */
block|{
literal|"t"
block|,
literal|""
block|,
literal|0
block|}
block|,
block|{
literal|"c"
block|,
literal|""
block|,
literal|0
block|}
block|,
block|{
literal|"}"
block|,
literal|""
block|,
literal|0
block|}
block|,
comment|/* Lines. */
block|{
literal|"ba"
block|,
literal|"|"
block|,
literal|0x007c
block|}
block|,
block|{
literal|"br"
block|,
literal|"|"
block|,
literal|0x2502
block|}
block|,
block|{
literal|"ul"
block|,
literal|"_"
block|,
literal|0x005f
block|}
block|,
block|{
literal|"rn"
block|,
literal|"-"
block|,
literal|0x203e
block|}
block|,
block|{
literal|"bb"
block|,
literal|"|"
block|,
literal|0x00a6
block|}
block|,
block|{
literal|"sl"
block|,
literal|"/"
block|,
literal|0x002f
block|}
block|,
block|{
literal|"rs"
block|,
literal|"\\"
block|,
literal|0x005c
block|}
block|,
comment|/* Text markers. */
block|{
literal|"ci"
block|,
literal|"O"
block|,
literal|0x25cb
block|}
block|,
block|{
literal|"bu"
block|,
literal|"+\bo"
block|,
literal|0x2022
block|}
block|,
block|{
literal|"dd"
block|,
literal|"|\b="
block|,
literal|0x2021
block|}
block|,
block|{
literal|"dg"
block|,
literal|"|\b-"
block|,
literal|0x2020
block|}
block|,
block|{
literal|"lz"
block|,
literal|"<>"
block|,
literal|0x25ca
block|}
block|,
block|{
literal|"sq"
block|,
literal|"[]"
block|,
literal|0x25a1
block|}
block|,
block|{
literal|"ps"
block|,
literal|"<par>"
block|,
literal|0x00b6
block|}
block|,
block|{
literal|"sc"
block|,
literal|"<sec>"
block|,
literal|0x00a7
block|}
block|,
block|{
literal|"lh"
block|,
literal|"<="
block|,
literal|0x261c
block|}
block|,
block|{
literal|"rh"
block|,
literal|"=>"
block|,
literal|0x261e
block|}
block|,
block|{
literal|"at"
block|,
literal|"@"
block|,
literal|0x0040
block|}
block|,
block|{
literal|"sh"
block|,
literal|"#"
block|,
literal|0x0023
block|}
block|,
block|{
literal|"CR"
block|,
literal|"_|"
block|,
literal|0x21b5
block|}
block|,
block|{
literal|"OK"
block|,
literal|"\\/"
block|,
literal|0x2713
block|}
block|,
comment|/* Legal symbols. */
block|{
literal|"co"
block|,
literal|"(C)"
block|,
literal|0x00a9
block|}
block|,
block|{
literal|"rg"
block|,
literal|"(R)"
block|,
literal|0x00ae
block|}
block|,
block|{
literal|"tm"
block|,
literal|"tm"
block|,
literal|0x2122
block|}
block|,
comment|/* Punctuation. */
block|{
literal|"em"
block|,
literal|"--"
block|,
literal|0x2014
block|}
block|,
block|{
literal|"en"
block|,
literal|"-"
block|,
literal|0x2013
block|}
block|,
block|{
literal|"hy"
block|,
literal|"-"
block|,
literal|0x2010
block|}
block|,
block|{
literal|"e"
block|,
literal|"\\"
block|,
literal|0x005c
block|}
block|,
block|{
literal|"."
block|,
literal|"."
block|,
literal|0x002e
block|}
block|,
block|{
literal|"r!"
block|,
literal|"!"
block|,
literal|0x00a1
block|}
block|,
block|{
literal|"r?"
block|,
literal|"?"
block|,
literal|0x00bf
block|}
block|,
comment|/* Quotes. */
block|{
literal|"Bq"
block|,
literal|",,"
block|,
literal|0x201e
block|}
block|,
block|{
literal|"bq"
block|,
literal|","
block|,
literal|0x201a
block|}
block|,
block|{
literal|"lq"
block|,
literal|"\""
block|,
literal|0x201c
block|}
block|,
block|{
literal|"rq"
block|,
literal|"\""
block|,
literal|0x201d
block|}
block|,
block|{
literal|"Lq"
block|,
literal|"\""
block|,
literal|0x201c
block|}
block|,
block|{
literal|"Rq"
block|,
literal|"\""
block|,
literal|0x201d
block|}
block|,
block|{
literal|"oq"
block|,
literal|"`"
block|,
literal|0x2018
block|}
block|,
block|{
literal|"cq"
block|,
literal|"\'"
block|,
literal|0x2019
block|}
block|,
block|{
literal|"aq"
block|,
literal|"\'"
block|,
literal|0x0027
block|}
block|,
block|{
literal|"dq"
block|,
literal|"\""
block|,
literal|0x0022
block|}
block|,
block|{
literal|"Fo"
block|,
literal|"<<"
block|,
literal|0x00ab
block|}
block|,
block|{
literal|"Fc"
block|,
literal|">>"
block|,
literal|0x00bb
block|}
block|,
block|{
literal|"fo"
block|,
literal|"<"
block|,
literal|0x2039
block|}
block|,
block|{
literal|"fc"
block|,
literal|">"
block|,
literal|0x203a
block|}
block|,
comment|/* Brackets. */
block|{
literal|"lB"
block|,
literal|"["
block|,
literal|0x005b
block|}
block|,
block|{
literal|"rB"
block|,
literal|"]"
block|,
literal|0x005d
block|}
block|,
block|{
literal|"lC"
block|,
literal|"{"
block|,
literal|0x007b
block|}
block|,
block|{
literal|"rC"
block|,
literal|"}"
block|,
literal|0x007d
block|}
block|,
block|{
literal|"la"
block|,
literal|"<"
block|,
literal|0x27e8
block|}
block|,
block|{
literal|"ra"
block|,
literal|">"
block|,
literal|0x27e9
block|}
block|,
block|{
literal|"bv"
block|,
literal|"|"
block|,
literal|0x23aa
block|}
block|,
block|{
literal|"braceex"
block|,
literal|"|"
block|,
literal|0x23aa
block|}
block|,
block|{
literal|"bracketlefttp"
block|,
literal|"|"
block|,
literal|0x23a1
block|}
block|,
block|{
literal|"bracketleftbt"
block|,
literal|"|"
block|,
literal|0x23a3
block|}
block|,
block|{
literal|"bracketleftex"
block|,
literal|"|"
block|,
literal|0x23a2
block|}
block|,
block|{
literal|"bracketrighttp"
block|,
literal|"|"
block|,
literal|0x23a4
block|}
block|,
block|{
literal|"bracketrightbt"
block|,
literal|"|"
block|,
literal|0x23a6
block|}
block|,
block|{
literal|"bracketrightex"
block|,
literal|"|"
block|,
literal|0x23a5
block|}
block|,
block|{
literal|"lt"
block|,
literal|",-"
block|,
literal|0x23a7
block|}
block|,
block|{
literal|"bracelefttp"
block|,
literal|",-"
block|,
literal|0x23a7
block|}
block|,
block|{
literal|"lk"
block|,
literal|"{"
block|,
literal|0x23a8
block|}
block|,
block|{
literal|"braceleftmid"
block|,
literal|"{"
block|,
literal|0x23a8
block|}
block|,
block|{
literal|"lb"
block|,
literal|"`-"
block|,
literal|0x23a9
block|}
block|,
block|{
literal|"braceleftbt"
block|,
literal|"`-"
block|,
literal|0x23a9
block|}
block|,
block|{
literal|"braceleftex"
block|,
literal|"|"
block|,
literal|0x23aa
block|}
block|,
block|{
literal|"rt"
block|,
literal|"-."
block|,
literal|0x23ab
block|}
block|,
block|{
literal|"bracerighttp"
block|,
literal|"-."
block|,
literal|0x23ab
block|}
block|,
block|{
literal|"rk"
block|,
literal|"}"
block|,
literal|0x23ac
block|}
block|,
block|{
literal|"bracerightmid"
block|,
literal|"}"
block|,
literal|0x23ac
block|}
block|,
block|{
literal|"rb"
block|,
literal|"-\'"
block|,
literal|0x23ad
block|}
block|,
block|{
literal|"bracerightbt"
block|,
literal|"-\'"
block|,
literal|0x23ad
block|}
block|,
block|{
literal|"bracerightex"
block|,
literal|"|"
block|,
literal|0x23aa
block|}
block|,
block|{
literal|"parenlefttp"
block|,
literal|"/"
block|,
literal|0x239b
block|}
block|,
block|{
literal|"parenleftbt"
block|,
literal|"\\"
block|,
literal|0x239d
block|}
block|,
block|{
literal|"parenleftex"
block|,
literal|"|"
block|,
literal|0x239c
block|}
block|,
block|{
literal|"parenrighttp"
block|,
literal|"\\"
block|,
literal|0x239e
block|}
block|,
block|{
literal|"parenrightbt"
block|,
literal|"/"
block|,
literal|0x23a0
block|}
block|,
block|{
literal|"parenrightex"
block|,
literal|"|"
block|,
literal|0x239f
block|}
block|,
comment|/* Arrows and lines. */
block|{
literal|"<-"
block|,
literal|"<-"
block|,
literal|0x2190
block|}
block|,
block|{
literal|"->"
block|,
literal|"->"
block|,
literal|0x2192
block|}
block|,
block|{
literal|"<>"
block|,
literal|"<->"
block|,
literal|0x2194
block|}
block|,
block|{
literal|"da"
block|,
literal|"|\bv"
block|,
literal|0x2193
block|}
block|,
block|{
literal|"ua"
block|,
literal|"|\b^"
block|,
literal|0x2191
block|}
block|,
block|{
literal|"va"
block|,
literal|"^v"
block|,
literal|0x2195
block|}
block|,
block|{
literal|"lA"
block|,
literal|"<="
block|,
literal|0x21d0
block|}
block|,
block|{
literal|"rA"
block|,
literal|"=>"
block|,
literal|0x21d2
block|}
block|,
block|{
literal|"hA"
block|,
literal|"<=>"
block|,
literal|0x21d4
block|}
block|,
block|{
literal|"uA"
block|,
literal|"=\b^"
block|,
literal|0x21d1
block|}
block|,
block|{
literal|"dA"
block|,
literal|"=\bv"
block|,
literal|0x21d3
block|}
block|,
block|{
literal|"vA"
block|,
literal|"^=v"
block|,
literal|0x21d5
block|}
block|,
comment|/* Logic. */
block|{
literal|"AN"
block|,
literal|"^"
block|,
literal|0x2227
block|}
block|,
block|{
literal|"OR"
block|,
literal|"v"
block|,
literal|0x2228
block|}
block|,
block|{
literal|"no"
block|,
literal|"~"
block|,
literal|0x00ac
block|}
block|,
block|{
literal|"tno"
block|,
literal|"~"
block|,
literal|0x00ac
block|}
block|,
block|{
literal|"te"
block|,
literal|"3"
block|,
literal|0x2203
block|}
block|,
block|{
literal|"fa"
block|,
literal|"-\bV"
block|,
literal|0x2200
block|}
block|,
block|{
literal|"st"
block|,
literal|"-)"
block|,
literal|0x220b
block|}
block|,
block|{
literal|"tf"
block|,
literal|".:."
block|,
literal|0x2234
block|}
block|,
block|{
literal|"3d"
block|,
literal|".:."
block|,
literal|0x2234
block|}
block|,
block|{
literal|"or"
block|,
literal|"|"
block|,
literal|0x007c
block|}
block|,
comment|/* Mathematicals. */
block|{
literal|"pl"
block|,
literal|"+"
block|,
literal|0x002b
block|}
block|,
block|{
literal|"mi"
block|,
literal|"-"
block|,
literal|0x2212
block|}
block|,
block|{
literal|"-"
block|,
literal|"-"
block|,
literal|0x002d
block|}
block|,
block|{
literal|"-+"
block|,
literal|"-+"
block|,
literal|0x2213
block|}
block|,
block|{
literal|"+-"
block|,
literal|"+-"
block|,
literal|0x00b1
block|}
block|,
block|{
literal|"t+-"
block|,
literal|"+-"
block|,
literal|0x00b1
block|}
block|,
block|{
literal|"pc"
block|,
literal|"."
block|,
literal|0x00b7
block|}
block|,
block|{
literal|"md"
block|,
literal|"."
block|,
literal|0x22c5
block|}
block|,
block|{
literal|"mu"
block|,
literal|"x"
block|,
literal|0x00d7
block|}
block|,
block|{
literal|"tmu"
block|,
literal|"x"
block|,
literal|0x00d7
block|}
block|,
block|{
literal|"c*"
block|,
literal|"O\bx"
block|,
literal|0x2297
block|}
block|,
block|{
literal|"c+"
block|,
literal|"O\b+"
block|,
literal|0x2295
block|}
block|,
block|{
literal|"di"
block|,
literal|"-:-"
block|,
literal|0x00f7
block|}
block|,
block|{
literal|"tdi"
block|,
literal|"-:-"
block|,
literal|0x00f7
block|}
block|,
block|{
literal|"f/"
block|,
literal|"/"
block|,
literal|0x2044
block|}
block|,
block|{
literal|"**"
block|,
literal|"*"
block|,
literal|0x2217
block|}
block|,
block|{
literal|"<="
block|,
literal|"<="
block|,
literal|0x2264
block|}
block|,
block|{
literal|">="
block|,
literal|">="
block|,
literal|0x2265
block|}
block|,
block|{
literal|"<<"
block|,
literal|"<<"
block|,
literal|0x226a
block|}
block|,
block|{
literal|">>"
block|,
literal|">>"
block|,
literal|0x226b
block|}
block|,
block|{
literal|"eq"
block|,
literal|"="
block|,
literal|0x003d
block|}
block|,
block|{
literal|"!="
block|,
literal|"!="
block|,
literal|0x2260
block|}
block|,
block|{
literal|"=="
block|,
literal|"=="
block|,
literal|0x2261
block|}
block|,
block|{
literal|"ne"
block|,
literal|"!=="
block|,
literal|0x2262
block|}
block|,
block|{
literal|"ap"
block|,
literal|"~"
block|,
literal|0x223c
block|}
block|,
block|{
literal|"|="
block|,
literal|"-~"
block|,
literal|0x2243
block|}
block|,
block|{
literal|"=~"
block|,
literal|"=~"
block|,
literal|0x2245
block|}
block|,
block|{
literal|"~~"
block|,
literal|"~~"
block|,
literal|0x2248
block|}
block|,
block|{
literal|"~="
block|,
literal|"~="
block|,
literal|0x2248
block|}
block|,
block|{
literal|"pt"
block|,
literal|"oc"
block|,
literal|0x221d
block|}
block|,
block|{
literal|"es"
block|,
literal|"{}"
block|,
literal|0x2205
block|}
block|,
block|{
literal|"mo"
block|,
literal|"E"
block|,
literal|0x2208
block|}
block|,
block|{
literal|"nm"
block|,
literal|"!E"
block|,
literal|0x2209
block|}
block|,
block|{
literal|"sb"
block|,
literal|"(="
block|,
literal|0x2282
block|}
block|,
block|{
literal|"nb"
block|,
literal|"(!="
block|,
literal|0x2284
block|}
block|,
block|{
literal|"sp"
block|,
literal|"=)"
block|,
literal|0x2283
block|}
block|,
block|{
literal|"nc"
block|,
literal|"!=)"
block|,
literal|0x2285
block|}
block|,
block|{
literal|"ib"
block|,
literal|"(=\b_"
block|,
literal|0x2286
block|}
block|,
block|{
literal|"ip"
block|,
literal|"=\b_)"
block|,
literal|0x2287
block|}
block|,
block|{
literal|"ca"
block|,
literal|"(^)"
block|,
literal|0x2229
block|}
block|,
block|{
literal|"cu"
block|,
literal|"U"
block|,
literal|0x222a
block|}
block|,
block|{
literal|"/_"
block|,
literal|"_\b/"
block|,
literal|0x2220
block|}
block|,
block|{
literal|"pp"
block|,
literal|"_\b|"
block|,
literal|0x22a5
block|}
block|,
block|{
literal|"is"
block|,
literal|"'\b,\bI"
block|,
literal|0x222b
block|}
block|,
block|{
literal|"integral"
block|,
literal|"'\b,\bI"
block|,
literal|0x222b
block|}
block|,
block|{
literal|"sum"
block|,
literal|"E"
block|,
literal|0x2211
block|}
block|,
block|{
literal|"product"
block|,
literal|"TT"
block|,
literal|0x220f
block|}
block|,
block|{
literal|"coproduct"
block|,
literal|"U"
block|,
literal|0x2210
block|}
block|,
block|{
literal|"gr"
block|,
literal|"V"
block|,
literal|0x2207
block|}
block|,
block|{
literal|"sr"
block|,
literal|"\\/"
block|,
literal|0x221a
block|}
block|,
block|{
literal|"sqrt"
block|,
literal|"\\/"
block|,
literal|0x221a
block|}
block|,
block|{
literal|"lc"
block|,
literal|"|~"
block|,
literal|0x2308
block|}
block|,
block|{
literal|"rc"
block|,
literal|"~|"
block|,
literal|0x2309
block|}
block|,
block|{
literal|"lf"
block|,
literal|"|_"
block|,
literal|0x230a
block|}
block|,
block|{
literal|"rf"
block|,
literal|"_|"
block|,
literal|0x230b
block|}
block|,
block|{
literal|"if"
block|,
literal|"oo"
block|,
literal|0x221e
block|}
block|,
block|{
literal|"Ah"
block|,
literal|"N"
block|,
literal|0x2135
block|}
block|,
block|{
literal|"Im"
block|,
literal|"I"
block|,
literal|0x2111
block|}
block|,
block|{
literal|"Re"
block|,
literal|"R"
block|,
literal|0x211c
block|}
block|,
block|{
literal|"pd"
block|,
literal|"a"
block|,
literal|0x2202
block|}
block|,
block|{
literal|"-h"
block|,
literal|"/h"
block|,
literal|0x210f
block|}
block|,
block|{
literal|"12"
block|,
literal|"1/2"
block|,
literal|0x00bd
block|}
block|,
block|{
literal|"14"
block|,
literal|"1/4"
block|,
literal|0x00bc
block|}
block|,
block|{
literal|"34"
block|,
literal|"3/4"
block|,
literal|0x00be
block|}
block|,
comment|/* Ligatures. */
block|{
literal|"ff"
block|,
literal|"ff"
block|,
literal|0xfb00
block|}
block|,
block|{
literal|"fi"
block|,
literal|"fi"
block|,
literal|0xfb01
block|}
block|,
block|{
literal|"fl"
block|,
literal|"fl"
block|,
literal|0xfb02
block|}
block|,
block|{
literal|"Fi"
block|,
literal|"ffi"
block|,
literal|0xfb03
block|}
block|,
block|{
literal|"Fl"
block|,
literal|"ffl"
block|,
literal|0xfb04
block|}
block|,
block|{
literal|"AE"
block|,
literal|"AE"
block|,
literal|0x00c6
block|}
block|,
block|{
literal|"ae"
block|,
literal|"ae"
block|,
literal|0x00e6
block|}
block|,
block|{
literal|"OE"
block|,
literal|"OE"
block|,
literal|0x0152
block|}
block|,
block|{
literal|"oe"
block|,
literal|"oe"
block|,
literal|0x0153
block|}
block|,
block|{
literal|"ss"
block|,
literal|"ss"
block|,
literal|0x00df
block|}
block|,
block|{
literal|"IJ"
block|,
literal|"IJ"
block|,
literal|0x0132
block|}
block|,
block|{
literal|"ij"
block|,
literal|"ij"
block|,
literal|0x0133
block|}
block|,
comment|/* Accents. */
block|{
literal|"a\""
block|,
literal|"\""
block|,
literal|0x02dd
block|}
block|,
block|{
literal|"a-"
block|,
literal|"-"
block|,
literal|0x00af
block|}
block|,
block|{
literal|"a."
block|,
literal|"."
block|,
literal|0x02d9
block|}
block|,
block|{
literal|"a^"
block|,
literal|"^"
block|,
literal|0x005e
block|}
block|,
block|{
literal|"aa"
block|,
literal|"\'"
block|,
literal|0x00b4
block|}
block|,
block|{
literal|"\'"
block|,
literal|"\'"
block|,
literal|0x00b4
block|}
block|,
block|{
literal|"ga"
block|,
literal|"`"
block|,
literal|0x0060
block|}
block|,
block|{
literal|"`"
block|,
literal|"`"
block|,
literal|0x0060
block|}
block|,
block|{
literal|"ab"
block|,
literal|"'\b`"
block|,
literal|0x02d8
block|}
block|,
block|{
literal|"ac"
block|,
literal|","
block|,
literal|0x00b8
block|}
block|,
block|{
literal|"ad"
block|,
literal|"\""
block|,
literal|0x00a8
block|}
block|,
block|{
literal|"ah"
block|,
literal|"v"
block|,
literal|0x02c7
block|}
block|,
block|{
literal|"ao"
block|,
literal|"o"
block|,
literal|0x02da
block|}
block|,
block|{
literal|"a~"
block|,
literal|"~"
block|,
literal|0x007e
block|}
block|,
block|{
literal|"ho"
block|,
literal|","
block|,
literal|0x02db
block|}
block|,
block|{
literal|"ha"
block|,
literal|"^"
block|,
literal|0x005e
block|}
block|,
block|{
literal|"ti"
block|,
literal|"~"
block|,
literal|0x007e
block|}
block|,
comment|/* Accented letters. */
block|{
literal|"'A"
block|,
literal|"'\bA"
block|,
literal|0x00c1
block|}
block|,
block|{
literal|"'E"
block|,
literal|"'\bE"
block|,
literal|0x00c9
block|}
block|,
block|{
literal|"'I"
block|,
literal|"'\bI"
block|,
literal|0x00cd
block|}
block|,
block|{
literal|"'O"
block|,
literal|"'\bO"
block|,
literal|0x00d3
block|}
block|,
block|{
literal|"'U"
block|,
literal|"'\bU"
block|,
literal|0x00da
block|}
block|,
block|{
literal|"'a"
block|,
literal|"'\ba"
block|,
literal|0x00e1
block|}
block|,
block|{
literal|"'e"
block|,
literal|"'\be"
block|,
literal|0x00e9
block|}
block|,
block|{
literal|"'i"
block|,
literal|"'\bi"
block|,
literal|0x00ed
block|}
block|,
block|{
literal|"'o"
block|,
literal|"'\bo"
block|,
literal|0x00f3
block|}
block|,
block|{
literal|"'u"
block|,
literal|"'\bu"
block|,
literal|0x00fa
block|}
block|,
block|{
literal|"`A"
block|,
literal|"`\bA"
block|,
literal|0x00c0
block|}
block|,
block|{
literal|"`E"
block|,
literal|"`\bE"
block|,
literal|0x00c8
block|}
block|,
block|{
literal|"`I"
block|,
literal|"`\bI"
block|,
literal|0x00cc
block|}
block|,
block|{
literal|"`O"
block|,
literal|"`\bO"
block|,
literal|0x00d2
block|}
block|,
block|{
literal|"`U"
block|,
literal|"`\bU"
block|,
literal|0x00d9
block|}
block|,
block|{
literal|"`a"
block|,
literal|"`\ba"
block|,
literal|0x00e0
block|}
block|,
block|{
literal|"`e"
block|,
literal|"`\be"
block|,
literal|0x00e8
block|}
block|,
block|{
literal|"`i"
block|,
literal|"`\bi"
block|,
literal|0x00ec
block|}
block|,
block|{
literal|"`o"
block|,
literal|"`\bo"
block|,
literal|0x00f2
block|}
block|,
block|{
literal|"`u"
block|,
literal|"`\bu"
block|,
literal|0x00f9
block|}
block|,
block|{
literal|"~A"
block|,
literal|"~\bA"
block|,
literal|0x00c3
block|}
block|,
block|{
literal|"~N"
block|,
literal|"~\bN"
block|,
literal|0x00d1
block|}
block|,
block|{
literal|"~O"
block|,
literal|"~\bO"
block|,
literal|0x00d5
block|}
block|,
block|{
literal|"~a"
block|,
literal|"~\ba"
block|,
literal|0x00e3
block|}
block|,
block|{
literal|"~n"
block|,
literal|"~\bn"
block|,
literal|0x00f1
block|}
block|,
block|{
literal|"~o"
block|,
literal|"~\bo"
block|,
literal|0x00f5
block|}
block|,
block|{
literal|":A"
block|,
literal|"\"\bA"
block|,
literal|0x00c4
block|}
block|,
block|{
literal|":E"
block|,
literal|"\"\bE"
block|,
literal|0x00cb
block|}
block|,
block|{
literal|":I"
block|,
literal|"\"\bI"
block|,
literal|0x00cf
block|}
block|,
block|{
literal|":O"
block|,
literal|"\"\bO"
block|,
literal|0x00d6
block|}
block|,
block|{
literal|":U"
block|,
literal|"\"\bU"
block|,
literal|0x00dc
block|}
block|,
block|{
literal|":a"
block|,
literal|"\"\ba"
block|,
literal|0x00e4
block|}
block|,
block|{
literal|":e"
block|,
literal|"\"\be"
block|,
literal|0x00eb
block|}
block|,
block|{
literal|":i"
block|,
literal|"\"\bi"
block|,
literal|0x00ef
block|}
block|,
block|{
literal|":o"
block|,
literal|"\"\bo"
block|,
literal|0x00f6
block|}
block|,
block|{
literal|":u"
block|,
literal|"\"\bu"
block|,
literal|0x00fc
block|}
block|,
block|{
literal|":y"
block|,
literal|"\"\by"
block|,
literal|0x00ff
block|}
block|,
block|{
literal|"^A"
block|,
literal|"^\bA"
block|,
literal|0x00c2
block|}
block|,
block|{
literal|"^E"
block|,
literal|"^\bE"
block|,
literal|0x00ca
block|}
block|,
block|{
literal|"^I"
block|,
literal|"^\bI"
block|,
literal|0x00ce
block|}
block|,
block|{
literal|"^O"
block|,
literal|"^\bO"
block|,
literal|0x00d4
block|}
block|,
block|{
literal|"^U"
block|,
literal|"^\bU"
block|,
literal|0x00db
block|}
block|,
block|{
literal|"^a"
block|,
literal|"^\ba"
block|,
literal|0x00e2
block|}
block|,
block|{
literal|"^e"
block|,
literal|"^\be"
block|,
literal|0x00ea
block|}
block|,
block|{
literal|"^i"
block|,
literal|"^\bi"
block|,
literal|0x00ee
block|}
block|,
block|{
literal|"^o"
block|,
literal|"^\bo"
block|,
literal|0x00f4
block|}
block|,
block|{
literal|"^u"
block|,
literal|"^\bu"
block|,
literal|0x00fb
block|}
block|,
block|{
literal|",C"
block|,
literal|",\bC"
block|,
literal|0x00c7
block|}
block|,
block|{
literal|",c"
block|,
literal|",\bc"
block|,
literal|0x00e7
block|}
block|,
block|{
literal|"/L"
block|,
literal|"/\bL"
block|,
literal|0x0141
block|}
block|,
block|{
literal|"/l"
block|,
literal|"/\bl"
block|,
literal|0x0142
block|}
block|,
block|{
literal|"/O"
block|,
literal|"/\bO"
block|,
literal|0x00d8
block|}
block|,
block|{
literal|"/o"
block|,
literal|"/\bo"
block|,
literal|0x00f8
block|}
block|,
block|{
literal|"oA"
block|,
literal|"o\bA"
block|,
literal|0x00c5
block|}
block|,
block|{
literal|"oa"
block|,
literal|"o\ba"
block|,
literal|0x00e5
block|}
block|,
comment|/* Special letters. */
block|{
literal|"-D"
block|,
literal|"-\bD"
block|,
literal|0x00d0
block|}
block|,
block|{
literal|"Sd"
block|,
literal|"d"
block|,
literal|0x00f0
block|}
block|,
block|{
literal|"TP"
block|,
literal|"Th"
block|,
literal|0x00de
block|}
block|,
block|{
literal|"Tp"
block|,
literal|"th"
block|,
literal|0x00fe
block|}
block|,
block|{
literal|".i"
block|,
literal|"i"
block|,
literal|0x0131
block|}
block|,
block|{
literal|".j"
block|,
literal|"j"
block|,
literal|0x0237
block|}
block|,
comment|/* Currency. */
block|{
literal|"Do"
block|,
literal|"$"
block|,
literal|0x0024
block|}
block|,
block|{
literal|"ct"
block|,
literal|"/\bc"
block|,
literal|0x00a2
block|}
block|,
block|{
literal|"Eu"
block|,
literal|"EUR"
block|,
literal|0x20ac
block|}
block|,
block|{
literal|"eu"
block|,
literal|"EUR"
block|,
literal|0x20ac
block|}
block|,
block|{
literal|"Ye"
block|,
literal|"=\bY"
block|,
literal|0x00a5
block|}
block|,
block|{
literal|"Po"
block|,
literal|"GBP"
block|,
literal|0x00a3
block|}
block|,
block|{
literal|"Cs"
block|,
literal|"o\bx"
block|,
literal|0x00a4
block|}
block|,
block|{
literal|"Fn"
block|,
literal|",\bf"
block|,
literal|0x0192
block|}
block|,
comment|/* Units. */
block|{
literal|"de"
block|,
literal|"<deg>"
block|,
literal|0x00b0
block|}
block|,
block|{
literal|"%0"
block|,
literal|"%o"
block|,
literal|0x2030
block|}
block|,
block|{
literal|"fm"
block|,
literal|"\'"
block|,
literal|0x2032
block|}
block|,
block|{
literal|"sd"
block|,
literal|"''"
block|,
literal|0x2033
block|}
block|,
block|{
literal|"mc"
block|,
literal|",\bu"
block|,
literal|0x00b5
block|}
block|,
comment|/* Greek characters. */
block|{
literal|"*A"
block|,
literal|"A"
block|,
literal|0x0391
block|}
block|,
block|{
literal|"*B"
block|,
literal|"B"
block|,
literal|0x0392
block|}
block|,
block|{
literal|"*G"
block|,
literal|"G"
block|,
literal|0x0393
block|}
block|,
block|{
literal|"*D"
block|,
literal|"_\b/_\b\\"
block|,
literal|0x0394
block|}
block|,
block|{
literal|"*E"
block|,
literal|"E"
block|,
literal|0x0395
block|}
block|,
block|{
literal|"*Z"
block|,
literal|"Z"
block|,
literal|0x0396
block|}
block|,
block|{
literal|"*Y"
block|,
literal|"H"
block|,
literal|0x0397
block|}
block|,
block|{
literal|"*H"
block|,
literal|"-\bO"
block|,
literal|0x0398
block|}
block|,
block|{
literal|"*I"
block|,
literal|"I"
block|,
literal|0x0399
block|}
block|,
block|{
literal|"*K"
block|,
literal|"K"
block|,
literal|0x039a
block|}
block|,
block|{
literal|"*L"
block|,
literal|"/\\"
block|,
literal|0x039b
block|}
block|,
block|{
literal|"*M"
block|,
literal|"M"
block|,
literal|0x039c
block|}
block|,
block|{
literal|"*N"
block|,
literal|"N"
block|,
literal|0x039d
block|}
block|,
block|{
literal|"*C"
block|,
literal|"_\bH"
block|,
literal|0x039e
block|}
block|,
block|{
literal|"*O"
block|,
literal|"O"
block|,
literal|0x039f
block|}
block|,
block|{
literal|"*P"
block|,
literal|"TT"
block|,
literal|0x03a0
block|}
block|,
block|{
literal|"*R"
block|,
literal|"P"
block|,
literal|0x03a1
block|}
block|,
block|{
literal|"*S"
block|,
literal|"S"
block|,
literal|0x03a3
block|}
block|,
block|{
literal|"*T"
block|,
literal|"T"
block|,
literal|0x03a4
block|}
block|,
block|{
literal|"*U"
block|,
literal|"Y"
block|,
literal|0x03a5
block|}
block|,
block|{
literal|"*F"
block|,
literal|"I\bO"
block|,
literal|0x03a6
block|}
block|,
block|{
literal|"*X"
block|,
literal|"X"
block|,
literal|0x03a7
block|}
block|,
block|{
literal|"*Q"
block|,
literal|"I\bY"
block|,
literal|0x03a8
block|}
block|,
block|{
literal|"*W"
block|,
literal|"_\bO"
block|,
literal|0x03a9
block|}
block|,
block|{
literal|"*a"
block|,
literal|"a"
block|,
literal|0x03b1
block|}
block|,
block|{
literal|"*b"
block|,
literal|"B"
block|,
literal|0x03b2
block|}
block|,
block|{
literal|"*g"
block|,
literal|"y"
block|,
literal|0x03b3
block|}
block|,
block|{
literal|"*d"
block|,
literal|"d"
block|,
literal|0x03b4
block|}
block|,
block|{
literal|"*e"
block|,
literal|"e"
block|,
literal|0x03b5
block|}
block|,
block|{
literal|"*z"
block|,
literal|",\bC"
block|,
literal|0x03b6
block|}
block|,
block|{
literal|"*y"
block|,
literal|"n"
block|,
literal|0x03b7
block|}
block|,
block|{
literal|"*h"
block|,
literal|"-\b0"
block|,
literal|0x03b8
block|}
block|,
block|{
literal|"*i"
block|,
literal|"i"
block|,
literal|0x03b9
block|}
block|,
block|{
literal|"*k"
block|,
literal|"k"
block|,
literal|0x03ba
block|}
block|,
block|{
literal|"*l"
block|,
literal|">\b\\"
block|,
literal|0x03bb
block|}
block|,
block|{
literal|"*m"
block|,
literal|",\bu"
block|,
literal|0x03bc
block|}
block|,
block|{
literal|"*n"
block|,
literal|"v"
block|,
literal|0x03bd
block|}
block|,
block|{
literal|"*c"
block|,
literal|",\bE"
block|,
literal|0x03be
block|}
block|,
block|{
literal|"*o"
block|,
literal|"o"
block|,
literal|0x03bf
block|}
block|,
block|{
literal|"*p"
block|,
literal|"-\bn"
block|,
literal|0x03c0
block|}
block|,
block|{
literal|"*r"
block|,
literal|"p"
block|,
literal|0x03c1
block|}
block|,
block|{
literal|"*s"
block|,
literal|"-\bo"
block|,
literal|0x03c3
block|}
block|,
block|{
literal|"*t"
block|,
literal|"~\bt"
block|,
literal|0x03c4
block|}
block|,
block|{
literal|"*u"
block|,
literal|"u"
block|,
literal|0x03c5
block|}
block|,
block|{
literal|"*f"
block|,
literal|"|\bo"
block|,
literal|0x03d5
block|}
block|,
block|{
literal|"*x"
block|,
literal|"x"
block|,
literal|0x03c7
block|}
block|,
block|{
literal|"*q"
block|,
literal|"|\bu"
block|,
literal|0x03c8
block|}
block|,
block|{
literal|"*w"
block|,
literal|"w"
block|,
literal|0x03c9
block|}
block|,
block|{
literal|"+h"
block|,
literal|"-\b0"
block|,
literal|0x03d1
block|}
block|,
block|{
literal|"+f"
block|,
literal|"|\bo"
block|,
literal|0x03c6
block|}
block|,
block|{
literal|"+p"
block|,
literal|"-\bw"
block|,
literal|0x03d6
block|}
block|,
block|{
literal|"+e"
block|,
literal|"e"
block|,
literal|0x03f5
block|}
block|,
block|{
literal|"ts"
block|,
literal|"s"
block|,
literal|0x03c2
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|ohash
name|mchars
decl_stmt|;
end_decl_stmt

begin_function
name|void
name|mchars_free
parameter_list|(
name|void
parameter_list|)
block|{
name|ohash_delete
argument_list|(
operator|&
name|mchars
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|mchars_alloc
parameter_list|(
name|void
parameter_list|)
block|{
name|size_t
name|i
decl_stmt|;
name|unsigned
name|int
name|slot
decl_stmt|;
name|mandoc_ohash_init
argument_list|(
operator|&
name|mchars
argument_list|,
literal|9
argument_list|,
name|offsetof
argument_list|(
expr|struct
name|ln
argument_list|,
name|roffcode
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
sizeof|sizeof
argument_list|(
name|lines
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|lines
index|[
literal|0
index|]
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
name|slot
operator|=
name|ohash_qlookup
argument_list|(
operator|&
name|mchars
argument_list|,
name|lines
index|[
name|i
index|]
operator|.
name|roffcode
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|ohash_find
argument_list|(
operator|&
name|mchars
argument_list|,
name|slot
argument_list|)
operator|==
name|NULL
argument_list|)
expr_stmt|;
name|ohash_insert
argument_list|(
operator|&
name|mchars
argument_list|,
name|slot
argument_list|,
name|lines
operator|+
name|i
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|int
name|mchars_spec2cp
parameter_list|(
specifier|const
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|sz
parameter_list|)
block|{
specifier|const
name|struct
name|ln
modifier|*
name|ln
decl_stmt|;
specifier|const
name|char
modifier|*
name|end
decl_stmt|;
name|end
operator|=
name|p
operator|+
name|sz
expr_stmt|;
name|ln
operator|=
name|ohash_find
argument_list|(
operator|&
name|mchars
argument_list|,
name|ohash_qlookupi
argument_list|(
operator|&
name|mchars
argument_list|,
name|p
argument_list|,
operator|&
name|end
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|ln
operator|!=
name|NULL
condition|?
name|ln
operator|->
name|unicode
else|:
name|sz
operator|==
literal|1
condition|?
operator|(
name|unsigned
name|char
operator|)
operator|*
name|p
else|:
operator|-
literal|1
return|;
block|}
end_function

begin_function
name|int
name|mchars_num2char
parameter_list|(
specifier|const
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|sz
parameter_list|)
block|{
name|int
name|i
decl_stmt|;
name|i
operator|=
name|mandoc_strntoi
argument_list|(
name|p
argument_list|,
name|sz
argument_list|,
literal|10
argument_list|)
expr_stmt|;
return|return
name|i
operator|>=
literal|0
operator|&&
name|i
operator|<
literal|256
condition|?
name|i
else|:
operator|-
literal|1
return|;
block|}
end_function

begin_function
name|int
name|mchars_num2uc
parameter_list|(
specifier|const
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|sz
parameter_list|)
block|{
name|int
name|i
decl_stmt|;
name|i
operator|=
name|mandoc_strntoi
argument_list|(
name|p
argument_list|,
name|sz
argument_list|,
literal|16
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|i
operator|>=
literal|0
operator|&&
name|i
operator|<=
literal|0x10FFFF
argument_list|)
expr_stmt|;
return|return
name|i
return|;
block|}
end_function

begin_function
specifier|const
name|char
modifier|*
name|mchars_spec2str
parameter_list|(
specifier|const
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|sz
parameter_list|,
name|size_t
modifier|*
name|rsz
parameter_list|)
block|{
specifier|const
name|struct
name|ln
modifier|*
name|ln
decl_stmt|;
specifier|const
name|char
modifier|*
name|end
decl_stmt|;
name|end
operator|=
name|p
operator|+
name|sz
expr_stmt|;
name|ln
operator|=
name|ohash_find
argument_list|(
operator|&
name|mchars
argument_list|,
name|ohash_qlookupi
argument_list|(
operator|&
name|mchars
argument_list|,
name|p
argument_list|,
operator|&
name|end
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|ln
operator|==
name|NULL
condition|)
block|{
operator|*
name|rsz
operator|=
literal|1
expr_stmt|;
return|return
name|sz
operator|==
literal|1
condition|?
name|p
else|:
name|NULL
return|;
block|}
operator|*
name|rsz
operator|=
name|strlen
argument_list|(
name|ln
operator|->
name|ascii
argument_list|)
expr_stmt|;
return|return
name|ln
operator|->
name|ascii
return|;
block|}
end_function

begin_function
specifier|const
name|char
modifier|*
name|mchars_uc2str
parameter_list|(
name|int
name|uc
parameter_list|)
block|{
name|size_t
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
sizeof|sizeof
argument_list|(
name|lines
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|lines
index|[
literal|0
index|]
argument_list|)
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|uc
operator|==
name|lines
index|[
name|i
index|]
operator|.
name|unicode
condition|)
return|return
name|lines
index|[
name|i
index|]
operator|.
name|ascii
return|;
return|return
literal|"<?>"
return|;
block|}
end_function

end_unit

