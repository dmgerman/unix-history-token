begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*- * Copyright (c) 2003-2007 Tim Kientzle * Copyright (c) 2011 Andres Mejia * Copyright (c) 2011 Michihiro NAKAJIMA * All rights reserved. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions * are met: * 1. Redistributions of source code must retain the above copyright *    notice, this list of conditions and the following disclaimer. * 2. Redistributions in binary form must reproduce the above copyright *    notice, this list of conditions and the following disclaimer in the *    documentation and/or other materials provided with the distribution. * * THIS SOFTWARE IS PROVIDED BY THE AUTHOR(S) ``AS IS'' AND ANY EXPRESS OR * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. * IN NO EVENT SHALL THE AUTHOR(S) BE LIABLE FOR ANY DIRECT, INDIRECT, * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */
end_comment

begin_include
include|#
directive|include
file|"archive_platform.h"
end_include

begin_include
include|#
directive|include
file|"archive.h"
end_include

begin_include
include|#
directive|include
file|"archive_crypto_private.h"
end_include

begin_comment
comment|/* In particular, force the configure probe to break if it tries  * to test a combination of OpenSSL and libmd. */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_OPENSSL
argument_list|)
operator|&&
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_LIBMD
argument_list|)
end_if

begin_error
error|#
directive|error
error|Cannot use both OpenSSL and libmd.
end_error

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/*  * Message digest functions for Windows platform.  */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_MD5_WIN
argument_list|)
operator|||
expr|\
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA1_WIN
argument_list|)
operator|||
expr|\
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA256_WIN
argument_list|)
operator|||
expr|\
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA384_WIN
argument_list|)
operator|||
expr|\
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA512_WIN
argument_list|)
end_if

begin_comment
comment|/*  * Initialize a Message digest.  */
end_comment

begin_function
specifier|static
name|int
name|win_crypto_init
parameter_list|(
name|Digest_CTX
modifier|*
name|ctx
parameter_list|,
name|ALG_ID
name|algId
parameter_list|)
block|{
name|ctx
operator|->
name|valid
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|!
name|CryptAcquireContext
argument_list|(
operator|&
name|ctx
operator|->
name|cryptProv
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|PROV_RSA_FULL
argument_list|,
name|CRYPT_VERIFYCONTEXT
argument_list|)
condition|)
block|{
if|if
condition|(
name|GetLastError
argument_list|()
operator|!=
operator|(
name|DWORD
operator|)
name|NTE_BAD_KEYSET
condition|)
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
if|if
condition|(
operator|!
name|CryptAcquireContext
argument_list|(
operator|&
name|ctx
operator|->
name|cryptProv
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|PROV_RSA_FULL
argument_list|,
name|CRYPT_NEWKEYSET
argument_list|)
condition|)
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
if|if
condition|(
operator|!
name|CryptCreateHash
argument_list|(
name|ctx
operator|->
name|cryptProv
argument_list|,
name|algId
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
operator|&
name|ctx
operator|->
name|hash
argument_list|)
condition|)
block|{
name|CryptReleaseContext
argument_list|(
name|ctx
operator|->
name|cryptProv
argument_list|,
literal|0
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
name|ctx
operator|->
name|valid
operator|=
literal|1
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Update a Message digest.  */
end_comment

begin_function
specifier|static
name|int
name|win_crypto_Update
parameter_list|(
name|Digest_CTX
modifier|*
name|ctx
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
name|buf
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
if|if
condition|(
operator|!
name|ctx
operator|->
name|valid
condition|)
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
name|CryptHashData
argument_list|(
name|ctx
operator|->
name|hash
argument_list|,
operator|(
name|unsigned
name|char
operator|*
operator|)
operator|(
name|uintptr_t
operator|)
name|buf
argument_list|,
operator|(
name|DWORD
operator|)
name|len
argument_list|,
literal|0
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|win_crypto_Final
parameter_list|(
name|unsigned
name|char
modifier|*
name|buf
parameter_list|,
name|size_t
name|bufsize
parameter_list|,
name|Digest_CTX
modifier|*
name|ctx
parameter_list|)
block|{
name|DWORD
name|siglen
init|=
operator|(
name|DWORD
operator|)
name|bufsize
decl_stmt|;
if|if
condition|(
operator|!
name|ctx
operator|->
name|valid
condition|)
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
name|CryptGetHashParam
argument_list|(
name|ctx
operator|->
name|hash
argument_list|,
name|HP_HASHVAL
argument_list|,
name|buf
argument_list|,
operator|&
name|siglen
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|CryptDestroyHash
argument_list|(
name|ctx
operator|->
name|hash
argument_list|)
expr_stmt|;
name|CryptReleaseContext
argument_list|(
name|ctx
operator|->
name|cryptProv
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|ctx
operator|->
name|valid
operator|=
literal|0
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* defined(ARCHIVE_CRYPTO_*_WIN) */
end_comment

begin_comment
comment|/* MD5 implementations */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_MD5_LIBC
argument_list|)
end_if

begin_function
specifier|static
name|int
name|__archive_libc_md5init
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|MD5Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc_md5update
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|MD5Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc_md5final
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|MD5Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_MD5_LIBMD
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_libmd_md5init
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|MD5Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libmd_md5update
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|MD5Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libmd_md5final
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|MD5Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_MD5_LIBSYSTEM
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_libsystem_md5init
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|CC_MD5_Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libsystem_md5update
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|CC_MD5_Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libsystem_md5final
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|CC_MD5_Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_MD5_NETTLE
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_nettle_md5init
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|md5_init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_nettle_md5update
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|md5_update
argument_list|(
name|ctx
argument_list|,
name|insize
argument_list|,
name|indata
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_nettle_md5final
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|md5_digest
argument_list|(
name|ctx
argument_list|,
name|MD5_DIGEST_SIZE
argument_list|,
name|md
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_MD5_OPENSSL
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_openssl_md5init
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|EVP_DigestInit
argument_list|(
name|ctx
argument_list|,
name|EVP_md5
argument_list|()
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_openssl_md5update
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|EVP_DigestUpdate
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_openssl_md5final
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
comment|/* HACK: archive_write_set_format_xar.c is finalizing empty contexts, so    * this is meant to cope with that. Real fix is probably to fix    * archive_write_set_format_xar.c    */
if|if
condition|(
name|ctx
operator|->
name|digest
condition|)
name|EVP_DigestFinal
argument_list|(
name|ctx
argument_list|,
name|md
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_MD5_WIN
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_windowsapi_md5init
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|)
block|{
return|return
operator|(
name|win_crypto_init
argument_list|(
name|ctx
argument_list|,
name|CALG_MD5
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_windowsapi_md5update
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
return|return
operator|(
name|win_crypto_Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_windowsapi_md5final
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
return|return
operator|(
name|win_crypto_Final
argument_list|(
name|md
argument_list|,
literal|16
argument_list|,
name|ctx
argument_list|)
operator|)
return|;
block|}
end_function

begin_else
else|#
directive|else
end_else

begin_function
specifier|static
name|int
name|__archive_stub_md5init
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_stub_md5update
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|indata
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|insize
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_stub_md5final
parameter_list|(
name|archive_md5_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|md
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* RIPEMD160 implementations */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_RMD160_LIBC
argument_list|)
end_if

begin_function
specifier|static
name|int
name|__archive_libc_ripemd160init
parameter_list|(
name|archive_rmd160_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|RMD160Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc_ripemd160update
parameter_list|(
name|archive_rmd160_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|RMD160Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc_ripemd160final
parameter_list|(
name|archive_rmd160_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|RMD160Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_RMD160_LIBMD
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_libmd_ripemd160init
parameter_list|(
name|archive_rmd160_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|RIPEMD160_Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libmd_ripemd160update
parameter_list|(
name|archive_rmd160_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|RIPEMD160_Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libmd_ripemd160final
parameter_list|(
name|archive_rmd160_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|RIPEMD160_Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_RMD160_NETTLE
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_nettle_ripemd160init
parameter_list|(
name|archive_rmd160_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|ripemd160_init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_nettle_ripemd160update
parameter_list|(
name|archive_rmd160_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|ripemd160_update
argument_list|(
name|ctx
argument_list|,
name|insize
argument_list|,
name|indata
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_nettle_ripemd160final
parameter_list|(
name|archive_rmd160_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|ripemd160_digest
argument_list|(
name|ctx
argument_list|,
name|RIPEMD160_DIGEST_SIZE
argument_list|,
name|md
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_RMD160_OPENSSL
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_openssl_ripemd160init
parameter_list|(
name|archive_rmd160_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|EVP_DigestInit
argument_list|(
name|ctx
argument_list|,
name|EVP_ripemd160
argument_list|()
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_openssl_ripemd160update
parameter_list|(
name|archive_rmd160_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|EVP_DigestUpdate
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_openssl_ripemd160final
parameter_list|(
name|archive_rmd160_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|EVP_DigestFinal
argument_list|(
name|ctx
argument_list|,
name|md
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_else
else|#
directive|else
end_else

begin_function
specifier|static
name|int
name|__archive_stub_ripemd160init
parameter_list|(
name|archive_rmd160_ctx
modifier|*
name|ctx
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_stub_ripemd160update
parameter_list|(
name|archive_rmd160_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|indata
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|insize
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_stub_ripemd160final
parameter_list|(
name|archive_rmd160_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|md
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* SHA1 implementations */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA1_LIBC
argument_list|)
end_if

begin_function
specifier|static
name|int
name|__archive_libc_sha1init
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|SHA1Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc_sha1update
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|SHA1Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc_sha1final
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|SHA1Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA1_LIBMD
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_libmd_sha1init
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|SHA1_Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libmd_sha1update
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|SHA1_Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libmd_sha1final
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|SHA1_Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA1_LIBSYSTEM
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_libsystem_sha1init
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|CC_SHA1_Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libsystem_sha1update
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|CC_SHA1_Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libsystem_sha1final
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|CC_SHA1_Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA1_NETTLE
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_nettle_sha1init
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|sha1_init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_nettle_sha1update
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|sha1_update
argument_list|(
name|ctx
argument_list|,
name|insize
argument_list|,
name|indata
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_nettle_sha1final
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|sha1_digest
argument_list|(
name|ctx
argument_list|,
name|SHA1_DIGEST_SIZE
argument_list|,
name|md
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA1_OPENSSL
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_openssl_sha1init
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|EVP_DigestInit
argument_list|(
name|ctx
argument_list|,
name|EVP_sha1
argument_list|()
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_openssl_sha1update
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|EVP_DigestUpdate
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_openssl_sha1final
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
comment|/* HACK: archive_write_set_format_xar.c is finalizing empty contexts, so    * this is meant to cope with that. Real fix is probably to fix    * archive_write_set_format_xar.c    */
if|if
condition|(
name|ctx
operator|->
name|digest
condition|)
name|EVP_DigestFinal
argument_list|(
name|ctx
argument_list|,
name|md
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA1_WIN
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_windowsapi_sha1init
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|)
block|{
return|return
operator|(
name|win_crypto_init
argument_list|(
name|ctx
argument_list|,
name|CALG_SHA1
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_windowsapi_sha1update
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
return|return
operator|(
name|win_crypto_Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_windowsapi_sha1final
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
return|return
operator|(
name|win_crypto_Final
argument_list|(
name|md
argument_list|,
literal|20
argument_list|,
name|ctx
argument_list|)
operator|)
return|;
block|}
end_function

begin_else
else|#
directive|else
end_else

begin_function
specifier|static
name|int
name|__archive_stub_sha1init
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_stub_sha1update
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|indata
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|insize
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_stub_sha1final
parameter_list|(
name|archive_sha1_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|md
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* SHA256 implementations */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA256_LIBC
argument_list|)
end_if

begin_function
specifier|static
name|int
name|__archive_libc_sha256init
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|SHA256_Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc_sha256update
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|SHA256_Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc_sha256final
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|SHA256_Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA256_LIBC2
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_libc2_sha256init
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|SHA256Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc2_sha256update
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|SHA256Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc2_sha256final
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|SHA256Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA256_LIBC3
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_libc3_sha256init
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|SHA256Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc3_sha256update
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|SHA256Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc3_sha256final
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|SHA256Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA256_LIBMD
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_libmd_sha256init
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|SHA256_Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libmd_sha256update
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|SHA256_Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libmd_sha256final
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|SHA256_Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA256_LIBSYSTEM
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_libsystem_sha256init
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|CC_SHA256_Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libsystem_sha256update
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|CC_SHA256_Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libsystem_sha256final
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|CC_SHA256_Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA256_NETTLE
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_nettle_sha256init
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|sha256_init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_nettle_sha256update
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|sha256_update
argument_list|(
name|ctx
argument_list|,
name|insize
argument_list|,
name|indata
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_nettle_sha256final
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|sha256_digest
argument_list|(
name|ctx
argument_list|,
name|SHA256_DIGEST_SIZE
argument_list|,
name|md
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA256_OPENSSL
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_openssl_sha256init
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|EVP_DigestInit
argument_list|(
name|ctx
argument_list|,
name|EVP_sha256
argument_list|()
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_openssl_sha256update
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|EVP_DigestUpdate
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_openssl_sha256final
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|EVP_DigestFinal
argument_list|(
name|ctx
argument_list|,
name|md
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA256_WIN
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_windowsapi_sha256init
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|)
block|{
return|return
operator|(
name|win_crypto_init
argument_list|(
name|ctx
argument_list|,
name|CALG_SHA_256
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_windowsapi_sha256update
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
return|return
operator|(
name|win_crypto_Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_windowsapi_sha256final
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
return|return
operator|(
name|win_crypto_Final
argument_list|(
name|md
argument_list|,
literal|32
argument_list|,
name|ctx
argument_list|)
operator|)
return|;
block|}
end_function

begin_else
else|#
directive|else
end_else

begin_function
specifier|static
name|int
name|__archive_stub_sha256init
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_stub_sha256update
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|indata
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|insize
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_stub_sha256final
parameter_list|(
name|archive_sha256_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|md
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* SHA384 implementations */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA384_LIBC
argument_list|)
end_if

begin_function
specifier|static
name|int
name|__archive_libc_sha384init
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|SHA384_Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc_sha384update
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|SHA384_Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc_sha384final
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|SHA384_Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA384_LIBC2
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_libc2_sha384init
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|SHA384Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc2_sha384update
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|SHA384Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc2_sha384final
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|SHA384Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA384_LIBC3
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_libc3_sha384init
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|SHA384Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc3_sha384update
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|SHA384Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc3_sha384final
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|SHA384Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA384_LIBSYSTEM
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_libsystem_sha384init
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|CC_SHA384_Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libsystem_sha384update
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|CC_SHA384_Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libsystem_sha384final
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|CC_SHA384_Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA384_NETTLE
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_nettle_sha384init
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|sha384_init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_nettle_sha384update
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|sha384_update
argument_list|(
name|ctx
argument_list|,
name|insize
argument_list|,
name|indata
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_nettle_sha384final
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|sha384_digest
argument_list|(
name|ctx
argument_list|,
name|SHA384_DIGEST_SIZE
argument_list|,
name|md
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA384_OPENSSL
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_openssl_sha384init
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|EVP_DigestInit
argument_list|(
name|ctx
argument_list|,
name|EVP_sha384
argument_list|()
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_openssl_sha384update
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|EVP_DigestUpdate
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_openssl_sha384final
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|EVP_DigestFinal
argument_list|(
name|ctx
argument_list|,
name|md
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA384_WIN
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_windowsapi_sha384init
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|)
block|{
return|return
operator|(
name|win_crypto_init
argument_list|(
name|ctx
argument_list|,
name|CALG_SHA_384
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_windowsapi_sha384update
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
return|return
operator|(
name|win_crypto_Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_windowsapi_sha384final
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
return|return
operator|(
name|win_crypto_Final
argument_list|(
name|md
argument_list|,
literal|48
argument_list|,
name|ctx
argument_list|)
operator|)
return|;
block|}
end_function

begin_else
else|#
directive|else
end_else

begin_function
specifier|static
name|int
name|__archive_stub_sha384init
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_stub_sha384update
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|indata
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|insize
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_stub_sha384final
parameter_list|(
name|archive_sha384_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|md
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* SHA512 implementations */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA512_LIBC
argument_list|)
end_if

begin_function
specifier|static
name|int
name|__archive_libc_sha512init
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|SHA512_Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc_sha512update
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|SHA512_Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc_sha512final
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|SHA512_Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA512_LIBC2
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_libc2_sha512init
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|SHA512Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc2_sha512update
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|SHA512Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc2_sha512final
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|SHA512Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA512_LIBC3
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_libc3_sha512init
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|SHA512Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc3_sha512update
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|SHA512Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libc3_sha512final
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|SHA512Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA512_LIBMD
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_libmd_sha512init
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|SHA512_Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libmd_sha512update
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|SHA512_Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libmd_sha512final
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|SHA512_Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA512_LIBSYSTEM
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_libsystem_sha512init
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|CC_SHA512_Init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libsystem_sha512update
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|CC_SHA512_Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_libsystem_sha512final
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|CC_SHA512_Final
argument_list|(
name|md
argument_list|,
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA512_NETTLE
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_nettle_sha512init
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|sha512_init
argument_list|(
name|ctx
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_nettle_sha512update
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|sha512_update
argument_list|(
name|ctx
argument_list|,
name|insize
argument_list|,
name|indata
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_nettle_sha512final
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|sha512_digest
argument_list|(
name|ctx
argument_list|,
name|SHA512_DIGEST_SIZE
argument_list|,
name|md
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA512_OPENSSL
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_openssl_sha512init
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|)
block|{
name|EVP_DigestInit
argument_list|(
name|ctx
argument_list|,
name|EVP_sha512
argument_list|()
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_openssl_sha512update
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
name|EVP_DigestUpdate
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_openssl_sha512final
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
name|EVP_DigestFinal
argument_list|(
name|ctx
argument_list|,
name|md
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
return|return
operator|(
name|ARCHIVE_OK
operator|)
return|;
block|}
end_function

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA512_WIN
argument_list|)
end_elif

begin_function
specifier|static
name|int
name|__archive_windowsapi_sha512init
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|)
block|{
return|return
operator|(
name|win_crypto_init
argument_list|(
name|ctx
argument_list|,
name|CALG_SHA_512
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_windowsapi_sha512update
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
return|return
operator|(
name|win_crypto_Update
argument_list|(
name|ctx
argument_list|,
name|indata
argument_list|,
name|insize
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_windowsapi_sha512final
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
return|return
operator|(
name|win_crypto_Final
argument_list|(
name|md
argument_list|,
literal|64
argument_list|,
name|ctx
argument_list|)
operator|)
return|;
block|}
end_function

begin_else
else|#
directive|else
end_else

begin_function
specifier|static
name|int
name|__archive_stub_sha512init
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_stub_sha512update
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
specifier|const
name|void
modifier|*
name|indata
parameter_list|,
name|size_t
name|insize
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|indata
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|insize
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|__archive_stub_sha512final
parameter_list|(
name|archive_sha512_ctx
modifier|*
name|ctx
parameter_list|,
name|void
modifier|*
name|md
parameter_list|)
block|{
operator|(
name|void
operator|)
name|ctx
expr_stmt|;
comment|/* UNUSED */
operator|(
name|void
operator|)
name|md
expr_stmt|;
comment|/* UNUSED */
return|return
operator|(
name|ARCHIVE_FAILED
operator|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* NOTE: Crypto functions are set based on availability and by the following  * order of preference.  * 1. libc  * 2. libc2  * 3. libc3  * 4. libSystem  * 5. Nettle  * 6. OpenSSL  * 7. libmd  * 8. Windows API  */
end_comment

begin_decl_stmt
specifier|const
name|struct
name|archive_crypto
name|__archive_crypto
init|=
block|{
comment|/* MD5 */
if|#
directive|if
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_MD5_LIBC
argument_list|)
operator|&
name|__archive_libc_md5init
block|,
operator|&
name|__archive_libc_md5update
block|,
operator|&
name|__archive_libc_md5final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_MD5_LIBMD
argument_list|)
operator|&
name|__archive_libmd_md5init
block|,
operator|&
name|__archive_libmd_md5update
block|,
operator|&
name|__archive_libmd_md5final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_MD5_LIBSYSTEM
argument_list|)
operator|&
name|__archive_libsystem_md5init
block|,
operator|&
name|__archive_libsystem_md5update
block|,
operator|&
name|__archive_libsystem_md5final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_MD5_NETTLE
argument_list|)
operator|&
name|__archive_nettle_md5init
block|,
operator|&
name|__archive_nettle_md5update
block|,
operator|&
name|__archive_nettle_md5final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_MD5_OPENSSL
argument_list|)
operator|&
name|__archive_openssl_md5init
block|,
operator|&
name|__archive_openssl_md5update
block|,
operator|&
name|__archive_openssl_md5final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_MD5_WIN
argument_list|)
operator|&
name|__archive_windowsapi_md5init
block|,
operator|&
name|__archive_windowsapi_md5update
block|,
operator|&
name|__archive_windowsapi_md5final
block|,
elif|#
directive|elif
operator|!
name|defined
argument_list|(
name|ARCHIVE_MD5_COMPILE_TEST
argument_list|)
operator|&
name|__archive_stub_md5init
block|,
operator|&
name|__archive_stub_md5update
block|,
operator|&
name|__archive_stub_md5final
block|,
endif|#
directive|endif
comment|/* RIPEMD160 */
if|#
directive|if
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_RMD160_LIBC
argument_list|)
operator|&
name|__archive_libc_ripemd160init
block|,
operator|&
name|__archive_libc_ripemd160update
block|,
operator|&
name|__archive_libc_ripemd160final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_RMD160_LIBMD
argument_list|)
operator|&
name|__archive_libmd_ripemd160init
block|,
operator|&
name|__archive_libmd_ripemd160update
block|,
operator|&
name|__archive_libmd_ripemd160final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_RMD160_NETTLE
argument_list|)
operator|&
name|__archive_nettle_ripemd160init
block|,
operator|&
name|__archive_nettle_ripemd160update
block|,
operator|&
name|__archive_nettle_ripemd160final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_RMD160_OPENSSL
argument_list|)
operator|&
name|__archive_openssl_ripemd160init
block|,
operator|&
name|__archive_openssl_ripemd160update
block|,
operator|&
name|__archive_openssl_ripemd160final
block|,
elif|#
directive|elif
operator|!
name|defined
argument_list|(
name|ARCHIVE_RMD160_COMPILE_TEST
argument_list|)
operator|&
name|__archive_stub_ripemd160init
block|,
operator|&
name|__archive_stub_ripemd160update
block|,
operator|&
name|__archive_stub_ripemd160final
block|,
endif|#
directive|endif
comment|/* SHA1 */
if|#
directive|if
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA1_LIBC
argument_list|)
operator|&
name|__archive_libc_sha1init
block|,
operator|&
name|__archive_libc_sha1update
block|,
operator|&
name|__archive_libc_sha1final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA1_LIBMD
argument_list|)
operator|&
name|__archive_libmd_sha1init
block|,
operator|&
name|__archive_libmd_sha1update
block|,
operator|&
name|__archive_libmd_sha1final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA1_LIBSYSTEM
argument_list|)
operator|&
name|__archive_libsystem_sha1init
block|,
operator|&
name|__archive_libsystem_sha1update
block|,
operator|&
name|__archive_libsystem_sha1final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA1_NETTLE
argument_list|)
operator|&
name|__archive_nettle_sha1init
block|,
operator|&
name|__archive_nettle_sha1update
block|,
operator|&
name|__archive_nettle_sha1final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA1_OPENSSL
argument_list|)
operator|&
name|__archive_openssl_sha1init
block|,
operator|&
name|__archive_openssl_sha1update
block|,
operator|&
name|__archive_openssl_sha1final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA1_WIN
argument_list|)
operator|&
name|__archive_windowsapi_sha1init
block|,
operator|&
name|__archive_windowsapi_sha1update
block|,
operator|&
name|__archive_windowsapi_sha1final
block|,
elif|#
directive|elif
operator|!
name|defined
argument_list|(
name|ARCHIVE_SHA1_COMPILE_TEST
argument_list|)
operator|&
name|__archive_stub_sha1init
block|,
operator|&
name|__archive_stub_sha1update
block|,
operator|&
name|__archive_stub_sha1final
block|,
endif|#
directive|endif
comment|/* SHA256 */
if|#
directive|if
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA256_LIBC
argument_list|)
operator|&
name|__archive_libc_sha256init
block|,
operator|&
name|__archive_libc_sha256update
block|,
operator|&
name|__archive_libc_sha256final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA256_LIBC2
argument_list|)
operator|&
name|__archive_libc2_sha256init
block|,
operator|&
name|__archive_libc2_sha256update
block|,
operator|&
name|__archive_libc2_sha256final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA256_LIBC3
argument_list|)
operator|&
name|__archive_libc3_sha256init
block|,
operator|&
name|__archive_libc3_sha256update
block|,
operator|&
name|__archive_libc3_sha256final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA256_LIBMD
argument_list|)
operator|&
name|__archive_libmd_sha256init
block|,
operator|&
name|__archive_libmd_sha256update
block|,
operator|&
name|__archive_libmd_sha256final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA256_LIBSYSTEM
argument_list|)
operator|&
name|__archive_libsystem_sha256init
block|,
operator|&
name|__archive_libsystem_sha256update
block|,
operator|&
name|__archive_libsystem_sha256final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA256_NETTLE
argument_list|)
operator|&
name|__archive_nettle_sha256init
block|,
operator|&
name|__archive_nettle_sha256update
block|,
operator|&
name|__archive_nettle_sha256final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA256_OPENSSL
argument_list|)
operator|&
name|__archive_openssl_sha256init
block|,
operator|&
name|__archive_openssl_sha256update
block|,
operator|&
name|__archive_openssl_sha256final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA256_WIN
argument_list|)
operator|&
name|__archive_windowsapi_sha256init
block|,
operator|&
name|__archive_windowsapi_sha256update
block|,
operator|&
name|__archive_windowsapi_sha256final
block|,
elif|#
directive|elif
operator|!
name|defined
argument_list|(
name|ARCHIVE_SHA256_COMPILE_TEST
argument_list|)
operator|&
name|__archive_stub_sha256init
block|,
operator|&
name|__archive_stub_sha256update
block|,
operator|&
name|__archive_stub_sha256final
block|,
endif|#
directive|endif
comment|/* SHA384 */
if|#
directive|if
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA384_LIBC
argument_list|)
operator|&
name|__archive_libc_sha384init
block|,
operator|&
name|__archive_libc_sha384update
block|,
operator|&
name|__archive_libc_sha384final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA384_LIBC2
argument_list|)
operator|&
name|__archive_libc2_sha384init
block|,
operator|&
name|__archive_libc2_sha384update
block|,
operator|&
name|__archive_libc2_sha384final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA384_LIBC3
argument_list|)
operator|&
name|__archive_libc3_sha384init
block|,
operator|&
name|__archive_libc3_sha384update
block|,
operator|&
name|__archive_libc3_sha384final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA384_LIBSYSTEM
argument_list|)
operator|&
name|__archive_libsystem_sha384init
block|,
operator|&
name|__archive_libsystem_sha384update
block|,
operator|&
name|__archive_libsystem_sha384final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA384_NETTLE
argument_list|)
operator|&
name|__archive_nettle_sha384init
block|,
operator|&
name|__archive_nettle_sha384update
block|,
operator|&
name|__archive_nettle_sha384final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA384_OPENSSL
argument_list|)
operator|&
name|__archive_openssl_sha384init
block|,
operator|&
name|__archive_openssl_sha384update
block|,
operator|&
name|__archive_openssl_sha384final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA384_WIN
argument_list|)
operator|&
name|__archive_windowsapi_sha384init
block|,
operator|&
name|__archive_windowsapi_sha384update
block|,
operator|&
name|__archive_windowsapi_sha384final
block|,
elif|#
directive|elif
operator|!
name|defined
argument_list|(
name|ARCHIVE_SHA384_COMPILE_TEST
argument_list|)
operator|&
name|__archive_stub_sha384init
block|,
operator|&
name|__archive_stub_sha384update
block|,
operator|&
name|__archive_stub_sha384final
block|,
endif|#
directive|endif
comment|/* SHA512 */
if|#
directive|if
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA512_LIBC
argument_list|)
operator|&
name|__archive_libc_sha512init
block|,
operator|&
name|__archive_libc_sha512update
block|,
operator|&
name|__archive_libc_sha512final
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA512_LIBC2
argument_list|)
operator|&
name|__archive_libc2_sha512init
block|,
operator|&
name|__archive_libc2_sha512update
block|,
operator|&
name|__archive_libc2_sha512final
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA512_LIBC3
argument_list|)
operator|&
name|__archive_libc3_sha512init
block|,
operator|&
name|__archive_libc3_sha512update
block|,
operator|&
name|__archive_libc3_sha512final
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA512_LIBMD
argument_list|)
operator|&
name|__archive_libmd_sha512init
block|,
operator|&
name|__archive_libmd_sha512update
block|,
operator|&
name|__archive_libmd_sha512final
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA512_LIBSYSTEM
argument_list|)
operator|&
name|__archive_libsystem_sha512init
block|,
operator|&
name|__archive_libsystem_sha512update
block|,
operator|&
name|__archive_libsystem_sha512final
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA512_NETTLE
argument_list|)
operator|&
name|__archive_nettle_sha512init
block|,
operator|&
name|__archive_nettle_sha512update
block|,
operator|&
name|__archive_nettle_sha512final
block|,
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA512_OPENSSL
argument_list|)
operator|&
name|__archive_openssl_sha512init
block|,
operator|&
name|__archive_openssl_sha512update
block|,
operator|&
name|__archive_openssl_sha512final
elif|#
directive|elif
name|defined
argument_list|(
name|ARCHIVE_CRYPTO_SHA512_WIN
argument_list|)
operator|&
name|__archive_windowsapi_sha512init
block|,
operator|&
name|__archive_windowsapi_sha512update
block|,
operator|&
name|__archive_windowsapi_sha512final
elif|#
directive|elif
operator|!
name|defined
argument_list|(
name|ARCHIVE_SHA512_COMPILE_TEST
argument_list|)
operator|&
name|__archive_stub_sha512init
block|,
operator|&
name|__archive_stub_sha512update
block|,
operator|&
name|__archive_stub_sha512final
endif|#
directive|endif
block|}
decl_stmt|;
end_decl_stmt

end_unit

