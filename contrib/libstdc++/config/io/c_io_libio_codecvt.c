begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* Copyright (C) 2000 Free Software Foundation, Inc.    This file is part of the GNU IO Library.     This library is free software; you can redistribute it and/or    modify it under the terms of the GNU General Public License as    published by the Free Software Foundation; either version 2, or (at    your option) any later version.     This library is distributed in the hope that it will be useful, but    WITHOUT ANY WARRANTY; without even the implied warranty of    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU    General Public License for more details.     You should have received a copy of the GNU General Public License    along with this library; see the file COPYING.  If not, write to    the Free Software Foundation, 59 Temple Place - Suite 330, Boston,    MA 02111-1307, USA.     As a special exception, if you link this library with files    compiled with a GNU compiler to produce an executable, this does    not cause the resulting executable to be covered by the GNU General    Public License.  This exception does not however invalidate any    other reasons why the executable file might be covered by the GNU    General Public License.  */
end_comment

begin_comment
comment|/* Slightly modified from glibc/libio/iofwide.c */
end_comment

begin_include
include|#
directive|include
file|<libio.h>
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|_GLIBCPP_USE_WCHAR_T
end_ifdef

begin_comment
comment|/* Prototypes of libio's codecvt functions.  */
end_comment

begin_function_decl
specifier|static
name|enum
name|__codecvt_result
name|do_out
parameter_list|(
name|struct
name|_IO_codecvt
modifier|*
name|codecvt
parameter_list|,
name|__c_mbstate_t
modifier|*
name|statep
parameter_list|,
specifier|const
name|wchar_t
modifier|*
name|from_start
parameter_list|,
specifier|const
name|wchar_t
modifier|*
name|from_end
parameter_list|,
specifier|const
name|wchar_t
modifier|*
modifier|*
name|from_stop
parameter_list|,
name|char
modifier|*
name|to_start
parameter_list|,
name|char
modifier|*
name|to_end
parameter_list|,
name|char
modifier|*
modifier|*
name|to_stop
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|enum
name|__codecvt_result
name|do_unshift
parameter_list|(
name|struct
name|_IO_codecvt
modifier|*
name|codecvt
parameter_list|,
name|__c_mbstate_t
modifier|*
name|statep
parameter_list|,
name|char
modifier|*
name|to_start
parameter_list|,
name|char
modifier|*
name|to_end
parameter_list|,
name|char
modifier|*
modifier|*
name|to_stop
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|enum
name|__codecvt_result
name|do_in
parameter_list|(
name|struct
name|_IO_codecvt
modifier|*
name|codecvt
parameter_list|,
name|__c_mbstate_t
modifier|*
name|statep
parameter_list|,
specifier|const
name|char
modifier|*
name|from_start
parameter_list|,
specifier|const
name|char
modifier|*
name|from_end
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|from_stop
parameter_list|,
name|wchar_t
modifier|*
name|to_start
parameter_list|,
name|wchar_t
modifier|*
name|to_end
parameter_list|,
name|wchar_t
modifier|*
modifier|*
name|to_stop
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|do_encoding
parameter_list|(
name|struct
name|_IO_codecvt
modifier|*
name|codecvt
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|do_length
parameter_list|(
name|struct
name|_IO_codecvt
modifier|*
name|codecvt
parameter_list|,
name|__c_mbstate_t
modifier|*
name|statep
parameter_list|,
specifier|const
name|char
modifier|*
name|from_start
parameter_list|,
specifier|const
name|char
modifier|*
name|from_end
parameter_list|,
name|_IO_size_t
name|max
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|do_max_length
parameter_list|(
name|struct
name|_IO_codecvt
modifier|*
name|codecvt
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|do_always_noconv
parameter_list|(
name|struct
name|_IO_codecvt
modifier|*
name|codecvt
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* The functions used in `codecvt' for libio are always the same.  */
end_comment

begin_decl_stmt
name|struct
name|_IO_codecvt
name|__c_libio_codecvt
init|=
block|{
operator|.
name|__codecvt_destr
operator|=
name|NULL
block|,
comment|/* Destructor, never used.  */
operator|.
name|__codecvt_do_out
operator|=
name|do_out
block|,
operator|.
name|__codecvt_do_unshift
operator|=
name|do_unshift
block|,
operator|.
name|__codecvt_do_in
operator|=
name|do_in
block|,
operator|.
name|__codecvt_do_encoding
operator|=
name|do_encoding
block|,
operator|.
name|__codecvt_do_always_noconv
operator|=
name|do_always_noconv
block|,
operator|.
name|__codecvt_do_length
operator|=
name|do_length
block|,
operator|.
name|__codecvt_do_max_length
operator|=
name|do_max_length
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|enum
name|__codecvt_result
name|do_out
parameter_list|(
name|struct
name|_IO_codecvt
modifier|*
name|codecvt
parameter_list|,
name|__c_mbstate_t
modifier|*
name|statep
parameter_list|,
specifier|const
name|wchar_t
modifier|*
name|from_start
parameter_list|,
specifier|const
name|wchar_t
modifier|*
name|from_end
parameter_list|,
specifier|const
name|wchar_t
modifier|*
modifier|*
name|from_stop
parameter_list|,
name|char
modifier|*
name|to_start
parameter_list|,
name|char
modifier|*
name|to_end
parameter_list|,
name|char
modifier|*
modifier|*
name|to_stop
parameter_list|)
block|{
name|enum
name|__codecvt_result
name|res
init|=
name|__codecvt_ok
decl_stmt|;
while|while
condition|(
name|from_start
operator|<
name|from_end
condition|)
block|{
if|if
condition|(
name|to_start
operator|>=
name|to_end
condition|)
block|{
name|res
operator|=
name|__codecvt_partial
expr_stmt|;
break|break;
block|}
operator|*
name|to_start
operator|++
operator|=
operator|(
name|char
operator|)
operator|*
name|from_start
operator|++
expr_stmt|;
block|}
operator|*
name|from_stop
operator|=
name|from_start
expr_stmt|;
operator|*
name|to_stop
operator|=
name|to_start
expr_stmt|;
return|return
name|res
return|;
block|}
end_function

begin_function
specifier|static
name|enum
name|__codecvt_result
name|do_unshift
parameter_list|(
name|struct
name|_IO_codecvt
modifier|*
name|codecvt
parameter_list|,
name|__c_mbstate_t
modifier|*
name|statep
parameter_list|,
name|char
modifier|*
name|to_start
parameter_list|,
name|char
modifier|*
name|to_end
parameter_list|,
name|char
modifier|*
modifier|*
name|to_stop
parameter_list|)
block|{
operator|*
name|to_stop
operator|=
name|to_start
expr_stmt|;
return|return
name|__codecvt_ok
return|;
block|}
end_function

begin_function
specifier|static
name|enum
name|__codecvt_result
name|do_in
parameter_list|(
name|struct
name|_IO_codecvt
modifier|*
name|codecvt
parameter_list|,
name|__c_mbstate_t
modifier|*
name|statep
parameter_list|,
specifier|const
name|char
modifier|*
name|from_start
parameter_list|,
specifier|const
name|char
modifier|*
name|from_end
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|from_stop
parameter_list|,
name|wchar_t
modifier|*
name|to_start
parameter_list|,
name|wchar_t
modifier|*
name|to_end
parameter_list|,
name|wchar_t
modifier|*
modifier|*
name|to_stop
parameter_list|)
block|{
name|enum
name|__codecvt_result
name|res
init|=
name|__codecvt_ok
decl_stmt|;
while|while
condition|(
name|from_start
operator|<
name|from_end
condition|)
block|{
if|if
condition|(
name|to_start
operator|>=
name|to_end
condition|)
block|{
name|res
operator|=
name|__codecvt_partial
expr_stmt|;
break|break;
block|}
operator|*
name|to_start
operator|++
operator|=
operator|(
name|wchar_t
operator|)
operator|*
name|from_start
operator|++
expr_stmt|;
block|}
operator|*
name|from_stop
operator|=
name|from_start
expr_stmt|;
operator|*
name|to_stop
operator|=
name|to_start
expr_stmt|;
return|return
name|res
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|do_encoding
parameter_list|(
name|struct
name|_IO_codecvt
modifier|*
name|codecvt
parameter_list|)
block|{
return|return
literal|1
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|do_always_noconv
parameter_list|(
name|struct
name|_IO_codecvt
modifier|*
name|codecvt
parameter_list|)
block|{
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|do_length
parameter_list|(
name|struct
name|_IO_codecvt
modifier|*
name|codecvt
parameter_list|,
name|__c_mbstate_t
modifier|*
name|statep
parameter_list|,
specifier|const
name|char
modifier|*
name|from_start
parameter_list|,
specifier|const
name|char
modifier|*
name|from_end
parameter_list|,
name|_IO_size_t
name|max
parameter_list|)
block|{
return|return
name|from_end
operator|-
name|from_start
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|do_max_length
parameter_list|(
name|struct
name|_IO_codecvt
modifier|*
name|codecvt
parameter_list|)
block|{
return|return
literal|1
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* _GLIBCPP_USE_WCHAR_T */
end_comment

end_unit

