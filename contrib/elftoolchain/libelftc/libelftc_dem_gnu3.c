begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2007 Hyogeol Lee<hyogeollee@gmail.com>  * Copyright (c) 2015-2017 Kai Wang<kaiwang27@gmail.com>  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer  *    in this position and unchanged.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHORS ``AS IS'' AND ANY EXPRESS OR  * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES  * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,  * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT  * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,  * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY  * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF  * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  */
end_comment

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|<assert.h>
end_include

begin_include
include|#
directive|include
file|<ctype.h>
end_include

begin_include
include|#
directive|include
file|<errno.h>
end_include

begin_include
include|#
directive|include
file|<libelftc.h>
end_include

begin_include
include|#
directive|include
file|<limits.h>
end_include

begin_include
include|#
directive|include
file|<stdbool.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|"_libelftc.h"
end_include

begin_expr_stmt
name|ELFTC_VCSID
argument_list|(
literal|"$Id: libelftc_dem_gnu3.c 3560 2017-06-25 00:28:23Z kaiwang27 $"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_comment
comment|/**  * @file cpp_demangle.c  * @brief Decode IA-64 C++ ABI style implementation.  *  * IA-64 standard ABI(Itanium C++ ABI) references.  *  * http://www.codesourcery.com/cxx-abi/abi.html#mangling \n  * http://www.codesourcery.com/cxx-abi/abi-mangling.html  */
end_comment

begin_enum
enum|enum
name|type_qualifier
block|{
name|TYPE_PTR
block|,
name|TYPE_REF
block|,
name|TYPE_CMX
block|,
name|TYPE_IMG
block|,
name|TYPE_EXT
block|,
name|TYPE_RST
block|,
name|TYPE_VAT
block|,
name|TYPE_CST
block|,
name|TYPE_VEC
block|,
name|TYPE_RREF
block|}
enum|;
end_enum

begin_struct
struct|struct
name|vector_type_qualifier
block|{
name|size_t
name|size
decl_stmt|,
name|capacity
decl_stmt|;
name|enum
name|type_qualifier
modifier|*
name|q_container
decl_stmt|;
name|struct
name|vector_str
name|ext_name
decl_stmt|;
block|}
struct|;
end_struct

begin_enum
enum|enum
name|read_cmd
block|{
name|READ_FAIL
block|,
name|READ_NEST
block|,
name|READ_TMPL
block|,
name|READ_EXPR
block|,
name|READ_EXPL
block|,
name|READ_LOCAL
block|,
name|READ_TYPE
block|,
name|READ_FUNC
block|,
name|READ_PTRMEM
block|}
enum|;
end_enum

begin_struct
struct|struct
name|read_cmd_item
block|{
name|enum
name|read_cmd
name|cmd
decl_stmt|;
name|void
modifier|*
name|data
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|vector_read_cmd
block|{
name|size_t
name|size
decl_stmt|,
name|capacity
decl_stmt|;
name|struct
name|read_cmd_item
modifier|*
name|r_container
decl_stmt|;
block|}
struct|;
end_struct

begin_enum
enum|enum
name|push_qualifier
block|{
name|PUSH_ALL_QUALIFIER
block|,
name|PUSH_CV_QUALIFIER
block|,
name|PUSH_NON_CV_QUALIFIER
block|, }
enum|;
end_enum

begin_struct
struct|struct
name|cpp_demangle_data
block|{
name|struct
name|vector_str
name|output
decl_stmt|;
comment|/* output string vector */
name|struct
name|vector_str
name|subst
decl_stmt|;
comment|/* substitution string vector */
name|struct
name|vector_str
name|tmpl
decl_stmt|;
name|struct
name|vector_str
name|class_type
decl_stmt|;
name|struct
name|vector_str
modifier|*
name|cur_output
decl_stmt|;
comment|/* ptr to current output vec */
name|struct
name|vector_read_cmd
name|cmd
decl_stmt|;
name|bool
name|mem_rst
decl_stmt|;
comment|/* restrict member function */
name|bool
name|mem_vat
decl_stmt|;
comment|/* volatile member function */
name|bool
name|mem_cst
decl_stmt|;
comment|/* const member function */
name|bool
name|mem_ref
decl_stmt|;
comment|/* lvalue-ref member func */
name|bool
name|mem_rref
decl_stmt|;
comment|/* rvalue-ref member func */
name|bool
name|is_tmpl
decl_stmt|;
comment|/* template args */
name|bool
name|is_functype
decl_stmt|;
comment|/* function type */
name|bool
name|ref_qualifier
decl_stmt|;
comment|/* ref qualifier */
name|enum
name|type_qualifier
name|ref_qualifier_type
decl_stmt|;
comment|/* ref qualifier type */
name|enum
name|push_qualifier
name|push_qualifier
decl_stmt|;
comment|/* which qualifiers to push */
name|int
name|func_type
decl_stmt|;
specifier|const
name|char
modifier|*
name|cur
decl_stmt|;
comment|/* current mangled name ptr */
specifier|const
name|char
modifier|*
name|last_sname
decl_stmt|;
comment|/* last source name */
block|}
struct|;
end_struct

begin_struct
struct|struct
name|type_delimit
block|{
name|bool
name|paren
decl_stmt|;
name|bool
name|firstp
decl_stmt|;
block|}
struct|;
end_struct

begin_define
define|#
directive|define
name|CPP_DEMANGLE_TRY_LIMIT
value|128
end_define

begin_define
define|#
directive|define
name|FLOAT_SPRINTF_TRY_LIMIT
value|5
end_define

begin_define
define|#
directive|define
name|FLOAT_QUADRUPLE_BYTES
value|16
end_define

begin_define
define|#
directive|define
name|FLOAT_EXTENED_BYTES
value|10
end_define

begin_define
define|#
directive|define
name|SIMPLE_HASH
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|)
value|(64 * x + y)
end_define

begin_define
define|#
directive|define
name|DEM_PUSH_STR
parameter_list|(
name|d
parameter_list|,
name|s
parameter_list|)
value|cpp_demangle_push_str((d), (s), strlen((s)))
end_define

begin_define
define|#
directive|define
name|VEC_PUSH_STR
parameter_list|(
name|d
parameter_list|,
name|s
parameter_list|)
value|vector_str_push((d), (s), strlen((s)))
end_define

begin_function_decl
specifier|static
name|void
name|cpp_demangle_data_dest
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_data_init
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_get_subst
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_get_tmpl_param
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_push_fp
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
name|char
modifier|*
function_decl|(
modifier|*
function_decl|)
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_push_str
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_pop_str
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_push_subst
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_push_subst_v
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
name|struct
name|vector_str
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_push_type_qualifier
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
name|struct
name|vector_type_qualifier
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_array
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_encoding
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_expr_primary
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_expression
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_expression_flat
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
name|char
modifier|*
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_expression_binary
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_expression_unary
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_expression_trinary
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_function
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
name|int
modifier|*
parameter_list|,
name|struct
name|vector_type_qualifier
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_local_source_name
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_local_name
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_name
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_name_flat
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
name|char
modifier|*
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_nested_name
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_number
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
name|long
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_number_as_string
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
name|char
modifier|*
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_nv_offset
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_offset
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_offset_number
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_pointer_to_member
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
name|struct
name|vector_type_qualifier
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_sname
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_subst
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_subst_std
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_subst_stdtmpl
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_tmpl_arg
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_tmpl_args
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_tmpl_param
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_type
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
name|struct
name|type_delimit
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_type_flat
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|,
name|char
modifier|*
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_uqname
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|cpp_demangle_read_v_offset
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|char
modifier|*
name|decode_fp_to_double
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|char
modifier|*
name|decode_fp_to_float
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|char
modifier|*
name|decode_fp_to_float128
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|char
modifier|*
name|decode_fp_to_float80
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|char
modifier|*
name|decode_fp_to_long_double
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|hex_to_dec
parameter_list|(
name|char
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|vector_read_cmd_dest
parameter_list|(
name|struct
name|vector_read_cmd
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|struct
name|read_cmd_item
modifier|*
name|vector_read_cmd_find
parameter_list|(
name|struct
name|vector_read_cmd
modifier|*
parameter_list|,
name|enum
name|read_cmd
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|vector_read_cmd_init
parameter_list|(
name|struct
name|vector_read_cmd
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|vector_read_cmd_pop
parameter_list|(
name|struct
name|vector_read_cmd
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|vector_read_cmd_push
parameter_list|(
name|struct
name|vector_read_cmd
modifier|*
parameter_list|,
name|enum
name|read_cmd
parameter_list|,
name|void
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|vector_type_qualifier_dest
parameter_list|(
name|struct
name|vector_type_qualifier
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|vector_type_qualifier_init
parameter_list|(
name|struct
name|vector_type_qualifier
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|vector_type_qualifier_push
parameter_list|(
name|struct
name|vector_type_qualifier
modifier|*
parameter_list|,
name|enum
name|type_qualifier
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/**  * @brief Decode the input string by IA-64 C++ ABI style.  *  * GNU GCC v3 use IA-64 standard ABI.  * @return New allocated demangled string or NULL if failed.  * @todo 1. Testing and more test case. 2. Code cleaning.  */
end_comment

begin_function
name|char
modifier|*
name|cpp_demangle_gnu3
parameter_list|(
specifier|const
name|char
modifier|*
name|org
parameter_list|)
block|{
name|struct
name|cpp_demangle_data
name|ddata
decl_stmt|;
name|struct
name|vector_str
name|ret_type
decl_stmt|;
name|struct
name|type_delimit
name|td
decl_stmt|;
name|ssize_t
name|org_len
decl_stmt|;
name|unsigned
name|int
name|limit
decl_stmt|;
name|char
modifier|*
name|rtn
decl_stmt|;
name|bool
name|has_ret
decl_stmt|,
name|more_type
decl_stmt|;
if|if
condition|(
name|org
operator|==
name|NULL
operator|||
operator|(
name|org_len
operator|=
name|strlen
argument_list|(
name|org
argument_list|)
operator|)
operator|<
literal|2
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
if|if
condition|(
name|org_len
operator|>
literal|11
operator|&&
operator|!
name|strncmp
argument_list|(
name|org
argument_list|,
literal|"_GLOBAL__I_"
argument_list|,
literal|11
argument_list|)
condition|)
block|{
if|if
condition|(
operator|(
name|rtn
operator|=
name|malloc
argument_list|(
name|org_len
operator|+
literal|19
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
name|snprintf
argument_list|(
name|rtn
argument_list|,
name|org_len
operator|+
literal|19
argument_list|,
literal|"global constructors keyed to %s"
argument_list|,
name|org
operator|+
literal|11
argument_list|)
expr_stmt|;
return|return
operator|(
name|rtn
operator|)
return|;
block|}
if|if
condition|(
name|org
index|[
literal|0
index|]
operator|!=
literal|'_'
operator|||
name|org
index|[
literal|1
index|]
operator|!=
literal|'Z'
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_data_init
argument_list|(
operator|&
name|ddata
argument_list|,
name|org
operator|+
literal|2
argument_list|)
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
name|rtn
operator|=
name|NULL
expr_stmt|;
name|has_ret
operator|=
name|more_type
operator|=
name|false
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_encoding
argument_list|(
operator|&
name|ddata
argument_list|)
condition|)
goto|goto
name|clean
goto|;
comment|/* 	 * Pop function name from substitution candidate list. 	 */
if|if
condition|(
operator|*
name|ddata
operator|.
name|cur
operator|!=
literal|0
operator|&&
name|ddata
operator|.
name|subst
operator|.
name|size
operator|>=
literal|1
condition|)
block|{
if|if
condition|(
operator|!
name|vector_str_pop
argument_list|(
operator|&
name|ddata
operator|.
name|subst
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
name|td
operator|.
name|paren
operator|=
name|false
expr_stmt|;
name|td
operator|.
name|firstp
operator|=
name|true
expr_stmt|;
name|limit
operator|=
literal|0
expr_stmt|;
comment|/* 	 * The first type is a return type if we just demangled template 	 * args. (the template args is right next to the function name, 	 * which means it's a template function) 	 */
if|if
condition|(
name|ddata
operator|.
name|is_tmpl
condition|)
block|{
name|ddata
operator|.
name|is_tmpl
operator|=
name|false
expr_stmt|;
if|if
condition|(
operator|!
name|vector_str_init
argument_list|(
operator|&
name|ret_type
argument_list|)
condition|)
goto|goto
name|clean
goto|;
name|ddata
operator|.
name|cur_output
operator|=
operator|&
name|ret_type
expr_stmt|;
name|has_ret
operator|=
name|true
expr_stmt|;
block|}
while|while
condition|(
operator|*
name|ddata
operator|.
name|cur
operator|!=
literal|'\0'
condition|)
block|{
comment|/* 		 * Breaking at some gcc info at tail. e.g) @@GLIBCXX_3.4 		 */
if|if
condition|(
operator|*
name|ddata
operator|.
name|cur
operator|==
literal|'@'
operator|&&
operator|*
operator|(
name|ddata
operator|.
name|cur
operator|+
literal|1
operator|)
operator|==
literal|'@'
condition|)
break|break;
if|if
condition|(
name|has_ret
condition|)
block|{
comment|/* Read return type */
if|if
condition|(
operator|!
name|cpp_demangle_read_type
argument_list|(
operator|&
name|ddata
argument_list|,
name|NULL
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
else|else
block|{
comment|/* Read function arg type */
if|if
condition|(
operator|!
name|cpp_demangle_read_type
argument_list|(
operator|&
name|ddata
argument_list|,
operator|&
name|td
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
if|if
condition|(
name|has_ret
condition|)
block|{
comment|/* Push return type to the beginning */
if|if
condition|(
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|ret_type
argument_list|,
literal|" "
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|vector_str_push_vector_head
argument_list|(
operator|&
name|ddata
operator|.
name|output
argument_list|,
operator|&
name|ret_type
argument_list|)
condition|)
goto|goto
name|clean
goto|;
name|ddata
operator|.
name|cur_output
operator|=
operator|&
name|ddata
operator|.
name|output
expr_stmt|;
name|vector_str_dest
argument_list|(
operator|&
name|ret_type
argument_list|)
expr_stmt|;
name|has_ret
operator|=
name|false
expr_stmt|;
name|more_type
operator|=
name|true
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|more_type
condition|)
name|more_type
operator|=
name|false
expr_stmt|;
if|if
condition|(
name|limit
operator|++
operator|>
name|CPP_DEMANGLE_TRY_LIMIT
condition|)
goto|goto
name|clean
goto|;
block|}
if|if
condition|(
name|more_type
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|ddata
operator|.
name|output
operator|.
name|size
operator|==
literal|0
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|td
operator|.
name|paren
operator|&&
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|ddata
operator|.
name|output
argument_list|,
literal|")"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|ddata
operator|.
name|mem_vat
operator|&&
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|ddata
operator|.
name|output
argument_list|,
literal|" volatile"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|ddata
operator|.
name|mem_cst
operator|&&
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|ddata
operator|.
name|output
argument_list|,
literal|" const"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|ddata
operator|.
name|mem_rst
operator|&&
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|ddata
operator|.
name|output
argument_list|,
literal|" restrict"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|ddata
operator|.
name|mem_ref
operator|&&
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|ddata
operator|.
name|output
argument_list|,
literal|"&"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|ddata
operator|.
name|mem_rref
operator|&&
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|ddata
operator|.
name|output
argument_list|,
literal|"&&"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
name|rtn
operator|=
name|vector_str_get_flat
argument_list|(
operator|&
name|ddata
operator|.
name|output
argument_list|,
operator|(
name|size_t
operator|*
operator|)
name|NULL
argument_list|)
expr_stmt|;
name|clean
label|:
if|if
condition|(
name|has_ret
condition|)
name|vector_str_dest
argument_list|(
operator|&
name|ret_type
argument_list|)
expr_stmt|;
name|cpp_demangle_data_dest
argument_list|(
operator|&
name|ddata
argument_list|)
expr_stmt|;
return|return
operator|(
name|rtn
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|cpp_demangle_data_dest
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|d
parameter_list|)
block|{
if|if
condition|(
name|d
operator|==
name|NULL
condition|)
return|return;
name|vector_read_cmd_dest
argument_list|(
operator|&
name|d
operator|->
name|cmd
argument_list|)
expr_stmt|;
name|vector_str_dest
argument_list|(
operator|&
name|d
operator|->
name|class_type
argument_list|)
expr_stmt|;
name|vector_str_dest
argument_list|(
operator|&
name|d
operator|->
name|tmpl
argument_list|)
expr_stmt|;
name|vector_str_dest
argument_list|(
operator|&
name|d
operator|->
name|subst
argument_list|)
expr_stmt|;
name|vector_str_dest
argument_list|(
operator|&
name|d
operator|->
name|output
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_data_init
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|d
parameter_list|,
specifier|const
name|char
modifier|*
name|cur
parameter_list|)
block|{
if|if
condition|(
name|d
operator|==
name|NULL
operator|||
name|cur
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|vector_str_init
argument_list|(
operator|&
name|d
operator|->
name|output
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|vector_str_init
argument_list|(
operator|&
name|d
operator|->
name|subst
argument_list|)
condition|)
goto|goto
name|clean1
goto|;
if|if
condition|(
operator|!
name|vector_str_init
argument_list|(
operator|&
name|d
operator|->
name|tmpl
argument_list|)
condition|)
goto|goto
name|clean2
goto|;
if|if
condition|(
operator|!
name|vector_str_init
argument_list|(
operator|&
name|d
operator|->
name|class_type
argument_list|)
condition|)
goto|goto
name|clean3
goto|;
if|if
condition|(
operator|!
name|vector_read_cmd_init
argument_list|(
operator|&
name|d
operator|->
name|cmd
argument_list|)
condition|)
goto|goto
name|clean4
goto|;
name|assert
argument_list|(
name|d
operator|->
name|output
operator|.
name|container
operator|!=
name|NULL
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|->
name|subst
operator|.
name|container
operator|!=
name|NULL
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|->
name|tmpl
operator|.
name|container
operator|!=
name|NULL
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|->
name|class_type
operator|.
name|container
operator|!=
name|NULL
argument_list|)
expr_stmt|;
name|d
operator|->
name|mem_rst
operator|=
name|false
expr_stmt|;
name|d
operator|->
name|mem_vat
operator|=
name|false
expr_stmt|;
name|d
operator|->
name|mem_cst
operator|=
name|false
expr_stmt|;
name|d
operator|->
name|mem_ref
operator|=
name|false
expr_stmt|;
name|d
operator|->
name|mem_rref
operator|=
name|false
expr_stmt|;
name|d
operator|->
name|is_tmpl
operator|=
name|false
expr_stmt|;
name|d
operator|->
name|is_functype
operator|=
name|false
expr_stmt|;
name|d
operator|->
name|ref_qualifier
operator|=
name|false
expr_stmt|;
name|d
operator|->
name|push_qualifier
operator|=
name|PUSH_ALL_QUALIFIER
expr_stmt|;
name|d
operator|->
name|func_type
operator|=
literal|0
expr_stmt|;
name|d
operator|->
name|cur
operator|=
name|cur
expr_stmt|;
name|d
operator|->
name|cur_output
operator|=
operator|&
name|d
operator|->
name|output
expr_stmt|;
name|d
operator|->
name|last_sname
operator|=
name|NULL
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
name|clean4
label|:
name|vector_str_dest
argument_list|(
operator|&
name|d
operator|->
name|class_type
argument_list|)
expr_stmt|;
name|clean3
label|:
name|vector_str_dest
argument_list|(
operator|&
name|d
operator|->
name|tmpl
argument_list|)
expr_stmt|;
name|clean2
label|:
name|vector_str_dest
argument_list|(
operator|&
name|d
operator|->
name|subst
argument_list|)
expr_stmt|;
name|clean1
label|:
name|vector_str_dest
argument_list|(
operator|&
name|d
operator|->
name|output
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_push_fp
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
name|char
modifier|*
function_decl|(
modifier|*
name|decoder
function_decl|)
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
parameter_list|)
block|{
name|size_t
name|len
decl_stmt|;
name|int
name|rtn
decl_stmt|;
specifier|const
name|char
modifier|*
name|fp
decl_stmt|;
name|char
modifier|*
name|f
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
name|decoder
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|fp
operator|=
name|ddata
operator|->
name|cur
expr_stmt|;
while|while
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'E'
condition|)
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
operator|(
name|f
operator|=
name|decoder
argument_list|(
name|fp
argument_list|,
name|ddata
operator|->
name|cur
operator|-
name|fp
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|rtn
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|(
name|len
operator|=
name|strlen
argument_list|(
name|f
argument_list|)
operator|)
operator|>
literal|0
condition|)
name|rtn
operator|=
name|cpp_demangle_push_str
argument_list|(
name|ddata
argument_list|,
name|f
argument_list|,
name|len
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|f
argument_list|)
expr_stmt|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
return|return
operator|(
name|rtn
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_push_str
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
specifier|const
name|char
modifier|*
name|str
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
name|str
operator|==
name|NULL
operator|||
name|len
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
comment|/* 	 * is_tmpl is used to check if the type (function arg) is right next 	 * to template args, and should always be cleared whenever new string 	 * pushed. 	 */
name|ddata
operator|->
name|is_tmpl
operator|=
name|false
expr_stmt|;
return|return
operator|(
name|vector_str_push
argument_list|(
name|ddata
operator|->
name|cur_output
argument_list|,
name|str
argument_list|,
name|len
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_pop_str
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
if|if
condition|(
name|ddata
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
name|vector_str_pop
argument_list|(
name|ddata
operator|->
name|cur_output
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_push_subst
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
specifier|const
name|char
modifier|*
name|str
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
name|str
operator|==
name|NULL
operator|||
name|len
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|vector_str_find
argument_list|(
operator|&
name|ddata
operator|->
name|subst
argument_list|,
name|str
argument_list|,
name|len
argument_list|)
condition|)
return|return
operator|(
name|vector_str_push
argument_list|(
operator|&
name|ddata
operator|->
name|subst
argument_list|,
name|str
argument_list|,
name|len
argument_list|)
operator|)
return|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_push_subst_v
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
name|struct
name|vector_str
modifier|*
name|v
parameter_list|)
block|{
name|size_t
name|str_len
decl_stmt|;
name|int
name|rtn
decl_stmt|;
name|char
modifier|*
name|str
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
name|v
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|(
name|str
operator|=
name|vector_str_get_flat
argument_list|(
name|v
argument_list|,
operator|&
name|str_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|rtn
operator|=
name|cpp_demangle_push_subst
argument_list|(
name|ddata
argument_list|,
name|str
argument_list|,
name|str_len
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|str
argument_list|)
expr_stmt|;
return|return
operator|(
name|rtn
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_push_type_qualifier
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
name|struct
name|vector_type_qualifier
modifier|*
name|v
parameter_list|,
specifier|const
name|char
modifier|*
name|type_str
parameter_list|)
block|{
name|struct
name|vector_str
name|subst_v
decl_stmt|;
name|enum
name|type_qualifier
name|t
decl_stmt|;
name|size_t
name|idx
decl_stmt|,
name|e_idx
decl_stmt|,
name|e_len
decl_stmt|;
name|char
modifier|*
name|buf
decl_stmt|;
name|int
name|rtn
decl_stmt|;
name|bool
name|cv
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
name|v
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|(
name|idx
operator|=
name|v
operator|->
name|size
operator|)
operator|==
literal|0
condition|)
return|return
operator|(
literal|1
operator|)
return|;
name|rtn
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|type_str
operator|!=
name|NULL
condition|)
block|{
if|if
condition|(
operator|!
name|vector_str_init
argument_list|(
operator|&
name|subst_v
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|subst_v
argument_list|,
name|type_str
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
name|cv
operator|=
name|true
expr_stmt|;
name|e_idx
operator|=
literal|0
expr_stmt|;
while|while
condition|(
name|idx
operator|>
literal|0
condition|)
block|{
switch|switch
condition|(
name|v
operator|->
name|q_container
index|[
name|idx
operator|-
literal|1
index|]
condition|)
block|{
case|case
name|TYPE_PTR
case|:
name|cv
operator|=
name|false
expr_stmt|;
if|if
condition|(
name|ddata
operator|->
name|push_qualifier
operator|==
name|PUSH_CV_QUALIFIER
condition|)
break|break;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"*"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|type_str
operator|!=
name|NULL
condition|)
block|{
if|if
condition|(
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|subst_v
argument_list|,
literal|"*"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|cpp_demangle_push_subst_v
argument_list|(
name|ddata
argument_list|,
operator|&
name|subst_v
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
break|break;
case|case
name|TYPE_REF
case|:
name|cv
operator|=
name|false
expr_stmt|;
if|if
condition|(
name|ddata
operator|->
name|push_qualifier
operator|==
name|PUSH_CV_QUALIFIER
condition|)
break|break;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"&"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|type_str
operator|!=
name|NULL
condition|)
block|{
if|if
condition|(
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|subst_v
argument_list|,
literal|"&"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|cpp_demangle_push_subst_v
argument_list|(
name|ddata
argument_list|,
operator|&
name|subst_v
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
break|break;
case|case
name|TYPE_RREF
case|:
name|cv
operator|=
name|false
expr_stmt|;
if|if
condition|(
name|ddata
operator|->
name|push_qualifier
operator|==
name|PUSH_CV_QUALIFIER
condition|)
break|break;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"&&"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|type_str
operator|!=
name|NULL
condition|)
block|{
if|if
condition|(
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|subst_v
argument_list|,
literal|"&&"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|cpp_demangle_push_subst_v
argument_list|(
name|ddata
argument_list|,
operator|&
name|subst_v
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
break|break;
case|case
name|TYPE_CMX
case|:
name|cv
operator|=
name|false
expr_stmt|;
if|if
condition|(
name|ddata
operator|->
name|push_qualifier
operator|==
name|PUSH_CV_QUALIFIER
condition|)
break|break;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|" complex"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|type_str
operator|!=
name|NULL
condition|)
block|{
if|if
condition|(
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|subst_v
argument_list|,
literal|" complex"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|cpp_demangle_push_subst_v
argument_list|(
name|ddata
argument_list|,
operator|&
name|subst_v
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
break|break;
case|case
name|TYPE_IMG
case|:
name|cv
operator|=
name|false
expr_stmt|;
if|if
condition|(
name|ddata
operator|->
name|push_qualifier
operator|==
name|PUSH_CV_QUALIFIER
condition|)
break|break;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|" imaginary"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|type_str
operator|!=
name|NULL
condition|)
block|{
if|if
condition|(
operator|!
name|vector_str_push
argument_list|(
operator|&
name|subst_v
argument_list|,
literal|" imaginary"
argument_list|,
literal|10
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|cpp_demangle_push_subst_v
argument_list|(
name|ddata
argument_list|,
operator|&
name|subst_v
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
break|break;
case|case
name|TYPE_EXT
case|:
name|cv
operator|=
name|false
expr_stmt|;
if|if
condition|(
name|ddata
operator|->
name|push_qualifier
operator|==
name|PUSH_CV_QUALIFIER
condition|)
break|break;
if|if
condition|(
name|v
operator|->
name|ext_name
operator|.
name|size
operator|==
literal|0
operator|||
name|e_idx
operator|>
name|v
operator|->
name|ext_name
operator|.
name|size
operator|-
literal|1
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|(
name|e_len
operator|=
name|strlen
argument_list|(
name|v
operator|->
name|ext_name
operator|.
name|container
index|[
name|e_idx
index|]
argument_list|)
operator|)
operator|==
literal|0
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|(
name|buf
operator|=
name|malloc
argument_list|(
name|e_len
operator|+
literal|2
argument_list|)
operator|)
operator|==
name|NULL
condition|)
goto|goto
name|clean
goto|;
name|snprintf
argument_list|(
name|buf
argument_list|,
name|e_len
operator|+
literal|2
argument_list|,
literal|" %s"
argument_list|,
name|v
operator|->
name|ext_name
operator|.
name|container
index|[
name|e_idx
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
name|buf
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|buf
argument_list|)
expr_stmt|;
goto|goto
name|clean
goto|;
block|}
if|if
condition|(
name|type_str
operator|!=
name|NULL
condition|)
block|{
if|if
condition|(
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|subst_v
argument_list|,
name|buf
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|buf
argument_list|)
expr_stmt|;
goto|goto
name|clean
goto|;
block|}
if|if
condition|(
operator|!
name|cpp_demangle_push_subst_v
argument_list|(
name|ddata
argument_list|,
operator|&
name|subst_v
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|buf
argument_list|)
expr_stmt|;
goto|goto
name|clean
goto|;
block|}
block|}
name|free
argument_list|(
name|buf
argument_list|)
expr_stmt|;
operator|++
name|e_idx
expr_stmt|;
break|break;
case|case
name|TYPE_RST
case|:
if|if
condition|(
name|ddata
operator|->
name|push_qualifier
operator|==
name|PUSH_NON_CV_QUALIFIER
operator|&&
name|cv
condition|)
break|break;
if|if
condition|(
name|ddata
operator|->
name|push_qualifier
operator|==
name|PUSH_CV_QUALIFIER
operator|&&
operator|!
name|cv
condition|)
break|break;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|" restrict"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|type_str
operator|!=
name|NULL
condition|)
block|{
if|if
condition|(
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|subst_v
argument_list|,
literal|" restrict"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|idx
operator|-
literal|1
operator|>
literal|0
condition|)
block|{
name|t
operator|=
name|v
operator|->
name|q_container
index|[
name|idx
operator|-
literal|2
index|]
expr_stmt|;
if|if
condition|(
name|t
operator|==
name|TYPE_RST
operator|||
name|t
operator|==
name|TYPE_VAT
operator|||
name|t
operator|==
name|TYPE_CST
condition|)
break|break;
block|}
if|if
condition|(
operator|!
name|cpp_demangle_push_subst_v
argument_list|(
name|ddata
argument_list|,
operator|&
name|subst_v
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
break|break;
case|case
name|TYPE_VAT
case|:
if|if
condition|(
name|ddata
operator|->
name|push_qualifier
operator|==
name|PUSH_NON_CV_QUALIFIER
operator|&&
name|cv
condition|)
break|break;
if|if
condition|(
name|ddata
operator|->
name|push_qualifier
operator|==
name|PUSH_CV_QUALIFIER
operator|&&
operator|!
name|cv
condition|)
break|break;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|" volatile"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|type_str
operator|!=
name|NULL
condition|)
block|{
if|if
condition|(
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|subst_v
argument_list|,
literal|" volatile"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|idx
operator|-
literal|1
operator|>
literal|0
condition|)
block|{
name|t
operator|=
name|v
operator|->
name|q_container
index|[
name|idx
operator|-
literal|2
index|]
expr_stmt|;
if|if
condition|(
name|t
operator|==
name|TYPE_RST
operator|||
name|t
operator|==
name|TYPE_VAT
operator|||
name|t
operator|==
name|TYPE_CST
condition|)
break|break;
block|}
if|if
condition|(
operator|!
name|cpp_demangle_push_subst_v
argument_list|(
name|ddata
argument_list|,
operator|&
name|subst_v
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
break|break;
case|case
name|TYPE_CST
case|:
if|if
condition|(
name|ddata
operator|->
name|push_qualifier
operator|==
name|PUSH_NON_CV_QUALIFIER
operator|&&
name|cv
condition|)
break|break;
if|if
condition|(
name|ddata
operator|->
name|push_qualifier
operator|==
name|PUSH_CV_QUALIFIER
operator|&&
operator|!
name|cv
condition|)
break|break;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|" const"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|type_str
operator|!=
name|NULL
condition|)
block|{
if|if
condition|(
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|subst_v
argument_list|,
literal|" const"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|idx
operator|-
literal|1
operator|>
literal|0
condition|)
block|{
name|t
operator|=
name|v
operator|->
name|q_container
index|[
name|idx
operator|-
literal|2
index|]
expr_stmt|;
if|if
condition|(
name|t
operator|==
name|TYPE_RST
operator|||
name|t
operator|==
name|TYPE_VAT
operator|||
name|t
operator|==
name|TYPE_CST
condition|)
break|break;
block|}
if|if
condition|(
operator|!
name|cpp_demangle_push_subst_v
argument_list|(
name|ddata
argument_list|,
operator|&
name|subst_v
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
break|break;
case|case
name|TYPE_VEC
case|:
name|cv
operator|=
name|false
expr_stmt|;
if|if
condition|(
name|ddata
operator|->
name|push_qualifier
operator|==
name|PUSH_CV_QUALIFIER
condition|)
break|break;
if|if
condition|(
name|v
operator|->
name|ext_name
operator|.
name|size
operator|==
literal|0
operator|||
name|e_idx
operator|>
name|v
operator|->
name|ext_name
operator|.
name|size
operator|-
literal|1
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|(
name|e_len
operator|=
name|strlen
argument_list|(
name|v
operator|->
name|ext_name
operator|.
name|container
index|[
name|e_idx
index|]
argument_list|)
operator|)
operator|==
literal|0
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|(
name|buf
operator|=
name|malloc
argument_list|(
name|e_len
operator|+
literal|12
argument_list|)
operator|)
operator|==
name|NULL
condition|)
goto|goto
name|clean
goto|;
name|snprintf
argument_list|(
name|buf
argument_list|,
name|e_len
operator|+
literal|12
argument_list|,
literal|" __vector(%s)"
argument_list|,
name|v
operator|->
name|ext_name
operator|.
name|container
index|[
name|e_idx
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
name|buf
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|buf
argument_list|)
expr_stmt|;
goto|goto
name|clean
goto|;
block|}
if|if
condition|(
name|type_str
operator|!=
name|NULL
condition|)
block|{
if|if
condition|(
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|subst_v
argument_list|,
name|buf
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|buf
argument_list|)
expr_stmt|;
goto|goto
name|clean
goto|;
block|}
if|if
condition|(
operator|!
name|cpp_demangle_push_subst_v
argument_list|(
name|ddata
argument_list|,
operator|&
name|subst_v
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|buf
argument_list|)
expr_stmt|;
goto|goto
name|clean
goto|;
block|}
block|}
name|free
argument_list|(
name|buf
argument_list|)
expr_stmt|;
operator|++
name|e_idx
expr_stmt|;
break|break;
block|}
operator|--
name|idx
expr_stmt|;
block|}
name|rtn
operator|=
literal|1
expr_stmt|;
name|clean
label|:
if|if
condition|(
name|type_str
operator|!=
name|NULL
condition|)
name|vector_str_dest
argument_list|(
operator|&
name|subst_v
argument_list|)
expr_stmt|;
return|return
operator|(
name|rtn
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_get_subst
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
name|size_t
name|idx
parameter_list|)
block|{
name|size_t
name|len
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
name|ddata
operator|->
name|subst
operator|.
name|size
operator|<=
name|idx
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|(
name|len
operator|=
name|strlen
argument_list|(
name|ddata
operator|->
name|subst
operator|.
name|container
index|[
name|idx
index|]
argument_list|)
operator|)
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_push_str
argument_list|(
name|ddata
argument_list|,
name|ddata
operator|->
name|subst
operator|.
name|container
index|[
name|idx
index|]
argument_list|,
name|len
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
comment|/* skip '_' */
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_get_tmpl_param
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
name|size_t
name|idx
parameter_list|)
block|{
name|size_t
name|len
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
name|ddata
operator|->
name|tmpl
operator|.
name|size
operator|<=
name|idx
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|(
name|len
operator|=
name|strlen
argument_list|(
name|ddata
operator|->
name|tmpl
operator|.
name|container
index|[
name|idx
index|]
argument_list|)
operator|)
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_push_str
argument_list|(
name|ddata
argument_list|,
name|ddata
operator|->
name|tmpl
operator|.
name|container
index|[
name|idx
index|]
argument_list|,
name|len
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_array
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
name|size_t
name|i
decl_stmt|,
name|num_len
decl_stmt|,
name|exp_len
decl_stmt|,
name|p_idx
decl_stmt|,
name|idx
decl_stmt|;
specifier|const
name|char
modifier|*
name|num
decl_stmt|;
name|char
modifier|*
name|exp
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
operator|*
operator|(
operator|++
name|ddata
operator|->
name|cur
operator|)
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'_'
condition|)
block|{
if|if
condition|(
operator|*
operator|(
operator|++
name|ddata
operator|->
name|cur
operator|)
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"[]"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
block|}
else|else
block|{
if|if
condition|(
name|ELFTC_ISDIGIT
argument_list|(
operator|*
name|ddata
operator|->
name|cur
argument_list|)
operator|!=
literal|0
condition|)
block|{
name|num
operator|=
name|ddata
operator|->
name|cur
expr_stmt|;
while|while
condition|(
name|ELFTC_ISDIGIT
argument_list|(
operator|*
name|ddata
operator|->
name|cur
argument_list|)
operator|!=
literal|0
condition|)
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'_'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|num_len
operator|=
name|ddata
operator|->
name|cur
operator|-
name|num
expr_stmt|;
name|assert
argument_list|(
name|num_len
operator|>
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|(
operator|++
name|ddata
operator|->
name|cur
operator|)
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"["
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_push_str
argument_list|(
name|ddata
argument_list|,
name|num
argument_list|,
name|num_len
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"]"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
block|}
else|else
block|{
name|p_idx
operator|=
name|ddata
operator|->
name|output
operator|.
name|size
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_expression
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|(
name|exp
operator|=
name|vector_str_substr
argument_list|(
operator|&
name|ddata
operator|->
name|output
argument_list|,
name|p_idx
argument_list|,
name|ddata
operator|->
name|output
operator|.
name|size
operator|-
literal|1
argument_list|,
operator|&
name|exp_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|idx
operator|=
name|ddata
operator|->
name|output
operator|.
name|size
expr_stmt|;
for|for
control|(
name|i
operator|=
name|p_idx
init|;
name|i
operator|<
name|idx
condition|;
operator|++
name|i
control|)
if|if
condition|(
operator|!
name|vector_str_pop
argument_list|(
operator|&
name|ddata
operator|->
name|output
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|exp
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'_'
condition|)
block|{
name|free
argument_list|(
name|exp
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
block|{
name|free
argument_list|(
name|exp
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
if|if
condition|(
operator|!
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|exp
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"["
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|exp
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
if|if
condition|(
operator|!
name|cpp_demangle_push_str
argument_list|(
name|ddata
argument_list|,
name|exp
argument_list|,
name|exp_len
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|exp
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"]"
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|exp
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
name|free
argument_list|(
name|exp
argument_list|)
expr_stmt|;
block|}
block|}
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_expr_primary
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|num
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
operator|*
operator|(
operator|++
name|ddata
operator|->
name|cur
operator|)
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'_'
operator|&&
operator|*
operator|(
name|ddata
operator|->
name|cur
operator|+
literal|1
operator|)
operator|==
literal|'Z'
condition|)
block|{
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_read_encoding
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
switch|switch
condition|(
operator|*
name|ddata
operator|->
name|cur
condition|)
block|{
case|case
literal|'b'
case|:
if|if
condition|(
operator|*
operator|(
name|ddata
operator|->
name|cur
operator|+
literal|2
operator|)
operator|!=
literal|'E'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
switch|switch
condition|(
operator|*
operator|(
operator|++
name|ddata
operator|->
name|cur
operator|)
condition|)
block|{
case|case
literal|'0'
case|:
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"false"
argument_list|)
operator|)
return|;
case|case
literal|'1'
case|:
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"true"
argument_list|)
operator|)
return|;
default|default:
return|return
operator|(
literal|0
operator|)
return|;
block|}
case|case
literal|'d'
case|:
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
return|return
operator|(
name|cpp_demangle_push_fp
argument_list|(
name|ddata
argument_list|,
name|decode_fp_to_double
argument_list|)
operator|)
return|;
case|case
literal|'e'
case|:
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
expr|sizeof
operator|(
name|long
name|double
operator|)
operator|==
literal|10
condition|)
return|return
operator|(
name|cpp_demangle_push_fp
argument_list|(
name|ddata
argument_list|,
name|decode_fp_to_double
argument_list|)
operator|)
return|;
return|return
operator|(
name|cpp_demangle_push_fp
argument_list|(
name|ddata
argument_list|,
name|decode_fp_to_float80
argument_list|)
operator|)
return|;
case|case
literal|'f'
case|:
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
return|return
operator|(
name|cpp_demangle_push_fp
argument_list|(
name|ddata
argument_list|,
name|decode_fp_to_float
argument_list|)
operator|)
return|;
case|case
literal|'g'
case|:
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
expr|sizeof
operator|(
name|long
name|double
operator|)
operator|==
literal|16
condition|)
return|return
operator|(
name|cpp_demangle_push_fp
argument_list|(
name|ddata
argument_list|,
name|decode_fp_to_double
argument_list|)
operator|)
return|;
return|return
operator|(
name|cpp_demangle_push_fp
argument_list|(
name|ddata
argument_list|,
name|decode_fp_to_float128
argument_list|)
operator|)
return|;
case|case
literal|'i'
case|:
case|case
literal|'j'
case|:
case|case
literal|'l'
case|:
case|case
literal|'m'
case|:
case|case
literal|'n'
case|:
case|case
literal|'s'
case|:
case|case
literal|'t'
case|:
case|case
literal|'x'
case|:
case|case
literal|'y'
case|:
if|if
condition|(
operator|*
operator|(
operator|++
name|ddata
operator|->
name|cur
operator|)
operator|==
literal|'n'
condition|)
block|{
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"-"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
block|}
name|num
operator|=
name|ddata
operator|->
name|cur
expr_stmt|;
while|while
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'E'
condition|)
block|{
if|if
condition|(
operator|!
name|ELFTC_ISDIGIT
argument_list|(
operator|*
name|ddata
operator|->
name|cur
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
block|}
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
return|return
operator|(
name|cpp_demangle_push_str
argument_list|(
name|ddata
argument_list|,
name|num
argument_list|,
name|ddata
operator|->
name|cur
operator|-
name|num
operator|-
literal|1
argument_list|)
operator|)
return|;
default|default:
return|return
operator|(
literal|0
operator|)
return|;
block|}
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_expression
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
switch|switch
condition|(
name|SIMPLE_HASH
argument_list|(
operator|*
name|ddata
operator|->
name|cur
argument_list|,
operator|*
operator|(
name|ddata
operator|->
name|cur
operator|+
literal|1
operator|)
argument_list|)
condition|)
block|{
case|case
name|SIMPLE_HASH
argument_list|(
literal|'s'
argument_list|,
literal|'t'
argument_list|)
case|:
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'s'
argument_list|,
literal|'r'
argument_list|)
case|:
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_read_uqname
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'I'
condition|)
return|return
operator|(
name|cpp_demangle_read_tmpl_args
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'a'
argument_list|,
literal|'a'
argument_list|)
case|:
comment|/* operator&& */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"&&"
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'a'
argument_list|,
literal|'d'
argument_list|)
case|:
comment|/* operator& (unary) */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_unary
argument_list|(
name|ddata
argument_list|,
literal|"&"
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'a'
argument_list|,
literal|'n'
argument_list|)
case|:
comment|/* operator& */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"&"
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'a'
argument_list|,
literal|'N'
argument_list|)
case|:
comment|/* operator&= */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"&="
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'a'
argument_list|,
literal|'S'
argument_list|)
case|:
comment|/* operator = */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"="
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'c'
argument_list|,
literal|'l'
argument_list|)
case|:
comment|/* operator () */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"()"
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'c'
argument_list|,
literal|'m'
argument_list|)
case|:
comment|/* operator , */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|","
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'c'
argument_list|,
literal|'o'
argument_list|)
case|:
comment|/* operator ~ */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"~"
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'c'
argument_list|,
literal|'v'
argument_list|)
case|:
comment|/* operator (cast) */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"(cast)"
argument_list|,
literal|6
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'d'
argument_list|,
literal|'a'
argument_list|)
case|:
comment|/* operator delete [] */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_unary
argument_list|(
name|ddata
argument_list|,
literal|"delete []"
argument_list|,
literal|9
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'d'
argument_list|,
literal|'e'
argument_list|)
case|:
comment|/* operator * (unary) */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_unary
argument_list|(
name|ddata
argument_list|,
literal|"*"
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'d'
argument_list|,
literal|'l'
argument_list|)
case|:
comment|/* operator delete */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_unary
argument_list|(
name|ddata
argument_list|,
literal|"delete"
argument_list|,
literal|6
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'d'
argument_list|,
literal|'v'
argument_list|)
case|:
comment|/* operator / */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"/"
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'d'
argument_list|,
literal|'V'
argument_list|)
case|:
comment|/* operator /= */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"/="
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'e'
argument_list|,
literal|'o'
argument_list|)
case|:
comment|/* operator ^ */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"^"
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'e'
argument_list|,
literal|'O'
argument_list|)
case|:
comment|/* operator ^= */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"^="
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'e'
argument_list|,
literal|'q'
argument_list|)
case|:
comment|/* operator == */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"=="
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'g'
argument_list|,
literal|'e'
argument_list|)
case|:
comment|/* operator>= */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|">="
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'g'
argument_list|,
literal|'t'
argument_list|)
case|:
comment|/* operator> */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|">"
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'i'
argument_list|,
literal|'x'
argument_list|)
case|:
comment|/* operator [] */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"[]"
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'l'
argument_list|,
literal|'e'
argument_list|)
case|:
comment|/* operator<= */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"<="
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'l'
argument_list|,
literal|'s'
argument_list|)
case|:
comment|/* operator<< */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"<<"
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'l'
argument_list|,
literal|'S'
argument_list|)
case|:
comment|/* operator<<= */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"<<="
argument_list|,
literal|3
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'l'
argument_list|,
literal|'t'
argument_list|)
case|:
comment|/* operator< */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"<"
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'m'
argument_list|,
literal|'i'
argument_list|)
case|:
comment|/* operator - */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"-"
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'m'
argument_list|,
literal|'I'
argument_list|)
case|:
comment|/* operator -= */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"-="
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'m'
argument_list|,
literal|'l'
argument_list|)
case|:
comment|/* operator * */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"*"
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'m'
argument_list|,
literal|'L'
argument_list|)
case|:
comment|/* operator *= */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"*="
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'m'
argument_list|,
literal|'m'
argument_list|)
case|:
comment|/* operator -- */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"--"
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'n'
argument_list|,
literal|'a'
argument_list|)
case|:
comment|/* operator new[] */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_unary
argument_list|(
name|ddata
argument_list|,
literal|"new []"
argument_list|,
literal|6
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'n'
argument_list|,
literal|'e'
argument_list|)
case|:
comment|/* operator != */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"!="
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'n'
argument_list|,
literal|'g'
argument_list|)
case|:
comment|/* operator - (unary) */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_unary
argument_list|(
name|ddata
argument_list|,
literal|"-"
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'n'
argument_list|,
literal|'t'
argument_list|)
case|:
comment|/* operator ! */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"!"
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'n'
argument_list|,
literal|'w'
argument_list|)
case|:
comment|/* operator new */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_unary
argument_list|(
name|ddata
argument_list|,
literal|"new"
argument_list|,
literal|3
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'o'
argument_list|,
literal|'o'
argument_list|)
case|:
comment|/* operator || */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"||"
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'o'
argument_list|,
literal|'r'
argument_list|)
case|:
comment|/* operator | */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"|"
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'o'
argument_list|,
literal|'R'
argument_list|)
case|:
comment|/* operator |= */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"|="
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'p'
argument_list|,
literal|'l'
argument_list|)
case|:
comment|/* operator + */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"+"
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'p'
argument_list|,
literal|'L'
argument_list|)
case|:
comment|/* operator += */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"+="
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'p'
argument_list|,
literal|'m'
argument_list|)
case|:
comment|/* operator ->* */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"->*"
argument_list|,
literal|3
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'p'
argument_list|,
literal|'p'
argument_list|)
case|:
comment|/* operator ++ */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"++"
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'p'
argument_list|,
literal|'s'
argument_list|)
case|:
comment|/* operator + (unary) */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_unary
argument_list|(
name|ddata
argument_list|,
literal|"+"
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'p'
argument_list|,
literal|'t'
argument_list|)
case|:
comment|/* operator -> */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"->"
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'q'
argument_list|,
literal|'u'
argument_list|)
case|:
comment|/* operator ? */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_trinary
argument_list|(
name|ddata
argument_list|,
literal|"?"
argument_list|,
literal|1
argument_list|,
literal|":"
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'r'
argument_list|,
literal|'m'
argument_list|)
case|:
comment|/* operator % */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"%"
argument_list|,
literal|1
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'r'
argument_list|,
literal|'M'
argument_list|)
case|:
comment|/* operator %= */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|"%="
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'r'
argument_list|,
literal|'s'
argument_list|)
case|:
comment|/* operator>> */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|">>"
argument_list|,
literal|2
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'r'
argument_list|,
literal|'S'
argument_list|)
case|:
comment|/* operator>>= */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_binary
argument_list|(
name|ddata
argument_list|,
literal|">>="
argument_list|,
literal|3
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'r'
argument_list|,
literal|'z'
argument_list|)
case|:
comment|/* operator sizeof */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_unary
argument_list|(
name|ddata
argument_list|,
literal|"sizeof"
argument_list|,
literal|6
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'s'
argument_list|,
literal|'v'
argument_list|)
case|:
comment|/* operator sizeof */
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_expression_unary
argument_list|(
name|ddata
argument_list|,
literal|"sizeof"
argument_list|,
literal|6
argument_list|)
operator|)
return|;
block|}
switch|switch
condition|(
operator|*
name|ddata
operator|->
name|cur
condition|)
block|{
case|case
literal|'L'
case|:
return|return
operator|(
name|cpp_demangle_read_expr_primary
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
case|case
literal|'T'
case|:
return|return
operator|(
name|cpp_demangle_read_tmpl_param
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_expression_flat
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
name|char
modifier|*
modifier|*
name|str
parameter_list|)
block|{
name|struct
name|vector_str
modifier|*
name|output
decl_stmt|;
name|size_t
name|i
decl_stmt|,
name|p_idx
decl_stmt|,
name|idx
decl_stmt|,
name|exp_len
decl_stmt|;
name|char
modifier|*
name|exp
decl_stmt|;
name|output
operator|=
operator|&
name|ddata
operator|->
name|output
expr_stmt|;
name|p_idx
operator|=
name|output
operator|->
name|size
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_expression
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|(
name|exp
operator|=
name|vector_str_substr
argument_list|(
name|output
argument_list|,
name|p_idx
argument_list|,
name|output
operator|->
name|size
operator|-
literal|1
argument_list|,
operator|&
name|exp_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|idx
operator|=
name|output
operator|->
name|size
expr_stmt|;
for|for
control|(
name|i
operator|=
name|p_idx
init|;
name|i
operator|<
name|idx
condition|;
operator|++
name|i
control|)
block|{
if|if
condition|(
operator|!
name|vector_str_pop
argument_list|(
name|output
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|exp
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
block|}
operator|*
name|str
operator|=
name|exp
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_expression_binary
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
specifier|const
name|char
modifier|*
name|name
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
name|name
operator|==
name|NULL
operator|||
name|len
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_read_expression
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_push_str
argument_list|(
name|ddata
argument_list|,
name|name
argument_list|,
name|len
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
name|cpp_demangle_read_expression
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_expression_unary
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
specifier|const
name|char
modifier|*
name|name
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
name|name
operator|==
name|NULL
operator|||
name|len
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_read_expression
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
name|cpp_demangle_push_str
argument_list|(
name|ddata
argument_list|,
name|name
argument_list|,
name|len
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_expression_trinary
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
specifier|const
name|char
modifier|*
name|name1
parameter_list|,
name|size_t
name|len1
parameter_list|,
specifier|const
name|char
modifier|*
name|name2
parameter_list|,
name|size_t
name|len2
parameter_list|)
block|{
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
name|name1
operator|==
name|NULL
operator|||
name|len1
operator|==
literal|0
operator|||
name|name2
operator|==
name|NULL
operator|||
name|len2
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_read_expression
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_push_str
argument_list|(
name|ddata
argument_list|,
name|name1
argument_list|,
name|len1
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_read_expression
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_push_str
argument_list|(
name|ddata
argument_list|,
name|name2
argument_list|,
name|len2
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
name|cpp_demangle_read_expression
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_function
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
name|int
modifier|*
name|ext_c
parameter_list|,
name|struct
name|vector_type_qualifier
modifier|*
name|v
parameter_list|)
block|{
name|struct
name|type_delimit
name|td
decl_stmt|;
name|struct
name|read_cmd_item
modifier|*
name|rc
decl_stmt|;
name|size_t
name|class_type_size
decl_stmt|,
name|class_type_len
decl_stmt|,
name|limit
decl_stmt|;
specifier|const
name|char
modifier|*
name|class_type
decl_stmt|;
name|int
name|i
decl_stmt|;
name|bool
name|paren
decl_stmt|,
name|non_cv_qualifier
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'F'
operator|||
name|v
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'Y'
condition|)
block|{
if|if
condition|(
name|ext_c
operator|!=
name|NULL
condition|)
operator|*
name|ext_c
operator|=
literal|1
expr_stmt|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
block|}
comment|/* Return type */
if|if
condition|(
operator|!
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'E'
condition|)
block|{
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|" "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|non_cv_qualifier
operator|=
name|false
expr_stmt|;
if|if
condition|(
name|v
operator|->
name|size
operator|>
literal|0
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
operator|(
name|size_t
operator|)
name|i
operator|<
name|v
operator|->
name|size
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|v
operator|->
name|q_container
index|[
name|i
index|]
operator|!=
name|TYPE_RST
operator|&&
name|v
operator|->
name|q_container
index|[
name|i
index|]
operator|!=
name|TYPE_VAT
operator|&&
name|v
operator|->
name|q_container
index|[
name|i
index|]
operator|!=
name|TYPE_CST
condition|)
block|{
name|non_cv_qualifier
operator|=
name|true
expr_stmt|;
break|break;
block|}
block|}
block|}
name|paren
operator|=
name|false
expr_stmt|;
name|rc
operator|=
name|vector_read_cmd_find
argument_list|(
operator|&
name|ddata
operator|->
name|cmd
argument_list|,
name|READ_PTRMEM
argument_list|)
expr_stmt|;
if|if
condition|(
name|non_cv_qualifier
operator|||
name|rc
operator|!=
name|NULL
condition|)
block|{
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"("
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|paren
operator|=
name|true
expr_stmt|;
block|}
comment|/* Push non-cv qualifiers. */
name|ddata
operator|->
name|push_qualifier
operator|=
name|PUSH_NON_CV_QUALIFIER
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_push_type_qualifier
argument_list|(
name|ddata
argument_list|,
name|v
argument_list|,
name|NULL
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
name|rc
condition|)
block|{
if|if
condition|(
name|non_cv_qualifier
operator|&&
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|" "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|(
name|class_type_size
operator|=
name|ddata
operator|->
name|class_type
operator|.
name|size
operator|)
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|class_type
operator|=
name|ddata
operator|->
name|class_type
operator|.
name|container
index|[
name|class_type_size
operator|-
literal|1
index|]
expr_stmt|;
if|if
condition|(
name|class_type
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|(
name|class_type_len
operator|=
name|strlen
argument_list|(
name|class_type
argument_list|)
operator|)
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_push_str
argument_list|(
name|ddata
argument_list|,
name|class_type
argument_list|,
name|class_type_len
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"::*"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
comment|/* Push pointer-to-member qualifiers. */
name|ddata
operator|->
name|push_qualifier
operator|=
name|PUSH_ALL_QUALIFIER
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_push_type_qualifier
argument_list|(
name|ddata
argument_list|,
name|rc
operator|->
name|data
argument_list|,
name|NULL
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
operator|++
name|ddata
operator|->
name|func_type
expr_stmt|;
block|}
if|if
condition|(
name|paren
condition|)
block|{
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|")"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|paren
operator|=
name|false
expr_stmt|;
block|}
name|td
operator|.
name|paren
operator|=
name|false
expr_stmt|;
name|td
operator|.
name|firstp
operator|=
name|true
expr_stmt|;
name|limit
operator|=
literal|0
expr_stmt|;
name|ddata
operator|->
name|is_functype
operator|=
name|true
expr_stmt|;
for|for
control|(
init|;
condition|;
control|)
block|{
if|if
condition|(
operator|!
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
operator|&
name|td
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'E'
condition|)
break|break;
if|if
condition|(
name|limit
operator|++
operator|>
name|CPP_DEMANGLE_TRY_LIMIT
condition|)
return|return
operator|(
literal|0
operator|)
return|;
block|}
name|ddata
operator|->
name|is_functype
operator|=
name|false
expr_stmt|;
if|if
condition|(
name|td
operator|.
name|paren
condition|)
block|{
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|")"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|td
operator|.
name|paren
operator|=
name|false
expr_stmt|;
block|}
comment|/* Push CV qualifiers. */
name|ddata
operator|->
name|push_qualifier
operator|=
name|PUSH_CV_QUALIFIER
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_push_type_qualifier
argument_list|(
name|ddata
argument_list|,
name|v
argument_list|,
name|NULL
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|push_qualifier
operator|=
name|PUSH_ALL_QUALIFIER
expr_stmt|;
comment|/* Release type qualifier vector. */
name|vector_type_qualifier_dest
argument_list|(
name|v
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|vector_type_qualifier_init
argument_list|(
name|v
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
comment|/* Push ref-qualifiers. */
if|if
condition|(
name|ddata
operator|->
name|ref_qualifier
condition|)
block|{
switch|switch
condition|(
name|ddata
operator|->
name|ref_qualifier_type
condition|)
block|{
case|case
name|TYPE_REF
case|:
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"&"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
break|break;
case|case
name|TYPE_RREF
case|:
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"&&"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
break|break;
default|default:
return|return
operator|(
literal|0
operator|)
return|;
block|}
name|ddata
operator|->
name|ref_qualifier
operator|=
name|false
expr_stmt|;
block|}
block|}
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_comment
comment|/* read encoding, encoding are function name, data name, special-name */
end_comment

begin_function
specifier|static
name|int
name|cpp_demangle_read_encoding
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|type
decl_stmt|,
modifier|*
name|num_str
decl_stmt|;
name|long
name|offset
decl_stmt|;
name|int
name|rtn
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
comment|/* special name */
switch|switch
condition|(
name|SIMPLE_HASH
argument_list|(
operator|*
name|ddata
operator|->
name|cur
argument_list|,
operator|*
operator|(
name|ddata
operator|->
name|cur
operator|+
literal|1
operator|)
argument_list|)
condition|)
block|{
case|case
name|SIMPLE_HASH
argument_list|(
literal|'G'
argument_list|,
literal|'A'
argument_list|)
case|:
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"hidden alias for "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
name|cpp_demangle_read_encoding
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'G'
argument_list|,
literal|'R'
argument_list|)
case|:
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"reference temporary #"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_read_name_flat
argument_list|(
name|ddata
argument_list|,
operator|&
name|name
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|rtn
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_number_as_string
argument_list|(
name|ddata
argument_list|,
operator|&
name|num_str
argument_list|)
condition|)
goto|goto
name|clean1
goto|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
name|num_str
argument_list|)
condition|)
goto|goto
name|clean2
goto|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|" for "
argument_list|)
condition|)
goto|goto
name|clean2
goto|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
name|name
argument_list|)
condition|)
goto|goto
name|clean2
goto|;
name|rtn
operator|=
literal|1
expr_stmt|;
name|clean2
label|:
name|free
argument_list|(
name|num_str
argument_list|)
expr_stmt|;
name|clean1
label|:
name|free
argument_list|(
name|name
argument_list|)
expr_stmt|;
return|return
operator|(
name|rtn
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'G'
argument_list|,
literal|'T'
argument_list|)
case|:
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
switch|switch
condition|(
operator|*
name|ddata
operator|->
name|cur
condition|)
block|{
case|case
literal|'n'
case|:
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"non-transaction clone for "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
break|break;
case|case
literal|'t'
case|:
default|default:
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"transaction clone for "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
break|break;
block|}
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_encoding
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'G'
argument_list|,
literal|'V'
argument_list|)
case|:
comment|/* sentry object for 1 time init */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"guard variable for "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
break|break;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'T'
argument_list|,
literal|'c'
argument_list|)
case|:
comment|/* virtual function covariant override thunk */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"virtual function covariant override "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_read_offset
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_read_offset
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
name|cpp_demangle_read_encoding
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'T'
argument_list|,
literal|'C'
argument_list|)
case|:
comment|/* construction vtable */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"construction vtable for "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_read_type_flat
argument_list|(
name|ddata
argument_list|,
operator|&
name|type
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|rtn
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_number
argument_list|(
name|ddata
argument_list|,
operator|&
name|offset
argument_list|)
condition|)
goto|goto
name|clean3
goto|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|++
operator|!=
literal|'_'
condition|)
goto|goto
name|clean3
goto|;
if|if
condition|(
operator|!
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
condition|)
goto|goto
name|clean3
goto|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"-in-"
argument_list|)
condition|)
goto|goto
name|clean3
goto|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
name|type
argument_list|)
condition|)
goto|goto
name|clean3
goto|;
name|rtn
operator|=
literal|1
expr_stmt|;
name|clean3
label|:
name|free
argument_list|(
name|type
argument_list|)
expr_stmt|;
return|return
operator|(
name|rtn
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'T'
argument_list|,
literal|'D'
argument_list|)
case|:
comment|/* typeinfo common proxy */
break|break;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'T'
argument_list|,
literal|'F'
argument_list|)
case|:
comment|/* typeinfo fn */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"typeinfo fn for "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'T'
argument_list|,
literal|'h'
argument_list|)
case|:
comment|/* virtual function non-virtual override thunk */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"virtual function non-virtual override "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_read_nv_offset
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
name|cpp_demangle_read_encoding
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'T'
argument_list|,
literal|'H'
argument_list|)
case|:
comment|/* TLS init function */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"TLS init function for "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
break|break;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'T'
argument_list|,
literal|'I'
argument_list|)
case|:
comment|/* typeinfo structure */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"typeinfo for "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'T'
argument_list|,
literal|'J'
argument_list|)
case|:
comment|/* java class */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"java Class for "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'T'
argument_list|,
literal|'S'
argument_list|)
case|:
comment|/* RTTI name (NTBS) */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"typeinfo name for "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'T'
argument_list|,
literal|'T'
argument_list|)
case|:
comment|/* VTT table */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"VTT for "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'T'
argument_list|,
literal|'v'
argument_list|)
case|:
comment|/* virtual function virtual override thunk */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"virtual function virtual override "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_read_v_offset
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
name|cpp_demangle_read_encoding
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'T'
argument_list|,
literal|'V'
argument_list|)
case|:
comment|/* virtual table */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"vtable for "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'T'
argument_list|,
literal|'W'
argument_list|)
case|:
comment|/* TLS wrapper function */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"TLS wrapper function for "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
break|break;
block|}
return|return
operator|(
name|cpp_demangle_read_name
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_local_name
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
name|struct
name|vector_str
name|local_name
decl_stmt|;
name|struct
name|type_delimit
name|td
decl_stmt|;
name|size_t
name|limit
decl_stmt|;
name|bool
name|more_type
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|*
operator|(
operator|++
name|ddata
operator|->
name|cur
operator|)
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|vector_str_init
argument_list|(
operator|&
name|local_name
argument_list|)
expr_stmt|;
name|ddata
operator|->
name|cur_output
operator|=
operator|&
name|local_name
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_encoding
argument_list|(
name|ddata
argument_list|)
condition|)
block|{
name|vector_str_dest
argument_list|(
operator|&
name|local_name
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
name|ddata
operator|->
name|cur_output
operator|=
operator|&
name|ddata
operator|->
name|output
expr_stmt|;
name|td
operator|.
name|paren
operator|=
name|false
expr_stmt|;
name|td
operator|.
name|firstp
operator|=
name|true
expr_stmt|;
name|more_type
operator|=
name|false
expr_stmt|;
name|limit
operator|=
literal|0
expr_stmt|;
comment|/* 	 * The first type is a return type if we just demangled template 	 * args. (the template args is right next to the function name, 	 * which means it's a template function) 	 */
if|if
condition|(
name|ddata
operator|->
name|is_tmpl
condition|)
block|{
name|ddata
operator|->
name|is_tmpl
operator|=
name|false
expr_stmt|;
comment|/* Read return type */
if|if
condition|(
operator|!
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
condition|)
block|{
name|vector_str_dest
argument_list|(
operator|&
name|local_name
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
name|more_type
operator|=
name|true
expr_stmt|;
block|}
comment|/* Now we can push the name after possible return type is handled. */
if|if
condition|(
operator|!
name|vector_str_push_vector
argument_list|(
operator|&
name|ddata
operator|->
name|output
argument_list|,
operator|&
name|local_name
argument_list|)
condition|)
block|{
name|vector_str_dest
argument_list|(
operator|&
name|local_name
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
name|vector_str_dest
argument_list|(
operator|&
name|local_name
argument_list|)
expr_stmt|;
while|while
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'\0'
condition|)
block|{
if|if
condition|(
operator|!
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
operator|&
name|td
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
name|more_type
condition|)
name|more_type
operator|=
name|false
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'E'
condition|)
break|break;
if|if
condition|(
name|limit
operator|++
operator|>
name|CPP_DEMANGLE_TRY_LIMIT
condition|)
return|return
operator|(
literal|0
operator|)
return|;
block|}
if|if
condition|(
name|more_type
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|*
operator|(
operator|++
name|ddata
operator|->
name|cur
operator|)
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
name|td
operator|.
name|paren
operator|==
name|true
condition|)
block|{
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|")"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|td
operator|.
name|paren
operator|=
name|false
expr_stmt|;
block|}
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'s'
condition|)
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
else|else
block|{
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"::"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_read_name
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
block|}
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'_'
condition|)
block|{
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
while|while
condition|(
name|ELFTC_ISDIGIT
argument_list|(
operator|*
name|ddata
operator|->
name|cur
argument_list|)
operator|!=
literal|0
condition|)
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
block|}
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_name
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
name|struct
name|vector_str
modifier|*
name|output
decl_stmt|,
name|v
decl_stmt|;
name|size_t
name|p_idx
decl_stmt|,
name|subst_str_len
decl_stmt|;
name|int
name|rtn
decl_stmt|;
name|char
modifier|*
name|subst_str
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|output
operator|=
name|ddata
operator|->
name|cur_output
expr_stmt|;
name|subst_str
operator|=
name|NULL
expr_stmt|;
switch|switch
condition|(
operator|*
name|ddata
operator|->
name|cur
condition|)
block|{
case|case
literal|'S'
case|:
return|return
operator|(
name|cpp_demangle_read_subst
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
case|case
literal|'N'
case|:
return|return
operator|(
name|cpp_demangle_read_nested_name
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
case|case
literal|'Z'
case|:
return|return
operator|(
name|cpp_demangle_read_local_name
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
block|}
if|if
condition|(
operator|!
name|vector_str_init
argument_list|(
operator|&
name|v
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|p_idx
operator|=
name|output
operator|->
name|size
expr_stmt|;
name|rtn
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_uqname
argument_list|(
name|ddata
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|(
name|subst_str
operator|=
name|vector_str_substr
argument_list|(
name|output
argument_list|,
name|p_idx
argument_list|,
name|output
operator|->
name|size
operator|-
literal|1
argument_list|,
operator|&
name|subst_str_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|subst_str_len
operator|>
literal|8
operator|&&
name|strstr
argument_list|(
name|subst_str
argument_list|,
literal|"operator"
argument_list|)
operator|!=
name|NULL
condition|)
block|{
name|rtn
operator|=
literal|1
expr_stmt|;
goto|goto
name|clean
goto|;
block|}
if|if
condition|(
operator|!
name|vector_str_push
argument_list|(
operator|&
name|v
argument_list|,
name|subst_str
argument_list|,
name|subst_str_len
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|cpp_demangle_push_subst_v
argument_list|(
name|ddata
argument_list|,
operator|&
name|v
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'I'
condition|)
block|{
name|p_idx
operator|=
name|output
operator|->
name|size
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_tmpl_args
argument_list|(
name|ddata
argument_list|)
condition|)
goto|goto
name|clean
goto|;
name|free
argument_list|(
name|subst_str
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|subst_str
operator|=
name|vector_str_substr
argument_list|(
name|output
argument_list|,
name|p_idx
argument_list|,
name|output
operator|->
name|size
operator|-
literal|1
argument_list|,
operator|&
name|subst_str_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|vector_str_push
argument_list|(
operator|&
name|v
argument_list|,
name|subst_str
argument_list|,
name|subst_str_len
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|cpp_demangle_push_subst_v
argument_list|(
name|ddata
argument_list|,
operator|&
name|v
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
name|rtn
operator|=
literal|1
expr_stmt|;
name|clean
label|:
name|free
argument_list|(
name|subst_str
argument_list|)
expr_stmt|;
name|vector_str_dest
argument_list|(
operator|&
name|v
argument_list|)
expr_stmt|;
return|return
operator|(
name|rtn
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_name_flat
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
name|char
modifier|*
modifier|*
name|str
parameter_list|)
block|{
name|struct
name|vector_str
modifier|*
name|output
decl_stmt|;
name|size_t
name|i
decl_stmt|,
name|p_idx
decl_stmt|,
name|idx
decl_stmt|,
name|name_len
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|;
name|output
operator|=
name|ddata
operator|->
name|cur_output
expr_stmt|;
name|p_idx
operator|=
name|output
operator|->
name|size
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_name
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|(
name|name
operator|=
name|vector_str_substr
argument_list|(
name|output
argument_list|,
name|p_idx
argument_list|,
name|output
operator|->
name|size
operator|-
literal|1
argument_list|,
operator|&
name|name_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|idx
operator|=
name|output
operator|->
name|size
expr_stmt|;
for|for
control|(
name|i
operator|=
name|p_idx
init|;
name|i
operator|<
name|idx
condition|;
operator|++
name|i
control|)
block|{
if|if
condition|(
operator|!
name|vector_str_pop
argument_list|(
name|output
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|name
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
block|}
operator|*
name|str
operator|=
name|name
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_nested_name
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
name|struct
name|vector_str
modifier|*
name|output
decl_stmt|,
name|v
decl_stmt|;
name|size_t
name|limit
decl_stmt|,
name|p_idx
decl_stmt|,
name|subst_str_len
decl_stmt|;
name|int
name|rtn
decl_stmt|;
name|char
modifier|*
name|subst_str
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'N'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|*
operator|(
operator|++
name|ddata
operator|->
name|cur
operator|)
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
do|do
block|{
switch|switch
condition|(
operator|*
name|ddata
operator|->
name|cur
condition|)
block|{
case|case
literal|'r'
case|:
name|ddata
operator|->
name|mem_rst
operator|=
name|true
expr_stmt|;
break|break;
case|case
literal|'V'
case|:
name|ddata
operator|->
name|mem_vat
operator|=
name|true
expr_stmt|;
break|break;
case|case
literal|'K'
case|:
name|ddata
operator|->
name|mem_cst
operator|=
name|true
expr_stmt|;
break|break;
case|case
literal|'R'
case|:
name|ddata
operator|->
name|mem_ref
operator|=
name|true
expr_stmt|;
break|break;
case|case
literal|'O'
case|:
name|ddata
operator|->
name|mem_rref
operator|=
name|true
expr_stmt|;
break|break;
default|default:
goto|goto
name|next
goto|;
block|}
block|}
do|while
condition|(
operator|*
operator|(
operator|++
name|ddata
operator|->
name|cur
operator|)
condition|)
do|;
name|next
label|:
name|output
operator|=
name|ddata
operator|->
name|cur_output
expr_stmt|;
if|if
condition|(
operator|!
name|vector_str_init
argument_list|(
operator|&
name|v
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|rtn
operator|=
literal|0
expr_stmt|;
name|limit
operator|=
literal|0
expr_stmt|;
for|for
control|(
init|;
condition|;
control|)
block|{
name|p_idx
operator|=
name|output
operator|->
name|size
expr_stmt|;
switch|switch
condition|(
operator|*
name|ddata
operator|->
name|cur
condition|)
block|{
case|case
literal|'I'
case|:
if|if
condition|(
operator|!
name|cpp_demangle_read_tmpl_args
argument_list|(
name|ddata
argument_list|)
condition|)
goto|goto
name|clean
goto|;
break|break;
case|case
literal|'S'
case|:
if|if
condition|(
operator|!
name|cpp_demangle_read_subst
argument_list|(
name|ddata
argument_list|)
condition|)
goto|goto
name|clean
goto|;
break|break;
case|case
literal|'T'
case|:
if|if
condition|(
operator|!
name|cpp_demangle_read_tmpl_param
argument_list|(
name|ddata
argument_list|)
condition|)
goto|goto
name|clean
goto|;
break|break;
default|default:
if|if
condition|(
operator|!
name|cpp_demangle_read_uqname
argument_list|(
name|ddata
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
if|if
condition|(
name|p_idx
operator|==
name|output
operator|->
name|size
condition|)
goto|goto
name|next_comp
goto|;
if|if
condition|(
operator|(
name|subst_str
operator|=
name|vector_str_substr
argument_list|(
name|output
argument_list|,
name|p_idx
argument_list|,
name|output
operator|->
name|size
operator|-
literal|1
argument_list|,
operator|&
name|subst_str_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|vector_str_push
argument_list|(
operator|&
name|v
argument_list|,
name|subst_str
argument_list|,
name|subst_str_len
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|subst_str
argument_list|)
expr_stmt|;
goto|goto
name|clean
goto|;
block|}
name|free
argument_list|(
name|subst_str
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_push_subst_v
argument_list|(
name|ddata
argument_list|,
operator|&
name|v
argument_list|)
condition|)
goto|goto
name|clean
goto|;
name|next_comp
label|:
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'E'
condition|)
break|break;
elseif|else
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'I'
operator|&&
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'C'
operator|&&
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'D'
operator|&&
name|p_idx
operator|!=
name|output
operator|->
name|size
condition|)
block|{
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"::"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|v
argument_list|,
literal|"::"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
if|if
condition|(
name|limit
operator|++
operator|>
name|CPP_DEMANGLE_TRY_LIMIT
condition|)
goto|goto
name|clean
goto|;
block|}
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
name|rtn
operator|=
literal|1
expr_stmt|;
name|clean
label|:
name|vector_str_dest
argument_list|(
operator|&
name|v
argument_list|)
expr_stmt|;
return|return
operator|(
name|rtn
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * read number  * number ::= [n]<decimal>  */
end_comment

begin_function
specifier|static
name|int
name|cpp_demangle_read_number
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
name|long
modifier|*
name|rtn
parameter_list|)
block|{
name|long
name|len
decl_stmt|,
name|negative_factor
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
name|rtn
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|negative_factor
operator|=
literal|1
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'n'
condition|)
block|{
name|negative_factor
operator|=
operator|-
literal|1
expr_stmt|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
block|}
if|if
condition|(
name|ELFTC_ISDIGIT
argument_list|(
operator|*
name|ddata
operator|->
name|cur
argument_list|)
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|errno
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|(
name|len
operator|=
name|strtol
argument_list|(
name|ddata
operator|->
name|cur
argument_list|,
operator|(
name|char
operator|*
operator|*
operator|)
name|NULL
argument_list|,
literal|10
argument_list|)
operator|)
operator|==
literal|0
operator|&&
name|errno
operator|!=
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
while|while
condition|(
name|ELFTC_ISDIGIT
argument_list|(
operator|*
name|ddata
operator|->
name|cur
argument_list|)
operator|!=
literal|0
condition|)
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
name|assert
argument_list|(
name|len
operator|>=
literal|0
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|negative_factor
operator|==
literal|1
operator|||
name|negative_factor
operator|==
operator|-
literal|1
argument_list|)
expr_stmt|;
operator|*
name|rtn
operator|=
name|len
operator|*
name|negative_factor
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_number_as_string
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
name|char
modifier|*
modifier|*
name|str
parameter_list|)
block|{
name|long
name|n
decl_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_number
argument_list|(
name|ddata
argument_list|,
operator|&
name|n
argument_list|)
condition|)
block|{
operator|*
name|str
operator|=
name|NULL
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
if|if
condition|(
name|asprintf
argument_list|(
name|str
argument_list|,
literal|"%ld"
argument_list|,
name|n
argument_list|)
operator|<
literal|0
condition|)
block|{
operator|*
name|str
operator|=
name|NULL
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_nv_offset
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
if|if
condition|(
name|ddata
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"offset : "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
name|cpp_demangle_read_offset_number
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
block|}
end_function

begin_comment
comment|/* read offset, offset are nv-offset, v-offset */
end_comment

begin_function
specifier|static
name|int
name|cpp_demangle_read_offset
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
if|if
condition|(
name|ddata
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'h'
condition|)
block|{
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_nv_offset
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
block|}
elseif|else
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'v'
condition|)
block|{
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_v_offset
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_offset_number
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
name|bool
name|negative
decl_stmt|;
specifier|const
name|char
modifier|*
name|start
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
comment|/* offset could be negative */
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'n'
condition|)
block|{
name|negative
operator|=
name|true
expr_stmt|;
name|start
operator|=
name|ddata
operator|->
name|cur
operator|+
literal|1
expr_stmt|;
block|}
else|else
block|{
name|negative
operator|=
name|false
expr_stmt|;
name|start
operator|=
name|ddata
operator|->
name|cur
expr_stmt|;
block|}
while|while
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'_'
condition|)
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
name|negative
operator|&&
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"-"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|assert
argument_list|(
name|start
operator|!=
name|NULL
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_push_str
argument_list|(
name|ddata
argument_list|,
name|start
argument_list|,
name|ddata
operator|->
name|cur
operator|-
name|start
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|" "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_pointer_to_member
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
name|struct
name|vector_type_qualifier
modifier|*
name|v
parameter_list|)
block|{
name|size_t
name|class_type_len
decl_stmt|,
name|i
decl_stmt|,
name|idx
decl_stmt|,
name|p_idx
decl_stmt|;
name|int
name|p_func_type
decl_stmt|,
name|rtn
decl_stmt|;
name|char
modifier|*
name|class_type
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'M'
operator|||
operator|*
operator|(
operator|++
name|ddata
operator|->
name|cur
operator|)
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|p_idx
operator|=
name|ddata
operator|->
name|output
operator|.
name|size
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|(
name|class_type
operator|=
name|vector_str_substr
argument_list|(
operator|&
name|ddata
operator|->
name|output
argument_list|,
name|p_idx
argument_list|,
name|ddata
operator|->
name|output
operator|.
name|size
operator|-
literal|1
argument_list|,
operator|&
name|class_type_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|rtn
operator|=
literal|0
expr_stmt|;
name|idx
operator|=
name|ddata
operator|->
name|output
operator|.
name|size
expr_stmt|;
for|for
control|(
name|i
operator|=
name|p_idx
init|;
name|i
operator|<
name|idx
condition|;
operator|++
name|i
control|)
if|if
condition|(
operator|!
name|vector_str_pop
argument_list|(
operator|&
name|ddata
operator|->
name|output
argument_list|)
condition|)
goto|goto
name|clean1
goto|;
if|if
condition|(
operator|!
name|vector_read_cmd_push
argument_list|(
operator|&
name|ddata
operator|->
name|cmd
argument_list|,
name|READ_PTRMEM
argument_list|,
name|v
argument_list|)
condition|)
goto|goto
name|clean1
goto|;
if|if
condition|(
operator|!
name|vector_str_push
argument_list|(
operator|&
name|ddata
operator|->
name|class_type
argument_list|,
name|class_type
argument_list|,
name|class_type_len
argument_list|)
condition|)
goto|goto
name|clean2
goto|;
name|p_func_type
operator|=
name|ddata
operator|->
name|func_type
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
condition|)
goto|goto
name|clean3
goto|;
if|if
condition|(
name|p_func_type
operator|==
name|ddata
operator|->
name|func_type
condition|)
block|{
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|" "
argument_list|)
condition|)
goto|goto
name|clean3
goto|;
if|if
condition|(
operator|!
name|cpp_demangle_push_str
argument_list|(
name|ddata
argument_list|,
name|class_type
argument_list|,
name|class_type_len
argument_list|)
condition|)
goto|goto
name|clean3
goto|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"::*"
argument_list|)
condition|)
goto|goto
name|clean3
goto|;
block|}
name|rtn
operator|=
literal|1
expr_stmt|;
name|clean3
label|:
if|if
condition|(
operator|!
name|vector_str_pop
argument_list|(
operator|&
name|ddata
operator|->
name|class_type
argument_list|)
condition|)
name|rtn
operator|=
literal|0
expr_stmt|;
name|clean2
label|:
if|if
condition|(
operator|!
name|vector_read_cmd_pop
argument_list|(
operator|&
name|ddata
operator|->
name|cmd
argument_list|)
condition|)
name|rtn
operator|=
literal|0
expr_stmt|;
name|clean1
label|:
name|free
argument_list|(
name|class_type
argument_list|)
expr_stmt|;
name|vector_type_qualifier_dest
argument_list|(
name|v
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|vector_type_qualifier_init
argument_list|(
name|v
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
name|rtn
operator|)
return|;
block|}
end_function

begin_comment
comment|/* read source-name, source-name is<len><ID> */
end_comment

begin_function
specifier|static
name|int
name|cpp_demangle_read_sname
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
name|long
name|len
decl_stmt|;
name|int
name|err
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
name|cpp_demangle_read_number
argument_list|(
name|ddata
argument_list|,
operator|&
name|len
argument_list|)
operator|==
literal|0
operator|||
name|len
operator|<=
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
name|len
operator|==
literal|12
operator|&&
operator|(
name|memcmp
argument_list|(
literal|"_GLOBAL__N_1"
argument_list|,
name|ddata
operator|->
name|cur
argument_list|,
literal|12
argument_list|)
operator|==
literal|0
operator|)
condition|)
name|err
operator|=
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"(anonymous namespace)"
argument_list|)
expr_stmt|;
else|else
name|err
operator|=
name|cpp_demangle_push_str
argument_list|(
name|ddata
argument_list|,
name|ddata
operator|->
name|cur
argument_list|,
name|len
argument_list|)
expr_stmt|;
if|if
condition|(
name|err
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|assert
argument_list|(
name|ddata
operator|->
name|output
operator|.
name|size
operator|>
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|vector_read_cmd_find
argument_list|(
operator|&
name|ddata
operator|->
name|cmd
argument_list|,
name|READ_TMPL
argument_list|)
operator|==
name|NULL
condition|)
name|ddata
operator|->
name|last_sname
operator|=
name|ddata
operator|->
name|output
operator|.
name|container
index|[
name|ddata
operator|->
name|output
operator|.
name|size
operator|-
literal|1
index|]
expr_stmt|;
name|ddata
operator|->
name|cur
operator|+=
name|len
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_subst
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
name|long
name|nth
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
comment|/* abbreviations of the form Sx */
switch|switch
condition|(
name|SIMPLE_HASH
argument_list|(
operator|*
name|ddata
operator|->
name|cur
argument_list|,
operator|*
operator|(
name|ddata
operator|->
name|cur
operator|+
literal|1
operator|)
argument_list|)
condition|)
block|{
case|case
name|SIMPLE_HASH
argument_list|(
literal|'S'
argument_list|,
literal|'a'
argument_list|)
case|:
comment|/* std::allocator */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"std::allocator"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'I'
condition|)
return|return
operator|(
name|cpp_demangle_read_subst_stdtmpl
argument_list|(
name|ddata
argument_list|,
literal|"std::allocator"
argument_list|)
operator|)
return|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'S'
argument_list|,
literal|'b'
argument_list|)
case|:
comment|/* std::basic_string */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"std::basic_string"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'I'
condition|)
return|return
operator|(
name|cpp_demangle_read_subst_stdtmpl
argument_list|(
name|ddata
argument_list|,
literal|"std::basic_string"
argument_list|)
operator|)
return|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'S'
argument_list|,
literal|'d'
argument_list|)
case|:
comment|/* std::basic_iostream<char, std::char_traits<char>> */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"std::basic_iostream<char, "
literal|"std::char_traits<char>>"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|last_sname
operator|=
literal|"basic_iostream"
expr_stmt|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'I'
condition|)
return|return
operator|(
name|cpp_demangle_read_subst_stdtmpl
argument_list|(
name|ddata
argument_list|,
literal|"std::basic_iostream<char, std::char_traits"
literal|"<char>>"
argument_list|)
operator|)
return|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'S'
argument_list|,
literal|'i'
argument_list|)
case|:
comment|/* std::basic_istream<char, std::char_traits<char>> */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"std::basic_istream<char, "
literal|"std::char_traits<char>>"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|last_sname
operator|=
literal|"basic_istream"
expr_stmt|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'I'
condition|)
return|return
operator|(
name|cpp_demangle_read_subst_stdtmpl
argument_list|(
name|ddata
argument_list|,
literal|"std::basic_istream<char, std::char_traits"
literal|"<char>>"
argument_list|)
operator|)
return|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'S'
argument_list|,
literal|'o'
argument_list|)
case|:
comment|/* std::basic_ostream<char, std::char_traits<char>> */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"std::basic_ostream<char, "
literal|"std::char_traits<char>>"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|last_sname
operator|=
literal|"basic_ostream"
expr_stmt|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'I'
condition|)
return|return
operator|(
name|cpp_demangle_read_subst_stdtmpl
argument_list|(
name|ddata
argument_list|,
literal|"std::basic_ostream<char, std::char_traits"
literal|"<char>>"
argument_list|)
operator|)
return|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'S'
argument_list|,
literal|'s'
argument_list|)
case|:
comment|/* 		 * std::basic_string<char, std::char_traits<char>, 		 * std::allocator<char>> 		 * 		 * a.k.a std::string 		 */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"std::basic_string<char, "
literal|"std::char_traits<char>, std::allocator<char>>"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|last_sname
operator|=
literal|"string"
expr_stmt|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'I'
condition|)
return|return
operator|(
name|cpp_demangle_read_subst_stdtmpl
argument_list|(
name|ddata
argument_list|,
literal|"std::basic_string<char, std::char_traits<char>,"
literal|" std::allocator<char>>"
argument_list|)
operator|)
return|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'S'
argument_list|,
literal|'t'
argument_list|)
case|:
comment|/* std:: */
return|return
operator|(
name|cpp_demangle_read_subst_std
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
block|}
if|if
condition|(
operator|*
operator|(
operator|++
name|ddata
operator|->
name|cur
operator|)
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
comment|/* Skip unknown substitution abbreviations. */
if|if
condition|(
operator|!
operator|(
operator|*
name|ddata
operator|->
name|cur
operator|>=
literal|'0'
operator|&&
operator|*
name|ddata
operator|->
name|cur
operator|<=
literal|'9'
operator|)
operator|&&
operator|!
operator|(
operator|*
name|ddata
operator|->
name|cur
operator|>=
literal|'A'
operator|&&
operator|*
name|ddata
operator|->
name|cur
operator|<=
literal|'Z'
operator|)
operator|&&
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'_'
condition|)
block|{
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
comment|/* substitution */
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'_'
condition|)
return|return
operator|(
name|cpp_demangle_get_subst
argument_list|(
name|ddata
argument_list|,
literal|0
argument_list|)
operator|)
return|;
else|else
block|{
name|errno
operator|=
literal|0
expr_stmt|;
comment|/* substitution number is base 36 */
if|if
condition|(
operator|(
name|nth
operator|=
name|strtol
argument_list|(
name|ddata
operator|->
name|cur
argument_list|,
operator|(
name|char
operator|*
operator|*
operator|)
name|NULL
argument_list|,
literal|36
argument_list|)
operator|)
operator|==
literal|0
operator|&&
name|errno
operator|!=
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
comment|/* first was '_', so increase one */
operator|++
name|nth
expr_stmt|;
while|while
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'_'
condition|)
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
name|assert
argument_list|(
name|nth
operator|>
literal|0
argument_list|)
expr_stmt|;
return|return
operator|(
name|cpp_demangle_get_subst
argument_list|(
name|ddata
argument_list|,
name|nth
argument_list|)
operator|)
return|;
block|}
comment|/* NOTREACHED */
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_subst_std
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
name|struct
name|vector_str
modifier|*
name|output
decl_stmt|,
name|v
decl_stmt|;
name|size_t
name|p_idx
decl_stmt|,
name|subst_str_len
decl_stmt|;
name|int
name|rtn
decl_stmt|;
name|char
modifier|*
name|subst_str
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|vector_str_init
argument_list|(
operator|&
name|v
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|subst_str
operator|=
name|NULL
expr_stmt|;
name|rtn
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"std::"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|v
argument_list|,
literal|"std::"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
name|output
operator|=
name|ddata
operator|->
name|cur_output
expr_stmt|;
name|p_idx
operator|=
name|output
operator|->
name|size
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_uqname
argument_list|(
name|ddata
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|(
name|subst_str
operator|=
name|vector_str_substr
argument_list|(
name|output
argument_list|,
name|p_idx
argument_list|,
name|output
operator|->
name|size
operator|-
literal|1
argument_list|,
operator|&
name|subst_str_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|vector_str_push
argument_list|(
operator|&
name|v
argument_list|,
name|subst_str
argument_list|,
name|subst_str_len
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|cpp_demangle_push_subst_v
argument_list|(
name|ddata
argument_list|,
operator|&
name|v
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'I'
condition|)
block|{
name|p_idx
operator|=
name|output
operator|->
name|size
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_tmpl_args
argument_list|(
name|ddata
argument_list|)
condition|)
goto|goto
name|clean
goto|;
name|free
argument_list|(
name|subst_str
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|subst_str
operator|=
name|vector_str_substr
argument_list|(
name|output
argument_list|,
name|p_idx
argument_list|,
name|output
operator|->
name|size
operator|-
literal|1
argument_list|,
operator|&
name|subst_str_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|vector_str_push
argument_list|(
operator|&
name|v
argument_list|,
name|subst_str
argument_list|,
name|subst_str_len
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|cpp_demangle_push_subst_v
argument_list|(
name|ddata
argument_list|,
operator|&
name|v
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
name|rtn
operator|=
literal|1
expr_stmt|;
name|clean
label|:
name|free
argument_list|(
name|subst_str
argument_list|)
expr_stmt|;
name|vector_str_dest
argument_list|(
operator|&
name|v
argument_list|)
expr_stmt|;
return|return
operator|(
name|rtn
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_subst_stdtmpl
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
specifier|const
name|char
modifier|*
name|str
parameter_list|)
block|{
name|struct
name|vector_str
modifier|*
name|output
decl_stmt|;
name|size_t
name|p_idx
decl_stmt|,
name|substr_len
decl_stmt|,
name|len
decl_stmt|;
name|int
name|rtn
decl_stmt|;
name|char
modifier|*
name|subst_str
decl_stmt|,
modifier|*
name|substr
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
name|str
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|(
name|len
operator|=
name|strlen
argument_list|(
name|str
argument_list|)
operator|)
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|output
operator|=
name|ddata
operator|->
name|cur_output
expr_stmt|;
name|p_idx
operator|=
name|output
operator|->
name|size
expr_stmt|;
name|substr
operator|=
name|NULL
expr_stmt|;
name|subst_str
operator|=
name|NULL
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_tmpl_args
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|(
name|substr
operator|=
name|vector_str_substr
argument_list|(
name|output
argument_list|,
name|p_idx
argument_list|,
name|output
operator|->
name|size
operator|-
literal|1
argument_list|,
operator|&
name|substr_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|rtn
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|(
name|subst_str
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
name|char
argument_list|)
operator|*
operator|(
name|substr_len
operator|+
name|len
operator|+
literal|1
operator|)
argument_list|)
operator|)
operator|==
name|NULL
condition|)
goto|goto
name|clean
goto|;
name|memcpy
argument_list|(
name|subst_str
argument_list|,
name|str
argument_list|,
name|len
argument_list|)
expr_stmt|;
name|memcpy
argument_list|(
name|subst_str
operator|+
name|len
argument_list|,
name|substr
argument_list|,
name|substr_len
argument_list|)
expr_stmt|;
name|subst_str
index|[
name|substr_len
operator|+
name|len
index|]
operator|=
literal|'\0'
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_push_subst
argument_list|(
name|ddata
argument_list|,
name|subst_str
argument_list|,
name|substr_len
operator|+
name|len
argument_list|)
condition|)
goto|goto
name|clean
goto|;
name|rtn
operator|=
literal|1
expr_stmt|;
name|clean
label|:
name|free
argument_list|(
name|subst_str
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|substr
argument_list|)
expr_stmt|;
return|return
operator|(
name|rtn
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_tmpl_arg
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
switch|switch
condition|(
operator|*
name|ddata
operator|->
name|cur
condition|)
block|{
case|case
literal|'L'
case|:
return|return
operator|(
name|cpp_demangle_read_expr_primary
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
case|case
literal|'X'
case|:
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_expression
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
operator|*
name|ddata
operator|->
name|cur
operator|++
operator|==
literal|'E'
operator|)
return|;
block|}
return|return
operator|(
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_tmpl_args
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
name|struct
name|vector_str
modifier|*
name|v
decl_stmt|;
name|size_t
name|arg_len
decl_stmt|,
name|idx
decl_stmt|,
name|limit
decl_stmt|,
name|size
decl_stmt|;
name|char
modifier|*
name|arg
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
operator|!
name|vector_read_cmd_push
argument_list|(
operator|&
name|ddata
operator|->
name|cmd
argument_list|,
name|READ_TMPL
argument_list|,
name|NULL
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"<"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|limit
operator|=
literal|0
expr_stmt|;
name|v
operator|=
operator|&
name|ddata
operator|->
name|output
expr_stmt|;
for|for
control|(
init|;
condition|;
control|)
block|{
name|idx
operator|=
name|v
operator|->
name|size
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_tmpl_arg
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|(
name|arg
operator|=
name|vector_str_substr
argument_list|(
name|v
argument_list|,
name|idx
argument_list|,
name|v
operator|->
name|size
operator|-
literal|1
argument_list|,
operator|&
name|arg_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|vector_str_find
argument_list|(
operator|&
name|ddata
operator|->
name|tmpl
argument_list|,
name|arg
argument_list|,
name|arg_len
argument_list|)
operator|&&
operator|!
name|vector_str_push
argument_list|(
operator|&
name|ddata
operator|->
name|tmpl
argument_list|,
name|arg
argument_list|,
name|arg_len
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|arg
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
name|free
argument_list|(
name|arg
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'E'
condition|)
block|{
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
name|size
operator|=
name|v
operator|->
name|size
expr_stmt|;
name|assert
argument_list|(
name|size
operator|>
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|strncmp
argument_list|(
name|v
operator|->
name|container
index|[
name|size
operator|-
literal|1
index|]
argument_list|,
literal|">"
argument_list|,
literal|1
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|">"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
block|}
elseif|else
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|">"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|is_tmpl
operator|=
name|true
expr_stmt|;
break|break;
block|}
elseif|else
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'I'
operator|&&
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|", "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
name|limit
operator|++
operator|>
name|CPP_DEMANGLE_TRY_LIMIT
condition|)
return|return
operator|(
literal|0
operator|)
return|;
block|}
return|return
operator|(
name|vector_read_cmd_pop
argument_list|(
operator|&
name|ddata
operator|->
name|cmd
argument_list|)
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Read template parameter that forms in 'T[number]_'.  * This function much like to read_subst but only for types.  */
end_comment

begin_function
specifier|static
name|int
name|cpp_demangle_read_tmpl_param
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
name|long
name|nth
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'T'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'_'
condition|)
return|return
operator|(
name|cpp_demangle_get_tmpl_param
argument_list|(
name|ddata
argument_list|,
literal|0
argument_list|)
operator|)
return|;
else|else
block|{
name|errno
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|(
name|nth
operator|=
name|strtol
argument_list|(
name|ddata
operator|->
name|cur
argument_list|,
operator|(
name|char
operator|*
operator|*
operator|)
name|NULL
argument_list|,
literal|36
argument_list|)
operator|)
operator|==
literal|0
operator|&&
name|errno
operator|!=
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
comment|/* T_ is first */
operator|++
name|nth
expr_stmt|;
while|while
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'_'
condition|)
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
name|assert
argument_list|(
name|nth
operator|>
literal|0
argument_list|)
expr_stmt|;
return|return
operator|(
name|cpp_demangle_get_tmpl_param
argument_list|(
name|ddata
argument_list|,
name|nth
argument_list|)
operator|)
return|;
block|}
comment|/* NOTREACHED */
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_type
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
name|struct
name|type_delimit
modifier|*
name|td
parameter_list|)
block|{
name|struct
name|vector_type_qualifier
name|v
decl_stmt|;
name|struct
name|vector_str
modifier|*
name|output
decl_stmt|,
name|sv
decl_stmt|;
name|size_t
name|p_idx
decl_stmt|,
name|type_str_len
decl_stmt|,
name|subst_str_len
decl_stmt|;
name|int
name|extern_c
decl_stmt|,
name|is_builtin
decl_stmt|;
name|long
name|len
decl_stmt|;
specifier|const
name|char
modifier|*
name|p
decl_stmt|;
name|char
modifier|*
name|type_str
decl_stmt|,
modifier|*
name|exp_str
decl_stmt|,
modifier|*
name|num_str
decl_stmt|,
modifier|*
name|subst_str
decl_stmt|;
name|bool
name|skip_ref_qualifier
decl_stmt|,
name|omit_void
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|output
operator|=
name|ddata
operator|->
name|cur_output
expr_stmt|;
if|if
condition|(
name|td
condition|)
block|{
if|if
condition|(
name|td
operator|->
name|paren
operator|==
name|false
condition|)
block|{
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"("
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
name|ddata
operator|->
name|output
operator|.
name|size
operator|<
literal|2
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|td
operator|->
name|paren
operator|=
name|true
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|td
operator|->
name|firstp
condition|)
block|{
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'I'
condition|)
block|{
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|", "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
block|}
block|}
block|}
name|assert
argument_list|(
name|output
operator|!=
name|NULL
argument_list|)
expr_stmt|;
comment|/* 	 * [r, V, K] [P, R, O, C, G, U] builtin, function, class-enum, array 	 * pointer-to-member, template-param, template-template-param, subst 	 */
if|if
condition|(
operator|!
name|vector_type_qualifier_init
argument_list|(
operator|&
name|v
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|extern_c
operator|=
literal|0
expr_stmt|;
name|is_builtin
operator|=
literal|1
expr_stmt|;
name|p_idx
operator|=
name|output
operator|->
name|size
expr_stmt|;
name|type_str
operator|=
name|exp_str
operator|=
name|num_str
operator|=
name|NULL
expr_stmt|;
name|skip_ref_qualifier
operator|=
name|false
expr_stmt|;
name|again
label|:
comment|/* Clear ref-qualifier flag */
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'R'
operator|&&
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'O'
operator|&&
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'E'
condition|)
name|ddata
operator|->
name|ref_qualifier
operator|=
name|false
expr_stmt|;
comment|/* builtin type */
switch|switch
condition|(
operator|*
name|ddata
operator|->
name|cur
condition|)
block|{
case|case
literal|'a'
case|:
comment|/* signed char */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"signed char"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'A'
case|:
comment|/* array type */
if|if
condition|(
operator|!
name|cpp_demangle_read_array
argument_list|(
name|ddata
argument_list|)
condition|)
goto|goto
name|clean
goto|;
name|is_builtin
operator|=
literal|0
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'b'
case|:
comment|/* bool */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"bool"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'C'
case|:
comment|/* complex pair */
if|if
condition|(
operator|!
name|vector_type_qualifier_push
argument_list|(
operator|&
name|v
argument_list|,
name|TYPE_CMX
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
name|td
condition|)
name|td
operator|->
name|firstp
operator|=
name|false
expr_stmt|;
goto|goto
name|again
goto|;
case|case
literal|'c'
case|:
comment|/* char */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"char"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'d'
case|:
comment|/* double */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"double"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'D'
case|:
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
switch|switch
condition|(
operator|*
name|ddata
operator|->
name|cur
condition|)
block|{
case|case
literal|'a'
case|:
comment|/* auto */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"auto"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
break|break;
case|case
literal|'c'
case|:
comment|/* decltype(auto) */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"decltype(auto)"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
break|break;
case|case
literal|'d'
case|:
comment|/* IEEE 754r decimal floating point (64 bits) */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"decimal64"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
break|break;
case|case
literal|'e'
case|:
comment|/* IEEE 754r decimal floating point (128 bits) */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"decimal128"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
break|break;
case|case
literal|'f'
case|:
comment|/* IEEE 754r decimal floating point (32 bits) */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"decimal32"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
break|break;
case|case
literal|'h'
case|:
comment|/* IEEE 754r half-precision floating point (16 bits) */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"half"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
break|break;
case|case
literal|'i'
case|:
comment|/* char32_t */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"char32_t"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
break|break;
case|case
literal|'n'
case|:
comment|/* std::nullptr_t (i.e., decltype(nullptr)) */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"decltype(nullptr)"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
break|break;
case|case
literal|'s'
case|:
comment|/* char16_t */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"char16_t"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
break|break;
case|case
literal|'v'
case|:
comment|/* gcc vector_size extension. */
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'_'
condition|)
block|{
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_expression_flat
argument_list|(
name|ddata
argument_list|,
operator|&
name|exp_str
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|v
operator|.
name|ext_name
argument_list|,
name|exp_str
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
else|else
block|{
if|if
condition|(
operator|!
name|cpp_demangle_read_number_as_string
argument_list|(
name|ddata
argument_list|,
operator|&
name|num_str
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|VEC_PUSH_STR
argument_list|(
operator|&
name|v
operator|.
name|ext_name
argument_list|,
name|num_str
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'_'
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
operator|!
name|vector_type_qualifier_push
argument_list|(
operator|&
name|v
argument_list|,
name|TYPE_VEC
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|td
condition|)
name|td
operator|->
name|firstp
operator|=
name|false
expr_stmt|;
goto|goto
name|again
goto|;
default|default:
goto|goto
name|clean
goto|;
block|}
goto|goto
name|rtn
goto|;
case|case
literal|'e'
case|:
comment|/* long double */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"long double"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'E'
case|:
comment|/* unexpected end except ref-qualifiers */
if|if
condition|(
name|ddata
operator|->
name|ref_qualifier
operator|&&
name|ddata
operator|->
name|is_functype
condition|)
block|{
name|skip_ref_qualifier
operator|=
name|true
expr_stmt|;
comment|/* Pop the delimiter. */
name|cpp_demangle_pop_str
argument_list|(
name|ddata
argument_list|)
expr_stmt|;
goto|goto
name|rtn
goto|;
block|}
goto|goto
name|clean
goto|;
case|case
literal|'f'
case|:
comment|/* float */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"float"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'F'
case|:
comment|/* function */
if|if
condition|(
operator|!
name|cpp_demangle_read_function
argument_list|(
name|ddata
argument_list|,
operator|&
name|extern_c
argument_list|,
operator|&
name|v
argument_list|)
condition|)
goto|goto
name|clean
goto|;
name|is_builtin
operator|=
literal|0
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'g'
case|:
comment|/* __float128 */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"__float128"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'G'
case|:
comment|/* imaginary */
if|if
condition|(
operator|!
name|vector_type_qualifier_push
argument_list|(
operator|&
name|v
argument_list|,
name|TYPE_IMG
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
name|td
condition|)
name|td
operator|->
name|firstp
operator|=
name|false
expr_stmt|;
goto|goto
name|again
goto|;
case|case
literal|'h'
case|:
comment|/* unsigned char */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"unsigned char"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'i'
case|:
comment|/* int */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"int"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'I'
case|:
comment|/* template args. */
comment|/* handles<substitute><template-args> */
name|p_idx
operator|=
name|output
operator|->
name|size
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_tmpl_args
argument_list|(
name|ddata
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|(
name|subst_str
operator|=
name|vector_str_substr
argument_list|(
name|output
argument_list|,
name|p_idx
argument_list|,
name|output
operator|->
name|size
operator|-
literal|1
argument_list|,
operator|&
name|subst_str_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|vector_str_init
argument_list|(
operator|&
name|sv
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|subst_str
argument_list|)
expr_stmt|;
goto|goto
name|clean
goto|;
block|}
if|if
condition|(
operator|!
name|vector_str_push
argument_list|(
operator|&
name|sv
argument_list|,
name|subst_str
argument_list|,
name|subst_str_len
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|subst_str
argument_list|)
expr_stmt|;
name|vector_str_dest
argument_list|(
operator|&
name|sv
argument_list|)
expr_stmt|;
goto|goto
name|clean
goto|;
block|}
name|free
argument_list|(
name|subst_str
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_push_subst_v
argument_list|(
name|ddata
argument_list|,
operator|&
name|sv
argument_list|)
condition|)
block|{
name|vector_str_dest
argument_list|(
operator|&
name|sv
argument_list|)
expr_stmt|;
goto|goto
name|clean
goto|;
block|}
name|vector_str_dest
argument_list|(
operator|&
name|sv
argument_list|)
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'j'
case|:
comment|/* unsigned int */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"unsigned int"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'K'
case|:
comment|/* const */
if|if
condition|(
operator|!
name|vector_type_qualifier_push
argument_list|(
operator|&
name|v
argument_list|,
name|TYPE_CST
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
name|td
condition|)
name|td
operator|->
name|firstp
operator|=
name|false
expr_stmt|;
goto|goto
name|again
goto|;
case|case
literal|'l'
case|:
comment|/* long */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"long"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'m'
case|:
comment|/* unsigned long */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"unsigned long"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'M'
case|:
comment|/* pointer to member */
if|if
condition|(
operator|!
name|cpp_demangle_read_pointer_to_member
argument_list|(
name|ddata
argument_list|,
operator|&
name|v
argument_list|)
condition|)
goto|goto
name|clean
goto|;
name|is_builtin
operator|=
literal|0
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'n'
case|:
comment|/* __int128 */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"__int128"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'o'
case|:
comment|/* unsigned __int128 */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"unsigned __int128"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'O'
case|:
comment|/* rvalue reference */
if|if
condition|(
name|ddata
operator|->
name|ref_qualifier
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|vector_type_qualifier_push
argument_list|(
operator|&
name|v
argument_list|,
name|TYPE_RREF
argument_list|)
condition|)
goto|goto
name|clean
goto|;
name|ddata
operator|->
name|ref_qualifier
operator|=
name|true
expr_stmt|;
name|ddata
operator|->
name|ref_qualifier_type
operator|=
name|TYPE_RREF
expr_stmt|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
name|td
condition|)
name|td
operator|->
name|firstp
operator|=
name|false
expr_stmt|;
goto|goto
name|again
goto|;
case|case
literal|'P'
case|:
comment|/* pointer */
if|if
condition|(
operator|!
name|vector_type_qualifier_push
argument_list|(
operator|&
name|v
argument_list|,
name|TYPE_PTR
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
name|td
condition|)
name|td
operator|->
name|firstp
operator|=
name|false
expr_stmt|;
goto|goto
name|again
goto|;
case|case
literal|'r'
case|:
comment|/* restrict */
if|if
condition|(
operator|!
name|vector_type_qualifier_push
argument_list|(
operator|&
name|v
argument_list|,
name|TYPE_RST
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
name|td
condition|)
name|td
operator|->
name|firstp
operator|=
name|false
expr_stmt|;
goto|goto
name|again
goto|;
case|case
literal|'R'
case|:
comment|/* reference */
if|if
condition|(
name|ddata
operator|->
name|ref_qualifier
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|vector_type_qualifier_push
argument_list|(
operator|&
name|v
argument_list|,
name|TYPE_REF
argument_list|)
condition|)
goto|goto
name|clean
goto|;
name|ddata
operator|->
name|ref_qualifier
operator|=
name|true
expr_stmt|;
name|ddata
operator|->
name|ref_qualifier_type
operator|=
name|TYPE_REF
expr_stmt|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
name|td
condition|)
name|td
operator|->
name|firstp
operator|=
name|false
expr_stmt|;
goto|goto
name|again
goto|;
case|case
literal|'s'
case|:
comment|/* short, local string */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"short"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'S'
case|:
comment|/* substitution */
if|if
condition|(
operator|!
name|cpp_demangle_read_subst
argument_list|(
name|ddata
argument_list|)
condition|)
goto|goto
name|clean
goto|;
name|is_builtin
operator|=
literal|0
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'t'
case|:
comment|/* unsigned short */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"unsigned short"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'T'
case|:
comment|/* template parameter */
if|if
condition|(
operator|!
name|cpp_demangle_read_tmpl_param
argument_list|(
name|ddata
argument_list|)
condition|)
goto|goto
name|clean
goto|;
name|is_builtin
operator|=
literal|0
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'u'
case|:
comment|/* vendor extended builtin */
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_sname
argument_list|(
name|ddata
argument_list|)
condition|)
goto|goto
name|clean
goto|;
name|is_builtin
operator|=
literal|0
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'U'
case|:
comment|/* vendor extended type qualifier */
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_number
argument_list|(
name|ddata
argument_list|,
operator|&
name|len
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|len
operator|<=
literal|0
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
operator|!
name|vector_str_push
argument_list|(
operator|&
name|v
operator|.
name|ext_name
argument_list|,
name|ddata
operator|->
name|cur
argument_list|,
name|len
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
name|len
expr_stmt|;
if|if
condition|(
operator|!
name|vector_type_qualifier_push
argument_list|(
operator|&
name|v
argument_list|,
name|TYPE_EXT
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|td
condition|)
name|td
operator|->
name|firstp
operator|=
name|false
expr_stmt|;
goto|goto
name|again
goto|;
case|case
literal|'v'
case|:
comment|/* void */
name|omit_void
operator|=
name|false
expr_stmt|;
if|if
condition|(
name|td
operator|&&
name|td
operator|->
name|firstp
condition|)
block|{
comment|/* 			 * peek into next bytes and see if we should omit 			 * the "void". 			 */
name|omit_void
operator|=
name|true
expr_stmt|;
for|for
control|(
name|p
operator|=
name|ddata
operator|->
name|cur
operator|+
literal|1
init|;
operator|*
name|p
operator|!=
literal|'\0'
condition|;
name|p
operator|++
control|)
block|{
if|if
condition|(
operator|*
name|p
operator|==
literal|'E'
condition|)
break|break;
if|if
condition|(
operator|*
name|p
operator|!=
literal|'R'
operator|&&
operator|*
name|p
operator|!=
literal|'O'
condition|)
block|{
name|omit_void
operator|=
name|false
expr_stmt|;
break|break;
block|}
block|}
block|}
if|if
condition|(
operator|!
name|omit_void
operator|&&
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"void"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'V'
case|:
comment|/* volatile */
if|if
condition|(
operator|!
name|vector_type_qualifier_push
argument_list|(
operator|&
name|v
argument_list|,
name|TYPE_VAT
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
if|if
condition|(
name|td
condition|)
name|td
operator|->
name|firstp
operator|=
name|false
expr_stmt|;
goto|goto
name|again
goto|;
case|case
literal|'w'
case|:
comment|/* wchar_t */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"wchar_t"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'x'
case|:
comment|/* long long */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"long long"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'y'
case|:
comment|/* unsigned long long */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"unsigned long long"
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
case|case
literal|'z'
case|:
comment|/* ellipsis */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"..."
argument_list|)
condition|)
goto|goto
name|clean
goto|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
goto|goto
name|rtn
goto|;
block|}
if|if
condition|(
operator|!
name|cpp_demangle_read_name
argument_list|(
name|ddata
argument_list|)
condition|)
goto|goto
name|clean
goto|;
name|is_builtin
operator|=
literal|0
expr_stmt|;
name|rtn
label|:
name|type_str
operator|=
name|vector_str_substr
argument_list|(
name|output
argument_list|,
name|p_idx
argument_list|,
name|output
operator|->
name|size
operator|-
literal|1
argument_list|,
operator|&
name|type_str_len
argument_list|)
expr_stmt|;
if|if
condition|(
name|is_builtin
operator|==
literal|0
condition|)
block|{
if|if
condition|(
operator|!
name|vector_str_find
argument_list|(
operator|&
name|ddata
operator|->
name|subst
argument_list|,
name|type_str
argument_list|,
name|type_str_len
argument_list|)
operator|&&
operator|!
name|vector_str_push
argument_list|(
operator|&
name|ddata
operator|->
name|subst
argument_list|,
name|type_str
argument_list|,
name|type_str_len
argument_list|)
condition|)
goto|goto
name|clean
goto|;
block|}
if|if
condition|(
operator|!
name|skip_ref_qualifier
operator|&&
operator|!
name|cpp_demangle_push_type_qualifier
argument_list|(
name|ddata
argument_list|,
operator|&
name|v
argument_list|,
name|type_str
argument_list|)
condition|)
goto|goto
name|clean
goto|;
if|if
condition|(
name|td
condition|)
name|td
operator|->
name|firstp
operator|=
name|false
expr_stmt|;
name|free
argument_list|(
name|type_str
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|exp_str
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|num_str
argument_list|)
expr_stmt|;
name|vector_type_qualifier_dest
argument_list|(
operator|&
name|v
argument_list|)
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
name|clean
label|:
name|free
argument_list|(
name|type_str
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|exp_str
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|num_str
argument_list|)
expr_stmt|;
name|vector_type_qualifier_dest
argument_list|(
operator|&
name|v
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_type_flat
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|,
name|char
modifier|*
modifier|*
name|str
parameter_list|)
block|{
name|struct
name|vector_str
modifier|*
name|output
decl_stmt|;
name|size_t
name|i
decl_stmt|,
name|p_idx
decl_stmt|,
name|idx
decl_stmt|,
name|type_len
decl_stmt|;
name|char
modifier|*
name|type
decl_stmt|;
name|output
operator|=
name|ddata
operator|->
name|cur_output
expr_stmt|;
name|p_idx
operator|=
name|output
operator|->
name|size
expr_stmt|;
if|if
condition|(
operator|!
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|(
name|type
operator|=
name|vector_str_substr
argument_list|(
name|output
argument_list|,
name|p_idx
argument_list|,
name|output
operator|->
name|size
operator|-
literal|1
argument_list|,
operator|&
name|type_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|idx
operator|=
name|output
operator|->
name|size
expr_stmt|;
for|for
control|(
name|i
operator|=
name|p_idx
init|;
name|i
operator|<
name|idx
condition|;
operator|++
name|i
control|)
block|{
if|if
condition|(
operator|!
name|vector_str_pop
argument_list|(
name|output
argument_list|)
condition|)
block|{
name|free
argument_list|(
name|type
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
block|}
operator|*
name|str
operator|=
name|type
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * read unqualified-name, unqualified name are operator-name, ctor-dtor-name,  * source-name  */
end_comment

begin_function
specifier|static
name|int
name|cpp_demangle_read_uqname
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
name|size_t
name|len
decl_stmt|;
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'\0'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
comment|/* operator name */
switch|switch
condition|(
name|SIMPLE_HASH
argument_list|(
operator|*
name|ddata
operator|->
name|cur
argument_list|,
operator|*
operator|(
name|ddata
operator|->
name|cur
operator|+
literal|1
operator|)
argument_list|)
condition|)
block|{
case|case
name|SIMPLE_HASH
argument_list|(
literal|'a'
argument_list|,
literal|'a'
argument_list|)
case|:
comment|/* operator&& */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator&&"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'a'
argument_list|,
literal|'d'
argument_list|)
case|:
comment|/* operator& (unary) */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator&"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'a'
argument_list|,
literal|'n'
argument_list|)
case|:
comment|/* operator& */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator&"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'a'
argument_list|,
literal|'N'
argument_list|)
case|:
comment|/* operator&= */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator&="
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'a'
argument_list|,
literal|'S'
argument_list|)
case|:
comment|/* operator = */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator="
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'c'
argument_list|,
literal|'l'
argument_list|)
case|:
comment|/* operator () */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator()"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'c'
argument_list|,
literal|'m'
argument_list|)
case|:
comment|/* operator , */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator,"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'c'
argument_list|,
literal|'o'
argument_list|)
case|:
comment|/* operator ~ */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator~"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'c'
argument_list|,
literal|'v'
argument_list|)
case|:
comment|/* operator (cast) */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator(cast)"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_type
argument_list|(
name|ddata
argument_list|,
name|NULL
argument_list|)
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'d'
argument_list|,
literal|'a'
argument_list|)
case|:
comment|/* operator delete [] */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator delete []"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'d'
argument_list|,
literal|'e'
argument_list|)
case|:
comment|/* operator * (unary) */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator*"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'d'
argument_list|,
literal|'l'
argument_list|)
case|:
comment|/* operator delete */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator delete"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'d'
argument_list|,
literal|'v'
argument_list|)
case|:
comment|/* operator / */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator/"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'d'
argument_list|,
literal|'V'
argument_list|)
case|:
comment|/* operator /= */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator/="
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'e'
argument_list|,
literal|'o'
argument_list|)
case|:
comment|/* operator ^ */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator^"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'e'
argument_list|,
literal|'O'
argument_list|)
case|:
comment|/* operator ^= */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator^="
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'e'
argument_list|,
literal|'q'
argument_list|)
case|:
comment|/* operator == */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator=="
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'g'
argument_list|,
literal|'e'
argument_list|)
case|:
comment|/* operator>= */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator>="
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'g'
argument_list|,
literal|'t'
argument_list|)
case|:
comment|/* operator> */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator>"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'i'
argument_list|,
literal|'x'
argument_list|)
case|:
comment|/* operator [] */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator[]"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'l'
argument_list|,
literal|'e'
argument_list|)
case|:
comment|/* operator<= */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator<="
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'l'
argument_list|,
literal|'s'
argument_list|)
case|:
comment|/* operator<< */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator<<"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'l'
argument_list|,
literal|'S'
argument_list|)
case|:
comment|/* operator<<= */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator<<="
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'l'
argument_list|,
literal|'t'
argument_list|)
case|:
comment|/* operator< */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator<"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'m'
argument_list|,
literal|'i'
argument_list|)
case|:
comment|/* operator - */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator-"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'m'
argument_list|,
literal|'I'
argument_list|)
case|:
comment|/* operator -= */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator-="
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'m'
argument_list|,
literal|'l'
argument_list|)
case|:
comment|/* operator * */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator*"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'m'
argument_list|,
literal|'L'
argument_list|)
case|:
comment|/* operator *= */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator*="
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'m'
argument_list|,
literal|'m'
argument_list|)
case|:
comment|/* operator -- */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator--"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'n'
argument_list|,
literal|'a'
argument_list|)
case|:
comment|/* operator new[] */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator new []"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'n'
argument_list|,
literal|'e'
argument_list|)
case|:
comment|/* operator != */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator!="
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'n'
argument_list|,
literal|'g'
argument_list|)
case|:
comment|/* operator - (unary) */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator-"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'n'
argument_list|,
literal|'t'
argument_list|)
case|:
comment|/* operator ! */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator!"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'n'
argument_list|,
literal|'w'
argument_list|)
case|:
comment|/* operator new */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator new"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'o'
argument_list|,
literal|'o'
argument_list|)
case|:
comment|/* operator || */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator||"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'o'
argument_list|,
literal|'r'
argument_list|)
case|:
comment|/* operator | */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator|"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'o'
argument_list|,
literal|'R'
argument_list|)
case|:
comment|/* operator |= */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator|="
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'p'
argument_list|,
literal|'l'
argument_list|)
case|:
comment|/* operator + */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator+"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'p'
argument_list|,
literal|'L'
argument_list|)
case|:
comment|/* operator += */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator+="
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'p'
argument_list|,
literal|'m'
argument_list|)
case|:
comment|/* operator ->* */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator->*"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'p'
argument_list|,
literal|'p'
argument_list|)
case|:
comment|/* operator ++ */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator++"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'p'
argument_list|,
literal|'s'
argument_list|)
case|:
comment|/* operator + (unary) */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator+"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'p'
argument_list|,
literal|'t'
argument_list|)
case|:
comment|/* operator -> */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator->"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'q'
argument_list|,
literal|'u'
argument_list|)
case|:
comment|/* operator ? */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator?"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'r'
argument_list|,
literal|'m'
argument_list|)
case|:
comment|/* operator % */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator%"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'r'
argument_list|,
literal|'M'
argument_list|)
case|:
comment|/* operator %= */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator%="
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'r'
argument_list|,
literal|'s'
argument_list|)
case|:
comment|/* operator>> */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator>>"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'r'
argument_list|,
literal|'S'
argument_list|)
case|:
comment|/* operator>>= */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator>>="
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'r'
argument_list|,
literal|'z'
argument_list|)
case|:
comment|/* operator sizeof */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator sizeof "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'s'
argument_list|,
literal|'r'
argument_list|)
case|:
comment|/* scope resolution operator */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"scope resolution operator "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'s'
argument_list|,
literal|'v'
argument_list|)
case|:
comment|/* operator sizeof */
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"operator sizeof "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
comment|/* vendor extened operator */
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'v'
operator|&&
name|ELFTC_ISDIGIT
argument_list|(
operator|*
operator|(
name|ddata
operator|->
name|cur
operator|+
literal|1
operator|)
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"vendor extened operator "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_push_str
argument_list|(
name|ddata
argument_list|,
name|ddata
operator|->
name|cur
operator|+
literal|1
argument_list|,
literal|1
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
name|cpp_demangle_read_sname
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
block|}
comment|/* ctor-dtor-name */
switch|switch
condition|(
name|SIMPLE_HASH
argument_list|(
operator|*
name|ddata
operator|->
name|cur
argument_list|,
operator|*
operator|(
name|ddata
operator|->
name|cur
operator|+
literal|1
operator|)
argument_list|)
condition|)
block|{
case|case
name|SIMPLE_HASH
argument_list|(
literal|'C'
argument_list|,
literal|'1'
argument_list|)
case|:
case|case
name|SIMPLE_HASH
argument_list|(
literal|'C'
argument_list|,
literal|'2'
argument_list|)
case|:
case|case
name|SIMPLE_HASH
argument_list|(
literal|'C'
argument_list|,
literal|'3'
argument_list|)
case|:
if|if
condition|(
name|ddata
operator|->
name|last_sname
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|(
name|len
operator|=
name|strlen
argument_list|(
name|ddata
operator|->
name|last_sname
argument_list|)
operator|)
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"::"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_push_str
argument_list|(
name|ddata
argument_list|,
name|ddata
operator|->
name|last_sname
argument_list|,
name|len
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
case|case
name|SIMPLE_HASH
argument_list|(
literal|'D'
argument_list|,
literal|'0'
argument_list|)
case|:
case|case
name|SIMPLE_HASH
argument_list|(
literal|'D'
argument_list|,
literal|'1'
argument_list|)
case|:
case|case
name|SIMPLE_HASH
argument_list|(
literal|'D'
argument_list|,
literal|'2'
argument_list|)
case|:
if|if
condition|(
name|ddata
operator|->
name|last_sname
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|(
name|len
operator|=
name|strlen
argument_list|(
name|ddata
operator|->
name|last_sname
argument_list|)
operator|)
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"::~"
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_push_str
argument_list|(
name|ddata
argument_list|,
name|ddata
operator|->
name|last_sname
argument_list|,
name|len
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|ddata
operator|->
name|cur
operator|+=
literal|2
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
comment|/* source name */
if|if
condition|(
name|ELFTC_ISDIGIT
argument_list|(
operator|*
name|ddata
operator|->
name|cur
argument_list|)
operator|!=
literal|0
condition|)
return|return
operator|(
name|cpp_demangle_read_sname
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
comment|/* local source name */
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'L'
condition|)
return|return
operator|(
name|cpp_demangle_local_source_name
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Read local source name.  *  * References:  *   http://gcc.gnu.org/bugzilla/show_bug.cgi?id=31775  *   http://gcc.gnu.org/viewcvs?view=rev&revision=124467  */
end_comment

begin_function
specifier|static
name|int
name|cpp_demangle_local_source_name
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
comment|/* L */
if|if
condition|(
name|ddata
operator|==
name|NULL
operator|||
operator|*
name|ddata
operator|->
name|cur
operator|!=
literal|'L'
condition|)
return|return
operator|(
literal|0
operator|)
return|;
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
comment|/* source name */
if|if
condition|(
operator|!
name|cpp_demangle_read_sname
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
comment|/* discriminator */
if|if
condition|(
operator|*
name|ddata
operator|->
name|cur
operator|==
literal|'_'
condition|)
block|{
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
while|while
condition|(
name|ELFTC_ISDIGIT
argument_list|(
operator|*
name|ddata
operator|->
name|cur
argument_list|)
operator|!=
literal|0
condition|)
operator|++
name|ddata
operator|->
name|cur
expr_stmt|;
block|}
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|cpp_demangle_read_v_offset
parameter_list|(
name|struct
name|cpp_demangle_data
modifier|*
name|ddata
parameter_list|)
block|{
if|if
condition|(
name|ddata
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"offset : "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|cpp_demangle_read_offset_number
argument_list|(
name|ddata
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|!
name|DEM_PUSH_STR
argument_list|(
name|ddata
argument_list|,
literal|"virtual offset : "
argument_list|)
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
operator|!
name|cpp_demangle_read_offset_number
argument_list|(
name|ddata
argument_list|)
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Decode floating point representation to string  * Return new allocated string or NULL  *  * Todo  * Replace these functions to macro.  */
end_comment

begin_function
specifier|static
name|char
modifier|*
name|decode_fp_to_double
parameter_list|(
specifier|const
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
name|double
name|f
decl_stmt|;
name|size_t
name|rtn_len
decl_stmt|,
name|limit
decl_stmt|,
name|i
decl_stmt|;
name|int
name|byte
decl_stmt|;
name|char
modifier|*
name|rtn
decl_stmt|;
if|if
condition|(
name|p
operator|==
name|NULL
operator|||
name|len
operator|==
literal|0
operator|||
name|len
operator|%
literal|2
operator|!=
literal|0
operator|||
name|len
operator|/
literal|2
operator|>
sizeof|sizeof
argument_list|(
name|double
argument_list|)
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
name|memset
argument_list|(
operator|&
name|f
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|double
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
operator|/
literal|2
condition|;
operator|++
name|i
control|)
block|{
name|byte
operator|=
name|hex_to_dec
argument_list|(
name|p
index|[
name|len
operator|-
name|i
operator|*
literal|2
operator|-
literal|1
index|]
argument_list|)
operator|+
name|hex_to_dec
argument_list|(
name|p
index|[
name|len
operator|-
name|i
operator|*
literal|2
operator|-
literal|2
index|]
argument_list|)
operator|*
literal|16
expr_stmt|;
if|if
condition|(
name|byte
operator|<
literal|0
operator|||
name|byte
operator|>
literal|255
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
if|#
directive|if
name|ELFTC_BYTE_ORDER
operator|==
name|ELFTC_BYTE_ORDER_LITTLE_ENDIAN
operator|(
operator|(
name|unsigned
name|char
operator|*
operator|)
operator|&
name|f
operator|)
index|[
name|i
index|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
name|byte
argument_list|)
expr_stmt|;
else|#
directive|else
comment|/* ELFTC_BYTE_ORDER != ELFTC_BYTE_ORDER_LITTLE_ENDIAN */
operator|(
operator|(
name|unsigned
name|char
operator|*
operator|)
operator|&
name|f
operator|)
index|[
sizeof|sizeof
argument_list|(
name|double
argument_list|)
operator|-
name|i
operator|-
literal|1
index|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
name|byte
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* ELFTC_BYTE_ORDER == ELFTC_BYTE_ORDER_LITTLE_ENDIAN */
block|}
name|rtn_len
operator|=
literal|64
expr_stmt|;
name|limit
operator|=
literal|0
expr_stmt|;
name|again
label|:
if|if
condition|(
operator|(
name|rtn
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
name|char
argument_list|)
operator|*
name|rtn_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
if|if
condition|(
name|snprintf
argument_list|(
name|rtn
argument_list|,
name|rtn_len
argument_list|,
literal|"%fld"
argument_list|,
name|f
argument_list|)
operator|>=
operator|(
name|int
operator|)
name|rtn_len
condition|)
block|{
name|free
argument_list|(
name|rtn
argument_list|)
expr_stmt|;
if|if
condition|(
name|limit
operator|++
operator|>
name|FLOAT_SPRINTF_TRY_LIMIT
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
name|rtn_len
operator|*=
name|BUFFER_GROWFACTOR
expr_stmt|;
goto|goto
name|again
goto|;
block|}
return|return
name|rtn
return|;
block|}
end_function

begin_function
specifier|static
name|char
modifier|*
name|decode_fp_to_float
parameter_list|(
specifier|const
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
name|size_t
name|i
decl_stmt|,
name|rtn_len
decl_stmt|,
name|limit
decl_stmt|;
name|float
name|f
decl_stmt|;
name|int
name|byte
decl_stmt|;
name|char
modifier|*
name|rtn
decl_stmt|;
if|if
condition|(
name|p
operator|==
name|NULL
operator|||
name|len
operator|==
literal|0
operator|||
name|len
operator|%
literal|2
operator|!=
literal|0
operator|||
name|len
operator|/
literal|2
operator|>
sizeof|sizeof
argument_list|(
name|float
argument_list|)
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
name|memset
argument_list|(
operator|&
name|f
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|float
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
operator|/
literal|2
condition|;
operator|++
name|i
control|)
block|{
name|byte
operator|=
name|hex_to_dec
argument_list|(
name|p
index|[
name|len
operator|-
name|i
operator|*
literal|2
operator|-
literal|1
index|]
argument_list|)
operator|+
name|hex_to_dec
argument_list|(
name|p
index|[
name|len
operator|-
name|i
operator|*
literal|2
operator|-
literal|2
index|]
argument_list|)
operator|*
literal|16
expr_stmt|;
if|if
condition|(
name|byte
operator|<
literal|0
operator|||
name|byte
operator|>
literal|255
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
if|#
directive|if
name|ELFTC_BYTE_ORDER
operator|==
name|ELFTC_BYTE_ORDER_LITTLE_ENDIAN
operator|(
operator|(
name|unsigned
name|char
operator|*
operator|)
operator|&
name|f
operator|)
index|[
name|i
index|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
name|byte
argument_list|)
expr_stmt|;
else|#
directive|else
comment|/* ELFTC_BYTE_ORDER != ELFTC_BYTE_ORDER_LITTLE_ENDIAN */
operator|(
operator|(
name|unsigned
name|char
operator|*
operator|)
operator|&
name|f
operator|)
index|[
sizeof|sizeof
argument_list|(
name|float
argument_list|)
operator|-
name|i
operator|-
literal|1
index|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
name|byte
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* ELFTC_BYTE_ORDER == ELFTC_BYTE_ORDER_LITTLE_ENDIAN */
block|}
name|rtn_len
operator|=
literal|64
expr_stmt|;
name|limit
operator|=
literal|0
expr_stmt|;
name|again
label|:
if|if
condition|(
operator|(
name|rtn
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
name|char
argument_list|)
operator|*
name|rtn_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
if|if
condition|(
name|snprintf
argument_list|(
name|rtn
argument_list|,
name|rtn_len
argument_list|,
literal|"%ff"
argument_list|,
name|f
argument_list|)
operator|>=
operator|(
name|int
operator|)
name|rtn_len
condition|)
block|{
name|free
argument_list|(
name|rtn
argument_list|)
expr_stmt|;
if|if
condition|(
name|limit
operator|++
operator|>
name|FLOAT_SPRINTF_TRY_LIMIT
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
name|rtn_len
operator|*=
name|BUFFER_GROWFACTOR
expr_stmt|;
goto|goto
name|again
goto|;
block|}
return|return
name|rtn
return|;
block|}
end_function

begin_function
specifier|static
name|char
modifier|*
name|decode_fp_to_float128
parameter_list|(
specifier|const
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
name|long
name|double
name|f
decl_stmt|;
name|size_t
name|rtn_len
decl_stmt|,
name|limit
decl_stmt|,
name|i
decl_stmt|;
name|int
name|byte
decl_stmt|;
name|unsigned
name|char
name|buf
index|[
name|FLOAT_QUADRUPLE_BYTES
index|]
decl_stmt|;
name|char
modifier|*
name|rtn
decl_stmt|;
switch|switch
condition|(
expr|sizeof
operator|(
name|long
name|double
operator|)
condition|)
block|{
case|case
name|FLOAT_QUADRUPLE_BYTES
case|:
return|return
operator|(
name|decode_fp_to_long_double
argument_list|(
name|p
argument_list|,
name|len
argument_list|)
operator|)
return|;
case|case
name|FLOAT_EXTENED_BYTES
case|:
if|if
condition|(
name|p
operator|==
name|NULL
operator|||
name|len
operator|==
literal|0
operator|||
name|len
operator|%
literal|2
operator|!=
literal|0
operator|||
name|len
operator|/
literal|2
operator|>
name|FLOAT_QUADRUPLE_BYTES
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
name|memset
argument_list|(
name|buf
argument_list|,
literal|0
argument_list|,
name|FLOAT_QUADRUPLE_BYTES
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
operator|/
literal|2
condition|;
operator|++
name|i
control|)
block|{
name|byte
operator|=
name|hex_to_dec
argument_list|(
name|p
index|[
name|len
operator|-
name|i
operator|*
literal|2
operator|-
literal|1
index|]
argument_list|)
operator|+
name|hex_to_dec
argument_list|(
name|p
index|[
name|len
operator|-
name|i
operator|*
literal|2
operator|-
literal|2
index|]
argument_list|)
operator|*
literal|16
expr_stmt|;
if|if
condition|(
name|byte
operator|<
literal|0
operator|||
name|byte
operator|>
literal|255
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
if|#
directive|if
name|ELFTC_BYTE_ORDER
operator|==
name|ELFTC_BYTE_ORDER_LITTLE_ENDIAN
name|buf
index|[
name|i
index|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
name|byte
argument_list|)
expr_stmt|;
else|#
directive|else
comment|/* ELFTC_BYTE_ORDER != ELFTC_BYTE_ORDER_LITTLE_ENDIAN */
name|buf
index|[
name|FLOAT_QUADRUPLE_BYTES
operator|-
name|i
operator|-
literal|1
index|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
name|byte
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* ELFTC_BYTE_ORDER == ELFTC_BYTE_ORDER_LITTLE_ENDIAN */
block|}
name|memset
argument_list|(
operator|&
name|f
argument_list|,
literal|0
argument_list|,
name|FLOAT_EXTENED_BYTES
argument_list|)
expr_stmt|;
if|#
directive|if
name|ELFTC_BYTE_ORDER
operator|==
name|ELFTC_BYTE_ORDER_LITTLE_ENDIAN
name|memcpy
argument_list|(
operator|&
name|f
argument_list|,
name|buf
argument_list|,
name|FLOAT_EXTENED_BYTES
argument_list|)
expr_stmt|;
else|#
directive|else
comment|/* ELFTC_BYTE_ORDER != ELFTC_BYTE_ORDER_LITTLE_ENDIAN */
name|memcpy
argument_list|(
operator|&
name|f
argument_list|,
name|buf
operator|+
literal|6
argument_list|,
name|FLOAT_EXTENED_BYTES
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* ELFTC_BYTE_ORDER == ELFTC_BYTE_ORDER_LITTLE_ENDIAN */
name|rtn_len
operator|=
literal|256
expr_stmt|;
name|limit
operator|=
literal|0
expr_stmt|;
name|again
label|:
if|if
condition|(
operator|(
name|rtn
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
name|char
argument_list|)
operator|*
name|rtn_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
if|if
condition|(
name|snprintf
argument_list|(
name|rtn
argument_list|,
name|rtn_len
argument_list|,
literal|"%Lfd"
argument_list|,
name|f
argument_list|)
operator|>=
operator|(
name|int
operator|)
name|rtn_len
condition|)
block|{
name|free
argument_list|(
name|rtn
argument_list|)
expr_stmt|;
if|if
condition|(
name|limit
operator|++
operator|>
name|FLOAT_SPRINTF_TRY_LIMIT
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
name|rtn_len
operator|*=
name|BUFFER_GROWFACTOR
expr_stmt|;
goto|goto
name|again
goto|;
block|}
return|return
operator|(
name|rtn
operator|)
return|;
default|default:
return|return
operator|(
name|NULL
operator|)
return|;
block|}
block|}
end_function

begin_function
specifier|static
name|char
modifier|*
name|decode_fp_to_float80
parameter_list|(
specifier|const
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
name|long
name|double
name|f
decl_stmt|;
name|size_t
name|rtn_len
decl_stmt|,
name|limit
decl_stmt|,
name|i
decl_stmt|;
name|int
name|byte
decl_stmt|;
name|unsigned
name|char
name|buf
index|[
name|FLOAT_EXTENED_BYTES
index|]
decl_stmt|;
name|char
modifier|*
name|rtn
decl_stmt|;
switch|switch
condition|(
expr|sizeof
operator|(
name|long
name|double
operator|)
condition|)
block|{
case|case
name|FLOAT_QUADRUPLE_BYTES
case|:
if|if
condition|(
name|p
operator|==
name|NULL
operator|||
name|len
operator|==
literal|0
operator|||
name|len
operator|%
literal|2
operator|!=
literal|0
operator|||
name|len
operator|/
literal|2
operator|>
name|FLOAT_EXTENED_BYTES
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
name|memset
argument_list|(
name|buf
argument_list|,
literal|0
argument_list|,
name|FLOAT_EXTENED_BYTES
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
operator|/
literal|2
condition|;
operator|++
name|i
control|)
block|{
name|byte
operator|=
name|hex_to_dec
argument_list|(
name|p
index|[
name|len
operator|-
name|i
operator|*
literal|2
operator|-
literal|1
index|]
argument_list|)
operator|+
name|hex_to_dec
argument_list|(
name|p
index|[
name|len
operator|-
name|i
operator|*
literal|2
operator|-
literal|2
index|]
argument_list|)
operator|*
literal|16
expr_stmt|;
if|if
condition|(
name|byte
operator|<
literal|0
operator|||
name|byte
operator|>
literal|255
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
if|#
directive|if
name|ELFTC_BYTE_ORDER
operator|==
name|ELFTC_BYTE_ORDER_LITTLE_ENDIAN
name|buf
index|[
name|i
index|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
name|byte
argument_list|)
expr_stmt|;
else|#
directive|else
comment|/* ELFTC_BYTE_ORDER != ELFTC_BYTE_ORDER_LITTLE_ENDIAN */
name|buf
index|[
name|FLOAT_EXTENED_BYTES
operator|-
name|i
operator|-
literal|1
index|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
name|byte
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* ELFTC_BYTE_ORDER == ELFTC_BYTE_ORDER_LITTLE_ENDIAN */
block|}
name|memset
argument_list|(
operator|&
name|f
argument_list|,
literal|0
argument_list|,
name|FLOAT_QUADRUPLE_BYTES
argument_list|)
expr_stmt|;
if|#
directive|if
name|ELFTC_BYTE_ORDER
operator|==
name|ELFTC_BYTE_ORDER_LITTLE_ENDIAN
name|memcpy
argument_list|(
operator|&
name|f
argument_list|,
name|buf
argument_list|,
name|FLOAT_EXTENED_BYTES
argument_list|)
expr_stmt|;
else|#
directive|else
comment|/* ELFTC_BYTE_ORDER != ELFTC_BYTE_ORDER_LITTLE_ENDIAN */
name|memcpy
argument_list|(
operator|(
name|unsigned
name|char
operator|*
operator|)
operator|(
operator|&
name|f
operator|)
operator|+
literal|6
argument_list|,
name|buf
argument_list|,
name|FLOAT_EXTENED_BYTES
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* ELFTC_BYTE_ORDER == ELFTC_BYTE_ORDER_LITTLE_ENDIAN */
name|rtn_len
operator|=
literal|256
expr_stmt|;
name|limit
operator|=
literal|0
expr_stmt|;
name|again
label|:
if|if
condition|(
operator|(
name|rtn
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
name|char
argument_list|)
operator|*
name|rtn_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
if|if
condition|(
name|snprintf
argument_list|(
name|rtn
argument_list|,
name|rtn_len
argument_list|,
literal|"%Lfd"
argument_list|,
name|f
argument_list|)
operator|>=
operator|(
name|int
operator|)
name|rtn_len
condition|)
block|{
name|free
argument_list|(
name|rtn
argument_list|)
expr_stmt|;
if|if
condition|(
name|limit
operator|++
operator|>
name|FLOAT_SPRINTF_TRY_LIMIT
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
name|rtn_len
operator|*=
name|BUFFER_GROWFACTOR
expr_stmt|;
goto|goto
name|again
goto|;
block|}
return|return
operator|(
name|rtn
operator|)
return|;
case|case
name|FLOAT_EXTENED_BYTES
case|:
return|return
operator|(
name|decode_fp_to_long_double
argument_list|(
name|p
argument_list|,
name|len
argument_list|)
operator|)
return|;
default|default:
return|return
operator|(
name|NULL
operator|)
return|;
block|}
block|}
end_function

begin_function
specifier|static
name|char
modifier|*
name|decode_fp_to_long_double
parameter_list|(
specifier|const
name|char
modifier|*
name|p
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
name|long
name|double
name|f
decl_stmt|;
name|size_t
name|rtn_len
decl_stmt|,
name|limit
decl_stmt|,
name|i
decl_stmt|;
name|int
name|byte
decl_stmt|;
name|char
modifier|*
name|rtn
decl_stmt|;
if|if
condition|(
name|p
operator|==
name|NULL
operator|||
name|len
operator|==
literal|0
operator|||
name|len
operator|%
literal|2
operator|!=
literal|0
operator|||
name|len
operator|/
literal|2
operator|>
expr|sizeof
operator|(
name|long
name|double
operator|)
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
name|memset
argument_list|(
operator|&
name|f
argument_list|,
literal|0
argument_list|,
expr|sizeof
operator|(
name|long
name|double
operator|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
operator|/
literal|2
condition|;
operator|++
name|i
control|)
block|{
name|byte
operator|=
name|hex_to_dec
argument_list|(
name|p
index|[
name|len
operator|-
name|i
operator|*
literal|2
operator|-
literal|1
index|]
argument_list|)
operator|+
name|hex_to_dec
argument_list|(
name|p
index|[
name|len
operator|-
name|i
operator|*
literal|2
operator|-
literal|2
index|]
argument_list|)
operator|*
literal|16
expr_stmt|;
if|if
condition|(
name|byte
operator|<
literal|0
operator|||
name|byte
operator|>
literal|255
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
if|#
directive|if
name|ELFTC_BYTE_ORDER
operator|==
name|ELFTC_BYTE_ORDER_LITTLE_ENDIAN
operator|(
operator|(
name|unsigned
name|char
operator|*
operator|)
operator|&
name|f
operator|)
index|[
name|i
index|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
name|byte
argument_list|)
expr_stmt|;
else|#
directive|else
comment|/* ELFTC_BYTE_ORDER != ELFTC_BYTE_ORDER_LITTLE_ENDIAN */
operator|(
operator|(
name|unsigned
name|char
operator|*
operator|)
operator|&
name|f
operator|)
index|[
expr|sizeof
operator|(
name|long
name|double
operator|)
operator|-
name|i
operator|-
literal|1
expr|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
name|byte
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* ELFTC_BYTE_ORDER == ELFTC_BYTE_ORDER_LITTLE_ENDIAN */
block|}
name|rtn_len
operator|=
literal|256
expr_stmt|;
name|limit
operator|=
literal|0
expr_stmt|;
name|again
label|:
if|if
condition|(
operator|(
name|rtn
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
name|char
argument_list|)
operator|*
name|rtn_len
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
if|if
condition|(
name|snprintf
argument_list|(
name|rtn
argument_list|,
name|rtn_len
argument_list|,
literal|"%Lfd"
argument_list|,
name|f
argument_list|)
operator|>=
operator|(
name|int
operator|)
name|rtn_len
condition|)
block|{
name|free
argument_list|(
name|rtn
argument_list|)
expr_stmt|;
if|if
condition|(
name|limit
operator|++
operator|>
name|FLOAT_SPRINTF_TRY_LIMIT
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
name|rtn_len
operator|*=
name|BUFFER_GROWFACTOR
expr_stmt|;
goto|goto
name|again
goto|;
block|}
return|return
operator|(
name|rtn
operator|)
return|;
block|}
end_function

begin_comment
comment|/* Simple hex to integer function used by decode_to_* function. */
end_comment

begin_function
specifier|static
name|int
name|hex_to_dec
parameter_list|(
name|char
name|c
parameter_list|)
block|{
switch|switch
condition|(
name|c
condition|)
block|{
case|case
literal|'0'
case|:
return|return
operator|(
literal|0
operator|)
return|;
case|case
literal|'1'
case|:
return|return
operator|(
literal|1
operator|)
return|;
case|case
literal|'2'
case|:
return|return
operator|(
literal|2
operator|)
return|;
case|case
literal|'3'
case|:
return|return
operator|(
literal|3
operator|)
return|;
case|case
literal|'4'
case|:
return|return
operator|(
literal|4
operator|)
return|;
case|case
literal|'5'
case|:
return|return
operator|(
literal|5
operator|)
return|;
case|case
literal|'6'
case|:
return|return
operator|(
literal|6
operator|)
return|;
case|case
literal|'7'
case|:
return|return
operator|(
literal|7
operator|)
return|;
case|case
literal|'8'
case|:
return|return
operator|(
literal|8
operator|)
return|;
case|case
literal|'9'
case|:
return|return
operator|(
literal|9
operator|)
return|;
case|case
literal|'a'
case|:
return|return
operator|(
literal|10
operator|)
return|;
case|case
literal|'b'
case|:
return|return
operator|(
literal|11
operator|)
return|;
case|case
literal|'c'
case|:
return|return
operator|(
literal|12
operator|)
return|;
case|case
literal|'d'
case|:
return|return
operator|(
literal|13
operator|)
return|;
case|case
literal|'e'
case|:
return|return
operator|(
literal|14
operator|)
return|;
case|case
literal|'f'
case|:
return|return
operator|(
literal|15
operator|)
return|;
default|default:
return|return
operator|(
operator|-
literal|1
operator|)
return|;
block|}
block|}
end_function

begin_comment
comment|/**  * @brief Test input string is mangled by IA-64 C++ ABI style.  *  * Test string heads with "_Z" or "_GLOBAL__I_".  * @return Return 0 at false.  */
end_comment

begin_function
name|bool
name|is_cpp_mangled_gnu3
parameter_list|(
specifier|const
name|char
modifier|*
name|org
parameter_list|)
block|{
name|size_t
name|len
decl_stmt|;
name|len
operator|=
name|strlen
argument_list|(
name|org
argument_list|)
expr_stmt|;
return|return
operator|(
operator|(
name|len
operator|>
literal|2
operator|&&
operator|*
name|org
operator|==
literal|'_'
operator|&&
operator|*
operator|(
name|org
operator|+
literal|1
operator|)
operator|==
literal|'Z'
operator|)
operator|||
operator|(
name|len
operator|>
literal|11
operator|&&
operator|!
name|strncmp
argument_list|(
name|org
argument_list|,
literal|"_GLOBAL__I_"
argument_list|,
literal|11
argument_list|)
operator|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|vector_read_cmd_dest
parameter_list|(
name|struct
name|vector_read_cmd
modifier|*
name|v
parameter_list|)
block|{
if|if
condition|(
name|v
operator|==
name|NULL
condition|)
return|return;
name|free
argument_list|(
name|v
operator|->
name|r_container
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|struct
name|read_cmd_item
modifier|*
name|vector_read_cmd_find
parameter_list|(
name|struct
name|vector_read_cmd
modifier|*
name|v
parameter_list|,
name|enum
name|read_cmd
name|dst
parameter_list|)
block|{
name|int
name|i
decl_stmt|;
if|if
condition|(
name|v
operator|==
name|NULL
operator|||
name|dst
operator|==
name|READ_FAIL
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
for|for
control|(
name|i
operator|=
operator|(
name|int
operator|)
name|v
operator|->
name|size
operator|-
literal|1
init|;
name|i
operator|>=
literal|0
condition|;
name|i
operator|--
control|)
if|if
condition|(
name|v
operator|->
name|r_container
index|[
name|i
index|]
operator|.
name|cmd
operator|==
name|dst
condition|)
return|return
operator|(
operator|&
name|v
operator|->
name|r_container
index|[
name|i
index|]
operator|)
return|;
return|return
operator|(
name|NULL
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|vector_read_cmd_init
parameter_list|(
name|struct
name|vector_read_cmd
modifier|*
name|v
parameter_list|)
block|{
if|if
condition|(
name|v
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|v
operator|->
name|size
operator|=
literal|0
expr_stmt|;
name|v
operator|->
name|capacity
operator|=
name|VECTOR_DEF_CAPACITY
expr_stmt|;
if|if
condition|(
operator|(
name|v
operator|->
name|r_container
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
operator|*
name|v
operator|->
name|r_container
argument_list|)
operator|*
name|v
operator|->
name|capacity
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|vector_read_cmd_pop
parameter_list|(
name|struct
name|vector_read_cmd
modifier|*
name|v
parameter_list|)
block|{
if|if
condition|(
name|v
operator|==
name|NULL
operator|||
name|v
operator|->
name|size
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
operator|--
name|v
operator|->
name|size
expr_stmt|;
name|v
operator|->
name|r_container
index|[
name|v
operator|->
name|size
index|]
operator|.
name|cmd
operator|=
name|READ_FAIL
expr_stmt|;
name|v
operator|->
name|r_container
index|[
name|v
operator|->
name|size
index|]
operator|.
name|data
operator|=
name|NULL
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|vector_read_cmd_push
parameter_list|(
name|struct
name|vector_read_cmd
modifier|*
name|v
parameter_list|,
name|enum
name|read_cmd
name|cmd
parameter_list|,
name|void
modifier|*
name|data
parameter_list|)
block|{
name|struct
name|read_cmd_item
modifier|*
name|tmp_r_ctn
decl_stmt|;
name|size_t
name|tmp_cap
decl_stmt|;
name|size_t
name|i
decl_stmt|;
if|if
condition|(
name|v
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
name|v
operator|->
name|size
operator|==
name|v
operator|->
name|capacity
condition|)
block|{
name|tmp_cap
operator|=
name|v
operator|->
name|capacity
operator|*
name|BUFFER_GROWFACTOR
expr_stmt|;
if|if
condition|(
operator|(
name|tmp_r_ctn
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
operator|*
name|tmp_r_ctn
argument_list|)
operator|*
name|tmp_cap
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|v
operator|->
name|size
condition|;
operator|++
name|i
control|)
name|tmp_r_ctn
index|[
name|i
index|]
operator|=
name|v
operator|->
name|r_container
index|[
name|i
index|]
expr_stmt|;
name|free
argument_list|(
name|v
operator|->
name|r_container
argument_list|)
expr_stmt|;
name|v
operator|->
name|r_container
operator|=
name|tmp_r_ctn
expr_stmt|;
name|v
operator|->
name|capacity
operator|=
name|tmp_cap
expr_stmt|;
block|}
name|v
operator|->
name|r_container
index|[
name|v
operator|->
name|size
index|]
operator|.
name|cmd
operator|=
name|cmd
expr_stmt|;
name|v
operator|->
name|r_container
index|[
name|v
operator|->
name|size
index|]
operator|.
name|data
operator|=
name|data
expr_stmt|;
operator|++
name|v
operator|->
name|size
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|vector_type_qualifier_dest
parameter_list|(
name|struct
name|vector_type_qualifier
modifier|*
name|v
parameter_list|)
block|{
if|if
condition|(
name|v
operator|==
name|NULL
condition|)
return|return;
name|free
argument_list|(
name|v
operator|->
name|q_container
argument_list|)
expr_stmt|;
name|vector_str_dest
argument_list|(
operator|&
name|v
operator|->
name|ext_name
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* size, capacity, ext_name */
end_comment

begin_function
specifier|static
name|int
name|vector_type_qualifier_init
parameter_list|(
name|struct
name|vector_type_qualifier
modifier|*
name|v
parameter_list|)
block|{
if|if
condition|(
name|v
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|v
operator|->
name|size
operator|=
literal|0
expr_stmt|;
name|v
operator|->
name|capacity
operator|=
name|VECTOR_DEF_CAPACITY
expr_stmt|;
if|if
condition|(
operator|(
name|v
operator|->
name|q_container
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
expr|enum
name|type_qualifier
argument_list|)
operator|*
name|v
operator|->
name|capacity
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|assert
argument_list|(
name|v
operator|->
name|q_container
operator|!=
name|NULL
argument_list|)
expr_stmt|;
if|if
condition|(
name|vector_str_init
argument_list|(
operator|&
name|v
operator|->
name|ext_name
argument_list|)
operator|==
name|false
condition|)
block|{
name|free
argument_list|(
name|v
operator|->
name|q_container
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|vector_type_qualifier_push
parameter_list|(
name|struct
name|vector_type_qualifier
modifier|*
name|v
parameter_list|,
name|enum
name|type_qualifier
name|t
parameter_list|)
block|{
name|enum
name|type_qualifier
modifier|*
name|tmp_ctn
decl_stmt|;
name|size_t
name|tmp_cap
decl_stmt|;
name|size_t
name|i
decl_stmt|;
if|if
condition|(
name|v
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
name|v
operator|->
name|size
operator|==
name|v
operator|->
name|capacity
condition|)
block|{
name|tmp_cap
operator|=
name|v
operator|->
name|capacity
operator|*
name|BUFFER_GROWFACTOR
expr_stmt|;
if|if
condition|(
operator|(
name|tmp_ctn
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
expr|enum
name|type_qualifier
argument_list|)
operator|*
name|tmp_cap
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
operator|(
literal|0
operator|)
return|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|v
operator|->
name|size
condition|;
operator|++
name|i
control|)
name|tmp_ctn
index|[
name|i
index|]
operator|=
name|v
operator|->
name|q_container
index|[
name|i
index|]
expr_stmt|;
name|free
argument_list|(
name|v
operator|->
name|q_container
argument_list|)
expr_stmt|;
name|v
operator|->
name|q_container
operator|=
name|tmp_ctn
expr_stmt|;
name|v
operator|->
name|capacity
operator|=
name|tmp_cap
expr_stmt|;
block|}
name|v
operator|->
name|q_container
index|[
name|v
operator|->
name|size
index|]
operator|=
name|t
expr_stmt|;
operator|++
name|v
operator|->
name|size
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

end_unit

