begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2015 Kai Wang  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  *  * $Id: libpe.h 3312 2016-01-10 09:23:51Z kaiwang27 $  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|_LIBPE_H_
end_ifndef

begin_define
define|#
directive|define
name|_LIBPE_H_
end_define

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|"pe.h"
end_include

begin_comment
comment|/* Library private data structures */
end_comment

begin_typedef
typedef|typedef
name|struct
name|_PE
name|PE
typedef|;
end_typedef

begin_typedef
typedef|typedef
name|struct
name|_PE_Scn
name|PE_Scn
typedef|;
end_typedef

begin_comment
comment|/* Section buffers */
end_comment

begin_typedef
typedef|typedef
struct|struct
name|PE_Buffer
block|{
name|unsigned
name|int
name|pb_align
decl_stmt|;
name|off_t
name|pb_off
decl_stmt|;
name|size_t
name|pb_size
decl_stmt|;
name|void
modifier|*
name|pb_buf
decl_stmt|;
block|}
name|PE_Buffer
typedef|;
end_typedef

begin_comment
comment|/* Object types */
end_comment

begin_typedef
typedef|typedef
enum|enum
block|{
name|PE_O_UNKNOWN
init|=
literal|0
block|,
name|PE_O_PE32
block|,
name|PE_O_PE32P
block|,
name|PE_O_COFF
block|, }
name|PE_Object
typedef|;
end_typedef

begin_comment
comment|/* Commands */
end_comment

begin_typedef
typedef|typedef
enum|enum
block|{
name|PE_C_NULL
init|=
literal|0
block|,
name|PE_C_CLR
block|,
name|PE_C_FDDONE
block|,
name|PE_C_FDREAD
block|,
name|PE_C_RDWR
block|,
name|PE_C_READ
block|,
name|PE_C_SET
block|,
name|PE_C_WRITE
block|,
name|PE_C_NUM
block|}
name|PE_Cmd
typedef|;
end_typedef

begin_comment
comment|/* Flags defined by the API. */
end_comment

begin_define
define|#
directive|define
name|PE_F_DIRTY
value|0x001U
end_define

begin_define
define|#
directive|define
name|PE_F_STRIP_DOS_STUB
value|0x002U
end_define

begin_define
define|#
directive|define
name|PE_F_STRIP_RICH_HEADER
value|0x004U
end_define

begin_define
define|#
directive|define
name|PE_F_STRIP_SYMTAB
value|0x008U
end_define

begin_define
define|#
directive|define
name|PE_F_STRIP_DEBUG
value|0x010U
end_define

begin_define
define|#
directive|define
name|PE_F_STRIP_SECTION
value|0x020U
end_define

begin_ifdef
ifdef|#
directive|ifdef
name|__cplusplus
end_ifdef

begin_extern
extern|extern
literal|"C"
block|{
endif|#
directive|endif
name|PE_CoffHdr
modifier|*
name|pe_coff_header
parameter_list|(
name|PE
modifier|*
parameter_list|)
function_decl|;
name|int
name|pe_cntl
parameter_list|(
name|PE
modifier|*
parameter_list|,
name|PE_Cmd
parameter_list|)
function_decl|;
name|PE_DataDir
modifier|*
name|pe_data_dir
parameter_list|(
name|PE
modifier|*
parameter_list|)
function_decl|;
name|void
name|pe_finish
parameter_list|(
name|PE
modifier|*
parameter_list|)
function_decl|;
name|int
name|pe_flag
parameter_list|(
name|PE
modifier|*
parameter_list|,
name|PE_Cmd
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
name|int
name|pe_flag_buffer
parameter_list|(
name|PE_Buffer
modifier|*
parameter_list|,
name|PE_Cmd
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
name|int
name|pe_flag_coff_header
parameter_list|(
name|PE
modifier|*
parameter_list|,
name|PE_Cmd
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
name|int
name|pe_flag_data_dir
parameter_list|(
name|PE
modifier|*
parameter_list|,
name|PE_Cmd
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
name|int
name|pe_flag_dos_header
parameter_list|(
name|PE
modifier|*
parameter_list|,
name|PE_Cmd
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
name|int
name|pe_flag_opt_header
parameter_list|(
name|PE
modifier|*
parameter_list|,
name|PE_Cmd
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
name|int
name|pe_flag_section_header
parameter_list|(
name|PE_Scn
modifier|*
parameter_list|,
name|PE_Cmd
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
name|int
name|pe_flag_scn
parameter_list|(
name|PE_Scn
modifier|*
parameter_list|,
name|PE_Cmd
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
name|PE_Buffer
modifier|*
name|pe_getbuffer
parameter_list|(
name|PE_Scn
modifier|*
parameter_list|,
name|PE_Buffer
modifier|*
parameter_list|)
function_decl|;
name|PE_Scn
modifier|*
name|pe_getscn
parameter_list|(
name|PE
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
name|PE
modifier|*
name|pe_init
parameter_list|(
name|int
parameter_list|,
name|PE_Cmd
parameter_list|,
name|PE_Object
parameter_list|)
function_decl|;
name|PE_Scn
modifier|*
name|pe_insertscn
parameter_list|(
name|PE
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
name|PE_DosHdr
modifier|*
name|pe_msdos_header
parameter_list|(
name|PE
modifier|*
parameter_list|)
function_decl|;
name|char
modifier|*
name|pe_msdos_stub
parameter_list|(
name|PE
modifier|*
parameter_list|,
name|size_t
modifier|*
parameter_list|)
function_decl|;
name|size_t
name|pe_ndxscn
parameter_list|(
name|PE_Scn
modifier|*
parameter_list|)
function_decl|;
name|PE_Buffer
modifier|*
name|pe_newbuffer
parameter_list|(
name|PE_Scn
modifier|*
parameter_list|)
function_decl|;
name|PE_Scn
modifier|*
name|pe_newscn
parameter_list|(
name|PE
modifier|*
parameter_list|)
function_decl|;
name|PE_Scn
modifier|*
name|pe_nextscn
parameter_list|(
name|PE
modifier|*
parameter_list|,
name|PE_Scn
modifier|*
parameter_list|)
function_decl|;
name|PE_Object
name|pe_object
parameter_list|(
name|PE
modifier|*
parameter_list|)
function_decl|;
name|PE_OptHdr
modifier|*
name|pe_opt_header
parameter_list|(
name|PE
modifier|*
parameter_list|)
function_decl|;
name|PE_RichHdr
modifier|*
name|pe_rich_header
parameter_list|(
name|PE
modifier|*
parameter_list|)
function_decl|;
name|int
name|pe_rich_header_validate
parameter_list|(
name|PE
modifier|*
parameter_list|)
function_decl|;
name|PE_SecHdr
modifier|*
name|pe_section_header
parameter_list|(
name|PE_Scn
modifier|*
parameter_list|)
function_decl|;
name|off_t
name|pe_update
parameter_list|(
name|PE
modifier|*
parameter_list|)
function_decl|;
name|int
name|pe_update_coff_header
parameter_list|(
name|PE
modifier|*
parameter_list|,
name|PE_CoffHdr
modifier|*
parameter_list|)
function_decl|;
name|int
name|pe_update_opt_header
parameter_list|(
name|PE
modifier|*
parameter_list|,
name|PE_OptHdr
modifier|*
parameter_list|)
function_decl|;
name|int
name|pe_update_data_dir
parameter_list|(
name|PE
modifier|*
parameter_list|,
name|PE_DataDir
modifier|*
parameter_list|)
function_decl|;
name|int
name|ps_update_msdos_header
parameter_list|(
name|PE
modifier|*
parameter_list|,
name|PE_DosHdr
modifier|*
parameter_list|)
function_decl|;
name|int
name|ps_update_msdos_stub
parameter_list|(
name|PE
modifier|*
parameter_list|,
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|)
function_decl|;
name|int
name|pe_update_section_header
parameter_list|(
name|PE_Scn
modifier|*
parameter_list|,
name|PE_SecHdr
modifier|*
parameter_list|)
function_decl|;
name|int
name|pe_update_symtab
parameter_list|(
name|PE
modifier|*
parameter_list|,
name|char
modifier|*
parameter_list|,
name|size_t
parameter_list|,
name|unsigned
name|int
parameter_list|)
function_decl|;
ifdef|#
directive|ifdef
name|__cplusplus
block|}
end_extern

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* !_LIBPE_H_ */
end_comment

end_unit

