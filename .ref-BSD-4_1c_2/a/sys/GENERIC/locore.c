begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_ifdef
ifdef|#
directive|ifdef
name|LOCORE
end_ifdef

begin_define
define|#
directive|define
name|P_LINK
value|0
end_define

begin_define
define|#
directive|define
name|P_RLINK
value|4
end_define

begin_define
define|#
directive|define
name|P_ADDR
value|8
end_define

begin_define
define|#
directive|define
name|P_PRI
value|13
end_define

begin_define
define|#
directive|define
name|P_STAT
value|15
end_define

begin_define
define|#
directive|define
name|P_WCHAN
value|84
end_define

begin_define
define|#
directive|define
name|SSLEEP
value|1
end_define

begin_define
define|#
directive|define
name|SRUN
value|3
end_define

begin_define
define|#
directive|define
name|UBA_BRRVR
value|48
end_define

begin_define
define|#
directive|define
name|UH_UBA
value|0
end_define

begin_define
define|#
directive|define
name|UH_VEC
value|8
end_define

begin_define
define|#
directive|define
name|UH_SIZE
value|52
end_define

begin_define
define|#
directive|define
name|RP_FLAG
value|12
end_define

begin_define
define|#
directive|define
name|V_SWTCH
value|0
end_define

begin_define
define|#
directive|define
name|V_TRAP
value|4
end_define

begin_define
define|#
directive|define
name|V_SYSCALL
value|8
end_define

begin_define
define|#
directive|define
name|V_INTR
value|12
end_define

begin_define
define|#
directive|define
name|V_PDMA
value|16
end_define

begin_define
define|#
directive|define
name|UPAGES
value|8
end_define

begin_define
define|#
directive|define
name|CLSIZE
value|2
end_define

begin_define
define|#
directive|define
name|SYSPTSIZE
value|4480
end_define

begin_define
define|#
directive|define
name|USRPTSIZE
value|1024
end_define

begin_define
define|#
directive|define
name|MSGBUFPTECNT
value|8
end_define

begin_define
define|#
directive|define
name|NMBCLUSTERS
value|256
end_define

begin_else
else|#
directive|else
end_else

begin_asm
asm|asm(".set	U_ARG,384");
end_asm

begin_asm
asm|asm(".set	U_QSAVE,148701184");
end_asm

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/*	scb.s	4.14	82/03/19	*/
end_comment

begin_comment
comment|/*  * System control block  */
end_comment

begin_expr_stmt
operator|.
name|set
name|INTSTK
operator|,
literal|1
operator|#
name|handle
name|this
name|interrupt
name|on
name|the
name|interrupt
name|stack
operator|.
name|set
name|HALT
operator|,
literal|3
operator|#
name|halt
end_expr_stmt

begin_if
if|if this interrupt occurs  _scb:	.globl	_scb
define|#
directive|define
name|STRAY
value|.long	_Xstray+INTSTK
define|#
directive|define
name|STRAY8
value|STRAY;STRAY;STRAY;STRAY;STRAY;STRAY;STRAY;STRAY
define|#
directive|define
name|STRAY15
value|STRAY;STRAY;STRAY;STRAY;STRAY;STRAY;STRAY;STRAY8
define|#
directive|define
name|KS
parameter_list|(
name|a
parameter_list|)
value|.long	_X
comment|/**/
value|a
define|#
directive|define
name|IS
parameter_list|(
name|a
parameter_list|)
value|.long	_X
comment|/**/
value|a+INTSTK
define|#
directive|define
name|STOP
parameter_list|(
name|a
parameter_list|)
value|.long	_X
comment|/**/
value|a+HALT
comment|/* 000 */
if|STRAY
empty_stmt|;
end_if

begin_expr_stmt
name|IS
argument_list|(
name|machcheck
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|IS
argument_list|(
name|kspnotval
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STOP
argument_list|(
name|powfail
argument_list|)
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* 010 */
end_comment

begin_expr_stmt
name|KS
argument_list|(
name|privinflt
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|KS
argument_list|(
name|xfcflt
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|KS
argument_list|(
name|resopflt
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|KS
argument_list|(
name|resadflt
argument_list|)
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* 020 */
end_comment

begin_expr_stmt
name|KS
argument_list|(
name|protflt
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|KS
argument_list|(
name|transflt
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|KS
argument_list|(
name|tracep
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|KS
argument_list|(
name|bptflt
argument_list|)
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* 030 */
end_comment

begin_expr_stmt
name|KS
argument_list|(
name|compatflt
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|KS
argument_list|(
name|arithtrap
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* 040 */
end_comment

begin_expr_stmt
name|KS
argument_list|(
name|syscall
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|KS
argument_list|(
name|chme
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|KS
argument_list|(
name|chms
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|KS
argument_list|(
name|chmu
argument_list|)
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* 050 */
end_comment

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|IS
argument_list|(
name|cmrd
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* 060 */
end_comment

begin_expr_stmt
name|IS
argument_list|(
name|wtime
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* 070 */
end_comment

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* 080 */
end_comment

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|KS
argument_list|(
name|astflt
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* 090 */
end_comment

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* 0a0 */
end_comment

begin_expr_stmt
name|IS
argument_list|(
name|softclock
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* 0b0 */
end_comment

begin_expr_stmt
name|IS
argument_list|(
name|netintr
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* 0c0 */
end_comment

begin_expr_stmt
name|IS
argument_list|(
name|hardclock
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* 0d0 */
end_comment

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* 0e0 */
end_comment

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* 0f0 */
end_comment

begin_expr_stmt
name|IS
argument_list|(
name|consdin
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|IS
argument_list|(
name|consdout
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|IS
argument_list|(
name|cnrint
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|IS
argument_list|(
name|cnxint
argument_list|)
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* 100 */
end_comment

begin_expr_stmt
name|IS
argument_list|(
name|nexzvec
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY15
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* ipl 0x14, nexus 0-15 */
end_comment

begin_comment
comment|/* 140 */
end_comment

begin_expr_stmt
name|IS
argument_list|(
name|nexzvec
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY15
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* ipl 0x15, nexus 0-15 */
end_comment

begin_comment
comment|/* 180 */
end_comment

begin_expr_stmt
name|IS
argument_list|(
name|nexzvec
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY15
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* ipl 0x16, nexus 0-15 */
end_comment

begin_comment
comment|/* 1c0 */
end_comment

begin_expr_stmt
name|IS
argument_list|(
name|nexzvec
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|STRAY15
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* ipl 0x17, nexus 0-15 */
end_comment

begin_expr_stmt
operator|.
name|globl
name|_UNIvec
name|_UNIvec
operator|:
operator|.
name|space
literal|512
operator|#
literal|750
name|unibus
name|intr
name|vector
empty|# 1st UBA jump table on 780's
comment|/*	locore.s	4.77	82/12/30	*/
include|#
directive|include
file|"../machine/psl.h"
include|#
directive|include
file|"../machine/pte.h"
include|#
directive|include
file|"../h/errno.h"
include|#
directive|include
file|"../vax/mtpr.h"
include|#
directive|include
file|"../vax/trap.h"
include|#
directive|include
file|"../vax/cpu.h"
include|#
directive|include
file|"../vax/nexus.h"
include|#
directive|include
file|"../vax/cons.h"
include|#
directive|include
file|"../vax/clock.h"
include|#
directive|include
file|"../vaxuba/ubareg.h"
include|#
directive|include
file|"dh.h"
include|#
directive|include
file|"dz.h"
include|#
directive|include
file|"mba.h"
operator|.
name|set
name|HIGH
operator|,
literal|0x1f
operator|#
name|mask
end_expr_stmt

begin_for
for|for total disable 	.set	MCKVEC
operator|,
literal|4
operator|#
name|offset
name|into
name|scb
name|of
name|machine
name|check
name|vector
operator|.
name|set
name|NBPG
operator|,
literal|512
operator|.
name|set
name|PGSHIFT
operator|,
literal|9
operator|.
name|set
name|NISP
operator|,
literal|3
operator|#
name|number
name|of
name|interrupt
name|stack
name|pages
comment|/*  * User structure is UPAGES at top of user space.  */
operator|.
name|globl
name|_u
operator|.
name|set
name|_u
operator|,
literal|0x80000000
operator|-
name|UPAGES
operator|*
name|NBPG
comment|/*  * Restart parameter block  * This is filled in in machdep.c in startup().  * It MUST be page aligned.  * When auto-restart occurs, we run restart() in machdep.c, which  * takes a core-dump and then cold-starts.  */
operator|.
name|globl
name|_rpb
name|_rpb
operator|:
operator|.
name|space
literal|508
name|erpb
operator|:
operator|.
name|space
literal|4
operator|.
name|globl
name|_intstack
name|_intstack
operator|:
operator|.
name|space
name|NISP
operator|*
name|NBPG
name|eintstack
operator|:
comment|/*  * Do a dump.  * Called by auto-restart.  * May be called manually.  */
operator|.
name|align
literal|2
operator|.
name|globl
name|_doadump
name|_doadump
operator|:
name|nop
expr_stmt|;
end_for

begin_expr_stmt
name|nop
operator|#
operator|.
name|word
literal|0x0101
define|#
directive|define
name|_rpbmap
value|_Sysmap+8			# scb, UNIvec, rpb, istack*4
name|bicl2
name|$PG_PROT
operator|,
name|_rpbmap
name|bisl2
name|$PG_KW
operator|,
name|_rpbmap
name|tstl
name|_rpb
operator|+
name|RP_FLAG
operator|#
name|dump
name|only
name|once
operator|!
name|bneq
literal|1f
name|incl
name|_rpb
operator|+
name|RP_FLAG
name|mtpr
name|$0
operator|,
name|$TBIA
name|movl
name|sp
operator|,
name|erpb
name|movab
name|erpb
operator|,
name|sp
name|mfpr
name|$PCBB
operator|,
operator|-
operator|(
name|sp
operator|)
name|mfpr
name|$MAPEN
operator|,
operator|-
operator|(
name|sp
operator|)
name|mfpr
name|$IPL
operator|,
operator|-
operator|(
name|sp
operator|)
name|mtpr
name|$0
operator|,
name|$MAPEN
name|mtpr
name|$HIGH
operator|,
name|$IPL
name|pushr
name|$0x3fff
name|calls
name|$0
operator|,
name|_dumpsys
literal|1
operator|:
name|mfpr
name|$TXCS
operator|,
name|r0
name|bitl
name|$TXCS_RDY
operator|,
name|r0
name|beql
literal|1b
name|mtpr
name|$TXDB_BOOT
operator|,
name|$TXDB
name|halt
comment|/*  * Interrupt vector routines  */
operator|.
name|globl
name|_waittime
define|#
directive|define
name|SCBVEC
parameter_list|(
name|name
parameter_list|)
value|.align 2; .globl _X
comment|/**/
value|name; _X
comment|/**/
value|name
define|#
directive|define
name|PANIC
parameter_list|(
name|msg
parameter_list|)
value|clrl _waittime; pushab 1f; \ 			calls $1,_panic; 1: .asciz msg
define|#
directive|define
name|PRINTF
parameter_list|(
name|n
parameter_list|,
name|msg
parameter_list|)
value|pushab 1f; calls $n+1,_printf; MSG(msg)
define|#
directive|define
name|MSG
parameter_list|(
name|msg
parameter_list|)
value|.data; 1: .asciz msg; .text
define|#
directive|define
name|PUSHR
value|pushr $0x3f
define|#
directive|define
name|POPR
value|popr $0x3f
name|SCBVEC
argument_list|(
name|machcheck
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|pushab
literal|6
operator|*
literal|4
operator|(
name|sp
operator|)
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|calls
name|$1
decl_stmt|,
name|_machinecheck
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|POPR
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|addl2
argument_list|(
name|sp
argument_list|)
operator|+
operator|,
name|sp
expr_stmt|;
end_expr_stmt

begin_macro
name|rei
end_macro

begin_expr_stmt
name|SCBVEC
argument_list|(
name|kspnotval
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PANIC
argument_list|(
literal|"KSP not valid"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SCBVEC
argument_list|(
name|powfail
argument_list|)
operator|:
name|halt
name|SCBVEC
argument_list|(
name|chme
argument_list|)
operator|:
name|SCBVEC
argument_list|(
name|chms
argument_list|)
operator|:
name|SCBVEC
argument_list|(
name|chmu
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PANIC
argument_list|(
literal|"CHM? in kernel"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|SCBVEC
argument_list|(
name|stray
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PRINTF
argument_list|(
literal|0
argument_list|,
literal|"stray scb interrupt\n"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|POPR
expr_stmt|;
end_expr_stmt

begin_macro
name|rei
end_macro

begin_expr_stmt
name|SCBVEC
argument_list|(
name|nexzvec
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|mfpr
name|$IPL
decl_stmt|,-
argument_list|(
name|sp
argument_list|)
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|PRINTF
argument_list|(
literal|1
argument_list|,
literal|"nexus stray intr ipl%x\n"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|POPR
expr_stmt|;
end_expr_stmt

begin_macro
name|rei
end_macro

begin_expr_stmt
name|SCBVEC
argument_list|(
name|cmrd
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|calls
name|$0
decl_stmt|,
name|_memerr
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|POPR
expr_stmt|;
end_expr_stmt

begin_macro
name|rei
end_macro

begin_expr_stmt
name|SCBVEC
argument_list|(
name|wtime
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|pushl
literal|6
operator|*
literal|4
operator|(
name|sp
operator|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PRINTF
argument_list|(
literal|1
argument_list|,
literal|"write timeout %x\n"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|POPR
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|PANIC
argument_list|(
literal|"wtimo"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_if
if|#
directive|if
name|NMBA
operator|>
literal|0
end_if

begin_expr_stmt
name|SCBVEC
argument_list|(
name|mba3int
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|pushl
name|$3
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|brb
literal|1f
name|SCBVEC
argument_list|(
name|mba2int
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|pushl
name|$2
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|brb
literal|1f
name|SCBVEC
argument_list|(
name|mba1int
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|pushl
name|$1
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|brb
literal|1f
name|SCBVEC
argument_list|(
name|mba0int
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|pushl
name|$0
literal|1
operator|:
name|calls
name|$1
operator|,
name|_mbintr
name|POPR
name|incl
name|_cnt
operator|+
name|V_INTR
name|rei
endif|#
directive|endif
if|#
directive|if
name|VAX780
comment|/*  * Registers for the uba handling code  */
define|#
directive|define
name|rUBANUM
value|r0
define|#
directive|define
name|rUBAHD
value|r1
define|#
directive|define
name|rUVEC
value|r3
define|#
directive|define
name|rUBA
value|r4
comment|/* r2,r5 are scratch */
name|SCBVEC
argument_list|(
name|ua3int
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|movl
name|$3
decl_stmt|,
name|rUBANUM
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|moval
name|_uba_hd
operator|+
operator|(
literal|3
operator|*
name|UH_SIZE
operator|)
operator|,
name|rUBAHD
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|brb
literal|1f
name|SCBVEC
argument_list|(
name|ua2int
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|movl
name|$2
decl_stmt|,
name|rUBANUM
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|moval
name|_uba_hd
operator|+
operator|(
literal|2
operator|*
name|UH_SIZE
operator|)
operator|,
name|rUBAHD
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|brb
literal|1f
name|SCBVEC
argument_list|(
name|ua1int
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|movl
name|$1
decl_stmt|,
name|rUBANUM
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|moval
name|_uba_hd
operator|+
operator|(
literal|1
operator|*
name|UH_SIZE
operator|)
operator|,
name|rUBAHD
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|brb
literal|1f
name|SCBVEC
argument_list|(
name|ua0int
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|movl
name|$0
decl_stmt|,
name|rUBANUM
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|moval
name|_uba_hd
operator|+
operator|(
literal|0
operator|*
name|UH_SIZE
operator|)
operator|,
name|rUBAHD
expr_stmt|;
end_expr_stmt

begin_expr_stmt
literal|1
operator|:
name|incl
name|_cnt
operator|+
name|V_INTR
name|mfpr
name|$IPL
operator|,
name|r2
comment|/* r2 = mfpr(IPL); */
name|movl
name|UH_UBA
argument_list|(
name|rUBAHD
argument_list|)
operator|,
name|rUBA
comment|/* uba = uhp->uh_uba; */
name|movl
name|UBA_BRRVR
operator|-
literal|0x14
operator|*
literal|4
operator|(
name|rUBA
operator|)
index|[
name|r2
index|]
operator|,
name|rUVEC
comment|/* uvec = uba->uba_brrvr[r2-0x14] */
name|ubanorm
operator|:
name|bleq
name|ubaerror
name|addl2
name|UH_VEC
argument_list|(
name|rUBAHD
argument_list|)
operator|,
name|rUVEC
comment|/* uvec += uh->uh_vec */
name|bicl3
name|$3
operator|,
operator|(
name|rUVEC
operator|)
operator|,
name|r1
name|jmp
literal|2
operator|(
name|r1
operator|)
comment|/* 2 skips ``pushr $0x3f'' */
name|ubaerror
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|calls
name|$0
decl_stmt|,
name|_ubaerror
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|POPR
comment|/* ubaerror r/w's r0-r5 */
name|tstl
name|rUVEC
decl_stmt|;
end_decl_stmt

begin_macro
name|jneq
end_macro

begin_macro
name|ubanorm
end_macro

begin_comment
comment|/* rUVEC contains result */
end_comment

begin_macro
name|POPR
end_macro

begin_macro
name|rei
end_macro

begin_endif
endif|#
directive|endif
end_endif

begin_expr_stmt
name|SCBVEC
argument_list|(
name|cnrint
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|calls
name|$0
decl_stmt|,
name|_cnrint
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|POPR
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|incl
name|_cnt
operator|+
name|V_INTR
expr_stmt|;
end_expr_stmt

begin_macro
name|rei
end_macro

begin_expr_stmt
name|SCBVEC
argument_list|(
name|cnxint
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|calls
name|$0
decl_stmt|,
name|_cnxint
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|POPR
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|incl
name|_cnt
operator|+
name|V_INTR
expr_stmt|;
end_expr_stmt

begin_macro
name|rei
end_macro

begin_expr_stmt
name|SCBVEC
argument_list|(
name|hardclock
argument_list|)
operator|:
name|PUSHR
name|mtpr
name|$ICCS_RUN
operator||
name|ICCS_IE
operator||
name|ICCS_INT
operator||
name|ICCS_ERR
operator|,
name|$ICCS
name|pushl
literal|4
operator|+
literal|6
operator|*
literal|4
operator|(
name|sp
operator|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|pushl
literal|4
operator|+
literal|6
operator|*
literal|4
operator|(
name|sp
operator|)
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|calls
name|$2
decl_stmt|,
name|_hardclock
decl|#
name|hardclock
argument_list|(
name|pc
argument_list|,
name|psl
argument_list|)
if|#
directive|if
name|NPS
operator|>
literal|0
name|pushl
decl|4+6
modifier|*
decl|4
argument_list|(
name|sp
argument_list|)
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|pushl
literal|4
operator|+
literal|6
operator|*
literal|4
operator|(
name|sp
operator|)
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|calls
name|$2
decl_stmt|,
name|_psextsync
endif|#
directive|endif
name|POPR
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|incl
name|_cnt
operator|+
name|V_INTR
operator|#
operator|#
name|temp
name|so
name|not
name|to
end_expr_stmt

begin_break
break|break
name|vmstat
break|-=
name|HZ
name|rei
name|SCBVEC
break|(
name|softclock
end_break

begin_decl_stmt
unit|):
name|PUSHR
if|#
directive|if
name|NDZ
operator|>
literal|0
name|calls
name|$0
decl_stmt|,
name|_dztimer
endif|#
directive|endif
if|#
directive|if
name|NDH
operator|>
literal|0
name|calls
name|$0
decl_stmt|,
name|_dhtimer
endif|#
directive|endif
name|pushl
decl|4+6
modifier|*
decl|4
argument_list|(
name|sp
argument_list|)
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|pushl
literal|4
operator|+
literal|6
operator|*
literal|4
operator|(
name|sp
operator|)
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|calls
name|$2
decl_stmt|,
name|_softclock
decl|#
name|softclock
argument_list|(
name|pc
argument_list|,
name|psl
argument_list|)
name|POPR
decl_stmt|;
end_decl_stmt

begin_macro
name|rei
end_macro

begin_include
include|#
directive|include
file|"../net/netisr.h"
end_include

begin_expr_stmt
operator|.
name|globl
name|_netisr
name|SCBVEC
argument_list|(
name|netintr
argument_list|)
operator|:
name|PUSHR
name|bbcc
name|$NETISR_RAW
operator|,
name|_netisr
operator|,
literal|1f
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|calls
name|$0
decl_stmt|,
name|_rawintr
decl_stmt|;
end_decl_stmt

begin_expr_stmt
literal|1
operator|:
ifdef|#
directive|ifdef
name|INET
include|#
directive|include
file|"../netinet/in_systm.h"
name|bbcc
name|$NETISR_IP
operator|,
name|_netisr
operator|,
literal|1f
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|calls
name|$0
decl_stmt|,
name|_ipintr
decl_stmt|;
end_decl_stmt

begin_expr_stmt
literal|1
operator|:
endif|#
directive|endif
ifdef|#
directive|ifdef
name|NS
name|bbcc
name|$NETISR_NS
operator|,
name|_netisr
operator|,
literal|1f
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|calls
name|$0
decl_stmt|,
name|_nsintr
decl_stmt|;
end_decl_stmt

begin_expr_stmt
literal|1
operator|:
endif|#
directive|endif
name|POPR
name|rei
if|#
directive|if
name|defined
argument_list|(
name|VAX750
argument_list|)
operator|||
name|defined
argument_list|(
name|VAX730
argument_list|)
name|SCBVEC
argument_list|(
name|consdin
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|calls
name|$0
decl_stmt|,
name|_turintr
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|POPR
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|incl
name|_cnt
operator|+
name|V_INTR
expr_stmt|;
end_expr_stmt

begin_macro
name|rei
end_macro

begin_expr_stmt
name|SCBVEC
argument_list|(
name|consdout
argument_list|)
operator|:
name|PUSHR
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|calls
name|$0
decl_stmt|,
name|_tuxintr
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|POPR
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|incl
name|_cnt
operator|+
name|V_INTR
expr_stmt|;
end_expr_stmt

begin_macro
name|rei
end_macro

begin_else
else|#
directive|else
end_else

begin_expr_stmt
name|SCBVEC
argument_list|(
name|consdin
argument_list|)
operator|:
name|halt
name|SCBVEC
argument_list|(
name|consdout
argument_list|)
operator|:
name|halt
endif|#
directive|endif
if|#
directive|if
name|NDZ
operator|>
literal|0
comment|/*  * DZ pseudo dma routine:  *	r0 - controller number  */
operator|.
name|align
literal|1
operator|.
name|globl
name|_dzdma
name|_dzdma
operator|:
name|mull2
name|$8
operator|*
literal|20
operator|,
name|r0
name|movab
name|_dzpdma
argument_list|(
name|r0
argument_list|)
operator|,
name|r3
operator|#
name|pdma
name|structure
name|base
empty|# for this controller
name|dzploop
operator|:
name|movl
name|r3
operator|,
name|r0
name|movl
argument_list|(
name|r0
argument_list|)
operator|+
operator|,
name|r1
operator|#
name|device
specifier|register
name|address
name|movzbl
literal|1
operator|(
name|r1
operator|)
operator|,
name|r2
operator|#
name|get
name|line
name|number
name|bitb
name|$0x80
operator|,
name|r2
operator|#
name|TRDY
name|on
condition|?
name|beql
name|dzprei
operator|#
name|no
name|bicb2
name|$0xf8
operator|,
name|r2
operator|#
name|clear
name|garbage
name|bits
name|mull2
name|$20
operator|,
name|r2
name|addl2
name|r2
operator|,
name|r0
operator|#
name|point
name|at
name|line
literal|'s pdma structure 	movl	(r0)+,r2		# p_mem 	cmpl	r2,(r0)+		# p_mem< p_end ? 	bgequ	dzpcall			# no, go call dzxint 	movb	(r2)+,6(r1)		# dztbuf = *p_mem++ 	movl	r2,-8(r0) 	brb 	dzploop			# check for another line dzprei: 	POPR 	incl	_cnt+V_PDMA 	rei  dzpcall: 	pushl	r3 	pushl	(r0)+			# push tty address 	calls	$1,*(r0)		# call interrupt rtn 	movl	(sp)+,r3 	brb 	dzploop			# check for another line #endif  /*  * Stray UNIBUS interrupt catch routines  */ 	.data 	.align	2 #define	PJ	PUSHR;jsb _Xustray 	.globl	_catcher _catcher: 	PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ 	PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ 	PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ 	PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ 	PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ 	PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ 	PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ 	PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ;PJ  	.globl	_cold _cold:	.long	1 	.data  	.text SCBVEC(ustray): 	blbc	_cold,1f 	mfpr	$IPL,r11 	subl3	$_catcher+8,(sp)+,r10 	ashl	$-1,r10,r10 	POPR 	rei 1: 	subl3	$_catcher+8,(sp)+,r0 	ashl	$-1,r0,-(sp) 	mfpr	$IPL,-(sp) 	PRINTF(2, "uba?: stray intr ipl %x vec %o\n") 	POPR 	rei  /*  * Trap and fault vector routines  */  #define	TRAP(a)	pushl $T_/**/a; jbr alltraps  /*  * Ast delivery (profiling and/or reschedule)  */ SCBVEC(astflt): 	pushl $0; TRAP(ASTFLT) SCBVEC(privinflt): 	pushl $0; TRAP(PRIVINFLT) SCBVEC(xfcflt): 	pushl $0; TRAP(XFCFLT) SCBVEC(resopflt): 	pushl $0; TRAP(RESOPFLT) SCBVEC(resadflt): 	pushl $0; TRAP(RESADFLT) SCBVEC(bptflt): 	pushl $0; TRAP(BPTFLT) SCBVEC(compatflt): 	TRAP(COMPATFLT); SCBVEC(tracep): 	pushl $0; TRAP(TRCTRAP) SCBVEC(arithtrap): 	TRAP(ARITHTRAP) SCBVEC(protflt): 	blbs	(sp)+,segflt 	TRAP(PROTFLT) segflt: 	TRAP(SEGFLT) SCBVEC(transflt): 	bitl	$2,(sp)+ 	bnequ	tableflt 	TRAP(PAGEFLT) tableflt:  	TRAP(TABLEFLT)  alltraps: 	mfpr	$USP,-(sp); calls $0,_trap; mtpr (sp)+,$USP 	incl	_cnt+V_TRAP 	addl2	$8,sp			# pop type, code 	mtpr	$HIGH,$IPL		## dont go to a higher IPL (GROT) 	rei  SCBVEC(syscall): 	pushl	$T_SYSCALL 	mfpr	$USP,-(sp); calls $0,_syscall; mtpr (sp)+,$USP 	incl	_cnt+V_SYSCALL 	addl2	$8,sp			# pop type, code 	mtpr	$HIGH,$IPL		## dont go to a higher IPL (GROT) 	rei  /*  * System page table  */  #define	vaddr(x)	((((x)-_Sysmap)/4)*NBPG+0x80000000) #define	SYSMAP(mname, vname, npte)			\ _/**/mname:	.globl	_/**/mname;		\ 	.space	npte*4;				\ 	.globl	_/**/vname;			\ 	.set	_/**/vname,vaddr(_/**/mname)  	.data 	.align	2 	SYSMAP(Sysmap	,Sysbase	,SYSPTSIZE	) 	SYSMAP(UMBAbeg	,umbabeg	,0		) 	SYSMAP(Nexmap	,nexus		,16*MAXNNEXUS	) 	SYSMAP(UMEMmap	,umem		,512*MAXNUBA	) 	SYSMAP(UMBAend	,umbaend	,0		) 	SYSMAP(Usrptmap	,usrpt		,USRPTSIZE	) 	SYSMAP(Forkmap	,forkutl	,UPAGES		) 	SYSMAP(Xswapmap	,xswaputl	,UPAGES		) 	SYSMAP(Xswap2map,xswap2utl	,UPAGES		) 	SYSMAP(Swapmap	,swaputl	,UPAGES		) 	SYSMAP(Pushmap	,pushutl	,UPAGES		) 	SYSMAP(Vfmap	,vfutl		,UPAGES		) 	SYSMAP(CMAP1	,CADDR1		,1		) 	SYSMAP(CMAP2	,CADDR2		,1		) 	SYSMAP(mcrmap	,mcr		,1		) 	SYSMAP(mmap	,vmmap		,1		) 	SYSMAP(msgbufmap,msgbuf		,MSGBUFPTECNT	) 	SYSMAP(camap	,cabase		,16*CLSIZE	) 	SYSMAP(ecamap	,calimit	,0		) 	SYSMAP(Mbmap	,mbutl		,NMBCLUSTERS*CLSIZE)  eSysmap: 	.globl	_Syssize 	.set	_Syssize,(eSysmap-_Sysmap)/4 	.text  /*  * Initialization  *  * ipl 0x1f; mapen 0; scbb, pcbb, sbr, slr, isp, ksp not set  */ 	.data 	.globl	_cpu _cpu:	.long	0 	.text 	.globl	start start: 	.word	0 /* set system control block base and system page table params */ 	mtpr	$_scb-0x80000000,$SCBB 	mtpr	$_Sysmap-0x80000000,$SBR 	mtpr	$_Syssize,$SLR /* double map the kernel into the virtual user addresses of phys mem */ 	mtpr	$_Sysmap,$P0BR 	mtpr	$_Syssize,$P0LR /* set ISP and get cpu type */ 	movl	$_intstack+NISP*NBPG,sp 	mfpr	$SID,r0 	movab	_cpu,r1 	extzv	$24,$8,r0,(r1) /* init RPB */ 	movab	_rpb,r0 	movl	r0,(r0)+			# rp_selfref 	movab	_doadump,r1 	movl	r1,(r0)+			# rp_dumprout 	movl	$0x1f,r2 	clrl	r3 1:	addl2	(r1)+,r3; sobgtr r2,1b 	movl	r3,(r0)+			# rp_chksum /* count up memory */ 	clrl	r7 1:	pushl	$4; pushl r7; calls $2,_badaddr; tstl r0; bneq 9f 	acbl	$8192*1024-1,$64*1024,r7,1b 9: /* clear memory from kernel bss and pages for proc 0 u. and page table */ 	movab	_edata,r6 	movab	_end,r5 	bbcc	$31,r5,0f; 0: 	addl2	$(UPAGES*NBPG)+NBPG+NBPG,r5 1:	clrq	(r6); acbl r5,$8,r6,1b /* trap() and syscall() save r0-r11 in the entry mask (per ../h/reg.h) */ 	bisw2	$0x0fff,_trap 	bisw2	$0x0fff,_syscall 	calls	$0,_fixctlrmask /* initialize system page table: scb and int stack writeable */ 	clrl	r2 	movab	eintstack,r1; bbcc $31,r1,0f; 0: ashl $-PGSHIFT,r1,r1 1:	bisl3	$PG_V|PG_KW,r2,_Sysmap[r2]; aoblss r1,r2,1b /* make rpb read-only as red zone for interrupt stack */ 	bicl2	$PG_PROT,_rpbmap 	bisl2	$PG_KR,_rpbmap /* make kernel text space read-only */ 	movab	_etext+NBPG-1,r1; bbcc $31,r1,0f; 0: ashl $-PGSHIFT,r1,r1 1:	bisl3	$PG_V|PG_KR,r2,_Sysmap[r2]; aoblss r1,r2,1b /* make kernel data, bss, read-write */ 	movab	_end+NBPG-1,r1; bbcc $31,r1,0f; 0:; ashl $-PGSHIFT,r1,r1 1:	bisl3	$PG_V|PG_KW,r2,_Sysmap[r2]; aoblss r1,r2,1b /* now go to mapped mode */ 	mtpr	$1,$TBIA; mtpr $1,$MAPEN; jmp *$0f; 0: /* init mem sizes */ 	ashl	$-PGSHIFT,r7,_maxmem 	movl	_maxmem,_physmem 	movl	_maxmem,_freemem /* setup context for proc[0] == Scheduler */ 	movab	_end+NBPG-1,r6 	bicl2	$NBPG-1,r6		# make page boundary /* setup page table for proc[0] */ 	bbcc	$31,r6,0f; 0: 	ashl	$-PGSHIFT,r6,r3			# r3 = btoc(r6) 	bisl3	$PG_V|PG_KW,r3,_Usrptmap	# init first upt entry 	incl	r3 	movab	_usrpt,r0 	mtpr	r0,$TBIS /* init p0br, p0lr */ 	mtpr	r0,$P0BR 	mtpr	$0,$P0LR /* init p1br, p1lr */ 	movab	NBPG(r0),r0 	movl	$0x200000-UPAGES,r1 	mtpr	r1,$P1LR 	mnegl	r1,r1 	moval	-4*UPAGES(r0)[r1],r2 	mtpr	r2,$P1BR /* setup mapping for UPAGES of _u */ 	movl	$UPAGES,r2; movab _u+NBPG*UPAGES,r1; addl2 $UPAGES,r3; jbr 2f 1:	decl	r3 	moval	-NBPG(r1),r1; 	bisl3	$PG_V|PG_URKW,r3,-(r0) 	mtpr	r1,$TBIS 2:	sobgeq	r2,1b /* initialize (slightly) the pcb */ 	movab	UPAGES*NBPG(r1),PCB_KSP(r1) 	mnegl	$1,PCB_ESP(r1) 	mnegl	$1,PCB_SSP(r1) 	movl	r1,PCB_USP(r1) 	mfpr	$P0BR,PCB_P0BR(r1) 	mfpr	$P0LR,PCB_P0LR(r1) 	movb	$4,PCB_P0LR+3(r1)		# disable ast 	mfpr	$P1BR,PCB_P1BR(r1) 	mfpr	$P1LR,PCB_P1LR(r1) 	movl	$CLSIZE,PCB_SZPT(r1)		# init u.u_pcb.pcb_szpt 	movl	r11,PCB_R11(r1) 	movab	1f,PCB_PC(r1)			# initial pc 	clrl	PCB_PSL(r1)			# mode(k,k), ipl=0 	ashl	$PGSHIFT,r3,r3 	mtpr	r3,$PCBB			# first pcbb /* set regs, p0br, p0lr, p1br, p1lr, astlvl, ksp and change to kernel mode */ 	ldpctx 	rei /* put signal trampoline code in u. area */ 1:	movab	_u,r0 	movc3	$12,sigcode,PCB_SIGC(r0) /* save reboot flags in global _boothowto */ 	movl	r11,_boothowto /* calculate firstaddr, and call main() */ 	movab	_end+NBPG-1,r0; bbcc $31,r0,0f; 0:; ashl $-PGSHIFT,r0,-(sp) 	addl2	$UPAGES+1,(sp); calls $1,_main /* proc[1] == /etc/init now running here; run icode */ 	pushl	$PSL_CURMOD|PSL_PRVMOD; pushl $0; rei  /* signal trampoline code: it is known that this code takes exactly 12 bytes */ /* in ../h/pcb.h and in the movc3 above */ sigcode: 	calls	$3,1(pc) 	rei 	.word	0x7f				# registers 0-6 (6==sp/compat) 	callg	(ap),*12(ap) 	ret  /*  * Primitives  */   /*  * badaddr(addr, len)  *	see if access addr with a len type instruction causes a machine check  *	len is length of access (1=byte, 2=short, 4=long)  */ 	.globl	_badaddr _badaddr: 	.word	0 	movl	$1,r0 	mfpr	$IPL,r1 	mtpr	$HIGH,$IPL 	movl	_scb+MCKVEC,r2 	movl	4(ap),r3 	movl	8(ap),r4 	movab	9f+INTSTK,_scb+MCKVEC 	bbc	$0,r4,1f; tstb	(r3) 1:	bbc	$1,r4,1f; tstw	(r3) 1:	bbc	$2,r4,1f; tstl	(r3) 1:	clrl	r0			# made it w/o machine checks 2:	movl	r2,_scb+MCKVEC 	mtpr	r1,$IPL 	ret 	.align	2 9: 	casel	_cpu,$1,$VAX_MAX 0: 	.word	8f-0b		# 1 is 780 	.word	5f-0b		# 2 is 750 	.word	5f-0b		# 3 is 730 5: #if defined(VAX750) || defined(VAX730) 	mtpr	$0xf,$MCESR #endif 	brb	1f 8: #if VAX780 	mtpr	$0,$SBIFS #endif 1: 	addl2	(sp)+,sp		# discard mchchk trash 	movab	2b,(sp) 	rei  _addupc:	.globl	_addupc 	.word	0x0 	movl	8(ap),r2		#&u.u_prof 	subl3	8(r2),4(ap),r0		# corrected pc 	blss	9f 	extzv	$1,$31,r0,r0		# logical right shift 	extzv	$1,$31,12(r2),r1	# ditto for scale 	emul	r1,r0,$0,r0 	ashq	$-14,r0,r0 	tstl	r1 	bneq	9f 	incl	r0 	bicl2	$1,r0 	cmpl	r0,4(r2)		# length 	bgequ	9f 	addl2	(r2),r0			# base 	probew	$3,$2,(r0) 	beql	8f 	addw2	12(ap),(r0) 9: 	ret 8: 	clrl	12(r2) 	ret  _Copyin:	.globl	_Copyin		#<<<massaged for jsb by asm.sed>>> 	movl	12(sp),r0		# copy length 	blss	ersb 	movl	4(sp),r1		# copy user address 	cmpl	$NBPG,r0		# probing one page or less ? 	bgeq	cishort			# yes ciloop: 	prober	$3,$NBPG,(r1)		# bytes accessible ? 	beql	ersb			# no 	addl2	$NBPG,r1		# incr user address ptr 	acbl	$NBPG+1,$-NBPG,r0,ciloop	# reduce count and loop cishort: 	prober	$3,r0,(r1)		# bytes accessible ? 	beql	ersb			# no 	movl	4(sp),r1 	movl	8(sp),r3 	jbr	2f 1: 	subl2	r0,12(sp) 	movc3	r0,(r1),(r3) 2: 	movzwl	$65535,r0 	cmpl	12(sp),r0 	jgtr	1b 	movc3	12(sp),(r1),(r3) 	clrl	r0			#redundant 	rsb  ersb: 	movl	$EFAULT,r0 	rsb  _Copyout: 	.globl	_Copyout	#<<<massaged for jsb by asm.sed>>> 	movl	12(sp),r0		# get count 	blss	ersb 	movl	8(sp),r1		# get user address 	cmpl	$NBPG,r0		# can do in one probew? 	bgeq	coshort			# yes coloop: 	probew	$3,$NBPG,(r1)		# bytes accessible? 	beql	ersb			# no  	addl2	$NBPG,r1		# increment user address 	acbl	$NBPG+1,$-NBPG,r0,coloop	# reduce count and loop coshort: 	probew	$3,r0,(r1)		# bytes accessible? 	beql	ersb			# no 	movl	4(sp),r1 	movl	8(sp),r3 	jbr	2f 1: 	subl2	r0,12(sp) 	movc3	r0,(r1),(r3) 2: 	movzwl	$65535,r0 	cmpl	12(sp),r0 	jgtr	1b 	movc3	12(sp),(r1),(r3) 	clrl	r0				#redundant 	rsb  /*  * non-local goto'
name|s
operator|*
operator|/
operator|.
name|globl
name|_Setjmp
name|_Setjmp
operator|:
name|movq
name|r6
operator|,
operator|(
name|r0
operator|)
operator|+
name|movq
name|r8
operator|,
operator|(
name|r0
operator|)
operator|+
name|movq
name|r10
operator|,
operator|(
name|r0
operator|)
operator|+
name|movq
name|r12
operator|,
operator|(
name|r0
operator|)
operator|+
name|addl3
name|$4
operator|,
name|sp
operator|,
operator|(
name|r0
operator|)
operator|+
name|movl
argument_list|(
name|sp
argument_list|)
operator|,
operator|(
name|r0
operator|)
name|clrl
name|r0
name|rsb
operator|.
name|globl
name|_Longjmp
name|_Longjmp
operator|:
name|movq
argument_list|(
name|r0
argument_list|)
operator|+
operator|,
name|r6
name|movq
argument_list|(
name|r0
argument_list|)
operator|+
operator|,
name|r8
name|movq
argument_list|(
name|r0
argument_list|)
operator|+
operator|,
name|r10
name|movq
argument_list|(
name|r0
argument_list|)
operator|+
operator|,
name|r12
name|movl
argument_list|(
name|r0
argument_list|)
operator|+
operator|,
name|r1
name|cmpl
name|r1
operator|,
name|sp
operator|#
name|must
name|be
name|a
name|pop
name|bgequ
name|lj2
name|pushab
name|lj1
name|calls
name|$1
operator|,
name|_panic
name|lj2
operator|:
name|movl
name|r1
operator|,
name|sp
name|jmp
operator|*
operator|(
name|r0
operator|)
operator|#
operator|`
operator|`
name|rsb
literal|''
name|lj1
operator|:
operator|.
name|asciz
literal|"longjmp"
operator|.
name|globl
name|_whichqs
operator|.
name|globl
name|_qs
operator|.
name|globl
name|_cnt
operator|.
name|globl
name|_noproc
operator|.
name|comm
name|_noproc
operator|,
literal|4
operator|.
name|globl
name|_runrun
operator|.
name|comm
name|_runrun
operator|,
literal|4
comment|/*  * The following primitives use the fancy VAX instructions  * much like VMS does.  _whichqs tells which of the 32 queues _qs  * have processes in them.  Setrq puts processes into queues, Remrq  * removes them from queues.  The running process is on no queue,  * other processes are on a queue related to p->p_pri, divided by 4  * actually to shrink the 0-127 range of priorities into the 32 available  * queues.  */
comment|/*  * Setrq(p), using fancy VAX instructions.  *  * Call should be made at spl6(), and p->p_stat should be SRUN  */
operator|.
name|globl
name|_Setrq
operator|#
expr|<<<
name|massaged
name|to
name|jsb
name|by
literal|"asm.sed"
operator|>>>
name|_Setrq
operator|:
name|tstl
name|P_RLINK
argument_list|(
name|r0
argument_list|)
operator|#
operator|#
name|firewall
operator|:
name|p
operator|->
name|p_rlink
name|must
name|be
literal|0
name|beql
name|set1
operator|#
operator|#
name|pushab
name|set3
operator|#
operator|#
name|calls
name|$1
operator|,
name|_panic
operator|#
operator|#
name|set1
operator|:
name|movzbl
name|P_PRI
argument_list|(
name|r0
argument_list|)
operator|,
name|r1
operator|#
name|put
name|on
name|queue
name|which
name|is
name|p
operator|->
name|p_pri
operator|/
literal|4
name|ashl
name|$
operator|-
literal|2
operator|,
name|r1
operator|,
name|r1
name|movaq
name|_qs
index|[
name|r1
index|]
operator|,
name|r2
name|insque
argument_list|(
name|r0
argument_list|)
operator|,
operator|*
literal|4
operator|(
name|r2
operator|)
operator|#
name|at
name|end
name|of
name|queue
name|bbss
name|r1
operator|,
name|_whichqs
operator|,
name|set2
operator|#
name|mark
name|queue
name|non
operator|-
name|empty
name|set2
operator|:
name|rsb
name|set3
operator|:
operator|.
name|asciz
literal|"setrq"
comment|/*  * Remrq(p), using fancy VAX instructions  *  * Call should be made at spl6().  */
operator|.
name|globl
name|_Remrq
operator|#
expr|<<<
name|massaged
name|to
name|jsb
name|by
literal|"asm.sed"
operator|>>>
name|_Remrq
operator|:
name|movzbl
name|P_PRI
argument_list|(
name|r0
argument_list|)
operator|,
name|r1
name|ashl
name|$
operator|-
literal|2
operator|,
name|r1
operator|,
name|r1
name|bbsc
name|r1
operator|,
name|_whichqs
operator|,
name|rem1
name|pushab
name|rem3
operator|#
name|it
name|wasn
literal|'t recorded to be on its q 	calls	$1,_panic rem1: 	remque	(r0),r2 	beql	rem2 	bbss	r1,_whichqs,rem2 rem2: 	clrl	P_RLINK(r0)		## for firewall checking 	rsb  rem3:	.asciz	"remrq"  /*  * Masterpaddr is the p->p_addr of the running process on the master  * processor.  When a multiprocessor system, the slave processors will have  * an array of slavepaddr'
name|s
operator|.
modifier|*
expr|/
operator|.
name|globl
name|_masterpaddr
operator|.
name|data
name|_masterpaddr
operator|:
operator|.
name|long
literal|0
operator|.
name|text
name|sw0
operator|:
operator|.
name|asciz
literal|"swtch"
comment|/*  * Swtch(), using fancy VAX instructions  */
operator|.
name|globl
name|_Swtch
name|_Swtch
operator|:
operator|#
expr|<<<
name|massaged
name|to
name|jsb
name|by
literal|"asm.sed"
operator|>>>
name|movl
name|$1
operator|,
name|_noproc
name|clrl
name|_runrun
name|sw1
operator|:
name|ffs
name|$0
operator|,
name|$32
operator|,
name|_whichqs
operator|,
name|r0
operator|#
name|look
end_expr_stmt

begin_for
for|for non-empty queue 	bneq	sw1a 	mtpr	$0
operator|,
name|$IPL
operator|#
name|must
name|allow
name|interrupts
name|here
name|jbr
name|sw1
operator|#
name|this
name|is
name|an
name|idle
name|loop
operator|!
name|sw1a
operator|:
name|mtpr
name|$0x18
operator|,
name|$IPL
operator|#
name|lock
name|out
name|all
name|so
name|_whichqs
operator|==
name|_qs
name|bbcc
name|r0
operator|,
name|_whichqs
operator|,
name|sw1
operator|#
name|proc
name|moved
name|via
name|lbolt
name|interrupt
name|movaq
name|_qs
index|[
name|r0
index|]
operator|,
name|r1
name|remque
operator|*
operator|(
name|r1
operator|)
operator|,
name|r2
operator|#
name|r2
operator|=
name|p
operator|=
name|highest
name|pri
name|process
name|bvc
name|sw2
operator|#
name|make
name|sure
name|something
name|was
name|there
name|sw1b
operator|:
name|pushab
name|sw0
name|calls
name|$1
operator|,
name|_panic
name|sw2
operator|:
name|beql
name|sw3
name|insv
name|$1
operator|,
name|r0
operator|,
name|$1
operator|,
name|_whichqs
operator|#
name|still
name|more
name|procs
name|in
name|this
name|queue
name|sw3
operator|:
name|clrl
name|_noproc
name|tstl
name|P_WCHAN
argument_list|(
name|r2
argument_list|)
operator|#
operator|#
name|firewalls
name|bneq
name|sw1b
operator|#
operator|#
name|movzbl
name|P_STAT
argument_list|(
name|r2
argument_list|)
operator|,
name|r3
operator|#
operator|#
name|cmpl
name|$SRUN
operator|,
name|r3
operator|#
operator|#
name|bneq
name|sw1b
operator|#
operator|#
name|clrl
name|P_RLINK
argument_list|(
name|r2
argument_list|)
operator|#
operator|#
name|movl
operator|*
name|P_ADDR
argument_list|(
name|r2
argument_list|)
operator|,
name|r0
name|movl
name|r0
operator|,
name|_masterpaddr
name|ashl
name|$PGSHIFT
operator|,
name|r0
operator|,
name|r0
operator|#
name|r0
operator|=
name|pcbb
argument_list|(
argument|p
argument_list|)
comment|/*	mfpr	$PCBB,r1		# resume of current proc is easy  *	cmpl	r0,r1  */
name|beql
name|res0
name|incl
name|_cnt
operator|+
name|V_SWTCH
comment|/* fall into... */
comment|/*  * Resume(pf)  */
operator|.
name|globl
name|_Resume
operator|#
expr|<<<
name|massaged
name|to
name|jsb
name|by
literal|"asm.sed"
operator|>>>
name|_Resume
operator|:
name|mtpr
name|$0x18
operator|,
name|$IPL
operator|#
name|no
name|interrupts
operator|,
name|please
name|movl
name|_CMAP2
operator|,
name|_u
operator|+
name|PCB_CMAP2
operator|#
name|yech
name|svpctx
name|mtpr
name|r0
operator|,
name|$PCBB
name|ldpctx
name|movl
name|_u
operator|+
name|PCB_CMAP2
operator|,
name|_CMAP2
operator|#
name|yech
name|mtpr
name|$_CADDR2
operator|,
name|$TBIS
name|res0
operator|:
name|tstl
name|_u
operator|+
name|PCB_SSWAP
name|beql
name|res1
name|movl
name|_u
operator|+
name|PCB_SSWAP
operator|,
name|r0
name|clrl
name|_u
operator|+
name|PCB_SSWAP
name|movab
name|_Longjmp
operator|,
operator|(
name|sp
operator|)
name|movl
name|$PSL_PRVMOD
operator|,
literal|4
operator|(
name|sp
operator|)
operator|#
operator|`
operator|`
name|cheating
literal|''
operator|(
name|jfr
operator|)
name|res1
operator|:
name|rei
comment|/*  * {fu,su},{byte,word}, all massaged by asm.sed to jsb's  */
operator|.
name|globl
name|_Fuword
name|_Fuword
operator|:
name|prober
name|$3
operator|,
name|$4
operator|,
operator|(
name|r0
operator|)
name|beql
name|fserr
name|movl
argument_list|(
name|r0
argument_list|)
operator|,
name|r0
name|rsb
name|fserr
operator|:
name|mnegl
name|$1
operator|,
name|r0
name|rsb
operator|.
name|globl
name|_Fubyte
name|_Fubyte
operator|:
name|prober
name|$3
operator|,
name|$1
operator|,
operator|(
name|r0
operator|)
name|beql
name|fserr
name|movzbl
argument_list|(
name|r0
argument_list|)
operator|,
name|r0
name|rsb
operator|.
name|globl
name|_Suword
name|_Suword
operator|:
name|probew
name|$3
operator|,
name|$4
operator|,
operator|(
name|r0
operator|)
name|beql
name|fserr
name|movl
name|r1
operator|,
operator|(
name|r0
operator|)
name|clrl
name|r0
name|rsb
operator|.
name|globl
name|_Subyte
name|_Subyte
operator|:
name|probew
name|$3
operator|,
name|$1
operator|,
operator|(
name|r0
operator|)
name|beql
name|fserr
name|movb
name|r1
operator|,
operator|(
name|r0
operator|)
name|clrl
name|r0
name|rsb
comment|/*  * Copy 1 relocation unit (NBPG bytes)  * from user virtual address to physical address  */
name|_copyseg
operator|:
operator|.
name|globl
name|_copyseg
operator|.
name|word
literal|0x0
name|bisl3
name|$PG_V
operator||
name|PG_KW
operator|,
literal|8
operator|(
name|ap
operator|)
operator|,
name|_CMAP2
name|mtpr
name|$_CADDR2
operator|,
name|$TBIS
operator|#
name|invalidate
name|entry
end_for

begin_for
for|for copy  	movc3	$NBPG
operator|,
operator|*
literal|4
operator|(
name|ap
operator|)
operator|,
name|_CADDR2
name|ret
comment|/*  * zero out physical memory  * specified in relocation units (NBPG bytes)  */
name|_clearseg
operator|:
operator|.
name|globl
name|_clearseg
operator|.
name|word
literal|0x0
name|bisl3
name|$PG_V
operator||
name|PG_KW
operator|,
literal|4
operator|(
name|ap
operator|)
operator|,
name|_CMAP1
name|mtpr
name|$_CADDR1
operator|,
name|$TBIS
name|movc5
name|$0
operator|,
operator|(
name|sp
operator|)
operator|,
name|$0
operator|,
name|$NBPG
operator|,
name|_CADDR1
name|ret
comment|/*  * Check address.  * Given virtual address, byte count, and rw flag  * returns 0 on no access.  */
name|_useracc
operator|:
operator|.
name|globl
name|_useracc
operator|.
name|word
literal|0x0
name|movl
literal|4
operator|(
name|ap
operator|)
operator|,
name|r0
operator|#
name|get
name|va
name|movl
literal|8
operator|(
name|ap
operator|)
operator|,
name|r1
operator|#
name|count
name|tstl
literal|12
operator|(
name|ap
operator|)
operator|#
name|test
end_for

begin_for
for|for read access ? 	bneq	userar			# yes 	cmpl	$NBPG
operator|,
name|r1
operator|#
name|can
name|we
end_for

begin_do
do|do
name|it
name|in
name|one
name|probe
condition|?
name|bgeq
name|uaw2
operator|#
name|yes
name|uaw1
else|:
name|probew
name|$3
operator|,
name|$NBPG
operator|,
operator|(
name|r0
operator|)
name|beql
name|uaerr
operator|#
name|no
name|access
name|addl2
name|$NBPG
operator|,
name|r0
name|acbl
name|$NBPG
operator|+
literal|1
operator|,
name|$
operator|-
name|NBPG
operator|,
name|r1
operator|,
name|uaw1
name|uaw2
operator|:
name|probew
name|$3
operator|,
name|r1
operator|,
operator|(
name|r0
operator|)
name|beql
name|uaerr
name|movl
name|$1
operator|,
name|r0
name|ret
name|userar
operator|:
name|cmpl
name|$NBPG
operator|,
name|r1
name|bgeq
name|uar2
name|uar1
operator|:
name|prober
name|$3
operator|,
name|$NBPG
operator|,
operator|(
name|r0
operator|)
name|beql
name|uaerr
name|addl2
name|$NBPG
operator|,
name|r0
name|acbl
name|$NBPG
operator|+
literal|1
operator|,
name|$
operator|-
name|NBPG
operator|,
name|r1
operator|,
name|uar1
name|uar2
operator|:
name|prober
name|$3
operator|,
name|r1
operator|,
operator|(
name|r0
operator|)
name|beql
name|uaerr
name|movl
name|$1
operator|,
name|r0
name|ret
name|uaerr
operator|:
name|clrl
name|r0
name|ret
comment|/*  * kernacc - check for kernel access privileges  *  * We can't use the probe instruction directly because  * it ors together current and previous mode.  */
operator|.
name|globl
name|_kernacc
name|_kernacc
operator|:
operator|.
name|word
literal|0x0
name|movl
literal|4
operator|(
name|ap
operator|)
operator|,
name|r0
operator|#
name|virtual
name|address
name|bbcc
name|$31
operator|,
name|r0
operator|,
name|kacc1
name|bbs
name|$30
operator|,
name|r0
operator|,
name|kacerr
name|mfpr
name|$SBR
operator|,
name|r2
operator|#
name|address
name|and
name|length
name|of
name|page
name|table
argument_list|(
argument|system
argument_list|)
name|bbss
name|$31
operator|,
name|r2
operator|,
literal|0f
expr_stmt|;
do|0: 	mfpr	$SLR
operator|,
do|r3 	brb	kacc2 kacc1: 	bbsc	$30
operator|,
do|r0
operator|,
do|kacc3 	mfpr	$P0BR
operator|,
do|r2	# user P0 	mfpr	$P0LR
operator|,
do|r3 	brb	kacc2 kacc3: 	mfpr	$P1BR
operator|,
do|r2	# user P1 (stack
end_do

begin_decl_stmt
unit|)
name|mfpr
name|$P1LR
decl_stmt|,
name|r3
name|kacc2
range|:
name|addl3
literal|8
operator|(
name|ap
operator|)
decl_stmt|,
name|r0
decl_stmt|,
name|r1
decl|#
name|ending
name|virtual
name|address
name|addl2
name|$NBPG
decl|-1
decl_stmt|,
name|r1
name|ashl
name|$
decl|-
name|PGSHIFT
decl_stmt|,
name|r0
decl_stmt|,
name|r0
name|ashl
name|$
decl|-
name|PGSHIFT
decl_stmt|,
name|r1
decl_stmt|,
name|r1
name|bbs
name|$31
decl_stmt|,4
argument_list|(
name|ap
argument_list|)
decl_stmt|,
name|kacc6
name|bbc
name|$30
decl_stmt|,4
argument_list|(
name|ap
argument_list|)
decl_stmt|,
name|kacc6
name|cmpl
name|r0
decl_stmt|,
name|r3
decl|#
name|user
name|stack
name|blss
name|kacerr
decl|#
name|address
name|too
name|low
name|brb
name|kacc4
name|kacc6
range|:
name|cmpl
name|r1
decl_stmt|,
name|r3
decl|#
name|compare
name|last
name|page
name|to
name|P0LR
name|or
name|SLR
name|bgtr
name|kacerr
decl|#
name|address
name|too
name|high
name|kacc4
range|:
name|movl
argument_list|(
name|r2
argument_list|)
index|[
name|r0
index|]
decl_stmt|,
name|r3
name|bbc
name|$31
decl_stmt|,4
argument_list|(
name|ap
argument_list|)
decl_stmt|,
name|kacc4a
name|bbc
name|$31
decl_stmt|,
name|r3
decl_stmt|,
name|kacerr
decl|#
name|valid
name|bit
name|is
name|off
name|kacc4a
range|:
name|cmpzv
name|$27
decl_stmt|,
name|$4
decl_stmt|,
name|r3
decl_stmt|,
name|$1
decl|#
name|check
name|protection
name|code
name|bleq
name|kacerr
decl|#
name|no
name|access
name|allowed
name|tstb
decl|12
argument_list|(
name|ap
argument_list|)
name|bneq
name|kacc5
decl|#
name|only
name|check
name|read
name|access
name|cmpzv
name|$27
decl_stmt|,
name|$2
decl_stmt|,
name|r3
decl_stmt|,
name|$3
decl|#
name|check
name|low
decl|2
name|bits
name|of
name|prot
name|code
name|beql
name|kacerr
decl|#
name|no
name|write
name|access
name|kacc5
range|:
name|aoblss
name|r1
decl_stmt|,
name|r0
decl_stmt|,
name|kacc4
decl|#
name|next
name|page
name|movl
name|$1
decl_stmt|,
name|r0
decl|#
name|no
name|errors
name|ret
name|kacerr
range|:
name|clrl
name|r0
operator|#
name|error
name|ret
operator|.
name|globl
name|_Xrkintr0
operator|.
name|align
literal|2
name|_Xrkintr0
operator|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_rkintr
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xtmintr0
operator|.
name|align
decl|2
name|_Xtmintr0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_tmintr
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xutintr0
operator|.
name|align
decl|2
name|_Xutintr0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_utintr
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xupintr0
operator|.
name|align
decl|2
name|_Xupintr0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_upintr
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xudintr0
operator|.
name|align
decl|2
name|_Xudintr0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_udintr
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xidcintr0
operator|.
name|align
decl|2
name|_Xidcintr0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_idcintr
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdnintr0
operator|.
name|align
decl|2
name|_Xdnintr0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_dnintr
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdhrint0
operator|.
name|align
decl|2
name|_Xdhrint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_dhrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdhxint0
operator|.
name|align
decl|2
name|_Xdhxint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_dhxint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdmintr0
operator|.
name|align
decl|2
name|_Xdmintr0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_dmintr
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdhrint1
operator|.
name|align
decl|2
name|_Xdhrint1
range|:
name|pushr
name|$0x3f
name|pushl
name|$1
name|calls
name|$1
decl_stmt|,
name|_dhrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdhxint1
operator|.
name|align
decl|2
name|_Xdhxint1
range|:
name|pushr
name|$0x3f
name|pushl
name|$1
name|calls
name|$1
decl_stmt|,
name|_dhxint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdzrint0
operator|.
name|align
decl|2
name|_Xdzrint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_dzrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdzxint0
operator|.
name|align
decl|2
name|_Xdzxint0
range|:
name|pushr
name|$0x3f
name|movl
name|$0
decl_stmt|,
name|r0
name|jmp
name|_dzdma
operator|.
name|globl
name|_Xdzrint1
operator|.
name|align
decl|2
name|_Xdzrint1
range|:
name|pushr
name|$0x3f
name|pushl
name|$1
name|calls
name|$1
decl_stmt|,
name|_dzrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdzxint1
operator|.
name|align
decl|2
name|_Xdzxint1
range|:
name|pushr
name|$0x3f
name|movl
name|$1
decl_stmt|,
name|r0
name|jmp
name|_dzdma
operator|.
name|globl
name|_Xdzrint2
operator|.
name|align
decl|2
name|_Xdzrint2
range|:
name|pushr
name|$0x3f
name|pushl
name|$2
name|calls
name|$1
decl_stmt|,
name|_dzrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdzxint2
operator|.
name|align
decl|2
name|_Xdzxint2
range|:
name|pushr
name|$0x3f
name|movl
name|$2
decl_stmt|,
name|r0
name|jmp
name|_dzdma
operator|.
name|globl
name|_Xdzrint3
operator|.
name|align
decl|2
name|_Xdzrint3
range|:
name|pushr
name|$0x3f
name|pushl
name|$3
name|calls
name|$1
decl_stmt|,
name|_dzrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdzxint3
operator|.
name|align
decl|2
name|_Xdzxint3
range|:
name|pushr
name|$0x3f
name|movl
name|$3
decl_stmt|,
name|r0
name|jmp
name|_dzdma
operator|.
name|globl
name|_Xdzrint4
operator|.
name|align
decl|2
name|_Xdzrint4
range|:
name|pushr
name|$0x3f
name|pushl
name|$4
name|calls
name|$1
decl_stmt|,
name|_dzrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdzxint4
operator|.
name|align
decl|2
name|_Xdzxint4
range|:
name|pushr
name|$0x3f
name|movl
name|$4
decl_stmt|,
name|r0
name|jmp
name|_dzdma
operator|.
name|globl
name|_Xdzrint5
operator|.
name|align
decl|2
name|_Xdzrint5
range|:
name|pushr
name|$0x3f
name|pushl
name|$5
name|calls
name|$1
decl_stmt|,
name|_dzrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdzxint5
operator|.
name|align
decl|2
name|_Xdzxint5
range|:
name|pushr
name|$0x3f
name|movl
name|$5
decl_stmt|,
name|r0
name|jmp
name|_dzdma
operator|.
name|globl
name|_Xdzrint6
operator|.
name|align
decl|2
name|_Xdzrint6
range|:
name|pushr
name|$0x3f
name|pushl
name|$6
name|calls
name|$1
decl_stmt|,
name|_dzrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdzxint6
operator|.
name|align
decl|2
name|_Xdzxint6
range|:
name|pushr
name|$0x3f
name|movl
name|$6
decl_stmt|,
name|r0
name|jmp
name|_dzdma
operator|.
name|globl
name|_Xdzrint7
operator|.
name|align
decl|2
name|_Xdzrint7
range|:
name|pushr
name|$0x3f
name|pushl
name|$7
name|calls
name|$1
decl_stmt|,
name|_dzrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdzxint7
operator|.
name|align
decl|2
name|_Xdzxint7
range|:
name|pushr
name|$0x3f
name|movl
name|$7
decl_stmt|,
name|r0
name|jmp
name|_dzdma
operator|.
name|globl
name|_Xtsintr0
operator|.
name|align
decl|2
name|_Xtsintr0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_tsintr
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdmfsrint0
operator|.
name|align
decl|2
name|_Xdmfsrint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_dmfsrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdmfsxint0
operator|.
name|align
decl|2
name|_Xdmfsxint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_dmfsxint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdmfdaint0
operator|.
name|align
decl|2
name|_Xdmfdaint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_dmfdaint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdmfdbint0
operator|.
name|align
decl|2
name|_Xdmfdbint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_dmfdbint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdmfrint0
operator|.
name|align
decl|2
name|_Xdmfrint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_dmfrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdmfxint0
operator|.
name|align
decl|2
name|_Xdmfxint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_dmfxint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdmflint0
operator|.
name|align
decl|2
name|_Xdmflint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_dmflint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xikintr0
operator|.
name|align
decl|2
name|_Xikintr0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_ikintr
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xenxint0
operator|.
name|align
decl|2
name|_Xenxint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_enxint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xenrint0
operator|.
name|align
decl|2
name|_Xenrint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_enrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xencollide0
operator|.
name|align
decl|2
name|_Xencollide0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_encollide
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xecrint0
operator|.
name|align
decl|2
name|_Xecrint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_ecrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xeccollide0
operator|.
name|align
decl|2
name|_Xeccollide0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_eccollide
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xecxint0
operator|.
name|align
decl|2
name|_Xecxint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_ecxint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xilrint0
operator|.
name|align
decl|2
name|_Xilrint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_ilrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xilcint0
operator|.
name|align
decl|2
name|_Xilcint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_ilcint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xaccrint0
operator|.
name|align
decl|2
name|_Xaccrint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_accrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xaccxint0
operator|.
name|align
decl|2
name|_Xaccxint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_accxint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xunintr0
operator|.
name|align
decl|2
name|_Xunintr0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_unintr
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdmcrint0
operator|.
name|align
decl|2
name|_Xdmcrint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_dmcrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xdmcxint0
operator|.
name|align
decl|2
name|_Xdmcxint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_dmcxint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xvvrint0
operator|.
name|align
decl|2
name|_Xvvrint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_vvrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xvvxint0
operator|.
name|align
decl|2
name|_Xvvxint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_vvxint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xhyint0
operator|.
name|align
decl|2
name|_Xhyint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_hyint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xcssxint0
operator|.
name|align
decl|2
name|_Xcssxint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_cssxint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xcssrint0
operator|.
name|align
decl|2
name|_Xcssrint0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_cssrint
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xvaintr0
operator|.
name|align
decl|2
name|_Xvaintr0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_vaintr
name|popr
name|$0x3f
name|rei
operator|.
name|globl
name|_Xvpintr0
operator|.
name|align
decl|2
name|_Xvpintr0
range|:
name|pushr
name|$0x3f
name|pushl
name|$0
name|calls
name|$1
decl_stmt|,
name|_vpintr
name|popr
name|$0x3f
name|rei
end_decl_stmt

end_unit

