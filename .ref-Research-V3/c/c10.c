begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  	    	C compiler, part 2  	Copyright 1972 Bell Telephone Laboratories, Inc.  */
end_comment

begin_macro
name|waste
argument_list|()
end_macro

begin_comment
comment|/* waste space */
end_comment

begin_block
block|{
name|waste
argument_list|(
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|,
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|,
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|)
expr_stmt|;
name|waste
argument_list|(
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|,
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|,
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|)
expr_stmt|;
name|waste
argument_list|(
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|,
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|,
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|)
expr_stmt|;
name|waste
argument_list|(
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|,
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|,
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|)
expr_stmt|;
name|waste
argument_list|(
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|,
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|,
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|)
expr_stmt|;
name|waste
argument_list|(
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|,
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|,
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|)
expr_stmt|;
name|waste
argument_list|(
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|,
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|,
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|)
expr_stmt|;
name|waste
argument_list|(
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|,
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|,
name|waste
argument_list|(
name|waste
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_block

begin_function
name|main
parameter_list|(
name|argc
parameter_list|,
name|argv
parameter_list|)
name|char
name|argv
index|[]
index|[]
decl_stmt|;
block|{
extern|extern fout
operator|,
extern|fin
operator|,
extern|nerror
operator|,
extern|line;
extern|extern getwrd
operator|,
extern|rcexpr
operator|,
extern|tmpfil;
extern|extern cctab[]
operator|,
extern|regtab[]
operator|,
extern|efftab[]
operator|,
extern|sptab[];
name|int
name|sp
index|[]
decl_stmt|,
name|c
decl_stmt|,
name|table
index|[]
decl_stmt|,
name|tabtab
index|[
literal|3
index|]
index|[]
decl_stmt|,
name|tree
decl_stmt|;
if|if
condition|(
name|argc
operator|<
literal|4
condition|)
block|{
name|error
argument_list|(
literal|"Arg count"
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|fin
operator|=
name|open
argument_list|(
name|argv
index|[
literal|1
index|]
argument_list|,
literal|0
argument_list|)
operator|)
operator|<
literal|0
condition|)
block|{
name|error
argument_list|(
literal|"Cant't find %s"
argument_list|,
name|argv
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|fout
operator|=
name|creat
argument_list|(
name|argv
index|[
literal|3
index|]
argument_list|,
literal|017
argument_list|)
operator|)
operator|<
literal|0
condition|)
block|{
name|error
argument_list|(
literal|"Can't create %s"
argument_list|,
name|argv
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
name|tmpfil
operator|=
name|argv
index|[
literal|2
index|]
expr_stmt|;
name|tabtab
index|[
literal|0
index|]
operator|=
name|regtab
expr_stmt|;
name|tabtab
index|[
literal|1
index|]
operator|=
name|efftab
expr_stmt|;
name|tabtab
index|[
literal|2
index|]
operator|=
name|cctab
expr_stmt|;
name|tabtab
index|[
literal|3
index|]
operator|=
name|sptab
expr_stmt|;
while|while
condition|(
name|c
operator|=
name|getchar
argument_list|()
condition|)
block|{
if|if
condition|(
name|c
operator|==
literal|'#'
condition|)
block|{
name|sp
operator|=
literal|0
expr_stmt|;
name|c
operator|=
name|getwrd
argument_list|()
expr_stmt|;
name|tree
operator|=
name|getwrd
argument_list|()
expr_stmt|;
name|table
operator|=
name|tabtab
index|[
name|getwrd
argument_list|()
index|]
expr_stmt|;
name|line
operator|=
name|getwrd
argument_list|()
expr_stmt|;
while|while
condition|(
name|c
operator|--
condition|)
operator|*
name|sp
operator|++
operator|=
name|getwrd
argument_list|()
expr_stmt|;
name|rcexpr
argument_list|(
name|tree
argument_list|,
name|table
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
else|else
name|putchar
argument_list|(
name|c
argument_list|)
expr_stmt|;
block|}
name|flush
argument_list|()
expr_stmt|;
name|exit
argument_list|(
name|nerror
operator|!=
literal|0
argument_list|)
expr_stmt|;
block|}
end_function

begin_macro
name|match
argument_list|(
argument|tree
argument_list|,
argument|table
argument_list|,
argument|nreg
argument_list|)
end_macro

begin_decl_stmt
name|int
name|tree
index|[]
decl_stmt|,
name|table
index|[]
decl_stmt|;
end_decl_stmt

begin_block
block|{
extern|extern opdope[]
operator|,
extern|cctab
operator|,
extern|maprel;
name|int
name|op
decl_stmt|,
name|d1
decl_stmt|,
name|d2
decl_stmt|,
name|t1
decl_stmt|,
name|t2
decl_stmt|,
name|p1
index|[]
decl_stmt|,
name|p2
index|[]
decl_stmt|,
name|dope
decl_stmt|,
name|cctab
index|[]
decl_stmt|;
name|int
name|maprel
index|[]
decl_stmt|;
name|char
name|mp
index|[]
decl_stmt|;
if|if
condition|(
name|tree
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|op
operator|=
operator|*
name|tree
expr_stmt|;
if|if
condition|(
name|op
operator|>=
literal|29
condition|)
comment|/* if not leaf */
name|p1
operator|=
name|tree
index|[
literal|3
index|]
expr_stmt|;
else|else
name|p1
operator|=
name|tree
expr_stmt|;
name|t1
operator|=
name|p1
index|[
literal|1
index|]
expr_stmt|;
name|d1
operator|=
name|dcalc
argument_list|(
name|p1
argument_list|,
name|nreg
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
operator|(
name|dope
operator|=
name|opdope
index|[
name|op
index|]
operator|)
operator|&
literal|01
operator|)
operator|!=
literal|0
condition|)
block|{
comment|/* binary? */
name|p2
operator|=
name|tree
index|[
literal|4
index|]
expr_stmt|;
name|t2
operator|=
name|p2
index|[
literal|1
index|]
expr_stmt|;
name|d2
operator|=
name|dcalc
argument_list|(
name|p2
argument_list|,
name|nreg
argument_list|)
expr_stmt|;
if|if
condition|(
name|d2
operator|>
name|d1
operator|&
operator|(
name|dope
operator|&
literal|0100
operator|)
operator|!=
literal|0
condition|)
comment|/* commute? */
if|if
condition|(
name|table
operator|!=
name|cctab
operator||
operator|(
name|op
operator|!=
literal|47
operator|&
name|op
operator|!=
literal|48
operator|)
condition|)
block|{
comment|/* commute? */
if|if
condition|(
operator|(
name|dope
operator|&
literal|04
operator|)
operator|!=
literal|0
condition|)
comment|/* relation? */
operator|*
name|tree
operator|=
name|op
operator|=
name|maprel
index|[
name|op
operator|-
literal|60
index|]
expr_stmt|;
name|dope
operator|=
name|t1
expr_stmt|;
name|t1
operator|=
name|t2
expr_stmt|;
name|t2
operator|=
name|dope
expr_stmt|;
name|dope
operator|=
name|p1
expr_stmt|;
name|tree
index|[
literal|3
index|]
operator|=
name|p1
operator|=
name|p2
expr_stmt|;
name|tree
index|[
literal|4
index|]
operator|=
name|p2
operator|=
name|dope
expr_stmt|;
name|dope
operator|=
name|d1
expr_stmt|;
name|d1
operator|=
name|d2
expr_stmt|;
name|d2
operator|=
name|dope
expr_stmt|;
name|dope
operator|=
name|t1
expr_stmt|;
name|t1
operator|=
name|t2
expr_stmt|;
name|t2
operator|=
name|dope
expr_stmt|;
block|}
block|}
while|while
condition|(
operator|*
name|table
condition|)
block|{
if|if
condition|(
operator|*
name|table
operator|++
operator|==
name|op
condition|)
goto|goto
name|foundop
goto|;
name|table
operator|++
expr_stmt|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
name|foundop
label|:
name|table
operator|=
operator|*
name|table
expr_stmt|;
name|nxtry
label|:
name|mp
operator|=
name|table
expr_stmt|;
if|if
condition|(
operator|*
name|mp
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
name|d1
operator|>
operator|(
operator|*
name|mp
operator|&
literal|077
operator|)
operator||
operator|(
operator|*
name|mp
operator|>=
literal|0100
operator|)
operator|&
operator|(
operator|*
name|p1
operator|!=
literal|36
operator|)
condition|)
goto|goto
name|notyet
goto|;
if|if
condition|(
name|notcompat
argument_list|(
name|t1
argument_list|,
name|mp
index|[
literal|1
index|]
argument_list|)
condition|)
goto|goto
name|notyet
goto|;
if|if
condition|(
operator|(
name|opdope
index|[
name|op
index|]
operator|&
literal|01
operator|)
operator|!=
literal|0
operator|&
name|p2
operator|!=
literal|0
condition|)
block|{
if|if
condition|(
name|d2
operator|>
operator|(
name|mp
index|[
literal|2
index|]
operator|&
literal|077
operator|)
operator||
operator|(
name|mp
index|[
literal|2
index|]
operator|>=
literal|0100
operator|)
operator|&
operator|(
operator|*
name|p2
operator|!=
literal|36
operator|)
condition|)
goto|goto
name|notyet
goto|;
if|if
condition|(
name|notcompat
argument_list|(
name|t2
argument_list|,
name|mp
index|[
literal|3
index|]
argument_list|)
condition|)
goto|goto
name|notyet
goto|;
block|}
name|now
label|:
return|return
operator|(
name|table
index|[
literal|2
index|]
operator|)
return|;
name|notyet
label|:
name|table
operator|=
name|table
operator|+
literal|3
expr_stmt|;
goto|goto
name|nxtry
goto|;
block|}
end_block

begin_macro
name|rcexpr
argument_list|(
argument|tree
argument_list|,
argument|table
argument_list|,
argument|reg
argument_list|)
end_macro

begin_decl_stmt
name|int
name|tree
index|[]
decl_stmt|;
end_decl_stmt

begin_block
block|{
extern|extern cexpr
operator|,
extern|regtab
operator|,
extern|cctab
operator|,
extern|sptab
operator|,
extern|printf
operator|,
extern|error;
extern|extern jumpc
operator|,
extern|cbranch;
name|int
name|r
decl_stmt|,
name|modf
decl_stmt|;
if|if
condition|(
name|tree
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
if|if
condition|(
operator|*
name|tree
operator|==
literal|103
operator||
operator|*
name|tree
operator|==
literal|104
condition|)
block|{
operator|(
operator|*
name|tree
operator|==
literal|103
condition|?
name|jumpc
else|:
name|cbranch
operator|)
operator|(
name|tree
index|[
literal|1
index|]
operator|,
name|tree
index|[
literal|2
index|]
operator|,
name|tree
index|[
literal|3
index|]
operator|,
literal|0
operator|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
name|modf
operator|=
name|isfloat
argument_list|(
name|tree
argument_list|)
condition|?
literal|'f'
else|:
literal|0
expr_stmt|;
if|if
condition|(
operator|*
name|tree
operator|==
literal|110
condition|)
block|{
comment|/* force r0 */
if|if
condition|(
operator|(
name|r
operator|=
name|rcexpr
argument_list|(
name|tree
index|[
literal|3
index|]
argument_list|,
name|table
argument_list|,
name|reg
argument_list|)
operator|)
operator|!=
literal|0
condition|)
name|printf
argument_list|(
literal|"mov%c	r%d,r0\n"
argument_list|,
name|modf
argument_list|,
name|r
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
if|if
condition|(
operator|(
name|r
operator|=
name|cexpr
argument_list|(
name|tree
argument_list|,
name|table
argument_list|,
name|reg
argument_list|)
operator|)
operator|>=
literal|0
condition|)
return|return
operator|(
name|r
operator|)
return|;
if|if
condition|(
name|table
operator|!=
name|regtab
condition|)
if|if
condition|(
operator|(
name|r
operator|=
name|cexpr
argument_list|(
name|tree
argument_list|,
name|regtab
argument_list|,
name|reg
argument_list|)
operator|)
operator|>=
literal|0
condition|)
block|{
if|if
condition|(
name|table
operator|==
name|sptab
condition|)
name|printf
argument_list|(
literal|"mov%c	r%d,-(sp)\n"
argument_list|,
name|modf
argument_list|,
name|r
argument_list|)
expr_stmt|;
if|if
condition|(
name|table
operator|==
name|cctab
condition|)
block|{
if|if
condition|(
name|modf
operator|==
literal|'f'
condition|)
name|printf
argument_list|(
literal|"cfcc\n"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"tst%c	r%d\n"
argument_list|,
name|modf
argument_list|,
name|r
argument_list|)
expr_stmt|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
name|error
argument_list|(
literal|"No match for op %d"
argument_list|,
operator|*
name|tree
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|cexpr
argument_list|(
argument|tree
argument_list|,
argument|table
argument_list|,
argument|reg
argument_list|)
end_macro

begin_decl_stmt
name|int
name|tree
index|[]
index|[]
decl_stmt|,
name|table
index|[]
decl_stmt|;
end_decl_stmt

begin_block
block|{
extern|extern match
operator|,
extern|nreg
operator|,
extern|printf
operator|,
extern|pname
operator|,
extern|putchar
operator|,
extern|regtab;
extern|extern sptab
operator|,
extern|cctab
operator|,
extern|rcexpr
operator|,
extern|prins
operator|,
extern|rlength
operator|,
extern|popstk;
extern|extern collcon
operator|,
extern|isn
operator|,
extern|label
operator|,
extern|branch
operator|,
extern|cbranch;
extern|extern maprel[];
name|int
name|p1
index|[]
decl_stmt|,
name|p2
index|[]
decl_stmt|,
name|c
decl_stmt|,
name|r
decl_stmt|,
name|p
index|[]
decl_stmt|,
name|otable
index|[]
decl_stmt|,
name|ctable
index|[]
decl_stmt|,
name|regtab
index|[]
decl_stmt|,
name|cctab
index|[]
decl_stmt|;
name|int
name|sptab
index|[]
decl_stmt|;
name|char
name|string
index|[]
decl_stmt|,
name|match
index|[]
decl_stmt|;
name|int
name|reg1
decl_stmt|,
name|rreg
decl_stmt|;
if|if
condition|(
operator|(
name|c
operator|=
operator|*
name|tree
operator|)
operator|==
literal|100
condition|)
block|{
comment|/* call */
name|p1
operator|=
name|tree
index|[
literal|3
index|]
expr_stmt|;
name|p2
operator|=
name|tree
index|[
literal|4
index|]
expr_stmt|;
name|r
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|*
name|p2
condition|)
block|{
while|while
condition|(
operator|*
name|p2
operator|==
literal|9
condition|)
block|{
comment|/* comma */
name|rcexpr
argument_list|(
name|p2
index|[
literal|4
index|]
argument_list|,
name|sptab
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|r
operator|=
operator|+
name|arlength
argument_list|(
operator|(
name|p
operator|=
name|p2
index|[
literal|4
index|]
operator|)
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|p2
operator|=
name|p2
index|[
literal|3
index|]
expr_stmt|;
block|}
name|rcexpr
argument_list|(
name|p2
argument_list|,
name|sptab
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|r
operator|=
operator|+
name|arlength
argument_list|(
name|p2
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
block|}
operator|*
name|tree
operator|=
literal|101
expr_stmt|;
name|tree
index|[
literal|2
index|]
operator|=
name|r
expr_stmt|;
comment|/* save arg length */
block|}
if|if
condition|(
name|c
operator|==
literal|90
condition|)
block|{
comment|/* ? */
name|cbranch
argument_list|(
name|tree
index|[
literal|3
index|]
argument_list|,
name|c
operator|=
name|isn
operator|++
argument_list|,
literal|0
argument_list|,
name|reg
argument_list|)
expr_stmt|;
name|rcexpr
argument_list|(
name|tree
index|[
literal|4
index|]
index|[
literal|3
index|]
argument_list|,
name|table
argument_list|,
name|reg
argument_list|)
expr_stmt|;
name|branch
argument_list|(
name|r
operator|=
name|isn
operator|++
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|label
argument_list|(
name|c
argument_list|)
expr_stmt|;
name|reg
operator|=
name|rcexpr
argument_list|(
name|tree
index|[
literal|4
index|]
index|[
literal|4
index|]
argument_list|,
name|table
argument_list|,
name|reg
argument_list|)
expr_stmt|;
name|label
argument_list|(
name|r
argument_list|)
expr_stmt|;
goto|goto
name|retrn
goto|;
block|}
name|reg
operator|=
name|oddreg
argument_list|(
name|tree
argument_list|,
name|reg
argument_list|)
expr_stmt|;
name|reg1
operator|=
name|reg
operator|+
literal|1
expr_stmt|;
if|if
condition|(
operator|(
name|string
operator|=
name|match
argument_list|(
name|tree
argument_list|,
name|table
argument_list|,
name|nreg
operator|-
name|reg
argument_list|)
operator|)
operator|==
literal|0
condition|)
return|return
operator|(
operator|-
literal|1
operator|)
return|;
name|p1
operator|=
name|tree
index|[
literal|3
index|]
expr_stmt|;
name|p2
operator|=
name|tree
index|[
literal|4
index|]
expr_stmt|;
name|loop
label|:
switch|switch
condition|(
name|c
operator|=
operator|*
name|string
operator|++
condition|)
block|{
case|case
literal|'\0'
case|:
name|p
operator|=
name|tree
expr_stmt|;
if|if
condition|(
operator|*
name|p
operator|==
literal|101
condition|)
block|{
if|if
condition|(
name|p
index|[
literal|2
index|]
operator|>
literal|0
condition|)
name|popstk
argument_list|(
name|p
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|reg
operator|=
literal|0
expr_stmt|;
block|}
name|retrn
label|:
name|c
operator|=
name|isfloat
argument_list|(
name|tree
argument_list|)
expr_stmt|;
if|if
condition|(
name|table
operator|==
name|cctab
operator|&
name|c
condition|)
name|printf
argument_list|(
literal|"cfcc\n"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|c
condition|)
if|if
condition|(
operator|(
name|c
operator|=
operator|*
name|tree
operator|)
operator|==
literal|43
operator||
name|c
operator|==
literal|73
condition|)
name|reg
operator|--
expr_stmt|;
return|return
operator|(
name|reg
operator|)
return|;
comment|/* A1 */
case|case
literal|'A'
case|:
name|p
operator|=
name|tree
index|[
literal|3
index|]
expr_stmt|;
goto|goto
name|adr
goto|;
comment|/* A2 */
case|case
literal|'B'
case|:
name|p
operator|=
name|tree
index|[
literal|4
index|]
expr_stmt|;
goto|goto
name|adr
goto|;
comment|/* A */
case|case
literal|'O'
case|:
name|p
operator|=
name|tree
expr_stmt|;
name|adr
label|:
name|pname
argument_list|(
name|p
argument_list|)
expr_stmt|;
goto|goto
name|loop
goto|;
comment|/* I */
case|case
literal|'M'
case|:
if|if
condition|(
operator|(
name|c
operator|=
operator|*
name|string
operator|)
operator|==
literal|'\''
condition|)
name|string
operator|++
expr_stmt|;
else|else
name|c
operator|=
literal|0
expr_stmt|;
name|prins
argument_list|(
operator|*
name|tree
argument_list|,
name|c
argument_list|)
expr_stmt|;
goto|goto
name|loop
goto|;
comment|/* B1 */
case|case
literal|'C'
case|:
if|if
condition|(
operator|(
name|c
operator|=
operator|*
name|tree
operator|)
operator|<
literal|28
condition|)
name|p
operator|=
name|tree
expr_stmt|;
else|else
name|p
operator|=
name|tree
index|[
literal|3
index|]
expr_stmt|;
goto|goto
name|pbyte
goto|;
comment|/* BF */
case|case
literal|'P'
case|:
name|p
operator|=
name|tree
expr_stmt|;
goto|goto
name|pb1
goto|;
comment|/* B2 */
case|case
literal|'D'
case|:
name|p
operator|=
name|tree
index|[
literal|4
index|]
expr_stmt|;
name|pbyte
label|:
if|if
condition|(
name|p
index|[
literal|1
index|]
operator|==
literal|1
condition|)
comment|/* char type? */
name|putchar
argument_list|(
literal|'b'
argument_list|)
expr_stmt|;
name|pb1
label|:
if|if
condition|(
name|isfloat
argument_list|(
name|p
argument_list|)
condition|)
name|putchar
argument_list|(
literal|'f'
argument_list|)
expr_stmt|;
goto|goto
name|loop
goto|;
comment|/* BE */
case|case
literal|'L'
case|:
if|if
condition|(
name|tree
index|[
literal|3
index|]
index|[
literal|1
index|]
operator|==
literal|1
operator||
name|tree
index|[
literal|4
index|]
index|[
literal|1
index|]
operator|==
literal|1
condition|)
name|putchar
argument_list|(
literal|'b'
argument_list|)
expr_stmt|;
name|p
operator|=
name|tree
expr_stmt|;
goto|goto
name|pb1
goto|;
comment|/* C1 */
case|case
literal|'E'
case|:
name|p
operator|=
name|p1
index|[
literal|3
index|]
expr_stmt|;
goto|goto const;
comment|/* C2 */
case|case
literal|'F'
case|:
name|p
operator|=
name|p2
index|[
literal|3
index|]
expr_stmt|;
specifier|const
operator|:
name|printf
argument_list|(
literal|"%o"
argument_list|,
name|p
argument_list|)
expr_stmt|;
goto|goto
name|loop
goto|;
comment|/* F */
case|case
literal|'G'
case|:
name|p
operator|=
name|p1
expr_stmt|;
goto|goto
name|subtre
goto|;
comment|/* S */
case|case
literal|'K'
case|:
name|p
operator|=
name|p2
expr_stmt|;
goto|goto
name|subtre
goto|;
comment|/* H */
case|case
literal|'H'
case|:
name|p
operator|=
name|tree
expr_stmt|;
name|subtre
label|:
name|ctable
operator|=
name|regtab
expr_stmt|;
name|r
operator|=
name|reg
expr_stmt|;
name|c
operator|=
operator|*
name|string
operator|++
operator|-
literal|'A'
expr_stmt|;
if|if
condition|(
operator|(
name|c
operator|&
literal|02
operator|)
operator|!=
literal|0
condition|)
name|ctable
operator|=
name|sptab
expr_stmt|;
if|if
condition|(
operator|(
name|c
operator|&
literal|04
operator|)
operator|!=
literal|0
condition|)
name|ctable
operator|=
name|cctab
expr_stmt|;
if|if
condition|(
operator|(
name|c
operator|&
literal|010
operator|)
operator|!=
literal|0
condition|)
name|r
operator|=
name|reg1
expr_stmt|;
if|if
condition|(
operator|(
name|c
operator|&
literal|01
operator|)
operator|!=
literal|0
condition|)
if|if
condition|(
operator|*
name|p
operator|==
literal|36
condition|)
block|{
name|p
operator|=
name|p
index|[
literal|3
index|]
expr_stmt|;
if|if
condition|(
name|collcon
argument_list|(
name|p
argument_list|)
operator|&
name|ctable
operator|!=
name|sptab
condition|)
name|p
operator|=
name|p
index|[
literal|3
index|]
expr_stmt|;
block|}
name|rreg
operator|=
name|rcexpr
argument_list|(
name|p
argument_list|,
name|ctable
argument_list|,
name|r
argument_list|)
expr_stmt|;
if|if
condition|(
name|rreg
operator|==
name|r
operator||
name|ctable
operator|!=
name|regtab
condition|)
goto|goto
name|loop
goto|;
if|if
condition|(
name|string
index|[
operator|-
literal|2
index|]
operator|==
literal|'G'
condition|)
comment|/* left operand */
if|if
condition|(
name|oddreg
argument_list|(
name|tree
argument_list|,
literal|0
argument_list|)
operator|==
literal|1
condition|)
block|{
name|printf
argument_list|(
literal|"mov	r%d,r%d\n"
argument_list|,
name|rreg
argument_list|,
name|r
argument_list|)
expr_stmt|;
goto|goto
name|loop
goto|;
block|}
if|if
condition|(
name|r
operator|==
name|reg
condition|)
block|{
name|reg
operator|=
name|rreg
expr_stmt|;
name|reg1
operator|=
name|rreg
operator|+
literal|1
expr_stmt|;
block|}
else|else
name|reg1
operator|=
name|rreg
expr_stmt|;
goto|goto
name|loop
goto|;
comment|/* R */
case|case
literal|'I'
case|:
name|r
operator|=
name|reg
expr_stmt|;
if|if
condition|(
operator|*
name|string
operator|==
literal|'-'
condition|)
block|{
name|string
operator|++
expr_stmt|;
name|r
operator|--
expr_stmt|;
block|}
goto|goto
name|preg
goto|;
comment|/* R1 */
case|case
literal|'J'
case|:
name|r
operator|=
name|reg1
expr_stmt|;
name|preg
label|:
if|if
condition|(
name|r
operator|>=
literal|5
condition|)
name|error
argument_list|(
literal|"Register overflow: simplify expression"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"r%d"
argument_list|,
name|r
argument_list|)
expr_stmt|;
goto|goto
name|loop
goto|;
case|case
literal|'#'
case|:
name|p
operator|=
name|p1
index|[
literal|3
index|]
expr_stmt|;
goto|goto
name|nmbr
goto|;
case|case
literal|'"'
case|:
name|p
operator|=
name|p2
index|[
literal|3
index|]
expr_stmt|;
goto|goto
name|nmbr
goto|;
case|case
literal|'~'
case|:
name|p
operator|=
name|tree
index|[
literal|3
index|]
expr_stmt|;
name|nmbr
label|:
if|if
condition|(
name|collcon
argument_list|(
name|p
argument_list|)
condition|)
block|{
if|if
condition|(
operator|*
name|p
operator|==
literal|41
condition|)
comment|/* - */
name|putchar
argument_list|(
literal|'-'
argument_list|)
expr_stmt|;
switch|switch
condition|(
operator|*
operator|(
name|p
operator|=
name|p
index|[
literal|4
index|]
operator|)
condition|)
block|{
case|case
literal|21
case|:
comment|/* number */
if|if
condition|(
name|p
index|[
literal|3
index|]
condition|)
name|printf
argument_list|(
literal|"%d."
argument_list|,
name|p
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
literal|35
case|:
comment|/*& name */
name|pname
argument_list|(
name|p
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
goto|goto
name|loop
goto|;
comment|/* V */
case|case
literal|'V'
case|:
name|tree
index|[
literal|0
index|]
operator|=
name|maprel
index|[
operator|(
name|c
operator|=
name|tree
index|[
literal|0
index|]
operator|)
operator|-
literal|60
index|]
expr_stmt|;
goto|goto
name|loop
goto|;
comment|/* Z */
case|case
literal|'Z'
case|:
name|printf
argument_list|(
literal|"$%o"
argument_list|,
name|p1
index|[
literal|5
index|]
operator|+
name|p1
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
goto|goto
name|loop
goto|;
case|case
literal|'^'
case|:
comment|/* for ++ -- */
name|printf
argument_list|(
literal|"%o"
argument_list|,
name|tree
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
goto|goto
name|loop
goto|;
block|}
name|putchar
argument_list|(
name|c
argument_list|)
expr_stmt|;
goto|goto
name|loop
goto|;
block|}
end_block

begin_macro
name|pname
argument_list|(
argument|p
argument_list|)
end_macro

begin_decl_stmt
name|int
name|p
index|[]
index|[]
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|char
name|np
index|[]
decl_stmt|;
name|int
name|i
decl_stmt|;
name|loop
label|:
switch|switch
condition|(
operator|*
name|p
condition|)
block|{
case|case
literal|21
case|:
comment|/* const */
name|printf
argument_list|(
literal|"$%o"
argument_list|,
name|p
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
return|return;
case|case
literal|23
case|:
comment|/* float const */
name|printf
argument_list|(
literal|"L%d"
argument_list|,
name|p
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
return|return;
name|casename
label|:
case|case
literal|20
case|:
comment|/* name */
if|if
condition|(
name|i
operator|=
name|p
index|[
literal|4
index|]
condition|)
name|printf
argument_list|(
literal|"%d.+"
argument_list|,
name|i
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|p
index|[
literal|3
index|]
condition|)
block|{
case|case
literal|5
case|:
comment|/* auto, param */
name|printf
argument_list|(
literal|"%d.(r5)"
argument_list|,
name|p
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
return|return;
comment|/* extern */
case|case
literal|6
case|:
name|printf
argument_list|(
literal|"%p"
argument_list|,
operator|&
name|p
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
return|return;
case|case
literal|4
case|:
name|error
argument_list|(
literal|"Illegal structure reference"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"$0"
argument_list|)
expr_stmt|;
return|return;
block|}
name|printf
argument_list|(
literal|"L%d"
argument_list|,
name|p
index|[
literal|5
index|]
argument_list|)
expr_stmt|;
return|return;
case|case
literal|35
case|:
comment|/*& */
name|putchar
argument_list|(
literal|'$'
argument_list|)
expr_stmt|;
name|p
operator|=
name|p
index|[
literal|3
index|]
expr_stmt|;
goto|goto
name|loop
goto|;
case|case
literal|36
case|:
comment|/* * */
name|putchar
argument_list|(
literal|'*'
argument_list|)
expr_stmt|;
name|p
operator|=
name|p
index|[
literal|3
index|]
expr_stmt|;
goto|goto
name|loop
goto|;
block|}
name|error
argument_list|(
literal|"pname called illegally"
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|dcalc
argument_list|(
argument|p
argument_list|,
argument|nreg
argument_list|)
end_macro

begin_decl_stmt
name|int
name|p
index|[]
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|int
name|op
decl_stmt|,
name|t
decl_stmt|,
name|p1
index|[]
decl_stmt|,
name|p2
index|[]
decl_stmt|;
if|if
condition|(
name|p
operator|==
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
name|op
operator|=
operator|*
name|p
expr_stmt|;
switch|switch
condition|(
name|op
condition|)
block|{
case|case
literal|20
case|:
comment|/* name */
case|case
literal|35
case|:
comment|/*& (non-automatic) */
return|return
operator|(
literal|12
operator|)
return|;
case|case
literal|21
case|:
comment|/* short constant */
return|return
operator|(
name|p
index|[
literal|3
index|]
operator|==
literal|0
condition|?
literal|4
else|:
literal|8
operator|)
return|;
case|case
literal|23
case|:
comment|/* float const */
return|return
operator|(
name|p
index|[
literal|3
index|]
operator|==
literal|0
condition|?
literal|4
else|:
literal|12
operator|)
return|;
case|case
literal|36
case|:
comment|/* * */
name|p1
operator|=
name|p
index|[
literal|3
index|]
expr_stmt|;
if|if
condition|(
operator|*
name|p1
operator|==
literal|20
condition|)
comment|/* name or offset name */
return|return
operator|(
literal|12
operator|)
return|;
block|}
name|def
label|:
return|return
operator|(
name|p
index|[
literal|2
index|]
operator|<=
name|nreg
condition|?
literal|20
else|:
literal|24
operator|)
return|;
block|}
end_block

begin_macro
name|notcompat
argument_list|(
argument|at
argument_list|,
argument|st
argument_list|)
end_macro

begin_block
block|{
if|if
condition|(
name|st
operator|==
literal|0
condition|)
comment|/* word, byte */
return|return
operator|(
name|at
operator|>
literal|1
operator|&
name|at
operator|<=
literal|07
operator|)
return|;
if|if
condition|(
name|st
operator|==
literal|1
condition|)
comment|/* word */
return|return
operator|(
name|at
operator|>
literal|0
operator|&
name|at
operator|<=
literal|07
operator|)
return|;
name|st
operator|=
operator|-
literal|2
expr_stmt|;
if|if
condition|(
operator|(
name|at
operator|&
literal|077740
operator|)
operator|!=
literal|0
condition|)
name|at
operator|=
literal|020
expr_stmt|;
comment|/* *int for **stuff */
if|if
condition|(
operator|(
name|at
operator|&
literal|077770
operator|)
operator|!=
literal|0
condition|)
name|at
operator|=
name|at
operator|&
literal|07
operator||
literal|020
expr_stmt|;
if|if
condition|(
name|st
operator|==
literal|2
operator|&
name|at
operator|==
literal|3
condition|)
name|at
operator|=
literal|2
expr_stmt|;
return|return
operator|(
name|st
operator|!=
name|at
operator|)
return|;
block|}
end_block

begin_macro
name|prins
argument_list|(
argument|op
argument_list|,
argument|c
argument_list|)
end_macro

begin_block
block|{
extern|extern instab[]
operator|,
extern|printf;
name|int
name|insp
index|[]
decl_stmt|;
name|insp
operator|=
name|instab
expr_stmt|;
while|while
condition|(
operator|*
name|insp
condition|)
block|{
if|if
condition|(
operator|*
name|insp
operator|++
operator|==
name|op
condition|)
block|{
if|if
condition|(
operator|(
name|c
operator|=
name|insp
index|[
name|c
operator|!=
literal|0
index|]
operator|)
operator|==
literal|0
condition|)
goto|goto
name|err
goto|;
name|printf
argument_list|(
literal|"%s"
argument_list|,
name|c
argument_list|)
expr_stmt|;
return|return;
block|}
else|else
name|insp
operator|=
name|insp
operator|+
literal|2
expr_stmt|;
block|}
name|err
label|:
name|error
argument_list|(
literal|"No match' for op %d"
argument_list|,
name|op
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|collcon
argument_list|(
argument|p
argument_list|)
end_macro

begin_decl_stmt
name|int
name|p
index|[]
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|int
name|p1
index|[]
decl_stmt|,
name|t
index|[]
decl_stmt|;
if|if
condition|(
operator|*
name|p
operator|==
literal|40
operator||
operator|*
name|p
operator|==
literal|41
condition|)
block|{
if|if
condition|(
operator|*
operator|(
name|p1
operator|=
name|p
index|[
literal|4
index|]
operator|)
operator|==
literal|21
condition|)
block|{
comment|/* number */
return|return
operator|(
literal|1
operator|)
return|;
block|}
if|if
condition|(
operator|*
name|p1
operator|==
literal|35
condition|)
return|return
operator|(
literal|1
operator|)
return|;
if|if
condition|(
operator|*
operator|(
name|p1
operator|=
name|p
index|[
literal|3
index|]
operator|)
operator|==
literal|35
condition|)
block|{
name|p1
operator|=
name|p
index|[
literal|3
index|]
expr_stmt|;
name|p
index|[
literal|3
index|]
operator|=
name|p
index|[
literal|4
index|]
expr_stmt|;
name|p
index|[
literal|4
index|]
operator|=
name|p1
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_block

begin_macro
name|isfloat
argument_list|(
argument|t
argument_list|)
end_macro

begin_decl_stmt
name|int
name|t
index|[]
decl_stmt|;
end_decl_stmt

begin_block
block|{
extern|extern opdope[];
name|int
name|rt
decl_stmt|;
if|if
condition|(
operator|(
name|opdope
index|[
name|t
index|[
literal|0
index|]
index|]
operator|&
literal|04
operator|)
operator|!=
literal|0
condition|)
comment|/* relational */
name|t
operator|=
name|t
index|[
literal|3
index|]
expr_stmt|;
if|if
condition|(
operator|(
name|rt
operator|=
name|t
index|[
literal|1
index|]
operator|)
operator|>=
literal|2
operator|&
name|rt
operator|<=
literal|3
condition|)
return|return
operator|(
name|rt
operator|)
return|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_block

begin_expr_stmt
name|nreg
literal|3
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|isn
literal|10000
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|namsiz
literal|8
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|line
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|tmpfil
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|nerror
expr_stmt|;
end_expr_stmt

begin_macro
name|oddreg
argument_list|(
argument|t
argument_list|,
argument|reg
argument_list|)
end_macro

begin_decl_stmt
name|int
name|t
index|[]
decl_stmt|;
end_decl_stmt

begin_block
block|{
if|if
condition|(
operator|!
name|isfloat
argument_list|(
name|t
argument_list|)
condition|)
switch|switch
condition|(
operator|*
name|t
condition|)
block|{
case|case
literal|43
case|:
comment|/* / */
case|case
literal|44
case|:
comment|/* % */
case|case
literal|73
case|:
comment|/* =/ */
case|case
literal|74
case|:
comment|/* =% */
name|reg
operator|++
expr_stmt|;
case|case
literal|42
case|:
comment|/* * */
case|case
literal|72
case|:
comment|/* =* */
return|return
operator|(
name|reg
operator||
literal|1
operator|)
return|;
block|}
return|return
operator|(
name|reg
operator|)
return|;
block|}
end_block

begin_macro
name|arlength
argument_list|(
argument|t
argument_list|)
end_macro

begin_block
block|{
name|int
name|arl
decl_stmt|;
if|if
condition|(
operator|(
name|arl
operator|=
name|rlength
argument_list|(
name|t
argument_list|)
operator|)
operator|==
literal|4
condition|)
return|return
operator|(
literal|8
operator|)
return|;
return|return
operator|(
name|arl
operator|)
return|;
block|}
end_block

begin_expr_stmt
name|maprel
index|[]
literal|60
operator|,
literal|61
operator|,
literal|64
operator|,
literal|65
operator|,
literal|62
operator|,
literal|63
operator|,
literal|68
operator|,
literal|69
operator|,
literal|66
operator|,
literal|67
expr_stmt|;
end_expr_stmt

end_unit

