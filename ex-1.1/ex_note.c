begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_empty
empty|#
end_empty

begin_comment
comment|/*  * Ex - a text editor  * Bill Joy UCB September, 1977  */
end_comment

begin_include
include|#
directive|include
file|"ex.h"
end_include

begin_include
include|#
directive|include
file|"ex_glob.h"
end_include

begin_macro
name|notable
argument_list|(
argument|i
argument_list|)
end_macro

begin_decl_stmt
name|int
name|i
decl_stmt|;
end_decl_stmt

begin_block
block|{
return|return
operator|(
name|value
argument_list|(
name|HUSH
argument_list|)
operator|==
literal|0
operator|&&
operator|!
name|inglobal
operator|&&
name|i
operator|>
name|value
argument_list|(
name|NOTIFY
argument_list|)
operator|)
return|;
block|}
end_block

begin_macro
name|killed
argument_list|()
end_macro

begin_block
block|{
specifier|register
name|int
name|cnt
decl_stmt|;
name|cnt
operator|=
name|addr2
operator|-
name|addr1
operator|+
literal|1
expr_stmt|;
if|if
condition|(
operator|!
name|notable
argument_list|(
name|cnt
argument_list|)
condition|)
return|return;
name|printf
argument_list|(
literal|"%d lines"
argument_list|,
name|cnt
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
argument_list|(
name|TERSE
argument_list|)
operator|==
literal|0
condition|)
block|{
name|printf
argument_list|(
literal|" %c%s"
argument_list|,
name|Command
index|[
literal|0
index|]
operator||
literal|' '
argument_list|,
name|Command
operator|+
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|Command
index|[
name|strlen
argument_list|(
name|Command
argument_list|)
operator|-
literal|1
index|]
operator|!=
literal|'e'
condition|)
name|putchar
argument_list|(
literal|'e'
argument_list|)
expr_stmt|;
name|putchar
argument_list|(
literal|'d'
argument_list|)
expr_stmt|;
block|}
name|putNFL
argument_list|()
expr_stmt|;
block|}
end_block

begin_macro
name|netchHAD
argument_list|(
argument|cnt
argument_list|)
end_macro

begin_decl_stmt
name|int
name|cnt
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|netchange
argument_list|(
operator|(
name|dol
operator|-
name|zero
operator|)
operator|-
name|cnt
argument_list|)
expr_stmt|;
block|}
end_block

begin_expr_stmt
name|netchange
argument_list|(
name|i
argument_list|)
specifier|register
name|int
name|i
expr_stmt|;
end_expr_stmt

begin_block
block|{
specifier|register
name|char
modifier|*
name|cp
decl_stmt|;
if|if
condition|(
name|i
operator|>
literal|0
condition|)
name|cp
operator|=
literal|"more"
expr_stmt|;
else|else
name|cp
operator|=
literal|"less"
operator|,
name|i
operator|=
operator|-
name|i
expr_stmt|;
if|if
condition|(
operator|!
name|notable
argument_list|(
name|i
argument_list|)
condition|)
return|return;
name|printf
argument_list|(
name|mesg
argument_list|(
literal|"%d %s lines@in file after %s"
argument_list|)
argument_list|,
name|i
argument_list|,
name|cp
argument_list|,
name|Command
argument_list|)
expr_stmt|;
name|putNFL
argument_list|()
expr_stmt|;
block|}
end_block

begin_expr_stmt
name|snote
argument_list|(
name|total
argument_list|,
name|lines
argument_list|)
specifier|register
name|int
name|total
operator|,
name|lines
expr_stmt|;
end_expr_stmt

begin_block
block|{
if|if
condition|(
operator|!
name|notable
argument_list|(
name|total
argument_list|)
condition|)
return|return;
name|printf
argument_list|(
name|mesg
argument_list|(
literal|"%d subs|%d substitutions"
argument_list|)
argument_list|,
name|total
argument_list|)
expr_stmt|;
if|if
condition|(
name|lines
operator|!=
literal|1
operator|&&
name|lines
operator|!=
name|total
condition|)
name|printf
argument_list|(
literal|" on %d lines"
argument_list|,
name|lines
argument_list|)
expr_stmt|;
name|putNFL
argument_list|()
expr_stmt|;
block|}
end_block

begin_macro
name|noteargs
argument_list|()
end_macro

begin_block
block|{
if|if
condition|(
name|argc
operator|>
literal|1
condition|)
block|{
name|printf
argument_list|(
name|mesg
argument_list|(
literal|"%d files@to edit"
argument_list|)
argument_list|,
name|argc
argument_list|)
expr_stmt|;
name|putNFL
argument_list|()
expr_stmt|;
block|}
block|}
end_block

end_unit

