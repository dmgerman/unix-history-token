begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_ifndef
ifndef|#
directive|ifndef
name|EAP_TLS_COMMON_H
end_ifndef

begin_define
define|#
directive|define
name|EAP_TLS_COMMON_H
end_define

begin_struct
struct|struct
name|eap_ssl_data
block|{
name|struct
name|tls_connection
modifier|*
name|conn
decl_stmt|;
name|u8
modifier|*
name|tls_out
decl_stmt|;
name|size_t
name|tls_out_len
decl_stmt|;
name|size_t
name|tls_out_pos
decl_stmt|;
name|size_t
name|tls_out_limit
decl_stmt|;
name|u8
modifier|*
name|tls_in
decl_stmt|;
name|size_t
name|tls_in_len
decl_stmt|;
name|size_t
name|tls_in_left
decl_stmt|;
name|size_t
name|tls_in_total
decl_stmt|;
name|int
name|phase2
decl_stmt|;
name|struct
name|eap_sm
modifier|*
name|eap
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|/* EAP TLS Flags */
end_comment

begin_define
define|#
directive|define
name|EAP_TLS_FLAGS_LENGTH_INCLUDED
value|0x80
end_define

begin_define
define|#
directive|define
name|EAP_TLS_FLAGS_MORE_FRAGMENTS
value|0x40
end_define

begin_define
define|#
directive|define
name|EAP_TLS_FLAGS_START
value|0x20
end_define

begin_define
define|#
directive|define
name|EAP_PEAP_VERSION_MASK
value|0x07
end_define

begin_comment
comment|/* could be up to 128 bytes, but only the first 64 bytes are used */
end_comment

begin_define
define|#
directive|define
name|EAP_TLS_KEY_LEN
value|64
end_define

begin_function_decl
name|int
name|eap_tls_ssl_init
parameter_list|(
name|struct
name|eap_sm
modifier|*
name|sm
parameter_list|,
name|struct
name|eap_ssl_data
modifier|*
name|data
parameter_list|,
name|int
name|verify_peer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|eap_tls_ssl_deinit
parameter_list|(
name|struct
name|eap_sm
modifier|*
name|sm
parameter_list|,
name|struct
name|eap_ssl_data
modifier|*
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|u8
modifier|*
name|eap_tls_derive_key
parameter_list|(
name|struct
name|eap_sm
modifier|*
name|sm
parameter_list|,
name|struct
name|eap_ssl_data
modifier|*
name|data
parameter_list|,
name|char
modifier|*
name|label
parameter_list|,
name|size_t
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|eap_tls_data_reassemble
parameter_list|(
name|struct
name|eap_sm
modifier|*
name|sm
parameter_list|,
name|struct
name|eap_ssl_data
modifier|*
name|data
parameter_list|,
name|u8
modifier|*
modifier|*
name|in_data
parameter_list|,
name|size_t
modifier|*
name|in_len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|eap_tls_process_helper
parameter_list|(
name|struct
name|eap_sm
modifier|*
name|sm
parameter_list|,
name|struct
name|eap_ssl_data
modifier|*
name|data
parameter_list|,
name|u8
modifier|*
name|in_data
parameter_list|,
name|size_t
name|in_len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|eap_tls_buildReq_helper
parameter_list|(
name|struct
name|eap_sm
modifier|*
name|sm
parameter_list|,
name|struct
name|eap_ssl_data
modifier|*
name|data
parameter_list|,
name|int
name|eap_type
parameter_list|,
name|int
name|peap_version
parameter_list|,
name|u8
name|id
parameter_list|,
name|u8
modifier|*
modifier|*
name|out_data
parameter_list|,
name|size_t
modifier|*
name|out_len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|u8
modifier|*
name|eap_tls_build_ack
parameter_list|(
name|size_t
modifier|*
name|reqDataLen
parameter_list|,
name|u8
name|id
parameter_list|,
name|int
name|eap_type
parameter_list|,
name|int
name|peap_version
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* EAP_TLS_COMMON_H */
end_comment

end_unit

