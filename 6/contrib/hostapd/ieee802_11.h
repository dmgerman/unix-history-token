begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_ifndef
ifndef|#
directive|ifndef
name|IEEE802_11_H
end_ifndef

begin_define
define|#
directive|define
name|IEEE802_11_H
end_define

begin_struct
struct|struct
name|ieee80211_mgmt
block|{
name|u16
name|frame_control
decl_stmt|;
name|u16
name|duration
decl_stmt|;
name|u8
name|da
index|[
literal|6
index|]
decl_stmt|;
name|u8
name|sa
index|[
literal|6
index|]
decl_stmt|;
name|u8
name|bssid
index|[
literal|6
index|]
decl_stmt|;
name|u16
name|seq_ctrl
decl_stmt|;
union|union
block|{
struct|struct
block|{
name|u16
name|auth_alg
decl_stmt|;
name|u16
name|auth_transaction
decl_stmt|;
name|u16
name|status_code
decl_stmt|;
comment|/* possibly followed by Challenge text */
name|u8
name|variable
index|[
literal|0
index|]
decl_stmt|;
block|}
name|__attribute__
argument_list|(
operator|(
name|packed
operator|)
argument_list|)
name|auth
struct|;
struct|struct
block|{
name|u16
name|reason_code
decl_stmt|;
block|}
name|__attribute__
argument_list|(
operator|(
name|packed
operator|)
argument_list|)
name|deauth
struct|;
struct|struct
block|{
name|u16
name|capab_info
decl_stmt|;
name|u16
name|listen_interval
decl_stmt|;
comment|/* followed by SSID and Supported rates */
name|u8
name|variable
index|[
literal|0
index|]
decl_stmt|;
block|}
name|__attribute__
argument_list|(
operator|(
name|packed
operator|)
argument_list|)
name|assoc_req
struct|;
struct|struct
block|{
name|u16
name|capab_info
decl_stmt|;
name|u16
name|status_code
decl_stmt|;
name|u16
name|aid
decl_stmt|;
comment|/* followed by Supported rates */
name|u8
name|variable
index|[
literal|0
index|]
decl_stmt|;
block|}
name|__attribute__
argument_list|(
operator|(
name|packed
operator|)
argument_list|)
name|assoc_resp
struct|,
name|reassoc_resp
struct|;
struct|struct
block|{
name|u16
name|capab_info
decl_stmt|;
name|u16
name|listen_interval
decl_stmt|;
name|u8
name|current_ap
index|[
literal|6
index|]
decl_stmt|;
comment|/* followed by SSID and Supported rates */
name|u8
name|variable
index|[
literal|0
index|]
decl_stmt|;
block|}
name|__attribute__
argument_list|(
operator|(
name|packed
operator|)
argument_list|)
name|reassoc_req
struct|;
struct|struct
block|{
name|u16
name|reason_code
decl_stmt|;
block|}
name|__attribute__
argument_list|(
operator|(
name|packed
operator|)
argument_list|)
name|disassoc
struct|;
struct|struct
block|{
name|u8
name|timestamp
index|[
literal|8
index|]
decl_stmt|;
name|u16
name|beacon_int
decl_stmt|;
name|u16
name|capab_info
decl_stmt|;
comment|/* followed by some of SSID, Supported rates, 			 * FH Params, DS Params, CF Params, IBSS Params, TIM */
name|u8
name|variable
index|[
literal|0
index|]
decl_stmt|;
block|}
name|__attribute__
argument_list|(
operator|(
name|packed
operator|)
argument_list|)
name|beacon
struct|;
block|}
name|u
union|;
block|}
name|__attribute__
argument_list|(
operator|(
name|packed
operator|)
argument_list|)
struct|;
end_struct

begin_comment
comment|/* Parsed Information Elements */
end_comment

begin_struct
struct|struct
name|ieee802_11_elems
block|{
name|u8
modifier|*
name|ssid
decl_stmt|;
name|u8
name|ssid_len
decl_stmt|;
name|u8
modifier|*
name|supp_rates
decl_stmt|;
name|u8
name|supp_rates_len
decl_stmt|;
name|u8
modifier|*
name|fh_params
decl_stmt|;
name|u8
name|fh_params_len
decl_stmt|;
name|u8
modifier|*
name|ds_params
decl_stmt|;
name|u8
name|ds_params_len
decl_stmt|;
name|u8
modifier|*
name|cf_params
decl_stmt|;
name|u8
name|cf_params_len
decl_stmt|;
name|u8
modifier|*
name|tim
decl_stmt|;
name|u8
name|tim_len
decl_stmt|;
name|u8
modifier|*
name|ibss_params
decl_stmt|;
name|u8
name|ibss_params_len
decl_stmt|;
name|u8
modifier|*
name|challenge
decl_stmt|;
name|u8
name|challenge_len
decl_stmt|;
name|u8
modifier|*
name|wpa_ie
decl_stmt|;
name|u8
name|wpa_ie_len
decl_stmt|;
name|u8
modifier|*
name|rsn_ie
decl_stmt|;
name|u8
name|rsn_ie_len
decl_stmt|;
block|}
struct|;
end_struct

begin_typedef
typedef|typedef
enum|enum
block|{
name|ParseOK
init|=
literal|0
block|,
name|ParseUnknown
init|=
literal|1
block|,
name|ParseFailed
init|=
operator|-
literal|1
block|}
name|ParseRes
typedef|;
end_typedef

begin_function_decl
name|void
name|ieee802_11_mgmt
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|u8
modifier|*
name|buf
parameter_list|,
name|size_t
name|len
parameter_list|,
name|u16
name|stype
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ieee802_11_mgmt_cb
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|u8
modifier|*
name|buf
parameter_list|,
name|size_t
name|len
parameter_list|,
name|u16
name|stype
parameter_list|,
name|int
name|ok
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ParseRes
name|ieee802_11_parse_elems
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|u8
modifier|*
name|start
parameter_list|,
name|size_t
name|len
parameter_list|,
name|struct
name|ieee802_11_elems
modifier|*
name|elems
parameter_list|,
name|int
name|show_errors
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|ieee80211_michael_mic_failure
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|u8
modifier|*
name|addr
parameter_list|,
name|int
name|local
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ieee802_11_get_mib
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|char
modifier|*
name|buf
parameter_list|,
name|size_t
name|buflen
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|ieee802_11_get_mib_sta
parameter_list|(
name|struct
name|hostapd_data
modifier|*
name|hapd
parameter_list|,
name|struct
name|sta_info
modifier|*
name|sta
parameter_list|,
name|char
modifier|*
name|buf
parameter_list|,
name|size_t
name|buflen
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* IEEE802_11_H */
end_comment

end_unit

