begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*      $OpenBSD: cast.c,v 1.2 2000/06/06 06:49:47 deraadt Exp $       */
end_comment

begin_comment
comment|/*-  *	CAST-128 in C  *	Written by Steve Reid<sreid@sea-to-sky.net>  *	100% Public Domain - no warranty  *	Released 1997.10.11  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|<opencrypto/cast.h>
end_include

begin_include
include|#
directive|include
file|<opencrypto/castsb.h>
end_include

begin_comment
comment|/* Macros to access 8-bit bytes out of a 32-bit word */
end_comment

begin_define
define|#
directive|define
name|U_INT8_Ta
parameter_list|(
name|x
parameter_list|)
value|( (u_int8_t) (x>>24) )
end_define

begin_define
define|#
directive|define
name|U_INT8_Tb
parameter_list|(
name|x
parameter_list|)
value|( (u_int8_t) ((x>>16)&255) )
end_define

begin_define
define|#
directive|define
name|U_INT8_Tc
parameter_list|(
name|x
parameter_list|)
value|( (u_int8_t) ((x>>8)&255) )
end_define

begin_define
define|#
directive|define
name|U_INT8_Td
parameter_list|(
name|x
parameter_list|)
value|( (u_int8_t) ((x)&255) )
end_define

begin_comment
comment|/* Circular left shift */
end_comment

begin_define
define|#
directive|define
name|ROL
parameter_list|(
name|x
parameter_list|,
name|n
parameter_list|)
value|( ((x)<<(n)) | ((x)>>(32-(n))) )
end_define

begin_comment
comment|/* CAST-128 uses three different round functions */
end_comment

begin_define
define|#
directive|define
name|F1
parameter_list|(
name|l
parameter_list|,
name|r
parameter_list|,
name|i
parameter_list|)
define|\
value|t = ROL(key->xkey[i] + r, key->xkey[i+16]); \ 	l ^= ((cast_sbox1[U_INT8_Ta(t)] ^ cast_sbox2[U_INT8_Tb(t)]) - \ 	 cast_sbox3[U_INT8_Tc(t)]) + cast_sbox4[U_INT8_Td(t)];
end_define

begin_define
define|#
directive|define
name|F2
parameter_list|(
name|l
parameter_list|,
name|r
parameter_list|,
name|i
parameter_list|)
define|\
value|t = ROL(key->xkey[i] ^ r, key->xkey[i+16]); \ 	l ^= ((cast_sbox1[U_INT8_Ta(t)] - cast_sbox2[U_INT8_Tb(t)]) + \ 	 cast_sbox3[U_INT8_Tc(t)]) ^ cast_sbox4[U_INT8_Td(t)];
end_define

begin_define
define|#
directive|define
name|F3
parameter_list|(
name|l
parameter_list|,
name|r
parameter_list|,
name|i
parameter_list|)
define|\
value|t = ROL(key->xkey[i] - r, key->xkey[i+16]); \ 	l ^= ((cast_sbox1[U_INT8_Ta(t)] + cast_sbox2[U_INT8_Tb(t)]) ^ \ 	 cast_sbox3[U_INT8_Tc(t)]) - cast_sbox4[U_INT8_Td(t)];
end_define

begin_comment
comment|/***** Encryption Function *****/
end_comment

begin_function
name|void
name|cast_encrypt
parameter_list|(
name|cast_key
modifier|*
name|key
parameter_list|,
name|u_int8_t
modifier|*
name|inblock
parameter_list|,
name|u_int8_t
modifier|*
name|outblock
parameter_list|)
block|{
name|u_int32_t
name|t
decl_stmt|,
name|l
decl_stmt|,
name|r
decl_stmt|;
comment|/* Get inblock into l,r */
name|l
operator|=
operator|(
operator|(
name|u_int32_t
operator|)
name|inblock
index|[
literal|0
index|]
operator|<<
literal|24
operator|)
operator||
operator|(
operator|(
name|u_int32_t
operator|)
name|inblock
index|[
literal|1
index|]
operator|<<
literal|16
operator|)
operator||
operator|(
operator|(
name|u_int32_t
operator|)
name|inblock
index|[
literal|2
index|]
operator|<<
literal|8
operator|)
operator||
operator|(
name|u_int32_t
operator|)
name|inblock
index|[
literal|3
index|]
expr_stmt|;
name|r
operator|=
operator|(
operator|(
name|u_int32_t
operator|)
name|inblock
index|[
literal|4
index|]
operator|<<
literal|24
operator|)
operator||
operator|(
operator|(
name|u_int32_t
operator|)
name|inblock
index|[
literal|5
index|]
operator|<<
literal|16
operator|)
operator||
operator|(
operator|(
name|u_int32_t
operator|)
name|inblock
index|[
literal|6
index|]
operator|<<
literal|8
operator|)
operator||
operator|(
name|u_int32_t
operator|)
name|inblock
index|[
literal|7
index|]
expr_stmt|;
comment|/* Do the work */
name|F1
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|F2
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|F3
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|F1
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|F2
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|F3
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|F1
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|F2
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|F3
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|F1
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|F2
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|F3
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
literal|11
argument_list|)
expr_stmt|;
comment|/* Only do full 16 rounds if key length> 80 bits */
if|if
condition|(
name|key
operator|->
name|rounds
operator|>
literal|12
condition|)
block|{
name|F1
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|F2
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|F3
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|F1
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
literal|15
argument_list|)
expr_stmt|;
block|}
comment|/* Put l,r into outblock */
name|outblock
index|[
literal|0
index|]
operator|=
name|U_INT8_Ta
argument_list|(
name|r
argument_list|)
expr_stmt|;
name|outblock
index|[
literal|1
index|]
operator|=
name|U_INT8_Tb
argument_list|(
name|r
argument_list|)
expr_stmt|;
name|outblock
index|[
literal|2
index|]
operator|=
name|U_INT8_Tc
argument_list|(
name|r
argument_list|)
expr_stmt|;
name|outblock
index|[
literal|3
index|]
operator|=
name|U_INT8_Td
argument_list|(
name|r
argument_list|)
expr_stmt|;
name|outblock
index|[
literal|4
index|]
operator|=
name|U_INT8_Ta
argument_list|(
name|l
argument_list|)
expr_stmt|;
name|outblock
index|[
literal|5
index|]
operator|=
name|U_INT8_Tb
argument_list|(
name|l
argument_list|)
expr_stmt|;
name|outblock
index|[
literal|6
index|]
operator|=
name|U_INT8_Tc
argument_list|(
name|l
argument_list|)
expr_stmt|;
name|outblock
index|[
literal|7
index|]
operator|=
name|U_INT8_Td
argument_list|(
name|l
argument_list|)
expr_stmt|;
comment|/* Wipe clean */
name|t
operator|=
name|l
operator|=
name|r
operator|=
literal|0
expr_stmt|;
block|}
end_function

begin_comment
comment|/***** Decryption Function *****/
end_comment

begin_function
name|void
name|cast_decrypt
parameter_list|(
name|cast_key
modifier|*
name|key
parameter_list|,
name|u_int8_t
modifier|*
name|inblock
parameter_list|,
name|u_int8_t
modifier|*
name|outblock
parameter_list|)
block|{
name|u_int32_t
name|t
decl_stmt|,
name|l
decl_stmt|,
name|r
decl_stmt|;
comment|/* Get inblock into l,r */
name|r
operator|=
operator|(
operator|(
name|u_int32_t
operator|)
name|inblock
index|[
literal|0
index|]
operator|<<
literal|24
operator|)
operator||
operator|(
operator|(
name|u_int32_t
operator|)
name|inblock
index|[
literal|1
index|]
operator|<<
literal|16
operator|)
operator||
operator|(
operator|(
name|u_int32_t
operator|)
name|inblock
index|[
literal|2
index|]
operator|<<
literal|8
operator|)
operator||
operator|(
name|u_int32_t
operator|)
name|inblock
index|[
literal|3
index|]
expr_stmt|;
name|l
operator|=
operator|(
operator|(
name|u_int32_t
operator|)
name|inblock
index|[
literal|4
index|]
operator|<<
literal|24
operator|)
operator||
operator|(
operator|(
name|u_int32_t
operator|)
name|inblock
index|[
literal|5
index|]
operator|<<
literal|16
operator|)
operator||
operator|(
operator|(
name|u_int32_t
operator|)
name|inblock
index|[
literal|6
index|]
operator|<<
literal|8
operator|)
operator||
operator|(
name|u_int32_t
operator|)
name|inblock
index|[
literal|7
index|]
expr_stmt|;
comment|/* Do the work */
comment|/* Only do full 16 rounds if key length> 80 bits */
if|if
condition|(
name|key
operator|->
name|rounds
operator|>
literal|12
condition|)
block|{
name|F1
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|F3
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
literal|14
argument_list|)
expr_stmt|;
name|F2
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
literal|13
argument_list|)
expr_stmt|;
name|F1
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
literal|12
argument_list|)
expr_stmt|;
block|}
name|F3
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
literal|11
argument_list|)
expr_stmt|;
name|F2
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|F1
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
literal|9
argument_list|)
expr_stmt|;
name|F3
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|F2
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
literal|7
argument_list|)
expr_stmt|;
name|F1
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|F3
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|F2
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|F1
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|F3
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|F2
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|F1
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|/* Put l,r into outblock */
name|outblock
index|[
literal|0
index|]
operator|=
name|U_INT8_Ta
argument_list|(
name|l
argument_list|)
expr_stmt|;
name|outblock
index|[
literal|1
index|]
operator|=
name|U_INT8_Tb
argument_list|(
name|l
argument_list|)
expr_stmt|;
name|outblock
index|[
literal|2
index|]
operator|=
name|U_INT8_Tc
argument_list|(
name|l
argument_list|)
expr_stmt|;
name|outblock
index|[
literal|3
index|]
operator|=
name|U_INT8_Td
argument_list|(
name|l
argument_list|)
expr_stmt|;
name|outblock
index|[
literal|4
index|]
operator|=
name|U_INT8_Ta
argument_list|(
name|r
argument_list|)
expr_stmt|;
name|outblock
index|[
literal|5
index|]
operator|=
name|U_INT8_Tb
argument_list|(
name|r
argument_list|)
expr_stmt|;
name|outblock
index|[
literal|6
index|]
operator|=
name|U_INT8_Tc
argument_list|(
name|r
argument_list|)
expr_stmt|;
name|outblock
index|[
literal|7
index|]
operator|=
name|U_INT8_Td
argument_list|(
name|r
argument_list|)
expr_stmt|;
comment|/* Wipe clean */
name|t
operator|=
name|l
operator|=
name|r
operator|=
literal|0
expr_stmt|;
block|}
end_function

begin_comment
comment|/***** Key Schedual *****/
end_comment

begin_function
name|void
name|cast_setkey
parameter_list|(
name|cast_key
modifier|*
name|key
parameter_list|,
name|u_int8_t
modifier|*
name|rawkey
parameter_list|,
name|int
name|keybytes
parameter_list|)
block|{
name|u_int32_t
name|t
index|[
literal|4
index|]
decl_stmt|,
name|z
index|[
literal|4
index|]
decl_stmt|,
name|x
index|[
literal|4
index|]
decl_stmt|;
name|int
name|i
decl_stmt|;
comment|/* Set number of rounds to 12 or 16, depending on key length */
name|key
operator|->
name|rounds
operator|=
operator|(
name|keybytes
operator|<=
literal|10
condition|?
literal|12
else|:
literal|16
operator|)
expr_stmt|;
comment|/* Copy key to workspace x */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|4
condition|;
name|i
operator|++
control|)
block|{
name|x
index|[
name|i
index|]
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|(
name|i
operator|*
literal|4
operator|+
literal|0
operator|)
operator|<
name|keybytes
condition|)
name|x
index|[
name|i
index|]
operator|=
operator|(
name|u_int32_t
operator|)
name|rawkey
index|[
name|i
operator|*
literal|4
operator|+
literal|0
index|]
operator|<<
literal|24
expr_stmt|;
if|if
condition|(
operator|(
name|i
operator|*
literal|4
operator|+
literal|1
operator|)
operator|<
name|keybytes
condition|)
name|x
index|[
name|i
index|]
operator||=
operator|(
name|u_int32_t
operator|)
name|rawkey
index|[
name|i
operator|*
literal|4
operator|+
literal|1
index|]
operator|<<
literal|16
expr_stmt|;
if|if
condition|(
operator|(
name|i
operator|*
literal|4
operator|+
literal|2
operator|)
operator|<
name|keybytes
condition|)
name|x
index|[
name|i
index|]
operator||=
operator|(
name|u_int32_t
operator|)
name|rawkey
index|[
name|i
operator|*
literal|4
operator|+
literal|2
index|]
operator|<<
literal|8
expr_stmt|;
if|if
condition|(
operator|(
name|i
operator|*
literal|4
operator|+
literal|3
operator|)
operator|<
name|keybytes
condition|)
name|x
index|[
name|i
index|]
operator||=
operator|(
name|u_int32_t
operator|)
name|rawkey
index|[
name|i
operator|*
literal|4
operator|+
literal|3
index|]
expr_stmt|;
block|}
comment|/* Generate 32 subkeys, four at a time */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|32
condition|;
name|i
operator|+=
literal|4
control|)
block|{
switch|switch
condition|(
name|i
operator|&
literal|4
condition|)
block|{
case|case
literal|0
case|:
name|t
index|[
literal|0
index|]
operator|=
name|z
index|[
literal|0
index|]
operator|=
name|x
index|[
literal|0
index|]
operator|^
name|cast_sbox5
index|[
name|U_INT8_Tb
argument_list|(
name|x
index|[
literal|3
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Td
argument_list|(
name|x
index|[
literal|3
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Ta
argument_list|(
name|x
index|[
literal|3
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Tc
argument_list|(
name|x
index|[
literal|3
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Ta
argument_list|(
name|x
index|[
literal|2
index|]
argument_list|)
index|]
expr_stmt|;
name|t
index|[
literal|1
index|]
operator|=
name|z
index|[
literal|1
index|]
operator|=
name|x
index|[
literal|2
index|]
operator|^
name|cast_sbox5
index|[
name|U_INT8_Ta
argument_list|(
name|z
index|[
literal|0
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Tc
argument_list|(
name|z
index|[
literal|0
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Tb
argument_list|(
name|z
index|[
literal|0
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Td
argument_list|(
name|z
index|[
literal|0
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Tc
argument_list|(
name|x
index|[
literal|2
index|]
argument_list|)
index|]
expr_stmt|;
name|t
index|[
literal|2
index|]
operator|=
name|z
index|[
literal|2
index|]
operator|=
name|x
index|[
literal|3
index|]
operator|^
name|cast_sbox5
index|[
name|U_INT8_Td
argument_list|(
name|z
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Tc
argument_list|(
name|z
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Tb
argument_list|(
name|z
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Ta
argument_list|(
name|z
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox5
index|[
name|U_INT8_Tb
argument_list|(
name|x
index|[
literal|2
index|]
argument_list|)
index|]
expr_stmt|;
name|t
index|[
literal|3
index|]
operator|=
name|z
index|[
literal|3
index|]
operator|=
name|x
index|[
literal|1
index|]
operator|^
name|cast_sbox5
index|[
name|U_INT8_Tc
argument_list|(
name|z
index|[
literal|2
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Tb
argument_list|(
name|z
index|[
literal|2
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Td
argument_list|(
name|z
index|[
literal|2
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Ta
argument_list|(
name|z
index|[
literal|2
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Td
argument_list|(
name|x
index|[
literal|2
index|]
argument_list|)
index|]
expr_stmt|;
break|break;
case|case
literal|4
case|:
name|t
index|[
literal|0
index|]
operator|=
name|x
index|[
literal|0
index|]
operator|=
name|z
index|[
literal|2
index|]
operator|^
name|cast_sbox5
index|[
name|U_INT8_Tb
argument_list|(
name|z
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Td
argument_list|(
name|z
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Ta
argument_list|(
name|z
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Tc
argument_list|(
name|z
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Ta
argument_list|(
name|z
index|[
literal|0
index|]
argument_list|)
index|]
expr_stmt|;
name|t
index|[
literal|1
index|]
operator|=
name|x
index|[
literal|1
index|]
operator|=
name|z
index|[
literal|0
index|]
operator|^
name|cast_sbox5
index|[
name|U_INT8_Ta
argument_list|(
name|x
index|[
literal|0
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Tc
argument_list|(
name|x
index|[
literal|0
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Tb
argument_list|(
name|x
index|[
literal|0
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Td
argument_list|(
name|x
index|[
literal|0
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Tc
argument_list|(
name|z
index|[
literal|0
index|]
argument_list|)
index|]
expr_stmt|;
name|t
index|[
literal|2
index|]
operator|=
name|x
index|[
literal|2
index|]
operator|=
name|z
index|[
literal|1
index|]
operator|^
name|cast_sbox5
index|[
name|U_INT8_Td
argument_list|(
name|x
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Tc
argument_list|(
name|x
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Tb
argument_list|(
name|x
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Ta
argument_list|(
name|x
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox5
index|[
name|U_INT8_Tb
argument_list|(
name|z
index|[
literal|0
index|]
argument_list|)
index|]
expr_stmt|;
name|t
index|[
literal|3
index|]
operator|=
name|x
index|[
literal|3
index|]
operator|=
name|z
index|[
literal|3
index|]
operator|^
name|cast_sbox5
index|[
name|U_INT8_Tc
argument_list|(
name|x
index|[
literal|2
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Tb
argument_list|(
name|x
index|[
literal|2
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Td
argument_list|(
name|x
index|[
literal|2
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Ta
argument_list|(
name|x
index|[
literal|2
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Td
argument_list|(
name|z
index|[
literal|0
index|]
argument_list|)
index|]
expr_stmt|;
break|break;
block|}
switch|switch
condition|(
name|i
operator|&
literal|12
condition|)
block|{
case|case
literal|0
case|:
case|case
literal|12
case|:
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|0
index|]
operator|=
name|cast_sbox5
index|[
name|U_INT8_Ta
argument_list|(
name|t
index|[
literal|2
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Tb
argument_list|(
name|t
index|[
literal|2
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Td
argument_list|(
name|t
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Tc
argument_list|(
name|t
index|[
literal|1
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|1
index|]
operator|=
name|cast_sbox5
index|[
name|U_INT8_Tc
argument_list|(
name|t
index|[
literal|2
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Td
argument_list|(
name|t
index|[
literal|2
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Tb
argument_list|(
name|t
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Ta
argument_list|(
name|t
index|[
literal|1
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|2
index|]
operator|=
name|cast_sbox5
index|[
name|U_INT8_Ta
argument_list|(
name|t
index|[
literal|3
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Tb
argument_list|(
name|t
index|[
literal|3
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Td
argument_list|(
name|t
index|[
literal|0
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Tc
argument_list|(
name|t
index|[
literal|0
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|3
index|]
operator|=
name|cast_sbox5
index|[
name|U_INT8_Tc
argument_list|(
name|t
index|[
literal|3
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Td
argument_list|(
name|t
index|[
literal|3
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Tb
argument_list|(
name|t
index|[
literal|0
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Ta
argument_list|(
name|t
index|[
literal|0
index|]
argument_list|)
index|]
expr_stmt|;
break|break;
case|case
literal|4
case|:
case|case
literal|8
case|:
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|0
index|]
operator|=
name|cast_sbox5
index|[
name|U_INT8_Td
argument_list|(
name|t
index|[
literal|0
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Tc
argument_list|(
name|t
index|[
literal|0
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Ta
argument_list|(
name|t
index|[
literal|3
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Tb
argument_list|(
name|t
index|[
literal|3
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|1
index|]
operator|=
name|cast_sbox5
index|[
name|U_INT8_Tb
argument_list|(
name|t
index|[
literal|0
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Ta
argument_list|(
name|t
index|[
literal|0
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Tc
argument_list|(
name|t
index|[
literal|3
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Td
argument_list|(
name|t
index|[
literal|3
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|2
index|]
operator|=
name|cast_sbox5
index|[
name|U_INT8_Td
argument_list|(
name|t
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Tc
argument_list|(
name|t
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Ta
argument_list|(
name|t
index|[
literal|2
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Tb
argument_list|(
name|t
index|[
literal|2
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|3
index|]
operator|=
name|cast_sbox5
index|[
name|U_INT8_Tb
argument_list|(
name|t
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox6
index|[
name|U_INT8_Ta
argument_list|(
name|t
index|[
literal|1
index|]
argument_list|)
index|]
operator|^
name|cast_sbox7
index|[
name|U_INT8_Tc
argument_list|(
name|t
index|[
literal|2
index|]
argument_list|)
index|]
operator|^
name|cast_sbox8
index|[
name|U_INT8_Td
argument_list|(
name|t
index|[
literal|2
index|]
argument_list|)
index|]
expr_stmt|;
break|break;
block|}
switch|switch
condition|(
name|i
operator|&
literal|12
condition|)
block|{
case|case
literal|0
case|:
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|0
index|]
operator|^=
name|cast_sbox5
index|[
name|U_INT8_Tc
argument_list|(
name|z
index|[
literal|0
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|1
index|]
operator|^=
name|cast_sbox6
index|[
name|U_INT8_Tc
argument_list|(
name|z
index|[
literal|1
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|2
index|]
operator|^=
name|cast_sbox7
index|[
name|U_INT8_Tb
argument_list|(
name|z
index|[
literal|2
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|3
index|]
operator|^=
name|cast_sbox8
index|[
name|U_INT8_Ta
argument_list|(
name|z
index|[
literal|3
index|]
argument_list|)
index|]
expr_stmt|;
break|break;
case|case
literal|4
case|:
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|0
index|]
operator|^=
name|cast_sbox5
index|[
name|U_INT8_Ta
argument_list|(
name|x
index|[
literal|2
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|1
index|]
operator|^=
name|cast_sbox6
index|[
name|U_INT8_Tb
argument_list|(
name|x
index|[
literal|3
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|2
index|]
operator|^=
name|cast_sbox7
index|[
name|U_INT8_Td
argument_list|(
name|x
index|[
literal|0
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|3
index|]
operator|^=
name|cast_sbox8
index|[
name|U_INT8_Td
argument_list|(
name|x
index|[
literal|1
index|]
argument_list|)
index|]
expr_stmt|;
break|break;
case|case
literal|8
case|:
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|0
index|]
operator|^=
name|cast_sbox5
index|[
name|U_INT8_Tb
argument_list|(
name|z
index|[
literal|2
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|1
index|]
operator|^=
name|cast_sbox6
index|[
name|U_INT8_Ta
argument_list|(
name|z
index|[
literal|3
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|2
index|]
operator|^=
name|cast_sbox7
index|[
name|U_INT8_Tc
argument_list|(
name|z
index|[
literal|0
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|3
index|]
operator|^=
name|cast_sbox8
index|[
name|U_INT8_Tc
argument_list|(
name|z
index|[
literal|1
index|]
argument_list|)
index|]
expr_stmt|;
break|break;
case|case
literal|12
case|:
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|0
index|]
operator|^=
name|cast_sbox5
index|[
name|U_INT8_Td
argument_list|(
name|x
index|[
literal|0
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|1
index|]
operator|^=
name|cast_sbox6
index|[
name|U_INT8_Td
argument_list|(
name|x
index|[
literal|1
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|2
index|]
operator|^=
name|cast_sbox7
index|[
name|U_INT8_Ta
argument_list|(
name|x
index|[
literal|2
index|]
argument_list|)
index|]
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|3
index|]
operator|^=
name|cast_sbox8
index|[
name|U_INT8_Tb
argument_list|(
name|x
index|[
literal|3
index|]
argument_list|)
index|]
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|i
operator|>=
literal|16
condition|)
block|{
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|0
index|]
operator|&=
literal|31
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|1
index|]
operator|&=
literal|31
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|2
index|]
operator|&=
literal|31
expr_stmt|;
name|key
operator|->
name|xkey
index|[
name|i
operator|+
literal|3
index|]
operator|&=
literal|31
expr_stmt|;
block|}
block|}
comment|/* Wipe clean */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|4
condition|;
name|i
operator|++
control|)
block|{
name|t
index|[
name|i
index|]
operator|=
name|x
index|[
name|i
index|]
operator|=
name|z
index|[
name|i
index|]
operator|=
literal|0
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* Made in Canada */
end_comment

end_unit

