begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* ocsp.c */
end_comment

begin_comment
comment|/* Written by Dr Stephen N Henson (shenson@bigfoot.com) for the OpenSSL  * project 2000.  */
end_comment

begin_comment
comment|/* ====================================================================  * Copyright (c) 2000 The OpenSSL Project.  All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  *  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.   *  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in  *    the documentation and/or other materials provided with the  *    distribution.  *  * 3. All advertising materials mentioning features or use of this  *    software must display the following acknowledgment:  *    "This product includes software developed by the OpenSSL Project  *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"  *  * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to  *    endorse or promote products derived from this software without  *    prior written permission. For written permission, please contact  *    licensing@OpenSSL.org.  *  * 5. Products derived from this software may not be called "OpenSSL"  *    nor may "OpenSSL" appear in their names without prior written  *    permission of the OpenSSL Project.  *  * 6. Redistributions of any form whatsoever must retain the following  *    acknowledgment:  *    "This product includes software developed by the OpenSSL Project  *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"  *  * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY  * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR  * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,  * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT  * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED  * OF THE POSSIBILITY OF SUCH DAMAGE.  * ====================================================================  *  * This product includes cryptographic software written by Eric Young  * (eay@cryptsoft.com).  This product includes software written by Tim  * Hudson (tjh@cryptsoft.com).  *  */
end_comment

begin_include
include|#
directive|include
file|<openssl/asn1.h>
end_include

begin_include
include|#
directive|include
file|<openssl/asn1t.h>
end_include

begin_include
include|#
directive|include
file|<openssl/x509v3.h>
end_include

begin_comment
comment|/* Example of new ASN1 code, OCSP request  	OCSPRequest     ::=     SEQUENCE { 	    tbsRequest                  TBSRequest, 	    optionalSignature   [0]     EXPLICIT Signature OPTIONAL }  	TBSRequest      ::=     SEQUENCE { 	    version             [0] EXPLICIT Version DEFAULT v1, 	    requestorName       [1] EXPLICIT GeneralName OPTIONAL, 	    requestList             SEQUENCE OF Request, 	    requestExtensions   [2] EXPLICIT Extensions OPTIONAL }  	Signature       ::=     SEQUENCE { 	    signatureAlgorithm   AlgorithmIdentifier, 	    signature            BIT STRING, 	    certs                [0] EXPLICIT SEQUENCE OF Certificate OPTIONAL }  	Version  ::=  INTEGER  {  v1(0) }  	Request ::=     SEQUENCE { 	    reqCert                    CertID, 	    singleRequestExtensions    [0] EXPLICIT Extensions OPTIONAL }  	CertID ::= SEQUENCE { 	    hashAlgorithm            AlgorithmIdentifier, 	    issuerNameHash     OCTET STRING, -- Hash of Issuer's DN 	    issuerKeyHash      OCTET STRING, -- Hash of Issuers public key 	    serialNumber       CertificateSerialNumber }  	OCSPResponse ::= SEQUENCE { 	   responseStatus         OCSPResponseStatus, 	   responseBytes          [0] EXPLICIT ResponseBytes OPTIONAL }  	OCSPResponseStatus ::= ENUMERATED { 	    successful            (0),      --Response has valid confirmations 	    malformedRequest      (1),      --Illegal confirmation request 	    internalError         (2),      --Internal error in issuer 	    tryLater              (3),      --Try again later 					    --(4) is not used 	    sigRequired           (5),      --Must sign the request 	    unauthorized          (6)       --Request unauthorized 	}  	ResponseBytes ::=       SEQUENCE { 	    responseType   OBJECT IDENTIFIER, 	    response       OCTET STRING }  	BasicOCSPResponse       ::= SEQUENCE { 	   tbsResponseData      ResponseData, 	   signatureAlgorithm   AlgorithmIdentifier, 	   signature            BIT STRING, 	   certs                [0] EXPLICIT SEQUENCE OF Certificate OPTIONAL }  	ResponseData ::= SEQUENCE { 	   version              [0] EXPLICIT Version DEFAULT v1, 	   responderID              ResponderID, 	   producedAt               GeneralizedTime, 	   responses                SEQUENCE OF SingleResponse, 	   responseExtensions   [1] EXPLICIT Extensions OPTIONAL }  	ResponderID ::= CHOICE { 	   byName   [1] Name,    --EXPLICIT 	   byKey    [2] KeyHash }  	KeyHash ::= OCTET STRING --SHA-1 hash of responder's public key 				 --(excluding the tag and length fields)  	SingleResponse ::= SEQUENCE { 	   certID                       CertID, 	   certStatus                   CertStatus, 	   thisUpdate                   GeneralizedTime, 	   nextUpdate           [0]     EXPLICIT GeneralizedTime OPTIONAL, 	   singleExtensions     [1]     EXPLICIT Extensions OPTIONAL }  	CertStatus ::= CHOICE { 	    good                [0]     IMPLICIT NULL, 	    revoked             [1]     IMPLICIT RevokedInfo, 	    unknown             [2]     IMPLICIT UnknownInfo }  	RevokedInfo ::= SEQUENCE { 	    revocationTime              GeneralizedTime, 	    revocationReason    [0]     EXPLICIT CRLReason OPTIONAL }  	UnknownInfo ::= NULL -- this can be replaced with an enumeration  	ArchiveCutoff ::= GeneralizedTime  	AcceptableResponses ::= SEQUENCE OF OBJECT IDENTIFIER  	ServiceLocator ::= SEQUENCE { 	    issuer    Name, 	    locator   AuthorityInfoAccessSyntax }  	-- Object Identifiers  	id-kp-OCSPSigning            OBJECT IDENTIFIER ::= { id-kp 9 } 	id-pkix-ocsp                 OBJECT IDENTIFIER ::= { id-ad-ocsp } 	id-pkix-ocsp-basic           OBJECT IDENTIFIER ::= { id-pkix-ocsp 1 } 	id-pkix-ocsp-nonce           OBJECT IDENTIFIER ::= { id-pkix-ocsp 2 } 	id-pkix-ocsp-crl             OBJECT IDENTIFIER ::= { id-pkix-ocsp 3 } 	id-pkix-ocsp-response        OBJECT IDENTIFIER ::= { id-pkix-ocsp 4 } 	id-pkix-ocsp-nocheck         OBJECT IDENTIFIER ::= { id-pkix-ocsp 5 } 	id-pkix-ocsp-archive-cutoff  OBJECT IDENTIFIER ::= { id-pkix-ocsp 6 } 	id-pkix-ocsp-service-locator OBJECT IDENTIFIER ::= { id-pkix-ocsp 7 }  */
end_comment

begin_comment
comment|/* Request Structures */
end_comment

begin_macro
name|DECLARE_STACK_OF
argument_list|(
argument|Request
argument_list|)
end_macro

begin_typedef
typedef|typedef
struct|struct
block|{
name|ASN1_INTEGER
modifier|*
name|version
decl_stmt|;
name|GENERAL_NAME
modifier|*
name|requestorName
decl_stmt|;
name|STACK_OF
argument_list|(
name|Request
argument_list|)
operator|*
name|requestList
expr_stmt|;
name|STACK_OF
argument_list|(
name|X509_EXTENSION
argument_list|)
operator|*
name|requestExtensions
expr_stmt|;
block|}
name|TBSRequest
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
block|{
name|X509_ALGOR
modifier|*
name|signatureAlgorithm
decl_stmt|;
name|ASN1_BIT_STRING
modifier|*
name|signature
decl_stmt|;
name|STACK_OF
argument_list|(
name|X509
argument_list|)
operator|*
name|certs
expr_stmt|;
block|}
name|Signature
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
block|{
name|TBSRequest
modifier|*
name|tbsRequest
decl_stmt|;
name|Signature
modifier|*
name|optionalSignature
decl_stmt|;
block|}
name|OCSPRequest
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
block|{
name|X509_ALGOR
modifier|*
name|hashAlgorithm
decl_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|issuerNameHash
decl_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|issuerKeyHash
decl_stmt|;
name|ASN1_INTEGER
modifier|*
name|certificateSerialNumber
decl_stmt|;
block|}
name|CertID
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
block|{
name|CertID
modifier|*
name|reqCert
decl_stmt|;
name|STACK_OF
argument_list|(
name|X509_EXTENSION
argument_list|)
operator|*
name|singleRequestExtensions
expr_stmt|;
block|}
name|Request
typedef|;
end_typedef

begin_comment
comment|/* Response structures */
end_comment

begin_typedef
typedef|typedef
struct|struct
block|{
name|ASN1_OBJECT
modifier|*
name|responseType
decl_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|response
decl_stmt|;
block|}
name|ResponseBytes
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
block|{
name|ASN1_ENUMERATED
modifier|*
name|responseStatus
decl_stmt|;
name|ResponseBytes
modifier|*
name|responseBytes
decl_stmt|;
block|}
name|OCSPResponse
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
block|{
name|int
name|type
decl_stmt|;
union|union
block|{
name|X509_NAME
modifier|*
name|byName
decl_stmt|;
name|ASN1_OCTET_STRING
modifier|*
name|byKey
decl_stmt|;
block|}
name|d
union|;
block|}
name|ResponderID
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
block|{
name|ASN1_INTEGER
modifier|*
name|version
decl_stmt|;
name|ResponderID
modifier|*
name|responderID
decl_stmt|;
name|ASN1_GENERALIZEDTIME
modifier|*
name|producedAt
decl_stmt|;
name|STACK_OF
argument_list|(
name|SingleResponse
argument_list|)
operator|*
name|responses
expr_stmt|;
name|STACK_OF
argument_list|(
name|X509_EXTENSION
argument_list|)
operator|*
name|responseExtensions
expr_stmt|;
block|}
name|ResponseData
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
block|{
name|ResponseData
modifier|*
name|tbsResponseData
decl_stmt|;
name|X509_ALGOR
modifier|*
name|signatureAlgorithm
decl_stmt|;
name|ASN1_BIT_STRING
modifier|*
name|signature
decl_stmt|;
name|STACK_OF
argument_list|(
name|X509
argument_list|)
operator|*
name|certs
expr_stmt|;
block|}
name|BasicOCSPResponse
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
block|{
name|ASN1_GENERALIZEDTIME
modifier|*
name|revocationTime
decl_stmt|;
name|ASN1_ENUMERATED
modifier|*
name|revocationReason
decl_stmt|;
block|}
name|RevokedInfo
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
block|{
name|int
name|type
decl_stmt|;
union|union
block|{
name|ASN1_NULL
modifier|*
name|good
decl_stmt|;
name|RevokedInfo
modifier|*
name|revoked
decl_stmt|;
name|ASN1_NULL
modifier|*
name|unknown
decl_stmt|;
block|}
name|d
union|;
block|}
name|CertStatus
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
block|{
name|CertID
modifier|*
name|certID
decl_stmt|;
name|CertStatus
modifier|*
name|certStatus
decl_stmt|;
name|ASN1_GENERALIZEDTIME
modifier|*
name|thisUpdate
decl_stmt|;
name|ASN1_GENERALIZEDTIME
modifier|*
name|nextUpdate
decl_stmt|;
name|STACK_OF
argument_list|(
name|X509_EXTENSION
argument_list|)
operator|*
name|singleExtensions
expr_stmt|;
block|}
name|SingleResponse
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
block|{
name|X509_NAME
modifier|*
name|issuer
decl_stmt|;
name|STACK_OF
argument_list|(
name|ACCESS_DESCRIPTION
argument_list|)
operator|*
name|locator
expr_stmt|;
block|}
name|ServiceLocator
typedef|;
end_typedef

begin_comment
comment|/* Now the ASN1 templates */
end_comment

begin_expr_stmt
name|IMPLEMENT_COMPAT_ASN1
argument_list|(
name|X509
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|IMPLEMENT_COMPAT_ASN1
argument_list|(
name|X509_ALGOR
argument_list|)
expr_stmt|;
end_expr_stmt

begin_comment
comment|//IMPLEMENT_COMPAT_ASN1(X509_EXTENSION);
end_comment

begin_expr_stmt
name|IMPLEMENT_COMPAT_ASN1
argument_list|(
name|GENERAL_NAME
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|IMPLEMENT_COMPAT_ASN1
argument_list|(
name|X509_NAME
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|ASN1_SEQUENCE
argument_list|(
name|X509_EXTENSION
argument_list|)
operator|=
block|{
name|ASN1_SIMPLE
argument_list|(
name|X509_EXTENSION
argument_list|,
name|object
argument_list|,
name|ASN1_OBJECT
argument_list|)
block|,
name|ASN1_OPT
argument_list|(
name|X509_EXTENSION
argument_list|,
name|critical
argument_list|,
name|ASN1_BOOLEAN
argument_list|)
block|,
name|ASN1_SIMPLE
argument_list|(
argument|X509_EXTENSION
argument_list|,
argument|value
argument_list|,
argument|ASN1_OCTET_STRING
argument_list|)
block|}
name|ASN1_SEQUENCE_END
argument_list|(
name|X509_EXTENSION
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|ASN1_SEQUENCE
argument_list|(
name|Signature
argument_list|)
operator|=
block|{
name|ASN1_SIMPLE
argument_list|(
name|Signature
argument_list|,
name|signatureAlgorithm
argument_list|,
name|X509_ALGOR
argument_list|)
block|,
name|ASN1_SIMPLE
argument_list|(
name|Signature
argument_list|,
name|signature
argument_list|,
name|ASN1_BIT_STRING
argument_list|)
block|,
name|ASN1_SEQUENCE_OF
argument_list|(
argument|Signature
argument_list|,
argument|certs
argument_list|,
argument|X509
argument_list|)
block|}
name|ASN1_SEQUENCE_END
argument_list|(
name|Signature
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|ASN1_SEQUENCE
argument_list|(
name|CertID
argument_list|)
operator|=
block|{
name|ASN1_SIMPLE
argument_list|(
name|CertID
argument_list|,
name|hashAlgorithm
argument_list|,
name|X509_ALGOR
argument_list|)
block|,
name|ASN1_SIMPLE
argument_list|(
name|CertID
argument_list|,
name|issuerNameHash
argument_list|,
name|ASN1_OCTET_STRING
argument_list|)
block|,
name|ASN1_SIMPLE
argument_list|(
name|CertID
argument_list|,
name|issuerKeyHash
argument_list|,
name|ASN1_OCTET_STRING
argument_list|)
block|,
name|ASN1_SIMPLE
argument_list|(
argument|CertID
argument_list|,
argument|certificateSerialNumber
argument_list|,
argument|ASN1_INTEGER
argument_list|)
block|}
name|ASN1_SEQUENCE_END
argument_list|(
name|CertID
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|ASN1_SEQUENCE
argument_list|(
name|Request
argument_list|)
operator|=
block|{
name|ASN1_SIMPLE
argument_list|(
name|Request
argument_list|,
name|reqCert
argument_list|,
name|CertID
argument_list|)
block|,
name|ASN1_EXP_SEQUENCE_OF_OPT
argument_list|(
argument|Request
argument_list|,
argument|singleRequestExtensions
argument_list|,
argument|X509_EXTENSION
argument_list|,
literal|0
argument_list|)
block|}
name|ASN1_SEQUENCE_END
argument_list|(
name|Request
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|ASN1_SEQUENCE
argument_list|(
name|TBSRequest
argument_list|)
operator|=
block|{
name|ASN1_EXP_OPT
argument_list|(
name|TBSRequest
argument_list|,
name|version
argument_list|,
name|ASN1_INTEGER
argument_list|,
literal|0
argument_list|)
block|,
name|ASN1_EXP_OPT
argument_list|(
name|TBSRequest
argument_list|,
name|requestorName
argument_list|,
name|GENERAL_NAME
argument_list|,
literal|1
argument_list|)
block|,
name|ASN1_SEQUENCE_OF
argument_list|(
name|TBSRequest
argument_list|,
name|requestList
argument_list|,
name|Request
argument_list|)
block|,
name|ASN1_EXP_SEQUENCE_OF_OPT
argument_list|(
argument|TBSRequest
argument_list|,
argument|requestExtensions
argument_list|,
argument|X509_EXTENSION
argument_list|,
literal|2
argument_list|)
block|}
name|ASN1_SEQUENCE_END
argument_list|(
name|TBSRequest
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|ASN1_SEQUENCE
argument_list|(
name|OCSPRequest
argument_list|)
operator|=
block|{
name|ASN1_SIMPLE
argument_list|(
name|OCSPRequest
argument_list|,
name|tbsRequest
argument_list|,
name|TBSRequest
argument_list|)
block|,
name|ASN1_EXP_OPT
argument_list|(
argument|OCSPRequest
argument_list|,
argument|optionalSignature
argument_list|,
argument|Signature
argument_list|,
literal|0
argument_list|)
block|}
name|ASN1_SEQUENCE_END
argument_list|(
name|OCSPRequest
argument_list|)
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* Response templates */
end_comment

begin_expr_stmt
name|ASN1_SEQUENCE
argument_list|(
name|ResponseBytes
argument_list|)
operator|=
block|{
name|ASN1_SIMPLE
argument_list|(
name|ResponseBytes
argument_list|,
name|responseType
argument_list|,
name|ASN1_OBJECT
argument_list|)
block|,
name|ASN1_SIMPLE
argument_list|(
argument|ResponseBytes
argument_list|,
argument|response
argument_list|,
argument|ASN1_OCTET_STRING
argument_list|)
block|}
name|ASN1_SEQUENCE_END
argument_list|(
name|ResponseBytes
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|ASN1_SEQUENCE
argument_list|(
name|OCSPResponse
argument_list|)
operator|=
block|{
name|ASN1_SIMPLE
argument_list|(
name|OCSPResponse
argument_list|,
name|responseStatus
argument_list|,
name|ASN1_ENUMERATED
argument_list|)
block|,
name|ASN1_EXP_OPT
argument_list|(
argument|OCSPResponse
argument_list|,
argument|responseBytes
argument_list|,
argument|ResponseBytes
argument_list|,
literal|0
argument_list|)
block|}
name|ASN1_SEQUENCE_END
argument_list|(
name|OCSPResponse
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|ASN1_CHOICE
argument_list|(
name|ResponderID
argument_list|)
operator|=
block|{
name|ASN1_EXP
argument_list|(
name|ResponderID
argument_list|,
name|d
operator|.
name|byName
argument_list|,
name|X509_NAME
argument_list|,
literal|1
argument_list|)
block|,
name|ASN1_IMP
argument_list|(
argument|ResponderID
argument_list|,
argument|d.byKey
argument_list|,
argument|ASN1_OCTET_STRING
argument_list|,
literal|2
argument_list|)
block|}
name|ASN1_CHOICE_END
argument_list|(
name|ResponderID
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|ASN1_SEQUENCE
argument_list|(
name|RevokedInfo
argument_list|)
operator|=
block|{
name|ASN1_SIMPLE
argument_list|(
name|RevokedInfo
argument_list|,
name|revocationTime
argument_list|,
name|ASN1_GENERALIZEDTIME
argument_list|)
block|,
name|ASN1_EXP_OPT
argument_list|(
argument|RevokedInfo
argument_list|,
argument|revocationReason
argument_list|,
argument|ASN1_ENUMERATED
argument_list|,
literal|0
argument_list|)
block|}
name|ASN1_SEQUENCE_END
argument_list|(
name|RevokedInfo
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|ASN1_CHOICE
argument_list|(
name|CertStatus
argument_list|)
operator|=
block|{
name|ASN1_IMP
argument_list|(
name|CertStatus
argument_list|,
name|d
operator|.
name|good
argument_list|,
name|ASN1_NULL
argument_list|,
literal|0
argument_list|)
block|,
name|ASN1_IMP
argument_list|(
name|CertStatus
argument_list|,
name|d
operator|.
name|revoked
argument_list|,
name|RevokedInfo
argument_list|,
literal|1
argument_list|)
block|,
name|ASN1_IMP
argument_list|(
argument|CertStatus
argument_list|,
argument|d.unknown
argument_list|,
argument|ASN1_NULL
argument_list|,
literal|2
argument_list|)
block|}
name|ASN1_CHOICE_END
argument_list|(
name|CertStatus
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|ASN1_SEQUENCE
argument_list|(
name|SingleResponse
argument_list|)
operator|=
block|{
name|ASN1_SIMPLE
argument_list|(
name|SingleResponse
argument_list|,
name|certID
argument_list|,
name|CertID
argument_list|)
block|,
name|ASN1_SIMPLE
argument_list|(
name|SingleResponse
argument_list|,
name|certStatus
argument_list|,
name|CertStatus
argument_list|)
block|,
name|ASN1_SIMPLE
argument_list|(
name|SingleResponse
argument_list|,
name|thisUpdate
argument_list|,
name|ASN1_GENERALIZEDTIME
argument_list|)
block|,
name|ASN1_EXP_OPT
argument_list|(
name|SingleResponse
argument_list|,
name|nextUpdate
argument_list|,
name|ASN1_GENERALIZEDTIME
argument_list|,
literal|0
argument_list|)
block|,
name|ASN1_EXP_SEQUENCE_OF_OPT
argument_list|(
argument|SingleResponse
argument_list|,
argument|singleExtensions
argument_list|,
argument|X509_EXTENSION
argument_list|,
literal|1
argument_list|)
block|}
name|ASN1_SEQUENCE_END
argument_list|(
name|SingleResponse
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|ASN1_SEQUENCE
argument_list|(
name|ResponseData
argument_list|)
operator|=
block|{
name|ASN1_EXP_OPT
argument_list|(
name|ResponseData
argument_list|,
name|version
argument_list|,
name|ASN1_INTEGER
argument_list|,
literal|0
argument_list|)
block|,
name|ASN1_SIMPLE
argument_list|(
name|ResponseData
argument_list|,
name|responderID
argument_list|,
name|ResponderID
argument_list|)
block|,
name|ASN1_SIMPLE
argument_list|(
name|ResponseData
argument_list|,
name|producedAt
argument_list|,
name|ASN1_GENERALIZEDTIME
argument_list|)
block|,
name|ASN1_SEQUENCE_OF
argument_list|(
name|ResponseData
argument_list|,
name|responses
argument_list|,
name|SingleResponse
argument_list|)
block|,
name|ASN1_EXP_SEQUENCE_OF_OPT
argument_list|(
argument|ResponseData
argument_list|,
argument|responseExtensions
argument_list|,
argument|X509_EXTENSION
argument_list|,
literal|1
argument_list|)
block|}
name|ASN1_SEQUENCE_END
argument_list|(
name|ResponseData
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|ASN1_SEQUENCE
argument_list|(
name|BasicOCSPResponse
argument_list|)
operator|=
block|{
name|ASN1_SIMPLE
argument_list|(
name|BasicOCSPResponse
argument_list|,
name|tbsResponseData
argument_list|,
name|ResponseData
argument_list|)
block|,
name|ASN1_SIMPLE
argument_list|(
name|BasicOCSPResponse
argument_list|,
name|signatureAlgorithm
argument_list|,
name|X509_ALGOR
argument_list|)
block|,
name|ASN1_SIMPLE
argument_list|(
name|BasicOCSPResponse
argument_list|,
name|signature
argument_list|,
name|ASN1_BIT_STRING
argument_list|)
block|,
name|ASN1_EXP_SEQUENCE_OF_OPT
argument_list|(
argument|BasicOCSPResponse
argument_list|,
argument|certs
argument_list|,
argument|X509
argument_list|,
literal|0
argument_list|)
block|}
name|ASN1_SEQUENCE_END
argument_list|(
name|BasicOCSPResponse
argument_list|)
expr_stmt|;
end_expr_stmt

end_unit

