begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
modifier|*
name|sccsid
init|=
literal|"@(#)main.c	1.1 83/03/17"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|"externs.h"
end_include

begin_define
define|#
directive|define
name|distance
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|)
value|(abs(x)>= abs(y) ? abs(x) + abs(y)/2 : abs(y) + abs(x)/2)
end_define

begin_expr_stmt
name|range
argument_list|(
name|fromship
argument_list|,
name|toship
argument_list|)
specifier|register
name|int
name|fromship
operator|,
name|toship
expr_stmt|;
end_expr_stmt

begin_block
block|{
name|int
name|bow1r
decl_stmt|,
name|bow1c
decl_stmt|,
name|bow2r
decl_stmt|,
name|bow2c
decl_stmt|;
name|int
name|stern1r
decl_stmt|,
name|stern1c
decl_stmt|,
name|stern2c
decl_stmt|,
name|stern2r
decl_stmt|;
specifier|register
name|int
name|bb
decl_stmt|,
name|bs
decl_stmt|,
name|sb
decl_stmt|,
name|ss
decl_stmt|,
name|result
decl_stmt|;
if|if
condition|(
name|fromship
operator|>
name|scene
index|[
name|game
index|]
operator|.
name|vessels
operator|||
name|toship
operator|>
name|scene
index|[
name|game
index|]
operator|.
name|vessels
condition|)
comment|/* just in case */
return|return
operator|(
literal|30000
operator|)
return|;
if|if
condition|(
operator|!
name|pos
index|[
name|toship
index|]
operator|.
name|dir
condition|)
return|return
operator|(
literal|30000
operator|)
return|;
name|stern1r
operator|=
name|bow1r
operator|=
name|pos
index|[
name|fromship
index|]
operator|.
name|row
expr_stmt|;
name|stern1c
operator|=
name|bow1c
operator|=
name|pos
index|[
name|fromship
index|]
operator|.
name|col
expr_stmt|;
name|stern2r
operator|=
name|bow2r
operator|=
name|pos
index|[
name|toship
index|]
operator|.
name|row
expr_stmt|;
name|stern2c
operator|=
name|bow2c
operator|=
name|pos
index|[
name|toship
index|]
operator|.
name|col
expr_stmt|;
name|result
operator|=
name|bb
operator|=
name|distance
argument_list|(
operator|(
name|bow2r
operator|-
name|bow1r
operator|)
argument_list|,
operator|(
name|bow2c
operator|-
name|bow1c
operator|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|bb
operator|<
literal|5
condition|)
block|{
name|drdc
argument_list|(
operator|&
name|stern2r
argument_list|,
operator|&
name|stern2c
argument_list|,
name|pos
index|[
name|toship
index|]
operator|.
name|dir
argument_list|)
expr_stmt|;
name|drdc
argument_list|(
operator|&
name|stern1r
argument_list|,
operator|&
name|stern1c
argument_list|,
name|pos
index|[
name|fromship
index|]
operator|.
name|dir
argument_list|)
expr_stmt|;
name|bs
operator|=
name|distance
argument_list|(
operator|(
name|bow2r
operator|-
name|stern1r
operator|)
argument_list|,
operator|(
name|bow2c
operator|-
name|stern1c
operator|)
argument_list|)
expr_stmt|;
name|sb
operator|=
name|distance
argument_list|(
operator|(
name|bow1r
operator|-
name|stern2r
operator|)
argument_list|,
operator|(
name|bow1c
operator|-
name|stern2c
operator|)
argument_list|)
expr_stmt|;
name|ss
operator|=
name|distance
argument_list|(
operator|(
name|stern2r
operator|-
name|stern1r
operator|)
argument_list|,
operator|(
name|stern2c
operator|-
name|stern1c
operator|)
argument_list|)
expr_stmt|;
name|result
operator|=
name|min
argument_list|(
name|bb
argument_list|,
name|min
argument_list|(
name|bs
argument_list|,
name|min
argument_list|(
name|sb
argument_list|,
name|ss
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
return|return
operator|(
name|result
operator|)
return|;
block|}
end_block

begin_expr_stmt
name|drdc
argument_list|(
name|dr
argument_list|,
name|dc
argument_list|,
name|dir
argument_list|)
specifier|register
name|int
operator|*
name|dr
operator|,
operator|*
name|dc
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|int
name|dir
decl_stmt|;
end_decl_stmt

begin_block
block|{
switch|switch
condition|(
name|dir
condition|)
block|{
case|case
literal|1
case|:
operator|(
operator|*
name|dr
operator|)
operator|++
expr_stmt|;
break|break;
case|case
literal|2
case|:
operator|(
operator|*
name|dr
operator|)
operator|++
expr_stmt|;
operator|(
operator|*
name|dc
operator|)
operator|--
expr_stmt|;
break|break;
case|case
literal|3
case|:
operator|(
operator|*
name|dc
operator|)
operator|--
expr_stmt|;
break|break;
case|case
literal|4
case|:
operator|(
operator|*
name|dr
operator|)
operator|--
expr_stmt|;
operator|(
operator|*
name|dc
operator|)
operator|--
expr_stmt|;
break|break;
case|case
literal|5
case|:
operator|(
operator|*
name|dr
operator|)
operator|--
expr_stmt|;
break|break;
case|case
literal|6
case|:
operator|(
operator|*
name|dr
operator|)
operator|--
expr_stmt|;
operator|(
operator|*
name|dc
operator|)
operator|++
expr_stmt|;
break|break;
case|case
literal|7
case|:
operator|(
operator|*
name|dc
operator|)
operator|++
expr_stmt|;
break|break;
case|case
literal|8
case|:
operator|(
operator|*
name|dr
operator|)
operator|++
expr_stmt|;
operator|(
operator|*
name|dc
operator|)
operator|++
expr_stmt|;
break|break;
block|}
block|}
end_block

end_unit

