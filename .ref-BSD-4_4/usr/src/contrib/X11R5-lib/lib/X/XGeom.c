begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* $XConsortium: XGeom.c,v 1.8 91/01/06 11:45:51 rws Exp $ */
end_comment

begin_comment
comment|/* Copyright Massachusetts Institute of Technology 1985 */
end_comment

begin_comment
comment|/* Permission to use, copy, modify, distribute, and sell this software and its documentation for any purpose is hereby granted without fee, provided that the above copyright notice appear in all copies and that both that copyright notice and this permission notice appear in supporting documentation, and that the name of M.I.T. not be used in advertising or publicity pertaining to distribution of the software without specific, written prior permission.  M.I.T. makes no representations about the suitability of this software for any purpose.  It is provided "as is" without express or implied warranty. */
end_comment

begin_include
include|#
directive|include
file|"Xlibint.h"
end_include

begin_include
include|#
directive|include
file|"Xutil.h"
end_include

begin_comment
comment|/*  * This routine given a user supplied positional argument and a default  * argument (fully qualified) will return the position the window should take  * returns 0 if there was some problem, else the position bitmask.  */
end_comment

begin_if
if|#
directive|if
name|NeedFunctionPrototypes
end_if

begin_function
name|int
name|XGeometry
parameter_list|(
name|Display
modifier|*
name|dpy
parameter_list|,
comment|/* user's display connection */
name|int
name|screen
parameter_list|,
comment|/* screen on which to do computation */
name|_Xconst
name|char
modifier|*
name|pos
parameter_list|,
comment|/* user provided geometry spec */
name|_Xconst
name|char
modifier|*
name|def
parameter_list|,
comment|/* default geometry spec for window */
name|unsigned
name|int
name|bwidth
parameter_list|,
comment|/* border width */
name|unsigned
name|int
name|fwidth
parameter_list|,
comment|/* size of position units */
name|unsigned
name|int
name|fheight
parameter_list|,
name|int
name|xadd
parameter_list|,
comment|/* any additional interior space */
name|int
name|yadd
parameter_list|,
specifier|register
name|int
modifier|*
name|x
parameter_list|,
comment|/* always set on successful RETURN */
specifier|register
name|int
modifier|*
name|y
parameter_list|,
comment|/* always set on successful RETURN */
specifier|register
name|int
modifier|*
name|width
parameter_list|,
comment|/* always set on successful RETURN */
specifier|register
name|int
modifier|*
name|height
parameter_list|)
comment|/* always set on successful RETURN */
else|#
directive|else
function|int XGeometry
parameter_list|(
name|dpy
parameter_list|,
name|screen
parameter_list|,
name|pos
parameter_list|,
name|def
parameter_list|,
name|bwidth
parameter_list|,
name|fwidth
parameter_list|,
name|fheight
parameter_list|,
name|xadd
parameter_list|,
name|yadd
parameter_list|,
name|x
parameter_list|,
name|y
parameter_list|,
name|width
parameter_list|,
name|height
parameter_list|)
name|Display
modifier|*
name|dpy
decl_stmt|;
comment|/* user's display connection */
name|int
name|screen
decl_stmt|;
comment|/* screen on which to do computation */
name|char
modifier|*
name|pos
decl_stmt|;
comment|/* user provided geometry spec */
name|char
modifier|*
name|def
decl_stmt|;
comment|/* default geometry spec for window */
name|unsigned
name|int
name|bwidth
decl_stmt|;
comment|/* border width */
name|unsigned
name|int
name|fwidth
decl_stmt|,
name|fheight
decl_stmt|;
comment|/* size of position units */
name|int
name|xadd
decl_stmt|,
name|yadd
decl_stmt|;
comment|/* any additional interior space */
specifier|register
name|int
modifier|*
name|x
decl_stmt|,
decl|*
name|y
decl_stmt|,
modifier|*
name|width
decl_stmt|,
modifier|*
name|height
decl_stmt|;
end_function

begin_comment
comment|/* always set on successful RETURN */
end_comment

begin_endif
endif|#
directive|endif
end_endif

begin_block
block|{
name|int
name|px
decl_stmt|,
name|py
decl_stmt|;
comment|/* returned values from parse */
name|unsigned
name|int
name|pwidth
decl_stmt|,
name|pheight
decl_stmt|;
comment|/* returned values from parse */
name|int
name|dx
decl_stmt|,
name|dy
decl_stmt|;
comment|/* default values from parse */
name|unsigned
name|int
name|dwidth
decl_stmt|,
name|dheight
decl_stmt|;
comment|/* default values from parse */
name|int
name|pmask
decl_stmt|,
name|dmask
decl_stmt|;
comment|/* values back from parse */
name|pmask
operator|=
name|XParseGeometry
argument_list|(
name|pos
argument_list|,
operator|&
name|px
argument_list|,
operator|&
name|py
argument_list|,
operator|&
name|pwidth
argument_list|,
operator|&
name|pheight
argument_list|)
expr_stmt|;
name|dmask
operator|=
name|XParseGeometry
argument_list|(
name|def
argument_list|,
operator|&
name|dx
argument_list|,
operator|&
name|dy
argument_list|,
operator|&
name|dwidth
argument_list|,
operator|&
name|dheight
argument_list|)
expr_stmt|;
comment|/* set default values */
operator|*
name|x
operator|=
operator|(
name|dmask
operator|&
name|XNegative
operator|)
condition|?
name|DisplayWidth
argument_list|(
name|dpy
argument_list|,
name|screen
argument_list|)
operator|+
name|dx
operator|-
name|dwidth
operator|*
name|fwidth
operator|-
literal|2
operator|*
name|bwidth
operator|-
name|xadd
else|:
name|dx
expr_stmt|;
operator|*
name|y
operator|=
operator|(
name|dmask
operator|&
name|YNegative
operator|)
condition|?
name|DisplayHeight
argument_list|(
name|dpy
argument_list|,
name|screen
argument_list|)
operator|+
name|dy
operator|-
name|dheight
operator|*
name|fheight
operator|-
literal|2
operator|*
name|bwidth
operator|-
name|yadd
else|:
name|dy
expr_stmt|;
operator|*
name|width
operator|=
name|dwidth
expr_stmt|;
operator|*
name|height
operator|=
name|dheight
expr_stmt|;
if|if
condition|(
name|pmask
operator|&
name|WidthValue
condition|)
operator|*
name|width
operator|=
name|pwidth
expr_stmt|;
if|if
condition|(
name|pmask
operator|&
name|HeightValue
condition|)
operator|*
name|height
operator|=
name|pheight
expr_stmt|;
if|if
condition|(
name|pmask
operator|&
name|XValue
condition|)
operator|*
name|x
operator|=
operator|(
name|pmask
operator|&
name|XNegative
operator|)
condition|?
name|DisplayWidth
argument_list|(
name|dpy
argument_list|,
name|screen
argument_list|)
operator|+
name|px
operator|-
operator|*
name|width
operator|*
name|fwidth
operator|-
literal|2
operator|*
name|bwidth
operator|-
name|xadd
else|:
name|px
expr_stmt|;
if|if
condition|(
name|pmask
operator|&
name|YValue
condition|)
operator|*
name|y
operator|=
operator|(
name|pmask
operator|&
name|YNegative
operator|)
condition|?
name|DisplayHeight
argument_list|(
name|dpy
argument_list|,
name|screen
argument_list|)
operator|+
name|py
operator|-
operator|*
name|height
operator|*
name|fheight
operator|-
literal|2
operator|*
name|bwidth
operator|-
name|yadd
else|:
name|py
expr_stmt|;
return|return
operator|(
name|pmask
operator|)
return|;
block|}
end_block

end_unit

