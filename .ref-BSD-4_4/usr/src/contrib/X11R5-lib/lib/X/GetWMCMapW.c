begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* $XConsortium: GetWMCMapW.c,v 1.5 91/02/01 16:33:05 gildea Exp $ */
end_comment

begin_comment
comment|/*********************************************************** Copyright 1987 by Digital Equipment Corporation, Maynard, Massachusetts, and the Massachusetts Institute of Technology, Cambridge, Massachusetts.                          All Rights Reserved  Permission to use, copy, modify, and distribute this software and its  documentation for any purpose and without fee is hereby granted,  provided that the above copyright notice appear in all copies and that both that copyright notice and this permission notice appear in  supporting documentation, and that the names of Digital or MIT not be used in advertising or publicity pertaining to distribution of the software without specific, written prior permission.    DIGITAL DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, IN NO EVENT SHALL DIGITAL BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.  ******************************************************************/
end_comment

begin_include
include|#
directive|include
file|"Xlibint.h"
end_include

begin_include
include|#
directive|include
file|<X11/Xatom.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_function
name|Status
name|XGetWMColormapWindows
parameter_list|(
name|dpy
parameter_list|,
name|w
parameter_list|,
name|colormapWindows
parameter_list|,
name|countReturn
parameter_list|)
name|Display
modifier|*
name|dpy
decl_stmt|;
name|Window
name|w
decl_stmt|;
name|Window
modifier|*
modifier|*
name|colormapWindows
decl_stmt|;
name|int
modifier|*
name|countReturn
decl_stmt|;
block|{
name|Atom
modifier|*
name|data
init|=
name|NULL
decl_stmt|;
name|Atom
name|actual_type
decl_stmt|;
name|Atom
name|prop
decl_stmt|;
name|int
name|actual_format
decl_stmt|;
name|unsigned
name|long
name|leftover
decl_stmt|,
name|nitems
decl_stmt|;
name|prop
operator|=
name|XInternAtom
argument_list|(
name|dpy
argument_list|,
literal|"WM_COLORMAP_WINDOWS"
argument_list|,
name|False
argument_list|)
expr_stmt|;
if|if
condition|(
name|prop
operator|==
name|None
condition|)
return|return
name|False
return|;
comment|/* get the property */
if|if
condition|(
name|XGetWindowProperty
argument_list|(
name|dpy
argument_list|,
name|w
argument_list|,
name|prop
argument_list|,
literal|0L
argument_list|,
literal|1000000L
argument_list|,
name|False
argument_list|,
name|XA_WINDOW
argument_list|,
operator|&
name|actual_type
argument_list|,
operator|&
name|actual_format
argument_list|,
operator|&
name|nitems
argument_list|,
operator|&
name|leftover
argument_list|,
operator|(
name|unsigned
name|char
operator|*
operator|*
operator|)
operator|&
name|data
argument_list|)
operator|!=
name|Success
condition|)
return|return
name|False
return|;
if|if
condition|(
name|actual_type
operator|!=
name|XA_WINDOW
operator|||
name|actual_format
operator|!=
literal|32
condition|)
block|{
if|if
condition|(
name|data
condition|)
name|Xfree
argument_list|(
operator|(
name|char
operator|*
operator|)
name|data
argument_list|)
expr_stmt|;
return|return
name|False
return|;
block|}
operator|*
name|colormapWindows
operator|=
operator|(
name|Window
operator|*
operator|)
name|data
expr_stmt|;
operator|*
name|countReturn
operator|=
operator|(
name|int
operator|)
name|nitems
expr_stmt|;
return|return
name|True
return|;
block|}
end_function

end_unit

