begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/**********************************************************************  *                          gost_keytrans.c                           *  *             Copyright (c) 2005-2006 Cryptocom LTD                  *  *         This file is distributed under the same license as OpenSSL *  *                                                                    *  *   ASN1 structure definition for GOST key transport                 *  *          Requires OpenSSL 0.9.9 for compilation                    *  **********************************************************************/
end_comment

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<openssl/asn1t.h>
end_include

begin_include
include|#
directive|include
file|<openssl/x509.h>
end_include

begin_include
include|#
directive|include
file|"gost_lcl.h"
end_include

begin_expr_stmt
name|ASN1_NDEF_SEQUENCE
argument_list|(
name|GOST_KEY_TRANSPORT
argument_list|)
operator|=
block|{
name|ASN1_SIMPLE
argument_list|(
name|GOST_KEY_TRANSPORT
argument_list|,
name|key_info
argument_list|,
name|GOST_KEY_INFO
argument_list|)
block|,
name|ASN1_IMP
argument_list|(
argument|GOST_KEY_TRANSPORT
argument_list|,
argument|key_agreement_info
argument_list|,
argument|GOST_KEY_AGREEMENT_INFO
argument_list|,
literal|0
argument_list|)
block|}
name|ASN1_NDEF_SEQUENCE_END
argument_list|(
argument|GOST_KEY_TRANSPORT
argument_list|)
name|IMPLEMENT_ASN1_FUNCTIONS
argument_list|(
argument|GOST_KEY_TRANSPORT
argument_list|)
name|ASN1_NDEF_SEQUENCE
argument_list|(
name|GOST_KEY_INFO
argument_list|)
operator|=
block|{
name|ASN1_SIMPLE
argument_list|(
name|GOST_KEY_INFO
argument_list|,
name|encrypted_key
argument_list|,
name|ASN1_OCTET_STRING
argument_list|)
block|,
name|ASN1_SIMPLE
argument_list|(
argument|GOST_KEY_INFO
argument_list|,
argument|imit
argument_list|,
argument|ASN1_OCTET_STRING
argument_list|)
block|}
name|ASN1_NDEF_SEQUENCE_END
argument_list|(
argument|GOST_KEY_INFO
argument_list|)
name|IMPLEMENT_ASN1_FUNCTIONS
argument_list|(
argument|GOST_KEY_INFO
argument_list|)
name|ASN1_NDEF_SEQUENCE
argument_list|(
name|GOST_KEY_AGREEMENT_INFO
argument_list|)
operator|=
block|{
name|ASN1_SIMPLE
argument_list|(
name|GOST_KEY_AGREEMENT_INFO
argument_list|,
name|cipher
argument_list|,
name|ASN1_OBJECT
argument_list|)
block|,
name|ASN1_IMP_OPT
argument_list|(
name|GOST_KEY_AGREEMENT_INFO
argument_list|,
name|ephem_key
argument_list|,
name|X509_PUBKEY
argument_list|,
literal|0
argument_list|)
block|,
name|ASN1_SIMPLE
argument_list|(
argument|GOST_KEY_AGREEMENT_INFO
argument_list|,
argument|eph_iv
argument_list|,
argument|ASN1_OCTET_STRING
argument_list|)
block|}
name|ASN1_NDEF_SEQUENCE_END
argument_list|(
argument|GOST_KEY_AGREEMENT_INFO
argument_list|)
name|IMPLEMENT_ASN1_FUNCTIONS
argument_list|(
argument|GOST_KEY_AGREEMENT_INFO
argument_list|)
name|ASN1_NDEF_SEQUENCE
argument_list|(
name|GOST_KEY_PARAMS
argument_list|)
operator|=
block|{
name|ASN1_SIMPLE
argument_list|(
name|GOST_KEY_PARAMS
argument_list|,
name|key_params
argument_list|,
name|ASN1_OBJECT
argument_list|)
block|,
name|ASN1_SIMPLE
argument_list|(
name|GOST_KEY_PARAMS
argument_list|,
name|hash_params
argument_list|,
name|ASN1_OBJECT
argument_list|)
block|,
name|ASN1_OPT
argument_list|(
name|GOST_KEY_PARAMS
argument_list|,
name|cipher_params
argument_list|,
name|ASN1_OBJECT
argument_list|)
block|, }
name|ASN1_NDEF_SEQUENCE_END
argument_list|(
argument|GOST_KEY_PARAMS
argument_list|)
name|IMPLEMENT_ASN1_FUNCTIONS
argument_list|(
argument|GOST_KEY_PARAMS
argument_list|)
name|ASN1_NDEF_SEQUENCE
argument_list|(
name|GOST_CIPHER_PARAMS
argument_list|)
operator|=
block|{
name|ASN1_SIMPLE
argument_list|(
name|GOST_CIPHER_PARAMS
argument_list|,
name|iv
argument_list|,
name|ASN1_OCTET_STRING
argument_list|)
block|,
name|ASN1_SIMPLE
argument_list|(
name|GOST_CIPHER_PARAMS
argument_list|,
name|enc_param_set
argument_list|,
name|ASN1_OBJECT
argument_list|)
block|, }
name|ASN1_NDEF_SEQUENCE_END
argument_list|(
argument|GOST_CIPHER_PARAMS
argument_list|)
name|IMPLEMENT_ASN1_FUNCTIONS
argument_list|(
argument|GOST_CIPHER_PARAMS
argument_list|)
name|ASN1_NDEF_SEQUENCE
argument_list|(
name|GOST_CLIENT_KEY_EXCHANGE_PARAMS
argument_list|)
operator|=
block|{
comment|/*FIXME incomplete*/
name|ASN1_SIMPLE
argument_list|(
argument|GOST_CLIENT_KEY_EXCHANGE_PARAMS
argument_list|,
argument|gkt
argument_list|,
argument|GOST_KEY_TRANSPORT
argument_list|)
block|}
name|ASN1_NDEF_SEQUENCE_END
argument_list|(
argument|GOST_CLIENT_KEY_EXCHANGE_PARAMS
argument_list|)
name|IMPLEMENT_ASN1_FUNCTIONS
argument_list|(
argument|GOST_CLIENT_KEY_EXCHANGE_PARAMS
argument_list|)
end_expr_stmt

end_unit

