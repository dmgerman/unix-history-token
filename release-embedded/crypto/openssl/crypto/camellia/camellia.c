begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* crypto/camellia/camellia.c -*- mode:C; c-file-style: "eay" -*- */
end_comment

begin_comment
comment|/* ====================================================================  * Copyright 2006 NTT (Nippon Telegraph and Telephone Corporation) .   * ALL RIGHTS RESERVED.  *  * Intellectual Property information for Camellia:  *     http://info.isl.ntt.co.jp/crypt/eng/info/chiteki.html  *  * News Release for Announcement of Camellia open source:  *     http://www.ntt.co.jp/news/news06e/0604/060413a.html  *  * The Camellia Code included herein is developed by  * NTT (Nippon Telegraph and Telephone Corporation), and is contributed  * to the OpenSSL project.  *  * The Camellia Code is licensed pursuant to the OpenSSL open source  * license provided below.  */
end_comment

begin_comment
comment|/* ====================================================================  * Copyright (c) 2006 The OpenSSL Project.  All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  *  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.   *  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in  *    the documentation and/or other materials provided with the  *    distribution.  *  * 3. All advertising materials mentioning features or use of this  *    software must display the following acknowledgment:  *    "This product includes software developed by the OpenSSL Project  *    for use in the OpenSSL Toolkit. (http://www.openssl.org/)"  *  * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to  *    endorse or promote products derived from this software without  *    prior written permission. For written permission, please contact  *    openssl-core@openssl.org.  *  * 5. Products derived from this software may not be called "OpenSSL"  *    nor may "OpenSSL" appear in their names without prior written  *    permission of the OpenSSL Project.  *  * 6. Redistributions of any form whatsoever must retain the following  *    acknowledgment:  *    "This product includes software developed by the OpenSSL Project  *    for use in the OpenSSL Toolkit (http://www.openssl.org/)"  *  * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY  * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR  * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,  * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT  * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;  * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED  * OF THE POSSIBILITY OF SUCH DAMAGE.  * ====================================================================  */
end_comment

begin_comment
comment|/* Algorithm Specification     http://info.isl.ntt.co.jp/crypt/eng/camellia/specifications.html */
end_comment

begin_comment
comment|/*  * This release balances code size and performance. In particular key  * schedule setup is fully unrolled, because doing so *significantly*  * reduces amount of instructions per setup round and code increase is  * justifiable. In block functions on the other hand only inner loops  * are unrolled, as full unroll gives only nominal performance boost,  * while code size grows 4 or 7 times. Also, unlike previous versions  * this one "encourages" compiler to keep intermediate variables in  * registers, which should give better "all round" results, in other  * words reasonable performance even with not so modern compilers.  */
end_comment

begin_include
include|#
directive|include
file|"camellia.h"
end_include

begin_include
include|#
directive|include
file|"cmll_locl.h"
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_comment
comment|/* 32-bit rotations */
end_comment

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|PEDANTIC
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_ASM
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|OPENSSL_NO_INLINE_ASM
argument_list|)
end_if

begin_if
if|#
directive|if
name|defined
argument_list|(
name|_MSC_VER
argument_list|)
operator|&&
operator|(
name|defined
argument_list|(
name|_M_IX86
argument_list|)
operator|||
name|defined
argument_list|(
name|_M_AMD64
argument_list|)
operator|||
name|defined
argument_list|(
name|_M_X64
argument_list|)
operator|)
end_if

begin_define
define|#
directive|define
name|RightRotate
parameter_list|(
name|x
parameter_list|,
name|s
parameter_list|)
value|_lrotr(x, s)
end_define

begin_define
define|#
directive|define
name|LeftRotate
parameter_list|(
name|x
parameter_list|,
name|s
parameter_list|)
value|_lrotl(x, s)
end_define

begin_if
if|#
directive|if
name|_MSC_VER
operator|>=
literal|1400
end_if

begin_define
define|#
directive|define
name|SWAP
parameter_list|(
name|x
parameter_list|)
value|_byteswap_ulong(x)
end_define

begin_else
else|#
directive|else
end_else

begin_define
define|#
directive|define
name|SWAP
parameter_list|(
name|x
parameter_list|)
value|(_lrotl(x, 8)& 0x00ff00ff | _lrotr(x, 8)& 0xff00ff00)
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_define
define|#
directive|define
name|GETU32
parameter_list|(
name|p
parameter_list|)
value|SWAP(*((u32 *)(p)))
end_define

begin_define
define|#
directive|define
name|PUTU32
parameter_list|(
name|p
parameter_list|,
name|v
parameter_list|)
value|(*((u32 *)(p)) = SWAP((v)))
end_define

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|__GNUC__
argument_list|)
operator|&&
name|__GNUC__
operator|>=
literal|2
end_elif

begin_if
if|#
directive|if
name|defined
argument_list|(
name|__i386
argument_list|)
operator|||
name|defined
argument_list|(
name|__x86_64
argument_list|)
end_if

begin_define
define|#
directive|define
name|RightRotate
parameter_list|(
name|x
parameter_list|,
name|s
parameter_list|)
value|({u32 ret; asm ("rorl %1,%0":"=r"(ret):"I"(s),"0"(x):"cc"); ret; })
end_define

begin_define
define|#
directive|define
name|LeftRotate
parameter_list|(
name|x
parameter_list|,
name|s
parameter_list|)
value|({u32 ret; asm ("roll %1,%0":"=r"(ret):"I"(s),"0"(x):"cc"); ret; })
end_define

begin_if
if|#
directive|if
name|defined
argument_list|(
name|B_ENDIAN
argument_list|)
end_if

begin_comment
comment|/* stratus.com does it */
end_comment

begin_define
define|#
directive|define
name|GETU32
parameter_list|(
name|p
parameter_list|)
value|(*(u32 *)(p))
end_define

begin_define
define|#
directive|define
name|PUTU32
parameter_list|(
name|p
parameter_list|,
name|v
parameter_list|)
value|(*(u32 *)(p)=(v))
end_define

begin_else
else|#
directive|else
end_else

begin_define
define|#
directive|define
name|GETU32
parameter_list|(
name|p
parameter_list|)
value|({u32 r=*(const u32 *)(p); asm("bswapl %0":"=r"(r):"0"(r)); r; })
end_define

begin_define
define|#
directive|define
name|PUTU32
parameter_list|(
name|p
parameter_list|,
name|v
parameter_list|)
value|({u32 r=(v); asm("bswapl %0":"=r"(r):"0"(r)); *(u32 *)(p)=r; })
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|_ARCH_PPC
argument_list|)
operator|||
name|defined
argument_list|(
name|_ARCH_PPC64
argument_list|)
operator|||
expr|\
name|defined
argument_list|(
name|__powerpc
argument_list|)
operator|||
name|defined
argument_list|(
name|__ppc__
argument_list|)
operator|||
name|defined
argument_list|(
name|__powerpc64__
argument_list|)
end_elif

begin_define
define|#
directive|define
name|LeftRotate
parameter_list|(
name|x
parameter_list|,
name|s
parameter_list|)
value|({u32 ret; asm ("rlwinm %0,%1,%2,0,31":"=r"(ret):"r"(x),"I"(s)); ret; })
end_define

begin_define
define|#
directive|define
name|RightRotate
parameter_list|(
name|x
parameter_list|,
name|s
parameter_list|)
value|LeftRotate(x,(32-s))
end_define

begin_elif
elif|#
directive|elif
name|defined
argument_list|(
name|__s390x__
argument_list|)
end_elif

begin_define
define|#
directive|define
name|LeftRotate
parameter_list|(
name|x
parameter_list|,
name|s
parameter_list|)
value|({u32 ret; asm ("rll %0,%1,%2":"=r"(ret):"r"(x),"I"(s)); ret; })
end_define

begin_define
define|#
directive|define
name|RightRotate
parameter_list|(
name|x
parameter_list|,
name|s
parameter_list|)
value|LeftRotate(x,(32-s))
end_define

begin_define
define|#
directive|define
name|GETU32
parameter_list|(
name|p
parameter_list|)
value|(*(u32 *)(p))
end_define

begin_define
define|#
directive|define
name|PUTU32
parameter_list|(
name|p
parameter_list|,
name|v
parameter_list|)
value|(*(u32 *)(p)=(v))
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|RightRotate
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|LeftRotate
argument_list|)
end_if

begin_define
define|#
directive|define
name|RightRotate
parameter_list|(
name|x
parameter_list|,
name|s
parameter_list|)
value|( ((x)>> (s)) + ((x)<< (32 - s)) )
end_define

begin_define
define|#
directive|define
name|LeftRotate
parameter_list|(
name|x
parameter_list|,
name|s
parameter_list|)
value|( ((x)<< (s)) + ((x)>> (32 - s)) )
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|GETU32
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|PUTU32
argument_list|)
end_if

begin_define
define|#
directive|define
name|GETU32
parameter_list|(
name|p
parameter_list|)
value|(((u32)(p)[0]<< 24) ^ ((u32)(p)[1]<< 16) ^ ((u32)(p)[2]<<  8) ^ ((u32)(p)[3]))
end_define

begin_define
define|#
directive|define
name|PUTU32
parameter_list|(
name|p
parameter_list|,
name|v
parameter_list|)
value|((p)[0] = (u8)((v)>> 24), (p)[1] = (u8)((v)>> 16), (p)[2] = (u8)((v)>>  8), (p)[3] = (u8)(v))
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* S-box data */
end_comment

begin_define
define|#
directive|define
name|SBOX1_1110
value|Camellia_SBOX[0]
end_define

begin_define
define|#
directive|define
name|SBOX4_4404
value|Camellia_SBOX[1]
end_define

begin_define
define|#
directive|define
name|SBOX2_0222
value|Camellia_SBOX[2]
end_define

begin_define
define|#
directive|define
name|SBOX3_3033
value|Camellia_SBOX[3]
end_define

begin_decl_stmt
specifier|static
specifier|const
name|u32
name|Camellia_SBOX
index|[]
index|[
literal|256
index|]
init|=
block|{
block|{
literal|0x70707000
block|,
literal|0x82828200
block|,
literal|0x2c2c2c00
block|,
literal|0xececec00
block|,
literal|0xb3b3b300
block|,
literal|0x27272700
block|,
literal|0xc0c0c000
block|,
literal|0xe5e5e500
block|,
literal|0xe4e4e400
block|,
literal|0x85858500
block|,
literal|0x57575700
block|,
literal|0x35353500
block|,
literal|0xeaeaea00
block|,
literal|0x0c0c0c00
block|,
literal|0xaeaeae00
block|,
literal|0x41414100
block|,
literal|0x23232300
block|,
literal|0xefefef00
block|,
literal|0x6b6b6b00
block|,
literal|0x93939300
block|,
literal|0x45454500
block|,
literal|0x19191900
block|,
literal|0xa5a5a500
block|,
literal|0x21212100
block|,
literal|0xededed00
block|,
literal|0x0e0e0e00
block|,
literal|0x4f4f4f00
block|,
literal|0x4e4e4e00
block|,
literal|0x1d1d1d00
block|,
literal|0x65656500
block|,
literal|0x92929200
block|,
literal|0xbdbdbd00
block|,
literal|0x86868600
block|,
literal|0xb8b8b800
block|,
literal|0xafafaf00
block|,
literal|0x8f8f8f00
block|,
literal|0x7c7c7c00
block|,
literal|0xebebeb00
block|,
literal|0x1f1f1f00
block|,
literal|0xcecece00
block|,
literal|0x3e3e3e00
block|,
literal|0x30303000
block|,
literal|0xdcdcdc00
block|,
literal|0x5f5f5f00
block|,
literal|0x5e5e5e00
block|,
literal|0xc5c5c500
block|,
literal|0x0b0b0b00
block|,
literal|0x1a1a1a00
block|,
literal|0xa6a6a600
block|,
literal|0xe1e1e100
block|,
literal|0x39393900
block|,
literal|0xcacaca00
block|,
literal|0xd5d5d500
block|,
literal|0x47474700
block|,
literal|0x5d5d5d00
block|,
literal|0x3d3d3d00
block|,
literal|0xd9d9d900
block|,
literal|0x01010100
block|,
literal|0x5a5a5a00
block|,
literal|0xd6d6d600
block|,
literal|0x51515100
block|,
literal|0x56565600
block|,
literal|0x6c6c6c00
block|,
literal|0x4d4d4d00
block|,
literal|0x8b8b8b00
block|,
literal|0x0d0d0d00
block|,
literal|0x9a9a9a00
block|,
literal|0x66666600
block|,
literal|0xfbfbfb00
block|,
literal|0xcccccc00
block|,
literal|0xb0b0b000
block|,
literal|0x2d2d2d00
block|,
literal|0x74747400
block|,
literal|0x12121200
block|,
literal|0x2b2b2b00
block|,
literal|0x20202000
block|,
literal|0xf0f0f000
block|,
literal|0xb1b1b100
block|,
literal|0x84848400
block|,
literal|0x99999900
block|,
literal|0xdfdfdf00
block|,
literal|0x4c4c4c00
block|,
literal|0xcbcbcb00
block|,
literal|0xc2c2c200
block|,
literal|0x34343400
block|,
literal|0x7e7e7e00
block|,
literal|0x76767600
block|,
literal|0x05050500
block|,
literal|0x6d6d6d00
block|,
literal|0xb7b7b700
block|,
literal|0xa9a9a900
block|,
literal|0x31313100
block|,
literal|0xd1d1d100
block|,
literal|0x17171700
block|,
literal|0x04040400
block|,
literal|0xd7d7d700
block|,
literal|0x14141400
block|,
literal|0x58585800
block|,
literal|0x3a3a3a00
block|,
literal|0x61616100
block|,
literal|0xdedede00
block|,
literal|0x1b1b1b00
block|,
literal|0x11111100
block|,
literal|0x1c1c1c00
block|,
literal|0x32323200
block|,
literal|0x0f0f0f00
block|,
literal|0x9c9c9c00
block|,
literal|0x16161600
block|,
literal|0x53535300
block|,
literal|0x18181800
block|,
literal|0xf2f2f200
block|,
literal|0x22222200
block|,
literal|0xfefefe00
block|,
literal|0x44444400
block|,
literal|0xcfcfcf00
block|,
literal|0xb2b2b200
block|,
literal|0xc3c3c300
block|,
literal|0xb5b5b500
block|,
literal|0x7a7a7a00
block|,
literal|0x91919100
block|,
literal|0x24242400
block|,
literal|0x08080800
block|,
literal|0xe8e8e800
block|,
literal|0xa8a8a800
block|,
literal|0x60606000
block|,
literal|0xfcfcfc00
block|,
literal|0x69696900
block|,
literal|0x50505000
block|,
literal|0xaaaaaa00
block|,
literal|0xd0d0d000
block|,
literal|0xa0a0a000
block|,
literal|0x7d7d7d00
block|,
literal|0xa1a1a100
block|,
literal|0x89898900
block|,
literal|0x62626200
block|,
literal|0x97979700
block|,
literal|0x54545400
block|,
literal|0x5b5b5b00
block|,
literal|0x1e1e1e00
block|,
literal|0x95959500
block|,
literal|0xe0e0e000
block|,
literal|0xffffff00
block|,
literal|0x64646400
block|,
literal|0xd2d2d200
block|,
literal|0x10101000
block|,
literal|0xc4c4c400
block|,
literal|0x00000000
block|,
literal|0x48484800
block|,
literal|0xa3a3a300
block|,
literal|0xf7f7f700
block|,
literal|0x75757500
block|,
literal|0xdbdbdb00
block|,
literal|0x8a8a8a00
block|,
literal|0x03030300
block|,
literal|0xe6e6e600
block|,
literal|0xdadada00
block|,
literal|0x09090900
block|,
literal|0x3f3f3f00
block|,
literal|0xdddddd00
block|,
literal|0x94949400
block|,
literal|0x87878700
block|,
literal|0x5c5c5c00
block|,
literal|0x83838300
block|,
literal|0x02020200
block|,
literal|0xcdcdcd00
block|,
literal|0x4a4a4a00
block|,
literal|0x90909000
block|,
literal|0x33333300
block|,
literal|0x73737300
block|,
literal|0x67676700
block|,
literal|0xf6f6f600
block|,
literal|0xf3f3f300
block|,
literal|0x9d9d9d00
block|,
literal|0x7f7f7f00
block|,
literal|0xbfbfbf00
block|,
literal|0xe2e2e200
block|,
literal|0x52525200
block|,
literal|0x9b9b9b00
block|,
literal|0xd8d8d800
block|,
literal|0x26262600
block|,
literal|0xc8c8c800
block|,
literal|0x37373700
block|,
literal|0xc6c6c600
block|,
literal|0x3b3b3b00
block|,
literal|0x81818100
block|,
literal|0x96969600
block|,
literal|0x6f6f6f00
block|,
literal|0x4b4b4b00
block|,
literal|0x13131300
block|,
literal|0xbebebe00
block|,
literal|0x63636300
block|,
literal|0x2e2e2e00
block|,
literal|0xe9e9e900
block|,
literal|0x79797900
block|,
literal|0xa7a7a700
block|,
literal|0x8c8c8c00
block|,
literal|0x9f9f9f00
block|,
literal|0x6e6e6e00
block|,
literal|0xbcbcbc00
block|,
literal|0x8e8e8e00
block|,
literal|0x29292900
block|,
literal|0xf5f5f500
block|,
literal|0xf9f9f900
block|,
literal|0xb6b6b600
block|,
literal|0x2f2f2f00
block|,
literal|0xfdfdfd00
block|,
literal|0xb4b4b400
block|,
literal|0x59595900
block|,
literal|0x78787800
block|,
literal|0x98989800
block|,
literal|0x06060600
block|,
literal|0x6a6a6a00
block|,
literal|0xe7e7e700
block|,
literal|0x46464600
block|,
literal|0x71717100
block|,
literal|0xbababa00
block|,
literal|0xd4d4d400
block|,
literal|0x25252500
block|,
literal|0xababab00
block|,
literal|0x42424200
block|,
literal|0x88888800
block|,
literal|0xa2a2a200
block|,
literal|0x8d8d8d00
block|,
literal|0xfafafa00
block|,
literal|0x72727200
block|,
literal|0x07070700
block|,
literal|0xb9b9b900
block|,
literal|0x55555500
block|,
literal|0xf8f8f800
block|,
literal|0xeeeeee00
block|,
literal|0xacacac00
block|,
literal|0x0a0a0a00
block|,
literal|0x36363600
block|,
literal|0x49494900
block|,
literal|0x2a2a2a00
block|,
literal|0x68686800
block|,
literal|0x3c3c3c00
block|,
literal|0x38383800
block|,
literal|0xf1f1f100
block|,
literal|0xa4a4a400
block|,
literal|0x40404000
block|,
literal|0x28282800
block|,
literal|0xd3d3d300
block|,
literal|0x7b7b7b00
block|,
literal|0xbbbbbb00
block|,
literal|0xc9c9c900
block|,
literal|0x43434300
block|,
literal|0xc1c1c100
block|,
literal|0x15151500
block|,
literal|0xe3e3e300
block|,
literal|0xadadad00
block|,
literal|0xf4f4f400
block|,
literal|0x77777700
block|,
literal|0xc7c7c700
block|,
literal|0x80808000
block|,
literal|0x9e9e9e00
block|}
block|,
block|{
literal|0x70700070
block|,
literal|0x2c2c002c
block|,
literal|0xb3b300b3
block|,
literal|0xc0c000c0
block|,
literal|0xe4e400e4
block|,
literal|0x57570057
block|,
literal|0xeaea00ea
block|,
literal|0xaeae00ae
block|,
literal|0x23230023
block|,
literal|0x6b6b006b
block|,
literal|0x45450045
block|,
literal|0xa5a500a5
block|,
literal|0xeded00ed
block|,
literal|0x4f4f004f
block|,
literal|0x1d1d001d
block|,
literal|0x92920092
block|,
literal|0x86860086
block|,
literal|0xafaf00af
block|,
literal|0x7c7c007c
block|,
literal|0x1f1f001f
block|,
literal|0x3e3e003e
block|,
literal|0xdcdc00dc
block|,
literal|0x5e5e005e
block|,
literal|0x0b0b000b
block|,
literal|0xa6a600a6
block|,
literal|0x39390039
block|,
literal|0xd5d500d5
block|,
literal|0x5d5d005d
block|,
literal|0xd9d900d9
block|,
literal|0x5a5a005a
block|,
literal|0x51510051
block|,
literal|0x6c6c006c
block|,
literal|0x8b8b008b
block|,
literal|0x9a9a009a
block|,
literal|0xfbfb00fb
block|,
literal|0xb0b000b0
block|,
literal|0x74740074
block|,
literal|0x2b2b002b
block|,
literal|0xf0f000f0
block|,
literal|0x84840084
block|,
literal|0xdfdf00df
block|,
literal|0xcbcb00cb
block|,
literal|0x34340034
block|,
literal|0x76760076
block|,
literal|0x6d6d006d
block|,
literal|0xa9a900a9
block|,
literal|0xd1d100d1
block|,
literal|0x04040004
block|,
literal|0x14140014
block|,
literal|0x3a3a003a
block|,
literal|0xdede00de
block|,
literal|0x11110011
block|,
literal|0x32320032
block|,
literal|0x9c9c009c
block|,
literal|0x53530053
block|,
literal|0xf2f200f2
block|,
literal|0xfefe00fe
block|,
literal|0xcfcf00cf
block|,
literal|0xc3c300c3
block|,
literal|0x7a7a007a
block|,
literal|0x24240024
block|,
literal|0xe8e800e8
block|,
literal|0x60600060
block|,
literal|0x69690069
block|,
literal|0xaaaa00aa
block|,
literal|0xa0a000a0
block|,
literal|0xa1a100a1
block|,
literal|0x62620062
block|,
literal|0x54540054
block|,
literal|0x1e1e001e
block|,
literal|0xe0e000e0
block|,
literal|0x64640064
block|,
literal|0x10100010
block|,
literal|0x00000000
block|,
literal|0xa3a300a3
block|,
literal|0x75750075
block|,
literal|0x8a8a008a
block|,
literal|0xe6e600e6
block|,
literal|0x09090009
block|,
literal|0xdddd00dd
block|,
literal|0x87870087
block|,
literal|0x83830083
block|,
literal|0xcdcd00cd
block|,
literal|0x90900090
block|,
literal|0x73730073
block|,
literal|0xf6f600f6
block|,
literal|0x9d9d009d
block|,
literal|0xbfbf00bf
block|,
literal|0x52520052
block|,
literal|0xd8d800d8
block|,
literal|0xc8c800c8
block|,
literal|0xc6c600c6
block|,
literal|0x81810081
block|,
literal|0x6f6f006f
block|,
literal|0x13130013
block|,
literal|0x63630063
block|,
literal|0xe9e900e9
block|,
literal|0xa7a700a7
block|,
literal|0x9f9f009f
block|,
literal|0xbcbc00bc
block|,
literal|0x29290029
block|,
literal|0xf9f900f9
block|,
literal|0x2f2f002f
block|,
literal|0xb4b400b4
block|,
literal|0x78780078
block|,
literal|0x06060006
block|,
literal|0xe7e700e7
block|,
literal|0x71710071
block|,
literal|0xd4d400d4
block|,
literal|0xabab00ab
block|,
literal|0x88880088
block|,
literal|0x8d8d008d
block|,
literal|0x72720072
block|,
literal|0xb9b900b9
block|,
literal|0xf8f800f8
block|,
literal|0xacac00ac
block|,
literal|0x36360036
block|,
literal|0x2a2a002a
block|,
literal|0x3c3c003c
block|,
literal|0xf1f100f1
block|,
literal|0x40400040
block|,
literal|0xd3d300d3
block|,
literal|0xbbbb00bb
block|,
literal|0x43430043
block|,
literal|0x15150015
block|,
literal|0xadad00ad
block|,
literal|0x77770077
block|,
literal|0x80800080
block|,
literal|0x82820082
block|,
literal|0xecec00ec
block|,
literal|0x27270027
block|,
literal|0xe5e500e5
block|,
literal|0x85850085
block|,
literal|0x35350035
block|,
literal|0x0c0c000c
block|,
literal|0x41410041
block|,
literal|0xefef00ef
block|,
literal|0x93930093
block|,
literal|0x19190019
block|,
literal|0x21210021
block|,
literal|0x0e0e000e
block|,
literal|0x4e4e004e
block|,
literal|0x65650065
block|,
literal|0xbdbd00bd
block|,
literal|0xb8b800b8
block|,
literal|0x8f8f008f
block|,
literal|0xebeb00eb
block|,
literal|0xcece00ce
block|,
literal|0x30300030
block|,
literal|0x5f5f005f
block|,
literal|0xc5c500c5
block|,
literal|0x1a1a001a
block|,
literal|0xe1e100e1
block|,
literal|0xcaca00ca
block|,
literal|0x47470047
block|,
literal|0x3d3d003d
block|,
literal|0x01010001
block|,
literal|0xd6d600d6
block|,
literal|0x56560056
block|,
literal|0x4d4d004d
block|,
literal|0x0d0d000d
block|,
literal|0x66660066
block|,
literal|0xcccc00cc
block|,
literal|0x2d2d002d
block|,
literal|0x12120012
block|,
literal|0x20200020
block|,
literal|0xb1b100b1
block|,
literal|0x99990099
block|,
literal|0x4c4c004c
block|,
literal|0xc2c200c2
block|,
literal|0x7e7e007e
block|,
literal|0x05050005
block|,
literal|0xb7b700b7
block|,
literal|0x31310031
block|,
literal|0x17170017
block|,
literal|0xd7d700d7
block|,
literal|0x58580058
block|,
literal|0x61610061
block|,
literal|0x1b1b001b
block|,
literal|0x1c1c001c
block|,
literal|0x0f0f000f
block|,
literal|0x16160016
block|,
literal|0x18180018
block|,
literal|0x22220022
block|,
literal|0x44440044
block|,
literal|0xb2b200b2
block|,
literal|0xb5b500b5
block|,
literal|0x91910091
block|,
literal|0x08080008
block|,
literal|0xa8a800a8
block|,
literal|0xfcfc00fc
block|,
literal|0x50500050
block|,
literal|0xd0d000d0
block|,
literal|0x7d7d007d
block|,
literal|0x89890089
block|,
literal|0x97970097
block|,
literal|0x5b5b005b
block|,
literal|0x95950095
block|,
literal|0xffff00ff
block|,
literal|0xd2d200d2
block|,
literal|0xc4c400c4
block|,
literal|0x48480048
block|,
literal|0xf7f700f7
block|,
literal|0xdbdb00db
block|,
literal|0x03030003
block|,
literal|0xdada00da
block|,
literal|0x3f3f003f
block|,
literal|0x94940094
block|,
literal|0x5c5c005c
block|,
literal|0x02020002
block|,
literal|0x4a4a004a
block|,
literal|0x33330033
block|,
literal|0x67670067
block|,
literal|0xf3f300f3
block|,
literal|0x7f7f007f
block|,
literal|0xe2e200e2
block|,
literal|0x9b9b009b
block|,
literal|0x26260026
block|,
literal|0x37370037
block|,
literal|0x3b3b003b
block|,
literal|0x96960096
block|,
literal|0x4b4b004b
block|,
literal|0xbebe00be
block|,
literal|0x2e2e002e
block|,
literal|0x79790079
block|,
literal|0x8c8c008c
block|,
literal|0x6e6e006e
block|,
literal|0x8e8e008e
block|,
literal|0xf5f500f5
block|,
literal|0xb6b600b6
block|,
literal|0xfdfd00fd
block|,
literal|0x59590059
block|,
literal|0x98980098
block|,
literal|0x6a6a006a
block|,
literal|0x46460046
block|,
literal|0xbaba00ba
block|,
literal|0x25250025
block|,
literal|0x42420042
block|,
literal|0xa2a200a2
block|,
literal|0xfafa00fa
block|,
literal|0x07070007
block|,
literal|0x55550055
block|,
literal|0xeeee00ee
block|,
literal|0x0a0a000a
block|,
literal|0x49490049
block|,
literal|0x68680068
block|,
literal|0x38380038
block|,
literal|0xa4a400a4
block|,
literal|0x28280028
block|,
literal|0x7b7b007b
block|,
literal|0xc9c900c9
block|,
literal|0xc1c100c1
block|,
literal|0xe3e300e3
block|,
literal|0xf4f400f4
block|,
literal|0xc7c700c7
block|,
literal|0x9e9e009e
block|}
block|,
block|{
literal|0x00e0e0e0
block|,
literal|0x00050505
block|,
literal|0x00585858
block|,
literal|0x00d9d9d9
block|,
literal|0x00676767
block|,
literal|0x004e4e4e
block|,
literal|0x00818181
block|,
literal|0x00cbcbcb
block|,
literal|0x00c9c9c9
block|,
literal|0x000b0b0b
block|,
literal|0x00aeaeae
block|,
literal|0x006a6a6a
block|,
literal|0x00d5d5d5
block|,
literal|0x00181818
block|,
literal|0x005d5d5d
block|,
literal|0x00828282
block|,
literal|0x00464646
block|,
literal|0x00dfdfdf
block|,
literal|0x00d6d6d6
block|,
literal|0x00272727
block|,
literal|0x008a8a8a
block|,
literal|0x00323232
block|,
literal|0x004b4b4b
block|,
literal|0x00424242
block|,
literal|0x00dbdbdb
block|,
literal|0x001c1c1c
block|,
literal|0x009e9e9e
block|,
literal|0x009c9c9c
block|,
literal|0x003a3a3a
block|,
literal|0x00cacaca
block|,
literal|0x00252525
block|,
literal|0x007b7b7b
block|,
literal|0x000d0d0d
block|,
literal|0x00717171
block|,
literal|0x005f5f5f
block|,
literal|0x001f1f1f
block|,
literal|0x00f8f8f8
block|,
literal|0x00d7d7d7
block|,
literal|0x003e3e3e
block|,
literal|0x009d9d9d
block|,
literal|0x007c7c7c
block|,
literal|0x00606060
block|,
literal|0x00b9b9b9
block|,
literal|0x00bebebe
block|,
literal|0x00bcbcbc
block|,
literal|0x008b8b8b
block|,
literal|0x00161616
block|,
literal|0x00343434
block|,
literal|0x004d4d4d
block|,
literal|0x00c3c3c3
block|,
literal|0x00727272
block|,
literal|0x00959595
block|,
literal|0x00ababab
block|,
literal|0x008e8e8e
block|,
literal|0x00bababa
block|,
literal|0x007a7a7a
block|,
literal|0x00b3b3b3
block|,
literal|0x00020202
block|,
literal|0x00b4b4b4
block|,
literal|0x00adadad
block|,
literal|0x00a2a2a2
block|,
literal|0x00acacac
block|,
literal|0x00d8d8d8
block|,
literal|0x009a9a9a
block|,
literal|0x00171717
block|,
literal|0x001a1a1a
block|,
literal|0x00353535
block|,
literal|0x00cccccc
block|,
literal|0x00f7f7f7
block|,
literal|0x00999999
block|,
literal|0x00616161
block|,
literal|0x005a5a5a
block|,
literal|0x00e8e8e8
block|,
literal|0x00242424
block|,
literal|0x00565656
block|,
literal|0x00404040
block|,
literal|0x00e1e1e1
block|,
literal|0x00636363
block|,
literal|0x00090909
block|,
literal|0x00333333
block|,
literal|0x00bfbfbf
block|,
literal|0x00989898
block|,
literal|0x00979797
block|,
literal|0x00858585
block|,
literal|0x00686868
block|,
literal|0x00fcfcfc
block|,
literal|0x00ececec
block|,
literal|0x000a0a0a
block|,
literal|0x00dadada
block|,
literal|0x006f6f6f
block|,
literal|0x00535353
block|,
literal|0x00626262
block|,
literal|0x00a3a3a3
block|,
literal|0x002e2e2e
block|,
literal|0x00080808
block|,
literal|0x00afafaf
block|,
literal|0x00282828
block|,
literal|0x00b0b0b0
block|,
literal|0x00747474
block|,
literal|0x00c2c2c2
block|,
literal|0x00bdbdbd
block|,
literal|0x00363636
block|,
literal|0x00222222
block|,
literal|0x00383838
block|,
literal|0x00646464
block|,
literal|0x001e1e1e
block|,
literal|0x00393939
block|,
literal|0x002c2c2c
block|,
literal|0x00a6a6a6
block|,
literal|0x00303030
block|,
literal|0x00e5e5e5
block|,
literal|0x00444444
block|,
literal|0x00fdfdfd
block|,
literal|0x00888888
block|,
literal|0x009f9f9f
block|,
literal|0x00656565
block|,
literal|0x00878787
block|,
literal|0x006b6b6b
block|,
literal|0x00f4f4f4
block|,
literal|0x00232323
block|,
literal|0x00484848
block|,
literal|0x00101010
block|,
literal|0x00d1d1d1
block|,
literal|0x00515151
block|,
literal|0x00c0c0c0
block|,
literal|0x00f9f9f9
block|,
literal|0x00d2d2d2
block|,
literal|0x00a0a0a0
block|,
literal|0x00555555
block|,
literal|0x00a1a1a1
block|,
literal|0x00414141
block|,
literal|0x00fafafa
block|,
literal|0x00434343
block|,
literal|0x00131313
block|,
literal|0x00c4c4c4
block|,
literal|0x002f2f2f
block|,
literal|0x00a8a8a8
block|,
literal|0x00b6b6b6
block|,
literal|0x003c3c3c
block|,
literal|0x002b2b2b
block|,
literal|0x00c1c1c1
block|,
literal|0x00ffffff
block|,
literal|0x00c8c8c8
block|,
literal|0x00a5a5a5
block|,
literal|0x00202020
block|,
literal|0x00898989
block|,
literal|0x00000000
block|,
literal|0x00909090
block|,
literal|0x00474747
block|,
literal|0x00efefef
block|,
literal|0x00eaeaea
block|,
literal|0x00b7b7b7
block|,
literal|0x00151515
block|,
literal|0x00060606
block|,
literal|0x00cdcdcd
block|,
literal|0x00b5b5b5
block|,
literal|0x00121212
block|,
literal|0x007e7e7e
block|,
literal|0x00bbbbbb
block|,
literal|0x00292929
block|,
literal|0x000f0f0f
block|,
literal|0x00b8b8b8
block|,
literal|0x00070707
block|,
literal|0x00040404
block|,
literal|0x009b9b9b
block|,
literal|0x00949494
block|,
literal|0x00212121
block|,
literal|0x00666666
block|,
literal|0x00e6e6e6
block|,
literal|0x00cecece
block|,
literal|0x00ededed
block|,
literal|0x00e7e7e7
block|,
literal|0x003b3b3b
block|,
literal|0x00fefefe
block|,
literal|0x007f7f7f
block|,
literal|0x00c5c5c5
block|,
literal|0x00a4a4a4
block|,
literal|0x00373737
block|,
literal|0x00b1b1b1
block|,
literal|0x004c4c4c
block|,
literal|0x00919191
block|,
literal|0x006e6e6e
block|,
literal|0x008d8d8d
block|,
literal|0x00767676
block|,
literal|0x00030303
block|,
literal|0x002d2d2d
block|,
literal|0x00dedede
block|,
literal|0x00969696
block|,
literal|0x00262626
block|,
literal|0x007d7d7d
block|,
literal|0x00c6c6c6
block|,
literal|0x005c5c5c
block|,
literal|0x00d3d3d3
block|,
literal|0x00f2f2f2
block|,
literal|0x004f4f4f
block|,
literal|0x00191919
block|,
literal|0x003f3f3f
block|,
literal|0x00dcdcdc
block|,
literal|0x00797979
block|,
literal|0x001d1d1d
block|,
literal|0x00525252
block|,
literal|0x00ebebeb
block|,
literal|0x00f3f3f3
block|,
literal|0x006d6d6d
block|,
literal|0x005e5e5e
block|,
literal|0x00fbfbfb
block|,
literal|0x00696969
block|,
literal|0x00b2b2b2
block|,
literal|0x00f0f0f0
block|,
literal|0x00313131
block|,
literal|0x000c0c0c
block|,
literal|0x00d4d4d4
block|,
literal|0x00cfcfcf
block|,
literal|0x008c8c8c
block|,
literal|0x00e2e2e2
block|,
literal|0x00757575
block|,
literal|0x00a9a9a9
block|,
literal|0x004a4a4a
block|,
literal|0x00575757
block|,
literal|0x00848484
block|,
literal|0x00111111
block|,
literal|0x00454545
block|,
literal|0x001b1b1b
block|,
literal|0x00f5f5f5
block|,
literal|0x00e4e4e4
block|,
literal|0x000e0e0e
block|,
literal|0x00737373
block|,
literal|0x00aaaaaa
block|,
literal|0x00f1f1f1
block|,
literal|0x00dddddd
block|,
literal|0x00595959
block|,
literal|0x00141414
block|,
literal|0x006c6c6c
block|,
literal|0x00929292
block|,
literal|0x00545454
block|,
literal|0x00d0d0d0
block|,
literal|0x00787878
block|,
literal|0x00707070
block|,
literal|0x00e3e3e3
block|,
literal|0x00494949
block|,
literal|0x00808080
block|,
literal|0x00505050
block|,
literal|0x00a7a7a7
block|,
literal|0x00f6f6f6
block|,
literal|0x00777777
block|,
literal|0x00939393
block|,
literal|0x00868686
block|,
literal|0x00838383
block|,
literal|0x002a2a2a
block|,
literal|0x00c7c7c7
block|,
literal|0x005b5b5b
block|,
literal|0x00e9e9e9
block|,
literal|0x00eeeeee
block|,
literal|0x008f8f8f
block|,
literal|0x00010101
block|,
literal|0x003d3d3d
block|}
block|,
block|{
literal|0x38003838
block|,
literal|0x41004141
block|,
literal|0x16001616
block|,
literal|0x76007676
block|,
literal|0xd900d9d9
block|,
literal|0x93009393
block|,
literal|0x60006060
block|,
literal|0xf200f2f2
block|,
literal|0x72007272
block|,
literal|0xc200c2c2
block|,
literal|0xab00abab
block|,
literal|0x9a009a9a
block|,
literal|0x75007575
block|,
literal|0x06000606
block|,
literal|0x57005757
block|,
literal|0xa000a0a0
block|,
literal|0x91009191
block|,
literal|0xf700f7f7
block|,
literal|0xb500b5b5
block|,
literal|0xc900c9c9
block|,
literal|0xa200a2a2
block|,
literal|0x8c008c8c
block|,
literal|0xd200d2d2
block|,
literal|0x90009090
block|,
literal|0xf600f6f6
block|,
literal|0x07000707
block|,
literal|0xa700a7a7
block|,
literal|0x27002727
block|,
literal|0x8e008e8e
block|,
literal|0xb200b2b2
block|,
literal|0x49004949
block|,
literal|0xde00dede
block|,
literal|0x43004343
block|,
literal|0x5c005c5c
block|,
literal|0xd700d7d7
block|,
literal|0xc700c7c7
block|,
literal|0x3e003e3e
block|,
literal|0xf500f5f5
block|,
literal|0x8f008f8f
block|,
literal|0x67006767
block|,
literal|0x1f001f1f
block|,
literal|0x18001818
block|,
literal|0x6e006e6e
block|,
literal|0xaf00afaf
block|,
literal|0x2f002f2f
block|,
literal|0xe200e2e2
block|,
literal|0x85008585
block|,
literal|0x0d000d0d
block|,
literal|0x53005353
block|,
literal|0xf000f0f0
block|,
literal|0x9c009c9c
block|,
literal|0x65006565
block|,
literal|0xea00eaea
block|,
literal|0xa300a3a3
block|,
literal|0xae00aeae
block|,
literal|0x9e009e9e
block|,
literal|0xec00ecec
block|,
literal|0x80008080
block|,
literal|0x2d002d2d
block|,
literal|0x6b006b6b
block|,
literal|0xa800a8a8
block|,
literal|0x2b002b2b
block|,
literal|0x36003636
block|,
literal|0xa600a6a6
block|,
literal|0xc500c5c5
block|,
literal|0x86008686
block|,
literal|0x4d004d4d
block|,
literal|0x33003333
block|,
literal|0xfd00fdfd
block|,
literal|0x66006666
block|,
literal|0x58005858
block|,
literal|0x96009696
block|,
literal|0x3a003a3a
block|,
literal|0x09000909
block|,
literal|0x95009595
block|,
literal|0x10001010
block|,
literal|0x78007878
block|,
literal|0xd800d8d8
block|,
literal|0x42004242
block|,
literal|0xcc00cccc
block|,
literal|0xef00efef
block|,
literal|0x26002626
block|,
literal|0xe500e5e5
block|,
literal|0x61006161
block|,
literal|0x1a001a1a
block|,
literal|0x3f003f3f
block|,
literal|0x3b003b3b
block|,
literal|0x82008282
block|,
literal|0xb600b6b6
block|,
literal|0xdb00dbdb
block|,
literal|0xd400d4d4
block|,
literal|0x98009898
block|,
literal|0xe800e8e8
block|,
literal|0x8b008b8b
block|,
literal|0x02000202
block|,
literal|0xeb00ebeb
block|,
literal|0x0a000a0a
block|,
literal|0x2c002c2c
block|,
literal|0x1d001d1d
block|,
literal|0xb000b0b0
block|,
literal|0x6f006f6f
block|,
literal|0x8d008d8d
block|,
literal|0x88008888
block|,
literal|0x0e000e0e
block|,
literal|0x19001919
block|,
literal|0x87008787
block|,
literal|0x4e004e4e
block|,
literal|0x0b000b0b
block|,
literal|0xa900a9a9
block|,
literal|0x0c000c0c
block|,
literal|0x79007979
block|,
literal|0x11001111
block|,
literal|0x7f007f7f
block|,
literal|0x22002222
block|,
literal|0xe700e7e7
block|,
literal|0x59005959
block|,
literal|0xe100e1e1
block|,
literal|0xda00dada
block|,
literal|0x3d003d3d
block|,
literal|0xc800c8c8
block|,
literal|0x12001212
block|,
literal|0x04000404
block|,
literal|0x74007474
block|,
literal|0x54005454
block|,
literal|0x30003030
block|,
literal|0x7e007e7e
block|,
literal|0xb400b4b4
block|,
literal|0x28002828
block|,
literal|0x55005555
block|,
literal|0x68006868
block|,
literal|0x50005050
block|,
literal|0xbe00bebe
block|,
literal|0xd000d0d0
block|,
literal|0xc400c4c4
block|,
literal|0x31003131
block|,
literal|0xcb00cbcb
block|,
literal|0x2a002a2a
block|,
literal|0xad00adad
block|,
literal|0x0f000f0f
block|,
literal|0xca00caca
block|,
literal|0x70007070
block|,
literal|0xff00ffff
block|,
literal|0x32003232
block|,
literal|0x69006969
block|,
literal|0x08000808
block|,
literal|0x62006262
block|,
literal|0x00000000
block|,
literal|0x24002424
block|,
literal|0xd100d1d1
block|,
literal|0xfb00fbfb
block|,
literal|0xba00baba
block|,
literal|0xed00eded
block|,
literal|0x45004545
block|,
literal|0x81008181
block|,
literal|0x73007373
block|,
literal|0x6d006d6d
block|,
literal|0x84008484
block|,
literal|0x9f009f9f
block|,
literal|0xee00eeee
block|,
literal|0x4a004a4a
block|,
literal|0xc300c3c3
block|,
literal|0x2e002e2e
block|,
literal|0xc100c1c1
block|,
literal|0x01000101
block|,
literal|0xe600e6e6
block|,
literal|0x25002525
block|,
literal|0x48004848
block|,
literal|0x99009999
block|,
literal|0xb900b9b9
block|,
literal|0xb300b3b3
block|,
literal|0x7b007b7b
block|,
literal|0xf900f9f9
block|,
literal|0xce00cece
block|,
literal|0xbf00bfbf
block|,
literal|0xdf00dfdf
block|,
literal|0x71007171
block|,
literal|0x29002929
block|,
literal|0xcd00cdcd
block|,
literal|0x6c006c6c
block|,
literal|0x13001313
block|,
literal|0x64006464
block|,
literal|0x9b009b9b
block|,
literal|0x63006363
block|,
literal|0x9d009d9d
block|,
literal|0xc000c0c0
block|,
literal|0x4b004b4b
block|,
literal|0xb700b7b7
block|,
literal|0xa500a5a5
block|,
literal|0x89008989
block|,
literal|0x5f005f5f
block|,
literal|0xb100b1b1
block|,
literal|0x17001717
block|,
literal|0xf400f4f4
block|,
literal|0xbc00bcbc
block|,
literal|0xd300d3d3
block|,
literal|0x46004646
block|,
literal|0xcf00cfcf
block|,
literal|0x37003737
block|,
literal|0x5e005e5e
block|,
literal|0x47004747
block|,
literal|0x94009494
block|,
literal|0xfa00fafa
block|,
literal|0xfc00fcfc
block|,
literal|0x5b005b5b
block|,
literal|0x97009797
block|,
literal|0xfe00fefe
block|,
literal|0x5a005a5a
block|,
literal|0xac00acac
block|,
literal|0x3c003c3c
block|,
literal|0x4c004c4c
block|,
literal|0x03000303
block|,
literal|0x35003535
block|,
literal|0xf300f3f3
block|,
literal|0x23002323
block|,
literal|0xb800b8b8
block|,
literal|0x5d005d5d
block|,
literal|0x6a006a6a
block|,
literal|0x92009292
block|,
literal|0xd500d5d5
block|,
literal|0x21002121
block|,
literal|0x44004444
block|,
literal|0x51005151
block|,
literal|0xc600c6c6
block|,
literal|0x7d007d7d
block|,
literal|0x39003939
block|,
literal|0x83008383
block|,
literal|0xdc00dcdc
block|,
literal|0xaa00aaaa
block|,
literal|0x7c007c7c
block|,
literal|0x77007777
block|,
literal|0x56005656
block|,
literal|0x05000505
block|,
literal|0x1b001b1b
block|,
literal|0xa400a4a4
block|,
literal|0x15001515
block|,
literal|0x34003434
block|,
literal|0x1e001e1e
block|,
literal|0x1c001c1c
block|,
literal|0xf800f8f8
block|,
literal|0x52005252
block|,
literal|0x20002020
block|,
literal|0x14001414
block|,
literal|0xe900e9e9
block|,
literal|0xbd00bdbd
block|,
literal|0xdd00dddd
block|,
literal|0xe400e4e4
block|,
literal|0xa100a1a1
block|,
literal|0xe000e0e0
block|,
literal|0x8a008a8a
block|,
literal|0xf100f1f1
block|,
literal|0xd600d6d6
block|,
literal|0x7a007a7a
block|,
literal|0xbb00bbbb
block|,
literal|0xe300e3e3
block|,
literal|0x40004040
block|,
literal|0x4f004f4f
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Key generation constants */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|u32
name|SIGMA
index|[]
init|=
block|{
literal|0xa09e667f
block|,
literal|0x3bcc908b
block|,
literal|0xb67ae858
block|,
literal|0x4caa73b2
block|,
literal|0xc6ef372f
block|,
literal|0xe94f82be
block|,
literal|0x54ff53a5
block|,
literal|0xf1d36f1c
block|,
literal|0x10e527fa
block|,
literal|0xde682d1d
block|,
literal|0xb05688c2
block|,
literal|0xb3e6c1fd
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* The phi algorithm given in C.2.7 of the Camellia spec document. */
end_comment

begin_comment
comment|/*  * This version does not attempt to minimize amount of temporary  * variables, but instead explicitly exposes algorithm's parallelism.  * It is therefore most appropriate for platforms with not less than  * ~16 registers. For platforms with less registers [well, x86 to be  * specific] assembler version should be/is provided anyway...  */
end_comment

begin_define
define|#
directive|define
name|Camellia_Feistel
parameter_list|(
name|_s0
parameter_list|,
name|_s1
parameter_list|,
name|_s2
parameter_list|,
name|_s3
parameter_list|,
name|_key
parameter_list|)
value|do {\ 	register u32 _t0,_t1,_t2,_t3;\ \ 	_t0  = _s0 ^ (_key)[0];\ 	_t3  = SBOX4_4404[_t0&0xff];\ 	_t1  = _s1 ^ (_key)[1];\ 	_t3 ^= SBOX3_3033[(_t0>> 8)&0xff];\ 	_t2  = SBOX1_1110[_t1&0xff];\ 	_t3 ^= SBOX2_0222[(_t0>> 16)&0xff];\ 	_t2 ^= SBOX4_4404[(_t1>> 8)&0xff];\ 	_t3 ^= SBOX1_1110[(_t0>> 24)];\ 	_t2 ^= _t3;\ 	_t3  = RightRotate(_t3,8);\ 	_t2 ^= SBOX3_3033[(_t1>> 16)&0xff];\ 	_s3 ^= _t3;\ 	_t2 ^= SBOX2_0222[(_t1>> 24)];\ 	_s2 ^= _t2; \ 	_s3 ^= _t2;\ } while(0)
end_define

begin_comment
comment|/*  * Note that n has to be less than 32. Rotations for larger amount  * of bits are achieved by "rotating" order of s-elements and  * adjusting n accordingly, e.g. RotLeft128(s1,s2,s3,s0,n-32).  */
end_comment

begin_define
define|#
directive|define
name|RotLeft128
parameter_list|(
name|_s0
parameter_list|,
name|_s1
parameter_list|,
name|_s2
parameter_list|,
name|_s3
parameter_list|,
name|_n
parameter_list|)
value|do {\ 	u32 _t0=_s0>>(32-_n);\ 	_s0 = (_s0<<_n) | (_s1>>(32-_n));\ 	_s1 = (_s1<<_n) | (_s2>>(32-_n));\ 	_s2 = (_s2<<_n) | (_s3>>(32-_n));\ 	_s3 = (_s3<<_n) | _t0;\ } while (0)
end_define

begin_function
name|int
name|Camellia_Ekeygen
parameter_list|(
name|int
name|keyBitLength
parameter_list|,
specifier|const
name|u8
modifier|*
name|rawKey
parameter_list|,
name|KEY_TABLE_TYPE
name|k
parameter_list|)
block|{
specifier|register
name|u32
name|s0
decl_stmt|,
name|s1
decl_stmt|,
name|s2
decl_stmt|,
name|s3
decl_stmt|;
name|k
index|[
literal|0
index|]
operator|=
name|s0
operator|=
name|GETU32
argument_list|(
name|rawKey
argument_list|)
expr_stmt|;
name|k
index|[
literal|1
index|]
operator|=
name|s1
operator|=
name|GETU32
argument_list|(
name|rawKey
operator|+
literal|4
argument_list|)
expr_stmt|;
name|k
index|[
literal|2
index|]
operator|=
name|s2
operator|=
name|GETU32
argument_list|(
name|rawKey
operator|+
literal|8
argument_list|)
expr_stmt|;
name|k
index|[
literal|3
index|]
operator|=
name|s3
operator|=
name|GETU32
argument_list|(
name|rawKey
operator|+
literal|12
argument_list|)
expr_stmt|;
if|if
condition|(
name|keyBitLength
operator|!=
literal|128
condition|)
block|{
name|k
index|[
literal|8
index|]
operator|=
name|s0
operator|=
name|GETU32
argument_list|(
name|rawKey
operator|+
literal|16
argument_list|)
expr_stmt|;
name|k
index|[
literal|9
index|]
operator|=
name|s1
operator|=
name|GETU32
argument_list|(
name|rawKey
operator|+
literal|20
argument_list|)
expr_stmt|;
if|if
condition|(
name|keyBitLength
operator|==
literal|192
condition|)
block|{
name|k
index|[
literal|10
index|]
operator|=
name|s2
operator|=
operator|~
name|s0
expr_stmt|;
name|k
index|[
literal|11
index|]
operator|=
name|s3
operator|=
operator|~
name|s1
expr_stmt|;
block|}
else|else
block|{
name|k
index|[
literal|10
index|]
operator|=
name|s2
operator|=
name|GETU32
argument_list|(
name|rawKey
operator|+
literal|24
argument_list|)
expr_stmt|;
name|k
index|[
literal|11
index|]
operator|=
name|s3
operator|=
name|GETU32
argument_list|(
name|rawKey
operator|+
literal|28
argument_list|)
expr_stmt|;
block|}
name|s0
operator|^=
name|k
index|[
literal|0
index|]
operator|,
name|s1
operator|^=
name|k
index|[
literal|1
index|]
operator|,
name|s2
operator|^=
name|k
index|[
literal|2
index|]
operator|,
name|s3
operator|^=
name|k
index|[
literal|3
index|]
expr_stmt|;
block|}
comment|/* Use the Feistel routine to scramble the key material */
name|Camellia_Feistel
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
name|SIGMA
operator|+
literal|0
argument_list|)
expr_stmt|;
name|Camellia_Feistel
argument_list|(
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
name|s1
argument_list|,
name|SIGMA
operator|+
literal|2
argument_list|)
expr_stmt|;
name|s0
operator|^=
name|k
index|[
literal|0
index|]
operator|,
name|s1
operator|^=
name|k
index|[
literal|1
index|]
operator|,
name|s2
operator|^=
name|k
index|[
literal|2
index|]
operator|,
name|s3
operator|^=
name|k
index|[
literal|3
index|]
expr_stmt|;
name|Camellia_Feistel
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
name|SIGMA
operator|+
literal|4
argument_list|)
expr_stmt|;
name|Camellia_Feistel
argument_list|(
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
name|s1
argument_list|,
name|SIGMA
operator|+
literal|6
argument_list|)
expr_stmt|;
comment|/* Fill the keyTable. Requires many block rotations. */
if|if
condition|(
name|keyBitLength
operator|==
literal|128
condition|)
block|{
name|k
index|[
literal|4
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|5
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|6
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|7
index|]
operator|=
name|s3
expr_stmt|;
name|RotLeft128
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
literal|15
argument_list|)
expr_stmt|;
comment|/* KA<<< 15 */
name|k
index|[
literal|12
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|13
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|14
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|15
index|]
operator|=
name|s3
expr_stmt|;
name|RotLeft128
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
literal|15
argument_list|)
expr_stmt|;
comment|/* KA<<< 30 */
name|k
index|[
literal|16
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|17
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|18
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|19
index|]
operator|=
name|s3
expr_stmt|;
name|RotLeft128
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
literal|15
argument_list|)
expr_stmt|;
comment|/* KA<<< 45 */
name|k
index|[
literal|24
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|25
index|]
operator|=
name|s1
expr_stmt|;
name|RotLeft128
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
literal|15
argument_list|)
expr_stmt|;
comment|/* KA<<< 60 */
name|k
index|[
literal|28
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|29
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|30
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|31
index|]
operator|=
name|s3
expr_stmt|;
name|RotLeft128
argument_list|(
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
comment|/* KA<<< 94 */
name|k
index|[
literal|40
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|41
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|42
index|]
operator|=
name|s3
operator|,
name|k
index|[
literal|43
index|]
operator|=
name|s0
expr_stmt|;
name|RotLeft128
argument_list|(
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
literal|17
argument_list|)
expr_stmt|;
comment|/* KA<<<111 */
name|k
index|[
literal|48
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|49
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|50
index|]
operator|=
name|s3
operator|,
name|k
index|[
literal|51
index|]
operator|=
name|s0
expr_stmt|;
name|s0
operator|=
name|k
index|[
literal|0
index|]
operator|,
name|s1
operator|=
name|k
index|[
literal|1
index|]
operator|,
name|s2
operator|=
name|k
index|[
literal|2
index|]
operator|,
name|s3
operator|=
name|k
index|[
literal|3
index|]
expr_stmt|;
name|RotLeft128
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
literal|15
argument_list|)
expr_stmt|;
comment|/* KL<<< 15 */
name|k
index|[
literal|8
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|9
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|10
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|11
index|]
operator|=
name|s3
expr_stmt|;
name|RotLeft128
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
literal|30
argument_list|)
expr_stmt|;
comment|/* KL<<< 45 */
name|k
index|[
literal|20
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|21
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|22
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|23
index|]
operator|=
name|s3
expr_stmt|;
name|RotLeft128
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
literal|15
argument_list|)
expr_stmt|;
comment|/* KL<<< 60 */
name|k
index|[
literal|26
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|27
index|]
operator|=
name|s3
expr_stmt|;
name|RotLeft128
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
literal|17
argument_list|)
expr_stmt|;
comment|/* KL<<< 77 */
name|k
index|[
literal|32
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|33
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|34
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|35
index|]
operator|=
name|s3
expr_stmt|;
name|RotLeft128
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
literal|17
argument_list|)
expr_stmt|;
comment|/* KL<<< 94 */
name|k
index|[
literal|36
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|37
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|38
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|39
index|]
operator|=
name|s3
expr_stmt|;
name|RotLeft128
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
literal|17
argument_list|)
expr_stmt|;
comment|/* KL<<<111 */
name|k
index|[
literal|44
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|45
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|46
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|47
index|]
operator|=
name|s3
expr_stmt|;
return|return
literal|3
return|;
comment|/* grand rounds */
block|}
else|else
block|{
name|k
index|[
literal|12
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|13
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|14
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|15
index|]
operator|=
name|s3
expr_stmt|;
name|s0
operator|^=
name|k
index|[
literal|8
index|]
operator|,
name|s1
operator|^=
name|k
index|[
literal|9
index|]
operator|,
name|s2
operator|^=
name|k
index|[
literal|10
index|]
operator|,
name|s3
operator|^=
name|k
index|[
literal|11
index|]
expr_stmt|;
name|Camellia_Feistel
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
operator|(
name|SIGMA
operator|+
literal|8
operator|)
argument_list|)
expr_stmt|;
name|Camellia_Feistel
argument_list|(
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
name|s1
argument_list|,
operator|(
name|SIGMA
operator|+
literal|10
operator|)
argument_list|)
expr_stmt|;
name|k
index|[
literal|4
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|5
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|6
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|7
index|]
operator|=
name|s3
expr_stmt|;
name|RotLeft128
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
literal|30
argument_list|)
expr_stmt|;
comment|/* KB<<< 30 */
name|k
index|[
literal|20
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|21
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|22
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|23
index|]
operator|=
name|s3
expr_stmt|;
name|RotLeft128
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
literal|30
argument_list|)
expr_stmt|;
comment|/* KB<<< 60 */
name|k
index|[
literal|40
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|41
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|42
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|43
index|]
operator|=
name|s3
expr_stmt|;
name|RotLeft128
argument_list|(
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
literal|19
argument_list|)
expr_stmt|;
comment|/* KB<<<111 */
name|k
index|[
literal|64
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|65
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|66
index|]
operator|=
name|s3
operator|,
name|k
index|[
literal|67
index|]
operator|=
name|s0
expr_stmt|;
name|s0
operator|=
name|k
index|[
literal|8
index|]
operator|,
name|s1
operator|=
name|k
index|[
literal|9
index|]
operator|,
name|s2
operator|=
name|k
index|[
literal|10
index|]
operator|,
name|s3
operator|=
name|k
index|[
literal|11
index|]
expr_stmt|;
name|RotLeft128
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
literal|15
argument_list|)
expr_stmt|;
comment|/* KR<<< 15 */
name|k
index|[
literal|8
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|9
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|10
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|11
index|]
operator|=
name|s3
expr_stmt|;
name|RotLeft128
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
literal|15
argument_list|)
expr_stmt|;
comment|/* KR<<< 30 */
name|k
index|[
literal|16
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|17
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|18
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|19
index|]
operator|=
name|s3
expr_stmt|;
name|RotLeft128
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
literal|30
argument_list|)
expr_stmt|;
comment|/* KR<<< 60 */
name|k
index|[
literal|36
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|37
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|38
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|39
index|]
operator|=
name|s3
expr_stmt|;
name|RotLeft128
argument_list|(
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
comment|/* KR<<< 94 */
name|k
index|[
literal|52
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|53
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|54
index|]
operator|=
name|s3
operator|,
name|k
index|[
literal|55
index|]
operator|=
name|s0
expr_stmt|;
name|s0
operator|=
name|k
index|[
literal|12
index|]
operator|,
name|s1
operator|=
name|k
index|[
literal|13
index|]
operator|,
name|s2
operator|=
name|k
index|[
literal|14
index|]
operator|,
name|s3
operator|=
name|k
index|[
literal|15
index|]
expr_stmt|;
name|RotLeft128
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
literal|15
argument_list|)
expr_stmt|;
comment|/* KA<<< 15 */
name|k
index|[
literal|12
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|13
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|14
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|15
index|]
operator|=
name|s3
expr_stmt|;
name|RotLeft128
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
literal|30
argument_list|)
expr_stmt|;
comment|/* KA<<< 45 */
name|k
index|[
literal|28
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|29
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|30
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|31
index|]
operator|=
name|s3
expr_stmt|;
comment|/* KA<<< 77 */
name|k
index|[
literal|48
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|49
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|50
index|]
operator|=
name|s3
operator|,
name|k
index|[
literal|51
index|]
operator|=
name|s0
expr_stmt|;
name|RotLeft128
argument_list|(
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
literal|17
argument_list|)
expr_stmt|;
comment|/* KA<<< 94 */
name|k
index|[
literal|56
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|57
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|58
index|]
operator|=
name|s3
operator|,
name|k
index|[
literal|59
index|]
operator|=
name|s0
expr_stmt|;
name|s0
operator|=
name|k
index|[
literal|0
index|]
operator|,
name|s1
operator|=
name|k
index|[
literal|1
index|]
operator|,
name|s2
operator|=
name|k
index|[
literal|2
index|]
operator|,
name|s3
operator|=
name|k
index|[
literal|3
index|]
expr_stmt|;
name|RotLeft128
argument_list|(
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
literal|13
argument_list|)
expr_stmt|;
comment|/* KL<<< 45 */
name|k
index|[
literal|24
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|25
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|26
index|]
operator|=
name|s3
operator|,
name|k
index|[
literal|27
index|]
operator|=
name|s0
expr_stmt|;
name|RotLeft128
argument_list|(
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
literal|15
argument_list|)
expr_stmt|;
comment|/* KL<<< 60 */
name|k
index|[
literal|32
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|33
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|34
index|]
operator|=
name|s3
operator|,
name|k
index|[
literal|35
index|]
operator|=
name|s0
expr_stmt|;
name|RotLeft128
argument_list|(
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
literal|17
argument_list|)
expr_stmt|;
comment|/* KL<<< 77 */
name|k
index|[
literal|44
index|]
operator|=
name|s1
operator|,
name|k
index|[
literal|45
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|46
index|]
operator|=
name|s3
operator|,
name|k
index|[
literal|47
index|]
operator|=
name|s0
expr_stmt|;
name|RotLeft128
argument_list|(
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
name|s1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
comment|/* KL<<<111 */
name|k
index|[
literal|60
index|]
operator|=
name|s2
operator|,
name|k
index|[
literal|61
index|]
operator|=
name|s3
operator|,
name|k
index|[
literal|62
index|]
operator|=
name|s0
operator|,
name|k
index|[
literal|63
index|]
operator|=
name|s1
expr_stmt|;
return|return
literal|4
return|;
comment|/* grand rounds */
block|}
comment|/* 	 * It is possible to perform certain precalculations, which 	 * would spare few cycles in block procedure. It's not done, 	 * because it upsets the performance balance between key 	 * setup and block procedures, negatively affecting overall 	 * throughput in applications operating on short messages 	 * and volatile keys. 	 */
block|}
end_function

begin_function
name|void
name|Camellia_EncryptBlock_Rounds
parameter_list|(
name|int
name|grandRounds
parameter_list|,
specifier|const
name|u8
name|plaintext
index|[]
parameter_list|,
specifier|const
name|KEY_TABLE_TYPE
name|keyTable
parameter_list|,
name|u8
name|ciphertext
index|[]
parameter_list|)
block|{
specifier|register
name|u32
name|s0
decl_stmt|,
name|s1
decl_stmt|,
name|s2
decl_stmt|,
name|s3
decl_stmt|;
specifier|const
name|u32
modifier|*
name|k
init|=
name|keyTable
decl_stmt|,
modifier|*
name|kend
init|=
name|keyTable
operator|+
name|grandRounds
operator|*
literal|16
decl_stmt|;
name|s0
operator|=
name|GETU32
argument_list|(
name|plaintext
argument_list|)
operator|^
name|k
index|[
literal|0
index|]
expr_stmt|;
name|s1
operator|=
name|GETU32
argument_list|(
name|plaintext
operator|+
literal|4
argument_list|)
operator|^
name|k
index|[
literal|1
index|]
expr_stmt|;
name|s2
operator|=
name|GETU32
argument_list|(
name|plaintext
operator|+
literal|8
argument_list|)
operator|^
name|k
index|[
literal|2
index|]
expr_stmt|;
name|s3
operator|=
name|GETU32
argument_list|(
name|plaintext
operator|+
literal|12
argument_list|)
operator|^
name|k
index|[
literal|3
index|]
expr_stmt|;
name|k
operator|+=
literal|4
expr_stmt|;
while|while
condition|(
literal|1
condition|)
block|{
comment|/* Camellia makes 6 Feistel rounds */
name|Camellia_Feistel
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
name|k
operator|+
literal|0
argument_list|)
expr_stmt|;
name|Camellia_Feistel
argument_list|(
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
name|s1
argument_list|,
name|k
operator|+
literal|2
argument_list|)
expr_stmt|;
name|Camellia_Feistel
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
name|k
operator|+
literal|4
argument_list|)
expr_stmt|;
name|Camellia_Feistel
argument_list|(
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
name|s1
argument_list|,
name|k
operator|+
literal|6
argument_list|)
expr_stmt|;
name|Camellia_Feistel
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
name|k
operator|+
literal|8
argument_list|)
expr_stmt|;
name|Camellia_Feistel
argument_list|(
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
name|s1
argument_list|,
name|k
operator|+
literal|10
argument_list|)
expr_stmt|;
name|k
operator|+=
literal|12
expr_stmt|;
if|if
condition|(
name|k
operator|==
name|kend
condition|)
break|break;
comment|/* This is the same function as the diffusion function D 		 * of the accompanying documentation. See section 3.2 		 * for properties of the FLlayer function. */
name|s1
operator|^=
name|LeftRotate
argument_list|(
name|s0
operator|&
name|k
index|[
literal|0
index|]
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|s2
operator|^=
name|s3
operator||
name|k
index|[
literal|3
index|]
expr_stmt|;
name|s0
operator|^=
name|s1
operator||
name|k
index|[
literal|1
index|]
expr_stmt|;
name|s3
operator|^=
name|LeftRotate
argument_list|(
name|s2
operator|&
name|k
index|[
literal|2
index|]
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|k
operator|+=
literal|4
expr_stmt|;
block|}
name|s2
operator|^=
name|k
index|[
literal|0
index|]
operator|,
name|s3
operator|^=
name|k
index|[
literal|1
index|]
operator|,
name|s0
operator|^=
name|k
index|[
literal|2
index|]
operator|,
name|s1
operator|^=
name|k
index|[
literal|3
index|]
expr_stmt|;
name|PUTU32
argument_list|(
name|ciphertext
argument_list|,
name|s2
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|ciphertext
operator|+
literal|4
argument_list|,
name|s3
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|ciphertext
operator|+
literal|8
argument_list|,
name|s0
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|ciphertext
operator|+
literal|12
argument_list|,
name|s1
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Camellia_EncryptBlock
parameter_list|(
name|int
name|keyBitLength
parameter_list|,
specifier|const
name|u8
name|plaintext
index|[]
parameter_list|,
specifier|const
name|KEY_TABLE_TYPE
name|keyTable
parameter_list|,
name|u8
name|ciphertext
index|[]
parameter_list|)
block|{
name|Camellia_EncryptBlock_Rounds
argument_list|(
name|keyBitLength
operator|==
literal|128
condition|?
literal|3
else|:
literal|4
argument_list|,
name|plaintext
argument_list|,
name|keyTable
argument_list|,
name|ciphertext
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Camellia_DecryptBlock_Rounds
parameter_list|(
name|int
name|grandRounds
parameter_list|,
specifier|const
name|u8
name|ciphertext
index|[]
parameter_list|,
specifier|const
name|KEY_TABLE_TYPE
name|keyTable
parameter_list|,
name|u8
name|plaintext
index|[]
parameter_list|)
block|{
name|u32
name|s0
decl_stmt|,
name|s1
decl_stmt|,
name|s2
decl_stmt|,
name|s3
decl_stmt|;
specifier|const
name|u32
modifier|*
name|k
init|=
name|keyTable
operator|+
name|grandRounds
operator|*
literal|16
decl_stmt|,
modifier|*
name|kend
init|=
name|keyTable
operator|+
literal|4
decl_stmt|;
name|s0
operator|=
name|GETU32
argument_list|(
name|ciphertext
argument_list|)
operator|^
name|k
index|[
literal|0
index|]
expr_stmt|;
name|s1
operator|=
name|GETU32
argument_list|(
name|ciphertext
operator|+
literal|4
argument_list|)
operator|^
name|k
index|[
literal|1
index|]
expr_stmt|;
name|s2
operator|=
name|GETU32
argument_list|(
name|ciphertext
operator|+
literal|8
argument_list|)
operator|^
name|k
index|[
literal|2
index|]
expr_stmt|;
name|s3
operator|=
name|GETU32
argument_list|(
name|ciphertext
operator|+
literal|12
argument_list|)
operator|^
name|k
index|[
literal|3
index|]
expr_stmt|;
while|while
condition|(
literal|1
condition|)
block|{
comment|/* Camellia makes 6 Feistel rounds */
name|k
operator|-=
literal|12
expr_stmt|;
name|Camellia_Feistel
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
name|k
operator|+
literal|10
argument_list|)
expr_stmt|;
name|Camellia_Feistel
argument_list|(
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
name|s1
argument_list|,
name|k
operator|+
literal|8
argument_list|)
expr_stmt|;
name|Camellia_Feistel
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
name|k
operator|+
literal|6
argument_list|)
expr_stmt|;
name|Camellia_Feistel
argument_list|(
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
name|s1
argument_list|,
name|k
operator|+
literal|4
argument_list|)
expr_stmt|;
name|Camellia_Feistel
argument_list|(
name|s0
argument_list|,
name|s1
argument_list|,
name|s2
argument_list|,
name|s3
argument_list|,
name|k
operator|+
literal|2
argument_list|)
expr_stmt|;
name|Camellia_Feistel
argument_list|(
name|s2
argument_list|,
name|s3
argument_list|,
name|s0
argument_list|,
name|s1
argument_list|,
name|k
operator|+
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|k
operator|==
name|kend
condition|)
break|break;
comment|/* This is the same function as the diffusion function D 		 * of the accompanying documentation. See section 3.2 		 * for properties of the FLlayer function. */
name|k
operator|-=
literal|4
expr_stmt|;
name|s1
operator|^=
name|LeftRotate
argument_list|(
name|s0
operator|&
name|k
index|[
literal|2
index|]
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|s2
operator|^=
name|s3
operator||
name|k
index|[
literal|1
index|]
expr_stmt|;
name|s0
operator|^=
name|s1
operator||
name|k
index|[
literal|3
index|]
expr_stmt|;
name|s3
operator|^=
name|LeftRotate
argument_list|(
name|s2
operator|&
name|k
index|[
literal|0
index|]
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
name|k
operator|-=
literal|4
expr_stmt|;
name|s2
operator|^=
name|k
index|[
literal|0
index|]
operator|,
name|s3
operator|^=
name|k
index|[
literal|1
index|]
operator|,
name|s0
operator|^=
name|k
index|[
literal|2
index|]
operator|,
name|s1
operator|^=
name|k
index|[
literal|3
index|]
expr_stmt|;
name|PUTU32
argument_list|(
name|plaintext
argument_list|,
name|s2
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|plaintext
operator|+
literal|4
argument_list|,
name|s3
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|plaintext
operator|+
literal|8
argument_list|,
name|s0
argument_list|)
expr_stmt|;
name|PUTU32
argument_list|(
name|plaintext
operator|+
literal|12
argument_list|,
name|s1
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Camellia_DecryptBlock
parameter_list|(
name|int
name|keyBitLength
parameter_list|,
specifier|const
name|u8
name|plaintext
index|[]
parameter_list|,
specifier|const
name|KEY_TABLE_TYPE
name|keyTable
parameter_list|,
name|u8
name|ciphertext
index|[]
parameter_list|)
block|{
name|Camellia_DecryptBlock_Rounds
argument_list|(
name|keyBitLength
operator|==
literal|128
condition|?
literal|3
else|:
literal|4
argument_list|,
name|plaintext
argument_list|,
name|keyTable
argument_list|,
name|ciphertext
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

