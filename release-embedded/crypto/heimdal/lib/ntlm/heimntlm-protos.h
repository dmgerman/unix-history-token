begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* This is a generated file */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|__heimntlm_protos_h__
end_ifndef

begin_define
define|#
directive|define
name|__heimntlm_protos_h__
end_define

begin_include
include|#
directive|include
file|<stdarg.h>
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|__cplusplus
end_ifdef

begin_extern
extern|extern
literal|"C"
block|{
endif|#
directive|endif
name|int
name|heim_ntlm_build_ntlm1_master
parameter_list|(
name|void
modifier|*
comment|/*key*/
parameter_list|,
name|size_t
comment|/*len*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*session*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*master*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_build_ntlm2_master
parameter_list|(
name|void
modifier|*
comment|/*key*/
parameter_list|,
name|size_t
comment|/*len*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*blob*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*session*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*master*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_calculate_lm2
parameter_list|(
specifier|const
name|void
modifier|*
comment|/*key*/
parameter_list|,
name|size_t
comment|/*len*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*username*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*target*/
parameter_list|,
specifier|const
name|unsigned
name|char
name|serverchallenge
index|[
literal|8
index|]
parameter_list|,
name|unsigned
name|char
name|ntlmv2
index|[
literal|16
index|]
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*answer*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_calculate_ntlm1
parameter_list|(
name|void
modifier|*
comment|/*key*/
parameter_list|,
name|size_t
comment|/*len*/
parameter_list|,
name|unsigned
name|char
name|challenge
index|[
literal|8
index|]
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*answer*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_calculate_ntlm2
parameter_list|(
specifier|const
name|void
modifier|*
comment|/*key*/
parameter_list|,
name|size_t
comment|/*len*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*username*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*target*/
parameter_list|,
specifier|const
name|unsigned
name|char
name|serverchallenge
index|[
literal|8
index|]
parameter_list|,
specifier|const
name|struct
name|ntlm_buf
modifier|*
comment|/*infotarget*/
parameter_list|,
name|unsigned
name|char
name|ntlmv2
index|[
literal|16
index|]
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*answer*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_calculate_ntlm2_sess
parameter_list|(
specifier|const
name|unsigned
name|char
name|clnt_nonce
index|[
literal|8
index|]
parameter_list|,
specifier|const
name|unsigned
name|char
name|svr_chal
index|[
literal|8
index|]
parameter_list|,
specifier|const
name|unsigned
name|char
name|ntlm_hash
index|[
literal|16
index|]
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*lm*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*ntlm*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_calculate_ntlm2_sess_hash
parameter_list|(
specifier|const
name|unsigned
name|char
name|clnt_nonce
index|[
literal|8
index|]
parameter_list|,
specifier|const
name|unsigned
name|char
name|svr_chal
index|[
literal|8
index|]
parameter_list|,
name|unsigned
name|char
name|verifier
index|[
literal|8
index|]
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_decode_targetinfo
parameter_list|(
specifier|const
name|struct
name|ntlm_buf
modifier|*
comment|/*data*/
parameter_list|,
name|int
comment|/*ucs2*/
parameter_list|,
name|struct
name|ntlm_targetinfo
modifier|*
comment|/*ti*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_decode_type1
parameter_list|(
specifier|const
name|struct
name|ntlm_buf
modifier|*
comment|/*buf*/
parameter_list|,
name|struct
name|ntlm_type1
modifier|*
comment|/*data*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_decode_type2
parameter_list|(
specifier|const
name|struct
name|ntlm_buf
modifier|*
comment|/*buf*/
parameter_list|,
name|struct
name|ntlm_type2
modifier|*
comment|/*type2*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_decode_type3
parameter_list|(
specifier|const
name|struct
name|ntlm_buf
modifier|*
comment|/*buf*/
parameter_list|,
name|int
comment|/*ucs2*/
parameter_list|,
name|struct
name|ntlm_type3
modifier|*
comment|/*type3*/
parameter_list|)
function_decl|;
name|void
name|heim_ntlm_derive_ntlm2_sess
parameter_list|(
specifier|const
name|unsigned
name|char
name|sessionkey
index|[
literal|16
index|]
parameter_list|,
specifier|const
name|unsigned
name|char
modifier|*
comment|/*clnt_nonce*/
parameter_list|,
name|size_t
comment|/*clnt_nonce_length*/
parameter_list|,
specifier|const
name|unsigned
name|char
name|svr_chal
index|[
literal|8
index|]
parameter_list|,
name|unsigned
name|char
name|derivedkey
index|[
literal|16
index|]
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_encode_targetinfo
parameter_list|(
specifier|const
name|struct
name|ntlm_targetinfo
modifier|*
comment|/*ti*/
parameter_list|,
name|int
comment|/*ucs2*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*data*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_encode_type1
parameter_list|(
specifier|const
name|struct
name|ntlm_type1
modifier|*
comment|/*type1*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*data*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_encode_type2
parameter_list|(
specifier|const
name|struct
name|ntlm_type2
modifier|*
comment|/*type2*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*data*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_encode_type3
parameter_list|(
specifier|const
name|struct
name|ntlm_type3
modifier|*
comment|/*type3*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*data*/
parameter_list|)
function_decl|;
name|void
name|heim_ntlm_free_buf
parameter_list|(
name|struct
name|ntlm_buf
modifier|*
comment|/*p*/
parameter_list|)
function_decl|;
name|void
name|heim_ntlm_free_targetinfo
parameter_list|(
name|struct
name|ntlm_targetinfo
modifier|*
comment|/*ti*/
parameter_list|)
function_decl|;
name|void
name|heim_ntlm_free_type1
parameter_list|(
name|struct
name|ntlm_type1
modifier|*
comment|/*data*/
parameter_list|)
function_decl|;
name|void
name|heim_ntlm_free_type2
parameter_list|(
name|struct
name|ntlm_type2
modifier|*
comment|/*data*/
parameter_list|)
function_decl|;
name|void
name|heim_ntlm_free_type3
parameter_list|(
name|struct
name|ntlm_type3
modifier|*
comment|/*data*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_keyex_unwrap
parameter_list|(
name|struct
name|ntlm_buf
modifier|*
comment|/*baseKey*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*encryptedSession*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*session*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_keyex_wrap
parameter_list|(
name|struct
name|ntlm_buf
modifier|*
comment|/*base_session*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*session*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*encryptedSession*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_nt_key
parameter_list|(
specifier|const
name|char
modifier|*
comment|/*password*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*key*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_ntlmv2_key
parameter_list|(
specifier|const
name|void
modifier|*
comment|/*key*/
parameter_list|,
name|size_t
comment|/*len*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*username*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*target*/
parameter_list|,
name|unsigned
name|char
name|ntlmv2
index|[
literal|16
index|]
parameter_list|)
function_decl|;
name|size_t
name|heim_ntlm_unparse_flags
parameter_list|(
name|uint32_t
comment|/*flags*/
parameter_list|,
name|char
modifier|*
comment|/*s*/
parameter_list|,
name|size_t
comment|/*len*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_v1_base_session
parameter_list|(
name|void
modifier|*
comment|/*key*/
parameter_list|,
name|size_t
comment|/*len*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*session*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_v2_base_session
parameter_list|(
name|void
modifier|*
comment|/*key*/
parameter_list|,
name|size_t
comment|/*len*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*ntlmResponse*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*session*/
parameter_list|)
function_decl|;
name|int
name|heim_ntlm_verify_ntlm2
parameter_list|(
specifier|const
name|void
modifier|*
comment|/*key*/
parameter_list|,
name|size_t
comment|/*len*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*username*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*target*/
parameter_list|,
name|time_t
comment|/*now*/
parameter_list|,
specifier|const
name|unsigned
name|char
name|serverchallenge
index|[
literal|8
index|]
parameter_list|,
specifier|const
name|struct
name|ntlm_buf
modifier|*
comment|/*answer*/
parameter_list|,
name|struct
name|ntlm_buf
modifier|*
comment|/*infotarget*/
parameter_list|,
name|unsigned
name|char
name|ntlmv2
index|[
literal|16
index|]
parameter_list|)
function_decl|;
ifdef|#
directive|ifdef
name|__cplusplus
block|}
end_extern

begin_endif
endif|#
directive|endif
end_endif

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* __heimntlm_protos_h__ */
end_comment

end_unit

