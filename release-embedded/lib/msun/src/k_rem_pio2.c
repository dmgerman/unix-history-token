begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* @(#)k_rem_pio2.c 1.3 95/01/18 */
end_comment

begin_comment
comment|/*  * ====================================================  * Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  *  * Developed at SunSoft, a Sun Microsystems, Inc. business.  * Permission to use, copy, modify, and distribute this  * software is freely granted, provided that this notice   * is preserved.  * ====================================================  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_comment
comment|/*  * __kernel_rem_pio2(x,y,e0,nx,prec)  * double x[],y[]; int e0,nx,prec;  *   * __kernel_rem_pio2 return the last three digits of N with   *		y = x - N*pi/2  * so that |y|< pi/2.  *  * The method is to compute the integer (mod 8) and fraction parts of   * (2/pi)*x without doing the full multiplication. In general we  * skip the part of the product that are known to be a huge integer (  * more accurately, = 0 mod 8 ). Thus the number of operations are  * independent of the exponent of the input.  *  * (2/pi) is represented by an array of 24-bit integers in ipio2[].  *  * Input parameters:  * 	x[]	The input value (must be positive) is broken into nx   *		pieces of 24-bit integers in double precision format.  *		x[i] will be the i-th 24 bit of x. The scaled exponent   *		of x[0] is given in input parameter e0 (i.e., x[0]*2^e0   *		match x's up to 24 bits.  *  *		Example of breaking a double positive z into x[0]+x[1]+x[2]:  *			e0 = ilogb(z)-23  *			z  = scalbn(z,-e0)  *		for i = 0,1,2  *			x[i] = floor(z)  *			z    = (z-x[i])*2**24  *  *  *	y[]	output result in an array of double precision numbers.  *		The dimension of y[] is:  *			24-bit  precision	1  *			53-bit  precision	2  *			64-bit  precision	2  *			113-bit precision	3  *		The actual value is the sum of them. Thus for 113-bit  *		precison, one may have to do something like:  *  *		long double t,w,r_head, r_tail;  *		t = (long double)y[2] + (long double)y[1];  *		w = (long double)y[0];  *		r_head = t+w;  *		r_tail = w - (r_head - t);  *  *	e0	The exponent of x[0]. Must be<= 16360 or you need to  *              expand the ipio2 table.  *  *	nx	dimension of x[]  *  *  	prec	an integer indicating the precision:  *			0	24  bits (single)  *			1	53  bits (double)  *			2	64  bits (extended)  *			3	113 bits (quad)  *  * External function:  *	double scalbn(), floor();  *  *  * Here is the description of some local variables:  *  * 	jk	jk+1 is the initial number of terms of ipio2[] needed  *		in the computation. The minimum and recommended value  *		for jk is 3,4,4,6 for single, double, extended, and quad.  *		jk+1 must be 2 larger than you might expect so that our  *		recomputation test works. (Up to 24 bits in the integer  *		part (the 24 bits of it that we compute) and 23 bits in  *		the fraction part may be lost to cancelation before we  *		recompute.)  *  * 	jz	local integer variable indicating the number of   *		terms of ipio2[] used.   *  *	jx	nx - 1  *  *	jv	index for pointing to the suitable ipio2[] for the  *		computation. In general, we want  *			( 2^e0*x[0] * ipio2[jv-1]*2^(-24jv) )/8  *		is an integer. Thus  *			e0-3-24*jv>= 0 or (e0-3)/24>= jv  *		Hence jv = max(0,(e0-3)/24).  *  *	jp	jp+1 is the number of terms in PIo2[] needed, jp = jk.  *  * 	q[]	double array with integral value, representing the  *		24-bits chunk of the product of x and 2/pi.  *  *	q0	the corresponding exponent of q[0]. Note that the  *		exponent for q[i] would be q0-24*i.  *  *	PIo2[]	double precision array, obtained by cutting pi/2  *		into 24 bits chunks.   *  *	f[]	ipio2[] in floating point   *  *	iq[]	integer array by breaking up q[] in 24-bits chunk.  *  *	fq[]	final product of x*(2/pi) in fq[0],..,fq[jk]  *  *	ih	integer. If>0 it indicates q[] is>= 0.5, hence  *		it also indicates the *sign* of the result.  *  */
end_comment

begin_comment
comment|/*  * Constants:  * The hexadecimal values are the intended ones for the following   * constants. The decimal values may be used, provided that the   * compiler will convert from decimal to binary accurately enough   * to produce the hexadecimal values shown.  */
end_comment

begin_include
include|#
directive|include
file|<float.h>
end_include

begin_include
include|#
directive|include
file|"math.h"
end_include

begin_include
include|#
directive|include
file|"math_private.h"
end_include

begin_decl_stmt
specifier|static
specifier|const
name|int
name|init_jk
index|[]
init|=
block|{
literal|3
block|,
literal|4
block|,
literal|4
block|,
literal|6
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* initial value for jk */
end_comment

begin_comment
comment|/*  * Table of constants for 2/pi, 396 Hex digits (476 decimal) of 2/pi  *  *		integer array, contains the (24*i)-th to (24*i+23)-th   *		bit of 2/pi after binary point. The corresponding   *		floating value is  *  *			ipio2[i] * 2^(-24(i+1)).  *  * NB: This table must have at least (e0-3)/24 + jk terms.  *     For quad precision (e0<= 16360, jk = 6), this is 686.  */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|int32_t
name|ipio2
index|[]
init|=
block|{
literal|0xA2F983
block|,
literal|0x6E4E44
block|,
literal|0x1529FC
block|,
literal|0x2757D1
block|,
literal|0xF534DD
block|,
literal|0xC0DB62
block|,
literal|0x95993C
block|,
literal|0x439041
block|,
literal|0xFE5163
block|,
literal|0xABDEBB
block|,
literal|0xC561B7
block|,
literal|0x246E3A
block|,
literal|0x424DD2
block|,
literal|0xE00649
block|,
literal|0x2EEA09
block|,
literal|0xD1921C
block|,
literal|0xFE1DEB
block|,
literal|0x1CB129
block|,
literal|0xA73EE8
block|,
literal|0x8235F5
block|,
literal|0x2EBB44
block|,
literal|0x84E99C
block|,
literal|0x7026B4
block|,
literal|0x5F7E41
block|,
literal|0x3991D6
block|,
literal|0x398353
block|,
literal|0x39F49C
block|,
literal|0x845F8B
block|,
literal|0xBDF928
block|,
literal|0x3B1FF8
block|,
literal|0x97FFDE
block|,
literal|0x05980F
block|,
literal|0xEF2F11
block|,
literal|0x8B5A0A
block|,
literal|0x6D1F6D
block|,
literal|0x367ECF
block|,
literal|0x27CB09
block|,
literal|0xB74F46
block|,
literal|0x3F669E
block|,
literal|0x5FEA2D
block|,
literal|0x7527BA
block|,
literal|0xC7EBE5
block|,
literal|0xF17B3D
block|,
literal|0x0739F7
block|,
literal|0x8A5292
block|,
literal|0xEA6BFB
block|,
literal|0x5FB11F
block|,
literal|0x8D5D08
block|,
literal|0x560330
block|,
literal|0x46FC7B
block|,
literal|0x6BABF0
block|,
literal|0xCFBC20
block|,
literal|0x9AF436
block|,
literal|0x1DA9E3
block|,
literal|0x91615E
block|,
literal|0xE61B08
block|,
literal|0x659985
block|,
literal|0x5F14A0
block|,
literal|0x68408D
block|,
literal|0xFFD880
block|,
literal|0x4D7327
block|,
literal|0x310606
block|,
literal|0x1556CA
block|,
literal|0x73A8C9
block|,
literal|0x60E27B
block|,
literal|0xC08C6B
block|,
if|#
directive|if
name|LDBL_MAX_EXP
operator|>
literal|1024
if|#
directive|if
name|LDBL_MAX_EXP
operator|>
literal|16384
error|#
directive|error
literal|"ipio2 table needs to be expanded"
endif|#
directive|endif
literal|0x47C419
block|,
literal|0xC367CD
block|,
literal|0xDCE809
block|,
literal|0x2A8359
block|,
literal|0xC4768B
block|,
literal|0x961CA6
block|,
literal|0xDDAF44
block|,
literal|0xD15719
block|,
literal|0x053EA5
block|,
literal|0xFF0705
block|,
literal|0x3F7E33
block|,
literal|0xE832C2
block|,
literal|0xDE4F98
block|,
literal|0x327DBB
block|,
literal|0xC33D26
block|,
literal|0xEF6B1E
block|,
literal|0x5EF89F
block|,
literal|0x3A1F35
block|,
literal|0xCAF27F
block|,
literal|0x1D87F1
block|,
literal|0x21907C
block|,
literal|0x7C246A
block|,
literal|0xFA6ED5
block|,
literal|0x772D30
block|,
literal|0x433B15
block|,
literal|0xC614B5
block|,
literal|0x9D19C3
block|,
literal|0xC2C4AD
block|,
literal|0x414D2C
block|,
literal|0x5D000C
block|,
literal|0x467D86
block|,
literal|0x2D71E3
block|,
literal|0x9AC69B
block|,
literal|0x006233
block|,
literal|0x7CD2B4
block|,
literal|0x97A7B4
block|,
literal|0xD55537
block|,
literal|0xF63ED7
block|,
literal|0x1810A3
block|,
literal|0xFC764D
block|,
literal|0x2A9D64
block|,
literal|0xABD770
block|,
literal|0xF87C63
block|,
literal|0x57B07A
block|,
literal|0xE71517
block|,
literal|0x5649C0
block|,
literal|0xD9D63B
block|,
literal|0x3884A7
block|,
literal|0xCB2324
block|,
literal|0x778AD6
block|,
literal|0x23545A
block|,
literal|0xB91F00
block|,
literal|0x1B0AF1
block|,
literal|0xDFCE19
block|,
literal|0xFF319F
block|,
literal|0x6A1E66
block|,
literal|0x615799
block|,
literal|0x47FBAC
block|,
literal|0xD87F7E
block|,
literal|0xB76522
block|,
literal|0x89E832
block|,
literal|0x60BFE6
block|,
literal|0xCDC4EF
block|,
literal|0x09366C
block|,
literal|0xD43F5D
block|,
literal|0xD7DE16
block|,
literal|0xDE3B58
block|,
literal|0x929BDE
block|,
literal|0x2822D2
block|,
literal|0xE88628
block|,
literal|0x4D58E2
block|,
literal|0x32CAC6
block|,
literal|0x16E308
block|,
literal|0xCB7DE0
block|,
literal|0x50C017
block|,
literal|0xA71DF3
block|,
literal|0x5BE018
block|,
literal|0x34132E
block|,
literal|0x621283
block|,
literal|0x014883
block|,
literal|0x5B8EF5
block|,
literal|0x7FB0AD
block|,
literal|0xF2E91E
block|,
literal|0x434A48
block|,
literal|0xD36710
block|,
literal|0xD8DDAA
block|,
literal|0x425FAE
block|,
literal|0xCE616A
block|,
literal|0xA4280A
block|,
literal|0xB499D3
block|,
literal|0xF2A606
block|,
literal|0x7F775C
block|,
literal|0x83C2A3
block|,
literal|0x883C61
block|,
literal|0x78738A
block|,
literal|0x5A8CAF
block|,
literal|0xBDD76F
block|,
literal|0x63A62D
block|,
literal|0xCBBFF4
block|,
literal|0xEF818D
block|,
literal|0x67C126
block|,
literal|0x45CA55
block|,
literal|0x36D9CA
block|,
literal|0xD2A828
block|,
literal|0x8D61C2
block|,
literal|0x77C912
block|,
literal|0x142604
block|,
literal|0x9B4612
block|,
literal|0xC459C4
block|,
literal|0x44C5C8
block|,
literal|0x91B24D
block|,
literal|0xF31700
block|,
literal|0xAD43D4
block|,
literal|0xE54929
block|,
literal|0x10D5FD
block|,
literal|0xFCBE00
block|,
literal|0xCC941E
block|,
literal|0xEECE70
block|,
literal|0xF53E13
block|,
literal|0x80F1EC
block|,
literal|0xC3E7B3
block|,
literal|0x28F8C7
block|,
literal|0x940593
block|,
literal|0x3E71C1
block|,
literal|0xB3092E
block|,
literal|0xF3450B
block|,
literal|0x9C1288
block|,
literal|0x7B20AB
block|,
literal|0x9FB52E
block|,
literal|0xC29247
block|,
literal|0x2F327B
block|,
literal|0x6D550C
block|,
literal|0x90A772
block|,
literal|0x1FE76B
block|,
literal|0x96CB31
block|,
literal|0x4A1679
block|,
literal|0xE27941
block|,
literal|0x89DFF4
block|,
literal|0x9794E8
block|,
literal|0x84E6E2
block|,
literal|0x973199
block|,
literal|0x6BED88
block|,
literal|0x365F5F
block|,
literal|0x0EFDBB
block|,
literal|0xB49A48
block|,
literal|0x6CA467
block|,
literal|0x427271
block|,
literal|0x325D8D
block|,
literal|0xB8159F
block|,
literal|0x09E5BC
block|,
literal|0x25318D
block|,
literal|0x3974F7
block|,
literal|0x1C0530
block|,
literal|0x010C0D
block|,
literal|0x68084B
block|,
literal|0x58EE2C
block|,
literal|0x90AA47
block|,
literal|0x02E774
block|,
literal|0x24D6BD
block|,
literal|0xA67DF7
block|,
literal|0x72486E
block|,
literal|0xEF169F
block|,
literal|0xA6948E
block|,
literal|0xF691B4
block|,
literal|0x5153D1
block|,
literal|0xF20ACF
block|,
literal|0x339820
block|,
literal|0x7E4BF5
block|,
literal|0x6863B2
block|,
literal|0x5F3EDD
block|,
literal|0x035D40
block|,
literal|0x7F8985
block|,
literal|0x295255
block|,
literal|0xC06437
block|,
literal|0x10D86D
block|,
literal|0x324832
block|,
literal|0x754C5B
block|,
literal|0xD4714E
block|,
literal|0x6E5445
block|,
literal|0xC1090B
block|,
literal|0x69F52A
block|,
literal|0xD56614
block|,
literal|0x9D0727
block|,
literal|0x50045D
block|,
literal|0xDB3BB4
block|,
literal|0xC576EA
block|,
literal|0x17F987
block|,
literal|0x7D6B49
block|,
literal|0xBA271D
block|,
literal|0x296996
block|,
literal|0xACCCC6
block|,
literal|0x5414AD
block|,
literal|0x6AE290
block|,
literal|0x89D988
block|,
literal|0x50722C
block|,
literal|0xBEA404
block|,
literal|0x940777
block|,
literal|0x7030F3
block|,
literal|0x27FC00
block|,
literal|0xA871EA
block|,
literal|0x49C266
block|,
literal|0x3DE064
block|,
literal|0x83DD97
block|,
literal|0x973FA3
block|,
literal|0xFD9443
block|,
literal|0x8C860D
block|,
literal|0xDE4131
block|,
literal|0x9D3992
block|,
literal|0x8C70DD
block|,
literal|0xE7B717
block|,
literal|0x3BDF08
block|,
literal|0x2B3715
block|,
literal|0xA0805C
block|,
literal|0x93805A
block|,
literal|0x921110
block|,
literal|0xD8E80F
block|,
literal|0xAF806C
block|,
literal|0x4BFFDB
block|,
literal|0x0F9038
block|,
literal|0x761859
block|,
literal|0x15A562
block|,
literal|0xBBCB61
block|,
literal|0xB989C7
block|,
literal|0xBD4010
block|,
literal|0x04F2D2
block|,
literal|0x277549
block|,
literal|0xF6B6EB
block|,
literal|0xBB22DB
block|,
literal|0xAA140A
block|,
literal|0x2F2689
block|,
literal|0x768364
block|,
literal|0x333B09
block|,
literal|0x1A940E
block|,
literal|0xAA3A51
block|,
literal|0xC2A31D
block|,
literal|0xAEEDAF
block|,
literal|0x12265C
block|,
literal|0x4DC26D
block|,
literal|0x9C7A2D
block|,
literal|0x9756C0
block|,
literal|0x833F03
block|,
literal|0xF6F009
block|,
literal|0x8C402B
block|,
literal|0x99316D
block|,
literal|0x07B439
block|,
literal|0x15200C
block|,
literal|0x5BC3D8
block|,
literal|0xC492F5
block|,
literal|0x4BADC6
block|,
literal|0xA5CA4E
block|,
literal|0xCD37A7
block|,
literal|0x36A9E6
block|,
literal|0x9492AB
block|,
literal|0x6842DD
block|,
literal|0xDE6319
block|,
literal|0xEF8C76
block|,
literal|0x528B68
block|,
literal|0x37DBFC
block|,
literal|0xABA1AE
block|,
literal|0x3115DF
block|,
literal|0xA1AE00
block|,
literal|0xDAFB0C
block|,
literal|0x664D64
block|,
literal|0xB705ED
block|,
literal|0x306529
block|,
literal|0xBF5657
block|,
literal|0x3AFF47
block|,
literal|0xB9F96A
block|,
literal|0xF3BE75
block|,
literal|0xDF9328
block|,
literal|0x3080AB
block|,
literal|0xF68C66
block|,
literal|0x15CB04
block|,
literal|0x0622FA
block|,
literal|0x1DE4D9
block|,
literal|0xA4B33D
block|,
literal|0x8F1B57
block|,
literal|0x09CD36
block|,
literal|0xE9424E
block|,
literal|0xA4BE13
block|,
literal|0xB52333
block|,
literal|0x1AAAF0
block|,
literal|0xA8654F
block|,
literal|0xA5C1D2
block|,
literal|0x0F3F0B
block|,
literal|0xCD785B
block|,
literal|0x76F923
block|,
literal|0x048B7B
block|,
literal|0x721789
block|,
literal|0x53A6C6
block|,
literal|0xE26E6F
block|,
literal|0x00EBEF
block|,
literal|0x584A9B
block|,
literal|0xB7DAC4
block|,
literal|0xBA66AA
block|,
literal|0xCFCF76
block|,
literal|0x1D02D1
block|,
literal|0x2DF1B1
block|,
literal|0xC1998C
block|,
literal|0x77ADC3
block|,
literal|0xDA4886
block|,
literal|0xA05DF7
block|,
literal|0xF480C6
block|,
literal|0x2FF0AC
block|,
literal|0x9AECDD
block|,
literal|0xBC5C3F
block|,
literal|0x6DDED0
block|,
literal|0x1FC790
block|,
literal|0xB6DB2A
block|,
literal|0x3A25A3
block|,
literal|0x9AAF00
block|,
literal|0x9353AD
block|,
literal|0x0457B6
block|,
literal|0xB42D29
block|,
literal|0x7E804B
block|,
literal|0xA707DA
block|,
literal|0x0EAA76
block|,
literal|0xA1597B
block|,
literal|0x2A1216
block|,
literal|0x2DB7DC
block|,
literal|0xFDE5FA
block|,
literal|0xFEDB89
block|,
literal|0xFDBE89
block|,
literal|0x6C76E4
block|,
literal|0xFCA906
block|,
literal|0x70803E
block|,
literal|0x156E85
block|,
literal|0xFF87FD
block|,
literal|0x073E28
block|,
literal|0x336761
block|,
literal|0x86182A
block|,
literal|0xEABD4D
block|,
literal|0xAFE7B3
block|,
literal|0x6E6D8F
block|,
literal|0x396795
block|,
literal|0x5BBF31
block|,
literal|0x48D784
block|,
literal|0x16DF30
block|,
literal|0x432DC7
block|,
literal|0x356125
block|,
literal|0xCE70C9
block|,
literal|0xB8CB30
block|,
literal|0xFD6CBF
block|,
literal|0xA200A4
block|,
literal|0xE46C05
block|,
literal|0xA0DD5A
block|,
literal|0x476F21
block|,
literal|0xD21262
block|,
literal|0x845CB9
block|,
literal|0x496170
block|,
literal|0xE0566B
block|,
literal|0x015299
block|,
literal|0x375550
block|,
literal|0xB7D51E
block|,
literal|0xC4F133
block|,
literal|0x5F6E13
block|,
literal|0xE4305D
block|,
literal|0xA92E85
block|,
literal|0xC3B21D
block|,
literal|0x3632A1
block|,
literal|0xA4B708
block|,
literal|0xD4B1EA
block|,
literal|0x21F716
block|,
literal|0xE4698F
block|,
literal|0x77FF27
block|,
literal|0x80030C
block|,
literal|0x2D408D
block|,
literal|0xA0CD4F
block|,
literal|0x99A520
block|,
literal|0xD3A2B3
block|,
literal|0x0A5D2F
block|,
literal|0x42F9B4
block|,
literal|0xCBDA11
block|,
literal|0xD0BE7D
block|,
literal|0xC1DB9B
block|,
literal|0xBD17AB
block|,
literal|0x81A2CA
block|,
literal|0x5C6A08
block|,
literal|0x17552E
block|,
literal|0x550027
block|,
literal|0xF0147F
block|,
literal|0x8607E1
block|,
literal|0x640B14
block|,
literal|0x8D4196
block|,
literal|0xDEBE87
block|,
literal|0x2AFDDA
block|,
literal|0xB6256B
block|,
literal|0x34897B
block|,
literal|0xFEF305
block|,
literal|0x9EBFB9
block|,
literal|0x4F6A68
block|,
literal|0xA82A4A
block|,
literal|0x5AC44F
block|,
literal|0xBCF82D
block|,
literal|0x985AD7
block|,
literal|0x95C7F4
block|,
literal|0x8D4D0D
block|,
literal|0xA63A20
block|,
literal|0x5F57A4
block|,
literal|0xB13F14
block|,
literal|0x953880
block|,
literal|0x0120CC
block|,
literal|0x86DD71
block|,
literal|0xB6DEC9
block|,
literal|0xF560BF
block|,
literal|0x11654D
block|,
literal|0x6B0701
block|,
literal|0xACB08C
block|,
literal|0xD0C0B2
block|,
literal|0x485551
block|,
literal|0x0EFB1E
block|,
literal|0xC37295
block|,
literal|0x3B06A3
block|,
literal|0x3540C0
block|,
literal|0x7BDC06
block|,
literal|0xCC45E0
block|,
literal|0xFA294E
block|,
literal|0xC8CAD6
block|,
literal|0x41F3E8
block|,
literal|0xDE647C
block|,
literal|0xD8649B
block|,
literal|0x31BED9
block|,
literal|0xC397A4
block|,
literal|0xD45877
block|,
literal|0xC5E369
block|,
literal|0x13DAF0
block|,
literal|0x3C3ABA
block|,
literal|0x461846
block|,
literal|0x5F7555
block|,
literal|0xF5BDD2
block|,
literal|0xC6926E
block|,
literal|0x5D2EAC
block|,
literal|0xED440E
block|,
literal|0x423E1C
block|,
literal|0x87C461
block|,
literal|0xE9FD29
block|,
literal|0xF3D6E7
block|,
literal|0xCA7C22
block|,
literal|0x35916F
block|,
literal|0xC5E008
block|,
literal|0x8DD7FF
block|,
literal|0xE26A6E
block|,
literal|0xC6FDB0
block|,
literal|0xC10893
block|,
literal|0x745D7C
block|,
literal|0xB2AD6B
block|,
literal|0x9D6ECD
block|,
literal|0x7B723E
block|,
literal|0x6A11C6
block|,
literal|0xA9CFF7
block|,
literal|0xDF7329
block|,
literal|0xBAC9B5
block|,
literal|0x5100B7
block|,
literal|0x0DB2E2
block|,
literal|0x24BA74
block|,
literal|0x607DE5
block|,
literal|0x8AD874
block|,
literal|0x2C150D
block|,
literal|0x0C1881
block|,
literal|0x94667E
block|,
literal|0x162901
block|,
literal|0x767A9F
block|,
literal|0xBEFDFD
block|,
literal|0xEF4556
block|,
literal|0x367ED9
block|,
literal|0x13D9EC
block|,
literal|0xB9BA8B
block|,
literal|0xFC97C4
block|,
literal|0x27A831
block|,
literal|0xC36EF1
block|,
literal|0x36C594
block|,
literal|0x56A8D8
block|,
literal|0xB5A8B4
block|,
literal|0x0ECCCF
block|,
literal|0x2D8912
block|,
literal|0x34576F
block|,
literal|0x89562C
block|,
literal|0xE3CE99
block|,
literal|0xB920D6
block|,
literal|0xAA5E6B
block|,
literal|0x9C2A3E
block|,
literal|0xCC5F11
block|,
literal|0x4A0BFD
block|,
literal|0xFBF4E1
block|,
literal|0x6D3B8E
block|,
literal|0x2C86E2
block|,
literal|0x84D4E9
block|,
literal|0xA9B4FC
block|,
literal|0xD1EEEF
block|,
literal|0xC9352E
block|,
literal|0x61392F
block|,
literal|0x442138
block|,
literal|0xC8D91B
block|,
literal|0x0AFC81
block|,
literal|0x6A4AFB
block|,
literal|0xD81C2F
block|,
literal|0x84B453
block|,
literal|0x8C994E
block|,
literal|0xCC2254
block|,
literal|0xDC552A
block|,
literal|0xD6C6C0
block|,
literal|0x96190B
block|,
literal|0xB8701A
block|,
literal|0x649569
block|,
literal|0x605A26
block|,
literal|0xEE523F
block|,
literal|0x0F117F
block|,
literal|0x11B5F4
block|,
literal|0xF5CBFC
block|,
literal|0x2DBC34
block|,
literal|0xEEBC34
block|,
literal|0xCC5DE8
block|,
literal|0x605EDD
block|,
literal|0x9B8E67
block|,
literal|0xEF3392
block|,
literal|0xB817C9
block|,
literal|0x9B5861
block|,
literal|0xBC57E1
block|,
literal|0xC68351
block|,
literal|0x103ED8
block|,
literal|0x4871DD
block|,
literal|0xDD1C2D
block|,
literal|0xA118AF
block|,
literal|0x462C21
block|,
literal|0xD7F359
block|,
literal|0x987AD9
block|,
literal|0xC0549E
block|,
literal|0xFA864F
block|,
literal|0xFC0656
block|,
literal|0xAE79E5
block|,
literal|0x362289
block|,
literal|0x22AD38
block|,
literal|0xDC9367
block|,
literal|0xAAE855
block|,
literal|0x382682
block|,
literal|0x9BE7CA
block|,
literal|0xA40D51
block|,
literal|0xB13399
block|,
literal|0x0ED7A9
block|,
literal|0x480569
block|,
literal|0xF0B265
block|,
literal|0xA7887F
block|,
literal|0x974C88
block|,
literal|0x36D1F9
block|,
literal|0xB39221
block|,
literal|0x4A827B
block|,
literal|0x21CF98
block|,
literal|0xDC9F40
block|,
literal|0x5547DC
block|,
literal|0x3A74E1
block|,
literal|0x42EB67
block|,
literal|0xDF9DFE
block|,
literal|0x5FD45E
block|,
literal|0xA4677B
block|,
literal|0x7AACBA
block|,
literal|0xA2F655
block|,
literal|0x23882B
block|,
literal|0x55BA41
block|,
literal|0x086E59
block|,
literal|0x862A21
block|,
literal|0x834739
block|,
literal|0xE6E389
block|,
literal|0xD49EE5
block|,
literal|0x40FB49
block|,
literal|0xE956FF
block|,
literal|0xCA0F1C
block|,
literal|0x8A59C5
block|,
literal|0x2BFA94
block|,
literal|0xC5C1D3
block|,
literal|0xCFC50F
block|,
literal|0xAE5ADB
block|,
literal|0x86C547
block|,
literal|0x624385
block|,
literal|0x3B8621
block|,
literal|0x94792C
block|,
literal|0x876110
block|,
literal|0x7B4C2A
block|,
literal|0x1A2C80
block|,
literal|0x12BF43
block|,
literal|0x902688
block|,
literal|0x893C78
block|,
literal|0xE4C4A8
block|,
literal|0x7BDBE5
block|,
literal|0xC23AC4
block|,
literal|0xEAF426
block|,
literal|0x8A67F7
block|,
literal|0xBF920D
block|,
literal|0x2BA365
block|,
literal|0xB1933D
block|,
literal|0x0B7CBD
block|,
literal|0xDC51A4
block|,
literal|0x63DD27
block|,
literal|0xDDE169
block|,
literal|0x19949A
block|,
literal|0x9529A8
block|,
literal|0x28CE68
block|,
literal|0xB4ED09
block|,
literal|0x209F44
block|,
literal|0xCA984E
block|,
literal|0x638270
block|,
literal|0x237C7E
block|,
literal|0x32B90F
block|,
literal|0x8EF5A7
block|,
literal|0xE75614
block|,
literal|0x08F121
block|,
literal|0x2A9DB5
block|,
literal|0x4D7E6F
block|,
literal|0x5119A5
block|,
literal|0xABF9B5
block|,
literal|0xD6DF82
block|,
literal|0x61DD96
block|,
literal|0x023616
block|,
literal|0x9F3AC4
block|,
literal|0xA1A283
block|,
literal|0x6DED72
block|,
literal|0x7A8D39
block|,
literal|0xA9B882
block|,
literal|0x5C326B
block|,
literal|0x5B2746
block|,
literal|0xED3400
block|,
literal|0x7700D2
block|,
literal|0x55F4FC
block|,
literal|0x4D5901
block|,
literal|0x8071E0
block|,
endif|#
directive|endif
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|PIo2
index|[]
init|=
block|{
literal|1.57079625129699707031e+00
block|,
comment|/* 0x3FF921FB, 0x40000000 */
literal|7.54978941586159635335e-08
block|,
comment|/* 0x3E74442D, 0x00000000 */
literal|5.39030252995776476554e-15
block|,
comment|/* 0x3CF84698, 0x80000000 */
literal|3.28200341580791294123e-22
block|,
comment|/* 0x3B78CC51, 0x60000000 */
literal|1.27065575308067607349e-29
block|,
comment|/* 0x39F01B83, 0x80000000 */
literal|1.22933308981111328932e-36
block|,
comment|/* 0x387A2520, 0x40000000 */
literal|2.73370053816464559624e-44
block|,
comment|/* 0x36E38222, 0x80000000 */
literal|2.16741683877804819444e-51
block|,
comment|/* 0x3569F31D, 0x00000000 */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|zero
init|=
literal|0.0
decl_stmt|,
name|one
init|=
literal|1.0
decl_stmt|,
name|two24
init|=
literal|1.67772160000000000000e+07
decl_stmt|,
comment|/* 0x41700000, 0x00000000 */
name|twon24
init|=
literal|5.96046447753906250000e-08
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* 0x3E700000, 0x00000000 */
end_comment

begin_function
name|int
name|__kernel_rem_pio2
parameter_list|(
name|double
modifier|*
name|x
parameter_list|,
name|double
modifier|*
name|y
parameter_list|,
name|int
name|e0
parameter_list|,
name|int
name|nx
parameter_list|,
name|int
name|prec
parameter_list|)
block|{
name|int32_t
name|jz
decl_stmt|,
name|jx
decl_stmt|,
name|jv
decl_stmt|,
name|jp
decl_stmt|,
name|jk
decl_stmt|,
name|carry
decl_stmt|,
name|n
decl_stmt|,
name|iq
index|[
literal|20
index|]
decl_stmt|,
name|i
decl_stmt|,
name|j
decl_stmt|,
name|k
decl_stmt|,
name|m
decl_stmt|,
name|q0
decl_stmt|,
name|ih
decl_stmt|;
name|double
name|z
decl_stmt|,
name|fw
decl_stmt|,
name|f
index|[
literal|20
index|]
decl_stmt|,
name|fq
index|[
literal|20
index|]
decl_stmt|,
name|q
index|[
literal|20
index|]
decl_stmt|;
comment|/* initialize jk*/
name|jk
operator|=
name|init_jk
index|[
name|prec
index|]
expr_stmt|;
name|jp
operator|=
name|jk
expr_stmt|;
comment|/* determine jx,jv,q0, note that 3>q0 */
name|jx
operator|=
name|nx
operator|-
literal|1
expr_stmt|;
name|jv
operator|=
operator|(
name|e0
operator|-
literal|3
operator|)
operator|/
literal|24
expr_stmt|;
if|if
condition|(
name|jv
operator|<
literal|0
condition|)
name|jv
operator|=
literal|0
expr_stmt|;
name|q0
operator|=
name|e0
operator|-
literal|24
operator|*
operator|(
name|jv
operator|+
literal|1
operator|)
expr_stmt|;
comment|/* set up f[0] to f[jx+jk] where f[jx+jk] = ipio2[jv+jk] */
name|j
operator|=
name|jv
operator|-
name|jx
expr_stmt|;
name|m
operator|=
name|jx
operator|+
name|jk
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<=
name|m
condition|;
name|i
operator|++
operator|,
name|j
operator|++
control|)
name|f
index|[
name|i
index|]
operator|=
operator|(
name|j
operator|<
literal|0
operator|)
condition|?
name|zero
else|:
operator|(
name|double
operator|)
name|ipio2
index|[
name|j
index|]
expr_stmt|;
comment|/* compute q[0],q[1],...q[jk] */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<=
name|jk
condition|;
name|i
operator|++
control|)
block|{
for|for
control|(
name|j
operator|=
literal|0
operator|,
name|fw
operator|=
literal|0.0
init|;
name|j
operator|<=
name|jx
condition|;
name|j
operator|++
control|)
name|fw
operator|+=
name|x
index|[
name|j
index|]
operator|*
name|f
index|[
name|jx
operator|+
name|i
operator|-
name|j
index|]
expr_stmt|;
name|q
index|[
name|i
index|]
operator|=
name|fw
expr_stmt|;
block|}
name|jz
operator|=
name|jk
expr_stmt|;
name|recompute
label|:
comment|/* distill q[] into iq[] reversingly */
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|j
operator|=
name|jz
operator|,
name|z
operator|=
name|q
index|[
name|jz
index|]
init|;
name|j
operator|>
literal|0
condition|;
name|i
operator|++
operator|,
name|j
operator|--
control|)
block|{
name|fw
operator|=
call|(
name|double
call|)
argument_list|(
call|(
name|int32_t
call|)
argument_list|(
name|twon24
operator|*
name|z
argument_list|)
argument_list|)
expr_stmt|;
name|iq
index|[
name|i
index|]
operator|=
call|(
name|int32_t
call|)
argument_list|(
name|z
operator|-
name|two24
operator|*
name|fw
argument_list|)
expr_stmt|;
name|z
operator|=
name|q
index|[
name|j
operator|-
literal|1
index|]
operator|+
name|fw
expr_stmt|;
block|}
comment|/* compute n */
name|z
operator|=
name|scalbn
argument_list|(
name|z
argument_list|,
name|q0
argument_list|)
expr_stmt|;
comment|/* actual value of z */
name|z
operator|-=
literal|8.0
operator|*
name|floor
argument_list|(
name|z
operator|*
literal|0.125
argument_list|)
expr_stmt|;
comment|/* trim off integer>= 8 */
name|n
operator|=
operator|(
name|int32_t
operator|)
name|z
expr_stmt|;
name|z
operator|-=
operator|(
name|double
operator|)
name|n
expr_stmt|;
name|ih
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|q0
operator|>
literal|0
condition|)
block|{
comment|/* need iq[jz-1] to determine n */
name|i
operator|=
operator|(
name|iq
index|[
name|jz
operator|-
literal|1
index|]
operator|>>
operator|(
literal|24
operator|-
name|q0
operator|)
operator|)
expr_stmt|;
name|n
operator|+=
name|i
expr_stmt|;
name|iq
index|[
name|jz
operator|-
literal|1
index|]
operator|-=
name|i
operator|<<
operator|(
literal|24
operator|-
name|q0
operator|)
expr_stmt|;
name|ih
operator|=
name|iq
index|[
name|jz
operator|-
literal|1
index|]
operator|>>
operator|(
literal|23
operator|-
name|q0
operator|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|q0
operator|==
literal|0
condition|)
name|ih
operator|=
name|iq
index|[
name|jz
operator|-
literal|1
index|]
operator|>>
literal|23
expr_stmt|;
elseif|else
if|if
condition|(
name|z
operator|>=
literal|0.5
condition|)
name|ih
operator|=
literal|2
expr_stmt|;
if|if
condition|(
name|ih
operator|>
literal|0
condition|)
block|{
comment|/* q> 0.5 */
name|n
operator|+=
literal|1
expr_stmt|;
name|carry
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|jz
condition|;
name|i
operator|++
control|)
block|{
comment|/* compute 1-q */
name|j
operator|=
name|iq
index|[
name|i
index|]
expr_stmt|;
if|if
condition|(
name|carry
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|j
operator|!=
literal|0
condition|)
block|{
name|carry
operator|=
literal|1
expr_stmt|;
name|iq
index|[
name|i
index|]
operator|=
literal|0x1000000
operator|-
name|j
expr_stmt|;
block|}
block|}
else|else
name|iq
index|[
name|i
index|]
operator|=
literal|0xffffff
operator|-
name|j
expr_stmt|;
block|}
if|if
condition|(
name|q0
operator|>
literal|0
condition|)
block|{
comment|/* rare case: chance is 1 in 12 */
switch|switch
condition|(
name|q0
condition|)
block|{
case|case
literal|1
case|:
name|iq
index|[
name|jz
operator|-
literal|1
index|]
operator|&=
literal|0x7fffff
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|iq
index|[
name|jz
operator|-
literal|1
index|]
operator|&=
literal|0x3fffff
expr_stmt|;
break|break;
block|}
block|}
if|if
condition|(
name|ih
operator|==
literal|2
condition|)
block|{
name|z
operator|=
name|one
operator|-
name|z
expr_stmt|;
if|if
condition|(
name|carry
operator|!=
literal|0
condition|)
name|z
operator|-=
name|scalbn
argument_list|(
name|one
argument_list|,
name|q0
argument_list|)
expr_stmt|;
block|}
block|}
comment|/* check if recomputation is needed */
if|if
condition|(
name|z
operator|==
name|zero
condition|)
block|{
name|j
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
name|jz
operator|-
literal|1
init|;
name|i
operator|>=
name|jk
condition|;
name|i
operator|--
control|)
name|j
operator||=
name|iq
index|[
name|i
index|]
expr_stmt|;
if|if
condition|(
name|j
operator|==
literal|0
condition|)
block|{
comment|/* need recomputation */
for|for
control|(
name|k
operator|=
literal|1
init|;
name|iq
index|[
name|jk
operator|-
name|k
index|]
operator|==
literal|0
condition|;
name|k
operator|++
control|)
empty_stmt|;
comment|/* k = no. of terms needed */
for|for
control|(
name|i
operator|=
name|jz
operator|+
literal|1
init|;
name|i
operator|<=
name|jz
operator|+
name|k
condition|;
name|i
operator|++
control|)
block|{
comment|/* add q[jz+1] to q[jz+k] */
name|f
index|[
name|jx
operator|+
name|i
index|]
operator|=
operator|(
name|double
operator|)
name|ipio2
index|[
name|jv
operator|+
name|i
index|]
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
operator|,
name|fw
operator|=
literal|0.0
init|;
name|j
operator|<=
name|jx
condition|;
name|j
operator|++
control|)
name|fw
operator|+=
name|x
index|[
name|j
index|]
operator|*
name|f
index|[
name|jx
operator|+
name|i
operator|-
name|j
index|]
expr_stmt|;
name|q
index|[
name|i
index|]
operator|=
name|fw
expr_stmt|;
block|}
name|jz
operator|+=
name|k
expr_stmt|;
goto|goto
name|recompute
goto|;
block|}
block|}
comment|/* chop off zero terms */
if|if
condition|(
name|z
operator|==
literal|0.0
condition|)
block|{
name|jz
operator|-=
literal|1
expr_stmt|;
name|q0
operator|-=
literal|24
expr_stmt|;
while|while
condition|(
name|iq
index|[
name|jz
index|]
operator|==
literal|0
condition|)
block|{
name|jz
operator|--
expr_stmt|;
name|q0
operator|-=
literal|24
expr_stmt|;
block|}
block|}
else|else
block|{
comment|/* break z into 24-bit if necessary */
name|z
operator|=
name|scalbn
argument_list|(
name|z
argument_list|,
operator|-
name|q0
argument_list|)
expr_stmt|;
if|if
condition|(
name|z
operator|>=
name|two24
condition|)
block|{
name|fw
operator|=
call|(
name|double
call|)
argument_list|(
call|(
name|int32_t
call|)
argument_list|(
name|twon24
operator|*
name|z
argument_list|)
argument_list|)
expr_stmt|;
name|iq
index|[
name|jz
index|]
operator|=
call|(
name|int32_t
call|)
argument_list|(
name|z
operator|-
name|two24
operator|*
name|fw
argument_list|)
expr_stmt|;
name|jz
operator|+=
literal|1
expr_stmt|;
name|q0
operator|+=
literal|24
expr_stmt|;
name|iq
index|[
name|jz
index|]
operator|=
operator|(
name|int32_t
operator|)
name|fw
expr_stmt|;
block|}
else|else
name|iq
index|[
name|jz
index|]
operator|=
operator|(
name|int32_t
operator|)
name|z
expr_stmt|;
block|}
comment|/* convert integer "bit" chunk to floating-point value */
name|fw
operator|=
name|scalbn
argument_list|(
name|one
argument_list|,
name|q0
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
name|jz
init|;
name|i
operator|>=
literal|0
condition|;
name|i
operator|--
control|)
block|{
name|q
index|[
name|i
index|]
operator|=
name|fw
operator|*
operator|(
name|double
operator|)
name|iq
index|[
name|i
index|]
expr_stmt|;
name|fw
operator|*=
name|twon24
expr_stmt|;
block|}
comment|/* compute PIo2[0,...,jp]*q[jz,...,0] */
for|for
control|(
name|i
operator|=
name|jz
init|;
name|i
operator|>=
literal|0
condition|;
name|i
operator|--
control|)
block|{
for|for
control|(
name|fw
operator|=
literal|0.0
operator|,
name|k
operator|=
literal|0
init|;
name|k
operator|<=
name|jp
operator|&&
name|k
operator|<=
name|jz
operator|-
name|i
condition|;
name|k
operator|++
control|)
name|fw
operator|+=
name|PIo2
index|[
name|k
index|]
operator|*
name|q
index|[
name|i
operator|+
name|k
index|]
expr_stmt|;
name|fq
index|[
name|jz
operator|-
name|i
index|]
operator|=
name|fw
expr_stmt|;
block|}
comment|/* compress fq[] into y[] */
switch|switch
condition|(
name|prec
condition|)
block|{
case|case
literal|0
case|:
name|fw
operator|=
literal|0.0
expr_stmt|;
for|for
control|(
name|i
operator|=
name|jz
init|;
name|i
operator|>=
literal|0
condition|;
name|i
operator|--
control|)
name|fw
operator|+=
name|fq
index|[
name|i
index|]
expr_stmt|;
name|y
index|[
literal|0
index|]
operator|=
operator|(
name|ih
operator|==
literal|0
operator|)
condition|?
name|fw
else|:
operator|-
name|fw
expr_stmt|;
break|break;
case|case
literal|1
case|:
case|case
literal|2
case|:
name|fw
operator|=
literal|0.0
expr_stmt|;
for|for
control|(
name|i
operator|=
name|jz
init|;
name|i
operator|>=
literal|0
condition|;
name|i
operator|--
control|)
name|fw
operator|+=
name|fq
index|[
name|i
index|]
expr_stmt|;
name|STRICT_ASSIGN
argument_list|(
name|double
argument_list|,
name|fw
argument_list|,
name|fw
argument_list|)
expr_stmt|;
name|y
index|[
literal|0
index|]
operator|=
operator|(
name|ih
operator|==
literal|0
operator|)
condition|?
name|fw
else|:
operator|-
name|fw
expr_stmt|;
name|fw
operator|=
name|fq
index|[
literal|0
index|]
operator|-
name|fw
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<=
name|jz
condition|;
name|i
operator|++
control|)
name|fw
operator|+=
name|fq
index|[
name|i
index|]
expr_stmt|;
name|y
index|[
literal|1
index|]
operator|=
operator|(
name|ih
operator|==
literal|0
operator|)
condition|?
name|fw
else|:
operator|-
name|fw
expr_stmt|;
break|break;
case|case
literal|3
case|:
comment|/* painful */
for|for
control|(
name|i
operator|=
name|jz
init|;
name|i
operator|>
literal|0
condition|;
name|i
operator|--
control|)
block|{
name|fw
operator|=
name|fq
index|[
name|i
operator|-
literal|1
index|]
operator|+
name|fq
index|[
name|i
index|]
expr_stmt|;
name|fq
index|[
name|i
index|]
operator|+=
name|fq
index|[
name|i
operator|-
literal|1
index|]
operator|-
name|fw
expr_stmt|;
name|fq
index|[
name|i
operator|-
literal|1
index|]
operator|=
name|fw
expr_stmt|;
block|}
for|for
control|(
name|i
operator|=
name|jz
init|;
name|i
operator|>
literal|1
condition|;
name|i
operator|--
control|)
block|{
name|fw
operator|=
name|fq
index|[
name|i
operator|-
literal|1
index|]
operator|+
name|fq
index|[
name|i
index|]
expr_stmt|;
name|fq
index|[
name|i
index|]
operator|+=
name|fq
index|[
name|i
operator|-
literal|1
index|]
operator|-
name|fw
expr_stmt|;
name|fq
index|[
name|i
operator|-
literal|1
index|]
operator|=
name|fw
expr_stmt|;
block|}
for|for
control|(
name|fw
operator|=
literal|0.0
operator|,
name|i
operator|=
name|jz
init|;
name|i
operator|>=
literal|2
condition|;
name|i
operator|--
control|)
name|fw
operator|+=
name|fq
index|[
name|i
index|]
expr_stmt|;
if|if
condition|(
name|ih
operator|==
literal|0
condition|)
block|{
name|y
index|[
literal|0
index|]
operator|=
name|fq
index|[
literal|0
index|]
expr_stmt|;
name|y
index|[
literal|1
index|]
operator|=
name|fq
index|[
literal|1
index|]
expr_stmt|;
name|y
index|[
literal|2
index|]
operator|=
name|fw
expr_stmt|;
block|}
else|else
block|{
name|y
index|[
literal|0
index|]
operator|=
operator|-
name|fq
index|[
literal|0
index|]
expr_stmt|;
name|y
index|[
literal|1
index|]
operator|=
operator|-
name|fq
index|[
literal|1
index|]
expr_stmt|;
name|y
index|[
literal|2
index|]
operator|=
operator|-
name|fw
expr_stmt|;
block|}
block|}
return|return
name|n
operator|&
literal|7
return|;
block|}
end_function

end_unit

