begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (c) 2015, Juniper Networks, Inc.  * All rights reserved.  * This SOFTWARE is licensed under the LICENSE provided in the  * ../Copyright file. By downloading, installing, copying, or otherwise  * using the SOFTWARE, you agree to be bound by the terms of that  * LICENSE.  * Phil Shafer, June 2015  */
end_comment

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<unistd.h>
end_include

begin_include
include|#
directive|include
file|<errno.h>
end_include

begin_include
include|#
directive|include
file|<ctype.h>
end_include

begin_include
include|#
directive|include
file|<time.h>
end_include

begin_include
include|#
directive|include
file|<sys/time.h>
end_include

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<locale.h>
end_include

begin_include
include|#
directive|include
file|<libintl.h>
end_include

begin_include
include|#
directive|include
file|"xo.h"
end_include

begin_function
name|int
name|main
parameter_list|(
name|int
name|argc
parameter_list|,
name|char
modifier|*
modifier|*
name|argv
parameter_list|)
block|{
specifier|static
name|char
name|domainname
index|[]
init|=
literal|"gt_01"
decl_stmt|;
name|char
name|path
index|[
name|MAXPATHLEN
index|]
decl_stmt|;
specifier|const
name|char
modifier|*
name|tzone
init|=
literal|"EST"
decl_stmt|;
specifier|const
name|char
modifier|*
name|lang
init|=
literal|"pig_latin"
decl_stmt|;
name|argc
operator|=
name|xo_parse_args
argument_list|(
name|argc
argument_list|,
name|argv
argument_list|)
expr_stmt|;
if|if
condition|(
name|argc
operator|<
literal|0
condition|)
return|return
literal|1
return|;
for|for
control|(
name|argc
operator|=
literal|1
init|;
name|argv
index|[
name|argc
index|]
condition|;
name|argc
operator|++
control|)
block|{
if|if
condition|(
name|strcmp
argument_list|(
name|argv
index|[
name|argc
index|]
argument_list|,
literal|"tz"
argument_list|)
operator|==
literal|0
condition|)
name|tzone
operator|=
name|argv
index|[
operator|++
name|argc
index|]
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
name|argv
index|[
name|argc
index|]
argument_list|,
literal|"lang"
argument_list|)
operator|==
literal|0
condition|)
name|lang
operator|=
name|argv
index|[
operator|++
name|argc
index|]
expr_stmt|;
elseif|else
if|if
condition|(
name|strcmp
argument_list|(
name|argv
index|[
name|argc
index|]
argument_list|,
literal|"po"
argument_list|)
operator|==
literal|0
condition|)
name|strlcpy
argument_list|(
name|path
argument_list|,
name|argv
index|[
operator|++
name|argc
index|]
argument_list|,
sizeof|sizeof
argument_list|(
name|path
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|setenv
argument_list|(
literal|"LANG"
argument_list|,
name|lang
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|setenv
argument_list|(
literal|"TZ"
argument_list|,
name|tzone
argument_list|,
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|path
index|[
literal|0
index|]
operator|==
literal|0
condition|)
block|{
name|getcwd
argument_list|(
name|path
argument_list|,
sizeof|sizeof
argument_list|(
name|path
argument_list|)
argument_list|)
expr_stmt|;
name|strlcat
argument_list|(
name|path
argument_list|,
literal|"/po"
argument_list|,
sizeof|sizeof
argument_list|(
name|path
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|setlocale
argument_list|(
name|LC_ALL
argument_list|,
literal|""
argument_list|)
expr_stmt|;
name|bindtextdomain
argument_list|(
name|domainname
argument_list|,
name|path
argument_list|)
expr_stmt|;
name|bindtextdomain
argument_list|(
literal|"ldns"
argument_list|,
name|path
argument_list|)
expr_stmt|;
name|bindtextdomain
argument_list|(
literal|"strerror"
argument_list|,
name|path
argument_list|)
expr_stmt|;
name|textdomain
argument_list|(
name|domainname
argument_list|)
expr_stmt|;
name|tzset
argument_list|()
expr_stmt|;
name|xo_open_container
argument_list|(
literal|"top"
argument_list|)
expr_stmt|;
name|xo_emit
argument_list|(
literal|"{G:}Your {qg:adjective} {g:noun} is {g:verb} {qg:owner} {g:target}\n"
argument_list|,
literal|"flaming"
argument_list|,
literal|"sword"
argument_list|,
literal|"burning"
argument_list|,
literal|"my"
argument_list|,
literal|"couch"
argument_list|)
expr_stmt|;
name|xo_emit
argument_list|(
literal|"{G:}The {qg:adjective} {g:noun} was {g:verb} {qg:owner} {g:target}\n"
argument_list|,
literal|"flaming"
argument_list|,
literal|"sword"
argument_list|,
literal|"burning"
argument_list|,
literal|"my"
argument_list|,
literal|"couch"
argument_list|)
expr_stmt|;
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|5
condition|;
name|i
operator|++
control|)
name|xo_emit
argument_list|(
literal|"{lw:bytes/%d}{Ngp:byte,bytes}\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|xo_emit
argument_list|(
literal|"{G:}{L:total} {:total/%u}\n"
argument_list|,
literal|1234
argument_list|)
expr_stmt|;
name|xo_emit
argument_list|(
literal|"{G:ldns}Received {:received/%zu} {Ngp:byte,bytes} "
literal|"from {:from/%s}#{:port/%d} in {:time/%d} ms\n"
argument_list|,
operator|(
name|size_t
operator|)
literal|1234
argument_list|,
literal|"foop"
argument_list|,
literal|4321
argument_list|,
literal|32
argument_list|)
expr_stmt|;
name|xo_emit
argument_list|(
literal|"{G:}Received {:received/%zu} {Ngp:byte,bytes} "
literal|"from {:from/%s}#{:port/%d} in {:time/%d} ms\n"
argument_list|,
operator|(
name|size_t
operator|)
literal|1234
argument_list|,
literal|"foop"
argument_list|,
literal|4321
argument_list|,
literal|32
argument_list|)
expr_stmt|;
name|xo_emit
argument_list|(
literal|"{G:/%s}Received {:received/%zu} {Ngp:byte,bytes} "
literal|"from {:from/%s}#{:port/%d} in {:time/%d} ms\n"
argument_list|,
literal|"ldns"
argument_list|,
operator|(
name|size_t
operator|)
literal|1234
argument_list|,
literal|"foop"
argument_list|,
literal|4321
argument_list|,
literal|32
argument_list|)
expr_stmt|;
name|struct
name|timeval
name|tv
decl_stmt|;
name|tv
operator|.
name|tv_sec
operator|=
literal|1435085229
expr_stmt|;
name|tv
operator|.
name|tv_usec
operator|=
literal|123456
expr_stmt|;
name|struct
name|tm
name|tm
decl_stmt|;
operator|(
name|void
operator|)
name|gmtime_r
argument_list|(
operator|&
name|tv
operator|.
name|tv_sec
argument_list|,
operator|&
name|tm
argument_list|)
expr_stmt|;
name|char
name|date
index|[
literal|64
index|]
decl_stmt|;
name|strftime
argument_list|(
name|date
argument_list|,
sizeof|sizeof
argument_list|(
name|date
argument_list|)
argument_list|,
literal|"%+"
argument_list|,
operator|&
name|tm
argument_list|)
expr_stmt|;
name|xo_emit
argument_list|(
literal|"{G:}Only {:marzlevanes/%d} {Ngp:marzlevane,marzlevanes} "
literal|"are functioning correctly\n"
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|xo_emit
argument_list|(
literal|"{G:}Version {:version} {:date}\n"
argument_list|,
literal|"1.2.3"
argument_list|,
name|date
argument_list|)
expr_stmt|;
name|errno
operator|=
name|EACCES
expr_stmt|;
name|xo_emit_warn
argument_list|(
literal|"{G:}Unable to {g:verb/objectulate} forward velociping"
argument_list|)
expr_stmt|;
name|xo_emit_warn
argument_list|(
literal|"{G:}{g:style/automatic} synchronization of {g:type/cardinal} "
literal|"{g:target/grammeters} failed"
argument_list|)
expr_stmt|;
name|xo_emit
argument_list|(
literal|"{G:}{Lwcg:hydrocoptic marzlevanes}{:marzlevanes/%d}\n"
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|xo_emit
argument_list|(
literal|"{G:}{Lwcg:Windings}{g:windings}\n"
argument_list|,
literal|"lotus-o-delta"
argument_list|)
expr_stmt|;
name|xo_close_container
argument_list|(
literal|"top"
argument_list|)
expr_stmt|;
name|xo_finish
argument_list|()
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

end_unit

