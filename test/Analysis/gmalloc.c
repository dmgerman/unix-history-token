begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|// RUN: %clang_cc1 -analyze -analyzer-checker=core,unix.Malloc -analyzer-store=region -verify %s
end_comment

begin_include
include|#
directive|include
file|"Inputs/system-header-simulator.h"
end_include

begin_typedef
typedef|typedef
name|void
modifier|*
name|gpointer
typedef|;
end_typedef

begin_typedef
typedef|typedef
specifier|const
name|void
modifier|*
name|gconstpointer
typedef|;
end_typedef

begin_typedef
typedef|typedef
name|unsigned
name|long
name|gsize
typedef|;
end_typedef

begin_typedef
typedef|typedef
name|unsigned
name|int
name|guint
typedef|;
end_typedef

begin_function_decl
name|gpointer
name|g_malloc
parameter_list|(
name|gsize
name|n_bytes
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|gpointer
name|g_malloc0
parameter_list|(
name|gsize
name|n_bytes
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|gpointer
name|g_realloc
parameter_list|(
name|gpointer
name|mem
parameter_list|,
name|gsize
name|n_bytes
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|gpointer
name|g_try_malloc
parameter_list|(
name|gsize
name|n_bytes
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|gpointer
name|g_try_malloc0
parameter_list|(
name|gsize
name|n_bytes
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|gpointer
name|g_try_realloc
parameter_list|(
name|gpointer
name|mem
parameter_list|,
name|gsize
name|n_bytes
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|gpointer
name|g_malloc_n
parameter_list|(
name|gsize
name|n_blocks
parameter_list|,
name|gsize
name|n_block_bytes
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|gpointer
name|g_malloc0_n
parameter_list|(
name|gsize
name|n_blocks
parameter_list|,
name|gsize
name|n_block_bytes
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|gpointer
name|g_realloc_n
parameter_list|(
name|gpointer
name|mem
parameter_list|,
name|gsize
name|n_blocks
parameter_list|,
name|gsize
name|n_block_bytes
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|gpointer
name|g_try_malloc_n
parameter_list|(
name|gsize
name|n_blocks
parameter_list|,
name|gsize
name|n_block_bytes
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|gpointer
name|g_try_malloc0_n
parameter_list|(
name|gsize
name|n_blocks
parameter_list|,
name|gsize
name|n_block_bytes
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|gpointer
name|g_try_realloc_n
parameter_list|(
name|gpointer
name|mem
parameter_list|,
name|gsize
name|n_blocks
parameter_list|,
name|gsize
name|n_block_bytes
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|g_free
parameter_list|(
name|gpointer
name|mem
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|gpointer
name|g_memdup
parameter_list|(
name|gconstpointer
name|mem
parameter_list|,
name|guint
name|byte_size
parameter_list|)
function_decl|;
end_function_decl

begin_decl_stmt
specifier|static
specifier|const
name|gsize
name|n_bytes
init|=
literal|1024
decl_stmt|;
end_decl_stmt

begin_function
name|void
name|f1
parameter_list|()
block|{
name|gpointer
name|g1
init|=
name|g_malloc
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|gpointer
name|g2
init|=
name|g_malloc0
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|g1
operator|=
name|g_realloc
argument_list|(
name|g1
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|)
expr_stmt|;
name|gpointer
name|g3
init|=
name|g_try_malloc
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|gpointer
name|g4
init|=
name|g_try_malloc0
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|g3
operator|=
name|g_try_realloc
argument_list|(
name|g3
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|)
expr_stmt|;
name|gpointer
name|g5
init|=
name|g_malloc_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|gpointer
name|g6
init|=
name|g_malloc0_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|g5
operator|=
name|g_realloc_n
argument_list|(
name|g5
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
expr_stmt|;
name|gpointer
name|g7
init|=
name|g_try_malloc_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|gpointer
name|g8
init|=
name|g_try_malloc0_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|g7
operator|=
name|g_try_realloc_n
argument_list|(
name|g7
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g1
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g2
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g2
argument_list|)
expr_stmt|;
comment|// expected-warning{{Attempt to free released memory}}
block|}
end_function

begin_function
name|void
name|f2
parameter_list|()
block|{
name|gpointer
name|g1
init|=
name|g_malloc
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|gpointer
name|g2
init|=
name|g_malloc0
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|g1
operator|=
name|g_realloc
argument_list|(
name|g1
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|)
expr_stmt|;
name|gpointer
name|g3
init|=
name|g_try_malloc
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|gpointer
name|g4
init|=
name|g_try_malloc0
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|g3
operator|=
name|g_try_realloc
argument_list|(
name|g3
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|)
expr_stmt|;
name|gpointer
name|g5
init|=
name|g_malloc_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|gpointer
name|g6
init|=
name|g_malloc0_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|g5
operator|=
name|g_realloc_n
argument_list|(
name|g5
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
expr_stmt|;
name|gpointer
name|g7
init|=
name|g_try_malloc_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|gpointer
name|g8
init|=
name|g_try_malloc0_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|g7
operator|=
name|g_try_realloc_n
argument_list|(
name|g7
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g1
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g2
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g3
argument_list|)
expr_stmt|;
name|g3
operator|=
name|g_memdup
argument_list|(
name|g3
argument_list|,
name|n_bytes
argument_list|)
expr_stmt|;
comment|// expected-warning{{Use of memory after it is freed}}
block|}
end_function

begin_function
name|void
name|f3
parameter_list|()
block|{
name|gpointer
name|g1
init|=
name|g_malloc
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|gpointer
name|g2
init|=
name|g_malloc0
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|g1
operator|=
name|g_realloc
argument_list|(
name|g1
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|)
expr_stmt|;
name|gpointer
name|g3
init|=
name|g_try_malloc
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|gpointer
name|g4
init|=
name|g_try_malloc0
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|g3
operator|=
name|g_try_realloc
argument_list|(
name|g3
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|)
expr_stmt|;
comment|// expected-warning{{Potential leak of memory pointed to by 'g4'}}
name|gpointer
name|g5
init|=
name|g_malloc_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|gpointer
name|g6
init|=
name|g_malloc0_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|g5
operator|=
name|g_realloc_n
argument_list|(
name|g5
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
expr_stmt|;
comment|// expected-warning{{Potential leak of memory pointed to by 'g6'}}
name|gpointer
name|g7
init|=
name|g_try_malloc_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
comment|// expected-warning{{Potential leak of memory pointed to by 'g5'}}
name|gpointer
name|g8
init|=
name|g_try_malloc0_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|g7
operator|=
name|g_try_realloc_n
argument_list|(
name|g7
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
expr_stmt|;
comment|// expected-warning{{Potential leak of memory pointed to by 'g8'}}
name|g_free
argument_list|(
name|g1
argument_list|)
expr_stmt|;
comment|// expected-warning{{Potential leak of memory pointed to by 'g7'}}
name|g_free
argument_list|(
name|g2
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g3
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|f4
parameter_list|()
block|{
name|gpointer
name|g1
init|=
name|g_malloc
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|gpointer
name|g2
init|=
name|g_malloc0
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|g1
operator|=
name|g_realloc
argument_list|(
name|g1
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|)
expr_stmt|;
name|gpointer
name|g3
init|=
name|g_try_malloc
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|gpointer
name|g4
init|=
name|g_try_malloc0
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|g3
operator|=
name|g_try_realloc
argument_list|(
name|g3
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|)
expr_stmt|;
name|gpointer
name|g5
init|=
name|g_malloc_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|gpointer
name|g6
init|=
name|g_malloc0_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|g5
operator|=
name|g_realloc_n
argument_list|(
name|g5
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
expr_stmt|;
comment|// expected-warning{{Potential leak of memory pointed to by 'g6'}}
name|gpointer
name|g7
init|=
name|g_try_malloc_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
comment|// expected-warning{{Potential leak of memory pointed to by 'g5'}}
name|gpointer
name|g8
init|=
name|g_try_malloc0_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|g7
operator|=
name|g_try_realloc_n
argument_list|(
name|g7
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
expr_stmt|;
comment|// expected-warning{{Potential leak of memory pointed to by 'g8'}}
name|g_free
argument_list|(
name|g1
argument_list|)
expr_stmt|;
comment|// expected-warning{{Potential leak of memory pointed to by 'g7'}}
name|g_free
argument_list|(
name|g2
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g3
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g4
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|f5
parameter_list|()
block|{
name|gpointer
name|g1
init|=
name|g_malloc
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|gpointer
name|g2
init|=
name|g_malloc0
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|g1
operator|=
name|g_realloc
argument_list|(
name|g1
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|)
expr_stmt|;
name|gpointer
name|g3
init|=
name|g_try_malloc
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|gpointer
name|g4
init|=
name|g_try_malloc0
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|g3
operator|=
name|g_try_realloc
argument_list|(
name|g3
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|)
expr_stmt|;
name|gpointer
name|g5
init|=
name|g_malloc_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|gpointer
name|g6
init|=
name|g_malloc0_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|g5
operator|=
name|g_realloc_n
argument_list|(
name|g5
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
expr_stmt|;
comment|// expected-warning{{Potential leak of memory pointed to by 'g6'}}
name|gpointer
name|g7
init|=
name|g_try_malloc_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|gpointer
name|g8
init|=
name|g_try_malloc0_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|g7
operator|=
name|g_try_realloc_n
argument_list|(
name|g7
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
expr_stmt|;
comment|// expected-warning{{Potential leak of memory pointed to by 'g8'}}
name|g_free
argument_list|(
name|g1
argument_list|)
expr_stmt|;
comment|// expected-warning{{Potential leak of memory pointed to by 'g7'}}
name|g_free
argument_list|(
name|g2
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g3
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g4
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g5
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|f6
parameter_list|()
block|{
name|gpointer
name|g1
init|=
name|g_malloc
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|gpointer
name|g2
init|=
name|g_malloc0
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|g1
operator|=
name|g_realloc
argument_list|(
name|g1
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|)
expr_stmt|;
name|gpointer
name|g3
init|=
name|g_try_malloc
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|gpointer
name|g4
init|=
name|g_try_malloc0
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|g3
operator|=
name|g_try_realloc
argument_list|(
name|g3
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|)
expr_stmt|;
name|gpointer
name|g5
init|=
name|g_malloc_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|gpointer
name|g6
init|=
name|g_malloc0_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|g5
operator|=
name|g_realloc_n
argument_list|(
name|g5
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
expr_stmt|;
name|gpointer
name|g7
init|=
name|g_try_malloc_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|gpointer
name|g8
init|=
name|g_try_malloc0_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|g7
operator|=
name|g_try_realloc_n
argument_list|(
name|g7
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
expr_stmt|;
comment|// expected-warning{{Potential leak of memory pointed to by 'g8'}}
name|g_free
argument_list|(
name|g1
argument_list|)
expr_stmt|;
comment|// expected-warning{{Potential leak of memory pointed to by 'g7'}}
name|g_free
argument_list|(
name|g2
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g3
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g4
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g5
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g6
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|f7
parameter_list|()
block|{
name|gpointer
name|g1
init|=
name|g_malloc
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|gpointer
name|g2
init|=
name|g_malloc0
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|g1
operator|=
name|g_realloc
argument_list|(
name|g1
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|)
expr_stmt|;
name|gpointer
name|g3
init|=
name|g_try_malloc
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|gpointer
name|g4
init|=
name|g_try_malloc0
argument_list|(
name|n_bytes
argument_list|)
decl_stmt|;
name|g3
operator|=
name|g_try_realloc
argument_list|(
name|g3
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|)
expr_stmt|;
name|gpointer
name|g5
init|=
name|g_malloc_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|gpointer
name|g6
init|=
name|g_malloc0_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|g5
operator|=
name|g_realloc_n
argument_list|(
name|g5
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
expr_stmt|;
name|gpointer
name|g7
init|=
name|g_try_malloc_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|gpointer
name|g8
init|=
name|g_try_malloc0_n
argument_list|(
name|n_bytes
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
decl_stmt|;
name|g7
operator|=
name|g_try_realloc_n
argument_list|(
name|g7
argument_list|,
name|n_bytes
operator|*
literal|2
argument_list|,
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
expr_stmt|;
comment|// expected-warning{{Potential leak of memory pointed to by 'g8'}}
name|g_free
argument_list|(
name|g1
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g2
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g3
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g4
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g5
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g6
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|g7
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

