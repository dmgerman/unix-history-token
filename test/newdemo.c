begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  *  newdemo.c	-	A demo program using PDCurses. The program illustrate  *  	 		the use of colours for text output.  *  * $Id: newdemo.c,v 1.40 2013/04/27 19:46:53 tom Exp $  */
end_comment

begin_include
include|#
directive|include
file|<test.priv.h>
end_include

begin_include
include|#
directive|include
file|<time.h>
end_include

begin_comment
comment|/*  *  The Australian map  */
end_comment

begin_decl_stmt
specifier|static
name|CONST_MENUS
name|char
modifier|*
name|AusMap
index|[
literal|16
index|]
init|=
block|{
literal|"           A           A "
block|,
literal|"    N.T. AAAAA       AAAA "
block|,
literal|"     AAAAAAAAAAA  AAAAAAAA "
block|,
literal|"   AAAAAAAAAAAAAAAAAAAAAAAAA Qld."
block|,
literal|"AAAAAAAAAAAAAAAAAAAAAAAAAAAAA "
block|,
literal|"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA "
block|,
literal|" AAAAAAAAAAAAAAAAAAAAAAAAAAAA "
block|,
literal|"   AAAAAAAAAAAAAAAAAAAAAAAAA N.S.W."
block|,
literal|"W.A. AAAAAAAAA      AAAAAA Vic."
block|,
literal|"       AAA   S.A.     AA"
block|,
literal|"                       A  Tas."
block|,
literal|""
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *  Funny messages  */
end_comment

begin_define
define|#
directive|define
name|NMESSAGES
value|6
end_define

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|messages
index|[]
init|=
block|{
literal|"Hello from the Land Down Under"
block|,
literal|"The Land of crocs. and a big Red Rock"
block|,
literal|"Where the sunflower runs along the highways"
block|,
literal|"the dusty red roads lead one to loneliness"
block|,
literal|"Blue sky in the morning and"
block|,
literal|"freezing nights and twinkling stars"
block|,
literal|""
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *  Trap interrupt  */
end_comment

begin_function
specifier|static
name|void
name|trap
parameter_list|(
name|int
name|sig
name|GCC_UNUSED
parameter_list|)
block|{
name|endwin
argument_list|()
expr_stmt|;
name|ExitProgram
argument_list|(
name|EXIT_FAILURE
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  Wait for user  */
end_comment

begin_function
specifier|static
name|int
name|WaitForUser
parameter_list|(
name|WINDOW
modifier|*
name|win
parameter_list|)
block|{
name|time_t
name|t
decl_stmt|;
name|chtype
name|key
decl_stmt|;
name|nodelay
argument_list|(
name|win
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|t
operator|=
name|time
argument_list|(
operator|(
name|time_t
operator|*
operator|)
literal|0
argument_list|)
expr_stmt|;
while|while
condition|(
literal|1
condition|)
block|{
if|if
condition|(
call|(
name|int
call|)
argument_list|(
name|key
operator|=
operator|(
name|chtype
operator|)
name|wgetch
argument_list|(
name|win
argument_list|)
argument_list|)
operator|!=
name|ERR
condition|)
block|{
if|if
condition|(
name|key
operator|==
literal|'q'
operator|||
name|key
operator|==
literal|'Q'
condition|)
return|return
literal|1
return|;
else|else
return|return
literal|0
return|;
block|}
if|if
condition|(
name|time
argument_list|(
operator|(
name|time_t
operator|*
operator|)
literal|0
argument_list|)
operator|-
name|t
operator|>
literal|5
condition|)
return|return
literal|0
return|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
name|set_colors
parameter_list|(
name|WINDOW
modifier|*
name|win
parameter_list|,
name|int
name|pair
parameter_list|,
name|int
name|foreground
parameter_list|,
name|int
name|background
parameter_list|)
block|{
if|if
condition|(
name|has_colors
argument_list|()
condition|)
block|{
if|if
condition|(
name|pair
operator|>
name|COLOR_PAIRS
condition|)
name|pair
operator|=
name|COLOR_PAIRS
expr_stmt|;
name|init_pair
argument_list|(
operator|(
name|short
operator|)
name|pair
argument_list|,
operator|(
name|short
operator|)
name|foreground
argument_list|,
operator|(
name|short
operator|)
name|background
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|wattrset
argument_list|(
name|win
argument_list|,
operator|(
name|int
operator|)
name|COLOR_PAIR
argument_list|(
name|pair
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|chtype
name|use_colors
parameter_list|(
name|WINDOW
modifier|*
name|win
parameter_list|,
name|int
name|pair
parameter_list|,
name|chtype
name|attrs
parameter_list|)
block|{
if|if
condition|(
name|has_colors
argument_list|()
condition|)
block|{
if|if
condition|(
name|pair
operator|>
name|COLOR_PAIRS
condition|)
name|pair
operator|=
name|COLOR_PAIRS
expr_stmt|;
name|attrs
operator||=
operator|(
name|chtype
operator|)
name|COLOR_PAIR
argument_list|(
name|pair
argument_list|)
expr_stmt|;
block|}
operator|(
name|void
operator|)
name|wattrset
argument_list|(
name|win
argument_list|,
operator|(
name|int
operator|)
name|attrs
argument_list|)
expr_stmt|;
return|return
name|attrs
return|;
block|}
end_function

begin_comment
comment|/*  * Test sub windows  */
end_comment

begin_function
specifier|static
name|int
name|SubWinTest
parameter_list|(
name|WINDOW
modifier|*
name|win
parameter_list|)
block|{
name|int
name|w
decl_stmt|,
name|h
decl_stmt|,
name|sw
decl_stmt|,
name|sh
decl_stmt|,
name|bx
decl_stmt|,
name|by
decl_stmt|;
name|WINDOW
modifier|*
name|swin1
decl_stmt|,
modifier|*
name|swin2
decl_stmt|,
modifier|*
name|swin3
decl_stmt|;
name|getmaxyx
argument_list|(
name|win
argument_list|,
name|h
argument_list|,
name|w
argument_list|)
expr_stmt|;
name|getbegyx
argument_list|(
name|win
argument_list|,
name|by
argument_list|,
name|bx
argument_list|)
expr_stmt|;
name|sw
operator|=
name|w
operator|/
literal|3
expr_stmt|;
name|sh
operator|=
name|h
operator|/
literal|3
expr_stmt|;
if|if
condition|(
operator|(
name|swin1
operator|=
name|subwin
argument_list|(
name|win
argument_list|,
name|sh
argument_list|,
name|sw
argument_list|,
name|by
operator|+
literal|3
argument_list|,
name|bx
operator|+
literal|5
argument_list|)
operator|)
operator|==
name|NULL
condition|)
block|{
return|return
literal|1
return|;
block|}
if|if
condition|(
operator|(
name|swin2
operator|=
name|subwin
argument_list|(
name|win
argument_list|,
name|sh
argument_list|,
name|sw
argument_list|,
name|by
operator|+
literal|4
argument_list|,
name|bx
operator|+
literal|8
argument_list|)
operator|)
operator|==
name|NULL
condition|)
block|{
name|delwin
argument_list|(
name|swin1
argument_list|)
expr_stmt|;
return|return
literal|1
return|;
block|}
if|if
condition|(
operator|(
name|swin3
operator|=
name|subwin
argument_list|(
name|win
argument_list|,
name|sh
argument_list|,
name|sw
argument_list|,
name|by
operator|+
literal|5
argument_list|,
name|bx
operator|+
literal|11
argument_list|)
operator|)
operator|==
name|NULL
condition|)
block|{
name|delwin
argument_list|(
name|swin1
argument_list|)
expr_stmt|;
name|delwin
argument_list|(
name|swin2
argument_list|)
expr_stmt|;
return|return
literal|1
return|;
block|}
name|set_colors
argument_list|(
name|swin1
argument_list|,
literal|8
argument_list|,
name|COLOR_RED
argument_list|,
name|COLOR_BLUE
argument_list|)
expr_stmt|;
name|werase
argument_list|(
name|swin1
argument_list|)
expr_stmt|;
name|MvWAddStr
argument_list|(
name|swin1
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
literal|"Sub-window 1"
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|swin1
argument_list|)
expr_stmt|;
name|set_colors
argument_list|(
name|swin2
argument_list|,
literal|9
argument_list|,
name|COLOR_CYAN
argument_list|,
name|COLOR_MAGENTA
argument_list|)
expr_stmt|;
name|werase
argument_list|(
name|swin2
argument_list|)
expr_stmt|;
name|MvWAddStr
argument_list|(
name|swin2
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
literal|"Sub-window 2"
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|swin2
argument_list|)
expr_stmt|;
name|set_colors
argument_list|(
name|swin3
argument_list|,
literal|10
argument_list|,
name|COLOR_YELLOW
argument_list|,
name|COLOR_GREEN
argument_list|)
expr_stmt|;
name|werase
argument_list|(
name|swin3
argument_list|)
expr_stmt|;
name|MvWAddStr
argument_list|(
name|swin3
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
literal|"Sub-window 3"
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|swin3
argument_list|)
expr_stmt|;
name|delwin
argument_list|(
name|swin1
argument_list|)
expr_stmt|;
name|delwin
argument_list|(
name|swin2
argument_list|)
expr_stmt|;
name|delwin
argument_list|(
name|swin3
argument_list|)
expr_stmt|;
name|WaitForUser
argument_list|(
name|win
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|bounce
parameter_list|(
name|int
name|n
parameter_list|,
name|int
modifier|*
name|dir
parameter_list|,
name|int
name|len
parameter_list|)
block|{
if|if
condition|(
operator|*
name|dir
operator|>
literal|0
condition|)
operator|++
name|n
expr_stmt|;
else|else
operator|--
name|n
expr_stmt|;
if|if
condition|(
name|n
operator|<=
literal|1
operator|||
name|n
operator|>=
name|len
operator|-
literal|2
condition|)
operator|*
name|dir
operator|=
operator|*
name|dir
condition|?
literal|0
else|:
literal|1
expr_stmt|;
return|return
name|n
return|;
block|}
end_function

begin_comment
comment|/*  *  Bouncing balls  */
end_comment

begin_function
specifier|static
name|int
name|BouncingBalls
parameter_list|(
name|WINDOW
modifier|*
name|win
parameter_list|)
block|{
name|int
name|w
decl_stmt|,
name|h
decl_stmt|;
name|int
name|x1
decl_stmt|,
name|y1
decl_stmt|,
name|xd1
decl_stmt|,
name|yd1
decl_stmt|;
name|int
name|x2
decl_stmt|,
name|y2
decl_stmt|,
name|xd2
decl_stmt|,
name|yd2
decl_stmt|;
name|int
name|x3
decl_stmt|,
name|y3
decl_stmt|,
name|xd3
decl_stmt|,
name|yd3
decl_stmt|;
name|getmaxyx
argument_list|(
name|win
argument_list|,
name|h
argument_list|,
name|w
argument_list|)
expr_stmt|;
name|x1
operator|=
literal|2
operator|+
name|rand
argument_list|()
operator|%
operator|(
name|w
operator|-
literal|4
operator|)
expr_stmt|;
name|y1
operator|=
literal|2
operator|+
name|rand
argument_list|()
operator|%
operator|(
name|h
operator|-
literal|4
operator|)
expr_stmt|;
name|x2
operator|=
literal|2
operator|+
name|rand
argument_list|()
operator|%
operator|(
name|w
operator|-
literal|4
operator|)
expr_stmt|;
name|y2
operator|=
literal|2
operator|+
name|rand
argument_list|()
operator|%
operator|(
name|h
operator|-
literal|4
operator|)
expr_stmt|;
name|x3
operator|=
literal|2
operator|+
name|rand
argument_list|()
operator|%
operator|(
name|w
operator|-
literal|4
operator|)
expr_stmt|;
name|y3
operator|=
literal|2
operator|+
name|rand
argument_list|()
operator|%
operator|(
name|h
operator|-
literal|4
operator|)
expr_stmt|;
name|xd1
operator|=
literal|1
expr_stmt|;
name|yd1
operator|=
literal|1
expr_stmt|;
name|xd2
operator|=
literal|1
expr_stmt|;
name|yd2
operator|=
literal|0
expr_stmt|;
name|xd3
operator|=
literal|0
expr_stmt|;
name|yd3
operator|=
literal|1
expr_stmt|;
name|nodelay
argument_list|(
name|win
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
while|while
condition|(
name|wgetch
argument_list|(
name|win
argument_list|)
operator|==
name|ERR
condition|)
block|{
name|x1
operator|=
name|bounce
argument_list|(
name|x1
argument_list|,
operator|&
name|xd1
argument_list|,
name|w
argument_list|)
expr_stmt|;
name|y1
operator|=
name|bounce
argument_list|(
name|y1
argument_list|,
operator|&
name|yd1
argument_list|,
name|h
argument_list|)
expr_stmt|;
name|x2
operator|=
name|bounce
argument_list|(
name|x2
argument_list|,
operator|&
name|xd2
argument_list|,
name|w
argument_list|)
expr_stmt|;
name|y2
operator|=
name|bounce
argument_list|(
name|y2
argument_list|,
operator|&
name|yd2
argument_list|,
name|h
argument_list|)
expr_stmt|;
name|x3
operator|=
name|bounce
argument_list|(
name|x3
argument_list|,
operator|&
name|xd3
argument_list|,
name|w
argument_list|)
expr_stmt|;
name|y3
operator|=
name|bounce
argument_list|(
name|y3
argument_list|,
operator|&
name|yd3
argument_list|,
name|h
argument_list|)
expr_stmt|;
name|set_colors
argument_list|(
name|win
argument_list|,
literal|11
argument_list|,
name|COLOR_RED
argument_list|,
name|COLOR_BLUE
argument_list|)
expr_stmt|;
name|MvWAddCh
argument_list|(
name|win
argument_list|,
name|y1
argument_list|,
name|x1
argument_list|,
literal|'O'
argument_list|)
expr_stmt|;
name|set_colors
argument_list|(
name|win
argument_list|,
literal|12
argument_list|,
name|COLOR_BLUE
argument_list|,
name|COLOR_RED
argument_list|)
expr_stmt|;
name|MvWAddCh
argument_list|(
name|win
argument_list|,
name|y2
argument_list|,
name|x2
argument_list|,
literal|'*'
argument_list|)
expr_stmt|;
name|set_colors
argument_list|(
name|win
argument_list|,
literal|13
argument_list|,
name|COLOR_YELLOW
argument_list|,
name|COLOR_WHITE
argument_list|)
expr_stmt|;
name|MvWAddCh
argument_list|(
name|win
argument_list|,
name|y3
argument_list|,
name|x3
argument_list|,
literal|'@'
argument_list|)
expr_stmt|;
name|wmove
argument_list|(
name|win
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|win
argument_list|)
expr_stmt|;
name|delay_output
argument_list|(
literal|100
argument_list|)
expr_stmt|;
block|}
return|return
literal|0
return|;
block|}
end_function

begin_comment
comment|/*  *  Main driver  */
end_comment

begin_function
name|int
name|main
parameter_list|(
name|int
name|argc
name|GCC_UNUSED
parameter_list|,
name|char
modifier|*
name|argv
index|[]
name|GCC_UNUSED
parameter_list|)
block|{
name|WINDOW
modifier|*
name|win
decl_stmt|;
name|int
name|w
decl_stmt|,
name|x
decl_stmt|,
name|y
decl_stmt|,
name|i
decl_stmt|,
name|j
decl_stmt|,
name|k
decl_stmt|;
name|char
name|buffer
index|[
name|SIZEOF
argument_list|(
name|messages
argument_list|)
operator|*
literal|80
index|]
decl_stmt|;
specifier|const
name|char
modifier|*
name|message
decl_stmt|;
name|int
name|width
decl_stmt|,
name|height
decl_stmt|;
name|chtype
name|save
index|[
literal|80
index|]
decl_stmt|;
name|chtype
name|c
decl_stmt|;
name|setlocale
argument_list|(
name|LC_ALL
argument_list|,
literal|""
argument_list|)
expr_stmt|;
name|CATCHALL
argument_list|(
name|trap
argument_list|)
expr_stmt|;
name|initscr
argument_list|()
expr_stmt|;
if|if
condition|(
name|has_colors
argument_list|()
condition|)
name|start_color
argument_list|()
expr_stmt|;
name|cbreak
argument_list|()
expr_stmt|;
name|curs_set
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|width
operator|=
literal|48
expr_stmt|;
name|height
operator|=
literal|14
expr_stmt|;
comment|/* Create a drawing window */
name|win
operator|=
name|newwin
argument_list|(
name|height
argument_list|,
name|width
argument_list|,
operator|(
name|LINES
operator|-
name|height
operator|)
operator|/
literal|2
argument_list|,
operator|(
name|COLS
operator|-
name|width
operator|)
operator|/
literal|2
argument_list|)
expr_stmt|;
if|if
condition|(
name|win
operator|==
name|NULL
condition|)
block|{
name|endwin
argument_list|()
expr_stmt|;
name|ExitProgram
argument_list|(
name|EXIT_FAILURE
argument_list|)
expr_stmt|;
block|}
while|while
condition|(
literal|1
condition|)
block|{
name|set_colors
argument_list|(
name|win
argument_list|,
literal|1
argument_list|,
name|COLOR_WHITE
argument_list|,
name|COLOR_BLUE
argument_list|)
expr_stmt|;
name|werase
argument_list|(
name|win
argument_list|)
expr_stmt|;
name|set_colors
argument_list|(
name|win
argument_list|,
literal|2
argument_list|,
name|COLOR_RED
argument_list|,
name|COLOR_RED
argument_list|)
expr_stmt|;
name|box
argument_list|(
name|win
argument_list|,
name|ACS_VLINE
argument_list|,
name|ACS_HLINE
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|win
argument_list|)
expr_stmt|;
comment|/* Do ramdom output of a character */
name|use_colors
argument_list|(
name|win
argument_list|,
literal|1
argument_list|,
name|A_NORMAL
argument_list|)
expr_stmt|;
name|c
operator|=
literal|'a'
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|5000
condition|;
operator|++
name|i
control|)
block|{
name|x
operator|=
name|rand
argument_list|()
operator|%
operator|(
name|width
operator|-
literal|2
operator|)
operator|+
literal|1
expr_stmt|;
name|y
operator|=
name|rand
argument_list|()
operator|%
operator|(
name|height
operator|-
literal|2
operator|)
operator|+
literal|1
expr_stmt|;
name|MvWAddCh
argument_list|(
name|win
argument_list|,
name|y
argument_list|,
name|x
argument_list|,
name|c
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|win
argument_list|)
expr_stmt|;
name|nodelay
argument_list|(
name|win
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
if|if
condition|(
name|wgetch
argument_list|(
name|win
argument_list|)
operator|!=
name|ERR
condition|)
break|break;
if|if
condition|(
name|i
operator|==
literal|2000
condition|)
block|{
name|c
operator|=
literal|'b'
expr_stmt|;
name|set_colors
argument_list|(
name|win
argument_list|,
literal|3
argument_list|,
name|COLOR_CYAN
argument_list|,
name|COLOR_YELLOW
argument_list|)
expr_stmt|;
block|}
block|}
name|SubWinTest
argument_list|(
name|win
argument_list|)
expr_stmt|;
comment|/* Erase and draw green window */
name|set_colors
argument_list|(
name|win
argument_list|,
literal|4
argument_list|,
name|COLOR_YELLOW
argument_list|,
name|COLOR_GREEN
argument_list|)
expr_stmt|;
name|wbkgd
argument_list|(
name|win
argument_list|,
name|use_colors
argument_list|(
name|win
argument_list|,
literal|4
argument_list|,
name|A_BOLD
argument_list|)
argument_list|)
expr_stmt|;
name|werase
argument_list|(
name|win
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|win
argument_list|)
expr_stmt|;
comment|/* Draw RED bounding box */
name|use_colors
argument_list|(
name|win
argument_list|,
literal|2
argument_list|,
name|A_NORMAL
argument_list|)
expr_stmt|;
name|box
argument_list|(
name|win
argument_list|,
literal|' '
argument_list|,
literal|' '
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|win
argument_list|)
expr_stmt|;
comment|/* Display Australia map */
name|use_colors
argument_list|(
name|win
argument_list|,
literal|4
argument_list|,
name|A_BOLD
argument_list|)
expr_stmt|;
name|i
operator|=
literal|0
expr_stmt|;
while|while
condition|(
operator|*
name|AusMap
index|[
name|i
index|]
condition|)
block|{
name|MvWAddStr
argument_list|(
name|win
argument_list|,
name|i
operator|+
literal|1
argument_list|,
literal|8
argument_list|,
name|AusMap
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|win
argument_list|)
expr_stmt|;
name|delay_output
argument_list|(
literal|50
argument_list|)
expr_stmt|;
operator|++
name|i
expr_stmt|;
block|}
name|set_colors
argument_list|(
name|win
argument_list|,
literal|5
argument_list|,
name|COLOR_BLUE
argument_list|,
name|COLOR_WHITE
argument_list|)
expr_stmt|;
name|use_colors
argument_list|(
name|win
argument_list|,
literal|5
argument_list|,
name|A_BLINK
argument_list|)
expr_stmt|;
name|MvWAddStr
argument_list|(
name|win
argument_list|,
name|height
operator|-
literal|2
argument_list|,
literal|6
argument_list|,
literal|" PDCurses 2.1 for DOS, OS/2 and Unix"
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|win
argument_list|)
expr_stmt|;
comment|/* Draw running messages */
name|set_colors
argument_list|(
name|win
argument_list|,
literal|6
argument_list|,
name|COLOR_YELLOW
argument_list|,
name|COLOR_WHITE
argument_list|)
expr_stmt|;
name|message
operator|=
name|messages
index|[
name|j
operator|=
literal|0
index|]
expr_stmt|;
name|i
operator|=
literal|1
expr_stmt|;
name|w
operator|=
name|width
operator|-
literal|2
expr_stmt|;
name|strcpy
argument_list|(
name|buffer
argument_list|,
name|message
argument_list|)
expr_stmt|;
while|while
condition|(
name|j
operator|<
name|NMESSAGES
condition|)
block|{
while|while
condition|(
operator|(
name|int
operator|)
name|strlen
argument_list|(
name|buffer
argument_list|)
operator|<
name|w
condition|)
block|{
name|strcat
argument_list|(
name|buffer
argument_list|,
literal|" ... "
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|buffer
argument_list|,
name|messages
index|[
operator|++
name|j
operator|%
name|NMESSAGES
index|]
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|i
operator|<
name|w
condition|)
operator|(
name|void
operator|)
name|mvwaddnstr
argument_list|(
name|win
argument_list|,
name|height
operator|/
literal|2
argument_list|,
name|w
operator|-
name|i
argument_list|,
name|buffer
argument_list|,
name|i
argument_list|)
expr_stmt|;
else|else
operator|(
name|void
operator|)
name|mvwaddnstr
argument_list|(
name|win
argument_list|,
name|height
operator|/
literal|2
argument_list|,
literal|1
argument_list|,
name|buffer
argument_list|,
name|w
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|win
argument_list|)
expr_stmt|;
name|nodelay
argument_list|(
name|win
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
if|if
condition|(
name|wgetch
argument_list|(
name|win
argument_list|)
operator|!=
name|ERR
condition|)
block|{
name|flushinp
argument_list|()
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|i
operator|++
operator|>=
name|w
condition|)
block|{
for|for
control|(
name|k
operator|=
literal|0
init|;
operator|(
name|buffer
index|[
name|k
index|]
operator|=
name|buffer
index|[
name|k
operator|+
literal|1
index|]
operator|)
operator|!=
literal|'\0'
condition|;
name|k
operator|++
control|)
empty_stmt|;
block|}
name|delay_output
argument_list|(
literal|100
argument_list|)
expr_stmt|;
block|}
name|j
operator|=
literal|0
expr_stmt|;
comment|/*  Draw running As across in RED */
name|set_colors
argument_list|(
name|win
argument_list|,
literal|7
argument_list|,
name|COLOR_RED
argument_list|,
name|COLOR_GREEN
argument_list|)
expr_stmt|;
name|memset
argument_list|(
name|save
argument_list|,
literal|' '
argument_list|,
sizeof|sizeof
argument_list|(
name|save
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|2
init|;
name|i
operator|<
name|width
operator|-
literal|4
condition|;
operator|++
name|i
control|)
block|{
name|k
operator|=
operator|(
name|int
operator|)
name|mvwinch
argument_list|(
name|win
argument_list|,
literal|4
argument_list|,
name|i
argument_list|)
expr_stmt|;
if|if
condition|(
name|k
operator|==
name|ERR
condition|)
break|break;
name|save
index|[
name|j
operator|++
index|]
operator|=
name|c
operator|=
operator|(
name|chtype
operator|)
name|k
expr_stmt|;
name|c
operator|&=
name|A_CHARTEXT
expr_stmt|;
name|MvWAddCh
argument_list|(
name|win
argument_list|,
literal|4
argument_list|,
name|i
argument_list|,
name|c
argument_list|)
expr_stmt|;
block|}
name|wrefresh
argument_list|(
name|win
argument_list|)
expr_stmt|;
comment|/* Put a message up wait for a key */
name|i
operator|=
name|height
operator|-
literal|2
expr_stmt|;
name|use_colors
argument_list|(
name|win
argument_list|,
literal|5
argument_list|,
name|A_NORMAL
argument_list|)
expr_stmt|;
name|MvWAddStr
argument_list|(
name|win
argument_list|,
name|i
argument_list|,
literal|5
argument_list|,
literal|" Type a key to continue or 'Q' to quit "
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|win
argument_list|)
expr_stmt|;
if|if
condition|(
name|WaitForUser
argument_list|(
name|win
argument_list|)
operator|==
literal|1
condition|)
break|break;
name|j
operator|=
literal|0
expr_stmt|;
comment|/* Restore the old line */
for|for
control|(
name|i
operator|=
literal|2
init|;
name|i
operator|<
name|width
operator|-
literal|4
condition|;
operator|++
name|i
control|)
name|MvWAddCh
argument_list|(
name|win
argument_list|,
literal|4
argument_list|,
name|i
argument_list|,
name|save
index|[
name|j
operator|++
index|]
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|win
argument_list|)
expr_stmt|;
name|BouncingBalls
argument_list|(
name|win
argument_list|)
expr_stmt|;
comment|/* Put a message up wait for a key */
name|i
operator|=
name|height
operator|-
literal|2
expr_stmt|;
name|use_colors
argument_list|(
name|win
argument_list|,
literal|5
argument_list|,
name|A_NORMAL
argument_list|)
expr_stmt|;
name|MvWAddStr
argument_list|(
name|win
argument_list|,
name|i
argument_list|,
literal|5
argument_list|,
literal|" Type a key to continue or 'Q' to quit "
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|win
argument_list|)
expr_stmt|;
if|if
condition|(
name|WaitForUser
argument_list|(
name|win
argument_list|)
operator|==
literal|1
condition|)
break|break;
block|}
name|endwin
argument_list|()
expr_stmt|;
name|ExitProgram
argument_list|(
name|EXIT_SUCCESS
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

