begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|// RUN: %clang_cc1 -triple x86_64-unknown-unknown %s -emit-llvm -o - | FileCheck %s
end_comment

begin_struct
struct|struct
name|P1
block|{
struct|struct
name|Q1
block|{
name|char
name|a
index|[
literal|6
index|]
decl_stmt|;
name|char
name|b
index|[
literal|6
index|]
decl_stmt|;
block|}
name|q
struct|;
block|}
struct|;
end_struct

begin_comment
comment|// CHECK: { [6 x i8] c"foo\00\00\00", [6 x i8] c"\00x\00\00\00\00" }
end_comment

begin_decl_stmt
name|struct
name|P1
name|l1
init|=
block|{
operator|(
expr|struct
name|Q1
operator|)
block|{
literal|"foo"
block|,
literal|"bar"
block|}
block|,
operator|.
name|q
operator|.
name|b
operator|=
block|{
literal|"boo"
block|}
block|,
operator|.
name|q
operator|.
name|b
operator|=
block|{
index|[
literal|1
index|]
operator|=
literal|'x'
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|// CHECK: { [6 x i8] c"foo\00\00\00", [6 x i8] c"bxo\00\00\00" }
end_comment

begin_decl_stmt
name|struct
name|P1
name|l1a
init|=
block|{
operator|(
expr|struct
name|Q1
operator|)
block|{
literal|"foo"
block|,
literal|"bar"
block|}
block|,
operator|.
name|q
operator|.
name|b
operator|=
block|{
literal|"boo"
block|}
block|,
operator|.
name|q
operator|.
name|b
index|[
literal|1
index|]
operator|=
literal|'x'
block|}
decl_stmt|;
end_decl_stmt

begin_struct
struct|struct
name|P2
block|{
name|char
name|x
index|[
literal|6
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|// CHECK: { [6 x i8] c"n\00\00\00\00\00" }
end_comment

begin_decl_stmt
name|struct
name|P2
name|l2
init|=
block|{
operator|.
name|x
operator|=
block|{
index|[
literal|1
index|]
operator|=
literal|'o'
block|}
block|,
operator|.
name|x
operator|=
block|{
index|[
literal|0
index|]
operator|=
literal|'n'
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_struct
struct|struct
name|P3
block|{
struct|struct
name|Q3
block|{
struct|struct
name|R1
block|{
name|int
name|a
decl_stmt|,
name|b
decl_stmt|,
name|c
decl_stmt|;
block|}
name|r1
struct|;
struct|struct
name|R2
block|{
name|int
name|d
decl_stmt|,
name|e
decl_stmt|,
name|f
decl_stmt|;
block|}
name|r2
struct|;
block|}
name|q
struct|;
block|}
struct|;
end_struct

begin_comment
comment|// CHECK: @l3 = global %struct.P3 { %struct.Q3 { %struct.R1 { i32 1, i32 2, i32 3 }, %struct.R2 { i32 0, i32 10, i32 0 } } }
end_comment

begin_decl_stmt
name|struct
name|P3
name|l3
init|=
block|{
operator|(
expr|struct
name|Q3
operator|)
block|{
block|{
literal|1
block|,
literal|2
block|,
literal|3
block|}
block|,
block|{
literal|4
block|,
literal|5
block|,
literal|6
block|}
block|}
block|,
operator|.
name|q
operator|.
name|r2
operator|=
block|{
literal|7
block|,
literal|8
block|,
literal|9
block|}
block|,
operator|.
name|q
operator|.
name|r2
operator|=
block|{
operator|.
name|e
operator|=
literal|10
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|// This bit is taken from Sema/wchar.c so we can avoid the wchar.h include.
end_comment

begin_typedef
typedef|typedef
name|__WCHAR_TYPE__
name|wchar_t
typedef|;
end_typedef

begin_struct
struct|struct
name|P4
block|{
name|wchar_t
name|x
index|[
literal|6
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|// CHECK: { [6 x i32] [i32 102, i32 111, i32 120, i32 0, i32 0, i32 0] }
end_comment

begin_decl_stmt
name|struct
name|P4
name|l4
init|=
block|{
block|{
literal|L"foo"
block|}
block|,
operator|.
name|x
index|[
literal|2
index|]
operator|=
literal|L'
expr|x'
block|}
decl_stmt|;
end_decl_stmt

begin_struct
struct|struct
name|P5
block|{
name|int
name|x
decl_stmt|;
struct|struct
name|Q5
block|{
name|int
name|a
decl_stmt|,
name|b
decl_stmt|,
name|c
decl_stmt|;
block|}
name|q
struct|;
name|int
name|y
decl_stmt|;
block|}
struct|;
end_struct

begin_comment
comment|// A three-pass test
end_comment

begin_comment
comment|// CHECK: @l5 = global %struct.P5 { i32 1, %struct.Q5 { i32 6, i32 9, i32 8 }, i32 5 }
end_comment

begin_decl_stmt
name|struct
name|P5
name|l5
init|=
block|{
literal|1
block|,
block|{
literal|2
block|,
literal|3
block|,
literal|4
block|}
block|,
literal|5
block|,
operator|.
name|q
operator|=
block|{
literal|6
block|,
literal|7
block|,
literal|8
block|}
block|,
operator|.
name|q
operator|.
name|b
operator|=
literal|9
block|}
decl_stmt|;
end_decl_stmt

end_unit

