begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|// RUN: clang-cc -emit-llvm -o %t %s&&
end_comment

begin_comment
comment|// RUN: not grep __builtin %t
end_comment

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<math.h>
end_include

begin_function
name|void
name|p
parameter_list|(
name|char
modifier|*
name|str
parameter_list|,
name|int
name|x
parameter_list|)
block|{
name|printf
argument_list|(
literal|"%s: %d\n"
argument_list|,
name|str
argument_list|,
name|x
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|q
parameter_list|(
name|char
modifier|*
name|str
parameter_list|,
name|double
name|x
parameter_list|)
block|{
name|printf
argument_list|(
literal|"%s: %f\n"
argument_list|,
name|str
argument_list|,
name|x
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|int
name|main
parameter_list|()
block|{
name|int
name|N
init|=
name|random
argument_list|()
decl_stmt|;
define|#
directive|define
name|P
parameter_list|(
name|n
parameter_list|,
name|args
parameter_list|)
value|p(#n #args, __builtin_##n args)
define|#
directive|define
name|Q
parameter_list|(
name|n
parameter_list|,
name|args
parameter_list|)
value|q(#n #args, __builtin_##n args)
define|#
directive|define
name|V
parameter_list|(
name|n
parameter_list|,
name|args
parameter_list|)
value|p(#n #args, (__builtin_##n args, 0))
name|P
argument_list|(
name|types_compatible_p
argument_list|,
operator|(
name|int
operator|,
name|float
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|choose_expr
argument_list|,
operator|(
literal|0
operator|,
literal|10
operator|,
literal|20
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|constant_p
argument_list|,
operator|(
sizeof|sizeof
argument_list|(
literal|10
argument_list|)
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|expect
argument_list|,
operator|(
name|N
operator|==
literal|12
operator|,
literal|0
operator|)
argument_list|)
expr_stmt|;
name|V
argument_list|(
name|prefetch
argument_list|,
operator|(
operator|&
name|N
operator|)
argument_list|)
expr_stmt|;
name|V
argument_list|(
name|prefetch
argument_list|,
operator|(
operator|&
name|N
operator|,
literal|1
operator|)
argument_list|)
expr_stmt|;
name|V
argument_list|(
name|prefetch
argument_list|,
operator|(
operator|&
name|N
operator|,
literal|1
operator|,
literal|0
operator|)
argument_list|)
expr_stmt|;
comment|// Numeric Constants
name|Q
argument_list|(
name|huge_val
argument_list|,
operator|(
operator|)
argument_list|)
expr_stmt|;
name|Q
argument_list|(
name|huge_valf
argument_list|,
operator|(
operator|)
argument_list|)
expr_stmt|;
name|Q
argument_list|(
name|huge_vall
argument_list|,
operator|(
operator|)
argument_list|)
expr_stmt|;
name|Q
argument_list|(
name|inf
argument_list|,
operator|(
operator|)
argument_list|)
expr_stmt|;
name|Q
argument_list|(
name|inff
argument_list|,
operator|(
operator|)
argument_list|)
expr_stmt|;
name|Q
argument_list|(
name|infl
argument_list|,
operator|(
operator|)
argument_list|)
expr_stmt|;
comment|// FIXME:
comment|// XXX note funny semantics for the (last) argument
comment|//  P(fpclassify, (FP_NAN, FP_INFINITE, FP_NORMAL, FP_SUBNORMAL, FP_ZERO, 1.0));
comment|//  P(isinf_sign, (1.0));
name|Q
argument_list|(
name|nan
argument_list|,
operator|(
literal|""
operator|)
argument_list|)
expr_stmt|;
name|Q
argument_list|(
name|nanf
argument_list|,
operator|(
literal|""
operator|)
argument_list|)
expr_stmt|;
name|Q
argument_list|(
name|nanl
argument_list|,
operator|(
literal|""
operator|)
argument_list|)
expr_stmt|;
name|Q
argument_list|(
name|nans
argument_list|,
operator|(
literal|""
operator|)
argument_list|)
expr_stmt|;
name|Q
argument_list|(
name|nan
argument_list|,
operator|(
literal|"10"
operator|)
argument_list|)
expr_stmt|;
name|Q
argument_list|(
name|nanf
argument_list|,
operator|(
literal|"10"
operator|)
argument_list|)
expr_stmt|;
name|Q
argument_list|(
name|nanl
argument_list|,
operator|(
literal|"10"
operator|)
argument_list|)
expr_stmt|;
name|Q
argument_list|(
name|nans
argument_list|,
operator|(
literal|"10"
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|isgreater
argument_list|,
operator|(
literal|1.
operator|,
literal|2.
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|isgreaterequal
argument_list|,
operator|(
literal|1.
operator|,
literal|2.
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|isless
argument_list|,
operator|(
literal|1.
operator|,
literal|2.
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|islessequal
argument_list|,
operator|(
literal|1.
operator|,
literal|2.
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|islessgreater
argument_list|,
operator|(
literal|1.
operator|,
literal|2.
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|isunordered
argument_list|,
operator|(
literal|1.
operator|,
literal|2.
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|isnan
argument_list|,
operator|(
literal|1.
operator|)
argument_list|)
expr_stmt|;
comment|// Bitwise& Numeric Functions
name|P
argument_list|(
name|abs
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|clz
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|clzl
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|clzll
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|ctz
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|ctzl
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|ctzll
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|ffs
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|ffsl
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|ffsll
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|parity
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|parityl
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|parityll
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|popcount
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|popcountl
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|popcountll
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
name|Q
argument_list|(
name|powi
argument_list|,
operator|(
literal|1.2f
operator|,
name|N
operator|)
argument_list|)
expr_stmt|;
name|Q
argument_list|(
name|powif
argument_list|,
operator|(
literal|1.2f
operator|,
name|N
operator|)
argument_list|)
expr_stmt|;
name|Q
argument_list|(
name|powil
argument_list|,
operator|(
literal|1.2f
operator|,
name|N
operator|)
argument_list|)
expr_stmt|;
comment|// Lib functions
name|int
name|a
decl_stmt|,
name|b
decl_stmt|,
name|n
init|=
name|random
argument_list|()
decl_stmt|;
comment|// Avoid optimizing out.
name|char
name|s0
index|[
literal|10
index|]
decl_stmt|,
name|s1
index|[]
init|=
literal|"Hello"
decl_stmt|;
name|V
argument_list|(
name|strcat
argument_list|,
operator|(
name|s0
operator|,
name|s1
operator|)
argument_list|)
expr_stmt|;
name|V
argument_list|(
name|strcmp
argument_list|,
operator|(
name|s0
operator|,
name|s1
operator|)
argument_list|)
expr_stmt|;
name|V
argument_list|(
name|strncat
argument_list|,
operator|(
name|s0
operator|,
name|s1
operator|,
name|n
operator|)
argument_list|)
expr_stmt|;
name|V
argument_list|(
name|strchr
argument_list|,
operator|(
name|s0
operator|,
name|s1
index|[
literal|0
index|]
operator|)
argument_list|)
expr_stmt|;
name|V
argument_list|(
name|strrchr
argument_list|,
operator|(
name|s0
operator|,
name|s1
index|[
literal|0
index|]
operator|)
argument_list|)
expr_stmt|;
name|V
argument_list|(
name|strcpy
argument_list|,
operator|(
name|s0
operator|,
name|s1
operator|)
argument_list|)
expr_stmt|;
name|V
argument_list|(
name|strncpy
argument_list|,
operator|(
name|s0
operator|,
name|s1
operator|,
name|n
operator|)
argument_list|)
expr_stmt|;
comment|// Object size checking
name|V
argument_list|(
name|__memset_chk
argument_list|,
operator|(
name|s0
operator|,
literal|0
operator|,
sizeof|sizeof
name|s0
operator|,
name|n
operator|)
argument_list|)
expr_stmt|;
name|V
argument_list|(
name|__memcpy_chk
argument_list|,
operator|(
name|s0
operator|,
name|s1
operator|,
sizeof|sizeof
name|s0
operator|,
name|n
operator|)
argument_list|)
expr_stmt|;
name|V
argument_list|(
name|__memmove_chk
argument_list|,
operator|(
name|s0
operator|,
name|s1
operator|,
sizeof|sizeof
name|s0
operator|,
name|n
operator|)
argument_list|)
expr_stmt|;
name|V
argument_list|(
name|__mempcpy_chk
argument_list|,
operator|(
name|s0
operator|,
name|s1
operator|,
sizeof|sizeof
name|s0
operator|,
name|n
operator|)
argument_list|)
expr_stmt|;
name|V
argument_list|(
name|__strncpy_chk
argument_list|,
operator|(
name|s0
operator|,
name|s1
operator|,
sizeof|sizeof
name|s0
operator|,
name|n
operator|)
argument_list|)
expr_stmt|;
name|V
argument_list|(
name|__strcpy_chk
argument_list|,
operator|(
name|s0
operator|,
name|s1
operator|,
name|n
operator|)
argument_list|)
expr_stmt|;
name|s0
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|V
argument_list|(
name|__strcat_chk
argument_list|,
operator|(
name|s0
operator|,
name|s1
operator|,
name|n
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|object_size
argument_list|,
operator|(
name|s0
operator|,
literal|0
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|object_size
argument_list|,
operator|(
name|s0
operator|,
literal|1
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|object_size
argument_list|,
operator|(
name|s0
operator|,
literal|2
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|object_size
argument_list|,
operator|(
name|s0
operator|,
literal|3
operator|)
argument_list|)
expr_stmt|;
comment|// Whatever
name|P
argument_list|(
name|bswap32
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|bswap64
argument_list|,
operator|(
name|N
operator|)
argument_list|)
expr_stmt|;
comment|// FIXME
comment|// V(clear_cache, (&N,&N+1));
name|V
argument_list|(
name|trap
argument_list|,
operator|(
operator|)
argument_list|)
expr_stmt|;
name|P
argument_list|(
name|extract_return_addr
argument_list|,
operator|(
operator|&
name|N
operator|)
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
name|void
name|strcat
parameter_list|()
block|{}
end_function

begin_function
name|void
name|foo
parameter_list|()
block|{
name|__builtin_strcat
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

