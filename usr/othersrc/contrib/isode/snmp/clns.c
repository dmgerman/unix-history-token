begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* clns.c - MIB realization of the experimental CLNS group */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
modifier|*
name|rcsid
init|=
literal|"$Header: /f/osi/snmp/RCS/clns.c,v 7.10 91/02/22 09:42:55 mrose Interim $"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/*   * $Header: /f/osi/snmp/RCS/clns.c,v 7.10 91/02/22 09:42:55 mrose Interim $  *  * Contributed by NYSERNet Inc.  This work was partially supported by the  * U.S. Defense Advanced Research Projects Agency and the Rome Air Development  * Center of the U.S. Air Force Systems Command under contract number  * F30602-88-C-0016.  *  *  * $Log:	clns.c,v $  * Revision 7.10  91/02/22  09:42:55  mrose  * Interim 6.8  *   * Revision 7.9  91/01/08  12:48:23  mrose  * update  *   * Revision 7.8  90/12/18  10:13:07  mrose  * update  *   * Revision 7.7  90/10/15  18:21:04  mrose  * tables  *   * Revision 7.6  90/09/07  11:21:27  mrose  * update  *   * Revision 7.5  90/07/09  14:48:34  mrose  * sync  *   * Revision 7.4  90/05/22  20:30:21  mrose  * cache  *   * Revision 7.3  90/02/27  18:49:28  mrose  * unix stuff  *   * Revision 7.2  90/02/17  10:37:37  mrose  * smux  *   * Revision 7.1  90/01/11  18:33:54  mrose  * real-sync  *   * Revision 7.0  89/11/23  22:22:55  mrose  * Release 6.0  *   */
end_comment

begin_comment
comment|/*  *				  NOTICE  *  *    Acquisition, use, and distribution of this module and related  *    materials are subject to the restrictions of a license agreement.  *    Consult the Preface in the User's Manual for the full terms of  *    this agreement.  *  */
end_comment

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|"mib.h"
end_include

begin_include
include|#
directive|include
file|"interfaces.h"
end_include

begin_include
include|#
directive|include
file|"routes.h"
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|BSD44
end_ifdef

begin_include
include|#
directive|include
file|<sys/kinfo.h>
end_include

begin_include
include|#
directive|include
file|<net/if_dl.h>
end_include

begin_include
include|#
directive|include
file|<netiso/iso_snpac.h>
end_include

begin_define
define|#
directive|define
name|CLNP_ER_CODES
end_define

begin_include
include|#
directive|include
file|<netiso/clnp.h>
end_include

begin_include
include|#
directive|include
file|<netiso/clnp_stat.h>
end_include

begin_include
include|#
directive|include
file|<netiso/esis.h>
end_include

begin_comment
comment|/*
comment|*/
end_comment

begin_define
define|#
directive|define
name|FORW_IS
value|1
end_define

begin_comment
comment|/* clnpForwarding */
end_comment

begin_define
define|#
directive|define
name|FORW_ES
value|2
end_define

begin_decl_stmt
specifier|static
name|int
name|iso_systype
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|clnp_stat
name|clnp_stat
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*
comment|*/
end_comment

begin_define
define|#
directive|define
name|clnpForwarding
value|0
end_define

begin_define
define|#
directive|define
name|clnpDefaultLifeTime
value|1
end_define

begin_define
define|#
directive|define
name|clnpInReceives
value|2
end_define

begin_define
define|#
directive|define
name|clnpInHdrErrors
value|3
end_define

begin_define
define|#
directive|define
name|clnpInAddrErrors
value|4
end_define

begin_define
define|#
directive|define
name|clnpForwPDUs
value|5
end_define

begin_undef
undef|#
directive|undef
name|clnpInUnknownNLPs
name|6
end_undef

begin_comment
comment|/* NOT IMPLEMENTED */
end_comment

begin_define
define|#
directive|define
name|clnpInUnknownULPs
value|7
end_define

begin_undef
undef|#
directive|undef
name|clnpInDiscards
name|8
end_undef

begin_comment
comment|/* NOT IMPLEMENTED */
end_comment

begin_define
define|#
directive|define
name|clnpInDelivers
value|9
end_define

begin_define
define|#
directive|define
name|clnpOutRequests
value|10
end_define

begin_define
define|#
directive|define
name|clnpOutDiscards
value|11
end_define

begin_define
define|#
directive|define
name|clnpOutNoRoutes
value|12
end_define

begin_define
define|#
directive|define
name|clnpReasmTimeout
value|13
end_define

begin_define
define|#
directive|define
name|clnpReasmReqds
value|14
end_define

begin_define
define|#
directive|define
name|clnpReasmOKs
value|15
end_define

begin_define
define|#
directive|define
name|clnpReasmFails
value|16
end_define

begin_define
define|#
directive|define
name|clnpSegOKs
value|17
end_define

begin_define
define|#
directive|define
name|clnpSegFails
value|18
end_define

begin_define
define|#
directive|define
name|clnpSegCreates
value|19
end_define

begin_undef
undef|#
directive|undef
name|clnpInOpts
name|20
end_undef

begin_comment
comment|/* NOT IMPLEMENTED */
end_comment

begin_undef
undef|#
directive|undef
name|clnpInOpts
name|21
end_undef

begin_comment
comment|/* NOT IMPLEMENTED */
end_comment

begin_define
define|#
directive|define
name|clnpInErrors
value|(100 + 0)
end_define

begin_define
define|#
directive|define
name|clnpOutErrors
value|(100 + 1)
end_define

begin_define
define|#
directive|define
name|clnpInErrUnspecs
value|(100 + 2)
end_define

begin_define
define|#
directive|define
name|clnpInErrProcs
value|(100 + 3)
end_define

begin_define
define|#
directive|define
name|clnpInErrCksums
value|(100 + 4)
end_define

begin_define
define|#
directive|define
name|clnpInErrCongests
value|(100 + 5)
end_define

begin_define
define|#
directive|define
name|clnpInErrHdrs
value|(100 + 6)
end_define

begin_define
define|#
directive|define
name|clnpInErrSegs
value|(100 + 7)
end_define

begin_define
define|#
directive|define
name|clnpInErrIncomps
value|(100 + 8)
end_define

begin_define
define|#
directive|define
name|clnpInErrDups
value|(100 + 9)
end_define

begin_define
define|#
directive|define
name|clnpInErrUnreachDsts
value|(100 + 10)
end_define

begin_define
define|#
directive|define
name|clnpInErrUnknownDsts
value|(100 + 11)
end_define

begin_define
define|#
directive|define
name|clnpInErrSRUnspecs
value|(100 + 12)
end_define

begin_define
define|#
directive|define
name|clnpInErrSRSyntaxes
value|(100 + 13)
end_define

begin_define
define|#
directive|define
name|clnpInErrSRUnkAddrs
value|(100 + 14)
end_define

begin_define
define|#
directive|define
name|clnpInErrSRBadPaths
value|(100 + 15)
end_define

begin_define
define|#
directive|define
name|clnpInErrHops
value|(100 + 16)
end_define

begin_define
define|#
directive|define
name|clnpInErrHopReassms
value|(100 + 17)
end_define

begin_define
define|#
directive|define
name|clnpInErrUnsOptions
value|(100 + 18)
end_define

begin_define
define|#
directive|define
name|clnpInErrUnsVersions
value|(100 + 19)
end_define

begin_define
define|#
directive|define
name|clnpInErrUnsSecurities
value|(100 + 20)
end_define

begin_define
define|#
directive|define
name|clnpInErrUnsSRs
value|(100 + 21)
end_define

begin_define
define|#
directive|define
name|clnpInErrUnsRRs
value|(100 + 22)
end_define

begin_define
define|#
directive|define
name|clnpInErrInterferences
value|(100 + 23)
end_define

begin_define
define|#
directive|define
name|clnpOutErrUnspecs
value|(100 + 24)
end_define

begin_define
define|#
directive|define
name|clnpOutErrProcs
value|(100 + 25)
end_define

begin_define
define|#
directive|define
name|clnpOutErrCksums
value|(100 + 26)
end_define

begin_define
define|#
directive|define
name|clnpOutErrCongests
value|(100 + 27)
end_define

begin_define
define|#
directive|define
name|clnpOutErrHdrs
value|(100 + 28)
end_define

begin_define
define|#
directive|define
name|clnpOutErrSegs
value|(100 + 29)
end_define

begin_define
define|#
directive|define
name|clnpOutErrIncomps
value|(100 + 30)
end_define

begin_define
define|#
directive|define
name|clnpOutErrDups
value|(100 + 31)
end_define

begin_define
define|#
directive|define
name|clnpOutErrUnreachDsts
value|(100 + 32)
end_define

begin_define
define|#
directive|define
name|clnpOutErrUnknownDsts
value|(100 + 33)
end_define

begin_define
define|#
directive|define
name|clnpOutErrSRUnspecs
value|(100 + 34)
end_define

begin_define
define|#
directive|define
name|clnpOutErrSRSyntaxes
value|(100 + 35)
end_define

begin_define
define|#
directive|define
name|clnpOutErrSRUnkAddrs
value|(100 + 36)
end_define

begin_define
define|#
directive|define
name|clnpOutErrSRBadPaths
value|(100 + 37)
end_define

begin_define
define|#
directive|define
name|clnpOutErrHops
value|(100 + 38)
end_define

begin_define
define|#
directive|define
name|clnpOutErrHopReassms
value|(100 + 39)
end_define

begin_define
define|#
directive|define
name|clnpOutErrUnsOptions
value|(100 + 40)
end_define

begin_define
define|#
directive|define
name|clnpOutErrUnsVersions
value|(100 + 41)
end_define

begin_define
define|#
directive|define
name|clnpOutErrUnsSecurities
value|(100 + 42)
end_define

begin_define
define|#
directive|define
name|clnpOutErrUnsSRs
value|(100 + 43)
end_define

begin_define
define|#
directive|define
name|clnpOutErrUnsRRs
value|(100 + 44)
end_define

begin_define
define|#
directive|define
name|clnpOutErrInterferences
value|(100 + 45)
end_define

begin_function
specifier|static
name|int
name|o_clnp
parameter_list|(
name|oi
parameter_list|,
name|v
parameter_list|,
name|offset
parameter_list|)
name|OI
name|oi
decl_stmt|;
specifier|register
name|struct
name|type_SNMP_VarBind
modifier|*
name|v
decl_stmt|;
name|int
name|offset
decl_stmt|;
block|{
specifier|register
name|int
modifier|*
name|dp
decl_stmt|,
modifier|*
name|ep
decl_stmt|,
name|j
decl_stmt|;
name|int
name|ifvar
decl_stmt|;
specifier|register
name|struct
name|clnp_stat
modifier|*
name|cns
init|=
operator|&
name|clnp_stat
decl_stmt|;
specifier|register
name|OID
name|oid
init|=
name|oi
operator|->
name|oi_name
decl_stmt|;
specifier|register
name|OT
name|ot
init|=
name|oi
operator|->
name|oi_type
decl_stmt|;
specifier|static
name|int
name|lastq
init|=
operator|-
literal|1
decl_stmt|;
name|ifvar
operator|=
operator|(
name|int
operator|)
name|ot
operator|->
name|ot_info
expr_stmt|;
switch|switch
condition|(
name|offset
condition|)
block|{
case|case
name|type_SNMP_PDUs_get__request
case|:
if|if
condition|(
name|oid
operator|->
name|oid_nelem
operator|!=
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
operator|+
literal|1
operator|||
name|oid
operator|->
name|oid_elements
index|[
name|oid
operator|->
name|oid_nelem
operator|-
literal|1
index|]
operator|!=
literal|0
condition|)
return|return
name|int_SNMP_error__status_noSuchName
return|;
break|break;
case|case
name|type_SNMP_PDUs_get__next__request
case|:
if|if
condition|(
name|oid
operator|->
name|oid_nelem
operator|==
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
condition|)
block|{
name|OID
name|new
decl_stmt|;
if|if
condition|(
operator|(
name|new
operator|=
name|oid_extend
argument_list|(
name|oid
argument_list|,
literal|1
argument_list|)
operator|)
operator|==
name|NULLOID
condition|)
return|return
name|NOTOK
return|;
name|new
operator|->
name|oid_elements
index|[
name|new
operator|->
name|oid_nelem
operator|-
literal|1
index|]
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|v
operator|->
name|name
condition|)
name|free_SNMP_ObjectName
argument_list|(
name|v
operator|->
name|name
argument_list|)
expr_stmt|;
name|v
operator|->
name|name
operator|=
name|new
expr_stmt|;
block|}
else|else
return|return
name|NOTOK
return|;
break|break;
default|default:
return|return
name|int_SNMP_error__status_genErr
return|;
block|}
switch|switch
condition|(
name|ifvar
condition|)
block|{
case|case
name|clnpDefaultLifeTime
case|:
case|case
name|clnpReasmTimeout
case|:
break|break;
default|default:
if|if
condition|(
name|quantum
operator|!=
name|lastq
condition|)
block|{
name|lastq
operator|=
name|quantum
expr_stmt|;
if|if
condition|(
name|getkmem
argument_list|(
name|nl
operator|+
name|N_ISO_SYSTYPE
argument_list|,
operator|(
name|caddr_t
operator|)
operator|&
name|iso_systype
argument_list|,
sizeof|sizeof
name|iso_systype
argument_list|)
operator|==
name|NOTOK
operator|||
name|getkmem
argument_list|(
name|nl
operator|+
name|N_CLNP_STAT
argument_list|,
operator|(
name|caddr_t
operator|)
name|cns
argument_list|,
sizeof|sizeof
expr|*
name|cns
argument_list|)
operator|==
name|NOTOK
condition|)
return|return
name|generr
argument_list|(
name|offset
argument_list|)
return|;
block|}
break|break;
block|}
switch|switch
condition|(
name|ifvar
condition|)
block|{
case|case
name|clnpForwarding
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|iso_systype
operator|&
name|SNPA_ES
condition|?
name|FORW_ES
else|:
name|FORW_IS
argument_list|)
return|;
case|case
name|clnpDefaultLifeTime
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|CLNP_TTL
argument_list|)
return|;
case|case
name|clnpInReceives
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|cns
operator|->
name|cns_total
argument_list|)
return|;
case|case
name|clnpInHdrErrors
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|cns
operator|->
name|cns_toosmall
operator|+
name|cns
operator|->
name|cns_badhlen
operator|+
name|cns
operator|->
name|cns_badcsum
operator|+
name|cns
operator|->
name|cns_noseg
operator|+
name|cns
operator|->
name|cns_badvers
argument_list|)
return|;
case|case
name|clnpInAddrErrors
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|cns
operator|->
name|cns_badaddr
argument_list|)
return|;
case|case
name|clnpForwPDUs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|cns
operator|->
name|cns_forward
argument_list|)
return|;
case|case
name|clnpInUnknownULPs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|cns
operator|->
name|cns_noproto
argument_list|)
return|;
case|case
name|clnpInDelivers
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|cns
operator|->
name|cns_delivered
argument_list|)
return|;
case|case
name|clnpOutRequests
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|cns
operator|->
name|cns_sent
operator|-
name|cns
operator|->
name|cns_forward
argument_list|)
return|;
case|case
name|clnpOutDiscards
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|cns
operator|->
name|cns_odropped
argument_list|)
return|;
case|case
name|clnpOutNoRoutes
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|cns
operator|->
name|cns_cantforward
argument_list|)
return|;
case|case
name|clnpReasmTimeout
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|CLNP_TTL
argument_list|)
return|;
case|case
name|clnpReasmReqds
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|cns
operator|->
name|cns_fragments
argument_list|)
return|;
case|case
name|clnpReasmOKs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|cns
operator|->
name|cns_reassembled
argument_list|)
return|;
case|case
name|clnpReasmFails
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|cns
operator|->
name|cns_fragdropped
operator|+
name|cns
operator|->
name|cns_fragtimeout
argument_list|)
return|;
case|case
name|clnpSegOKs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|cns
operator|->
name|cns_fragmented
argument_list|)
return|;
case|case
name|clnpSegFails
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|cns
operator|->
name|cns_cantfrag
argument_list|)
return|;
case|case
name|clnpSegCreates
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|cns
operator|->
name|cns_ofragments
argument_list|)
return|;
case|case
name|clnpInErrors
case|:
name|j
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|ep
operator|=
operator|(
name|dp
operator|=
name|cns
operator|->
name|cns_er_inhist
operator|)
operator|+
name|CLNP_ERRORS
init|;
name|dp
operator|<=
name|ep
condition|;
control|)
name|j
operator|+=
operator|*
name|dp
operator|++
expr_stmt|;
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|j
argument_list|)
return|;
case|case
name|clnpOutErrors
case|:
name|j
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|ep
operator|=
operator|(
name|dp
operator|=
name|cns
operator|->
name|cns_er_outhist
operator|)
operator|+
name|CLNP_ERRORS
init|;
name|dp
operator|<=
name|ep
condition|;
control|)
name|j
operator|+=
operator|*
name|dp
operator|++
expr_stmt|;
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|j
argument_list|)
return|;
define|#
directive|define
name|clnpInputError
parameter_list|(
name|r
parameter_list|)
value|cns -> cns_er_inhist[clnp_er_index (r)]
case|case
name|clnpInErrUnspecs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|GEN_NOREAS
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrProcs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|GEN_PROTOERR
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrCksums
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|GEN_BADCSUM
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrCongests
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|GEN_CONGEST
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrHdrs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|GEN_HDRSYNTAX
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrSegs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|GEN_SEGNEEDED
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrIncomps
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|GEN_INCOMPLETE
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrDups
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|GEN_DUPOPT
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrUnreachDsts
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|ADDR_DESTUNREACH
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrUnknownDsts
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|ADDR_DESTUNKNOWN
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrSRUnspecs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|SRCRT_UNSPECERR
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrSRSyntaxes
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|SRCRT_SYNTAX
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrSRUnkAddrs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|SRCRT_UNKNOWNADDR
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrSRBadPaths
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|SRCRT_BADPATH
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrHops
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|TTL_EXPTRANSIT
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrHopReassms
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|TTL_EXPREASS
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrUnsOptions
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|DISC_UNSUPPOPT
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrUnsVersions
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|DISC_UNSUPPVERS
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrUnsSecurities
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|DISC_UNSUPPSECURE
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrUnsSRs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|DISC_UNSUPPSRCRT
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrUnsRRs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|DISC_UNSUPPRECRT
argument_list|)
argument_list|)
return|;
case|case
name|clnpInErrInterferences
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpInputError
argument_list|(
name|REASS_INTERFERE
argument_list|)
argument_list|)
return|;
undef|#
directive|undef
name|clnpInputError
define|#
directive|define
name|clnpOutputError
parameter_list|(
name|r
parameter_list|)
value|cns -> cns_er_outhist[clnp_er_index (r)]
case|case
name|clnpOutErrUnspecs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|GEN_NOREAS
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrProcs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|GEN_PROTOERR
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrCksums
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|GEN_BADCSUM
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrCongests
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|GEN_CONGEST
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrHdrs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|GEN_HDRSYNTAX
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrSegs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|GEN_SEGNEEDED
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrIncomps
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|GEN_INCOMPLETE
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrDups
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|GEN_DUPOPT
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrUnreachDsts
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|ADDR_DESTUNREACH
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrUnknownDsts
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|ADDR_DESTUNKNOWN
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrSRUnspecs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|SRCRT_UNSPECERR
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrSRSyntaxes
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|SRCRT_SYNTAX
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrSRUnkAddrs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|SRCRT_UNKNOWNADDR
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrSRBadPaths
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|SRCRT_BADPATH
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrHops
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|TTL_EXPTRANSIT
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrHopReassms
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|TTL_EXPREASS
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrUnsOptions
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|DISC_UNSUPPOPT
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrUnsVersions
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|DISC_UNSUPPVERS
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrUnsSecurities
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|DISC_UNSUPPSECURE
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrUnsSRs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|DISC_UNSUPPSRCRT
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrUnsRRs
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|DISC_UNSUPPRECRT
argument_list|)
argument_list|)
return|;
case|case
name|clnpOutErrInterferences
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|clnpOutputError
argument_list|(
name|REASS_INTERFERE
argument_list|)
argument_list|)
return|;
undef|#
directive|undef
name|clnpOutputError
default|default:
return|return
name|int_SNMP_error__status_noSuchName
return|;
block|}
block|}
end_function

begin_comment
comment|/*
comment|*/
end_comment

begin_function
specifier|static
name|int
name|clnp_er_index
parameter_list|(
name|p
parameter_list|)
name|u_char
name|p
decl_stmt|;
block|{
specifier|register
name|u_char
modifier|*
name|cp
init|=
name|clnp_er_codes
operator|+
name|CLNP_ERRORS
decl_stmt|;
while|while
condition|(
name|cp
operator|--
operator|>
name|clnp_er_codes
condition|)
if|if
condition|(
operator|*
name|cp
operator|==
name|p
condition|)
return|return
operator|(
name|cp
operator|-
name|clnp_er_codes
operator|)
return|;
return|return
operator|(
name|CLNP_ERRORS
operator|+
literal|1
operator|)
return|;
block|}
end_function

begin_comment
comment|/*
comment|*/
end_comment

begin_define
define|#
directive|define
name|CLNP_MAXPACKET
value|65535
end_define

begin_comment
comment|/* clnpAdEntReasmMaxSize */
end_comment

begin_comment
comment|/* equivalent of IP_MAXPACKET */
end_comment

begin_define
define|#
directive|define
name|clnpAdEntAddr
value|0
end_define

begin_define
define|#
directive|define
name|clnpAdEntIfIndex
value|1
end_define

begin_define
define|#
directive|define
name|clnpAdEntNetMask
value|2
end_define

begin_define
define|#
directive|define
name|clnpAdEntReasmMaxSize
value|3
end_define

begin_function
specifier|static
name|int
name|o_clnp_addr
parameter_list|(
name|oi
parameter_list|,
name|v
parameter_list|,
name|offset
parameter_list|)
name|OI
name|oi
decl_stmt|;
specifier|register
name|struct
name|type_SNMP_VarBind
modifier|*
name|v
decl_stmt|;
name|int
name|offset
decl_stmt|;
block|{
specifier|register
name|int
name|i
decl_stmt|;
name|int
name|ifvar
decl_stmt|;
specifier|register
name|unsigned
name|int
modifier|*
name|ip
decl_stmt|,
modifier|*
name|jp
decl_stmt|;
specifier|register
name|struct
name|address
modifier|*
name|as
decl_stmt|;
specifier|register
name|OID
name|oid
init|=
name|oi
operator|->
name|oi_name
decl_stmt|;
specifier|register
name|OT
name|ot
init|=
name|oi
operator|->
name|oi_type
decl_stmt|;
if|if
condition|(
name|get_interfaces
argument_list|(
name|offset
argument_list|)
operator|==
name|NOTOK
condition|)
return|return
name|generr
argument_list|(
name|offset
argument_list|)
return|;
name|ifvar
operator|=
operator|(
name|int
operator|)
name|ot
operator|->
name|ot_info
expr_stmt|;
switch|switch
condition|(
name|offset
condition|)
block|{
case|case
name|type_SNMP_PDUs_get__request
case|:
if|if
condition|(
name|oid
operator|->
name|oid_nelem
operator|<=
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
condition|)
return|return
name|int_SNMP_error__status_noSuchName
return|;
if|if
condition|(
operator|(
name|as
operator|=
name|get_addrent
argument_list|(
name|oid
operator|->
name|oid_elements
operator|+
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
argument_list|,
name|oid
operator|->
name|oid_nelem
operator|-
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
argument_list|,
name|afs_iso
argument_list|,
literal|0
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
name|int_SNMP_error__status_noSuchName
return|;
break|break;
case|case
name|type_SNMP_PDUs_get__next__request
case|:
if|if
condition|(
name|oid
operator|->
name|oid_nelem
operator|<
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
condition|)
return|return
name|NOTOK
return|;
if|if
condition|(
name|oid
operator|->
name|oid_nelem
operator|==
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
condition|)
block|{
name|OID
name|new
decl_stmt|;
if|if
condition|(
operator|(
name|as
operator|=
name|afs_iso
operator|)
operator|==
name|NULL
condition|)
return|return
name|NOTOK
return|;
if|if
condition|(
operator|(
name|new
operator|=
name|oid_extend
argument_list|(
name|oid
argument_list|,
name|as
operator|->
name|adr_insize
argument_list|)
operator|)
operator|==
name|NULLOID
condition|)
return|return
name|NOTOK
return|;
name|ip
operator|=
name|new
operator|->
name|oid_elements
operator|+
name|new
operator|->
name|oid_nelem
operator|-
name|as
operator|->
name|adr_insize
expr_stmt|;
name|jp
operator|=
name|as
operator|->
name|adr_instance
expr_stmt|;
for|for
control|(
name|i
operator|=
name|as
operator|->
name|adr_insize
init|;
name|i
operator|>
literal|0
condition|;
name|i
operator|--
control|)
operator|*
name|ip
operator|++
operator|=
operator|*
name|jp
operator|++
expr_stmt|;
if|if
condition|(
name|v
operator|->
name|name
condition|)
name|free_SNMP_ObjectName
argument_list|(
name|v
operator|->
name|name
argument_list|)
expr_stmt|;
name|v
operator|->
name|name
operator|=
name|new
expr_stmt|;
block|}
else|else
block|{
name|int
name|j
decl_stmt|;
if|if
condition|(
operator|(
name|as
operator|=
name|get_addrent
argument_list|(
name|oid
operator|->
name|oid_elements
operator|+
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
argument_list|,
name|j
operator|=
name|oid
operator|->
name|oid_nelem
operator|-
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
argument_list|,
name|afs_iso
argument_list|,
literal|1
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
name|NOTOK
return|;
if|if
condition|(
operator|(
name|i
operator|=
name|j
operator|-
name|as
operator|->
name|adr_insize
operator|)
operator|<
literal|0
condition|)
block|{
name|OID
name|new
decl_stmt|;
if|if
condition|(
operator|(
name|new
operator|=
name|oid_extend
argument_list|(
name|oid
argument_list|,
operator|-
name|i
argument_list|)
operator|)
operator|==
name|NULLOID
condition|)
return|return
name|NOTOK
return|;
if|if
condition|(
name|v
operator|->
name|name
condition|)
name|free_SNMP_ObjectName
argument_list|(
name|v
operator|->
name|name
argument_list|)
expr_stmt|;
name|v
operator|->
name|name
operator|=
name|new
expr_stmt|;
name|oid
operator|=
name|new
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|i
operator|>
literal|0
condition|)
name|oid
operator|->
name|oid_nelem
operator|-=
name|i
expr_stmt|;
name|ip
operator|=
name|oid
operator|->
name|oid_elements
operator|+
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
expr_stmt|;
name|jp
operator|=
name|as
operator|->
name|adr_instance
expr_stmt|;
for|for
control|(
name|i
operator|=
name|as
operator|->
name|adr_insize
init|;
name|i
operator|>
literal|0
condition|;
name|i
operator|--
control|)
operator|*
name|ip
operator|++
operator|=
operator|*
name|jp
operator|++
expr_stmt|;
block|}
break|break;
default|default:
return|return
name|int_SNMP_error__status_genErr
return|;
block|}
switch|switch
condition|(
name|ifvar
condition|)
block|{
case|case
name|clnpAdEntAddr
case|:
return|return
name|o_clnpaddr
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
operator|(
expr|struct
name|sockaddr_iso
operator|*
operator|)
operator|&
name|as
operator|->
name|adr_address
argument_list|)
return|;
case|case
name|clnpAdEntIfIndex
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|ffs
argument_list|(
name|as
operator|->
name|adr_indexmask
argument_list|)
argument_list|)
return|;
case|case
name|clnpAdEntNetMask
case|:
return|return
name|o_clnpaddr
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
operator|(
expr|struct
name|sockaddr_iso
operator|*
operator|)
operator|&
name|as
operator|->
name|adr_netmask
argument_list|)
return|;
case|case
name|clnpAdEntReasmMaxSize
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|CLNP_MAXPACKET
argument_list|)
return|;
default|default:
return|return
name|int_SNMP_error__status_noSuchName
return|;
block|}
block|}
end_function

begin_comment
comment|/*
comment|*/
end_comment

begin_define
define|#
directive|define
name|clnpRouteDest
value|0
end_define

begin_define
define|#
directive|define
name|clnpRouteIfIndex
value|1
end_define

begin_define
define|#
directive|define
name|clnpRouteMetric1
value|2
end_define

begin_define
define|#
directive|define
name|clnpRouteMetric2
value|3
end_define

begin_define
define|#
directive|define
name|clnpRouteMetric3
value|4
end_define

begin_define
define|#
directive|define
name|clnpRouteMetric4
value|5
end_define

begin_define
define|#
directive|define
name|clnpRouteNextHop
value|6
end_define

begin_define
define|#
directive|define
name|clnpRouteType
value|7
end_define

begin_define
define|#
directive|define
name|clnpRouteProto
value|8
end_define

begin_define
define|#
directive|define
name|clnpRouteAge
value|9
end_define

begin_define
define|#
directive|define
name|unixClnpRouteFlags
value|10
end_define

begin_define
define|#
directive|define
name|unixClnpRouteRefCnt
value|11
end_define

begin_define
define|#
directive|define
name|unixClnpRouteUses
value|12
end_define

begin_function
specifier|static
name|int
name|o_clnp_route
parameter_list|(
name|oi
parameter_list|,
name|v
parameter_list|,
name|offset
parameter_list|)
name|OI
name|oi
decl_stmt|;
specifier|register
name|struct
name|type_SNMP_VarBind
modifier|*
name|v
decl_stmt|;
name|int
name|offset
decl_stmt|;
block|{
name|int
name|ifvar
decl_stmt|;
specifier|register
name|int
name|i
decl_stmt|;
specifier|register
name|unsigned
name|int
modifier|*
name|ip
decl_stmt|,
modifier|*
name|jp
decl_stmt|;
specifier|register
name|struct
name|rtetab
modifier|*
name|rt
decl_stmt|;
specifier|register
name|OID
name|oid
init|=
name|oi
operator|->
name|oi_name
decl_stmt|;
name|OID
name|new
decl_stmt|;
specifier|register
name|OT
name|ot
init|=
name|oi
operator|->
name|oi_type
decl_stmt|;
if|if
condition|(
name|get_routes
argument_list|(
name|offset
argument_list|)
operator|==
name|NOTOK
condition|)
return|return
name|generr
argument_list|(
name|offset
argument_list|)
return|;
name|ifvar
operator|=
operator|(
name|int
operator|)
name|ot
operator|->
name|ot_info
expr_stmt|;
switch|switch
condition|(
name|offset
condition|)
block|{
case|case
name|type_SNMP_PDUs_get__request
case|:
if|if
condition|(
name|oid
operator|->
name|oid_nelem
operator|<=
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
condition|)
return|return
name|int_SNMP_error__status_noSuchName
return|;
if|if
condition|(
operator|(
name|rt
operator|=
name|get_rtent
argument_list|(
name|oid
operator|->
name|oid_elements
operator|+
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
argument_list|,
name|oid
operator|->
name|oid_nelem
operator|-
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
argument_list|,
name|rts_iso
argument_list|,
literal|0
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
name|int_SNMP_error__status_noSuchName
return|;
break|break;
case|case
name|type_SNMP_PDUs_get__next__request
case|:
if|if
condition|(
name|oid
operator|->
name|oid_nelem
operator|==
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
condition|)
block|{
if|if
condition|(
operator|(
name|rt
operator|=
name|rts_iso
operator|)
operator|==
name|NULL
condition|)
return|return
name|NOTOK
return|;
if|if
condition|(
operator|(
name|new
operator|=
name|oid_extend
argument_list|(
name|oid
argument_list|,
name|rt
operator|->
name|rt_insize
argument_list|)
operator|)
operator|==
name|NULLOID
condition|)
return|return
name|NOTOK
return|;
name|ip
operator|=
name|new
operator|->
name|oid_elements
operator|+
name|new
operator|->
name|oid_nelem
operator|-
name|rt
operator|->
name|rt_insize
expr_stmt|;
name|jp
operator|=
name|rt
operator|->
name|rt_instance
expr_stmt|;
for|for
control|(
name|i
operator|=
name|rt
operator|->
name|rt_insize
init|;
name|i
operator|>
literal|0
condition|;
name|i
operator|--
control|)
operator|*
name|ip
operator|++
operator|=
operator|*
name|jp
operator|++
expr_stmt|;
if|if
condition|(
name|v
operator|->
name|name
condition|)
name|free_SNMP_ObjectName
argument_list|(
name|v
operator|->
name|name
argument_list|)
expr_stmt|;
name|v
operator|->
name|name
operator|=
name|new
expr_stmt|;
block|}
else|else
block|{
name|int
name|j
decl_stmt|;
if|if
condition|(
operator|(
name|rt
operator|=
name|get_rtent
argument_list|(
name|oid
operator|->
name|oid_elements
operator|+
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
argument_list|,
name|j
operator|=
name|oid
operator|->
name|oid_nelem
operator|-
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
argument_list|,
name|rts_iso
argument_list|,
literal|1
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
name|NOTOK
return|;
if|if
condition|(
operator|(
name|i
operator|=
name|j
operator|-
name|rt
operator|->
name|rt_insize
operator|)
operator|<
literal|0
condition|)
block|{
if|if
condition|(
operator|(
name|new
operator|=
name|oid_extend
argument_list|(
name|oid
argument_list|,
operator|-
name|i
argument_list|)
operator|)
operator|==
name|NULLOID
condition|)
return|return
name|NOTOK
return|;
if|if
condition|(
name|v
operator|->
name|name
condition|)
name|free_SNMP_ObjectName
argument_list|(
name|v
operator|->
name|name
argument_list|)
expr_stmt|;
name|v
operator|->
name|name
operator|=
name|new
expr_stmt|;
name|oid
operator|=
name|new
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|i
operator|>
literal|0
condition|)
name|oid
operator|->
name|oid_nelem
operator|-=
name|i
expr_stmt|;
name|ip
operator|=
name|oid
operator|->
name|oid_elements
operator|+
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
expr_stmt|;
name|jp
operator|=
name|rt
operator|->
name|rt_instance
expr_stmt|;
for|for
control|(
name|i
operator|=
name|rt
operator|->
name|rt_insize
init|;
name|i
operator|>
literal|0
condition|;
name|i
operator|--
control|)
operator|*
name|ip
operator|++
operator|=
operator|*
name|jp
operator|++
expr_stmt|;
block|}
break|break;
default|default:
return|return
name|int_SNMP_error__status_genErr
return|;
block|}
switch|switch
condition|(
name|ifvar
condition|)
block|{
case|case
name|clnpRouteDest
case|:
return|return
name|o_clnpaddr
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
operator|(
expr|struct
name|sockaddr_iso
operator|*
operator|)
operator|&
name|rt
operator|->
name|rt_dst
argument_list|)
return|;
case|case
name|clnpRouteIfIndex
case|:
block|{
specifier|register
name|struct
name|interface
modifier|*
name|is
decl_stmt|;
for|for
control|(
name|is
operator|=
name|ifs
init|;
name|is
condition|;
name|is
operator|=
name|is
operator|->
name|ifn_next
control|)
if|if
condition|(
operator|(
name|caddr_t
operator|)
name|is
operator|->
name|ifn_offset
operator|==
operator|(
name|caddr_t
operator|)
name|rt
operator|->
name|rt_rt
operator|.
name|rt_ifp
condition|)
block|{
if|if
condition|(
name|is
operator|->
name|ifn_ready
condition|)
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|is
operator|->
name|ifn_index
argument_list|)
return|;
break|break;
block|}
if|if
condition|(
name|offset
operator|==
name|type_SNMP_PDUs_get__next__request
condition|)
return|return
name|NOTOK
return|;
return|return
name|int_SNMP_error__status_noSuchName
return|;
block|}
case|case
name|clnpRouteMetric1
case|:
case|case
name|clnpRouteMetric2
case|:
case|case
name|clnpRouteMetric3
case|:
case|case
name|clnpRouteMetric4
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|METRIC_NONE
argument_list|)
return|;
case|case
name|clnpRouteNextHop
case|:
return|return
name|o_clnpaddr
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
operator|(
expr|struct
name|sockaddr_iso
operator|*
operator|)
operator|&
name|rt
operator|->
name|rt_gateway
argument_list|)
return|;
case|case
name|clnpRouteType
case|:
switch|switch
condition|(
name|rt
operator|->
name|rt_rt
operator|.
name|rt_flags
operator|&
operator|(
name|RTF_GATEWAY
operator||
name|RTF_HOST
operator|)
condition|)
block|{
case|case
name|RTF_GATEWAY
case|:
case|case
name|RTF_HOST
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|TYPE_REMOTE
argument_list|)
return|;
case|case
literal|0
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|TYPE_DIRECT
argument_list|)
return|;
default|default:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|TYPE_OTHER
argument_list|)
return|;
block|}
case|case
name|clnpRouteProto
case|:
if|if
condition|(
name|rt
operator|->
name|rt_rt
operator|.
name|rt_flags
operator|&
operator|(
name|RTF_DYNAMIC
operator||
name|RTF_MODIFIED
operator|)
condition|)
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|PROTO_ESIS
argument_list|)
return|;
else|else
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|PROTO_OTHER
argument_list|)
return|;
case|case
name|clnpRouteAge
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
literal|0
argument_list|)
return|;
case|case
name|unixClnpRouteFlags
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|rt
operator|->
name|rt_rt
operator|.
name|rt_flags
operator|&
literal|0xffff
argument_list|)
return|;
case|case
name|unixClnpRouteRefCnt
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|rt
operator|->
name|rt_rt
operator|.
name|rt_refcnt
operator|&
literal|0xffff
argument_list|)
return|;
case|case
name|unixClnpRouteUses
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|rt
operator|->
name|rt_rt
operator|.
name|rt_use
argument_list|)
return|;
default|default:
return|return
name|int_SNMP_error__status_noSuchName
return|;
block|}
block|}
end_function

begin_comment
comment|/*
comment|*/
end_comment

begin_struct
struct|struct
name|adrtab
block|{
define|#
directive|define
name|ADN_SIZE
value|ADR_SIZE
comment|/* ClnpAddress instance */
name|unsigned
name|int
name|adn_instance
index|[
name|ADN_SIZE
index|]
decl_stmt|;
name|int
name|adn_insize
decl_stmt|;
name|struct
name|iso_addr
name|adn_address
decl_stmt|;
comment|/* ClnpAddress */
define|#
directive|define
name|ADM_SIZE
value|ADR_SIZE
comment|/* PhysAddress instance */
name|unsigned
name|int
name|adm_instance
index|[
name|ADM_SIZE
index|]
decl_stmt|;
name|int
name|adm_insize
decl_stmt|;
name|u_char
name|adm_address
index|[
name|ADM_SIZE
index|]
decl_stmt|;
comment|/* PhysAddress */
name|u_char
name|adm_addrlen
decl_stmt|;
comment|/*   .. */
name|int
name|adr_index
decl_stmt|;
comment|/* ifIndex */
name|int
name|adr_type
decl_stmt|;
comment|/* clnpNetToMediaType */
comment|/* clnpMediaToNetType */
define|#
directive|define
name|DYNAMIC_MAPPING
value|3
define|#
directive|define
name|STATIC_MAPPING
value|4
name|struct
name|adrtab
modifier|*
name|adn_next
decl_stmt|;
comment|/* next ClnpAddress */
name|struct
name|adrtab
modifier|*
name|adm_next
decl_stmt|;
comment|/* next PhysAddress */
block|}
struct|;
end_struct

begin_decl_stmt
specifier|static
name|struct
name|adrtab
modifier|*
name|adn
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|adrtab
modifier|*
name|adm
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|flush_arp_cache
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_function_decl
specifier|static
name|struct
name|adrtab
modifier|*
name|get_arpent
parameter_list|()
function_decl|;
end_function_decl

begin_comment
comment|/*
comment|*/
end_comment

begin_define
define|#
directive|define
name|clnpNetToMediaIfIndex
value|0
end_define

begin_define
define|#
directive|define
name|clnpNetToMediaPhysAddress
value|1
end_define

begin_define
define|#
directive|define
name|clnpNetToMediaNetAddress
value|2
end_define

begin_define
define|#
directive|define
name|clnpNetToMediaType
value|3
end_define

begin_undef
undef|#
directive|undef
name|clnpNetToMediaAge
name|4
end_undef

begin_comment
comment|/* NOT IMPLEMENTED */
end_comment

begin_undef
undef|#
directive|undef
name|clnpNetToMediaHoldTime
name|5
end_undef

begin_comment
comment|/* NOT IMPLEMENTED */
end_comment

begin_define
define|#
directive|define
name|clnpMediaToNetIfIndex
value|6
end_define

begin_define
define|#
directive|define
name|clnpMediaToNetNetAddress
value|7
end_define

begin_define
define|#
directive|define
name|clnpMediaToNetPhysAddress
value|8
end_define

begin_define
define|#
directive|define
name|clnpMediaToNetType
value|9
end_define

begin_undef
undef|#
directive|undef
name|clnpMediaToNetAge
name|10
end_undef

begin_comment
comment|/* NOT IMPLEMENTED */
end_comment

begin_undef
undef|#
directive|undef
name|clnpMediaToNetHoldTime
name|11
end_undef

begin_comment
comment|/* NOT IMPLEMENTED */
end_comment

begin_function
specifier|static
name|int
name|o_address
parameter_list|(
name|oi
parameter_list|,
name|v
parameter_list|,
name|offset
parameter_list|)
name|OI
name|oi
decl_stmt|;
specifier|register
name|struct
name|type_SNMP_VarBind
modifier|*
name|v
decl_stmt|;
name|int
name|offset
decl_stmt|;
block|{
specifier|register
name|int
name|i
decl_stmt|;
name|int
name|ifvar
decl_stmt|,
name|isnpa
decl_stmt|;
specifier|register
name|unsigned
name|int
modifier|*
name|ip
decl_stmt|,
modifier|*
name|jp
decl_stmt|;
specifier|register
name|struct
name|adrtab
modifier|*
name|at
decl_stmt|;
name|struct
name|sockaddr_iso
name|netaddr
decl_stmt|;
specifier|register
name|OID
name|oid
init|=
name|oi
operator|->
name|oi_name
decl_stmt|;
specifier|register
name|OT
name|ot
init|=
name|oi
operator|->
name|oi_type
decl_stmt|;
if|if
condition|(
name|get_arptab
argument_list|(
name|offset
argument_list|)
operator|==
name|NOTOK
condition|)
return|return
name|generr
argument_list|(
name|offset
argument_list|)
return|;
switch|switch
condition|(
name|ifvar
operator|=
operator|(
name|int
operator|)
name|ot
operator|->
name|ot_info
condition|)
block|{
case|case
name|clnpNetToMediaIfIndex
case|:
case|case
name|clnpNetToMediaPhysAddress
case|:
case|case
name|clnpNetToMediaNetAddress
case|:
case|case
name|clnpNetToMediaType
case|:
name|isnpa
operator|=
literal|0
expr_stmt|;
break|break;
case|case
name|clnpMediaToNetIfIndex
case|:
case|case
name|clnpMediaToNetNetAddress
case|:
case|case
name|clnpMediaToNetPhysAddress
case|:
case|case
name|clnpMediaToNetType
case|:
name|isnpa
operator|=
literal|1
expr_stmt|;
break|break;
default|default:
return|return
name|generr
argument_list|(
name|offset
argument_list|)
return|;
block|}
switch|switch
condition|(
name|offset
condition|)
block|{
case|case
name|type_SNMP_PDUs_get__request
case|:
if|if
condition|(
name|oid
operator|->
name|oid_nelem
operator|<=
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
condition|)
return|return
name|int_SNMP_error__status_noSuchName
return|;
if|if
condition|(
operator|(
name|at
operator|=
name|get_arpent
argument_list|(
name|oid
operator|->
name|oid_elements
operator|+
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
argument_list|,
name|oid
operator|->
name|oid_nelem
operator|-
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
argument_list|,
name|isnpa
argument_list|,
literal|0
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
name|int_SNMP_error__status_noSuchName
return|;
break|break;
case|case
name|type_SNMP_PDUs_get__next__request
case|:
if|if
condition|(
name|oid
operator|->
name|oid_nelem
operator|<
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
condition|)
return|return
name|NOTOK
return|;
if|if
condition|(
name|oid
operator|->
name|oid_nelem
operator|==
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
condition|)
block|{
name|OID
name|new
decl_stmt|;
if|if
condition|(
operator|(
name|at
operator|=
name|isnpa
condition|?
name|adm
else|:
name|adn
operator|)
operator|==
name|NULL
condition|)
return|return
name|NOTOK
return|;
if|if
condition|(
name|isnpa
condition|)
name|jp
operator|=
name|at
operator|->
name|adm_instance
operator|,
name|i
operator|=
name|at
operator|->
name|adm_insize
expr_stmt|;
else|else
name|jp
operator|=
name|at
operator|->
name|adn_instance
operator|,
name|i
operator|=
name|at
operator|->
name|adn_insize
expr_stmt|;
if|if
condition|(
operator|(
name|new
operator|=
name|oid_extend
argument_list|(
name|oid
argument_list|,
name|i
argument_list|)
operator|)
operator|==
name|NULLOID
condition|)
return|return
name|NOTOK
return|;
name|ip
operator|=
name|new
operator|->
name|oid_elements
operator|+
name|new
operator|->
name|oid_nelem
operator|-
name|i
expr_stmt|;
for|for
control|(
init|;
name|i
operator|>
literal|0
condition|;
name|i
operator|--
control|)
operator|*
name|ip
operator|++
operator|=
operator|*
name|jp
operator|++
expr_stmt|;
if|if
condition|(
name|v
operator|->
name|name
condition|)
name|free_SNMP_ObjectName
argument_list|(
name|v
operator|->
name|name
argument_list|)
expr_stmt|;
name|v
operator|->
name|name
operator|=
name|new
expr_stmt|;
block|}
else|else
block|{
name|int
name|j
decl_stmt|;
if|if
condition|(
operator|(
name|at
operator|=
name|get_arpent
argument_list|(
name|oid
operator|->
name|oid_elements
operator|+
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
argument_list|,
name|j
operator|=
name|oid
operator|->
name|oid_nelem
operator|-
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
argument_list|,
name|isnpa
argument_list|,
literal|1
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
name|NOTOK
return|;
name|i
operator|=
name|isnpa
condition|?
name|at
operator|->
name|adm_insize
else|:
name|at
operator|->
name|adn_insize
expr_stmt|;
if|if
condition|(
operator|(
name|i
operator|=
name|j
operator|-
name|i
operator|)
operator|<
literal|0
condition|)
block|{
name|OID
name|new
decl_stmt|;
if|if
condition|(
operator|(
name|new
operator|=
name|oid_extend
argument_list|(
name|oid
argument_list|,
operator|-
name|i
argument_list|)
operator|)
operator|==
name|NULLOID
condition|)
return|return
name|NOTOK
return|;
if|if
condition|(
name|v
operator|->
name|name
condition|)
name|free_SNMP_ObjectName
argument_list|(
name|v
operator|->
name|name
argument_list|)
expr_stmt|;
name|v
operator|->
name|name
operator|=
name|new
expr_stmt|;
name|oid
operator|=
name|new
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|i
operator|>
literal|0
condition|)
name|oid
operator|->
name|oid_nelem
operator|-=
name|i
expr_stmt|;
name|ip
operator|=
name|oid
operator|->
name|oid_elements
operator|+
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
expr_stmt|;
if|if
condition|(
name|isnpa
condition|)
name|jp
operator|=
name|at
operator|->
name|adm_instance
operator|,
name|i
operator|=
name|at
operator|->
name|adm_insize
expr_stmt|;
else|else
name|jp
operator|=
name|at
operator|->
name|adn_instance
operator|,
name|i
operator|=
name|at
operator|->
name|adn_insize
expr_stmt|;
for|for
control|(
init|;
name|i
operator|>
literal|0
condition|;
name|i
operator|--
control|)
operator|*
name|ip
operator|++
operator|=
operator|*
name|jp
operator|++
expr_stmt|;
block|}
break|break;
default|default:
return|return
name|int_SNMP_error__status_genErr
return|;
block|}
switch|switch
condition|(
name|ifvar
condition|)
block|{
case|case
name|clnpNetToMediaIfIndex
case|:
case|case
name|clnpMediaToNetIfIndex
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|at
operator|->
name|adr_index
argument_list|)
return|;
case|case
name|clnpNetToMediaPhysAddress
case|:
case|case
name|clnpMediaToNetPhysAddress
case|:
return|return
name|o_string
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
operator|(
name|char
operator|*
operator|)
name|at
operator|->
name|adm_address
argument_list|,
operator|(
name|int
operator|)
name|at
operator|->
name|adm_addrlen
argument_list|)
return|;
case|case
name|clnpNetToMediaNetAddress
case|:
case|case
name|clnpMediaToNetNetAddress
case|:
name|netaddr
operator|.
name|siso_addr
operator|=
name|at
operator|->
name|adn_address
expr_stmt|;
comment|/* struct copy */
return|return
name|o_clnpaddr
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
operator|&
name|netaddr
argument_list|)
return|;
case|case
name|clnpNetToMediaType
case|:
case|case
name|clnpMediaToNetType
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|at
operator|->
name|adr_type
argument_list|)
return|;
default|default:
return|return
name|int_SNMP_error__status_noSuchName
return|;
block|}
block|}
end_function

begin_comment
comment|/*
comment|*/
end_comment

begin_function
specifier|static
name|int
name|adn_compar
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
specifier|register
name|struct
name|adrtab
modifier|*
modifier|*
name|a
decl_stmt|,
decl|*
modifier|*
name|b
decl_stmt|;
end_function

begin_block
block|{
return|return
name|elem_cmp
argument_list|(
operator|(
operator|*
name|a
operator|)
operator|->
name|adn_instance
argument_list|,
operator|(
operator|*
name|a
operator|)
operator|->
name|adn_insize
argument_list|,
operator|(
operator|*
name|b
operator|)
operator|->
name|adn_instance
argument_list|,
operator|(
operator|*
name|b
operator|)
operator|->
name|adn_insize
argument_list|)
return|;
block|}
end_block

begin_function
specifier|static
name|int
name|adm_compar
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
specifier|register
name|struct
name|adrtab
modifier|*
modifier|*
name|a
decl_stmt|,
decl|*
modifier|*
name|b
decl_stmt|;
end_function

begin_block
block|{
return|return
name|elem_cmp
argument_list|(
operator|(
operator|*
name|a
operator|)
operator|->
name|adm_instance
argument_list|,
operator|(
operator|*
name|a
operator|)
operator|->
name|adm_insize
argument_list|,
operator|(
operator|*
name|b
operator|)
operator|->
name|adm_instance
argument_list|,
operator|(
operator|*
name|b
operator|)
operator|->
name|adm_insize
argument_list|)
return|;
block|}
end_block

begin_define
define|#
directive|define
name|ROUND
parameter_list|(
name|a
parameter_list|)
value|(1 + (((a) - 1) | (sizeof (long) - 1)))
end_define

begin_function
specifier|static
name|int
name|get_arptab
parameter_list|(
name|offset
parameter_list|)
name|int
name|offset
decl_stmt|;
block|{
name|int
name|adrNumber
init|=
literal|0
decl_stmt|,
name|rlen
decl_stmt|,
name|tblsize
decl_stmt|;
name|char
modifier|*
name|snpac
decl_stmt|;
specifier|register
name|char
modifier|*
name|sc
decl_stmt|,
modifier|*
name|se
decl_stmt|;
specifier|register
name|struct
name|adrtab
modifier|*
name|at
decl_stmt|,
modifier|*
name|ap
decl_stmt|,
modifier|*
modifier|*
name|base
decl_stmt|,
modifier|*
modifier|*
name|afe
decl_stmt|,
modifier|*
modifier|*
name|afp
decl_stmt|;
specifier|register
name|struct
name|interface
modifier|*
name|is
decl_stmt|;
specifier|register
name|struct
name|rt_msghdr
modifier|*
name|rtm
decl_stmt|;
specifier|static
name|int
name|first_time
init|=
literal|1
decl_stmt|;
specifier|static
name|int
name|lastq
init|=
operator|-
literal|1
decl_stmt|;
if|if
condition|(
name|quantum
operator|==
name|lastq
condition|)
return|return
name|OK
return|;
if|if
condition|(
operator|!
name|flush_arp_cache
operator|&&
name|offset
operator|==
name|type_SNMP_PDUs_get__next__request
operator|&&
name|quantum
operator|==
name|lastq
operator|+
literal|1
condition|)
block|{
comment|/* XXX: caching! */
name|lastq
operator|=
name|quantum
expr_stmt|;
return|return
name|OK
return|;
block|}
name|lastq
operator|=
name|quantum
operator|,
name|flush_arp_cache
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|at
operator|=
name|adn
init|;
name|at
condition|;
name|at
operator|=
name|ap
control|)
block|{
name|ap
operator|=
name|at
operator|->
name|adn_next
expr_stmt|;
name|free
argument_list|(
operator|(
name|char
operator|*
operator|)
name|at
argument_list|)
expr_stmt|;
block|}
name|adn
operator|=
name|adm
operator|=
name|NULL
expr_stmt|;
if|if
condition|(
operator|(
name|tblsize
operator|=
name|getkerninfo
argument_list|(
name|KINFO_RT_DUMP
argument_list|,
name|NULLCP
argument_list|,
name|NULLIP
argument_list|,
literal|0
argument_list|)
operator|)
operator|==
name|NOTOK
condition|)
return|return
name|NOTOK
return|;
if|if
condition|(
operator|(
name|snpac
operator|=
name|malloc
argument_list|(
operator|(
name|unsigned
operator|)
name|tblsize
argument_list|)
operator|)
operator|==
name|NULL
condition|)
name|adios
argument_list|(
name|NULLCP
argument_list|,
literal|"out of memory"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|rlen
operator|=
name|getkerninfo
argument_list|(
name|KINFO_RT_DUMP
argument_list|,
name|snpac
argument_list|,
operator|&
name|tblsize
argument_list|,
literal|0
argument_list|)
operator|)
operator|==
name|NOTOK
condition|)
block|{
name|free
argument_list|(
name|snpac
argument_list|)
expr_stmt|;
return|return
name|NOTOK
return|;
block|}
name|afp
operator|=
operator|&
name|adn
expr_stmt|;
for|for
control|(
name|se
operator|=
operator|(
name|sc
operator|=
name|snpac
operator|)
operator|+
name|rlen
init|;
name|sc
operator|<
name|se
condition|;
name|sc
operator|+=
name|rtm
operator|->
name|rtm_msglen
control|)
block|{
specifier|register
name|struct
name|sockaddr_dl
modifier|*
name|sdl
decl_stmt|;
specifier|register
name|struct
name|sockaddr
modifier|*
name|sa
decl_stmt|;
name|struct
name|iso_addr
name|nsap
decl_stmt|;
name|rtm
operator|=
operator|(
expr|struct
name|rt_msghdr
operator|*
operator|)
name|sc
expr_stmt|;
name|sa
operator|=
operator|(
expr|struct
name|sockaddr
operator|*
operator|)
operator|(
name|rtm
operator|+
literal|1
operator|)
expr_stmt|;
if|if
condition|(
name|sa
operator|->
name|sa_family
operator|!=
name|AF_ISO
condition|)
continue|continue;
name|sdl
operator|=
operator|(
expr|struct
name|sockaddr_dl
operator|*
operator|)
operator|(
operator|(
operator|(
name|caddr_t
operator|)
name|sa
operator|)
operator|+
name|ROUND
argument_list|(
name|sa
operator|->
name|sa_len
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
name|sdl
operator|->
name|sdl_family
operator|!=
name|AF_LINK
condition|)
continue|continue;
name|nsap
operator|=
operator|(
operator|(
expr|struct
name|sockaddr_iso
operator|*
operator|)
name|sa
operator|)
operator|->
name|siso_addr
expr_stmt|;
comment|/* struct copy */
if|if
condition|(
name|nsap
operator|.
name|isoa_len
operator|==
literal|0
condition|)
continue|continue;
for|for
control|(
name|is
operator|=
name|ifs
init|;
name|is
condition|;
name|is
operator|=
name|is
operator|->
name|ifn_next
control|)
if|if
condition|(
name|is
operator|->
name|ifn_interface
operator|.
name|ac_if
operator|.
name|if_index
operator|==
name|rtm
operator|->
name|rtm_index
condition|)
break|break;
if|if
condition|(
operator|!
name|is
condition|)
block|{
if|if
condition|(
name|first_time
condition|)
name|advise
argument_list|(
name|LLOG_EXCEPTIONS
argument_list|,
name|NULLCP
argument_list|,
literal|"unable to find interface for SNPA in cache"
argument_list|)
expr_stmt|;
continue|continue;
block|}
if|if
condition|(
operator|(
name|at
operator|=
operator|(
expr|struct
name|adrtab
operator|*
operator|)
name|calloc
argument_list|(
literal|1
argument_list|,
sizeof|sizeof
expr|*
name|at
argument_list|)
operator|)
operator|==
name|NULL
condition|)
name|adios
argument_list|(
name|NULLCP
argument_list|,
literal|"out of memory"
argument_list|)
expr_stmt|;
operator|*
name|afp
operator|=
name|at
operator|,
name|afp
operator|=
operator|&
name|at
operator|->
name|adn_next
operator|,
name|adrNumber
operator|++
expr_stmt|;
name|at
operator|->
name|adr_index
operator|=
name|is
operator|->
name|ifn_index
expr_stmt|;
name|at
operator|->
name|adr_type
operator|=
name|rtm
operator|->
name|rtm_flags
operator|&
operator|(
name|RTF_DYNAMIC
operator||
name|RTF_MODIFIED
operator|)
condition|?
name|DYNAMIC_MAPPING
else|:
name|STATIC_MAPPING
expr_stmt|;
name|at
operator|->
name|adn_address
operator|=
name|nsap
expr_stmt|;
comment|/* struct copy */
name|at
operator|->
name|adn_instance
index|[
literal|0
index|]
operator|=
name|at
operator|->
name|adr_index
operator|,
name|at
operator|->
name|adn_insize
operator|=
literal|1
expr_stmt|;
name|at
operator|->
name|adn_insize
operator|+=
name|clnpaddr2oid
argument_list|(
name|at
operator|->
name|adn_instance
operator|+
literal|1
argument_list|,
operator|&
name|at
operator|->
name|adn_address
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|(
name|char
operator|*
operator|)
name|LLADDR
argument_list|(
name|sdl
argument_list|)
argument_list|,
operator|(
name|char
operator|*
operator|)
name|at
operator|->
name|adm_address
argument_list|,
call|(
name|int
call|)
argument_list|(
name|at
operator|->
name|adm_addrlen
operator|=
name|sdl
operator|->
name|sdl_alen
argument_list|)
argument_list|)
expr_stmt|;
name|at
operator|->
name|adm_instance
index|[
literal|0
index|]
operator|=
name|at
operator|->
name|adr_index
operator|,
name|at
operator|->
name|adm_insize
operator|=
literal|1
expr_stmt|;
name|at
operator|->
name|adm_insize
operator|+=
name|mediaddr2oid
argument_list|(
name|at
operator|->
name|adm_instance
operator|+
literal|1
argument_list|,
name|at
operator|->
name|adm_address
argument_list|,
operator|(
name|int
operator|)
name|at
operator|->
name|adm_addrlen
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|debug
operator|&&
name|first_time
condition|)
block|{
name|char
name|buffer
index|[
name|BUFSIZ
index|]
decl_stmt|;
name|OIDentifier
name|oids
decl_stmt|;
name|oids
operator|.
name|oid_elements
operator|=
name|at
operator|->
name|adn_instance
expr_stmt|;
name|oids
operator|.
name|oid_nelem
operator|=
name|at
operator|->
name|adn_insize
expr_stmt|;
operator|(
name|void
operator|)
name|strcpy
argument_list|(
name|buffer
argument_list|,
name|sprintoid
argument_list|(
operator|&
name|oids
argument_list|)
argument_list|)
expr_stmt|;
name|oids
operator|.
name|oid_elements
operator|=
name|at
operator|->
name|adm_instance
expr_stmt|;
name|oids
operator|.
name|oid_nelem
operator|=
name|at
operator|->
name|adm_insize
expr_stmt|;
name|advise
argument_list|(
name|LLOG_DEBUG
argument_list|,
name|NULLCP
argument_list|,
literal|"add mapping on interface %d: %s -> %s"
argument_list|,
name|at
operator|->
name|adr_index
argument_list|,
name|buffer
argument_list|,
name|sprintoid
argument_list|(
operator|&
name|oids
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
name|first_time
operator|=
literal|0
expr_stmt|;
name|free
argument_list|(
operator|(
name|char
operator|*
operator|)
name|snpac
argument_list|)
expr_stmt|;
if|if
condition|(
name|adrNumber
operator|<=
literal|1
condition|)
block|{
name|adm
operator|=
name|adn
expr_stmt|;
return|return
name|OK
return|;
block|}
if|if
condition|(
operator|(
name|base
operator|=
operator|(
expr|struct
name|adrtab
operator|*
operator|*
operator|)
name|malloc
argument_list|(
call|(
name|unsigned
call|)
argument_list|(
name|adrNumber
operator|*
sizeof|sizeof
expr|*
name|base
argument_list|)
argument_list|)
operator|)
operator|==
name|NULL
condition|)
name|adios
argument_list|(
name|NULLCP
argument_list|,
literal|"out of memory"
argument_list|)
expr_stmt|;
name|afe
operator|=
name|base
expr_stmt|;
for|for
control|(
name|at
operator|=
name|adn
init|;
name|at
condition|;
name|at
operator|=
name|at
operator|->
name|adn_next
control|)
operator|*
name|afe
operator|++
operator|=
name|at
expr_stmt|;
name|qsort
argument_list|(
operator|(
name|char
operator|*
operator|)
name|base
argument_list|,
name|adrNumber
argument_list|,
sizeof|sizeof
expr|*
name|base
argument_list|,
name|adn_compar
argument_list|)
expr_stmt|;
name|afp
operator|=
name|base
expr_stmt|;
name|at
operator|=
name|adn
operator|=
operator|*
name|afp
operator|++
expr_stmt|;
while|while
condition|(
name|afp
operator|<
name|afe
condition|)
block|{
name|at
operator|->
name|adn_next
operator|=
operator|*
name|afp
expr_stmt|;
name|at
operator|=
operator|*
name|afp
operator|++
expr_stmt|;
block|}
name|at
operator|->
name|adn_next
operator|=
name|NULL
expr_stmt|;
name|qsort
argument_list|(
operator|(
name|char
operator|*
operator|)
name|base
argument_list|,
name|adrNumber
argument_list|,
sizeof|sizeof
expr|*
name|base
argument_list|,
name|adm_compar
argument_list|)
expr_stmt|;
name|afp
operator|=
name|base
expr_stmt|;
name|at
operator|=
name|adm
operator|=
operator|*
name|afp
operator|++
expr_stmt|;
while|while
condition|(
name|afp
operator|<
name|afe
condition|)
block|{
name|at
operator|->
name|adm_next
operator|=
operator|*
name|afp
expr_stmt|;
name|at
operator|=
operator|*
name|afp
operator|++
expr_stmt|;
block|}
name|at
operator|->
name|adm_next
operator|=
name|NULL
expr_stmt|;
name|free
argument_list|(
operator|(
name|char
operator|*
operator|)
name|base
argument_list|)
expr_stmt|;
return|return
name|OK
return|;
block|}
end_function

begin_undef
undef|#
directive|undef
name|ROUND
end_undef

begin_comment
comment|/*
comment|*/
end_comment

begin_function
specifier|static
name|struct
name|adrtab
modifier|*
name|get_arpent
parameter_list|(
name|ip
parameter_list|,
name|len
parameter_list|,
name|isnpa
parameter_list|,
name|isnext
parameter_list|)
specifier|register
name|unsigned
name|int
modifier|*
name|ip
decl_stmt|;
name|int
name|len
decl_stmt|;
name|int
name|isnpa
decl_stmt|,
name|isnext
decl_stmt|;
block|{
specifier|register
name|struct
name|adrtab
modifier|*
name|at
decl_stmt|;
if|if
condition|(
name|isnpa
condition|)
for|for
control|(
name|at
operator|=
name|adm
init|;
name|at
condition|;
name|at
operator|=
name|at
operator|->
name|adm_next
control|)
switch|switch
condition|(
name|elem_cmp
argument_list|(
name|at
operator|->
name|adm_instance
argument_list|,
name|at
operator|->
name|adm_insize
argument_list|,
name|ip
argument_list|,
name|len
argument_list|)
condition|)
block|{
case|case
literal|0
case|:
if|if
condition|(
operator|!
name|isnext
condition|)
return|return
name|at
return|;
if|if
condition|(
operator|(
name|at
operator|=
name|at
operator|->
name|adm_next
operator|)
operator|==
name|NULL
condition|)
goto|goto
name|out
goto|;
comment|/* else fall... */
case|case
literal|1
case|:
return|return
operator|(
name|isnext
condition|?
name|at
else|:
name|NULL
operator|)
return|;
block|}
else|else
for|for
control|(
name|at
operator|=
name|adn
init|;
name|at
condition|;
name|at
operator|=
name|at
operator|->
name|adn_next
control|)
switch|switch
condition|(
name|elem_cmp
argument_list|(
name|at
operator|->
name|adn_instance
argument_list|,
name|at
operator|->
name|adn_insize
argument_list|,
name|ip
argument_list|,
name|len
argument_list|)
condition|)
block|{
case|case
literal|0
case|:
if|if
condition|(
operator|!
name|isnext
condition|)
return|return
name|at
return|;
if|if
condition|(
operator|(
name|at
operator|=
name|at
operator|->
name|adn_next
operator|)
operator|==
name|NULL
condition|)
goto|goto
name|out
goto|;
comment|/* else fall... */
case|case
literal|1
case|:
return|return
operator|(
name|isnext
condition|?
name|at
else|:
name|NULL
operator|)
return|;
block|}
name|out
label|:
empty_stmt|;
name|flush_arp_cache
operator|=
literal|1
expr_stmt|;
return|return
name|NULL
return|;
block|}
end_function

begin_comment
comment|/*
comment|*/
end_comment

begin_decl_stmt
specifier|static
name|struct
name|esis_stat
name|esis_stat
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*
comment|*/
end_comment

begin_define
define|#
directive|define
name|esisESHins
value|0
end_define

begin_define
define|#
directive|define
name|esisESHouts
value|1
end_define

begin_define
define|#
directive|define
name|esisISHins
value|2
end_define

begin_define
define|#
directive|define
name|esisISHouts
value|3
end_define

begin_define
define|#
directive|define
name|esisRDUins
value|4
end_define

begin_define
define|#
directive|define
name|esisRDUouts
value|5
end_define

begin_function
specifier|static
name|int
name|o_esis
parameter_list|(
name|oi
parameter_list|,
name|v
parameter_list|,
name|offset
parameter_list|)
name|OI
name|oi
decl_stmt|;
specifier|register
name|struct
name|type_SNMP_VarBind
modifier|*
name|v
decl_stmt|;
name|int
name|offset
decl_stmt|;
block|{
name|int
name|ifvar
decl_stmt|;
specifier|register
name|struct
name|esis_stat
modifier|*
name|es
init|=
operator|&
name|esis_stat
decl_stmt|;
specifier|register
name|OID
name|oid
init|=
name|oi
operator|->
name|oi_name
decl_stmt|;
specifier|register
name|OT
name|ot
init|=
name|oi
operator|->
name|oi_type
decl_stmt|;
specifier|static
name|int
name|lastq
init|=
operator|-
literal|1
decl_stmt|;
name|ifvar
operator|=
operator|(
name|int
operator|)
name|ot
operator|->
name|ot_info
expr_stmt|;
switch|switch
condition|(
name|offset
condition|)
block|{
case|case
name|type_SNMP_PDUs_get__request
case|:
if|if
condition|(
name|oid
operator|->
name|oid_nelem
operator|!=
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
operator|+
literal|1
operator|||
name|oid
operator|->
name|oid_elements
index|[
name|oid
operator|->
name|oid_nelem
operator|-
literal|1
index|]
operator|!=
literal|0
condition|)
return|return
name|int_SNMP_error__status_noSuchName
return|;
break|break;
case|case
name|type_SNMP_PDUs_get__next__request
case|:
if|if
condition|(
name|oid
operator|->
name|oid_nelem
operator|==
name|ot
operator|->
name|ot_name
operator|->
name|oid_nelem
condition|)
block|{
name|OID
name|new
decl_stmt|;
if|if
condition|(
operator|(
name|new
operator|=
name|oid_extend
argument_list|(
name|oid
argument_list|,
literal|1
argument_list|)
operator|)
operator|==
name|NULLOID
condition|)
return|return
name|NOTOK
return|;
name|new
operator|->
name|oid_elements
index|[
name|new
operator|->
name|oid_nelem
operator|-
literal|1
index|]
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|v
operator|->
name|name
condition|)
name|free_SNMP_ObjectName
argument_list|(
name|v
operator|->
name|name
argument_list|)
expr_stmt|;
name|v
operator|->
name|name
operator|=
name|new
expr_stmt|;
block|}
else|else
return|return
name|NOTOK
return|;
break|break;
default|default:
return|return
name|int_SNMP_error__status_genErr
return|;
block|}
if|if
condition|(
name|quantum
operator|!=
name|lastq
condition|)
block|{
name|lastq
operator|=
name|quantum
expr_stmt|;
if|if
condition|(
name|getkmem
argument_list|(
name|nl
operator|+
name|N_ESIS_STAT
argument_list|,
operator|(
name|caddr_t
operator|)
operator|&
name|esis_stat
argument_list|,
sizeof|sizeof
name|esis_stat
argument_list|)
operator|==
name|NOTOK
condition|)
return|return
name|generr
argument_list|(
name|offset
argument_list|)
return|;
block|}
switch|switch
condition|(
name|ifvar
condition|)
block|{
case|case
name|esisESHins
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|es
operator|->
name|es_eshrcvd
argument_list|)
return|;
case|case
name|esisESHouts
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|es
operator|->
name|es_eshsent
argument_list|)
return|;
case|case
name|esisISHins
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|es
operator|->
name|es_ishrcvd
argument_list|)
return|;
case|case
name|esisISHouts
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|es
operator|->
name|es_ishsent
argument_list|)
return|;
case|case
name|esisRDUins
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|es
operator|->
name|es_rdrcvd
argument_list|)
return|;
case|case
name|esisRDUouts
case|:
return|return
name|o_integer
argument_list|(
name|oi
argument_list|,
name|v
argument_list|,
name|es
operator|->
name|es_rdsent
argument_list|)
return|;
default|default:
return|return
name|int_SNMP_error__status_noSuchName
return|;
block|}
block|}
end_function

begin_comment
comment|/*
comment|*/
end_comment

begin_macro
name|init_clns
argument_list|()
end_macro

begin_block
block|{
specifier|register
name|OT
name|ot
decl_stmt|;
if|if
condition|(
name|nl
index|[
name|N_ISO_SYSTYPE
index|]
operator|.
name|n_value
operator|==
literal|0
condition|)
return|return;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpForwarding"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpForwarding
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpDefaultLifeTime"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpDefaultLifeTime
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInReceives"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInReceives
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInHdrErrors"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInHdrErrors
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInAddrErrors"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInAddrErrors
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpForwPDUs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpForwPDUs
expr_stmt|;
ifdef|#
directive|ifdef
name|clnpInUnknownNLPs
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInUnknownNLPs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInUnknownNLPs
expr_stmt|;
endif|#
directive|endif
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInUnknownULPs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInUnknownULPs
expr_stmt|;
ifdef|#
directive|ifdef
name|clnpInDiscards
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInDiscards"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInDiscards
expr_stmt|;
endif|#
directive|endif
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInDelivers"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInDelivers
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutRequests"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutRequests
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutDiscards"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutDiscards
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutNoRoutes"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutNoRoutes
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpReasmTimeout"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpReasmTimeout
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpReasmReqds"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpReasmReqds
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpReasmOKs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpReasmOKs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpReasmFails"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpReasmFails
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpSegOKs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpSegOKs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpSegFails"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpSegFails
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpSegCreates"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpSegCreates
expr_stmt|;
ifdef|#
directive|ifdef
name|clnpInOpts
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInOpts"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInOpts
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|clnpOutOpts
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutOpts"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutOpts
expr_stmt|;
endif|#
directive|endif
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpAdEntAddr"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp_addr
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpAdEntAddr
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpAdEntIfIndex"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp_addr
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpAdEntIfIndex
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpAdEntNetMask"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp_addr
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpAdEntNetMask
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpAdEntReasmMaxSize"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp_addr
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpAdEntReasmMaxSize
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpRouteDest"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp_route
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpRouteDest
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpRouteIfIndex"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp_route
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpRouteIfIndex
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpRouteMetric1"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp_route
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpRouteMetric1
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpRouteMetric2"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp_route
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpRouteMetric2
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpRouteMetric3"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp_route
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpRouteMetric3
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpRouteMetric4"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp_route
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpRouteMetric4
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpRouteNextHop"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp_route
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpRouteNextHop
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpRouteType"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp_route
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpRouteType
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpRouteProto"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp_route
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpRouteProto
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpRouteAge"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp_route
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpRouteAge
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"unixClnpRouteFlags"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp_route
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|unixClnpRouteFlags
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"unixClnpRouteRefCnt"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp_route
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|unixClnpRouteRefCnt
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"unixClnpRouteUses"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp_route
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|unixClnpRouteUses
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpNetToMediaIfIndex"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_address
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpNetToMediaIfIndex
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpNetToMediaPhysAddress"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_address
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpNetToMediaPhysAddress
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpNetToMediaNetAddress"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_address
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpNetToMediaNetAddress
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpNetToMediaType"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_address
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpNetToMediaType
expr_stmt|;
ifdef|#
directive|ifdef
name|clnpNetToMediaAge
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpNetToMediaAge"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_address
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpNetToMediaAge
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|clnpNetToMediaHoldTime
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpNetToMediaHoldTime"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_address
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpNetToMediaHoldTime
expr_stmt|;
endif|#
directive|endif
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpMediaToNetIfIndex"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_address
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpMediaToNetIfIndex
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpMediaToNetNetAddress"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_address
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpMediaToNetNetAddress
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpMediaToNetPhysAddress"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_address
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpMediaToNetPhysAddress
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpMediaToNetType"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_address
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpMediaToNetType
expr_stmt|;
ifdef|#
directive|ifdef
name|clnpMediaToNetAge
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpMediaToNetAge"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_address
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpMediaToNetAge
expr_stmt|;
endif|#
directive|endif
ifdef|#
directive|ifdef
name|clnpMediaToNetHoldTime
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpMediaToNetHoldTime"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_address
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpMediaToNetHoldTime
expr_stmt|;
endif|#
directive|endif
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrors"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrors
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrors"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrors
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrUnspecs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrUnspecs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrProcs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrProcs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrCksums"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrCksums
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrCongests"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrCongests
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrHdrs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrHdrs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrSegs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrSegs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrIncomps"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrIncomps
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrDups"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrDups
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrUnreachDsts"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrUnreachDsts
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrUnknownDsts"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrUnknownDsts
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrSRUnspecs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrSRUnspecs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrSRSyntaxes"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrSRSyntaxes
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrSRUnkAddrs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrSRUnkAddrs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrSRBadPaths"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrSRBadPaths
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrHops"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrHops
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrHopReassms"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrHopReassms
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrUnsOptions"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrUnsOptions
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrUnsVersions"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrUnsVersions
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrUnsSecurities"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrUnsSecurities
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrUnsSRs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrUnsSRs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrUnsRRs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrUnsRRs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpInErrInterferences"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpInErrInterferences
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrUnspecs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrUnspecs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrProcs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrProcs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrCksums"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrCksums
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrCongests"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrCongests
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrHdrs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrHdrs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrSegs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrSegs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrIncomps"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrIncomps
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrDups"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrDups
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrUnreachDsts"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrUnreachDsts
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrUnknownDsts"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrUnknownDsts
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrSRUnspecs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrSRUnspecs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrSRSyntaxes"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrSRSyntaxes
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrSRUnkAddrs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrSRUnkAddrs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrSRBadPaths"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrSRBadPaths
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrHops"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrHops
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrHopReassms"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrHopReassms
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrUnsOptions"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrUnsOptions
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrUnsVersions"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrUnsVersions
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrUnsSecurities"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrUnsSecurities
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrUnsSRs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrUnsSRs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrUnsRRs"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrUnsRRs
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"clnpOutErrInterferences"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_clnp
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|clnpOutErrInterferences
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"esisESHins"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_esis
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|esisESHins
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"esisESHouts"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_esis
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|esisESHouts
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"esisISHins"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_esis
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|esisISHins
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"esisISHouts"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_esis
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|esisISHouts
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"esisRDUins"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_esis
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|esisRDUins
expr_stmt|;
if|if
condition|(
name|ot
operator|=
name|text2obj
argument_list|(
literal|"esisRDUouts"
argument_list|)
condition|)
name|ot
operator|->
name|ot_getfnx
operator|=
name|o_esis
operator|,
name|ot
operator|->
name|ot_info
operator|=
operator|(
name|caddr_t
operator|)
name|esisRDUouts
expr_stmt|;
block|}
end_block

begin_else
else|#
directive|else
end_else

begin_macro
name|init_clns
argument_list|()
end_macro

begin_block
block|{}
end_block

begin_endif
endif|#
directive|endif
end_endif

end_unit

