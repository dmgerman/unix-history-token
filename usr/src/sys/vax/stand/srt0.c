begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*	srt0.c	4.9	82/07/15	*/
end_comment

begin_include
include|#
directive|include
file|"../h/mtpr.h"
end_include

begin_define
define|#
directive|define
name|LOCORE
end_define

begin_include
include|#
directive|include
file|"../h/cpu.h"
end_include

begin_comment
comment|/*  * Startup code for standalone system  * Non-relocating version -- for programs which are loaded by boot  */
end_comment

begin_expr_stmt
operator|.
name|globl
name|_end
operator|.
name|globl
name|_edata
operator|.
name|globl
name|_main
operator|.
name|globl
name|__rtt
operator|.
name|globl
name|_configure
operator|.
name|globl
name|_cpu
operator|.
name|globl
name|_openfirst
operator|.
name|set
name|HIGH
operator|,
literal|31
operator|#
name|mask
end_expr_stmt

begin_for
for|for total disable  entry:	.globl	entry 	.word	0x0 	mtpr	$HIGH
operator|,
name|$IPL
operator|#
name|just
name|in
end_for

begin_case
case|case
ifdef|#
directive|ifdef
name|REL
name|movl
name|$RELOC
operator|,
name|sp
else|#
directive|else
name|movl
name|$RELOC
operator|-
literal|0x2400
operator|,
name|sp
endif|#
directive|endif
name|start
case|:
end_case

begin_decl_stmt
name|movl
name|aedata
decl_stmt|,
name|r0
name|clr
range|:
name|clrl
argument_list|(
name|r0
argument_list|)
operator|+
name|cmpl
name|r0
decl_stmt|,
name|sp
name|jlss
name|clr
ifdef|#
directive|ifdef
name|REL
name|movc3
name|aend
decl_stmt|,
modifier|*
name|$0
decl_stmt|,
argument_list|(
name|sp
argument_list|)
name|jmp
modifier|*
name|abegin
name|begin
range|:
endif|#
directive|endif
name|mtpr
name|$0
decl_stmt|,
name|$SCBB
name|calls
name|$0
decl_stmt|,
name|_configure
name|movl
name|$1
decl_stmt|,
name|_openfirst
name|calls
name|$0
decl_stmt|,
name|_main
ifndef|#
directive|ifndef
name|TP
name|jmp
name|start
else|#
directive|else
name|ret
endif|#
directive|endif
operator|.
name|data
ifdef|#
directive|ifdef
name|REL
name|abegin
range|:
operator|.
name|long
name|begin
name|aend
operator|:
operator|.
name|long
name|_end
operator|-
name|RELOC
name|aedata
operator|:
operator|.
name|long
name|_edata
operator|-
name|RELOC
else|#
directive|else
name|aedata
operator|:
operator|.
name|long
name|_edata
endif|#
directive|endif
name|__rtt
operator|:
operator|.
name|word
literal|0x0
name|jmp
name|start
operator|.
name|globl
name|_badloc
name|_badloc
operator|:
operator|.
name|word
literal|0
name|movl
name|$1
decl_stmt|,
name|r0
name|movl
decl|4
argument_list|(
name|ap
argument_list|)
decl_stmt|,
name|r3
name|movl
name|$4
decl_stmt|,
name|r2
name|movab
decl|9f
decl_stmt|,
argument_list|(
name|r2
argument_list|)
name|tstl
argument_list|(
name|r3
argument_list|)
decl|1
range|:
name|clrl
name|r0
operator|#
name|made
name|it
name|w
operator|/
name|o
name|machine
name|checks
literal|2
operator|:
name|movl
name|$4
decl_stmt|,
name|r2
name|clrl
argument_list|(
name|r2
argument_list|)
name|ret
operator|.
name|align
decl|2 9
range|:
name|casel
name|_cpu
decl_stmt|,
name|$1
decl_stmt|,
name|$VAX_MAX
decl|0
range|:
operator|.
name|word
literal|8f
operator|-
literal|0b
operator|#
literal|1
name|is
literal|780
operator|.
name|word
literal|5f
operator|-
literal|0b
operator|#
literal|2
name|is
literal|750
operator|.
name|word
literal|5f
operator|-
literal|0b
operator|#
literal|3
name|is
literal|730
literal|5
operator|:
name|mtpr
name|$0xf
decl_stmt|,
name|$MCESR
name|brb
decl|1f 8
range|:
name|mtpr
name|$0
decl_stmt|,
name|$SBIFS
decl|1
range|:
name|addl2
argument_list|(
name|sp
argument_list|)
operator|+
decl_stmt|,
name|sp
decl|#
name|discard
name|mchchk
name|trash
name|movab
decl|2b
decl_stmt|,
argument_list|(
name|sp
argument_list|)
name|rei
end_decl_stmt

end_unit

