begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*********************************************************** 		Copyright IBM Corporation 1987                        All Rights Reserved  Permission to use, copy, modify, and distribute this software and its  documentation for any purpose and without fee is hereby granted,  provided that the above copyright notice appear in all copies and that both that copyright notice and this permission notice appear in  supporting documentation, and that the name of IBM not be used in advertising or publicity pertaining to distribution of the software without specific, written prior permission.    IBM DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, IN NO EVENT SHALL IBM BE LIABLE FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.  ******************************************************************/
end_comment

begin_comment
comment|/*  * ARGO Project, Computer Sciences Dept., University of Wisconsin - Madison  */
end_comment

begin_comment
comment|/* $Header: clnp_debug.c,v 4.2 88/06/29 14:58:34 hagens Exp $ */
end_comment

begin_comment
comment|/* $Source: /usr/argo/sys/netargo/RCS/clnp_debug.c,v $ */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
modifier|*
name|rcsid
init|=
literal|"$Header: clnp_debug.c,v 4.2 88/06/29 14:58:34 hagens Exp $"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
endif|lint
end_endif

begin_include
include|#
directive|include
file|"../h/types.h"
end_include

begin_include
include|#
directive|include
file|"../h/param.h"
end_include

begin_include
include|#
directive|include
file|"../h/mbuf.h"
end_include

begin_include
include|#
directive|include
file|"../h/domain.h"
end_include

begin_include
include|#
directive|include
file|"../h/protosw.h"
end_include

begin_include
include|#
directive|include
file|"../h/socket.h"
end_include

begin_include
include|#
directive|include
file|"../h/socketvar.h"
end_include

begin_include
include|#
directive|include
file|"../h/errno.h"
end_include

begin_include
include|#
directive|include
file|"../net/if.h"
end_include

begin_include
include|#
directive|include
file|"../net/route.h"
end_include

begin_include
include|#
directive|include
file|"../netiso/iso.h"
end_include

begin_include
include|#
directive|include
file|"../netiso/clnp.h"
end_include

begin_include
include|#
directive|include
file|"../netiso/clnp_stat.h"
end_include

begin_include
include|#
directive|include
file|"../netiso/argo_debug.h"
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|ARGO_DEBUG
end_ifdef

begin_ifdef
ifdef|#
directive|ifdef
name|TESTDEBUG
end_ifdef

begin_ifdef
ifdef|#
directive|ifdef
name|notdef
end_ifdef

begin_decl_stmt
name|struct
name|addr_37
name|u_37
init|=
block|{
block|{
literal|0x00
block|,
literal|0x02
block|,
literal|0x00
block|,
literal|0x10
block|,
literal|0x20
block|,
literal|0x30
block|,
literal|0x35
block|}
block|,
block|{
literal|0x01
block|,
literal|0x02
block|,
literal|0x03
block|,
literal|0x04
block|,
literal|0x50
block|,
literal|0x60
block|,
literal|0x70
block|,
literal|0x80
block|,
literal|0x90
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|addr_osinet
name|u_osinet
init|=
block|{
block|{
literal|0x00
block|,
literal|0x04
block|}
block|,
block|{
literal|0x00
block|,
literal|0x02
block|,
literal|0x00
block|,
literal|0x01
block|,
literal|0x23
block|,
literal|0x42
block|,
literal|0x78
block|,
literal|0x20
block|,
literal|0x01
block|,
literal|0x05
block|,
literal|0x00
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
endif|notdef
end_endif

begin_decl_stmt
name|struct
name|addr_rfc986
name|u_rfc986
init|=
block|{
block|{
literal|0x00
block|,
literal|0x06
block|}
block|,
block|{
literal|0x01
block|,
literal|0xc0
block|,
literal|0x0c
block|,
literal|0x0c
block|,
literal|0xab
block|,
literal|0x11
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|addr_rfc986
name|u_bad
init|=
block|{
block|{
literal|0x00
block|,
literal|0x01
block|}
block|,
block|{
literal|0x01
block|,
literal|0xc0
block|,
literal|0x0c
block|,
literal|0x0c
block|,
literal|0xab
block|,
literal|0x11
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_function
name|main
parameter_list|()
block|{
name|struct
name|iso_addr
name|a
decl_stmt|;
name|a
operator|.
name|isoa_afi
operator|=
name|AFI_37
expr_stmt|;
name|a
operator|.
name|isoa_u
operator|.
name|addr_37
operator|=
name|u_37
expr_stmt|;
name|a
operator|.
name|isoa_len
operator|=
literal|17
expr_stmt|;
name|printf
argument_list|(
literal|"type 37: %s\n"
argument_list|,
name|clnp_iso_addrp
argument_list|(
operator|&
name|a
argument_list|)
argument_list|)
expr_stmt|;
name|a
operator|.
name|isoa_afi
operator|=
name|AFI_OSINET
expr_stmt|;
name|a
operator|.
name|isoa_u
operator|.
name|addr_osinet
operator|=
name|u_osinet
expr_stmt|;
name|a
operator|.
name|isoa_len
operator|=
literal|14
expr_stmt|;
name|printf
argument_list|(
literal|"type osinet: %s\n"
argument_list|,
name|clnp_iso_addrp
argument_list|(
operator|&
name|a
argument_list|)
argument_list|)
expr_stmt|;
name|a
operator|.
name|isoa_afi
operator|=
name|AFI_RFC986
expr_stmt|;
name|a
operator|.
name|isoa_u
operator|.
name|addr_rfc986
operator|=
name|u_rfc986
expr_stmt|;
name|a
operator|.
name|isoa_len
operator|=
literal|9
expr_stmt|;
name|printf
argument_list|(
literal|"type rfc986: %s\n"
argument_list|,
name|clnp_iso_addrp
argument_list|(
operator|&
name|a
argument_list|)
argument_list|)
expr_stmt|;
name|a
operator|.
name|isoa_afi
operator|=
literal|12
expr_stmt|;
name|a
operator|.
name|isoa_u
operator|.
name|addr_rfc986
operator|=
name|u_rfc986
expr_stmt|;
name|a
operator|.
name|isoa_len
operator|=
literal|9
expr_stmt|;
name|printf
argument_list|(
literal|"type bad afi: %s\n"
argument_list|,
name|clnp_iso_addrp
argument_list|(
operator|&
name|a
argument_list|)
argument_list|)
expr_stmt|;
name|a
operator|.
name|isoa_afi
operator|=
name|AFI_RFC986
expr_stmt|;
name|a
operator|.
name|isoa_u
operator|.
name|addr_rfc986
operator|=
name|u_bad
expr_stmt|;
name|a
operator|.
name|isoa_len
operator|=
literal|9
expr_stmt|;
name|printf
argument_list|(
literal|"type bad idi: %s\n"
argument_list|,
name|clnp_iso_addrp
argument_list|(
operator|&
name|a
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_endif
endif|#
directive|endif
endif|TESTDEBUG
end_endif

begin_decl_stmt
name|unsigned
name|int
name|clnp_debug
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|char
name|letters
index|[]
init|=
literal|"0123456789abcdef"
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  *	Print buffer in hex, return addr of where we left off.  *	Do not null terminate.  */
end_comment

begin_function
name|char
modifier|*
name|clnp_hexp
parameter_list|(
name|src
parameter_list|,
name|len
parameter_list|,
name|where
parameter_list|)
name|char
modifier|*
name|src
decl_stmt|;
comment|/* src of data to print */
name|int
name|len
decl_stmt|;
comment|/* lengthof src */
name|char
modifier|*
name|where
decl_stmt|;
comment|/* where to put data */
block|{
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
name|i
operator|++
control|)
block|{
operator|*
name|where
operator|++
operator|=
name|letters
index|[
name|src
index|[
name|i
index|]
operator|>>
literal|4
index|]
expr_stmt|;
operator|*
name|where
operator|++
operator|=
name|letters
index|[
name|src
index|[
name|i
index|]
operator|&
literal|0x0f
index|]
expr_stmt|;
block|}
return|return
name|where
return|;
block|}
end_function

begin_comment
comment|/*  *	Return a ptr to a human readable form of an iso addr   */
end_comment

begin_decl_stmt
specifier|static
name|char
name|iso_addr_b
index|[
literal|50
index|]
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|DELIM
value|'.';
end_define

begin_function
name|char
modifier|*
name|clnp_iso_addrp
parameter_list|(
name|isoa
parameter_list|)
name|struct
name|iso_addr
modifier|*
name|isoa
decl_stmt|;
block|{
name|char
modifier|*
name|cp
decl_stmt|;
comment|/* print length */
name|clnp_sprintf
argument_list|(
name|iso_addr_b
argument_list|,
literal|"[%d] "
argument_list|,
name|isoa
operator|->
name|isoa_len
argument_list|)
expr_stmt|;
comment|/* set cp to end of what we have */
name|cp
operator|=
name|iso_addr_b
expr_stmt|;
while|while
condition|(
operator|*
name|cp
condition|)
name|cp
operator|++
expr_stmt|;
comment|/* print afi */
name|cp
operator|=
name|clnp_hexp
argument_list|(
operator|&
name|isoa
operator|->
name|isoa_afi
argument_list|,
literal|1
argument_list|,
name|cp
argument_list|)
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
name|DELIM
expr_stmt|;
comment|/* print type specific part */
switch|switch
condition|(
name|isoa
operator|->
name|isoa_afi
condition|)
block|{
case|case
name|AFI_37
case|:
name|cp
operator|=
name|clnp_hexp
argument_list|(
name|isoa
operator|->
name|t37_idi
argument_list|,
name|ADDR37_IDI_LEN
argument_list|,
name|cp
argument_list|)
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
name|DELIM
expr_stmt|;
name|cp
operator|=
name|clnp_hexp
argument_list|(
name|isoa
operator|->
name|t37_dsp
argument_list|,
name|ADDR37_DSP_LEN
argument_list|,
name|cp
argument_list|)
expr_stmt|;
break|break;
comment|/* 		case AFI_OSINET:*/
case|case
name|AFI_RFC986
case|:
block|{
name|u_short
name|idi
decl_stmt|;
comment|/* osinet and rfc986 have idi in the same place */
comment|/* print idi */
name|cp
operator|=
name|clnp_hexp
argument_list|(
name|isoa
operator|->
name|rfc986_idi
argument_list|,
name|ADDROSINET_IDI_LEN
argument_list|,
name|cp
argument_list|)
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
name|DELIM
expr_stmt|;
name|CTOH
argument_list|(
name|isoa
operator|->
name|rfc986_idi
index|[
literal|0
index|]
argument_list|,
name|isoa
operator|->
name|rfc986_idi
index|[
literal|1
index|]
argument_list|,
name|idi
argument_list|)
expr_stmt|;
if|if
condition|(
name|idi
operator|==
name|IDI_OSINET
condition|)
block|{
name|struct
name|ovl_osinet
modifier|*
name|oosi
init|=
operator|(
expr|struct
name|ovl_osinet
operator|*
operator|)
name|isoa
decl_stmt|;
name|cp
operator|=
name|clnp_hexp
argument_list|(
name|oosi
operator|->
name|oosi_orgid
argument_list|,
name|OVLOSINET_ORGID_LEN
argument_list|,
name|cp
argument_list|)
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
name|DELIM
expr_stmt|;
name|cp
operator|=
name|clnp_hexp
argument_list|(
name|oosi
operator|->
name|oosi_snetid
argument_list|,
name|OVLOSINET_SNETID_LEN
argument_list|,
name|cp
argument_list|)
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
name|DELIM
expr_stmt|;
name|cp
operator|=
name|clnp_hexp
argument_list|(
name|oosi
operator|->
name|oosi_snpa
argument_list|,
name|OVLOSINET_SNPA_LEN
argument_list|,
name|cp
argument_list|)
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
name|DELIM
expr_stmt|;
name|cp
operator|=
name|clnp_hexp
argument_list|(
name|oosi
operator|->
name|oosi_nsap
argument_list|,
name|OVLOSINET_NSAP_LEN
argument_list|,
name|cp
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|idi
operator|==
name|IDI_RFC986
condition|)
block|{
name|struct
name|ovl_rfc986
modifier|*
name|o986
init|=
operator|(
expr|struct
name|ovl_rfc986
operator|*
operator|)
name|isoa
decl_stmt|;
name|cp
operator|=
name|clnp_hexp
argument_list|(
operator|&
name|o986
operator|->
name|o986_vers
argument_list|,
literal|1
argument_list|,
name|cp
argument_list|)
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
name|DELIM
expr_stmt|;
ifdef|#
directive|ifdef
name|vax
name|clnp_sprintf
argument_list|(
name|cp
argument_list|,
literal|"%d.%d.%d.%d.%d"
argument_list|,
name|o986
operator|->
name|o986_inetaddr
index|[
literal|0
index|]
operator|&
literal|0xff
argument_list|,
name|o986
operator|->
name|o986_inetaddr
index|[
literal|1
index|]
operator|&
literal|0xff
argument_list|,
name|o986
operator|->
name|o986_inetaddr
index|[
literal|2
index|]
operator|&
literal|0xff
argument_list|,
name|o986
operator|->
name|o986_inetaddr
index|[
literal|3
index|]
operator|&
literal|0xff
argument_list|,
name|o986
operator|->
name|o986_upid
operator|&
literal|0xff
argument_list|)
expr_stmt|;
return|return
operator|(
name|iso_addr_b
operator|)
return|;
else|#
directive|else
name|cp
operator|=
name|clnp_hexp
argument_list|(
operator|&
name|o986
operator|->
name|o986_inetaddr
index|[
literal|0
index|]
argument_list|,
literal|1
argument_list|,
name|cp
argument_list|)
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
name|DELIM
expr_stmt|;
name|cp
operator|=
name|clnp_hexp
argument_list|(
operator|&
name|o986
operator|->
name|o986_inetaddr
index|[
literal|1
index|]
argument_list|,
literal|1
argument_list|,
name|cp
argument_list|)
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
name|DELIM
expr_stmt|;
name|cp
operator|=
name|clnp_hexp
argument_list|(
operator|&
name|o986
operator|->
name|o986_inetaddr
index|[
literal|2
index|]
argument_list|,
literal|1
argument_list|,
name|cp
argument_list|)
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
name|DELIM
expr_stmt|;
name|cp
operator|=
name|clnp_hexp
argument_list|(
operator|&
name|o986
operator|->
name|o986_inetaddr
index|[
literal|3
index|]
argument_list|,
literal|1
argument_list|,
name|cp
argument_list|)
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
name|DELIM
expr_stmt|;
name|cp
operator|=
name|clnp_hexp
argument_list|(
operator|&
name|o986
operator|->
name|o986_upid
argument_list|,
literal|1
argument_list|,
name|cp
argument_list|)
expr_stmt|;
endif|#
directive|endif
endif|vax
block|}
block|}
break|break;
default|default:
operator|*
name|cp
operator|++
operator|=
literal|'?'
expr_stmt|;
break|break;
block|}
operator|*
name|cp
operator|=
operator|(
name|char
operator|)
literal|0
expr_stmt|;
return|return
operator|(
name|iso_addr_b
operator|)
return|;
block|}
end_function

begin_define
define|#
directive|define
name|MAX_COLUMNS
value|8
end_define

begin_comment
comment|/*  *	Dump the buffer to the screen in a readable format. Format is:  *  *		hex/dec  where hex is the hex format, dec is the decimal format.  *		columns of hex/dec numbers will be printed, followed by the  *		character representations (if printable).  */
end_comment

begin_macro
name|dump_buf
argument_list|(
argument|buf
argument_list|,
argument|len
argument_list|)
end_macro

begin_decl_stmt
name|char
modifier|*
name|buf
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|len
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
name|printf
argument_list|(
literal|"Dump buf 0x%x len 0x%x\n"
argument_list|,
name|buf
argument_list|,
name|len
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
name|i
operator|+=
name|MAX_COLUMNS
control|)
block|{
name|printf
argument_list|(
literal|"+%d:\t"
argument_list|,
name|i
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|MAX_COLUMNS
condition|;
name|j
operator|++
control|)
block|{
if|if
condition|(
name|i
operator|+
name|j
operator|<
name|len
condition|)
block|{
name|printf
argument_list|(
literal|"%x/%d\t"
argument_list|,
name|buf
index|[
name|i
operator|+
name|j
index|]
operator|&
literal|0xff
argument_list|,
name|buf
index|[
name|i
operator|+
name|j
index|]
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|printf
argument_list|(
literal|"	"
argument_list|)
expr_stmt|;
block|}
block|}
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|MAX_COLUMNS
condition|;
name|j
operator|++
control|)
block|{
if|if
condition|(
name|i
operator|+
name|j
operator|<
name|len
condition|)
block|{
if|if
condition|(
operator|(
operator|(
name|buf
index|[
name|i
operator|+
name|j
index|]
operator|)
operator|>
literal|31
operator|)
operator|&&
operator|(
operator|(
name|buf
index|[
name|i
operator|+
name|j
index|]
operator|)
operator|<
literal|128
operator|)
condition|)
name|printf
argument_list|(
literal|"%c"
argument_list|,
name|buf
index|[
name|i
operator|+
name|j
index|]
operator|&
literal|0xff
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"."
argument_list|)
expr_stmt|;
block|}
block|}
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
end_block

begin_comment
comment|/*  *		The following hacks are a trimmed down version of sprintf.  */
end_comment

begin_comment
comment|/*VARARGS1*/
end_comment

begin_expr_stmt
name|clnp_sprintf
argument_list|(
name|buf
argument_list|,
name|fmt
argument_list|,
name|x1
argument_list|,
name|x2
argument_list|)
specifier|register
name|char
operator|*
name|fmt
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|unsigned
name|x1
decl_stmt|,
name|x2
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|clnp_prf
argument_list|(
name|buf
argument_list|,
name|fmt
argument_list|,
operator|&
name|x1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_block

begin_expr_stmt
name|clnp_prf
argument_list|(
name|buf
argument_list|,
name|fmt
argument_list|,
name|adx
argument_list|,
name|dummy
argument_list|)
specifier|register
name|char
operator|*
name|buf
expr_stmt|;
end_expr_stmt

begin_decl_stmt
specifier|register
name|char
modifier|*
name|fmt
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|register
name|unsigned
name|int
modifier|*
name|adx
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|dummy
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|int
name|b
decl_stmt|,
name|c
decl_stmt|,
name|i
decl_stmt|;
name|char
modifier|*
name|s
decl_stmt|;
name|char
modifier|*
name|clnp_printn
parameter_list|()
function_decl|;
name|loop
label|:
while|while
condition|(
operator|(
name|c
operator|=
operator|*
name|fmt
operator|++
operator|)
operator|!=
literal|'%'
condition|)
block|{
if|if
condition|(
name|c
operator|==
literal|'\0'
condition|)
block|{
operator|*
name|buf
operator|++
operator|=
operator|(
name|char
operator|)
literal|0
expr_stmt|;
return|return;
block|}
operator|*
name|buf
operator|++
operator|=
name|c
expr_stmt|;
block|}
name|again
label|:
name|c
operator|=
operator|*
name|fmt
operator|++
expr_stmt|;
switch|switch
condition|(
name|c
condition|)
block|{
case|case
literal|'l'
case|:
goto|goto
name|again
goto|;
case|case
literal|'x'
case|:
case|case
literal|'X'
case|:
name|b
operator|=
literal|16
expr_stmt|;
goto|goto
name|number
goto|;
case|case
literal|'d'
case|:
case|case
literal|'D'
case|:
case|case
literal|'u'
case|:
comment|/* what a joke */
name|b
operator|=
literal|10
expr_stmt|;
goto|goto
name|number
goto|;
case|case
literal|'o'
case|:
case|case
literal|'O'
case|:
name|b
operator|=
literal|8
expr_stmt|;
name|number
label|:
name|buf
operator|=
name|clnp_printn
argument_list|(
operator|(
name|unsigned
name|long
operator|)
operator|*
name|adx
argument_list|,
name|b
argument_list|,
name|buf
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'c'
case|:
name|b
operator|=
operator|*
name|adx
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|24
init|;
name|i
operator|>=
literal|0
condition|;
name|i
operator|-=
literal|8
control|)
if|if
condition|(
name|c
operator|=
operator|(
name|b
operator|>>
name|i
operator|)
operator|&
literal|0x7f
condition|)
operator|*
name|buf
operator|++
operator|=
name|c
expr_stmt|;
break|break;
case|case
literal|'s'
case|:
name|s
operator|=
operator|(
name|char
operator|*
operator|)
operator|*
name|adx
expr_stmt|;
while|while
condition|(
operator|*
name|s
condition|)
operator|*
name|buf
operator|++
operator|=
operator|*
name|s
operator|++
expr_stmt|;
break|break;
case|case
literal|'%'
case|:
operator|*
name|buf
operator|++
operator|=
literal|'%'
expr_stmt|;
break|break;
block|}
name|adx
operator|++
expr_stmt|;
goto|goto
name|loop
goto|;
block|}
end_block

begin_function
name|char
modifier|*
name|clnp_printn
parameter_list|(
name|n
parameter_list|,
name|b
parameter_list|,
name|where
parameter_list|)
name|unsigned
name|long
name|n
decl_stmt|;
name|int
name|b
decl_stmt|;
name|char
modifier|*
name|where
decl_stmt|;
block|{
name|char
name|prbuf
index|[
literal|11
index|]
decl_stmt|;
specifier|register
name|char
modifier|*
name|cp
decl_stmt|;
if|if
condition|(
name|b
operator|==
literal|10
operator|&&
operator|(
name|int
operator|)
name|n
operator|<
literal|0
condition|)
block|{
operator|*
name|where
operator|++
operator|=
literal|'-'
expr_stmt|;
name|n
operator|=
call|(
name|unsigned
call|)
argument_list|(
operator|-
operator|(
name|int
operator|)
name|n
argument_list|)
expr_stmt|;
block|}
name|cp
operator|=
name|prbuf
expr_stmt|;
do|do
block|{
operator|*
name|cp
operator|++
operator|=
literal|"0123456789abcdef"
index|[
name|n
operator|%
name|b
index|]
expr_stmt|;
name|n
operator|/=
name|b
expr_stmt|;
block|}
do|while
condition|(
name|n
condition|)
do|;
do|do
block|{
operator|*
name|where
operator|++
operator|=
operator|*
operator|--
name|cp
expr_stmt|;
block|}
do|while
condition|(
name|cp
operator|>
name|prbuf
condition|)
do|;
return|return
operator|(
name|where
operator|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
endif|ARGO_DEBUG
end_endif

end_unit

