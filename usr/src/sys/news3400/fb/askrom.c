begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (c) 1992 The Regents of the University of California.  * All rights reserved.  *  * This code is derived from software contributed to Berkeley by  * Sony Corp. and Kazumasa Utashiro of Software Research Associates, Inc.  *  * %sccs.include.redist.c%  *  * from: $Hdr: askrom.c,v 4.300 91/06/09 06:32:39 root Rel41 $ SONY  *  *	@(#)askrom.c	7.3 (Berkeley) %G%  */
end_comment

begin_include
include|#
directive|include
file|"nwb514.h"
end_include

begin_include
include|#
directive|include
file|"nwb251.h"
end_include

begin_include
include|#
directive|include
file|"nwb256.h"
end_include

begin_if
if|#
directive|if
name|NNWB514
operator|>
literal|0
operator|||
name|NNWB251
operator|>
literal|0
operator|||
name|NNWB256
operator|>
literal|0
end_if

begin_ifdef
ifdef|#
directive|ifdef
name|IPC_MRX
end_ifdef

begin_include
include|#
directive|include
file|"../../h/param.h"
end_include

begin_include
include|#
directive|include
file|"../../iop/framebuf.h"
end_include

begin_include
include|#
directive|include
file|"../../iop/fbreg.h"
end_include

begin_else
else|#
directive|else
end_else

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<news3400/iop/framebuf.h>
end_include

begin_include
include|#
directive|include
file|<news3400/iop/fbreg.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|<news3400/fb/fbdefs.h>
end_include

begin_include
include|#
directive|include
file|<news3400/fb/qpdm.h>
end_include

begin_decl_stmt
specifier|extern
name|short
name|zero
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|char
modifier|*
name|ext_fnt_addr
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|char
modifier|*
name|ext_fnt24_addr
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|krom_enable
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_function
name|caddr_t
name|autos_Krom_addr
parameter_list|(
name|fb
parameter_list|,
name|c
parameter_list|,
name|sr
parameter_list|)
name|struct
name|fbdev
modifier|*
name|fb
decl_stmt|;
specifier|register
name|int
name|c
decl_stmt|;
name|lRectangle
modifier|*
name|sr
decl_stmt|;
block|{
name|unsigned
name|int
name|cvcode24
parameter_list|()
function_decl|;
if|if
condition|(
operator|(
name|c
operator|>=
literal|0x20
operator|)
operator|&&
operator|(
name|c
operator|<=
literal|0x7e
operator|)
condition|)
block|{
comment|/* 		 * ASCII char 		 */
name|c
operator|-=
literal|' '
expr_stmt|;
name|c
operator|=
operator|(
operator|(
name|c
operator|&
literal|0x1f
operator|)
operator||
operator|(
operator|(
name|c
operator|&
literal|0xe0
operator|)
operator|<<
literal|2
operator|)
operator|)
operator|<<
literal|7
expr_stmt|;
return|return
operator|(
call|(
name|caddr_t
call|)
argument_list|(
name|c
operator|+
name|QP_KJROM
operator|+
operator|(
name|sr
operator|->
name|extent
operator|.
name|y
operator|>
literal|16
condition|?
literal|0
else|:
literal|96
operator|)
argument_list|)
operator|)
return|;
block|}
elseif|else
if|if
condition|(
operator|(
name|c
operator|>=
literal|0xa1
operator|)
operator|&&
operator|(
name|c
operator|<=
literal|0xdf
operator|)
condition|)
block|{
comment|/* 		 * KANA char 		 */
if|if
condition|(
name|sr
operator|->
name|extent
operator|.
name|y
operator|>
literal|16
condition|)
return|return
operator|(
operator|(
name|caddr_t
operator|)
name|ext_fnt24_addr
index|[
name|c
operator|+
literal|64
index|]
operator|)
return|;
else|else
return|return
operator|(
operator|(
name|caddr_t
operator|)
name|ext_fnt_addr
index|[
name|c
operator|+
literal|64
index|]
operator|)
return|;
block|}
elseif|else
if|if
condition|(
operator|(
name|c
operator|>=
literal|0x2000
operator|)
operator|&&
operator|(
name|c
operator|<=
literal|0x7fff
operator|)
condition|)
block|{
comment|/* 		 * KANJI char 		 */
switch|switch
condition|(
name|c
operator|&
literal|0x7000
condition|)
block|{
case|case
literal|0x2000
case|:
name|c
operator|=
operator|(
operator|(
name|c
operator|&
literal|0x1f
operator|)
operator||
operator|(
operator|(
name|c
operator|&
literal|0x60
operator|)
operator|<<
literal|5
operator|)
operator||
operator|(
operator|(
name|c
operator|&
literal|0x700
operator|)
operator|>>
literal|1
operator|)
operator|)
operator|<<
literal|7
expr_stmt|;
break|break;
case|case
literal|0x3000
case|:
case|case
literal|0x4000
case|:
name|c
operator|=
operator|(
operator|(
name|c
operator|&
literal|0x7f
operator|)
operator||
operator|(
operator|(
name|c
operator|&
literal|0xf00
operator|)
operator|>>
literal|1
operator|)
operator||
operator|(
operator|(
name|c
operator|&
literal|0x4000
operator|)
operator|>>
literal|3
operator|)
operator|)
operator|<<
literal|7
expr_stmt|;
break|break;
case|case
literal|0x5000
case|:
case|case
literal|0x6000
case|:
name|c
operator|=
operator|(
operator|(
name|c
operator|&
literal|0x7f
operator|)
operator||
operator|(
operator|(
name|c
operator|&
literal|0xf00
operator|)
operator|>>
literal|1
operator|)
operator||
operator|(
operator|(
name|c
operator|&
literal|0x2000
operator|)
operator|>>
literal|2
operator|)
operator||
literal|0x1000
operator|)
operator|<<
literal|7
expr_stmt|;
break|break;
case|case
literal|0x7000
case|:
name|c
operator|=
operator|(
operator|(
name|c
operator|&
literal|0x1f
operator|)
operator||
operator|(
operator|(
name|c
operator|&
literal|0x60
operator|)
operator|<<
literal|5
operator|)
operator||
operator|(
operator|(
name|c
operator|&
literal|0x700
operator|)
operator|>>
literal|1
operator|)
operator||
literal|0x1000
operator|)
operator|<<
literal|7
expr_stmt|;
break|break;
block|}
return|return
operator|(
call|(
name|caddr_t
call|)
argument_list|(
name|c
operator|+
name|QP_KJROM
operator|+
operator|(
name|sr
operator|->
name|extent
operator|.
name|y
operator|>
literal|16
condition|?
literal|0
else|:
literal|96
operator|)
argument_list|)
operator|)
return|;
block|}
else|else
block|{
comment|/* 		 * UNKNOWN char 		 */
return|return
operator|(
operator|(
name|caddr_t
operator|)
name|zero
operator|)
return|;
block|}
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* NNWB514> 0 || NNWB251> 0 || NNWB256> 0 */
end_comment

end_unit

