begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  */
end_comment

begin_include
include|#
directive|include
file|"X.h"
end_include

begin_define
define|#
directive|define
name|NEED_EVENTS
end_define

begin_include
include|#
directive|include
file|"Xproto.h"
end_include

begin_include
include|#
directive|include
file|"scrnintstr.h"
end_include

begin_include
include|#
directive|include
file|"cursorstr.h"
end_include

begin_include
include|#
directive|include
file|"pixmapstr.h"
end_include

begin_include
include|#
directive|include
file|"inputstr.h"
end_include

begin_include
include|#
directive|include
file|"regionstr.h"
end_include

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|"hppriv.h"
end_include

begin_include
include|#
directive|include
file|"hyperion.h"
end_include

begin_include
include|#
directive|include
file|"../mfb/mfb.h"
end_include

begin_include
include|#
directive|include
file|"../mfb/maskbits.h"
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|FASTGETBITS
end_ifdef

begin_define
define|#
directive|define
name|getunalignedword
parameter_list|(
name|psrc
parameter_list|,
name|x
parameter_list|,
name|dst
parameter_list|)
value|{ \         register int _tmp; \         FASTGETBITS(psrc, x, 32, _tmp); \         dst = _tmp; \ }
end_define

begin_else
else|#
directive|else
end_else

begin_define
define|#
directive|define
name|getunalignedword
parameter_list|(
name|psrc
parameter_list|,
name|x
parameter_list|,
name|dst
parameter_list|)
define|\
value|{ \     dst = (SCRLEFT((unsigned) *(psrc), (x))) | \           (SCRRIGHT((unsigned) *((psrc)+1), 32-(x))); \ }
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* FASTGETBITS */
end_comment

begin_include
include|#
directive|include
file|"../mfb/fastblt.h"
end_include

begin_function
name|void
name|hyperMoveBits
parameter_list|(
name|pScreen
parameter_list|,
name|planeMask
parameter_list|,
name|alu
parameter_list|,
name|sourceX
parameter_list|,
name|sourceY
parameter_list|,
name|destX
parameter_list|,
name|destY
parameter_list|,
name|w
parameter_list|,
name|h
parameter_list|)
name|ScreenPtr
name|pScreen
decl_stmt|;
name|u_char
name|planeMask
decl_stmt|;
name|int
name|alu
decl_stmt|,
name|sourceX
decl_stmt|,
name|sourceY
decl_stmt|,
name|destX
decl_stmt|,
name|destY
decl_stmt|,
name|w
decl_stmt|,
name|h
decl_stmt|;
block|{
name|unsigned
name|int
modifier|*
name|pBase
decl_stmt|;
comment|/* start of src and dst bitmaps */
name|int
name|width
decl_stmt|;
comment|/* add to get to same position in next line */
name|unsigned
name|int
modifier|*
name|psrcLine
decl_stmt|,
modifier|*
name|pdstLine
decl_stmt|;
comment|/* pointers to line with current src and dst */
specifier|register
name|unsigned
name|int
modifier|*
name|psrc
decl_stmt|;
comment|/* pointer to current src longword */
specifier|register
name|unsigned
name|int
modifier|*
name|pdst
decl_stmt|;
comment|/* pointer to current dst longword */
comment|/* following used for looping through a line */
name|unsigned
name|int
name|startmask
decl_stmt|,
name|endmask
decl_stmt|;
comment|/* masks for writing ends of dst */
name|int
name|nlMiddle
decl_stmt|;
comment|/* whole longwords in dst */
specifier|register
name|int
name|nl
decl_stmt|;
comment|/* temp copy of nlMiddle */
specifier|register
name|unsigned
name|int
name|tmpSrc
decl_stmt|;
comment|/* place to store full source word */
specifier|register
name|int
name|xoffSrc
decl_stmt|;
comment|/* offset (>= 0,< 32) from which to 			           fetch whole longwords fetched  				   in src */
name|int
name|nstart
decl_stmt|;
comment|/* number of ragged bits at start of dst */
name|int
name|nend
decl_stmt|;
comment|/* number of ragged bits at end of dst */
name|int
name|srcStartOver
decl_stmt|;
comment|/* pulling nstart bits from src 				   overflows into the next word? */
if|if
condition|(
name|h
operator|==
literal|0
operator|||
name|w
operator|==
literal|0
condition|)
return|return;
name|pBase
operator|=
operator|(
name|unsigned
name|int
operator|*
operator|)
name|getPrivScreenPtr
argument_list|(
name|pScreen
argument_list|)
operator|->
name|bits
expr_stmt|;
name|width
operator|=
name|getPrivScreenPtr
argument_list|(
name|pScreen
argument_list|)
operator|->
name|memWidth
operator|>>
literal|5
expr_stmt|;
if|if
condition|(
name|sourceY
operator|<
name|destY
condition|)
comment|/* start at last scanline of rectangle */
block|{
name|psrcLine
operator|=
name|pBase
operator|+
operator|(
operator|(
name|sourceY
operator|+
name|h
operator|-
literal|1
operator|)
operator|*
name|width
operator|)
expr_stmt|;
name|pdstLine
operator|=
name|pBase
operator|+
operator|(
operator|(
name|destY
operator|+
name|h
operator|-
literal|1
operator|)
operator|*
name|width
operator|)
expr_stmt|;
name|width
operator|=
operator|-
name|width
expr_stmt|;
block|}
else|else
comment|/* start at first scanline */
block|{
name|psrcLine
operator|=
name|pBase
operator|+
operator|(
name|sourceY
operator|*
name|width
operator|)
expr_stmt|;
name|pdstLine
operator|=
name|pBase
operator|+
operator|(
name|destY
operator|*
name|width
operator|)
expr_stmt|;
block|}
comment|/* special case copy */
if|if
condition|(
name|alu
operator|==
name|GXcopy
condition|)
block|{
specifier|register
name|unsigned
name|int
name|bits
decl_stmt|;
specifier|register
name|unsigned
name|int
name|bits1
decl_stmt|;
name|int
name|xoffSrc
decl_stmt|,
name|xoffDst
decl_stmt|;
name|int
name|leftShift
decl_stmt|,
name|rightShift
decl_stmt|;
if|if
condition|(
operator|(
name|destX
operator|&
literal|0x1f
operator|)
operator|+
name|w
operator|<=
literal|32
condition|)
block|{
name|pdst
operator|=
name|pdstLine
operator|+
operator|(
name|destX
operator|>>
literal|5
operator|)
expr_stmt|;
name|psrc
operator|=
name|psrcLine
operator|+
operator|(
name|sourceX
operator|>>
literal|5
operator|)
expr_stmt|;
name|xoffSrc
operator|=
name|sourceX
operator|&
literal|0x1f
expr_stmt|;
name|xoffDst
operator|=
name|destX
operator|&
literal|0x1f
expr_stmt|;
while|while
condition|(
name|h
operator|--
condition|)
block|{
name|getandputbits
argument_list|(
name|psrc
argument_list|,
name|xoffSrc
argument_list|,
name|xoffDst
argument_list|,
name|w
argument_list|,
name|pdst
argument_list|)
expr_stmt|;
name|psrc
operator|+=
name|width
expr_stmt|;
name|pdst
operator|+=
name|width
expr_stmt|;
block|}
block|}
else|else
block|{
name|maskbits
argument_list|(
name|destX
argument_list|,
name|w
argument_list|,
name|startmask
argument_list|,
name|endmask
argument_list|,
name|nlMiddle
argument_list|)
expr_stmt|;
if|if
condition|(
name|sourceX
operator|>=
name|destX
condition|)
block|{
name|xoffSrc
operator|=
name|sourceX
operator|&
literal|0x1f
expr_stmt|;
name|xoffDst
operator|=
name|destX
operator|&
literal|0x1f
expr_stmt|;
name|pdstLine
operator|+=
operator|(
name|destX
operator|>>
literal|5
operator|)
expr_stmt|;
name|psrcLine
operator|+=
operator|(
name|sourceX
operator|>>
literal|5
operator|)
expr_stmt|;
if|if
condition|(
name|xoffSrc
operator|==
name|xoffDst
condition|)
block|{
while|while
condition|(
name|h
operator|--
condition|)
block|{
name|psrc
operator|=
name|psrcLine
expr_stmt|;
name|pdst
operator|=
name|pdstLine
expr_stmt|;
name|pdstLine
operator|+=
name|width
expr_stmt|;
name|psrcLine
operator|+=
name|width
expr_stmt|;
if|if
condition|(
name|startmask
condition|)
block|{
operator|*
name|pdst
operator|=
operator|(
operator|*
name|pdst
operator|&
operator|~
name|startmask
operator|)
operator||
operator|(
operator|*
name|psrc
operator|++
operator|&
name|startmask
operator|)
expr_stmt|;
name|pdst
operator|++
expr_stmt|;
block|}
name|nl
operator|=
name|nlMiddle
expr_stmt|;
name|DuffL
argument_list|(
argument|nl
argument_list|,
argument|label1
argument_list|,
argument|*pdst++ = *psrc++;
argument_list|)
if|if
condition|(
name|endmask
condition|)
operator|*
name|pdst
operator|=
operator|(
operator|*
name|pdst
operator|&
operator|~
name|endmask
operator|)
operator||
operator|(
operator|*
name|psrc
operator|++
operator|&
name|endmask
operator|)
expr_stmt|;
block|}
block|}
else|else
block|{
if|if
condition|(
name|xoffSrc
operator|>
name|xoffDst
condition|)
block|{
name|leftShift
operator|=
operator|(
name|xoffSrc
operator|-
name|xoffDst
operator|)
expr_stmt|;
name|rightShift
operator|=
literal|32
operator|-
name|leftShift
expr_stmt|;
block|}
else|else
block|{
name|rightShift
operator|=
operator|(
name|xoffDst
operator|-
name|xoffSrc
operator|)
expr_stmt|;
name|leftShift
operator|=
literal|32
operator|-
name|rightShift
expr_stmt|;
block|}
while|while
condition|(
name|h
operator|--
condition|)
block|{
name|psrc
operator|=
name|psrcLine
expr_stmt|;
name|pdst
operator|=
name|pdstLine
expr_stmt|;
name|pdstLine
operator|+=
name|width
expr_stmt|;
name|psrcLine
operator|+=
name|width
expr_stmt|;
name|bits
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|xoffSrc
operator|>
name|xoffDst
condition|)
name|bits
operator|=
operator|*
name|psrc
operator|++
expr_stmt|;
if|if
condition|(
name|startmask
condition|)
block|{
name|bits1
operator|=
name|SCRLEFT
argument_list|(
name|bits
argument_list|,
name|leftShift
argument_list|)
expr_stmt|;
name|bits
operator|=
operator|*
name|psrc
operator|++
expr_stmt|;
name|bits1
operator||=
name|SCRRIGHT
argument_list|(
name|bits
argument_list|,
name|rightShift
argument_list|)
expr_stmt|;
operator|*
name|pdst
operator|=
operator|(
operator|*
name|pdst
operator|&
operator|~
name|startmask
operator|)
operator||
operator|(
name|bits1
operator|&
name|startmask
operator|)
expr_stmt|;
name|pdst
operator|++
expr_stmt|;
block|}
name|nl
operator|=
name|nlMiddle
expr_stmt|;
name|DuffL
argument_list|(
argument|nl
argument_list|,
argument|label2
argument_list|,
argument|bits1 = BitLeft(bits, leftShift); 			       bits = *psrc++; 			       *pdst++ = bits1 | BitRight(bits, rightShift);
argument_list|)
if|if
condition|(
name|endmask
condition|)
block|{
name|bits1
operator|=
name|SCRLEFT
argument_list|(
name|bits
argument_list|,
name|leftShift
argument_list|)
expr_stmt|;
if|if
condition|(
name|SCRLEFT
argument_list|(
name|endmask
argument_list|,
name|rightShift
argument_list|)
condition|)
block|{
name|bits
operator|=
operator|*
name|psrc
operator|++
expr_stmt|;
name|bits1
operator||=
name|SCRRIGHT
argument_list|(
name|bits
argument_list|,
name|rightShift
argument_list|)
expr_stmt|;
block|}
operator|*
name|pdst
operator|=
operator|(
operator|*
name|pdst
operator|&
operator|~
name|endmask
operator|)
operator||
operator|(
name|bits1
operator|&
name|endmask
operator|)
expr_stmt|;
block|}
block|}
block|}
block|}
else|else
comment|/* walk source right to left */
block|{
name|xoffSrc
operator|=
operator|(
name|sourceX
operator|+
name|w
operator|-
literal|1
operator|)
operator|&
literal|0x1f
expr_stmt|;
name|xoffDst
operator|=
operator|(
name|destX
operator|+
name|w
operator|-
literal|1
operator|)
operator|&
literal|0x1f
expr_stmt|;
name|pdstLine
operator|+=
operator|(
operator|(
name|destX
operator|+
name|w
operator|-
literal|1
operator|)
operator|>>
literal|5
operator|)
operator|+
literal|1
expr_stmt|;
name|psrcLine
operator|+=
operator|(
operator|(
name|sourceX
operator|+
name|w
operator|-
literal|1
operator|)
operator|>>
literal|5
operator|)
operator|+
literal|1
expr_stmt|;
if|if
condition|(
name|xoffSrc
operator|==
name|xoffDst
condition|)
block|{
while|while
condition|(
name|h
operator|--
condition|)
block|{
name|psrc
operator|=
name|psrcLine
expr_stmt|;
name|pdst
operator|=
name|pdstLine
expr_stmt|;
name|pdstLine
operator|+=
name|width
expr_stmt|;
name|psrcLine
operator|+=
name|width
expr_stmt|;
if|if
condition|(
name|endmask
condition|)
block|{
name|pdst
operator|--
expr_stmt|;
operator|*
name|pdst
operator|=
operator|(
operator|*
name|pdst
operator|&
operator|~
name|endmask
operator|)
operator||
operator|(
operator|*
operator|--
name|psrc
operator|&
name|endmask
operator|)
expr_stmt|;
block|}
name|nl
operator|=
name|nlMiddle
expr_stmt|;
name|DuffL
argument_list|(
argument|nl
argument_list|,
argument|label3
argument_list|,
argument|*--pdst = *--psrc;
argument_list|)
if|if
condition|(
name|startmask
condition|)
block|{
operator|--
name|pdst
expr_stmt|;
operator|*
name|pdst
operator|=
operator|(
operator|*
name|pdst
operator|&
operator|~
name|startmask
operator|)
operator||
operator|(
operator|*
operator|--
name|psrc
operator|&
name|startmask
operator|)
expr_stmt|;
block|}
block|}
block|}
else|else
block|{
if|if
condition|(
name|xoffDst
operator|>
name|xoffSrc
condition|)
block|{
name|rightShift
operator|=
operator|(
name|xoffDst
operator|-
name|xoffSrc
operator|)
expr_stmt|;
name|leftShift
operator|=
literal|32
operator|-
name|rightShift
expr_stmt|;
block|}
else|else
block|{
name|leftShift
operator|=
operator|(
name|xoffSrc
operator|-
name|xoffDst
operator|)
expr_stmt|;
name|rightShift
operator|=
literal|32
operator|-
name|leftShift
expr_stmt|;
block|}
while|while
condition|(
name|h
operator|--
condition|)
block|{
name|psrc
operator|=
name|psrcLine
expr_stmt|;
name|pdst
operator|=
name|pdstLine
expr_stmt|;
name|pdstLine
operator|+=
name|width
expr_stmt|;
name|psrcLine
operator|+=
name|width
expr_stmt|;
name|bits
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|xoffDst
operator|>
name|xoffSrc
condition|)
name|bits
operator|=
operator|*
operator|--
name|psrc
expr_stmt|;
if|if
condition|(
name|endmask
condition|)
block|{
name|bits1
operator|=
name|SCRRIGHT
argument_list|(
name|bits
argument_list|,
name|rightShift
argument_list|)
expr_stmt|;
name|bits
operator|=
operator|*
operator|--
name|psrc
expr_stmt|;
name|bits1
operator||=
name|SCRLEFT
argument_list|(
name|bits
argument_list|,
name|leftShift
argument_list|)
expr_stmt|;
name|pdst
operator|--
expr_stmt|;
operator|*
name|pdst
operator|=
operator|(
operator|*
name|pdst
operator|&
operator|~
name|endmask
operator|)
operator||
operator|(
name|bits1
operator|&
name|endmask
operator|)
expr_stmt|;
block|}
name|nl
operator|=
name|nlMiddle
expr_stmt|;
name|DuffL
argument_list|(
argument|nl
argument_list|,
argument|label4
argument_list|,
argument|bits1 = BitRight(bits, rightShift); 			       bits = *--psrc; 			       *--pdst = bits1 | BitLeft(bits, leftShift);
argument_list|)
if|if
condition|(
name|startmask
condition|)
block|{
name|bits1
operator|=
name|SCRRIGHT
argument_list|(
name|bits
argument_list|,
name|rightShift
argument_list|)
expr_stmt|;
if|if
condition|(
name|SCRRIGHT
argument_list|(
name|startmask
argument_list|,
name|leftShift
argument_list|)
condition|)
block|{
name|bits
operator|=
operator|*
operator|--
name|psrc
expr_stmt|;
name|bits1
operator||=
name|SCRLEFT
argument_list|(
name|bits
argument_list|,
name|leftShift
argument_list|)
expr_stmt|;
block|}
operator|--
name|pdst
expr_stmt|;
operator|*
name|pdst
operator|=
operator|(
operator|*
name|pdst
operator|&
operator|~
name|startmask
operator|)
operator||
operator|(
name|bits1
operator|&
name|startmask
operator|)
expr_stmt|;
block|}
block|}
block|}
block|}
block|}
block|}
else|else
comment|/* do some rop */
block|{
comment|/* x direction doesn't matter for< 1 longword */
if|if
condition|(
name|w
operator|<=
literal|32
condition|)
block|{
name|int
name|srcBit
decl_stmt|,
name|dstBit
decl_stmt|;
comment|/* bit offset of src and dst */
name|pdstLine
operator|+=
operator|(
name|destX
operator|>>
literal|5
operator|)
expr_stmt|;
name|psrcLine
operator|+=
operator|(
name|sourceX
operator|>>
literal|5
operator|)
expr_stmt|;
name|psrc
operator|=
name|psrcLine
expr_stmt|;
name|pdst
operator|=
name|pdstLine
expr_stmt|;
name|srcBit
operator|=
name|sourceX
operator|&
literal|0x1f
expr_stmt|;
name|dstBit
operator|=
name|destX
operator|&
literal|0x1f
expr_stmt|;
while|while
condition|(
name|h
operator|--
condition|)
block|{
name|getandputrop
argument_list|(
argument|psrc
argument_list|,
argument|srcBit
argument_list|,
argument|dstBit
argument_list|,
argument|w
argument_list|,
argument|pdst
argument_list|,
argument|alu
argument_list|)
name|pdst
operator|+=
name|width
expr_stmt|;
name|psrc
operator|+=
name|width
expr_stmt|;
block|}
block|}
else|else
block|{
name|maskbits
argument_list|(
argument|destX
argument_list|,
argument|w
argument_list|,
argument|startmask
argument_list|,
argument|endmask
argument_list|,
argument|nlMiddle
argument_list|)
if|if
condition|(
name|startmask
condition|)
name|nstart
operator|=
literal|32
operator|-
operator|(
name|destX
operator|&
literal|0x1f
operator|)
expr_stmt|;
else|else
name|nstart
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|endmask
condition|)
name|nend
operator|=
name|destX
operator|+
name|w
operator|&
literal|0x1f
expr_stmt|;
else|else
name|nend
operator|=
literal|0
expr_stmt|;
name|xoffSrc
operator|=
operator|(
operator|(
name|sourceX
operator|&
literal|0x1f
operator|)
operator|+
name|nstart
operator|)
operator|&
literal|0x1f
expr_stmt|;
name|srcStartOver
operator|=
operator|(
operator|(
name|sourceX
operator|&
literal|0x1f
operator|)
operator|+
name|nstart
operator|)
operator|>
literal|31
expr_stmt|;
if|if
condition|(
name|sourceX
operator|>=
name|destX
condition|)
comment|/* move left to right */
block|{
name|pdstLine
operator|+=
operator|(
name|destX
operator|>>
literal|5
operator|)
expr_stmt|;
name|psrcLine
operator|+=
operator|(
name|sourceX
operator|>>
literal|5
operator|)
expr_stmt|;
while|while
condition|(
name|h
operator|--
condition|)
block|{
name|psrc
operator|=
name|psrcLine
expr_stmt|;
name|pdst
operator|=
name|pdstLine
expr_stmt|;
if|if
condition|(
name|startmask
condition|)
block|{
name|getandputrop
argument_list|(
argument|psrc
argument_list|,
argument|(sourceX&
literal|0x1f
argument|)
argument_list|,
argument|(destX&
literal|0x1f
argument|)
argument_list|,
argument|nstart
argument_list|,
argument|pdst
argument_list|,
argument|alu
argument_list|)
name|pdst
operator|++
expr_stmt|;
if|if
condition|(
name|srcStartOver
condition|)
name|psrc
operator|++
expr_stmt|;
block|}
comment|/* special case for aligned operations */
if|if
condition|(
name|xoffSrc
operator|==
literal|0
condition|)
block|{
name|nl
operator|=
name|nlMiddle
expr_stmt|;
while|while
condition|(
name|nl
operator|--
condition|)
block|{
name|DoRop
argument_list|(
operator|*
name|pdst
argument_list|,
name|alu
argument_list|,
operator|*
name|psrc
operator|++
argument_list|,
operator|*
name|pdst
argument_list|)
expr_stmt|;
name|pdst
operator|++
expr_stmt|;
block|}
block|}
else|else
block|{
name|nl
operator|=
name|nlMiddle
operator|+
literal|1
expr_stmt|;
while|while
condition|(
operator|--
name|nl
condition|)
block|{
name|getunalignedword
argument_list|(
argument|psrc
argument_list|,
argument|xoffSrc
argument_list|,
argument|tmpSrc
argument_list|)
name|DoRop
argument_list|(
operator|*
name|pdst
argument_list|,
name|alu
argument_list|,
name|tmpSrc
argument_list|,
operator|*
name|pdst
argument_list|)
expr_stmt|;
name|pdst
operator|++
expr_stmt|;
name|psrc
operator|++
expr_stmt|;
block|}
block|}
if|if
condition|(
name|endmask
condition|)
block|{
name|getandputrop0
argument_list|(
name|psrc
argument_list|,
name|xoffSrc
argument_list|,
name|nend
argument_list|,
name|pdst
argument_list|,
name|alu
argument_list|)
expr_stmt|;
block|}
name|pdstLine
operator|+=
name|width
expr_stmt|;
name|psrcLine
operator|+=
name|width
expr_stmt|;
block|}
block|}
else|else
comment|/* move right to left */
block|{
name|pdstLine
operator|+=
operator|(
name|destX
operator|+
name|w
operator|>>
literal|5
operator|)
expr_stmt|;
name|psrcLine
operator|+=
operator|(
name|sourceX
operator|+
name|w
operator|>>
literal|5
operator|)
expr_stmt|;
comment|/* if fetch of last partial bits from source crosses 		   a longword boundary, start at the previous longword 		   */
if|if
condition|(
name|xoffSrc
operator|+
name|nend
operator|>=
literal|32
condition|)
operator|--
name|psrcLine
expr_stmt|;
while|while
condition|(
name|h
operator|--
condition|)
block|{
name|psrc
operator|=
name|psrcLine
expr_stmt|;
name|pdst
operator|=
name|pdstLine
expr_stmt|;
if|if
condition|(
name|endmask
condition|)
block|{
name|getandputrop0
argument_list|(
name|psrc
argument_list|,
name|xoffSrc
argument_list|,
name|nend
argument_list|,
name|pdst
argument_list|,
name|alu
argument_list|)
expr_stmt|;
block|}
name|nl
operator|=
name|nlMiddle
operator|+
literal|1
expr_stmt|;
while|while
condition|(
operator|--
name|nl
condition|)
block|{
operator|--
name|psrc
expr_stmt|;
operator|--
name|pdst
expr_stmt|;
name|getunalignedword
argument_list|(
argument|psrc
argument_list|,
argument|xoffSrc
argument_list|,
argument|tmpSrc
argument_list|)
name|DoRop
argument_list|(
operator|*
name|pdst
argument_list|,
name|alu
argument_list|,
name|tmpSrc
argument_list|,
operator|*
name|pdst
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|startmask
condition|)
block|{
if|if
condition|(
name|srcStartOver
condition|)
operator|--
name|psrc
expr_stmt|;
operator|--
name|pdst
expr_stmt|;
name|getandputrop
argument_list|(
argument|psrc
argument_list|,
argument|(sourceX&
literal|0x1f
argument|)
argument_list|,
argument|(destX&
literal|0x1f
argument|)
argument_list|,
argument|nstart
argument_list|,
argument|pdst
argument_list|,
argument|alu
argument_list|)
block|}
name|pdstLine
operator|+=
name|width
expr_stmt|;
name|psrcLine
operator|+=
name|width
expr_stmt|;
block|}
block|}
comment|/* move right to left */
block|}
block|}
block|}
end_function

end_unit

