begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* $XConsortium: XWindow.c,v 11.16 91/01/06 11:48:49 rws Exp $ */
end_comment

begin_comment
comment|/* Copyright    Massachusetts Institute of Technology    1986	*/
end_comment

begin_comment
comment|/* Permission to use, copy, modify, distribute, and sell this software and its documentation for any purpose is hereby granted without fee, provided that the above copyright notice appear in all copies and that both that copyright notice and this permission notice appear in supporting documentation, and that the name of M.I.T. not be used in advertising or publicity pertaining to distribution of the software without specific, written prior permission.  M.I.T. makes no representations about the suitability of this software for any purpose.  It is provided "as is" without express or implied warranty. */
end_comment

begin_include
include|#
directive|include
file|"Xlibint.h"
end_include

begin_define
define|#
directive|define
name|AllMaskBits
value|(CWBackPixmap|CWBackPixel|CWBorderPixmap|\ 		     CWBorderPixel|CWBitGravity|CWWinGravity|\ 		     CWBackingStore|CWBackingPlanes|CWBackingPixel|\ 		     CWOverrideRedirect|CWSaveUnder|CWEventMask|\ 		     CWDontPropagate|CWColormap|CWCursor)
end_define

begin_function
name|Window
name|XCreateWindow
parameter_list|(
name|dpy
parameter_list|,
name|parent
parameter_list|,
name|x
parameter_list|,
name|y
parameter_list|,
name|width
parameter_list|,
name|height
parameter_list|,
name|borderWidth
parameter_list|,
name|depth
parameter_list|,
name|class
parameter_list|,
name|visual
parameter_list|,
name|valuemask
parameter_list|,
name|attributes
parameter_list|)
specifier|register
name|Display
modifier|*
name|dpy
decl_stmt|;
name|Window
name|parent
decl_stmt|;
name|int
name|x
decl_stmt|,
name|y
decl_stmt|;
name|unsigned
name|int
name|width
decl_stmt|,
name|height
decl_stmt|,
name|borderWidth
decl_stmt|;
name|int
name|depth
decl_stmt|;
name|unsigned
name|int
name|class
decl_stmt|;
name|Visual
modifier|*
name|visual
decl_stmt|;
name|unsigned
name|long
name|valuemask
decl_stmt|;
name|XSetWindowAttributes
modifier|*
name|attributes
decl_stmt|;
block|{
name|Window
name|wid
decl_stmt|;
specifier|register
name|xCreateWindowReq
modifier|*
name|req
decl_stmt|;
name|LockDisplay
argument_list|(
name|dpy
argument_list|)
expr_stmt|;
name|GetReq
argument_list|(
name|CreateWindow
argument_list|,
name|req
argument_list|)
expr_stmt|;
name|req
operator|->
name|parent
operator|=
name|parent
expr_stmt|;
name|req
operator|->
name|x
operator|=
name|x
expr_stmt|;
name|req
operator|->
name|y
operator|=
name|y
expr_stmt|;
name|req
operator|->
name|width
operator|=
name|width
expr_stmt|;
name|req
operator|->
name|height
operator|=
name|height
expr_stmt|;
name|req
operator|->
name|borderWidth
operator|=
name|borderWidth
expr_stmt|;
name|req
operator|->
name|depth
operator|=
name|depth
expr_stmt|;
name|req
operator|->
name|class
operator|=
name|class
expr_stmt|;
if|if
condition|(
name|visual
operator|==
name|CopyFromParent
condition|)
name|req
operator|->
name|visual
operator|=
name|CopyFromParent
expr_stmt|;
else|else
name|req
operator|->
name|visual
operator|=
name|visual
operator|->
name|visualid
expr_stmt|;
name|wid
operator|=
name|req
operator|->
name|wid
operator|=
name|XAllocID
argument_list|(
name|dpy
argument_list|)
expr_stmt|;
name|valuemask
operator|&=
name|AllMaskBits
expr_stmt|;
if|if
condition|(
name|req
operator|->
name|mask
operator|=
name|valuemask
condition|)
name|_XProcessWindowAttributes
argument_list|(
name|dpy
argument_list|,
operator|(
name|xChangeWindowAttributesReq
operator|*
operator|)
name|req
argument_list|,
name|valuemask
argument_list|,
name|attributes
argument_list|)
expr_stmt|;
name|UnlockDisplay
argument_list|(
name|dpy
argument_list|)
expr_stmt|;
name|SyncHandle
argument_list|()
expr_stmt|;
return|return
operator|(
name|wid
operator|)
return|;
block|}
end_function

begin_expr_stmt
name|_XProcessWindowAttributes
argument_list|(
name|dpy
argument_list|,
name|req
argument_list|,
name|valuemask
argument_list|,
name|attributes
argument_list|)
specifier|register
name|Display
operator|*
name|dpy
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|xChangeWindowAttributesReq
modifier|*
name|req
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|register
name|unsigned
name|long
name|valuemask
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|register
name|XSetWindowAttributes
modifier|*
name|attributes
decl_stmt|;
end_decl_stmt

begin_block
block|{
comment|/* Warning!  This code assumes that "unsigned long" is 32-bits wide */
name|unsigned
name|long
name|values
index|[
literal|32
index|]
decl_stmt|;
specifier|register
name|unsigned
name|long
modifier|*
name|value
init|=
name|values
decl_stmt|;
name|unsigned
name|int
name|nvalues
decl_stmt|;
if|if
condition|(
name|valuemask
operator|&
name|CWBackPixmap
condition|)
operator|*
name|value
operator|++
operator|=
name|attributes
operator|->
name|background_pixmap
expr_stmt|;
if|if
condition|(
name|valuemask
operator|&
name|CWBackPixel
condition|)
operator|*
name|value
operator|++
operator|=
name|attributes
operator|->
name|background_pixel
expr_stmt|;
if|if
condition|(
name|valuemask
operator|&
name|CWBorderPixmap
condition|)
operator|*
name|value
operator|++
operator|=
name|attributes
operator|->
name|border_pixmap
expr_stmt|;
if|if
condition|(
name|valuemask
operator|&
name|CWBorderPixel
condition|)
operator|*
name|value
operator|++
operator|=
name|attributes
operator|->
name|border_pixel
expr_stmt|;
if|if
condition|(
name|valuemask
operator|&
name|CWBitGravity
condition|)
operator|*
name|value
operator|++
operator|=
name|attributes
operator|->
name|bit_gravity
expr_stmt|;
if|if
condition|(
name|valuemask
operator|&
name|CWWinGravity
condition|)
operator|*
name|value
operator|++
operator|=
name|attributes
operator|->
name|win_gravity
expr_stmt|;
if|if
condition|(
name|valuemask
operator|&
name|CWBackingStore
condition|)
operator|*
name|value
operator|++
operator|=
name|attributes
operator|->
name|backing_store
expr_stmt|;
if|if
condition|(
name|valuemask
operator|&
name|CWBackingPlanes
condition|)
operator|*
name|value
operator|++
operator|=
name|attributes
operator|->
name|backing_planes
expr_stmt|;
if|if
condition|(
name|valuemask
operator|&
name|CWBackingPixel
condition|)
operator|*
name|value
operator|++
operator|=
name|attributes
operator|->
name|backing_pixel
expr_stmt|;
if|if
condition|(
name|valuemask
operator|&
name|CWOverrideRedirect
condition|)
operator|*
name|value
operator|++
operator|=
name|attributes
operator|->
name|override_redirect
expr_stmt|;
if|if
condition|(
name|valuemask
operator|&
name|CWSaveUnder
condition|)
operator|*
name|value
operator|++
operator|=
name|attributes
operator|->
name|save_under
expr_stmt|;
if|if
condition|(
name|valuemask
operator|&
name|CWEventMask
condition|)
operator|*
name|value
operator|++
operator|=
name|attributes
operator|->
name|event_mask
expr_stmt|;
if|if
condition|(
name|valuemask
operator|&
name|CWDontPropagate
condition|)
operator|*
name|value
operator|++
operator|=
name|attributes
operator|->
name|do_not_propagate_mask
expr_stmt|;
if|if
condition|(
name|valuemask
operator|&
name|CWColormap
condition|)
operator|*
name|value
operator|++
operator|=
name|attributes
operator|->
name|colormap
expr_stmt|;
if|if
condition|(
name|valuemask
operator|&
name|CWCursor
condition|)
operator|*
name|value
operator|++
operator|=
name|attributes
operator|->
name|cursor
expr_stmt|;
name|req
operator|->
name|length
operator|+=
operator|(
name|nvalues
operator|=
name|value
operator|-
name|values
operator|)
expr_stmt|;
name|nvalues
operator|<<=
literal|2
expr_stmt|;
comment|/* watch out for macros... */
name|Data32
argument_list|(
name|dpy
argument_list|,
operator|(
name|long
operator|*
operator|)
name|values
argument_list|,
operator|(
name|long
operator|)
name|nvalues
argument_list|)
expr_stmt|;
block|}
end_block

end_unit

