begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* $XConsortium: XGetWAttrs.c,v 11.23 91/01/06 11:46:21 rws Exp $ */
end_comment

begin_comment
comment|/* Copyright    Massachusetts Institute of Technology    1986	*/
end_comment

begin_comment
comment|/* Permission to use, copy, modify, distribute, and sell this software and its documentation for any purpose is hereby granted without fee, provided that the above copyright notice appear in all copies and that both that copyright notice and this permission notice appear in supporting documentation, and that the name of M.I.T. not be used in advertising or publicity pertaining to distribution of the software without specific, written prior permission.  M.I.T. makes no representations about the suitability of this software for any purpose.  It is provided "as is" without express or implied warranty. */
end_comment

begin_define
define|#
directive|define
name|NEED_REPLIES
end_define

begin_include
include|#
directive|include
file|"Xlibint.h"
end_include

begin_function
name|Status
name|XGetWindowAttributes
parameter_list|(
name|dpy
parameter_list|,
name|w
parameter_list|,
name|attr
parameter_list|)
specifier|register
name|Display
modifier|*
name|dpy
decl_stmt|;
name|Window
name|w
decl_stmt|;
name|XWindowAttributes
modifier|*
name|attr
decl_stmt|;
block|{
name|xGetWindowAttributesReply
name|rep
decl_stmt|;
name|xGetGeometryReply
name|rep2
decl_stmt|;
specifier|register
name|xResourceReq
modifier|*
name|req1
decl_stmt|;
specifier|register
name|xResourceReq
modifier|*
name|req2
decl_stmt|;
specifier|register
name|int
name|i
decl_stmt|;
specifier|register
name|Screen
modifier|*
name|sp
decl_stmt|;
name|LockDisplay
argument_list|(
name|dpy
argument_list|)
expr_stmt|;
name|GetResReq
argument_list|(
name|GetWindowAttributes
argument_list|,
name|w
argument_list|,
name|req1
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|_XReply
argument_list|(
name|dpy
argument_list|,
operator|(
name|xReply
operator|*
operator|)
operator|&
name|rep
argument_list|,
operator|(
name|SIZEOF
argument_list|(
name|xGetWindowAttributesReply
argument_list|)
operator|-
name|SIZEOF
argument_list|(
name|xReply
argument_list|)
operator|)
operator|>>
literal|2
argument_list|,
name|xTrue
argument_list|)
condition|)
block|{
name|UnlockDisplay
argument_list|(
name|dpy
argument_list|)
expr_stmt|;
name|SyncHandle
argument_list|()
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
name|attr
operator|->
name|class
operator|=
name|rep
operator|.
name|class
expr_stmt|;
name|attr
operator|->
name|bit_gravity
operator|=
name|rep
operator|.
name|bitGravity
expr_stmt|;
name|attr
operator|->
name|win_gravity
operator|=
name|rep
operator|.
name|winGravity
expr_stmt|;
name|attr
operator|->
name|backing_store
operator|=
name|rep
operator|.
name|backingStore
expr_stmt|;
name|attr
operator|->
name|backing_planes
operator|=
name|rep
operator|.
name|backingBitPlanes
expr_stmt|;
name|attr
operator|->
name|backing_pixel
operator|=
name|rep
operator|.
name|backingPixel
expr_stmt|;
name|attr
operator|->
name|save_under
operator|=
name|rep
operator|.
name|saveUnder
expr_stmt|;
name|attr
operator|->
name|colormap
operator|=
name|rep
operator|.
name|colormap
expr_stmt|;
name|attr
operator|->
name|map_installed
operator|=
name|rep
operator|.
name|mapInstalled
expr_stmt|;
name|attr
operator|->
name|map_state
operator|=
name|rep
operator|.
name|mapState
expr_stmt|;
name|attr
operator|->
name|all_event_masks
operator|=
name|rep
operator|.
name|allEventMasks
expr_stmt|;
name|attr
operator|->
name|your_event_mask
operator|=
name|rep
operator|.
name|yourEventMask
expr_stmt|;
name|attr
operator|->
name|do_not_propagate_mask
operator|=
name|rep
operator|.
name|doNotPropagateMask
expr_stmt|;
name|attr
operator|->
name|override_redirect
operator|=
name|rep
operator|.
name|override
expr_stmt|;
name|attr
operator|->
name|visual
operator|=
name|_XVIDtoVisual
argument_list|(
name|dpy
argument_list|,
name|rep
operator|.
name|visualID
argument_list|)
expr_stmt|;
name|GetResReq
argument_list|(
name|GetGeometry
argument_list|,
name|w
argument_list|,
name|req2
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|_XReply
argument_list|(
name|dpy
argument_list|,
operator|(
name|xReply
operator|*
operator|)
operator|&
name|rep2
argument_list|,
literal|0
argument_list|,
name|xTrue
argument_list|)
condition|)
block|{
name|UnlockDisplay
argument_list|(
name|dpy
argument_list|)
expr_stmt|;
name|SyncHandle
argument_list|()
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
name|attr
operator|->
name|x
operator|=
name|cvtINT16toInt
argument_list|(
name|rep2
operator|.
name|x
argument_list|)
expr_stmt|;
name|attr
operator|->
name|y
operator|=
name|cvtINT16toInt
argument_list|(
name|rep2
operator|.
name|y
argument_list|)
expr_stmt|;
name|attr
operator|->
name|width
operator|=
name|rep2
operator|.
name|width
expr_stmt|;
name|attr
operator|->
name|height
operator|=
name|rep2
operator|.
name|height
expr_stmt|;
name|attr
operator|->
name|border_width
operator|=
name|rep2
operator|.
name|borderWidth
expr_stmt|;
name|attr
operator|->
name|depth
operator|=
name|rep2
operator|.
name|depth
expr_stmt|;
name|attr
operator|->
name|root
operator|=
name|rep2
operator|.
name|root
expr_stmt|;
comment|/* find correct screen so that applications find it easier.... */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|dpy
operator|->
name|nscreens
condition|;
name|i
operator|++
control|)
block|{
name|sp
operator|=
operator|&
name|dpy
operator|->
name|screens
index|[
name|i
index|]
expr_stmt|;
if|if
condition|(
name|sp
operator|->
name|root
operator|==
name|attr
operator|->
name|root
condition|)
block|{
name|attr
operator|->
name|screen
operator|=
name|sp
expr_stmt|;
break|break;
block|}
block|}
name|UnlockDisplay
argument_list|(
name|dpy
argument_list|)
expr_stmt|;
name|SyncHandle
argument_list|()
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
end_function

end_unit

