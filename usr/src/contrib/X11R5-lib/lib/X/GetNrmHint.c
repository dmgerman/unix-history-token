begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* $XConsortium: GetNrmHint.c,v 1.6 91/02/01 16:32:58 gildea Exp $ */
end_comment

begin_comment
comment|/*********************************************************** Copyright 1988 by Wyse Technology, Inc., San Jose, Ca, and the Massachusetts Institute of Technology, Cambridge, Massachusetts. Copyright 1987 by Digital Equipment Corporation, Maynard, Massachusetts, and the Massachusetts Institute of Technology, Cambridge, Massachusetts.                          All Rights Reserved  Permission to use, copy, modify, and distribute this software and its  documentation for any purpose and without fee is hereby granted,  provided that the above copyright notice appear in all copies and that both that copyright notice and this permission notice appear in  supporting documentation, and that the names of Digital or MIT not be used in advertising or publicity pertaining to distribution of the software without specific, written prior permission.    DIGITAL AND WYSE DISCLAIM ALL WARRANTIES WITH REGARD TO THIS SOFTWARE,  INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, IN NO  EVENT SHALL DIGITAL OR WYSE BE LIABLE FOR ANY SPECIAL, INDIRECT OR  CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF  USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR  PERFORMANCE OF THIS SOFTWARE.  ******************************************************************/
end_comment

begin_include
include|#
directive|include
file|<X11/Xlibint.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xatom.h>
end_include

begin_include
include|#
directive|include
file|"Xatomtype.h"
end_include

begin_include
include|#
directive|include
file|<X11/Xutil.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_function
name|Status
name|XGetWMSizeHints
parameter_list|(
name|dpy
parameter_list|,
name|w
parameter_list|,
name|hints
parameter_list|,
name|supplied
parameter_list|,
name|property
parameter_list|)
name|Display
modifier|*
name|dpy
decl_stmt|;
name|Window
name|w
decl_stmt|;
name|XSizeHints
modifier|*
name|hints
decl_stmt|;
name|long
modifier|*
name|supplied
decl_stmt|;
name|Atom
name|property
decl_stmt|;
block|{
name|xPropSizeHints
modifier|*
name|prop
init|=
name|NULL
decl_stmt|;
name|Atom
name|actual_type
decl_stmt|;
name|int
name|actual_format
decl_stmt|;
name|unsigned
name|long
name|leftover
decl_stmt|;
name|unsigned
name|long
name|nitems
decl_stmt|;
if|if
condition|(
name|XGetWindowProperty
argument_list|(
name|dpy
argument_list|,
name|w
argument_list|,
name|property
argument_list|,
literal|0L
argument_list|,
operator|(
name|long
operator|)
name|NumPropSizeElements
argument_list|,
name|False
argument_list|,
name|XA_WM_SIZE_HINTS
argument_list|,
operator|&
name|actual_type
argument_list|,
operator|&
name|actual_format
argument_list|,
operator|&
name|nitems
argument_list|,
operator|&
name|leftover
argument_list|,
operator|(
name|unsigned
name|char
operator|*
operator|*
operator|)
operator|&
name|prop
argument_list|)
operator|!=
name|Success
condition|)
return|return
name|False
return|;
if|if
condition|(
operator|(
name|actual_type
operator|!=
name|XA_WM_SIZE_HINTS
operator|)
operator|||
operator|(
name|nitems
operator|<
name|OldNumPropSizeElements
operator|)
operator|||
operator|(
name|actual_format
operator|!=
literal|32
operator|)
condition|)
block|{
if|if
condition|(
name|prop
operator|!=
name|NULL
condition|)
name|Xfree
argument_list|(
operator|(
name|char
operator|*
operator|)
name|prop
argument_list|)
expr_stmt|;
return|return
name|False
return|;
block|}
name|hints
operator|->
name|flags
operator|=
name|prop
operator|->
name|flags
expr_stmt|;
comment|/* XSizeHints misdeclares these as int instead of long */
name|hints
operator|->
name|x
operator|=
name|cvtINT32toInt
argument_list|(
name|prop
operator|->
name|x
argument_list|)
expr_stmt|;
name|hints
operator|->
name|y
operator|=
name|cvtINT32toInt
argument_list|(
name|prop
operator|->
name|y
argument_list|)
expr_stmt|;
name|hints
operator|->
name|width
operator|=
name|cvtINT32toInt
argument_list|(
name|prop
operator|->
name|width
argument_list|)
expr_stmt|;
name|hints
operator|->
name|height
operator|=
name|cvtINT32toInt
argument_list|(
name|prop
operator|->
name|height
argument_list|)
expr_stmt|;
name|hints
operator|->
name|min_width
operator|=
name|cvtINT32toInt
argument_list|(
name|prop
operator|->
name|minWidth
argument_list|)
expr_stmt|;
name|hints
operator|->
name|min_height
operator|=
name|cvtINT32toInt
argument_list|(
name|prop
operator|->
name|minHeight
argument_list|)
expr_stmt|;
name|hints
operator|->
name|max_width
operator|=
name|cvtINT32toInt
argument_list|(
name|prop
operator|->
name|maxWidth
argument_list|)
expr_stmt|;
name|hints
operator|->
name|max_height
operator|=
name|cvtINT32toInt
argument_list|(
name|prop
operator|->
name|maxHeight
argument_list|)
expr_stmt|;
name|hints
operator|->
name|width_inc
operator|=
name|cvtINT32toInt
argument_list|(
name|prop
operator|->
name|widthInc
argument_list|)
expr_stmt|;
name|hints
operator|->
name|height_inc
operator|=
name|cvtINT32toInt
argument_list|(
name|prop
operator|->
name|heightInc
argument_list|)
expr_stmt|;
name|hints
operator|->
name|min_aspect
operator|.
name|x
operator|=
name|cvtINT32toInt
argument_list|(
name|prop
operator|->
name|minAspectX
argument_list|)
expr_stmt|;
name|hints
operator|->
name|min_aspect
operator|.
name|y
operator|=
name|cvtINT32toInt
argument_list|(
name|prop
operator|->
name|minAspectY
argument_list|)
expr_stmt|;
name|hints
operator|->
name|max_aspect
operator|.
name|x
operator|=
name|cvtINT32toInt
argument_list|(
name|prop
operator|->
name|maxAspectX
argument_list|)
expr_stmt|;
name|hints
operator|->
name|max_aspect
operator|.
name|y
operator|=
name|cvtINT32toInt
argument_list|(
name|prop
operator|->
name|maxAspectY
argument_list|)
expr_stmt|;
operator|*
name|supplied
operator|=
operator|(
name|USPosition
operator||
name|USSize
operator||
name|PAllHints
operator|)
expr_stmt|;
if|if
condition|(
name|nitems
operator|>=
name|NumPropSizeElements
condition|)
block|{
name|hints
operator|->
name|base_width
operator|=
name|cvtINT32toInt
argument_list|(
name|prop
operator|->
name|baseWidth
argument_list|)
expr_stmt|;
name|hints
operator|->
name|base_height
operator|=
name|cvtINT32toInt
argument_list|(
name|prop
operator|->
name|baseHeight
argument_list|)
expr_stmt|;
name|hints
operator|->
name|win_gravity
operator|=
name|cvtINT32toInt
argument_list|(
name|prop
operator|->
name|winGravity
argument_list|)
expr_stmt|;
operator|*
name|supplied
operator||=
operator|(
name|PBaseSize
operator||
name|PWinGravity
operator|)
expr_stmt|;
block|}
name|hints
operator|->
name|flags
operator|&=
operator|(
operator|*
name|supplied
operator|)
expr_stmt|;
comment|/* get rid of unwanted bits */
name|Xfree
argument_list|(
operator|(
name|char
operator|*
operator|)
name|prop
argument_list|)
expr_stmt|;
return|return
name|True
return|;
block|}
end_function

begin_function
name|Status
name|XGetWMNormalHints
parameter_list|(
name|dpy
parameter_list|,
name|w
parameter_list|,
name|hints
parameter_list|,
name|supplied
parameter_list|)
name|Display
modifier|*
name|dpy
decl_stmt|;
name|Window
name|w
decl_stmt|;
name|XSizeHints
modifier|*
name|hints
decl_stmt|;
name|long
modifier|*
name|supplied
decl_stmt|;
block|{
return|return
operator|(
name|XGetWMSizeHints
argument_list|(
name|dpy
argument_list|,
name|w
argument_list|,
name|hints
argument_list|,
name|supplied
argument_list|,
name|XA_WM_NORMAL_HINTS
argument_list|)
operator|)
return|;
block|}
end_function

end_unit

