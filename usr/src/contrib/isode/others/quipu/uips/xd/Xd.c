begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* $Header: /f/osi/others/quipu/uips/xd/RCS/Xd.c,v 7.2 91/02/22 09:32:39 mrose Interim $ */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
modifier|*
name|rcsid
init|=
literal|"$Id: Xd.c,v 7.2 91/02/22 09:32:39 mrose Interim $"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/*  $Log:	Xd.c,v $  * Revision 7.2  91/02/22  09:32:39  mrose  * Interim 6.8  *   * Revision 7.1  90/10/17  11:50:17  mrose  * sync  *   * Revision 7.0  90/06/12  13:10:46  mrose  * *** empty log message ***  *   * Revision 1.5  90/04/26  10:22:32  emsrssn  * Installation fixed  *   *   * Revision 1.4  90/04/25  17:28:02  emsrssn  * Lint tidy up  *   *   * Revision 1.3  90/04/19  13:54:00  emsrssn  * keyboard accelerator now activates button highlight.  *   * search types available is dependent on current position  * to prevent unreasonable searches.  *   * the help popup changes automatically depending on the   * position of the cursor  *   * buttons remain a fixed size when the application is  * resized  *   * command line options are now handled properly  *   * logging added  *   * "reads" are now sorted to show mail address at top etc.  *   *   * Revision 1.2  90/03/09  15:57:25  emsrssn  * First public distribution  *   *   * Revision 1.1  90/03/08  13:18:43  emsrssn  * Initial revision  *   *  */
end_comment

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|"quipu/util.h"
end_include

begin_include
include|#
directive|include
file|"sequence.h"
end_include

begin_include
include|#
directive|include
file|"dirtitle.h"
end_include

begin_include
include|#
directive|include
file|<X11/Xatom.h>
end_include

begin_include
include|#
directive|include
file|<X11/Intrinsic.h>
end_include

begin_include
include|#
directive|include
file|<X11/StringDefs.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/AsciiText.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/Box.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/Clock.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/Command.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/Dialog.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/Form.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/Label.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/List.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/Logo.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/MenuButton.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/Scrollbar.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/SimpleMenu.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/Sme.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/SmeBSB.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/SmeLine.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/StripChart.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/Paned.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/Text.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/Toggle.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/Viewport.h>
end_include

begin_include
include|#
directive|include
file|<X11/Xaw/Cardinals.h>
end_include

begin_include
include|#
directive|include
file|<X11/cursorfont.h>
end_include

begin_define
define|#
directive|define
name|ASIZELIMIT
value|50
end_define

begin_comment
comment|/* used for result list size and directory limits */
end_comment

begin_define
define|#
directive|define
name|MAXLOOKBACKLENGTH
value|10
end_define

begin_define
define|#
directive|define
name|MAXLENGTH
value|255
end_define

begin_define
define|#
directive|define
name|MAXRESULTLISTLENGTH
value|ASIZELIMIT
end_define

begin_define
define|#
directive|define
name|NOHISTORY
value|"You've not been anywhere yet"
end_define

begin_decl_stmt
specifier|extern
name|char
name|base_path
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|char
name|friendly_base_path
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|char
name|goto_path
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|char
name|mvalue
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|filt_num
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|unsigned
name|int
name|typeindx
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|char
modifier|*
name|filtvalue
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|char
modifier|*
name|filttype
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|char
name|dua_help_dir
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
modifier|*
name|av_typeindx
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|D_seq
name|showseq
decl_stmt|,
name|dnseq
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|entry_number
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|element_number
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|asizelimit
init|=
name|ASIZELIMIT
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|void
name|add_to_lookback
argument_list|()
decl_stmt|,
name|xprint
argument_list|()
decl_stmt|,
name|CreatePopupHelp
argument_list|()
decl_stmt|,
name|Change_Help
argument_list|()
decl_stmt|;
end_decl_stmt

begin_function_decl
specifier|static
name|void
name|Call_Change_Help
parameter_list|()
function_decl|;
end_function_decl

begin_decl_stmt
specifier|static
name|void
name|Quit
argument_list|()
decl_stmt|,
name|create_genform
argument_list|()
decl_stmt|,
name|create_inputform
argument_list|()
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|create_viewlist
argument_list|()
decl_stmt|,
name|create_commandform
argument_list|()
decl_stmt|,
name|create_outputform
argument_list|()
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|PopupList
argument_list|()
decl_stmt|,
name|PopupTypelist
argument_list|()
decl_stmt|,
name|Quit_Popup
argument_list|()
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|PopupHelp
argument_list|()
decl_stmt|,
name|PopdownHelp
argument_list|()
decl_stmt|,
name|Change_Type
argument_list|()
decl_stmt|,
name|Change_Search_Area
argument_list|()
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|Search
argument_list|()
decl_stmt|,
name|List
argument_list|()
decl_stmt|,
name|widen_search
argument_list|()
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|Boolean
name|lookback_open
init|=
name|False
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* is there a look back popup? */
end_comment

begin_decl_stmt
specifier|static
name|Boolean
name|help_popped_up
init|=
name|False
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* is the help window up? */
end_comment

begin_decl_stmt
name|String
name|result_list
index|[
name|MAXRESULTLISTLENGTH
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|String
name|lookback_list
index|[
name|MAXLOOKBACKLENGTH
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|Widget
name|toplevel
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|XtAppContext
name|app_con
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|XtActionsRec
name|buttonActionsTable
index|[]
init|=
block|{
block|{
literal|"Call_Change_Help"
block|,
operator|(
name|XtActionProc
operator|)
name|Call_Change_Help
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_function
name|void
name|init_widgets
parameter_list|()
block|{
name|Arg
name|args
index|[
literal|1
index|]
decl_stmt|;
name|Widget
name|outer
decl_stmt|;
name|int
name|count
decl_stmt|;
name|outer
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"outer"
argument_list|,
name|panedWidgetClass
argument_list|,
name|toplevel
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|XtAppAddActions
argument_list|(
name|app_con
argument_list|,
name|buttonActionsTable
argument_list|,
name|XtNumber
argument_list|(
name|buttonActionsTable
argument_list|)
argument_list|)
expr_stmt|;
name|create_genform
argument_list|(
name|outer
argument_list|)
expr_stmt|;
name|create_inputform
argument_list|(
name|outer
argument_list|)
expr_stmt|;
name|create_outputform
argument_list|(
name|outer
argument_list|)
expr_stmt|;
name|create_commandform
argument_list|(
name|outer
argument_list|)
expr_stmt|;
name|create_viewlist
argument_list|(
name|outer
argument_list|)
expr_stmt|;
for|for
control|(
name|count
operator|=
literal|0
init|;
name|count
operator|<
name|MAXRESULTLISTLENGTH
condition|;
name|count
operator|++
control|)
block|{
name|result_list
index|[
name|count
index|]
operator|=
name|XtMalloc
argument_list|(
name|MAXLENGTH
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|count
operator|=
literal|0
init|;
name|count
operator|<
name|MAXLOOKBACKLENGTH
condition|;
name|count
operator|++
control|)
block|{
name|lookback_list
index|[
name|count
index|]
operator|=
name|XtMalloc
argument_list|(
name|MAXLENGTH
argument_list|)
expr_stmt|;
block|}
comment|/* add text to stop widget assuming daft size */
operator|(
name|void
operator|)
name|strcpy
argument_list|(
name|lookback_list
index|[
literal|0
index|]
argument_list|,
name|NOHISTORY
argument_list|)
expr_stmt|;
block|}
end_function

begin_macro
name|free_memory
argument_list|()
end_macro

begin_block
block|{
name|int
name|count
decl_stmt|;
for|for
control|(
name|count
operator|=
literal|0
init|;
name|count
operator|<
name|MAXRESULTLISTLENGTH
condition|;
name|count
operator|++
control|)
block|{
name|XtFree
argument_list|(
name|result_list
index|[
name|count
index|]
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|count
operator|=
literal|0
init|;
name|count
operator|<
name|MAXLOOKBACKLENGTH
condition|;
name|count
operator|++
control|)
block|{
name|XtFree
argument_list|(
name|lookback_list
index|[
name|count
index|]
argument_list|)
expr_stmt|;
block|}
block|}
end_block

begin_function
name|void
name|Loop
parameter_list|()
block|{
name|Arg
name|args
index|[
literal|5
index|]
decl_stmt|;
name|Pixmap
name|title_pix
decl_stmt|;
name|String
name|title_name
init|=
literal|"outer.genform.title"
decl_stmt|;
name|Widget
name|title_widg
init|=
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
name|title_name
argument_list|)
decl_stmt|;
name|XtRealizeWidget
argument_list|(
name|toplevel
argument_list|)
expr_stmt|;
name|XFlush
argument_list|(
name|XtDisplay
argument_list|(
name|toplevel
argument_list|)
argument_list|)
expr_stmt|;
comment|/* this ensures that all requests are sent */
comment|/* without this line, linking with cc means */
comment|/* that the requests are not all sent */
name|title_pix
operator|=
name|XCreateBitmapFromData
argument_list|(
name|XtDisplay
argument_list|(
name|title_widg
argument_list|)
argument_list|,
name|XtWindow
argument_list|(
name|title_widg
argument_list|)
argument_list|,
name|stef_bits
argument_list|,
name|stef_width
argument_list|,
name|stef_height
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNbitmap
argument_list|,
name|title_pix
argument_list|)
expr_stmt|;
name|XtSetValues
argument_list|(
name|title_widg
argument_list|,
name|args
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XtAppMainLoop
argument_list|(
name|app_con
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*ARGSUSED*/
end_comment

begin_function
specifier|static
name|void
name|Call_Change_Help
parameter_list|(
name|w
parameter_list|,
name|event
parameter_list|,
name|params
parameter_list|,
name|num_params
parameter_list|)
name|Widget
name|w
decl_stmt|;
name|XEvent
modifier|*
name|event
decl_stmt|;
name|String
modifier|*
name|params
decl_stmt|;
name|int
name|num_params
decl_stmt|;
block|{
name|Change_Help
argument_list|(
name|params
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|create_viewlist
parameter_list|(
name|parent
parameter_list|)
name|Widget
name|parent
decl_stmt|;
block|{
name|Widget
name|view_list
decl_stmt|,
name|list_area
decl_stmt|;
name|Arg
name|args
index|[
literal|10
index|]
decl_stmt|;
name|view_list
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"view_list"
argument_list|,
name|viewportWidgetClass
argument_list|,
name|parent
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNlist
argument_list|,
name|result_list
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|1
index|]
argument_list|,
name|XtNdefaultColumns
argument_list|,
operator|(
name|int
operator|)
literal|1
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|2
index|]
argument_list|,
name|XtNverticalList
argument_list|,
name|True
argument_list|)
expr_stmt|;
name|list_area
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"list_area"
argument_list|,
name|listWidgetClass
argument_list|,
name|view_list
argument_list|,
name|args
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|XtAddCallback
argument_list|(
name|list_area
argument_list|,
name|XtNcallback
argument_list|,
name|Change_Search_Area
argument_list|,
operator|(
name|XtPointer
operator|)
literal|0
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|create_outputform
parameter_list|(
name|parent
parameter_list|)
name|Widget
name|parent
decl_stmt|;
block|{
name|Arg
name|args
index|[
literal|10
index|]
decl_stmt|;
specifier|static
name|XawTextSelectType
name|sarray
index|[]
init|=
block|{
name|XawselectLine
block|,
name|XawselectPosition
block|,
name|XawselectAll
block|,
name|XawselectNull
block|}
decl_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNselectTypes
argument_list|,
name|sarray
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|XtCreateManagedWidget
argument_list|(
literal|"result_area"
argument_list|,
name|asciiTextWidgetClass
argument_list|,
name|parent
argument_list|,
name|args
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|create_commandform
parameter_list|(
name|parent
parameter_list|)
name|Widget
name|parent
decl_stmt|;
block|{
name|Arg
name|args
index|[
literal|1
index|]
decl_stmt|;
comment|/* used to pass zero args...to be consistent for lint */
name|Widget
name|form
decl_stmt|,
name|widen_but
decl_stmt|;
name|Widget
name|search_but
decl_stmt|,
name|list_but
decl_stmt|,
name|lookback_but
decl_stmt|;
name|form
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"commandform"
argument_list|,
name|formWidgetClass
argument_list|,
name|parent
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|search_but
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"search_but"
argument_list|,
name|commandWidgetClass
argument_list|,
name|form
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|XtAddCallback
argument_list|(
name|search_but
argument_list|,
name|XtNcallback
argument_list|,
name|Search
argument_list|,
operator|(
name|XtPointer
operator|)
literal|0
argument_list|)
expr_stmt|;
name|list_but
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"list_but"
argument_list|,
name|commandWidgetClass
argument_list|,
name|form
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|XtAddCallback
argument_list|(
name|list_but
argument_list|,
name|XtNcallback
argument_list|,
name|List
argument_list|,
operator|(
name|XtPointer
operator|)
literal|0
argument_list|)
expr_stmt|;
name|lookback_but
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"lookback_but"
argument_list|,
name|commandWidgetClass
argument_list|,
name|form
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|XtAddCallback
argument_list|(
name|lookback_but
argument_list|,
name|XtNcallback
argument_list|,
name|PopupList
argument_list|,
operator|(
name|XtPointer
operator|)
literal|0
argument_list|)
expr_stmt|;
name|widen_but
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"widen_but"
argument_list|,
name|commandWidgetClass
argument_list|,
name|form
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|XtAddCallback
argument_list|(
name|widen_but
argument_list|,
name|XtNcallback
argument_list|,
name|widen_search
argument_list|,
operator|(
name|XtPointer
operator|)
literal|0
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Searchpress
parameter_list|()
block|{
name|XEvent
name|search_event
decl_stmt|;
name|Widget
name|search_but
init|=
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
literal|"outer.commandform.search_but"
argument_list|)
decl_stmt|;
name|search_event
operator|.
name|type
operator|=
name|ButtonPress
expr_stmt|;
name|search_event
operator|.
name|xbutton
operator|.
name|button
operator|=
name|Button1
expr_stmt|;
name|search_event
operator|.
name|xany
operator|.
name|display
operator|=
name|XtDisplay
argument_list|(
name|search_but
argument_list|)
expr_stmt|;
name|search_event
operator|.
name|xany
operator|.
name|window
operator|=
name|XtWindow
argument_list|(
name|search_but
argument_list|)
expr_stmt|;
name|XSendEvent
argument_list|(
name|XtDisplay
argument_list|(
name|search_but
argument_list|)
argument_list|,
name|XtWindow
argument_list|(
name|search_but
argument_list|)
argument_list|,
name|True
argument_list|,
name|ButtonPressMask
operator||
name|ButtonReleaseMask
argument_list|,
operator|&
name|search_event
argument_list|)
expr_stmt|;
name|search_event
operator|.
name|type
operator|=
name|ButtonRelease
expr_stmt|;
name|XSendEvent
argument_list|(
name|XtDisplay
argument_list|(
name|search_but
argument_list|)
argument_list|,
name|XtWindow
argument_list|(
name|search_but
argument_list|)
argument_list|,
name|True
argument_list|,
name|ButtonPressMask
operator||
name|ButtonReleaseMask
argument_list|,
operator|&
name|search_event
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|Widget
name|create_type_menu
parameter_list|(
name|parent
parameter_list|)
name|Widget
name|parent
decl_stmt|;
block|{
name|Arg
name|args
index|[
literal|1
index|]
decl_stmt|;
comment|/* used to pass zero args...to be consistent for lint */
name|Widget
name|menu
decl_stmt|,
name|button
decl_stmt|;
name|int
name|n
decl_stmt|;
name|menu
operator|=
name|XtCreatePopupShell
argument_list|(
literal|"menu"
argument_list|,
name|simpleMenuWidgetClass
argument_list|,
name|parent
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|n
operator|=
literal|0
expr_stmt|;
while|while
condition|(
name|av_typeindx
index|[
name|n
index|]
operator|!=
operator|-
literal|1
condition|)
block|{
name|button
operator|=
name|XtCreateManagedWidget
argument_list|(
operator|(
name|String
operator|)
name|filttype
index|[
name|av_typeindx
index|[
name|n
index|]
index|]
argument_list|,
name|smeBSBObjectClass
argument_list|,
name|menu
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|XtAddCallback
argument_list|(
name|button
argument_list|,
name|XtNcallback
argument_list|,
name|Change_Type
argument_list|,
operator|(
name|XtPointer
operator|)
name|av_typeindx
index|[
name|n
index|]
argument_list|)
expr_stmt|;
name|n
operator|++
expr_stmt|;
block|}
return|return
name|menu
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|create_inputform
parameter_list|(
name|parent
parameter_list|)
name|Widget
name|parent
decl_stmt|;
block|{
name|Widget
name|form
decl_stmt|,
name|area_form
decl_stmt|,
name|for_form
decl_stmt|,
name|type_form
decl_stmt|;
name|Widget
name|type_but
decl_stmt|;
name|Widget
name|search_for
decl_stmt|;
name|Arg
name|args
index|[
literal|10
index|]
decl_stmt|;
specifier|static
name|XtActionsRec
name|actionsTable
index|[]
init|=
block|{
block|{
literal|"Searchpress"
block|,
operator|(
name|XtActionProc
operator|)
name|Searchpress
block|}
block|,   }
decl_stmt|;
specifier|static
name|char
name|defaultTranslations
index|[]
init|=
literal|"<Key>Return: Searchpress() \n\      Ctrl<Key>M:  Searchpress() \n\      Ctrl<Key>O:  Searchpress()"
decl_stmt|;
name|XtTranslations
name|trans_table
decl_stmt|;
name|form
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"inputform"
argument_list|,
name|formWidgetClass
argument_list|,
name|parent
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|area_form
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"area_form"
argument_list|,
name|formWidgetClass
argument_list|,
name|form
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|XtCreateManagedWidget
argument_list|(
literal|"search_area_label"
argument_list|,
name|labelWidgetClass
argument_list|,
name|area_form
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNstring
argument_list|,
name|friendly_base_path
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|1
index|]
argument_list|,
name|XtNwidth
argument_list|,
operator|(
name|Dimension
operator|)
literal|300
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|XtCreateManagedWidget
argument_list|(
literal|"search_area"
argument_list|,
name|asciiTextWidgetClass
argument_list|,
name|area_form
argument_list|,
name|args
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|for_form
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"for_form"
argument_list|,
name|formWidgetClass
argument_list|,
name|form
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|XtCreateManagedWidget
argument_list|(
literal|"search_for_label"
argument_list|,
name|labelWidgetClass
argument_list|,
name|for_form
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|search_for
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"search_for"
argument_list|,
name|asciiTextWidgetClass
argument_list|,
name|for_form
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|XtAppAddActions
argument_list|(
name|app_con
argument_list|,
name|actionsTable
argument_list|,
name|XtNumber
argument_list|(
name|actionsTable
argument_list|)
argument_list|)
expr_stmt|;
name|trans_table
operator|=
name|XtParseTranslationTable
argument_list|(
name|defaultTranslations
argument_list|)
expr_stmt|;
name|XtOverrideTranslations
argument_list|(
name|search_for
argument_list|,
name|trans_table
argument_list|)
expr_stmt|;
name|type_form
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"type_form"
argument_list|,
name|formWidgetClass
argument_list|,
name|form
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|type_but
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"type_but"
argument_list|,
name|menuButtonWidgetClass
argument_list|,
name|type_form
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|XtCreateManagedWidget
argument_list|(
literal|"search_type"
argument_list|,
name|asciiTextWidgetClass
argument_list|,
name|type_form
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|create_type_menu
argument_list|(
name|type_but
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|create_genform
parameter_list|(
name|parent
parameter_list|)
name|Widget
name|parent
decl_stmt|;
block|{
name|Widget
name|form
decl_stmt|,
name|quit_but
decl_stmt|,
name|help_but
decl_stmt|;
name|Arg
name|args
index|[
literal|10
index|]
decl_stmt|;
name|form
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"genform"
argument_list|,
name|formWidgetClass
argument_list|,
name|parent
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNheight
argument_list|,
name|stef_height
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|1
index|]
argument_list|,
name|XtNwidth
argument_list|,
name|stef_width
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|XtCreateManagedWidget
argument_list|(
literal|"title"
argument_list|,
name|labelWidgetClass
argument_list|,
name|form
argument_list|,
name|args
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|quit_but
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"quit_but"
argument_list|,
name|commandWidgetClass
argument_list|,
name|form
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|XtAddCallback
argument_list|(
name|quit_but
argument_list|,
name|XtNcallback
argument_list|,
name|Quit
argument_list|,
operator|(
name|XtPointer
operator|)
name|toplevel
argument_list|)
expr_stmt|;
name|help_but
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"help_but"
argument_list|,
name|commandWidgetClass
argument_list|,
name|form
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|CreatePopupHelp
argument_list|(
name|help_but
argument_list|)
expr_stmt|;
name|XtAddCallback
argument_list|(
name|help_but
argument_list|,
name|XtNcallback
argument_list|,
name|PopupHelp
argument_list|,
operator|(
name|XtPointer
operator|)
literal|0
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*ARGSUSED*/
end_comment

begin_function
specifier|static
name|void
name|Quit
parameter_list|(
name|widget
parameter_list|,
name|closure
parameter_list|,
name|callData
parameter_list|)
name|Widget
name|widget
decl_stmt|;
name|XtPointer
name|closure
decl_stmt|,
name|callData
decl_stmt|;
block|{
name|XtDestroyWidget
argument_list|(
operator|(
name|Widget
operator|)
name|closure
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|0
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|CreatePopupHelp
parameter_list|(
name|button
parameter_list|)
name|Widget
name|button
decl_stmt|;
block|{
name|Widget
name|popup
decl_stmt|,
name|form
decl_stmt|,
name|quit_but
decl_stmt|;
name|Arg
name|args
index|[
literal|5
index|]
decl_stmt|;
name|FILE
modifier|*
name|file
decl_stmt|;
name|char
name|fullname
index|[
name|MAXLENGTH
index|]
decl_stmt|;
name|char
name|filename
index|[
name|MAXLENGTH
index|]
decl_stmt|;
operator|(
name|void
operator|)
name|strcpy
argument_list|(
name|filename
argument_list|,
literal|"xd.help"
argument_list|)
expr_stmt|;
name|popup
operator|=
name|XtCreatePopupShell
argument_list|(
literal|"popup"
argument_list|,
name|transientShellWidgetClass
argument_list|,
name|button
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|form
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"form"
argument_list|,
name|formWidgetClass
argument_list|,
name|popup
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|quit_but
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"quit_but"
argument_list|,
name|commandWidgetClass
argument_list|,
name|form
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|XtAddCallback
argument_list|(
name|quit_but
argument_list|,
name|XtNcallback
argument_list|,
name|PopdownHelp
argument_list|,
operator|(
name|XtPointer
operator|)
literal|0
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strcpy
argument_list|(
name|fullname
argument_list|,
name|dua_help_dir
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strcat
argument_list|(
name|fullname
argument_list|,
name|filename
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|file
operator|=
name|fopen
argument_list|(
name|fullname
argument_list|,
literal|"r"
argument_list|)
operator|)
condition|)
block|{
operator|(
name|void
operator|)
name|strcpy
argument_list|(
name|fullname
argument_list|,
literal|"./xd/helpdir/"
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strcat
argument_list|(
name|fullname
argument_list|,
name|filename
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|file
operator|=
name|fopen
argument_list|(
name|fullname
argument_list|,
literal|"r"
argument_list|)
operator|)
condition|)
operator|(
name|void
operator|)
name|printf
argument_list|(
literal|"Helpfile not found"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|file
operator|!=
name|NULL
condition|)
block|{
operator|(
name|void
operator|)
name|fclose
argument_list|(
name|file
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNstring
argument_list|,
name|fullname
argument_list|)
expr_stmt|;
block|}
operator|(
name|void
operator|)
name|XtCreateManagedWidget
argument_list|(
literal|"help_text"
argument_list|,
name|asciiTextWidgetClass
argument_list|,
name|form
argument_list|,
name|args
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*ARGSUSED*/
end_comment

begin_function
specifier|static
name|void
name|PopupHelp
parameter_list|(
name|button
parameter_list|,
name|client_data
parameter_list|,
name|call_data
parameter_list|)
name|Widget
name|button
decl_stmt|;
name|XtPointer
name|client_data
decl_stmt|,
name|call_data
decl_stmt|;
block|{
name|Widget
name|pop_widg
init|=
name|XtNameToWidget
argument_list|(
name|button
argument_list|,
literal|"popup"
argument_list|)
decl_stmt|;
name|Arg
name|args
index|[
literal|5
index|]
decl_stmt|;
name|Position
name|x
decl_stmt|,
name|y
decl_stmt|;
name|Cardinal
name|n
decl_stmt|;
name|XtTranslateCoords
argument_list|(
name|button
argument_list|,
operator|(
name|Position
operator|)
literal|0
argument_list|,
operator|(
name|Position
operator|)
literal|0
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|)
expr_stmt|;
name|n
operator|=
literal|0
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
name|n
index|]
argument_list|,
name|XtNx
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|n
operator|++
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
name|n
index|]
argument_list|,
name|XtNy
argument_list|,
name|y
operator|-
literal|245
argument_list|)
expr_stmt|;
name|n
operator|++
expr_stmt|;
name|XtSetValues
argument_list|(
name|pop_widg
argument_list|,
name|args
argument_list|,
name|n
argument_list|)
expr_stmt|;
name|help_popped_up
operator|=
name|TRUE
expr_stmt|;
name|XtPopup
argument_list|(
name|pop_widg
argument_list|,
name|XtGrabNone
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*ARGSUSED*/
end_comment

begin_function
specifier|static
name|void
name|PopdownHelp
parameter_list|(
name|button
parameter_list|,
name|client_data
parameter_list|,
name|call_data
parameter_list|)
name|Widget
name|button
decl_stmt|;
name|XtPointer
name|client_data
decl_stmt|,
name|call_data
decl_stmt|;
block|{
name|Widget
name|pop_widg
init|=
name|XtParent
argument_list|(
name|XtParent
argument_list|(
name|button
argument_list|)
argument_list|)
decl_stmt|;
name|help_popped_up
operator|=
name|FALSE
expr_stmt|;
name|XtPopdown
argument_list|(
name|pop_widg
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Change_Help
parameter_list|(
name|filename
parameter_list|)
name|String
name|filename
decl_stmt|;
block|{
name|Arg
name|args
index|[
literal|5
index|]
decl_stmt|;
name|FILE
modifier|*
name|file
decl_stmt|;
name|char
modifier|*
name|fullname
decl_stmt|;
specifier|static
name|char
modifier|*
name|old_pointer
init|=
literal|0
decl_stmt|;
comment|/* this gets around a problem  mine or athena widgets ? */
comment|/* does usestringinplace=false work for type = file */
comment|/*  when using asciitext widgets? */
if|if
condition|(
name|help_popped_up
condition|)
block|{
name|fullname
operator|=
name|XtMalloc
argument_list|(
name|MAXLENGTH
operator|*
sizeof|sizeof
argument_list|(
name|char
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|old_pointer
operator|!=
literal|0
condition|)
block|{
name|XtFree
argument_list|(
operator|(
name|char
operator|*
operator|)
name|old_pointer
argument_list|)
expr_stmt|;
name|old_pointer
operator|=
name|fullname
expr_stmt|;
block|}
operator|(
name|void
operator|)
name|strcpy
argument_list|(
name|fullname
argument_list|,
name|dua_help_dir
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strcat
argument_list|(
name|fullname
argument_list|,
name|filename
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|file
operator|=
name|fopen
argument_list|(
name|fullname
argument_list|,
literal|"r"
argument_list|)
operator|)
condition|)
block|{
operator|(
name|void
operator|)
name|strcpy
argument_list|(
name|fullname
argument_list|,
literal|"./Xd/helpdir/"
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strcat
argument_list|(
name|fullname
argument_list|,
name|filename
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|file
operator|=
name|fopen
argument_list|(
name|fullname
argument_list|,
literal|"r"
argument_list|)
operator|)
condition|)
operator|(
name|void
operator|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Helpfile not found\n"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|file
operator|!=
name|NULL
condition|)
block|{
operator|(
name|void
operator|)
name|fclose
argument_list|(
name|file
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNstring
argument_list|,
name|fullname
argument_list|)
expr_stmt|;
name|XtSetValues
argument_list|(
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
literal|"outer.genform.help_but.popup.form.help_text"
argument_list|)
argument_list|,
name|args
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
name|XFlush
argument_list|(
name|XtDisplay
argument_list|(
name|toplevel
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*ARGSUSED*/
end_comment

begin_function
specifier|static
name|void
name|PopupList
parameter_list|(
name|button
parameter_list|,
name|client_data
parameter_list|,
name|call_data
parameter_list|)
name|Widget
name|button
decl_stmt|;
name|XtPointer
name|client_data
decl_stmt|,
name|call_data
decl_stmt|;
block|{
name|Arg
name|args
index|[
literal|5
index|]
decl_stmt|;
name|Widget
name|popup
decl_stmt|,
name|form
decl_stmt|,
name|list_places
decl_stmt|,
name|quit_but
decl_stmt|;
name|Position
name|x
decl_stmt|,
name|y
decl_stmt|;
name|Dimension
name|width
decl_stmt|,
name|height
decl_stmt|;
name|Cardinal
name|n
decl_stmt|;
name|String
name|widget_name
init|=
literal|"outer.commandform.lookback_but.popup"
decl_stmt|;
if|if
condition|(
name|lookback_open
operator|==
name|True
condition|)
block|{
name|XtPopup
argument_list|(
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
name|widget_name
argument_list|)
argument_list|,
name|XtGrabNone
argument_list|)
expr_stmt|;
return|return;
block|}
name|n
operator|=
literal|0
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNwidth
argument_list|,
operator|&
name|width
argument_list|)
expr_stmt|;
name|n
operator|++
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|1
index|]
argument_list|,
name|XtNheight
argument_list|,
operator|&
name|height
argument_list|)
expr_stmt|;
name|n
operator|++
expr_stmt|;
name|XtGetValues
argument_list|(
name|button
argument_list|,
name|args
argument_list|,
name|n
argument_list|)
expr_stmt|;
name|XtTranslateCoords
argument_list|(
name|button
argument_list|,
call|(
name|Position
call|)
argument_list|(
name|width
operator|/
literal|2
argument_list|)
argument_list|,
call|(
name|Position
call|)
argument_list|(
name|height
operator|/
literal|2
argument_list|)
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|)
expr_stmt|;
name|n
operator|=
literal|0
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
name|n
index|]
argument_list|,
name|XtNx
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|n
operator|++
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
name|n
index|]
argument_list|,
name|XtNy
argument_list|,
name|y
argument_list|)
expr_stmt|;
name|n
operator|++
expr_stmt|;
name|popup
operator|=
name|XtCreatePopupShell
argument_list|(
literal|"popup"
argument_list|,
name|transientShellWidgetClass
argument_list|,
name|button
argument_list|,
name|args
argument_list|,
name|n
argument_list|)
expr_stmt|;
name|form
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"form"
argument_list|,
name|formWidgetClass
argument_list|,
name|popup
argument_list|,
name|args
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNlabel
argument_list|,
operator|(
name|String
operator|)
literal|"Quit"
argument_list|)
expr_stmt|;
name|quit_but
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"quit_but"
argument_list|,
name|commandWidgetClass
argument_list|,
name|form
argument_list|,
name|args
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XtAddCallback
argument_list|(
name|quit_but
argument_list|,
name|XtNcallback
argument_list|,
name|Quit_Popup
argument_list|,
operator|(
name|XtPointer
operator|)
name|form
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNlist
argument_list|,
name|lookback_list
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|1
index|]
argument_list|,
name|XtNfromVert
argument_list|,
name|quit_but
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|2
index|]
argument_list|,
name|XtNverticalList
argument_list|,
name|True
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|3
index|]
argument_list|,
name|XtNnumberStrings
argument_list|,
name|MAXLOOKBACKLENGTH
argument_list|)
expr_stmt|;
name|list_places
operator|=
name|XtCreateManagedWidget
argument_list|(
literal|"list_places"
argument_list|,
name|listWidgetClass
argument_list|,
name|form
argument_list|,
name|args
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|XtAddCallback
argument_list|(
name|list_places
argument_list|,
name|XtNcallback
argument_list|,
name|Change_Search_Area
argument_list|,
operator|(
name|XtPointer
operator|)
literal|0
argument_list|)
expr_stmt|;
name|lookback_open
operator|=
name|True
expr_stmt|;
name|XtPopup
argument_list|(
name|popup
argument_list|,
name|XtGrabNone
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Add_To_Results
parameter_list|(
name|add_this
parameter_list|)
name|String
name|add_this
decl_stmt|;
block|{
name|Arg
name|args
index|[
literal|10
index|]
decl_stmt|;
name|String
name|str
decl_stmt|;
name|char
name|new_str
index|[
literal|2000
index|]
decl_stmt|;
name|Widget
name|result_widg
init|=
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
literal|"outer.result_area"
argument_list|)
decl_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNstring
argument_list|,
operator|&
name|str
argument_list|)
expr_stmt|;
name|XtGetValues
argument_list|(
name|result_widg
argument_list|,
name|args
argument_list|,
name|ONE
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
name|str
operator|==
literal|'\0'
condition|)
operator|(
name|void
operator|)
name|strcpy
argument_list|(
name|new_str
argument_list|,
name|add_this
argument_list|)
expr_stmt|;
else|else
operator|(
name|void
operator|)
name|sprintf
argument_list|(
operator|(
name|char
operator|*
operator|)
name|new_str
argument_list|,
literal|"%s\n%s"
argument_list|,
name|str
argument_list|,
name|add_this
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNstring
argument_list|,
name|new_str
argument_list|)
expr_stmt|;
name|XtSetValues
argument_list|(
name|result_widg
argument_list|,
name|args
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|Clear_Results
parameter_list|()
block|{
name|Arg
name|args
index|[
literal|10
index|]
decl_stmt|;
name|Widget
name|result_widg
init|=
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
literal|"outer.result_area"
argument_list|)
decl_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNstring
argument_list|,
literal|"\0"
argument_list|)
expr_stmt|;
name|XtSetValues
argument_list|(
name|result_widg
argument_list|,
name|args
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_macro
name|Switch_Off_Result_Update
argument_list|()
end_macro

begin_block
block|{
name|Widget
name|result_widg
init|=
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
literal|"outer.result_area"
argument_list|)
decl_stmt|;
name|XawTextDisableRedisplay
argument_list|(
name|result_widg
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|Switch_On_Result_Update
argument_list|()
end_macro

begin_block
block|{
name|Widget
name|result_widg
init|=
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
literal|"outer.result_area"
argument_list|)
decl_stmt|;
name|XawTextEnableRedisplay
argument_list|(
name|result_widg
argument_list|)
expr_stmt|;
block|}
end_block

begin_comment
comment|/*ARGSUSED*/
end_comment

begin_function
specifier|static
name|void
name|Search
parameter_list|(
name|w
parameter_list|,
name|client_data
parameter_list|,
name|call_data
parameter_list|)
name|Widget
name|w
decl_stmt|;
name|XtPointer
name|client_data
decl_stmt|,
name|call_data
decl_stmt|;
block|{
name|Arg
name|args
index|[
literal|10
index|]
decl_stmt|;
name|int
name|n
decl_stmt|,
name|numb
decl_stmt|;
name|String
name|str
decl_stmt|;
name|String
name|string
decl_stmt|;
name|Widget
name|list_widg
init|=
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
literal|"outer.view_list.list_area"
argument_list|)
decl_stmt|;
name|Widget
name|widg
init|=
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
literal|"outer.inputform.for_form.search_for"
argument_list|)
decl_stmt|;
name|Clear_Results
argument_list|()
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNstring
argument_list|,
operator|&
name|str
argument_list|)
expr_stmt|;
name|XtGetValues
argument_list|(
name|widg
argument_list|,
name|args
argument_list|,
name|ONE
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strcpy
argument_list|(
name|mvalue
argument_list|,
name|str
argument_list|)
expr_stmt|;
name|srch_start
argument_list|()
expr_stmt|;
name|xprint
argument_list|(
literal|"Search completed"
argument_list|)
expr_stmt|;
name|showseq
operator|=
name|dnseq
expr_stmt|;
name|element_number
operator|=
name|entry_number
expr_stmt|;
name|numb
operator|=
name|element_number
expr_stmt|;
if|if
condition|(
name|numb
operator|>=
name|MAXRESULTLISTLENGTH
condition|)
name|numb
operator|=
name|MAXRESULTLISTLENGTH
operator|-
literal|1
expr_stmt|;
for|for
control|(
name|n
operator|=
literal|0
init|;
name|n
operator|<
name|numb
condition|;
name|n
operator|++
control|)
block|{
name|string
operator|=
name|get_from_seq
argument_list|(
name|n
operator|+
literal|1
argument_list|,
name|showseq
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strcpy
argument_list|(
name|result_list
index|[
name|n
index|]
argument_list|,
name|string
argument_list|)
expr_stmt|;
block|}
for|for
control|(
init|;
name|n
operator|<
name|MAXRESULTLISTLENGTH
condition|;
name|n
operator|++
control|)
block|{
operator|(
name|void
operator|)
name|strcpy
argument_list|(
name|result_list
index|[
name|n
index|]
argument_list|,
literal|""
argument_list|)
expr_stmt|;
block|}
name|XawListChange
argument_list|(
name|list_widg
argument_list|,
name|result_list
argument_list|,
name|MAXRESULTLISTLENGTH
argument_list|,
literal|0
argument_list|,
name|True
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*ARGSUSED*/
end_comment

begin_function
specifier|static
name|void
name|List
parameter_list|(
name|w
parameter_list|,
name|client_data
parameter_list|,
name|call_data
parameter_list|)
name|Widget
name|w
decl_stmt|;
name|XtPointer
name|client_data
decl_stmt|,
name|call_data
decl_stmt|;
block|{
name|String
name|string
decl_stmt|;
name|int
name|n
decl_stmt|,
name|numb
decl_stmt|;
name|Arg
name|args
index|[
literal|10
index|]
decl_stmt|;
name|Widget
name|list_widg
init|=
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
literal|"outer.view_list.list_area"
argument_list|)
decl_stmt|;
name|Widget
name|top_widg
init|=
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
literal|"outer"
argument_list|)
decl_stmt|;
name|Display
modifier|*
name|this_display
init|=
name|XtDisplay
argument_list|(
name|top_widg
argument_list|)
decl_stmt|;
name|Cursor
name|time_cur
init|=
name|XCreateFontCursor
argument_list|(
name|this_display
argument_list|,
name|XC_watch
argument_list|)
decl_stmt|;
name|Cursor
name|normal_cur
decl_stmt|;
name|Clear_Results
argument_list|()
expr_stmt|;
operator|(
name|void
operator|)
name|strcpy
argument_list|(
name|mvalue
argument_list|,
literal|""
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNcursor
argument_list|,
operator|&
name|normal_cur
argument_list|)
expr_stmt|;
name|XtGetValues
argument_list|(
name|top_widg
argument_list|,
name|args
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNcursor
argument_list|,
name|time_cur
argument_list|)
expr_stmt|;
name|XtSetValues
argument_list|(
name|top_widg
argument_list|,
name|args
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XFlush
argument_list|(
name|this_display
argument_list|)
expr_stmt|;
name|srch_start
argument_list|()
expr_stmt|;
name|set_default_type
argument_list|()
expr_stmt|;
name|showseq
operator|=
name|dnseq
expr_stmt|;
name|element_number
operator|=
name|entry_number
expr_stmt|;
name|numb
operator|=
name|element_number
expr_stmt|;
if|if
condition|(
name|numb
operator|>=
name|MAXRESULTLISTLENGTH
condition|)
name|numb
operator|=
name|MAXRESULTLISTLENGTH
operator|-
literal|1
expr_stmt|;
for|for
control|(
name|n
operator|=
literal|0
init|;
name|n
operator|<
name|numb
condition|;
name|n
operator|++
control|)
block|{
name|string
operator|=
name|get_from_seq
argument_list|(
name|n
operator|+
literal|1
argument_list|,
name|showseq
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strcpy
argument_list|(
name|result_list
index|[
name|n
index|]
argument_list|,
name|string
argument_list|)
expr_stmt|;
block|}
for|for
control|(
init|;
name|n
operator|<
name|MAXRESULTLISTLENGTH
condition|;
name|n
operator|++
control|)
block|{
operator|(
name|void
operator|)
name|strcpy
argument_list|(
name|result_list
index|[
name|n
index|]
argument_list|,
literal|""
argument_list|)
expr_stmt|;
block|}
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNcursor
argument_list|,
name|normal_cur
argument_list|)
expr_stmt|;
name|XtSetValues
argument_list|(
name|top_widg
argument_list|,
name|args
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|XawListChange
argument_list|(
name|list_widg
argument_list|,
name|result_list
argument_list|,
name|MAXRESULTLISTLENGTH
argument_list|,
literal|0
argument_list|,
name|True
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*ARGSUSED*/
end_comment

begin_function
specifier|static
name|void
name|Change_Type
parameter_list|(
name|w
parameter_list|,
name|client_data
parameter_list|,
name|call_data
parameter_list|)
name|Widget
name|w
decl_stmt|;
name|XtPointer
name|client_data
decl_stmt|,
name|call_data
decl_stmt|;
block|{
name|typeindx
operator|=
operator|(
name|unsigned
name|int
operator|)
name|client_data
expr_stmt|;
name|Set_Search_Type
argument_list|(
name|filttype
index|[
operator|(
name|int
operator|)
name|client_data
index|]
argument_list|)
expr_stmt|;
block|}
end_function

begin_macro
name|Set_Search_Type
argument_list|(
argument|string
argument_list|)
end_macro

begin_decl_stmt
name|String
name|string
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|Arg
name|args
index|[
literal|5
index|]
decl_stmt|;
name|Widget
name|search_w
init|=
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
literal|"outer.inputform.type_form.search_type"
argument_list|)
decl_stmt|;
name|Widget
name|typebut_w
init|=
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
literal|"outer.inputform.type_form.type_but"
argument_list|)
decl_stmt|;
name|Widget
name|typemenu_w
init|=
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
literal|"outer.inputform.type_form.type_but.menu"
argument_list|)
decl_stmt|;
name|XtDestroyWidget
argument_list|(
name|typemenu_w
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|create_type_menu
argument_list|(
name|typebut_w
argument_list|)
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNstring
argument_list|,
name|string
argument_list|)
expr_stmt|;
name|XtSetValues
argument_list|(
name|search_w
argument_list|,
name|args
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
end_block

begin_comment
comment|/*ARGSUSED*/
end_comment

begin_function
specifier|static
name|void
name|Change_Search_Area
parameter_list|(
name|w
parameter_list|,
name|client_data
parameter_list|,
name|call_data
parameter_list|)
name|Widget
name|w
decl_stmt|;
name|XtPointer
name|client_data
decl_stmt|,
name|call_data
decl_stmt|;
block|{
name|XawListReturnStruct
modifier|*
name|item
init|=
operator|(
name|XawListReturnStruct
operator|*
operator|)
name|call_data
decl_stmt|;
name|Clear_Results
argument_list|()
expr_stmt|;
if|if
condition|(
operator|(
name|strlen
argument_list|(
name|item
operator|->
name|string
argument_list|)
operator|!=
literal|0
operator|)
operator|&&
operator|(
name|strcmp
argument_list|(
name|item
operator|->
name|string
argument_list|,
name|NOHISTORY
argument_list|)
operator|)
condition|)
block|{
name|Set_Search_Area
argument_list|(
name|item
operator|->
name|string
argument_list|)
expr_stmt|;
name|rd_start
argument_list|()
expr_stmt|;
name|add_to_lookback
argument_list|(
name|base_path
argument_list|)
expr_stmt|;
block|}
name|XawListUnhighlight
argument_list|(
name|w
argument_list|)
expr_stmt|;
block|}
end_function

begin_macro
name|Set_Search_Area
argument_list|(
argument|string
argument_list|)
end_macro

begin_decl_stmt
name|String
name|string
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|Arg
name|args
index|[
literal|10
index|]
decl_stmt|;
name|String
name|widget_name
init|=
literal|"outer.inputform.area_form.search_area"
decl_stmt|;
name|Widget
name|search_w
init|=
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
name|widget_name
argument_list|)
decl_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNstring
argument_list|,
name|string
argument_list|)
expr_stmt|;
name|XtSetValues
argument_list|(
name|search_w
argument_list|,
name|args
argument_list|,
literal|1
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|strcpy
argument_list|(
name|base_path
argument_list|,
name|string
argument_list|)
expr_stmt|;
name|set_default_type
argument_list|()
expr_stmt|;
block|}
end_block

begin_comment
comment|/*ARGSUSED*/
end_comment

begin_function
specifier|static
name|void
name|Quit_Popup
parameter_list|(
name|widget
parameter_list|,
name|client_data
parameter_list|,
name|call_data
parameter_list|)
name|Widget
name|widget
decl_stmt|;
name|XtPointer
name|client_data
decl_stmt|,
name|call_data
decl_stmt|;
block|{
name|Widget
name|popup
init|=
name|XtParent
argument_list|(
operator|(
name|Widget
operator|)
name|client_data
argument_list|)
decl_stmt|;
if|if
condition|(
name|lookback_open
operator|==
name|True
condition|)
if|if
condition|(
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
literal|"outer.commandform.lookback_but.popup.form.quit_but"
argument_list|)
operator|==
name|widget
condition|)
name|lookback_open
operator|=
name|False
expr_stmt|;
name|XtDestroyWidget
argument_list|(
name|popup
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|xprint
parameter_list|(
name|str
parameter_list|)
name|String
name|str
decl_stmt|;
block|{
name|Add_To_Results
argument_list|(
name|str
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*ARGSUSED*/
end_comment

begin_function
specifier|static
name|void
name|widen_search
parameter_list|()
block|{
name|Arg
name|args
index|[
literal|10
index|]
decl_stmt|;
name|String
name|widget_name
init|=
literal|"outer.inputform.area_form.search_area"
decl_stmt|;
name|Widget
name|search_w
init|=
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
name|widget_name
argument_list|)
decl_stmt|;
name|widen
argument_list|()
expr_stmt|;
name|XtSetArg
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|,
name|XtNstring
argument_list|,
name|base_path
argument_list|)
expr_stmt|;
name|XtSetValues
argument_list|(
name|search_w
argument_list|,
name|args
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|add_to_lookback
parameter_list|(
name|addthis
parameter_list|)
name|String
name|addthis
decl_stmt|;
block|{
name|int
name|count
decl_stmt|;
name|String
name|widget_name
init|=
literal|"outer.commandform.lookback_but.popup.form.list_places"
decl_stmt|;
name|Widget
name|list_w
decl_stmt|;
for|for
control|(
name|count
operator|=
literal|0
init|;
name|count
operator|<
name|MAXLOOKBACKLENGTH
condition|;
name|count
operator|++
control|)
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|lookback_list
index|[
name|count
index|]
argument_list|,
name|addthis
argument_list|)
condition|)
return|return;
comment|/* no duplicates thankyou! */
for|for
control|(
name|count
operator|=
literal|0
init|;
name|count
operator|<
name|MAXLOOKBACKLENGTH
operator|-
literal|1
condition|;
control|)
block|{
operator|(
name|void
operator|)
name|strcpy
argument_list|(
name|lookback_list
index|[
name|count
index|]
argument_list|,
name|lookback_list
index|[
name|count
operator|+
literal|1
index|]
argument_list|)
expr_stmt|;
name|count
operator|++
expr_stmt|;
block|}
operator|(
name|void
operator|)
name|strcpy
argument_list|(
name|lookback_list
index|[
name|count
operator|++
index|]
argument_list|,
name|addthis
argument_list|)
expr_stmt|;
if|if
condition|(
name|lookback_open
operator|==
name|True
condition|)
block|{
name|list_w
operator|=
name|XtNameToWidget
argument_list|(
name|toplevel
argument_list|,
name|widget_name
argument_list|)
expr_stmt|;
name|XawListChange
argument_list|(
name|list_w
argument_list|,
name|lookback_list
argument_list|,
name|MAXLOOKBACKLENGTH
argument_list|,
literal|0
argument_list|,
name|True
argument_list|)
expr_stmt|;
block|}
name|XFlush
argument_list|(
name|XtDisplay
argument_list|(
name|toplevel
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

