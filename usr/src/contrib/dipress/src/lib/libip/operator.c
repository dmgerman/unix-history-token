begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  *  Interpress utilities  *  *  Written for Xerox Corporation by William LeFebvre  *  24-May-1984  *  * Copyright (c) 1984, 1985 Xerox Corp.  *  * HISTORY  * 15-Jan-86  lee at Xerox, WRC  *	Removed vax dependencies.  *  *	29-apr-85  ed flint	add conditional compilation for vax-11 c (vms)  */
end_comment

begin_comment
comment|/*  *  Subroutines to help build interpress files:  *  *  operator interface level - these routines call routines at the literal  *			       interface level to provide an easy way to  *			       write operators along with their parameters.  */
end_comment

begin_include
include|#
directive|include
file|"iptokens.h"
end_include

begin_include
include|#
directive|include
file|"literal.h"
end_include

begin_include
include|#
directive|include
file|"operator.h"
end_include

begin_function_decl
name|char
modifier|*
name|index
parameter_list|()
function_decl|;
end_function_decl

begin_macro
name|op_i
argument_list|(
argument|opcode
argument_list|,
argument|i
argument_list|)
end_macro

begin_decl_stmt
name|int
name|opcode
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|long
name|i
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|AppendInteger
argument_list|(
name|i
argument_list|)
expr_stmt|;
name|AppendOp
argument_list|(
name|opcode
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|op_n
argument_list|(
argument|opcode
argument_list|,
argument|n
argument_list|)
end_macro

begin_decl_stmt
name|int
name|opcode
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|double
name|n
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|AppendNumber
argument_list|(
name|n
argument_list|)
expr_stmt|;
name|AppendOp
argument_list|(
name|opcode
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|op_ii
argument_list|(
argument|opcode
argument_list|,
argument|i1
argument_list|,
argument|i2
argument_list|)
end_macro

begin_decl_stmt
name|int
name|opcode
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|long
name|i1
decl_stmt|,
name|i2
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|AppendInteger
argument_list|(
name|i1
argument_list|)
expr_stmt|;
name|AppendInteger
argument_list|(
name|i2
argument_list|)
expr_stmt|;
name|AppendOp
argument_list|(
name|opcode
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|op_ni
argument_list|(
argument|opcode
argument_list|,
argument|n
argument_list|,
argument|i
argument_list|)
end_macro

begin_decl_stmt
name|int
name|opcode
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|double
name|n
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|long
name|i
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|AppendNumber
argument_list|(
name|n
argument_list|)
expr_stmt|;
name|AppendInteger
argument_list|(
name|i
argument_list|)
expr_stmt|;
name|AppendOp
argument_list|(
name|opcode
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|op_nn
argument_list|(
argument|opcode
argument_list|,
argument|n1
argument_list|,
argument|n2
argument_list|)
end_macro

begin_decl_stmt
name|int
name|opcode
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|double
name|n1
decl_stmt|,
name|n2
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|AppendNumber
argument_list|(
name|n1
argument_list|)
expr_stmt|;
name|AppendNumber
argument_list|(
name|n2
argument_list|)
expr_stmt|;
name|AppendOp
argument_list|(
name|opcode
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|op_nnnn
argument_list|(
argument|opcode
argument_list|,
argument|n1
argument_list|,
argument|n2
argument_list|,
argument|n3
argument_list|,
argument|n4
argument_list|)
end_macro

begin_decl_stmt
name|int
name|opcode
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|double
name|n1
decl_stmt|,
name|n2
decl_stmt|,
name|n3
decl_stmt|,
name|n4
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|AppendNumber
argument_list|(
name|n1
argument_list|)
expr_stmt|;
name|AppendNumber
argument_list|(
name|n2
argument_list|)
expr_stmt|;
name|AppendNumber
argument_list|(
name|n3
argument_list|)
expr_stmt|;
name|AppendNumber
argument_list|(
name|n4
argument_list|)
expr_stmt|;
name|AppendOp
argument_list|(
name|opcode
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|op_nnnnnn
argument_list|(
argument|opcode
argument_list|,
argument|n1
argument_list|,
argument|n2
argument_list|,
argument|n3
argument_list|,
argument|n4
argument_list|,
argument|n5
argument_list|,
argument|n6
argument_list|)
end_macro

begin_decl_stmt
name|int
name|opcode
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|double
name|n1
decl_stmt|,
name|n2
decl_stmt|,
name|n3
decl_stmt|,
name|n4
decl_stmt|,
name|n5
decl_stmt|,
name|n6
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|AppendNumber
argument_list|(
name|n1
argument_list|)
expr_stmt|;
name|AppendNumber
argument_list|(
name|n2
argument_list|)
expr_stmt|;
name|AppendNumber
argument_list|(
name|n3
argument_list|)
expr_stmt|;
name|AppendNumber
argument_list|(
name|n4
argument_list|)
expr_stmt|;
name|AppendNumber
argument_list|(
name|n5
argument_list|)
expr_stmt|;
name|AppendNumber
argument_list|(
name|n6
argument_list|)
expr_stmt|;
name|AppendOp
argument_list|(
name|opcode
argument_list|)
expr_stmt|;
block|}
end_block

begin_comment
comment|/*  *  Here are some extra and useful goodies   */
end_comment

begin_macro
name|SetupFont
argument_list|(
argument|name
argument_list|,
argument|size
argument_list|,
argument|frame_index
argument_list|)
end_macro

begin_decl_stmt
name|char
modifier|*
name|name
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|double
name|size
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|frame_index
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|int
name|i
init|=
literal|1
decl_stmt|;
name|char
modifier|*
name|slashp
decl_stmt|;
name|char
modifier|*
name|namep
init|=
name|name
decl_stmt|;
comment|/* make heirarchical name vector using slash as separator */
ifdef|#
directive|ifdef
name|vax11c
while|while
condition|(
operator|(
name|slashp
operator|=
name|strchr
argument_list|(
name|namep
argument_list|,
literal|'/'
argument_list|)
operator|)
operator|!=
literal|0
condition|)
else|#
directive|else
while|while
condition|(
operator|(
name|slashp
operator|=
name|index
argument_list|(
name|namep
argument_list|,
literal|'/'
argument_list|)
operator|)
operator|!=
literal|0
condition|)
endif|#
directive|endif
block|{
operator|*
name|slashp
operator|=
literal|'\0'
expr_stmt|;
name|AppendIdentifier
argument_list|(
name|namep
argument_list|)
expr_stmt|;
name|namep
operator|=
name|slashp
operator|+
literal|1
expr_stmt|;
operator|*
name|slashp
operator|=
literal|'/'
expr_stmt|;
name|i
operator|++
expr_stmt|;
block|}
name|AppendIdentifier
argument_list|(
name|namep
argument_list|)
expr_stmt|;
name|AppendInteger
argument_list|(
operator|(
name|long
operator|)
name|i
argument_list|)
expr_stmt|;
name|AppendOp
argument_list|(
name|OP_makevec
argument_list|)
expr_stmt|;
comment|/* find the font */
name|AppendOp
argument_list|(
name|OP_findfont
argument_list|)
expr_stmt|;
comment|/* build a scaling transform */
name|Scale
argument_list|(
name|size
argument_list|)
expr_stmt|;
comment|/* apply the transform to the font */
name|AppendOp
argument_list|(
name|OP_modifyfont
argument_list|)
expr_stmt|;
comment|/* set the frame index of choice */
name|AppendInteger
argument_list|(
operator|(
name|long
operator|)
name|frame_index
argument_list|)
expr_stmt|;
name|AppendOp
argument_list|(
name|OP_fset
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|ShowString
argument_list|(
argument|string
argument_list|)
end_macro

begin_decl_stmt
name|char
modifier|*
name|string
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|AppendString
argument_list|(
name|string
argument_list|)
expr_stmt|;
name|AppendOp
argument_list|(
name|OP_show
argument_list|)
expr_stmt|;
block|}
end_block

end_unit

