begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* xdr_regs.c - xdr routines for 68k registers */
end_comment

begin_comment
comment|/* Copyright 1984, 1985, 1986, 1987, 1988, 1989, 1992 Free Software Foundation, Inc.     This code was donated by Wind River Systems, Inc. */
end_comment

begin_comment
comment|/* DESCRIPTION This module contains the eXternal Data Representation (XDR) routines for the GDB interface for VxWorks. */
end_comment

begin_include
include|#
directive|include
file|"vxWorks.h"
end_include

begin_include
include|#
directive|include
file|<rpc/rpc.h>
end_include

begin_include
include|#
directive|include
file|"reg.h"
end_include

begin_include
include|#
directive|include
file|"xdr_regs.h"
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|I80960
end_ifdef

begin_comment
comment|/******************************************************************************* * * xdr_regs - xdr routine for i960 registers */
end_comment

begin_function
name|bool_t
name|xdr_regs
parameter_list|(
name|xdrs
parameter_list|,
name|objp
parameter_list|)
name|XDR
modifier|*
name|xdrs
decl_stmt|;
name|struct
name|regs
modifier|*
name|objp
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|xdr_opaque
argument_list|(
name|xdrs
argument_list|,
operator|(
name|char
operator|*
operator|)
name|objp
operator|->
name|r_lreg
argument_list|,
literal|16
operator|*
sizeof|sizeof
argument_list|(
name|int
argument_list|)
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_opaque
argument_list|(
name|xdrs
argument_list|,
operator|(
name|char
operator|*
operator|)
name|objp
operator|->
name|r_greg
argument_list|,
literal|16
operator|*
sizeof|sizeof
argument_list|(
name|int
argument_list|)
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_opaque
argument_list|(
name|xdrs
argument_list|,
operator|(
name|char
operator|*
operator|)
operator|&
name|objp
operator|->
name|r_pcw
argument_list|,
sizeof|sizeof
argument_list|(
name|int
argument_list|)
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_opaque
argument_list|(
name|xdrs
argument_list|,
operator|(
name|char
operator|*
operator|)
operator|&
name|objp
operator|->
name|r_acw
argument_list|,
sizeof|sizeof
argument_list|(
name|int
argument_list|)
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_opaque
argument_list|(
name|xdrs
argument_list|,
operator|(
name|char
operator|*
operator|)
operator|&
name|objp
operator|->
name|r_tcw
argument_list|,
sizeof|sizeof
argument_list|(
name|int
argument_list|)
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
return|return
operator|(
name|TRUE
operator|)
return|;
block|}
end_function

begin_comment
comment|/******************************************************************************* * * xdr_fp_status - xdr routine for i960 floating point registers */
end_comment

begin_function
name|bool_t
name|xdr_fp_status
parameter_list|(
name|xdrs
parameter_list|,
name|objp
parameter_list|)
name|XDR
modifier|*
name|xdrs
decl_stmt|;
name|struct
name|fp_status
modifier|*
name|objp
decl_stmt|;
block|{
name|unsigned
name|int
name|size
init|=
literal|4
operator|*
name|FP_REG_SIZE
decl_stmt|;
comment|/* We use xdr_bytes to indicate how many bytes of FP regs there are! */
if|if
condition|(
operator|!
name|xdr_bytes
argument_list|(
name|xdrs
argument_list|,
operator|(
name|char
operator|*
operator|)
name|objp
operator|->
name|fps_regs
argument_list|,
operator|&
name|size
argument_list|,
literal|4
operator|*
name|FP_REG_SIZE
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
return|return
operator|(
name|TRUE
operator|)
return|;
block|}
end_function

begin_comment
comment|/******************************************************************************* * * xdr_ext_fp - xdr for a single fp register */
end_comment

begin_function
name|bool_t
name|xdr_ext_fp
parameter_list|(
name|xdrs
parameter_list|,
name|objp
parameter_list|)
name|XDR
modifier|*
name|xdrs
decl_stmt|;
name|char
modifier|*
name|objp
decl_stmt|;
block|{
name|unsigned
name|int
name|size
init|=
name|FP_REG_SIZE
decl_stmt|;
if|if
condition|(
operator|!
name|xdr_bytes
argument_list|(
name|xdrs
argument_list|,
name|objp
argument_list|,
operator|&
name|size
argument_list|,
name|FP_REG_SIZE
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
return|return
operator|(
name|TRUE
operator|)
return|;
block|}
end_function

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* Must be 68K if it isn't i960 -- for now.  FIXME!  */
end_comment

begin_comment
comment|/******************************************************************************* * * xdr_regs - xdr routine for 68k registers */
end_comment

begin_function
name|bool_t
name|xdr_regs
parameter_list|(
name|xdrs
parameter_list|,
name|objp
parameter_list|)
name|XDR
modifier|*
name|xdrs
decl_stmt|;
name|struct
name|regs
modifier|*
name|objp
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|xdr_opaque
argument_list|(
name|xdrs
argument_list|,
operator|(
name|char
operator|*
operator|)
name|objp
operator|->
name|r_dreg
argument_list|,
literal|8
operator|*
sizeof|sizeof
argument_list|(
name|int
argument_list|)
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_opaque
argument_list|(
name|xdrs
argument_list|,
operator|(
name|char
operator|*
operator|)
name|objp
operator|->
name|r_areg
argument_list|,
literal|8
operator|*
sizeof|sizeof
argument_list|(
name|int
argument_list|)
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_opaque
argument_list|(
name|xdrs
argument_list|,
operator|(
name|char
operator|*
operator|)
operator|&
name|objp
operator|->
name|r_sr
argument_list|,
sizeof|sizeof
argument_list|(
name|int
argument_list|)
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_opaque
argument_list|(
name|xdrs
argument_list|,
operator|(
name|char
operator|*
operator|)
operator|&
name|objp
operator|->
name|r_pc
argument_list|,
sizeof|sizeof
argument_list|(
name|int
argument_list|)
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
return|return
operator|(
name|TRUE
operator|)
return|;
block|}
end_function

begin_comment
comment|/******************************************************************************* * * xdr_ext_fp - xdr for a single fp register */
end_comment

begin_function
name|bool_t
name|xdr_ext_fp
parameter_list|(
name|xdrs
parameter_list|,
name|objp
parameter_list|)
name|XDR
modifier|*
name|xdrs
decl_stmt|;
name|ext_fp
modifier|*
name|objp
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|xdr_vector
argument_list|(
name|xdrs
argument_list|,
operator|(
name|char
operator|*
operator|)
name|objp
operator|->
name|fp
argument_list|,
literal|3
argument_list|,
sizeof|sizeof
argument_list|(
name|int
argument_list|)
argument_list|,
name|xdr_int
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
return|return
operator|(
name|TRUE
operator|)
return|;
block|}
end_function

begin_comment
comment|/******************************************************************************* * * xdr_fp_status - xdr routine for floating point registers */
end_comment

begin_function
name|bool_t
name|xdr_fp_status
parameter_list|(
name|xdrs
parameter_list|,
name|objp
parameter_list|)
name|XDR
modifier|*
name|xdrs
decl_stmt|;
name|struct
name|fp_status
modifier|*
name|objp
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|xdr_vector
argument_list|(
name|xdrs
argument_list|,
operator|(
name|char
operator|*
operator|)
name|objp
operator|->
name|fps_regs
argument_list|,
literal|8
argument_list|,
sizeof|sizeof
argument_list|(
name|ext_fp
argument_list|)
argument_list|,
name|xdr_ext_fp
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fps_control
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fps_status
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fps_iaddr
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fps_code
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fps_flags
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
return|return
operator|(
name|TRUE
operator|)
return|;
block|}
end_function

begin_comment
comment|/******************************************************************************* * * xdr_fpa_status - xdr for fpa status */
end_comment

begin_function
name|bool_t
name|xdr_fpa_status
parameter_list|(
name|xdrs
parameter_list|,
name|objp
parameter_list|)
name|XDR
modifier|*
name|xdrs
decl_stmt|;
name|struct
name|fpa_status
modifier|*
name|objp
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|xdr_u_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fpas_state
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_u_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fpas_imask
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_u_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fpas_load_ptr
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_u_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fpas_ierr
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_u_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fpas_act_instr
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_u_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fpas_nxt_instr
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_u_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fpas_act_d1half
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_u_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fpas_act_d2half
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_u_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fpas_nxt_d1half
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_u_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fpas_nxt_d2half
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_u_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fpas_mode3_0
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_u_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fpas_wstatus
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
return|return
operator|(
name|TRUE
operator|)
return|;
block|}
end_function

begin_comment
comment|/******************************************************************************* * * xdr_fpa_long - xdr for fpa data register */
end_comment

begin_function
name|bool_t
name|xdr_fpa_long
parameter_list|(
name|xdrs
parameter_list|,
name|objp
parameter_list|)
name|XDR
modifier|*
name|xdrs
decl_stmt|;
name|fpa_long
modifier|*
name|objp
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|xdr_vector
argument_list|(
name|xdrs
argument_list|,
operator|(
name|char
operator|*
operator|)
name|objp
operator|->
name|fpl_data
argument_list|,
literal|2
argument_list|,
sizeof|sizeof
argument_list|(
name|int
argument_list|)
argument_list|,
name|xdr_int
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
return|return
operator|(
name|TRUE
operator|)
return|;
block|}
end_function

begin_comment
comment|/******************************************************************************* * * xdr_fpa_regs - xdr for fpa_regs  */
end_comment

begin_function
name|bool_t
name|xdr_fpa_regs
parameter_list|(
name|xdrs
parameter_list|,
name|objp
parameter_list|)
name|XDR
modifier|*
name|xdrs
decl_stmt|;
name|struct
name|fpa_regs
modifier|*
name|objp
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|xdr_u_int
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fpar_flags
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_fpa_status
argument_list|(
name|xdrs
argument_list|,
operator|&
name|objp
operator|->
name|fpar_status
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
operator|!
name|xdr_vector
argument_list|(
name|xdrs
argument_list|,
operator|(
name|char
operator|*
operator|)
name|objp
operator|->
name|fpar_data
argument_list|,
name|FPA_NDATA_REGS
argument_list|,
sizeof|sizeof
argument_list|(
name|fpa_long
argument_list|)
argument_list|,
name|xdr_fpa_long
argument_list|)
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
return|return
operator|(
name|TRUE
operator|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* I80960 */
end_comment

end_unit

