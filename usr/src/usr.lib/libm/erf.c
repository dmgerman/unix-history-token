begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*	@(#)erf.c	4.1	12/25/82	*/
end_comment

begin_comment
comment|/* 	C program for floating point error function  	erf(x) returns the error function of its argument 	erfc(x) returns 1.0-erf(x)  	erf(x) is defined by 	${2 over sqrt(pi)} int from 0 to x e sup {-t sup 2} dt$  	the entry for erfc is provided because of the 	extreme loss of relative accuracy if erf(x) is 	called for large x and the result subtracted 	from 1. (e.g. for x= 10, 12 places are lost).  	There are no error returns.  	Calls exp.  	Coefficients for large x are #5667 from Hart& Cheney (18.72D). */
end_comment

begin_define
define|#
directive|define
name|M
value|7
end_define

begin_define
define|#
directive|define
name|N
value|9
end_define

begin_decl_stmt
name|int
name|errno
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|torp
init|=
literal|1.1283791670955125738961589031
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p1
index|[]
init|=
block|{
literal|0.804373630960840172832162e5
block|,
literal|0.740407142710151470082064e4
block|,
literal|0.301782788536507577809226e4
block|,
literal|0.380140318123903008244444e2
block|,
literal|0.143383842191748205576712e2
block|,
operator|-
literal|.288805137207594084924010e0
block|,
literal|0.007547728033418631287834e0
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|q1
index|[]
init|=
block|{
literal|0.804373630960840172826266e5
block|,
literal|0.342165257924628539769006e5
block|,
literal|0.637960017324428279487120e4
block|,
literal|0.658070155459240506326937e3
block|,
literal|0.380190713951939403753468e2
block|,
literal|0.100000000000000000000000e1
block|,
literal|0.0
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p2
index|[]
init|=
block|{
literal|0.18263348842295112592168999e4
block|,
literal|0.28980293292167655611275846e4
block|,
literal|0.2320439590251635247384768711e4
block|,
literal|0.1143262070703886173606073338e4
block|,
literal|0.3685196154710010637133875746e3
block|,
literal|0.7708161730368428609781633646e2
block|,
literal|0.9675807882987265400604202961e1
block|,
literal|0.5641877825507397413087057563e0
block|,
literal|0.0
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|q2
index|[]
init|=
block|{
literal|0.18263348842295112595576438e4
block|,
literal|0.495882756472114071495438422e4
block|,
literal|0.60895424232724435504633068e4
block|,
literal|0.4429612803883682726711528526e4
block|,
literal|0.2094384367789539593790281779e4
block|,
literal|0.6617361207107653469211984771e3
block|,
literal|0.1371255960500622202878443578e3
block|,
literal|0.1714980943627607849376131193e2
block|,
literal|1.0
block|, }
decl_stmt|;
end_decl_stmt

begin_function
name|double
name|erf
parameter_list|(
name|arg
parameter_list|)
name|double
name|arg
decl_stmt|;
block|{
name|double
name|erfc
parameter_list|()
function_decl|;
name|int
name|sign
decl_stmt|;
name|double
name|argsq
decl_stmt|;
name|double
name|d
decl_stmt|,
name|n
decl_stmt|;
name|int
name|i
decl_stmt|;
name|errno
operator|=
literal|0
expr_stmt|;
name|sign
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|arg
operator|<
literal|0.
condition|)
block|{
name|arg
operator|=
operator|-
name|arg
expr_stmt|;
name|sign
operator|=
operator|-
literal|1
expr_stmt|;
block|}
if|if
condition|(
name|arg
operator|<
literal|0.5
condition|)
block|{
name|argsq
operator|=
name|arg
operator|*
name|arg
expr_stmt|;
for|for
control|(
name|n
operator|=
literal|0
operator|,
name|d
operator|=
literal|0
operator|,
name|i
operator|=
name|M
operator|-
literal|1
init|;
name|i
operator|>=
literal|0
condition|;
name|i
operator|--
control|)
block|{
name|n
operator|=
name|n
operator|*
name|argsq
operator|+
name|p1
index|[
name|i
index|]
expr_stmt|;
name|d
operator|=
name|d
operator|*
name|argsq
operator|+
name|q1
index|[
name|i
index|]
expr_stmt|;
block|}
return|return
operator|(
name|sign
operator|*
name|torp
operator|*
name|arg
operator|*
name|n
operator|/
name|d
operator|)
return|;
block|}
if|if
condition|(
name|arg
operator|>=
literal|10.
condition|)
return|return
operator|(
name|sign
operator|*
literal|1.
operator|)
return|;
return|return
operator|(
name|sign
operator|*
operator|(
literal|1.
operator|-
name|erfc
argument_list|(
name|arg
argument_list|)
operator|)
operator|)
return|;
block|}
end_function

begin_function
name|double
name|erfc
parameter_list|(
name|arg
parameter_list|)
name|double
name|arg
decl_stmt|;
block|{
name|double
name|erf
parameter_list|()
function_decl|;
name|double
name|exp
parameter_list|()
function_decl|;
name|double
name|n
decl_stmt|,
name|d
decl_stmt|;
name|int
name|i
decl_stmt|;
name|errno
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|arg
operator|<
literal|0.
condition|)
return|return
operator|(
literal|2.
operator|-
name|erfc
argument_list|(
operator|-
name|arg
argument_list|)
operator|)
return|;
comment|/* 	if(arg< 0.5) 		return(1. - erf(arg)); */
if|if
condition|(
name|arg
operator|>=
literal|10.
condition|)
return|return
operator|(
literal|0.
operator|)
return|;
for|for
control|(
name|n
operator|=
literal|0
operator|,
name|d
operator|=
literal|0
operator|,
name|i
operator|=
name|N
operator|-
literal|1
init|;
name|i
operator|>=
literal|0
condition|;
name|i
operator|--
control|)
block|{
name|n
operator|=
name|n
operator|*
name|arg
operator|+
name|p2
index|[
name|i
index|]
expr_stmt|;
name|d
operator|=
name|d
operator|*
name|arg
operator|+
name|q2
index|[
name|i
index|]
expr_stmt|;
block|}
return|return
operator|(
name|exp
argument_list|(
operator|-
name|arg
operator|*
name|arg
argument_list|)
operator|*
name|n
operator|/
name|d
operator|)
return|;
block|}
end_function

end_unit

