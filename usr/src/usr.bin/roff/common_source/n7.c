begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
name|sccsid
index|[]
init|=
literal|"@(#)n7.c	4.3 1/5/88"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
endif|lint
end_endif

begin_include
include|#
directive|include
file|"tdef.h"
end_include

begin_decl_stmt
specifier|extern
include|#
directive|include
file|"d.h"
specifier|extern
include|#
directive|include
file|"v.h"
ifdef|#
directive|ifdef
name|NROFF
specifier|extern
include|#
directive|include
file|"tw.h"
endif|#
directive|endif
include|#
directive|include
file|"sdef.h"
ifdef|#
directive|ifdef
name|NROFF
define|#
directive|define
name|GETCH
value|gettch
endif|#
directive|endif
ifndef|#
directive|ifndef
name|NROFF
define|#
directive|define
name|GETCH
value|getch
endif|#
directive|endif
comment|/* troff7.c  text */
specifier|extern
name|struct
name|s
modifier|*
name|frame
decl_stmt|,
modifier|*
name|stk
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|struct
name|s
modifier|*
name|ejl
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|pl
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|trap
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|flss
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|npnflg
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|npn
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|stop
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|nflush
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ejf
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ascii
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|donef
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|nc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|wch
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|dpn
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ndone
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|lss
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|pto
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|pfrom
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|print
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|nlist
index|[
name|NTRAP
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|mlist
index|[
name|NTRAP
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
modifier|*
name|pnp
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|nb
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ic
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|icf
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ics
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ne
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ll
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|un
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|un1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|in
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ls
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|spread
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|totout
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|nwd
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
modifier|*
name|pendw
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
modifier|*
name|linep
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|line
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|lastl
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ch
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ce
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|fi
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|nlflg
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|pendt
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|sps
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|adsp
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|pendnf
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|over
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|adrem
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|nel
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ad
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ohc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|hyoff
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|nhyp
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|spflg
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|word
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
modifier|*
name|wordp
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|wne
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|chbits
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|cwidth
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|widthp
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|hyf
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|xbitf
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|vflag
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ul
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|cu
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|font
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|sfont
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|it
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|itmac
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
modifier|*
name|hyptr
index|[
name|NHYP
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
modifier|*
modifier|*
name|hyp
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
modifier|*
name|wdstart
decl_stmt|,
modifier|*
name|wdend
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|lnmod
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|admod
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|nn
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|nms
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ndf
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ni
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|nform
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|lnsize
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|po
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|ulbit
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
modifier|*
name|vlist
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|nrbits
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|nmbits
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|char
name|trtab
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|xxx
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|brflg
decl_stmt|;
end_decl_stmt

begin_macro
name|tbreak
argument_list|()
end_macro

begin_block
block|{
specifier|register
operator|*
name|i
operator|,
name|j
operator|,
name|pad
expr_stmt|;
name|int
name|res
decl_stmt|;
name|trap
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|nb
condition|)
return|return;
if|if
condition|(
operator|(
name|dip
operator|==
name|d
operator|)
operator|&&
operator|(
name|v
operator|.
name|nl
operator|==
operator|-
literal|1
operator|)
condition|)
block|{
name|newline
argument_list|(
literal|1
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
operator|!
name|nc
condition|)
block|{
name|setnel
argument_list|()
expr_stmt|;
if|if
condition|(
operator|!
name|wch
condition|)
return|return;
if|if
condition|(
name|pendw
condition|)
name|getword
argument_list|(
literal|1
argument_list|)
expr_stmt|;
name|movword
argument_list|()
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|pendw
operator|&&
operator|!
name|brflg
condition|)
block|{
name|getword
argument_list|(
literal|1
argument_list|)
expr_stmt|;
name|movword
argument_list|()
expr_stmt|;
block|}
operator|*
name|linep
operator|=
name|dip
operator|->
name|nls
operator|=
literal|0
expr_stmt|;
ifdef|#
directive|ifdef
name|NROFF
if|if
condition|(
name|dip
operator|==
name|d
condition|)
name|horiz
argument_list|(
name|po
argument_list|)
expr_stmt|;
endif|#
directive|endif
if|if
condition|(
name|lnmod
condition|)
name|donum
argument_list|()
expr_stmt|;
name|lastl
operator|=
name|ne
expr_stmt|;
if|if
condition|(
name|brflg
operator|!=
literal|1
condition|)
block|{
name|totout
operator|=
literal|0
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|ad
condition|)
block|{
if|if
condition|(
operator|(
name|lastl
operator|=
operator|(
name|ll
operator|-
name|un
operator|)
operator|)
operator|<
name|ne
condition|)
name|lastl
operator|=
name|ne
expr_stmt|;
block|}
if|if
condition|(
name|admod
operator|&&
name|ad
operator|&&
operator|(
name|brflg
operator|!=
literal|2
operator|)
condition|)
block|{
name|lastl
operator|=
name|ne
expr_stmt|;
name|adsp
operator|=
name|adrem
operator|=
literal|0
expr_stmt|;
ifdef|#
directive|ifdef
name|NROFF
if|if
condition|(
name|admod
operator|==
literal|1
condition|)
name|un
operator|+=
name|quant
argument_list|(
name|nel
operator|/
literal|2
argument_list|,
name|t
operator|.
name|Adj
argument_list|)
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|NROFF
if|if
condition|(
name|admod
operator|==
literal|1
condition|)
name|un
operator|+=
name|nel
operator|/
literal|2
expr_stmt|;
endif|#
directive|endif
elseif|else
if|if
condition|(
name|admod
operator|==
literal|2
condition|)
name|un
operator|+=
name|nel
expr_stmt|;
block|}
name|totout
operator|++
expr_stmt|;
name|brflg
operator|=
literal|0
expr_stmt|;
if|if
condition|(
operator|(
name|lastl
operator|+
name|un
operator|)
operator|>
name|dip
operator|->
name|maxl
condition|)
name|dip
operator|->
name|maxl
operator|=
operator|(
name|lastl
operator|+
name|un
operator|)
expr_stmt|;
name|horiz
argument_list|(
name|un
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|NROFF
if|if
condition|(
name|adrem
operator|%
name|t
operator|.
name|Adj
condition|)
name|res
operator|=
name|t
operator|.
name|Hor
expr_stmt|;
else|else
name|res
operator|=
name|t
operator|.
name|Adj
expr_stmt|;
endif|#
directive|endif
for|for
control|(
name|i
operator|=
name|line
init|;
name|nc
operator|>
literal|0
condition|;
control|)
block|{
if|if
condition|(
operator|(
operator|(
name|j
operator|=
operator|*
name|i
operator|++
operator|)
operator|&
name|CMASK
operator|)
operator|==
literal|' '
condition|)
block|{
name|pad
operator|=
literal|0
expr_stmt|;
do|do
block|{
name|pad
operator|+=
name|width
argument_list|(
name|j
argument_list|)
expr_stmt|;
name|nc
operator|--
expr_stmt|;
block|}
do|while
condition|(
operator|(
operator|(
name|j
operator|=
operator|*
name|i
operator|++
operator|)
operator|&
name|CMASK
operator|)
operator|==
literal|' '
condition|)
do|;
name|i
operator|--
expr_stmt|;
name|pad
operator|+=
name|adsp
expr_stmt|;
operator|--
name|nwd
expr_stmt|;
if|if
condition|(
name|adrem
condition|)
block|{
if|if
condition|(
name|adrem
operator|<
literal|0
condition|)
block|{
ifdef|#
directive|ifdef
name|NROFF
name|pad
operator|-=
name|res
expr_stmt|;
name|adrem
operator|+=
name|res
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|(
name|totout
operator|&
literal|01
operator|)
operator|||
operator|(
operator|(
name|adrem
operator|/
name|res
operator|)
operator|>=
operator|(
name|nwd
operator|)
operator|)
condition|)
block|{
name|pad
operator|+=
name|res
expr_stmt|;
name|adrem
operator|-=
name|res
expr_stmt|;
endif|#
directive|endif
ifndef|#
directive|ifndef
name|NROFF
name|pad
operator|--
expr_stmt|;
name|adrem
operator|++
expr_stmt|;
block|}
else|else
block|{
name|pad
operator|++
expr_stmt|;
name|adrem
operator|--
expr_stmt|;
endif|#
directive|endif
block|}
block|}
name|horiz
argument_list|(
name|pad
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|pchar
argument_list|(
name|j
argument_list|)
expr_stmt|;
name|nc
operator|--
expr_stmt|;
block|}
block|}
if|if
condition|(
name|ic
condition|)
block|{
if|if
condition|(
operator|(
name|j
operator|=
name|ll
operator|-
name|un
operator|-
name|lastl
operator|+
name|ics
operator|)
operator|>
literal|0
condition|)
name|horiz
argument_list|(
name|j
argument_list|)
expr_stmt|;
name|pchar
argument_list|(
name|ic
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|icf
condition|)
name|icf
operator|++
expr_stmt|;
else|else
name|ic
operator|=
literal|0
expr_stmt|;
name|ne
operator|=
name|nwd
operator|=
literal|0
expr_stmt|;
name|un
operator|=
name|in
expr_stmt|;
name|setnel
argument_list|()
expr_stmt|;
name|newline
argument_list|(
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|dip
operator|!=
name|d
condition|)
block|{
if|if
condition|(
name|dip
operator|->
name|dnl
operator|>
name|dip
operator|->
name|hnl
condition|)
name|dip
operator|->
name|hnl
operator|=
name|dip
operator|->
name|dnl
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|v
operator|.
name|nl
operator|>
name|dip
operator|->
name|hnl
condition|)
name|dip
operator|->
name|hnl
operator|=
name|v
operator|.
name|nl
expr_stmt|;
block|}
for|for
control|(
name|j
operator|=
name|ls
operator|-
literal|1
init|;
operator|(
name|j
operator|>
literal|0
operator|)
operator|&&
operator|!
name|trap
condition|;
name|j
operator|--
control|)
name|newline
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|spread
operator|=
literal|0
expr_stmt|;
block|}
end_block

begin_macro
name|donum
argument_list|()
end_macro

begin_block
block|{
specifier|register
name|i
operator|,
name|nw
expr_stmt|;
extern|extern pchar(
block|)
end_block

begin_empty_stmt
empty_stmt|;
end_empty_stmt

begin_expr_stmt
name|nrbits
operator|=
name|nmbits
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|nw
operator|=
name|width
argument_list|(
literal|'1'
operator||
name|nrbits
argument_list|)
expr_stmt|;
end_expr_stmt

begin_if
if|if
condition|(
name|nn
condition|)
block|{
name|nn
operator|--
expr_stmt|;
goto|goto
name|d1
goto|;
block|}
end_if

begin_if
if|if
condition|(
name|v
operator|.
name|ln
operator|%
name|ndf
condition|)
block|{
name|v
operator|.
name|ln
operator|++
expr_stmt|;
name|d1
label|:
name|un
operator|+=
name|nw
operator|*
operator|(
literal|3
operator|+
name|nms
operator|+
name|ni
operator|)
expr_stmt|;
return|return;
block|}
end_if

begin_expr_stmt
name|i
operator|=
literal|0
expr_stmt|;
end_expr_stmt

begin_if
if|if
condition|(
name|v
operator|.
name|ln
operator|<
literal|100
condition|)
name|i
operator|++
expr_stmt|;
end_if

begin_if
if|if
condition|(
name|v
operator|.
name|ln
operator|<
literal|10
condition|)
name|i
operator|++
expr_stmt|;
end_if

begin_expr_stmt
name|horiz
argument_list|(
name|nw
operator|*
operator|(
name|ni
operator|+
name|i
operator|)
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|nform
operator|=
literal|0
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|fnumb
argument_list|(
name|v
operator|.
name|ln
argument_list|,
name|pchar
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|un
operator|+=
name|nw
operator|*
name|nms
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|v
operator|.
name|ln
operator|++
expr_stmt|;
end_expr_stmt

begin_expr_stmt
unit|} text
operator|(
operator|)
block|{
specifier|register
name|i
block|;
specifier|static
name|int
name|spcnt
block|;
name|nflush
operator|++
block|;
if|if
condition|(
operator|(
name|dip
operator|==
name|d
operator|)
operator|&&
operator|(
name|v
operator|.
name|nl
operator|==
operator|-
literal|1
operator|)
condition|)
block|{
name|newline
argument_list|(
literal|1
argument_list|)
expr_stmt|;
return|return;
block|}
name|setnel
argument_list|()
expr_stmt|;
end_expr_stmt

begin_if
if|if
condition|(
name|ce
operator|||
operator|!
name|fi
condition|)
block|{
name|nofill
argument_list|()
expr_stmt|;
return|return;
block|}
end_if

begin_if
if|if
condition|(
name|pendw
condition|)
goto|goto
name|t4
goto|;
end_if

begin_if
if|if
condition|(
name|pendt
condition|)
if|if
condition|(
name|spcnt
condition|)
goto|goto
name|t2
goto|;
else|else
goto|goto
name|t3
goto|;
end_if

begin_expr_stmt
name|pendt
operator|++
expr_stmt|;
end_expr_stmt

begin_if
if|if
condition|(
name|spcnt
condition|)
goto|goto
name|t2
goto|;
end_if

begin_while
while|while
condition|(
operator|(
operator|(
name|i
operator|=
name|GETCH
argument_list|()
operator|)
operator|&
name|CMASK
operator|)
operator|==
literal|' '
condition|)
name|spcnt
operator|++
expr_stmt|;
end_while

begin_if
if|if
condition|(
name|nlflg
condition|)
block|{
name|t1
label|:
name|nflush
operator|=
name|pendt
operator|=
name|ch
operator|=
name|spcnt
operator|=
literal|0
expr_stmt|;
name|callsp
argument_list|()
expr_stmt|;
return|return;
block|}
end_if

begin_expr_stmt
name|ch
operator|=
name|i
expr_stmt|;
end_expr_stmt

begin_if
if|if
condition|(
name|spcnt
condition|)
block|{
name|t2
label|:
name|tbreak
argument_list|()
expr_stmt|;
if|if
condition|(
name|nc
operator|||
name|wch
condition|)
goto|goto
name|rtn
goto|;
name|un
operator|+=
name|spcnt
operator|*
name|sps
expr_stmt|;
name|spcnt
operator|=
literal|0
expr_stmt|;
name|setnel
argument_list|()
expr_stmt|;
if|if
condition|(
name|trap
condition|)
goto|goto
name|rtn
goto|;
if|if
condition|(
name|nlflg
condition|)
goto|goto
name|t1
goto|;
block|}
end_if

begin_label
name|t3
label|:
end_label

begin_if
if|if
condition|(
name|spread
condition|)
goto|goto
name|t5
goto|;
end_if

begin_if
if|if
condition|(
name|pendw
operator|||
operator|!
name|wch
condition|)
name|t4
label|:
if|if
condition|(
name|getword
argument_list|(
literal|0
argument_list|)
condition|)
goto|goto
name|t6
goto|;
end_if

begin_if
if|if
condition|(
operator|!
name|movword
argument_list|()
condition|)
goto|goto
name|t3
goto|;
end_if

begin_label
name|t5
label|:
end_label

begin_if
if|if
condition|(
name|nlflg
condition|)
name|pendt
operator|=
literal|0
expr_stmt|;
end_if

begin_expr_stmt
name|adsp
operator|=
name|adrem
operator|=
literal|0
expr_stmt|;
end_expr_stmt

begin_if
if|if
condition|(
name|ad
condition|)
block|{
comment|/* jfr */
if|if
condition|(
name|nwd
operator|==
literal|1
condition|)
name|adsp
operator|=
name|nel
expr_stmt|;
else|else
name|adsp
operator|=
name|nel
operator|/
operator|(
name|nwd
operator|-
literal|1
operator|)
expr_stmt|;
ifdef|#
directive|ifdef
name|NROFF
name|adsp
operator|=
operator|(
name|adsp
operator|/
name|t
operator|.
name|Adj
operator|)
operator|*
name|t
operator|.
name|Adj
expr_stmt|;
endif|#
directive|endif
name|adrem
operator|=
name|nel
operator|-
name|adsp
operator|*
operator|(
name|nwd
operator|-
literal|1
operator|)
expr_stmt|;
block|}
end_if

begin_expr_stmt
name|brflg
operator|=
literal|1
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|tbreak
argument_list|()
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|spread
operator|=
literal|0
expr_stmt|;
end_expr_stmt

begin_if
if|if
condition|(
operator|!
name|trap
condition|)
goto|goto
name|t3
goto|;
end_if

begin_if
if|if
condition|(
operator|!
name|nlflg
condition|)
goto|goto
name|rtn
goto|;
end_if

begin_label
name|t6
label|:
end_label

begin_expr_stmt
name|pendt
operator|=
literal|0
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|ckul
argument_list|()
expr_stmt|;
end_expr_stmt

begin_label
name|rtn
label|:
end_label

begin_expr_stmt
name|nflush
operator|=
literal|0
expr_stmt|;
end_expr_stmt

begin_expr_stmt
unit|} nofill
operator|(
operator|)
block|{
specifier|register
name|i
block|,
name|j
block|;
if|if
condition|(
operator|!
name|pendnf
condition|)
block|{
name|over
operator|=
literal|0
expr_stmt|;
name|tbreak
argument_list|()
expr_stmt|;
if|if
condition|(
name|trap
condition|)
goto|goto
name|rtn
goto|;
if|if
condition|(
name|nlflg
condition|)
block|{
name|ch
operator|=
name|nflush
operator|=
literal|0
expr_stmt|;
name|callsp
argument_list|()
expr_stmt|;
return|return;
block|}
name|adsp
operator|=
name|adrem
operator|=
literal|0
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|nwd
operator|=
literal|10000
expr_stmt|;
end_expr_stmt

begin_expr_stmt
unit|} 	while
operator|(
operator|(
name|j
operator|=
operator|(
operator|(
name|i
operator|=
name|GETCH
argument_list|()
operator|)
operator|&
name|CMASK
operator|)
operator|)
operator|!=
literal|'\n'
operator|)
block|{
if|if
condition|(
name|j
operator|==
name|ohc
condition|)
continue|continue;
end_expr_stmt

begin_if
if|if
condition|(
name|j
operator|==
name|CONT
condition|)
block|{
name|pendnf
operator|++
expr_stmt|;
name|nflush
operator|=
literal|0
expr_stmt|;
name|flushi
argument_list|()
expr_stmt|;
name|ckul
argument_list|()
expr_stmt|;
return|return;
block|}
end_if

begin_expr_stmt
name|storeline
argument_list|(
name|i
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
unit|} 	if
operator|(
name|ce
operator|)
block|{
name|ce
operator|--
block|;
if|if
condition|(
operator|(
name|i
operator|=
name|quant
argument_list|(
name|nel
operator|/
literal|2
argument_list|,
name|HOR
argument_list|)
operator|)
operator|>
literal|0
condition|)
name|un
operator|+=
name|i
expr_stmt|;
block|}
end_expr_stmt

begin_if
if|if
condition|(
operator|!
name|nc
condition|)
name|storeline
argument_list|(
name|FILLER
argument_list|,
literal|0
argument_list|)
expr_stmt|;
end_if

begin_expr_stmt
name|brflg
operator|=
literal|2
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|tbreak
argument_list|()
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|ckul
argument_list|()
expr_stmt|;
end_expr_stmt

begin_label
name|rtn
label|:
end_label

begin_expr_stmt
name|pendnf
operator|=
name|nflush
operator|=
literal|0
expr_stmt|;
end_expr_stmt

begin_expr_stmt
unit|} callsp
operator|(
operator|)
block|{
specifier|register
name|i
block|;
if|if
condition|(
name|flss
condition|)
name|i
operator|=
name|flss
expr_stmt|;
else|else
name|i
operator|=
name|lss
expr_stmt|;
name|flss
operator|=
literal|0
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|casesp
argument_list|(
name|i
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
unit|} ckul
operator|(
operator|)
block|{
if|if
condition|(
name|ul
operator|&&
operator|(
operator|--
name|ul
operator|==
literal|0
operator|)
condition|)
block|{
name|cu
operator|=
literal|0
expr_stmt|;
name|font
operator|=
name|sfont
expr_stmt|;
name|mchbits
argument_list|()
expr_stmt|;
block|}
end_expr_stmt

begin_if
if|if
condition|(
name|it
operator|&&
operator|(
operator|--
name|it
operator|==
literal|0
operator|)
operator|&&
name|itmac
condition|)
name|control
argument_list|(
name|itmac
argument_list|,
literal|0
argument_list|)
expr_stmt|;
end_if

begin_expr_stmt
unit|} storeline
operator|(
name|c
operator|,
name|w
operator|)
block|{
specifier|register
name|i
block|;
if|if
condition|(
operator|(
name|c
operator|&
name|CMASK
operator|)
operator|==
name|JREG
condition|)
block|{
if|if
condition|(
operator|(
name|i
operator|=
name|findr
argument_list|(
name|c
operator|>>
name|BYTE
argument_list|)
operator|)
operator|!=
operator|-
literal|1
condition|)
name|vlist
index|[
name|i
index|]
operator|=
name|ne
expr_stmt|;
return|return;
block|}
end_expr_stmt

begin_if
if|if
condition|(
name|linep
operator|>=
operator|(
name|line
operator|+
name|lnsize
operator|-
literal|1
operator|)
condition|)
block|{
if|if
condition|(
operator|!
name|over
condition|)
block|{
name|prstrfl
argument_list|(
literal|"Line overflow.\n"
argument_list|)
expr_stmt|;
name|over
operator|++
expr_stmt|;
name|c
operator|=
literal|0343
expr_stmt|;
name|w
operator|=
operator|-
literal|1
expr_stmt|;
goto|goto
name|s1
goto|;
block|}
return|return;
block|}
end_if

begin_label
name|s1
label|:
end_label

begin_if
if|if
condition|(
name|w
operator|==
operator|-
literal|1
condition|)
name|w
operator|=
name|width
argument_list|(
name|c
argument_list|)
expr_stmt|;
end_if

begin_expr_stmt
name|ne
operator|+=
name|w
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|nel
operator|-=
name|w
expr_stmt|;
end_expr_stmt

begin_comment
comment|/*  *	if( cu&& !(c& MOT)&& (trtab[(c& CMASK)] == ' '))  *		c = ((c& ~ulbit)& ~CMASK) | '_';  */
end_comment

begin_expr_stmt
operator|*
name|linep
operator|++
operator|=
name|c
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|nc
operator|++
expr_stmt|;
end_expr_stmt

begin_expr_stmt
unit|} newline
operator|(
name|a
operator|)
name|int
name|a
expr_stmt|;
end_expr_stmt

begin_block
block|{
specifier|register
name|i
operator|,
name|j
operator|,
name|nlss
expr_stmt|;
name|int
name|opn
decl_stmt|;
if|if
condition|(
name|a
condition|)
goto|goto
name|nl1
goto|;
if|if
condition|(
name|dip
operator|!=
name|d
condition|)
block|{
name|j
operator|=
name|lss
expr_stmt|;
name|pchar1
argument_list|(
name|FLSS
argument_list|)
expr_stmt|;
if|if
condition|(
name|flss
condition|)
name|lss
operator|=
name|flss
expr_stmt|;
name|i
operator|=
name|lss
operator|+
name|dip
operator|->
name|blss
expr_stmt|;
name|dip
operator|->
name|dnl
operator|+=
name|i
expr_stmt|;
name|pchar1
argument_list|(
name|i
argument_list|)
expr_stmt|;
name|pchar1
argument_list|(
literal|'\n'
argument_list|)
expr_stmt|;
name|lss
operator|=
name|j
expr_stmt|;
name|dip
operator|->
name|blss
operator|=
name|flss
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|dip
operator|->
name|alss
condition|)
block|{
name|pchar1
argument_list|(
name|FLSS
argument_list|)
expr_stmt|;
name|pchar1
argument_list|(
name|dip
operator|->
name|alss
argument_list|)
expr_stmt|;
name|pchar1
argument_list|(
literal|'\n'
argument_list|)
expr_stmt|;
name|dip
operator|->
name|dnl
operator|+=
name|dip
operator|->
name|alss
expr_stmt|;
name|dip
operator|->
name|alss
operator|=
literal|0
expr_stmt|;
block|}
if|if
condition|(
name|dip
operator|->
name|ditrap
operator|&&
operator|!
name|dip
operator|->
name|ditf
operator|&&
operator|(
name|dip
operator|->
name|dnl
operator|>=
name|dip
operator|->
name|ditrap
operator|)
operator|&&
name|dip
operator|->
name|dimac
condition|)
if|if
condition|(
name|control
argument_list|(
name|dip
operator|->
name|dimac
argument_list|,
literal|0
argument_list|)
condition|)
block|{
name|trap
operator|++
expr_stmt|;
name|dip
operator|->
name|ditf
operator|++
expr_stmt|;
block|}
return|return;
block|}
name|j
operator|=
name|lss
expr_stmt|;
if|if
condition|(
name|flss
condition|)
name|lss
operator|=
name|flss
expr_stmt|;
name|nlss
operator|=
name|dip
operator|->
name|alss
operator|+
name|dip
operator|->
name|blss
operator|+
name|lss
expr_stmt|;
name|v
operator|.
name|nl
operator|+=
name|nlss
expr_stmt|;
ifndef|#
directive|ifndef
name|NROFF
if|if
condition|(
name|ascii
condition|)
block|{
name|dip
operator|->
name|alss
operator|=
name|dip
operator|->
name|blss
operator|=
literal|0
expr_stmt|;
block|}
endif|#
directive|endif
name|pchar1
argument_list|(
literal|'\n'
argument_list|)
expr_stmt|;
name|flss
operator|=
literal|0
expr_stmt|;
name|lss
operator|=
name|j
expr_stmt|;
if|if
condition|(
name|v
operator|.
name|nl
operator|<
name|pl
condition|)
goto|goto
name|nl2
goto|;
name|nl1
label|:
name|ejf
operator|=
name|dip
operator|->
name|hnl
operator|=
name|v
operator|.
name|nl
operator|=
literal|0
expr_stmt|;
name|ejl
operator|=
name|frame
expr_stmt|;
if|if
condition|(
name|donef
operator|==
literal|1
condition|)
block|{
if|if
condition|(
operator|(
operator|!
name|nc
operator|&&
operator|!
name|wch
operator|)
operator|||
name|ndone
condition|)
name|done1
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|ndone
operator|++
expr_stmt|;
name|donef
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|frame
operator|==
name|stk
condition|)
name|nflush
operator|++
expr_stmt|;
block|}
name|opn
operator|=
name|v
operator|.
name|pn
expr_stmt|;
name|v
operator|.
name|pn
operator|++
expr_stmt|;
if|if
condition|(
name|npnflg
condition|)
block|{
name|v
operator|.
name|pn
operator|=
name|npn
expr_stmt|;
name|npn
operator|=
name|npnflg
operator|=
literal|0
expr_stmt|;
block|}
name|nlpn
label|:
if|if
condition|(
name|v
operator|.
name|pn
operator|==
name|pfrom
condition|)
block|{
name|print
operator|++
expr_stmt|;
name|pfrom
operator|=
operator|-
literal|1
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|opn
operator|==
name|pto
operator|||
name|v
operator|.
name|pn
operator|>
name|pto
condition|)
block|{
name|print
operator|=
literal|0
expr_stmt|;
name|opn
operator|=
operator|-
literal|1
expr_stmt|;
name|chkpn
argument_list|()
expr_stmt|;
goto|goto
name|nlpn
goto|;
block|}
if|if
condition|(
name|stop
operator|&&
name|print
condition|)
block|{
name|dpn
operator|++
expr_stmt|;
if|if
condition|(
name|dpn
operator|>=
name|stop
condition|)
block|{
name|dpn
operator|=
literal|0
expr_stmt|;
name|dostop
argument_list|()
expr_stmt|;
block|}
block|}
name|nl2
label|:
name|trap
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|v
operator|.
name|nl
operator|==
literal|0
condition|)
block|{
if|if
condition|(
operator|(
name|j
operator|=
name|findn
argument_list|(
literal|0
argument_list|)
operator|)
operator|!=
name|NTRAP
condition|)
name|trap
operator|=
name|control
argument_list|(
name|mlist
index|[
name|j
index|]
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|(
name|i
operator|=
name|findt
argument_list|(
name|v
operator|.
name|nl
operator|-
name|nlss
argument_list|)
operator|)
operator|<=
name|nlss
condition|)
block|{
if|if
condition|(
operator|(
name|j
operator|=
name|findn1
argument_list|(
name|v
operator|.
name|nl
operator|-
name|nlss
operator|+
name|i
argument_list|)
operator|)
operator|==
name|NTRAP
condition|)
block|{
name|prstrfl
argument_list|(
literal|"Trap botch.\n"
argument_list|)
expr_stmt|;
name|done2
argument_list|(
operator|-
literal|5
argument_list|)
expr_stmt|;
block|}
name|trap
operator|=
name|control
argument_list|(
name|mlist
index|[
name|j
index|]
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
block|}
end_block

begin_macro
name|findn1
argument_list|(
argument|a
argument_list|)
end_macro

begin_decl_stmt
name|int
name|a
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|i
operator|,
name|j
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|NTRAP
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|mlist
index|[
name|i
index|]
condition|)
block|{
if|if
condition|(
operator|(
name|j
operator|=
name|nlist
index|[
name|i
index|]
operator|)
operator|<
literal|0
condition|)
name|j
operator|+=
name|pl
expr_stmt|;
if|if
condition|(
name|j
operator|==
name|a
condition|)
break|break;
block|}
block|}
return|return
operator|(
name|i
operator|)
return|;
block|}
end_block

begin_macro
name|chkpn
argument_list|()
end_macro

begin_block
block|{
name|pto
operator|=
operator|*
operator|(
name|pnp
operator|++
operator|)
expr_stmt|;
name|pfrom
operator|=
name|pto
operator|&
operator|~
name|MOT
expr_stmt|;
if|if
condition|(
name|pto
operator|==
operator|-
literal|1
condition|)
block|{
name|flusho
argument_list|()
expr_stmt|;
name|done1
argument_list|(
literal|0
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|pto
operator|&
name|MOT
condition|)
block|{
name|pto
operator|&=
operator|~
name|MOT
expr_stmt|;
name|print
operator|++
expr_stmt|;
name|pfrom
operator|=
literal|0
expr_stmt|;
block|}
block|}
end_block

begin_macro
name|findt
argument_list|(
argument|a
argument_list|)
end_macro

begin_decl_stmt
name|int
name|a
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|i
operator|,
name|j
operator|,
name|k
expr_stmt|;
name|k
operator|=
literal|32767
expr_stmt|;
if|if
condition|(
name|dip
operator|!=
name|d
condition|)
block|{
if|if
condition|(
name|dip
operator|->
name|dimac
operator|&&
operator|(
operator|(
name|i
operator|=
name|dip
operator|->
name|ditrap
operator|-
name|a
operator|)
operator|>
literal|0
operator|)
condition|)
name|k
operator|=
name|i
expr_stmt|;
return|return
operator|(
name|k
operator|)
return|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|NTRAP
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|mlist
index|[
name|i
index|]
condition|)
block|{
if|if
condition|(
operator|(
name|j
operator|=
name|nlist
index|[
name|i
index|]
operator|)
operator|<
literal|0
condition|)
name|j
operator|+=
name|pl
expr_stmt|;
if|if
condition|(
operator|(
name|j
operator|-=
name|a
operator|)
operator|<=
literal|0
condition|)
continue|continue;
if|if
condition|(
name|j
operator|<
name|k
condition|)
name|k
operator|=
name|j
expr_stmt|;
block|}
block|}
name|i
operator|=
name|pl
operator|-
name|a
expr_stmt|;
if|if
condition|(
name|k
operator|>
name|i
condition|)
name|k
operator|=
name|i
expr_stmt|;
return|return
operator|(
name|k
operator|)
return|;
block|}
end_block

begin_macro
name|findt1
argument_list|()
end_macro

begin_block
block|{
specifier|register
name|i
expr_stmt|;
if|if
condition|(
name|dip
operator|!=
name|d
condition|)
name|i
operator|=
name|dip
operator|->
name|dnl
expr_stmt|;
else|else
name|i
operator|=
name|v
operator|.
name|nl
expr_stmt|;
return|return
operator|(
name|findt
argument_list|(
name|i
argument_list|)
operator|)
return|;
block|}
end_block

begin_macro
name|eject
argument_list|(
argument|a
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|s
modifier|*
name|a
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|savlss
expr_stmt|;
if|if
condition|(
name|dip
operator|!=
name|d
condition|)
return|return;
name|ejf
operator|++
expr_stmt|;
if|if
condition|(
name|a
condition|)
name|ejl
operator|=
name|a
expr_stmt|;
else|else
name|ejl
operator|=
name|frame
expr_stmt|;
if|if
condition|(
name|trap
condition|)
return|return;
name|e1
label|:
name|savlss
operator|=
name|lss
expr_stmt|;
name|lss
operator|=
name|findt
argument_list|(
name|v
operator|.
name|nl
argument_list|)
expr_stmt|;
name|newline
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|lss
operator|=
name|savlss
expr_stmt|;
if|if
condition|(
name|v
operator|.
name|nl
operator|&&
operator|!
name|trap
condition|)
goto|goto
name|e1
goto|;
block|}
end_block

begin_macro
name|movword
argument_list|()
end_macro

begin_block
block|{
specifier|register
name|i
operator|,
name|w
operator|,
operator|*
name|wp
expr_stmt|;
name|int
name|savwch
decl_stmt|,
name|hys
decl_stmt|;
name|over
operator|=
literal|0
expr_stmt|;
name|wp
operator|=
name|wordp
expr_stmt|;
if|if
condition|(
operator|!
name|nwd
condition|)
block|{
while|while
condition|(
operator|(
operator|(
name|i
operator|=
operator|*
name|wp
operator|++
operator|)
operator|&
name|CMASK
operator|)
operator|==
literal|' '
condition|)
block|{
name|wch
operator|--
expr_stmt|;
name|wne
operator|-=
name|width
argument_list|(
name|i
argument_list|)
expr_stmt|;
block|}
name|wp
operator|--
expr_stmt|;
block|}
if|if
condition|(
operator|(
name|wne
operator|>
name|nel
operator|)
operator|&&
operator|!
name|hyoff
operator|&&
name|hyf
operator|&&
operator|(
operator|!
name|nwd
operator|||
operator|(
name|nel
operator|>
literal|3
operator|*
name|sps
operator|)
operator|)
operator|&&
operator|(
operator|!
operator|(
name|hyf
operator|&
literal|02
operator|)
operator|||
operator|(
name|findt1
argument_list|()
operator|>
name|lss
operator|)
operator|)
condition|)
name|hyphen
argument_list|(
name|wp
argument_list|)
expr_stmt|;
name|savwch
operator|=
name|wch
expr_stmt|;
name|hyp
operator|=
name|hyptr
expr_stmt|;
name|nhyp
operator|=
literal|0
expr_stmt|;
while|while
condition|(
operator|*
name|hyp
operator|&&
operator|(
operator|*
name|hyp
operator|<=
name|wp
operator|)
condition|)
name|hyp
operator|++
expr_stmt|;
while|while
condition|(
name|wch
condition|)
block|{
if|if
condition|(
operator|(
name|hyoff
operator|!=
literal|1
operator|)
operator|&&
operator|(
operator|*
name|hyp
operator|==
name|wp
operator|)
condition|)
block|{
name|hyp
operator|++
expr_stmt|;
if|if
condition|(
operator|!
name|wdstart
operator|||
operator|(
operator|(
name|wp
operator|>
operator|(
name|wdstart
operator|+
literal|1
operator|)
operator|)
operator|&&
operator|(
name|wp
operator|<
name|wdend
operator|)
operator|&&
operator|(
operator|!
operator|(
name|hyf
operator|&
literal|04
operator|)
operator|||
operator|(
name|wp
operator|<
operator|(
name|wdend
operator|-
literal|1
operator|)
operator|)
operator|)
operator|&&
operator|(
operator|!
operator|(
name|hyf
operator|&
literal|010
operator|)
operator|||
operator|(
name|wp
operator|>
operator|(
name|wdstart
operator|+
literal|2
operator|)
operator|)
operator|)
operator|)
condition|)
block|{
name|nhyp
operator|++
expr_stmt|;
name|storeline
argument_list|(
name|IMP
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
block|}
name|i
operator|=
operator|*
name|wp
operator|++
expr_stmt|;
name|w
operator|=
name|width
argument_list|(
name|i
argument_list|)
expr_stmt|;
name|wne
operator|-=
name|w
expr_stmt|;
name|wch
operator|--
expr_stmt|;
name|storeline
argument_list|(
name|i
argument_list|,
name|w
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|nel
operator|>=
literal|0
condition|)
block|{
name|nwd
operator|++
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
name|xbitf
operator|=
literal|1
expr_stmt|;
name|hys
operator|=
name|width
argument_list|(
literal|0200
argument_list|)
expr_stmt|;
comment|/*hyphen*/
name|m1
label|:
if|if
condition|(
operator|!
name|nhyp
condition|)
block|{
if|if
condition|(
operator|!
name|nwd
condition|)
goto|goto
name|m3
goto|;
if|if
condition|(
name|wch
operator|==
name|savwch
condition|)
goto|goto
name|m4
goto|;
block|}
if|if
condition|(
operator|*
operator|--
name|linep
operator|!=
name|IMP
condition|)
goto|goto
name|m5
goto|;
if|if
condition|(
operator|!
operator|(
operator|--
name|nhyp
operator|)
condition|)
if|if
condition|(
operator|!
name|nwd
condition|)
goto|goto
name|m2
goto|;
if|if
condition|(
name|nel
operator|<
name|hys
condition|)
block|{
name|nc
operator|--
expr_stmt|;
goto|goto
name|m1
goto|;
block|}
name|m2
label|:
if|if
condition|(
operator|(
operator|(
name|i
operator|=
operator|*
operator|(
name|linep
operator|-
literal|1
operator|)
operator|&
name|CMASK
operator|)
operator|!=
literal|'-'
operator|)
operator|&&
operator|(
name|i
operator|!=
literal|0203
operator|)
condition|)
block|{
operator|*
name|linep
operator|=
operator|(
operator|*
operator|(
name|linep
operator|-
literal|1
operator|)
operator|&
operator|~
name|CMASK
operator|)
operator||
literal|0200
expr_stmt|;
name|w
operator|=
name|width
argument_list|(
operator|*
name|linep
argument_list|)
expr_stmt|;
name|nel
operator|-=
name|w
expr_stmt|;
name|ne
operator|+=
name|w
expr_stmt|;
name|linep
operator|++
expr_stmt|;
comment|/* 	hsend(); */
block|}
name|m3
label|:
name|nwd
operator|++
expr_stmt|;
name|m4
label|:
name|wordp
operator|=
name|wp
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
name|m5
label|:
name|nc
operator|--
expr_stmt|;
name|w
operator|=
name|width
argument_list|(
operator|*
name|linep
argument_list|)
expr_stmt|;
name|ne
operator|-=
name|w
expr_stmt|;
name|nel
operator|+=
name|w
expr_stmt|;
name|wne
operator|+=
name|w
expr_stmt|;
name|wch
operator|++
expr_stmt|;
name|wp
operator|--
expr_stmt|;
goto|goto
name|m1
goto|;
block|}
end_block

begin_macro
name|horiz
argument_list|(
argument|i
argument_list|)
end_macro

begin_decl_stmt
name|int
name|i
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|vflag
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|i
condition|)
name|pchar
argument_list|(
name|makem
argument_list|(
name|i
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|setnel
argument_list|()
end_macro

begin_block
block|{
if|if
condition|(
operator|!
name|nc
condition|)
block|{
name|linep
operator|=
name|line
expr_stmt|;
if|if
condition|(
name|un1
operator|>=
literal|0
condition|)
block|{
name|un
operator|=
name|un1
expr_stmt|;
name|un1
operator|=
operator|-
literal|1
expr_stmt|;
block|}
name|nel
operator|=
name|ll
operator|-
name|un
expr_stmt|;
name|ne
operator|=
name|adsp
operator|=
name|adrem
operator|=
literal|0
expr_stmt|;
block|}
block|}
end_block

begin_macro
name|getword
argument_list|(
argument|x
argument_list|)
end_macro

begin_decl_stmt
name|int
name|x
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|i
operator|,
name|j
operator|,
name|swp
expr_stmt|;
name|int
name|noword
decl_stmt|;
name|noword
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|x
condition|)
if|if
condition|(
name|pendw
condition|)
block|{
operator|*
name|pendw
operator|=
literal|0
expr_stmt|;
goto|goto
name|rtn
goto|;
block|}
if|if
condition|(
name|wordp
operator|=
name|pendw
condition|)
goto|goto
name|g1
goto|;
name|hyp
operator|=
name|hyptr
expr_stmt|;
name|wordp
operator|=
name|word
expr_stmt|;
name|over
operator|=
name|wne
operator|=
name|wch
operator|=
literal|0
expr_stmt|;
name|hyoff
operator|=
literal|0
expr_stmt|;
while|while
condition|(
literal|1
condition|)
block|{
name|j
operator|=
operator|(
name|i
operator|=
name|GETCH
argument_list|()
operator|)
operator|&
name|CMASK
expr_stmt|;
if|if
condition|(
name|j
operator|==
literal|'\n'
condition|)
block|{
name|wne
operator|=
name|wch
operator|=
literal|0
expr_stmt|;
name|noword
operator|=
literal|1
expr_stmt|;
goto|goto
name|rtn
goto|;
block|}
if|if
condition|(
name|j
operator|==
name|ohc
condition|)
block|{
name|hyoff
operator|=
literal|1
expr_stmt|;
continue|continue;
block|}
if|if
condition|(
name|j
operator|==
literal|' '
condition|)
block|{
name|storeword
argument_list|(
name|i
argument_list|,
name|width
argument_list|(
name|i
argument_list|)
argument_list|)
expr_stmt|;
comment|/* XXX */
continue|continue;
block|}
break|break;
block|}
name|swp
operator|=
name|widthp
expr_stmt|;
name|storeword
argument_list|(
literal|' '
operator||
name|chbits
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|spflg
condition|)
block|{
name|storeword
argument_list|(
literal|' '
operator||
name|chbits
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|spflg
operator|=
literal|0
expr_stmt|;
block|}
name|widthp
operator|=
name|swp
expr_stmt|;
name|g0
label|:
if|if
condition|(
name|j
operator|==
name|CONT
condition|)
block|{
name|pendw
operator|=
name|wordp
expr_stmt|;
name|nflush
operator|=
literal|0
expr_stmt|;
name|flushi
argument_list|()
expr_stmt|;
return|return
operator|(
literal|1
operator|)
return|;
block|}
if|if
condition|(
name|hyoff
operator|!=
literal|1
condition|)
block|{
if|if
condition|(
name|j
operator|==
name|ohc
condition|)
block|{
name|hyoff
operator|=
literal|2
expr_stmt|;
operator|*
name|hyp
operator|++
operator|=
name|wordp
expr_stmt|;
if|if
condition|(
name|hyp
operator|>
operator|(
name|hyptr
operator|+
name|NHYP
operator|-
literal|1
operator|)
condition|)
name|hyp
operator|=
name|hyptr
operator|+
name|NHYP
operator|-
literal|1
expr_stmt|;
goto|goto
name|g1
goto|;
block|}
if|if
condition|(
operator|(
name|j
operator|==
literal|'-'
operator|)
operator|||
operator|(
name|j
operator|==
literal|0203
operator|)
comment|/*3/4 Em dash*/
condition|)
if|if
condition|(
name|wordp
operator|>
name|word
operator|+
literal|1
condition|)
block|{
name|hyoff
operator|=
literal|2
expr_stmt|;
operator|*
name|hyp
operator|++
operator|=
name|wordp
operator|+
literal|1
expr_stmt|;
if|if
condition|(
name|hyp
operator|>
operator|(
name|hyptr
operator|+
name|NHYP
operator|-
literal|1
operator|)
condition|)
name|hyp
operator|=
name|hyptr
operator|+
name|NHYP
operator|-
literal|1
expr_stmt|;
block|}
block|}
name|storeword
argument_list|(
name|i
argument_list|,
name|width
argument_list|(
name|i
argument_list|)
argument_list|)
expr_stmt|;
comment|/* XXX */
name|g1
label|:
name|j
operator|=
operator|(
name|i
operator|=
name|GETCH
argument_list|()
operator|)
operator|&
name|CMASK
expr_stmt|;
if|if
condition|(
name|j
operator|!=
literal|' '
condition|)
block|{
if|if
condition|(
name|j
operator|!=
literal|'\n'
condition|)
goto|goto
name|g0
goto|;
name|j
operator|=
operator|*
operator|(
name|wordp
operator|-
literal|1
operator|)
operator|&
name|CMASK
expr_stmt|;
if|if
condition|(
operator|(
name|j
operator|==
literal|'.'
operator|)
operator|||
operator|(
name|j
operator|==
literal|'!'
operator|)
operator|||
operator|(
name|j
operator|==
literal|'?'
operator|)
condition|)
name|spflg
operator|++
expr_stmt|;
block|}
operator|*
name|wordp
operator|=
literal|0
expr_stmt|;
name|rtn
label|:
name|wdstart
operator|=
literal|0
expr_stmt|;
name|wordp
operator|=
name|word
expr_stmt|;
name|pendw
operator|=
literal|0
expr_stmt|;
operator|*
name|hyp
operator|++
operator|=
literal|0
expr_stmt|;
name|setnel
argument_list|()
expr_stmt|;
return|return
operator|(
name|noword
operator|)
return|;
block|}
end_block

begin_macro
name|storeword
argument_list|(
argument|c
argument_list|,
argument|w
argument_list|)
end_macro

begin_decl_stmt
name|int
name|c
decl_stmt|,
name|w
decl_stmt|;
end_decl_stmt

begin_block
block|{
if|if
condition|(
name|wordp
operator|>=
operator|&
name|word
index|[
name|WDSIZE
operator|-
literal|1
index|]
condition|)
block|{
if|if
condition|(
operator|!
name|over
condition|)
block|{
name|prstrfl
argument_list|(
literal|"Word overflow.\n"
argument_list|)
expr_stmt|;
name|over
operator|++
expr_stmt|;
name|c
operator|=
literal|0343
expr_stmt|;
name|w
operator|=
operator|-
literal|1
expr_stmt|;
goto|goto
name|s1
goto|;
block|}
return|return;
block|}
name|s1
label|:
if|if
condition|(
name|w
operator|==
operator|-
literal|1
condition|)
name|w
operator|=
name|width
argument_list|(
name|c
argument_list|)
expr_stmt|;
name|wne
operator|+=
name|w
expr_stmt|;
operator|*
name|wordp
operator|++
operator|=
name|c
expr_stmt|;
name|wch
operator|++
expr_stmt|;
block|}
end_block

begin_ifdef
ifdef|#
directive|ifdef
name|NROFF
end_ifdef

begin_decl_stmt
specifier|extern
name|char
name|trtab
index|[]
decl_stmt|;
end_decl_stmt

begin_macro
name|gettch
argument_list|()
end_macro

begin_block
block|{
specifier|register
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
if|if
condition|(
operator|!
operator|(
operator|(
name|i
operator|=
name|getch
argument_list|()
operator|)
operator|&
name|MOT
operator|)
operator|&&
operator|(
name|i
operator|&
name|ulbit
operator|)
condition|)
block|{
name|j
operator|=
name|i
operator|&
name|CMASK
expr_stmt|;
if|if
condition|(
name|cu
operator|&&
operator|(
name|trtab
index|[
name|j
index|]
operator|==
literal|' '
operator|)
condition|)
name|i
operator|=
operator|(
operator|(
name|i
operator|&
operator|~
name|ulbit
operator|)
operator|&
operator|~
name|CMASK
operator|)
operator||
literal|'_'
expr_stmt|;
if|if
condition|(
operator|!
name|cu
operator|&&
operator|(
name|j
operator|>
literal|32
operator|)
operator|&&
operator|(
name|j
operator|<
literal|0370
operator|)
operator|&&
operator|!
operator|(
operator|*
name|t
operator|.
name|codetab
index|[
name|j
operator|-
literal|32
index|]
operator|&
literal|0200
operator|)
condition|)
name|i
operator|&=
operator|~
name|ulbit
expr_stmt|;
block|}
return|return
operator|(
name|i
operator|)
return|;
block|}
end_block

begin_endif
endif|#
directive|endif
end_endif

end_unit

