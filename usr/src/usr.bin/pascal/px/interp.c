begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (c) 1980 Regents of the University of California.  * All rights reserved.  The Berkeley software License Agreement  * specifies the terms and conditions for redistribution.  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
name|sccsid
index|[]
init|=
literal|"@(#)interp.c	5.3 (Berkeley) %G%"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
endif|not lint
end_endif

begin_include
include|#
directive|include
file|<math.h>
end_include

begin_include
include|#
directive|include
file|<signal.h>
end_include

begin_include
include|#
directive|include
file|"whoami.h"
end_include

begin_include
include|#
directive|include
file|"vars.h"
end_include

begin_include
include|#
directive|include
file|"objfmt.h"
end_include

begin_include
include|#
directive|include
file|"h02opcs.h"
end_include

begin_include
include|#
directive|include
file|"machdep.h"
end_include

begin_include
include|#
directive|include
file|"libpc.h"
end_include

begin_comment
comment|/*  * program variables  */
end_comment

begin_decl_stmt
name|union
name|display
name|_display
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|dispsave
modifier|*
name|_dp
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|long
name|_lino
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|_argc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
modifier|*
name|_argv
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|long
name|_mode
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|long
name|_runtst
init|=
operator|(
name|long
operator|)
name|TRUE
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|bool
name|_nodump
init|=
name|FALSE
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|long
name|_stlim
init|=
literal|500000
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|long
name|_stcnt
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|long
name|_seed
init|=
literal|1
decl_stmt|;
end_decl_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|ADDR32
end_ifdef

begin_decl_stmt
name|char
modifier|*
name|_minptr
init|=
operator|(
name|char
operator|*
operator|)
literal|0x7fffffff
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
endif|ADDR32
end_endif

begin_ifdef
ifdef|#
directive|ifdef
name|ADDR16
end_ifdef

begin_decl_stmt
name|char
modifier|*
name|_minptr
init|=
operator|(
name|char
operator|*
operator|)
literal|0xffff
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
endif|ADDR16
end_endif

begin_decl_stmt
name|char
modifier|*
name|_maxptr
init|=
operator|(
name|char
operator|*
operator|)
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|long
modifier|*
name|_pcpcount
init|=
operator|(
name|long
operator|*
operator|)
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|long
name|_cntrs
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|long
name|_rtns
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * standard files  */
end_comment

begin_decl_stmt
name|char
name|_inwin
decl_stmt|,
name|_outwin
decl_stmt|,
name|_errwin
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|iorechd
name|_err
init|=
block|{
operator|&
name|_errwin
block|,
comment|/* fileptr */
literal|0
block|,
comment|/* lcount  */
literal|0x7fffffff
block|,
comment|/* llimit  */
operator|&
name|_iob
index|[
literal|2
index|]
block|,
comment|/* fbuf    */
name|FILNIL
block|,
comment|/* fchain  */
name|STDLVL
block|,
comment|/* flev    */
literal|"Message file"
block|,
comment|/* pfname  */
name|FTEXT
operator||
name|FWRITE
operator||
name|EOFF
block|,
comment|/* funit   */
literal|2
block|,
comment|/* fblk    */
literal|1
comment|/* fsize   */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|iorechd
name|output
init|=
block|{
operator|&
name|_outwin
block|,
comment|/* fileptr */
literal|0
block|,
comment|/* lcount  */
literal|0x7fffffff
block|,
comment|/* llimit  */
operator|&
name|_iob
index|[
literal|1
index|]
block|,
comment|/* fbuf    */
name|ERR
block|,
comment|/* fchain  */
name|STDLVL
block|,
comment|/* flev    */
literal|"standard output"
block|,
comment|/* pfname  */
name|FTEXT
operator||
name|FWRITE
operator||
name|EOFF
block|,
comment|/* funit   */
literal|1
block|,
comment|/* fblk    */
literal|1
comment|/* fsize   */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|iorechd
name|input
init|=
block|{
operator|&
name|_inwin
block|,
comment|/* fileptr */
literal|0
block|,
comment|/* lcount  */
literal|0x7fffffff
block|,
comment|/* llimit  */
operator|&
name|_iob
index|[
literal|0
index|]
block|,
comment|/* fbuf    */
name|OUTPUT
block|,
comment|/* fchain  */
name|STDLVL
block|,
comment|/* flev    */
literal|"standard input"
block|,
comment|/* pfname  */
name|FTEXT
operator||
name|FREAD
operator||
name|SYNC
operator||
name|EOLN
block|,
comment|/* funit   */
literal|0
block|,
comment|/* fblk    */
literal|1
comment|/* fsize   */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * file record variables  */
end_comment

begin_decl_stmt
name|long
name|_filefre
init|=
name|PREDEF
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|iorechd
name|_fchain
init|=
block|{
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
comment|/* only use fchain field */
name|INPUT
comment|/* fchain  */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|iorec
modifier|*
name|_actfile
index|[
name|MAXFILES
index|]
init|=
block|{
name|INPUT
block|,
name|OUTPUT
block|,
name|ERR
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * stuff for pdx  */
end_comment

begin_decl_stmt
name|union
name|progcntr
modifier|*
name|pcaddrp
decl_stmt|;
end_decl_stmt

begin_asm
asm|asm(".globl _loopaddr");
end_asm

begin_comment
comment|/*  * Px profile array  */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|PROFILE
end_ifdef

begin_decl_stmt
name|long
name|_profcnts
index|[
name|NUMOPS
index|]
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
endif|PROFILE
end_endif

begin_comment
comment|/*  * debugging variables  */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|DEBUG
end_ifdef

begin_decl_stmt
name|char
name|opc
index|[
literal|10
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|long
name|opcptr
init|=
literal|9
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
endif|DEBUG
end_endif

begin_escape
end_escape

begin_macro
name|interpreter
argument_list|(
argument|base
argument_list|)
end_macro

begin_decl_stmt
name|char
modifier|*
name|base
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|union
name|progcntr
name|pc
decl_stmt|;
comment|/* interpreted program cntr */
specifier|register
name|char
modifier|*
name|vpc
decl_stmt|;
comment|/* register used for "pc" */
name|struct
name|iorec
modifier|*
name|curfile
decl_stmt|;
comment|/* active file */
specifier|register
name|struct
name|blockmark
modifier|*
name|stp
decl_stmt|;
comment|/* active stack frame ptr */
comment|/* 	 * the following variables are used as scratch 	 */
specifier|register
name|char
modifier|*
name|tcp
decl_stmt|;
specifier|register
name|short
modifier|*
name|tsp
decl_stmt|;
specifier|register
name|long
name|tl
decl_stmt|,
name|tl1
decl_stmt|,
name|tl2
decl_stmt|;
name|double
name|td
decl_stmt|,
name|td1
decl_stmt|;
name|struct
name|sze8
name|t8
decl_stmt|;
specifier|register
name|short
modifier|*
name|tsp1
decl_stmt|;
name|long
modifier|*
name|tlp
decl_stmt|,
name|tl3
decl_stmt|;
name|char
modifier|*
name|tcp1
decl_stmt|;
name|bool
name|tb
decl_stmt|;
name|struct
name|blockmark
modifier|*
name|tstp
decl_stmt|;
specifier|register
name|struct
name|formalrtn
modifier|*
name|tfp
decl_stmt|;
name|union
name|progcntr
name|tpc
decl_stmt|;
name|struct
name|iorec
modifier|*
modifier|*
name|ip
decl_stmt|;
name|int
name|mypid
decl_stmt|;
name|pcaddrp
operator|=
operator|&
name|pc
expr_stmt|;
name|mypid
operator|=
name|getpid
argument_list|()
expr_stmt|;
comment|/* 	 * Setup sets up any hardware specific parameters before 	 * starting the interpreter. Typically this is inline replaced 	 * by interp.sed to utilize specific machine instructions. 	 */
name|setup
argument_list|()
expr_stmt|;
comment|/* 	 * necessary only on systems which do not initialize 	 * memory to zero 	 */
for|for
control|(
name|ip
operator|=
operator|&
name|_actfile
index|[
literal|3
index|]
init|;
name|ip
operator|<
operator|&
name|_actfile
index|[
name|MAXFILES
index|]
condition|;
operator|*
name|ip
operator|++
operator|=
name|FILNIL
control|)
comment|/* void */
empty_stmt|;
comment|/* 	 * set up global environment, then ``call'' the main program 	 */
name|_display
operator|.
name|frame
index|[
literal|0
index|]
operator|.
name|locvars
operator|=
name|pushsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|2
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|iorec
operator|*
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|_display
operator|.
name|frame
index|[
literal|0
index|]
operator|.
name|locvars
operator|+=
literal|2
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|iorec
operator|*
argument_list|)
expr_stmt|;
operator|*
operator|(
expr|struct
name|iorec
operator|*
operator|*
operator|)
operator|(
name|_display
operator|.
name|frame
index|[
literal|0
index|]
operator|.
name|locvars
operator|+
name|OUTPUT_OFF
operator|)
operator|=
name|OUTPUT
expr_stmt|;
operator|*
operator|(
expr|struct
name|iorec
operator|*
operator|*
operator|)
operator|(
name|_display
operator|.
name|frame
index|[
literal|0
index|]
operator|.
name|locvars
operator|+
name|INPUT_OFF
operator|)
operator|=
name|INPUT
expr_stmt|;
name|stp
operator|=
operator|(
expr|struct
name|blockmark
operator|*
operator|)
name|pushsp
argument_list|(
call|(
name|long
call|)
argument_list|(
sizeof|sizeof
argument_list|(
expr|struct
name|blockmark
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|_dp
operator|=
operator|&
name|_display
operator|.
name|frame
index|[
literal|0
index|]
expr_stmt|;
name|pc
operator|.
name|cp
operator|=
name|base
expr_stmt|;
asm|asm("_loopaddr:");
for|for
control|(
init|;
condition|;
control|)
block|{
ifdef|#
directive|ifdef
name|DEBUG
if|if
condition|(
operator|++
name|opcptr
operator|==
literal|10
condition|)
name|opcptr
operator|=
literal|0
expr_stmt|;
name|opc
index|[
name|opcptr
index|]
operator|=
operator|*
name|pc
operator|.
name|ucp
expr_stmt|;
endif|#
directive|endif
endif|DEBUG
ifdef|#
directive|ifdef
name|PROFILE
name|_profcnts
index|[
operator|*
name|pc
operator|.
name|ucp
index|]
operator|++
expr_stmt|;
endif|#
directive|endif
endif|PROFILE
switch|switch
condition|(
operator|*
name|pc
operator|.
name|ucp
operator|++
condition|)
block|{
case|case
name|O_BPT
case|:
comment|/* breakpoint trap */
name|PFLUSH
argument_list|()
expr_stmt|;
name|kill
argument_list|(
name|mypid
argument_list|,
name|SIGILL
argument_list|)
expr_stmt|;
name|pc
operator|.
name|ucp
operator|--
expr_stmt|;
continue|continue;
case|case
name|O_NODUMP
case|:
name|_nodump
operator|=
name|TRUE
expr_stmt|;
comment|/* and fall through */
case|case
name|O_BEG
case|:
name|_dp
operator|+=
literal|1
expr_stmt|;
comment|/* enter local scope */
name|stp
operator|->
name|odisp
operator|=
operator|*
name|_dp
expr_stmt|;
comment|/* save old display value */
name|tl
operator|=
operator|*
name|pc
operator|.
name|ucp
operator|++
expr_stmt|;
comment|/* tl = name size */
name|stp
operator|->
name|entry
operator|=
name|pc
operator|.
name|hdrp
expr_stmt|;
comment|/* pointer to entry info */
name|tl1
operator|=
name|pc
operator|.
name|hdrp
operator|->
name|framesze
expr_stmt|;
comment|/* tl1 = size of frame */
name|_lino
operator|=
name|pc
operator|.
name|hdrp
operator|->
name|offset
expr_stmt|;
name|_runtst
operator|=
name|pc
operator|.
name|hdrp
operator|->
name|tests
expr_stmt|;
name|disableovrflo
argument_list|()
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
name|enableovrflo
argument_list|()
expr_stmt|;
name|pc
operator|.
name|cp
operator|+=
operator|(
name|int
operator|)
name|tl
expr_stmt|;
comment|/* skip over proc hdr info */
name|stp
operator|->
name|file
operator|=
name|curfile
expr_stmt|;
comment|/* save active file */
name|tcp
operator|=
name|pushsp
argument_list|(
name|tl1
argument_list|)
expr_stmt|;
comment|/* tcp = new top of stack */
if|if
condition|(
name|_runtst
condition|)
comment|/* zero stack frame */
name|blkclr
argument_list|(
name|tcp
argument_list|,
name|tl1
argument_list|)
expr_stmt|;
name|tcp
operator|+=
operator|(
name|int
operator|)
name|tl1
expr_stmt|;
comment|/* offsets of locals are neg */
name|_dp
operator|->
name|locvars
operator|=
name|tcp
expr_stmt|;
comment|/* set new display pointer */
name|_dp
operator|->
name|stp
operator|=
name|stp
expr_stmt|;
name|stp
operator|->
name|tos
operator|=
name|pushsp
argument_list|(
operator|(
name|long
operator|)
literal|0
argument_list|)
expr_stmt|;
comment|/* set tos pointer */
continue|continue;
case|case
name|O_END
case|:
name|PCLOSE
argument_list|(
name|_dp
operator|->
name|locvars
argument_list|)
expr_stmt|;
comment|/* flush& close local files */
name|stp
operator|=
name|_dp
operator|->
name|stp
expr_stmt|;
name|curfile
operator|=
name|stp
operator|->
name|file
expr_stmt|;
comment|/* restore old active file */
operator|*
name|_dp
operator|=
name|stp
operator|->
name|odisp
expr_stmt|;
comment|/* restore old display entry */
if|if
condition|(
name|_dp
operator|==
operator|&
name|_display
operator|.
name|frame
index|[
literal|1
index|]
condition|)
return|return;
comment|/* exiting main proc ??? */
name|_lino
operator|=
name|stp
operator|->
name|lino
expr_stmt|;
comment|/* restore lino, pc, dp */
name|pc
operator|.
name|cp
operator|=
name|stp
operator|->
name|pc
expr_stmt|;
name|_dp
operator|=
name|stp
operator|->
name|dp
expr_stmt|;
name|_runtst
operator|=
name|stp
operator|->
name|entry
operator|->
name|tests
expr_stmt|;
name|disableovrflo
argument_list|()
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
name|enableovrflo
argument_list|()
expr_stmt|;
name|popsp
argument_list|(
name|stp
operator|->
name|entry
operator|->
name|framesze
operator|+
comment|/* pop local vars */
sizeof|sizeof
argument_list|(
expr|struct
name|blockmark
argument_list|)
operator|+
comment|/* pop stack frame */
name|stp
operator|->
name|entry
operator|->
name|nargs
argument_list|)
expr_stmt|;
comment|/* pop parms */
continue|continue;
case|case
name|O_CALL
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tcp
operator|=
name|base
operator|+
operator|*
name|pc
operator|.
name|lp
operator|++
expr_stmt|;
comment|/* calc new entry point */
name|tcp
operator|+=
sizeof|sizeof
argument_list|(
name|short
argument_list|)
expr_stmt|;
name|tcp
operator|=
name|base
operator|+
operator|*
operator|(
name|long
operator|*
operator|)
name|tcp
expr_stmt|;
name|stp
operator|=
operator|(
expr|struct
name|blockmark
operator|*
operator|)
name|pushsp
argument_list|(
call|(
name|long
call|)
argument_list|(
sizeof|sizeof
argument_list|(
expr|struct
name|blockmark
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|stp
operator|->
name|lino
operator|=
name|_lino
expr_stmt|;
comment|/* save lino, pc, dp */
name|stp
operator|->
name|pc
operator|=
name|pc
operator|.
name|cp
expr_stmt|;
name|stp
operator|->
name|dp
operator|=
name|_dp
expr_stmt|;
name|_dp
operator|=
operator|&
name|_display
operator|.
name|frame
index|[
name|tl
index|]
expr_stmt|;
comment|/* set up new display ptr */
name|pc
operator|.
name|cp
operator|=
name|tcp
expr_stmt|;
continue|continue;
case|case
name|O_FCALL
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
comment|/* ptr to display save area */
name|tfp
operator|=
operator|(
expr|struct
name|formalrtn
operator|*
operator|)
name|popaddr
argument_list|()
expr_stmt|;
name|stp
operator|=
operator|(
expr|struct
name|blockmark
operator|*
operator|)
name|pushsp
argument_list|(
call|(
name|long
call|)
argument_list|(
sizeof|sizeof
argument_list|(
expr|struct
name|blockmark
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|stp
operator|->
name|lino
operator|=
name|_lino
expr_stmt|;
comment|/* save lino, pc, dp */
name|stp
operator|->
name|pc
operator|=
name|pc
operator|.
name|cp
expr_stmt|;
name|stp
operator|->
name|dp
operator|=
name|_dp
expr_stmt|;
name|pc
operator|.
name|cp
operator|=
operator|(
name|char
operator|*
operator|)
operator|(
name|tfp
operator|->
name|fentryaddr
operator|)
expr_stmt|;
comment|/* new entry point */
name|_dp
operator|=
operator|&
name|_display
operator|.
name|frame
index|[
name|tfp
operator|->
name|fbn
index|]
expr_stmt|;
comment|/* new display ptr */
name|blkcpy
argument_list|(
operator|&
name|_display
operator|.
name|frame
index|[
literal|1
index|]
argument_list|,
name|tcp
argument_list|,
name|tfp
operator|->
name|fbn
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|dispsave
argument_list|)
argument_list|)
expr_stmt|;
name|blkcpy
argument_list|(
operator|&
name|tfp
operator|->
name|fdisp
index|[
literal|0
index|]
argument_list|,
operator|&
name|_display
operator|.
name|frame
index|[
literal|1
index|]
argument_list|,
name|tfp
operator|->
name|fbn
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|dispsave
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_FRTN
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl = size of return obj */
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tcp
operator|=
name|pushsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|tfp
operator|=
operator|*
operator|(
expr|struct
name|formalrtn
operator|*
operator|*
operator|)
operator|(
name|tcp
operator|+
name|tl
operator|)
expr_stmt|;
name|tcp1
operator|=
operator|*
operator|(
name|char
operator|*
operator|*
operator|)
operator|(
name|tcp
operator|+
name|tl
operator|+
sizeof|sizeof
argument_list|(
expr|struct
name|formalrtn
operator|*
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
name|tl
operator|!=
literal|0
condition|)
block|{
name|blkcpy
argument_list|(
name|tcp
argument_list|,
name|tcp
operator|+
sizeof|sizeof
argument_list|(
expr|struct
name|formalrtn
operator|*
argument_list|)
operator|+
sizeof|sizeof
argument_list|(
name|char
operator|*
argument_list|)
argument_list|,
name|tl
argument_list|)
expr_stmt|;
block|}
name|popsp
argument_list|(
call|(
name|long
call|)
argument_list|(
sizeof|sizeof
argument_list|(
expr|struct
name|formalrtn
operator|*
argument_list|)
operator|+
sizeof|sizeof
argument_list|(
name|char
operator|*
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|blkcpy
argument_list|(
name|tcp1
argument_list|,
operator|&
name|_display
operator|.
name|frame
index|[
literal|1
index|]
argument_list|,
name|tfp
operator|->
name|fbn
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|dispsave
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_FSAV
case|:
name|tfp
operator|=
operator|(
expr|struct
name|formalrtn
operator|*
operator|)
name|popaddr
argument_list|()
expr_stmt|;
name|tfp
operator|->
name|fbn
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* blk number of routine */
name|tcp
operator|=
name|base
operator|+
operator|*
name|pc
operator|.
name|lp
operator|++
expr_stmt|;
comment|/* calc new entry point */
name|tcp
operator|+=
sizeof|sizeof
argument_list|(
name|short
argument_list|)
expr_stmt|;
name|tfp
operator|->
name|fentryaddr
operator|=
operator|(
name|long
argument_list|(
operator|*
argument_list|)
argument_list|()
operator|)
operator|(
name|base
operator|+
operator|*
operator|(
name|long
operator|*
operator|)
name|tcp
operator|)
expr_stmt|;
name|blkcpy
argument_list|(
operator|&
name|_display
operator|.
name|frame
index|[
literal|1
index|]
argument_list|,
operator|&
name|tfp
operator|->
name|fdisp
index|[
literal|0
index|]
argument_list|,
name|tfp
operator|->
name|fbn
operator|*
sizeof|sizeof
argument_list|(
expr|struct
name|dispsave
argument_list|)
argument_list|)
expr_stmt|;
name|pushaddr
argument_list|(
name|tfp
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SDUP2
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|tl
argument_list|)
argument_list|)
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|tl
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SDUP4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl
argument_list|)
expr_stmt|;
name|push4
argument_list|(
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_TRA
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|pc
operator|.
name|cp
operator|+=
operator|*
name|pc
operator|.
name|sp
expr_stmt|;
continue|continue;
case|case
name|O_TRA4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|pc
operator|.
name|cp
operator|=
name|base
operator|+
operator|*
name|pc
operator|.
name|lp
expr_stmt|;
continue|continue;
case|case
name|O_GOTO
case|:
name|tstp
operator|=
name|_display
operator|.
name|frame
index|[
operator|*
name|pc
operator|.
name|cp
operator|++
index|]
operator|.
name|stp
expr_stmt|;
comment|/* ptr to 								exit frame */
name|pc
operator|.
name|cp
operator|=
name|base
operator|+
operator|*
name|pc
operator|.
name|lp
expr_stmt|;
name|stp
operator|=
name|_dp
operator|->
name|stp
expr_stmt|;
while|while
condition|(
name|tstp
operator|!=
name|stp
condition|)
block|{
if|if
condition|(
name|_dp
operator|==
operator|&
name|_display
operator|.
name|frame
index|[
literal|1
index|]
condition|)
name|ERROR
argument_list|(
literal|"Active frame not found in non-local goto\n"
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|/* exiting prog ??? */
name|PCLOSE
argument_list|(
name|_dp
operator|->
name|locvars
argument_list|)
expr_stmt|;
comment|/* close local files */
name|curfile
operator|=
name|stp
operator|->
name|file
expr_stmt|;
comment|/* restore active file */
operator|*
name|_dp
operator|=
name|stp
operator|->
name|odisp
expr_stmt|;
comment|/* old display entry */
name|_dp
operator|=
name|stp
operator|->
name|dp
expr_stmt|;
comment|/* restore dp */
name|stp
operator|=
name|_dp
operator|->
name|stp
expr_stmt|;
block|}
comment|/* pop locals, stack frame, parms, and return values */
name|popsp
argument_list|(
call|(
name|long
call|)
argument_list|(
name|stp
operator|->
name|tos
operator|-
name|pushsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|0
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_LINO
case|:
if|if
condition|(
name|_dp
operator|->
name|stp
operator|->
name|tos
operator|!=
name|pushsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|0
argument_list|)
argument_list|)
condition|)
name|ERROR
argument_list|(
literal|"Panic: stack not empty between statements\n"
argument_list|)
expr_stmt|;
name|_lino
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* set line number */
if|if
condition|(
name|_lino
operator|==
literal|0
condition|)
name|_lino
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|LINO
argument_list|()
expr_stmt|;
comment|/* inc statement count */
continue|continue;
block|}
name|_stcnt
operator|++
expr_stmt|;
continue|continue;
case|case
name|O_PUSH
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|lp
operator|++
expr_stmt|;
name|tl
operator|=
operator|(
operator|-
name|tl
operator|+
literal|1
operator|)
operator|&
operator|~
literal|1
expr_stmt|;
name|tcp
operator|=
name|pushsp
argument_list|(
name|tl
argument_list|)
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
name|blkclr
argument_list|(
name|tcp
argument_list|,
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_IF
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|pop2
argument_list|()
condition|)
block|{
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
continue|continue;
block|}
name|pc
operator|.
name|cp
operator|+=
operator|*
name|pc
operator|.
name|sp
expr_stmt|;
continue|continue;
case|case
name|O_REL2
case|:
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
goto|goto
name|cmplong
goto|;
case|case
name|O_REL24
case|:
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
goto|goto
name|cmplong
goto|;
case|case
name|O_REL42
case|:
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
goto|goto
name|cmplong
goto|;
case|case
name|O_REL4
case|:
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|cmplong
label|:
switch|switch
condition|(
operator|*
name|pc
operator|.
name|cp
operator|++
condition|)
block|{
case|case
name|releq
case|:
name|push2
argument_list|(
name|tl1
operator|==
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|relne
case|:
name|push2
argument_list|(
name|tl1
operator|!=
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|rellt
case|:
name|push2
argument_list|(
name|tl1
operator|<
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|relgt
case|:
name|push2
argument_list|(
name|tl1
operator|>
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|relle
case|:
name|push2
argument_list|(
name|tl1
operator|<=
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|relge
case|:
name|push2
argument_list|(
name|tl1
operator|>=
name|tl
argument_list|)
expr_stmt|;
continue|continue;
default|default:
name|ERROR
argument_list|(
literal|"Panic: bad relation %d to REL4*\n"
argument_list|,
operator|*
operator|(
name|pc
operator|.
name|cp
operator|-
literal|1
operator|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
case|case
name|O_RELG
case|:
name|tl2
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tc has jump opcode */
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
comment|/* tl has comparison length */
name|tl1
operator|=
operator|(
name|tl
operator|+
literal|1
operator|)
operator|&
operator|~
literal|1
expr_stmt|;
comment|/* tl1 has arg stack length */
name|tcp
operator|=
name|pushsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
comment|/* tcp pts to first arg */
switch|switch
condition|(
name|tl2
condition|)
block|{
case|case
name|releq
case|:
name|tb
operator|=
name|RELEQ
argument_list|(
name|tl
argument_list|,
name|tcp
operator|+
name|tl1
argument_list|,
name|tcp
argument_list|)
expr_stmt|;
break|break;
case|case
name|relne
case|:
name|tb
operator|=
name|RELNE
argument_list|(
name|tl
argument_list|,
name|tcp
operator|+
name|tl1
argument_list|,
name|tcp
argument_list|)
expr_stmt|;
break|break;
case|case
name|rellt
case|:
name|tb
operator|=
name|RELSLT
argument_list|(
name|tl
argument_list|,
name|tcp
operator|+
name|tl1
argument_list|,
name|tcp
argument_list|)
expr_stmt|;
break|break;
case|case
name|relgt
case|:
name|tb
operator|=
name|RELSGT
argument_list|(
name|tl
argument_list|,
name|tcp
operator|+
name|tl1
argument_list|,
name|tcp
argument_list|)
expr_stmt|;
break|break;
case|case
name|relle
case|:
name|tb
operator|=
name|RELSLE
argument_list|(
name|tl
argument_list|,
name|tcp
operator|+
name|tl1
argument_list|,
name|tcp
argument_list|)
expr_stmt|;
break|break;
case|case
name|relge
case|:
name|tb
operator|=
name|RELSGE
argument_list|(
name|tl
argument_list|,
name|tcp
operator|+
name|tl1
argument_list|,
name|tcp
argument_list|)
expr_stmt|;
break|break;
default|default:
name|ERROR
argument_list|(
literal|"Panic: bad relation %d to RELG*\n"
argument_list|,
name|tl2
argument_list|)
expr_stmt|;
break|break;
block|}
name|popsp
argument_list|(
name|tl1
operator|<<
literal|1
argument_list|)
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|tb
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_RELT
case|:
name|tl2
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tc has jump opcode */
name|tl1
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
comment|/* tl1 has comparison length */
name|tcp
operator|=
name|pushsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
comment|/* tcp pts to first arg */
switch|switch
condition|(
name|tl2
condition|)
block|{
case|case
name|releq
case|:
name|tb
operator|=
name|RELEQ
argument_list|(
name|tl1
argument_list|,
name|tcp
operator|+
name|tl1
argument_list|,
name|tcp
argument_list|)
expr_stmt|;
break|break;
case|case
name|relne
case|:
name|tb
operator|=
name|RELNE
argument_list|(
name|tl1
argument_list|,
name|tcp
operator|+
name|tl1
argument_list|,
name|tcp
argument_list|)
expr_stmt|;
break|break;
case|case
name|rellt
case|:
name|tb
operator|=
name|RELTLT
argument_list|(
name|tl1
argument_list|,
name|tcp
operator|+
name|tl1
argument_list|,
name|tcp
argument_list|)
expr_stmt|;
break|break;
case|case
name|relgt
case|:
name|tb
operator|=
name|RELTGT
argument_list|(
name|tl1
argument_list|,
name|tcp
operator|+
name|tl1
argument_list|,
name|tcp
argument_list|)
expr_stmt|;
break|break;
case|case
name|relle
case|:
name|tb
operator|=
name|RELTLE
argument_list|(
name|tl1
argument_list|,
name|tcp
operator|+
name|tl1
argument_list|,
name|tcp
argument_list|)
expr_stmt|;
break|break;
case|case
name|relge
case|:
name|tb
operator|=
name|RELTGE
argument_list|(
name|tl1
argument_list|,
name|tcp
operator|+
name|tl1
argument_list|,
name|tcp
argument_list|)
expr_stmt|;
break|break;
default|default:
name|ERROR
argument_list|(
literal|"Panic: bad relation %d to RELT*\n"
argument_list|,
name|tl2
argument_list|)
expr_stmt|;
break|break;
block|}
name|popsp
argument_list|(
name|tl1
operator|<<
literal|1
argument_list|)
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|tb
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_REL28
case|:
name|td
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop8
argument_list|()
expr_stmt|;
goto|goto
name|cmpdbl
goto|;
case|case
name|O_REL48
case|:
name|td
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop8
argument_list|()
expr_stmt|;
goto|goto
name|cmpdbl
goto|;
case|case
name|O_REL82
case|:
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop2
argument_list|()
expr_stmt|;
goto|goto
name|cmpdbl
goto|;
case|case
name|O_REL84
case|:
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop4
argument_list|()
expr_stmt|;
goto|goto
name|cmpdbl
goto|;
case|case
name|O_REL8
case|:
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|cmpdbl
label|:
switch|switch
condition|(
operator|*
name|pc
operator|.
name|cp
operator|++
condition|)
block|{
case|case
name|releq
case|:
name|push2
argument_list|(
name|td1
operator|==
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|relne
case|:
name|push2
argument_list|(
name|td1
operator|!=
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|rellt
case|:
name|push2
argument_list|(
name|td1
operator|<
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|relgt
case|:
name|push2
argument_list|(
name|td1
operator|>
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|relle
case|:
name|push2
argument_list|(
name|td1
operator|<=
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|relge
case|:
name|push2
argument_list|(
name|td1
operator|>=
name|td
argument_list|)
expr_stmt|;
continue|continue;
default|default:
name|ERROR
argument_list|(
literal|"Panic: bad relation %d to REL8*\n"
argument_list|,
operator|*
operator|(
name|pc
operator|.
name|cp
operator|-
literal|1
operator|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
case|case
name|O_AND
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push2
argument_list|(
name|tl1
operator|&
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_OR
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push2
argument_list|(
name|tl1
operator||
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_NOT
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push2
argument_list|(
name|tl
operator|^
literal|1
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_AS2
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
operator|*
operator|(
name|short
operator|*
operator|)
name|popaddr
argument_list|()
operator|=
name|tl
expr_stmt|;
continue|continue;
case|case
name|O_AS4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
operator|*
operator|(
name|long
operator|*
operator|)
name|popaddr
argument_list|()
operator|=
name|tl
expr_stmt|;
continue|continue;
case|case
name|O_AS24
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
operator|*
operator|(
name|long
operator|*
operator|)
name|popaddr
argument_list|()
operator|=
name|tl
expr_stmt|;
continue|continue;
case|case
name|O_AS42
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
operator|*
operator|(
name|short
operator|*
operator|)
name|popaddr
argument_list|()
operator|=
name|tl
expr_stmt|;
continue|continue;
case|case
name|O_AS21
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
operator|*
name|popaddr
argument_list|()
operator|=
name|tl
expr_stmt|;
continue|continue;
case|case
name|O_AS41
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
operator|*
name|popaddr
argument_list|()
operator|=
name|tl
expr_stmt|;
continue|continue;
case|case
name|O_AS28
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
operator|*
operator|(
name|double
operator|*
operator|)
name|popaddr
argument_list|()
operator|=
name|tl
expr_stmt|;
continue|continue;
case|case
name|O_AS48
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
operator|*
operator|(
name|double
operator|*
operator|)
name|popaddr
argument_list|()
operator|=
name|tl
expr_stmt|;
continue|continue;
case|case
name|O_AS8
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|t8
operator|=
name|popsze8
argument_list|()
expr_stmt|;
operator|*
operator|(
expr|struct
name|sze8
operator|*
operator|)
name|popaddr
argument_list|()
operator|=
name|t8
expr_stmt|;
continue|continue;
case|case
name|O_AS
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tl1
operator|=
operator|(
name|tl
operator|+
literal|1
operator|)
operator|&
operator|~
literal|1
expr_stmt|;
name|tcp
operator|=
name|pushsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
name|blkcpy
argument_list|(
name|tcp
argument_list|,
operator|*
operator|(
name|char
operator|*
operator|*
operator|)
operator|(
name|tcp
operator|+
name|tl1
operator|)
argument_list|,
name|tl
argument_list|)
expr_stmt|;
name|popsp
argument_list|(
name|tl1
operator|+
sizeof|sizeof
argument_list|(
name|char
operator|*
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_VAS
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|tcp1
operator|=
name|popaddr
argument_list|()
expr_stmt|;
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
name|blkcpy
argument_list|(
name|tcp1
argument_list|,
name|tcp
argument_list|,
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_INX2P2
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl has shift amount */
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|tl1
operator|=
operator|(
name|tl1
operator|-
operator|*
name|pc
operator|.
name|sp
operator|++
operator|)
operator|<<
name|tl
expr_stmt|;
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
name|pushaddr
argument_list|(
name|tcp
operator|+
name|tl1
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_INX4P2
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl has shift amount */
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|tl1
operator|=
operator|(
name|tl1
operator|-
operator|*
name|pc
operator|.
name|sp
operator|++
operator|)
operator|<<
name|tl
expr_stmt|;
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
name|pushaddr
argument_list|(
name|tcp
operator|+
name|tl1
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_INX2
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl has element size */
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
comment|/* index */
name|tl2
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
name|pushaddr
argument_list|(
name|tcp
operator|+
operator|(
name|tl1
operator|-
name|tl2
operator|)
operator|*
name|tl
argument_list|)
expr_stmt|;
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
name|SUBSC
argument_list|(
name|tl1
argument_list|,
name|tl2
argument_list|,
name|tl
argument_list|)
expr_stmt|;
comment|/* range check */
continue|continue;
case|case
name|O_INX4
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl has element size */
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* index */
name|tl2
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
name|pushaddr
argument_list|(
name|tcp
operator|+
operator|(
name|tl1
operator|-
name|tl2
operator|)
operator|*
name|tl
argument_list|)
expr_stmt|;
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
name|SUBSC
argument_list|(
name|tl1
argument_list|,
name|tl2
argument_list|,
name|tl
argument_list|)
expr_stmt|;
comment|/* range check */
continue|continue;
case|case
name|O_VINX2
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
comment|/* tl has element size */
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
comment|/* upper bound */
name|tl2
operator|=
name|pop2
argument_list|()
expr_stmt|;
comment|/* lower bound */
name|tl3
operator|=
name|pop2
argument_list|()
expr_stmt|;
comment|/* index */
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
name|pushaddr
argument_list|(
name|tcp
operator|+
operator|(
name|tl3
operator|-
name|tl2
operator|)
operator|*
name|tl
argument_list|)
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
name|SUBSC
argument_list|(
name|tl3
argument_list|,
name|tl2
argument_list|,
name|tl1
argument_list|)
expr_stmt|;
comment|/* range check */
continue|continue;
case|case
name|O_VINX24
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
comment|/* tl has element size */
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
comment|/* upper bound */
name|tl2
operator|=
name|pop2
argument_list|()
expr_stmt|;
comment|/* lower bound */
name|tl3
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* index */
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
name|pushaddr
argument_list|(
name|tcp
operator|+
operator|(
name|tl3
operator|-
name|tl2
operator|)
operator|*
name|tl
argument_list|)
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
name|SUBSC
argument_list|(
name|tl3
argument_list|,
name|tl2
argument_list|,
name|tl1
argument_list|)
expr_stmt|;
comment|/* range check */
continue|continue;
case|case
name|O_VINX42
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* tl has element size */
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* upper bound */
name|tl2
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* lower bound */
name|tl3
operator|=
name|pop2
argument_list|()
expr_stmt|;
comment|/* index */
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
name|pushaddr
argument_list|(
name|tcp
operator|+
operator|(
name|tl3
operator|-
name|tl2
operator|)
operator|*
name|tl
argument_list|)
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
name|SUBSC
argument_list|(
name|tl3
argument_list|,
name|tl2
argument_list|,
name|tl1
argument_list|)
expr_stmt|;
comment|/* range check */
continue|continue;
case|case
name|O_VINX4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* tl has element size */
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* upper bound */
name|tl2
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* lower bound */
name|tl3
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* index */
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
name|pushaddr
argument_list|(
name|tcp
operator|+
operator|(
name|tl3
operator|-
name|tl2
operator|)
operator|*
name|tl
argument_list|)
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
name|SUBSC
argument_list|(
name|tl3
argument_list|,
name|tl2
argument_list|,
name|tl1
argument_list|)
expr_stmt|;
comment|/* range check */
continue|continue;
case|case
name|O_OFF
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
name|pushaddr
argument_list|(
name|tcp
operator|+
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_NIL
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
name|NIL
argument_list|(
name|tcp
argument_list|)
expr_stmt|;
name|pushaddr
argument_list|(
name|tcp
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ADD2
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|+
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ADD4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|+
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ADD24
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|+
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ADD42
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|+
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ADD28
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td
operator|+
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ADD48
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td
operator|+
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ADD82
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|+
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ADD84
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|+
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SUB2
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|-
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SUB4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|-
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SUB24
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|-
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SUB42
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|-
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SUB28
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td
operator|-
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SUB48
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td
operator|-
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SUB82
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|-
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SUB84
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|-
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_MUL2
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|*
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_MUL4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|*
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_MUL24
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|*
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_MUL42
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|*
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_MUL28
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td
operator|*
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_MUL48
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td
operator|*
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_MUL82
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|*
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_MUL84
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|*
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ABS2
case|:
case|case
name|O_ABS4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl
operator|>=
literal|0
condition|?
name|tl
else|:
operator|-
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ABS8
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td
operator|>=
literal|0.0
condition|?
name|td
else|:
operator|-
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_NEG2
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push4
argument_list|(
call|(
name|long
call|)
argument_list|(
operator|-
name|pop2
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_NEG4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push4
argument_list|(
operator|-
name|pop4
argument_list|()
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_NEG8
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push8
argument_list|(
operator|-
name|pop8
argument_list|()
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_DIV2
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|/
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_DIV4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|/
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_DIV24
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|/
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_DIV42
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|/
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_MOD2
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|%
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_MOD4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|%
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_MOD24
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|%
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_MOD42
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|%
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ADD8
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|+
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SUB8
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|-
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_MUL8
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|*
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_DVD8
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|/
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_STOI
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push4
argument_list|(
call|(
name|long
call|)
argument_list|(
name|pop2
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_STOD
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ITOD
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ITOS
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|pop4
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_DVD2
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|/
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_DVD4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|/
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_DVD24
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|/
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_DVD42
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|/
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_DVD28
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|/
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_DVD48
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|/
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_DVD82
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|/
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_DVD84
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|td1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td1
operator|/
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_RV1
case|:
name|tcp
operator|=
name|_display
operator|.
name|raw
index|[
operator|*
name|pc
operator|.
name|ucp
operator|++
index|]
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
operator|*
operator|(
name|tcp
operator|+
operator|*
name|pc
operator|.
name|sp
operator|++
operator|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_RV14
case|:
name|tcp
operator|=
name|_display
operator|.
name|raw
index|[
operator|*
name|pc
operator|.
name|ucp
operator|++
index|]
expr_stmt|;
name|push4
argument_list|(
call|(
name|long
call|)
argument_list|(
operator|*
operator|(
name|tcp
operator|+
operator|*
name|pc
operator|.
name|sp
operator|++
operator|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_RV2
case|:
name|tcp
operator|=
name|_display
operator|.
name|raw
index|[
operator|*
name|pc
operator|.
name|ucp
operator|++
index|]
expr_stmt|;
name|push2
argument_list|(
operator|*
operator|(
name|short
operator|*
operator|)
operator|(
name|tcp
operator|+
operator|*
name|pc
operator|.
name|sp
operator|++
operator|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_RV24
case|:
name|tcp
operator|=
name|_display
operator|.
name|raw
index|[
operator|*
name|pc
operator|.
name|ucp
operator|++
index|]
expr_stmt|;
name|push4
argument_list|(
call|(
name|long
call|)
argument_list|(
operator|*
operator|(
name|short
operator|*
operator|)
operator|(
name|tcp
operator|+
operator|*
name|pc
operator|.
name|sp
operator|++
operator|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_RV4
case|:
name|tcp
operator|=
name|_display
operator|.
name|raw
index|[
operator|*
name|pc
operator|.
name|ucp
operator|++
index|]
expr_stmt|;
name|push4
argument_list|(
operator|*
operator|(
name|long
operator|*
operator|)
operator|(
name|tcp
operator|+
operator|*
name|pc
operator|.
name|sp
operator|++
operator|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_RV8
case|:
name|tcp
operator|=
name|_display
operator|.
name|raw
index|[
operator|*
name|pc
operator|.
name|ucp
operator|++
index|]
expr_stmt|;
name|pushsze8
argument_list|(
operator|*
operator|(
expr|struct
name|sze8
operator|*
operator|)
operator|(
name|tcp
operator|+
operator|*
name|pc
operator|.
name|sp
operator|++
operator|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_RV
case|:
name|tcp
operator|=
name|_display
operator|.
name|raw
index|[
operator|*
name|pc
operator|.
name|ucp
operator|++
index|]
expr_stmt|;
name|tcp
operator|+=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tcp1
operator|=
name|pushsp
argument_list|(
operator|(
name|tl
operator|+
literal|1
operator|)
operator|&
operator|~
literal|1
argument_list|)
expr_stmt|;
name|blkcpy
argument_list|(
name|tcp
argument_list|,
name|tcp1
argument_list|,
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_LV
case|:
name|tcp
operator|=
name|_display
operator|.
name|raw
index|[
operator|*
name|pc
operator|.
name|ucp
operator|++
index|]
expr_stmt|;
name|pushaddr
argument_list|(
name|tcp
operator|+
operator|*
name|pc
operator|.
name|sp
operator|++
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_LRV1
case|:
name|tcp
operator|=
name|_display
operator|.
name|raw
index|[
operator|*
name|pc
operator|.
name|ucp
operator|++
index|]
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
operator|*
operator|(
name|tcp
operator|+
operator|*
name|pc
operator|.
name|lp
operator|++
operator|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_LRV14
case|:
name|tcp
operator|=
name|_display
operator|.
name|raw
index|[
operator|*
name|pc
operator|.
name|ucp
operator|++
index|]
expr_stmt|;
name|push4
argument_list|(
call|(
name|long
call|)
argument_list|(
operator|*
operator|(
name|tcp
operator|+
operator|*
name|pc
operator|.
name|lp
operator|++
operator|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_LRV2
case|:
name|tcp
operator|=
name|_display
operator|.
name|raw
index|[
operator|*
name|pc
operator|.
name|ucp
operator|++
index|]
expr_stmt|;
name|push2
argument_list|(
operator|*
operator|(
name|short
operator|*
operator|)
operator|(
name|tcp
operator|+
operator|*
name|pc
operator|.
name|lp
operator|++
operator|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_LRV24
case|:
name|tcp
operator|=
name|_display
operator|.
name|raw
index|[
operator|*
name|pc
operator|.
name|ucp
operator|++
index|]
expr_stmt|;
name|push4
argument_list|(
call|(
name|long
call|)
argument_list|(
operator|*
operator|(
name|short
operator|*
operator|)
operator|(
name|tcp
operator|+
operator|*
name|pc
operator|.
name|lp
operator|++
operator|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_LRV4
case|:
name|tcp
operator|=
name|_display
operator|.
name|raw
index|[
operator|*
name|pc
operator|.
name|ucp
operator|++
index|]
expr_stmt|;
name|push4
argument_list|(
operator|*
operator|(
name|long
operator|*
operator|)
operator|(
name|tcp
operator|+
operator|*
name|pc
operator|.
name|lp
operator|++
operator|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_LRV8
case|:
name|tcp
operator|=
name|_display
operator|.
name|raw
index|[
operator|*
name|pc
operator|.
name|ucp
operator|++
index|]
expr_stmt|;
name|pushsze8
argument_list|(
operator|*
operator|(
expr|struct
name|sze8
operator|*
operator|)
operator|(
name|tcp
operator|+
operator|*
name|pc
operator|.
name|lp
operator|++
operator|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_LRV
case|:
name|tcp
operator|=
name|_display
operator|.
name|raw
index|[
operator|*
name|pc
operator|.
name|ucp
operator|++
index|]
expr_stmt|;
name|tcp
operator|+=
operator|(
name|int
operator|)
operator|*
name|pc
operator|.
name|lp
operator|++
expr_stmt|;
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tcp1
operator|=
name|pushsp
argument_list|(
operator|(
name|tl
operator|+
literal|1
operator|)
operator|&
operator|~
literal|1
argument_list|)
expr_stmt|;
name|blkcpy
argument_list|(
name|tcp
argument_list|,
name|tcp1
argument_list|,
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_LLV
case|:
name|tcp
operator|=
name|_display
operator|.
name|raw
index|[
operator|*
name|pc
operator|.
name|ucp
operator|++
index|]
expr_stmt|;
name|pushaddr
argument_list|(
name|tcp
operator|+
operator|*
name|pc
operator|.
name|lp
operator|++
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_IND1
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
operator|*
name|popaddr
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_IND14
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push4
argument_list|(
call|(
name|long
call|)
argument_list|(
operator|*
name|popaddr
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_IND2
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push2
argument_list|(
operator|*
operator|(
name|short
operator|*
operator|)
operator|(
name|popaddr
argument_list|()
operator|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_IND24
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push4
argument_list|(
call|(
name|long
call|)
argument_list|(
operator|*
operator|(
name|short
operator|*
operator|)
operator|(
name|popaddr
argument_list|()
operator|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_IND4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push4
argument_list|(
operator|*
operator|(
name|long
operator|*
operator|)
operator|(
name|popaddr
argument_list|()
operator|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_IND8
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|pushsze8
argument_list|(
operator|*
operator|(
expr|struct
name|sze8
operator|*
operator|)
operator|(
name|popaddr
argument_list|()
operator|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_IND
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
name|tcp1
operator|=
name|pushsp
argument_list|(
operator|(
name|tl
operator|+
literal|1
operator|)
operator|&
operator|~
literal|1
argument_list|)
expr_stmt|;
name|blkcpy
argument_list|(
name|tcp
argument_list|,
name|tcp1
argument_list|,
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_CON1
case|:
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
operator|*
name|pc
operator|.
name|cp
operator|++
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_CON14
case|:
name|push4
argument_list|(
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|cp
operator|++
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_CON2
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push2
argument_list|(
operator|*
name|pc
operator|.
name|sp
operator|++
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_CON24
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push4
argument_list|(
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|sp
operator|++
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_CON4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push4
argument_list|(
operator|*
name|pc
operator|.
name|lp
operator|++
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_CON8
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push8
argument_list|(
operator|*
name|pc
operator|.
name|dbp
operator|++
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_CON
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tl
operator|=
operator|(
name|tl
operator|+
literal|1
operator|)
operator|&
operator|~
literal|1
expr_stmt|;
name|tcp
operator|=
name|pushsp
argument_list|(
name|tl
argument_list|)
expr_stmt|;
name|blkcpy
argument_list|(
name|pc
operator|.
name|cp
argument_list|,
name|tcp
argument_list|,
name|tl
argument_list|)
expr_stmt|;
name|pc
operator|.
name|cp
operator|+=
operator|(
name|int
operator|)
name|tl
expr_stmt|;
continue|continue;
case|case
name|O_CONG
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tl1
operator|=
operator|(
name|tl
operator|+
literal|1
operator|)
operator|&
operator|~
literal|1
expr_stmt|;
name|tcp
operator|=
name|pushsp
argument_list|(
name|tl1
argument_list|)
expr_stmt|;
name|blkcpy
argument_list|(
name|pc
operator|.
name|cp
argument_list|,
name|tcp
argument_list|,
name|tl1
argument_list|)
expr_stmt|;
name|pc
operator|.
name|cp
operator|+=
call|(
name|int
call|)
argument_list|(
operator|(
name|tl
operator|+
literal|2
operator|)
operator|&
operator|~
literal|1
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_LVCON
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tl
operator|=
operator|(
name|tl
operator|+
literal|1
operator|)
operator|&
operator|~
literal|1
expr_stmt|;
name|pushaddr
argument_list|(
name|pc
operator|.
name|cp
argument_list|)
expr_stmt|;
name|pc
operator|.
name|cp
operator|+=
operator|(
name|int
operator|)
name|tl
expr_stmt|;
continue|continue;
case|case
name|O_RANG2
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|RANG4
argument_list|(
name|tl1
argument_list|,
name|tl
argument_list|,
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|sp
operator|++
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_RANG42
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|RANG4
argument_list|(
name|tl1
argument_list|,
name|tl
argument_list|,
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|sp
operator|++
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_RSNG2
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|RSNG4
argument_list|(
name|tl1
argument_list|,
name|tl
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_RSNG42
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|RSNG4
argument_list|(
name|tl1
argument_list|,
name|tl
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_RANG4
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|lp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|RANG4
argument_list|(
name|tl1
argument_list|,
name|tl
argument_list|,
operator|*
name|pc
operator|.
name|lp
operator|++
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_RANG24
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|lp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|RANG4
argument_list|(
name|tl1
argument_list|,
name|tl
argument_list|,
operator|*
name|pc
operator|.
name|lp
operator|++
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_RSNG4
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|lp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|RSNG4
argument_list|(
name|tl1
argument_list|,
name|tl
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_RSNG24
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|lp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|RSNG4
argument_list|(
name|tl1
argument_list|,
name|tl
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_STLIM
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|STLIM
argument_list|()
expr_stmt|;
name|popsp
argument_list|(
call|(
name|long
call|)
argument_list|(
sizeof|sizeof
argument_list|(
name|long
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_LLIMIT
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|LLIMIT
argument_list|()
expr_stmt|;
name|popsp
argument_list|(
call|(
name|long
call|)
argument_list|(
sizeof|sizeof
argument_list|(
name|char
operator|*
argument_list|)
operator|+
sizeof|sizeof
argument_list|(
name|long
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_BUFF
case|:
name|BUFF
argument_list|(
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|cp
operator|++
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_HALT
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|_nodump
operator|==
name|TRUE
condition|)
name|psexit
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|fputs
argument_list|(
literal|"\nCall to procedure halt\n"
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
name|backtrace
argument_list|(
literal|"Halted"
argument_list|)
expr_stmt|;
name|psexit
argument_list|(
literal|0
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_PXPBUF
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|_cntrs
operator|=
operator|*
name|pc
operator|.
name|lp
operator|++
expr_stmt|;
name|_rtns
operator|=
operator|*
name|pc
operator|.
name|lp
operator|++
expr_stmt|;
name|NEW
argument_list|(
operator|&
name|_pcpcount
argument_list|,
operator|(
name|_cntrs
operator|+
literal|1
operator|)
operator|*
sizeof|sizeof
argument_list|(
name|long
argument_list|)
argument_list|)
expr_stmt|;
name|blkclr
argument_list|(
name|_pcpcount
argument_list|,
operator|(
name|_cntrs
operator|+
literal|1
operator|)
operator|*
sizeof|sizeof
argument_list|(
name|long
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_COUNT
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|_pcpcount
index|[
operator|*
name|pc
operator|.
name|usp
operator|++
index|]
operator|++
expr_stmt|;
continue|continue;
case|case
name|O_CASE1OP
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl = number of cases */
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tsp
operator|=
name|pc
operator|.
name|sp
operator|+
name|tl
expr_stmt|;
comment|/* ptr to end of jump table */
name|tcp
operator|=
operator|(
name|char
operator|*
operator|)
name|tsp
expr_stmt|;
comment|/* tcp = ptr to case values */
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
comment|/* tl1 = element to find */
for|for
control|(
init|;
name|tl
operator|>
literal|0
condition|;
name|tl
operator|--
control|)
comment|/* look for element */
if|if
condition|(
name|tl1
operator|==
operator|*
name|tcp
operator|++
condition|)
break|break;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
comment|/* default case => error */
name|CASERNG
argument_list|(
name|tl1
argument_list|)
expr_stmt|;
name|pc
operator|.
name|cp
operator|+=
operator|*
operator|(
name|tsp
operator|-
name|tl
operator|)
expr_stmt|;
continue|continue;
case|case
name|O_CASE2OP
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl = number of cases */
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tsp
operator|=
name|pc
operator|.
name|sp
operator|+
name|tl
expr_stmt|;
comment|/* ptr to end of jump table */
name|tsp1
operator|=
name|tsp
expr_stmt|;
comment|/* tsp1 = ptr to case values */
name|tl1
operator|=
operator|(
name|unsigned
name|short
operator|)
name|pop2
argument_list|()
expr_stmt|;
comment|/* tl1 = element to find */
for|for
control|(
init|;
name|tl
operator|>
literal|0
condition|;
name|tl
operator|--
control|)
comment|/* look for element */
if|if
condition|(
name|tl1
operator|==
operator|*
name|tsp1
operator|++
condition|)
break|break;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
comment|/* default case => error */
name|CASERNG
argument_list|(
name|tl1
argument_list|)
expr_stmt|;
name|pc
operator|.
name|cp
operator|+=
operator|*
operator|(
name|tsp
operator|-
name|tl
operator|)
expr_stmt|;
continue|continue;
case|case
name|O_CASE4OP
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl = number of cases */
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tsp
operator|=
name|pc
operator|.
name|sp
operator|+
name|tl
expr_stmt|;
comment|/* ptr to end of jump table */
name|tlp
operator|=
operator|(
name|long
operator|*
operator|)
name|tsp
expr_stmt|;
comment|/* tlp = ptr to case values */
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* tl1 = element to find */
for|for
control|(
init|;
name|tl
operator|>
literal|0
condition|;
name|tl
operator|--
control|)
comment|/* look for element */
if|if
condition|(
name|tl1
operator|==
operator|*
name|tlp
operator|++
condition|)
break|break;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
comment|/* default case => error */
name|CASERNG
argument_list|(
name|tl1
argument_list|)
expr_stmt|;
name|pc
operator|.
name|cp
operator|+=
operator|*
operator|(
name|tsp
operator|-
name|tl
operator|)
expr_stmt|;
continue|continue;
case|case
name|O_ADDT
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl has comparison length */
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tcp
operator|=
name|pushsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
comment|/* tcp pts to first arg */
name|ADDT
argument_list|(
name|tcp
operator|+
name|tl
argument_list|,
name|tcp
operator|+
name|tl
argument_list|,
name|tcp
argument_list|,
name|tl
operator|>>
literal|2
argument_list|)
expr_stmt|;
name|popsp
argument_list|(
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SUBT
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl has comparison length */
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tcp
operator|=
name|pushsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
comment|/* tcp pts to first arg */
name|SUBT
argument_list|(
name|tcp
operator|+
name|tl
argument_list|,
name|tcp
operator|+
name|tl
argument_list|,
name|tcp
argument_list|,
name|tl
operator|>>
literal|2
argument_list|)
expr_stmt|;
name|popsp
argument_list|(
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_MULT
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl has comparison length */
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tcp
operator|=
name|pushsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
comment|/* tcp pts to first arg */
name|MULT
argument_list|(
name|tcp
operator|+
name|tl
argument_list|,
name|tcp
operator|+
name|tl
argument_list|,
name|tcp
argument_list|,
name|tl
operator|>>
literal|2
argument_list|)
expr_stmt|;
name|popsp
argument_list|(
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_INCT
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl has number of args */
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tb
operator|=
name|INCT
argument_list|()
expr_stmt|;
name|popsp
argument_list|(
name|tl
operator|*
sizeof|sizeof
argument_list|(
name|long
argument_list|)
argument_list|)
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|tb
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_CTTOT
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl has number of args */
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tl1
operator|=
name|tl
operator|*
sizeof|sizeof
argument_list|(
name|long
argument_list|)
expr_stmt|;
name|tcp
operator|=
name|pushsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|0
argument_list|)
argument_list|)
operator|+
name|tl1
expr_stmt|;
comment|/* tcp pts to result */
name|CTTOT
argument_list|(
name|tcp
argument_list|)
expr_stmt|;
name|popsp
argument_list|(
name|tl
operator|*
sizeof|sizeof
argument_list|(
name|long
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_CARD
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl has comparison length */
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tcp
operator|=
name|pushsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
comment|/* tcp pts to set */
name|tl1
operator|=
name|CARD
argument_list|(
name|tcp
argument_list|,
name|tl
argument_list|)
expr_stmt|;
name|popsp
argument_list|(
name|tl
argument_list|)
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|tl1
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_IN
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl has comparison length */
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* tl1 is the element */
name|tcp
operator|=
name|pushsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
comment|/* tcp pts to set */
name|tl2
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
comment|/* lower bound */
name|tb
operator|=
name|IN
argument_list|(
name|tl1
argument_list|,
name|tl2
argument_list|,
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|usp
operator|++
argument_list|)
argument_list|,
name|tcp
argument_list|)
expr_stmt|;
name|popsp
argument_list|(
name|tl
argument_list|)
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|tb
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ASRT
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
name|ASRTS
argument_list|(
name|tl
argument_list|,
name|tcp
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_FOR1U
case|:
name|tl1
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl1 loop branch */
if|if
condition|(
name|tl1
operator|==
literal|0
condition|)
name|tl1
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
comment|/* tcp = ptr to index var */
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* tl upper bound */
if|if
condition|(
operator|*
name|tcp
operator|==
name|tl
condition|)
comment|/* loop is done, fall through */
continue|continue;
operator|*
name|tcp
operator|+=
literal|1
expr_stmt|;
comment|/* inc index var */
name|pc
operator|.
name|cp
operator|+=
name|tl1
expr_stmt|;
comment|/* return to top of loop */
continue|continue;
case|case
name|O_FOR2U
case|:
name|tl1
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl1 loop branch */
if|if
condition|(
name|tl1
operator|==
literal|0
condition|)
name|tl1
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
name|tsp
operator|=
operator|(
name|short
operator|*
operator|)
name|popaddr
argument_list|()
expr_stmt|;
comment|/* tsp = ptr to index var */
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* tl upper bound */
if|if
condition|(
operator|*
name|tsp
operator|==
name|tl
condition|)
comment|/* loop is done, fall through */
continue|continue;
operator|*
name|tsp
operator|+=
literal|1
expr_stmt|;
comment|/* inc index var */
name|pc
operator|.
name|cp
operator|+=
name|tl1
expr_stmt|;
comment|/* return to top of loop */
continue|continue;
case|case
name|O_FOR4U
case|:
name|tl1
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl1 loop branch */
if|if
condition|(
name|tl1
operator|==
literal|0
condition|)
name|tl1
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
name|tlp
operator|=
operator|(
name|long
operator|*
operator|)
name|popaddr
argument_list|()
expr_stmt|;
comment|/* tlp = ptr to index var */
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* tl upper bound */
if|if
condition|(
operator|*
name|tlp
operator|==
name|tl
condition|)
comment|/* loop is done, fall through */
continue|continue;
operator|*
name|tlp
operator|+=
literal|1
expr_stmt|;
comment|/* inc index var */
name|pc
operator|.
name|cp
operator|+=
name|tl1
expr_stmt|;
comment|/* return to top of loop */
continue|continue;
case|case
name|O_FOR1D
case|:
name|tl1
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl1 loop branch */
if|if
condition|(
name|tl1
operator|==
literal|0
condition|)
name|tl1
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
comment|/* tcp = ptr to index var */
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* tl upper bound */
if|if
condition|(
operator|*
name|tcp
operator|==
name|tl
condition|)
comment|/* loop is done, fall through */
continue|continue;
operator|*
name|tcp
operator|-=
literal|1
expr_stmt|;
comment|/* dec index var */
name|pc
operator|.
name|cp
operator|+=
name|tl1
expr_stmt|;
comment|/* return to top of loop */
continue|continue;
case|case
name|O_FOR2D
case|:
name|tl1
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl1 loop branch */
if|if
condition|(
name|tl1
operator|==
literal|0
condition|)
name|tl1
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
name|tsp
operator|=
operator|(
name|short
operator|*
operator|)
name|popaddr
argument_list|()
expr_stmt|;
comment|/* tsp = ptr to index var */
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* tl upper bound */
if|if
condition|(
operator|*
name|tsp
operator|==
name|tl
condition|)
comment|/* loop is done, fall through */
continue|continue;
operator|*
name|tsp
operator|-=
literal|1
expr_stmt|;
comment|/* dec index var */
name|pc
operator|.
name|cp
operator|+=
name|tl1
expr_stmt|;
comment|/* return to top of loop */
continue|continue;
case|case
name|O_FOR4D
case|:
name|tl1
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl1 loop branch */
if|if
condition|(
name|tl1
operator|==
literal|0
condition|)
name|tl1
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
name|tlp
operator|=
operator|(
name|long
operator|*
operator|)
name|popaddr
argument_list|()
expr_stmt|;
comment|/* tlp = ptr to index var */
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* tl upper bound */
if|if
condition|(
operator|*
name|tlp
operator|==
name|tl
condition|)
comment|/* loop is done, fall through */
continue|continue;
operator|*
name|tlp
operator|-=
literal|1
expr_stmt|;
comment|/* dec index var */
name|pc
operator|.
name|cp
operator|+=
name|tl1
expr_stmt|;
comment|/* return to top of loop */
continue|continue;
case|case
name|O_READE
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|READE
argument_list|(
name|curfile
argument_list|,
name|base
operator|+
operator|*
name|pc
operator|.
name|lp
operator|++
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_READ4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push4
argument_list|(
name|READ4
argument_list|(
name|curfile
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_READC
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|READC
argument_list|(
name|curfile
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_READ8
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push8
argument_list|(
name|READ8
argument_list|(
name|curfile
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_READLN
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|READLN
argument_list|(
name|curfile
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_EOF
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|TEOF
argument_list|(
name|popaddr
argument_list|()
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_EOLN
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|TEOLN
argument_list|(
name|popaddr
argument_list|()
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_WRITEC
case|:
if|if
condition|(
name|_runtst
condition|)
block|{
name|WRITEC
argument_list|(
name|curfile
argument_list|)
expr_stmt|;
name|popsp
argument_list|(
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|cp
operator|++
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
switch|switch
condition|(
name|tl
operator|-
sizeof|sizeof
argument_list|(
name|FILE
operator|*
argument_list|)
condition|)
block|{
case|case
literal|2
case|:
name|tl1
operator|=
name|pop2
argument_list|()
expr_stmt|;
break|break;
case|case
literal|4
case|:
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
break|break;
default|default:
name|ERROR
argument_list|(
literal|"Panic: bad size to O_WRITEC"
argument_list|)
expr_stmt|;
comment|/* NOT REACHED */
block|}
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
name|fputc
argument_list|(
name|tl1
argument_list|,
name|tcp
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_WRITES
case|:
if|if
condition|(
name|_runtst
condition|)
block|{
name|WRITES
argument_list|(
name|curfile
argument_list|)
expr_stmt|;
name|popsp
argument_list|(
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|cp
operator|++
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|fwrite
argument_list|()
expr_stmt|;
name|popsp
argument_list|(
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|cp
operator|++
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_WRITEF
case|:
if|if
condition|(
name|_runtst
condition|)
block|{
name|WRITEF
argument_list|(
name|curfile
argument_list|)
expr_stmt|;
name|popsp
argument_list|(
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|cp
operator|++
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|fprintf
argument_list|()
expr_stmt|;
name|popsp
argument_list|(
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|cp
operator|++
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_WRITLN
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|WRITLN
argument_list|(
name|curfile
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|fputc
argument_list|(
literal|'\n'
argument_list|,
name|ACTFILE
argument_list|(
name|curfile
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_PAGE
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|PAGE
argument_list|(
name|curfile
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|fputc
argument_list|(
literal|'
literal|'
argument_list|,
name|ACTFILE
argument_list|(
name|curfile
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_NAM
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|pushaddr
argument_list|(
name|NAM
argument_list|(
name|tl
argument_list|,
name|base
operator|+
operator|*
name|pc
operator|.
name|lp
operator|++
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_MAX
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|push4
argument_list|(
name|MAX
argument_list|(
name|tl1
argument_list|,
name|tl
argument_list|,
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|usp
operator|++
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|tl1
operator|-=
name|tl
expr_stmt|;
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|>
name|tl
condition|?
name|tl1
else|:
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_MIN
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl1
operator|<
name|tl
condition|?
name|tl1
else|:
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_UNIT
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|curfile
operator|=
name|UNIT
argument_list|(
name|popaddr
argument_list|()
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_UNITINP
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|curfile
operator|=
name|INPUT
expr_stmt|;
continue|continue;
case|case
name|O_UNITOUT
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|curfile
operator|=
name|OUTPUT
expr_stmt|;
continue|continue;
case|case
name|O_MESSAGE
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|PFLUSH
argument_list|()
expr_stmt|;
name|curfile
operator|=
name|ERR
expr_stmt|;
continue|continue;
case|case
name|O_PUT
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|PUT
argument_list|(
name|curfile
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_GET
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|GET
argument_list|(
name|curfile
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_FNIL
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|pushaddr
argument_list|(
name|FNIL
argument_list|(
name|popaddr
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_DEFNAME
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|DEFNAME
argument_list|()
expr_stmt|;
name|popsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|2
operator|*
sizeof|sizeof
argument_list|(
name|char
operator|*
argument_list|)
operator|+
literal|2
operator|*
sizeof|sizeof
argument_list|(
name|long
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_RESET
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|RESET
argument_list|()
expr_stmt|;
name|popsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|2
operator|*
sizeof|sizeof
argument_list|(
name|char
operator|*
argument_list|)
operator|+
literal|2
operator|*
sizeof|sizeof
argument_list|(
name|long
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_REWRITE
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|REWRITE
argument_list|()
expr_stmt|;
name|popsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|2
operator|*
sizeof|sizeof
argument_list|(
name|char
operator|*
argument_list|)
operator|+
literal|2
operator|*
sizeof|sizeof
argument_list|(
name|long
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_FILE
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|pushaddr
argument_list|(
name|ACTFILE
argument_list|(
name|curfile
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_REMOVE
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|REMOVE
argument_list|()
expr_stmt|;
name|popsp
argument_list|(
call|(
name|long
call|)
argument_list|(
sizeof|sizeof
argument_list|(
name|char
operator|*
argument_list|)
operator|+
sizeof|sizeof
argument_list|(
name|long
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_FLUSH
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|FLUSH
argument_list|()
expr_stmt|;
name|popsp
argument_list|(
call|(
name|long
call|)
argument_list|(
sizeof|sizeof
argument_list|(
name|char
operator|*
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_PACK
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|PACK
argument_list|()
expr_stmt|;
name|popsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|5
operator|*
sizeof|sizeof
argument_list|(
name|long
argument_list|)
operator|+
literal|2
operator|*
sizeof|sizeof
argument_list|(
name|char
operator|*
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_UNPACK
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|UNPACK
argument_list|()
expr_stmt|;
name|popsp
argument_list|(
call|(
name|long
call|)
argument_list|(
literal|5
operator|*
sizeof|sizeof
argument_list|(
name|long
argument_list|)
operator|+
literal|2
operator|*
sizeof|sizeof
argument_list|(
name|char
operator|*
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ARGC
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push4
argument_list|(
operator|(
name|long
operator|)
name|_argc
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ARGV
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl = size of char array */
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
comment|/* tcp = addr of char array */
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
comment|/* tl1 = argv subscript */
name|ARGV
argument_list|(
name|tl1
argument_list|,
name|tcp
argument_list|,
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_CLCK
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push4
argument_list|(
name|CLCK
argument_list|()
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_WCLCK
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push4
argument_list|(
name|time
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SCLCK
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push4
argument_list|(
name|SCLCK
argument_list|()
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_NEW
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl = size being new'ed */
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
comment|/* ptr to ptr being new'ed */
name|NEW
argument_list|(
name|tcp
argument_list|,
name|tl
argument_list|)
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|blkclr
argument_list|(
operator|*
operator|(
operator|(
name|char
operator|*
operator|*
operator|)
operator|(
name|tcp
operator|)
operator|)
argument_list|,
name|tl
argument_list|)
expr_stmt|;
block|}
continue|continue;
case|case
name|O_DISPOSE
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl = size being disposed */
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
comment|/* ptr to ptr being disposed */
name|DISPOSE
argument_list|(
name|tcp
argument_list|,
name|tl
argument_list|)
expr_stmt|;
operator|*
operator|(
name|char
operator|*
operator|*
operator|)
name|tcp
operator|=
operator|(
name|char
operator|*
operator|)
literal|0
expr_stmt|;
continue|continue;
case|case
name|O_DFDISP
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
comment|/* tl = size being disposed */
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|usp
operator|++
expr_stmt|;
name|tcp
operator|=
name|popaddr
argument_list|()
expr_stmt|;
comment|/* ptr to ptr being disposed */
name|DFDISPOSE
argument_list|(
name|tcp
argument_list|,
name|tl
argument_list|)
expr_stmt|;
operator|*
operator|(
name|char
operator|*
operator|*
operator|)
name|tcp
operator|=
operator|(
name|char
operator|*
operator|)
literal|0
expr_stmt|;
continue|continue;
case|case
name|O_DATE
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|DATE
argument_list|(
name|popaddr
argument_list|()
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_TIME
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|TIME
argument_list|(
name|popaddr
argument_list|()
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_UNDEF
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|pop8
argument_list|()
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ATAN
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|push8
argument_list|(
name|ATAN
argument_list|(
name|pop8
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|push8
argument_list|(
name|atan
argument_list|(
name|pop8
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_COS
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|push8
argument_list|(
name|COS
argument_list|(
name|pop8
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|push8
argument_list|(
name|cos
argument_list|(
name|pop8
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_EXP
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|push8
argument_list|(
name|EXP
argument_list|(
name|pop8
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|push8
argument_list|(
name|exp
argument_list|(
name|pop8
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_LN
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|push8
argument_list|(
name|LN
argument_list|(
name|pop8
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|push8
argument_list|(
name|log
argument_list|(
name|pop8
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SIN
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|push8
argument_list|(
name|SIN
argument_list|(
name|pop8
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|push8
argument_list|(
name|sin
argument_list|(
name|pop8
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SQRT
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|push8
argument_list|(
name|SQRT
argument_list|(
name|pop8
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|push8
argument_list|(
name|sqrt
argument_list|(
name|pop8
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_CHR2
case|:
case|case
name|O_CHR4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|CHR
argument_list|(
name|pop4
argument_list|()
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|pop4
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ODD2
case|:
case|case
name|O_ODD4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|tl
operator|&
literal|1
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SUCC2
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|SUCC
argument_list|(
name|tl1
argument_list|,
name|tl
argument_list|,
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|sp
operator|++
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|tl1
operator|+
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
continue|continue;
case|case
name|O_SUCC24
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|push4
argument_list|(
name|SUCC
argument_list|(
name|tl1
argument_list|,
name|tl
argument_list|,
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|sp
operator|++
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|push4
argument_list|(
name|tl1
operator|+
literal|1
argument_list|)
expr_stmt|;
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
continue|continue;
case|case
name|O_SUCC4
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|lp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|push4
argument_list|(
name|SUCC
argument_list|(
name|tl1
argument_list|,
name|tl
argument_list|,
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|lp
operator|++
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|push4
argument_list|(
name|tl1
operator|+
literal|1
argument_list|)
expr_stmt|;
name|pc
operator|.
name|lp
operator|++
expr_stmt|;
continue|continue;
case|case
name|O_PRED2
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|PRED
argument_list|(
name|tl1
argument_list|,
name|tl
argument_list|,
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|sp
operator|++
argument_list|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|push2
argument_list|(
call|(
name|short
call|)
argument_list|(
name|tl1
operator|-
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
continue|continue;
case|case
name|O_PRED24
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|push4
argument_list|(
name|PRED
argument_list|(
name|tl1
argument_list|,
name|tl
argument_list|,
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|sp
operator|++
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|push4
argument_list|(
name|tl1
operator|-
literal|1
argument_list|)
expr_stmt|;
name|pc
operator|.
name|sp
operator|++
expr_stmt|;
continue|continue;
case|case
name|O_PRED4
case|:
name|tl
operator|=
operator|*
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
if|if
condition|(
name|tl
operator|==
literal|0
condition|)
name|tl
operator|=
operator|*
name|pc
operator|.
name|lp
operator|++
expr_stmt|;
name|tl1
operator|=
name|pop4
argument_list|()
expr_stmt|;
if|if
condition|(
name|_runtst
condition|)
block|{
name|push4
argument_list|(
name|PRED
argument_list|(
name|tl1
argument_list|,
name|tl
argument_list|,
call|(
name|long
call|)
argument_list|(
operator|*
name|pc
operator|.
name|lp
operator|++
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
block|}
name|push4
argument_list|(
name|tl1
operator|-
literal|1
argument_list|)
expr_stmt|;
name|pc
operator|.
name|lp
operator|++
expr_stmt|;
continue|continue;
case|case
name|O_SEED
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push4
argument_list|(
name|SEED
argument_list|(
name|pop4
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_RANDOM
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push8
argument_list|(
name|RANDOM
argument_list|(
name|pop8
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_EXPO
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push4
argument_list|(
name|EXPO
argument_list|(
name|pop8
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SQR2
case|:
case|case
name|O_SQR4
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|tl
operator|=
name|pop4
argument_list|()
expr_stmt|;
name|push4
argument_list|(
name|tl
operator|*
name|tl
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_SQR8
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|td
operator|=
name|pop8
argument_list|()
expr_stmt|;
name|push8
argument_list|(
name|td
operator|*
name|td
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_ROUND
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push4
argument_list|(
name|ROUND
argument_list|(
name|pop8
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
case|case
name|O_TRUNC
case|:
name|pc
operator|.
name|cp
operator|++
expr_stmt|;
name|push4
argument_list|(
name|TRUNC
argument_list|(
name|pop8
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
continue|continue;
default|default:
name|ERROR
argument_list|(
literal|"Panic: bad op code\n"
argument_list|)
expr_stmt|;
continue|continue;
block|}
block|}
block|}
end_block

end_unit

