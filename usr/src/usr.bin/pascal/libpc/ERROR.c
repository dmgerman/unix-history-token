begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* Copyright (c) 1979 Regents of the University of California */
end_comment

begin_decl_stmt
specifier|static
name|char
name|sccsid
index|[]
init|=
literal|"@(#)ERROR.c 1.3 %G%"
decl_stmt|;
end_decl_stmt

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<signal.h>
end_include

begin_include
include|#
directive|include
file|"h00vars.h"
end_include

begin_include
include|#
directive|include
file|"h01errs.h"
end_include

begin_comment
comment|/*  * Routine ERROR is called from the runtime library when a runtime error  * occurs. Its arguments are the internal number of the error which occurred,  * and an error specific piece of error data. The error file is constructed  * from errdata by the makefile using the editor script make.ed1.  */
end_comment

begin_function
name|long
name|ERROR
parameter_list|(
name|errnum
parameter_list|,
name|errordata
parameter_list|)
name|short
name|errnum
decl_stmt|;
name|double
name|errordata
decl_stmt|;
block|{
union|union
name|cvt
block|{
name|long
name|longdat
decl_stmt|;
name|char
modifier|*
name|strngdat
decl_stmt|;
name|double
name|dbldat
decl_stmt|;
block|}
name|errdata
union|;
name|errdata
operator|.
name|dbldat
operator|=
name|errordata
expr_stmt|;
name|PFLUSH
argument_list|()
expr_stmt|;
if|if
condition|(
name|_entry
index|[
name|errnum
index|]
operator|.
name|entryaddr
operator|!=
literal|0
condition|)
block|{
operator|(
operator|*
name|_entry
index|[
name|errnum
index|]
operator|.
name|entryaddr
operator|)
operator|(
name|errdata
operator|)
expr_stmt|;
return|return;
block|}
name|fputc
argument_list|(
literal|'\n'
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
name|SETRACE
argument_list|()
expr_stmt|;
switch|switch
condition|(
name|errnum
condition|)
block|{
case|case
name|ECHR
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Argument to chr of %D is out of range\n"
argument_list|,
name|errdata
operator|.
name|longdat
argument_list|)
expr_stmt|;
return|return
operator|(
name|errdata
operator|.
name|longdat
operator|)
return|;
case|case
name|EHALT
case|:
name|fputs
argument_list|(
literal|"Call to procedure halt\n"
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
name|PCEXIT
argument_list|(
literal|0
argument_list|)
expr_stmt|;
case|case
name|ENILPTR
case|:
name|fputs
argument_list|(
literal|"Pointer value out of legal range\n"
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|EPASTEOF
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: Tried to read past end of file\n"
argument_list|,
name|errdata
operator|.
name|strngdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|EREADIT
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: Attempt to read, but open for writing\n"
argument_list|,
name|errdata
operator|.
name|strngdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|EWRITEIT
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: Attempt to write, but open for reading\n"
argument_list|,
name|errdata
operator|.
name|strngdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|ECLOSE
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: Close failed\n"
argument_list|,
name|errdata
operator|.
name|strngdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|ELLIMIT
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: Line limit exceeded\n"
argument_list|,
name|errdata
operator|.
name|strngdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|ESQRT
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Negative argument of %e to sqrt\n"
argument_list|,
name|errdata
operator|.
name|dbldat
argument_list|)
expr_stmt|;
return|return
operator|(
name|errdata
operator|.
name|dbldat
operator|)
return|;
case|case
name|EREFINAF
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: "
argument_list|,
name|errdata
operator|.
name|strngdat
argument_list|)
expr_stmt|;
case|case
name|ENOFILE
case|:
name|fputs
argument_list|(
literal|"Reference to an inactive file\n"
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|EWRITE
case|:
name|fputs
argument_list|(
literal|"Could not write to "
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
name|perror
argument_list|(
name|errdata
operator|.
name|strngdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|EOPEN
case|:
name|fputs
argument_list|(
literal|"Could not open "
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
name|perror
argument_list|(
name|errdata
operator|.
name|strngdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|ECREATE
case|:
name|fputs
argument_list|(
literal|"Could not create "
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
name|perror
argument_list|(
name|errdata
operator|.
name|strngdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|EREMOVE
case|:
name|fputs
argument_list|(
literal|"Could not remove "
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
name|perror
argument_list|(
name|errdata
operator|.
name|strngdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|ESEEK
case|:
name|fputs
argument_list|(
literal|"Could not reset "
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
name|perror
argument_list|(
name|errdata
operator|.
name|strngdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|ENAMESIZE
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: File name too long\n"
argument_list|,
name|errdata
operator|.
name|strngdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|ELN
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Non-positive argument of %e to ln\n"
argument_list|,
name|errdata
operator|.
name|dbldat
argument_list|)
expr_stmt|;
return|return
operator|(
name|errdata
operator|.
name|dbldat
operator|)
return|;
case|case
name|EBADINUM
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: Bad data found on integer read\n"
argument_list|,
name|errdata
operator|.
name|strngdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|EBADFNUM
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: Bad data found on real read\n"
argument_list|,
name|errdata
operator|.
name|strngdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|ENUMNTFD
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Unknown name \"%s\" found on enumerated type read\n"
argument_list|,
name|errdata
operator|.
name|strngdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|ENAMRNG
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Enumerated type value of %D is out of range on output\n"
argument_list|,
name|errdata
operator|.
name|longdat
argument_list|)
expr_stmt|;
return|return
operator|(
name|errdata
operator|.
name|longdat
operator|)
return|;
case|case
name|EFMTSIZE
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Negative format width: %D\n"
argument_list|,
name|errdata
operator|.
name|longdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|EGOTO
case|:
name|fputs
argument_list|(
literal|"Active frame not found in non-local goto\n"
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|ECASE
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Label of %D not found in case\n"
argument_list|,
name|errdata
operator|.
name|longdat
argument_list|)
expr_stmt|;
return|return
operator|(
name|errdata
operator|.
name|longdat
operator|)
return|;
case|case
name|EOUTOFMEM
case|:
name|fputs
argument_list|(
literal|"Ran out of memory\n"
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|ECTLWR
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Range lower bound of %D out of set bounds\n"
argument_list|,
name|errdata
operator|.
name|longdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|ECTUPR
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Range upper bound of %D out of set bounds\n"
argument_list|,
name|errdata
operator|.
name|longdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|ECTSNG
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Value of %D out of set bounds\n"
argument_list|,
name|errdata
operator|.
name|longdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|ENARGS
case|:
if|if
condition|(
name|errdata
operator|.
name|longdat
operator|<
literal|0
condition|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"There were %D too few arguments to formal routine\n"
argument_list|,
operator|-
name|errdata
operator|.
name|longdat
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"There were %D too many arguments to formal routine\n"
argument_list|,
name|errdata
operator|.
name|longdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|EARGV
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Argument to argv of %D is out of range\n"
argument_list|,
name|errdata
operator|.
name|longdat
argument_list|)
expr_stmt|;
return|return
operator|(
name|errdata
operator|.
name|longdat
operator|)
return|;
case|case
name|EPACK
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"i = %D: Bad i to pack(a,i,z)\n"
argument_list|,
name|errdata
operator|.
name|longdat
argument_list|)
expr_stmt|;
return|return
operator|(
name|errdata
operator|.
name|longdat
operator|)
return|;
case|case
name|EUNPACK
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"i = %D: Bad i to unpack(z,a,i)\n"
argument_list|,
name|errdata
operator|.
name|longdat
argument_list|)
expr_stmt|;
return|return
operator|(
name|errdata
operator|.
name|longdat
operator|)
return|;
case|case
name|ERANGE
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Value of %D is out of range\n"
argument_list|,
name|errdata
operator|.
name|longdat
argument_list|)
expr_stmt|;
return|return
operator|(
name|errdata
operator|.
name|longdat
operator|)
return|;
case|case
name|ESUBSC
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Subscript value of %D is out of range\n"
argument_list|,
name|errdata
operator|.
name|longdat
argument_list|)
expr_stmt|;
return|return
operator|(
name|errdata
operator|.
name|longdat
operator|)
return|;
case|case
name|EASRT
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Assertion failed: %s\n"
argument_list|,
name|errdata
operator|.
name|strngdat
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
case|case
name|ESTLIM
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Statement count limit exceeded, %D statements executed\n"
argument_list|,
name|errdata
operator|.
name|longdat
argument_list|)
expr_stmt|;
return|return
operator|(
name|errdata
operator|.
name|longdat
operator|)
return|;
default|default:
name|fputs
argument_list|(
literal|"Panic: unknown error\n"
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
block|}
end_function

end_unit

