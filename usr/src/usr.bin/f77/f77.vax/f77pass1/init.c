begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (c) 1980 Regents of the University of California.  * All rights reserved.  The Berkeley software License Agreement  * specifies the terms and conditions for redistribution.  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
modifier|*
name|sccsid
init|=
literal|"@(#)init.c	5.3 (Berkeley) 1/3/88"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/*  * init.c  *  * Initializations for f77 compiler, pass 1.  *  * University of Utah CS Dept modification history:  *  * $Header: init.c,v 5.2 85/08/10 04:30:57 donn Exp $  * $Log:	init.c,v $  * Revision 5.2  85/08/10  04:30:57  donn  * Jerry Berkman's changes to ifdef 66 code and handle -r8/double flag.  *   * Revision 5.1  85/08/10  03:47:33  donn  * 4.3 alpha  *   * Revision 2.1  84/07/19  12:03:26  donn  * Changed comment headers for UofU.  *   * Revision 1.3  84/02/28  21:07:53  donn  * Added Berkeley changes for call argument temporaries fix.  *   * Fixed incorrect check of 'cdatafile' when 'cchkfile' is opened. -- Donn  */
end_comment

begin_include
include|#
directive|include
file|"defs.h"
end_include

begin_include
include|#
directive|include
file|"io.h"
end_include

begin_include
include|#
directive|include
file|<sys/file.h>
end_include

begin_decl_stmt
name|FILEP
name|infile
init|=
block|{
name|stdin
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|FILEP
name|diagfile
init|=
block|{
name|stderr
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|FILEP
name|textfile
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|FILEP
name|asmfile
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|FILEP
name|initfile
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|long
name|int
name|headoffset
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
name|token
index|[
literal|1321
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|toklen
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|lineno
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|infname
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|needkwd
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|Labelblock
modifier|*
name|thislabel
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|nowarnflag
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|ftn66flag
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|ONLY66
end_ifdef

begin_decl_stmt
name|flag
name|no66flag
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|noextflag
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
name|flag
name|dblflag
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|profileflag
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|optimflag
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|shiftcase
init|=
name|YES
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|undeftype
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|shortsubs
init|=
name|YES
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|onetripflag
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|checksubs
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|debugflag
index|[
name|MAXDEBUGFLAG
index|]
init|=
block|{
name|NO
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|equivdcl
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nerr
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nwarn
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|ndata
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|saveall
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|substars
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|parstate
init|=
name|OUTSIDE
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|headerdone
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|blklevel
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|impltype
index|[
literal|26
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|implleng
index|[
literal|26
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|implstg
index|[
literal|26
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|tyint
init|=
name|TYLONG
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|tylogical
init|=
name|TYLONG
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|ftnint
name|typesize
index|[
name|NTYPES
index|]
init|=
block|{
literal|1
block|,
name|SZADDR
block|,
name|SZSHORT
block|,
name|SZLONG
block|,
name|SZLONG
block|,
literal|2
operator|*
name|SZLONG
block|,
literal|2
operator|*
name|SZLONG
block|,
literal|4
operator|*
name|SZLONG
block|,
name|SZLONG
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|typealign
index|[
name|NTYPES
index|]
init|=
block|{
literal|1
block|,
name|ALIADDR
block|,
name|ALISHORT
block|,
name|ALILONG
block|,
name|ALILONG
block|,
name|ALIDOUBLE
block|,
name|ALILONG
block|,
name|ALIDOUBLE
block|,
name|ALILONG
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|procno
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|lwmno
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|proctype
init|=
name|TYUNKNOWN
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|procname
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|rtvlabel
index|[
name|NTYPES
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|fudgelabel
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|Addrp
name|typeaddr
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|Addrp
name|retslot
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|cxslot
init|=
operator|-
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|chslot
init|=
operator|-
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|chlgslot
init|=
operator|-
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|procclass
init|=
name|CLUNKNOWN
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nentry
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|multitype
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|ftnint
name|procleng
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|lastlabno
init|=
literal|10
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|lastvarno
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|lastargslot
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|argloc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|ftnint
name|autoleng
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|ftnint
name|bssleng
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|retlabel
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|ret0label
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|ftnint
name|lowbss
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|ftnint
name|highbss
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|bsslabel
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|anyinits
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|anylocals
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|maxctl
init|=
name|MAXCTL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|Ctlframe
modifier|*
name|ctls
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|Ctlframe
modifier|*
name|ctlstack
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|Ctlframe
modifier|*
name|lastctl
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|Namep
name|regnamep
index|[
name|MAXREGVAR
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|highregvar
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nregvar
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|maxext
init|=
name|MAXEXT
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|Extsym
modifier|*
name|extsymtab
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|Extsym
modifier|*
name|nextext
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|Extsym
modifier|*
name|lastext
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|maxequiv
init|=
name|MAXEQUIV
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|Equivblock
modifier|*
name|eqvclass
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|maxhash
init|=
name|MAXHASH
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|Hashentry
modifier|*
name|hashtab
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|Hashentry
modifier|*
name|lasthash
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|maxstno
init|=
name|MAXSTNO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|Labelblock
modifier|*
name|labeltab
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|Labelblock
modifier|*
name|labtabend
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|Labelblock
modifier|*
name|highlabtab
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|maxdim
init|=
name|MAXDIM
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|Rplblock
modifier|*
name|rpllist
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|Chain
modifier|*
name|curdtp
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|toomanyinit
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|ftnint
name|curdtelt
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|chainp
name|templist
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|chainp
name|argtemplist
init|=
name|CHNULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|chainp
name|activearglist
init|=
name|CHNULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|chainp
name|holdtemps
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|dorange
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|Entrypoint
modifier|*
name|entries
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|chainp
name|chains
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|inioctl
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|Addrp
name|ioblkp
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|iostmt
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nioctl
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nequiv
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|eqvstart
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nintnames
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|SDB
end_ifdef

begin_decl_stmt
name|int
name|dbglabel
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|sdbflag
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
name|struct
name|Literal
name|litpool
index|[
name|MAXLITERALS
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nliterals
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|cdatafile
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|cchkfile
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|vdatafile
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|vchkfile
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
name|cdatafname
index|[
literal|44
index|]
init|=
literal|""
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
name|cchkfname
index|[
literal|44
index|]
init|=
literal|""
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
name|vdatafname
index|[
literal|44
index|]
init|=
literal|""
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
name|vchkfname
index|[
literal|44
index|]
init|=
literal|""
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|long
name|cdatahwm
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|long
name|vdatahwm
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|ioblock
modifier|*
name|iodata
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_macro
name|fileinit
argument_list|()
end_macro

begin_block
block|{
name|int
name|pid
decl_stmt|;
name|pid
operator|=
name|getpid
argument_list|()
expr_stmt|;
name|sprintf
argument_list|(
name|cdatafname
argument_list|,
literal|"/tmp/fortcd.%d"
argument_list|,
name|pid
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|cchkfname
argument_list|,
literal|"/tmp/fortcc.%d"
argument_list|,
name|pid
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|vdatafname
argument_list|,
literal|"/tmp/fortvd.%d"
argument_list|,
name|pid
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|vchkfname
argument_list|,
literal|"/tmp/fortvc.%d"
argument_list|,
name|pid
argument_list|)
expr_stmt|;
name|cdatafile
operator|=
name|open
argument_list|(
name|cdatafname
argument_list|,
name|O_CREAT
operator||
name|O_RDWR
argument_list|,
literal|0600
argument_list|)
expr_stmt|;
if|if
condition|(
name|cdatafile
operator|<
literal|0
condition|)
name|fatalstr
argument_list|(
literal|"cannot open tmp file %s"
argument_list|,
name|cdatafname
argument_list|)
expr_stmt|;
name|cchkfile
operator|=
name|open
argument_list|(
name|cchkfname
argument_list|,
name|O_CREAT
operator||
name|O_RDWR
argument_list|,
literal|0600
argument_list|)
expr_stmt|;
if|if
condition|(
name|cchkfile
operator|<
literal|0
condition|)
name|fatalstr
argument_list|(
literal|"cannot open tmp file %s"
argument_list|,
name|cchkfname
argument_list|)
expr_stmt|;
name|pruse
argument_list|(
name|initfile
argument_list|,
name|USEINIT
argument_list|)
expr_stmt|;
name|procno
operator|=
literal|0
expr_stmt|;
name|lwmno
operator|=
literal|0
expr_stmt|;
name|lastlabno
operator|=
literal|10
expr_stmt|;
name|lastvarno
operator|=
literal|0
expr_stmt|;
name|nliterals
operator|=
literal|0
expr_stmt|;
name|nerr
operator|=
literal|0
expr_stmt|;
name|ndata
operator|=
literal|0
expr_stmt|;
name|ctls
operator|=
name|ALLOCN
argument_list|(
name|maxctl
argument_list|,
name|Ctlframe
argument_list|)
expr_stmt|;
name|extsymtab
operator|=
name|ALLOCN
argument_list|(
name|maxext
argument_list|,
name|Extsym
argument_list|)
expr_stmt|;
name|eqvclass
operator|=
name|ALLOCN
argument_list|(
name|maxequiv
argument_list|,
name|Equivblock
argument_list|)
expr_stmt|;
name|hashtab
operator|=
name|ALLOCN
argument_list|(
name|maxhash
argument_list|,
name|Hashentry
argument_list|)
expr_stmt|;
name|labeltab
operator|=
name|ALLOCN
argument_list|(
name|maxstno
argument_list|,
name|Labelblock
argument_list|)
expr_stmt|;
name|ctlstack
operator|=
name|ctls
operator|-
literal|1
expr_stmt|;
name|lastctl
operator|=
name|ctls
operator|+
name|maxctl
expr_stmt|;
name|nextext
operator|=
name|extsymtab
expr_stmt|;
name|lastext
operator|=
name|extsymtab
operator|+
name|maxext
expr_stmt|;
name|lasthash
operator|=
name|hashtab
operator|+
name|maxhash
expr_stmt|;
name|labtabend
operator|=
name|labeltab
operator|+
name|maxstno
expr_stmt|;
name|highlabtab
operator|=
name|labeltab
expr_stmt|;
block|}
end_block

begin_macro
name|procinit
argument_list|()
end_macro

begin_block
block|{
specifier|register
name|Namep
name|p
decl_stmt|;
specifier|register
name|struct
name|Dimblock
modifier|*
name|q
decl_stmt|;
specifier|register
name|struct
name|Hashentry
modifier|*
name|hp
decl_stmt|;
specifier|register
name|struct
name|Labelblock
modifier|*
name|lp
decl_stmt|;
name|struct
name|Chain
modifier|*
name|cp
decl_stmt|;
name|int
name|i
decl_stmt|;
name|vdatafile
operator|=
name|open
argument_list|(
name|vdatafname
argument_list|,
name|O_CREAT
operator||
name|O_RDWR
argument_list|,
literal|0600
argument_list|)
expr_stmt|;
if|if
condition|(
name|vdatafile
operator|<
literal|0
condition|)
name|fatalstr
argument_list|(
literal|"cannot open tmp file %s"
argument_list|,
name|vdatafname
argument_list|)
expr_stmt|;
name|vchkfile
operator|=
name|open
argument_list|(
name|vchkfname
argument_list|,
name|O_CREAT
operator||
name|O_RDWR
argument_list|,
literal|0600
argument_list|)
expr_stmt|;
if|if
condition|(
name|vchkfile
operator|<
literal|0
condition|)
name|fatalstr
argument_list|(
literal|"cannot open tmp file %s"
argument_list|,
name|vchkfname
argument_list|)
expr_stmt|;
name|pruse
argument_list|(
name|asmfile
argument_list|,
name|USECONST
argument_list|)
expr_stmt|;
if|#
directive|if
name|FAMILY
operator|==
name|PCC
name|p2pass
argument_list|(
name|USETEXT
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|parstate
operator|=
name|OUTSIDE
expr_stmt|;
name|headerdone
operator|=
name|NO
expr_stmt|;
name|blklevel
operator|=
literal|1
expr_stmt|;
name|saveall
operator|=
name|NO
expr_stmt|;
name|substars
operator|=
name|NO
expr_stmt|;
name|nwarn
operator|=
literal|0
expr_stmt|;
name|thislabel
operator|=
name|NULL
expr_stmt|;
name|needkwd
operator|=
literal|0
expr_stmt|;
operator|++
name|procno
expr_stmt|;
name|proctype
operator|=
name|TYUNKNOWN
expr_stmt|;
name|procname
operator|=
literal|"MAIN     "
expr_stmt|;
name|procclass
operator|=
name|CLUNKNOWN
expr_stmt|;
name|nentry
operator|=
literal|0
expr_stmt|;
name|multitype
operator|=
name|NO
expr_stmt|;
name|typeaddr
operator|=
name|NULL
expr_stmt|;
name|retslot
operator|=
name|NULL
expr_stmt|;
name|cxslot
operator|=
operator|-
literal|1
expr_stmt|;
name|chslot
operator|=
operator|-
literal|1
expr_stmt|;
name|chlgslot
operator|=
operator|-
literal|1
expr_stmt|;
name|procleng
operator|=
literal|0
expr_stmt|;
name|blklevel
operator|=
literal|1
expr_stmt|;
name|lastargslot
operator|=
literal|0
expr_stmt|;
if|#
directive|if
name|TARGET
operator|==
name|PDP11
name|autoleng
operator|=
literal|6
expr_stmt|;
else|#
directive|else
name|autoleng
operator|=
literal|0
expr_stmt|;
endif|#
directive|endif
for|for
control|(
name|lp
operator|=
name|labeltab
init|;
name|lp
operator|<
name|labtabend
condition|;
operator|++
name|lp
control|)
name|lp
operator|->
name|stateno
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|hp
operator|=
name|hashtab
init|;
name|hp
operator|<
name|lasthash
condition|;
operator|++
name|hp
control|)
if|if
condition|(
name|p
operator|=
name|hp
operator|->
name|varp
condition|)
block|{
name|frexpr
argument_list|(
name|p
operator|->
name|vleng
argument_list|)
expr_stmt|;
if|if
condition|(
name|q
operator|=
name|p
operator|->
name|vdim
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|q
operator|->
name|ndim
condition|;
operator|++
name|i
control|)
block|{
name|frexpr
argument_list|(
name|q
operator|->
name|dims
index|[
name|i
index|]
operator|.
name|dimsize
argument_list|)
expr_stmt|;
name|frexpr
argument_list|(
name|q
operator|->
name|dims
index|[
name|i
index|]
operator|.
name|dimexpr
argument_list|)
expr_stmt|;
block|}
name|frexpr
argument_list|(
name|q
operator|->
name|nelt
argument_list|)
expr_stmt|;
name|frexpr
argument_list|(
name|q
operator|->
name|baseoffset
argument_list|)
expr_stmt|;
name|frexpr
argument_list|(
name|q
operator|->
name|basexpr
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|charptr
operator|)
name|q
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|p
operator|->
name|vclass
operator|==
name|CLNAMELIST
condition|)
name|frchain
argument_list|(
operator|&
operator|(
name|p
operator|->
name|varxptr
operator|.
name|namelist
operator|)
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|charptr
operator|)
name|p
argument_list|)
expr_stmt|;
name|hp
operator|->
name|varp
operator|=
name|NULL
expr_stmt|;
block|}
name|nintnames
operator|=
literal|0
expr_stmt|;
name|highlabtab
operator|=
name|labeltab
expr_stmt|;
name|ctlstack
operator|=
name|ctls
operator|-
literal|1
expr_stmt|;
for|for
control|(
name|cp
operator|=
name|templist
init|;
name|cp
condition|;
name|cp
operator|=
name|cp
operator|->
name|nextp
control|)
name|free
argument_list|(
call|(
name|charptr
call|)
argument_list|(
name|cp
operator|->
name|datap
argument_list|)
argument_list|)
expr_stmt|;
name|frchain
argument_list|(
operator|&
name|templist
argument_list|)
expr_stmt|;
for|for
control|(
name|cp
operator|=
name|argtemplist
init|;
name|cp
condition|;
name|cp
operator|=
name|cp
operator|->
name|nextp
control|)
name|free
argument_list|(
operator|(
name|char
operator|*
operator|)
operator|(
name|cp
operator|->
name|datap
operator|)
argument_list|)
expr_stmt|;
name|frchain
argument_list|(
operator|&
name|argtemplist
argument_list|)
expr_stmt|;
name|holdtemps
operator|=
name|NULL
expr_stmt|;
name|dorange
operator|=
literal|0
expr_stmt|;
name|nregvar
operator|=
literal|0
expr_stmt|;
name|highregvar
operator|=
literal|0
expr_stmt|;
name|entries
operator|=
name|NULL
expr_stmt|;
name|rpllist
operator|=
name|NULL
expr_stmt|;
name|inioctl
operator|=
name|NO
expr_stmt|;
name|ioblkp
operator|=
name|NULL
expr_stmt|;
name|eqvstart
operator|+=
name|nequiv
expr_stmt|;
name|nequiv
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|NTYPES
condition|;
operator|++
name|i
control|)
name|rtvlabel
index|[
name|i
index|]
operator|=
literal|0
expr_stmt|;
name|fudgelabel
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|undeftype
condition|)
name|setimpl
argument_list|(
name|TYUNKNOWN
argument_list|,
operator|(
name|ftnint
operator|)
literal|0
argument_list|,
literal|'a'
argument_list|,
literal|'z'
argument_list|)
expr_stmt|;
else|else
block|{
name|setimpl
argument_list|(
name|dblflag
condition|?
name|TYDREAL
else|:
name|TYREAL
argument_list|,
operator|(
name|ftnint
operator|)
literal|0
argument_list|,
literal|'a'
argument_list|,
literal|'z'
argument_list|)
expr_stmt|;
name|setimpl
argument_list|(
name|tyint
argument_list|,
operator|(
name|ftnint
operator|)
literal|0
argument_list|,
literal|'i'
argument_list|,
literal|'n'
argument_list|)
expr_stmt|;
block|}
name|setimpl
argument_list|(
operator|-
name|STGBSS
argument_list|,
operator|(
name|ftnint
operator|)
literal|0
argument_list|,
literal|'a'
argument_list|,
literal|'z'
argument_list|)
expr_stmt|;
comment|/* set class */
name|setlog
argument_list|()
expr_stmt|;
name|setopt
argument_list|()
expr_stmt|;
name|bsslabel
operator|=
operator|++
name|lastvarno
expr_stmt|;
name|anylocals
operator|=
name|NO
expr_stmt|;
name|anyinits
operator|=
name|NO
expr_stmt|;
block|}
end_block

begin_macro
name|setimpl
argument_list|(
argument|type
argument_list|,
argument|length
argument_list|,
argument|c1
argument_list|,
argument|c2
argument_list|)
end_macro

begin_decl_stmt
name|int
name|type
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|ftnint
name|length
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|c1
decl_stmt|,
name|c2
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|int
name|i
decl_stmt|;
name|char
name|buff
index|[
literal|100
index|]
decl_stmt|;
if|if
condition|(
name|c1
operator|==
literal|0
operator|||
name|c2
operator|==
literal|0
condition|)
return|return;
if|if
condition|(
name|c1
operator|>
name|c2
condition|)
block|{
name|sprintf
argument_list|(
name|buff
argument_list|,
literal|"characters out of order in implicit:%c-%c"
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
expr_stmt|;
name|err
argument_list|(
name|buff
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|type
operator|<
literal|0
condition|)
for|for
control|(
name|i
operator|=
name|c1
init|;
name|i
operator|<=
name|c2
condition|;
operator|++
name|i
control|)
name|implstg
index|[
name|i
operator|-
literal|'a'
index|]
operator|=
operator|-
name|type
expr_stmt|;
else|else
block|{
name|type
operator|=
name|lengtype
argument_list|(
name|type
argument_list|,
operator|(
name|int
operator|)
name|length
argument_list|)
expr_stmt|;
if|if
condition|(
name|type
operator|!=
name|TYCHAR
condition|)
name|length
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
name|c1
init|;
name|i
operator|<=
name|c2
condition|;
operator|++
name|i
control|)
block|{
name|impltype
index|[
name|i
operator|-
literal|'a'
index|]
operator|=
name|type
expr_stmt|;
name|implleng
index|[
name|i
operator|-
literal|'a'
index|]
operator|=
name|length
expr_stmt|;
block|}
block|}
block|}
end_block

end_unit

