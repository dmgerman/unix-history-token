begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_include
include|#
directive|include
file|"defs.h"
end_include

begin_decl_stmt
specifier|extern
name|ftnint
name|intcon
index|[
literal|14
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|double
name|realcon
index|[
literal|6
index|]
decl_stmt|;
end_decl_stmt

begin_union
union|union
block|{
name|int
name|ijunk
decl_stmt|;
name|struct
name|Intrpacked
name|bits
decl_stmt|;
block|}
name|packed
union|;
end_union

begin_struct
struct|struct
name|Intrbits
block|{
name|int
name|intrgroup
comment|/* :3 */
decl_stmt|;
name|int
name|intrstuff
comment|/* result type or number of generics */
decl_stmt|;
name|int
name|intrno
comment|/* :7 */
decl_stmt|;
block|}
struct|;
end_struct

begin_macro
name|LOCAL
end_macro

begin_struct
struct|struct
name|Intrblock
block|{
name|char
name|intrfname
index|[
name|VL
index|]
decl_stmt|;
name|struct
name|Intrbits
name|intrval
decl_stmt|;
block|}
name|intrtab
index|[ ]
init|=
block|{
literal|"int"
block|,
block|{
name|INTRCONV
block|,
name|TYLONG
block|}
block|,
literal|"real"
block|,
block|{
name|INTRCONV
block|,
name|TYREAL
block|}
block|,
literal|"dble"
block|,
block|{
name|INTRCONV
block|,
name|TYDREAL
block|}
block|,
literal|"dreal"
block|,
block|{
name|INTRCONV
block|,
name|TYDREAL
block|}
block|,
literal|"cmplx"
block|,
block|{
name|INTRCONV
block|,
name|TYCOMPLEX
block|}
block|,
literal|"dcmplx"
block|,
block|{
name|INTRCONV
block|,
name|TYDCOMPLEX
block|}
block|,
literal|"ifix"
block|,
block|{
name|INTRCONV
block|,
name|TYLONG
block|}
block|,
literal|"idint"
block|,
block|{
name|INTRCONV
block|,
name|TYLONG
block|}
block|,
literal|"float"
block|,
block|{
name|INTRCONV
block|,
name|TYREAL
block|}
block|,
literal|"dfloat"
block|,
block|{
name|INTRCONV
block|,
name|TYDREAL
block|}
block|,
literal|"sngl"
block|,
block|{
name|INTRCONV
block|,
name|TYREAL
block|}
block|,
literal|"ichar"
block|,
block|{
name|INTRCONV
block|,
name|TYLONG
block|}
block|,
literal|"iachar"
block|,
block|{
name|INTRCONV
block|,
name|TYLONG
block|}
block|,
literal|"char"
block|,
block|{
name|INTRCONV
block|,
name|TYCHAR
block|}
block|,
literal|"achar"
block|,
block|{
name|INTRCONV
block|,
name|TYCHAR
block|}
block|,
literal|"max"
block|,
block|{
name|INTRMAX
block|,
name|TYUNKNOWN
block|}
block|,
literal|"max0"
block|,
block|{
name|INTRMAX
block|,
name|TYLONG
block|}
block|,
literal|"amax0"
block|,
block|{
name|INTRMAX
block|,
name|TYREAL
block|}
block|,
literal|"max1"
block|,
block|{
name|INTRMAX
block|,
name|TYLONG
block|}
block|,
literal|"amax1"
block|,
block|{
name|INTRMAX
block|,
name|TYREAL
block|}
block|,
literal|"dmax1"
block|,
block|{
name|INTRMAX
block|,
name|TYDREAL
block|}
block|,
literal|"and"
block|,
block|{
name|INTRBOOL
block|,
name|TYUNKNOWN
block|,
name|OPBITAND
block|}
block|,
literal|"or"
block|,
block|{
name|INTRBOOL
block|,
name|TYUNKNOWN
block|,
name|OPBITOR
block|}
block|,
literal|"xor"
block|,
block|{
name|INTRBOOL
block|,
name|TYUNKNOWN
block|,
name|OPBITXOR
block|}
block|,
literal|"not"
block|,
block|{
name|INTRBOOL
block|,
name|TYUNKNOWN
block|,
name|OPBITNOT
block|}
block|,
literal|"lshift"
block|,
block|{
name|INTRBOOL
block|,
name|TYUNKNOWN
block|,
name|OPLSHIFT
block|}
block|,
literal|"rshift"
block|,
block|{
name|INTRBOOL
block|,
name|TYUNKNOWN
block|,
name|OPRSHIFT
block|}
block|,
literal|"min"
block|,
block|{
name|INTRMIN
block|,
name|TYUNKNOWN
block|}
block|,
literal|"min0"
block|,
block|{
name|INTRMIN
block|,
name|TYLONG
block|}
block|,
literal|"amin0"
block|,
block|{
name|INTRMIN
block|,
name|TYREAL
block|}
block|,
literal|"min1"
block|,
block|{
name|INTRMIN
block|,
name|TYLONG
block|}
block|,
literal|"amin1"
block|,
block|{
name|INTRMIN
block|,
name|TYREAL
block|}
block|,
literal|"dmin1"
block|,
block|{
name|INTRMIN
block|,
name|TYDREAL
block|}
block|,
literal|"aint"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|0
block|}
block|,
literal|"dint"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|1
block|}
block|,
literal|"anint"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|2
block|}
block|,
literal|"dnint"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|3
block|}
block|,
literal|"nint"
block|,
block|{
name|INTRGEN
block|,
literal|4
block|,
literal|4
block|}
block|,
literal|"idnint"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|6
block|}
block|,
literal|"abs"
block|,
block|{
name|INTRGEN
block|,
literal|6
block|,
literal|8
block|}
block|,
literal|"iabs"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|9
block|}
block|,
literal|"dabs"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|11
block|}
block|,
literal|"cabs"
block|,
block|{
name|INTRSPEC
block|,
name|TYREAL
block|,
literal|12
block|}
block|,
literal|"zabs"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|13
block|}
block|,
literal|"cdabs"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|13
block|}
block|,
literal|"mod"
block|,
block|{
name|INTRGEN
block|,
literal|4
block|,
literal|14
block|}
block|,
literal|"amod"
block|,
block|{
name|INTRSPEC
block|,
name|TYREAL
block|,
literal|16
block|}
block|,
literal|"dmod"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|17
block|}
block|,
literal|"sign"
block|,
block|{
name|INTRGEN
block|,
literal|4
block|,
literal|18
block|}
block|,
literal|"isign"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|19
block|}
block|,
literal|"dsign"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|21
block|}
block|,
literal|"dim"
block|,
block|{
name|INTRGEN
block|,
literal|4
block|,
literal|22
block|}
block|,
literal|"idim"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|23
block|}
block|,
literal|"ddim"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|25
block|}
block|,
literal|"dprod"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|26
block|}
block|,
literal|"len"
block|,
block|{
name|INTRSPEC
block|,
name|TYLONG
block|,
literal|27
block|}
block|,
literal|"index"
block|,
block|{
name|INTRSPEC
block|,
name|TYLONG
block|,
literal|29
block|}
block|,
literal|"imag"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|31
block|}
block|,
literal|"aimag"
block|,
block|{
name|INTRSPEC
block|,
name|TYREAL
block|,
literal|31
block|}
block|,
literal|"dimag"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|32
block|}
block|,
literal|"conjg"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|33
block|}
block|,
literal|"dconjg"
block|,
block|{
name|INTRSPEC
block|,
name|TYDCOMPLEX
block|,
literal|34
block|}
block|,
literal|"sqrt"
block|,
block|{
name|INTRGEN
block|,
literal|4
block|,
literal|35
block|}
block|,
literal|"dsqrt"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|36
block|}
block|,
literal|"csqrt"
block|,
block|{
name|INTRSPEC
block|,
name|TYCOMPLEX
block|,
literal|37
block|}
block|,
literal|"zsqrt"
block|,
block|{
name|INTRSPEC
block|,
name|TYDCOMPLEX
block|,
literal|38
block|}
block|,
literal|"cdsqrt"
block|,
block|{
name|INTRSPEC
block|,
name|TYDCOMPLEX
block|,
literal|38
block|}
block|,
literal|"exp"
block|,
block|{
name|INTRGEN
block|,
literal|4
block|,
literal|39
block|}
block|,
literal|"dexp"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|40
block|}
block|,
literal|"cexp"
block|,
block|{
name|INTRSPEC
block|,
name|TYCOMPLEX
block|,
literal|41
block|}
block|,
literal|"zexp"
block|,
block|{
name|INTRSPEC
block|,
name|TYDCOMPLEX
block|,
literal|42
block|}
block|,
literal|"cdexp"
block|,
block|{
name|INTRSPEC
block|,
name|TYDCOMPLEX
block|,
literal|42
block|}
block|,
literal|"log"
block|,
block|{
name|INTRGEN
block|,
literal|4
block|,
literal|43
block|}
block|,
literal|"alog"
block|,
block|{
name|INTRSPEC
block|,
name|TYREAL
block|,
literal|43
block|}
block|,
literal|"dlog"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|44
block|}
block|,
literal|"clog"
block|,
block|{
name|INTRSPEC
block|,
name|TYCOMPLEX
block|,
literal|45
block|}
block|,
literal|"zlog"
block|,
block|{
name|INTRSPEC
block|,
name|TYDCOMPLEX
block|,
literal|46
block|}
block|,
literal|"cdlog"
block|,
block|{
name|INTRSPEC
block|,
name|TYDCOMPLEX
block|,
literal|46
block|}
block|,
literal|"log10"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|47
block|}
block|,
literal|"alog10"
block|,
block|{
name|INTRSPEC
block|,
name|TYREAL
block|,
literal|47
block|}
block|,
literal|"dlog10"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|48
block|}
block|,
literal|"sin"
block|,
block|{
name|INTRGEN
block|,
literal|4
block|,
literal|49
block|}
block|,
literal|"dsin"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|50
block|}
block|,
literal|"csin"
block|,
block|{
name|INTRSPEC
block|,
name|TYCOMPLEX
block|,
literal|51
block|}
block|,
literal|"zsin"
block|,
block|{
name|INTRSPEC
block|,
name|TYDCOMPLEX
block|,
literal|52
block|}
block|,
literal|"cdsin"
block|,
block|{
name|INTRSPEC
block|,
name|TYDCOMPLEX
block|,
literal|52
block|}
block|,
literal|"cos"
block|,
block|{
name|INTRGEN
block|,
literal|4
block|,
literal|53
block|}
block|,
literal|"dcos"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|54
block|}
block|,
literal|"ccos"
block|,
block|{
name|INTRSPEC
block|,
name|TYCOMPLEX
block|,
literal|55
block|}
block|,
literal|"zcos"
block|,
block|{
name|INTRSPEC
block|,
name|TYDCOMPLEX
block|,
literal|56
block|}
block|,
literal|"cdcos"
block|,
block|{
name|INTRSPEC
block|,
name|TYDCOMPLEX
block|,
literal|56
block|}
block|,
literal|"tan"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|57
block|}
block|,
literal|"dtan"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|58
block|}
block|,
literal|"asin"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|59
block|}
block|,
literal|"dasin"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|60
block|}
block|,
literal|"acos"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|61
block|}
block|,
literal|"dacos"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|62
block|}
block|,
literal|"atan"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|63
block|}
block|,
literal|"datan"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|64
block|}
block|,
literal|"atan2"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|65
block|}
block|,
literal|"datan2"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|66
block|}
block|,
literal|"sinh"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|67
block|}
block|,
literal|"dsinh"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|68
block|}
block|,
literal|"cosh"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|69
block|}
block|,
literal|"dcosh"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|70
block|}
block|,
literal|"tanh"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|71
block|}
block|,
literal|"dtanh"
block|,
block|{
name|INTRSPEC
block|,
name|TYDREAL
block|,
literal|72
block|}
block|,
literal|"lge"
block|,
block|{
name|INTRSPEC
block|,
name|TYLOGICAL
block|,
literal|73
block|}
block|,
literal|"lgt"
block|,
block|{
name|INTRSPEC
block|,
name|TYLOGICAL
block|,
literal|75
block|}
block|,
literal|"lle"
block|,
block|{
name|INTRSPEC
block|,
name|TYLOGICAL
block|,
literal|77
block|}
block|,
literal|"llt"
block|,
block|{
name|INTRSPEC
block|,
name|TYLOGICAL
block|,
literal|79
block|}
block|,
literal|"epbase"
block|,
block|{
name|INTRCNST
block|,
literal|4
block|,
literal|0
block|}
block|,
literal|"epprec"
block|,
block|{
name|INTRCNST
block|,
literal|4
block|,
literal|4
block|}
block|,
literal|"epemin"
block|,
block|{
name|INTRCNST
block|,
literal|2
block|,
literal|8
block|}
block|,
literal|"epemax"
block|,
block|{
name|INTRCNST
block|,
literal|2
block|,
literal|10
block|}
block|,
literal|"eptiny"
block|,
block|{
name|INTRCNST
block|,
literal|2
block|,
literal|12
block|}
block|,
literal|"ephuge"
block|,
block|{
name|INTRCNST
block|,
literal|4
block|,
literal|14
block|}
block|,
literal|"epmrsp"
block|,
block|{
name|INTRCNST
block|,
literal|2
block|,
literal|18
block|}
block|,
literal|"fpexpn"
block|,
block|{
name|INTRGEN
block|,
literal|4
block|,
literal|81
block|}
block|,
literal|"fpabsp"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|85
block|}
block|,
literal|"fprrsp"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|87
block|}
block|,
literal|"fpfrac"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|89
block|}
block|,
literal|"fpmake"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|91
block|}
block|,
literal|"fpscal"
block|,
block|{
name|INTRGEN
block|,
literal|2
block|,
literal|93
block|}
block|,
literal|""
block|}
struct|;
end_struct

begin_escape
end_escape

begin_macro
name|LOCAL
end_macro

begin_struct
struct|struct
name|Specblock
block|{
name|char
name|atype
decl_stmt|;
name|char
name|rtype
decl_stmt|;
name|char
name|nargs
decl_stmt|;
name|char
name|spxname
index|[
name|XL
index|]
decl_stmt|;
name|char
name|othername
decl_stmt|;
comment|/* index into callbyvalue table */
block|}
name|spectab
index|[ ]
init|=
block|{
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_int"
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_int"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_nint"
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_nint"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYSHORT
block|,
literal|1
block|,
literal|"h_nint"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYLONG
block|,
literal|1
block|,
literal|"i_nint"
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYSHORT
block|,
literal|1
block|,
literal|"h_dnnt"
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYLONG
block|,
literal|1
block|,
literal|"i_dnnt"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_abs"
block|}
block|,
block|{
name|TYSHORT
block|,
name|TYSHORT
block|,
literal|1
block|,
literal|"h_abs"
block|}
block|,
block|{
name|TYLONG
block|,
name|TYLONG
block|,
literal|1
block|,
literal|"i_abs"
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_abs"
block|}
block|,
block|{
name|TYCOMPLEX
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"c_abs"
block|}
block|,
block|{
name|TYDCOMPLEX
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"z_abs"
block|}
block|,
block|{
name|TYSHORT
block|,
name|TYSHORT
block|,
literal|2
block|,
literal|"h_mod"
block|}
block|,
block|{
name|TYLONG
block|,
name|TYLONG
block|,
literal|2
block|,
literal|"i_mod"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|2
block|,
literal|"r_mod"
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|2
block|,
literal|"d_mod"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|2
block|,
literal|"r_sign"
block|}
block|,
block|{
name|TYSHORT
block|,
name|TYSHORT
block|,
literal|2
block|,
literal|"h_sign"
block|}
block|,
block|{
name|TYLONG
block|,
name|TYLONG
block|,
literal|2
block|,
literal|"i_sign"
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|2
block|,
literal|"d_sign"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|2
block|,
literal|"r_dim"
block|}
block|,
block|{
name|TYSHORT
block|,
name|TYSHORT
block|,
literal|2
block|,
literal|"h_dim"
block|}
block|,
block|{
name|TYLONG
block|,
name|TYLONG
block|,
literal|2
block|,
literal|"i_dim"
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|2
block|,
literal|"d_dim"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYDREAL
block|,
literal|2
block|,
literal|"d_prod"
block|}
block|,
block|{
name|TYCHAR
block|,
name|TYSHORT
block|,
literal|1
block|,
literal|"h_len"
block|}
block|,
block|{
name|TYCHAR
block|,
name|TYLONG
block|,
literal|1
block|,
literal|"i_len"
block|}
block|,
block|{
name|TYCHAR
block|,
name|TYSHORT
block|,
literal|2
block|,
literal|"h_indx"
block|}
block|,
block|{
name|TYCHAR
block|,
name|TYLONG
block|,
literal|2
block|,
literal|"i_indx"
block|}
block|,
block|{
name|TYCOMPLEX
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_imag"
block|}
block|,
block|{
name|TYDCOMPLEX
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_imag"
block|}
block|,
block|{
name|TYCOMPLEX
block|,
name|TYCOMPLEX
block|,
literal|1
block|,
literal|"r_cnjg"
block|}
block|,
block|{
name|TYDCOMPLEX
block|,
name|TYDCOMPLEX
block|,
literal|1
block|,
literal|"d_cnjg"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_sqrt"
block|,
literal|1
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_sqrt"
block|,
literal|1
block|}
block|,
block|{
name|TYCOMPLEX
block|,
name|TYCOMPLEX
block|,
literal|1
block|,
literal|"c_sqrt"
block|}
block|,
block|{
name|TYDCOMPLEX
block|,
name|TYDCOMPLEX
block|,
literal|1
block|,
literal|"z_sqrt"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_exp"
block|,
literal|2
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_exp"
block|,
literal|2
block|}
block|,
block|{
name|TYCOMPLEX
block|,
name|TYCOMPLEX
block|,
literal|1
block|,
literal|"c_exp"
block|}
block|,
block|{
name|TYDCOMPLEX
block|,
name|TYDCOMPLEX
block|,
literal|1
block|,
literal|"z_exp"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_log"
block|,
literal|3
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_log"
block|,
literal|3
block|}
block|,
block|{
name|TYCOMPLEX
block|,
name|TYCOMPLEX
block|,
literal|1
block|,
literal|"c_log"
block|}
block|,
block|{
name|TYDCOMPLEX
block|,
name|TYDCOMPLEX
block|,
literal|1
block|,
literal|"z_log"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_lg10"
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_lg10"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_sin"
block|,
literal|4
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_sin"
block|,
literal|4
block|}
block|,
block|{
name|TYCOMPLEX
block|,
name|TYCOMPLEX
block|,
literal|1
block|,
literal|"c_sin"
block|}
block|,
block|{
name|TYDCOMPLEX
block|,
name|TYDCOMPLEX
block|,
literal|1
block|,
literal|"z_sin"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_cos"
block|,
literal|5
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_cos"
block|,
literal|5
block|}
block|,
block|{
name|TYCOMPLEX
block|,
name|TYCOMPLEX
block|,
literal|1
block|,
literal|"c_cos"
block|}
block|,
block|{
name|TYDCOMPLEX
block|,
name|TYDCOMPLEX
block|,
literal|1
block|,
literal|"z_cos"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_tan"
block|,
literal|6
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_tan"
block|,
literal|6
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_asin"
block|,
literal|7
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_asin"
block|,
literal|7
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_acos"
block|,
literal|8
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_acos"
block|,
literal|8
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_atan"
block|,
literal|9
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_atan"
block|,
literal|9
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|2
block|,
literal|"r_atn2"
block|,
literal|10
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|2
block|,
literal|"d_atn2"
block|,
literal|10
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_sinh"
block|,
literal|11
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_sinh"
block|,
literal|11
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_cosh"
block|,
literal|12
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_cosh"
block|,
literal|12
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_tanh"
block|,
literal|13
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_tanh"
block|,
literal|13
block|}
block|,
block|{
name|TYCHAR
block|,
name|TYLOGICAL
block|,
literal|2
block|,
literal|"hl_ge"
block|}
block|,
block|{
name|TYCHAR
block|,
name|TYLOGICAL
block|,
literal|2
block|,
literal|"l_ge"
block|}
block|,
block|{
name|TYCHAR
block|,
name|TYLOGICAL
block|,
literal|2
block|,
literal|"hl_gt"
block|}
block|,
block|{
name|TYCHAR
block|,
name|TYLOGICAL
block|,
literal|2
block|,
literal|"l_gt"
block|}
block|,
block|{
name|TYCHAR
block|,
name|TYLOGICAL
block|,
literal|2
block|,
literal|"hl_le"
block|}
block|,
block|{
name|TYCHAR
block|,
name|TYLOGICAL
block|,
literal|2
block|,
literal|"l_le"
block|}
block|,
block|{
name|TYCHAR
block|,
name|TYLOGICAL
block|,
literal|2
block|,
literal|"hl_lt"
block|}
block|,
block|{
name|TYCHAR
block|,
name|TYLOGICAL
block|,
literal|2
block|,
literal|"l_lt"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYSHORT
block|,
literal|1
block|,
literal|"hr_expn"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYLONG
block|,
literal|1
block|,
literal|"ir_expn"
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYSHORT
block|,
literal|1
block|,
literal|"hd_expn"
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYLONG
block|,
literal|1
block|,
literal|"id_expn"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_absp"
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_absp"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"r_rrsp"
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_rrsp"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|1
block|,
literal|"r_frac"
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|,
literal|"d_frac"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|2
block|,
literal|"r_make"
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|2
block|,
literal|"d_make"
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|2
block|,
literal|"r_scal"
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|2
block|,
literal|"d_scal"
block|}
block|}
struct|;
end_struct

begin_escape
end_escape

begin_macro
name|LOCAL
end_macro

begin_struct
struct|struct
name|Incstblock
block|{
name|char
name|atype
decl_stmt|;
name|char
name|rtype
decl_stmt|;
name|char
name|constno
decl_stmt|;
block|}
name|consttab
index|[ ]
init|=
block|{
block|{
name|TYSHORT
block|,
name|TYLONG
block|,
literal|0
block|}
block|,
block|{
name|TYLONG
block|,
name|TYLONG
block|,
literal|1
block|}
block|,
block|{
name|TYREAL
block|,
name|TYLONG
block|,
literal|2
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYLONG
block|,
literal|3
block|}
block|,
block|{
name|TYSHORT
block|,
name|TYLONG
block|,
literal|4
block|}
block|,
block|{
name|TYLONG
block|,
name|TYLONG
block|,
literal|5
block|}
block|,
block|{
name|TYREAL
block|,
name|TYLONG
block|,
literal|6
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYLONG
block|,
literal|7
block|}
block|,
block|{
name|TYREAL
block|,
name|TYLONG
block|,
literal|8
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYLONG
block|,
literal|9
block|}
block|,
block|{
name|TYREAL
block|,
name|TYLONG
block|,
literal|10
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYLONG
block|,
literal|11
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|0
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|1
block|}
block|,
block|{
name|TYSHORT
block|,
name|TYLONG
block|,
literal|12
block|}
block|,
block|{
name|TYLONG
block|,
name|TYLONG
block|,
literal|13
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|2
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|3
block|}
block|,
block|{
name|TYREAL
block|,
name|TYREAL
block|,
literal|4
block|}
block|,
block|{
name|TYDREAL
block|,
name|TYDREAL
block|,
literal|5
block|}
block|}
struct|;
end_struct

begin_comment
comment|/* For each machine, two arrays must be initialized. intcon contains 	radix for short int 	radix for long int 	radix for single precision 	radix for double precision 	precision for short int 	precision for long int 	precision for single precision 	precision for double precision 	emin for single precision 	emin for double precision 	emax for single precision 	emax for double prcision 	largest short int 	largest long int  realcon contains 	tiny for single precision 	tiny for double precision 	huge for single precision 	huge for double precision 	mrsp (epsilon) for single precision 	mrsp (epsilon) for double precision  the realcons should probably be filled in in binary if TARGET==HERE */
end_comment

begin_escape
end_escape

begin_decl_stmt
name|char
name|callbyvalue
index|[ ]
index|[
name|XL
index|]
init|=
block|{
literal|"sqrt"
block|,
literal|"exp"
block|,
literal|"log"
block|,
literal|"sin"
block|,
literal|"cos"
block|,
literal|"tan"
block|,
literal|"asin"
block|,
literal|"acos"
block|,
literal|"atan"
block|,
literal|"atan2"
block|,
literal|"sinh"
block|,
literal|"cosh"
block|,
literal|"tanh"
block|}
decl_stmt|;
end_decl_stmt

begin_escape
end_escape

begin_function
name|expptr
name|intrcall
parameter_list|(
name|np
parameter_list|,
name|argsp
parameter_list|,
name|nargs
parameter_list|)
name|Namep
name|np
decl_stmt|;
name|struct
name|Listblock
modifier|*
name|argsp
decl_stmt|;
name|int
name|nargs
decl_stmt|;
block|{
name|int
name|i
decl_stmt|,
name|rettype
decl_stmt|;
name|Addrp
name|ap
decl_stmt|;
specifier|register
name|struct
name|Specblock
modifier|*
name|sp
decl_stmt|;
specifier|register
name|struct
name|Chain
modifier|*
name|cp
decl_stmt|;
name|expptr
specifier|inline
operator|(
operator|)
operator|,
name|mkcxcon
argument_list|()
operator|,
name|mkrealcon
argument_list|()
expr_stmt|;
specifier|register
name|struct
name|Incstblock
modifier|*
name|cstp
decl_stmt|;
name|expptr
name|q
decl_stmt|,
name|ep
decl_stmt|;
name|int
name|mtype
decl_stmt|;
name|int
name|op
decl_stmt|;
name|int
name|f1field
decl_stmt|,
name|f2field
decl_stmt|,
name|f3field
decl_stmt|;
name|packed
operator|.
name|ijunk
operator|=
name|np
operator|->
name|vardesc
operator|.
name|varno
expr_stmt|;
name|f1field
operator|=
name|packed
operator|.
name|bits
operator|.
name|f1
expr_stmt|;
name|f2field
operator|=
name|packed
operator|.
name|bits
operator|.
name|f2
expr_stmt|;
name|f3field
operator|=
name|packed
operator|.
name|bits
operator|.
name|f3
expr_stmt|;
if|if
condition|(
name|nargs
operator|==
literal|0
condition|)
goto|goto
name|badnargs
goto|;
name|mtype
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|cp
operator|=
name|argsp
operator|->
name|listp
init|;
name|cp
condition|;
name|cp
operator|=
name|cp
operator|->
name|nextp
control|)
block|{
comment|/* TEMPORARY */
name|ep
operator|=
call|(
name|expptr
call|)
argument_list|(
name|cp
operator|->
name|datap
argument_list|)
expr_stmt|;
comment|/* TEMPORARY */
if|if
condition|(
name|ISCONST
argument_list|(
name|ep
argument_list|)
operator|&&
name|ep
operator|->
name|headblock
operator|.
name|vtype
operator|==
name|TYSHORT
condition|)
comment|/* TEMPORARY */
name|cp
operator|->
name|datap
operator|=
operator|(
name|tagptr
operator|)
name|mkconv
argument_list|(
name|tyint
argument_list|,
name|ep
argument_list|)
expr_stmt|;
name|mtype
operator|=
name|maxtype
argument_list|(
name|mtype
argument_list|,
name|ep
operator|->
name|headblock
operator|.
name|vtype
argument_list|)
expr_stmt|;
block|}
switch|switch
condition|(
name|f1field
condition|)
block|{
case|case
name|INTRBOOL
case|:
name|op
operator|=
name|f3field
expr_stmt|;
if|if
condition|(
operator|!
name|ONEOF
argument_list|(
name|mtype
argument_list|,
name|MSKINT
operator||
name|MSKLOGICAL
argument_list|)
condition|)
goto|goto
name|badtype
goto|;
if|if
condition|(
name|op
operator|==
name|OPBITNOT
condition|)
block|{
if|if
condition|(
name|nargs
operator|!=
literal|1
condition|)
goto|goto
name|badnargs
goto|;
name|q
operator|=
name|mkexpr
argument_list|(
name|OPBITNOT
argument_list|,
name|argsp
operator|->
name|listp
operator|->
name|datap
argument_list|,
name|ENULL
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|nargs
operator|!=
literal|2
condition|)
goto|goto
name|badnargs
goto|;
name|q
operator|=
name|mkexpr
argument_list|(
name|op
argument_list|,
name|argsp
operator|->
name|listp
operator|->
name|datap
argument_list|,
name|argsp
operator|->
name|listp
operator|->
name|nextp
operator|->
name|datap
argument_list|)
expr_stmt|;
block|}
name|frchain
argument_list|(
operator|&
operator|(
name|argsp
operator|->
name|listp
operator|)
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|charptr
operator|)
name|argsp
argument_list|)
expr_stmt|;
return|return
operator|(
name|q
operator|)
return|;
case|case
name|INTRCONV
case|:
if|if
condition|(
name|nargs
operator|==
literal|1
condition|)
block|{
if|if
condition|(
name|argsp
operator|->
name|listp
operator|->
name|datap
operator|->
name|headblock
operator|.
name|vtype
operator|==
name|TYERROR
condition|)
block|{
name|free
argument_list|(
operator|(
name|charptr
operator|)
name|argsp
operator|->
name|listp
operator|->
name|datap
argument_list|)
expr_stmt|;
name|frchain
argument_list|(
operator|&
operator|(
name|argsp
operator|->
name|listp
operator|)
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|charptr
operator|)
name|argsp
argument_list|)
expr_stmt|;
return|return
operator|(
name|errnode
argument_list|()
operator|)
return|;
block|}
block|}
elseif|else
if|if
condition|(
name|nargs
operator|==
literal|2
condition|)
block|{
if|if
condition|(
name|argsp
operator|->
name|listp
operator|->
name|nextp
operator|->
name|datap
operator|->
name|headblock
operator|.
name|vtype
operator|==
name|TYERROR
operator|||
name|argsp
operator|->
name|listp
operator|->
name|datap
operator|->
name|headblock
operator|.
name|vtype
operator|==
name|TYERROR
condition|)
block|{
name|free
argument_list|(
operator|(
name|charptr
operator|)
name|argsp
operator|->
name|listp
operator|->
name|nextp
operator|->
name|datap
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|charptr
operator|)
name|argsp
operator|->
name|listp
operator|->
name|datap
argument_list|)
expr_stmt|;
name|frchain
argument_list|(
operator|&
operator|(
name|argsp
operator|->
name|listp
operator|)
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|charptr
operator|)
name|argsp
argument_list|)
expr_stmt|;
return|return
operator|(
name|errnode
argument_list|()
operator|)
return|;
block|}
block|}
name|rettype
operator|=
name|f2field
expr_stmt|;
if|if
condition|(
name|rettype
operator|==
name|TYLONG
condition|)
name|rettype
operator|=
name|tyint
expr_stmt|;
if|if
condition|(
name|ISCOMPLEX
argument_list|(
name|rettype
argument_list|)
operator|&&
name|nargs
operator|==
literal|2
condition|)
block|{
name|expptr
name|qr
decl_stmt|,
name|qi
decl_stmt|;
name|qr
operator|=
call|(
name|expptr
call|)
argument_list|(
name|argsp
operator|->
name|listp
operator|->
name|datap
argument_list|)
expr_stmt|;
name|qi
operator|=
call|(
name|expptr
call|)
argument_list|(
name|argsp
operator|->
name|listp
operator|->
name|nextp
operator|->
name|datap
argument_list|)
expr_stmt|;
if|if
condition|(
name|ISCONST
argument_list|(
name|qr
argument_list|)
operator|&&
name|ISCONST
argument_list|(
name|qi
argument_list|)
condition|)
name|q
operator|=
name|mkcxcon
argument_list|(
name|qr
argument_list|,
name|qi
argument_list|)
expr_stmt|;
else|else
name|q
operator|=
name|mkexpr
argument_list|(
name|OPCONV
argument_list|,
name|mkconv
argument_list|(
name|rettype
operator|-
literal|2
argument_list|,
name|qr
argument_list|)
argument_list|,
name|mkconv
argument_list|(
name|rettype
operator|-
literal|2
argument_list|,
name|qi
argument_list|)
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|nargs
operator|==
literal|1
condition|)
name|q
operator|=
name|mkconv
argument_list|(
name|rettype
argument_list|,
name|argsp
operator|->
name|listp
operator|->
name|datap
argument_list|)
expr_stmt|;
else|else
goto|goto
name|badnargs
goto|;
name|q
operator|->
name|headblock
operator|.
name|vtype
operator|=
name|rettype
expr_stmt|;
name|frchain
argument_list|(
operator|&
operator|(
name|argsp
operator|->
name|listp
operator|)
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|charptr
operator|)
name|argsp
argument_list|)
expr_stmt|;
return|return
operator|(
name|q
operator|)
return|;
case|case
name|INTRCNST
case|:
name|cstp
operator|=
name|consttab
operator|+
name|f3field
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|f2field
condition|;
operator|++
name|i
control|)
if|if
condition|(
name|cstp
operator|->
name|atype
operator|==
name|mtype
condition|)
goto|goto
name|foundconst
goto|;
else|else
operator|++
name|cstp
expr_stmt|;
goto|goto
name|badtype
goto|;
name|foundconst
label|:
switch|switch
condition|(
name|cstp
operator|->
name|rtype
condition|)
block|{
case|case
name|TYLONG
case|:
return|return
operator|(
name|mkintcon
argument_list|(
name|intcon
index|[
name|cstp
operator|->
name|constno
index|]
argument_list|)
operator|)
return|;
case|case
name|TYREAL
case|:
case|case
name|TYDREAL
case|:
return|return
operator|(
name|mkrealcon
argument_list|(
name|cstp
operator|->
name|rtype
argument_list|,
name|realcon
index|[
name|cstp
operator|->
name|constno
index|]
argument_list|)
operator|)
return|;
default|default:
name|fatal
argument_list|(
literal|"impossible intrinsic constant"
argument_list|)
expr_stmt|;
block|}
case|case
name|INTRGEN
case|:
name|sp
operator|=
name|spectab
operator|+
name|f3field
expr_stmt|;
if|if
condition|(
name|no66flag
condition|)
if|if
condition|(
name|sp
operator|->
name|atype
operator|==
name|mtype
condition|)
goto|goto
name|specfunct
goto|;
else|else
name|err66
argument_list|(
literal|"generic function"
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|f2field
condition|;
operator|++
name|i
control|)
if|if
condition|(
name|sp
operator|->
name|atype
operator|==
name|mtype
condition|)
goto|goto
name|specfunct
goto|;
else|else
operator|++
name|sp
expr_stmt|;
goto|goto
name|badtype
goto|;
case|case
name|INTRSPEC
case|:
name|sp
operator|=
name|spectab
operator|+
name|f3field
expr_stmt|;
name|specfunct
label|:
if|if
condition|(
name|tyint
operator|==
name|TYLONG
operator|&&
name|ONEOF
argument_list|(
name|sp
operator|->
name|rtype
argument_list|,
name|M
argument_list|(
name|TYSHORT
argument_list|)
operator||
name|M
argument_list|(
name|TYLOGICAL
argument_list|)
argument_list|)
operator|&&
operator|(
name|sp
operator|+
literal|1
operator|)
operator|->
name|atype
operator|==
name|sp
operator|->
name|atype
condition|)
operator|++
name|sp
expr_stmt|;
if|if
condition|(
name|nargs
operator|!=
name|sp
operator|->
name|nargs
condition|)
goto|goto
name|badnargs
goto|;
if|if
condition|(
name|mtype
operator|!=
name|sp
operator|->
name|atype
condition|)
goto|goto
name|badtype
goto|;
name|fixargs
argument_list|(
name|YES
argument_list|,
name|argsp
argument_list|)
expr_stmt|;
if|if
condition|(
name|q
operator|=
specifier|inline
operator|(
name|sp
operator|-
name|spectab
operator|,
name|mtype
operator|,
name|argsp
operator|->
name|listp
operator|)
condition|)
block|{
name|frchain
argument_list|(
operator|&
operator|(
name|argsp
operator|->
name|listp
operator|)
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|charptr
operator|)
name|argsp
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|sp
operator|->
name|othername
condition|)
block|{
name|ap
operator|=
name|builtin
argument_list|(
name|sp
operator|->
name|rtype
argument_list|,
name|varstr
argument_list|(
name|XL
argument_list|,
name|callbyvalue
index|[
name|sp
operator|->
name|othername
operator|-
literal|1
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|q
operator|=
name|fixexpr
argument_list|(
name|mkexpr
argument_list|(
name|OPCCALL
argument_list|,
name|ap
argument_list|,
name|argsp
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|ap
operator|=
name|builtin
argument_list|(
name|sp
operator|->
name|rtype
argument_list|,
name|varstr
argument_list|(
name|XL
argument_list|,
name|sp
operator|->
name|spxname
argument_list|)
argument_list|)
expr_stmt|;
name|q
operator|=
name|fixexpr
argument_list|(
name|mkexpr
argument_list|(
name|OPCALL
argument_list|,
name|ap
argument_list|,
name|argsp
argument_list|)
argument_list|)
expr_stmt|;
block|}
return|return
operator|(
name|q
operator|)
return|;
case|case
name|INTRMIN
case|:
case|case
name|INTRMAX
case|:
if|if
condition|(
name|nargs
operator|<
literal|2
condition|)
goto|goto
name|badnargs
goto|;
if|if
condition|(
operator|!
name|ONEOF
argument_list|(
name|mtype
argument_list|,
name|MSKINT
operator||
name|MSKREAL
argument_list|)
condition|)
goto|goto
name|badtype
goto|;
name|argsp
operator|->
name|vtype
operator|=
name|mtype
expr_stmt|;
name|q
operator|=
name|mkexpr
argument_list|(
operator|(
name|f1field
operator|==
name|INTRMIN
condition|?
name|OPMIN
else|:
name|OPMAX
operator|)
argument_list|,
name|argsp
argument_list|,
name|ENULL
argument_list|)
expr_stmt|;
name|q
operator|->
name|headblock
operator|.
name|vtype
operator|=
name|mtype
expr_stmt|;
name|rettype
operator|=
name|f2field
expr_stmt|;
if|if
condition|(
name|rettype
operator|==
name|TYLONG
condition|)
name|rettype
operator|=
name|tyint
expr_stmt|;
elseif|else
if|if
condition|(
name|rettype
operator|==
name|TYUNKNOWN
condition|)
name|rettype
operator|=
name|mtype
expr_stmt|;
return|return
operator|(
name|mkconv
argument_list|(
name|rettype
argument_list|,
name|q
argument_list|)
operator|)
return|;
default|default:
name|fatali
argument_list|(
literal|"intrcall: bad intrgroup %d"
argument_list|,
name|f1field
argument_list|)
expr_stmt|;
block|}
name|badnargs
label|:
name|errstr
argument_list|(
literal|"bad number of arguments to intrinsic %s"
argument_list|,
name|varstr
argument_list|(
name|VL
argument_list|,
name|np
operator|->
name|varname
argument_list|)
argument_list|)
expr_stmt|;
goto|goto
name|bad
goto|;
name|badtype
label|:
name|errstr
argument_list|(
literal|"bad argument type to intrinsic %s"
argument_list|,
name|varstr
argument_list|(
name|VL
argument_list|,
name|np
operator|->
name|varname
argument_list|)
argument_list|)
expr_stmt|;
name|bad
label|:
return|return
operator|(
name|errnode
argument_list|()
operator|)
return|;
block|}
end_function

begin_macro
name|intrfunct
argument_list|(
argument|s
argument_list|)
end_macro

begin_decl_stmt
name|char
name|s
index|[
name|VL
index|]
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|struct
name|Intrblock
modifier|*
name|p
decl_stmt|;
name|char
name|nm
index|[
name|VL
index|]
decl_stmt|;
specifier|register
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|VL
condition|;
operator|++
name|s
control|)
name|nm
index|[
name|i
operator|++
index|]
operator|=
operator|(
operator|*
name|s
operator|==
literal|' '
condition|?
literal|'\0'
else|:
operator|*
name|s
operator|)
expr_stmt|;
for|for
control|(
name|p
operator|=
name|intrtab
init|;
name|p
operator|->
name|intrval
operator|.
name|intrgroup
operator|!=
name|INTREND
condition|;
operator|++
name|p
control|)
block|{
if|if
condition|(
name|eqn
argument_list|(
name|VL
argument_list|,
name|nm
argument_list|,
name|p
operator|->
name|intrfname
argument_list|)
condition|)
block|{
name|packed
operator|.
name|bits
operator|.
name|f1
operator|=
name|p
operator|->
name|intrval
operator|.
name|intrgroup
expr_stmt|;
name|packed
operator|.
name|bits
operator|.
name|f2
operator|=
name|p
operator|->
name|intrval
operator|.
name|intrstuff
expr_stmt|;
name|packed
operator|.
name|bits
operator|.
name|f3
operator|=
name|p
operator|->
name|intrval
operator|.
name|intrno
expr_stmt|;
return|return
operator|(
name|packed
operator|.
name|ijunk
operator|)
return|;
block|}
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_block

begin_function
name|Addrp
name|intraddr
parameter_list|(
name|np
parameter_list|)
name|Namep
name|np
decl_stmt|;
block|{
name|Addrp
name|q
decl_stmt|;
specifier|register
name|struct
name|Specblock
modifier|*
name|sp
decl_stmt|;
name|int
name|f3field
decl_stmt|;
if|if
condition|(
name|np
operator|->
name|vclass
operator|!=
name|CLPROC
operator|||
name|np
operator|->
name|vprocclass
operator|!=
name|PINTRINSIC
condition|)
name|fatalstr
argument_list|(
literal|"intraddr: %s is not intrinsic"
argument_list|,
name|varstr
argument_list|(
name|VL
argument_list|,
name|np
operator|->
name|varname
argument_list|)
argument_list|)
expr_stmt|;
name|packed
operator|.
name|ijunk
operator|=
name|np
operator|->
name|vardesc
operator|.
name|varno
expr_stmt|;
name|f3field
operator|=
name|packed
operator|.
name|bits
operator|.
name|f3
expr_stmt|;
switch|switch
condition|(
name|packed
operator|.
name|bits
operator|.
name|f1
condition|)
block|{
case|case
name|INTRGEN
case|:
comment|/* imag, log, and log10 arent specific functions */
if|if
condition|(
name|f3field
operator|==
literal|31
operator|||
name|f3field
operator|==
literal|43
operator|||
name|f3field
operator|==
literal|47
condition|)
goto|goto
name|bad
goto|;
case|case
name|INTRSPEC
case|:
name|sp
operator|=
name|spectab
operator|+
name|f3field
expr_stmt|;
if|if
condition|(
name|tyint
operator|==
name|TYLONG
operator|&&
name|sp
operator|->
name|rtype
operator|==
name|TYSHORT
condition|)
operator|++
name|sp
expr_stmt|;
name|q
operator|=
name|builtin
argument_list|(
name|sp
operator|->
name|rtype
argument_list|,
name|varstr
argument_list|(
name|XL
argument_list|,
name|sp
operator|->
name|spxname
argument_list|)
argument_list|)
expr_stmt|;
return|return
operator|(
name|q
operator|)
return|;
case|case
name|INTRCONV
case|:
case|case
name|INTRMIN
case|:
case|case
name|INTRMAX
case|:
case|case
name|INTRBOOL
case|:
case|case
name|INTRCNST
case|:
name|bad
label|:
name|errstr
argument_list|(
literal|"cannot pass %s as actual"
argument_list|,
name|varstr
argument_list|(
name|VL
argument_list|,
name|np
operator|->
name|varname
argument_list|)
argument_list|)
expr_stmt|;
return|return
operator|(
operator|(
name|Addrp
operator|)
name|errnode
argument_list|()
operator|)
return|;
block|}
name|fatali
argument_list|(
literal|"intraddr: impossible f1=%d\n"
argument_list|,
operator|(
name|int
operator|)
name|packed
operator|.
name|bits
operator|.
name|f1
argument_list|)
expr_stmt|;
comment|/* NOTREACHED */
block|}
end_function

begin_expr_stmt
name|expptr
specifier|inline
operator|(
name|fno
operator|,
name|type
operator|,
name|args
operator|)
name|int
name|fno
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|int
name|type
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|Chain
modifier|*
name|args
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|expptr
name|q
decl_stmt|,
name|t
decl_stmt|,
name|t1
decl_stmt|;
switch|switch
condition|(
name|fno
condition|)
block|{
case|case
literal|8
case|:
comment|/* real abs */
case|case
literal|9
case|:
comment|/* short int abs */
case|case
literal|10
case|:
comment|/* long int abs */
case|case
literal|11
case|:
comment|/* double precision abs */
if|if
condition|(
name|addressable
argument_list|(
name|q
operator|=
call|(
name|expptr
call|)
argument_list|(
name|args
operator|->
name|datap
argument_list|)
argument_list|)
condition|)
block|{
name|t
operator|=
name|q
expr_stmt|;
name|q
operator|=
name|NULL
expr_stmt|;
block|}
else|else
name|t
operator|=
operator|(
name|expptr
operator|)
name|mktemp
argument_list|(
name|type
argument_list|,
name|PNULL
argument_list|)
expr_stmt|;
name|t1
operator|=
name|mkexpr
argument_list|(
name|OPQUEST
argument_list|,
name|mkexpr
argument_list|(
name|OPLE
argument_list|,
name|mkconv
argument_list|(
name|type
argument_list|,
name|ICON
argument_list|(
literal|0
argument_list|)
argument_list|)
argument_list|,
name|cpexpr
argument_list|(
name|t
argument_list|)
argument_list|)
argument_list|,
name|mkexpr
argument_list|(
name|OPCOLON
argument_list|,
name|cpexpr
argument_list|(
name|t
argument_list|)
argument_list|,
name|mkexpr
argument_list|(
name|OPNEG
argument_list|,
name|cpexpr
argument_list|(
name|t
argument_list|)
argument_list|,
name|ENULL
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|q
condition|)
name|t1
operator|=
name|mkexpr
argument_list|(
name|OPCOMMA
argument_list|,
name|mkexpr
argument_list|(
name|OPASSIGN
argument_list|,
name|cpexpr
argument_list|(
name|t
argument_list|)
argument_list|,
name|q
argument_list|)
argument_list|,
name|t1
argument_list|)
expr_stmt|;
name|frexpr
argument_list|(
name|t
argument_list|)
expr_stmt|;
return|return
operator|(
name|t1
operator|)
return|;
case|case
literal|26
case|:
comment|/* dprod */
name|q
operator|=
name|mkexpr
argument_list|(
name|OPSTAR
argument_list|,
name|mkconv
argument_list|(
name|TYDREAL
argument_list|,
name|args
operator|->
name|datap
argument_list|)
argument_list|,
name|args
operator|->
name|nextp
operator|->
name|datap
argument_list|)
expr_stmt|;
return|return
operator|(
name|q
operator|)
return|;
case|case
literal|27
case|:
comment|/* len of character string */
name|q
operator|=
operator|(
name|expptr
operator|)
name|cpexpr
argument_list|(
name|args
operator|->
name|datap
operator|->
name|headblock
operator|.
name|vleng
argument_list|)
expr_stmt|;
name|frexpr
argument_list|(
name|args
operator|->
name|datap
argument_list|)
expr_stmt|;
return|return
operator|(
name|q
operator|)
return|;
case|case
literal|14
case|:
comment|/* half-integer mod */
case|case
literal|15
case|:
comment|/* mod */
return|return
operator|(
name|mkexpr
argument_list|(
name|OPMOD
argument_list|,
call|(
name|expptr
call|)
argument_list|(
name|args
operator|->
name|datap
argument_list|)
argument_list|,
call|(
name|expptr
call|)
argument_list|(
name|args
operator|->
name|nextp
operator|->
name|datap
argument_list|)
argument_list|)
operator|)
return|;
block|}
return|return
operator|(
name|NULL
operator|)
return|;
block|}
end_block

end_unit

