begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*	@(#)j0.c	4.1	12/25/82	*/
end_comment

begin_comment
comment|/* 	floating point Bessel's function 	of the first and second kinds 	of order zero  	j0(x) returns the value of J0(x) 	for all real values of x.  	There are no error returns. 	Calls sin, cos, sqrt.  	There is a niggling bug in J0 which 	causes errors up to 2e-16 for x in the 	interval [-8,8]. 	The bug is caused by an inappropriate order 	of summation of the series.  rhm will fix it 	someday.  	Coefficients are from Hart& Cheney. 	#5849 (19.22D) 	#6549 (19.25D) 	#6949 (19.41D)  	y0(x) returns the value of Y0(x) 	for positive real values of x. 	For x<=0, error number EDOM is set and a 	large negative value is returned.  	Calls sin, cos, sqrt, log, j0.  	The values of Y0 have not been checked 	to more than ten places.  	Coefficients are from Hart& Cheney. 	#6245 (18.78D) 	#6549 (19.25D) 	#6949 (19.41D) */
end_comment

begin_include
include|#
directive|include
file|<math.h>
end_include

begin_include
include|#
directive|include
file|<errno.h>
end_include

begin_decl_stmt
name|int
name|errno
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|pzero
decl_stmt|,
name|qzero
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|tpi
init|=
literal|.6366197723675813430755350535e0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|pio4
init|=
literal|.7853981633974483096156608458e0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p1
index|[]
init|=
block|{
literal|0.4933787251794133561816813446e21
block|,
operator|-
literal|.1179157629107610536038440800e21
block|,
literal|0.6382059341072356562289432465e19
block|,
operator|-
literal|.1367620353088171386865416609e18
block|,
literal|0.1434354939140344111664316553e16
block|,
operator|-
literal|.8085222034853793871199468171e13
block|,
literal|0.2507158285536881945555156435e11
block|,
operator|-
literal|.4050412371833132706360663322e8
block|,
literal|0.2685786856980014981415848441e5
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|q1
index|[]
init|=
block|{
literal|0.4933787251794133562113278438e21
block|,
literal|0.5428918384092285160200195092e19
block|,
literal|0.3024635616709462698627330784e17
block|,
literal|0.1127756739679798507056031594e15
block|,
literal|0.3123043114941213172572469442e12
block|,
literal|0.6699987672982239671814028660e9
block|,
literal|0.1114636098462985378182402543e7
block|,
literal|0.1363063652328970604442810507e4
block|,
literal|1.0
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p2
index|[]
init|=
block|{
literal|0.5393485083869438325262122897e7
block|,
literal|0.1233238476817638145232406055e8
block|,
literal|0.8413041456550439208464315611e7
block|,
literal|0.2016135283049983642487182349e7
block|,
literal|0.1539826532623911470917825993e6
block|,
literal|0.2485271928957404011288128951e4
block|,
literal|0.0
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|q2
index|[]
init|=
block|{
literal|0.5393485083869438325560444960e7
block|,
literal|0.1233831022786324960844856182e8
block|,
literal|0.8426449050629797331554404810e7
block|,
literal|0.2025066801570134013891035236e7
block|,
literal|0.1560017276940030940592769933e6
block|,
literal|0.2615700736920839685159081813e4
block|,
literal|1.0
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p3
index|[]
init|=
block|{
operator|-
literal|.3984617357595222463506790588e4
block|,
operator|-
literal|.1038141698748464093880530341e5
block|,
operator|-
literal|.8239066313485606568803548860e4
block|,
operator|-
literal|.2365956170779108192723612816e4
block|,
operator|-
literal|.2262630641933704113967255053e3
block|,
operator|-
literal|.4887199395841261531199129300e1
block|,
literal|0.0
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|q3
index|[]
init|=
block|{
literal|0.2550155108860942382983170882e6
block|,
literal|0.6667454239319826986004038103e6
block|,
literal|0.5332913634216897168722255057e6
block|,
literal|0.1560213206679291652539287109e6
block|,
literal|0.1570489191515395519392882766e5
block|,
literal|0.4087714673983499223402830260e3
block|,
literal|1.0
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p4
index|[]
init|=
block|{
operator|-
literal|.2750286678629109583701933175e20
block|,
literal|0.6587473275719554925999402049e20
block|,
operator|-
literal|.5247065581112764941297350814e19
block|,
literal|0.1375624316399344078571335453e18
block|,
operator|-
literal|.1648605817185729473122082537e16
block|,
literal|0.1025520859686394284509167421e14
block|,
operator|-
literal|.3436371222979040378171030138e11
block|,
literal|0.5915213465686889654273830069e8
block|,
operator|-
literal|.4137035497933148554125235152e5
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|q4
index|[]
init|=
block|{
literal|0.3726458838986165881989980e21
block|,
literal|0.4192417043410839973904769661e19
block|,
literal|0.2392883043499781857439356652e17
block|,
literal|0.9162038034075185262489147968e14
block|,
literal|0.2613065755041081249568482092e12
block|,
literal|0.5795122640700729537480087915e9
block|,
literal|0.1001702641288906265666651753e7
block|,
literal|0.1282452772478993804176329391e4
block|,
literal|1.0
block|, }
decl_stmt|;
end_decl_stmt

begin_function
name|double
name|j0
parameter_list|(
name|arg
parameter_list|)
name|double
name|arg
decl_stmt|;
block|{
name|double
name|argsq
decl_stmt|,
name|n
decl_stmt|,
name|d
decl_stmt|;
name|double
name|sin
argument_list|()
decl_stmt|,
name|cos
argument_list|()
decl_stmt|,
name|sqrt
argument_list|()
decl_stmt|;
name|int
name|i
decl_stmt|;
if|if
condition|(
name|arg
operator|<
literal|0.
condition|)
name|arg
operator|=
operator|-
name|arg
expr_stmt|;
if|if
condition|(
name|arg
operator|>
literal|8.
condition|)
block|{
name|asympt
argument_list|(
name|arg
argument_list|)
expr_stmt|;
name|n
operator|=
name|arg
operator|-
name|pio4
expr_stmt|;
return|return
operator|(
name|sqrt
argument_list|(
name|tpi
operator|/
name|arg
argument_list|)
operator|*
operator|(
name|pzero
operator|*
name|cos
argument_list|(
name|n
argument_list|)
operator|-
name|qzero
operator|*
name|sin
argument_list|(
name|n
argument_list|)
operator|)
operator|)
return|;
block|}
name|argsq
operator|=
name|arg
operator|*
name|arg
expr_stmt|;
for|for
control|(
name|n
operator|=
literal|0
operator|,
name|d
operator|=
literal|0
operator|,
name|i
operator|=
literal|8
init|;
name|i
operator|>=
literal|0
condition|;
name|i
operator|--
control|)
block|{
name|n
operator|=
name|n
operator|*
name|argsq
operator|+
name|p1
index|[
name|i
index|]
expr_stmt|;
name|d
operator|=
name|d
operator|*
name|argsq
operator|+
name|q1
index|[
name|i
index|]
expr_stmt|;
block|}
return|return
operator|(
name|n
operator|/
name|d
operator|)
return|;
block|}
end_function

begin_function
name|double
name|y0
parameter_list|(
name|arg
parameter_list|)
name|double
name|arg
decl_stmt|;
block|{
name|double
name|argsq
decl_stmt|,
name|n
decl_stmt|,
name|d
decl_stmt|;
name|double
name|sin
argument_list|()
decl_stmt|,
name|cos
argument_list|()
decl_stmt|,
name|sqrt
argument_list|()
decl_stmt|,
name|log
argument_list|()
decl_stmt|,
name|j0
argument_list|()
decl_stmt|;
name|int
name|i
decl_stmt|;
name|errno
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|arg
operator|<=
literal|0.
condition|)
block|{
name|errno
operator|=
name|EDOM
expr_stmt|;
return|return
operator|(
operator|-
name|HUGE
operator|)
return|;
block|}
if|if
condition|(
name|arg
operator|>
literal|8.
condition|)
block|{
name|asympt
argument_list|(
name|arg
argument_list|)
expr_stmt|;
name|n
operator|=
name|arg
operator|-
name|pio4
expr_stmt|;
return|return
operator|(
name|sqrt
argument_list|(
name|tpi
operator|/
name|arg
argument_list|)
operator|*
operator|(
name|pzero
operator|*
name|sin
argument_list|(
name|n
argument_list|)
operator|+
name|qzero
operator|*
name|cos
argument_list|(
name|n
argument_list|)
operator|)
operator|)
return|;
block|}
name|argsq
operator|=
name|arg
operator|*
name|arg
expr_stmt|;
for|for
control|(
name|n
operator|=
literal|0
operator|,
name|d
operator|=
literal|0
operator|,
name|i
operator|=
literal|8
init|;
name|i
operator|>=
literal|0
condition|;
name|i
operator|--
control|)
block|{
name|n
operator|=
name|n
operator|*
name|argsq
operator|+
name|p4
index|[
name|i
index|]
expr_stmt|;
name|d
operator|=
name|d
operator|*
name|argsq
operator|+
name|q4
index|[
name|i
index|]
expr_stmt|;
block|}
return|return
operator|(
name|n
operator|/
name|d
operator|+
name|tpi
operator|*
name|j0
argument_list|(
name|arg
argument_list|)
operator|*
name|log
argument_list|(
name|arg
argument_list|)
operator|)
return|;
block|}
end_function

begin_expr_stmt
specifier|static
name|asympt
argument_list|(
argument|arg
argument_list|)
name|double
name|arg
expr_stmt|;
end_expr_stmt

begin_block
block|{
name|double
name|zsq
decl_stmt|,
name|n
decl_stmt|,
name|d
decl_stmt|;
name|int
name|i
decl_stmt|;
name|zsq
operator|=
literal|64.
operator|/
operator|(
name|arg
operator|*
name|arg
operator|)
expr_stmt|;
for|for
control|(
name|n
operator|=
literal|0
operator|,
name|d
operator|=
literal|0
operator|,
name|i
operator|=
literal|6
init|;
name|i
operator|>=
literal|0
condition|;
name|i
operator|--
control|)
block|{
name|n
operator|=
name|n
operator|*
name|zsq
operator|+
name|p2
index|[
name|i
index|]
expr_stmt|;
name|d
operator|=
name|d
operator|*
name|zsq
operator|+
name|q2
index|[
name|i
index|]
expr_stmt|;
block|}
name|pzero
operator|=
name|n
operator|/
name|d
expr_stmt|;
for|for
control|(
name|n
operator|=
literal|0
operator|,
name|d
operator|=
literal|0
operator|,
name|i
operator|=
literal|6
init|;
name|i
operator|>=
literal|0
condition|;
name|i
operator|--
control|)
block|{
name|n
operator|=
name|n
operator|*
name|zsq
operator|+
name|p3
index|[
name|i
index|]
expr_stmt|;
name|d
operator|=
name|d
operator|*
name|zsq
operator|+
name|q3
index|[
name|i
index|]
expr_stmt|;
block|}
name|qzero
operator|=
operator|(
literal|8.
operator|/
name|arg
operator|)
operator|*
operator|(
name|n
operator|/
name|d
operator|)
expr_stmt|;
block|}
end_block

end_unit

