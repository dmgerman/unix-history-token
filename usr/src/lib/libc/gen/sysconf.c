begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 1993 The Regents of the University of California.  * All rights reserved.  *  * This code is derived from software contributed to Berkeley by  * Sean Eric Fagan of Cygnus Support.  *  * %sccs.include.redist.c%  */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|LIBC_SCCS
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|lint
argument_list|)
end_if

begin_decl_stmt
specifier|static
name|char
name|sccsid
index|[]
init|=
literal|"@(#)sysconf.c	5.1 (Berkeley) %G%"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* LIBC_SCCS and not lint */
end_comment

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<sys/sysctl.h>
end_include

begin_include
include|#
directive|include
file|<errno.h>
end_include

begin_include
include|#
directive|include
file|<unistd.h>
end_include

begin_function
name|long
name|sysconf
parameter_list|(
name|name
parameter_list|)
name|int
name|name
decl_stmt|;
block|{
name|struct
name|clockinfo
name|clk
decl_stmt|;
name|size_t
name|len
decl_stmt|;
name|int
name|mib
index|[
literal|2
index|]
decl_stmt|,
name|value
decl_stmt|;
switch|switch
condition|(
name|name
condition|)
block|{
case|case
name|_SC_ARG_MAX
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_KERN
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|KERN_ARGMAX
expr_stmt|;
break|break;
case|case
name|_SC_CHILD_MAX
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_KERN
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|KERN_MAXPROC
expr_stmt|;
break|break;
case|case
name|_SC_CLK_TCK
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_KERN
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|KERN_CLOCKRATE
expr_stmt|;
name|len
operator|=
sizeof|sizeof
argument_list|(
expr|struct
name|clockinfo
argument_list|)
expr_stmt|;
return|return
operator|(
name|sysctl
argument_list|(
name|mib
argument_list|,
literal|2
argument_list|,
operator|&
name|clk
argument_list|,
operator|&
name|len
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|)
operator|==
operator|-
literal|1
condition|?
operator|-
literal|1
else|:
name|clk
operator|.
name|hz
operator|)
return|;
case|case
name|_SC_NGROUPS_MAX
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_KERN
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|KERN_NGROUPS
expr_stmt|;
break|break;
case|case
name|_SC_OPEN_MAX
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_KERN
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|KERN_MAXFILES
expr_stmt|;
break|break;
case|case
name|_SC_JOB_CONTROL
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_KERN
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|KERN_JOB_CONTROL
expr_stmt|;
break|break;
case|case
name|_SC_SAVED_IDS
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_KERN
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|KERN_SAVED_IDS
expr_stmt|;
break|break;
case|case
name|_SC_VERSION
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_KERN
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|KERN_POSIX1
expr_stmt|;
break|break;
case|case
name|_SC_BC_BASE_MAX
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_USER
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|USER_BC_BASE_MAX
expr_stmt|;
break|break;
case|case
name|_SC_BC_DIM_MAX
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_USER
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|USER_BC_DIM_MAX
expr_stmt|;
break|break;
case|case
name|_SC_BC_SCALE_MAX
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_USER
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|USER_BC_SCALE_MAX
expr_stmt|;
break|break;
case|case
name|_SC_BC_STRING_MAX
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_USER
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|USER_BC_STRING_MAX
expr_stmt|;
break|break;
case|case
name|_SC_COLL_WEIGHTS_MAX
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_USER
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|USER_COLL_WEIGHTS_MAX
expr_stmt|;
break|break;
case|case
name|_SC_EXPR_NEST_MAX
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_USER
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|USER_EXPR_NEST_MAX
expr_stmt|;
break|break;
case|case
name|_SC_LINE_MAX
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_USER
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|USER_LINE_MAX
expr_stmt|;
break|break;
case|case
name|_SC_RE_DUP_MAX
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_USER
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|USER_RE_DUP_MAX
expr_stmt|;
break|break;
case|case
name|_SC_2_VERSION
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_USER
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|USER_POSIX2_VERSION
expr_stmt|;
break|break;
case|case
name|_SC_2_C_BIND
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_USER
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|USER_POSIX2_C_BIND
expr_stmt|;
break|break;
case|case
name|_SC_2_C_DEV
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_USER
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|USER_POSIX2_C_DEV
expr_stmt|;
break|break;
case|case
name|_SC_2_FORT_DEV
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_USER
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|USER_POSIX2_FORT_DEV
expr_stmt|;
break|break;
case|case
name|_SC_2_FORT_RUN
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_USER
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|USER_POSIX2_FORT_RUN
expr_stmt|;
break|break;
case|case
name|_SC_2_LOCALEDEF
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_USER
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|USER_POSIX2_LOCALEDEF
expr_stmt|;
break|break;
case|case
name|_SC_2_SW_DEV
case|:
name|mib
index|[
literal|0
index|]
operator|=
name|CTL_USER
expr_stmt|;
name|mib
index|[
literal|1
index|]
operator|=
name|USER_POSIX2_SW_DEV
expr_stmt|;
break|break;
default|default:
name|errno
operator|=
name|EINVAL
expr_stmt|;
return|return
operator|(
operator|-
literal|1
operator|)
return|;
block|}
name|len
operator|=
sizeof|sizeof
argument_list|(
name|value
argument_list|)
expr_stmt|;
return|return
operator|(
name|sysctl
argument_list|(
name|mib
argument_list|,
literal|2
argument_list|,
operator|&
name|value
argument_list|,
operator|&
name|len
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|)
operator|==
operator|-
literal|1
condition|?
operator|-
literal|1
else|:
name|value
operator|)
return|;
block|}
end_function

end_unit

