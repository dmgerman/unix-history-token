begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 1992 The Regents of the University of California.  * All rights reserved.  *  * %sccs.include.redist.c%  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
name|sccsid
index|[]
init|=
literal|"@(#)erf.c	5.4 (Berkeley) %G%"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* not lint */
end_comment

begin_comment
comment|/*  * ====================================================  * Copyright (C) 1992 by Sun Microsystems, Inc.  *  * Developed at SunPro, a Sun Microsystems, Inc. business.  * Permission to use, copy, modify, and distribute this  * software is freely granted, provided that this notice   * is preserved.  * ====================================================  *  * ******************* WARNING ********************  * This is an alpha version of SunPro's FDLIBM (Freely  * Distributable Math Library) for IEEE double precision   * arithmetic. FDLIBM is a basic math library written  * in C that runs on machines that conform to IEEE   * Standard 754/854. This alpha version is distributed   * for testing purpose. Those who use this software   * should report any bugs to   *  *		fdlibm-comments@sunpro.eng.sun.com  *  * -- K.C. Ng, Oct 12, 1992  * ************************************************  */
end_comment

begin_comment
comment|/* Modified Nov 30, 1992 P. McILROY:  *	Replaced expansion for x> 6  *	Add #ifdef's for vax/tahoe.  */
end_comment

begin_comment
comment|/* double erf(double x)  * double erfc(double x)  *			     x  *		      2      |\  *     erf(x)  =  ---------  | exp(-t*t)dt  *		   sqrt(pi) \|  *			     0  *  *     erfc(x) =  1-erf(x)  *  * Method:  *      1. Reduce x to |x| by erf(-x) = -erf(x)  *	2. For x in [0, 0.84375]  *	    erf(x)  = x + x*P(x^2)  *          erfc(x) = 1 - erf(x)           if x<=0.25  *                  = 0.5 + ((0.5-x)-x*P)  if x in [0.25,0.84375]  *	   where  *			2		 2	  4		  20    *              P =  P(x ) = (p0 + p1 * x + p2 * x + ... + p10 * x  )  * 	   is an approximation to (erf(x)-x)/x with precision  *  *						 -56.45  *			| P - (erf(x)-x)/x |<= 2  *	  *  *	   Remark. The formula is derived by noting  *          erf(x) = (2/sqrt(pi))*(x - x^3/3 + x^5/10 - x^7/42 + ....)  *	   and that  *          2/sqrt(pi) = 1.128379167095512573896158903121545171688  *	   is close to one. The interval is chosen because the fixed  *	   point of erf(x) is near 0.6174 (i.e., erf(x)=x when x is  *	   near 0.6174), and by some experiment, 0.84375 is chosen to  * 	   guarantee the error is less than one ulp for erf.  *  *      3. For x in [0.84375,1.25], let s = x - 1, and  *         c = 0.84506291151 rounded to single (24 bits)  *         	erf(x)  = c  + P1(s)/Q1(s)  *         	erfc(x) = (1-c)  - P1(s)/Q1(s)  *         	|P1/Q1 - (erf(x)-c)|<= 2**-59.06  *	   Remark: here we use the taylor series expansion at x=1.  *		erf(1+s) = erf(1) + s*Poly(s)  *			 = 0.845.. + P1(s)/Q1(s)  *	   That is, we use rational approximation to approximate  *			erf(1+s) - (c = (single)0.84506291151)  *	   Note that |P1/Q1|< 0.078 for x in [0.84375,1.25]  *	   where   *		P1(s) = degree 7 poly in s  *  *      4. For x in [1.25,6],  *         	erf(x)  = 1 - erfc(x)  *		erfc(x) = exp(-x*x)*(1/x)*R1(1/x)/S1(1/x)  *	where   *		R1(y) = degree 7 poly in y, (y=1/x)  *		S1(y) = degree 8 poly in y  *  *      5. For x in [6,28]  *         	erf(x)  = 1.0 - tiny  *		erfc(x)	= (1/x)exp(-x*x-(.5*log(pi)+eps) + zP(z))  *  *	Where P is degree 9 polynomial in z = 1/(x*x)  *  *      Notes:  *	   Here 4 and 5 make use of the asymptotic series  *			  exp(-x*x)  *		erfc(x) ~ ---------- * ( 1 + Poly(1/x^2) );  *			  x*sqrt(pi)  *  *		where for z = 1/(x*x)  *		P(z) ~ z/2*(-1 + z*3/2*(1 + z*5/2*(-1 + z*7/2*(1 +...))))  *  *	   Thus we use rational approximation to approximate  *              erfc*x*exp(x*x) ~ 1/sqrt(pi)   *  *		The error bound for the target function, G(z) for  *		case 5 is  * 		|eps + 1/(x*x)P(1/x*x) - G(x)|< 2**(-58.34)  *		For case 4,  *      	|R2/S2 - erfc*x*exp(x*x)|< 2**(-61.52)  *  *      6. For inf> x>= 28  *         	erf(x)  = 1 - tiny  (raise inexact)  *         	erfc(x) = tiny*tiny (raise underflow)  *  *      7. Special cases:  *         	erf(0)  = 0, erf(inf)  = 1, erf(-inf) = -1,  *         	erfc(0) = 1, erfc(inf) = 0, erfc(-inf) = 2,   *	   	erfc/erf(NaN) is NaN  */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|vax
argument_list|)
operator|||
name|defined
argument_list|(
name|tahoe
argument_list|)
end_if

begin_define
define|#
directive|define
name|_IEEE
value|0
end_define

begin_define
define|#
directive|define
name|TRUNC
parameter_list|(
name|x
parameter_list|)
value|(double) (float) (x)
end_define

begin_else
else|#
directive|else
end_else

begin_define
define|#
directive|define
name|_IEEE
value|1
end_define

begin_define
define|#
directive|define
name|TRUNC
parameter_list|(
name|x
parameter_list|)
value|*(((int *)&x) + 1)&= 0xf8000000
end_define

begin_define
define|#
directive|define
name|infnan
parameter_list|(
name|x
parameter_list|)
value|0.0
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_ifdef
ifdef|#
directive|ifdef
name|_IEEE_LIBM
end_ifdef

begin_comment
comment|/*  * redefining "___function" to "function" in _IEEE_LIBM mode  */
end_comment

begin_include
include|#
directive|include
file|"ieee_libm.h"
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
specifier|static
name|double
name|tiny
init|=
literal|1e-300
decl_stmt|,
name|half
init|=
literal|0.5
decl_stmt|,
name|one
init|=
literal|1.0
decl_stmt|,
name|two
init|=
literal|2.0
decl_stmt|,
name|c
init|=
literal|8.45062911510467529297e-01
decl_stmt|,
comment|/* (float)0.84506291151 */
comment|/*  * Coefficients for approximation to  erf on [0,0.84375]  */
name|p0t8
init|=
literal|1.02703333676410051049867154944018394163280
decl_stmt|,
name|p0
init|=
literal|1.283791670955125638123339436800229927041e-0001
decl_stmt|,
name|p1
init|=
operator|-
literal|3.761263890318340796574473028946097022260e-0001
decl_stmt|,
name|p2
init|=
literal|1.128379167093567004871858633779992337238e-0001
decl_stmt|,
name|p3
init|=
operator|-
literal|2.686617064084433642889526516177508374437e-0002
decl_stmt|,
name|p4
init|=
literal|5.223977576966219409445780927846432273191e-0003
decl_stmt|,
name|p5
init|=
operator|-
literal|8.548323822001639515038738961618255438422e-0004
decl_stmt|,
name|p6
init|=
literal|1.205520092530505090384383082516403772317e-0004
decl_stmt|,
name|p7
init|=
operator|-
literal|1.492214100762529635365672665955239554276e-0005
decl_stmt|,
name|p8
init|=
literal|1.640186161764254363152286358441771740838e-0006
decl_stmt|,
name|p9
init|=
operator|-
literal|1.571599331700515057841960987689515895479e-0007
decl_stmt|,
name|p10
init|=
literal|1.073087585213621540635426191486561494058e-0008
decl_stmt|,
comment|/*  * Coefficients for approximation to  erf  in [0.84375,1.25]   */
name|pa0
init|=
operator|-
literal|2.362118560752659485957248365514511540287e-0003
decl_stmt|,
name|pa1
init|=
literal|4.148561186837483359654781492060070469522e-0001
decl_stmt|,
name|pa2
init|=
operator|-
literal|3.722078760357013107593507594535478633044e-0001
decl_stmt|,
name|pa3
init|=
literal|3.183466199011617316853636418691420262160e-0001
decl_stmt|,
name|pa4
init|=
operator|-
literal|1.108946942823966771253985510891237782544e-0001
decl_stmt|,
name|pa5
init|=
literal|3.547830432561823343969797140537411825179e-0002
decl_stmt|,
name|pa6
init|=
operator|-
literal|2.166375594868790886906539848893221184820e-0003
decl_stmt|,
name|qa1
init|=
literal|1.064208804008442270765369280952419863524e-0001
decl_stmt|,
name|qa2
init|=
literal|5.403979177021710663441167681878575087235e-0001
decl_stmt|,
name|qa3
init|=
literal|7.182865441419627066207655332170665812023e-0002
decl_stmt|,
name|qa4
init|=
literal|1.261712198087616469108438860983447773726e-0001
decl_stmt|,
name|qa5
init|=
literal|1.363708391202905087876983523620537833157e-0002
decl_stmt|,
name|qa6
init|=
literal|1.198449984679910764099772682882189711364e-0002
decl_stmt|,
comment|/*  * Coefficients for approximation to  erfc in [1.25,6]  */
name|ra0
init|=
literal|5.641895806197543833169694096883621225329e-0001
decl_stmt|,
name|ra1
init|=
literal|7.239004794325021293310782759791744583987e+0000
decl_stmt|,
name|ra2
init|=
literal|4.615482605646378370356340497765510677914e+0001
decl_stmt|,
name|ra3
init|=
literal|1.831130716384318567879039478746072928548e+0002
decl_stmt|,
name|ra4
init|=
literal|4.827304689401256945023566678442020977744e+0002
decl_stmt|,
name|ra5
init|=
literal|8.443683805001379929687313735294340282751e+0002
decl_stmt|,
name|ra6
init|=
literal|9.151771804289399937165800774604677980269e+0002
decl_stmt|,
name|ra7
init|=
literal|4.884236881266866025539987843147838061930e+0002
decl_stmt|,
name|sa1
init|=
literal|1.283080158932067675016971332625972882793e+0001
decl_stmt|,
name|sa2
init|=
literal|8.230730944985601552133528541648529041935e+0001
decl_stmt|,
name|sa3
init|=
literal|3.309746710535947168967275132570416337810e+0002
decl_stmt|,
name|sa4
init|=
literal|8.960238586988354676031385802384985611536e+0002
decl_stmt|,
name|sa5
init|=
literal|1.652440076836585407285764071805622271834e+0003
decl_stmt|,
name|sa6
init|=
literal|2.010492426273281289533320672757992672142e+0003
decl_stmt|,
name|sa7
init|=
literal|1.466304171232599681829476641652969136592e+0003
decl_stmt|,
name|sa8
init|=
literal|4.884237022526160104676542187698268809111e+0002
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Coefficients for approximation to  erfc in [6,28]  */
end_comment

begin_define
define|#
directive|define
name|a0_hi
value|-0.5723649429247001929610405568
end_define

begin_comment
comment|/* ~-.5log(pi) */
end_comment

begin_define
define|#
directive|define
name|a0_lo
value|-0.0000000000000000189783711362898601
end_define

begin_define
define|#
directive|define
name|P0
value|-4.99999999999749700219098258458e-0001
end_define

begin_comment
comment|/* -1	   /2 	*/
end_comment

begin_define
define|#
directive|define
name|P1
value|6.24999999807451578348604925850e-0001
end_define

begin_comment
comment|/* 5/2	   /4	*/
end_comment

begin_define
define|#
directive|define
name|P2
value|-1.54166659013994022942029005208e+0001
end_define

begin_comment
comment|/* -37/3   /8	*/
end_comment

begin_define
define|#
directive|define
name|P3
value|5.51560710872094706047619183664e+0001
end_define

begin_comment
comment|/* 353/4   /16	*/
end_comment

begin_define
define|#
directive|define
name|P4
value|-2.55036053070125880992691236315e+0002
end_define

begin_comment
comment|/* -4081/5 /32	*/
end_comment

begin_define
define|#
directive|define
name|P5
value|1.43505282730286381820405949838e+0002
end_define

begin_comment
comment|/* 55205/6 /64	*/
end_comment

begin_define
define|#
directive|define
name|P6
value|-9.36421869861889035746571607888e+0002
end_define

begin_comment
comment|/* ....etc....	*/
end_comment

begin_define
define|#
directive|define
name|P7
value|6.51030087738772090233396738768e+0003
end_define

begin_define
define|#
directive|define
name|P8
value|-3.98835620275180117459967732430e+0004
end_define

begin_define
define|#
directive|define
name|P9
value|1.44460450428346201078966259956e+0005
end_define

begin_function
name|double
name|erf
parameter_list|(
name|x
parameter_list|)
name|double
name|x
decl_stmt|;
block|{
name|double
name|R
decl_stmt|,
name|S
decl_stmt|,
name|P
decl_stmt|,
name|Q
decl_stmt|,
name|ax
decl_stmt|,
name|s
decl_stmt|,
name|y
decl_stmt|,
name|z
decl_stmt|,
name|odd
decl_stmt|,
name|even
decl_stmt|,
name|r
decl_stmt|,
name|fabs
argument_list|()
decl_stmt|,
name|exp
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
name|finite
argument_list|(
name|x
argument_list|)
condition|)
block|{
comment|/* erf(nan)=nan */
if|if
condition|(
name|isnan
argument_list|(
name|x
argument_list|)
condition|)
return|return
operator|(
name|x
operator|)
return|;
return|return
operator|(
name|x
operator|>
literal|0
condition|?
name|one
else|:
operator|-
name|one
operator|)
return|;
comment|/* erf(+/-inf)= +/-1 */
block|}
if|if
condition|(
operator|(
name|ax
operator|=
name|x
operator|)
operator|<
literal|0
condition|)
name|ax
operator|=
operator|-
name|ax
expr_stmt|;
if|if
condition|(
name|ax
operator|<
literal|.84375
condition|)
block|{
if|if
condition|(
name|ax
operator|<
literal|3.7e-09
condition|)
block|{
if|if
condition|(
name|ax
operator|<
literal|1.0e-308
condition|)
return|return
literal|0.125
operator|*
operator|(
literal|8.0
operator|*
name|x
operator|+
name|p0t8
operator|*
name|x
operator|)
return|;
comment|/*avoid underflow */
return|return
name|x
operator|+
name|p0
operator|*
name|x
return|;
block|}
name|y
operator|=
name|x
operator|*
name|x
expr_stmt|;
name|z
operator|=
name|y
operator|*
name|y
expr_stmt|;
name|even
operator|=
name|z
operator|*
operator|(
name|p2
operator|+
name|z
operator|*
operator|(
name|p4
operator|+
name|z
operator|*
operator|(
name|p6
operator|+
name|z
operator|*
operator|(
name|p8
operator|+
name|z
operator|*
name|p10
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|odd
operator|=
name|p1
operator|+
name|z
operator|*
operator|(
name|p3
operator|+
name|z
operator|*
operator|(
name|p5
operator|+
name|z
operator|*
operator|(
name|p7
operator|+
name|z
operator|*
name|p9
operator|)
operator|)
operator|)
expr_stmt|;
name|r
operator|=
name|y
operator|*
name|odd
operator|+
name|even
expr_stmt|;
return|return
name|x
operator|+
name|x
operator|*
operator|(
name|p0
operator|+
name|r
operator|)
return|;
block|}
if|if
condition|(
name|ax
operator|<
literal|1.25
condition|)
block|{
comment|/* 0.84375<= |x|< 1.25 */
name|s
operator|=
name|fabs
argument_list|(
name|x
argument_list|)
operator|-
name|one
expr_stmt|;
name|P
operator|=
name|pa0
operator|+
name|s
operator|*
operator|(
name|pa1
operator|+
name|s
operator|*
operator|(
name|pa2
operator|+
name|s
operator|*
operator|(
name|pa3
operator|+
name|s
operator|*
operator|(
name|pa4
operator|+
name|s
operator|*
operator|(
name|pa5
operator|+
name|s
operator|*
name|pa6
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|Q
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|qa1
operator|+
name|s
operator|*
operator|(
name|qa2
operator|+
name|s
operator|*
operator|(
name|qa3
operator|+
name|s
operator|*
operator|(
name|qa4
operator|+
name|s
operator|*
operator|(
name|qa5
operator|+
name|s
operator|*
name|qa6
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
if|if
condition|(
name|x
operator|>=
literal|0
condition|)
return|return
operator|(
name|c
operator|+
name|P
operator|/
name|Q
operator|)
return|;
else|else
return|return
operator|(
operator|-
name|c
operator|-
name|P
operator|/
name|Q
operator|)
return|;
block|}
if|if
condition|(
name|ax
operator|>=
literal|6.0
condition|)
block|{
comment|/* inf>|x|>=6 */
if|if
condition|(
name|x
operator|>=
literal|0.0
condition|)
return|return
operator|(
name|one
operator|-
name|tiny
operator|)
return|;
else|else
return|return
operator|(
name|tiny
operator|-
name|one
operator|)
return|;
block|}
comment|/* 1.25<= |x|< 6 */
name|s
operator|=
name|one
operator|/
name|fabs
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|R
operator|=
name|ra0
operator|+
name|s
operator|*
operator|(
name|ra1
operator|+
name|s
operator|*
operator|(
name|ra2
operator|+
name|s
operator|*
operator|(
name|ra3
operator|+
name|s
operator|*
operator|(
name|ra4
operator|+
name|s
operator|*
operator|(
name|ra5
operator|+
name|s
operator|*
operator|(
name|ra6
operator|+
name|s
operator|*
name|ra7
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|S
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|sa1
operator|+
name|s
operator|*
operator|(
name|sa2
operator|+
name|s
operator|*
operator|(
name|sa3
operator|+
name|s
operator|*
operator|(
name|sa4
operator|+
name|s
operator|*
operator|(
name|sa5
operator|+
name|s
operator|*
operator|(
name|sa6
operator|+
name|s
operator|*
operator|(
name|sa7
operator|+
name|s
operator|*
name|sa8
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|z
operator|=
name|exp
argument_list|(
operator|-
name|x
operator|*
name|x
argument_list|)
operator|*
operator|(
name|R
operator|/
name|S
operator|)
operator|*
name|s
expr_stmt|;
if|if
condition|(
name|x
operator|>=
literal|0
condition|)
return|return
operator|(
name|one
operator|-
name|z
operator|)
return|;
else|else
return|return
operator|(
name|z
operator|-
name|one
operator|)
return|;
block|}
end_function

begin_function
name|double
name|erfc
parameter_list|(
name|x
parameter_list|)
name|double
name|x
decl_stmt|;
block|{
name|double
name|R
decl_stmt|,
name|S
decl_stmt|,
name|P
decl_stmt|,
name|Q
decl_stmt|,
name|s
decl_stmt|,
name|ax
decl_stmt|,
name|y
decl_stmt|,
name|odd
decl_stmt|,
name|even
decl_stmt|,
name|z
decl_stmt|,
name|r
decl_stmt|,
name|fabs
argument_list|()
decl_stmt|,
name|exp__D
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
name|finite
argument_list|(
name|x
argument_list|)
condition|)
block|{
if|if
condition|(
name|isnan
argument_list|(
name|x
argument_list|)
condition|)
comment|/* erfc(NaN) = NaN */
return|return
operator|(
name|x
operator|)
return|;
elseif|else
if|if
condition|(
name|x
operator|>
literal|0
condition|)
comment|/* erfc(+-inf)=0,2 */
return|return
literal|0.0
return|;
else|else
return|return
literal|2.0
return|;
block|}
if|if
condition|(
operator|(
name|ax
operator|=
name|x
operator|)
operator|<
literal|0
condition|)
name|ax
operator|=
operator|-
name|ax
expr_stmt|;
if|if
condition|(
name|ax
operator|<
literal|.84375
condition|)
block|{
comment|/* |x|<0.84375 */
if|if
condition|(
name|ax
operator|<
literal|1.38777878078144568e-17
condition|)
comment|/* |x|<2**-56 */
return|return
name|one
operator|-
name|x
return|;
name|y
operator|=
name|x
operator|*
name|x
expr_stmt|;
name|z
operator|=
name|y
operator|*
name|y
expr_stmt|;
name|even
operator|=
name|z
operator|*
operator|(
name|p2
operator|+
name|z
operator|*
operator|(
name|p4
operator|+
name|z
operator|*
operator|(
name|p6
operator|+
name|z
operator|*
operator|(
name|p8
operator|+
name|z
operator|*
name|p10
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|odd
operator|=
name|p1
operator|+
name|z
operator|*
operator|(
name|p3
operator|+
name|z
operator|*
operator|(
name|p5
operator|+
name|z
operator|*
operator|(
name|p7
operator|+
name|z
operator|*
name|p9
operator|)
operator|)
operator|)
expr_stmt|;
name|r
operator|=
name|y
operator|*
name|odd
operator|+
name|even
expr_stmt|;
if|if
condition|(
name|ax
operator|<
literal|.0625
condition|)
block|{
comment|/* |x|<2**-4 */
return|return
operator|(
name|one
operator|-
operator|(
name|x
operator|+
name|x
operator|*
operator|(
name|p0
operator|+
name|r
operator|)
operator|)
operator|)
return|;
block|}
else|else
block|{
name|r
operator|=
name|x
operator|*
operator|(
name|p0
operator|+
name|r
operator|)
expr_stmt|;
name|r
operator|+=
operator|(
name|x
operator|-
name|half
operator|)
expr_stmt|;
return|return
operator|(
name|half
operator|-
name|r
operator|)
return|;
block|}
block|}
if|if
condition|(
name|ax
operator|<
literal|1.25
condition|)
block|{
comment|/* 0.84375<= |x|< 1.25 */
name|s
operator|=
name|ax
operator|-
name|one
expr_stmt|;
name|P
operator|=
name|pa0
operator|+
name|s
operator|*
operator|(
name|pa1
operator|+
name|s
operator|*
operator|(
name|pa2
operator|+
name|s
operator|*
operator|(
name|pa3
operator|+
name|s
operator|*
operator|(
name|pa4
operator|+
name|s
operator|*
operator|(
name|pa5
operator|+
name|s
operator|*
name|pa6
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|Q
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|qa1
operator|+
name|s
operator|*
operator|(
name|qa2
operator|+
name|s
operator|*
operator|(
name|qa3
operator|+
name|s
operator|*
operator|(
name|qa4
operator|+
name|s
operator|*
operator|(
name|qa5
operator|+
name|s
operator|*
name|qa6
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
if|if
condition|(
name|x
operator|>=
literal|0
condition|)
block|{
name|z
operator|=
name|one
operator|-
name|c
expr_stmt|;
return|return
name|z
operator|-
name|P
operator|/
name|Q
return|;
block|}
else|else
block|{
name|z
operator|=
name|c
operator|+
name|P
operator|/
name|Q
expr_stmt|;
return|return
name|one
operator|+
name|z
return|;
block|}
block|}
if|if
condition|(
name|ax
operator|>=
literal|28
condition|)
comment|/* Out of range */
if|if
condition|(
name|x
operator|>
literal|0
condition|)
return|return
operator|(
name|tiny
operator|*
name|tiny
operator|)
return|;
else|else
return|return
operator|(
name|two
operator|-
name|tiny
operator|)
return|;
name|z
operator|=
name|ax
expr_stmt|;
name|TRUNC
argument_list|(
name|z
argument_list|)
expr_stmt|;
name|y
operator|=
name|z
operator|-
name|ax
expr_stmt|;
name|y
operator|*=
operator|(
name|ax
operator|+
name|z
operator|)
expr_stmt|;
name|z
operator|*=
operator|-
name|z
expr_stmt|;
comment|/* Here z + y = -x^2 */
if|if
condition|(
name|ax
operator|>=
literal|6
condition|)
block|{
comment|/* 6<= ax */
name|s
operator|=
name|one
operator|/
operator|(
operator|-
name|z
operator|-
name|y
operator|)
expr_stmt|;
comment|/* 1/(x*x) */
name|R
operator|=
name|s
operator|*
operator|(
name|P0
operator|+
name|s
operator|*
operator|(
name|P1
operator|+
name|s
operator|*
operator|(
name|P2
operator|+
name|s
operator|*
operator|(
name|P3
operator|+
name|s
operator|*
operator|(
name|P4
operator|+
name|s
operator|*
operator|(
name|P5
operator|+
name|s
operator|*
operator|(
name|P6
operator|+
name|s
operator|*
operator|(
name|P7
operator|+
name|s
operator|*
operator|(
name|P8
operator|+
name|s
operator|*
name|P9
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|y
operator|+=
name|a0_lo
expr_stmt|;
comment|/* return exp(-x^2 + a0_hi + R)/x;	*/
name|s
operator|=
operator|(
operator|(
name|R
operator|+
name|y
operator|)
operator|+
name|a0_hi
operator|)
operator|+
name|z
expr_stmt|;
name|y
operator|=
operator|(
operator|(
operator|(
name|z
operator|-
name|s
operator|)
operator|+
name|a0_hi
operator|)
operator|+
name|R
operator|)
operator|+
name|y
expr_stmt|;
name|r
operator|=
name|exp__D
argument_list|(
name|s
argument_list|,
name|y
argument_list|)
operator|/
name|x
expr_stmt|;
block|}
else|else
block|{
comment|/* 1.25<= ax<= 6 */
name|s
operator|=
name|one
operator|/
operator|(
name|ax
operator|)
expr_stmt|;
name|R
operator|=
name|ra0
operator|+
name|s
operator|*
operator|(
name|ra1
operator|+
name|s
operator|*
operator|(
name|ra2
operator|+
name|s
operator|*
operator|(
name|ra3
operator|+
name|s
operator|*
operator|(
name|ra4
operator|+
name|s
operator|*
operator|(
name|ra5
operator|+
name|s
operator|*
operator|(
name|ra6
operator|+
name|s
operator|*
name|ra7
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|S
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|sa1
operator|+
name|s
operator|*
operator|(
name|sa2
operator|+
name|s
operator|*
operator|(
name|sa3
operator|+
name|s
operator|*
operator|(
name|sa4
operator|+
name|s
operator|*
operator|(
name|sa5
operator|+
name|s
operator|*
operator|(
name|sa6
operator|+
name|s
operator|*
operator|(
name|sa7
operator|+
name|s
operator|*
name|sa8
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|r
operator|=
operator|(
name|R
operator|/
name|S
operator|)
operator|/
name|x
expr_stmt|;
name|s
operator|=
name|z
operator|+
name|y
expr_stmt|;
name|y
operator|=
operator|(
name|z
operator|-
name|s
operator|)
operator|+
name|y
expr_stmt|;
name|r
operator|*=
name|exp__D
argument_list|(
name|s
argument_list|,
name|y
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|x
operator|>
literal|0
condition|)
return|return
name|r
return|;
else|else
return|return
name|two
operator|-
name|r
return|;
block|}
end_function

end_unit

