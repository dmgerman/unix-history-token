begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_empty
empty|#
end_empty

begin_comment
comment|/*  *  *	UNIX debugger  *  */
end_comment

begin_include
include|#
directive|include
file|"defs.h"
end_include

begin_decl_stmt
name|MSG
name|LONGFIL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|MSG
name|NOTOPEN
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|MSG
name|A68BAD
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|MSG
name|A68LNK
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|MSG
name|BADMOD
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|MAP
name|txtmap
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|MAP
name|datmap
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|SYMTAB
name|symbol
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|INT
name|lastframe
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|INT
name|callpc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|INT
name|infile
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|INT
name|outfile
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|CHAR
modifier|*
name|lp
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|INT
name|maxoff
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|INT
name|maxpos
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|INT
name|octal
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* symbol management */
end_comment

begin_decl_stmt
name|L_INT
name|localval
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* breakpoints */
end_comment

begin_decl_stmt
name|BKPTR
name|bkpthead
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|REGLIST
name|reglist
index|[]
block|{
literal|"ps"
operator|,
name|ps
operator|,
literal|"pc"
operator|,
name|pc
operator|,
literal|"sp"
operator|,
name|sp
operator|,
literal|"r5"
operator|,
name|r5
operator|,
literal|"r4"
operator|,
name|r4
operator|,
literal|"r3"
operator|,
name|r3
operator|,
literal|"r2"
operator|,
name|r2
operator|,
literal|"r1"
operator|,
name|r1
operator|,
literal|"r0"
operator|,
name|r0
operator|,
block|}
end_decl_stmt

begin_empty_stmt
empty_stmt|;
end_empty_stmt

begin_decl_stmt
name|INT
name|frnames
index|[]
block|{
literal|0
operator|,
literal|3
operator|,
literal|4
operator|,
literal|5
operator|,
literal|1
operator|,
literal|2
block|}
end_decl_stmt

begin_empty_stmt
empty_stmt|;
end_empty_stmt

begin_decl_stmt
name|char
name|lastc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|POS
name|corhdr
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|POS
modifier|*
name|endhdr
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|INT
name|fcor
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|STRING
name|errflg
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|INT
name|signo
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|L_INT
name|dot
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|L_INT
name|var
index|[]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|STRING
name|symfil
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|STRING
name|corfil
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|INT
name|pid
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|L_INT
name|adrval
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|INT
name|adrflg
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|L_INT
name|cntval
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|INT
name|cntflg
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|STRING
name|signals
index|[]
block|{
literal|""
operator|,
literal|"hangup"
operator|,
literal|"interrupt"
operator|,
literal|"quit"
operator|,
literal|"illegal instruction"
operator|,
literal|"trace/BPT"
operator|,
literal|"IOT"
operator|,
literal|"EMT"
operator|,
literal|"floating exception"
operator|,
literal|"killed"
operator|,
literal|"bus error"
operator|,
literal|"memory fault"
operator|,
literal|"bad system call"
operator|,
literal|"broken pipe"
operator|,
literal|"alarm call"
operator|,
literal|"terminated"
operator|,
block|}
end_decl_stmt

begin_empty_stmt
empty_stmt|;
end_empty_stmt

begin_comment
comment|/* general printing routines ($) */
end_comment

begin_macro
name|printtrace
argument_list|(
argument|modif
argument_list|)
end_macro

begin_block
block|{
name|INT
name|narg
decl_stmt|,
name|i
decl_stmt|,
name|stat
decl_stmt|,
name|name
decl_stmt|,
name|limit
decl_stmt|;
name|POS
name|dynam
decl_stmt|;
name|REG
name|BKPTR
name|bkptr
decl_stmt|;
name|CHAR
name|hi
decl_stmt|,
name|lo
decl_stmt|;
name|INT
name|word
decl_stmt|;
name|STRING
name|comptr
decl_stmt|;
name|L_INT
name|argp
decl_stmt|,
name|frame
decl_stmt|,
name|link
decl_stmt|;
name|SYMPTR
name|symp
decl_stmt|;
name|IF
name|cntflg
operator|==
literal|0
name|THEN
name|cntval
operator|=
operator|-
literal|1
expr_stmt|;
name|FI
switch|switch
condition|(
name|modif
condition|)
block|{
case|case
literal|'<'
case|:
case|case
literal|'>'
case|:
block|{
name|CHAR
name|file
index|[
literal|64
index|]
decl_stmt|;
name|INT
name|index
decl_stmt|;
name|index
operator|=
literal|0
expr_stmt|;
name|IF
name|modif
operator|==
literal|'<'
name|THEN
name|iclose
argument_list|()
expr_stmt|;
name|ELSE
name|oclose
parameter_list|()
function_decl|;
name|FI
name|IF
name|rdc
argument_list|()
operator|!=
name|EOR
name|THEN
name|REP
name|file
index|[
name|index
operator|++
index|]
operator|=
name|lastc
expr_stmt|;
name|IF
name|index
operator|>=
literal|63
name|THEN
name|error
argument_list|(
name|LONGFIL
argument_list|)
expr_stmt|;
name|FI
name|PER
name|readchar
argument_list|()
operator|!=
name|EOR
name|DONE
name|file
index|[
name|index
index|]
operator|=
literal|0
expr_stmt|;
name|IF
name|modif
operator|==
literal|'<'
name|THEN
name|infile
operator|=
name|open
argument_list|(
name|file
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|IF
name|infile
operator|<
literal|0
name|THEN
name|infile
operator|=
literal|0
expr_stmt|;
name|error
argument_list|(
name|NOTOPEN
argument_list|)
expr_stmt|;
name|FI
name|ELSE
name|outfile
init|=
name|open
argument_list|(
name|file
argument_list|,
literal|1
argument_list|)
decl_stmt|;
name|IF
name|outfile
operator|<
literal|0
name|THEN
name|outfile
operator|=
name|creat
argument_list|(
name|file
argument_list|,
literal|0644
argument_list|)
expr_stmt|;
name|ELSE
name|lseek
argument_list|(
name|outfile
argument_list|,
literal|0L
argument_list|,
literal|2
argument_list|)
decl_stmt|;
name|FI
name|FI
name|FI
name|lp
operator|--
expr_stmt|;
block|}
break|break;
case|case
literal|'o'
case|:
name|octal
operator|=
name|TRUE
expr_stmt|;
break|break;
case|case
literal|'d'
case|:
name|octal
operator|=
name|FALSE
expr_stmt|;
break|break;
case|case
literal|'q'
case|:
case|case
literal|'Q'
case|:
case|case
literal|'%'
case|:
name|done
argument_list|()
expr_stmt|;
case|case
literal|'w'
case|:
case|case
literal|'W'
case|:
name|maxpos
operator|=
operator|(
name|adrflg
condition|?
name|adrval
else|:
name|MAXPOS
operator|)
expr_stmt|;
break|break;
case|case
literal|'s'
case|:
case|case
literal|'S'
case|:
name|maxoff
operator|=
operator|(
name|adrflg
condition|?
name|adrval
else|:
name|MAXOFF
operator|)
expr_stmt|;
break|break;
case|case
literal|'v'
case|:
case|case
literal|'V'
case|:
name|prints
argument_list|(
literal|"variables\n"
argument_list|)
expr_stmt|;
name|FOR
name|i
init|=
literal|0
decl_stmt|;
name|i
operator|<=
literal|35
expr_stmt|;
name|i
operator|++
name|DO
name|IF
name|var
index|[
name|i
index|]
name|THEN
name|printc
argument_list|(
operator|(
name|i
operator|<=
literal|9
condition|?
literal|'0'
else|:
literal|'a'
operator|-
literal|10
operator|)
operator|+
name|i
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|" = %Q\n"
argument_list|,
name|var
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|FI
name|OD
break|break;
case|case
literal|'m'
case|:
case|case
literal|'M'
case|:
name|printmap
argument_list|(
literal|"? map"
argument_list|,
operator|&
name|txtmap
argument_list|)
expr_stmt|;
name|printmap
argument_list|(
literal|"/ map"
argument_list|,
operator|&
name|datmap
argument_list|)
expr_stmt|;
break|break;
case|case
literal|0
case|:
case|case
literal|'?'
case|:
name|IF
name|pid
name|THEN
name|printf
argument_list|(
literal|"pcs id = %d\n"
argument_list|,
name|pid
argument_list|)
decl_stmt|;
name|ELSE
name|prints
argument_list|(
literal|"no process\n"
argument_list|)
decl_stmt|;
name|FI
name|sigprint
parameter_list|()
function_decl|;
name|flushbuf
argument_list|()
expr_stmt|;
case|case
literal|'r'
case|:
case|case
literal|'R'
case|:
name|printregs
argument_list|()
expr_stmt|;
return|return;
case|case
literal|'f'
case|:
case|case
literal|'F'
case|:
name|printfregs
argument_list|(
name|modif
operator|==
literal|'F'
argument_list|)
expr_stmt|;
return|return;
case|case
literal|'c'
case|:
case|case
literal|'C'
case|:
name|frame
operator|=
operator|(
name|adrflg
condition|?
name|adrval
else|:
name|endhdr
index|[
name|r5
index|]
operator|)
operator|&
name|EVEN
expr_stmt|;
name|lastframe
operator|=
literal|0
expr_stmt|;
name|callpc
operator|=
operator|(
name|adrflg
condition|?
name|get
argument_list|(
name|frame
operator|+
literal|2
argument_list|,
name|DSP
argument_list|)
else|:
name|endhdr
index|[
name|pc
index|]
operator|)
expr_stmt|;
name|WHILE
name|cntval
operator|--
name|DO
name|chkerr
argument_list|()
expr_stmt|;
name|narg
operator|=
name|findroutine
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"%.8s("
argument_list|,
name|symbol
operator|.
name|symc
argument_list|)
expr_stmt|;
name|argp
operator|=
name|frame
operator|+
literal|4
expr_stmt|;
name|IF
operator|--
name|narg
operator|>=
literal|0
name|THEN
name|printf
argument_list|(
literal|"%o"
argument_list|,
name|get
argument_list|(
name|argp
argument_list|,
name|DSP
argument_list|)
argument_list|)
expr_stmt|;
name|FI
name|WHILE
operator|--
name|narg
operator|>=
literal|0
name|DO
name|argp
operator|+=
literal|2
expr_stmt|;
name|printf
argument_list|(
literal|",%o"
argument_list|,
name|get
argument_list|(
name|argp
argument_list|,
name|DSP
argument_list|)
argument_list|)
expr_stmt|;
name|OD
name|prints
argument_list|(
literal|")\n"
argument_list|)
decl_stmt|;
name|IF
name|modif
operator|==
literal|'C'
name|THEN
name|WHILE
name|localsym
argument_list|(
argument|frame
argument_list|)
name|DO
name|word
operator|=
name|get
argument_list|(
name|localval
argument_list|,
name|DSP
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"%8t%.8s:%10t"
argument_list|,
name|symbol
operator|.
name|symc
argument_list|)
expr_stmt|;
name|IF
name|errflg
name|THEN
name|prints
argument_list|(
literal|"?\n"
argument_list|)
decl_stmt|;
name|errflg
operator|=
literal|0
expr_stmt|;
name|ELSE
name|printf
argument_list|(
literal|"%o\n"
argument_list|,
name|word
argument_list|)
decl_stmt|;
name|FI
name|OD
name|FI
name|lastframe
init|=
name|frame
decl_stmt|;
name|frame
operator|=
name|get
argument_list|(
name|frame
argument_list|,
name|DSP
argument_list|)
operator|&
name|EVEN
expr_stmt|;
name|IF
name|frame
operator|==
literal|0
name|THEN
break|break;
name|FI
name|OD
break|break;
comment|/*print externals*/
case|case
literal|'e'
case|:
case|case
literal|'E'
case|:
name|symset
argument_list|()
expr_stmt|;
name|WHILE
argument_list|(
argument|symp=symget()
argument_list|)
name|DO
name|chkerr
parameter_list|()
function_decl|;
name|IF
argument_list|(
name|symp
operator|->
name|symf
argument_list|)
operator|==
literal|043
name|ORF
argument_list|(
name|symp
operator|->
name|symf
argument_list|)
operator|==
literal|044
name|THEN
name|printf
argument_list|(
literal|"%.8s:%12t%o\n"
argument_list|,
name|symp
operator|->
name|symc
argument_list|,
name|get
argument_list|(
name|leng
argument_list|(
name|symp
operator|->
name|symv
argument_list|)
argument_list|,
name|DSP
argument_list|)
argument_list|)
expr_stmt|;
name|FI
name|OD
break|break;
case|case
literal|'a'
case|:
case|case
literal|'A'
case|:
name|frame
operator|=
operator|(
name|adrflg
condition|?
name|adrval
else|:
name|endhdr
index|[
name|r4
index|]
operator|)
expr_stmt|;
name|WHILE
name|cntval
operator|--
name|DO
name|chkerr
argument_list|()
expr_stmt|;
name|stat
operator|=
name|get
argument_list|(
name|frame
argument_list|,
name|DSP
argument_list|)
expr_stmt|;
name|dynam
operator|=
name|get
argument_list|(
name|frame
operator|+
literal|2
argument_list|,
name|DSP
argument_list|)
expr_stmt|;
name|link
operator|=
name|get
argument_list|(
name|frame
operator|+
literal|4
argument_list|,
name|DSP
argument_list|)
expr_stmt|;
name|IF
name|modif
operator|==
literal|'A'
name|THEN
name|printf
argument_list|(
literal|"%8O:%8t%-8o,%-8o,%-8o"
argument_list|,
name|frame
argument_list|,
name|stat
argument_list|,
name|dynam
argument_list|,
name|link
argument_list|)
expr_stmt|;
name|FI
name|IF
name|stat
operator|==
literal|1
name|THEN
break|break;
name|FI
name|IF
name|errflg
name|THEN
name|error
parameter_list|(
name|A68BAD
parameter_list|)
function_decl|;
name|FI
name|IF
name|get
argument_list|(
name|link
operator|-
literal|4
argument_list|,
name|ISP
argument_list|)
decl|!=04767
name|THEN
name|IF
name|get
argument_list|(
name|link
operator|-
literal|2
argument_list|,
name|ISP
argument_list|)
decl|!=04775
name|THEN
name|error
argument_list|(
name|A68LNK
argument_list|)
decl_stmt|;
name|ELSE
comment|/*compute entry point of routine*/
name|prints
argument_list|(
literal|" ? "
argument_list|)
decl_stmt|;
name|FI
name|ELSE
name|printf
argument_list|(
literal|"%8t"
argument_list|)
decl_stmt|;
name|valpr
argument_list|(
name|name
operator|=
name|shorten
argument_list|(
name|link
argument_list|)
operator|+
name|get
argument_list|(
name|link
operator|-
literal|2
argument_list|,
name|ISP
argument_list|)
argument_list|,
name|ISYM
argument_list|)
expr_stmt|;
name|name
operator|=
name|get
argument_list|(
name|leng
argument_list|(
name|name
operator|-
literal|2
argument_list|)
argument_list|,
name|ISP
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"%8t\""
argument_list|)
expr_stmt|;
name|limit
operator|=
literal|8
expr_stmt|;
name|REP
name|word
init|=
name|get
argument_list|(
name|leng
argument_list|(
name|name
argument_list|)
argument_list|,
name|DSP
argument_list|)
decl_stmt|;
name|name
operator|+=
literal|2
expr_stmt|;
name|lo
operator|=
name|word
operator|&
name|LOBYTE
expr_stmt|;
name|hi
operator|=
operator|(
name|word
operator|>>
literal|8
operator|)
operator|&
name|LOBYTE
expr_stmt|;
name|printc
argument_list|(
name|lo
argument_list|)
expr_stmt|;
name|printc
argument_list|(
name|hi
argument_list|)
expr_stmt|;
name|PER
name|lo
name|ANDF
name|hi
name|ANDF
name|limit
operator|--
name|DONE
name|printc
argument_list|(
literal|'"'
argument_list|)
expr_stmt|;
name|FI
name|limit
init|=
literal|4
decl_stmt|;
name|i
operator|=
literal|6
expr_stmt|;
name|printf
argument_list|(
literal|"%24targs:%8t"
argument_list|)
expr_stmt|;
name|WHILE
name|limit
operator|--
name|DO
name|printf
argument_list|(
literal|"%8t%o"
argument_list|,
name|get
argument_list|(
name|frame
operator|+
name|i
argument_list|,
name|DSP
argument_list|)
argument_list|)
expr_stmt|;
name|i
operator|+=
literal|2
expr_stmt|;
name|OD
name|printc
parameter_list|(
name|EOR
parameter_list|)
function_decl|;
name|frame
operator|=
name|dynam
expr_stmt|;
name|OD
name|errflg
init|=
literal|0
decl_stmt|;
name|flushbuf
argument_list|()
expr_stmt|;
break|break;
comment|/*set default c frame*/
comment|/*print breakpoints*/
case|case
literal|'b'
case|:
case|case
literal|'B'
case|:
name|printf
argument_list|(
literal|"breakpoints\ncount%8tbkpt%24tcommand\n"
argument_list|)
expr_stmt|;
name|FOR
name|bkptr
init|=
name|bkpthead
decl_stmt|;
name|bkptr
expr_stmt|;
name|bkptr
operator|=
name|bkptr
operator|->
name|nxtbkpt
name|DO
name|IF
name|bkptr
operator|->
name|flag
name|THEN
name|printf
argument_list|(
literal|"%-8.8d"
argument_list|,
name|bkptr
operator|->
name|count
argument_list|)
expr_stmt|;
name|psymoff
argument_list|(
name|leng
argument_list|(
name|bkptr
operator|->
name|loc
argument_list|)
argument_list|,
name|ISYM
argument_list|,
literal|"%24t"
argument_list|)
expr_stmt|;
name|comptr
operator|=
name|bkptr
operator|->
name|comm
expr_stmt|;
name|WHILE
modifier|*
name|comptr
name|DO
name|printc
argument_list|(
operator|*
name|comptr
operator|++
argument_list|)
decl_stmt|;
name|OD
name|FI
name|OD
break|break;
default|default:
name|error
argument_list|(
name|BADMOD
argument_list|)
expr_stmt|;
block|}
block|}
end_block

begin_macro
name|printmap
argument_list|(
argument|s
argument_list|,
argument|amap
argument_list|)
end_macro

begin_decl_stmt
name|STRING
name|s
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|MAP
modifier|*
name|amap
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|int
name|file
decl_stmt|;
name|file
operator|=
name|amap
operator|->
name|ufd
expr_stmt|;
name|printf
argument_list|(
literal|"%s%12t`%s'\n"
argument_list|,
name|s
argument_list|,
operator|(
name|file
operator|<
literal|0
condition|?
literal|"-"
else|:
operator|(
name|file
operator|==
name|fcor
condition|?
name|corfil
else|:
name|symfil
operator|)
operator|)
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"b1 = %-16Q"
argument_list|,
name|amap
operator|->
name|b1
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"e1 = %-16Q"
argument_list|,
name|amap
operator|->
name|e1
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"f1 = %-16Q"
argument_list|,
name|amap
operator|->
name|f1
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\nb2 = %-16Q"
argument_list|,
name|amap
operator|->
name|b2
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"e2 = %-16Q"
argument_list|,
name|amap
operator|->
name|e2
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"f2 = %-16Q"
argument_list|,
name|amap
operator|->
name|f2
argument_list|)
expr_stmt|;
name|printc
argument_list|(
name|EOR
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|printfregs
argument_list|(
argument|longpr
argument_list|)
end_macro

begin_block
block|{
name|REG
name|i
decl_stmt|;
name|L_REAL
name|f
decl_stmt|;
name|printf
argument_list|(
literal|"fpsr	%o\n"
argument_list|,
name|corhdr
index|[
literal|0
index|]
operator|.
name|fpsr
argument_list|)
expr_stmt|;
name|FOR
name|i
init|=
literal|0
decl_stmt|;
name|i
operator|<
name|FRMAX
expr_stmt|;
name|i
operator|++
name|DO
name|IF
name|corhdr
index|[
literal|0
index|]
operator|.
name|fpsr
operator|&
name|FD
name|ORF
name|longpr
comment|/* long mode */
name|THEN
name|f
operator|=
name|corhdr
index|[
literal|0
index|]
operator|.
name|Lfr
index|[
name|frnames
index|[
name|i
index|]
index|]
expr_stmt|;
name|ELSE
name|f
init|=
name|corhdr
index|[
literal|0
index|]
operator|.
name|Sfr
index|[
name|frnames
index|[
name|i
index|]
index|]
decl_stmt|;
name|FI
name|printf
argument_list|(
literal|"fr%-8d%-32.18f\n"
argument_list|,
name|i
argument_list|,
name|f
argument_list|)
decl_stmt|;
name|OD
block|}
end_block

begin_macro
name|printregs
argument_list|()
end_macro

begin_block
block|{
name|REG
name|REGPTR
name|p
decl_stmt|;
name|INT
name|v
decl_stmt|;
name|FOR
name|p
init|=
name|reglist
decl_stmt|;
name|p
operator|<
operator|&
name|reglist
index|[
literal|9
index|]
expr_stmt|;
name|p
operator|++
name|DO
name|printf
argument_list|(
literal|"%s%8t%o%8t"
argument_list|,
name|p
operator|->
name|rname
argument_list|,
name|v
operator|=
name|endhdr
index|[
name|p
operator|->
name|roffs
index|]
argument_list|)
expr_stmt|;
name|valpr
argument_list|(
name|v
argument_list|,
operator|(
name|p
operator|->
name|roffs
operator|==
name|pc
condition|?
name|ISYM
else|:
name|DSYM
operator|)
argument_list|)
expr_stmt|;
name|printc
argument_list|(
name|EOR
argument_list|)
expr_stmt|;
name|OD
name|printpc
parameter_list|()
function_decl|;
block|}
end_block

begin_macro
name|getreg
argument_list|(
argument|regnam
argument_list|)
end_macro

begin_block
block|{
name|REG
name|REGPTR
name|p
decl_stmt|;
name|REG
name|STRING
name|regptr
decl_stmt|;
name|CHAR
name|regnxt
decl_stmt|;
name|regnxt
operator|=
name|readchar
argument_list|()
expr_stmt|;
name|FOR
name|p
init|=
name|reglist
decl_stmt|;
name|p
operator|<
operator|&
name|reglist
index|[
literal|9
index|]
expr_stmt|;
name|p
operator|++
name|DO
name|regptr
operator|=
name|p
operator|->
name|rname
expr_stmt|;
name|IF
argument_list|(
argument|regnam == *regptr++
argument_list|)
name|ANDF
argument_list|(
argument|regnxt == *regptr
argument_list|)
name|THEN
return|return
operator|(
name|p
operator|->
name|roffs
operator|)
return|;
name|FI
name|OD
name|lp
operator|--
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_block

begin_macro
name|printpc
argument_list|()
end_macro

begin_block
block|{
name|dot
operator|=
name|endhdr
index|[
name|pc
index|]
expr_stmt|;
name|psymoff
argument_list|(
name|dot
argument_list|,
name|ISYM
argument_list|,
literal|":%16t"
argument_list|)
expr_stmt|;
name|printins
argument_list|(
literal|0
argument_list|,
name|ISP
argument_list|,
name|chkget
argument_list|(
name|dot
argument_list|,
name|ISP
argument_list|)
argument_list|)
expr_stmt|;
name|printc
argument_list|(
name|EOR
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|sigprint
argument_list|()
end_macro

begin_block
block|{
name|prints
argument_list|(
name|signals
index|[
name|signo
index|]
argument_list|)
expr_stmt|;
block|}
end_block

end_unit

