begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*      *	pCopy.c      *	a collection of functions      *	to copy pi's tree nodes      *	to pTree pNodes.      */
end_comment

begin_include
include|#
directive|include
file|"whoami"
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|PTREE
end_ifdef

begin_include
include|#
directive|include
file|"0.h"
end_include

begin_comment
comment|/*      *	get all the pi tree tags      */
end_comment

begin_include
include|#
directive|include
file|"tree.h"
end_include

begin_comment
comment|/*	constructs a ThreadNode to a declaration      *	given an identifier char * symbol      */
end_comment

begin_function
name|pPointer
name|ThreadSymbol
parameter_list|(
name|symbol
parameter_list|)
name|char
modifier|*
name|symbol
decl_stmt|;
block|{
name|pPointer
name|Thread
decl_stmt|;
name|struct
name|nl
modifier|*
name|symbp
init|=
name|nllook
argument_list|(
name|symbol
argument_list|)
decl_stmt|;
if|if
condition|(
name|symbp
operator|==
name|NIL
operator|||
name|symbp
operator|->
name|inTree
operator|==
name|pNIL
condition|)
return|return
name|pNIL
return|;
name|Thread
operator|=
name|pNewNode
argument_list|(
name|ThreadTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|ThreadNode
argument_list|)
argument_list|)
expr_stmt|;
name|pDEF
argument_list|(
name|Thread
argument_list|)
operator|.
name|ThreadPointer
operator|=
name|symbp
operator|->
name|inTree
expr_stmt|;
return|return
name|Thread
return|;
block|}
end_function

begin_comment
comment|/*	constructs a ThreadNode to a declaration      *	given a namelist pointer      */
end_comment

begin_function
name|pPointer
name|ThreadName
parameter_list|(
name|nlp
parameter_list|)
name|struct
name|nl
modifier|*
name|nlp
decl_stmt|;
block|{
name|pPointer
name|Thread
decl_stmt|;
if|if
condition|(
name|nlp
operator|==
name|NIL
operator|||
name|nlp
operator|->
name|inTree
operator|==
name|pNIL
condition|)
return|return
name|pNIL
return|;
name|Thread
operator|=
name|pNewNode
argument_list|(
name|ThreadTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|ThreadNode
argument_list|)
argument_list|)
expr_stmt|;
name|pDEF
argument_list|(
name|Thread
argument_list|)
operator|.
name|ThreadPointer
operator|=
name|nlp
operator|->
name|inTree
expr_stmt|;
return|return
name|Thread
return|;
block|}
end_function

begin_comment
comment|/*      *	copies a unary operator node to an appropriate pNode.      *	unary operators come in two flavors,      *	those with known constant operands (T_PLUSC and T_MINUSC),      *	and those (T_PLUS, T_MINUS, and T_NOT)      *	which carry around with them whether they have a constant operand      *	unop	[0]	T_PLUSC, T_MINUSC  or   [0]	T_PLUS, T_MINUS, T_NOT      *		[1]	expression		[1]	constant operand?      *						[2]	expression      */
end_comment

begin_function
name|pPointer
name|UnOpCopy
parameter_list|(
name|unop
parameter_list|)
name|int
modifier|*
name|unop
decl_stmt|;
block|{
name|pPointer
name|UnOp
decl_stmt|;
name|pPointer
name|Expr
decl_stmt|;
switch|switch
condition|(
name|unop
index|[
literal|0
index|]
condition|)
block|{
case|case
name|T_PLUSC
case|:
case|case
name|T_PLUS
case|:
name|UnOp
operator|=
name|pNewNode
argument_list|(
name|PlusTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|PlusNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_MINUSC
case|:
case|case
name|T_MINUS
case|:
name|UnOp
operator|=
name|pNewNode
argument_list|(
name|MinusTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|MinusNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_NOT
case|:
name|UnOp
operator|=
name|pNewNode
argument_list|(
name|NotTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|NotNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
default|default:
name|panic
argument_list|(
literal|"UnOpCopy"
argument_list|)
expr_stmt|;
block|}
switch|switch
condition|(
name|unop
index|[
literal|0
index|]
condition|)
block|{
case|case
name|T_PLUSC
case|:
case|case
name|T_MINUSC
case|:
name|Expr
operator|=
name|tCopy
argument_list|(
name|unop
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_PLUS
case|:
case|case
name|T_MINUS
case|:
case|case
name|T_NOT
case|:
name|Expr
operator|=
name|tCopy
argument_list|(
name|unop
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
break|break;
default|default:
name|panic
argument_list|(
literal|"UnOpCopy"
argument_list|)
expr_stmt|;
block|}
name|pDEF
argument_list|(
name|UnOp
argument_list|)
operator|.
name|UnOpExpr
operator|=
name|Expr
expr_stmt|;
return|return
name|UnOp
return|;
block|}
end_function

begin_comment
comment|/*      *	returns an empty PtrTNode      *	to be filled in by foredecl      *	typtr	[0]	T_TYPTR      *		[1]	lineof "^"      *		[2][0]	T_ID      *		   [1]	type name      */
end_comment

begin_function
name|pPointer
name|PtrTCopy
parameter_list|(
name|typtr
parameter_list|)
name|int
modifier|*
name|typtr
decl_stmt|;
block|{
name|pPointer
name|PtrT
init|=
name|pNewNode
argument_list|(
name|PtrTTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|PtrTNode
argument_list|)
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|PtrT
argument_list|)
operator|.
name|PtrTType
operator|=
name|pNIL
expr_stmt|;
return|return
name|PtrT
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a PACKED declaration to a PackTNode      *	typack	[0]	T_TYPACK      *		[1]	lineof "packed"      *		[2]	structured type      */
end_comment

begin_function
name|pPointer
name|PackTCopy
parameter_list|(
name|typack
parameter_list|)
name|int
modifier|*
name|typack
decl_stmt|;
block|{
name|pPointer
name|PackT
init|=
name|pNewNode
argument_list|(
name|PackTTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|PackTNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Type
init|=
name|tCopy
argument_list|(
name|typack
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|PackT
argument_list|)
operator|.
name|PackTType
operator|=
name|Type
expr_stmt|;
return|return
name|PackT
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_TYRANG node to a RangeTNode      *	tyrang	[0]	T_TYRANG      *		[1]	lineof ".."      *		[2]	lower const      *		[3]	upper const      */
end_comment

begin_function
name|pPointer
name|RangeTCopy
parameter_list|(
name|tyrang
parameter_list|)
name|int
modifier|*
name|tyrang
decl_stmt|;
block|{
name|pPointer
name|RangeT
init|=
name|pNewNode
argument_list|(
name|RangeTTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|RangeTNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Lower
init|=
name|tCopy
argument_list|(
name|tyrang
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|Upper
init|=
name|tCopy
argument_list|(
name|tyrang
index|[
literal|3
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|RangeT
argument_list|)
operator|.
name|RangeTLower
operator|=
name|Lower
expr_stmt|;
name|pDEF
argument_list|(
name|RangeT
argument_list|)
operator|.
name|RangeTUpper
operator|=
name|Upper
expr_stmt|;
return|return
name|RangeT
return|;
block|}
end_function

begin_comment
comment|/*      *	ArrayTCopy      *	copy a T_TYARY node to an ArrayTNode      *	tyary	[0]	T_TYARY      *		[1]	lineof "array"      *		[2]	simple_type_list      *		[3]	type      */
end_comment

begin_function
name|pPointer
name|ArrayTCopy
parameter_list|(
name|tyary
parameter_list|)
name|int
modifier|*
name|tyary
decl_stmt|;
block|{
name|pPointer
name|ArrayT
init|=
name|pNewNode
argument_list|(
name|ArrayTTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|ArrayTNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Dims
init|=
name|tCopy
argument_list|(
name|tyary
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|Type
init|=
name|tCopy
argument_list|(
name|tyary
index|[
literal|3
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|ArrayT
argument_list|)
operator|.
name|ArrayTDims
operator|=
name|Dims
expr_stmt|;
name|pDEF
argument_list|(
name|ArrayT
argument_list|)
operator|.
name|ArrayTType
operator|=
name|Type
expr_stmt|;
return|return
name|ArrayT
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_TYFILE node to a FileTNode      *	tyfile	[0]	T_TYFILE      *		[1]	lineof file      *		[2]	type      */
end_comment

begin_function
name|pPointer
name|FileTCopy
parameter_list|(
name|tyfile
parameter_list|)
name|int
modifier|*
name|tyfile
decl_stmt|;
block|{
name|pPointer
name|FileT
init|=
name|pNewNode
argument_list|(
name|FileTTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|FileTNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Type
init|=
name|tCopy
argument_list|(
name|tyfile
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|FileT
argument_list|)
operator|.
name|FileTType
operator|=
name|Type
expr_stmt|;
return|return
name|FileT
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_TYSET node of a SetTNode      *	tyset	[0]	T_TYSET      *		[1]	lineof "set"      *		[2]	simple type      */
end_comment

begin_function
name|pPointer
name|SetTCopy
parameter_list|(
name|tyset
parameter_list|)
name|int
modifier|*
name|tyset
decl_stmt|;
block|{
name|pPointer
name|SetT
init|=
name|pNewNode
argument_list|(
name|SetTTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|SetTNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Type
init|=
name|tCopy
argument_list|(
name|tyset
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|SetT
argument_list|)
operator|.
name|SetTType
operator|=
name|Type
expr_stmt|;
return|return
name|SetT
return|;
block|}
end_function

begin_comment
comment|/*      *	copy an extended T_TYREC node to a RecTNode      *	tyrec	[0]	T_TYREC      *		[1]	lineof field_list      *		[2]	pointer to field_list      *		[3]>>pTree extension<< struct nl * to record in namelist      *	sets extern inrecord so fields know in which record they are.      *	saved previous inrecord to deal with nested records.      */
end_comment

begin_function
name|pPointer
name|RecTCopy
parameter_list|(
name|tyrec
parameter_list|)
name|int
modifier|*
name|tyrec
decl_stmt|;
block|{
specifier|extern
name|struct
name|nl
modifier|*
name|inrecord
decl_stmt|;
name|struct
name|nl
modifier|*
name|saverecord
decl_stmt|;
name|pPointer
name|RecT
init|=
name|pNewNode
argument_list|(
name|RecTTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|RecTNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Fldlst
decl_stmt|;
name|saverecord
operator|=
name|inrecord
expr_stmt|;
name|inrecord
operator|=
operator|(
expr|struct
name|nl
operator|*
operator|)
name|tyrec
index|[
literal|3
index|]
expr_stmt|;
name|Fldlst
operator|=
name|tCopy
argument_list|(
name|tyrec
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|pDEF
argument_list|(
name|RecT
argument_list|)
operator|.
name|RecTFldlst
operator|=
name|Fldlst
expr_stmt|;
name|inrecord
operator|=
name|saverecord
expr_stmt|;
return|return
name|RecT
return|;
block|}
end_function

begin_comment
comment|/*      *	copy an extended T_FLDLST node to a FldlstNode      *	fldlst	[0]	T_FLDLST      *		[1]	0      *		[2]	fixed part (list of T_RFIELDs)      *		[3]	variant part (pointer to T_TYVARPT node)      */
end_comment

begin_function
name|pPointer
name|FldlstCopy
parameter_list|(
name|fldlst
parameter_list|)
name|int
modifier|*
name|fldlst
decl_stmt|;
block|{
name|pPointer
name|Fldlst
init|=
name|pNewNode
argument_list|(
name|FldlstTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|FldlstNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Fixed
decl_stmt|;
name|pPointer
name|Varpt
decl_stmt|;
name|Fixed
operator|=
name|tCopy
argument_list|(
name|fldlst
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|Varpt
operator|=
name|tCopy
argument_list|(
name|fldlst
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|pDEF
argument_list|(
name|Fldlst
argument_list|)
operator|.
name|FldlstFixed
operator|=
name|Fixed
expr_stmt|;
name|pDEF
argument_list|(
name|Fldlst
argument_list|)
operator|.
name|FldlstVariant
operator|=
name|Varpt
expr_stmt|;
return|return
name|Fldlst
return|;
block|}
end_function

begin_comment
comment|/*      *	copies a T_TYVARNT to a VCaseNode      *	tyvarnt	[0]	T_TYVARNT      *		[1]	lineof ":"      *		[2]	constant list      *		[3]	nil or&(T_FLDLST node)      */
end_comment

begin_function
name|pPointer
name|VCaseCopy
parameter_list|(
name|tyvarnt
parameter_list|)
name|int
modifier|*
name|tyvarnt
decl_stmt|;
block|{
name|pPointer
name|VCase
init|=
name|pNewNode
argument_list|(
name|VCaseTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|VCaseNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Consts
init|=
name|tCopy
argument_list|(
name|tyvarnt
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|Rec
init|=
name|tCopy
argument_list|(
name|tyvarnt
index|[
literal|3
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|VCase
argument_list|)
operator|.
name|VCaseConsts
operator|=
name|Consts
expr_stmt|;
name|pDEF
argument_list|(
name|VCase
argument_list|)
operator|.
name|VCaseRec
operator|=
name|Rec
expr_stmt|;
return|return
name|VCase
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_CSTAT to a CasedNode      *	cstat	[0]	T_CSTAT      *		[1]	lineof ":"      *		[2]	constant list      *		[3]	statement      */
end_comment

begin_function
name|pPointer
name|CasedCopy
parameter_list|(
name|cstat
parameter_list|)
name|int
modifier|*
name|cstat
decl_stmt|;
block|{
name|pPointer
name|Cased
init|=
name|pNewNode
argument_list|(
name|CasedTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|CasedNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Label
init|=
name|tCopy
argument_list|(
name|cstat
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|Stat
init|=
name|tCopy
argument_list|(
name|cstat
index|[
literal|3
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|Cased
argument_list|)
operator|.
name|CasedLabel
operator|=
name|Label
expr_stmt|;
name|pDEF
argument_list|(
name|Cased
argument_list|)
operator|.
name|CasedStat
operator|=
name|Stat
expr_stmt|;
return|return
name|Cased
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_LABEL to a ListNode      *	whose ListUp is a LabelNode and       *	whose ListDown is the labelled statement      *	(cf. the hack in ListAppend )      *	label	[0]	T_LABEL      *		[1]	lineof :      *		[2]	hash of integer label      *		[3]	statement      */
end_comment

begin_function
name|pPointer
name|LabelCopy
parameter_list|(
name|label
parameter_list|)
name|int
modifier|*
name|label
decl_stmt|;
block|{
name|pPointer
name|List
decl_stmt|;
name|pPointer
name|Label
init|=
name|pNewNode
argument_list|(
name|LabelTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|LabelNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Stat
decl_stmt|;
name|Stat
operator|=
name|tCopy
argument_list|(
name|label
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|pDEF
argument_list|(
name|Label
argument_list|)
operator|.
name|LabelLabel
operator|=
name|nllook
argument_list|(
name|label
index|[
literal|2
index|]
argument_list|)
operator|->
name|inTree
expr_stmt|;
name|List
operator|=
name|ListAppend
argument_list|(
name|pNIL
argument_list|,
name|Stat
argument_list|)
expr_stmt|;
name|pDEF
argument_list|(
name|List
argument_list|)
operator|.
name|ListUp
operator|=
name|Label
expr_stmt|;
return|return
name|List
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_PCALL node to a PCallNode      *	pcall	[0]	T_PCALL      *		[1]	lineof yyline or "("      *		[2]	proc_id      *		[3]	actual list      */
end_comment

begin_function
name|pPointer
name|PCallCopy
parameter_list|(
name|pcall
parameter_list|)
name|int
modifier|*
name|pcall
decl_stmt|;
block|{
name|pPointer
name|PCall
init|=
name|pNewNode
argument_list|(
name|PCallTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|PCallNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Id
init|=
name|ThreadSymbol
argument_list|(
name|pcall
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|Actuals
init|=
name|tCopy
argument_list|(
name|pcall
index|[
literal|3
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|PCall
argument_list|)
operator|.
name|PCallId
operator|=
name|Id
expr_stmt|;
name|pDEF
argument_list|(
name|PCall
argument_list|)
operator|.
name|PCallActuals
operator|=
name|Actuals
expr_stmt|;
return|return
name|PCall
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_CASE node to a CaseSNode      *	tcase	[0]	T_CASE      *		[1]	lineof "case"      *		[2]	expression      *		[3]	list of cases      */
end_comment

begin_function
name|pPointer
name|CaseSCopy
parameter_list|(
name|tcase
parameter_list|)
name|int
modifier|*
name|tcase
decl_stmt|;
block|{
name|pPointer
name|CaseS
init|=
name|pNewNode
argument_list|(
name|CaseSTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|CaseSNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Expr
init|=
name|tCopy
argument_list|(
name|tcase
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|Caselist
init|=
name|tCopy
argument_list|(
name|tcase
index|[
literal|3
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|CaseS
argument_list|)
operator|.
name|CaseSExpr
operator|=
name|Expr
expr_stmt|;
name|pDEF
argument_list|(
name|CaseS
argument_list|)
operator|.
name|CaseSStat
operator|=
name|Caselist
expr_stmt|;
return|return
name|CaseS
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_WITH node to a WithNode      *	with	[0]	T_WITH      *		[1]	lineof "with"      *		[2]	variable list      *		[3]	statement      */
end_comment

begin_function
name|pPointer
name|WithCopy
parameter_list|(
name|with
parameter_list|)
name|int
modifier|*
name|with
decl_stmt|;
block|{
name|pPointer
name|With
init|=
name|pNewNode
argument_list|(
name|WithTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|WithNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Vars
init|=
name|tCopy
argument_list|(
name|with
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|Stat
init|=
name|tCopy
argument_list|(
name|with
index|[
literal|3
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|With
argument_list|)
operator|.
name|WithVars
operator|=
name|Vars
expr_stmt|;
name|pDEF
argument_list|(
name|With
argument_list|)
operator|.
name|WithStat
operator|=
name|Stat
expr_stmt|;
return|return
name|With
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_WHILE node to a WhileNode      *	twhile	[0]	T_WHILE      *		[1]	lineof "while"      *		[2]	expression      *		[3]	statement      */
end_comment

begin_function
name|pPointer
name|WhileCopy
parameter_list|(
name|twhile
parameter_list|)
name|int
modifier|*
name|twhile
decl_stmt|;
block|{
name|pPointer
name|While
init|=
name|pNewNode
argument_list|(
name|WhileTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|WhileNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Expr
init|=
name|tCopy
argument_list|(
name|twhile
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|Stat
init|=
name|tCopy
argument_list|(
name|twhile
index|[
literal|3
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|While
argument_list|)
operator|.
name|WhileExpr
operator|=
name|Expr
expr_stmt|;
name|pDEF
argument_list|(
name|While
argument_list|)
operator|.
name|WhileStat
operator|=
name|Stat
expr_stmt|;
return|return
name|While
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_REPEAT node to a RepeatNode      *	trepeat	[0]	T_REPEAT      *		[1]	lineof "repeat"      *		[2]	statement list      *		[3]	expression      */
end_comment

begin_function
name|pPointer
name|RepeatCopy
parameter_list|(
name|trepeat
parameter_list|)
name|int
modifier|*
name|trepeat
decl_stmt|;
block|{
name|pPointer
name|Repeat
init|=
name|pNewNode
argument_list|(
name|RepeatTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|RepeatNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Stat
init|=
name|tCopy
argument_list|(
name|trepeat
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|Expr
init|=
name|tCopy
argument_list|(
name|trepeat
index|[
literal|3
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|Repeat
argument_list|)
operator|.
name|RepeatStat
operator|=
name|Stat
expr_stmt|;
name|pDEF
argument_list|(
name|Repeat
argument_list|)
operator|.
name|RepeatExpr
operator|=
name|Expr
expr_stmt|;
return|return
name|Repeat
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_FORU or T_FORD node to a ForUNode or a ForDNode      *	tfor	[0]	T_FORU or T_FORD      *		[1]	lineof "for"      *		[2]	assignment      *		[3]	termination expression      *		[4]	statement      */
end_comment

begin_function
name|pPointer
name|ForCopy
parameter_list|(
name|tfor
parameter_list|)
name|int
modifier|*
name|tfor
decl_stmt|;
block|{
name|pPointer
name|For
decl_stmt|;
name|pPointer
name|Assign
decl_stmt|;
name|pPointer
name|Expr
decl_stmt|;
name|pPointer
name|Stat
decl_stmt|;
switch|switch
condition|(
name|tfor
index|[
literal|0
index|]
condition|)
block|{
case|case
name|T_FORU
case|:
name|For
operator|=
name|pNewNode
argument_list|(
name|ForUTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|ForUNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_FORD
case|:
name|For
operator|=
name|pNewNode
argument_list|(
name|ForDTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|ForDNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
default|default:
name|panic
argument_list|(
literal|"ForCopy"
argument_list|)
expr_stmt|;
block|}
name|Assign
operator|=
name|tCopy
argument_list|(
name|tfor
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|Expr
operator|=
name|tCopy
argument_list|(
name|tfor
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|Stat
operator|=
name|tCopy
argument_list|(
name|tfor
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|pDEF
argument_list|(
name|For
argument_list|)
operator|.
name|ForUAssign
operator|=
name|Assign
expr_stmt|;
name|pDEF
argument_list|(
name|For
argument_list|)
operator|.
name|ForUExpr
operator|=
name|Expr
expr_stmt|;
name|pDEF
argument_list|(
name|For
argument_list|)
operator|.
name|ForUStat
operator|=
name|Stat
expr_stmt|;
return|return
name|For
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_FORD node to a ForDNode      *	ford	[0]	T_FORD      *		[1]	lineof "for"      *		[2]	assignment      *		[3]	termination expression      *		[4]	statement      */
end_comment

begin_function
name|pPointer
name|ForDCopy
parameter_list|(
name|ford
parameter_list|)
name|int
modifier|*
name|ford
decl_stmt|;
block|{
name|pPointer
name|ForD
init|=
name|pNewNode
argument_list|(
name|ForDTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|ForDNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Assign
init|=
name|tCopy
argument_list|(
name|ford
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|Expr
init|=
name|tCopy
argument_list|(
name|ford
index|[
literal|3
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|Stat
init|=
name|tCopy
argument_list|(
name|ford
index|[
literal|4
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|ForD
argument_list|)
operator|.
name|ForDAssign
operator|=
name|Assign
expr_stmt|;
name|pDEF
argument_list|(
name|ForD
argument_list|)
operator|.
name|ForDExpr
operator|=
name|Expr
expr_stmt|;
name|pDEF
argument_list|(
name|ForD
argument_list|)
operator|.
name|ForDStat
operator|=
name|Stat
expr_stmt|;
return|return
name|ForD
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_GOTO node to a GotoNode      *	tgoto	[0]	T_GOTO      *		[1]	lineof "goto"      *		[2]	hash of integer label      */
end_comment

begin_function
name|pPointer
name|GotoCopy
parameter_list|(
name|tgoto
parameter_list|)
name|int
modifier|*
name|tgoto
decl_stmt|;
block|{
name|pPointer
name|Goto
init|=
name|pNewNode
argument_list|(
name|GotoTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|GotoNode
argument_list|)
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|Goto
argument_list|)
operator|.
name|GotoLabel
operator|=
name|nllook
argument_list|(
name|tgoto
index|[
literal|2
index|]
argument_list|)
operator|->
name|inTree
expr_stmt|;
return|return
name|Goto
return|;
block|}
end_function

begin_comment
comment|/*      *	copy T_IF or T_IFEL nodes to IfNodes      *	tif	[0]	T_IF or T_IFEL      *		[1]	lineof "if"      *		[2]	expression      *		[3]	then statement      *		[4]	else statement      */
end_comment

begin_function
name|pPointer
name|IfCopy
parameter_list|(
name|tif
parameter_list|)
name|int
modifier|*
name|tif
decl_stmt|;
block|{
name|pPointer
name|If
init|=
name|pNewNode
argument_list|(
name|IfTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|IfNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Cond
init|=
name|tCopy
argument_list|(
name|tif
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|Then
init|=
name|tCopy
argument_list|(
name|tif
index|[
literal|3
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|Else
init|=
name|tCopy
argument_list|(
name|tif
index|[
literal|4
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|If
argument_list|)
operator|.
name|IfCond
operator|=
name|Cond
expr_stmt|;
name|pDEF
argument_list|(
name|If
argument_list|)
operator|.
name|IfThen
operator|=
name|Then
expr_stmt|;
name|pDEF
argument_list|(
name|If
argument_list|)
operator|.
name|IfElse
operator|=
name|Else
expr_stmt|;
return|return
name|If
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_ASRT node to an AssertNode      *	asrt	[0]	T_ASRT      *		[1]	lineof "assert"      *		[2]	expression      */
end_comment

begin_function
name|pPointer
name|AssertCopy
parameter_list|(
name|asrt
parameter_list|)
name|int
modifier|*
name|asrt
decl_stmt|;
block|{
name|pPointer
name|Assert
init|=
name|pNewNode
argument_list|(
name|AssertTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|AssertNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Expr
init|=
name|tCopy
argument_list|(
name|asrt
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|Assert
argument_list|)
operator|.
name|AssertExpr
operator|=
name|Expr
expr_stmt|;
return|return
name|Assert
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_ASGN node to an AssignNode      *	asgn	[0]	T_ASGN      *		[1]	lineof ":" (of ":=")      *		[2]	variable      *		[3]	expression      */
end_comment

begin_function
name|pPointer
name|AssignCopy
parameter_list|(
name|asgn
parameter_list|)
name|int
modifier|*
name|asgn
decl_stmt|;
block|{
name|pPointer
name|Assign
init|=
name|pNewNode
argument_list|(
name|AssignTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|AssignNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Var
init|=
name|tCopy
argument_list|(
name|asgn
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|Expr
init|=
name|tCopy
argument_list|(
name|asgn
index|[
literal|3
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|Assign
argument_list|)
operator|.
name|AssignVar
operator|=
name|Var
expr_stmt|;
name|pDEF
argument_list|(
name|Assign
argument_list|)
operator|.
name|AssignExpr
operator|=
name|Expr
expr_stmt|;
return|return
name|Assign
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a binary operator to an appropriate pNode      *	binop	[0]	T_EQ, T_LT, T_GT, T_LE, T_GE, T_NE,      *			T_ADD, T_SUB, T_MULT, T_DIV, T_DIVD, T_MOD      *			T_IN, T_OR, T_AND      *		[1]	SAWCON      *		[2]	left operand expression      *		[3]	right operand expression      */
end_comment

begin_function
name|pPointer
name|BinOpCopy
parameter_list|(
name|binop
parameter_list|)
name|int
modifier|*
name|binop
decl_stmt|;
block|{
name|pPointer
name|BinOp
decl_stmt|;
name|pPointer
name|Left
decl_stmt|;
name|pPointer
name|Right
decl_stmt|;
switch|switch
condition|(
name|binop
index|[
literal|0
index|]
condition|)
block|{
case|case
name|T_EQ
case|:
name|BinOp
operator|=
name|pNewNode
argument_list|(
name|EqTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|EqNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_LT
case|:
name|BinOp
operator|=
name|pNewNode
argument_list|(
name|LtTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|LtNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_GT
case|:
name|BinOp
operator|=
name|pNewNode
argument_list|(
name|GtTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|GtNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_LE
case|:
name|BinOp
operator|=
name|pNewNode
argument_list|(
name|LeTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|LeNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_GE
case|:
name|BinOp
operator|=
name|pNewNode
argument_list|(
name|GeTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|GeNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_NE
case|:
name|BinOp
operator|=
name|pNewNode
argument_list|(
name|NeTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|NeNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_ADD
case|:
name|BinOp
operator|=
name|pNewNode
argument_list|(
name|AddTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|AddNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_SUB
case|:
name|BinOp
operator|=
name|pNewNode
argument_list|(
name|SubTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|SubNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_MULT
case|:
name|BinOp
operator|=
name|pNewNode
argument_list|(
name|MultTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|MultNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_DIV
case|:
name|BinOp
operator|=
name|pNewNode
argument_list|(
name|DivTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|DivNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_DIVD
case|:
name|BinOp
operator|=
name|pNewNode
argument_list|(
name|DivdTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|DivdNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_MOD
case|:
name|BinOp
operator|=
name|pNewNode
argument_list|(
name|ModTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|ModNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_IN
case|:
name|BinOp
operator|=
name|pNewNode
argument_list|(
name|InTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|InNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_OR
case|:
name|BinOp
operator|=
name|pNewNode
argument_list|(
name|OrTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|OrNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|T_AND
case|:
name|BinOp
operator|=
name|pNewNode
argument_list|(
name|AndTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|AndNode
argument_list|)
argument_list|)
expr_stmt|;
break|break;
default|default:
name|panic
argument_list|(
literal|"BinOpCopy"
argument_list|)
expr_stmt|;
block|}
name|Left
operator|=
name|tCopy
argument_list|(
name|binop
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|Right
operator|=
name|tCopy
argument_list|(
name|binop
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|pDEF
argument_list|(
name|BinOp
argument_list|)
operator|.
name|BinOpLeft
operator|=
name|Left
expr_stmt|;
name|pDEF
argument_list|(
name|BinOp
argument_list|)
operator|.
name|BinOpRight
operator|=
name|Right
expr_stmt|;
return|return
name|BinOp
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_NIL node to a NilNode      *	tnil	[0]	T_NIL      *		[1]	NOCON      */
end_comment

begin_function
name|pPointer
name|NilCopy
parameter_list|(
name|tnil
parameter_list|)
name|int
modifier|*
name|tnil
decl_stmt|;
block|{
name|pPointer
name|Nil
init|=
name|pNewNode
argument_list|(
name|NilTAG
argument_list|,
literal|0
argument_list|)
decl_stmt|;
return|return
name|Nil
return|;
block|}
end_function

begin_comment
comment|/*      *	copy an T_FCALL node to an FCallNode      *	fcall	[0]	T_FCALL      *		[1]	NOCON      *		[2]	func_id      *		[3]	actual expression list      */
end_comment

begin_function
name|pPointer
name|FCallCopy
parameter_list|(
name|fcall
parameter_list|)
name|int
modifier|*
name|fcall
decl_stmt|;
block|{
name|pPointer
name|FCall
init|=
name|pNewNode
argument_list|(
name|FCallTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|FCallNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Id
init|=
name|ThreadSymbol
argument_list|(
name|fcall
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|Actuals
init|=
name|tCopy
argument_list|(
name|fcall
index|[
literal|3
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|FCall
argument_list|)
operator|.
name|FCallId
operator|=
name|Id
expr_stmt|;
name|pDEF
argument_list|(
name|FCall
argument_list|)
operator|.
name|FCallActuals
operator|=
name|Actuals
expr_stmt|;
return|return
name|FCall
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_CSET node to a SetNode      *	cset	[0]	T_CSET      *		[1]	SAWCON      *		[2]	element list      */
end_comment

begin_function
name|pPointer
name|SetCopy
parameter_list|(
name|cset
parameter_list|)
name|int
modifier|*
name|cset
decl_stmt|;
block|{
name|pPointer
name|Set
init|=
name|pNewNode
argument_list|(
name|SetTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|SetNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Elements
init|=
name|tCopy
argument_list|(
name|cset
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|Set
argument_list|)
operator|.
name|SetElements
operator|=
name|Elements
expr_stmt|;
return|return
name|Set
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_RANG node to a RangeNode      *	rang	[0]	T_RANG      *		[1]	lower limit      *		[2]	upper limit      */
end_comment

begin_function
name|pPointer
name|RangeCopy
parameter_list|(
name|rang
parameter_list|)
name|int
modifier|*
name|rang
decl_stmt|;
block|{
name|pPointer
name|Range
init|=
name|pNewNode
argument_list|(
name|RangeTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|RangeNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Lower
init|=
name|tCopy
argument_list|(
name|rang
index|[
literal|1
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|Upper
init|=
name|tCopy
argument_list|(
name|rang
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|Range
argument_list|)
operator|.
name|RangeLower
operator|=
name|Lower
expr_stmt|;
name|pDEF
argument_list|(
name|Range
argument_list|)
operator|.
name|RangeUpper
operator|=
name|Upper
expr_stmt|;
return|return
name|Range
return|;
block|}
end_function

begin_comment
comment|/*      *	copies an extended T_VAR node to a VarNode      *	var	[0]	T_VAR      *		[1]	NOCON      *		[2]	variable id (may be variable or field name in WITH)      *		[3]	qualifications list      *		[4]>>pTree extension<< struct nl * or NIL.      *			NIL if this is a real variable,      *			struct nl * to field,      *			otherwise we'd never find it in the right record.      *			see setupvar      */
end_comment

begin_function
name|pPointer
name|VarCopy
parameter_list|(
name|var
parameter_list|)
name|int
modifier|*
name|var
decl_stmt|;
block|{
name|pPointer
name|Var
init|=
name|pNewNode
argument_list|(
name|VarTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|VarNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Id
decl_stmt|;
name|pPointer
name|Quals
init|=
name|tCopy
argument_list|(
name|var
index|[
literal|3
index|]
argument_list|)
decl_stmt|;
if|if
condition|(
name|var
index|[
literal|4
index|]
operator|==
name|NIL
condition|)
name|Id
operator|=
name|ThreadSymbol
argument_list|(
name|var
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
else|else
name|Id
operator|=
name|ThreadName
argument_list|(
name|var
index|[
literal|4
index|]
argument_list|)
expr_stmt|;
name|pDEF
argument_list|(
name|Var
argument_list|)
operator|.
name|VarId
operator|=
name|Id
expr_stmt|;
name|pDEF
argument_list|(
name|Var
argument_list|)
operator|.
name|VarQuals
operator|=
name|Quals
expr_stmt|;
return|return
name|Var
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_ARY qualification to a SubscNode      *	ary	[0]	T_ARY      *		[1]	subscript expression list      */
end_comment

begin_function
name|pPointer
name|SubscCopy
parameter_list|(
name|ary
parameter_list|)
name|int
modifier|*
name|ary
decl_stmt|;
block|{
name|pPointer
name|Subsc
init|=
name|pNewNode
argument_list|(
name|SubscTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|SubscNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Exprs
init|=
name|tCopy
argument_list|(
name|ary
index|[
literal|1
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|Subsc
argument_list|)
operator|.
name|SubscSubsc
operator|=
name|Exprs
expr_stmt|;
return|return
name|Subsc
return|;
block|}
end_function

begin_comment
comment|/*      *	copy an extended T_FIELD qualification to a SelNode      *	field	[0]	T_FIELD      *		[1]	field_id      *		[2]	NIL      *		[3]>>pTree extension<< struct nl * to field      *			otherwise we'd never know where it is      *			put in by lvalue      */
end_comment

begin_function
name|pPointer
name|SelCopy
parameter_list|(
name|field
parameter_list|)
name|int
modifier|*
name|field
decl_stmt|;
block|{
name|pPointer
name|Sel
init|=
name|pNewNode
argument_list|(
name|SelTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|SelNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|Field
init|=
name|ThreadName
argument_list|(
name|field
index|[
literal|3
index|]
argument_list|)
decl_stmt|;
name|pDEF
argument_list|(
name|Sel
argument_list|)
operator|.
name|SelField
operator|=
name|Field
expr_stmt|;
return|return
name|Sel
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_PTR qualification to a PtrNode      *	ptr	[0]	T_PTR      */
end_comment

begin_function
name|pPointer
name|PtrCopy
parameter_list|(
name|ptr
parameter_list|)
name|int
modifier|*
name|ptr
decl_stmt|;
block|{
name|pPointer
name|Ptr
init|=
name|pNewNode
argument_list|(
name|PtrTAG
argument_list|,
literal|0
argument_list|)
decl_stmt|;
return|return
name|Ptr
return|;
block|}
end_function

begin_comment
comment|/*      *	copy a T_WEXP node to a WidthNode and maybe an OctNode or a HexNode      *	for expr : width      *	 or expr : width : places      *	 or expr radix      *	 or expr : width radix      *	wexp	[0]	T_WEXP      *		[1]	expr      *		[2]	width or NIL      *		[3]	places or OCT or HEX      */
end_comment

begin_function
name|pPointer
name|WidthCopy
parameter_list|(
name|wexp
parameter_list|)
name|int
modifier|*
name|wexp
decl_stmt|;
block|{
name|pPointer
name|Width
init|=
name|pNewNode
argument_list|(
name|WidthTAG
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|WidthNode
argument_list|)
argument_list|)
decl_stmt|;
name|pPointer
name|expr
init|=
name|tCopy
argument_list|(
name|wexp
index|[
literal|1
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|width
init|=
name|tCopy
argument_list|(
name|wexp
index|[
literal|2
index|]
argument_list|)
decl_stmt|;
name|pPointer
name|places
decl_stmt|;
name|pPointer
name|radix
decl_stmt|;
name|pDEF
argument_list|(
name|Width
argument_list|)
operator|.
name|WidthExpr
operator|=
name|expr
expr_stmt|;
name|pDEF
argument_list|(
name|Width
argument_list|)
operator|.
name|WidthWidth
operator|=
name|width
expr_stmt|;
switch|switch
condition|(
name|wexp
index|[
literal|3
index|]
condition|)
block|{
default|default:
name|places
operator|=
name|tCopy
argument_list|(
name|wexp
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|radix
operator|=
name|pNIL
expr_stmt|;
break|break;
case|case
name|OCT
case|:
name|places
operator|=
name|pNIL
expr_stmt|;
name|radix
operator|=
name|pNewNode
argument_list|(
name|OctTAG
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
name|HEX
case|:
name|places
operator|=
name|pNIL
expr_stmt|;
name|radix
operator|=
name|pNewNode
argument_list|(
name|HexTAG
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
block|}
name|pDEF
argument_list|(
name|Width
argument_list|)
operator|.
name|WidthPlaces
operator|=
name|places
expr_stmt|;
name|pDEF
argument_list|(
name|Width
argument_list|)
operator|.
name|WidthRadix
operator|=
name|radix
expr_stmt|;
return|return
name|Width
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
endif|PTREE
end_endif

end_unit

