begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*	@(#)atan.c	4.1/4.2		10/31/84  CCI-CPG	*/
end_comment

begin_comment
comment|/*  * Double-precision arctangent function recoded with  * new algorithm polynomial at CCI-CPG.  *   * atan returns the value of the arctangent of its  * argument in the range [-pi/2,pi/2].  *   * atan2 returns the arctangent of arg1/arg2  * in the range [-pi,pi].  *   * There are no error returns.  *   * New version by Les Powers (3/31/85)  */
end_comment

begin_include
include|#
directive|include
file|"atand.h"
end_include

begin_decl_stmt
specifier|static
name|double
name|pio2
init|=
literal|1.570796326794896619231e0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|pio4
init|=
literal|0.785398163397448309615e0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|ap0
init|=
literal|1.0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|ap1
init|=
operator|-
literal|1.0
operator|/
literal|3.0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|ap2
init|=
literal|1.0
operator|/
literal|5.0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|ap3
init|=
operator|-
literal|1.0
operator|/
literal|7.0
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * atan reduces its argument  * and returns the arctan.  */
end_comment

begin_function
name|double
name|atan
parameter_list|(
name|x
parameter_list|)
name|double
name|x
decl_stmt|;
block|{
name|double
name|t
decl_stmt|,
name|s
decl_stmt|;
name|unsigned
name|ta
decl_stmt|;
union|union
block|{
name|double
name|d
decl_stmt|;
struct|struct
block|{
name|unsigned
name|i0
decl_stmt|,
name|i1
decl_stmt|;
block|}
name|i
struct|;
struct|struct
block|{
name|unsigned
name|char
name|b0
decl_stmt|,
name|b1
decl_stmt|,
name|b2
decl_stmt|,
name|b3
decl_stmt|;
block|}
name|b
struct|;
block|}
name|u
union|;
if|if
condition|(
name|x
operator|<
literal|0
condition|)
return|return
operator|(
operator|-
name|atan
argument_list|(
operator|-
name|x
argument_list|)
operator|)
return|;
name|u
operator|.
name|d
operator|=
name|x
expr_stmt|;
if|if
condition|(
name|u
operator|.
name|i
operator|.
name|i0
operator|>=
literal|0x41000000
condition|)
block|{
comment|/* if (x>= 2.0) */
return|return
operator|(
name|pio2
operator|-
name|atan
argument_list|(
literal|1.0
operator|/
name|x
argument_list|)
operator|)
return|;
block|}
if|if
condition|(
name|u
operator|.
name|i
operator|.
name|i0
operator|>=
literal|0x40000000
condition|)
block|{
comment|/* if (x>= 0.5) */
name|u
operator|.
name|i
operator|.
name|i0
operator|=
operator|(
name|u
operator|.
name|i
operator|.
name|i0
operator|&
literal|0x40ff8000
operator|)
operator||
literal|0x00008000
expr_stmt|;
name|u
operator|.
name|i
operator|.
name|i1
operator|=
literal|0
expr_stmt|;
name|t
operator|=
operator|(
name|x
operator|-
name|u
operator|.
name|d
operator|)
operator|/
operator|(
name|x
operator|*
name|u
operator|.
name|d
operator|+
literal|1.0
operator|)
expr_stmt|;
name|s
operator|=
name|t
operator|*
name|t
expr_stmt|;
return|return
operator|(
name|t
operator|*
operator|(
name|ap0
operator|+
name|s
operator|*
operator|(
name|ap1
operator|+
name|s
operator|*
name|ap2
operator|)
operator|)
operator|+
name|at1
index|[
name|u
operator|.
name|b
operator|.
name|b1
index|]
operator|)
return|;
block|}
if|if
condition|(
name|u
operator|.
name|i
operator|.
name|i0
operator|>=
literal|0x3d000000
condition|)
block|{
comment|/* if (x>= 1/128) */
name|u
operator|.
name|i
operator|.
name|i0
operator|+=
literal|0x03800000
expr_stmt|;
name|ta
operator|=
name|u
operator|.
name|d
expr_stmt|;
name|u
operator|.
name|d
operator|=
name|ta
expr_stmt|;
name|u
operator|.
name|i
operator|.
name|i0
operator|-=
literal|0x03800000
expr_stmt|;
name|t
operator|=
operator|(
name|x
operator|-
name|u
operator|.
name|d
operator|)
operator|/
operator|(
name|x
operator|*
name|u
operator|.
name|d
operator|+
literal|1.0
operator|)
expr_stmt|;
block|}
else|else
block|{
name|ta
operator|=
literal|0
expr_stmt|;
name|t
operator|=
name|x
expr_stmt|;
block|}
name|s
operator|=
name|t
operator|*
name|t
expr_stmt|;
return|return
operator|(
name|t
operator|*
operator|(
name|ap0
operator|+
name|s
operator|*
operator|(
name|ap1
operator|+
name|s
operator|*
operator|(
name|ap2
operator|+
name|s
operator|*
name|ap3
operator|)
operator|)
operator|)
operator|+
name|at0
index|[
name|ta
index|]
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * atan2 discovers what quadrant the angle  * is in and calls atan.  */
end_comment

begin_function
name|double
name|atan2
parameter_list|(
name|y
parameter_list|,
name|x
parameter_list|)
name|double
name|y
decl_stmt|,
name|x
decl_stmt|;
block|{
name|double
name|atan
parameter_list|()
function_decl|;
if|if
condition|(
name|y
operator|>
literal|0
condition|)
if|if
condition|(
name|x
operator|>=
name|y
condition|)
return|return
operator|(
name|atan
argument_list|(
name|y
operator|/
name|x
argument_list|)
operator|)
return|;
elseif|else
if|if
condition|(
name|x
operator|>=
literal|0
condition|)
return|return
operator|(
name|pio2
operator|-
name|atan
argument_list|(
name|x
operator|/
name|y
argument_list|)
operator|)
return|;
elseif|else
if|if
condition|(
operator|-
name|x
operator|<=
name|y
condition|)
return|return
operator|(
name|pio2
operator|+
name|atan
argument_list|(
operator|-
name|x
operator|/
name|y
argument_list|)
operator|)
return|;
else|else
return|return
operator|(
name|pio2
operator|+
name|pio2
operator|-
name|atan
argument_list|(
operator|-
name|y
operator|/
name|x
argument_list|)
operator|)
return|;
elseif|else
if|if
condition|(
name|y
operator|<
literal|0
condition|)
if|if
condition|(
name|x
operator|>=
operator|-
name|y
condition|)
return|return
operator|(
operator|-
name|atan
argument_list|(
operator|-
name|y
operator|/
name|x
argument_list|)
operator|)
return|;
elseif|else
if|if
condition|(
name|x
operator|>=
literal|0
condition|)
return|return
operator|(
operator|-
name|pio2
operator|+
name|atan
argument_list|(
name|x
operator|/
operator|(
operator|-
name|y
operator|)
argument_list|)
operator|)
return|;
elseif|else
if|if
condition|(
operator|-
name|x
operator|<=
operator|-
name|y
condition|)
return|return
operator|(
operator|-
name|pio2
operator|-
name|atan
argument_list|(
name|x
operator|/
name|y
argument_list|)
operator|)
return|;
else|else
return|return
operator|(
operator|-
name|pio2
operator|-
name|pio2
operator|+
name|atan
argument_list|(
name|y
operator|/
name|x
argument_list|)
operator|)
return|;
elseif|else
if|if
condition|(
name|x
operator|>
literal|0
condition|)
return|return
operator|(
literal|0
operator|)
return|;
elseif|else
if|if
condition|(
name|x
operator|<
literal|0
condition|)
return|return
operator|(
name|pio2
operator|+
name|pio2
operator|)
return|;
else|else
return|return
operator|(
name|pio2
operator|)
return|;
block|}
end_function

end_unit

