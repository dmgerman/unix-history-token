begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*	@(#)sin.c	4.1/4.2 	10/31/84 CCI-CPG  */
end_comment

begin_comment
comment|/*  * Double-precision floating point sin/cos function.  * Calls modf.  * Pn coefficients are #3345 from Hart& etc.(18.79D).  *  * New version by Les Powers (3/26/85).  */
end_comment

begin_decl_stmt
specifier|static
name|double
name|twoopi
init|=
literal|0.63661977236758134308
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|piotwo
init|=
literal|3.14159265358979323846264338327950288419716939937511
operator|/
literal|2.
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|piotwols
init|=
literal|.572118872610983179676266255859012e-17
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|piofour
init|=
literal|3.14159265358979323846264338327950288419716939937511
operator|/
literal|4.
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|threepio4
init|=
literal|3.14159265358979323846264338327950288419716939937511
operator|*
literal|.75
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p0
init|=
literal|.15707963267948966188272e1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p1
init|=
operator|-
literal|.64596409750624619108547e0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p2
init|=
literal|.7969262624616543562977e-1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p3
init|=
operator|-
literal|.468175413530264260121e-2
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p4
init|=
literal|.1604411847068220716e-3
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p5
init|=
operator|-
literal|.359884300720869272e-5
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p6
init|=
literal|.5692134872719023e-7
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p7
init|=
operator|-
literal|.66843217206396e-9
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|p8
init|=
literal|.587061098171e-11
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Sn coefficients are #3043 from Hart& etc.(17.48D).  * Cn coefficients are #3824 from Hart& etc.(19.45D).  * The coefficients are multiplied by the appropriate power  * of 4/pi using binary calculator with 40 digit arithmetic.  * The following statements in comments indicate the  * operations originally used to generate the coefficients.  *  * #define FP (4/3.14159265358979323846264338327950288419716939937511)  * #define FS FP*FP  *  * static double s0	=  .785398163397448307014e0*FP;  * static double s1	= -.80745512188280530192e-1*FP*FS;  * static double s2	=  .2490394570188736117e-2*FP*FS*FS;  * static double s3	= -.36576204158455695e-4*FP*FS*FS*FS;  * static double s4	=  .313361621661904e-6*FP*FS*FS*FS*FS;  * static double s5	= -.1757149292755e-8*FP*FS*FS*FS*FS*FS;  * static double s6	=  .6877100349e-11*FP*FS*FS*FS*FS*FS*FS;  *  * static double c0	=  .99999999999999999996415e0;  * static double c1	= -.30842513753404245242414e0*FS;  * static double c2	=  .1585434424381541089754e-1*FS*FS;  * static double c3	= -.32599188692668755044e-3*FS*FS*FS;  * static double c4	=  .359086044588581953e-5*FS*FS*FS*FS;  * static double c5	= -.2461136382637005e-7*FS*FS*FS*FS*FS;  * static double c6	=  .11500497024263e-9*FS*FS*FS*FS*FS*FS;  * static double c7	= -.38577620372e-12*FS*FS*FS*FS*FS*FS*FS;  */
end_comment

begin_decl_stmt
specifier|static
name|double
name|s0
init|=
literal|.9999999999999999966874625291130031549274
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|s1
init|=
operator|-
literal|.1666666666666661475150697663344387409506
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|s2
init|=
literal|.0083333333333200019685518812023464185712
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|s3
init|=
operator|-
literal|.0001984126982840175394529286095367983768
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|s4
init|=
literal|.0000027557313298885682473645051747116530
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|s5
init|=
operator|-
literal|.0000000250507058263681718011320436448899
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|s6
init|=
literal|.0000000001589413523004632819499530093565
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|c0
init|=
literal|0.99999999999999999996415
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|c1
init|=
operator|-
literal|.4999999999999999928435829208978050890709
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|c2
init|=
literal|.0416666666666664302573692446884954307432
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|c3
init|=
operator|-
literal|.0013888888888858960434395194724966502603
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|c4
init|=
literal|.0000248015872828994630247806807330993132
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|c5
init|=
operator|-
literal|.0000002755731286569608222434728722627332
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|c6
init|=
literal|.0000000020875555145677882874779379760684
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|double
name|c7
init|=
operator|-
literal|.0000000000113521232057839395845871741059
decl_stmt|;
end_decl_stmt

begin_function
name|double
name|cos
parameter_list|(
name|arg
parameter_list|)
name|double
name|arg
decl_stmt|;
block|{
name|double
name|sinus
parameter_list|()
function_decl|;
name|double
name|s
decl_stmt|;
union|union
block|{
name|double
name|d
decl_stmt|;
name|unsigned
name|i
decl_stmt|;
block|}
name|u
union|;
if|if
condition|(
name|arg
operator|<
literal|0
condition|)
name|arg
operator|=
operator|-
name|arg
expr_stmt|;
name|u
operator|.
name|d
operator|=
name|arg
expr_stmt|;
if|if
condition|(
name|u
operator|.
name|i
operator|<
literal|0x40490fdb
condition|)
block|{
comment|/* arg< pi * 1/4 */
name|s
operator|=
name|arg
operator|*
name|arg
expr_stmt|;
return|return
operator|(
name|c0
operator|+
name|s
operator|*
operator|(
name|c1
operator|+
name|s
operator|*
operator|(
name|c2
operator|+
name|s
operator|*
operator|(
name|c3
operator|+
name|s
operator|*
operator|(
name|c4
operator|+
name|s
operator|*
operator|(
name|c5
operator|+
name|s
operator|*
operator|(
name|c6
operator|+
name|s
operator|*
name|c7
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
return|;
block|}
if|if
condition|(
name|u
operator|.
name|i
operator|<
literal|0x4116cbe3
condition|)
block|{
comment|/* arg< pi * 3/4 */
name|arg
operator|=
operator|(
name|piotwo
operator|-
name|arg
operator|)
operator|+
name|piotwols
expr_stmt|;
name|s
operator|=
name|arg
operator|*
name|arg
expr_stmt|;
return|return
operator|(
name|arg
operator|*
operator|(
name|s0
operator|+
name|s
operator|*
operator|(
name|s1
operator|+
name|s
operator|*
operator|(
name|s2
operator|+
name|s
operator|*
operator|(
name|s3
operator|+
name|s
operator|*
operator|(
name|s4
operator|+
name|s
operator|*
operator|(
name|s5
operator|+
name|s
operator|*
name|s6
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
return|;
block|}
return|return
operator|(
name|sinus
argument_list|(
name|arg
argument_list|,
literal|1
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
name|double
name|sin
parameter_list|(
name|arg
parameter_list|)
name|double
name|arg
decl_stmt|;
block|{
name|double
name|sinus
parameter_list|()
function_decl|;
name|double
name|s
decl_stmt|;
union|union
block|{
name|double
name|d
decl_stmt|;
name|unsigned
name|i
decl_stmt|;
block|}
name|u
union|;
if|if
condition|(
name|arg
operator|<
literal|0
condition|)
return|return
operator|(
operator|-
name|sin
argument_list|(
operator|-
name|arg
argument_list|)
operator|)
return|;
name|u
operator|.
name|d
operator|=
name|arg
expr_stmt|;
if|if
condition|(
name|u
operator|.
name|i
operator|<
literal|0x40490fdb
condition|)
block|{
comment|/* arg< pi * 1/4 */
name|s
operator|=
name|arg
operator|*
name|arg
expr_stmt|;
return|return
operator|(
name|arg
operator|*
operator|(
name|s0
operator|+
name|s
operator|*
operator|(
name|s1
operator|+
name|s
operator|*
operator|(
name|s2
operator|+
name|s
operator|*
operator|(
name|s3
operator|+
name|s
operator|*
operator|(
name|s4
operator|+
name|s
operator|*
operator|(
name|s5
operator|+
name|s
operator|*
name|s6
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
return|;
block|}
if|if
condition|(
name|u
operator|.
name|i
operator|<
literal|0x4116cbe3
condition|)
block|{
comment|/* arg< pi * 3/4 */
name|arg
operator|=
operator|(
name|piotwo
operator|-
name|arg
operator|)
operator|+
name|piotwols
expr_stmt|;
name|s
operator|=
name|arg
operator|*
name|arg
expr_stmt|;
return|return
operator|(
name|c0
operator|+
name|s
operator|*
operator|(
name|c1
operator|+
name|s
operator|*
operator|(
name|c2
operator|+
name|s
operator|*
operator|(
name|c3
operator|+
name|s
operator|*
operator|(
name|c4
operator|+
name|s
operator|*
operator|(
name|c5
operator|+
name|s
operator|*
operator|(
name|c6
operator|+
name|s
operator|*
name|c7
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
return|;
block|}
return|return
operator|(
name|sinus
argument_list|(
name|arg
argument_list|,
literal|0
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|double
name|sinus
parameter_list|(
name|arg
parameter_list|,
name|quad
parameter_list|)
name|double
name|arg
decl_stmt|;
name|int
name|quad
decl_stmt|;
block|{
name|double
name|modf
parameter_list|()
function_decl|;
name|double
name|e
decl_stmt|,
name|f
decl_stmt|;
name|double
name|ysq
decl_stmt|;
name|double
name|x
decl_stmt|,
name|y
decl_stmt|;
name|int
name|k
decl_stmt|;
name|double
name|temp1
decl_stmt|,
name|temp2
decl_stmt|;
name|x
operator|=
name|arg
expr_stmt|;
if|if
condition|(
name|x
operator|<
literal|0
condition|)
block|{
name|x
operator|=
operator|-
name|x
expr_stmt|;
name|quad
operator|=
name|quad
operator|+
literal|2
expr_stmt|;
block|}
name|x
operator|=
name|x
operator|*
name|twoopi
expr_stmt|;
comment|/*underflow?*/
if|if
condition|(
name|x
operator|>
literal|32764
condition|)
block|{
name|y
operator|=
name|modf
argument_list|(
name|x
argument_list|,
operator|&
name|e
argument_list|)
expr_stmt|;
name|e
operator|=
name|e
operator|+
name|quad
expr_stmt|;
name|modf
argument_list|(
literal|0.25
operator|*
name|e
argument_list|,
operator|&
name|f
argument_list|)
expr_stmt|;
name|quad
operator|=
name|e
operator|-
literal|4
operator|*
name|f
expr_stmt|;
block|}
else|else
block|{
name|k
operator|=
name|x
expr_stmt|;
name|y
operator|=
name|x
operator|-
name|k
expr_stmt|;
name|quad
operator|=
operator|(
name|quad
operator|+
name|k
operator|)
operator|&
literal|03
expr_stmt|;
block|}
if|if
condition|(
name|quad
operator|&
literal|01
condition|)
name|y
operator|=
literal|1
operator|-
name|y
expr_stmt|;
if|if
condition|(
name|quad
operator|>
literal|1
condition|)
name|y
operator|=
operator|-
name|y
expr_stmt|;
name|ysq
operator|=
name|y
operator|*
name|y
expr_stmt|;
name|temp1
operator|=
operator|(
operator|(
operator|(
operator|(
operator|(
operator|(
operator|(
operator|(
name|p8
operator|*
name|ysq
operator|+
name|p7
operator|)
operator|*
name|ysq
operator|+
name|p6
operator|)
operator|*
name|ysq
operator|+
name|p5
operator|)
operator|*
name|ysq
operator|+
name|p4
operator|)
operator|*
name|ysq
operator|+
name|p3
operator|)
operator|*
name|ysq
operator|+
name|p2
operator|)
operator|*
name|ysq
operator|+
name|p1
operator|)
operator|*
name|ysq
operator|+
name|p0
operator|)
expr_stmt|;
return|return
operator|(
name|temp1
operator|*
name|y
operator|)
return|;
block|}
end_function

end_unit

