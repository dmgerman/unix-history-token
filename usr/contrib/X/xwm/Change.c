begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_include
include|#
directive|include
file|<X/mit-copyright.h>
end_include

begin_comment
comment|/* Copyright    Massachusetts Institute of Technology    1985	*/
end_comment

begin_comment
comment|/*  *	Change - This subroutine implements window size manipulation  *	for the X Window System window manager (xwm).  *  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
modifier|*
name|rcsid_Change_c
init|=
literal|"$Header: Change.c,v 10.3 86/02/01 16:09:10 tony Rel $"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|"xwm.h"
end_include

begin_function
name|Bool
name|Change
parameter_list|(
name|window
parameter_list|,
name|x0
parameter_list|,
name|y0
parameter_list|)
name|Window
name|window
decl_stmt|;
comment|/* Event window. */
name|int
name|x0
decl_stmt|,
name|y0
decl_stmt|;
comment|/* Event mouse coordinates. */
block|{
specifier|register
name|WindowInfo
name|window_info
decl_stmt|;
comment|/* Event window info. */
specifier|register
name|WindowInfo
name|assoc_info
decl_stmt|;
comment|/* Icon's associated window info. */
name|int
name|d
decl_stmt|;
comment|/* ??? */
name|int
name|t
decl_stmt|;
comment|/* ??? */
name|int
name|x
decl_stmt|,
name|y
decl_stmt|;
comment|/* ??? */
name|int
name|h0
decl_stmt|,
name|hinc
decl_stmt|,
name|w0
decl_stmt|,
name|winc
decl_stmt|,
name|wadd
decl_stmt|,
name|hadd
decl_stmt|;
comment|/* ??? */
name|int
name|x1
decl_stmt|,
name|y1
decl_stmt|,
name|x2
decl_stmt|,
name|y2
decl_stmt|;
comment|/* ??? */
name|int
name|mx
decl_stmt|,
name|my
decl_stmt|;
comment|/* ??? */
name|int
name|ox
decl_stmt|,
name|oy
decl_stmt|;
comment|/* ??? */
name|int
name|lx
decl_stmt|,
name|ly
decl_stmt|;
comment|/* ??? */
name|int
name|pop_x
decl_stmt|,
name|pop_y
decl_stmt|;
comment|/* ??? */
name|int
name|hsize
decl_stmt|,
name|vsize
decl_stmt|;
comment|/* ??? */
name|int
name|dx
decl_stmt|,
name|dy
decl_stmt|;
comment|/* ??? */
name|int
name|status
decl_stmt|;
comment|/* Routine call return status. */
name|int
name|num_vectors
decl_stmt|;
comment|/* Number of vectors to XDraw. */
name|Window
name|assoc
decl_stmt|;
comment|/* Window represented by the icon. */
name|Window
name|sub_win
decl_stmt|;
comment|/* Mouse query sub window. */
name|XButtonEvent
name|button_event
decl_stmt|;
comment|/* Button event packet. */
name|Vertex
name|box
index|[
name|MAX_BOX_VECTORS
index|]
decl_stmt|;
comment|/* Box drawing vertex buffer. */
name|Vertex
name|zap
index|[
name|MAX_ZAP_VECTORS
index|]
decl_stmt|;
comment|/* Zap drawing vertex buffer. */
name|Bool
name|domult
decl_stmt|;
comment|/* ??? */
name|Bool
name|stop
decl_stmt|;
comment|/* Should the window stop changing? */
name|Bool
name|changing
decl_stmt|;
comment|/* Is the window changing? */
comment|/*      * Clear the vector buffers.      */
name|bzero
argument_list|(
name|box
argument_list|,
sizeof|sizeof
argument_list|(
name|box
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|Zap
condition|)
name|bzero
argument_list|(
name|zap
argument_list|,
sizeof|sizeof
argument_list|(
name|zap
argument_list|)
argument_list|)
expr_stmt|;
comment|/*      * Gather info about the event window.      */
name|status
operator|=
name|XQueryWindow
argument_list|(
name|window
argument_list|,
operator|&
name|window_info
argument_list|)
expr_stmt|;
if|if
condition|(
name|status
operator|==
name|FAILURE
condition|)
block|{
comment|/* 	 * If there is a query error, abort the operation. 	 */
return|return
operator|(
name|FALSE
operator|)
return|;
block|}
comment|/*      * Check to see if we have an icon window.      */
if|if
condition|(
name|window_info
operator|.
name|type
operator|==
name|IsIcon
condition|)
block|{
comment|/* 	 * We have an uniconify event, wait for a change in button state. 	 */
name|assoc
operator|=
name|window_info
operator|.
name|assoc_wind
expr_stmt|;
comment|/* 	 * Gather info about the assoc window. 	 */
name|status
operator|=
name|XQueryWindow
argument_list|(
name|assoc
argument_list|,
operator|&
name|assoc_info
argument_list|)
expr_stmt|;
if|if
condition|(
name|status
operator|==
name|FAILURE
condition|)
block|{
comment|/* 	     * If there is a query error, abort the operation. 	     */
return|return
operator|(
name|FALSE
operator|)
return|;
block|}
comment|/* 	 * Spin our wheels untill there is a button event. 	 */
while|while
condition|(
operator|!
name|GetButton
argument_list|(
operator|&
name|button_event
argument_list|)
condition|)
empty_stmt|;
comment|/* 	 * Ok, we have a button event, process it. 	 */
if|if
condition|(
operator|(
name|button_event
operator|.
name|type
operator|==
name|ButtonReleased
operator|)
operator|&&
operator|(
operator|(
name|button_event
operator|.
name|detail
operator|&
name|ValueMask
operator|)
operator|==
name|MiddleButton
operator|)
condition|)
block|{
comment|/* 	     * Middle button came up, this means we have to uniconify the 	     * window. 	     */
if|if
condition|(
name|Zap
condition|)
block|{
comment|/* 		 * Store the zap vector buffer. 		 */
name|num_vectors
operator|=
name|StoreZap
argument_list|(
name|zap
argument_list|,
name|assoc_info
operator|.
name|x
operator|-
literal|1
argument_list|,
name|assoc_info
operator|.
name|y
operator|-
literal|1
argument_list|,
name|assoc_info
operator|.
name|x
operator|+
name|assoc_info
operator|.
name|width
operator|+
operator|(
name|assoc_info
operator|.
name|bdrwidth
operator|<<
literal|1
operator|)
argument_list|,
name|assoc_info
operator|.
name|y
operator|+
name|assoc_info
operator|.
name|height
operator|+
operator|(
name|assoc_info
operator|.
name|bdrwidth
operator|<<
literal|1
operator|)
argument_list|,
name|window_info
operator|.
name|x
operator|-
literal|1
argument_list|,
name|window_info
operator|.
name|y
operator|-
literal|1
argument_list|,
name|window_info
operator|.
name|x
operator|+
name|window_info
operator|.
name|width
operator|+
operator|(
name|window_info
operator|.
name|bdrwidth
operator|<<
literal|1
operator|)
argument_list|,
name|window_info
operator|.
name|y
operator|+
name|window_info
operator|.
name|height
operator|+
operator|(
name|window_info
operator|.
name|bdrwidth
operator|<<
literal|1
operator|)
argument_list|)
expr_stmt|;
block|}
comment|/* 	     * Map the window and synchronize. 	     */
name|XMapWindow
argument_list|(
name|assoc
argument_list|)
expr_stmt|;
if|if
condition|(
name|Zap
condition|)
block|{
comment|/* 		 * Draw the zap lines. 		 */
name|XDraw
argument_list|(
name|RootWindow
argument_list|,
name|zap
argument_list|,
name|num_vectors
argument_list|,
name|DRAW_HEIGHT
argument_list|,
name|DRAW_WIDTH
argument_list|,
name|DRAW_VALUE
argument_list|,
name|DRAW_FUNC
argument_list|,
name|DRAW_PLANES
argument_list|)
expr_stmt|;
name|XDraw
argument_list|(
name|RootWindow
argument_list|,
name|zap
argument_list|,
name|num_vectors
argument_list|,
name|DRAW_HEIGHT
argument_list|,
name|DRAW_WIDTH
argument_list|,
name|DRAW_VALUE
argument_list|,
name|DRAW_FUNC
argument_list|,
name|DRAW_PLANES
argument_list|)
expr_stmt|;
block|}
comment|/* 	     * Unmap the icon window. 	     */
name|XUnmapWindow
argument_list|(
name|window
argument_list|)
expr_stmt|;
comment|/* 	     * This changed the window, return TRUE. 	     */
return|return
operator|(
name|TRUE
operator|)
return|;
block|}
else|else
block|{
comment|/* 	     * Some other button event occured. 	     * Don't change window, return FALSE. 	     */
return|return
operator|(
name|FALSE
operator|)
return|;
block|}
block|}
comment|/*      * If we are here then we have a resize operation in progress.      */
comment|/*      * Get the event window resize hint.      */
name|XGetResizeHint
argument_list|(
name|window
argument_list|,
operator|&
name|w0
argument_list|,
operator|&
name|h0
argument_list|,
operator|&
name|winc
argument_list|,
operator|&
name|hinc
argument_list|)
expr_stmt|;
comment|/*      * If I ever have the time to REALLY figure the rest of this out I will      * comment it better.      */
name|wadd
operator|=
name|winc
operator|>>
literal|1
expr_stmt|;
name|hadd
operator|=
name|hinc
operator|>>
literal|1
expr_stmt|;
name|x1
operator|=
name|window_info
operator|.
name|x
expr_stmt|;
name|y1
operator|=
name|window_info
operator|.
name|y
expr_stmt|;
name|x2
operator|=
name|x1
operator|+
name|window_info
operator|.
name|width
operator|+
operator|(
name|window_info
operator|.
name|bdrwidth
operator|<<
literal|1
operator|)
operator|-
literal|1
expr_stmt|;
name|y2
operator|=
name|y1
operator|+
name|window_info
operator|.
name|height
operator|+
operator|(
name|window_info
operator|.
name|bdrwidth
operator|<<
literal|1
operator|)
operator|-
literal|1
expr_stmt|;
name|domult
operator|=
operator|(
name|winc
operator|>
literal|3
operator|&&
name|hinc
operator|>
literal|3
operator|&&
operator|(
name|window_info
operator|.
name|width
operator|-
name|w0
operator|)
operator|%
name|winc
operator|==
literal|0
operator|&&
operator|(
name|window_info
operator|.
name|height
operator|-
name|h0
operator|)
operator|%
name|hinc
operator|==
literal|0
operator|)
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|w0
operator|==
literal|0
operator|&&
name|winc
operator|==
literal|1
operator|&&
name|h0
operator|==
literal|0
operator|&&
name|hinc
operator|==
literal|1
condition|)
block|{
name|w0
operator|=
literal|1
expr_stmt|;
name|h0
operator|=
literal|1
expr_stmt|;
block|}
name|mx
operator|=
name|x2
operator|-
name|window_info
operator|.
name|width
operator|+
name|w0
operator|+
name|winc
expr_stmt|;
name|my
operator|=
name|y2
operator|-
name|window_info
operator|.
name|height
operator|+
name|h0
operator|+
name|hinc
expr_stmt|;
name|w0
operator|+=
operator|(
name|window_info
operator|.
name|bdrwidth
operator|<<
literal|1
operator|)
operator|-
literal|1
expr_stmt|;
name|h0
operator|+=
operator|(
name|window_info
operator|.
name|bdrwidth
operator|<<
literal|1
operator|)
operator|-
literal|1
expr_stmt|;
name|x
operator|=
name|x2
expr_stmt|;
name|y
operator|=
name|y2
expr_stmt|;
name|dx
operator|=
literal|1
expr_stmt|;
name|dy
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|x0
operator|-
name|x1
operator|<
name|x2
operator|-
name|x0
condition|)
block|{
name|dx
operator|=
operator|-
literal|1
expr_stmt|;
name|x
operator|=
name|x1
expr_stmt|;
name|mx
operator|=
name|x2
operator|-
operator|(
name|mx
operator|-
name|x1
operator|)
expr_stmt|;
name|t
operator|=
name|x1
expr_stmt|;
name|x1
operator|=
name|x2
expr_stmt|;
name|x2
operator|=
name|t
expr_stmt|;
block|}
if|if
condition|(
name|y0
operator|-
name|y1
operator|<
name|y2
operator|-
name|y0
condition|)
block|{
name|dy
operator|=
operator|-
literal|1
expr_stmt|;
name|y
operator|=
name|y1
expr_stmt|;
name|my
operator|=
name|y2
operator|-
operator|(
name|my
operator|-
name|y1
operator|)
expr_stmt|;
name|t
operator|=
name|y1
expr_stmt|;
name|y1
operator|=
name|y2
expr_stmt|;
name|y2
operator|=
name|t
expr_stmt|;
block|}
name|ox
operator|=
operator|(
operator|(
name|x0
operator|-
name|window_info
operator|.
name|x
operator|-
name|window_info
operator|.
name|bdrwidth
operator|)
operator|*
literal|3
operator|)
operator|/
name|window_info
operator|.
name|width
expr_stmt|;
name|oy
operator|=
operator|(
operator|(
name|y0
operator|-
name|window_info
operator|.
name|y
operator|-
name|window_info
operator|.
name|bdrwidth
operator|)
operator|*
literal|3
operator|)
operator|/
name|window_info
operator|.
name|height
expr_stmt|;
if|if
condition|(
name|window_info
operator|.
name|width
operator|>
literal|2
operator|&&
name|window_info
operator|.
name|height
operator|>
literal|2
operator|&&
operator|(
operator|(
name|ox
operator|+
name|oy
operator|)
operator|&
literal|1
operator|)
condition|)
block|{
if|if
condition|(
name|ox
operator|&
literal|1
condition|)
name|dx
operator|=
literal|0
expr_stmt|;
else|else
name|dy
operator|=
literal|0
expr_stmt|;
block|}
name|stop
operator|=
name|FALSE
expr_stmt|;
name|changing
operator|=
name|FALSE
expr_stmt|;
name|ox
operator|=
operator|-
literal|1
expr_stmt|;
name|oy
operator|=
operator|-
literal|1
expr_stmt|;
name|lx
operator|=
operator|-
literal|1
expr_stmt|;
name|ly
operator|=
operator|-
literal|1
expr_stmt|;
while|while
condition|(
operator|!
name|stop
condition|)
block|{
if|if
condition|(
name|x
operator|!=
name|ox
operator|||
name|y
operator|!=
name|oy
condition|)
block|{
if|if
condition|(
name|Grid
condition|)
block|{
name|num_vectors
operator|=
name|StoreGridBox
argument_list|(
name|box
argument_list|,
name|min
argument_list|(
name|x1
argument_list|,
name|x
argument_list|)
argument_list|,
name|min
argument_list|(
name|y1
argument_list|,
name|y
argument_list|)
argument_list|,
name|max
argument_list|(
name|x1
argument_list|,
name|x
argument_list|)
argument_list|,
name|max
argument_list|(
name|y1
argument_list|,
name|y
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|num_vectors
operator|=
name|StoreBox
argument_list|(
name|box
argument_list|,
name|min
argument_list|(
name|x1
argument_list|,
name|x
argument_list|)
argument_list|,
name|min
argument_list|(
name|y1
argument_list|,
name|y
argument_list|)
argument_list|,
name|max
argument_list|(
name|x1
argument_list|,
name|x
argument_list|)
argument_list|,
name|max
argument_list|(
name|y1
argument_list|,
name|y
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|domult
operator|&&
name|changing
condition|)
block|{
name|hsize
operator|=
operator|(
name|abs
argument_list|(
name|x
operator|-
name|x1
argument_list|)
operator|-
name|w0
operator|)
operator|/
name|winc
expr_stmt|;
name|vsize
operator|=
operator|(
name|abs
argument_list|(
name|y
operator|-
name|y1
argument_list|)
operator|-
name|h0
operator|)
operator|/
name|hinc
expr_stmt|;
name|PText
index|[
literal|0
index|]
operator|=
name|hsize
operator|/
literal|100
operator|+
literal|'0'
expr_stmt|;
name|PText
index|[
literal|1
index|]
operator|=
operator|(
name|hsize
operator|/
literal|10
operator|)
operator|%
literal|10
operator|+
literal|'0'
expr_stmt|;
name|PText
index|[
literal|2
index|]
operator|=
name|hsize
operator|%
literal|10
operator|+
literal|'0'
expr_stmt|;
name|PText
index|[
literal|4
index|]
operator|=
name|vsize
operator|/
literal|100
operator|+
literal|'0'
expr_stmt|;
name|PText
index|[
literal|5
index|]
operator|=
operator|(
name|vsize
operator|/
literal|10
operator|)
operator|%
literal|10
operator|+
literal|'0'
expr_stmt|;
name|PText
index|[
literal|6
index|]
operator|=
name|vsize
operator|%
literal|10
operator|+
literal|'0'
expr_stmt|;
comment|/* 		 * If the font is not fixed width we have to 		 * clear the window to guarantee that the characters 		 * that were there before are erased. 		 */
if|if
condition|(
operator|!
operator|(
name|PFontInfo
operator|.
name|fixedwidth
operator|)
condition|)
name|XClear
argument_list|(
name|Pop
argument_list|)
expr_stmt|;
name|XTextPad
argument_list|(
name|Pop
argument_list|,
name|PPadding
argument_list|,
name|PPadding
argument_list|,
name|PText
argument_list|,
name|PTextSize
argument_list|,
name|PFont
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|PTextForground
argument_list|,
name|PTextBackground
argument_list|,
name|GXcopy
argument_list|,
name|AllPlanes
argument_list|)
expr_stmt|;
block|}
name|ox
operator|=
name|x
expr_stmt|;
name|oy
operator|=
name|y
expr_stmt|;
block|}
if|if
condition|(
name|changing
condition|)
block|{
name|XDraw
argument_list|(
name|RootWindow
argument_list|,
name|box
argument_list|,
name|num_vectors
argument_list|,
name|DRAW_HEIGHT
argument_list|,
name|DRAW_WIDTH
argument_list|,
name|DRAW_VALUE
argument_list|,
name|DRAW_FUNC
argument_list|,
name|DRAW_PLANES
argument_list|)
expr_stmt|;
name|XDraw
argument_list|(
name|RootWindow
argument_list|,
name|box
argument_list|,
name|num_vectors
argument_list|,
name|DRAW_HEIGHT
argument_list|,
name|DRAW_WIDTH
argument_list|,
name|DRAW_VALUE
argument_list|,
name|DRAW_FUNC
argument_list|,
name|DRAW_PLANES
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|XPending
argument_list|()
operator|&&
name|GetButton
argument_list|(
operator|&
name|button_event
argument_list|)
condition|)
block|{
if|if
condition|(
operator|(
name|button_event
operator|.
name|type
operator|==
name|ButtonReleased
operator|)
operator|&&
operator|(
operator|(
name|button_event
operator|.
name|detail
operator|&
name|ValueMask
operator|)
operator|==
name|MiddleButton
operator|)
condition|)
block|{
name|x
operator|=
name|button_event
operator|.
name|x
expr_stmt|;
name|y
operator|=
name|button_event
operator|.
name|y
expr_stmt|;
name|stop
operator|=
name|TRUE
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|domult
operator|&&
name|changing
condition|)
block|{
name|XUnmapWindow
argument_list|(
name|Pop
argument_list|)
expr_stmt|;
block|}
return|return
operator|(
name|FALSE
operator|)
return|;
block|}
block|}
else|else
block|{
name|XQueryMouse
argument_list|(
name|RootWindow
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|sub_win
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|x
operator|==
name|lx
operator|&&
name|y
operator|==
name|ly
condition|)
block|{
name|x
operator|=
name|ox
expr_stmt|;
name|y
operator|=
name|oy
expr_stmt|;
continue|continue;
block|}
name|lx
operator|=
name|x
expr_stmt|;
name|ly
operator|=
name|y
expr_stmt|;
if|if
condition|(
operator|!
name|changing
condition|)
block|{
if|if
condition|(
name|abs
argument_list|(
name|x
operator|-
name|x0
argument_list|)
operator|<
name|Delta
operator|&&
name|abs
argument_list|(
name|y
operator|-
name|y0
argument_list|)
operator|<
name|Delta
condition|)
block|{
name|x
operator|=
name|ox
expr_stmt|;
name|y
operator|=
name|oy
expr_stmt|;
continue|continue;
block|}
if|if
condition|(
name|dx
condition|)
name|ox
operator|=
operator|-
literal|1
expr_stmt|;
else|else
name|oy
operator|=
operator|-
literal|1
expr_stmt|;
name|changing
operator|=
name|TRUE
expr_stmt|;
if|if
condition|(
name|domult
condition|)
block|{
if|if
condition|(
name|dx
operator|>
literal|0
condition|)
name|pop_x
operator|=
name|x1
operator|+
name|window_info
operator|.
name|bdrwidth
expr_stmt|;
elseif|else
if|if
condition|(
name|dx
operator|<
literal|0
condition|)
name|pop_x
operator|=
name|x1
operator|-
name|PWidth
operator|-
name|window_info
operator|.
name|bdrwidth
operator|+
literal|1
expr_stmt|;
else|else
name|pop_x
operator|=
name|window_info
operator|.
name|x
operator|+
name|window_info
operator|.
name|bdrwidth
operator|+
operator|(
name|window_info
operator|.
name|width
operator|-
name|PWidth
operator|)
operator|/
literal|2
expr_stmt|;
if|if
condition|(
name|dy
operator|>
literal|0
condition|)
name|pop_y
operator|=
name|y1
operator|+
name|window_info
operator|.
name|bdrwidth
expr_stmt|;
elseif|else
if|if
condition|(
name|dy
operator|<
literal|0
condition|)
name|pop_y
operator|=
name|y1
operator|-
name|PHeight
operator|-
name|window_info
operator|.
name|bdrwidth
operator|+
literal|1
expr_stmt|;
else|else
name|pop_y
operator|=
name|window_info
operator|.
name|y
operator|+
name|window_info
operator|.
name|bdrwidth
operator|+
operator|(
name|window_info
operator|.
name|height
operator|-
name|PHeight
operator|)
operator|/
literal|2
expr_stmt|;
name|XMoveWindow
argument_list|(
name|Pop
argument_list|,
name|pop_x
argument_list|,
name|pop_y
argument_list|)
expr_stmt|;
name|XMapWindow
argument_list|(
name|Pop
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|dx
condition|)
block|{
if|if
condition|(
operator|(
name|d
operator|=
name|abs
argument_list|(
name|x
operator|-
name|x0
argument_list|)
operator|+
name|wadd
operator|)
operator|<
literal|0
condition|)
name|d
operator|=
literal|0
expr_stmt|;
name|d
operator|=
operator|(
name|d
operator|/
name|winc
operator|)
operator|*
name|winc
expr_stmt|;
if|if
condition|(
name|x
operator|<
name|x0
condition|)
block|{
name|x
operator|=
name|x2
operator|-
name|d
expr_stmt|;
if|if
condition|(
name|dx
operator|>
literal|0
operator|&&
name|x
operator|<
name|mx
condition|)
name|x
operator|=
name|mx
expr_stmt|;
block|}
else|else
block|{
name|x
operator|=
name|x2
operator|+
name|d
expr_stmt|;
if|if
condition|(
name|dx
operator|<
literal|0
operator|&&
name|x
operator|>
name|mx
condition|)
name|x
operator|=
name|mx
expr_stmt|;
block|}
block|}
else|else
name|x
operator|=
name|ox
expr_stmt|;
if|if
condition|(
name|dy
condition|)
block|{
if|if
condition|(
operator|(
name|d
operator|=
name|abs
argument_list|(
name|y
operator|-
name|y0
argument_list|)
operator|+
name|hadd
operator|)
operator|<
literal|0
condition|)
name|d
operator|=
literal|0
expr_stmt|;
name|d
operator|=
operator|(
name|d
operator|/
name|hinc
operator|)
operator|*
name|hinc
expr_stmt|;
if|if
condition|(
name|y
operator|<
name|y0
condition|)
block|{
name|y
operator|=
name|y2
operator|-
name|d
expr_stmt|;
if|if
condition|(
name|dy
operator|>
literal|0
operator|&&
name|y
operator|<
name|my
condition|)
name|y
operator|=
name|my
expr_stmt|;
block|}
else|else
block|{
name|y
operator|=
name|y2
operator|+
name|d
expr_stmt|;
if|if
condition|(
name|dy
operator|<
literal|0
operator|&&
name|y
operator|>
name|my
condition|)
name|y
operator|=
name|my
expr_stmt|;
block|}
block|}
else|else
name|y
operator|=
name|oy
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|changing
condition|)
return|return
operator|(
name|FALSE
operator|)
return|;
if|if
condition|(
name|x
operator|==
name|x2
operator|&&
name|y
operator|==
name|y2
condition|)
block|{
name|XUnmapWindow
argument_list|(
name|Pop
argument_list|)
expr_stmt|;
name|XRaiseWindow
argument_list|(
name|window
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|x
operator|<
name|x1
condition|)
block|{
name|t
operator|=
name|x1
expr_stmt|;
name|x1
operator|=
name|x
expr_stmt|;
name|x
operator|=
name|t
expr_stmt|;
block|}
if|if
condition|(
name|y
operator|<
name|y1
condition|)
block|{
name|t
operator|=
name|y1
expr_stmt|;
name|y1
operator|=
name|y
expr_stmt|;
name|y
operator|=
name|t
expr_stmt|;
block|}
name|dx
operator|=
name|x
operator|-
name|x1
operator|+
literal|1
operator|-
operator|(
name|window_info
operator|.
name|bdrwidth
operator|<<
literal|1
operator|)
expr_stmt|;
name|dy
operator|=
name|y
operator|-
name|y1
operator|+
literal|1
operator|-
operator|(
name|window_info
operator|.
name|bdrwidth
operator|<<
literal|1
operator|)
expr_stmt|;
if|if
condition|(
operator|(
name|PWidth
operator|>
name|window_info
operator|.
name|width
operator|)
operator|||
operator|(
name|PHeight
operator|>
name|window_info
operator|.
name|height
operator|)
operator|||
operator|(
name|PWidth
operator|>
name|dx
operator|)
operator|||
operator|(
name|PHeight
operator|>
name|dy
operator|)
condition|)
block|{
name|XUnmapWindow
argument_list|(
name|Pop
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|XUnmapTransparent
argument_list|(
name|Pop
argument_list|)
expr_stmt|;
block|}
name|XConfigureWindow
argument_list|(
name|window
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|,
name|dx
argument_list|,
name|dy
argument_list|)
expr_stmt|;
block|}
return|return
operator|(
name|TRUE
operator|)
return|;
block|}
end_function

end_unit

