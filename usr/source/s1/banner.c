begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_define
define|#
directive|define
name|nchars
value|64
end_define

begin_comment
comment|/*number of chars in char set*/
end_comment

begin_define
define|#
directive|define
name|nlines
value|6
end_define

begin_comment
comment|/*number of lines in a banner character*/
end_comment

begin_define
define|#
directive|define
name|pposs
value|85
end_define

begin_comment
comment|/*number of print positions on a line (must be multiple of 4)*/
end_comment

begin_comment
comment|/*followed by end of string character*/
end_comment

begin_define
define|#
directive|define
name|pospch
value|8
end_define

begin_comment
comment|/*number of char positions per banner char*/
end_comment

begin_define
define|#
directive|define
name|chpln
value|10
end_define

begin_comment
comment|/*number of banner characters per line*/
end_comment

begin_struct
struct|struct
name|bann
block|{
name|char
name|alpha
index|[
name|nlines
index|]
index|[
name|pposs
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_decl_stmt
name|struct
name|bann
name|buffer
decl_stmt|,
modifier|*
name|bp
name|buffer
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
name|ctbl
index|[
name|nchars
index|]
index|[
name|nlines
index|]
block|{
literal|036
operator|,
literal|041
operator|,
literal|046
operator|,
literal|051
operator|,
literal|046
operator|,
literal|035
operator|,
comment|/*@*/
literal|014
operator|,
literal|022
operator|,
literal|041
operator|,
literal|077
operator|,
literal|041
operator|,
literal|041
operator|,
comment|/*A*/
literal|076
operator|,
literal|041
operator|,
literal|076
operator|,
literal|041
operator|,
literal|041
operator|,
literal|076
operator|,
comment|/*B*/
literal|036
operator|,
literal|041
operator|,
literal|040
operator|,
literal|040
operator|,
literal|041
operator|,
literal|036
operator|,
comment|/*C*/
literal|076
operator|,
literal|041
operator|,
literal|041
operator|,
literal|041
operator|,
literal|041
operator|,
literal|076
operator|,
comment|/*D*/
literal|077
operator|,
literal|040
operator|,
literal|076
operator|,
literal|040
operator|,
literal|040
operator|,
literal|077
operator|,
comment|/*E*/
literal|077
operator|,
literal|040
operator|,
literal|076
operator|,
literal|040
operator|,
literal|040
operator|,
literal|040
operator|,
comment|/*F*/
literal|036
operator|,
literal|041
operator|,
literal|040
operator|,
literal|047
operator|,
literal|041
operator|,
literal|036
operator|,
comment|/*G*/
literal|041
operator|,
literal|041
operator|,
literal|077
operator|,
literal|041
operator|,
literal|041
operator|,
literal|041
operator|,
comment|/*H*/
literal|004
operator|,
literal|004
operator|,
literal|004
operator|,
literal|004
operator|,
literal|004
operator|,
literal|004
operator|,
comment|/*I*/
literal|001
operator|,
literal|001
operator|,
literal|001
operator|,
literal|001
operator|,
literal|041
operator|,
literal|036
operator|,
comment|/*J*/
literal|041
operator|,
literal|042
operator|,
literal|074
operator|,
literal|044
operator|,
literal|042
operator|,
literal|041
operator|,
comment|/*K*/
literal|040
operator|,
literal|040
operator|,
literal|040
operator|,
literal|040
operator|,
literal|040
operator|,
literal|077
operator|,
comment|/*L*/
literal|041
operator|,
literal|063
operator|,
literal|055
operator|,
literal|041
operator|,
literal|041
operator|,
literal|041
operator|,
comment|/*M*/
literal|041
operator|,
literal|061
operator|,
literal|051
operator|,
literal|045
operator|,
literal|043
operator|,
literal|041
operator|,
comment|/*N*/
literal|036
operator|,
literal|041
operator|,
literal|041
operator|,
literal|041
operator|,
literal|041
operator|,
literal|036
operator|,
comment|/*O*/
literal|076
operator|,
literal|041
operator|,
literal|041
operator|,
literal|076
operator|,
literal|040
operator|,
literal|040
operator|,
comment|/*P*/
literal|036
operator|,
literal|041
operator|,
literal|041
operator|,
literal|045
operator|,
literal|042
operator|,
literal|035
operator|,
comment|/*Q*/
literal|076
operator|,
literal|041
operator|,
literal|041
operator|,
literal|076
operator|,
literal|042
operator|,
literal|041
operator|,
comment|/*R*/
literal|036
operator|,
literal|040
operator|,
literal|036
operator|,
literal|001
operator|,
literal|041
operator|,
literal|036
operator|,
comment|/*S*/
literal|037
operator|,
literal|004
operator|,
literal|004
operator|,
literal|004
operator|,
literal|004
operator|,
literal|004
operator|,
comment|/*T*/
literal|041
operator|,
literal|041
operator|,
literal|041
operator|,
literal|041
operator|,
literal|041
operator|,
literal|036
operator|,
comment|/*U*/
literal|041
operator|,
literal|041
operator|,
literal|041
operator|,
literal|041
operator|,
literal|022
operator|,
literal|014
operator|,
comment|/*V*/
literal|041
operator|,
literal|041
operator|,
literal|041
operator|,
literal|055
operator|,
literal|063
operator|,
literal|041
operator|,
comment|/*W*/
literal|041
operator|,
literal|022
operator|,
literal|014
operator|,
literal|014
operator|,
literal|022
operator|,
literal|041
operator|,
comment|/*X*/
literal|021
operator|,
literal|012
operator|,
literal|004
operator|,
literal|004
operator|,
literal|004
operator|,
literal|004
operator|,
comment|/*Y*/
literal|077
operator|,
literal|002
operator|,
literal|004
operator|,
literal|010
operator|,
literal|020
operator|,
literal|077
operator|,
comment|/*Z*/
literal|016
operator|,
literal|010
operator|,
literal|010
operator|,
literal|010
operator|,
literal|010
operator|,
literal|016
operator|,
comment|/*[*/
literal|040
operator|,
literal|020
operator|,
literal|010
operator|,
literal|004
operator|,
literal|002
operator|,
literal|001
operator|,
comment|/*\*/
literal|034
operator|,
literal|004
operator|,
literal|004
operator|,
literal|004
operator|,
literal|004
operator|,
literal|034
operator|,
comment|/*]*/
literal|004
operator|,
literal|012
operator|,
literal|000
operator|,
literal|000
operator|,
literal|000
operator|,
literal|000
operator|,
comment|/*^*/
literal|000
operator|,
literal|000
operator|,
literal|000
operator|,
literal|000
operator|,
literal|000
operator|,
literal|077
operator|,
comment|/*_*/
literal|000
operator|,
literal|000
operator|,
literal|000
operator|,
literal|000
operator|,
literal|000
operator|,
literal|000
operator|,
comment|/* */
literal|010
operator|,
literal|010
operator|,
literal|010
operator|,
literal|010
operator|,
literal|000
operator|,
literal|010
operator|,
comment|/*!*/
literal|022
operator|,
literal|022
operator|,
literal|000
operator|,
literal|000
operator|,
literal|000
operator|,
literal|000
operator|,
comment|/*"*/
literal|022
operator|,
literal|077
operator|,
literal|022
operator|,
literal|022
operator|,
literal|077
operator|,
literal|022
operator|,
comment|/*#*/
literal|036
operator|,
literal|054
operator|,
literal|036
operator|,
literal|015
operator|,
literal|055
operator|,
literal|036
operator|,
comment|/*$*/
literal|001
operator|,
literal|062
operator|,
literal|064
operator|,
literal|013
operator|,
literal|023
operator|,
literal|040
operator|,
comment|/*%*/
literal|014
operator|,
literal|022
operator|,
literal|014
operator|,
literal|024
operator|,
literal|042
operator|,
literal|035
operator|,
comment|/*&*/
literal|010
operator|,
literal|010
operator|,
literal|000
operator|,
literal|000
operator|,
literal|000
operator|,
literal|000
operator|,
comment|/*'*/
literal|004
operator|,
literal|010
operator|,
literal|010
operator|,
literal|010
operator|,
literal|010
operator|,
literal|004
operator|,
comment|/*(*/
literal|010
operator|,
literal|004
operator|,
literal|004
operator|,
literal|004
operator|,
literal|004
operator|,
literal|010
operator|,
comment|/*)*/
literal|000
operator|,
literal|022
operator|,
literal|014
operator|,
literal|014
operator|,
literal|022
operator|,
literal|000
comment|/***/
block|}
end_decl_stmt

begin_empty_stmt
empty_stmt|;
end_empty_stmt

begin_expr_stmt
name|char
name|blank
literal|' '
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|char
name|plot
literal|'X'
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|int
name|msk
literal|040
expr_stmt|;
end_expr_stmt

begin_comment
comment|/*mask at sixth bit*/
end_comment

begin_function
name|main
parameter_list|(
name|argc
parameter_list|,
name|argp
parameter_list|)
name|char
modifier|*
modifier|*
name|argp
decl_stmt|;
name|int
name|argc
decl_stmt|;
block|{
name|int
name|i
decl_stmt|;
comment|/*if invoked with no arguments, prints error comment; 	  if invoked with an argument, prints it in banner form. 	*/
if|if
condition|(
name|argc
operator|<
literal|2
condition|)
block|{
name|printf
argument_list|(
literal|"missing argument\n"
argument_list|)
expr_stmt|;
name|exit
argument_list|()
expr_stmt|;
block|}
name|banner
argument_list|(
name|argp
index|[
literal|1
index|]
argument_list|,
name|bp
argument_list|)
expr_stmt|;
name|banprt
argument_list|(
name|bp
argument_list|)
expr_stmt|;
block|}
end_function

begin_macro
name|banner
argument_list|(
argument|s
argument_list|,
argument|bufp
argument_list|)
end_macro

begin_decl_stmt
name|char
modifier|*
name|s
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|bann
modifier|*
name|bufp
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|char
name|c
decl_stmt|,
modifier|*
name|p
decl_stmt|,
modifier|*
name|q
decl_stmt|,
modifier|*
name|r
decl_stmt|;
name|p
operator|=
name|s
expr_stmt|;
name|r
operator|=
name|bufp
expr_stmt|;
name|banset
argument_list|(
name|blank
argument_list|,
name|bufp
argument_list|)
expr_stmt|;
while|while
condition|(
operator|(
name|c
operator|=
operator|*
name|s
operator|++
operator|)
operator|!=
literal|0
condition|)
block|{
if|if
condition|(
operator|(
name|s
operator|-
name|p
operator|)
operator|>
name|chpln
condition|)
return|return
operator|(
name|s
operator|-
name|p
operator|)
return|;
if|if
condition|(
name|c
operator|>=
literal|'`'
condition|)
name|c
operator|=
operator|-
literal|' '
expr_stmt|;
comment|/*map lower to upper case*/
if|if
condition|(
name|c
operator|<
literal|' '
condition|)
name|c
operator|=
literal|'#'
expr_stmt|;
if|if
condition|(
name|c
operator|>
literal|'?'
condition|)
name|c
operator|=
operator|-
literal|0100
expr_stmt|;
name|q
operator|=
name|ctbl
index|[
name|c
index|]
expr_stmt|;
name|banfil
argument_list|(
name|q
argument_list|,
name|r
argument_list|)
expr_stmt|;
name|r
operator|=
operator|+
name|pospch
expr_stmt|;
block|}
block|}
end_block

begin_macro
name|banfil
argument_list|(
argument|c
argument_list|,
argument|p
argument_list|)
end_macro

begin_decl_stmt
name|char
modifier|*
name|c
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|bann
modifier|*
name|p
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nlines
condition|;
name|i
operator|++
control|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|pospch
condition|;
name|j
operator|++
control|)
block|{
if|if
condition|(
operator|(
operator|(
name|c
index|[
name|i
index|]
operator|<<
name|j
operator|)
operator|&
name|msk
operator|)
operator|!=
literal|0
condition|)
name|p
operator|->
name|alpha
index|[
name|i
index|]
index|[
name|j
index|]
operator|=
name|plot
expr_stmt|;
block|}
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_block

begin_macro
name|banset
argument_list|(
argument|c
argument_list|,
argument|p
argument_list|)
end_macro

begin_decl_stmt
name|char
name|c
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|bann
modifier|*
name|p
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nlines
condition|;
name|i
operator|++
control|)
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|pposs
operator|-
literal|1
condition|;
name|j
operator|++
control|)
name|p
operator|->
name|alpha
index|[
name|i
index|]
index|[
name|j
index|]
operator|=
name|c
expr_stmt|;
block|}
end_block

begin_macro
name|banprt
argument_list|(
argument|ptr
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|bann
modifier|*
name|ptr
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nlines
condition|;
name|i
operator|++
control|)
block|{
name|ptr
operator|->
name|alpha
index|[
name|i
index|]
index|[
name|pposs
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
for|for
control|(
name|j
operator|=
name|pposs
operator|-
literal|2
init|;
name|j
operator|>=
literal|0
condition|;
name|j
operator|--
control|)
block|{
if|if
condition|(
name|ptr
operator|->
name|alpha
index|[
name|i
index|]
index|[
name|j
index|]
operator|!=
name|blank
condition|)
break|break;
name|ptr
operator|->
name|alpha
index|[
name|i
index|]
index|[
name|j
index|]
operator|=
literal|'\0'
expr_stmt|;
block|}
name|printf
argument_list|(
literal|"%s\n"
argument_list|,
name|ptr
operator|->
name|alpha
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
block|}
end_block

end_unit

