begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* $NetBSD: t_wcstod.c,v 1.3 2011/10/01 17:56:11 christos Exp $ */
end_comment

begin_comment
comment|/*-  * Copyright (c) 2011 The NetBSD Foundation, Inc.  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS  * ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED  * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR  * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE FOUNDATION OR CONTRIBUTORS  * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR  * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF  * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS  * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN  * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE  * POSSIBILITY OF SUCH DAMAGE.  */
end_comment

begin_comment
comment|/*-  * Copyright (c)2005 Citrus Project,  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  *  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__COPYRIGHT
argument_list|(
literal|"@(#) Copyright (c) 2011\  The NetBSD Foundation, inc. All rights reserved."
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|__RCSID
argument_list|(
literal|"$NetBSD: t_wcstod.c,v 1.3 2011/10/01 17:56:11 christos Exp $"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_include
include|#
directive|include
file|<errno.h>
end_include

begin_include
include|#
directive|include
file|<math.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<wchar.h>
end_include

begin_include
include|#
directive|include
file|<atf-c.h>
end_include

begin_define
define|#
directive|define
name|ALT_HUGE_VAL
value|-1
end_define

begin_define
define|#
directive|define
name|ALT_MINUS_HUGE_VAL
value|-2
end_define

begin_define
define|#
directive|define
name|ALT_NAN
value|-3
end_define

begin_if
if|#
directive|if
operator|!
name|defined
argument_list|(
name|__vax__
argument_list|)
end_if

begin_struct
specifier|static
struct|struct
name|test
block|{
specifier|const
name|wchar_t
modifier|*
name|wcs
decl_stmt|;
name|size_t
name|len
decl_stmt|;
name|double
name|val
decl_stmt|;
name|int
name|err
decl_stmt|;
block|}
name|tests
index|[]
init|=
block|{
block|{
literal|L"IN"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+IN"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-IN"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"INX"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+INX"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-INX"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"INF"
block|,
literal|3
block|,
name|ALT_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"+INF"
block|,
literal|4
block|,
name|ALT_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"-INF"
block|,
literal|4
block|,
name|ALT_MINUS_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"INFX"
block|,
literal|3
block|,
name|ALT_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"+INFX"
block|,
literal|4
block|,
name|ALT_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"-INFX"
block|,
literal|4
block|,
name|ALT_MINUS_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"     IN"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"     +IN"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"     -IN"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"     INX"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"     +INX"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"     -INX"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+     INF"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-     INF"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"     INF"
block|,
literal|8
block|,
name|ALT_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"     +INF"
block|,
literal|9
block|,
name|ALT_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"     -INF"
block|,
literal|9
block|,
name|ALT_MINUS_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"     INFX"
block|,
literal|8
block|,
name|ALT_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"     +INFX"
block|,
literal|9
block|,
name|ALT_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"     -INFX"
block|,
literal|9
block|,
name|ALT_MINUS_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"     INFINIT"
block|,
literal|8
block|,
name|ALT_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"     +INFINIT"
block|,
literal|9
block|,
name|ALT_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"     -INFINIT"
block|,
literal|9
block|,
name|ALT_MINUS_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"     INFINITY"
block|,
literal|13
block|,
name|ALT_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"     +INFINITY"
block|,
literal|14
block|,
name|ALT_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"     -INFINITY"
block|,
literal|14
block|,
name|ALT_MINUS_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"     INFINITYX"
block|,
literal|13
block|,
name|ALT_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"     +INFINITYX"
block|,
literal|14
block|,
name|ALT_HUGE_VAL
block|,
literal|0
block|}
block|,
block|{
literal|L"     -INFINITYX"
block|,
literal|14
block|,
name|ALT_MINUS_HUGE_VAL
block|,
literal|0
block|}
block|,
comment|/* NAN */
block|{
literal|L"NA"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+NA"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-NA"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"NAX"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+NAX"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-NAX"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"NAN"
block|,
literal|3
block|,
name|ALT_NAN
block|,
literal|0
block|}
block|,
block|{
literal|L"+NAN"
block|,
literal|4
block|,
name|ALT_NAN
block|,
literal|0
block|}
block|,
block|{
literal|L"-NAN"
block|,
literal|4
block|,
name|ALT_NAN
block|,
literal|0
block|}
block|,
block|{
literal|L"NANX"
block|,
literal|3
block|,
name|ALT_NAN
block|,
literal|0
block|}
block|,
block|{
literal|L"+NANX"
block|,
literal|4
block|,
name|ALT_NAN
block|,
literal|0
block|}
block|,
block|{
literal|L"-NANX"
block|,
literal|4
block|,
name|ALT_NAN
block|,
literal|0
block|}
block|,
block|{
literal|L"     NA"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"     +NA"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"     -NA"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"     NAX"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"     +NAX"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"     -NAX"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+     NAN"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-     NAN"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"     NAN"
block|,
literal|8
block|,
name|ALT_NAN
block|,
literal|0
block|}
block|,
block|{
literal|L"     +NAN"
block|,
literal|9
block|,
name|ALT_NAN
block|,
literal|0
block|}
block|,
block|{
literal|L"     -NAN"
block|,
literal|9
block|,
name|ALT_NAN
block|,
literal|0
block|}
block|,
block|{
literal|L"     NANX"
block|,
literal|8
block|,
name|ALT_NAN
block|,
literal|0
block|}
block|,
block|{
literal|L"     +NANX"
block|,
literal|9
block|,
name|ALT_NAN
block|,
literal|0
block|}
block|,
block|{
literal|L"     -NANX"
block|,
literal|9
block|,
name|ALT_NAN
block|,
literal|0
block|}
block|,
block|{
literal|L"0"
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0"
block|,
literal|2
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0"
block|,
literal|2
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          0"
block|,
literal|11
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +0"
block|,
literal|12
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -0"
block|,
literal|12
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+          0"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-          0"
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"."
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L".0"
block|,
literal|2
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L".00"
block|,
literal|3
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L".000"
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"0."
block|,
literal|2
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0."
block|,
literal|3
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0."
block|,
literal|3
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          0."
block|,
literal|12
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +0."
block|,
literal|13
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -0."
block|,
literal|13
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"0.0"
block|,
literal|3
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0.0"
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0.0"
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          0.0"
block|,
literal|13
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +0.0"
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -0.0"
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"000"
block|,
literal|3
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+000"
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-000"
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          000"
block|,
literal|13
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +000"
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -000"
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"000."
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+000."
block|,
literal|5
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-000."
block|,
literal|5
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          000."
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +000."
block|,
literal|15
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -000."
block|,
literal|15
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"000.0"
block|,
literal|5
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+000.0"
block|,
literal|6
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-000.0"
block|,
literal|6
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          000.0"
block|,
literal|15
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +000.0"
block|,
literal|16
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -000.0"
block|,
literal|16
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"0.0."
block|,
literal|3
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0.0."
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0.0."
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          0.0."
block|,
literal|13
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +0.0."
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -0.0."
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"0.0.0"
block|,
literal|3
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0.0.0"
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0.0.0"
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          0.0.0"
block|,
literal|13
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +0.0.0"
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -0.0.0"
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
comment|/* XXX: FIXME */
if|#
directive|if
name|defined
argument_list|(
name|__linux__
argument_list|)
block|{
literal|L"0X"
block|,
literal|2
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0X"
block|,
literal|3
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0X"
block|,
literal|3
block|,
literal|0
block|,
literal|0
block|}
block|,
else|#
directive|else
block|{
literal|L"0X"
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0X"
block|,
literal|2
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0X"
block|,
literal|2
block|,
literal|0
block|,
literal|0
block|}
block|,
endif|#
directive|endif
comment|/* XXX: SunOS 5.8's wcstod(3) doesn't accept hex */
if|#
directive|if
operator|!
name|defined
argument_list|(
name|__SunOS__
argument_list|)
if|#
directive|if
name|defined
argument_list|(
name|__linux__
argument_list|)
block|{
literal|L"0X."
block|,
literal|3
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0X."
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0X."
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          0X."
block|,
literal|13
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +0X."
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -0X."
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
else|#
directive|else
block|{
literal|L"0X."
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0X."
block|,
literal|2
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0X."
block|,
literal|2
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          0X."
block|,
literal|11
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +0X."
block|,
literal|12
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -0X."
block|,
literal|12
block|,
literal|0
block|,
literal|0
block|}
block|,
endif|#
directive|endif
comment|/* XXX: FIXME */
if|#
directive|if
name|defined
argument_list|(
name|__NetBSD__
argument_list|)
operator|||
name|defined
argument_list|(
name|__linux__
argument_list|)
block|{
literal|L"0X.0"
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0X.0"
block|,
literal|5
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0X.0"
block|,
literal|5
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          0X.0"
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +0X.0"
block|,
literal|15
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -0X.0"
block|,
literal|15
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"0X.0P"
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0X.0P"
block|,
literal|5
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0X.0P"
block|,
literal|5
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          0X.0P"
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +0X.0P"
block|,
literal|15
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -0X.0P"
block|,
literal|15
block|,
literal|0
block|,
literal|0
block|}
block|,
else|#
directive|else
block|{
literal|L"0X.0"
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0X.0"
block|,
literal|2
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0X.0"
block|,
literal|2
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          0X.0"
block|,
literal|11
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +0X.0"
block|,
literal|12
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -0X.0"
block|,
literal|12
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"0X.0P"
block|,
literal|1
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0X.0P"
block|,
literal|2
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0X.0P"
block|,
literal|2
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          0X.0P"
block|,
literal|11
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +0X.0P"
block|,
literal|12
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -0X.0P"
block|,
literal|12
block|,
literal|0
block|,
literal|0
block|}
block|,
endif|#
directive|endif
block|{
literal|L"0X0"
block|,
literal|3
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0X0"
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0X0"
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          0X0"
block|,
literal|13
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +0X0"
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -0X0"
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"00X0.0"
block|,
literal|2
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+00X0.0"
block|,
literal|3
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-00X0.0"
block|,
literal|3
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          00X0.0"
block|,
literal|12
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +00X0.0"
block|,
literal|13
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -00X0.0"
block|,
literal|13
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"0X0P"
block|,
literal|3
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0X0P"
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0X0P"
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          0X0P"
block|,
literal|13
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +0X0P"
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -0X0P"
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"0X0."
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0X0."
block|,
literal|5
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0X0."
block|,
literal|5
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          0X0."
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +0X0."
block|,
literal|15
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -0X0."
block|,
literal|15
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"0X0.0"
block|,
literal|5
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0X0.0"
block|,
literal|6
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0X0.0"
block|,
literal|6
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          0X0.0"
block|,
literal|15
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +0X0.0"
block|,
literal|16
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -0X0.0"
block|,
literal|16
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"0X0.P"
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0X0.P"
block|,
literal|5
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0X0.P"
block|,
literal|5
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          0X0.P"
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +0X0.P"
block|,
literal|15
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -0X0.P"
block|,
literal|15
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"0X0.P"
block|,
literal|4
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"+0X0.P"
block|,
literal|5
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"-0X0.P"
block|,
literal|5
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          0X0.P"
block|,
literal|14
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          +0X0.P"
block|,
literal|15
block|,
literal|0
block|,
literal|0
block|}
block|,
block|{
literal|L"          -0X0.P"
block|,
literal|15
block|,
literal|0
block|,
literal|0
block|}
block|,
endif|#
directive|endif
block|{
literal|L"0.12345678"
block|,
literal|10
block|,
literal|0.12345678
block|,
literal|0
block|}
block|,
block|{
literal|L"+0.12345678"
block|,
literal|11
block|,
operator|+
literal|0.12345678
block|,
literal|0
block|}
block|,
block|{
literal|L"-0.12345678"
block|,
literal|11
block|,
operator|-
literal|0.12345678
block|,
literal|0
block|}
block|,
block|{
literal|L"     0.12345678"
block|,
literal|15
block|,
literal|0.12345678
block|,
literal|0
block|}
block|,
block|{
literal|L"     +0.12345678"
block|,
literal|16
block|,
operator|+
literal|0.12345678
block|,
literal|0
block|}
block|,
block|{
literal|L"     -0.12345678"
block|,
literal|16
block|,
operator|-
literal|0.12345678
block|,
literal|0
block|}
block|,
block|{
literal|L"0.12345E67"
block|,
literal|10
block|,
literal|0.12345E67
block|,
literal|0
block|}
block|,
block|{
literal|L"+0.12345E67"
block|,
literal|11
block|,
operator|+
literal|0.12345E67
block|,
literal|0
block|}
block|,
block|{
literal|L"-0.12345E67"
block|,
literal|11
block|,
operator|-
literal|0.12345E67
block|,
literal|0
block|}
block|,
block|{
literal|L"     0.12345E67"
block|,
literal|15
block|,
literal|0.12345E67
block|,
literal|0
block|}
block|,
block|{
literal|L"     +0.12345E67"
block|,
literal|16
block|,
operator|+
literal|0.12345E67
block|,
literal|0
block|}
block|,
block|{
literal|L"     -0.12345E67"
block|,
literal|16
block|,
operator|-
literal|0.12345E67
block|,
literal|0
block|}
block|,
block|{
literal|L"0.12345E+6"
block|,
literal|10
block|,
literal|0.12345E
operator|+
literal|6
block|,
literal|0
block|}
block|,
block|{
literal|L"+0.12345E+6"
block|,
literal|11
block|,
operator|+
literal|0.12345E
operator|+
literal|6
block|,
literal|0
block|}
block|,
block|{
literal|L"-0.12345E+6"
block|,
literal|11
block|,
operator|-
literal|0.12345E
operator|+
literal|6
block|,
literal|0
block|}
block|,
block|{
literal|L"     0.12345E+6"
block|,
literal|15
block|,
literal|0.12345E
operator|+
literal|6
block|,
literal|0
block|}
block|,
block|{
literal|L"     +0.12345E+6"
block|,
literal|16
block|,
operator|+
literal|0.12345E
operator|+
literal|6
block|,
literal|0
block|}
block|,
block|{
literal|L"     -0.12345E+6"
block|,
literal|16
block|,
operator|-
literal|0.12345E
operator|+
literal|6
block|,
literal|0
block|}
block|,
block|{
literal|L"0.98765E-4"
block|,
literal|10
block|,
literal|0.98765E
operator|-
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"+0.98765E-4"
block|,
literal|11
block|,
operator|+
literal|0.98765E
operator|-
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"-0.98765E-4"
block|,
literal|11
block|,
operator|-
literal|0.98765E
operator|-
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"     0.98765E-4"
block|,
literal|15
block|,
literal|0.98765E
operator|-
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"     +0.98765E-4"
block|,
literal|16
block|,
operator|+
literal|0.98765E
operator|-
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"     -0.98765E-4"
block|,
literal|16
block|,
operator|-
literal|0.98765E
operator|-
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"12345678E9"
block|,
literal|10
block|,
literal|12345678E9
block|,
literal|0
block|}
block|,
block|{
literal|L"+12345678E9"
block|,
literal|11
block|,
operator|+
literal|12345678E9
block|,
literal|0
block|}
block|,
block|{
literal|L"-12345678E9"
block|,
literal|11
block|,
operator|-
literal|12345678E9
block|,
literal|0
block|}
block|,
block|{
literal|L"     12345678E9"
block|,
literal|15
block|,
literal|12345678E9
block|,
literal|0
block|}
block|,
block|{
literal|L"     +12345678E9"
block|,
literal|16
block|,
operator|+
literal|12345678E9
block|,
literal|0
block|}
block|,
block|{
literal|L"     -12345678E9"
block|,
literal|16
block|,
operator|-
literal|12345678E9
block|,
literal|0
block|}
block|,
comment|/* XXX: SunOS 5.8's wcstod(3) doesn't accept hex */
if|#
directive|if
operator|!
name|defined
argument_list|(
name|__SunOS__
argument_list|)
block|{
literal|L"0x1P+2"
block|,
literal|6
block|,
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"+0x1P+2"
block|,
literal|7
block|,
operator|+
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"-0x1P+2"
block|,
literal|7
block|,
operator|-
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"     0x1P+2"
block|,
literal|11
block|,
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"     +0x1P+2"
block|,
literal|12
block|,
operator|+
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"     -0x1P+2"
block|,
literal|12
block|,
operator|-
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"0x1.0P+2"
block|,
literal|8
block|,
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"+0x1.0P+2"
block|,
literal|9
block|,
operator|+
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"-0x1.0P+2"
block|,
literal|9
block|,
operator|-
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"     0x1.0P+2"
block|,
literal|13
block|,
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"     +0x1.0P+2"
block|,
literal|14
block|,
operator|+
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"     -0x1.0P+2"
block|,
literal|14
block|,
operator|-
literal|4
block|,
literal|0
block|}
block|,
block|{
literal|L"0x1P-2"
block|,
literal|6
block|,
literal|0.25
block|,
literal|0
block|}
block|,
block|{
literal|L"+0x1P-2"
block|,
literal|7
block|,
operator|+
literal|0.25
block|,
literal|0
block|}
block|,
block|{
literal|L"-0x1P-2"
block|,
literal|7
block|,
operator|-
literal|0.25
block|,
literal|0
block|}
block|,
block|{
literal|L"     0x1P-2"
block|,
literal|11
block|,
literal|0.25
block|,
literal|0
block|}
block|,
block|{
literal|L"     +0x1P-2"
block|,
literal|12
block|,
operator|+
literal|0.25
block|,
literal|0
block|}
block|,
block|{
literal|L"     -0x1P-2"
block|,
literal|12
block|,
operator|-
literal|0.25
block|,
literal|0
block|}
block|,
block|{
literal|L"0x1.0P-2"
block|,
literal|8
block|,
literal|0.25
block|,
literal|0
block|}
block|,
block|{
literal|L"+0x1.0P-2"
block|,
literal|9
block|,
operator|+
literal|0.25
block|,
literal|0
block|}
block|,
block|{
literal|L"-0x1.0P-2"
block|,
literal|9
block|,
operator|-
literal|0.25
block|,
literal|0
block|}
block|,
block|{
literal|L"     0x1.0P-2"
block|,
literal|13
block|,
literal|0.25
block|,
literal|0
block|}
block|,
block|{
literal|L"     +0x1.0P-2"
block|,
literal|14
block|,
operator|+
literal|0.25
block|,
literal|0
block|}
block|,
block|{
literal|L"     -0x1.0P-2"
block|,
literal|14
block|,
operator|-
literal|0.25
block|,
literal|0
block|}
block|,
endif|#
directive|endif
block|{
name|NULL
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|}
struct|;
end_struct

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* !defined(__vax__) */
end_comment

begin_expr_stmt
name|ATF_TC
argument_list|(
name|wcstod
argument_list|)
expr_stmt|;
end_expr_stmt

begin_macro
name|ATF_TC_HEAD
argument_list|(
argument|wcstod
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
name|atf_tc_set_md_var
argument_list|(
name|tc
argument_list|,
literal|"descr"
argument_list|,
literal|"Checks wcstod(3)"
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|ATF_TC_BODY
argument_list|(
argument|wcstod
argument_list|,
argument|tc
argument_list|)
end_macro

begin_block
block|{
if|#
directive|if
name|defined
argument_list|(
name|__vax__
argument_list|)
else|#
directive|else
name|struct
name|test
modifier|*
name|t
decl_stmt|;
endif|#
directive|endif
if|#
directive|if
operator|!
name|defined
argument_list|(
name|__vax__
argument_list|)
for|for
control|(
name|t
operator|=
operator|&
name|tests
index|[
literal|0
index|]
init|;
name|t
operator|->
name|wcs
operator|!=
name|NULL
condition|;
operator|++
name|t
control|)
block|{
name|double
name|d
decl_stmt|;
name|size_t
name|n
decl_stmt|;
name|wchar_t
modifier|*
name|tail
decl_stmt|;
name|char
modifier|*
name|buf
decl_stmt|;
comment|/* we do not supported %ls nor %S yet. */
name|n
operator|=
name|wcstombs
argument_list|(
name|NULL
argument_list|,
name|t
operator|->
name|wcs
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|ATF_REQUIRE
argument_list|(
operator|(
name|buf
operator|=
operator|(
name|void
operator|*
operator|)
name|malloc
argument_list|(
name|n
operator|+
literal|1
argument_list|)
operator|)
operator|!=
name|NULL
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|wcstombs
argument_list|(
name|buf
argument_list|,
name|t
operator|->
name|wcs
argument_list|,
name|n
operator|+
literal|1
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|printf
argument_list|(
literal|"Checking wcstod(\"%s\",&tail):\n"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|buf
argument_list|)
expr_stmt|;
name|errno
operator|=
literal|0
expr_stmt|;
name|d
operator|=
name|wcstod
argument_list|(
name|t
operator|->
name|wcs
argument_list|,
operator|&
name|tail
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|printf
argument_list|(
literal|"[errno]\n"
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|printf
argument_list|(
literal|"  got     : %s\n"
argument_list|,
name|strerror
argument_list|(
name|errno
argument_list|)
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|printf
argument_list|(
literal|"  expected: %s\n"
argument_list|,
name|strerror
argument_list|(
name|t
operator|->
name|err
argument_list|)
argument_list|)
expr_stmt|;
name|ATF_REQUIRE_EQ
argument_list|(
name|errno
argument_list|,
name|t
operator|->
name|err
argument_list|)
expr_stmt|;
name|n
operator|=
call|(
name|size_t
call|)
argument_list|(
name|tail
operator|-
name|t
operator|->
name|wcs
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|printf
argument_list|(
literal|"[endptr - nptr]\n"
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|printf
argument_list|(
literal|"  got     : %zd\n"
argument_list|,
name|n
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|printf
argument_list|(
literal|"  expected: %zd\n"
argument_list|,
name|t
operator|->
name|len
argument_list|)
expr_stmt|;
name|ATF_REQUIRE_EQ
argument_list|(
name|n
argument_list|,
name|t
operator|->
name|len
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|printf
argument_list|(
literal|"[result]\n"
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|printf
argument_list|(
literal|"  real:     %F\n"
argument_list|,
name|d
argument_list|)
expr_stmt|;
if|if
condition|(
name|t
operator|->
name|val
operator|==
name|ALT_HUGE_VAL
condition|)
block|{
operator|(
name|void
operator|)
name|printf
argument_list|(
literal|"  expected: %F\n"
argument_list|,
name|HUGE_VAL
argument_list|)
expr_stmt|;
name|ATF_REQUIRE
argument_list|(
name|isinf
argument_list|(
name|d
argument_list|)
argument_list|)
expr_stmt|;
name|ATF_REQUIRE_EQ
argument_list|(
name|d
argument_list|,
name|HUGE_VAL
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|t
operator|->
name|val
operator|==
name|ALT_MINUS_HUGE_VAL
condition|)
block|{
operator|(
name|void
operator|)
name|printf
argument_list|(
literal|"  expected: %F\n"
argument_list|,
operator|-
name|HUGE_VAL
argument_list|)
expr_stmt|;
name|ATF_REQUIRE
argument_list|(
name|isinf
argument_list|(
name|d
argument_list|)
argument_list|)
expr_stmt|;
name|ATF_REQUIRE_EQ
argument_list|(
name|d
argument_list|,
operator|-
name|HUGE_VAL
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|t
operator|->
name|val
operator|==
name|ALT_NAN
condition|)
block|{
operator|(
name|void
operator|)
name|printf
argument_list|(
literal|"  expected: %F\n"
argument_list|,
name|NAN
argument_list|)
expr_stmt|;
name|ATF_REQUIRE
argument_list|(
name|isnan
argument_list|(
name|d
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
operator|(
name|void
operator|)
name|printf
argument_list|(
literal|"  expected: %F\n"
argument_list|,
name|t
operator|->
name|val
argument_list|)
expr_stmt|;
name|ATF_REQUIRE_EQ
argument_list|(
name|d
argument_list|,
name|t
operator|->
name|val
argument_list|)
expr_stmt|;
block|}
operator|(
name|void
operator|)
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
else|#
directive|else
comment|/* !defined(__vax__) */
name|atf_tc_skip
argument_list|(
literal|"Test is unavailable on vax."
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* !defined(__vax__) */
block|}
end_block

begin_macro
name|ATF_TP_ADD_TCS
argument_list|(
argument|tp
argument_list|)
end_macro

begin_block
block|{
name|ATF_TP_ADD_TC
argument_list|(
name|tp
argument_list|,
name|wcstod
argument_list|)
expr_stmt|;
return|return
name|atf_no_error
argument_list|()
return|;
block|}
end_block

end_unit

