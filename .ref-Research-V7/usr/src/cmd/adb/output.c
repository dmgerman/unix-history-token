begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_empty
empty|#
end_empty

begin_comment
comment|/*  *  *	UNIX debugger  *  */
end_comment

begin_include
include|#
directive|include
file|"defs.h"
end_include

begin_decl_stmt
name|INT
name|mkfault
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|INT
name|infile
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|INT
name|outfile
literal|1
expr_stmt|;
end_expr_stmt

begin_decl_stmt
name|INT
name|maxpos
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|CHAR
name|printbuf
index|[
name|MAXLIN
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|CHAR
modifier|*
name|printptr
name|printbuf
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|CHAR
modifier|*
name|digitptr
decl_stmt|;
end_decl_stmt

begin_macro
name|eqstr
argument_list|(
argument|s1
argument_list|,
argument|s2
argument_list|)
end_macro

begin_decl_stmt
name|REG
name|STRING
name|s1
decl_stmt|,
name|s2
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|REG
name|STRING
name|es1
decl_stmt|;
name|es1
operator|=
name|s1
operator|+
literal|8
expr_stmt|;
name|WHILE
operator|*
name|s1
operator|++
operator|==
operator|*
name|s2
name|DO
name|IF
operator|*
name|s2
operator|++
operator|==
literal|0
name|ORF
name|s1
operator|>=
name|es1
name|THEN
return|return
operator|(
literal|1
operator|)
return|;
name|FI
name|OD
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_block

begin_macro
name|length
argument_list|(
argument|s
argument_list|)
end_macro

begin_decl_stmt
name|STRING
name|s
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|INT
name|n
literal|0
expr_stmt|;
name|WHILE
operator|*
name|s
operator|++
name|DO
name|n
operator|++
expr_stmt|;
name|OD
return|return
operator|(
name|n
operator|)
return|;
block|}
end_block

begin_macro
name|printc
argument_list|(
argument|c
argument_list|)
end_macro

begin_decl_stmt
name|CHAR
name|c
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|CHAR
name|d
decl_stmt|;
name|STRING
name|q
decl_stmt|;
name|INT
name|posn
decl_stmt|,
name|tabs
decl_stmt|,
name|p
decl_stmt|;
name|IF
name|mkfault
name|THEN
return|return;
name|ELIF
argument_list|(
operator|*
name|printptr
operator|=
name|c
argument_list|)
operator|==
name|EOR
name|THEN
name|tabs
operator|=
literal|0
expr_stmt|;
name|posn
operator|=
literal|0
expr_stmt|;
name|q
operator|=
name|printbuf
expr_stmt|;
name|FOR
name|p
init|=
literal|0
decl_stmt|;
name|p
operator|<
name|printptr
operator|-
name|printbuf
expr_stmt|;
name|p
operator|++
name|DO
name|d
operator|=
name|printbuf
index|[
name|p
index|]
expr_stmt|;
name|IF
argument_list|(
name|p
operator|&
literal|7
argument_list|)
operator|==
literal|0
name|ANDF
name|posn
name|THEN
name|tabs
operator|++
expr_stmt|;
name|posn
operator|=
literal|0
expr_stmt|;
name|FI
name|IF
name|d
operator|==
name|SP
name|THEN
name|posn
operator|++
expr_stmt|;
name|ELSE
name|WHILE
name|tabs
operator|>
literal|0
name|DO
operator|*
name|q
operator|++
operator|=
name|TB
expr_stmt|;
name|tabs
operator|--
expr_stmt|;
name|OD
name|WHILE
name|posn
operator|>
literal|0
name|DO
operator|*
name|q
operator|++
operator|=
name|SP
expr_stmt|;
name|posn
operator|--
expr_stmt|;
name|OD
operator|*
name|q
operator|++
operator|=
name|d
expr_stmt|;
name|FI
name|OD
operator|*
name|q
operator|++
operator|=
name|EOR
expr_stmt|;
name|write
argument_list|(
name|outfile
argument_list|,
name|printbuf
argument_list|,
name|q
operator|-
name|printbuf
argument_list|)
expr_stmt|;
name|printptr
operator|=
name|printbuf
expr_stmt|;
name|ELIF
name|c
operator|==
name|TB
name|THEN
operator|*
name|printptr
operator|++
operator|=
name|SP
expr_stmt|;
name|WHILE
argument_list|(
name|printptr
operator|-
name|printbuf
argument_list|)
operator|&
literal|7
name|DO
operator|*
name|printptr
operator|++
operator|=
name|SP
expr_stmt|;
name|OD
name|ELIF
name|c
name|THEN
name|printptr
operator|++
expr_stmt|;
name|FI
block|}
end_block

begin_macro
name|charpos
argument_list|()
end_macro

begin_block
block|{
return|return
operator|(
name|printptr
operator|-
name|printbuf
operator|)
return|;
block|}
end_block

begin_macro
name|flushbuf
argument_list|()
end_macro

begin_block
block|{
name|IF
name|printptr
operator|!=
name|printbuf
name|THEN
name|printc
argument_list|(
name|EOR
argument_list|)
expr_stmt|;
name|FI
block|}
end_block

begin_macro
name|printf
argument_list|(
argument|fmat
argument_list|,
argument|a1
argument_list|)
end_macro

begin_decl_stmt
name|STRING
name|fmat
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|STRING
modifier|*
name|a1
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|STRING
name|fptr
decl_stmt|,
name|s
decl_stmt|;
name|INT
modifier|*
name|vptr
decl_stmt|;
name|L_INT
modifier|*
name|dptr
decl_stmt|;
name|L_REAL
modifier|*
name|rptr
decl_stmt|;
name|INT
name|width
decl_stmt|,
name|prec
decl_stmt|;
name|CHAR
name|c
decl_stmt|,
name|adj
decl_stmt|;
name|INT
name|x
decl_stmt|,
name|decpt
decl_stmt|,
name|n
decl_stmt|;
name|L_INT
name|lx
decl_stmt|;
name|CHAR
name|digits
index|[
literal|64
index|]
decl_stmt|;
name|fptr
operator|=
name|fmat
expr_stmt|;
name|vptr
operator|=
operator|&
name|a1
expr_stmt|;
name|WHILE
name|c
init|=
operator|*
name|fptr
operator|++
name|DO
name|IF
name|c
operator|!=
literal|'%'
name|THEN
name|printc
argument_list|(
name|c
argument_list|)
decl_stmt|;
name|ELSE
name|IF
operator|*
name|fptr
operator|==
literal|'-'
name|THEN
name|adj
operator|=
literal|'l'
expr_stmt|;
name|fptr
operator|++
expr_stmt|;
name|ELSE
name|adj
init|=
literal|'r'
decl_stmt|;
name|FI
name|width
init|=
name|convert
argument_list|(
operator|&
name|fptr
argument_list|)
decl_stmt|;
name|IF
operator|*
name|fptr
operator|==
literal|'.'
name|THEN
name|fptr
operator|++
expr_stmt|;
name|prec
operator|=
name|convert
argument_list|(
operator|&
name|fptr
argument_list|)
expr_stmt|;
name|ELSE
name|prec
init|=
operator|-
literal|1
decl_stmt|;
name|FI
name|digitptr
init|=
name|digits
decl_stmt|;
name|dptr
operator|=
name|rptr
operator|=
name|vptr
expr_stmt|;
name|lx
operator|=
operator|*
name|dptr
expr_stmt|;
name|x
operator|=
operator|*
name|vptr
operator|++
expr_stmt|;
name|s
operator|=
literal|0
expr_stmt|;
switch|switch
condition|(
name|c
operator|=
operator|*
name|fptr
operator|++
condition|)
block|{
case|case
literal|'d'
case|:
case|case
literal|'u'
case|:
name|printnum
argument_list|(
name|x
argument_list|,
name|c
argument_list|,
literal|10
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'o'
case|:
name|printoct
argument_list|(
literal|0
argument_list|,
name|x
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'q'
case|:
name|lx
operator|=
name|x
expr_stmt|;
name|printoct
argument_list|(
name|lx
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'x'
case|:
name|printdbl
argument_list|(
literal|0
argument_list|,
name|x
argument_list|,
name|c
argument_list|,
literal|16
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'Y'
case|:
name|printdate
argument_list|(
name|lx
argument_list|)
expr_stmt|;
name|vptr
operator|++
expr_stmt|;
break|break;
case|case
literal|'D'
case|:
case|case
literal|'U'
case|:
name|printdbl
argument_list|(
name|lx
argument_list|,
name|c
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|vptr
operator|++
expr_stmt|;
break|break;
case|case
literal|'O'
case|:
name|printoct
argument_list|(
name|lx
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|vptr
operator|++
expr_stmt|;
break|break;
case|case
literal|'Q'
case|:
name|printoct
argument_list|(
name|lx
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|vptr
operator|++
expr_stmt|;
break|break;
case|case
literal|'X'
case|:
name|printdbl
argument_list|(
name|lx
argument_list|,
literal|'x'
argument_list|,
literal|16
argument_list|)
expr_stmt|;
name|vptr
operator|++
expr_stmt|;
break|break;
case|case
literal|'c'
case|:
name|printc
argument_list|(
name|x
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'s'
case|:
name|s
operator|=
name|x
expr_stmt|;
break|break;
case|case
literal|'f'
case|:
case|case
literal|'F'
case|:
name|vptr
operator|+=
literal|7
expr_stmt|;
name|s
operator|=
name|ecvt
argument_list|(
operator|*
name|rptr
argument_list|,
name|prec
argument_list|,
operator|&
name|decpt
argument_list|,
operator|&
name|n
argument_list|)
expr_stmt|;
operator|*
name|digitptr
operator|++
operator|=
operator|(
name|n
condition|?
literal|'-'
else|:
literal|'+'
operator|)
expr_stmt|;
operator|*
name|digitptr
operator|++
operator|=
operator|(
name|decpt
operator|<=
literal|0
condition|?
literal|'0'
else|:
operator|*
name|s
operator|++
operator|)
expr_stmt|;
name|IF
name|decpt
operator|>
literal|0
name|THEN
name|decpt
operator|--
expr_stmt|;
name|FI
operator|*
name|digitptr
operator|++
operator|=
literal|'.'
expr_stmt|;
name|WHILE
operator|*
name|s
name|ANDF
name|prec
operator|--
name|DO
operator|*
name|digitptr
operator|++
operator|=
operator|*
name|s
operator|++
expr_stmt|;
name|OD
name|WHILE
operator|*
operator|--
name|digitptr
operator|==
literal|'0'
name|DONE
name|digitptr
operator|+=
operator|(
name|digitptr
operator|-
name|digits
operator|>=
literal|3
condition|?
literal|1
else|:
literal|2
operator|)
expr_stmt|;
name|IF
name|decpt
name|THEN
operator|*
name|digitptr
operator|++
operator|=
literal|'e'
expr_stmt|;
name|printnum
argument_list|(
name|decpt
argument_list|,
literal|'d'
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|FI
name|s
init|=
literal|0
decl_stmt|;
name|prec
operator|=
operator|-
literal|1
expr_stmt|;
break|break;
case|case
literal|'m'
case|:
name|vptr
operator|--
expr_stmt|;
break|break;
case|case
literal|'M'
case|:
name|width
operator|=
name|x
expr_stmt|;
break|break;
case|case
literal|'T'
case|:
case|case
literal|'t'
case|:
name|IF
name|c
operator|==
literal|'T'
name|THEN
name|width
operator|=
name|x
expr_stmt|;
name|ELSE
name|vptr
operator|--
expr_stmt|;
name|FI
name|IF
name|width
name|THEN
name|width
operator|-=
name|charpos
argument_list|()
operator|%
name|width
expr_stmt|;
name|FI
break|break;
default|default:
name|printc
argument_list|(
name|c
argument_list|)
expr_stmt|;
name|vptr
operator|--
expr_stmt|;
block|}
name|IF
name|s
operator|==
literal|0
name|THEN
operator|*
name|digitptr
operator|=
literal|0
expr_stmt|;
name|s
operator|=
name|digits
expr_stmt|;
name|FI
name|n
init|=
name|length
argument_list|(
name|s
argument_list|)
decl_stmt|;
name|n
operator|=
operator|(
name|prec
operator|<
name|n
name|ANDF
name|prec
operator|>=
literal|0
condition|?
name|prec
else|:
name|n
operator|)
expr_stmt|;
name|width
operator|-=
name|n
expr_stmt|;
name|IF
name|adj
operator|==
literal|'r'
name|THEN
name|WHILE
name|width
operator|--
operator|>
literal|0
name|DO
name|printc
argument_list|(
name|SP
argument_list|)
expr_stmt|;
name|OD
name|FI
name|WHILE
name|n
operator|--
name|DO
name|printc
argument_list|(
operator|*
name|s
operator|++
argument_list|)
expr_stmt|;
name|OD
name|WHILE
name|width
operator|--
operator|>
literal|0
name|DO
name|printc
argument_list|(
name|SP
argument_list|)
expr_stmt|;
name|OD
name|digitptr
init|=
name|digits
decl_stmt|;
name|FI
name|OD
block|}
end_block

begin_macro
name|printdate
argument_list|(
argument|tvec
argument_list|)
end_macro

begin_decl_stmt
name|L_INT
name|tvec
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|REG
name|INT
name|i
decl_stmt|;
name|REG
name|STRING
name|timeptr
decl_stmt|;
name|timeptr
operator|=
name|ctime
argument_list|(
operator|&
name|tvec
argument_list|)
expr_stmt|;
name|FOR
name|i
init|=
literal|20
decl_stmt|;
name|i
operator|<
literal|24
expr_stmt|;
name|i
operator|++
name|DO
operator|*
name|digitptr
operator|++
operator|=
operator|*
operator|(
name|timeptr
operator|+
name|i
operator|)
expr_stmt|;
name|OD
name|FOR
name|i
init|=
literal|3
decl_stmt|;
name|i
operator|<
literal|19
expr_stmt|;
name|i
operator|++
name|DO
operator|*
name|digitptr
operator|++
operator|=
operator|*
operator|(
name|timeptr
operator|+
name|i
operator|)
expr_stmt|;
name|OD
block|}
end_block

begin_comment
comment|/*printdate*/
end_comment

begin_macro
name|prints
argument_list|(
argument|s
argument_list|)
end_macro

begin_decl_stmt
name|char
modifier|*
name|s
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|printf
argument_list|(
literal|"%s"
argument_list|,
name|s
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|newline
argument_list|()
end_macro

begin_block
block|{
name|printc
argument_list|(
name|EOR
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|convert
argument_list|(
argument|cp
argument_list|)
end_macro

begin_decl_stmt
name|REG
name|STRING
modifier|*
name|cp
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|REG
name|CHAR
name|c
decl_stmt|;
name|INT
name|n
decl_stmt|;
name|n
operator|=
literal|0
expr_stmt|;
name|WHILE
argument_list|(
argument|(c = *(*cp)++)>=
literal|'0'
argument_list|)
name|ANDF
argument_list|(
argument|c<=
literal|'9'
argument_list|)
name|DO
name|n
init|=
name|n
operator|*
literal|10
operator|+
name|c
operator|-
literal|'0'
decl_stmt|;
name|OD
argument_list|(
operator|*
name|cp
argument_list|)
operator|--
expr_stmt|;
return|return
operator|(
name|n
operator|)
return|;
block|}
end_block

begin_macro
name|printnum
argument_list|(
argument|n
argument_list|,
argument|fmat
argument_list|,
argument|base
argument_list|)
end_macro

begin_decl_stmt
name|REG
name|INT
name|n
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|REG
name|CHAR
name|k
decl_stmt|;
name|REG
name|INT
modifier|*
name|dptr
decl_stmt|;
name|INT
name|digs
index|[
literal|15
index|]
decl_stmt|;
name|dptr
operator|=
name|digs
expr_stmt|;
name|IF
name|n
operator|<
literal|0
name|ANDF
name|fmat
operator|==
literal|'d'
name|THEN
name|n
operator|=
operator|-
name|n
expr_stmt|;
operator|*
name|digitptr
operator|++
operator|=
literal|'-'
expr_stmt|;
name|FI
name|WHILE
name|n
name|DO
operator|*
name|dptr
operator|++
operator|=
operator|(
operator|(
name|POS
operator|)
name|n
operator|)
operator|%
name|base
expr_stmt|;
name|n
operator|=
operator|(
operator|(
name|POS
operator|)
name|n
operator|)
operator|/
name|base
expr_stmt|;
name|OD
name|IF
name|dptr
operator|==
name|digs
name|THEN
operator|*
name|dptr
operator|++
operator|=
literal|0
expr_stmt|;
name|FI
name|WHILE
name|dptr
operator|!=
name|digs
name|DO
name|k
operator|=
operator|*
operator|--
name|dptr
expr_stmt|;
operator|*
name|digitptr
operator|++
operator|=
operator|(
name|k
operator|+
operator|(
name|k
operator|<=
literal|9
condition|?
literal|'0'
else|:
literal|'a'
operator|-
literal|10
operator|)
operator|)
expr_stmt|;
name|OD
block|}
end_block

begin_macro
name|printoct
argument_list|(
argument|o
argument_list|,
argument|s
argument_list|)
end_macro

begin_decl_stmt
name|L_INT
name|o
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|INT
name|s
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|INT
name|i
decl_stmt|;
name|L_INT
name|po
init|=
name|o
decl_stmt|;
name|CHAR
name|digs
index|[
literal|12
index|]
decl_stmt|;
name|IF
name|s
name|THEN
name|IF
name|po
operator|<
literal|0
name|THEN
name|po
operator|=
operator|-
name|po
expr_stmt|;
operator|*
name|digitptr
operator|++
operator|=
literal|'-'
expr_stmt|;
name|ELSE
name|IF
name|s
operator|>
literal|0
name|THEN
operator|*
name|digitptr
operator|++
operator|=
literal|'+'
expr_stmt|;
name|FI
name|FI
name|FI
name|FOR
name|i
init|=
literal|0
decl_stmt|;
name|i
operator|<=
literal|11
expr_stmt|;
name|i
operator|++
name|DO
name|digs
index|[
name|i
index|]
operator|=
name|po
operator|&
literal|7
expr_stmt|;
name|po
operator|=
operator|>>
literal|3
expr_stmt|;
name|OD
name|digs
index|[
literal|10
index|]
operator|&=
literal|03
expr_stmt|;
name|digs
index|[
literal|11
index|]
operator|=
literal|0
expr_stmt|;
name|FOR
name|i
init|=
literal|11
decl_stmt|;
name|i
operator|>=
literal|0
expr_stmt|;
name|i
operator|--
name|DO
name|IF
name|digs
index|[
name|i
index|]
name|THEN
break|break;
name|FI
name|OD
name|FOR
name|i
operator|++
expr_stmt|;
name|i
operator|>=
literal|0
expr_stmt|;
name|i
operator|--
name|DO
operator|*
name|digitptr
operator|++
operator|=
name|digs
index|[
name|i
index|]
operator|+
literal|'0'
expr_stmt|;
name|OD
block|}
end_block

begin_macro
name|printdbl
argument_list|(
argument|lx
argument_list|,
argument|ly
argument_list|,
argument|fmat
argument_list|,
argument|base
argument_list|)
end_macro

begin_decl_stmt
name|INT
name|lx
decl_stmt|,
name|ly
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
name|fmat
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|base
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|int
name|digs
index|[
literal|20
index|]
decl_stmt|;
name|int
modifier|*
name|dptr
decl_stmt|;
name|char
name|k
decl_stmt|;
name|L_REAL
name|f
decl_stmt|,
name|g
decl_stmt|;
name|long
name|q
decl_stmt|;
name|dptr
operator|=
name|digs
expr_stmt|;
name|IF
name|fmat
operator|!=
literal|'D'
name|THEN
name|f
operator|=
name|leng
argument_list|(
name|lx
argument_list|)
expr_stmt|;
name|f
operator|*=
name|itol
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|f
operator|+=
name|leng
argument_list|(
name|ly
argument_list|)
expr_stmt|;
name|IF
name|fmat
operator|==
literal|'x'
name|THEN
operator|*
name|digitptr
operator|++
operator|=
literal|'#'
expr_stmt|;
name|FI
name|ELSE
name|f
init|=
name|itol
argument_list|(
name|lx
argument_list|,
name|ly
argument_list|)
decl_stmt|;
name|IF
name|f
operator|<
literal|0
name|THEN
operator|*
name|digitptr
operator|++
operator|=
literal|'-'
expr_stmt|;
name|f
operator|=
operator|-
name|f
expr_stmt|;
name|FI
name|FI
name|WHILE
name|f
name|DO
name|q
init|=
name|f
operator|/
name|base
decl_stmt|;
name|g
operator|=
name|q
expr_stmt|;
operator|*
name|dptr
operator|++
operator|=
name|f
operator|-
name|g
operator|*
name|base
expr_stmt|;
name|f
operator|=
name|q
expr_stmt|;
name|OD
name|IF
name|dptr
operator|==
name|digs
name|THEN
operator|*
name|dptr
operator|++
operator|=
literal|0
expr_stmt|;
name|FI
name|WHILE
name|dptr
operator|!=
name|digs
name|DO
name|k
operator|=
operator|*
operator|--
name|dptr
expr_stmt|;
operator|*
name|digitptr
operator|++
operator|=
operator|(
name|k
operator|+
operator|(
name|k
operator|<=
literal|9
condition|?
literal|'0'
else|:
literal|'a'
operator|-
literal|10
operator|)
operator|)
expr_stmt|;
name|OD
block|}
end_block

begin_macro
name|iclose
argument_list|()
end_macro

begin_block
block|{
name|IF
name|infile
name|THEN
name|close
parameter_list|(
name|infile
parameter_list|)
function_decl|;
name|infile
operator|=
literal|0
expr_stmt|;
name|FI
block|}
end_block

begin_macro
name|oclose
argument_list|()
end_macro

begin_block
block|{
name|IF
name|outfile
operator|!=
literal|1
name|THEN
name|flushbuf
argument_list|()
expr_stmt|;
name|close
argument_list|(
name|outfile
argument_list|)
expr_stmt|;
name|outfile
operator|=
literal|1
expr_stmt|;
name|FI
block|}
end_block

begin_macro
name|endline
argument_list|()
end_macro

begin_block
block|{
name|IF
name|charpos
argument_list|()
operator|>=
name|maxpos
name|THEN
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|FI
block|}
end_block

end_unit

