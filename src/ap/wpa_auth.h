begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * hostapd - IEEE 802.11i-2004 / WPA Authenticator  * Copyright (c) 2004-2015, Jouni Malinen<j@w1.fi>  *  * This software may be distributed under the terms of the BSD license.  * See README for more details.  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|WPA_AUTH_H
end_ifndef

begin_define
define|#
directive|define
name|WPA_AUTH_H
end_define

begin_include
include|#
directive|include
file|"common/defs.h"
end_include

begin_include
include|#
directive|include
file|"common/eapol_common.h"
end_include

begin_include
include|#
directive|include
file|"common/wpa_common.h"
end_include

begin_include
include|#
directive|include
file|"common/ieee802_11_defs.h"
end_include

begin_define
define|#
directive|define
name|MAX_OWN_IE_OVERRIDE
value|256
end_define

begin_ifdef
ifdef|#
directive|ifdef
name|_MSC_VER
end_ifdef

begin_pragma
pragma|#
directive|pragma
name|pack
name|(
name|push
name|,
name|1
name|)
end_pragma

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* _MSC_VER */
end_comment

begin_comment
comment|/* IEEE Std 802.11r-2008, 11A.10.3 - Remote request/response frame definition  */
end_comment

begin_struct
struct|struct
name|ft_rrb_frame
block|{
name|u8
name|frame_type
decl_stmt|;
comment|/* RSN_REMOTE_FRAME_TYPE_FT_RRB */
name|u8
name|packet_type
decl_stmt|;
comment|/* FT_PACKET_REQUEST/FT_PACKET_RESPONSE */
name|le16
name|action_length
decl_stmt|;
comment|/* little endian length of action_frame */
name|u8
name|ap_address
index|[
name|ETH_ALEN
index|]
decl_stmt|;
comment|/* 	 * Followed by action_length bytes of FT Action frame (from Category 	 * field to the end of Action Frame body. 	 */
block|}
name|STRUCT_PACKED
struct|;
end_struct

begin_define
define|#
directive|define
name|RSN_REMOTE_FRAME_TYPE_FT_RRB
value|1
end_define

begin_define
define|#
directive|define
name|FT_PACKET_REQUEST
value|0
end_define

begin_define
define|#
directive|define
name|FT_PACKET_RESPONSE
value|1
end_define

begin_comment
comment|/* Vendor-specific types for R0KH-R1KH protocol; not defined in 802.11r */
end_comment

begin_define
define|#
directive|define
name|FT_PACKET_R0KH_R1KH_PULL
value|200
end_define

begin_define
define|#
directive|define
name|FT_PACKET_R0KH_R1KH_RESP
value|201
end_define

begin_define
define|#
directive|define
name|FT_PACKET_R0KH_R1KH_PUSH
value|202
end_define

begin_define
define|#
directive|define
name|FT_R0KH_R1KH_PULL_DATA_LEN
value|44
end_define

begin_define
define|#
directive|define
name|FT_R0KH_R1KH_RESP_DATA_LEN
value|76
end_define

begin_define
define|#
directive|define
name|FT_R0KH_R1KH_PUSH_DATA_LEN
value|88
end_define

begin_define
define|#
directive|define
name|FT_R0KH_R1KH_PULL_NONCE_LEN
value|16
end_define

begin_struct
struct|struct
name|ft_r0kh_r1kh_pull_frame
block|{
name|u8
name|frame_type
decl_stmt|;
comment|/* RSN_REMOTE_FRAME_TYPE_FT_RRB */
name|u8
name|packet_type
decl_stmt|;
comment|/* FT_PACKET_R0KH_R1KH_PULL */
name|le16
name|data_length
decl_stmt|;
comment|/* little endian length of data (44) */
name|u8
name|ap_address
index|[
name|ETH_ALEN
index|]
decl_stmt|;
name|u8
name|nonce
index|[
name|FT_R0KH_R1KH_PULL_NONCE_LEN
index|]
decl_stmt|;
name|u8
name|pmk_r0_name
index|[
name|WPA_PMK_NAME_LEN
index|]
decl_stmt|;
name|u8
name|r1kh_id
index|[
name|FT_R1KH_ID_LEN
index|]
decl_stmt|;
name|u8
name|s1kh_id
index|[
name|ETH_ALEN
index|]
decl_stmt|;
name|u8
name|pad
index|[
literal|4
index|]
decl_stmt|;
comment|/* 8-octet boundary for AES key wrap */
name|u8
name|key_wrap_extra
index|[
literal|8
index|]
decl_stmt|;
block|}
name|STRUCT_PACKED
struct|;
end_struct

begin_struct
struct|struct
name|ft_r0kh_r1kh_resp_frame
block|{
name|u8
name|frame_type
decl_stmt|;
comment|/* RSN_REMOTE_FRAME_TYPE_FT_RRB */
name|u8
name|packet_type
decl_stmt|;
comment|/* FT_PACKET_R0KH_R1KH_RESP */
name|le16
name|data_length
decl_stmt|;
comment|/* little endian length of data (76) */
name|u8
name|ap_address
index|[
name|ETH_ALEN
index|]
decl_stmt|;
name|u8
name|nonce
index|[
name|FT_R0KH_R1KH_PULL_NONCE_LEN
index|]
decl_stmt|;
comment|/* copied from pull */
name|u8
name|r1kh_id
index|[
name|FT_R1KH_ID_LEN
index|]
decl_stmt|;
comment|/* copied from pull */
name|u8
name|s1kh_id
index|[
name|ETH_ALEN
index|]
decl_stmt|;
comment|/* copied from pull */
name|u8
name|pmk_r1
index|[
name|PMK_LEN
index|]
decl_stmt|;
name|u8
name|pmk_r1_name
index|[
name|WPA_PMK_NAME_LEN
index|]
decl_stmt|;
name|le16
name|pairwise
decl_stmt|;
name|u8
name|pad
index|[
literal|2
index|]
decl_stmt|;
comment|/* 8-octet boundary for AES key wrap */
name|u8
name|key_wrap_extra
index|[
literal|8
index|]
decl_stmt|;
block|}
name|STRUCT_PACKED
struct|;
end_struct

begin_struct
struct|struct
name|ft_r0kh_r1kh_push_frame
block|{
name|u8
name|frame_type
decl_stmt|;
comment|/* RSN_REMOTE_FRAME_TYPE_FT_RRB */
name|u8
name|packet_type
decl_stmt|;
comment|/* FT_PACKET_R0KH_R1KH_PUSH */
name|le16
name|data_length
decl_stmt|;
comment|/* little endian length of data (88) */
name|u8
name|ap_address
index|[
name|ETH_ALEN
index|]
decl_stmt|;
comment|/* Encrypted with AES key-wrap */
name|u8
name|timestamp
index|[
literal|4
index|]
decl_stmt|;
comment|/* current time in seconds since unix epoch, little 			  * endian */
name|u8
name|r1kh_id
index|[
name|FT_R1KH_ID_LEN
index|]
decl_stmt|;
name|u8
name|s1kh_id
index|[
name|ETH_ALEN
index|]
decl_stmt|;
name|u8
name|pmk_r0_name
index|[
name|WPA_PMK_NAME_LEN
index|]
decl_stmt|;
name|u8
name|pmk_r1
index|[
name|PMK_LEN
index|]
decl_stmt|;
name|u8
name|pmk_r1_name
index|[
name|WPA_PMK_NAME_LEN
index|]
decl_stmt|;
name|le16
name|pairwise
decl_stmt|;
name|u8
name|pad
index|[
literal|6
index|]
decl_stmt|;
comment|/* 8-octet boundary for AES key wrap */
name|u8
name|key_wrap_extra
index|[
literal|8
index|]
decl_stmt|;
block|}
name|STRUCT_PACKED
struct|;
end_struct

begin_ifdef
ifdef|#
directive|ifdef
name|_MSC_VER
end_ifdef

begin_pragma
pragma|#
directive|pragma
name|pack
name|(
name|pop
name|)
end_pragma

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* _MSC_VER */
end_comment

begin_comment
comment|/* per STA state machine data */
end_comment

begin_struct_decl
struct_decl|struct
name|wpa_authenticator
struct_decl|;
end_struct_decl

begin_struct_decl
struct_decl|struct
name|wpa_state_machine
struct_decl|;
end_struct_decl

begin_struct_decl
struct_decl|struct
name|rsn_pmksa_cache_entry
struct_decl|;
end_struct_decl

begin_struct_decl
struct_decl|struct
name|eapol_state_machine
struct_decl|;
end_struct_decl

begin_struct
struct|struct
name|ft_remote_r0kh
block|{
name|struct
name|ft_remote_r0kh
modifier|*
name|next
decl_stmt|;
name|u8
name|addr
index|[
name|ETH_ALEN
index|]
decl_stmt|;
name|u8
name|id
index|[
name|FT_R0KH_ID_MAX_LEN
index|]
decl_stmt|;
name|size_t
name|id_len
decl_stmt|;
name|u8
name|key
index|[
literal|16
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|ft_remote_r1kh
block|{
name|struct
name|ft_remote_r1kh
modifier|*
name|next
decl_stmt|;
name|u8
name|addr
index|[
name|ETH_ALEN
index|]
decl_stmt|;
name|u8
name|id
index|[
name|FT_R1KH_ID_LEN
index|]
decl_stmt|;
name|u8
name|key
index|[
literal|16
index|]
decl_stmt|;
block|}
struct|;
end_struct

begin_struct
struct|struct
name|wpa_auth_config
block|{
name|int
name|wpa
decl_stmt|;
name|int
name|wpa_key_mgmt
decl_stmt|;
name|int
name|wpa_pairwise
decl_stmt|;
name|int
name|wpa_group
decl_stmt|;
name|int
name|wpa_group_rekey
decl_stmt|;
name|int
name|wpa_strict_rekey
decl_stmt|;
name|int
name|wpa_gmk_rekey
decl_stmt|;
name|int
name|wpa_ptk_rekey
decl_stmt|;
name|int
name|rsn_pairwise
decl_stmt|;
name|int
name|rsn_preauth
decl_stmt|;
name|int
name|eapol_version
decl_stmt|;
name|int
name|peerkey
decl_stmt|;
name|int
name|wmm_enabled
decl_stmt|;
name|int
name|wmm_uapsd
decl_stmt|;
name|int
name|disable_pmksa_caching
decl_stmt|;
name|int
name|okc
decl_stmt|;
name|int
name|tx_status
decl_stmt|;
ifdef|#
directive|ifdef
name|CONFIG_IEEE80211W
name|enum
name|mfp_options
name|ieee80211w
decl_stmt|;
name|int
name|group_mgmt_cipher
decl_stmt|;
endif|#
directive|endif
comment|/* CONFIG_IEEE80211W */
ifdef|#
directive|ifdef
name|CONFIG_IEEE80211R
name|u8
name|ssid
index|[
name|SSID_MAX_LEN
index|]
decl_stmt|;
name|size_t
name|ssid_len
decl_stmt|;
name|u8
name|mobility_domain
index|[
name|MOBILITY_DOMAIN_ID_LEN
index|]
decl_stmt|;
name|u8
name|r0_key_holder
index|[
name|FT_R0KH_ID_MAX_LEN
index|]
decl_stmt|;
name|size_t
name|r0_key_holder_len
decl_stmt|;
name|u8
name|r1_key_holder
index|[
name|FT_R1KH_ID_LEN
index|]
decl_stmt|;
name|u32
name|r0_key_lifetime
decl_stmt|;
name|u32
name|reassociation_deadline
decl_stmt|;
name|struct
name|ft_remote_r0kh
modifier|*
name|r0kh_list
decl_stmt|;
name|struct
name|ft_remote_r1kh
modifier|*
name|r1kh_list
decl_stmt|;
name|int
name|pmk_r1_push
decl_stmt|;
name|int
name|ft_over_ds
decl_stmt|;
endif|#
directive|endif
comment|/* CONFIG_IEEE80211R */
name|int
name|disable_gtk
decl_stmt|;
name|int
name|ap_mlme
decl_stmt|;
ifdef|#
directive|ifdef
name|CONFIG_TESTING_OPTIONS
name|double
name|corrupt_gtk_rekey_mic_probability
decl_stmt|;
name|u8
name|own_ie_override
index|[
name|MAX_OWN_IE_OVERRIDE
index|]
decl_stmt|;
name|size_t
name|own_ie_override_len
decl_stmt|;
endif|#
directive|endif
comment|/* CONFIG_TESTING_OPTIONS */
ifdef|#
directive|ifdef
name|CONFIG_P2P
name|u8
name|ip_addr_go
index|[
literal|4
index|]
decl_stmt|;
name|u8
name|ip_addr_mask
index|[
literal|4
index|]
decl_stmt|;
name|u8
name|ip_addr_start
index|[
literal|4
index|]
decl_stmt|;
name|u8
name|ip_addr_end
index|[
literal|4
index|]
decl_stmt|;
endif|#
directive|endif
comment|/* CONFIG_P2P */
block|}
struct|;
end_struct

begin_typedef
typedef|typedef
enum|enum
block|{
name|LOGGER_DEBUG
block|,
name|LOGGER_INFO
block|,
name|LOGGER_WARNING
block|}
name|logger_level
typedef|;
end_typedef

begin_typedef
typedef|typedef
enum|enum
block|{
name|WPA_EAPOL_portEnabled
block|,
name|WPA_EAPOL_portValid
block|,
name|WPA_EAPOL_authorized
block|,
name|WPA_EAPOL_portControl_Auto
block|,
name|WPA_EAPOL_keyRun
block|,
name|WPA_EAPOL_keyAvailable
block|,
name|WPA_EAPOL_keyDone
block|,
name|WPA_EAPOL_inc_EapolFramesTx
block|}
name|wpa_eapol_variable
typedef|;
end_typedef

begin_struct
struct|struct
name|wpa_auth_callbacks
block|{
name|void
modifier|*
name|ctx
decl_stmt|;
name|void
function_decl|(
modifier|*
name|logger
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|logger_level
name|level
parameter_list|,
specifier|const
name|char
modifier|*
name|txt
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|disconnect
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|u16
name|reason
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|mic_failure_report
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|psk_failure_report
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|)
function_decl|;
name|void
function_decl|(
modifier|*
name|set_eapol
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|wpa_eapol_variable
name|var
parameter_list|,
name|int
name|value
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|get_eapol
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|wpa_eapol_variable
name|var
parameter_list|)
function_decl|;
specifier|const
name|u8
modifier|*
function_decl|(
modifier|*
name|get_psk
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
specifier|const
name|u8
modifier|*
name|p2p_dev_addr
parameter_list|,
specifier|const
name|u8
modifier|*
name|prev_psk
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|get_msk
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|u8
modifier|*
name|msk
parameter_list|,
name|size_t
modifier|*
name|len
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|set_key
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
name|int
name|vlan_id
parameter_list|,
name|enum
name|wpa_alg
name|alg
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|int
name|idx
parameter_list|,
name|u8
modifier|*
name|key
parameter_list|,
name|size_t
name|key_len
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|get_seqnum
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|int
name|idx
parameter_list|,
name|u8
modifier|*
name|seq
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|send_eapol
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
specifier|const
name|u8
modifier|*
name|data
parameter_list|,
name|size_t
name|data_len
parameter_list|,
name|int
name|encrypt
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|for_each_sta
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
name|int
function_decl|(
modifier|*
name|cb
function_decl|)
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
name|void
modifier|*
name|ctx
parameter_list|)
parameter_list|,
name|void
modifier|*
name|cb_ctx
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|for_each_auth
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
name|int
function_decl|(
modifier|*
name|cb
function_decl|)
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|a
parameter_list|,
name|void
modifier|*
name|ctx
parameter_list|)
parameter_list|,
name|void
modifier|*
name|cb_ctx
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|send_ether
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
specifier|const
name|u8
modifier|*
name|dst
parameter_list|,
name|u16
name|proto
parameter_list|,
specifier|const
name|u8
modifier|*
name|data
parameter_list|,
name|size_t
name|data_len
parameter_list|)
function_decl|;
ifdef|#
directive|ifdef
name|CONFIG_IEEE80211R
name|struct
name|wpa_state_machine
modifier|*
function_decl|(
modifier|*
name|add_sta
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
specifier|const
name|u8
modifier|*
name|sta_addr
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|send_ft_action
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
specifier|const
name|u8
modifier|*
name|dst
parameter_list|,
specifier|const
name|u8
modifier|*
name|data
parameter_list|,
name|size_t
name|data_len
parameter_list|)
function_decl|;
name|int
function_decl|(
modifier|*
name|add_tspec
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
specifier|const
name|u8
modifier|*
name|sta_addr
parameter_list|,
name|u8
modifier|*
name|tspec_ie
parameter_list|,
name|size_t
name|tspec_ielen
parameter_list|)
function_decl|;
endif|#
directive|endif
comment|/* CONFIG_IEEE80211R */
ifdef|#
directive|ifdef
name|CONFIG_MESH
name|int
function_decl|(
modifier|*
name|start_ampe
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
specifier|const
name|u8
modifier|*
name|sta_addr
parameter_list|)
function_decl|;
endif|#
directive|endif
comment|/* CONFIG_MESH */
block|}
struct|;
end_struct

begin_function_decl
name|struct
name|wpa_authenticator
modifier|*
name|wpa_init
parameter_list|(
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
name|struct
name|wpa_auth_config
modifier|*
name|conf
parameter_list|,
name|struct
name|wpa_auth_callbacks
modifier|*
name|cb
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_init_keys
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_deinit
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_reconfig
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|,
name|struct
name|wpa_auth_config
modifier|*
name|conf
parameter_list|)
function_decl|;
end_function_decl

begin_enum
enum|enum
block|{
name|WPA_IE_OK
block|,
name|WPA_INVALID_IE
block|,
name|WPA_INVALID_GROUP
block|,
name|WPA_INVALID_PAIRWISE
block|,
name|WPA_INVALID_AKMP
block|,
name|WPA_NOT_ENABLED
block|,
name|WPA_ALLOC_FAIL
block|,
name|WPA_MGMT_FRAME_PROTECTION_VIOLATION
block|,
name|WPA_INVALID_MGMT_GROUP_CIPHER
block|,
name|WPA_INVALID_MDIE
block|,
name|WPA_INVALID_PROTO
block|}
enum|;
end_enum

begin_function_decl
name|int
name|wpa_validate_wpa_ie
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|,
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
specifier|const
name|u8
modifier|*
name|wpa_ie
parameter_list|,
name|size_t
name|wpa_ie_len
parameter_list|,
specifier|const
name|u8
modifier|*
name|mdie
parameter_list|,
name|size_t
name|mdie_len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_validate_osen
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|,
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
specifier|const
name|u8
modifier|*
name|osen_ie
parameter_list|,
name|size_t
name|osen_ie_len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_auth_uses_mfp
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|wpa_state_machine
modifier|*
name|wpa_auth_sta_init
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
specifier|const
name|u8
modifier|*
name|p2p_dev_addr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_auth_sta_associated
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|,
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_auth_sta_no_wpa
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_auth_sta_deinit
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_receive
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|,
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
name|u8
modifier|*
name|data
parameter_list|,
name|size_t
name|data_len
parameter_list|)
function_decl|;
end_function_decl

begin_enum
enum|enum
name|wpa_event
block|{
name|WPA_AUTH
block|,
name|WPA_ASSOC
block|,
name|WPA_DISASSOC
block|,
name|WPA_DEAUTH
block|,
name|WPA_REAUTH
block|,
name|WPA_REAUTH_EAPOL
block|,
name|WPA_ASSOC_FT
block|}
enum|;
end_enum

begin_function_decl
name|void
name|wpa_remove_ptk
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_auth_sm_event
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
name|enum
name|wpa_event
name|event
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_auth_sm_notify
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_gtk_rekey
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_get_mib
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|,
name|char
modifier|*
name|buf
parameter_list|,
name|size_t
name|buflen
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_get_mib_sta
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
name|char
modifier|*
name|buf
parameter_list|,
name|size_t
name|buflen
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_auth_countermeasures_start
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_auth_pairwise_set
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_auth_get_pairwise
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_auth_sta_key_mgmt
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_auth_sta_wpa_version
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_auth_sta_clear_pmksa
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
name|struct
name|rsn_pmksa_cache_entry
modifier|*
name|entry
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|struct
name|rsn_pmksa_cache_entry
modifier|*
name|wpa_auth_sta_get_pmksa
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_auth_sta_local_mic_failure_report
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|const
name|u8
modifier|*
name|wpa_auth_get_wpa_ie
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|,
name|size_t
modifier|*
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_auth_pmksa_add
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
specifier|const
name|u8
modifier|*
name|pmk
parameter_list|,
name|int
name|session_timeout
parameter_list|,
name|struct
name|eapol_state_machine
modifier|*
name|eapol
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_auth_pmksa_add_preauth
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|,
specifier|const
name|u8
modifier|*
name|pmk
parameter_list|,
name|size_t
name|len
parameter_list|,
specifier|const
name|u8
modifier|*
name|sta_addr
parameter_list|,
name|int
name|session_timeout
parameter_list|,
name|struct
name|eapol_state_machine
modifier|*
name|eapol
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_auth_pmksa_add_sae
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|,
specifier|const
name|u8
modifier|*
name|pmk
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_auth_pmksa_remove
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|,
specifier|const
name|u8
modifier|*
name|sta_addr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_auth_sta_set_vlan
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
name|int
name|vlan_id
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_auth_eapol_key_tx_status
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|,
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
name|int
name|ack
parameter_list|)
function_decl|;
end_function_decl

begin_ifdef
ifdef|#
directive|ifdef
name|CONFIG_IEEE80211R
end_ifdef

begin_function_decl
name|u8
modifier|*
name|wpa_sm_write_assoc_resp_ies
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
name|u8
modifier|*
name|pos
parameter_list|,
name|size_t
name|max_len
parameter_list|,
name|int
name|auth_alg
parameter_list|,
specifier|const
name|u8
modifier|*
name|req_ies
parameter_list|,
name|size_t
name|req_ies_len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_ft_process_auth
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
specifier|const
name|u8
modifier|*
name|bssid
parameter_list|,
name|u16
name|auth_transaction
parameter_list|,
specifier|const
name|u8
modifier|*
name|ies
parameter_list|,
name|size_t
name|ies_len
parameter_list|,
name|void
function_decl|(
modifier|*
name|cb
function_decl|)
parameter_list|(
name|void
modifier|*
name|ctx
parameter_list|,
specifier|const
name|u8
modifier|*
name|dst
parameter_list|,
specifier|const
name|u8
modifier|*
name|bssid
parameter_list|,
name|u16
name|auth_transaction
parameter_list|,
name|u16
name|resp
parameter_list|,
specifier|const
name|u8
modifier|*
name|ies
parameter_list|,
name|size_t
name|ies_len
parameter_list|)
parameter_list|,
name|void
modifier|*
name|ctx
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|u16
name|wpa_ft_validate_reassoc
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
specifier|const
name|u8
modifier|*
name|ies
parameter_list|,
name|size_t
name|ies_len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_ft_action_rx
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
specifier|const
name|u8
modifier|*
name|data
parameter_list|,
name|size_t
name|len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_ft_rrb_rx
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|,
specifier|const
name|u8
modifier|*
name|src_addr
parameter_list|,
specifier|const
name|u8
modifier|*
name|data
parameter_list|,
name|size_t
name|data_len
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_ft_push_pmk_r1
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|,
specifier|const
name|u8
modifier|*
name|addr
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* CONFIG_IEEE80211R */
end_comment

begin_function_decl
name|void
name|wpa_wnmsleep_rekey_gtk
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_set_wnmsleep
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
name|int
name|flag
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_wnmsleep_gtk_subelem
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
name|u8
modifier|*
name|pos
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_wnmsleep_igtk_subelem
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
name|u8
modifier|*
name|pos
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_auth_uses_sae
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_auth_uses_ft_sae
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|wpa_auth_get_ip_addr
parameter_list|(
name|struct
name|wpa_state_machine
modifier|*
name|sm
parameter_list|,
name|u8
modifier|*
name|addr
parameter_list|)
function_decl|;
end_function_decl

begin_struct_decl
struct_decl|struct
name|radius_das_attrs
struct_decl|;
end_struct_decl

begin_function_decl
name|int
name|wpa_auth_radius_das_disconnect_pmksa
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|,
name|struct
name|radius_das_attrs
modifier|*
name|attr
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|wpa_auth_reconfig_group_keys
parameter_list|(
name|struct
name|wpa_authenticator
modifier|*
name|wpa_auth
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* WPA_AUTH_H */
end_comment

end_unit

