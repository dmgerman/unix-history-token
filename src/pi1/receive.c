begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* Copyright (c) 1979 Regents of the University of California */
end_comment

begin_include
include|#
directive|include
file|"0.h"
end_include

begin_include
include|#
directive|include
file|"send.h"
end_include

begin_include
include|#
directive|include
file|"tree.h"
end_include

begin_comment
comment|/*  * Pi - Pascal interpreter code translator  *  * Bill Joy UCB February 6, 1978  */
end_comment

begin_decl_stmt
name|int
name|fp2
index|[
name|DSPLYSZ
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|pin
index|[
literal|259
index|]
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Unit 0 */
end_comment

begin_decl_stmt
name|int
name|ackd
decl_stmt|,
name|acker
decl_stmt|;
end_decl_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|DEBUG
end_ifdef

begin_decl_stmt
specifier|extern
name|char
modifier|*
name|trnames
index|[]
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
specifier|extern
name|int
modifier|*
name|spacep
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|char
name|printed
decl_stmt|,
name|hadsome
decl_stmt|,
modifier|*
name|lastname
decl_stmt|,
modifier|*
name|obj
decl_stmt|;
end_decl_stmt

begin_ifdef
ifdef|#
directive|ifdef
name|DEBUG
end_ifdef

begin_decl_stmt
name|char
modifier|*
name|rnames
index|[]
block|{
literal|""
operator|,
literal|"RINIT"
operator|,
literal|"RENQ"
operator|,
literal|"RTREE"
operator|,
literal|"RTRFREE"
operator|,
literal|"RTRCHK"
operator|,
literal|"REVENIT"
operator|,
literal|"RSTRING"
operator|,
literal|"REVLAB"
operator|,
literal|"REVCNST"
operator|,
literal|"REVTBEG"
operator|,
literal|"REVTYPE"
operator|,
literal|"REVTEND"
operator|,
literal|"REVVBEG"
operator|,
literal|"REVVAR"
operator|,
literal|"REVVEND"
operator|,
literal|"REVFHDR"
operator|,
literal|"REVFFWD"
operator|,
literal|"REVFBDY"
operator|,
literal|"REVFEND"
operator|,
literal|"ROPUSH"
operator|,
literal|"ROPOP"
operator|,
literal|"ROSET"
operator|,
literal|"RKILL"
operator|,
literal|"RFINISH"
operator|,
block|}
end_decl_stmt

begin_empty_stmt
empty_stmt|;
end_empty_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_define
define|#
directive|define
name|getaw
parameter_list|()
value|getw(pin)
end_define

begin_define
define|#
directive|define
name|getac
parameter_list|()
value|getc(pin)
end_define

begin_define
define|#
directive|define
name|sgetaw
parameter_list|()
value|sreloc(getaw())
end_define

begin_define
define|#
directive|define
name|tgetaw
parameter_list|()
value|treloc(getaw())
end_define

begin_macro
name|receive
argument_list|()
end_macro

begin_block
block|{
specifier|register
name|int
name|i
decl_stmt|,
modifier|*
name|ip
decl_stmt|;
specifier|register
name|char
modifier|*
name|cp
decl_stmt|;
define|#
directive|define
name|TREENMAX
value|6
comment|/* From tree.c */
name|int
name|loctree
index|[
name|TREENMAX
operator|*
literal|2
index|]
decl_stmt|,
name|locstring
index|[
literal|514
index|]
decl_stmt|;
name|int
name|ch
decl_stmt|,
name|j
decl_stmt|;
for|for
control|(
init|;
condition|;
control|)
block|{
name|i
operator|=
name|getac
argument_list|()
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
if|if
condition|(
name|i
operator|>
literal|0
operator|&&
name|i
operator|<=
name|RLAST
condition|)
name|dprintf
argument_list|(
literal|"%s\t"
argument_list|,
name|rnames
index|[
name|i
index|]
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|i
operator|==
operator|-
literal|1
condition|)
name|dprintf
argument_list|(
literal|"EOF\t"
argument_list|)
expr_stmt|;
else|else
name|dprintf
argument_list|(
literal|"OOPS!\t"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|holdderr
operator|=
literal|1
expr_stmt|;
switch|switch
condition|(
name|i
condition|)
block|{
case|case
name|RINIT
case|:
name|lastname
operator|=
name|sreloc
argument_list|(
name|getaw
argument_list|()
argument_list|)
expr_stmt|;
name|obj
operator|=
name|sreloc
argument_list|(
name|getaw
argument_list|()
argument_list|)
expr_stmt|;
name|ackd
operator|=
name|getac
argument_list|()
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|26
condition|;
name|i
operator|++
control|)
name|opts
index|[
name|i
index|]
operator|=
name|getac
argument_list|()
expr_stmt|;
name|efil
operator|=
name|getac
argument_list|()
expr_stmt|;
name|errfile
operator|=
name|sreloc
argument_list|(
name|getaw
argument_list|()
argument_list|)
expr_stmt|;
name|ofil
operator|=
name|getac
argument_list|()
expr_stmt|;
name|magic
argument_list|()
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"RINIT\n\t"
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|"lastname \"%s\"\n\t"
argument_list|,
name|lastname
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|"ackd %d\n\t"
argument_list|,
name|ackd
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|"options: "
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|26
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|opts
index|[
name|i
index|]
condition|)
if|if
condition|(
name|i
operator|==
literal|1
condition|)
name|dprintf
argument_list|(
literal|"b%d "
argument_list|,
name|opts
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
else|else
name|dprintf
argument_list|(
literal|"%c "
argument_list|,
name|i
operator|+
literal|'a'
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|"\n\tefil %d\n"
argument_list|,
name|efil
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|"\terrfile \"%s\"\n"
argument_list|,
name|errfile
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|"\tofil %d\n"
argument_list|,
name|ofil
argument_list|)
expr_stmt|;
endif|#
directive|endif
break|break;
case|case
name|RENQ
case|:
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"\tACK\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|ack
argument_list|()
expr_stmt|;
break|break;
case|case
name|RTREE
case|:
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"%d "
argument_list|,
name|toffset
argument_list|(
name|spacep
argument_list|)
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|i
operator|=
name|getac
argument_list|()
expr_stmt|;
if|if
condition|(
name|i
operator|<
literal|0
operator|||
name|i
operator|>
name|T_LAST
condition|)
block|{
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"\tBAD: %d\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|panic
argument_list|(
literal|"recv RTREE"
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
name|cp
operator|=
name|trdesc
index|[
name|i
index|]
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"\t%s:"
argument_list|,
name|trnames
index|[
name|i
index|]
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|ip
operator|=
name|loctree
expr_stmt|;
operator|*
name|ip
operator|++
operator|=
name|i
expr_stmt|;
name|j
operator|=
literal|1
expr_stmt|;
while|while
condition|(
operator|*
name|cp
condition|)
block|{
name|j
operator|++
expr_stmt|;
switch|switch
condition|(
operator|*
name|cp
operator|++
condition|)
block|{
case|case
literal|'s'
case|:
name|cp
operator|=
name|locstring
expr_stmt|;
name|i
operator|=
literal|512
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|" \""
argument_list|)
expr_stmt|;
endif|#
directive|endif
while|while
condition|(
operator|(
name|ch
operator|=
name|getac
argument_list|()
operator|)
operator|&&
name|ch
operator|!=
operator|-
literal|1
condition|)
block|{
if|if
condition|(
operator|--
name|i
operator|==
literal|0
condition|)
name|panic
argument_list|(
literal|"RTREE case s"
argument_list|)
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
name|ch
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"%c"
argument_list|,
name|ch
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"\"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
operator|*
name|cp
operator|++
operator|=
literal|0
expr_stmt|;
name|copystr
argument_list|(
name|locstring
argument_list|)
expr_stmt|;
goto|goto
name|out
goto|;
case|case
literal|'d'
case|:
operator|*
name|ip
operator|++
operator|=
name|getac
argument_list|()
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|" d%d"
argument_list|,
name|ip
index|[
operator|-
literal|1
index|]
argument_list|)
expr_stmt|;
endif|#
directive|endif
continue|continue;
case|case
literal|'n'
case|:
operator|*
name|ip
operator|++
operator|=
name|getaw
argument_list|()
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|" n%d"
argument_list|,
name|ip
index|[
operator|-
literal|1
index|]
argument_list|)
expr_stmt|;
endif|#
directive|endif
continue|continue;
case|case
literal|'"'
case|:
operator|*
name|ip
operator|++
operator|=
name|sreloc
argument_list|(
name|getaw
argument_list|()
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
if|if
condition|(
name|ip
index|[
operator|-
literal|1
index|]
operator|==
name|NIL
condition|)
name|dprintf
argument_list|(
literal|" NIL\""
argument_list|)
expr_stmt|;
else|else
name|dprintf
argument_list|(
literal|" \"%s\""
argument_list|,
name|ip
index|[
operator|-
literal|1
index|]
argument_list|)
expr_stmt|;
endif|#
directive|endif
continue|continue;
case|case
literal|'p'
case|:
operator|*
name|ip
operator|++
operator|=
name|treloc
argument_list|(
name|getaw
argument_list|()
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dptree
argument_list|(
name|ip
index|[
operator|-
literal|1
index|]
argument_list|)
expr_stmt|;
endif|#
directive|endif
continue|continue;
block|}
block|}
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|treev
argument_list|(
name|j
argument_list|,
name|loctree
argument_list|)
expr_stmt|;
name|out
label|:
break|break;
case|case
name|RTRCHK
case|:
name|i
operator|=
name|getaw
argument_list|()
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|" %d\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
if|if
condition|(
name|i
operator|!=
name|toffset
argument_list|(
name|spacep
argument_list|)
condition|)
name|dprintf
argument_list|(
literal|"trchk %d, have %d\n"
argument_list|,
name|i
argument_list|,
name|toffset
argument_list|(
name|spacep
argument_list|)
argument_list|)
expr_stmt|;
endif|#
directive|endif
break|break;
case|case
name|RTRFREE
case|:
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"\t%d\n"
argument_list|,
name|toffset
argument_list|(
name|spacep
argument_list|)
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|trfree
argument_list|()
expr_stmt|;
break|break;
case|case
name|REVTBEG
case|:
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|typebeg
argument_list|()
expr_stmt|;
break|break;
case|case
name|REVTEND
case|:
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|typeend
argument_list|()
expr_stmt|;
break|break;
case|case
name|REVVBEG
case|:
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|varbeg
argument_list|()
expr_stmt|;
break|break;
case|case
name|REVVEND
case|:
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|varend
argument_list|()
expr_stmt|;
break|break;
case|case
name|REVENIT
case|:
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|evenit
argument_list|()
expr_stmt|;
break|break;
case|case
name|RSTRING
case|:
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|" \""
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|cp
operator|=
name|locstring
expr_stmt|;
name|i
operator|=
literal|512
expr_stmt|;
while|while
condition|(
operator|(
name|ch
operator|=
name|getac
argument_list|()
operator|)
operator|&&
name|ch
operator|!=
operator|-
literal|1
condition|)
block|{
if|if
condition|(
operator|--
name|i
operator|==
literal|0
condition|)
name|panic
argument_list|(
literal|"RSTRING length"
argument_list|)
expr_stmt|;
operator|*
name|cp
operator|++
operator|=
name|ch
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"%c"
argument_list|,
name|ch
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"\"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
operator|*
name|cp
operator|++
operator|=
literal|0
expr_stmt|;
name|savestr
argument_list|(
name|locstring
argument_list|)
expr_stmt|;
break|break;
case|case
name|REVLAB
case|:
name|loctree
index|[
literal|0
index|]
operator|=
name|treloc
argument_list|(
name|getaw
argument_list|()
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dptree
argument_list|(
name|loctree
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|label
argument_list|(
name|loctree
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|REVCNST
case|:
name|loctree
index|[
literal|0
index|]
operator|=
name|getaw
argument_list|()
expr_stmt|;
name|loctree
index|[
literal|1
index|]
operator|=
name|sreloc
argument_list|(
name|getaw
argument_list|()
argument_list|)
expr_stmt|;
name|loctree
index|[
literal|2
index|]
operator|=
name|treloc
argument_list|(
name|getaw
argument_list|()
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|" %d"
argument_list|,
name|loctree
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|" \"%s\""
argument_list|,
name|loctree
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|dptree
argument_list|(
name|loctree
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
specifier|const
operator|(
name|loctree
index|[
literal|0
index|]
operator|,
name|loctree
index|[
literal|1
index|]
operator|,
name|loctree
index|[
literal|2
index|]
operator|)
expr_stmt|;
break|break;
case|case
name|REVTYPE
case|:
name|loctree
index|[
literal|0
index|]
operator|=
name|getaw
argument_list|()
expr_stmt|;
name|loctree
index|[
literal|1
index|]
operator|=
name|sreloc
argument_list|(
name|getaw
argument_list|()
argument_list|)
expr_stmt|;
name|loctree
index|[
literal|2
index|]
operator|=
name|treloc
argument_list|(
name|getaw
argument_list|()
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|" %d"
argument_list|,
name|loctree
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|" \"%s\""
argument_list|,
name|loctree
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|dptree
argument_list|(
name|loctree
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|type
argument_list|(
name|loctree
index|[
literal|0
index|]
argument_list|,
name|loctree
index|[
literal|1
index|]
argument_list|,
name|loctree
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|REVVAR
case|:
name|loctree
index|[
literal|0
index|]
operator|=
name|getaw
argument_list|()
expr_stmt|;
name|loctree
index|[
literal|1
index|]
operator|=
name|treloc
argument_list|(
name|getaw
argument_list|()
argument_list|)
expr_stmt|;
name|loctree
index|[
literal|2
index|]
operator|=
name|treloc
argument_list|(
name|getaw
argument_list|()
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|" %d"
argument_list|,
name|loctree
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|dptree
argument_list|(
name|loctree
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|dptree
argument_list|(
name|loctree
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|var
argument_list|(
name|loctree
index|[
literal|0
index|]
argument_list|,
name|loctree
index|[
literal|1
index|]
argument_list|,
name|loctree
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|REVFHDR
case|:
name|loctree
index|[
literal|0
index|]
operator|=
name|treloc
argument_list|(
name|getaw
argument_list|()
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dptree
argument_list|(
name|loctree
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|fp2
index|[
name|cbn
index|]
operator|=
name|funchdr
argument_list|(
name|loctree
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|REVFBDY
case|:
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|funcbody
argument_list|(
name|fp2
index|[
name|cbn
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|REVFEND
case|:
name|holdderr
operator|=
literal|0
expr_stmt|;
name|loctree
index|[
literal|0
index|]
operator|=
name|treloc
argument_list|(
name|getaw
argument_list|()
argument_list|)
expr_stmt|;
name|loctree
index|[
literal|1
index|]
operator|=
name|getaw
argument_list|()
expr_stmt|;
name|loctree
index|[
literal|2
index|]
operator|=
name|getaw
argument_list|()
expr_stmt|;
name|lastname
operator|=
name|sreloc
argument_list|(
name|getaw
argument_list|()
argument_list|)
expr_stmt|;
name|filename
operator|=
name|sreloc
argument_list|(
name|getaw
argument_list|()
argument_list|)
expr_stmt|;
name|printed
operator|=
name|getac
argument_list|()
expr_stmt|;
name|hadsome
operator|=
name|getac
argument_list|()
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dptree
argument_list|(
name|loctree
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|" %d"
argument_list|,
name|loctree
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|" %d"
argument_list|,
name|loctree
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|" lastname=%s"
argument_list|,
name|lastname
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|" filename=%s"
argument_list|,
name|filename
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|" printed=%d"
argument_list|,
name|printed
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|" hadsome=%d"
argument_list|,
name|hadsome
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|funcend
argument_list|(
name|fp2
index|[
name|cbn
operator|-
literal|1
index|]
argument_list|,
name|loctree
index|[
literal|0
index|]
argument_list|,
name|loctree
index|[
literal|1
index|]
argument_list|,
name|loctree
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|ROPUSH
case|:
name|i
operator|=
name|getaw
argument_list|()
expr_stmt|;
name|opush
argument_list|(
name|i
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|" %c\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
endif|#
directive|endif
break|break;
case|case
name|ROPOP
case|:
name|i
operator|=
name|getaw
argument_list|()
expr_stmt|;
name|opop
argument_list|(
name|i
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|" %c\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
endif|#
directive|endif
break|break;
case|case
name|ROSET
case|:
name|ch
operator|=
name|getac
argument_list|()
expr_stmt|;
name|i
operator|=
name|getaw
argument_list|()
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|" %c="
argument_list|,
name|ch
argument_list|)
expr_stmt|;
name|dprintf
argument_list|(
literal|"%d\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|opt
argument_list|(
name|ch
argument_list|)
operator|=
name|i
expr_stmt|;
break|break;
case|case
name|RKILL
case|:
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"I should be dead!\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|panic
argument_list|(
literal|"RKILL"
argument_list|)
expr_stmt|;
break|break;
case|case
name|RFINISH
case|:
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|magic2
argument_list|()
expr_stmt|;
name|write
argument_list|(
name|ackd
argument_list|,
operator|&
name|eflg
argument_list|,
literal|2
argument_list|)
expr_stmt|;
break|break;
case|case
operator|-
literal|1
case|:
name|ack
argument_list|()
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"\nEXIT\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|exit
argument_list|(
literal|0
argument_list|)
expr_stmt|;
default|default:
ifdef|#
directive|ifdef
name|DEBUG
name|dprintf
argument_list|(
literal|"CODE=%d\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|panic
argument_list|(
literal|"rcv CODE"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_block

begin_macro
name|ack
argument_list|()
end_macro

begin_block
block|{
extern|extern Fp;
name|int
name|i
index|[
literal|3
index|]
decl_stmt|;
name|i
index|[
literal|0
index|]
operator|=
name|lastname
expr_stmt|;
name|i
index|[
literal|1
index|]
operator|=
name|Fp
expr_stmt|;
name|i
index|[
literal|2
index|]
operator|=
operator|(
name|hadsome
operator|<<
literal|8
operator|)
operator||
name|printed
expr_stmt|;
name|write
argument_list|(
name|ackd
argument_list|,
name|i
argument_list|,
literal|6
argument_list|)
expr_stmt|;
block|}
end_block

begin_ifdef
ifdef|#
directive|ifdef
name|DEBUG
end_ifdef

begin_macro
name|dprintf
argument_list|(
argument|a1
argument_list|,
argument|a2
argument_list|,
argument|a3
argument_list|,
argument|a4
argument_list|,
argument|a5
argument_list|)
end_macro

begin_block
block|{
if|if
condition|(
name|opt
argument_list|(
literal|'d'
argument_list|)
condition|)
name|printf
argument_list|(
name|a1
argument_list|,
name|a2
argument_list|,
name|a3
argument_list|,
name|a4
argument_list|,
name|a5
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|dptree
argument_list|(
argument|j
argument_list|)
end_macro

begin_decl_stmt
name|int
name|j
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|int
name|i
decl_stmt|;
name|i
operator|=
name|toffset
argument_list|(
name|j
argument_list|)
expr_stmt|;
if|if
condition|(
name|i
operator|>=
name|ITREE
condition|)
name|dprintf
argument_list|(
literal|" p%d"
argument_list|,
name|i
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|i
operator|==
literal|0
condition|)
name|dprintf
argument_list|(
literal|" NIL"
argument_list|)
expr_stmt|;
else|else
name|dprintf
argument_list|(
literal|"  \"%s\""
argument_list|,
name|j
argument_list|)
expr_stmt|;
block|}
end_block

begin_endif
endif|#
directive|endif
end_endif

end_unit

