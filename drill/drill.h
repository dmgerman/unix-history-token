begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * drill.h  * the main header file of drill  * (c) 2005, 2006 NLnet Labs  *  * See the file LICENSE for the license  *  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|_DRILL_H_
end_ifndef

begin_define
define|#
directive|define
name|_DRILL_H_
end_define

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|"drill_util.h"
end_include

begin_define
define|#
directive|define
name|DRILL_VERSION
value|PACKAGE_VERSION
end_define

begin_comment
comment|/* what kind of stuff do we allow */
end_comment

begin_define
define|#
directive|define
name|DRILL_QUERY
value|0
end_define

begin_define
define|#
directive|define
name|DRILL_TRACE
value|1
end_define

begin_define
define|#
directive|define
name|DRILL_CHASE
value|2
end_define

begin_define
define|#
directive|define
name|DRILL_AFROMFILE
value|3
end_define

begin_define
define|#
directive|define
name|DRILL_QTOFILE
value|4
end_define

begin_define
define|#
directive|define
name|DRILL_NSEC
value|5
end_define

begin_define
define|#
directive|define
name|DRILL_REVERSE
value|6
end_define

begin_define
define|#
directive|define
name|DRILL_SECTRACE
value|7
end_define

begin_define
define|#
directive|define
name|DRILL_ON
parameter_list|(
name|VAR
parameter_list|,
name|BIT
parameter_list|)
define|\
value|(VAR) = (VAR) | (BIT)
end_define

begin_define
define|#
directive|define
name|DRILL_OFF
parameter_list|(
name|VAR
parameter_list|,
name|BIT
parameter_list|)
define|\
value|(VAR) = (VAR)& ~(BIT)
end_define

begin_decl_stmt
specifier|extern
name|ldns_rr_list
modifier|*
name|global_dns_root
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|bool
name|qds
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|int
name|verbosity
decl_stmt|;
end_decl_stmt

begin_function_decl
name|ldns_pkt
modifier|*
name|do_trace
parameter_list|(
name|ldns_resolver
modifier|*
name|res
parameter_list|,
name|ldns_rdf
modifier|*
name|name
parameter_list|,
name|ldns_rr_type
name|type
parameter_list|,
name|ldns_rr_class
name|c
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ldns_status
name|do_chase
parameter_list|(
name|ldns_resolver
modifier|*
name|res
parameter_list|,
name|ldns_rdf
modifier|*
name|name
parameter_list|,
name|ldns_rr_type
name|type
parameter_list|,
name|ldns_rr_class
name|c
parameter_list|,
name|ldns_rr_list
modifier|*
name|trusted_keys
parameter_list|,
name|ldns_pkt
modifier|*
name|pkt_o
parameter_list|,
name|uint16_t
name|qflags
parameter_list|,
name|ldns_rr_list
modifier|*
name|prev_key_list
parameter_list|,
name|int
name|verbosity
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|do_secure_trace
parameter_list|(
name|ldns_resolver
modifier|*
name|res
parameter_list|,
name|ldns_rdf
modifier|*
name|name
parameter_list|,
name|ldns_rr_type
name|type
parameter_list|,
name|ldns_rr_class
name|c
parameter_list|,
name|ldns_rr_list
modifier|*
name|trusted_keys
parameter_list|,
name|ldns_rdf
modifier|*
name|start_name
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ldns_rr_list
modifier|*
name|get_rr
parameter_list|(
name|ldns_resolver
modifier|*
name|res
parameter_list|,
name|ldns_rdf
modifier|*
name|zname
parameter_list|,
name|ldns_rr_type
name|t
parameter_list|,
name|ldns_rr_class
name|c
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|drill_pkt_print
parameter_list|(
name|FILE
modifier|*
name|fd
parameter_list|,
name|ldns_resolver
modifier|*
name|r
parameter_list|,
name|ldns_pkt
modifier|*
name|p
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|drill_pkt_print_footer
parameter_list|(
name|FILE
modifier|*
name|fd
parameter_list|,
name|ldns_resolver
modifier|*
name|r
parameter_list|,
name|ldns_pkt
modifier|*
name|p
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ldns_pkt_type
name|get_dnssec_rr
parameter_list|(
name|ldns_pkt
modifier|*
name|p
parameter_list|,
name|ldns_rdf
modifier|*
name|name
parameter_list|,
name|ldns_rr_type
name|t
parameter_list|,
name|ldns_rr_list
modifier|*
modifier|*
name|rrlist
parameter_list|,
name|ldns_rr_list
modifier|*
modifier|*
name|sig
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ldns_rr
modifier|*
name|ldns_nsec3_exact_match
parameter_list|(
name|ldns_rdf
modifier|*
name|qname
parameter_list|,
name|ldns_rr_type
name|qtype
parameter_list|,
name|ldns_rr_list
modifier|*
name|nsec3s
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ldns_rdf
modifier|*
name|ldns_nsec3_closest_encloser
parameter_list|(
name|ldns_rdf
modifier|*
name|qname
parameter_list|,
name|ldns_rr_type
name|qtype
parameter_list|,
name|ldns_rr_list
modifier|*
name|nsec3s
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* verifies denial of existence of *name in *pkt (must contain NSEC or NSEC3 records  * if *nsec_rrs and *nsec_rr_sigs are given, pointers to the relevant nsecs and their signatures are  * placed there  */
end_comment

begin_function_decl
name|ldns_status
name|ldns_verify_denial
parameter_list|(
name|ldns_pkt
modifier|*
name|pkt
parameter_list|,
name|ldns_rdf
modifier|*
name|name
parameter_list|,
name|ldns_rr_type
name|type
parameter_list|,
name|ldns_rr_list
modifier|*
modifier|*
name|nsec_rrs
parameter_list|,
name|ldns_rr_list
modifier|*
modifier|*
name|nsec_rr_sigs
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ldns_status
name|read_key_file
parameter_list|(
specifier|const
name|char
modifier|*
name|filename
parameter_list|,
name|ldns_rr_list
modifier|*
name|key_list
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ldns_pkt
modifier|*
name|read_hex_pkt
parameter_list|(
name|char
modifier|*
name|filename
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ldns_buffer
modifier|*
name|read_hex_buffer
parameter_list|(
name|char
modifier|*
name|filename
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|init_root
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|ldns_rr_list
modifier|*
name|read_root_hints
parameter_list|(
specifier|const
name|char
modifier|*
name|filename
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|clear_root
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|dump_hex
parameter_list|(
specifier|const
name|ldns_pkt
modifier|*
name|pkt
parameter_list|,
specifier|const
name|char
modifier|*
name|file
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|warning
parameter_list|(
specifier|const
name|char
modifier|*
name|fmt
parameter_list|,
modifier|...
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|error
parameter_list|(
specifier|const
name|char
modifier|*
name|fmt
parameter_list|,
modifier|...
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|mesg
parameter_list|(
specifier|const
name|char
modifier|*
name|fmt
parameter_list|,
modifier|...
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* screen.c */
end_comment

begin_function_decl
name|void
name|resolver_print_nameservers
parameter_list|(
name|ldns_resolver
modifier|*
name|r
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|print_dnskey
parameter_list|(
name|ldns_rr_list
modifier|*
name|key_list
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|print_ds
parameter_list|(
name|ldns_rr_list
modifier|*
name|ds_list
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* _DRILL_H_ */
end_comment

end_unit

