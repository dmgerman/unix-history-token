begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* This is a generated file */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|__kadm5_private_h__
end_ifndef

begin_define
define|#
directive|define
name|__kadm5_private_h__
end_define

begin_include
include|#
directive|include
file|<stdarg.h>
end_include

begin_function_decl
name|kadm5_ret_t
name|_kadm5_acl_check_permission
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|,
name|unsigned
comment|/*op*/
parameter_list|,
name|krb5_const_principal
comment|/*princ*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_acl_init
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_bump_pw_expire
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|,
name|hdb_entry
modifier|*
comment|/*ent*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_error_code
name|_kadm5_c_get_cred_cache
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*client_name*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*server_name*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*password*/
parameter_list|,
name|krb5_prompter_fct
comment|/*prompter*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*keytab*/
parameter_list|,
name|krb5_ccache
comment|/*ccache*/
parameter_list|,
name|krb5_ccache
modifier|*
comment|/*ret_cache*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_c_init_context
parameter_list|(
name|kadm5_client_context
modifier|*
modifier|*
comment|/*ctx*/
parameter_list|,
name|kadm5_config_params
modifier|*
comment|/*params*/
parameter_list|,
name|krb5_context
comment|/*context*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_client_recv
parameter_list|(
name|kadm5_client_context
modifier|*
comment|/*context*/
parameter_list|,
name|krb5_data
modifier|*
comment|/*reply*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_client_send
parameter_list|(
name|kadm5_client_context
modifier|*
comment|/*context*/
parameter_list|,
name|krb5_storage
modifier|*
comment|/*sp*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|int
name|_kadm5_cmp_keys
parameter_list|(
name|Key
modifier|*
comment|/*keys1*/
parameter_list|,
name|int
comment|/*len1*/
parameter_list|,
name|Key
modifier|*
comment|/*keys2*/
parameter_list|,
name|int
comment|/*len2*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_connect
parameter_list|(
name|void
modifier|*
comment|/*handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_error_code
parameter_list|(
name|kadm5_ret_t
comment|/*code*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|_kadm5_free_keys
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|int
comment|/*len*/
parameter_list|,
name|Key
modifier|*
comment|/*keys*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|_kadm5_init_keys
parameter_list|(
name|Key
modifier|*
comment|/*keys*/
parameter_list|,
name|int
comment|/*len*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_marshal_params
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|kadm5_config_params
modifier|*
comment|/*params*/
parameter_list|,
name|krb5_data
modifier|*
comment|/*out*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_privs_to_string
parameter_list|(
name|uint32_t
comment|/*privs*/
parameter_list|,
name|char
modifier|*
comment|/*string*/
parameter_list|,
name|size_t
comment|/*len*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|HDB
modifier|*
name|_kadm5_s_get_db
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_s_init_context
parameter_list|(
name|kadm5_server_context
modifier|*
modifier|*
comment|/*ctx*/
parameter_list|,
name|kadm5_config_params
modifier|*
comment|/*params*/
parameter_list|,
name|krb5_context
comment|/*context*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_set_keys
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|,
name|hdb_entry
modifier|*
comment|/*ent*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*password*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_set_keys2
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|,
name|hdb_entry
modifier|*
comment|/*ent*/
parameter_list|,
name|int16_t
comment|/*n_key_data*/
parameter_list|,
name|krb5_key_data
modifier|*
comment|/*key_data*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_set_keys3
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|,
name|hdb_entry
modifier|*
comment|/*ent*/
parameter_list|,
name|int
comment|/*n_keys*/
parameter_list|,
name|krb5_keyblock
modifier|*
comment|/*keyblocks*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_set_keys_randomly
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|,
name|hdb_entry
modifier|*
comment|/*ent*/
parameter_list|,
name|krb5_keyblock
modifier|*
modifier|*
comment|/*new_keys*/
parameter_list|,
name|int
modifier|*
comment|/*n_keys*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_set_modifier
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|,
name|hdb_entry
modifier|*
comment|/*ent*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_setup_entry
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|,
name|hdb_entry_ex
modifier|*
comment|/*ent*/
parameter_list|,
name|uint32_t
comment|/*mask*/
parameter_list|,
name|kadm5_principal_ent_t
comment|/*princ*/
parameter_list|,
name|uint32_t
comment|/*princ_mask*/
parameter_list|,
name|kadm5_principal_ent_t
comment|/*def*/
parameter_list|,
name|uint32_t
comment|/*def_mask*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_string_to_privs
parameter_list|(
specifier|const
name|char
modifier|*
comment|/*s*/
parameter_list|,
name|uint32_t
modifier|*
comment|/*privs*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|_kadm5_unmarshal_params
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_data
modifier|*
comment|/*in*/
parameter_list|,
name|kadm5_config_params
modifier|*
comment|/*params*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_chpass_principal
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|krb5_principal
comment|/*princ*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*password*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_chpass_principal_with_key
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|krb5_principal
comment|/*princ*/
parameter_list|,
name|int
comment|/*n_key_data*/
parameter_list|,
name|krb5_key_data
modifier|*
comment|/*key_data*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_create_principal
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|kadm5_principal_ent_t
comment|/*princ*/
parameter_list|,
name|uint32_t
comment|/*mask*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*password*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_delete_principal
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|krb5_principal
comment|/*princ*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_destroy
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_flush
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_get_principal
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|krb5_principal
comment|/*princ*/
parameter_list|,
name|kadm5_principal_ent_t
comment|/*out*/
parameter_list|,
name|uint32_t
comment|/*mask*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_get_principals
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*expression*/
parameter_list|,
name|char
modifier|*
modifier|*
modifier|*
comment|/*princs*/
parameter_list|,
name|int
modifier|*
comment|/*count*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_get_privs
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|uint32_t
modifier|*
comment|/*privs*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_init_with_creds
parameter_list|(
specifier|const
name|char
modifier|*
comment|/*client_name*/
parameter_list|,
name|krb5_ccache
comment|/*ccache*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*service_name*/
parameter_list|,
name|kadm5_config_params
modifier|*
comment|/*realm_params*/
parameter_list|,
name|unsigned
name|long
comment|/*struct_version*/
parameter_list|,
name|unsigned
name|long
comment|/*api_version*/
parameter_list|,
name|void
modifier|*
modifier|*
comment|/*server_handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_init_with_creds_ctx
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*client_name*/
parameter_list|,
name|krb5_ccache
comment|/*ccache*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*service_name*/
parameter_list|,
name|kadm5_config_params
modifier|*
comment|/*realm_params*/
parameter_list|,
name|unsigned
name|long
comment|/*struct_version*/
parameter_list|,
name|unsigned
name|long
comment|/*api_version*/
parameter_list|,
name|void
modifier|*
modifier|*
comment|/*server_handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_init_with_password
parameter_list|(
specifier|const
name|char
modifier|*
comment|/*client_name*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*password*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*service_name*/
parameter_list|,
name|kadm5_config_params
modifier|*
comment|/*realm_params*/
parameter_list|,
name|unsigned
name|long
comment|/*struct_version*/
parameter_list|,
name|unsigned
name|long
comment|/*api_version*/
parameter_list|,
name|void
modifier|*
modifier|*
comment|/*server_handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_init_with_password_ctx
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*client_name*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*password*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*service_name*/
parameter_list|,
name|kadm5_config_params
modifier|*
comment|/*realm_params*/
parameter_list|,
name|unsigned
name|long
comment|/*struct_version*/
parameter_list|,
name|unsigned
name|long
comment|/*api_version*/
parameter_list|,
name|void
modifier|*
modifier|*
comment|/*server_handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_init_with_skey
parameter_list|(
specifier|const
name|char
modifier|*
comment|/*client_name*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*keytab*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*service_name*/
parameter_list|,
name|kadm5_config_params
modifier|*
comment|/*realm_params*/
parameter_list|,
name|unsigned
name|long
comment|/*struct_version*/
parameter_list|,
name|unsigned
name|long
comment|/*api_version*/
parameter_list|,
name|void
modifier|*
modifier|*
comment|/*server_handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_init_with_skey_ctx
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*client_name*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*keytab*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*service_name*/
parameter_list|,
name|kadm5_config_params
modifier|*
comment|/*realm_params*/
parameter_list|,
name|unsigned
name|long
comment|/*struct_version*/
parameter_list|,
name|unsigned
name|long
comment|/*api_version*/
parameter_list|,
name|void
modifier|*
modifier|*
comment|/*server_handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_modify_principal
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|kadm5_principal_ent_t
comment|/*princ*/
parameter_list|,
name|uint32_t
comment|/*mask*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_randkey_principal
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|krb5_principal
comment|/*princ*/
parameter_list|,
name|krb5_keyblock
modifier|*
modifier|*
comment|/*new_keys*/
parameter_list|,
name|int
modifier|*
comment|/*n_keys*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_c_rename_principal
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|krb5_principal
comment|/*source*/
parameter_list|,
name|krb5_principal
comment|/*target*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_log_create
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|,
name|hdb_entry
modifier|*
comment|/*ent*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_log_delete
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|,
name|krb5_principal
comment|/*princ*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_log_end
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_log_foreach
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|,
name|void
function_decl|(
modifier|*
comment|/*func*/
function_decl|)
parameter_list|(
name|kadm5_server_context
modifier|*
name|server_context
parameter_list|,
name|uint32_t
name|ver
parameter_list|,
name|time_t
name|timestamp
parameter_list|,
name|enum
name|kadm_ops
name|op
parameter_list|,
name|uint32_t
name|len
parameter_list|,
name|krb5_storage
modifier|*
parameter_list|,
name|void
modifier|*
parameter_list|)
parameter_list|,
name|void
modifier|*
comment|/*ctx*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_log_get_version
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|,
name|uint32_t
modifier|*
comment|/*ver*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_log_get_version_fd
parameter_list|(
name|int
comment|/*fd*/
parameter_list|,
name|uint32_t
modifier|*
comment|/*ver*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|krb5_storage
modifier|*
name|kadm5_log_goto_end
parameter_list|(
name|int
comment|/*fd*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_log_init
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_log_modify
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|,
name|hdb_entry
modifier|*
comment|/*ent*/
parameter_list|,
name|uint32_t
comment|/*mask*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_log_nop
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_log_previous
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
name|krb5_storage
modifier|*
comment|/*sp*/
parameter_list|,
name|uint32_t
modifier|*
comment|/*ver*/
parameter_list|,
name|time_t
modifier|*
comment|/*timestamp*/
parameter_list|,
name|enum
name|kadm_ops
modifier|*
comment|/*op*/
parameter_list|,
name|uint32_t
modifier|*
comment|/*len*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_log_reinit
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_log_rename
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|,
name|krb5_principal
comment|/*source*/
parameter_list|,
name|hdb_entry
modifier|*
comment|/*ent*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_log_replay
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|,
name|enum
name|kadm_ops
comment|/*op*/
parameter_list|,
name|uint32_t
comment|/*ver*/
parameter_list|,
name|uint32_t
comment|/*len*/
parameter_list|,
name|krb5_storage
modifier|*
comment|/*sp*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_log_set_version
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*context*/
parameter_list|,
name|uint32_t
comment|/*vno*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|const
name|char
modifier|*
name|kadm5_log_signal_socket
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_log_truncate
parameter_list|(
name|kadm5_server_context
modifier|*
comment|/*server_context*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_chpass_principal
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|krb5_principal
comment|/*princ*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*password*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_chpass_principal_cond
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|krb5_principal
comment|/*princ*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*password*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_chpass_principal_with_key
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|krb5_principal
comment|/*princ*/
parameter_list|,
name|int
comment|/*n_key_data*/
parameter_list|,
name|krb5_key_data
modifier|*
comment|/*key_data*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_create_principal
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|kadm5_principal_ent_t
comment|/*princ*/
parameter_list|,
name|uint32_t
comment|/*mask*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*password*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_create_principal_with_key
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|kadm5_principal_ent_t
comment|/*princ*/
parameter_list|,
name|uint32_t
comment|/*mask*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_delete_principal
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|krb5_principal
comment|/*princ*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_destroy
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_flush
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_get_principal
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|krb5_principal
comment|/*princ*/
parameter_list|,
name|kadm5_principal_ent_t
comment|/*out*/
parameter_list|,
name|uint32_t
comment|/*mask*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_get_principals
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*expression*/
parameter_list|,
name|char
modifier|*
modifier|*
modifier|*
comment|/*princs*/
parameter_list|,
name|int
modifier|*
comment|/*count*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_get_privs
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|uint32_t
modifier|*
comment|/*privs*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_init_with_creds
parameter_list|(
specifier|const
name|char
modifier|*
comment|/*client_name*/
parameter_list|,
name|krb5_ccache
comment|/*ccache*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*service_name*/
parameter_list|,
name|kadm5_config_params
modifier|*
comment|/*realm_params*/
parameter_list|,
name|unsigned
name|long
comment|/*struct_version*/
parameter_list|,
name|unsigned
name|long
comment|/*api_version*/
parameter_list|,
name|void
modifier|*
modifier|*
comment|/*server_handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_init_with_creds_ctx
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*client_name*/
parameter_list|,
name|krb5_ccache
comment|/*ccache*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*service_name*/
parameter_list|,
name|kadm5_config_params
modifier|*
comment|/*realm_params*/
parameter_list|,
name|unsigned
name|long
comment|/*struct_version*/
parameter_list|,
name|unsigned
name|long
comment|/*api_version*/
parameter_list|,
name|void
modifier|*
modifier|*
comment|/*server_handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_init_with_password
parameter_list|(
specifier|const
name|char
modifier|*
comment|/*client_name*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*password*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*service_name*/
parameter_list|,
name|kadm5_config_params
modifier|*
comment|/*realm_params*/
parameter_list|,
name|unsigned
name|long
comment|/*struct_version*/
parameter_list|,
name|unsigned
name|long
comment|/*api_version*/
parameter_list|,
name|void
modifier|*
modifier|*
comment|/*server_handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_init_with_password_ctx
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*client_name*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*password*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*service_name*/
parameter_list|,
name|kadm5_config_params
modifier|*
comment|/*realm_params*/
parameter_list|,
name|unsigned
name|long
comment|/*struct_version*/
parameter_list|,
name|unsigned
name|long
comment|/*api_version*/
parameter_list|,
name|void
modifier|*
modifier|*
comment|/*server_handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_init_with_skey
parameter_list|(
specifier|const
name|char
modifier|*
comment|/*client_name*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*keytab*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*service_name*/
parameter_list|,
name|kadm5_config_params
modifier|*
comment|/*realm_params*/
parameter_list|,
name|unsigned
name|long
comment|/*struct_version*/
parameter_list|,
name|unsigned
name|long
comment|/*api_version*/
parameter_list|,
name|void
modifier|*
modifier|*
comment|/*server_handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_init_with_skey_ctx
parameter_list|(
name|krb5_context
comment|/*context*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*client_name*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*keytab*/
parameter_list|,
specifier|const
name|char
modifier|*
comment|/*service_name*/
parameter_list|,
name|kadm5_config_params
modifier|*
comment|/*realm_params*/
parameter_list|,
name|unsigned
name|long
comment|/*struct_version*/
parameter_list|,
name|unsigned
name|long
comment|/*api_version*/
parameter_list|,
name|void
modifier|*
modifier|*
comment|/*server_handle*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_modify_principal
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|kadm5_principal_ent_t
comment|/*princ*/
parameter_list|,
name|uint32_t
comment|/*mask*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_randkey_principal
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|krb5_principal
comment|/*princ*/
parameter_list|,
name|krb5_keyblock
modifier|*
modifier|*
comment|/*new_keys*/
parameter_list|,
name|int
modifier|*
comment|/*n_keys*/
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|kadm5_ret_t
name|kadm5_s_rename_principal
parameter_list|(
name|void
modifier|*
comment|/*server_handle*/
parameter_list|,
name|krb5_principal
comment|/*source*/
parameter_list|,
name|krb5_principal
comment|/*target*/
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* __kadm5_private_h__ */
end_comment

end_unit

