begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (c) 1985, 1993  *	The Regents of the University of California.  All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  * 3. All advertising materials mentioning features or use of this software  *    must display the following acknowledgement:  *	This product includes software developed by the University of  *	California, Berkeley and its contributors.  * 4. Neither the name of the University nor the names of its contributors  *    may be used to endorse or promote products derived from this software  *    without specific prior written permission.  *  * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
name|sccsid
index|[]
init|=
literal|"@(#)atan2.c	8.1 (Berkeley) 6/4/93"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* not lint */
end_comment

begin_comment
comment|/* ATAN2(Y,X)  * RETURN ARG (X+iY)  * DOUBLE PRECISION (VAX D format 56 bits, IEEE DOUBLE 53 BITS)  * CODED IN C BY K.C. NG, 1/8/85;  * REVISED BY K.C. NG on 2/7/85, 2/13/85, 3/7/85, 3/30/85, 6/29/85.  *  * Required system supported functions :  *	copysign(x,y)  *	scalb(x,y)  *	logb(x)  *  * Method :  *	1. Reduce y to positive by atan2(y,x)=-atan2(-y,x).  *	2. Reduce x to positive by (if x and y are unexceptional):  *		ARG (x+iy) = arctan(y/x)   	   ... if x> 0,  *		ARG (x+iy) = pi - arctan[y/(-x)]   ... if x< 0,  *	3. According to the integer k=4t+0.25 truncated , t=y/x, the argument  *	   is further reduced to one of the following intervals and the  *	   arctangent of y/x is evaluated by the corresponding formula:  *  *         [0,7/16]	   atan(y/x) = t - t^3*(a1+t^2*(a2+...(a10+t^2*a11)...)  *	   [7/16,11/16]    atan(y/x) = atan(1/2) + atan( (y-x/2)/(x+y/2) )  *	   [11/16.19/16]   atan(y/x) = atan( 1 ) + atan( (y-x)/(x+y) )  *	   [19/16,39/16]   atan(y/x) = atan(3/2) + atan( (y-1.5x)/(x+1.5y) )  *	   [39/16,INF]     atan(y/x) = atan(INF) + atan( -x/y )  *  * Special cases:  * Notations: atan2(y,x) == ARG (x+iy) == ARG(x,y).  *  *	ARG( NAN , (anything) ) is NaN;  *	ARG( (anything), NaN ) is NaN;  *	ARG(+(anything but NaN), +-0) is +-0  ;  *	ARG(-(anything but NaN), +-0) is +-PI ;  *	ARG( 0, +-(anything but 0 and NaN) ) is +-PI/2;  *	ARG( +INF,+-(anything but INF and NaN) ) is +-0 ;  *	ARG( -INF,+-(anything but INF and NaN) ) is +-PI;  *	ARG( +INF,+-INF ) is +-PI/4 ;  *	ARG( -INF,+-INF ) is +-3PI/4;  *	ARG( (anything but,0,NaN, and INF),+-INF ) is +-PI/2;  *  * Accuracy:  *	atan2(y,x) returns (PI/pi) * the exact ARG (x+iy) nearly rounded,  *	where  *  *	in decimal:  *		pi = 3.141592653589793 23846264338327 .....  *    53 bits   PI = 3.141592653589793 115997963 ..... ,  *    56 bits   PI = 3.141592653589793 227020265 ..... ,  *  *	in hexadecimal:  *		pi = 3.243F6A8885A308D313198A2E....  *    53 bits   PI = 3.243F6A8885A30  =  2 * 1.921FB54442D18	error=.276ulps  *    56 bits   PI = 3.243F6A8885A308 =  4 * .C90FDAA22168C2    error=.206ulps  *  *	In a test run with 356,000 random argument on [-1,1] * [-1,1] on a  *	VAX, the maximum observed error was 1.41 ulps (units of the last place)  *	compared with (PI/pi)*(the exact ARG(x+iy)).  *  * Note:  *	We use machine PI (the true pi rounded) in place of the actual  *	value of pi for all the trig and inverse trig functions. In general,  *	if trig is one of sin, cos, tan, then computed trig(y) returns the  *	exact trig(y*pi/PI) nearly rounded; correspondingly, computed arctrig  *	returns the exact arctrig(y)*PI/pi nearly rounded. These guarantee the  *	trig functions have period PI, and trig(arctrig(x)) returns x for  *	all critical values x.  *  * Constants:  * The hexadecimal values are the intended ones for the following constants.  * The decimal values may be used, provided that the compiler will convert  * from decimal to binary accurately enough to produce the hexadecimal values  * shown.  */
end_comment

begin_include
include|#
directive|include
file|"mathimpl.h"
end_include

begin_macro
name|vc
argument_list|(
argument|athfhi
argument_list|,
literal|4.6364760900080611433E
argument|-
literal|1
argument_list|,
literal|6338
argument_list|,
literal|3fed
argument_list|,
argument|da7b
argument_list|,
literal|2b0d
argument_list|,
argument|-
literal|1
argument_list|,
argument|.ED63382B0DDA7B
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|athflo
argument_list|,
literal|1.9338828231967579916E
argument|-
literal|19
argument_list|,
literal|5005
argument_list|,
literal|2164
argument_list|,
literal|92c0
argument_list|,
literal|9cfe
argument_list|,
argument|-
literal|62
argument_list|,
argument|.E450059CFE92C0
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|PIo4
argument_list|,
literal|7.8539816339744830676E
argument|-
literal|1
argument_list|,
literal|0fda
argument_list|,
literal|4049
argument_list|,
literal|68c2
argument_list|,
argument|a221
argument_list|,
literal|0
argument_list|,
argument|.C90FDAA22168C2
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|at1fhi
argument_list|,
literal|9.8279372324732906796E
argument|-
literal|1
argument_list|,
literal|985e
argument_list|,
literal|407b
argument_list|,
argument|b4d9
argument_list|,
literal|940f
argument_list|,
literal|0
argument_list|,
argument|.FB985E940FB4D9
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|at1flo
argument_list|,
argument|-
literal|3.5540295636764633916E
argument|-
literal|18
argument_list|,
literal|1edc
argument_list|,
argument|a383
argument_list|,
argument|eaea
argument_list|,
literal|34d6
argument_list|,
argument|-
literal|57
argument_list|,
argument|-
literal|.831EDC34D6EAEA
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|PIo2
argument_list|,
literal|1.5707963267948966135E0
argument_list|,
literal|0fda
argument_list|,
literal|40c9
argument_list|,
literal|68c2
argument_list|,
argument|a221
argument_list|,
literal|1
argument_list|,
argument|.C90FDAA22168C2
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|PI
argument_list|,
literal|3.1415926535897932270E0
argument_list|,
literal|0fda
argument_list|,
literal|4149
argument_list|,
literal|68c2
argument_list|,
argument|a221
argument_list|,
literal|2
argument_list|,
argument|.C90FDAA22168C2
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|a1
argument_list|,
literal|3.3333333333333473730E
argument|-
literal|1
argument_list|,
argument|aaaa
argument_list|,
literal|3faa
argument_list|,
argument|ab75
argument_list|,
argument|aaaa
argument_list|,
argument|-
literal|1
argument_list|,
argument|.AAAAAAAAAAAB75
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|a2
argument_list|,
argument|-
literal|2.0000000000017730678E
argument|-
literal|1
argument_list|,
argument|cccc
argument_list|,
argument|bf4c
argument_list|,
literal|946e
argument_list|,
argument|cccd
argument_list|,
argument|-
literal|2
argument_list|,
argument|-.CCCCCCCCCD946E
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|a3
argument_list|,
literal|1.4285714286694640301E
argument|-
literal|1
argument_list|,
literal|4924
argument_list|,
literal|3f12
argument_list|,
literal|4262
argument_list|,
literal|9274
argument_list|,
argument|-
literal|2
argument_list|,
literal|.92492492744262
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|a4
argument_list|,
argument|-
literal|1.1111111135032672795E
argument|-
literal|1
argument_list|,
literal|8e38
argument_list|,
argument|bee3
argument_list|,
literal|6292
argument_list|,
argument|ebc6
argument_list|,
argument|-
literal|3
argument_list|,
argument|-.E38E38EBC66292
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|a5
argument_list|,
literal|9.0909091380563043783E
argument|-
literal|2
argument_list|,
literal|2e8b
argument_list|,
literal|3eba
argument_list|,
argument|d70c
argument_list|,
argument|b31b
argument_list|,
argument|-
literal|3
argument_list|,
argument|.BA2E8BB31BD70C
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|a6
argument_list|,
argument|-
literal|7.6922954286089459397E
argument|-
literal|2
argument_list|,
literal|89c8
argument_list|,
argument|be9d
argument_list|,
literal|7f18
argument_list|,
literal|27c3
argument_list|,
argument|-
literal|3
argument_list|,
argument|-
literal|.9D89C827C37F18
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|a7
argument_list|,
literal|6.6663180891693915586E
argument|-
literal|2
argument_list|,
literal|86b4
argument_list|,
literal|3e88
argument_list|,
literal|9e58
argument_list|,
argument|ae37
argument_list|,
argument|-
literal|3
argument_list|,
literal|.8886B4AE379E58
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|a8
argument_list|,
argument|-
literal|5.8772703698290408927E
argument|-
literal|2
argument_list|,
argument|bba5
argument_list|,
argument|be70
argument_list|,
argument|a942
argument_list|,
literal|8481
argument_list|,
argument|-
literal|4
argument_list|,
argument|-.F0BBA58481A942
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|a9
argument_list|,
literal|5.2170707402812969804E
argument|-
literal|2
argument_list|,
argument|b0f3
argument_list|,
literal|3e55
argument_list|,
literal|13ab
argument_list|,
argument|a1ab
argument_list|,
argument|-
literal|4
argument_list|,
argument|.D5B0F3A1AB13AB
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|a10
argument_list|,
argument|-
literal|4.4895863157820361210E
argument|-
literal|2
argument_list|,
argument|e4b9
argument_list|,
argument|be37
argument_list|,
literal|048f
argument_list|,
literal|7fd1
argument_list|,
argument|-
literal|4
argument_list|,
argument|-.B7E4B97FD1048F
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|a11
argument_list|,
literal|3.3006147437343875094E
argument|-
literal|2
argument_list|,
literal|3174
argument_list|,
literal|3e07
argument_list|,
literal|2d87
argument_list|,
literal|3cf7
argument_list|,
argument|-
literal|4
argument_list|,
literal|.8731743CF72D87
argument_list|)
end_macro

begin_macro
name|vc
argument_list|(
argument|a12
argument_list|,
argument|-
literal|1.4614844866464185439E
argument|-
literal|2
argument_list|,
literal|731a
argument_list|,
argument|bd6f
argument_list|,
literal|76d9
argument_list|,
literal|2f34
argument_list|,
argument|-
literal|6
argument_list|,
argument|-.EF731A2F3476D9
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|athfhi
argument_list|,
literal|4.6364760900080609352E
argument|-
literal|1
argument_list|,
argument|-
literal|2
argument_list|,
literal|1.DAC670561BB4F
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|athflo
argument_list|,
literal|4.6249969567426939759E
argument|-
literal|18
argument_list|,
argument|-
literal|58
argument_list|,
literal|1.5543B8F253271
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|PIo4
argument_list|,
literal|7.8539816339744827900E
argument|-
literal|1
argument_list|,
argument|-
literal|1
argument_list|,
literal|1.921FB54442D18
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|at1fhi
argument_list|,
literal|9.8279372324732905408E
argument|-
literal|1
argument_list|,
argument|-
literal|1
argument_list|,
literal|1.F730BD281F69B
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|at1flo
argument_list|,
argument|-
literal|2.4407677060164810007E
argument|-
literal|17
argument_list|,
argument|-
literal|56
argument_list|,
argument|-
literal|1.C23DFEFEAE6B5
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|PIo2
argument_list|,
literal|1.5707963267948965580E0
argument_list|,
literal|0
argument_list|,
literal|1.921FB54442D18
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|PI
argument_list|,
literal|3.1415926535897931160E0
argument_list|,
literal|1
argument_list|,
literal|1.921FB54442D18
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|a1
argument_list|,
literal|3.3333333333333942106E
argument|-
literal|1
argument_list|,
argument|-
literal|2
argument_list|,
literal|1.55555555555C3
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|a2
argument_list|,
argument|-
literal|1.9999999999979536924E
argument|-
literal|1
argument_list|,
argument|-
literal|3
argument_list|,
argument|-
literal|1.9999999997CCD
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|a3
argument_list|,
literal|1.4285714278004377209E
argument|-
literal|1
argument_list|,
argument|-
literal|3
argument_list|,
literal|1.24924921EC1D7
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|a4
argument_list|,
argument|-
literal|1.1111110579344973814E
argument|-
literal|1
argument_list|,
argument|-
literal|4
argument_list|,
argument|-
literal|1.C71C7059AF280
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|a5
argument_list|,
literal|9.0908906105474668324E
argument|-
literal|2
argument_list|,
argument|-
literal|4
argument_list|,
literal|1.745CE5AA35DB2
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|a6
argument_list|,
argument|-
literal|7.6919217767468239799E
argument|-
literal|2
argument_list|,
argument|-
literal|4
argument_list|,
argument|-
literal|1.3B0FA54BEC400
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|a7
argument_list|,
literal|6.6614695906082474486E
argument|-
literal|2
argument_list|,
argument|-
literal|4
argument_list|,
literal|1.10DA924597FFF
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|a8
argument_list|,
argument|-
literal|5.8358371008508623523E
argument|-
literal|2
argument_list|,
argument|-
literal|5
argument_list|,
argument|-
literal|1.DE125FDDBD793
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|a9
argument_list|,
literal|4.9850617156082015213E
argument|-
literal|2
argument_list|,
argument|-
literal|5
argument_list|,
literal|1.9860524BDD807
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|a10
argument_list|,
argument|-
literal|3.6700606902093604877E
argument|-
literal|2
argument_list|,
argument|-
literal|5
argument_list|,
argument|-
literal|1.2CA6C04C6937A
argument_list|)
end_macro

begin_macro
name|ic
argument_list|(
argument|a11
argument_list|,
literal|1.6438029044759730479E
argument|-
literal|2
argument_list|,
argument|-
literal|6
argument_list|,
literal|1.0D52174A1BB54
argument_list|)
end_macro

begin_ifdef
ifdef|#
directive|ifdef
name|vccast
end_ifdef

begin_define
define|#
directive|define
name|athfhi
value|vccast(athfhi)
end_define

begin_define
define|#
directive|define
name|athflo
value|vccast(athflo)
end_define

begin_define
define|#
directive|define
name|PIo4
value|vccast(PIo4)
end_define

begin_define
define|#
directive|define
name|at1fhi
value|vccast(at1fhi)
end_define

begin_define
define|#
directive|define
name|at1flo
value|vccast(at1flo)
end_define

begin_define
define|#
directive|define
name|PIo2
value|vccast(PIo2)
end_define

begin_define
define|#
directive|define
name|PI
value|vccast(PI)
end_define

begin_define
define|#
directive|define
name|a1
value|vccast(a1)
end_define

begin_define
define|#
directive|define
name|a2
value|vccast(a2)
end_define

begin_define
define|#
directive|define
name|a3
value|vccast(a3)
end_define

begin_define
define|#
directive|define
name|a4
value|vccast(a4)
end_define

begin_define
define|#
directive|define
name|a5
value|vccast(a5)
end_define

begin_define
define|#
directive|define
name|a6
value|vccast(a6)
end_define

begin_define
define|#
directive|define
name|a7
value|vccast(a7)
end_define

begin_define
define|#
directive|define
name|a8
value|vccast(a8)
end_define

begin_define
define|#
directive|define
name|a9
value|vccast(a9)
end_define

begin_define
define|#
directive|define
name|a10
value|vccast(a10)
end_define

begin_define
define|#
directive|define
name|a11
value|vccast(a11)
end_define

begin_define
define|#
directive|define
name|a12
value|vccast(a12)
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_function
name|double
name|atan2
parameter_list|(
name|y
parameter_list|,
name|x
parameter_list|)
name|double
name|y
decl_stmt|,
name|x
decl_stmt|;
block|{
specifier|static
specifier|const
name|double
name|zero
init|=
literal|0
decl_stmt|,
name|one
init|=
literal|1
decl_stmt|,
name|small
init|=
literal|1.0E
operator|-
literal|9
decl_stmt|,
name|big
init|=
literal|1.0E18
decl_stmt|;
name|double
name|t
decl_stmt|,
name|z
decl_stmt|,
name|signy
decl_stmt|,
name|signx
decl_stmt|,
name|hi
decl_stmt|,
name|lo
decl_stmt|;
name|int
name|k
decl_stmt|,
name|m
decl_stmt|;
if|#
directive|if
operator|!
name|defined
argument_list|(
name|vax
argument_list|)
operator|&&
operator|!
name|defined
argument_list|(
name|tahoe
argument_list|)
comment|/* if x or y is NAN */
if|if
condition|(
name|x
operator|!=
name|x
condition|)
return|return
operator|(
name|x
operator|)
return|;
if|if
condition|(
name|y
operator|!=
name|y
condition|)
return|return
operator|(
name|y
operator|)
return|;
endif|#
directive|endif
comment|/* !defined(vax)&&!defined(tahoe) */
comment|/* copy down the sign of y and x */
name|signy
operator|=
name|copysign
argument_list|(
name|one
argument_list|,
name|y
argument_list|)
expr_stmt|;
name|signx
operator|=
name|copysign
argument_list|(
name|one
argument_list|,
name|x
argument_list|)
expr_stmt|;
comment|/* if x is 1.0, goto begin */
if|if
condition|(
name|x
operator|==
literal|1
condition|)
block|{
name|y
operator|=
name|copysign
argument_list|(
name|y
argument_list|,
name|one
argument_list|)
expr_stmt|;
name|t
operator|=
name|y
expr_stmt|;
if|if
condition|(
name|finite
argument_list|(
name|t
argument_list|)
condition|)
goto|goto
name|begin
goto|;
block|}
comment|/* when y = 0 */
if|if
condition|(
name|y
operator|==
name|zero
condition|)
return|return
operator|(
operator|(
name|signx
operator|==
name|one
operator|)
condition|?
name|y
else|:
name|copysign
argument_list|(
name|PI
argument_list|,
name|signy
argument_list|)
operator|)
return|;
comment|/* when x = 0 */
if|if
condition|(
name|x
operator|==
name|zero
condition|)
return|return
operator|(
name|copysign
argument_list|(
name|PIo2
argument_list|,
name|signy
argument_list|)
operator|)
return|;
comment|/* when x is INF */
if|if
condition|(
operator|!
name|finite
argument_list|(
name|x
argument_list|)
condition|)
if|if
condition|(
operator|!
name|finite
argument_list|(
name|y
argument_list|)
condition|)
return|return
operator|(
name|copysign
argument_list|(
operator|(
name|signx
operator|==
name|one
operator|)
condition|?
name|PIo4
else|:
literal|3
operator|*
name|PIo4
argument_list|,
name|signy
argument_list|)
operator|)
return|;
else|else
return|return
operator|(
name|copysign
argument_list|(
operator|(
name|signx
operator|==
name|one
operator|)
condition|?
name|zero
else|:
name|PI
argument_list|,
name|signy
argument_list|)
operator|)
return|;
comment|/* when y is INF */
if|if
condition|(
operator|!
name|finite
argument_list|(
name|y
argument_list|)
condition|)
return|return
operator|(
name|copysign
argument_list|(
name|PIo2
argument_list|,
name|signy
argument_list|)
operator|)
return|;
comment|/* compute y/x */
name|x
operator|=
name|copysign
argument_list|(
name|x
argument_list|,
name|one
argument_list|)
expr_stmt|;
name|y
operator|=
name|copysign
argument_list|(
name|y
argument_list|,
name|one
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|m
operator|=
operator|(
name|k
operator|=
name|logb
argument_list|(
name|y
argument_list|)
operator|)
operator|-
name|logb
argument_list|(
name|x
argument_list|)
operator|)
operator|>
literal|60
condition|)
name|t
operator|=
name|big
operator|+
name|big
expr_stmt|;
elseif|else
if|if
condition|(
name|m
operator|<
operator|-
literal|80
condition|)
name|t
operator|=
name|y
operator|/
name|x
expr_stmt|;
else|else
block|{
name|t
operator|=
name|y
operator|/
name|x
expr_stmt|;
name|y
operator|=
name|scalb
argument_list|(
name|y
argument_list|,
operator|-
name|k
argument_list|)
expr_stmt|;
name|x
operator|=
name|scalb
argument_list|(
name|x
argument_list|,
operator|-
name|k
argument_list|)
expr_stmt|;
block|}
comment|/* begin argument reduction */
name|begin
label|:
if|if
condition|(
name|t
operator|<
literal|2.4375
condition|)
block|{
comment|/* truncate 4(t+1/16) to integer for branching */
name|k
operator|=
literal|4
operator|*
operator|(
name|t
operator|+
literal|0.0625
operator|)
expr_stmt|;
switch|switch
condition|(
name|k
condition|)
block|{
comment|/* t is in [0,7/16] */
case|case
literal|0
case|:
case|case
literal|1
case|:
if|if
condition|(
name|t
operator|<
name|small
condition|)
block|{
name|big
operator|+
name|small
expr_stmt|;
comment|/* raise inexact flag */
return|return
operator|(
name|copysign
argument_list|(
operator|(
name|signx
operator|>
name|zero
operator|)
condition|?
name|t
else|:
name|PI
operator|-
name|t
argument_list|,
name|signy
argument_list|)
operator|)
return|;
block|}
name|hi
operator|=
name|zero
expr_stmt|;
name|lo
operator|=
name|zero
expr_stmt|;
break|break;
comment|/* t is in [7/16,11/16] */
case|case
literal|2
case|:
name|hi
operator|=
name|athfhi
expr_stmt|;
name|lo
operator|=
name|athflo
expr_stmt|;
name|z
operator|=
name|x
operator|+
name|x
expr_stmt|;
name|t
operator|=
operator|(
operator|(
name|y
operator|+
name|y
operator|)
operator|-
name|x
operator|)
operator|/
operator|(
name|z
operator|+
name|y
operator|)
expr_stmt|;
break|break;
comment|/* t is in [11/16,19/16] */
case|case
literal|3
case|:
case|case
literal|4
case|:
name|hi
operator|=
name|PIo4
expr_stmt|;
name|lo
operator|=
name|zero
expr_stmt|;
name|t
operator|=
operator|(
name|y
operator|-
name|x
operator|)
operator|/
operator|(
name|x
operator|+
name|y
operator|)
expr_stmt|;
break|break;
comment|/* t is in [19/16,39/16] */
default|default:
name|hi
operator|=
name|at1fhi
expr_stmt|;
name|lo
operator|=
name|at1flo
expr_stmt|;
name|z
operator|=
name|y
operator|-
name|x
expr_stmt|;
name|y
operator|=
name|y
operator|+
name|y
operator|+
name|y
expr_stmt|;
name|t
operator|=
name|x
operator|+
name|x
expr_stmt|;
name|t
operator|=
operator|(
operator|(
name|z
operator|+
name|z
operator|)
operator|-
name|x
operator|)
operator|/
operator|(
name|t
operator|+
name|y
operator|)
expr_stmt|;
break|break;
block|}
block|}
comment|/* end of if (t< 2.4375) */
else|else
block|{
name|hi
operator|=
name|PIo2
expr_stmt|;
name|lo
operator|=
name|zero
expr_stmt|;
comment|/* t is in [2.4375, big] */
if|if
condition|(
name|t
operator|<=
name|big
condition|)
name|t
operator|=
operator|-
name|x
operator|/
name|y
expr_stmt|;
comment|/* t is in [big, INF] */
else|else
block|{
name|big
operator|+
name|small
expr_stmt|;
comment|/* raise inexact flag */
name|t
operator|=
name|zero
expr_stmt|;
block|}
block|}
comment|/* end of argument reduction */
comment|/* compute atan(t) for t in [-.4375, .4375] */
name|z
operator|=
name|t
operator|*
name|t
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|vax
argument_list|)
operator|||
name|defined
argument_list|(
name|tahoe
argument_list|)
name|z
operator|=
name|t
operator|*
operator|(
name|z
operator|*
operator|(
name|a1
operator|+
name|z
operator|*
operator|(
name|a2
operator|+
name|z
operator|*
operator|(
name|a3
operator|+
name|z
operator|*
operator|(
name|a4
operator|+
name|z
operator|*
operator|(
name|a5
operator|+
name|z
operator|*
operator|(
name|a6
operator|+
name|z
operator|*
operator|(
name|a7
operator|+
name|z
operator|*
operator|(
name|a8
operator|+
name|z
operator|*
operator|(
name|a9
operator|+
name|z
operator|*
operator|(
name|a10
operator|+
name|z
operator|*
operator|(
name|a11
operator|+
name|z
operator|*
name|a12
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
else|#
directive|else
comment|/* defined(vax)||defined(tahoe) */
name|z
operator|=
name|t
operator|*
operator|(
name|z
operator|*
operator|(
name|a1
operator|+
name|z
operator|*
operator|(
name|a2
operator|+
name|z
operator|*
operator|(
name|a3
operator|+
name|z
operator|*
operator|(
name|a4
operator|+
name|z
operator|*
operator|(
name|a5
operator|+
name|z
operator|*
operator|(
name|a6
operator|+
name|z
operator|*
operator|(
name|a7
operator|+
name|z
operator|*
operator|(
name|a8
operator|+
name|z
operator|*
operator|(
name|a9
operator|+
name|z
operator|*
operator|(
name|a10
operator|+
name|z
operator|*
name|a11
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
endif|#
directive|endif
comment|/* defined(vax)||defined(tahoe) */
name|z
operator|=
name|lo
operator|-
name|z
expr_stmt|;
name|z
operator|+=
name|t
expr_stmt|;
name|z
operator|+=
name|hi
expr_stmt|;
return|return
operator|(
name|copysign
argument_list|(
operator|(
name|signx
operator|>
name|zero
operator|)
condition|?
name|z
else|:
name|PI
operator|-
name|z
argument_list|,
name|signy
argument_list|)
operator|)
return|;
block|}
end_function

end_unit

