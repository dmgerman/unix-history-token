begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 1992, 1993  *	The Regents of the University of California.  All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  * 3. All advertising materials mentioning features or use of this software  *    must display the following acknowledgement:  *	This product includes software developed by the University of  *	California, Berkeley and its contributors.  * 4. Neither the name of the University nor the names of its contributors  *    may be used to endorse or promote products derived from this software  *    without specific prior written permission.  *  * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
name|sccsid
index|[]
init|=
literal|"@(#)erf.c	8.1 (Berkeley) 6/4/93"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* not lint */
end_comment

begin_comment
comment|/* Modified Nov 30, 1992 P. McILROY:  *	Replaced expansions for x>= 1.25 (error 1.7ulp vs ~6ulp)  * Replaced even+odd with direct calculation for x< .84375,  * to avoid destructive cancellation.  *  * Performance of erfc(x):  * In 300000 trials in the range [.83, .84375] the  * maximum observed error was 3.6ulp.  *  * In [.84735,1.25] the maximum observed error was<2.5ulp in  * 100000 runs in the range [1.2, 1.25].  *  * In [1.25,26] (Not including subnormal results)  * the error is< 1.7ulp.  */
end_comment

begin_comment
comment|/* double erf(double x)  * double erfc(double x)  *			     x  *		      2      |\  *     erf(x)  =  ---------  | exp(-t*t)dt  *		   sqrt(pi) \|  *			     0  *  *     erfc(x) =  1-erf(x)  *  * Method:  *      1. Reduce x to |x| by erf(-x) = -erf(x)  *	2. For x in [0, 0.84375]  *	    erf(x)  = x + x*P(x^2)  *          erfc(x) = 1 - erf(x)           if x<=0.25  *                  = 0.5 + ((0.5-x)-x*P)  if x in [0.25,0.84375]  *	   where  *			2		 2	  4		  20  *              P =  P(x ) = (p0 + p1 * x + p2 * x + ... + p10 * x  )  * 	   is an approximation to (erf(x)-x)/x with precision  *  *						 -56.45  *			| P - (erf(x)-x)/x |<= 2  *  *  *	   Remark. The formula is derived by noting  *          erf(x) = (2/sqrt(pi))*(x - x^3/3 + x^5/10 - x^7/42 + ....)  *	   and that  *          2/sqrt(pi) = 1.128379167095512573896158903121545171688  *	   is close to one. The interval is chosen because the fixed  *	   point of erf(x) is near 0.6174 (i.e., erf(x)=x when x is  *	   near 0.6174), and by some experiment, 0.84375 is chosen to  * 	   guarantee the error is less than one ulp for erf.  *  *      3. For x in [0.84375,1.25], let s = x - 1, and  *         c = 0.84506291151 rounded to single (24 bits)  *         	erf(x)  = c  + P1(s)/Q1(s)  *         	erfc(x) = (1-c)  - P1(s)/Q1(s)  *         	|P1/Q1 - (erf(x)-c)|<= 2**-59.06  *	   Remark: here we use the taylor series expansion at x=1.  *		erf(1+s) = erf(1) + s*Poly(s)  *			 = 0.845.. + P1(s)/Q1(s)  *	   That is, we use rational approximation to approximate  *			erf(1+s) - (c = (single)0.84506291151)  *	   Note that |P1/Q1|< 0.078 for x in [0.84375,1.25]  *	   where  *		P1(s) = degree 6 poly in s  *		Q1(s) = degree 6 poly in s  *  *	4. For x in [1.25, 2]; [2, 4]  *         	erf(x)  = 1.0 - tiny  *		erfc(x)	= (1/x)exp(-x*x-(.5*log(pi) -.5z + R(z)/S(z))  *  *	Where z = 1/(x*x), R is degree 9, and S is degree 3;  *  *      5. For x in [4,28]  *         	erf(x)  = 1.0 - tiny  *		erfc(x)	= (1/x)exp(-x*x-(.5*log(pi)+eps + zP(z))  *  *	Where P is degree 14 polynomial in 1/(x*x).  *  *      Notes:  *	   Here 4 and 5 make use of the asymptotic series  *			  exp(-x*x)  *		erfc(x) ~ ---------- * ( 1 + Poly(1/x^2) );  *			  x*sqrt(pi)  *  *		where for z = 1/(x*x)  *		P(z) ~ z/2*(-1 + z*3/2*(1 + z*5/2*(-1 + z*7/2*(1 +...))))  *  *	   Thus we use rational approximation to approximate  *              erfc*x*exp(x*x) ~ 1/sqrt(pi);  *  *		The error bound for the target function, G(z) for  *		the interval  *		[4, 28]:  * 		|eps + 1/(z)P(z) - G(z)|< 2**(-56.61)  *		for [2, 4]:  *      	|R(z)/S(z) - G(z)|< 2**(-58.24)  *		for [1.25, 2]:  *		|R(z)/S(z) - G(z)|< 2**(-58.12)  *  *      6. For inf> x>= 28  *         	erf(x)  = 1 - tiny  (raise inexact)  *         	erfc(x) = tiny*tiny (raise underflow)  *  *      7. Special cases:  *         	erf(0)  = 0, erf(inf)  = 1, erf(-inf) = -1,  *         	erfc(0) = 1, erfc(inf) = 0, erfc(-inf) = 2,  *	   	erfc/erf(NaN) is NaN  */
end_comment

begin_if
if|#
directive|if
name|defined
argument_list|(
name|vax
argument_list|)
operator|||
name|defined
argument_list|(
name|tahoe
argument_list|)
end_if

begin_define
define|#
directive|define
name|_IEEE
value|0
end_define

begin_define
define|#
directive|define
name|TRUNC
parameter_list|(
name|x
parameter_list|)
value|(double) (float) (x)
end_define

begin_else
else|#
directive|else
end_else

begin_define
define|#
directive|define
name|_IEEE
value|1
end_define

begin_define
define|#
directive|define
name|TRUNC
parameter_list|(
name|x
parameter_list|)
value|*(((int *)&x) + 1)&= 0xf8000000
end_define

begin_define
define|#
directive|define
name|infnan
parameter_list|(
name|x
parameter_list|)
value|0.0
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_ifdef
ifdef|#
directive|ifdef
name|_IEEE_LIBM
end_ifdef

begin_comment
comment|/*  * redefining "___function" to "function" in _IEEE_LIBM mode  */
end_comment

begin_include
include|#
directive|include
file|"ieee_libm.h"
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
specifier|static
name|double
name|tiny
init|=
literal|1e-300
decl_stmt|,
name|half
init|=
literal|0.5
decl_stmt|,
name|one
init|=
literal|1.0
decl_stmt|,
name|two
init|=
literal|2.0
decl_stmt|,
name|c
init|=
literal|8.45062911510467529297e-01
decl_stmt|,
comment|/* (float)0.84506291151 */
comment|/*  * Coefficients for approximation to erf in [0,0.84375]  */
name|p0t8
init|=
literal|1.02703333676410051049867154944018394163280
decl_stmt|,
name|p0
init|=
literal|1.283791670955125638123339436800229927041e-0001
decl_stmt|,
name|p1
init|=
operator|-
literal|3.761263890318340796574473028946097022260e-0001
decl_stmt|,
name|p2
init|=
literal|1.128379167093567004871858633779992337238e-0001
decl_stmt|,
name|p3
init|=
operator|-
literal|2.686617064084433642889526516177508374437e-0002
decl_stmt|,
name|p4
init|=
literal|5.223977576966219409445780927846432273191e-0003
decl_stmt|,
name|p5
init|=
operator|-
literal|8.548323822001639515038738961618255438422e-0004
decl_stmt|,
name|p6
init|=
literal|1.205520092530505090384383082516403772317e-0004
decl_stmt|,
name|p7
init|=
operator|-
literal|1.492214100762529635365672665955239554276e-0005
decl_stmt|,
name|p8
init|=
literal|1.640186161764254363152286358441771740838e-0006
decl_stmt|,
name|p9
init|=
operator|-
literal|1.571599331700515057841960987689515895479e-0007
decl_stmt|,
name|p10
init|=
literal|1.073087585213621540635426191486561494058e-0008
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Coefficients for approximation to erf in [0.84375,1.25]  */
end_comment

begin_decl_stmt
specifier|static
name|double
name|pa0
init|=
operator|-
literal|2.362118560752659485957248365514511540287e-0003
decl_stmt|,
name|pa1
init|=
literal|4.148561186837483359654781492060070469522e-0001
decl_stmt|,
name|pa2
init|=
operator|-
literal|3.722078760357013107593507594535478633044e-0001
decl_stmt|,
name|pa3
init|=
literal|3.183466199011617316853636418691420262160e-0001
decl_stmt|,
name|pa4
init|=
operator|-
literal|1.108946942823966771253985510891237782544e-0001
decl_stmt|,
name|pa5
init|=
literal|3.547830432561823343969797140537411825179e-0002
decl_stmt|,
name|pa6
init|=
operator|-
literal|2.166375594868790886906539848893221184820e-0003
decl_stmt|,
name|qa1
init|=
literal|1.064208804008442270765369280952419863524e-0001
decl_stmt|,
name|qa2
init|=
literal|5.403979177021710663441167681878575087235e-0001
decl_stmt|,
name|qa3
init|=
literal|7.182865441419627066207655332170665812023e-0002
decl_stmt|,
name|qa4
init|=
literal|1.261712198087616469108438860983447773726e-0001
decl_stmt|,
name|qa5
init|=
literal|1.363708391202905087876983523620537833157e-0002
decl_stmt|,
name|qa6
init|=
literal|1.198449984679910764099772682882189711364e-0002
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * log(sqrt(pi)) for large x expansions.  * The tail (lsqrtPI_lo) is included in the rational  * approximations. */
end_comment

begin_decl_stmt
specifier|static
name|double
name|lsqrtPI_hi
init|=
literal|.5723649429247000819387380943226
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * lsqrtPI_lo = .000000000000000005132975581353913;  *  * Coefficients for approximation to erfc in [2, 4] */
end_comment

begin_decl_stmt
specifier|static
name|double
name|rb0
init|=
operator|-
literal|1.5306508387410807582e-010
decl_stmt|,
comment|/* includes lsqrtPI_lo */
name|rb1
init|=
literal|2.15592846101742183841910806188e-008
decl_stmt|,
name|rb2
init|=
literal|6.24998557732436510470108714799e-001
decl_stmt|,
name|rb3
init|=
literal|8.24849222231141787631258921465e+000
decl_stmt|,
name|rb4
init|=
literal|2.63974967372233173534823436057e+001
decl_stmt|,
name|rb5
init|=
literal|9.86383092541570505318304640241e+000
decl_stmt|,
name|rb6
init|=
operator|-
literal|7.28024154841991322228977878694e+000
decl_stmt|,
name|rb7
init|=
literal|5.96303287280680116566600190708e+000
decl_stmt|,
name|rb8
init|=
operator|-
literal|4.40070358507372993983608466806e+000
decl_stmt|,
name|rb9
init|=
literal|2.39923700182518073731330332521e+000
decl_stmt|,
name|rb10
init|=
operator|-
literal|6.89257464785841156285073338950e-001
decl_stmt|,
name|sb1
init|=
literal|1.56641558965626774835300238919e+001
decl_stmt|,
name|sb2
init|=
literal|7.20522741000949622502957936376e+001
decl_stmt|,
name|sb3
init|=
literal|9.60121069770492994166488642804e+001
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Coefficients for approximation to erfc in [1.25, 2] */
end_comment

begin_decl_stmt
specifier|static
name|double
name|rc0
init|=
operator|-
literal|2.47925334685189288817e-007
decl_stmt|,
comment|/* includes lsqrtPI_lo */
name|rc1
init|=
literal|1.28735722546372485255126993930e-005
decl_stmt|,
name|rc2
init|=
literal|6.24664954087883916855616917019e-001
decl_stmt|,
name|rc3
init|=
literal|4.69798884785807402408863708843e+000
decl_stmt|,
name|rc4
init|=
literal|7.61618295853929705430118701770e+000
decl_stmt|,
name|rc5
init|=
literal|9.15640208659364240872946538730e-001
decl_stmt|,
name|rc6
init|=
operator|-
literal|3.59753040425048631334448145935e-001
decl_stmt|,
name|rc7
init|=
literal|1.42862267989304403403849619281e-001
decl_stmt|,
name|rc8
init|=
operator|-
literal|4.74392758811439801958087514322e-002
decl_stmt|,
name|rc9
init|=
literal|1.09964787987580810135757047874e-002
decl_stmt|,
name|rc10
init|=
operator|-
literal|1.28856240494889325194638463046e-003
decl_stmt|,
name|sc1
init|=
literal|9.97395106984001955652274773456e+000
decl_stmt|,
name|sc2
init|=
literal|2.80952153365721279953959310660e+001
decl_stmt|,
name|sc3
init|=
literal|2.19826478142545234106819407316e+001
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  * Coefficients for approximation to  erfc in [4,28]  */
end_comment

begin_decl_stmt
specifier|static
name|double
name|rd0
init|=
operator|-
literal|2.1491361969012978677e-016
decl_stmt|,
comment|/* includes lsqrtPI_lo */
name|rd1
init|=
operator|-
literal|4.99999999999640086151350330820e-001
decl_stmt|,
name|rd2
init|=
literal|6.24999999772906433825880867516e-001
decl_stmt|,
name|rd3
init|=
operator|-
literal|1.54166659428052432723177389562e+000
decl_stmt|,
name|rd4
init|=
literal|5.51561147405411844601985649206e+000
decl_stmt|,
name|rd5
init|=
operator|-
literal|2.55046307982949826964613748714e+001
decl_stmt|,
name|rd6
init|=
literal|1.43631424382843846387913799845e+002
decl_stmt|,
name|rd7
init|=
operator|-
literal|9.45789244999420134263345971704e+002
decl_stmt|,
name|rd8
init|=
literal|6.94834146607051206956384703517e+003
decl_stmt|,
name|rd9
init|=
operator|-
literal|5.27176414235983393155038356781e+004
decl_stmt|,
name|rd10
init|=
literal|3.68530281128672766499221324921e+005
decl_stmt|,
name|rd11
init|=
operator|-
literal|2.06466642800404317677021026611e+006
decl_stmt|,
name|rd12
init|=
literal|7.78293889471135381609201431274e+006
decl_stmt|,
name|rd13
init|=
operator|-
literal|1.42821001129434127360582351685e+007
decl_stmt|;
end_decl_stmt

begin_function
name|double
name|erf
parameter_list|(
name|x
parameter_list|)
name|double
name|x
decl_stmt|;
block|{
name|double
name|R
decl_stmt|,
name|S
decl_stmt|,
name|P
decl_stmt|,
name|Q
decl_stmt|,
name|ax
decl_stmt|,
name|s
decl_stmt|,
name|y
decl_stmt|,
name|z
decl_stmt|,
name|r
decl_stmt|,
name|fabs
argument_list|()
decl_stmt|,
name|exp
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
name|finite
argument_list|(
name|x
argument_list|)
condition|)
block|{
comment|/* erf(nan)=nan */
if|if
condition|(
name|isnan
argument_list|(
name|x
argument_list|)
condition|)
return|return
operator|(
name|x
operator|)
return|;
return|return
operator|(
name|x
operator|>
literal|0
condition|?
name|one
else|:
operator|-
name|one
operator|)
return|;
comment|/* erf(+/-inf)= +/-1 */
block|}
if|if
condition|(
operator|(
name|ax
operator|=
name|x
operator|)
operator|<
literal|0
condition|)
name|ax
operator|=
operator|-
name|ax
expr_stmt|;
if|if
condition|(
name|ax
operator|<
literal|.84375
condition|)
block|{
if|if
condition|(
name|ax
operator|<
literal|3.7e-09
condition|)
block|{
if|if
condition|(
name|ax
operator|<
literal|1.0e-308
condition|)
return|return
literal|0.125
operator|*
operator|(
literal|8.0
operator|*
name|x
operator|+
name|p0t8
operator|*
name|x
operator|)
return|;
comment|/*avoid underflow */
return|return
name|x
operator|+
name|p0
operator|*
name|x
return|;
block|}
name|y
operator|=
name|x
operator|*
name|x
expr_stmt|;
name|r
operator|=
name|y
operator|*
operator|(
name|p1
operator|+
name|y
operator|*
operator|(
name|p2
operator|+
name|y
operator|*
operator|(
name|p3
operator|+
name|y
operator|*
operator|(
name|p4
operator|+
name|y
operator|*
operator|(
name|p5
operator|+
name|y
operator|*
operator|(
name|p6
operator|+
name|y
operator|*
operator|(
name|p7
operator|+
name|y
operator|*
operator|(
name|p8
operator|+
name|y
operator|*
operator|(
name|p9
operator|+
name|y
operator|*
name|p10
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
return|return
name|x
operator|+
name|x
operator|*
operator|(
name|p0
operator|+
name|r
operator|)
return|;
block|}
if|if
condition|(
name|ax
operator|<
literal|1.25
condition|)
block|{
comment|/* 0.84375<= |x|< 1.25 */
name|s
operator|=
name|fabs
argument_list|(
name|x
argument_list|)
operator|-
name|one
expr_stmt|;
name|P
operator|=
name|pa0
operator|+
name|s
operator|*
operator|(
name|pa1
operator|+
name|s
operator|*
operator|(
name|pa2
operator|+
name|s
operator|*
operator|(
name|pa3
operator|+
name|s
operator|*
operator|(
name|pa4
operator|+
name|s
operator|*
operator|(
name|pa5
operator|+
name|s
operator|*
name|pa6
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|Q
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|qa1
operator|+
name|s
operator|*
operator|(
name|qa2
operator|+
name|s
operator|*
operator|(
name|qa3
operator|+
name|s
operator|*
operator|(
name|qa4
operator|+
name|s
operator|*
operator|(
name|qa5
operator|+
name|s
operator|*
name|qa6
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
if|if
condition|(
name|x
operator|>=
literal|0
condition|)
return|return
operator|(
name|c
operator|+
name|P
operator|/
name|Q
operator|)
return|;
else|else
return|return
operator|(
operator|-
name|c
operator|-
name|P
operator|/
name|Q
operator|)
return|;
block|}
if|if
condition|(
name|ax
operator|>=
literal|6.0
condition|)
block|{
comment|/* inf>|x|>=6 */
if|if
condition|(
name|x
operator|>=
literal|0.0
condition|)
return|return
operator|(
name|one
operator|-
name|tiny
operator|)
return|;
else|else
return|return
operator|(
name|tiny
operator|-
name|one
operator|)
return|;
block|}
comment|/* 1.25<= |x|< 6 */
name|z
operator|=
operator|-
name|ax
operator|*
name|ax
expr_stmt|;
name|s
operator|=
operator|-
name|one
operator|/
name|z
expr_stmt|;
if|if
condition|(
name|ax
operator|<
literal|2.0
condition|)
block|{
name|R
operator|=
name|rc0
operator|+
name|s
operator|*
operator|(
name|rc1
operator|+
name|s
operator|*
operator|(
name|rc2
operator|+
name|s
operator|*
operator|(
name|rc3
operator|+
name|s
operator|*
operator|(
name|rc4
operator|+
name|s
operator|*
operator|(
name|rc5
operator|+
name|s
operator|*
operator|(
name|rc6
operator|+
name|s
operator|*
operator|(
name|rc7
operator|+
name|s
operator|*
operator|(
name|rc8
operator|+
name|s
operator|*
operator|(
name|rc9
operator|+
name|s
operator|*
name|rc10
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|S
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|sc1
operator|+
name|s
operator|*
operator|(
name|sc2
operator|+
name|s
operator|*
name|sc3
operator|)
operator|)
expr_stmt|;
block|}
else|else
block|{
name|R
operator|=
name|rb0
operator|+
name|s
operator|*
operator|(
name|rb1
operator|+
name|s
operator|*
operator|(
name|rb2
operator|+
name|s
operator|*
operator|(
name|rb3
operator|+
name|s
operator|*
operator|(
name|rb4
operator|+
name|s
operator|*
operator|(
name|rb5
operator|+
name|s
operator|*
operator|(
name|rb6
operator|+
name|s
operator|*
operator|(
name|rb7
operator|+
name|s
operator|*
operator|(
name|rb8
operator|+
name|s
operator|*
operator|(
name|rb9
operator|+
name|s
operator|*
name|rb10
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|S
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|sb1
operator|+
name|s
operator|*
operator|(
name|sb2
operator|+
name|s
operator|*
name|sb3
operator|)
operator|)
expr_stmt|;
block|}
name|y
operator|=
operator|(
name|R
operator|/
name|S
operator|-
literal|.5
operator|*
name|s
operator|)
operator|-
name|lsqrtPI_hi
expr_stmt|;
name|z
operator|+=
name|y
expr_stmt|;
name|z
operator|=
name|exp
argument_list|(
name|z
argument_list|)
operator|/
name|ax
expr_stmt|;
if|if
condition|(
name|x
operator|>=
literal|0
condition|)
return|return
operator|(
name|one
operator|-
name|z
operator|)
return|;
else|else
return|return
operator|(
name|z
operator|-
name|one
operator|)
return|;
block|}
end_function

begin_function
name|double
name|erfc
parameter_list|(
name|x
parameter_list|)
name|double
name|x
decl_stmt|;
block|{
name|double
name|R
decl_stmt|,
name|S
decl_stmt|,
name|P
decl_stmt|,
name|Q
decl_stmt|,
name|s
decl_stmt|,
name|ax
decl_stmt|,
name|y
decl_stmt|,
name|z
decl_stmt|,
name|r
decl_stmt|,
name|fabs
argument_list|()
decl_stmt|,
name|__exp__D
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
name|finite
argument_list|(
name|x
argument_list|)
condition|)
block|{
if|if
condition|(
name|isnan
argument_list|(
name|x
argument_list|)
condition|)
comment|/* erfc(NaN) = NaN */
return|return
operator|(
name|x
operator|)
return|;
elseif|else
if|if
condition|(
name|x
operator|>
literal|0
condition|)
comment|/* erfc(+-inf)=0,2 */
return|return
literal|0.0
return|;
else|else
return|return
literal|2.0
return|;
block|}
if|if
condition|(
operator|(
name|ax
operator|=
name|x
operator|)
operator|<
literal|0
condition|)
name|ax
operator|=
operator|-
name|ax
expr_stmt|;
if|if
condition|(
name|ax
operator|<
literal|.84375
condition|)
block|{
comment|/* |x|<0.84375 */
if|if
condition|(
name|ax
operator|<
literal|1.38777878078144568e-17
condition|)
comment|/* |x|<2**-56 */
return|return
name|one
operator|-
name|x
return|;
name|y
operator|=
name|x
operator|*
name|x
expr_stmt|;
name|r
operator|=
name|y
operator|*
operator|(
name|p1
operator|+
name|y
operator|*
operator|(
name|p2
operator|+
name|y
operator|*
operator|(
name|p3
operator|+
name|y
operator|*
operator|(
name|p4
operator|+
name|y
operator|*
operator|(
name|p5
operator|+
name|y
operator|*
operator|(
name|p6
operator|+
name|y
operator|*
operator|(
name|p7
operator|+
name|y
operator|*
operator|(
name|p8
operator|+
name|y
operator|*
operator|(
name|p9
operator|+
name|y
operator|*
name|p10
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
if|if
condition|(
name|ax
operator|<
literal|.0625
condition|)
block|{
comment|/* |x|<2**-4 */
return|return
operator|(
name|one
operator|-
operator|(
name|x
operator|+
name|x
operator|*
operator|(
name|p0
operator|+
name|r
operator|)
operator|)
operator|)
return|;
block|}
else|else
block|{
name|r
operator|=
name|x
operator|*
operator|(
name|p0
operator|+
name|r
operator|)
expr_stmt|;
name|r
operator|+=
operator|(
name|x
operator|-
name|half
operator|)
expr_stmt|;
return|return
operator|(
name|half
operator|-
name|r
operator|)
return|;
block|}
block|}
if|if
condition|(
name|ax
operator|<
literal|1.25
condition|)
block|{
comment|/* 0.84375<= |x|< 1.25 */
name|s
operator|=
name|ax
operator|-
name|one
expr_stmt|;
name|P
operator|=
name|pa0
operator|+
name|s
operator|*
operator|(
name|pa1
operator|+
name|s
operator|*
operator|(
name|pa2
operator|+
name|s
operator|*
operator|(
name|pa3
operator|+
name|s
operator|*
operator|(
name|pa4
operator|+
name|s
operator|*
operator|(
name|pa5
operator|+
name|s
operator|*
name|pa6
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|Q
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|qa1
operator|+
name|s
operator|*
operator|(
name|qa2
operator|+
name|s
operator|*
operator|(
name|qa3
operator|+
name|s
operator|*
operator|(
name|qa4
operator|+
name|s
operator|*
operator|(
name|qa5
operator|+
name|s
operator|*
name|qa6
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
if|if
condition|(
name|x
operator|>=
literal|0
condition|)
block|{
name|z
operator|=
name|one
operator|-
name|c
expr_stmt|;
return|return
name|z
operator|-
name|P
operator|/
name|Q
return|;
block|}
else|else
block|{
name|z
operator|=
name|c
operator|+
name|P
operator|/
name|Q
expr_stmt|;
return|return
name|one
operator|+
name|z
return|;
block|}
block|}
if|if
condition|(
name|ax
operator|>=
literal|28
condition|)
comment|/* Out of range */
if|if
condition|(
name|x
operator|>
literal|0
condition|)
return|return
operator|(
name|tiny
operator|*
name|tiny
operator|)
return|;
else|else
return|return
operator|(
name|two
operator|-
name|tiny
operator|)
return|;
name|z
operator|=
name|ax
expr_stmt|;
name|TRUNC
argument_list|(
name|z
argument_list|)
expr_stmt|;
name|y
operator|=
name|z
operator|-
name|ax
expr_stmt|;
name|y
operator|*=
operator|(
name|ax
operator|+
name|z
operator|)
expr_stmt|;
name|z
operator|*=
operator|-
name|z
expr_stmt|;
comment|/* Here z + y = -x^2 */
name|s
operator|=
name|one
operator|/
operator|(
operator|-
name|z
operator|-
name|y
operator|)
expr_stmt|;
comment|/* 1/(x*x) */
if|if
condition|(
name|ax
operator|>=
literal|4
condition|)
block|{
comment|/* 6<= ax */
name|R
operator|=
name|s
operator|*
operator|(
name|rd1
operator|+
name|s
operator|*
operator|(
name|rd2
operator|+
name|s
operator|*
operator|(
name|rd3
operator|+
name|s
operator|*
operator|(
name|rd4
operator|+
name|s
operator|*
operator|(
name|rd5
operator|+
name|s
operator|*
operator|(
name|rd6
operator|+
name|s
operator|*
operator|(
name|rd7
operator|+
name|s
operator|*
operator|(
name|rd8
operator|+
name|s
operator|*
operator|(
name|rd9
operator|+
name|s
operator|*
operator|(
name|rd10
operator|+
name|s
operator|*
operator|(
name|rd11
operator|+
name|s
operator|*
operator|(
name|rd12
operator|+
name|s
operator|*
name|rd13
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|y
operator|+=
name|rd0
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|ax
operator|>=
literal|2
condition|)
block|{
name|R
operator|=
name|rb0
operator|+
name|s
operator|*
operator|(
name|rb1
operator|+
name|s
operator|*
operator|(
name|rb2
operator|+
name|s
operator|*
operator|(
name|rb3
operator|+
name|s
operator|*
operator|(
name|rb4
operator|+
name|s
operator|*
operator|(
name|rb5
operator|+
name|s
operator|*
operator|(
name|rb6
operator|+
name|s
operator|*
operator|(
name|rb7
operator|+
name|s
operator|*
operator|(
name|rb8
operator|+
name|s
operator|*
operator|(
name|rb9
operator|+
name|s
operator|*
name|rb10
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|S
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|sb1
operator|+
name|s
operator|*
operator|(
name|sb2
operator|+
name|s
operator|*
name|sb3
operator|)
operator|)
expr_stmt|;
name|y
operator|+=
name|R
operator|/
name|S
expr_stmt|;
name|R
operator|=
operator|-
literal|.5
operator|*
name|s
expr_stmt|;
block|}
else|else
block|{
name|R
operator|=
name|rc0
operator|+
name|s
operator|*
operator|(
name|rc1
operator|+
name|s
operator|*
operator|(
name|rc2
operator|+
name|s
operator|*
operator|(
name|rc3
operator|+
name|s
operator|*
operator|(
name|rc4
operator|+
name|s
operator|*
operator|(
name|rc5
operator|+
name|s
operator|*
operator|(
name|rc6
operator|+
name|s
operator|*
operator|(
name|rc7
operator|+
name|s
operator|*
operator|(
name|rc8
operator|+
name|s
operator|*
operator|(
name|rc9
operator|+
name|s
operator|*
name|rc10
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|S
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|sc1
operator|+
name|s
operator|*
operator|(
name|sc2
operator|+
name|s
operator|*
name|sc3
operator|)
operator|)
expr_stmt|;
name|y
operator|+=
name|R
operator|/
name|S
expr_stmt|;
name|R
operator|=
operator|-
literal|.5
operator|*
name|s
expr_stmt|;
block|}
comment|/* return exp(-x^2 - lsqrtPI_hi + R + y)/x;	*/
name|s
operator|=
operator|(
operator|(
name|R
operator|+
name|y
operator|)
operator|-
name|lsqrtPI_hi
operator|)
operator|+
name|z
expr_stmt|;
name|y
operator|=
operator|(
operator|(
operator|(
name|z
operator|-
name|s
operator|)
operator|-
name|lsqrtPI_hi
operator|)
operator|+
name|R
operator|)
operator|+
name|y
expr_stmt|;
name|r
operator|=
name|__exp__D
argument_list|(
name|s
argument_list|,
name|y
argument_list|)
operator|/
name|x
expr_stmt|;
if|if
condition|(
name|x
operator|>
literal|0
condition|)
return|return
name|r
return|;
else|else
return|return
name|two
operator|-
name|r
return|;
block|}
end_function

end_unit

