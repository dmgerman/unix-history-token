begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2004 Poul-Henning Kamp<phk@FreeBSD.org>  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|<netinet/in.h>
end_include

begin_include
include|#
directive|include
file|<alias.h>
end_include

begin_comment
comment|/*  * These functions are for backwards compatibility and because apps may  * be linked against shlib versions, they have to be actual functions,  * we cannot inline them.  */
end_comment

begin_decl_stmt
specifier|static
name|struct
name|libalias
modifier|*
name|la
decl_stmt|;
end_decl_stmt

begin_function
name|void
name|PacketAliasInit
parameter_list|(
name|void
parameter_list|)
block|{
name|la
operator|=
name|LibAliasInit
argument_list|(
name|la
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|PacketAliasSetAddress
parameter_list|(
name|struct
name|in_addr
name|_addr
parameter_list|)
block|{
name|LibAliasSetAddress
argument_list|(
name|la
argument_list|,
name|_addr
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|PacketAliasSetFWBase
parameter_list|(
name|unsigned
name|int
name|_base
parameter_list|,
name|unsigned
name|int
name|_num
parameter_list|)
block|{
name|LibAliasSetFWBase
argument_list|(
name|la
argument_list|,
name|_base
argument_list|,
name|_num
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|PacketAliasSetSkinnyPort
parameter_list|(
name|unsigned
name|int
name|_port
parameter_list|)
block|{
name|LibAliasSetSkinnyPort
argument_list|(
name|la
argument_list|,
name|_port
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|unsigned
name|int
name|PacketAliasSetMode
parameter_list|(
name|unsigned
name|int
name|_flags
parameter_list|,
name|unsigned
name|int
name|_mask
parameter_list|)
block|{
return|return
name|LibAliasSetMode
argument_list|(
name|la
argument_list|,
name|_flags
argument_list|,
name|_mask
argument_list|)
return|;
block|}
end_function

begin_function
name|void
name|PacketAliasUninit
parameter_list|(
name|void
parameter_list|)
block|{
name|LibAliasUninit
argument_list|(
name|la
argument_list|)
expr_stmt|;
name|la
operator|=
name|NULL
expr_stmt|;
block|}
end_function

begin_function
name|int
name|PacketAliasIn
parameter_list|(
name|char
modifier|*
name|_ptr
parameter_list|,
name|int
name|_maxpacketsize
parameter_list|)
block|{
return|return
name|LibAliasIn
argument_list|(
name|la
argument_list|,
name|_ptr
argument_list|,
name|_maxpacketsize
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|PacketAliasOut
parameter_list|(
name|char
modifier|*
name|_ptr
parameter_list|,
name|int
name|_maxpacketsize
parameter_list|)
block|{
return|return
name|LibAliasOut
argument_list|(
name|la
argument_list|,
name|_ptr
argument_list|,
name|_maxpacketsize
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|PacketUnaliasOut
parameter_list|(
name|char
modifier|*
name|_ptr
parameter_list|,
name|int
name|_maxpacketsize
parameter_list|)
block|{
return|return
name|LibAliasUnaliasOut
argument_list|(
name|la
argument_list|,
name|_ptr
argument_list|,
name|_maxpacketsize
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|PacketAliasAddServer
parameter_list|(
name|struct
name|alias_link
modifier|*
name|_lnk
parameter_list|,
name|struct
name|in_addr
name|_addr
parameter_list|,
name|unsigned
name|short
name|_port
parameter_list|)
block|{
return|return
name|LibAliasAddServer
argument_list|(
name|la
argument_list|,
name|_lnk
argument_list|,
name|_addr
argument_list|,
name|_port
argument_list|)
return|;
block|}
end_function

begin_function
name|struct
name|alias_link
modifier|*
name|PacketAliasRedirectAddr
parameter_list|(
name|struct
name|in_addr
name|_src_addr
parameter_list|,
name|struct
name|in_addr
name|_alias_addr
parameter_list|)
block|{
return|return
name|LibAliasRedirectAddr
argument_list|(
name|la
argument_list|,
name|_src_addr
argument_list|,
name|_alias_addr
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|PacketAliasRedirectDynamic
parameter_list|(
name|struct
name|alias_link
modifier|*
name|_lnk
parameter_list|)
block|{
return|return
name|LibAliasRedirectDynamic
argument_list|(
name|la
argument_list|,
name|_lnk
argument_list|)
return|;
block|}
end_function

begin_function
name|void
name|PacketAliasRedirectDelete
parameter_list|(
name|struct
name|alias_link
modifier|*
name|_lnk
parameter_list|)
block|{
name|LibAliasRedirectDelete
argument_list|(
name|la
argument_list|,
name|_lnk
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|struct
name|alias_link
modifier|*
name|PacketAliasRedirectPort
parameter_list|(
name|struct
name|in_addr
name|_src_addr
parameter_list|,
name|unsigned
name|short
name|_src_port
parameter_list|,
name|struct
name|in_addr
name|_dst_addr
parameter_list|,
name|unsigned
name|short
name|_dst_port
parameter_list|,
name|struct
name|in_addr
name|_alias_addr
parameter_list|,
name|unsigned
name|short
name|_alias_port
parameter_list|,
name|unsigned
name|char
name|_proto
parameter_list|)
block|{
return|return
name|LibAliasRedirectPort
argument_list|(
name|la
argument_list|,
name|_src_addr
argument_list|,
name|_src_port
argument_list|,
name|_dst_addr
argument_list|,
name|_dst_port
argument_list|,
name|_alias_addr
argument_list|,
name|_alias_port
argument_list|,
name|_proto
argument_list|)
return|;
block|}
end_function

begin_function
name|struct
name|alias_link
modifier|*
name|PacketAliasRedirectProto
parameter_list|(
name|struct
name|in_addr
name|_src_addr
parameter_list|,
name|struct
name|in_addr
name|_dst_addr
parameter_list|,
name|struct
name|in_addr
name|_alias_addr
parameter_list|,
name|unsigned
name|char
name|_proto
parameter_list|)
block|{
return|return
name|LibAliasRedirectProto
argument_list|(
name|la
argument_list|,
name|_src_addr
argument_list|,
name|_dst_addr
argument_list|,
name|_alias_addr
argument_list|,
name|_proto
argument_list|)
return|;
block|}
end_function

begin_function
name|void
name|PacketAliasFragmentIn
parameter_list|(
name|char
modifier|*
name|_ptr
parameter_list|,
name|char
modifier|*
name|_ptr_fragment
parameter_list|)
block|{
name|LibAliasFragmentIn
argument_list|(
name|la
argument_list|,
name|_ptr
argument_list|,
name|_ptr_fragment
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|char
modifier|*
name|PacketAliasGetFragment
parameter_list|(
name|char
modifier|*
name|_ptr
parameter_list|)
block|{
return|return
name|LibAliasGetFragment
argument_list|(
name|la
argument_list|,
name|_ptr
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|PacketAliasSaveFragment
parameter_list|(
name|char
modifier|*
name|_ptr
parameter_list|)
block|{
return|return
name|LibAliasSaveFragment
argument_list|(
name|la
argument_list|,
name|_ptr
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|PacketAliasCheckNewLink
parameter_list|(
name|void
parameter_list|)
block|{
return|return
name|LibAliasCheckNewLink
argument_list|(
name|la
argument_list|)
return|;
block|}
end_function

begin_function
name|unsigned
name|short
name|PacketAliasInternetChecksum
parameter_list|(
name|unsigned
name|short
modifier|*
name|_ptr
parameter_list|,
name|int
name|_nbytes
parameter_list|)
block|{
return|return
name|LibAliasInternetChecksum
argument_list|(
name|la
argument_list|,
name|_ptr
argument_list|,
name|_nbytes
argument_list|)
return|;
block|}
end_function

begin_function
name|void
name|PacketAliasSetTarget
parameter_list|(
name|struct
name|in_addr
name|_target_addr
parameter_list|)
block|{
name|LibAliasSetTarget
argument_list|(
name|la
argument_list|,
name|_target_addr
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* Transparent proxying routines. */
end_comment

begin_function
name|int
name|PacketAliasProxyRule
parameter_list|(
specifier|const
name|char
modifier|*
name|_cmd
parameter_list|)
block|{
return|return
name|LibAliasProxyRule
argument_list|(
name|la
argument_list|,
name|_cmd
argument_list|)
return|;
block|}
end_function

end_unit

