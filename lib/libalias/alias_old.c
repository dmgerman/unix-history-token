begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*     This file can be considered a junk pile of old functions that     are either obsolete or have had their names changed.  In the     transition from alias2.1 to alias2.2, all the function names     were rationalized so that they began with "PacketAlias..."      These functions are included for backwards compatibility.   */
end_comment

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|<netinet/in_systm.h>
end_include

begin_include
include|#
directive|include
file|<netinet/in.h>
end_include

begin_include
include|#
directive|include
file|<netinet/ip.h>
end_include

begin_include
include|#
directive|include
file|"alias.h"
end_include

begin_include
include|#
directive|include
file|"alias_local.h"
end_include

begin_function
name|void
name|InitPacketAlias
parameter_list|(
name|void
parameter_list|)
block|{
name|PacketAliasInit
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
name|void
name|SetPacketAliasAddress
parameter_list|(
name|struct
name|in_addr
name|addr
parameter_list|)
block|{
name|PacketAliasSetAddress
argument_list|(
name|addr
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|unsigned
name|int
name|SetPacketAliasMode
parameter_list|(
name|unsigned
name|int
name|flags
parameter_list|,
name|unsigned
name|int
name|mask
parameter_list|)
block|{
return|return
name|PacketAliasSetMode
argument_list|(
name|flags
argument_list|,
name|mask
argument_list|)
return|;
block|}
end_function

begin_function
name|int
name|PacketAliasPermanentLink
parameter_list|(
name|struct
name|in_addr
name|src_addr
parameter_list|,
name|u_short
name|src_port
parameter_list|,
name|struct
name|in_addr
name|dst_addr
parameter_list|,
name|u_short
name|dst_port
parameter_list|,
name|u_short
name|alias_port
parameter_list|,
name|u_char
name|proto
parameter_list|)
block|{
name|struct
name|alias_link
modifier|*
name|link
decl_stmt|;
name|struct
name|in_addr
name|null_address
decl_stmt|;
name|null_address
operator|.
name|s_addr
operator|=
literal|0
expr_stmt|;
name|link
operator|=
name|PacketAliasRedirectPort
argument_list|(
name|src_addr
argument_list|,
name|src_port
argument_list|,
name|dst_addr
argument_list|,
name|dst_port
argument_list|,
name|null_address
argument_list|,
name|alias_port
argument_list|,
name|proto
argument_list|)
expr_stmt|;
if|if
condition|(
name|link
operator|==
name|NULL
condition|)
return|return
operator|-
literal|1
return|;
else|else
return|return
literal|0
return|;
block|}
end_function

begin_function
name|int
name|SaveFragmentPtr
parameter_list|(
name|char
modifier|*
name|ptr
parameter_list|)
block|{
return|return
name|PacketAliasSaveFragment
argument_list|(
name|ptr
argument_list|)
return|;
block|}
end_function

begin_function
name|char
modifier|*
name|GetNextFragmentPtr
parameter_list|(
name|char
modifier|*
name|ptr
parameter_list|)
block|{
return|return
name|PacketAliasGetFragment
argument_list|(
name|ptr
argument_list|)
return|;
block|}
end_function

begin_function
name|void
name|FragmentAliasIn
parameter_list|(
name|char
modifier|*
name|header
parameter_list|,
name|char
modifier|*
name|fragment
parameter_list|)
block|{
name|PacketAliasFragmentIn
argument_list|(
name|header
argument_list|,
name|fragment
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|u_short
name|InternetChecksum
parameter_list|(
name|u_short
modifier|*
name|ptr
parameter_list|,
name|int
name|len
parameter_list|)
block|{
return|return
name|PacketAliasInternetChecksum
argument_list|(
name|ptr
argument_list|,
name|len
argument_list|)
return|;
block|}
end_function

end_unit

