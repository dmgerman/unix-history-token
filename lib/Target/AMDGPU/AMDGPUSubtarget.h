begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|//=====-- AMDGPUSubtarget.h - Define Subtarget for AMDGPU ------*- C++ -*-====//
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|//                     The LLVM Compiler Infrastructure
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// This file is distributed under the University of Illinois Open Source
end_comment

begin_comment
comment|// License. See LICENSE.TXT for details.
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|//==-----------------------------------------------------------------------===//
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|/// \file
end_comment

begin_comment
comment|/// \brief AMDGPU specific subclass of TargetSubtarget.
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|//===----------------------------------------------------------------------===//
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|LLVM_LIB_TARGET_AMDGPU_AMDGPUSUBTARGET_H
end_ifndef

begin_define
define|#
directive|define
name|LLVM_LIB_TARGET_AMDGPU_AMDGPUSUBTARGET_H
end_define

begin_include
include|#
directive|include
file|"AMDGPU.h"
end_include

begin_include
include|#
directive|include
file|"R600FrameLowering.h"
end_include

begin_include
include|#
directive|include
file|"R600ISelLowering.h"
end_include

begin_include
include|#
directive|include
file|"R600InstrInfo.h"
end_include

begin_include
include|#
directive|include
file|"SIFrameLowering.h"
end_include

begin_include
include|#
directive|include
file|"SIISelLowering.h"
end_include

begin_include
include|#
directive|include
file|"SIInstrInfo.h"
end_include

begin_include
include|#
directive|include
file|"SIMachineFunctionInfo.h"
end_include

begin_include
include|#
directive|include
file|"Utils/AMDGPUBaseInfo.h"
end_include

begin_include
include|#
directive|include
file|"llvm/ADT/Triple.h"
end_include

begin_include
include|#
directive|include
file|"llvm/CodeGen/GlobalISel/GISelAccessor.h"
end_include

begin_include
include|#
directive|include
file|"llvm/CodeGen/MachineFunction.h"
end_include

begin_include
include|#
directive|include
file|"llvm/CodeGen/SelectionDAGTargetInfo.h"
end_include

begin_include
include|#
directive|include
file|"llvm/MC/MCInstrItineraries.h"
end_include

begin_include
include|#
directive|include
file|"llvm/Support/MathExtras.h"
end_include

begin_include
include|#
directive|include
file|<cassert>
end_include

begin_include
include|#
directive|include
file|<cstdint>
end_include

begin_include
include|#
directive|include
file|<memory>
end_include

begin_include
include|#
directive|include
file|<utility>
end_include

begin_define
define|#
directive|define
name|GET_SUBTARGETINFO_HEADER
end_define

begin_include
include|#
directive|include
file|"AMDGPUGenSubtargetInfo.inc"
end_include

begin_decl_stmt
name|namespace
name|llvm
block|{
name|class
name|StringRef
decl_stmt|;
name|class
name|AMDGPUSubtarget
range|:
name|public
name|AMDGPUGenSubtargetInfo
block|{
name|public
operator|:
expr|enum
name|Generation
block|{
name|R600
operator|=
literal|0
block|,
name|R700
block|,
name|EVERGREEN
block|,
name|NORTHERN_ISLANDS
block|,
name|SOUTHERN_ISLANDS
block|,
name|SEA_ISLANDS
block|,
name|VOLCANIC_ISLANDS
block|,
name|GFX9
block|,   }
block|;    enum
block|{
name|ISAVersion0_0_0
block|,
name|ISAVersion6_0_0
block|,
name|ISAVersion6_0_1
block|,
name|ISAVersion7_0_0
block|,
name|ISAVersion7_0_1
block|,
name|ISAVersion7_0_2
block|,
name|ISAVersion7_0_3
block|,
name|ISAVersion8_0_0
block|,
name|ISAVersion8_0_1
block|,
name|ISAVersion8_0_2
block|,
name|ISAVersion8_0_3
block|,
name|ISAVersion8_0_4
block|,
name|ISAVersion8_1_0
block|,
name|ISAVersion9_0_0
block|,
name|ISAVersion9_0_1
block|,
name|ISAVersion9_0_2
block|,
name|ISAVersion9_0_3
block|}
block|;    enum
name|TrapHandlerAbi
block|{
name|TrapHandlerAbiNone
operator|=
literal|0
block|,
name|TrapHandlerAbiHsa
operator|=
literal|1
block|}
block|;    enum
name|TrapID
block|{
name|TrapIDHardwareReserved
operator|=
literal|0
block|,
name|TrapIDHSADebugTrap
operator|=
literal|1
block|,
name|TrapIDLLVMTrap
operator|=
literal|2
block|,
name|TrapIDLLVMDebugTrap
operator|=
literal|3
block|,
name|TrapIDDebugBreakpoint
operator|=
literal|7
block|,
name|TrapIDDebugReserved8
operator|=
literal|8
block|,
name|TrapIDDebugReservedFE
operator|=
literal|0xfe
block|,
name|TrapIDDebugReservedFF
operator|=
literal|0xff
block|}
block|;    enum
name|TrapRegValues
block|{
name|LLVMTrapHandlerRegValue
operator|=
literal|1
block|}
block|;
name|protected
operator|:
comment|// Basic subtarget description.
name|Triple
name|TargetTriple
block|;
name|Generation
name|Gen
block|;
name|unsigned
name|IsaVersion
block|;
name|unsigned
name|WavefrontSize
block|;
name|int
name|LocalMemorySize
block|;
name|int
name|LDSBankCount
block|;
name|unsigned
name|MaxPrivateElementSize
block|;
comment|// Possibly statically set by tablegen, but may want to be overridden.
name|bool
name|FastFMAF32
block|;
name|bool
name|HalfRate64Ops
block|;
comment|// Dynamially set bits that enable features.
name|bool
name|FP32Denormals
block|;
name|bool
name|FP64FP16Denormals
block|;
name|bool
name|FPExceptions
block|;
name|bool
name|DX10Clamp
block|;
name|bool
name|FlatForGlobal
block|;
name|bool
name|AutoWaitcntBeforeBarrier
block|;
name|bool
name|UnalignedScratchAccess
block|;
name|bool
name|UnalignedBufferAccess
block|;
name|bool
name|HasApertureRegs
block|;
name|bool
name|EnableXNACK
block|;
name|bool
name|TrapHandler
block|;
name|bool
name|DebuggerInsertNops
block|;
name|bool
name|DebuggerReserveRegs
block|;
name|bool
name|DebuggerEmitPrologue
block|;
comment|// Used as options.
name|bool
name|EnableVGPRSpilling
block|;
name|bool
name|EnablePromoteAlloca
block|;
name|bool
name|EnableLoadStoreOpt
block|;
name|bool
name|EnableUnsafeDSOffsetFolding
block|;
name|bool
name|EnableSIScheduler
block|;
name|bool
name|DumpCode
block|;
comment|// Subtarget statically properties set by tablegen
name|bool
name|FP64
block|;
name|bool
name|IsGCN
block|;
name|bool
name|GCN1Encoding
block|;
name|bool
name|GCN3Encoding
block|;
name|bool
name|CIInsts
block|;
name|bool
name|GFX9Insts
block|;
name|bool
name|SGPRInitBug
block|;
name|bool
name|HasSMemRealTime
block|;
name|bool
name|Has16BitInsts
block|;
name|bool
name|HasVOP3PInsts
block|;
name|bool
name|HasMovrel
block|;
name|bool
name|HasVGPRIndexMode
block|;
name|bool
name|HasScalarStores
block|;
name|bool
name|HasInv2PiInlineImm
block|;
name|bool
name|HasSDWA
block|;
name|bool
name|HasSDWAOmod
block|;
name|bool
name|HasSDWAScalar
block|;
name|bool
name|HasSDWASdst
block|;
name|bool
name|HasSDWAMac
block|;
name|bool
name|HasSDWAOutModsVOPC
block|;
name|bool
name|HasDPP
block|;
name|bool
name|FlatAddressSpace
block|;
name|bool
name|FlatInstOffsets
block|;
name|bool
name|FlatGlobalInsts
block|;
name|bool
name|FlatScratchInsts
block|;
name|bool
name|R600ALUInst
block|;
name|bool
name|CaymanISA
block|;
name|bool
name|CFALUBug
block|;
name|bool
name|HasVertexCache
block|;
name|short
name|TexVTXClauseSize
block|;
name|bool
name|ScalarizeGlobal
block|;
comment|// Dummy feature to use for assembler in tablegen.
name|bool
name|FeatureDisable
block|;
name|InstrItineraryData
name|InstrItins
block|;
name|SelectionDAGTargetInfo
name|TSInfo
block|;
name|AMDGPUAS
name|AS
block|;
name|public
operator|:
name|AMDGPUSubtarget
argument_list|(
argument|const Triple&TT
argument_list|,
argument|StringRef GPU
argument_list|,
argument|StringRef FS
argument_list|,
argument|const TargetMachine&TM
argument_list|)
block|;
operator|~
name|AMDGPUSubtarget
argument_list|()
name|override
block|;
name|AMDGPUSubtarget
operator|&
name|initializeSubtargetDependencies
argument_list|(
argument|const Triple&TT
argument_list|,
argument|StringRef GPU
argument_list|,
argument|StringRef FS
argument_list|)
block|;
specifier|const
name|AMDGPUInstrInfo
operator|*
name|getInstrInfo
argument_list|()
specifier|const
name|override
operator|=
literal|0
block|;
specifier|const
name|AMDGPUFrameLowering
operator|*
name|getFrameLowering
argument_list|()
specifier|const
name|override
operator|=
literal|0
block|;
specifier|const
name|AMDGPUTargetLowering
operator|*
name|getTargetLowering
argument_list|()
specifier|const
name|override
operator|=
literal|0
block|;
specifier|const
name|AMDGPURegisterInfo
operator|*
name|getRegisterInfo
argument_list|()
specifier|const
name|override
operator|=
literal|0
block|;
specifier|const
name|InstrItineraryData
operator|*
name|getInstrItineraryData
argument_list|()
specifier|const
name|override
block|{
return|return
operator|&
name|InstrItins
return|;
block|}
comment|// Nothing implemented, just prevent crashes on use.
specifier|const
name|SelectionDAGTargetInfo
operator|*
name|getSelectionDAGInfo
argument_list|()
specifier|const
name|override
block|{
return|return
operator|&
name|TSInfo
return|;
block|}
name|void
name|ParseSubtargetFeatures
argument_list|(
argument|StringRef CPU
argument_list|,
argument|StringRef FS
argument_list|)
block|;
name|bool
name|isAmdHsaOS
argument_list|()
specifier|const
block|{
return|return
name|TargetTriple
operator|.
name|getOS
argument_list|()
operator|==
name|Triple
operator|::
name|AMDHSA
return|;
block|}
name|bool
name|isMesa3DOS
argument_list|()
specifier|const
block|{
return|return
name|TargetTriple
operator|.
name|getOS
argument_list|()
operator|==
name|Triple
operator|::
name|Mesa3D
return|;
block|}
name|bool
name|isOpenCLEnv
argument_list|()
specifier|const
block|{
return|return
name|TargetTriple
operator|.
name|getEnvironment
argument_list|()
operator|==
name|Triple
operator|::
name|OpenCL
operator|||
name|TargetTriple
operator|.
name|getEnvironmentName
argument_list|()
operator|==
literal|"amdgizcl"
return|;
block|}
name|Generation
name|getGeneration
argument_list|()
specifier|const
block|{
return|return
name|Gen
return|;
block|}
name|unsigned
name|getWavefrontSize
argument_list|()
specifier|const
block|{
return|return
name|WavefrontSize
return|;
block|}
name|int
name|getLocalMemorySize
argument_list|()
specifier|const
block|{
return|return
name|LocalMemorySize
return|;
block|}
name|int
name|getLDSBankCount
argument_list|()
specifier|const
block|{
return|return
name|LDSBankCount
return|;
block|}
name|unsigned
name|getMaxPrivateElementSize
argument_list|()
specifier|const
block|{
return|return
name|MaxPrivateElementSize
return|;
block|}
name|AMDGPUAS
name|getAMDGPUAS
argument_list|()
specifier|const
block|{
return|return
name|AS
return|;
block|}
name|bool
name|has16BitInsts
argument_list|()
specifier|const
block|{
return|return
name|Has16BitInsts
return|;
block|}
name|bool
name|hasVOP3PInsts
argument_list|()
specifier|const
block|{
return|return
name|HasVOP3PInsts
return|;
block|}
name|bool
name|hasHWFP64
argument_list|()
specifier|const
block|{
return|return
name|FP64
return|;
block|}
name|bool
name|hasFastFMAF32
argument_list|()
specifier|const
block|{
return|return
name|FastFMAF32
return|;
block|}
name|bool
name|hasHalfRate64Ops
argument_list|()
specifier|const
block|{
return|return
name|HalfRate64Ops
return|;
block|}
name|bool
name|hasAddr64
argument_list|()
specifier|const
block|{
return|return
operator|(
name|getGeneration
argument_list|()
operator|<
name|VOLCANIC_ISLANDS
operator|)
return|;
block|}
name|bool
name|hasBFE
argument_list|()
specifier|const
block|{
return|return
operator|(
name|getGeneration
argument_list|()
operator|>=
name|EVERGREEN
operator|)
return|;
block|}
name|bool
name|hasBFI
argument_list|()
specifier|const
block|{
return|return
operator|(
name|getGeneration
argument_list|()
operator|>=
name|EVERGREEN
operator|)
return|;
block|}
name|bool
name|hasBFM
argument_list|()
specifier|const
block|{
return|return
name|hasBFE
argument_list|()
return|;
block|}
name|bool
name|hasBCNT
argument_list|(
argument|unsigned Size
argument_list|)
specifier|const
block|{
if|if
condition|(
name|Size
operator|==
literal|32
condition|)
return|return
operator|(
name|getGeneration
argument_list|()
operator|>=
name|EVERGREEN
operator|)
return|;
if|if
condition|(
name|Size
operator|==
literal|64
condition|)
return|return
operator|(
name|getGeneration
argument_list|()
operator|>=
name|SOUTHERN_ISLANDS
operator|)
return|;
return|return
name|false
return|;
block|}
end_decl_stmt

begin_expr_stmt
name|bool
name|hasMulU24
argument_list|()
specifier|const
block|{
return|return
operator|(
name|getGeneration
argument_list|()
operator|>=
name|EVERGREEN
operator|)
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasMulI24
argument_list|()
specifier|const
block|{
return|return
operator|(
name|getGeneration
argument_list|()
operator|>=
name|SOUTHERN_ISLANDS
operator|||
name|hasCaymanISA
argument_list|()
operator|)
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasFFBL
argument_list|()
specifier|const
block|{
return|return
operator|(
name|getGeneration
argument_list|()
operator|>=
name|EVERGREEN
operator|)
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasFFBH
argument_list|()
specifier|const
block|{
return|return
operator|(
name|getGeneration
argument_list|()
operator|>=
name|EVERGREEN
operator|)
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasMed3_16
argument_list|()
specifier|const
block|{
return|return
name|getGeneration
argument_list|()
operator|>=
name|GFX9
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasMin3Max3_16
argument_list|()
specifier|const
block|{
return|return
name|getGeneration
argument_list|()
operator|>=
name|GFX9
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasCARRY
argument_list|()
specifier|const
block|{
return|return
operator|(
name|getGeneration
argument_list|()
operator|>=
name|EVERGREEN
operator|)
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasBORROW
argument_list|()
specifier|const
block|{
return|return
operator|(
name|getGeneration
argument_list|()
operator|>=
name|EVERGREEN
operator|)
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasCaymanISA
argument_list|()
specifier|const
block|{
return|return
name|CaymanISA
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|TrapHandlerAbi
name|getTrapHandlerAbi
argument_list|()
specifier|const
block|{
return|return
name|isAmdHsaOS
argument_list|()
operator|?
name|TrapHandlerAbiHsa
operator|:
name|TrapHandlerAbiNone
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|isPromoteAllocaEnabled
argument_list|()
specifier|const
block|{
return|return
name|EnablePromoteAlloca
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|unsafeDSOffsetFoldingEnabled
argument_list|()
specifier|const
block|{
return|return
name|EnableUnsafeDSOffsetFolding
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|dumpCode
argument_list|()
specifier|const
block|{
return|return
name|DumpCode
return|;
block|}
end_expr_stmt

begin_comment
comment|/// Return the amount of LDS that can be used that will not restrict the
end_comment

begin_comment
comment|/// occupancy lower than WaveCount.
end_comment

begin_decl_stmt
name|unsigned
name|getMaxLocalMemSizeWithWaveCount
argument_list|(
name|unsigned
name|WaveCount
argument_list|,
specifier|const
name|Function
operator|&
argument_list|)
decl|const
decl_stmt|;
end_decl_stmt

begin_comment
comment|/// Inverse of getMaxLocalMemWithWaveCount. Return the maximum wavecount if
end_comment

begin_comment
comment|/// the given LDS memory size is the only constraint.
end_comment

begin_decl_stmt
name|unsigned
name|getOccupancyWithLocalMemSize
argument_list|(
name|uint32_t
name|Bytes
argument_list|,
specifier|const
name|Function
operator|&
argument_list|)
decl|const
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|unsigned
name|getOccupancyWithLocalMemSize
argument_list|(
specifier|const
name|MachineFunction
operator|&
name|MF
argument_list|)
decl|const
block|{
specifier|const
specifier|auto
modifier|*
name|MFI
init|=
name|MF
operator|.
name|getInfo
operator|<
name|SIMachineFunctionInfo
operator|>
operator|(
operator|)
decl_stmt|;
return|return
name|getOccupancyWithLocalMemSize
argument_list|(
name|MFI
operator|->
name|getLDSSize
argument_list|()
argument_list|,
operator|*
name|MF
operator|.
name|getFunction
argument_list|()
argument_list|)
return|;
block|}
end_decl_stmt

begin_expr_stmt
name|bool
name|hasFP16Denormals
argument_list|()
specifier|const
block|{
return|return
name|FP64FP16Denormals
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasFP32Denormals
argument_list|()
specifier|const
block|{
return|return
name|FP32Denormals
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasFP64Denormals
argument_list|()
specifier|const
block|{
return|return
name|FP64FP16Denormals
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasFPExceptions
argument_list|()
specifier|const
block|{
return|return
name|FPExceptions
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|enableDX10Clamp
argument_list|()
specifier|const
block|{
return|return
name|DX10Clamp
return|;
block|}
end_expr_stmt

begin_decl_stmt
name|bool
name|enableIEEEBit
argument_list|(
specifier|const
name|MachineFunction
operator|&
name|MF
argument_list|)
decl|const
block|{
return|return
name|AMDGPU
operator|::
name|isCompute
argument_list|(
name|MF
operator|.
name|getFunction
argument_list|()
operator|->
name|getCallingConv
argument_list|()
argument_list|)
return|;
block|}
end_decl_stmt

begin_expr_stmt
name|bool
name|useFlatForGlobal
argument_list|()
specifier|const
block|{
return|return
name|FlatForGlobal
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasAutoWaitcntBeforeBarrier
argument_list|()
specifier|const
block|{
return|return
name|AutoWaitcntBeforeBarrier
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasUnalignedBufferAccess
argument_list|()
specifier|const
block|{
return|return
name|UnalignedBufferAccess
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasUnalignedScratchAccess
argument_list|()
specifier|const
block|{
return|return
name|UnalignedScratchAccess
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasApertureRegs
argument_list|()
specifier|const
block|{
return|return
name|HasApertureRegs
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|isTrapHandlerEnabled
argument_list|()
specifier|const
block|{
return|return
name|TrapHandler
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|isXNACKEnabled
argument_list|()
specifier|const
block|{
return|return
name|EnableXNACK
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasFlatAddressSpace
argument_list|()
specifier|const
block|{
return|return
name|FlatAddressSpace
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasFlatInstOffsets
argument_list|()
specifier|const
block|{
return|return
name|FlatInstOffsets
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasFlatGlobalInsts
argument_list|()
specifier|const
block|{
return|return
name|FlatGlobalInsts
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasFlatScratchInsts
argument_list|()
specifier|const
block|{
return|return
name|FlatScratchInsts
return|;
block|}
end_expr_stmt

begin_decl_stmt
name|bool
name|isMesaKernel
argument_list|(
specifier|const
name|MachineFunction
operator|&
name|MF
argument_list|)
decl|const
block|{
return|return
name|isMesa3DOS
argument_list|()
operator|&&
operator|!
name|AMDGPU
operator|::
name|isShader
argument_list|(
name|MF
operator|.
name|getFunction
argument_list|()
operator|->
name|getCallingConv
argument_list|()
argument_list|)
return|;
block|}
end_decl_stmt

begin_comment
comment|// Covers VS/PS/CS graphics shaders
end_comment

begin_decl_stmt
name|bool
name|isMesaGfxShader
argument_list|(
specifier|const
name|MachineFunction
operator|&
name|MF
argument_list|)
decl|const
block|{
return|return
name|isMesa3DOS
argument_list|()
operator|&&
name|AMDGPU
operator|::
name|isShader
argument_list|(
name|MF
operator|.
name|getFunction
argument_list|()
operator|->
name|getCallingConv
argument_list|()
argument_list|)
return|;
block|}
end_decl_stmt

begin_decl_stmt
name|bool
name|isAmdCodeObjectV2
argument_list|(
specifier|const
name|MachineFunction
operator|&
name|MF
argument_list|)
decl|const
block|{
return|return
name|isAmdHsaOS
argument_list|()
operator|||
name|isMesaKernel
argument_list|(
name|MF
argument_list|)
return|;
block|}
end_decl_stmt

begin_expr_stmt
name|bool
name|hasFminFmaxLegacy
argument_list|()
specifier|const
block|{
return|return
name|getGeneration
argument_list|()
operator|<
name|AMDGPUSubtarget
operator|::
name|VOLCANIC_ISLANDS
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasSDWA
argument_list|()
specifier|const
block|{
return|return
name|HasSDWA
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasSDWAOmod
argument_list|()
specifier|const
block|{
return|return
name|HasSDWAOmod
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasSDWAScalar
argument_list|()
specifier|const
block|{
return|return
name|HasSDWAScalar
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasSDWASdst
argument_list|()
specifier|const
block|{
return|return
name|HasSDWASdst
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasSDWAMac
argument_list|()
specifier|const
block|{
return|return
name|HasSDWAMac
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|hasSDWAOutModsVOPC
argument_list|()
specifier|const
block|{
return|return
name|HasSDWAOutModsVOPC
return|;
block|}
end_expr_stmt

begin_comment
comment|/// \brief Returns the offset in bytes from the start of the input buffer
end_comment

begin_comment
comment|///        of the first explicit kernel argument.
end_comment

begin_decl_stmt
name|unsigned
name|getExplicitKernelArgOffset
argument_list|(
specifier|const
name|MachineFunction
operator|&
name|MF
argument_list|)
decl|const
block|{
return|return
name|isAmdCodeObjectV2
argument_list|(
name|MF
argument_list|)
condition|?
literal|0
else|:
literal|36
return|;
block|}
end_decl_stmt

begin_expr_stmt
name|unsigned
name|getAlignmentForImplicitArgPtr
argument_list|()
specifier|const
block|{
return|return
name|isAmdHsaOS
argument_list|()
operator|?
literal|8
operator|:
literal|4
return|;
block|}
end_expr_stmt

begin_decl_stmt
name|unsigned
name|getImplicitArgNumBytes
argument_list|(
specifier|const
name|MachineFunction
operator|&
name|MF
argument_list|)
decl|const
block|{
if|if
condition|(
name|isMesaKernel
argument_list|(
name|MF
argument_list|)
condition|)
return|return
literal|16
return|;
if|if
condition|(
name|isAmdHsaOS
argument_list|()
operator|&&
name|isOpenCLEnv
argument_list|()
condition|)
return|return
literal|32
return|;
return|return
literal|0
return|;
block|}
end_decl_stmt

begin_comment
comment|// Scratch is allocated in 256 dword per wave blocks for the entire
end_comment

begin_comment
comment|// wavefront. When viewed from the perspecive of an arbitrary workitem, this
end_comment

begin_comment
comment|// is 4-byte aligned.
end_comment

begin_expr_stmt
name|unsigned
name|getStackAlignment
argument_list|()
specifier|const
block|{
return|return
literal|4
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|enableMachineScheduler
argument_list|()
specifier|const
name|override
block|{
return|return
name|true
return|;
block|}
end_expr_stmt

begin_expr_stmt
name|bool
name|enableSubRegLiveness
argument_list|()
specifier|const
name|override
block|{
return|return
name|true
return|;
block|}
end_expr_stmt

begin_function
name|void
name|setScalarizeGlobalBehavior
parameter_list|(
name|bool
name|b
parameter_list|)
block|{
name|ScalarizeGlobal
operator|=
name|b
expr_stmt|;
block|}
end_function

begin_expr_stmt
name|bool
name|getScalarizeGlobalBehavior
argument_list|()
specifier|const
block|{
return|return
name|ScalarizeGlobal
return|;
block|}
end_expr_stmt

begin_comment
comment|/// \returns Number of execution units per compute unit supported by the
end_comment

begin_comment
comment|/// subtarget.
end_comment

begin_expr_stmt
name|unsigned
name|getEUsPerCU
argument_list|()
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getEUsPerCU
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|)
return|;
block|}
end_expr_stmt

begin_comment
comment|/// \returns Maximum number of work groups per compute unit supported by the
end_comment

begin_comment
comment|/// subtarget and limited by given \p FlatWorkGroupSize.
end_comment

begin_decl_stmt
name|unsigned
name|getMaxWorkGroupsPerCU
argument_list|(
name|unsigned
name|FlatWorkGroupSize
argument_list|)
decl|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getMaxWorkGroupsPerCU
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|,
name|FlatWorkGroupSize
argument_list|)
return|;
block|}
end_decl_stmt

begin_comment
comment|/// \returns Maximum number of waves per compute unit supported by the
end_comment

begin_comment
comment|/// subtarget without any kind of limitation.
end_comment

begin_expr_stmt
name|unsigned
name|getMaxWavesPerCU
argument_list|()
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getMaxWavesPerCU
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|)
return|;
block|}
end_expr_stmt

begin_comment
comment|/// \returns Maximum number of waves per compute unit supported by the
end_comment

begin_comment
comment|/// subtarget and limited by given \p FlatWorkGroupSize.
end_comment

begin_decl_stmt
name|unsigned
name|getMaxWavesPerCU
argument_list|(
name|unsigned
name|FlatWorkGroupSize
argument_list|)
decl|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getMaxWavesPerCU
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|,
name|FlatWorkGroupSize
argument_list|)
return|;
block|}
end_decl_stmt

begin_comment
comment|/// \returns Minimum number of waves per execution unit supported by the
end_comment

begin_comment
comment|/// subtarget.
end_comment

begin_expr_stmt
name|unsigned
name|getMinWavesPerEU
argument_list|()
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getMinWavesPerEU
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|)
return|;
block|}
end_expr_stmt

begin_comment
comment|/// \returns Maximum number of waves per execution unit supported by the
end_comment

begin_comment
comment|/// subtarget without any kind of limitation.
end_comment

begin_expr_stmt
name|unsigned
name|getMaxWavesPerEU
argument_list|()
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getMaxWavesPerEU
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|)
return|;
block|}
end_expr_stmt

begin_comment
comment|/// \returns Maximum number of waves per execution unit supported by the
end_comment

begin_comment
comment|/// subtarget and limited by given \p FlatWorkGroupSize.
end_comment

begin_decl_stmt
name|unsigned
name|getMaxWavesPerEU
argument_list|(
name|unsigned
name|FlatWorkGroupSize
argument_list|)
decl|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getMaxWavesPerEU
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|,
name|FlatWorkGroupSize
argument_list|)
return|;
block|}
end_decl_stmt

begin_comment
comment|/// \returns Minimum flat work group size supported by the subtarget.
end_comment

begin_expr_stmt
name|unsigned
name|getMinFlatWorkGroupSize
argument_list|()
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getMinFlatWorkGroupSize
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|)
return|;
block|}
end_expr_stmt

begin_comment
comment|/// \returns Maximum flat work group size supported by the subtarget.
end_comment

begin_expr_stmt
name|unsigned
name|getMaxFlatWorkGroupSize
argument_list|()
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getMaxFlatWorkGroupSize
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|)
return|;
block|}
end_expr_stmt

begin_comment
comment|/// \returns Number of waves per work group supported by the subtarget and
end_comment

begin_comment
comment|/// limited by given \p FlatWorkGroupSize.
end_comment

begin_decl_stmt
name|unsigned
name|getWavesPerWorkGroup
argument_list|(
name|unsigned
name|FlatWorkGroupSize
argument_list|)
decl|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getWavesPerWorkGroup
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|,
name|FlatWorkGroupSize
argument_list|)
return|;
block|}
end_decl_stmt

begin_comment
comment|/// \returns Subtarget's default pair of minimum/maximum flat work group sizes
end_comment

begin_comment
comment|/// for function \p F, or minimum/maximum flat work group sizes explicitly
end_comment

begin_comment
comment|/// requested using "amdgpu-flat-work-group-size" attribute attached to
end_comment

begin_comment
comment|/// function \p F.
end_comment

begin_comment
comment|///
end_comment

begin_comment
comment|/// \returns Subtarget's default values if explicitly requested values cannot
end_comment

begin_comment
comment|/// be converted to integer, or violate subtarget's specifications.
end_comment

begin_expr_stmt
name|std
operator|::
name|pair
operator|<
name|unsigned
operator|,
name|unsigned
operator|>
name|getFlatWorkGroupSizes
argument_list|(
argument|const Function&F
argument_list|)
specifier|const
expr_stmt|;
end_expr_stmt

begin_comment
comment|/// \returns Subtarget's default pair of minimum/maximum number of waves per
end_comment

begin_comment
comment|/// execution unit for function \p F, or minimum/maximum number of waves per
end_comment

begin_comment
comment|/// execution unit explicitly requested using "amdgpu-waves-per-eu" attribute
end_comment

begin_comment
comment|/// attached to function \p F.
end_comment

begin_comment
comment|///
end_comment

begin_comment
comment|/// \returns Subtarget's default values if explicitly requested values cannot
end_comment

begin_comment
comment|/// be converted to integer, violate subtarget's specifications, or are not
end_comment

begin_comment
comment|/// compatible with minimum/maximum number of waves limited by flat work group
end_comment

begin_comment
comment|/// size, register usage, and/or lds usage.
end_comment

begin_expr_stmt
name|std
operator|::
name|pair
operator|<
name|unsigned
operator|,
name|unsigned
operator|>
name|getWavesPerEU
argument_list|(
argument|const Function&F
argument_list|)
specifier|const
expr_stmt|;
end_expr_stmt

begin_comment
comment|/// Creates value range metadata on an workitemid.* inrinsic call or load.
end_comment

begin_decl_stmt
name|bool
name|makeLIDRangeMetadata
argument_list|(
name|Instruction
operator|*
name|I
argument_list|)
decl|const
decl_stmt|;
end_decl_stmt

begin_decl_stmt
unit|};
name|class
name|R600Subtarget
name|final
range|:
name|public
name|AMDGPUSubtarget
block|{
name|private
operator|:
name|R600InstrInfo
name|InstrInfo
block|;
name|R600FrameLowering
name|FrameLowering
block|;
name|R600TargetLowering
name|TLInfo
block|;
name|public
operator|:
name|R600Subtarget
argument_list|(
argument|const Triple&TT
argument_list|,
argument|StringRef CPU
argument_list|,
argument|StringRef FS
argument_list|,
argument|const TargetMachine&TM
argument_list|)
block|;
specifier|const
name|R600InstrInfo
operator|*
name|getInstrInfo
argument_list|()
specifier|const
name|override
block|{
return|return
operator|&
name|InstrInfo
return|;
block|}
specifier|const
name|R600FrameLowering
operator|*
name|getFrameLowering
argument_list|()
specifier|const
name|override
block|{
return|return
operator|&
name|FrameLowering
return|;
block|}
specifier|const
name|R600TargetLowering
operator|*
name|getTargetLowering
argument_list|()
specifier|const
name|override
block|{
return|return
operator|&
name|TLInfo
return|;
block|}
specifier|const
name|R600RegisterInfo
operator|*
name|getRegisterInfo
argument_list|()
specifier|const
name|override
block|{
return|return
operator|&
name|InstrInfo
operator|.
name|getRegisterInfo
argument_list|()
return|;
block|}
name|bool
name|hasCFAluBug
argument_list|()
specifier|const
block|{
return|return
name|CFALUBug
return|;
block|}
name|bool
name|hasVertexCache
argument_list|()
specifier|const
block|{
return|return
name|HasVertexCache
return|;
block|}
name|short
name|getTexVTXClauseSize
argument_list|()
specifier|const
block|{
return|return
name|TexVTXClauseSize
return|;
block|}
expr|}
block|;
name|class
name|SISubtarget
name|final
operator|:
name|public
name|AMDGPUSubtarget
block|{
name|private
operator|:
name|SIInstrInfo
name|InstrInfo
block|;
name|SIFrameLowering
name|FrameLowering
block|;
name|SITargetLowering
name|TLInfo
block|;
name|std
operator|::
name|unique_ptr
operator|<
name|GISelAccessor
operator|>
name|GISel
block|;
name|public
operator|:
name|SISubtarget
argument_list|(
argument|const Triple&TT
argument_list|,
argument|StringRef CPU
argument_list|,
argument|StringRef FS
argument_list|,
argument|const TargetMachine&TM
argument_list|)
block|;
specifier|const
name|SIInstrInfo
operator|*
name|getInstrInfo
argument_list|()
specifier|const
name|override
block|{
return|return
operator|&
name|InstrInfo
return|;
block|}
specifier|const
name|SIFrameLowering
operator|*
name|getFrameLowering
argument_list|()
specifier|const
name|override
block|{
return|return
operator|&
name|FrameLowering
return|;
block|}
specifier|const
name|SITargetLowering
operator|*
name|getTargetLowering
argument_list|()
specifier|const
name|override
block|{
return|return
operator|&
name|TLInfo
return|;
block|}
specifier|const
name|CallLowering
operator|*
name|getCallLowering
argument_list|()
specifier|const
name|override
block|{
name|assert
argument_list|(
name|GISel
operator|&&
literal|"Access to GlobalISel APIs not set"
argument_list|)
block|;
return|return
name|GISel
operator|->
name|getCallLowering
argument_list|()
return|;
block|}
specifier|const
name|InstructionSelector
operator|*
name|getInstructionSelector
argument_list|()
specifier|const
name|override
block|{
name|assert
argument_list|(
name|GISel
operator|&&
literal|"Access to GlobalISel APIs not set"
argument_list|)
block|;
return|return
name|GISel
operator|->
name|getInstructionSelector
argument_list|()
return|;
block|}
specifier|const
name|LegalizerInfo
operator|*
name|getLegalizerInfo
argument_list|()
specifier|const
name|override
block|{
name|assert
argument_list|(
name|GISel
operator|&&
literal|"Access to GlobalISel APIs not set"
argument_list|)
block|;
return|return
name|GISel
operator|->
name|getLegalizerInfo
argument_list|()
return|;
block|}
specifier|const
name|RegisterBankInfo
operator|*
name|getRegBankInfo
argument_list|()
specifier|const
name|override
block|{
name|assert
argument_list|(
name|GISel
operator|&&
literal|"Access to GlobalISel APIs not set"
argument_list|)
block|;
return|return
name|GISel
operator|->
name|getRegBankInfo
argument_list|()
return|;
block|}
specifier|const
name|SIRegisterInfo
operator|*
name|getRegisterInfo
argument_list|()
specifier|const
name|override
block|{
return|return
operator|&
name|InstrInfo
operator|.
name|getRegisterInfo
argument_list|()
return|;
block|}
name|void
name|setGISelAccessor
argument_list|(
argument|GISelAccessor&GISel
argument_list|)
block|{
name|this
operator|->
name|GISel
operator|.
name|reset
argument_list|(
operator|&
name|GISel
argument_list|)
block|;   }
comment|// XXX - Why is this here if it isn't in the default pass set?
name|bool
name|enableEarlyIfConversion
argument_list|()
specifier|const
name|override
block|{
return|return
name|true
return|;
block|}
name|void
name|overrideSchedPolicy
argument_list|(
argument|MachineSchedPolicy&Policy
argument_list|,
argument|unsigned NumRegionInstrs
argument_list|)
specifier|const
name|override
block|;
name|bool
name|isVGPRSpillingEnabled
argument_list|(
argument|const Function& F
argument_list|)
specifier|const
block|;
name|unsigned
name|getMaxNumUserSGPRs
argument_list|()
specifier|const
block|{
return|return
literal|16
return|;
block|}
name|bool
name|hasSMemRealTime
argument_list|()
specifier|const
block|{
return|return
name|HasSMemRealTime
return|;
block|}
name|bool
name|hasMovrel
argument_list|()
specifier|const
block|{
return|return
name|HasMovrel
return|;
block|}
name|bool
name|hasVGPRIndexMode
argument_list|()
specifier|const
block|{
return|return
name|HasVGPRIndexMode
return|;
block|}
name|bool
name|useVGPRIndexMode
argument_list|(
argument|bool UserEnable
argument_list|)
specifier|const
block|{
return|return
operator|!
name|hasMovrel
argument_list|()
operator|||
operator|(
name|UserEnable
operator|&&
name|hasVGPRIndexMode
argument_list|()
operator|)
return|;
block|}
name|bool
name|hasScalarCompareEq64
argument_list|()
specifier|const
block|{
return|return
name|getGeneration
argument_list|()
operator|>=
name|VOLCANIC_ISLANDS
return|;
block|}
name|bool
name|hasScalarStores
argument_list|()
specifier|const
block|{
return|return
name|HasScalarStores
return|;
block|}
name|bool
name|hasInv2PiInlineImm
argument_list|()
specifier|const
block|{
return|return
name|HasInv2PiInlineImm
return|;
block|}
name|bool
name|hasDPP
argument_list|()
specifier|const
block|{
return|return
name|HasDPP
return|;
block|}
name|bool
name|enableSIScheduler
argument_list|()
specifier|const
block|{
return|return
name|EnableSIScheduler
return|;
block|}
name|bool
name|debuggerSupported
argument_list|()
specifier|const
block|{
return|return
name|debuggerInsertNops
argument_list|()
operator|&&
name|debuggerReserveRegs
argument_list|()
operator|&&
name|debuggerEmitPrologue
argument_list|()
return|;
block|}
name|bool
name|debuggerInsertNops
argument_list|()
specifier|const
block|{
return|return
name|DebuggerInsertNops
return|;
block|}
name|bool
name|debuggerReserveRegs
argument_list|()
specifier|const
block|{
return|return
name|DebuggerReserveRegs
return|;
block|}
name|bool
name|debuggerEmitPrologue
argument_list|()
specifier|const
block|{
return|return
name|DebuggerEmitPrologue
return|;
block|}
name|bool
name|loadStoreOptEnabled
argument_list|()
specifier|const
block|{
return|return
name|EnableLoadStoreOpt
return|;
block|}
name|bool
name|hasSGPRInitBug
argument_list|()
specifier|const
block|{
return|return
name|SGPRInitBug
return|;
block|}
name|bool
name|has12DWordStoreHazard
argument_list|()
specifier|const
block|{
return|return
name|getGeneration
argument_list|()
operator|!=
name|AMDGPUSubtarget
operator|::
name|SOUTHERN_ISLANDS
return|;
block|}
name|bool
name|hasSMovFedHazard
argument_list|()
specifier|const
block|{
return|return
name|getGeneration
argument_list|()
operator|>=
name|AMDGPUSubtarget
operator|::
name|GFX9
return|;
block|}
name|bool
name|hasReadM0Hazard
argument_list|()
specifier|const
block|{
return|return
name|getGeneration
argument_list|()
operator|>=
name|AMDGPUSubtarget
operator|::
name|GFX9
return|;
block|}
name|unsigned
name|getKernArgSegmentSize
argument_list|(
argument|const MachineFunction&MF
argument_list|,
argument|unsigned ExplictArgBytes
argument_list|)
specifier|const
block|;
comment|/// Return the maximum number of waves per SIMD for kernels using \p SGPRs SGPRs
name|unsigned
name|getOccupancyWithNumSGPRs
argument_list|(
argument|unsigned SGPRs
argument_list|)
specifier|const
block|;
comment|/// Return the maximum number of waves per SIMD for kernels using \p VGPRs VGPRs
name|unsigned
name|getOccupancyWithNumVGPRs
argument_list|(
argument|unsigned VGPRs
argument_list|)
specifier|const
block|;
comment|/// \returns true if the flat_scratch register should be initialized with the
comment|/// pointer to the wave's scratch memory rather than a size and offset.
name|bool
name|flatScratchIsPointer
argument_list|()
specifier|const
block|{
return|return
name|getGeneration
argument_list|()
operator|>=
name|GFX9
return|;
block|}
comment|/// \returns SGPR allocation granularity supported by the subtarget.
name|unsigned
name|getSGPRAllocGranule
argument_list|()
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getSGPRAllocGranule
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|)
return|;
block|}
comment|/// \returns SGPR encoding granularity supported by the subtarget.
name|unsigned
name|getSGPREncodingGranule
argument_list|()
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getSGPREncodingGranule
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|)
return|;
block|}
comment|/// \returns Total number of SGPRs supported by the subtarget.
name|unsigned
name|getTotalNumSGPRs
argument_list|()
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getTotalNumSGPRs
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|)
return|;
block|}
comment|/// \returns Addressable number of SGPRs supported by the subtarget.
name|unsigned
name|getAddressableNumSGPRs
argument_list|()
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getAddressableNumSGPRs
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|)
return|;
block|}
comment|/// \returns Minimum number of SGPRs that meets the given number of waves per
comment|/// execution unit requirement supported by the subtarget.
name|unsigned
name|getMinNumSGPRs
argument_list|(
argument|unsigned WavesPerEU
argument_list|)
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getMinNumSGPRs
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|,
name|WavesPerEU
argument_list|)
return|;
block|}
comment|/// \returns Maximum number of SGPRs that meets the given number of waves per
comment|/// execution unit requirement supported by the subtarget.
name|unsigned
name|getMaxNumSGPRs
argument_list|(
argument|unsigned WavesPerEU
argument_list|,
argument|bool Addressable
argument_list|)
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getMaxNumSGPRs
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|,
name|WavesPerEU
argument_list|,
name|Addressable
argument_list|)
return|;
block|}
comment|/// \returns Reserved number of SGPRs for given function \p MF.
name|unsigned
name|getReservedNumSGPRs
argument_list|(
argument|const MachineFunction&MF
argument_list|)
specifier|const
block|;
comment|/// \returns Maximum number of SGPRs that meets number of waves per execution
comment|/// unit requirement for function \p MF, or number of SGPRs explicitly
comment|/// requested using "amdgpu-num-sgpr" attribute attached to function \p MF.
comment|///
comment|/// \returns Value that meets number of waves per execution unit requirement
comment|/// if explicitly requested value cannot be converted to integer, violates
comment|/// subtarget's specifications, or does not meet number of waves per execution
comment|/// unit requirement.
name|unsigned
name|getMaxNumSGPRs
argument_list|(
argument|const MachineFunction&MF
argument_list|)
specifier|const
block|;
comment|/// \returns VGPR allocation granularity supported by the subtarget.
name|unsigned
name|getVGPRAllocGranule
argument_list|()
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getVGPRAllocGranule
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|)
return|;
block|}
comment|/// \returns VGPR encoding granularity supported by the subtarget.
name|unsigned
name|getVGPREncodingGranule
argument_list|()
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getVGPREncodingGranule
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|)
return|;
block|}
comment|/// \returns Total number of VGPRs supported by the subtarget.
name|unsigned
name|getTotalNumVGPRs
argument_list|()
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getTotalNumVGPRs
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|)
return|;
block|}
comment|/// \returns Addressable number of VGPRs supported by the subtarget.
name|unsigned
name|getAddressableNumVGPRs
argument_list|()
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getAddressableNumVGPRs
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|)
return|;
block|}
comment|/// \returns Minimum number of VGPRs that meets given number of waves per
comment|/// execution unit requirement supported by the subtarget.
name|unsigned
name|getMinNumVGPRs
argument_list|(
argument|unsigned WavesPerEU
argument_list|)
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getMinNumVGPRs
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|,
name|WavesPerEU
argument_list|)
return|;
block|}
comment|/// \returns Maximum number of VGPRs that meets given number of waves per
comment|/// execution unit requirement supported by the subtarget.
name|unsigned
name|getMaxNumVGPRs
argument_list|(
argument|unsigned WavesPerEU
argument_list|)
specifier|const
block|{
return|return
name|AMDGPU
operator|::
name|IsaInfo
operator|::
name|getMaxNumVGPRs
argument_list|(
name|getFeatureBits
argument_list|()
argument_list|,
name|WavesPerEU
argument_list|)
return|;
block|}
comment|/// \returns Reserved number of VGPRs for given function \p MF.
name|unsigned
name|getReservedNumVGPRs
argument_list|(
argument|const MachineFunction&MF
argument_list|)
specifier|const
block|{
return|return
name|debuggerReserveRegs
argument_list|()
operator|?
literal|4
operator|:
literal|0
return|;
block|}
comment|/// \returns Maximum number of VGPRs that meets number of waves per execution
comment|/// unit requirement for function \p MF, or number of VGPRs explicitly
comment|/// requested using "amdgpu-num-vgpr" attribute attached to function \p MF.
comment|///
comment|/// \returns Value that meets number of waves per execution unit requirement
comment|/// if explicitly requested value cannot be converted to integer, violates
comment|/// subtarget's specifications, or does not meet number of waves per execution
comment|/// unit requirement.
name|unsigned
name|getMaxNumVGPRs
argument_list|(
argument|const MachineFunction&MF
argument_list|)
specifier|const
block|; }
block|;  }
end_decl_stmt

begin_comment
comment|// end namespace llvm
end_comment

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|// LLVM_LIB_TARGET_AMDGPU_AMDGPUSUBTARGET_H
end_comment

end_unit

