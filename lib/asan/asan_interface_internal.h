begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|//===-- asan_interface_internal.h -------------------------------*- C++ -*-===//
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|//                     The LLVM Compiler Infrastructure
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// This file is distributed under the University of Illinois Open Source
end_comment

begin_comment
comment|// License. See LICENSE.TXT for details.
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|//===----------------------------------------------------------------------===//
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// This file is a part of AddressSanitizer, an address sanity checker.
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// This header declares the AddressSanitizer runtime interface functions.
end_comment

begin_comment
comment|// The runtime library has to define these functions so the instrumented program
end_comment

begin_comment
comment|// could call them.
end_comment

begin_comment
comment|//
end_comment

begin_comment
comment|// See also include/sanitizer/asan_interface.h
end_comment

begin_comment
comment|//===----------------------------------------------------------------------===//
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|ASAN_INTERFACE_INTERNAL_H
end_ifndef

begin_define
define|#
directive|define
name|ASAN_INTERFACE_INTERNAL_H
end_define

begin_include
include|#
directive|include
file|"sanitizer_common/sanitizer_internal_defs.h"
end_include

begin_include
include|#
directive|include
file|"asan_init_version.h"
end_include

begin_expr_stmt
name|using
name|__sanitizer
operator|::
name|uptr
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|using
name|__sanitizer
operator|::
name|u64
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|using
name|__sanitizer
operator|::
name|u32
expr_stmt|;
end_expr_stmt

begin_extern
extern|extern
literal|"C"
block|{
comment|// This function should be called at the very beginning of the process,
comment|// before any instrumented code is executed and before any call to malloc.
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_init
parameter_list|()
function_decl|;
comment|// This function exists purely to get a linker/loader error when using
comment|// incompatible versions of instrumentation and runtime library. Please note
comment|// that __asan_version_mismatch_check is a macro that is replaced with
comment|// __asan_version_mismatch_check_vXXX at compile-time.
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_version_mismatch_check
parameter_list|()
function_decl|;
comment|// This structure is used to describe the source location of a place where
comment|// global was defined.
struct|struct
name|__asan_global_source_location
block|{
specifier|const
name|char
modifier|*
name|filename
decl_stmt|;
name|int
name|line_no
decl_stmt|;
name|int
name|column_no
decl_stmt|;
block|}
struct|;
comment|// This structure describes an instrumented global variable.
struct|struct
name|__asan_global
block|{
name|uptr
name|beg
decl_stmt|;
comment|// The address of the global.
name|uptr
name|size
decl_stmt|;
comment|// The original size of the global.
name|uptr
name|size_with_redzone
decl_stmt|;
comment|// The size with the redzone.
specifier|const
name|char
modifier|*
name|name
decl_stmt|;
comment|// Name as a C string.
specifier|const
name|char
modifier|*
name|module_name
decl_stmt|;
comment|// Module name as a C string. This pointer is a
comment|// unique identifier of a module.
name|uptr
name|has_dynamic_init
decl_stmt|;
comment|// Non-zero if the global has dynamic initializer.
name|__asan_global_source_location
modifier|*
name|location
decl_stmt|;
comment|// Source location of a global,
comment|// or NULL if it is unknown.
name|uptr
name|odr_indicator
decl_stmt|;
comment|// The address of the ODR indicator symbol.
block|}
struct|;
comment|// These functions can be called on some platforms to find globals in the same
comment|// loaded image as `flag' and apply __asan_(un)register_globals to them,
comment|// filtering out redundant calls.
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_register_image_globals
parameter_list|(
name|uptr
modifier|*
name|flag
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_unregister_image_globals
parameter_list|(
name|uptr
modifier|*
name|flag
parameter_list|)
function_decl|;
comment|// These two functions should be called by the instrumented code.
comment|// 'globals' is an array of structures describing 'n' globals.
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_register_globals
parameter_list|(
name|__asan_global
modifier|*
name|globals
parameter_list|,
name|uptr
name|n
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_unregister_globals
parameter_list|(
name|__asan_global
modifier|*
name|globals
parameter_list|,
name|uptr
name|n
parameter_list|)
function_decl|;
comment|// These two functions should be called before and after dynamic initializers
comment|// of a single module run, respectively.
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_before_dynamic_init
parameter_list|(
specifier|const
name|char
modifier|*
name|module_name
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_after_dynamic_init
parameter_list|()
function_decl|;
comment|// Sets bytes of the given range of the shadow memory into specific value.
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_set_shadow_00
parameter_list|(
name|uptr
name|addr
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_set_shadow_f1
parameter_list|(
name|uptr
name|addr
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_set_shadow_f2
parameter_list|(
name|uptr
name|addr
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_set_shadow_f3
parameter_list|(
name|uptr
name|addr
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_set_shadow_f5
parameter_list|(
name|uptr
name|addr
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_set_shadow_f8
parameter_list|(
name|uptr
name|addr
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
comment|// These two functions are used by instrumented code in the
comment|// use-after-scope mode. They mark memory for local variables as
comment|// unaddressable when they leave scope and addressable before the
comment|// function exits.
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_poison_stack_memory
parameter_list|(
name|uptr
name|addr
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_unpoison_stack_memory
parameter_list|(
name|uptr
name|addr
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
comment|// Performs cleanup before a NoReturn function. Must be called before things
comment|// like _exit and execl to avoid false positives on stack.
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_handle_no_return
parameter_list|()
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_poison_memory_region
parameter_list|(
name|void
specifier|const
specifier|volatile
modifier|*
name|addr
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_unpoison_memory_region
parameter_list|(
name|void
specifier|const
specifier|volatile
modifier|*
name|addr
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|int
name|__asan_address_is_poisoned
parameter_list|(
name|void
specifier|const
specifier|volatile
modifier|*
name|addr
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|uptr
name|__asan_region_is_poisoned
parameter_list|(
name|uptr
name|beg
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_describe_address
parameter_list|(
name|uptr
name|addr
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|int
name|__asan_report_present
parameter_list|()
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|uptr
name|__asan_get_report_pc
parameter_list|()
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|uptr
name|__asan_get_report_bp
parameter_list|()
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|uptr
name|__asan_get_report_sp
parameter_list|()
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|uptr
name|__asan_get_report_address
parameter_list|()
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|int
name|__asan_get_report_access_type
parameter_list|()
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|uptr
name|__asan_get_report_access_size
parameter_list|()
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
specifier|const
name|char
modifier|*
name|__asan_get_report_description
parameter_list|()
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
specifier|const
name|char
modifier|*
name|__asan_locate_address
parameter_list|(
name|uptr
name|addr
parameter_list|,
name|char
modifier|*
name|name
parameter_list|,
name|uptr
name|name_size
parameter_list|,
name|uptr
modifier|*
name|region_address
parameter_list|,
name|uptr
modifier|*
name|region_size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|uptr
name|__asan_get_alloc_stack
parameter_list|(
name|uptr
name|addr
parameter_list|,
name|uptr
modifier|*
name|trace
parameter_list|,
name|uptr
name|size
parameter_list|,
name|u32
modifier|*
name|thread_id
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|uptr
name|__asan_get_free_stack
parameter_list|(
name|uptr
name|addr
parameter_list|,
name|uptr
modifier|*
name|trace
parameter_list|,
name|uptr
name|size
parameter_list|,
name|u32
modifier|*
name|thread_id
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_get_shadow_mapping
parameter_list|(
name|uptr
modifier|*
name|shadow_scale
parameter_list|,
name|uptr
modifier|*
name|shadow_offset
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_report_error
parameter_list|(
name|uptr
name|pc
parameter_list|,
name|uptr
name|bp
parameter_list|,
name|uptr
name|sp
parameter_list|,
name|uptr
name|addr
parameter_list|,
name|int
name|is_write
parameter_list|,
name|uptr
name|access_size
parameter_list|,
name|u32
name|exp
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_set_death_callback
parameter_list|(
name|void
function_decl|(
modifier|*
name|callback
function_decl|)
parameter_list|(
name|void
parameter_list|)
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_set_error_report_callback
parameter_list|(
name|void
function_decl|(
modifier|*
name|callback
function_decl|)
parameter_list|(
specifier|const
name|char
modifier|*
parameter_list|)
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|SANITIZER_WEAK_ATTRIBUTE
name|void
name|__asan_on_error
parameter_list|()
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_print_accumulated_stats
parameter_list|()
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|SANITIZER_WEAK_ATTRIBUTE
specifier|const
name|char
modifier|*
name|__asan_default_options
parameter_list|()
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
specifier|extern
name|uptr
name|__asan_shadow_memory_dynamic_address
decl_stmt|;
comment|// Global flag, copy of ASAN_OPTIONS=detect_stack_use_after_return
name|SANITIZER_INTERFACE_ATTRIBUTE
specifier|extern
name|int
name|__asan_option_detect_stack_use_after_return
decl_stmt|;
name|SANITIZER_INTERFACE_ATTRIBUTE
specifier|extern
name|uptr
modifier|*
name|__asan_test_only_reported_buggy_pointer
decl_stmt|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_load1
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_load2
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_load4
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_load8
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_load16
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_store1
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_store2
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_store4
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_store8
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_store16
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_loadN
parameter_list|(
name|uptr
name|p
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_storeN
parameter_list|(
name|uptr
name|p
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_load1_noabort
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_load2_noabort
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_load4_noabort
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_load8_noabort
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_load16_noabort
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_store1_noabort
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_store2_noabort
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_store4_noabort
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_store8_noabort
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_store16_noabort
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_loadN_noabort
parameter_list|(
name|uptr
name|p
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_storeN_noabort
parameter_list|(
name|uptr
name|p
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_exp_load1
parameter_list|(
name|uptr
name|p
parameter_list|,
name|u32
name|exp
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_exp_load2
parameter_list|(
name|uptr
name|p
parameter_list|,
name|u32
name|exp
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_exp_load4
parameter_list|(
name|uptr
name|p
parameter_list|,
name|u32
name|exp
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_exp_load8
parameter_list|(
name|uptr
name|p
parameter_list|,
name|u32
name|exp
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_exp_load16
parameter_list|(
name|uptr
name|p
parameter_list|,
name|u32
name|exp
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_exp_store1
parameter_list|(
name|uptr
name|p
parameter_list|,
name|u32
name|exp
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_exp_store2
parameter_list|(
name|uptr
name|p
parameter_list|,
name|u32
name|exp
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_exp_store4
parameter_list|(
name|uptr
name|p
parameter_list|,
name|u32
name|exp
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_exp_store8
parameter_list|(
name|uptr
name|p
parameter_list|,
name|u32
name|exp
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_exp_store16
parameter_list|(
name|uptr
name|p
parameter_list|,
name|u32
name|exp
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_exp_loadN
parameter_list|(
name|uptr
name|p
parameter_list|,
name|uptr
name|size
parameter_list|,
name|u32
name|exp
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_exp_storeN
parameter_list|(
name|uptr
name|p
parameter_list|,
name|uptr
name|size
parameter_list|,
name|u32
name|exp
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
modifier|*
name|__asan_memcpy
parameter_list|(
name|void
modifier|*
name|dst
parameter_list|,
specifier|const
name|void
modifier|*
name|src
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
modifier|*
name|__asan_memset
parameter_list|(
name|void
modifier|*
name|s
parameter_list|,
name|int
name|c
parameter_list|,
name|uptr
name|n
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
modifier|*
name|__asan_memmove
parameter_list|(
name|void
modifier|*
name|dest
parameter_list|,
specifier|const
name|void
modifier|*
name|src
parameter_list|,
name|uptr
name|n
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_poison_cxx_array_cookie
parameter_list|(
name|uptr
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|uptr
name|__asan_load_cxx_array_cookie
parameter_list|(
name|uptr
modifier|*
name|p
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_poison_intra_object_redzone
parameter_list|(
name|uptr
name|p
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_unpoison_intra_object_redzone
parameter_list|(
name|uptr
name|p
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_alloca_poison
parameter_list|(
name|uptr
name|addr
parameter_list|,
name|uptr
name|size
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|void
name|__asan_allocas_unpoison
parameter_list|(
name|uptr
name|top
parameter_list|,
name|uptr
name|bottom
parameter_list|)
function_decl|;
name|SANITIZER_INTERFACE_ATTRIBUTE
name|SANITIZER_WEAK_ATTRIBUTE
specifier|const
name|char
modifier|*
name|__asan_default_suppressions
parameter_list|()
function_decl|;
block|}
end_extern

begin_comment
comment|// extern "C"
end_comment

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|// ASAN_INTERFACE_INTERNAL_H
end_comment

end_unit

