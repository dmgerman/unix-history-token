begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* MD4C.C - RSA Data Security, Inc., MD4 message-digest algorithm  * $FreeBSD$  */
end_comment

begin_comment
comment|/* Copyright (C) 1990-2, RSA Data Security, Inc. All rights reserved.     License to copy and use this software is granted provided that it    is identified as the "RSA Data Security, Inc. MD4 Message-Digest    Algorithm" in all material mentioning or referencing this software    or this function.     License is also granted to make and use derivative works provided    that such works are identified as "derived from the RSA Data    Security, Inc. MD4 Message-Digest Algorithm" in all material    mentioning or referencing the derived work.     RSA Data Security, Inc. makes no representations concerning either    the merchantability of this software or the suitability of this    software for any particular purpose. It is provided "as is"    without express or implied warranty of any kind.     These notices must be retained in any copies of any part of this    documentation and/or software.  */
end_comment

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|"md4.h"
end_include

begin_typedef
typedef|typedef
name|unsigned
name|char
modifier|*
name|POINTER
typedef|;
end_typedef

begin_typedef
typedef|typedef
name|u_int16_t
name|UINT2
typedef|;
end_typedef

begin_typedef
typedef|typedef
name|u_int32_t
name|UINT4
typedef|;
end_typedef

begin_define
define|#
directive|define
name|PROTO_LIST
parameter_list|(
name|list
parameter_list|)
value|list
end_define

begin_comment
comment|/* Constants for MD4Transform routine.  */
end_comment

begin_define
define|#
directive|define
name|S11
value|3
end_define

begin_define
define|#
directive|define
name|S12
value|7
end_define

begin_define
define|#
directive|define
name|S13
value|11
end_define

begin_define
define|#
directive|define
name|S14
value|19
end_define

begin_define
define|#
directive|define
name|S21
value|3
end_define

begin_define
define|#
directive|define
name|S22
value|5
end_define

begin_define
define|#
directive|define
name|S23
value|9
end_define

begin_define
define|#
directive|define
name|S24
value|13
end_define

begin_define
define|#
directive|define
name|S31
value|3
end_define

begin_define
define|#
directive|define
name|S32
value|9
end_define

begin_define
define|#
directive|define
name|S33
value|11
end_define

begin_define
define|#
directive|define
name|S34
value|15
end_define

begin_decl_stmt
specifier|static
name|void
name|MD4Transform
name|PROTO_LIST
argument_list|(
operator|(
name|UINT4
index|[
literal|4
index|]
operator|,
specifier|const
name|unsigned
name|char
index|[
literal|64
index|]
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|Encode
name|PROTO_LIST
argument_list|(
operator|(
name|unsigned
name|char
operator|*
operator|,
name|UINT4
operator|*
operator|,
name|unsigned
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|Decode
name|PROTO_LIST
argument_list|(
operator|(
name|UINT4
operator|*
operator|,
specifier|const
name|unsigned
name|char
operator|*
operator|,
name|unsigned
name|int
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|unsigned
name|char
name|PADDING
index|[
literal|64
index|]
init|=
block|{
literal|0x80
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|,
literal|0
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* F, G and H are basic MD4 functions.  */
end_comment

begin_define
define|#
directive|define
name|F
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|,
name|z
parameter_list|)
value|(((x)& (y)) | ((~x)& (z)))
end_define

begin_define
define|#
directive|define
name|G
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|,
name|z
parameter_list|)
value|(((x)& (y)) | ((x)& (z)) | ((y)& (z)))
end_define

begin_define
define|#
directive|define
name|H
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|,
name|z
parameter_list|)
value|((x) ^ (y) ^ (z))
end_define

begin_comment
comment|/* ROTATE_LEFT rotates x left n bits.  */
end_comment

begin_define
define|#
directive|define
name|ROTATE_LEFT
parameter_list|(
name|x
parameter_list|,
name|n
parameter_list|)
value|(((x)<< (n)) | ((x)>> (32-(n))))
end_define

begin_comment
comment|/* FF, GG and HH are transformations for rounds 1, 2 and 3 */
end_comment

begin_comment
comment|/* Rotation is separate from addition to prevent recomputation */
end_comment

begin_define
define|#
directive|define
name|FF
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|c
parameter_list|,
name|d
parameter_list|,
name|x
parameter_list|,
name|s
parameter_list|)
value|{ \     (a) += F ((b), (c), (d)) + (x); \     (a) = ROTATE_LEFT ((a), (s)); \   }
end_define

begin_define
define|#
directive|define
name|GG
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|c
parameter_list|,
name|d
parameter_list|,
name|x
parameter_list|,
name|s
parameter_list|)
value|{ \     (a) += G ((b), (c), (d)) + (x) + (UINT4)0x5a827999; \     (a) = ROTATE_LEFT ((a), (s)); \   }
end_define

begin_define
define|#
directive|define
name|HH
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|c
parameter_list|,
name|d
parameter_list|,
name|x
parameter_list|,
name|s
parameter_list|)
value|{ \     (a) += H ((b), (c), (d)) + (x) + (UINT4)0x6ed9eba1; \     (a) = ROTATE_LEFT ((a), (s)); \   }
end_define

begin_comment
comment|/* MD4 initialization. Begins an MD4 operation, writing a new context.  */
end_comment

begin_function
name|void
name|MD4Init
parameter_list|(
name|context
parameter_list|)
name|MD4_CTX
modifier|*
name|context
decl_stmt|;
comment|/* context */
block|{
name|context
operator|->
name|count
index|[
literal|0
index|]
operator|=
name|context
operator|->
name|count
index|[
literal|1
index|]
operator|=
literal|0
expr_stmt|;
comment|/* Load magic initialization constants.    */
name|context
operator|->
name|state
index|[
literal|0
index|]
operator|=
literal|0x67452301
expr_stmt|;
name|context
operator|->
name|state
index|[
literal|1
index|]
operator|=
literal|0xefcdab89
expr_stmt|;
name|context
operator|->
name|state
index|[
literal|2
index|]
operator|=
literal|0x98badcfe
expr_stmt|;
name|context
operator|->
name|state
index|[
literal|3
index|]
operator|=
literal|0x10325476
expr_stmt|;
block|}
end_function

begin_comment
comment|/* MD4 block update operation. Continues an MD4 message-digest      operation, processing another message block, and updating the      context.  */
end_comment

begin_function
name|void
name|MD4Update
parameter_list|(
name|context
parameter_list|,
name|input
parameter_list|,
name|inputLen
parameter_list|)
name|MD4_CTX
modifier|*
name|context
decl_stmt|;
comment|/* context */
specifier|const
name|unsigned
name|char
modifier|*
name|input
decl_stmt|;
comment|/* input block */
name|unsigned
name|int
name|inputLen
decl_stmt|;
comment|/* length of input block */
block|{
name|unsigned
name|int
name|i
decl_stmt|,
name|index
decl_stmt|,
name|partLen
decl_stmt|;
comment|/* Compute number of bytes mod 64 */
name|index
operator|=
call|(
name|unsigned
name|int
call|)
argument_list|(
operator|(
name|context
operator|->
name|count
index|[
literal|0
index|]
operator|>>
literal|3
operator|)
operator|&
literal|0x3F
argument_list|)
expr_stmt|;
comment|/* Update number of bits */
if|if
condition|(
operator|(
name|context
operator|->
name|count
index|[
literal|0
index|]
operator|+=
operator|(
operator|(
name|UINT4
operator|)
name|inputLen
operator|<<
literal|3
operator|)
operator|)
operator|<
operator|(
operator|(
name|UINT4
operator|)
name|inputLen
operator|<<
literal|3
operator|)
condition|)
name|context
operator|->
name|count
index|[
literal|1
index|]
operator|++
expr_stmt|;
name|context
operator|->
name|count
index|[
literal|1
index|]
operator|+=
operator|(
operator|(
name|UINT4
operator|)
name|inputLen
operator|>>
literal|29
operator|)
expr_stmt|;
name|partLen
operator|=
literal|64
operator|-
name|index
expr_stmt|;
comment|/* Transform as many times as possible.    */
if|if
condition|(
name|inputLen
operator|>=
name|partLen
condition|)
block|{
name|memcpy
argument_list|(
operator|(
name|POINTER
operator|)
operator|&
name|context
operator|->
name|buffer
index|[
name|index
index|]
argument_list|,
operator|(
name|POINTER
operator|)
name|input
argument_list|,
name|partLen
argument_list|)
expr_stmt|;
name|MD4Transform
argument_list|(
name|context
operator|->
name|state
argument_list|,
name|context
operator|->
name|buffer
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
name|partLen
init|;
name|i
operator|+
literal|63
operator|<
name|inputLen
condition|;
name|i
operator|+=
literal|64
control|)
name|MD4Transform
argument_list|(
name|context
operator|->
name|state
argument_list|,
operator|&
name|input
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|index
operator|=
literal|0
expr_stmt|;
block|}
else|else
name|i
operator|=
literal|0
expr_stmt|;
comment|/* Buffer remaining input */
name|memcpy
argument_list|(
operator|(
name|POINTER
operator|)
operator|&
name|context
operator|->
name|buffer
index|[
name|index
index|]
argument_list|,
operator|(
name|POINTER
operator|)
operator|&
name|input
index|[
name|i
index|]
argument_list|,
name|inputLen
operator|-
name|i
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* MD4 finalization. Ends an MD4 message-digest operation, writing the      the message digest and zeroizing the context.  */
end_comment

begin_function
name|void
name|MD4Final
parameter_list|(
name|digest
parameter_list|,
name|context
parameter_list|)
name|unsigned
name|char
name|digest
index|[
literal|16
index|]
decl_stmt|;
comment|/* message digest */
name|MD4_CTX
modifier|*
name|context
decl_stmt|;
comment|/* context */
block|{
name|unsigned
name|char
name|bits
index|[
literal|8
index|]
decl_stmt|;
name|unsigned
name|int
name|index
decl_stmt|,
name|padLen
decl_stmt|;
comment|/* Save number of bits */
name|Encode
argument_list|(
name|bits
argument_list|,
name|context
operator|->
name|count
argument_list|,
literal|8
argument_list|)
expr_stmt|;
comment|/* Pad out to 56 mod 64.    */
name|index
operator|=
call|(
name|unsigned
name|int
call|)
argument_list|(
operator|(
name|context
operator|->
name|count
index|[
literal|0
index|]
operator|>>
literal|3
operator|)
operator|&
literal|0x3f
argument_list|)
expr_stmt|;
name|padLen
operator|=
operator|(
name|index
operator|<
literal|56
operator|)
condition|?
operator|(
literal|56
operator|-
name|index
operator|)
else|:
operator|(
literal|120
operator|-
name|index
operator|)
expr_stmt|;
name|MD4Update
argument_list|(
name|context
argument_list|,
name|PADDING
argument_list|,
name|padLen
argument_list|)
expr_stmt|;
comment|/* Append length (before padding) */
name|MD4Update
argument_list|(
name|context
argument_list|,
name|bits
argument_list|,
literal|8
argument_list|)
expr_stmt|;
comment|/* Store state in digest */
name|Encode
argument_list|(
name|digest
argument_list|,
name|context
operator|->
name|state
argument_list|,
literal|16
argument_list|)
expr_stmt|;
comment|/* Zeroize sensitive information.    */
name|memset
argument_list|(
operator|(
name|POINTER
operator|)
name|context
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
operator|*
name|context
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* MD4 basic transformation. Transforms state based on block.  */
end_comment

begin_function
specifier|static
name|void
name|MD4Transform
parameter_list|(
name|state
parameter_list|,
name|block
parameter_list|)
name|UINT4
name|state
index|[
literal|4
index|]
decl_stmt|;
specifier|const
name|unsigned
name|char
name|block
index|[
literal|64
index|]
decl_stmt|;
block|{
name|UINT4
name|a
init|=
name|state
index|[
literal|0
index|]
decl_stmt|,
name|b
init|=
name|state
index|[
literal|1
index|]
decl_stmt|,
name|c
init|=
name|state
index|[
literal|2
index|]
decl_stmt|,
name|d
init|=
name|state
index|[
literal|3
index|]
decl_stmt|,
name|x
index|[
literal|16
index|]
decl_stmt|;
name|Decode
argument_list|(
name|x
argument_list|,
name|block
argument_list|,
literal|64
argument_list|)
expr_stmt|;
comment|/* Round 1 */
name|FF
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|0
index|]
argument_list|,
name|S11
argument_list|)
expr_stmt|;
comment|/* 1 */
name|FF
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|1
index|]
argument_list|,
name|S12
argument_list|)
expr_stmt|;
comment|/* 2 */
name|FF
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|2
index|]
argument_list|,
name|S13
argument_list|)
expr_stmt|;
comment|/* 3 */
name|FF
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|3
index|]
argument_list|,
name|S14
argument_list|)
expr_stmt|;
comment|/* 4 */
name|FF
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|4
index|]
argument_list|,
name|S11
argument_list|)
expr_stmt|;
comment|/* 5 */
name|FF
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|5
index|]
argument_list|,
name|S12
argument_list|)
expr_stmt|;
comment|/* 6 */
name|FF
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|6
index|]
argument_list|,
name|S13
argument_list|)
expr_stmt|;
comment|/* 7 */
name|FF
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|7
index|]
argument_list|,
name|S14
argument_list|)
expr_stmt|;
comment|/* 8 */
name|FF
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|8
index|]
argument_list|,
name|S11
argument_list|)
expr_stmt|;
comment|/* 9 */
name|FF
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|9
index|]
argument_list|,
name|S12
argument_list|)
expr_stmt|;
comment|/* 10 */
name|FF
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|10
index|]
argument_list|,
name|S13
argument_list|)
expr_stmt|;
comment|/* 11 */
name|FF
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|11
index|]
argument_list|,
name|S14
argument_list|)
expr_stmt|;
comment|/* 12 */
name|FF
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|12
index|]
argument_list|,
name|S11
argument_list|)
expr_stmt|;
comment|/* 13 */
name|FF
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|13
index|]
argument_list|,
name|S12
argument_list|)
expr_stmt|;
comment|/* 14 */
name|FF
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|14
index|]
argument_list|,
name|S13
argument_list|)
expr_stmt|;
comment|/* 15 */
name|FF
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|15
index|]
argument_list|,
name|S14
argument_list|)
expr_stmt|;
comment|/* 16 */
comment|/* Round 2 */
name|GG
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|0
index|]
argument_list|,
name|S21
argument_list|)
expr_stmt|;
comment|/* 17 */
name|GG
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|4
index|]
argument_list|,
name|S22
argument_list|)
expr_stmt|;
comment|/* 18 */
name|GG
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|8
index|]
argument_list|,
name|S23
argument_list|)
expr_stmt|;
comment|/* 19 */
name|GG
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|12
index|]
argument_list|,
name|S24
argument_list|)
expr_stmt|;
comment|/* 20 */
name|GG
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|1
index|]
argument_list|,
name|S21
argument_list|)
expr_stmt|;
comment|/* 21 */
name|GG
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|5
index|]
argument_list|,
name|S22
argument_list|)
expr_stmt|;
comment|/* 22 */
name|GG
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|9
index|]
argument_list|,
name|S23
argument_list|)
expr_stmt|;
comment|/* 23 */
name|GG
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|13
index|]
argument_list|,
name|S24
argument_list|)
expr_stmt|;
comment|/* 24 */
name|GG
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|2
index|]
argument_list|,
name|S21
argument_list|)
expr_stmt|;
comment|/* 25 */
name|GG
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|6
index|]
argument_list|,
name|S22
argument_list|)
expr_stmt|;
comment|/* 26 */
name|GG
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|10
index|]
argument_list|,
name|S23
argument_list|)
expr_stmt|;
comment|/* 27 */
name|GG
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|14
index|]
argument_list|,
name|S24
argument_list|)
expr_stmt|;
comment|/* 28 */
name|GG
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|3
index|]
argument_list|,
name|S21
argument_list|)
expr_stmt|;
comment|/* 29 */
name|GG
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|7
index|]
argument_list|,
name|S22
argument_list|)
expr_stmt|;
comment|/* 30 */
name|GG
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|11
index|]
argument_list|,
name|S23
argument_list|)
expr_stmt|;
comment|/* 31 */
name|GG
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|15
index|]
argument_list|,
name|S24
argument_list|)
expr_stmt|;
comment|/* 32 */
comment|/* Round 3 */
name|HH
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|0
index|]
argument_list|,
name|S31
argument_list|)
expr_stmt|;
comment|/* 33 */
name|HH
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|8
index|]
argument_list|,
name|S32
argument_list|)
expr_stmt|;
comment|/* 34 */
name|HH
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|4
index|]
argument_list|,
name|S33
argument_list|)
expr_stmt|;
comment|/* 35 */
name|HH
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|12
index|]
argument_list|,
name|S34
argument_list|)
expr_stmt|;
comment|/* 36 */
name|HH
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|2
index|]
argument_list|,
name|S31
argument_list|)
expr_stmt|;
comment|/* 37 */
name|HH
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|10
index|]
argument_list|,
name|S32
argument_list|)
expr_stmt|;
comment|/* 38 */
name|HH
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|6
index|]
argument_list|,
name|S33
argument_list|)
expr_stmt|;
comment|/* 39 */
name|HH
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|14
index|]
argument_list|,
name|S34
argument_list|)
expr_stmt|;
comment|/* 40 */
name|HH
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|1
index|]
argument_list|,
name|S31
argument_list|)
expr_stmt|;
comment|/* 41 */
name|HH
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|9
index|]
argument_list|,
name|S32
argument_list|)
expr_stmt|;
comment|/* 42 */
name|HH
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|5
index|]
argument_list|,
name|S33
argument_list|)
expr_stmt|;
comment|/* 43 */
name|HH
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|13
index|]
argument_list|,
name|S34
argument_list|)
expr_stmt|;
comment|/* 44 */
name|HH
argument_list|(
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|x
index|[
literal|3
index|]
argument_list|,
name|S31
argument_list|)
expr_stmt|;
comment|/* 45 */
name|HH
argument_list|(
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|c
argument_list|,
name|x
index|[
literal|11
index|]
argument_list|,
name|S32
argument_list|)
expr_stmt|;
comment|/* 46 */
name|HH
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|b
argument_list|,
name|x
index|[
literal|7
index|]
argument_list|,
name|S33
argument_list|)
expr_stmt|;
comment|/* 47 */
name|HH
argument_list|(
name|b
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|a
argument_list|,
name|x
index|[
literal|15
index|]
argument_list|,
name|S34
argument_list|)
expr_stmt|;
comment|/* 48 */
name|state
index|[
literal|0
index|]
operator|+=
name|a
expr_stmt|;
name|state
index|[
literal|1
index|]
operator|+=
name|b
expr_stmt|;
name|state
index|[
literal|2
index|]
operator|+=
name|c
expr_stmt|;
name|state
index|[
literal|3
index|]
operator|+=
name|d
expr_stmt|;
comment|/* Zeroize sensitive information.    */
name|memset
argument_list|(
operator|(
name|POINTER
operator|)
name|x
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|x
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* Encodes input (UINT4) into output (unsigned char). Assumes len is      a multiple of 4.  */
end_comment

begin_function
specifier|static
name|void
name|Encode
parameter_list|(
name|output
parameter_list|,
name|input
parameter_list|,
name|len
parameter_list|)
name|unsigned
name|char
modifier|*
name|output
decl_stmt|;
name|UINT4
modifier|*
name|input
decl_stmt|;
name|unsigned
name|int
name|len
decl_stmt|;
block|{
name|unsigned
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|len
condition|;
name|i
operator|++
operator|,
name|j
operator|+=
literal|4
control|)
block|{
name|output
index|[
name|j
index|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
name|input
index|[
name|i
index|]
operator|&
literal|0xff
argument_list|)
expr_stmt|;
name|output
index|[
name|j
operator|+
literal|1
index|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
operator|(
name|input
index|[
name|i
index|]
operator|>>
literal|8
operator|)
operator|&
literal|0xff
argument_list|)
expr_stmt|;
name|output
index|[
name|j
operator|+
literal|2
index|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
operator|(
name|input
index|[
name|i
index|]
operator|>>
literal|16
operator|)
operator|&
literal|0xff
argument_list|)
expr_stmt|;
name|output
index|[
name|j
operator|+
literal|3
index|]
operator|=
call|(
name|unsigned
name|char
call|)
argument_list|(
operator|(
name|input
index|[
name|i
index|]
operator|>>
literal|24
operator|)
operator|&
literal|0xff
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* Decodes input (unsigned char) into output (UINT4). Assumes len is      a multiple of 4.  */
end_comment

begin_function
specifier|static
name|void
name|Decode
parameter_list|(
name|output
parameter_list|,
name|input
parameter_list|,
name|len
parameter_list|)
name|UINT4
modifier|*
name|output
decl_stmt|;
specifier|const
name|unsigned
name|char
modifier|*
name|input
decl_stmt|;
name|unsigned
name|int
name|len
decl_stmt|;
block|{
name|unsigned
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|len
condition|;
name|i
operator|++
operator|,
name|j
operator|+=
literal|4
control|)
name|output
index|[
name|i
index|]
operator|=
operator|(
operator|(
name|UINT4
operator|)
name|input
index|[
name|j
index|]
operator|)
operator||
operator|(
operator|(
operator|(
name|UINT4
operator|)
name|input
index|[
name|j
operator|+
literal|1
index|]
operator|)
operator|<<
literal|8
operator|)
operator||
operator|(
operator|(
operator|(
name|UINT4
operator|)
name|input
index|[
name|j
operator|+
literal|2
index|]
operator|)
operator|<<
literal|16
operator|)
operator||
operator|(
operator|(
operator|(
name|UINT4
operator|)
name|input
index|[
name|j
operator|+
literal|3
index|]
operator|)
operator|<<
literal|24
operator|)
expr_stmt|;
block|}
end_function

end_unit

