begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*		      Library for ftpd clients.(libftp) 			Copyright by Oleg Orel 			 All rights reserved.  This  library is desined  for  free,  non-commercial  software  creation. It is changeable and can be improved. The author would greatly appreciate any  advises, new  components  and  patches  of  the  existing  programs. Commercial  usage is  also  possible  with  participation of it's author. */
end_comment

begin_include
include|#
directive|include
file|"FtpLibrary.h"
end_include

begin_function
specifier|static
name|char
modifier|*
name|simplename
parameter_list|(
name|char
modifier|*
name|s
parameter_list|)
block|{
name|char
modifier|*
name|p
decl_stmt|;
if|if
condition|(
operator|(
name|p
operator|=
operator|(
name|char
operator|*
operator|)
name|strrchr
argument_list|(
name|s
argument_list|,
literal|'/'
argument_list|)
operator|)
operator|==
name|NULL
condition|)
return|return
name|s
return|;
return|return
name|p
operator|+
literal|1
return|;
block|}
end_function

begin_function
name|STATUS
name|FtpFilenameChecker
parameter_list|(
name|char
modifier|*
modifier|*
name|in
parameter_list|,
name|char
modifier|*
modifier|*
name|out
parameter_list|)
block|{
name|struct
name|stat
name|st
decl_stmt|;
if|if
condition|(
operator|(
name|stat
argument_list|(
operator|*
name|out
argument_list|,
operator|&
name|st
argument_list|)
operator|==
literal|0
operator|)
operator|&&
name|S_ISDIR
argument_list|(
name|st
operator|.
name|st_mode
argument_list|)
condition|)
block|{
name|char
modifier|*
name|sfn
init|=
name|simplename
argument_list|(
operator|*
name|in
argument_list|)
decl_stmt|;
name|char
modifier|*
name|new
init|=
operator|(
name|char
operator|*
operator|)
name|malloc
argument_list|(
name|strlen
argument_list|(
operator|*
name|out
argument_list|)
operator|+
name|strlen
argument_list|(
name|sfn
argument_list|)
operator|+
literal|2
argument_list|)
decl_stmt|;
name|strcpy
argument_list|(
name|new
argument_list|,
operator|*
name|out
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|new
argument_list|,
literal|"/"
argument_list|)
expr_stmt|;
name|strcat
argument_list|(
name|new
argument_list|,
name|sfn
argument_list|)
expr_stmt|;
operator|*
name|out
operator|=
name|new
expr_stmt|;
return|return
literal|0
return|;
block|}
empty_stmt|;
return|return
literal|0
return|;
block|}
end_function

end_unit

