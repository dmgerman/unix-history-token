begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* s_erff.c -- float version of s_erf.c.  * Conversion to float by Ian Lance Taylor, Cygnus Support, ian@cygnus.com.  */
end_comment

begin_comment
comment|/*  * ====================================================  * Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  *  * Developed at SunPro, a Sun Microsystems, Inc. business.  * Permission to use, copy, modify, and distribute this  * software is freely granted, provided that this notice  * is preserved.  * ====================================================  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_include
include|#
directive|include
file|"math.h"
end_include

begin_include
include|#
directive|include
file|"math_private.h"
end_include

begin_comment
comment|/* XXX Prevent compilers from erroneously constant folding: */
end_comment

begin_decl_stmt
specifier|static
specifier|const
specifier|volatile
name|float
name|tiny
init|=
literal|1e-30
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|float
name|half
init|=
literal|0.5
decl_stmt|,
name|one
init|=
literal|1
decl_stmt|,
name|two
init|=
literal|2
decl_stmt|,
name|erx
init|=
literal|8.42697144e-01
decl_stmt|,
comment|/* 0x3f57bb00 */
comment|/*  * In the domain [0, 2**-14], only the first term in the power series  * expansion of erf(x) is used.  The magnitude of the first neglected  * terms is less than 2**-42.  */
name|efx
init|=
literal|1.28379166e-01
decl_stmt|,
comment|/* 0x3e0375d4 */
name|efx8
init|=
literal|1.02703333e+00
decl_stmt|,
comment|/* 0x3f8375d4 */
comment|/*  * Domain [0, 0.84375], range ~[-5.4419e-10, 5.5179e-10]:  * |(erf(x) - x)/x - pp(x)/qq(x)|< 2**-31  */
name|pp0
init|=
literal|1.28379166e-01
decl_stmt|,
comment|/* 0x3e0375d4 */
name|pp1
init|=
operator|-
literal|3.36030394e-01
decl_stmt|,
comment|/* 0xbeac0c2d */
name|pp2
init|=
operator|-
literal|1.86261395e-03
decl_stmt|,
comment|/* 0xbaf422f4 */
name|qq1
init|=
literal|3.12324315e-01
decl_stmt|,
comment|/* 0x3e9fe8f9 */
name|qq2
init|=
literal|2.16070414e-02
decl_stmt|,
comment|/* 0x3cb10140 */
name|qq3
init|=
operator|-
literal|1.98859372e-03
decl_stmt|,
comment|/* 0xbb025311 */
comment|/*  * Domain [0.84375, 1.25], range ~[-1.023e-9, 1.023e-9]:  * |(erf(x) - erx) - pa(x)/qa(x)|< 2**-31  */
name|pa0
init|=
literal|3.65041046e-06
decl_stmt|,
comment|/* 0x3674f993 */
name|pa1
init|=
literal|4.15109307e-01
decl_stmt|,
comment|/* 0x3ed48935 */
name|pa2
init|=
operator|-
literal|2.09395722e-01
decl_stmt|,
comment|/* 0xbe566bd5 */
name|pa3
init|=
literal|8.67677554e-02
decl_stmt|,
comment|/* 0x3db1b34b */
name|qa1
init|=
literal|4.95560974e-01
decl_stmt|,
comment|/* 0x3efdba2b */
name|qa2
init|=
literal|3.71248513e-01
decl_stmt|,
comment|/* 0x3ebe1449 */
name|qa3
init|=
literal|3.92478965e-02
decl_stmt|,
comment|/* 0x3d20c267 */
comment|/*  * Domain [1.25,1/0.35], range ~[-4.821e-9, 4.927e-9]:  * |log(x*erfc(x)) + x**2 + 0.5625 - ra(x)/sa(x)|< 2**-28  */
name|ra0
init|=
operator|-
literal|9.88156721e-03
decl_stmt|,
comment|/* 0xbc21e64c */
name|ra1
init|=
operator|-
literal|5.43658376e-01
decl_stmt|,
comment|/* 0xbf0b2d32 */
name|ra2
init|=
operator|-
literal|1.66828310e+00
decl_stmt|,
comment|/* 0xbfd58a4d */
name|ra3
init|=
operator|-
literal|6.91554189e-01
decl_stmt|,
comment|/* 0xbf3109b2 */
name|sa1
init|=
literal|4.48581553e+00
decl_stmt|,
comment|/* 0x408f8bcd */
name|sa2
init|=
literal|4.10799170e+00
decl_stmt|,
comment|/* 0x408374ab */
name|sa3
init|=
literal|5.53855181e-01
decl_stmt|,
comment|/* 0x3f0dc974 */
comment|/*  * Domain [2.85715, 11], range ~[-1.484e-9, 1.505e-9]:  * |log(x*erfc(x)) + x**2 + 0.5625 - rb(x)/sb(x)|< 2**-30  */
name|rb0
init|=
operator|-
literal|9.86496918e-03
decl_stmt|,
comment|/* 0xbc21a0ae */
name|rb1
init|=
operator|-
literal|5.48049808e-01
decl_stmt|,
comment|/* 0xbf0c4cfe */
name|rb2
init|=
operator|-
literal|1.84115684e+00
decl_stmt|,
comment|/* 0xbfebab07 */
name|sb1
init|=
literal|4.87132740e+00
decl_stmt|,
comment|/* 0x409be1ea */
name|sb2
init|=
literal|3.04982710e+00
decl_stmt|,
comment|/* 0x4043305e */
name|sb3
init|=
operator|-
literal|7.61900663e-01
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* 0xbf430bec */
end_comment

begin_function
name|float
name|erff
parameter_list|(
name|float
name|x
parameter_list|)
block|{
name|int32_t
name|hx
decl_stmt|,
name|ix
decl_stmt|,
name|i
decl_stmt|;
name|float
name|R
decl_stmt|,
name|S
decl_stmt|,
name|P
decl_stmt|,
name|Q
decl_stmt|,
name|s
decl_stmt|,
name|y
decl_stmt|,
name|z
decl_stmt|,
name|r
decl_stmt|;
name|GET_FLOAT_WORD
argument_list|(
name|hx
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|ix
operator|=
name|hx
operator|&
literal|0x7fffffff
expr_stmt|;
if|if
condition|(
name|ix
operator|>=
literal|0x7f800000
condition|)
block|{
comment|/* erff(nan)=nan */
name|i
operator|=
operator|(
operator|(
name|u_int32_t
operator|)
name|hx
operator|>>
literal|31
operator|)
operator|<<
literal|1
expr_stmt|;
return|return
call|(
name|float
call|)
argument_list|(
literal|1
operator|-
name|i
argument_list|)
operator|+
name|one
operator|/
name|x
return|;
comment|/* erff(+-inf)=+-1 */
block|}
if|if
condition|(
name|ix
operator|<
literal|0x3f580000
condition|)
block|{
comment|/* |x|<0.84375 */
if|if
condition|(
name|ix
operator|<
literal|0x38800000
condition|)
block|{
comment|/* |x|<2**-14 */
if|if
condition|(
name|ix
operator|<
literal|0x04000000
condition|)
comment|/* |x|<0x1p-119 */
return|return
operator|(
literal|8
operator|*
name|x
operator|+
name|efx8
operator|*
name|x
operator|)
operator|/
literal|8
return|;
comment|/* avoid spurious underflow */
return|return
name|x
operator|+
name|efx
operator|*
name|x
return|;
block|}
name|z
operator|=
name|x
operator|*
name|x
expr_stmt|;
name|r
operator|=
name|pp0
operator|+
name|z
operator|*
operator|(
name|pp1
operator|+
name|z
operator|*
name|pp2
operator|)
expr_stmt|;
name|s
operator|=
name|one
operator|+
name|z
operator|*
operator|(
name|qq1
operator|+
name|z
operator|*
operator|(
name|qq2
operator|+
name|z
operator|*
name|qq3
operator|)
operator|)
expr_stmt|;
name|y
operator|=
name|r
operator|/
name|s
expr_stmt|;
return|return
name|x
operator|+
name|x
operator|*
name|y
return|;
block|}
if|if
condition|(
name|ix
operator|<
literal|0x3fa00000
condition|)
block|{
comment|/* 0.84375<= |x|< 1.25 */
name|s
operator|=
name|fabsf
argument_list|(
name|x
argument_list|)
operator|-
name|one
expr_stmt|;
name|P
operator|=
name|pa0
operator|+
name|s
operator|*
operator|(
name|pa1
operator|+
name|s
operator|*
operator|(
name|pa2
operator|+
name|s
operator|*
name|pa3
operator|)
operator|)
expr_stmt|;
name|Q
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|qa1
operator|+
name|s
operator|*
operator|(
name|qa2
operator|+
name|s
operator|*
name|qa3
operator|)
operator|)
expr_stmt|;
if|if
condition|(
name|hx
operator|>=
literal|0
condition|)
return|return
name|erx
operator|+
name|P
operator|/
name|Q
return|;
else|else
return|return
operator|-
name|erx
operator|-
name|P
operator|/
name|Q
return|;
block|}
if|if
condition|(
name|ix
operator|>=
literal|0x40800000
condition|)
block|{
comment|/* inf>|x|>=4 */
if|if
condition|(
name|hx
operator|>=
literal|0
condition|)
return|return
name|one
operator|-
name|tiny
return|;
else|else
return|return
name|tiny
operator|-
name|one
return|;
block|}
name|x
operator|=
name|fabsf
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|s
operator|=
name|one
operator|/
operator|(
name|x
operator|*
name|x
operator|)
expr_stmt|;
if|if
condition|(
name|ix
operator|<
literal|0x4036db8c
condition|)
block|{
comment|/* |x|< 2.85715 ~ 1/0.35 */
name|R
operator|=
name|ra0
operator|+
name|s
operator|*
operator|(
name|ra1
operator|+
name|s
operator|*
operator|(
name|ra2
operator|+
name|s
operator|*
name|ra3
operator|)
operator|)
expr_stmt|;
name|S
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|sa1
operator|+
name|s
operator|*
operator|(
name|sa2
operator|+
name|s
operator|*
name|sa3
operator|)
operator|)
expr_stmt|;
block|}
else|else
block|{
comment|/* |x|>= 2.85715 ~ 1/0.35 */
name|R
operator|=
name|rb0
operator|+
name|s
operator|*
operator|(
name|rb1
operator|+
name|s
operator|*
name|rb2
operator|)
expr_stmt|;
name|S
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|sb1
operator|+
name|s
operator|*
operator|(
name|sb2
operator|+
name|s
operator|*
name|sb3
operator|)
operator|)
expr_stmt|;
block|}
name|SET_FLOAT_WORD
argument_list|(
name|z
argument_list|,
name|hx
operator|&
literal|0xffffe000
argument_list|)
expr_stmt|;
name|r
operator|=
name|expf
argument_list|(
operator|-
name|z
operator|*
name|z
operator|-
literal|0.5625F
argument_list|)
operator|*
name|expf
argument_list|(
operator|(
name|z
operator|-
name|x
operator|)
operator|*
operator|(
name|z
operator|+
name|x
operator|)
operator|+
name|R
operator|/
name|S
argument_list|)
expr_stmt|;
if|if
condition|(
name|hx
operator|>=
literal|0
condition|)
return|return
name|one
operator|-
name|r
operator|/
name|x
return|;
else|else
return|return
name|r
operator|/
name|x
operator|-
name|one
return|;
block|}
end_function

begin_function
name|float
name|erfcf
parameter_list|(
name|float
name|x
parameter_list|)
block|{
name|int32_t
name|hx
decl_stmt|,
name|ix
decl_stmt|;
name|float
name|R
decl_stmt|,
name|S
decl_stmt|,
name|P
decl_stmt|,
name|Q
decl_stmt|,
name|s
decl_stmt|,
name|y
decl_stmt|,
name|z
decl_stmt|,
name|r
decl_stmt|;
name|GET_FLOAT_WORD
argument_list|(
name|hx
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|ix
operator|=
name|hx
operator|&
literal|0x7fffffff
expr_stmt|;
if|if
condition|(
name|ix
operator|>=
literal|0x7f800000
condition|)
block|{
comment|/* erfcf(nan)=nan */
comment|/* erfcf(+-inf)=0,2 */
return|return
call|(
name|float
call|)
argument_list|(
operator|(
operator|(
name|u_int32_t
operator|)
name|hx
operator|>>
literal|31
operator|)
operator|<<
literal|1
argument_list|)
operator|+
name|one
operator|/
name|x
return|;
block|}
if|if
condition|(
name|ix
operator|<
literal|0x3f580000
condition|)
block|{
comment|/* |x|<0.84375 */
if|if
condition|(
name|ix
operator|<
literal|0x33800000
condition|)
comment|/* |x|<2**-24 */
return|return
name|one
operator|-
name|x
return|;
name|z
operator|=
name|x
operator|*
name|x
expr_stmt|;
name|r
operator|=
name|pp0
operator|+
name|z
operator|*
operator|(
name|pp1
operator|+
name|z
operator|*
name|pp2
operator|)
expr_stmt|;
name|s
operator|=
name|one
operator|+
name|z
operator|*
operator|(
name|qq1
operator|+
name|z
operator|*
operator|(
name|qq2
operator|+
name|z
operator|*
name|qq3
operator|)
operator|)
expr_stmt|;
name|y
operator|=
name|r
operator|/
name|s
expr_stmt|;
if|if
condition|(
name|hx
operator|<
literal|0x3e800000
condition|)
block|{
comment|/* x<1/4 */
return|return
name|one
operator|-
operator|(
name|x
operator|+
name|x
operator|*
name|y
operator|)
return|;
block|}
else|else
block|{
name|r
operator|=
name|x
operator|*
name|y
expr_stmt|;
name|r
operator|+=
operator|(
name|x
operator|-
name|half
operator|)
expr_stmt|;
return|return
name|half
operator|-
name|r
return|;
block|}
block|}
if|if
condition|(
name|ix
operator|<
literal|0x3fa00000
condition|)
block|{
comment|/* 0.84375<= |x|< 1.25 */
name|s
operator|=
name|fabsf
argument_list|(
name|x
argument_list|)
operator|-
name|one
expr_stmt|;
name|P
operator|=
name|pa0
operator|+
name|s
operator|*
operator|(
name|pa1
operator|+
name|s
operator|*
operator|(
name|pa2
operator|+
name|s
operator|*
name|pa3
operator|)
operator|)
expr_stmt|;
name|Q
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|qa1
operator|+
name|s
operator|*
operator|(
name|qa2
operator|+
name|s
operator|*
name|qa3
operator|)
operator|)
expr_stmt|;
if|if
condition|(
name|hx
operator|>=
literal|0
condition|)
block|{
name|z
operator|=
name|one
operator|-
name|erx
expr_stmt|;
return|return
name|z
operator|-
name|P
operator|/
name|Q
return|;
block|}
else|else
block|{
name|z
operator|=
name|erx
operator|+
name|P
operator|/
name|Q
expr_stmt|;
return|return
name|one
operator|+
name|z
return|;
block|}
block|}
if|if
condition|(
name|ix
operator|<
literal|0x41300000
condition|)
block|{
comment|/* |x|<11 */
name|x
operator|=
name|fabsf
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|s
operator|=
name|one
operator|/
operator|(
name|x
operator|*
name|x
operator|)
expr_stmt|;
if|if
condition|(
name|ix
operator|<
literal|0x4036db8c
condition|)
block|{
comment|/* |x|< 2.85715 ~ 1/.35 */
name|R
operator|=
name|ra0
operator|+
name|s
operator|*
operator|(
name|ra1
operator|+
name|s
operator|*
operator|(
name|ra2
operator|+
name|s
operator|*
name|ra3
operator|)
operator|)
expr_stmt|;
name|S
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|sa1
operator|+
name|s
operator|*
operator|(
name|sa2
operator|+
name|s
operator|*
name|sa3
operator|)
operator|)
expr_stmt|;
block|}
else|else
block|{
comment|/* |x|>= 2.85715 ~ 1/.35 */
if|if
condition|(
name|hx
operator|<
literal|0
operator|&&
name|ix
operator|>=
literal|0x40a00000
condition|)
return|return
name|two
operator|-
name|tiny
return|;
comment|/* x< -5 */
name|R
operator|=
name|rb0
operator|+
name|s
operator|*
operator|(
name|rb1
operator|+
name|s
operator|*
name|rb2
operator|)
expr_stmt|;
name|S
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|sb1
operator|+
name|s
operator|*
operator|(
name|sb2
operator|+
name|s
operator|*
name|sb3
operator|)
operator|)
expr_stmt|;
block|}
name|SET_FLOAT_WORD
argument_list|(
name|z
argument_list|,
name|hx
operator|&
literal|0xffffe000
argument_list|)
expr_stmt|;
name|r
operator|=
name|expf
argument_list|(
operator|-
name|z
operator|*
name|z
operator|-
literal|0.5625F
argument_list|)
operator|*
name|expf
argument_list|(
operator|(
name|z
operator|-
name|x
operator|)
operator|*
operator|(
name|z
operator|+
name|x
operator|)
operator|+
name|R
operator|/
name|S
argument_list|)
expr_stmt|;
if|if
condition|(
name|hx
operator|>
literal|0
condition|)
return|return
name|r
operator|/
name|x
return|;
else|else
return|return
name|two
operator|-
name|r
operator|/
name|x
return|;
block|}
else|else
block|{
if|if
condition|(
name|hx
operator|>
literal|0
condition|)
return|return
name|tiny
operator|*
name|tiny
return|;
else|else
return|return
name|two
operator|-
name|tiny
return|;
block|}
block|}
end_function

end_unit

