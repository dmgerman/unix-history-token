begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* @(#)e_j1.c 5.1 93/09/24 */
end_comment

begin_comment
comment|/*  * ====================================================  * Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  *  * Developed at SunPro, a Sun Microsystems, Inc. business.  * Permission to use, copy, modify, and distribute this  * software is freely granted, provided that this notice  * is preserved.  * ====================================================  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
name|rcsid
index|[]
init|=
literal|"$FreeBSD$"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* __ieee754_j1(x), __ieee754_y1(x)  * Bessel function of the first and second kinds of order zero.  * Method -- j1(x):  *	1. For tiny x, we use j1(x) = x/2 - x^3/16 + x^5/384 - ...  *	2. Reduce x to |x| since j1(x)=-j1(-x),  and  *	   for x in (0,2)  *		j1(x) = x/2 + x*z*R0/S0,  where z = x*x;  *	   (precision:  |j1/x - 1/2 - R0/S0 |<2**-61.51 )  *	   for x in (2,inf)  * 		j1(x) = sqrt(2/(pi*x))*(p1(x)*cos(x1)-q1(x)*sin(x1))  * 		y1(x) = sqrt(2/(pi*x))*(p1(x)*sin(x1)+q1(x)*cos(x1))  * 	   where x1 = x-3*pi/4. It is better to compute sin(x1),cos(x1)  *	   as follow:  *		cos(x1) =  cos(x)cos(3pi/4)+sin(x)sin(3pi/4)  *			=  1/sqrt(2) * (sin(x) - cos(x))  *		sin(x1) =  sin(x)cos(3pi/4)-cos(x)sin(3pi/4)  *			= -1/sqrt(2) * (sin(x) + cos(x))  * 	   (To avoid cancellation, use  *		sin(x) +- cos(x) = -cos(2x)/(sin(x) -+ cos(x))  * 	    to compute the worse one.)  *  *	3 Special cases  *		j1(nan)= nan  *		j1(0) = 0  *		j1(inf) = 0  *  * Method -- y1(x):  *	1. screen out x<=0 cases: y1(0)=-inf, y1(x<0)=NaN  *	2. For x<2.  *	   Since  *		y1(x) = 2/pi*(j1(x)*(ln(x/2)+Euler)-1/x-x/2+5/64*x^3-...)  *	   therefore y1(x)-2/pi*j1(x)*ln(x)-1/x is an odd function.  *	   We use the following function to approximate y1,  *		y1(x) = x*U(z)/V(z) + (2/pi)*(j1(x)*ln(x)-1/x), z= x^2  *	   where for x in [0,2] (abs err less than 2**-65.89)  *		U(z) = U0[0] + U0[1]*z + ... + U0[4]*z^4  *		V(z) = 1  + v0[0]*z + ... + v0[4]*z^5  *	   Note: For tiny x, 1/x dominate y1 and hence  *		y1(tiny) = -2/pi/tiny, (choose tiny<2**-54)  *	3. For x>=2.  * 		y1(x) = sqrt(2/(pi*x))*(p1(x)*sin(x1)+q1(x)*cos(x1))  * 	   where x1 = x-3*pi/4. It is better to compute sin(x1),cos(x1)  *	   by method mentioned above.  */
end_comment

begin_include
include|#
directive|include
file|"math.h"
end_include

begin_include
include|#
directive|include
file|"math_private.h"
end_include

begin_decl_stmt
specifier|static
name|double
name|pone
argument_list|(
name|double
argument_list|)
decl_stmt|,
name|qone
argument_list|(
name|double
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|huge
init|=
literal|1e300
decl_stmt|,
name|one
init|=
literal|1.0
decl_stmt|,
name|invsqrtpi
init|=
literal|5.64189583547756279280e-01
decl_stmt|,
comment|/* 0x3FE20DD7, 0x50429B6D */
name|tpi
init|=
literal|6.36619772367581382433e-01
decl_stmt|,
comment|/* 0x3FE45F30, 0x6DC9C883 */
comment|/* R0/S0 on [0,2] */
name|r00
init|=
operator|-
literal|6.25000000000000000000e-02
decl_stmt|,
comment|/* 0xBFB00000, 0x00000000 */
name|r01
init|=
literal|1.40705666955189706048e-03
decl_stmt|,
comment|/* 0x3F570D9F, 0x98472C61 */
name|r02
init|=
operator|-
literal|1.59955631084035597520e-05
decl_stmt|,
comment|/* 0xBEF0C5C6, 0xBA169668 */
name|r03
init|=
literal|4.96727999609584448412e-08
decl_stmt|,
comment|/* 0x3E6AAAFA, 0x46CA0BD9 */
name|s01
init|=
literal|1.91537599538363460805e-02
decl_stmt|,
comment|/* 0x3F939D0B, 0x12637E53 */
name|s02
init|=
literal|1.85946785588630915560e-04
decl_stmt|,
comment|/* 0x3F285F56, 0xB9CDF664 */
name|s03
init|=
literal|1.17718464042623683263e-06
decl_stmt|,
comment|/* 0x3EB3BFF8, 0x333F8498 */
name|s04
init|=
literal|5.04636257076217042715e-09
decl_stmt|,
comment|/* 0x3E35AC88, 0xC97DFF2C */
name|s05
init|=
literal|1.23542274426137913908e-11
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* 0x3DAB2ACF, 0xCFB97ED8 */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|double
name|zero
init|=
literal|0.0
decl_stmt|;
end_decl_stmt

begin_function
name|double
name|__ieee754_j1
parameter_list|(
name|double
name|x
parameter_list|)
block|{
name|double
name|z
decl_stmt|,
name|s
decl_stmt|,
name|c
decl_stmt|,
name|ss
decl_stmt|,
name|cc
decl_stmt|,
name|r
decl_stmt|,
name|u
decl_stmt|,
name|v
decl_stmt|,
name|y
decl_stmt|;
name|int32_t
name|hx
decl_stmt|,
name|ix
decl_stmt|;
name|GET_HIGH_WORD
argument_list|(
name|hx
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|ix
operator|=
name|hx
operator|&
literal|0x7fffffff
expr_stmt|;
if|if
condition|(
name|ix
operator|>=
literal|0x7ff00000
condition|)
return|return
name|one
operator|/
name|x
return|;
name|y
operator|=
name|fabs
argument_list|(
name|x
argument_list|)
expr_stmt|;
if|if
condition|(
name|ix
operator|>=
literal|0x40000000
condition|)
block|{
comment|/* |x|>= 2.0 */
name|s
operator|=
name|sin
argument_list|(
name|y
argument_list|)
expr_stmt|;
name|c
operator|=
name|cos
argument_list|(
name|y
argument_list|)
expr_stmt|;
name|ss
operator|=
operator|-
name|s
operator|-
name|c
expr_stmt|;
name|cc
operator|=
name|s
operator|-
name|c
expr_stmt|;
if|if
condition|(
name|ix
operator|<
literal|0x7fe00000
condition|)
block|{
comment|/* make sure y+y not overflow */
name|z
operator|=
name|cos
argument_list|(
name|y
operator|+
name|y
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|s
operator|*
name|c
operator|)
operator|>
name|zero
condition|)
name|cc
operator|=
name|z
operator|/
name|ss
expr_stmt|;
else|else
name|ss
operator|=
name|z
operator|/
name|cc
expr_stmt|;
block|}
comment|/* 	 * j1(x) = 1/sqrt(pi) * (P(1,x)*cc - Q(1,x)*ss) / sqrt(x) 	 * y1(x) = 1/sqrt(pi) * (P(1,x)*ss + Q(1,x)*cc) / sqrt(x) 	 */
if|if
condition|(
name|ix
operator|>
literal|0x48000000
condition|)
name|z
operator|=
operator|(
name|invsqrtpi
operator|*
name|cc
operator|)
operator|/
name|sqrt
argument_list|(
name|y
argument_list|)
expr_stmt|;
else|else
block|{
name|u
operator|=
name|pone
argument_list|(
name|y
argument_list|)
expr_stmt|;
name|v
operator|=
name|qone
argument_list|(
name|y
argument_list|)
expr_stmt|;
name|z
operator|=
name|invsqrtpi
operator|*
operator|(
name|u
operator|*
name|cc
operator|-
name|v
operator|*
name|ss
operator|)
operator|/
name|sqrt
argument_list|(
name|y
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|hx
operator|<
literal|0
condition|)
return|return
operator|-
name|z
return|;
else|else
return|return
name|z
return|;
block|}
if|if
condition|(
name|ix
operator|<
literal|0x3e400000
condition|)
block|{
comment|/* |x|<2**-27 */
if|if
condition|(
name|huge
operator|+
name|x
operator|>
name|one
condition|)
return|return
literal|0.5
operator|*
name|x
return|;
comment|/* inexact if x!=0 necessary */
block|}
name|z
operator|=
name|x
operator|*
name|x
expr_stmt|;
name|r
operator|=
name|z
operator|*
operator|(
name|r00
operator|+
name|z
operator|*
operator|(
name|r01
operator|+
name|z
operator|*
operator|(
name|r02
operator|+
name|z
operator|*
name|r03
operator|)
operator|)
operator|)
expr_stmt|;
name|s
operator|=
name|one
operator|+
name|z
operator|*
operator|(
name|s01
operator|+
name|z
operator|*
operator|(
name|s02
operator|+
name|z
operator|*
operator|(
name|s03
operator|+
name|z
operator|*
operator|(
name|s04
operator|+
name|z
operator|*
name|s05
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|r
operator|*=
name|x
expr_stmt|;
return|return
operator|(
name|x
operator|*
literal|0.5
operator|+
name|r
operator|/
name|s
operator|)
return|;
block|}
end_function

begin_decl_stmt
specifier|static
specifier|const
name|double
name|U0
index|[
literal|5
index|]
init|=
block|{
operator|-
literal|1.96057090646238940668e-01
block|,
comment|/* 0xBFC91866, 0x143CBC8A */
literal|5.04438716639811282616e-02
block|,
comment|/* 0x3FA9D3C7, 0x76292CD1 */
operator|-
literal|1.91256895875763547298e-03
block|,
comment|/* 0xBF5F55E5, 0x4844F50F */
literal|2.35252600561610495928e-05
block|,
comment|/* 0x3EF8AB03, 0x8FA6B88E */
operator|-
literal|9.19099158039878874504e-08
block|,
comment|/* 0xBE78AC00, 0x569105B8 */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|V0
index|[
literal|5
index|]
init|=
block|{
literal|1.99167318236649903973e-02
block|,
comment|/* 0x3F94650D, 0x3F4DA9F0 */
literal|2.02552581025135171496e-04
block|,
comment|/* 0x3F2A8C89, 0x6C257764 */
literal|1.35608801097516229404e-06
block|,
comment|/* 0x3EB6C05A, 0x894E8CA6 */
literal|6.22741452364621501295e-09
block|,
comment|/* 0x3E3ABF1D, 0x5BA69A86 */
literal|1.66559246207992079114e-11
block|,
comment|/* 0x3DB25039, 0xDACA772A */
block|}
decl_stmt|;
end_decl_stmt

begin_function
name|double
name|__ieee754_y1
parameter_list|(
name|double
name|x
parameter_list|)
block|{
name|double
name|z
decl_stmt|,
name|s
decl_stmt|,
name|c
decl_stmt|,
name|ss
decl_stmt|,
name|cc
decl_stmt|,
name|u
decl_stmt|,
name|v
decl_stmt|;
name|int32_t
name|hx
decl_stmt|,
name|ix
decl_stmt|,
name|lx
decl_stmt|;
name|EXTRACT_WORDS
argument_list|(
name|hx
argument_list|,
name|lx
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|ix
operator|=
literal|0x7fffffff
operator|&
name|hx
expr_stmt|;
comment|/* if Y1(NaN) is NaN, Y1(-inf) is NaN, Y1(inf) is 0 */
if|if
condition|(
name|ix
operator|>=
literal|0x7ff00000
condition|)
return|return
name|one
operator|/
operator|(
name|x
operator|+
name|x
operator|*
name|x
operator|)
return|;
if|if
condition|(
operator|(
name|ix
operator||
name|lx
operator|)
operator|==
literal|0
condition|)
return|return
operator|-
name|one
operator|/
name|zero
return|;
if|if
condition|(
name|hx
operator|<
literal|0
condition|)
return|return
name|zero
operator|/
name|zero
return|;
if|if
condition|(
name|ix
operator|>=
literal|0x40000000
condition|)
block|{
comment|/* |x|>= 2.0 */
name|s
operator|=
name|sin
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|c
operator|=
name|cos
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|ss
operator|=
operator|-
name|s
operator|-
name|c
expr_stmt|;
name|cc
operator|=
name|s
operator|-
name|c
expr_stmt|;
if|if
condition|(
name|ix
operator|<
literal|0x7fe00000
condition|)
block|{
comment|/* make sure x+x not overflow */
name|z
operator|=
name|cos
argument_list|(
name|x
operator|+
name|x
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|s
operator|*
name|c
operator|)
operator|>
name|zero
condition|)
name|cc
operator|=
name|z
operator|/
name|ss
expr_stmt|;
else|else
name|ss
operator|=
name|z
operator|/
name|cc
expr_stmt|;
block|}
comment|/* y1(x) = sqrt(2/(pi*x))*(p1(x)*sin(x0)+q1(x)*cos(x0))          * where x0 = x-3pi/4          *      Better formula:          *              cos(x0) = cos(x)cos(3pi/4)+sin(x)sin(3pi/4)          *                      =  1/sqrt(2) * (sin(x) - cos(x))          *              sin(x0) = sin(x)cos(3pi/4)-cos(x)sin(3pi/4)          *                      = -1/sqrt(2) * (cos(x) + sin(x))          * To avoid cancellation, use          *              sin(x) +- cos(x) = -cos(2x)/(sin(x) -+ cos(x))          * to compute the worse one.          */
if|if
condition|(
name|ix
operator|>
literal|0x48000000
condition|)
name|z
operator|=
operator|(
name|invsqrtpi
operator|*
name|ss
operator|)
operator|/
name|sqrt
argument_list|(
name|x
argument_list|)
expr_stmt|;
else|else
block|{
name|u
operator|=
name|pone
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|v
operator|=
name|qone
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|z
operator|=
name|invsqrtpi
operator|*
operator|(
name|u
operator|*
name|ss
operator|+
name|v
operator|*
name|cc
operator|)
operator|/
name|sqrt
argument_list|(
name|x
argument_list|)
expr_stmt|;
block|}
return|return
name|z
return|;
block|}
if|if
condition|(
name|ix
operator|<=
literal|0x3c900000
condition|)
block|{
comment|/* x< 2**-54 */
return|return
operator|(
operator|-
name|tpi
operator|/
name|x
operator|)
return|;
block|}
name|z
operator|=
name|x
operator|*
name|x
expr_stmt|;
name|u
operator|=
name|U0
index|[
literal|0
index|]
operator|+
name|z
operator|*
operator|(
name|U0
index|[
literal|1
index|]
operator|+
name|z
operator|*
operator|(
name|U0
index|[
literal|2
index|]
operator|+
name|z
operator|*
operator|(
name|U0
index|[
literal|3
index|]
operator|+
name|z
operator|*
name|U0
index|[
literal|4
index|]
operator|)
operator|)
operator|)
expr_stmt|;
name|v
operator|=
name|one
operator|+
name|z
operator|*
operator|(
name|V0
index|[
literal|0
index|]
operator|+
name|z
operator|*
operator|(
name|V0
index|[
literal|1
index|]
operator|+
name|z
operator|*
operator|(
name|V0
index|[
literal|2
index|]
operator|+
name|z
operator|*
operator|(
name|V0
index|[
literal|3
index|]
operator|+
name|z
operator|*
name|V0
index|[
literal|4
index|]
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
return|return
operator|(
name|x
operator|*
operator|(
name|u
operator|/
name|v
operator|)
operator|+
name|tpi
operator|*
operator|(
name|__ieee754_j1
argument_list|(
name|x
argument_list|)
operator|*
name|__ieee754_log
argument_list|(
name|x
argument_list|)
operator|-
name|one
operator|/
name|x
operator|)
operator|)
return|;
block|}
end_function

begin_comment
comment|/* For x>= 8, the asymptotic expansions of pone is  *	1 + 15/128 s^2 - 4725/2^15 s^4 - ...,	where s = 1/x.  * We approximate pone by  * 	pone(x) = 1 + (R/S)  * where  R = pr0 + pr1*s^2 + pr2*s^4 + ... + pr5*s^10  * 	  S = 1 + ps0*s^2 + ... + ps4*s^10  * and  *	| pone(x)-1-R/S |<= 2  ** ( -60.06)  */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|double
name|pr8
index|[
literal|6
index|]
init|=
block|{
comment|/* for x in [inf, 8]=1/[0,0.125] */
literal|0.00000000000000000000e+00
block|,
comment|/* 0x00000000, 0x00000000 */
literal|1.17187499999988647970e-01
block|,
comment|/* 0x3FBDFFFF, 0xFFFFFCCE */
literal|1.32394806593073575129e+01
block|,
comment|/* 0x402A7A9D, 0x357F7FCE */
literal|4.12051854307378562225e+02
block|,
comment|/* 0x4079C0D4, 0x652EA590 */
literal|3.87474538913960532227e+03
block|,
comment|/* 0x40AE457D, 0xA3A532CC */
literal|7.91447954031891731574e+03
block|,
comment|/* 0x40BEEA7A, 0xC32782DD */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|ps8
index|[
literal|5
index|]
init|=
block|{
literal|1.14207370375678408436e+02
block|,
comment|/* 0x405C8D45, 0x8E656CAC */
literal|3.65093083420853463394e+03
block|,
comment|/* 0x40AC85DC, 0x964D274F */
literal|3.69562060269033463555e+04
block|,
comment|/* 0x40E20B86, 0x97C5BB7F */
literal|9.76027935934950801311e+04
block|,
comment|/* 0x40F7D42C, 0xB28F17BB */
literal|3.08042720627888811578e+04
block|,
comment|/* 0x40DE1511, 0x697A0B2D */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|pr5
index|[
literal|6
index|]
init|=
block|{
comment|/* for x in [8,4.5454]=1/[0.125,0.22001] */
literal|1.31990519556243522749e-11
block|,
comment|/* 0x3DAD0667, 0xDAE1CA7D */
literal|1.17187493190614097638e-01
block|,
comment|/* 0x3FBDFFFF, 0xE2C10043 */
literal|6.80275127868432871736e+00
block|,
comment|/* 0x401B3604, 0x6E6315E3 */
literal|1.08308182990189109773e+02
block|,
comment|/* 0x405B13B9, 0x452602ED */
literal|5.17636139533199752805e+02
block|,
comment|/* 0x40802D16, 0xD052D649 */
literal|5.28715201363337541807e+02
block|,
comment|/* 0x408085B8, 0xBB7E0CB7 */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|ps5
index|[
literal|5
index|]
init|=
block|{
literal|5.92805987221131331921e+01
block|,
comment|/* 0x404DA3EA, 0xA8AF633D */
literal|9.91401418733614377743e+02
block|,
comment|/* 0x408EFB36, 0x1B066701 */
literal|5.35326695291487976647e+03
block|,
comment|/* 0x40B4E944, 0x5706B6FB */
literal|7.84469031749551231769e+03
block|,
comment|/* 0x40BEA4B0, 0xB8A5BB15 */
literal|1.50404688810361062679e+03
block|,
comment|/* 0x40978030, 0x036F5E51 */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|pr3
index|[
literal|6
index|]
init|=
block|{
literal|3.02503916137373618024e-09
block|,
comment|/* 0x3E29FC21, 0xA7AD9EDD */
literal|1.17186865567253592491e-01
block|,
comment|/* 0x3FBDFFF5, 0x5B21D17B */
literal|3.93297750033315640650e+00
block|,
comment|/* 0x400F76BC, 0xE85EAD8A */
literal|3.51194035591636932736e+01
block|,
comment|/* 0x40418F48, 0x9DA6D129 */
literal|9.10550110750781271918e+01
block|,
comment|/* 0x4056C385, 0x4D2C1837 */
literal|4.85590685197364919645e+01
block|,
comment|/* 0x4048478F, 0x8EA83EE5 */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|ps3
index|[
literal|5
index|]
init|=
block|{
literal|3.47913095001251519989e+01
block|,
comment|/* 0x40416549, 0xA134069C */
literal|3.36762458747825746741e+02
block|,
comment|/* 0x40750C33, 0x07F1A75F */
literal|1.04687139975775130551e+03
block|,
comment|/* 0x40905B7C, 0x5037D523 */
literal|8.90811346398256432622e+02
block|,
comment|/* 0x408BD67D, 0xA32E31E9 */
literal|1.03787932439639277504e+02
block|,
comment|/* 0x4059F26D, 0x7C2EED53 */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|pr2
index|[
literal|6
index|]
init|=
block|{
comment|/* for x in [2.8570,2]=1/[0.3499,0.5] */
literal|1.07710830106873743082e-07
block|,
comment|/* 0x3E7CE9D4, 0xF65544F4 */
literal|1.17176219462683348094e-01
block|,
comment|/* 0x3FBDFF42, 0xBE760D83 */
literal|2.36851496667608785174e+00
block|,
comment|/* 0x4002F2B7, 0xF98FAEC0 */
literal|1.22426109148261232917e+01
block|,
comment|/* 0x40287C37, 0x7F71A964 */
literal|1.76939711271687727390e+01
block|,
comment|/* 0x4031B1A8, 0x177F8EE2 */
literal|5.07352312588818499250e+00
block|,
comment|/* 0x40144B49, 0xA574C1FE */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|ps2
index|[
literal|5
index|]
init|=
block|{
literal|2.14364859363821409488e+01
block|,
comment|/* 0x40356FBD, 0x8AD5ECDC */
literal|1.25290227168402751090e+02
block|,
comment|/* 0x405F5293, 0x14F92CD5 */
literal|2.32276469057162813669e+02
block|,
comment|/* 0x406D08D8, 0xD5A2DBD9 */
literal|1.17679373287147100768e+02
block|,
comment|/* 0x405D6B7A, 0xDA1884A9 */
literal|8.36463893371618283368e+00
block|,
comment|/* 0x4020BAB1, 0xF44E5192 */
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|double
name|pone
parameter_list|(
name|double
name|x
parameter_list|)
block|{
specifier|const
name|double
modifier|*
name|p
decl_stmt|,
modifier|*
name|q
decl_stmt|;
name|double
name|z
decl_stmt|,
name|r
decl_stmt|,
name|s
decl_stmt|;
name|int32_t
name|ix
decl_stmt|;
name|GET_HIGH_WORD
argument_list|(
name|ix
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|ix
operator|&=
literal|0x7fffffff
expr_stmt|;
if|if
condition|(
name|ix
operator|>=
literal|0x40200000
condition|)
block|{
name|p
operator|=
name|pr8
expr_stmt|;
name|q
operator|=
name|ps8
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|ix
operator|>=
literal|0x40122E8B
condition|)
block|{
name|p
operator|=
name|pr5
expr_stmt|;
name|q
operator|=
name|ps5
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|ix
operator|>=
literal|0x4006DB6D
condition|)
block|{
name|p
operator|=
name|pr3
expr_stmt|;
name|q
operator|=
name|ps3
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|ix
operator|>=
literal|0x40000000
condition|)
block|{
name|p
operator|=
name|pr2
expr_stmt|;
name|q
operator|=
name|ps2
expr_stmt|;
block|}
name|z
operator|=
name|one
operator|/
operator|(
name|x
operator|*
name|x
operator|)
expr_stmt|;
name|r
operator|=
name|p
index|[
literal|0
index|]
operator|+
name|z
operator|*
operator|(
name|p
index|[
literal|1
index|]
operator|+
name|z
operator|*
operator|(
name|p
index|[
literal|2
index|]
operator|+
name|z
operator|*
operator|(
name|p
index|[
literal|3
index|]
operator|+
name|z
operator|*
operator|(
name|p
index|[
literal|4
index|]
operator|+
name|z
operator|*
name|p
index|[
literal|5
index|]
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|s
operator|=
name|one
operator|+
name|z
operator|*
operator|(
name|q
index|[
literal|0
index|]
operator|+
name|z
operator|*
operator|(
name|q
index|[
literal|1
index|]
operator|+
name|z
operator|*
operator|(
name|q
index|[
literal|2
index|]
operator|+
name|z
operator|*
operator|(
name|q
index|[
literal|3
index|]
operator|+
name|z
operator|*
name|q
index|[
literal|4
index|]
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
return|return
name|one
operator|+
name|r
operator|/
name|s
return|;
block|}
end_function

begin_comment
comment|/* For x>= 8, the asymptotic expansions of qone is  *	3/8 s - 105/1024 s^3 - ..., where s = 1/x.  * We approximate pone by  * 	qone(x) = s*(0.375 + (R/S))  * where  R = qr1*s^2 + qr2*s^4 + ... + qr5*s^10  * 	  S = 1 + qs1*s^2 + ... + qs6*s^12  * and  *	| qone(x)/s -0.375-R/S |<= 2  ** ( -61.13)  */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|double
name|qr8
index|[
literal|6
index|]
init|=
block|{
comment|/* for x in [inf, 8]=1/[0,0.125] */
literal|0.00000000000000000000e+00
block|,
comment|/* 0x00000000, 0x00000000 */
operator|-
literal|1.02539062499992714161e-01
block|,
comment|/* 0xBFBA3FFF, 0xFFFFFDF3 */
operator|-
literal|1.62717534544589987888e+01
block|,
comment|/* 0xC0304591, 0xA26779F7 */
operator|-
literal|7.59601722513950107896e+02
block|,
comment|/* 0xC087BCD0, 0x53E4B576 */
operator|-
literal|1.18498066702429587167e+04
block|,
comment|/* 0xC0C724E7, 0x40F87415 */
operator|-
literal|4.84385124285750353010e+04
block|,
comment|/* 0xC0E7A6D0, 0x65D09C6A */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|qs8
index|[
literal|6
index|]
init|=
block|{
literal|1.61395369700722909556e+02
block|,
comment|/* 0x40642CA6, 0xDE5BCDE5 */
literal|7.82538599923348465381e+03
block|,
comment|/* 0x40BE9162, 0xD0D88419 */
literal|1.33875336287249578163e+05
block|,
comment|/* 0x4100579A, 0xB0B75E98 */
literal|7.19657723683240939863e+05
block|,
comment|/* 0x4125F653, 0x72869C19 */
literal|6.66601232617776375264e+05
block|,
comment|/* 0x412457D2, 0x7719AD5C */
operator|-
literal|2.94490264303834643215e+05
block|,
comment|/* 0xC111F969, 0x0EA5AA18 */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|qr5
index|[
literal|6
index|]
init|=
block|{
comment|/* for x in [8,4.5454]=1/[0.125,0.22001] */
operator|-
literal|2.08979931141764104297e-11
block|,
comment|/* 0xBDB6FA43, 0x1AA1A098 */
operator|-
literal|1.02539050241375426231e-01
block|,
comment|/* 0xBFBA3FFF, 0xCB597FEF */
operator|-
literal|8.05644828123936029840e+00
block|,
comment|/* 0xC0201CE6, 0xCA03AD4B */
operator|-
literal|1.83669607474888380239e+02
block|,
comment|/* 0xC066F56D, 0x6CA7B9B0 */
operator|-
literal|1.37319376065508163265e+03
block|,
comment|/* 0xC09574C6, 0x6931734F */
operator|-
literal|2.61244440453215656817e+03
block|,
comment|/* 0xC0A468E3, 0x88FDA79D */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|qs5
index|[
literal|6
index|]
init|=
block|{
literal|8.12765501384335777857e+01
block|,
comment|/* 0x405451B2, 0xFF5A11B2 */
literal|1.99179873460485964642e+03
block|,
comment|/* 0x409F1F31, 0xE77BF839 */
literal|1.74684851924908907677e+04
block|,
comment|/* 0x40D10F1F, 0x0D64CE29 */
literal|4.98514270910352279316e+04
block|,
comment|/* 0x40E8576D, 0xAABAD197 */
literal|2.79480751638918118260e+04
block|,
comment|/* 0x40DB4B04, 0xCF7C364B */
operator|-
literal|4.71918354795128470869e+03
block|,
comment|/* 0xC0B26F2E, 0xFCFFA004 */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|qr3
index|[
literal|6
index|]
init|=
block|{
operator|-
literal|5.07831226461766561369e-09
block|,
comment|/* 0xBE35CFA9, 0xD38FC84F */
operator|-
literal|1.02537829820837089745e-01
block|,
comment|/* 0xBFBA3FEB, 0x51AEED54 */
operator|-
literal|4.61011581139473403113e+00
block|,
comment|/* 0xC01270C2, 0x3302D9FF */
operator|-
literal|5.78472216562783643212e+01
block|,
comment|/* 0xC04CEC71, 0xC25D16DA */
operator|-
literal|2.28244540737631695038e+02
block|,
comment|/* 0xC06C87D3, 0x4718D55F */
operator|-
literal|2.19210128478909325622e+02
block|,
comment|/* 0xC06B66B9, 0x5F5C1BF6 */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|qs3
index|[
literal|6
index|]
init|=
block|{
literal|4.76651550323729509273e+01
block|,
comment|/* 0x4047D523, 0xCCD367E4 */
literal|6.73865112676699709482e+02
block|,
comment|/* 0x40850EEB, 0xC031EE3E */
literal|3.38015286679526343505e+03
block|,
comment|/* 0x40AA684E, 0x448E7C9A */
literal|5.54772909720722782367e+03
block|,
comment|/* 0x40B5ABBA, 0xA61D54A6 */
literal|1.90311919338810798763e+03
block|,
comment|/* 0x409DBC7A, 0x0DD4DF4B */
operator|-
literal|1.35201191444307340817e+02
block|,
comment|/* 0xC060E670, 0x290A311F */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|qr2
index|[
literal|6
index|]
init|=
block|{
comment|/* for x in [2.8570,2]=1/[0.3499,0.5] */
operator|-
literal|1.78381727510958865572e-07
block|,
comment|/* 0xBE87F126, 0x44C626D2 */
operator|-
literal|1.02517042607985553460e-01
block|,
comment|/* 0xBFBA3E8E, 0x9148B010 */
operator|-
literal|2.75220568278187460720e+00
block|,
comment|/* 0xC0060484, 0x69BB4EDA */
operator|-
literal|1.96636162643703720221e+01
block|,
comment|/* 0xC033A9E2, 0xC168907F */
operator|-
literal|4.23253133372830490089e+01
block|,
comment|/* 0xC04529A3, 0xDE104AAA */
operator|-
literal|2.13719211703704061733e+01
block|,
comment|/* 0xC0355F36, 0x39CF6E52 */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|qs2
index|[
literal|6
index|]
init|=
block|{
literal|2.95333629060523854548e+01
block|,
comment|/* 0x403D888A, 0x78AE64FF */
literal|2.52981549982190529136e+02
block|,
comment|/* 0x406F9F68, 0xDB821CBA */
literal|7.57502834868645436472e+02
block|,
comment|/* 0x4087AC05, 0xCE49A0F7 */
literal|7.39393205320467245656e+02
block|,
comment|/* 0x40871B25, 0x48D4C029 */
literal|1.55949003336666123687e+02
block|,
comment|/* 0x40637E5E, 0x3C3ED8D4 */
operator|-
literal|4.95949898822628210127e+00
block|,
comment|/* 0xC013D686, 0xE71BE86B */
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|double
name|qone
parameter_list|(
name|double
name|x
parameter_list|)
block|{
specifier|const
name|double
modifier|*
name|p
decl_stmt|,
modifier|*
name|q
decl_stmt|;
name|double
name|s
decl_stmt|,
name|r
decl_stmt|,
name|z
decl_stmt|;
name|int32_t
name|ix
decl_stmt|;
name|GET_HIGH_WORD
argument_list|(
name|ix
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|ix
operator|&=
literal|0x7fffffff
expr_stmt|;
if|if
condition|(
name|ix
operator|>=
literal|0x40200000
condition|)
block|{
name|p
operator|=
name|qr8
expr_stmt|;
name|q
operator|=
name|qs8
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|ix
operator|>=
literal|0x40122E8B
condition|)
block|{
name|p
operator|=
name|qr5
expr_stmt|;
name|q
operator|=
name|qs5
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|ix
operator|>=
literal|0x4006DB6D
condition|)
block|{
name|p
operator|=
name|qr3
expr_stmt|;
name|q
operator|=
name|qs3
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|ix
operator|>=
literal|0x40000000
condition|)
block|{
name|p
operator|=
name|qr2
expr_stmt|;
name|q
operator|=
name|qs2
expr_stmt|;
block|}
name|z
operator|=
name|one
operator|/
operator|(
name|x
operator|*
name|x
operator|)
expr_stmt|;
name|r
operator|=
name|p
index|[
literal|0
index|]
operator|+
name|z
operator|*
operator|(
name|p
index|[
literal|1
index|]
operator|+
name|z
operator|*
operator|(
name|p
index|[
literal|2
index|]
operator|+
name|z
operator|*
operator|(
name|p
index|[
literal|3
index|]
operator|+
name|z
operator|*
operator|(
name|p
index|[
literal|4
index|]
operator|+
name|z
operator|*
name|p
index|[
literal|5
index|]
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|s
operator|=
name|one
operator|+
name|z
operator|*
operator|(
name|q
index|[
literal|0
index|]
operator|+
name|z
operator|*
operator|(
name|q
index|[
literal|1
index|]
operator|+
name|z
operator|*
operator|(
name|q
index|[
literal|2
index|]
operator|+
name|z
operator|*
operator|(
name|q
index|[
literal|3
index|]
operator|+
name|z
operator|*
operator|(
name|q
index|[
literal|4
index|]
operator|+
name|z
operator|*
name|q
index|[
literal|5
index|]
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
return|return
operator|(
literal|.375
operator|+
name|r
operator|/
name|s
operator|)
operator|/
name|x
return|;
block|}
end_function

end_unit

