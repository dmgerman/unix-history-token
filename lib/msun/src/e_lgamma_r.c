begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* @(#)e_lgamma_r.c 1.3 95/01/18 */
end_comment

begin_comment
comment|/*  * ====================================================  * Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  *  * Developed at SunSoft, a Sun Microsystems, Inc. business.  * Permission to use, copy, modify, and distribute this  * software is freely granted, provided that this notice   * is preserved.  * ====================================================  *  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
name|rcsid
index|[]
init|=
literal|"$FreeBSD$"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* __ieee754_lgamma_r(x, signgamp)  * Reentrant version of the logarithm of the Gamma function   * with user provide pointer for the sign of Gamma(x).   *  * Method:  *   1. Argument Reduction for 0< x<= 8  * 	Since gamma(1+s)=s*gamma(s), for x in [0,8], we may   * 	reduce x to a number in [1.5,2.5] by  * 		lgamma(1+s) = log(s) + lgamma(s)  *	for example,  *		lgamma(7.3) = log(6.3) + lgamma(6.3)  *			    = log(6.3*5.3) + lgamma(5.3)  *			    = log(6.3*5.3*4.3*3.3*2.3) + lgamma(2.3)  *   2. Polynomial approximation of lgamma around its  *	minimun ymin=1.461632144968362245 to maintain monotonicity.  *	On [ymin-0.23, ymin+0.27] (i.e., [1.23164,1.73163]), use  *		Let z = x-ymin;  *		lgamma(x) = -1.214862905358496078218 + z^2*poly(z)  *	where  *		poly(z) is a 14 degree polynomial.  *   2. Rational approximation in the primary interval [2,3]  *	We use the following approximation:  *		s = x-2.0;  *		lgamma(x) = 0.5*s + s*P(s)/Q(s)  *	with accuracy  *		|P/Q - (lgamma(x)-0.5s)|< 2**-61.71  *	Our algorithms are based on the following observation  *  *                             zeta(2)-1    2    zeta(3)-1    3  * lgamma(2+s) = s*(1-Euler) + --------- * s  -  --------- * s  + ...  *                                 2                 3  *  *	where Euler = 0.5771... is the Euler constant, which is very  *	close to 0.5.  *  *   3. For x>=8, we have  *	lgamma(x)~(x-0.5)log(x)-x+0.5*log(2pi)+1/(12x)-1/(360x**3)+....  *	(better formula:  *	   lgamma(x)~(x-0.5)*(log(x)-1)-.5*(log(2pi)-1) + ...)  *	Let z = 1/x, then we approximation  *		f(z) = lgamma(x) - (x-0.5)(log(x)-1)  *	by  *	  			    3       5             11  *		w = w0 + w1*z + w2*z  + w3*z  + ... + w6*z  *	where   *		|w - f(z)|< 2**-58.74  *		  *   4. For negative x, since (G is gamma function)  *		-x*G(-x)*G(x) = pi/sin(pi*x),  * 	we have  * 		G(x) = pi/(sin(pi*x)*(-x)*G(-x))  *	since G(-x) is positive, sign(G(x)) = sign(sin(pi*x)) for x<0  *	Hence, for x<0, signgam = sign(sin(pi*x)) and   *		lgamma(x) = log(|Gamma(x)|)  *			  = log(pi/(|x*sin(pi*x)|)) - lgamma(-x);  *	Note: one should avoid compute pi*(-x) directly in the   *	      computation of sin(pi*(-x)).  *		  *   5. Special Cases  *		lgamma(2+s) ~ s*(1-Euler) for tiny s  *		lgamma(1) = lgamma(2) = 0  *		lgamma(x) ~ -log(|x|) for tiny x  *		lgamma(0) = lgamma(neg.integer) = inf and raise divide-by-zero  *		lgamma(inf) = inf  *		lgamma(-inf) = inf (bug for bug compatible with C99!?)  *	  */
end_comment

begin_include
include|#
directive|include
file|"math.h"
end_include

begin_include
include|#
directive|include
file|"math_private.h"
end_include

begin_decl_stmt
specifier|static
specifier|const
name|double
name|two52
init|=
literal|4.50359962737049600000e+15
decl_stmt|,
comment|/* 0x43300000, 0x00000000 */
name|half
init|=
literal|5.00000000000000000000e-01
decl_stmt|,
comment|/* 0x3FE00000, 0x00000000 */
name|one
init|=
literal|1.00000000000000000000e+00
decl_stmt|,
comment|/* 0x3FF00000, 0x00000000 */
name|pi
init|=
literal|3.14159265358979311600e+00
decl_stmt|,
comment|/* 0x400921FB, 0x54442D18 */
name|a0
init|=
literal|7.72156649015328655494e-02
decl_stmt|,
comment|/* 0x3FB3C467, 0xE37DB0C8 */
name|a1
init|=
literal|3.22467033424113591611e-01
decl_stmt|,
comment|/* 0x3FD4A34C, 0xC4A60FAD */
name|a2
init|=
literal|6.73523010531292681824e-02
decl_stmt|,
comment|/* 0x3FB13E00, 0x1A5562A7 */
name|a3
init|=
literal|2.05808084325167332806e-02
decl_stmt|,
comment|/* 0x3F951322, 0xAC92547B */
name|a4
init|=
literal|7.38555086081402883957e-03
decl_stmt|,
comment|/* 0x3F7E404F, 0xB68FEFE8 */
name|a5
init|=
literal|2.89051383673415629091e-03
decl_stmt|,
comment|/* 0x3F67ADD8, 0xCCB7926B */
name|a6
init|=
literal|1.19270763183362067845e-03
decl_stmt|,
comment|/* 0x3F538A94, 0x116F3F5D */
name|a7
init|=
literal|5.10069792153511336608e-04
decl_stmt|,
comment|/* 0x3F40B6C6, 0x89B99C00 */
name|a8
init|=
literal|2.20862790713908385557e-04
decl_stmt|,
comment|/* 0x3F2CF2EC, 0xED10E54D */
name|a9
init|=
literal|1.08011567247583939954e-04
decl_stmt|,
comment|/* 0x3F1C5088, 0x987DFB07 */
name|a10
init|=
literal|2.52144565451257326939e-05
decl_stmt|,
comment|/* 0x3EFA7074, 0x428CFA52 */
name|a11
init|=
literal|4.48640949618915160150e-05
decl_stmt|,
comment|/* 0x3F07858E, 0x90A45837 */
name|tc
init|=
literal|1.46163214496836224576e+00
decl_stmt|,
comment|/* 0x3FF762D8, 0x6356BE3F */
name|tf
init|=
operator|-
literal|1.21486290535849611461e-01
decl_stmt|,
comment|/* 0xBFBF19B9, 0xBCC38A42 */
comment|/* tt = -(tail of tf) */
name|tt
init|=
operator|-
literal|3.63867699703950536541e-18
decl_stmt|,
comment|/* 0xBC50C7CA, 0xA48A971F */
name|t0
init|=
literal|4.83836122723810047042e-01
decl_stmt|,
comment|/* 0x3FDEF72B, 0xC8EE38A2 */
name|t1
init|=
operator|-
literal|1.47587722994593911752e-01
decl_stmt|,
comment|/* 0xBFC2E427, 0x8DC6C509 */
name|t2
init|=
literal|6.46249402391333854778e-02
decl_stmt|,
comment|/* 0x3FB08B42, 0x94D5419B */
name|t3
init|=
operator|-
literal|3.27885410759859649565e-02
decl_stmt|,
comment|/* 0xBFA0C9A8, 0xDF35B713 */
name|t4
init|=
literal|1.79706750811820387126e-02
decl_stmt|,
comment|/* 0x3F9266E7, 0x970AF9EC */
name|t5
init|=
operator|-
literal|1.03142241298341437450e-02
decl_stmt|,
comment|/* 0xBF851F9F, 0xBA91EC6A */
name|t6
init|=
literal|6.10053870246291332635e-03
decl_stmt|,
comment|/* 0x3F78FCE0, 0xE370E344 */
name|t7
init|=
operator|-
literal|3.68452016781138256760e-03
decl_stmt|,
comment|/* 0xBF6E2EFF, 0xB3E914D7 */
name|t8
init|=
literal|2.25964780900612472250e-03
decl_stmt|,
comment|/* 0x3F6282D3, 0x2E15C915 */
name|t9
init|=
operator|-
literal|1.40346469989232843813e-03
decl_stmt|,
comment|/* 0xBF56FE8E, 0xBF2D1AF1 */
name|t10
init|=
literal|8.81081882437654011382e-04
decl_stmt|,
comment|/* 0x3F4CDF0C, 0xEF61A8E9 */
name|t11
init|=
operator|-
literal|5.38595305356740546715e-04
decl_stmt|,
comment|/* 0xBF41A610, 0x9C73E0EC */
name|t12
init|=
literal|3.15632070903625950361e-04
decl_stmt|,
comment|/* 0x3F34AF6D, 0x6C0EBBF7 */
name|t13
init|=
operator|-
literal|3.12754168375120860518e-04
decl_stmt|,
comment|/* 0xBF347F24, 0xECC38C38 */
name|t14
init|=
literal|3.35529192635519073543e-04
decl_stmt|,
comment|/* 0x3F35FD3E, 0xE8C2D3F4 */
name|u0
init|=
operator|-
literal|7.72156649015328655494e-02
decl_stmt|,
comment|/* 0xBFB3C467, 0xE37DB0C8 */
name|u1
init|=
literal|6.32827064025093366517e-01
decl_stmt|,
comment|/* 0x3FE4401E, 0x8B005DFF */
name|u2
init|=
literal|1.45492250137234768737e+00
decl_stmt|,
comment|/* 0x3FF7475C, 0xD119BD6F */
name|u3
init|=
literal|9.77717527963372745603e-01
decl_stmt|,
comment|/* 0x3FEF4976, 0x44EA8450 */
name|u4
init|=
literal|2.28963728064692451092e-01
decl_stmt|,
comment|/* 0x3FCD4EAE, 0xF6010924 */
name|u5
init|=
literal|1.33810918536787660377e-02
decl_stmt|,
comment|/* 0x3F8B678B, 0xBF2BAB09 */
name|v1
init|=
literal|2.45597793713041134822e+00
decl_stmt|,
comment|/* 0x4003A5D7, 0xC2BD619C */
name|v2
init|=
literal|2.12848976379893395361e+00
decl_stmt|,
comment|/* 0x40010725, 0xA42B18F5 */
name|v3
init|=
literal|7.69285150456672783825e-01
decl_stmt|,
comment|/* 0x3FE89DFB, 0xE45050AF */
name|v4
init|=
literal|1.04222645593369134254e-01
decl_stmt|,
comment|/* 0x3FBAAE55, 0xD6537C88 */
name|v5
init|=
literal|3.21709242282423911810e-03
decl_stmt|,
comment|/* 0x3F6A5ABB, 0x57D0CF61 */
name|s0
init|=
operator|-
literal|7.72156649015328655494e-02
decl_stmt|,
comment|/* 0xBFB3C467, 0xE37DB0C8 */
name|s1
init|=
literal|2.14982415960608852501e-01
decl_stmt|,
comment|/* 0x3FCB848B, 0x36E20878 */
name|s2
init|=
literal|3.25778796408930981787e-01
decl_stmt|,
comment|/* 0x3FD4D98F, 0x4F139F59 */
name|s3
init|=
literal|1.46350472652464452805e-01
decl_stmt|,
comment|/* 0x3FC2BB9C, 0xBEE5F2F7 */
name|s4
init|=
literal|2.66422703033638609560e-02
decl_stmt|,
comment|/* 0x3F9B481C, 0x7E939961 */
name|s5
init|=
literal|1.84028451407337715652e-03
decl_stmt|,
comment|/* 0x3F5E26B6, 0x7368F239 */
name|s6
init|=
literal|3.19475326584100867617e-05
decl_stmt|,
comment|/* 0x3F00BFEC, 0xDD17E945 */
name|r1
init|=
literal|1.39200533467621045958e+00
decl_stmt|,
comment|/* 0x3FF645A7, 0x62C4AB74 */
name|r2
init|=
literal|7.21935547567138069525e-01
decl_stmt|,
comment|/* 0x3FE71A18, 0x93D3DCDC */
name|r3
init|=
literal|1.71933865632803078993e-01
decl_stmt|,
comment|/* 0x3FC601ED, 0xCCFBDF27 */
name|r4
init|=
literal|1.86459191715652901344e-02
decl_stmt|,
comment|/* 0x3F9317EA, 0x742ED475 */
name|r5
init|=
literal|7.77942496381893596434e-04
decl_stmt|,
comment|/* 0x3F497DDA, 0xCA41A95B */
name|r6
init|=
literal|7.32668430744625636189e-06
decl_stmt|,
comment|/* 0x3EDEBAF7, 0xA5B38140 */
name|w0
init|=
literal|4.18938533204672725052e-01
decl_stmt|,
comment|/* 0x3FDACFE3, 0x90C97D69 */
name|w1
init|=
literal|8.33333333333329678849e-02
decl_stmt|,
comment|/* 0x3FB55555, 0x5555553B */
name|w2
init|=
operator|-
literal|2.77777777728775536470e-03
decl_stmt|,
comment|/* 0xBF66C16C, 0x16B02E5C */
name|w3
init|=
literal|7.93650558643019558500e-04
decl_stmt|,
comment|/* 0x3F4A019F, 0x98CF38B6 */
name|w4
init|=
operator|-
literal|5.95187557450339963135e-04
decl_stmt|,
comment|/* 0xBF4380CB, 0x8C0FE741 */
name|w5
init|=
literal|8.36339918996282139126e-04
decl_stmt|,
comment|/* 0x3F4B67BA, 0x4CDAD5D1 */
name|w6
init|=
operator|-
literal|1.63092934096575273989e-03
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* 0xBF5AB89D, 0x0B9E43E4 */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|double
name|zero
init|=
literal|0.00000000000000000000e+00
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|double
name|sin_pi
parameter_list|(
name|double
name|x
parameter_list|)
block|{
name|double
name|y
decl_stmt|,
name|z
decl_stmt|;
name|int
name|n
decl_stmt|,
name|ix
decl_stmt|;
name|GET_HIGH_WORD
argument_list|(
name|ix
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|ix
operator|&=
literal|0x7fffffff
expr_stmt|;
if|if
condition|(
name|ix
operator|<
literal|0x3fd00000
condition|)
return|return
name|__kernel_sin
argument_list|(
name|pi
operator|*
name|x
argument_list|,
name|zero
argument_list|,
literal|0
argument_list|)
return|;
name|y
operator|=
operator|-
name|x
expr_stmt|;
comment|/* x is assume negative */
comment|/*      * argument reduction, make sure inexact flag not raised if input      * is an integer      */
name|z
operator|=
name|floor
argument_list|(
name|y
argument_list|)
expr_stmt|;
if|if
condition|(
name|z
operator|!=
name|y
condition|)
block|{
comment|/* inexact anyway */
name|y
operator|*=
literal|0.5
expr_stmt|;
name|y
operator|=
literal|2.0
operator|*
operator|(
name|y
operator|-
name|floor
argument_list|(
name|y
argument_list|)
operator|)
expr_stmt|;
comment|/* y = |x| mod 2.0 */
name|n
operator|=
call|(
name|int
call|)
argument_list|(
name|y
operator|*
literal|4.0
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|ix
operator|>=
literal|0x43400000
condition|)
block|{
name|y
operator|=
name|zero
expr_stmt|;
name|n
operator|=
literal|0
expr_stmt|;
comment|/* y must be even */
block|}
else|else
block|{
if|if
condition|(
name|ix
operator|<
literal|0x43300000
condition|)
name|z
operator|=
name|y
operator|+
name|two52
expr_stmt|;
comment|/* exact */
name|GET_LOW_WORD
argument_list|(
name|n
argument_list|,
name|z
argument_list|)
expr_stmt|;
name|n
operator|&=
literal|1
expr_stmt|;
name|y
operator|=
name|n
expr_stmt|;
name|n
operator|<<=
literal|2
expr_stmt|;
block|}
block|}
switch|switch
condition|(
name|n
condition|)
block|{
case|case
literal|0
case|:
name|y
operator|=
name|__kernel_sin
argument_list|(
name|pi
operator|*
name|y
argument_list|,
name|zero
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
literal|1
case|:
case|case
literal|2
case|:
name|y
operator|=
name|__kernel_cos
argument_list|(
name|pi
operator|*
operator|(
literal|0.5
operator|-
name|y
operator|)
argument_list|,
name|zero
argument_list|)
expr_stmt|;
break|break;
case|case
literal|3
case|:
case|case
literal|4
case|:
name|y
operator|=
name|__kernel_sin
argument_list|(
name|pi
operator|*
operator|(
name|one
operator|-
name|y
operator|)
argument_list|,
name|zero
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
literal|5
case|:
case|case
literal|6
case|:
name|y
operator|=
operator|-
name|__kernel_cos
argument_list|(
name|pi
operator|*
operator|(
name|y
operator|-
literal|1.5
operator|)
argument_list|,
name|zero
argument_list|)
expr_stmt|;
break|break;
default|default:
name|y
operator|=
name|__kernel_sin
argument_list|(
name|pi
operator|*
operator|(
name|y
operator|-
literal|2.0
operator|)
argument_list|,
name|zero
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
block|}
return|return
operator|-
name|y
return|;
block|}
end_function

begin_function
name|double
name|__ieee754_lgamma_r
parameter_list|(
name|double
name|x
parameter_list|,
name|int
modifier|*
name|signgamp
parameter_list|)
block|{
name|double
name|t
decl_stmt|,
name|y
decl_stmt|,
name|z
decl_stmt|,
name|nadj
decl_stmt|,
name|p
decl_stmt|,
name|p1
decl_stmt|,
name|p2
decl_stmt|,
name|p3
decl_stmt|,
name|q
decl_stmt|,
name|r
decl_stmt|,
name|w
decl_stmt|;
name|int32_t
name|hx
decl_stmt|;
name|int
name|i
decl_stmt|,
name|lx
decl_stmt|,
name|ix
decl_stmt|;
name|EXTRACT_WORDS
argument_list|(
name|hx
argument_list|,
name|lx
argument_list|,
name|x
argument_list|)
expr_stmt|;
comment|/* purge off +-inf, NaN, +-0, tiny and negative arguments */
operator|*
name|signgamp
operator|=
literal|1
expr_stmt|;
name|ix
operator|=
name|hx
operator|&
literal|0x7fffffff
expr_stmt|;
if|if
condition|(
name|ix
operator|>=
literal|0x7ff00000
condition|)
return|return
name|x
operator|*
name|x
return|;
if|if
condition|(
operator|(
name|ix
operator||
name|lx
operator|)
operator|==
literal|0
condition|)
return|return
name|one
operator|/
name|zero
return|;
if|if
condition|(
name|ix
operator|<
literal|0x3b900000
condition|)
block|{
comment|/* |x|<2**-70, return -log(|x|) */
if|if
condition|(
name|hx
operator|<
literal|0
condition|)
block|{
operator|*
name|signgamp
operator|=
operator|-
literal|1
expr_stmt|;
return|return
operator|-
name|__ieee754_log
argument_list|(
operator|-
name|x
argument_list|)
return|;
block|}
else|else
return|return
operator|-
name|__ieee754_log
argument_list|(
name|x
argument_list|)
return|;
block|}
if|if
condition|(
name|hx
operator|<
literal|0
condition|)
block|{
if|if
condition|(
name|ix
operator|>=
literal|0x43300000
condition|)
comment|/* |x|>=2**52, must be -integer */
return|return
name|one
operator|/
name|zero
return|;
name|t
operator|=
name|sin_pi
argument_list|(
name|x
argument_list|)
expr_stmt|;
if|if
condition|(
name|t
operator|==
name|zero
condition|)
return|return
name|one
operator|/
name|zero
return|;
comment|/* -integer */
name|nadj
operator|=
name|__ieee754_log
argument_list|(
name|pi
operator|/
name|fabs
argument_list|(
name|t
operator|*
name|x
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|t
operator|<
name|zero
condition|)
operator|*
name|signgamp
operator|=
operator|-
literal|1
expr_stmt|;
name|x
operator|=
operator|-
name|x
expr_stmt|;
block|}
comment|/* purge off 1 and 2 */
if|if
condition|(
operator|(
operator|(
operator|(
name|ix
operator|-
literal|0x3ff00000
operator|)
operator||
name|lx
operator|)
operator|==
literal|0
operator|)
operator|||
operator|(
operator|(
operator|(
name|ix
operator|-
literal|0x40000000
operator|)
operator||
name|lx
operator|)
operator|==
literal|0
operator|)
condition|)
name|r
operator|=
literal|0
expr_stmt|;
comment|/* for x< 2.0 */
elseif|else
if|if
condition|(
name|ix
operator|<
literal|0x40000000
condition|)
block|{
if|if
condition|(
name|ix
operator|<=
literal|0x3feccccc
condition|)
block|{
comment|/* lgamma(x) = lgamma(x+1)-log(x) */
name|r
operator|=
operator|-
name|__ieee754_log
argument_list|(
name|x
argument_list|)
expr_stmt|;
if|if
condition|(
name|ix
operator|>=
literal|0x3FE76944
condition|)
block|{
name|y
operator|=
name|one
operator|-
name|x
expr_stmt|;
name|i
operator|=
literal|0
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|ix
operator|>=
literal|0x3FCDA661
condition|)
block|{
name|y
operator|=
name|x
operator|-
operator|(
name|tc
operator|-
name|one
operator|)
expr_stmt|;
name|i
operator|=
literal|1
expr_stmt|;
block|}
else|else
block|{
name|y
operator|=
name|x
expr_stmt|;
name|i
operator|=
literal|2
expr_stmt|;
block|}
block|}
else|else
block|{
name|r
operator|=
name|zero
expr_stmt|;
if|if
condition|(
name|ix
operator|>=
literal|0x3FFBB4C3
condition|)
block|{
name|y
operator|=
literal|2.0
operator|-
name|x
expr_stmt|;
name|i
operator|=
literal|0
expr_stmt|;
block|}
comment|/* [1.7316,2] */
elseif|else
if|if
condition|(
name|ix
operator|>=
literal|0x3FF3B4C4
condition|)
block|{
name|y
operator|=
name|x
operator|-
name|tc
expr_stmt|;
name|i
operator|=
literal|1
expr_stmt|;
block|}
comment|/* [1.23,1.73] */
else|else
block|{
name|y
operator|=
name|x
operator|-
name|one
expr_stmt|;
name|i
operator|=
literal|2
expr_stmt|;
block|}
block|}
switch|switch
condition|(
name|i
condition|)
block|{
case|case
literal|0
case|:
name|z
operator|=
name|y
operator|*
name|y
expr_stmt|;
name|p1
operator|=
name|a0
operator|+
name|z
operator|*
operator|(
name|a2
operator|+
name|z
operator|*
operator|(
name|a4
operator|+
name|z
operator|*
operator|(
name|a6
operator|+
name|z
operator|*
operator|(
name|a8
operator|+
name|z
operator|*
name|a10
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|p2
operator|=
name|z
operator|*
operator|(
name|a1
operator|+
name|z
operator|*
operator|(
name|a3
operator|+
name|z
operator|*
operator|(
name|a5
operator|+
name|z
operator|*
operator|(
name|a7
operator|+
name|z
operator|*
operator|(
name|a9
operator|+
name|z
operator|*
name|a11
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|p
operator|=
name|y
operator|*
name|p1
operator|+
name|p2
expr_stmt|;
name|r
operator|+=
operator|(
name|p
operator|-
literal|0.5
operator|*
name|y
operator|)
expr_stmt|;
break|break;
case|case
literal|1
case|:
name|z
operator|=
name|y
operator|*
name|y
expr_stmt|;
name|w
operator|=
name|z
operator|*
name|y
expr_stmt|;
name|p1
operator|=
name|t0
operator|+
name|w
operator|*
operator|(
name|t3
operator|+
name|w
operator|*
operator|(
name|t6
operator|+
name|w
operator|*
operator|(
name|t9
operator|+
name|w
operator|*
name|t12
operator|)
operator|)
operator|)
expr_stmt|;
comment|/* parallel comp */
name|p2
operator|=
name|t1
operator|+
name|w
operator|*
operator|(
name|t4
operator|+
name|w
operator|*
operator|(
name|t7
operator|+
name|w
operator|*
operator|(
name|t10
operator|+
name|w
operator|*
name|t13
operator|)
operator|)
operator|)
expr_stmt|;
name|p3
operator|=
name|t2
operator|+
name|w
operator|*
operator|(
name|t5
operator|+
name|w
operator|*
operator|(
name|t8
operator|+
name|w
operator|*
operator|(
name|t11
operator|+
name|w
operator|*
name|t14
operator|)
operator|)
operator|)
expr_stmt|;
name|p
operator|=
name|z
operator|*
name|p1
operator|-
operator|(
name|tt
operator|-
name|w
operator|*
operator|(
name|p2
operator|+
name|y
operator|*
name|p3
operator|)
operator|)
expr_stmt|;
name|r
operator|+=
operator|(
name|tf
operator|+
name|p
operator|)
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|p1
operator|=
name|y
operator|*
operator|(
name|u0
operator|+
name|y
operator|*
operator|(
name|u1
operator|+
name|y
operator|*
operator|(
name|u2
operator|+
name|y
operator|*
operator|(
name|u3
operator|+
name|y
operator|*
operator|(
name|u4
operator|+
name|y
operator|*
name|u5
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|p2
operator|=
name|one
operator|+
name|y
operator|*
operator|(
name|v1
operator|+
name|y
operator|*
operator|(
name|v2
operator|+
name|y
operator|*
operator|(
name|v3
operator|+
name|y
operator|*
operator|(
name|v4
operator|+
name|y
operator|*
name|v5
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|r
operator|+=
operator|(
operator|-
literal|0.5
operator|*
name|y
operator|+
name|p1
operator|/
name|p2
operator|)
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|ix
operator|<
literal|0x40200000
condition|)
block|{
comment|/* x< 8.0 */
name|i
operator|=
operator|(
name|int
operator|)
name|x
expr_stmt|;
name|t
operator|=
name|zero
expr_stmt|;
name|y
operator|=
name|x
operator|-
operator|(
name|double
operator|)
name|i
expr_stmt|;
name|p
operator|=
name|y
operator|*
operator|(
name|s0
operator|+
name|y
operator|*
operator|(
name|s1
operator|+
name|y
operator|*
operator|(
name|s2
operator|+
name|y
operator|*
operator|(
name|s3
operator|+
name|y
operator|*
operator|(
name|s4
operator|+
name|y
operator|*
operator|(
name|s5
operator|+
name|y
operator|*
name|s6
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|q
operator|=
name|one
operator|+
name|y
operator|*
operator|(
name|r1
operator|+
name|y
operator|*
operator|(
name|r2
operator|+
name|y
operator|*
operator|(
name|r3
operator|+
name|y
operator|*
operator|(
name|r4
operator|+
name|y
operator|*
operator|(
name|r5
operator|+
name|y
operator|*
name|r6
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|r
operator|=
name|half
operator|*
name|y
operator|+
name|p
operator|/
name|q
expr_stmt|;
name|z
operator|=
name|one
expr_stmt|;
comment|/* lgamma(1+s) = log(s) + lgamma(s) */
switch|switch
condition|(
name|i
condition|)
block|{
case|case
literal|7
case|:
name|z
operator|*=
operator|(
name|y
operator|+
literal|6.0
operator|)
expr_stmt|;
comment|/* FALLTHRU */
case|case
literal|6
case|:
name|z
operator|*=
operator|(
name|y
operator|+
literal|5.0
operator|)
expr_stmt|;
comment|/* FALLTHRU */
case|case
literal|5
case|:
name|z
operator|*=
operator|(
name|y
operator|+
literal|4.0
operator|)
expr_stmt|;
comment|/* FALLTHRU */
case|case
literal|4
case|:
name|z
operator|*=
operator|(
name|y
operator|+
literal|3.0
operator|)
expr_stmt|;
comment|/* FALLTHRU */
case|case
literal|3
case|:
name|z
operator|*=
operator|(
name|y
operator|+
literal|2.0
operator|)
expr_stmt|;
comment|/* FALLTHRU */
name|r
operator|+=
name|__ieee754_log
argument_list|(
name|z
argument_list|)
expr_stmt|;
break|break;
block|}
comment|/* 8.0<= x< 2**58 */
block|}
elseif|else
if|if
condition|(
name|ix
operator|<
literal|0x43900000
condition|)
block|{
name|t
operator|=
name|__ieee754_log
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|z
operator|=
name|one
operator|/
name|x
expr_stmt|;
name|y
operator|=
name|z
operator|*
name|z
expr_stmt|;
name|w
operator|=
name|w0
operator|+
name|z
operator|*
operator|(
name|w1
operator|+
name|y
operator|*
operator|(
name|w2
operator|+
name|y
operator|*
operator|(
name|w3
operator|+
name|y
operator|*
operator|(
name|w4
operator|+
name|y
operator|*
operator|(
name|w5
operator|+
name|y
operator|*
name|w6
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|r
operator|=
operator|(
name|x
operator|-
name|half
operator|)
operator|*
operator|(
name|t
operator|-
name|one
operator|)
operator|+
name|w
expr_stmt|;
block|}
else|else
comment|/* 2**58<= x<= inf */
name|r
operator|=
name|x
operator|*
operator|(
name|__ieee754_log
argument_list|(
name|x
argument_list|)
operator|-
name|one
operator|)
expr_stmt|;
if|if
condition|(
name|hx
operator|<
literal|0
condition|)
name|r
operator|=
name|nadj
operator|-
name|r
expr_stmt|;
return|return
name|r
return|;
block|}
end_function

end_unit

