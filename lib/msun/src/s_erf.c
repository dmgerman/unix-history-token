begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* @(#)s_erf.c 5.1 93/09/24 */
end_comment

begin_comment
comment|/*  * ====================================================  * Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  *  * Developed at SunPro, a Sun Microsystems, Inc. business.  * Permission to use, copy, modify, and distribute this  * software is freely granted, provided that this notice  * is preserved.  * ====================================================  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
name|rcsid
index|[]
init|=
literal|"$FreeBSD$"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* double erf(double x)  * double erfc(double x)  *			     x  *		      2      |\  *     erf(x)  =  ---------  | exp(-t*t)dt  *	 	   sqrt(pi) \|  *			     0  *  *     erfc(x) =  1-erf(x)  *  Note that  *		erf(-x) = -erf(x)  *		erfc(-x) = 2 - erfc(x)  *  * Method:  *	1. For |x| in [0, 0.84375]  *	    erf(x)  = x + x*R(x^2)  *          erfc(x) = 1 - erf(x)           if x in [-.84375,0.25]  *                  = 0.5 + ((0.5-x)-x*R)  if x in [0.25,0.84375]  *	   where R = P/Q where P is an odd poly of degree 8 and  *	   Q is an odd poly of degree 10.  *						 -57.90  *			| R - (erf(x)-x)/x |<= 2  *  *  *	   Remark. The formula is derived by noting  *          erf(x) = (2/sqrt(pi))*(x - x^3/3 + x^5/10 - x^7/42 + ....)  *	   and that  *          2/sqrt(pi) = 1.128379167095512573896158903121545171688  *	   is close to one. The interval is chosen because the fix  *	   point of erf(x) is near 0.6174 (i.e., erf(x)=x when x is  *	   near 0.6174), and by some experiment, 0.84375 is chosen to  * 	   guarantee the error is less than one ulp for erf.  *  *      2. For |x| in [0.84375,1.25], let s = |x| - 1, and  *         c = 0.84506291151 rounded to single (24 bits)  *         	erf(x)  = sign(x) * (c  + P1(s)/Q1(s))  *         	erfc(x) = (1-c)  - P1(s)/Q1(s) if x> 0  *			  1+(c+P1(s)/Q1(s))    if x< 0  *         	|P1/Q1 - (erf(|x|)-c)|<= 2**-59.06  *	   Remark: here we use the taylor series expansion at x=1.  *		erf(1+s) = erf(1) + s*Poly(s)  *			 = 0.845.. + P1(s)/Q1(s)  *	   That is, we use rational approximation to approximate  *			erf(1+s) - (c = (single)0.84506291151)  *	   Note that |P1/Q1|< 0.078 for x in [0.84375,1.25]  *	   where  *		P1(s) = degree 6 poly in s  *		Q1(s) = degree 6 poly in s  *  *      3. For x in [1.25,1/0.35(~2.857143)],  *         	erfc(x) = (1/x)*exp(-x*x-0.5625+R1/S1)  *         	erf(x)  = 1 - erfc(x)  *	   where  *		R1(z) = degree 7 poly in z, (z=1/x^2)  *		S1(z) = degree 8 poly in z  *  *      4. For x in [1/0.35,28]  *         	erfc(x) = (1/x)*exp(-x*x-0.5625+R2/S2) if x> 0  *			= 2.0 - (1/x)*exp(-x*x-0.5625+R2/S2) if -6<x<0  *			= 2.0 - tiny		(if x<= -6)  *         	erf(x)  = sign(x)*(1.0 - erfc(x)) if x< 6, else  *         	erf(x)  = sign(x)*(1.0 - tiny)  *	   where  *		R2(z) = degree 6 poly in z, (z=1/x^2)  *		S2(z) = degree 7 poly in z  *  *      Note1:  *	   To compute exp(-x*x-0.5625+R/S), let s be a single  *	   precision number and s := x; then  *		-x*x = -s*s + (s-x)*(s+x)  *	        exp(-x*x-0.5626+R/S) =  *			exp(-s*s-0.5625)*exp((s-x)*(s+x)+R/S);  *      Note2:  *	   Here 4 and 5 make use of the asymptotic series  *			  exp(-x*x)  *		erfc(x) ~ ---------- * ( 1 + Poly(1/x^2) )  *			  x*sqrt(pi)  *	   We use rational approximation to approximate  *      	g(s)=f(1/x^2) = log(erfc(x)*x) - x*x + 0.5625  *	   Here is the error bound for R1/S1 and R2/S2  *      	|R1/S1 - f(x)|< 2**(-62.57)  *      	|R2/S2 - f(x)|< 2**(-61.52)  *  *      5. For inf> x>= 28  *         	erf(x)  = sign(x) *(1 - tiny)  (raise inexact)  *         	erfc(x) = tiny*tiny (raise underflow) if x> 0  *			= 2 - tiny if x<0  *  *      7. Special case:  *         	erf(0)  = 0, erf(inf)  = 1, erf(-inf) = -1,  *         	erfc(0) = 1, erfc(inf) = 0, erfc(-inf) = 2,  *	   	erfc/erf(NaN) is NaN  */
end_comment

begin_include
include|#
directive|include
file|"math.h"
end_include

begin_include
include|#
directive|include
file|"math_private.h"
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|__STDC__
end_ifdef

begin_decl_stmt
specifier|static
specifier|const
name|double
else|#
directive|else
specifier|static
name|double
endif|#
directive|endif
name|tiny
init|=
literal|1e-300
decl_stmt|,
name|half
init|=
literal|5.00000000000000000000e-01
decl_stmt|,
comment|/* 0x3FE00000, 0x00000000 */
name|one
init|=
literal|1.00000000000000000000e+00
decl_stmt|,
comment|/* 0x3FF00000, 0x00000000 */
name|two
init|=
literal|2.00000000000000000000e+00
decl_stmt|,
comment|/* 0x40000000, 0x00000000 */
comment|/* c = (float)0.84506291151 */
name|erx
init|=
literal|8.45062911510467529297e-01
decl_stmt|,
comment|/* 0x3FEB0AC1, 0x60000000 */
comment|/*  * Coefficients for approximation to  erf on [0,0.84375]  */
name|efx
init|=
literal|1.28379167095512586316e-01
decl_stmt|,
comment|/* 0x3FC06EBA, 0x8214DB69 */
name|efx8
init|=
literal|1.02703333676410069053e+00
decl_stmt|,
comment|/* 0x3FF06EBA, 0x8214DB69 */
name|pp0
init|=
literal|1.28379167095512558561e-01
decl_stmt|,
comment|/* 0x3FC06EBA, 0x8214DB68 */
name|pp1
init|=
operator|-
literal|3.25042107247001499370e-01
decl_stmt|,
comment|/* 0xBFD4CD7D, 0x691CB913 */
name|pp2
init|=
operator|-
literal|2.84817495755985104766e-02
decl_stmt|,
comment|/* 0xBF9D2A51, 0xDBD7194F */
name|pp3
init|=
operator|-
literal|5.77027029648944159157e-03
decl_stmt|,
comment|/* 0xBF77A291, 0x236668E4 */
name|pp4
init|=
operator|-
literal|2.37630166566501626084e-05
decl_stmt|,
comment|/* 0xBEF8EAD6, 0x120016AC */
name|qq1
init|=
literal|3.97917223959155352819e-01
decl_stmt|,
comment|/* 0x3FD97779, 0xCDDADC09 */
name|qq2
init|=
literal|6.50222499887672944485e-02
decl_stmt|,
comment|/* 0x3FB0A54C, 0x5536CEBA */
name|qq3
init|=
literal|5.08130628187576562776e-03
decl_stmt|,
comment|/* 0x3F74D022, 0xC4D36B0F */
name|qq4
init|=
literal|1.32494738004321644526e-04
decl_stmt|,
comment|/* 0x3F215DC9, 0x221C1A10 */
name|qq5
init|=
operator|-
literal|3.96022827877536812320e-06
decl_stmt|,
comment|/* 0xBED09C43, 0x42A26120 */
comment|/*  * Coefficients for approximation to  erf  in [0.84375,1.25]  */
name|pa0
init|=
operator|-
literal|2.36211856075265944077e-03
decl_stmt|,
comment|/* 0xBF6359B8, 0xBEF77538 */
name|pa1
init|=
literal|4.14856118683748331666e-01
decl_stmt|,
comment|/* 0x3FDA8D00, 0xAD92B34D */
name|pa2
init|=
operator|-
literal|3.72207876035701323847e-01
decl_stmt|,
comment|/* 0xBFD7D240, 0xFBB8C3F1 */
name|pa3
init|=
literal|3.18346619901161753674e-01
decl_stmt|,
comment|/* 0x3FD45FCA, 0x805120E4 */
name|pa4
init|=
operator|-
literal|1.10894694282396677476e-01
decl_stmt|,
comment|/* 0xBFBC6398, 0x3D3E28EC */
name|pa5
init|=
literal|3.54783043256182359371e-02
decl_stmt|,
comment|/* 0x3FA22A36, 0x599795EB */
name|pa6
init|=
operator|-
literal|2.16637559486879084300e-03
decl_stmt|,
comment|/* 0xBF61BF38, 0x0A96073F */
name|qa1
init|=
literal|1.06420880400844228286e-01
decl_stmt|,
comment|/* 0x3FBB3E66, 0x18EEE323 */
name|qa2
init|=
literal|5.40397917702171048937e-01
decl_stmt|,
comment|/* 0x3FE14AF0, 0x92EB6F33 */
name|qa3
init|=
literal|7.18286544141962662868e-02
decl_stmt|,
comment|/* 0x3FB2635C, 0xD99FE9A7 */
name|qa4
init|=
literal|1.26171219808761642112e-01
decl_stmt|,
comment|/* 0x3FC02660, 0xE763351F */
name|qa5
init|=
literal|1.36370839120290507362e-02
decl_stmt|,
comment|/* 0x3F8BEDC2, 0x6B51DD1C */
name|qa6
init|=
literal|1.19844998467991074170e-02
decl_stmt|,
comment|/* 0x3F888B54, 0x5735151D */
comment|/*  * Coefficients for approximation to  erfc in [1.25,1/0.35]  */
name|ra0
init|=
operator|-
literal|9.86494403484714822705e-03
decl_stmt|,
comment|/* 0xBF843412, 0x600D6435 */
name|ra1
init|=
operator|-
literal|6.93858572707181764372e-01
decl_stmt|,
comment|/* 0xBFE63416, 0xE4BA7360 */
name|ra2
init|=
operator|-
literal|1.05586262253232909814e+01
decl_stmt|,
comment|/* 0xC0251E04, 0x41B0E726 */
name|ra3
init|=
operator|-
literal|6.23753324503260060396e+01
decl_stmt|,
comment|/* 0xC04F300A, 0xE4CBA38D */
name|ra4
init|=
operator|-
literal|1.62396669462573470355e+02
decl_stmt|,
comment|/* 0xC0644CB1, 0x84282266 */
name|ra5
init|=
operator|-
literal|1.84605092906711035994e+02
decl_stmt|,
comment|/* 0xC067135C, 0xEBCCABB2 */
name|ra6
init|=
operator|-
literal|8.12874355063065934246e+01
decl_stmt|,
comment|/* 0xC0545265, 0x57E4D2F2 */
name|ra7
init|=
operator|-
literal|9.81432934416914548592e+00
decl_stmt|,
comment|/* 0xC023A0EF, 0xC69AC25C */
name|sa1
init|=
literal|1.96512716674392571292e+01
decl_stmt|,
comment|/* 0x4033A6B9, 0xBD707687 */
name|sa2
init|=
literal|1.37657754143519042600e+02
decl_stmt|,
comment|/* 0x4061350C, 0x526AE721 */
name|sa3
init|=
literal|4.34565877475229228821e+02
decl_stmt|,
comment|/* 0x407B290D, 0xD58A1A71 */
name|sa4
init|=
literal|6.45387271733267880336e+02
decl_stmt|,
comment|/* 0x40842B19, 0x21EC2868 */
name|sa5
init|=
literal|4.29008140027567833386e+02
decl_stmt|,
comment|/* 0x407AD021, 0x57700314 */
name|sa6
init|=
literal|1.08635005541779435134e+02
decl_stmt|,
comment|/* 0x405B28A3, 0xEE48AE2C */
name|sa7
init|=
literal|6.57024977031928170135e+00
decl_stmt|,
comment|/* 0x401A47EF, 0x8E484A93 */
name|sa8
init|=
operator|-
literal|6.04244152148580987438e-02
decl_stmt|,
comment|/* 0xBFAEEFF2, 0xEE749A62 */
comment|/*  * Coefficients for approximation to  erfc in [1/.35,28]  */
name|rb0
init|=
operator|-
literal|9.86494292470009928597e-03
decl_stmt|,
comment|/* 0xBF843412, 0x39E86F4A */
name|rb1
init|=
operator|-
literal|7.99283237680523006574e-01
decl_stmt|,
comment|/* 0xBFE993BA, 0x70C285DE */
name|rb2
init|=
operator|-
literal|1.77579549177547519889e+01
decl_stmt|,
comment|/* 0xC031C209, 0x555F995A */
name|rb3
init|=
operator|-
literal|1.60636384855821916062e+02
decl_stmt|,
comment|/* 0xC064145D, 0x43C5ED98 */
name|rb4
init|=
operator|-
literal|6.37566443368389627722e+02
decl_stmt|,
comment|/* 0xC083EC88, 0x1375F228 */
name|rb5
init|=
operator|-
literal|1.02509513161107724954e+03
decl_stmt|,
comment|/* 0xC0900461, 0x6A2E5992 */
name|rb6
init|=
operator|-
literal|4.83519191608651397019e+02
decl_stmt|,
comment|/* 0xC07E384E, 0x9BDC383F */
name|sb1
init|=
literal|3.03380607434824582924e+01
decl_stmt|,
comment|/* 0x403E568B, 0x261D5190 */
name|sb2
init|=
literal|3.25792512996573918826e+02
decl_stmt|,
comment|/* 0x40745CAE, 0x221B9F0A */
name|sb3
init|=
literal|1.53672958608443695994e+03
decl_stmt|,
comment|/* 0x409802EB, 0x189D5118 */
name|sb4
init|=
literal|3.19985821950859553908e+03
decl_stmt|,
comment|/* 0x40A8FFB7, 0x688C246A */
name|sb5
init|=
literal|2.55305040643316442583e+03
decl_stmt|,
comment|/* 0x40A3F219, 0xCEDF3BE6 */
name|sb6
init|=
literal|4.74528541206955367215e+02
decl_stmt|,
comment|/* 0x407DA874, 0xE79FE763 */
name|sb7
init|=
operator|-
literal|2.24409524465858183362e+01
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* 0xC03670E2, 0x42712D62 */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|__STDC__
end_ifdef

begin_function
name|double
name|erf
parameter_list|(
name|double
name|x
parameter_list|)
else|#
directive|else
function|double erf
parameter_list|(
name|x
parameter_list|)
name|double
name|x
decl_stmt|;
endif|#
directive|endif
block|{
name|int32_t
name|hx
decl_stmt|,
name|ix
decl_stmt|,
name|i
decl_stmt|;
name|double
name|R
decl_stmt|,
name|S
decl_stmt|,
name|P
decl_stmt|,
name|Q
decl_stmt|,
name|s
decl_stmt|,
name|y
decl_stmt|,
name|z
decl_stmt|,
name|r
decl_stmt|;
name|GET_HIGH_WORD
argument_list|(
name|hx
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|ix
operator|=
name|hx
operator|&
literal|0x7fffffff
expr_stmt|;
if|if
condition|(
name|ix
operator|>=
literal|0x7ff00000
condition|)
block|{
comment|/* erf(nan)=nan */
name|i
operator|=
operator|(
operator|(
name|u_int32_t
operator|)
name|hx
operator|>>
literal|31
operator|)
operator|<<
literal|1
expr_stmt|;
return|return
call|(
name|double
call|)
argument_list|(
literal|1
operator|-
name|i
argument_list|)
operator|+
name|one
operator|/
name|x
return|;
comment|/* erf(+-inf)=+-1 */
block|}
if|if
condition|(
name|ix
operator|<
literal|0x3feb0000
condition|)
block|{
comment|/* |x|<0.84375 */
if|if
condition|(
name|ix
operator|<
literal|0x3e300000
condition|)
block|{
comment|/* |x|<2**-28 */
if|if
condition|(
name|ix
operator|<
literal|0x00800000
condition|)
return|return
literal|0.125
operator|*
operator|(
literal|8.0
operator|*
name|x
operator|+
name|efx8
operator|*
name|x
operator|)
return|;
comment|/*avoid underflow */
return|return
name|x
operator|+
name|efx
operator|*
name|x
return|;
block|}
name|z
operator|=
name|x
operator|*
name|x
expr_stmt|;
name|r
operator|=
name|pp0
operator|+
name|z
operator|*
operator|(
name|pp1
operator|+
name|z
operator|*
operator|(
name|pp2
operator|+
name|z
operator|*
operator|(
name|pp3
operator|+
name|z
operator|*
name|pp4
operator|)
operator|)
operator|)
expr_stmt|;
name|s
operator|=
name|one
operator|+
name|z
operator|*
operator|(
name|qq1
operator|+
name|z
operator|*
operator|(
name|qq2
operator|+
name|z
operator|*
operator|(
name|qq3
operator|+
name|z
operator|*
operator|(
name|qq4
operator|+
name|z
operator|*
name|qq5
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|y
operator|=
name|r
operator|/
name|s
expr_stmt|;
return|return
name|x
operator|+
name|x
operator|*
name|y
return|;
block|}
if|if
condition|(
name|ix
operator|<
literal|0x3ff40000
condition|)
block|{
comment|/* 0.84375<= |x|< 1.25 */
name|s
operator|=
name|fabs
argument_list|(
name|x
argument_list|)
operator|-
name|one
expr_stmt|;
name|P
operator|=
name|pa0
operator|+
name|s
operator|*
operator|(
name|pa1
operator|+
name|s
operator|*
operator|(
name|pa2
operator|+
name|s
operator|*
operator|(
name|pa3
operator|+
name|s
operator|*
operator|(
name|pa4
operator|+
name|s
operator|*
operator|(
name|pa5
operator|+
name|s
operator|*
name|pa6
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|Q
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|qa1
operator|+
name|s
operator|*
operator|(
name|qa2
operator|+
name|s
operator|*
operator|(
name|qa3
operator|+
name|s
operator|*
operator|(
name|qa4
operator|+
name|s
operator|*
operator|(
name|qa5
operator|+
name|s
operator|*
name|qa6
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
if|if
condition|(
name|hx
operator|>=
literal|0
condition|)
return|return
name|erx
operator|+
name|P
operator|/
name|Q
return|;
else|else
return|return
operator|-
name|erx
operator|-
name|P
operator|/
name|Q
return|;
block|}
if|if
condition|(
name|ix
operator|>=
literal|0x40180000
condition|)
block|{
comment|/* inf>|x|>=6 */
if|if
condition|(
name|hx
operator|>=
literal|0
condition|)
return|return
name|one
operator|-
name|tiny
return|;
else|else
return|return
name|tiny
operator|-
name|one
return|;
block|}
name|x
operator|=
name|fabs
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|s
operator|=
name|one
operator|/
operator|(
name|x
operator|*
name|x
operator|)
expr_stmt|;
if|if
condition|(
name|ix
operator|<
literal|0x4006DB6E
condition|)
block|{
comment|/* |x|< 1/0.35 */
name|R
operator|=
name|ra0
operator|+
name|s
operator|*
operator|(
name|ra1
operator|+
name|s
operator|*
operator|(
name|ra2
operator|+
name|s
operator|*
operator|(
name|ra3
operator|+
name|s
operator|*
operator|(
name|ra4
operator|+
name|s
operator|*
operator|(
name|ra5
operator|+
name|s
operator|*
operator|(
name|ra6
operator|+
name|s
operator|*
name|ra7
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|S
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|sa1
operator|+
name|s
operator|*
operator|(
name|sa2
operator|+
name|s
operator|*
operator|(
name|sa3
operator|+
name|s
operator|*
operator|(
name|sa4
operator|+
name|s
operator|*
operator|(
name|sa5
operator|+
name|s
operator|*
operator|(
name|sa6
operator|+
name|s
operator|*
operator|(
name|sa7
operator|+
name|s
operator|*
name|sa8
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
block|}
else|else
block|{
comment|/* |x|>= 1/0.35 */
name|R
operator|=
name|rb0
operator|+
name|s
operator|*
operator|(
name|rb1
operator|+
name|s
operator|*
operator|(
name|rb2
operator|+
name|s
operator|*
operator|(
name|rb3
operator|+
name|s
operator|*
operator|(
name|rb4
operator|+
name|s
operator|*
operator|(
name|rb5
operator|+
name|s
operator|*
name|rb6
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|S
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|sb1
operator|+
name|s
operator|*
operator|(
name|sb2
operator|+
name|s
operator|*
operator|(
name|sb3
operator|+
name|s
operator|*
operator|(
name|sb4
operator|+
name|s
operator|*
operator|(
name|sb5
operator|+
name|s
operator|*
operator|(
name|sb6
operator|+
name|s
operator|*
name|sb7
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
block|}
name|z
operator|=
name|x
expr_stmt|;
name|SET_LOW_WORD
argument_list|(
name|z
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|r
operator|=
name|__ieee754_exp
argument_list|(
operator|-
name|z
operator|*
name|z
operator|-
literal|0.5625
argument_list|)
operator|*
name|__ieee754_exp
argument_list|(
operator|(
name|z
operator|-
name|x
operator|)
operator|*
operator|(
name|z
operator|+
name|x
operator|)
operator|+
name|R
operator|/
name|S
argument_list|)
expr_stmt|;
if|if
condition|(
name|hx
operator|>=
literal|0
condition|)
return|return
name|one
operator|-
name|r
operator|/
name|x
return|;
else|else
return|return
name|r
operator|/
name|x
operator|-
name|one
return|;
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|__STDC__
end_ifdef

begin_function
name|double
name|erfc
parameter_list|(
name|double
name|x
parameter_list|)
else|#
directive|else
function|double erfc
parameter_list|(
name|x
parameter_list|)
name|double
name|x
decl_stmt|;
endif|#
directive|endif
block|{
name|int32_t
name|hx
decl_stmt|,
name|ix
decl_stmt|;
name|double
name|R
decl_stmt|,
name|S
decl_stmt|,
name|P
decl_stmt|,
name|Q
decl_stmt|,
name|s
decl_stmt|,
name|y
decl_stmt|,
name|z
decl_stmt|,
name|r
decl_stmt|;
name|GET_HIGH_WORD
argument_list|(
name|hx
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|ix
operator|=
name|hx
operator|&
literal|0x7fffffff
expr_stmt|;
if|if
condition|(
name|ix
operator|>=
literal|0x7ff00000
condition|)
block|{
comment|/* erfc(nan)=nan */
comment|/* erfc(+-inf)=0,2 */
return|return
call|(
name|double
call|)
argument_list|(
operator|(
operator|(
name|u_int32_t
operator|)
name|hx
operator|>>
literal|31
operator|)
operator|<<
literal|1
argument_list|)
operator|+
name|one
operator|/
name|x
return|;
block|}
if|if
condition|(
name|ix
operator|<
literal|0x3feb0000
condition|)
block|{
comment|/* |x|<0.84375 */
if|if
condition|(
name|ix
operator|<
literal|0x3c700000
condition|)
comment|/* |x|<2**-56 */
return|return
name|one
operator|-
name|x
return|;
name|z
operator|=
name|x
operator|*
name|x
expr_stmt|;
name|r
operator|=
name|pp0
operator|+
name|z
operator|*
operator|(
name|pp1
operator|+
name|z
operator|*
operator|(
name|pp2
operator|+
name|z
operator|*
operator|(
name|pp3
operator|+
name|z
operator|*
name|pp4
operator|)
operator|)
operator|)
expr_stmt|;
name|s
operator|=
name|one
operator|+
name|z
operator|*
operator|(
name|qq1
operator|+
name|z
operator|*
operator|(
name|qq2
operator|+
name|z
operator|*
operator|(
name|qq3
operator|+
name|z
operator|*
operator|(
name|qq4
operator|+
name|z
operator|*
name|qq5
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|y
operator|=
name|r
operator|/
name|s
expr_stmt|;
if|if
condition|(
name|hx
operator|<
literal|0x3fd00000
condition|)
block|{
comment|/* x<1/4 */
return|return
name|one
operator|-
operator|(
name|x
operator|+
name|x
operator|*
name|y
operator|)
return|;
block|}
else|else
block|{
name|r
operator|=
name|x
operator|*
name|y
expr_stmt|;
name|r
operator|+=
operator|(
name|x
operator|-
name|half
operator|)
expr_stmt|;
return|return
name|half
operator|-
name|r
return|;
block|}
block|}
if|if
condition|(
name|ix
operator|<
literal|0x3ff40000
condition|)
block|{
comment|/* 0.84375<= |x|< 1.25 */
name|s
operator|=
name|fabs
argument_list|(
name|x
argument_list|)
operator|-
name|one
expr_stmt|;
name|P
operator|=
name|pa0
operator|+
name|s
operator|*
operator|(
name|pa1
operator|+
name|s
operator|*
operator|(
name|pa2
operator|+
name|s
operator|*
operator|(
name|pa3
operator|+
name|s
operator|*
operator|(
name|pa4
operator|+
name|s
operator|*
operator|(
name|pa5
operator|+
name|s
operator|*
name|pa6
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|Q
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|qa1
operator|+
name|s
operator|*
operator|(
name|qa2
operator|+
name|s
operator|*
operator|(
name|qa3
operator|+
name|s
operator|*
operator|(
name|qa4
operator|+
name|s
operator|*
operator|(
name|qa5
operator|+
name|s
operator|*
name|qa6
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
if|if
condition|(
name|hx
operator|>=
literal|0
condition|)
block|{
name|z
operator|=
name|one
operator|-
name|erx
expr_stmt|;
return|return
name|z
operator|-
name|P
operator|/
name|Q
return|;
block|}
else|else
block|{
name|z
operator|=
name|erx
operator|+
name|P
operator|/
name|Q
expr_stmt|;
return|return
name|one
operator|+
name|z
return|;
block|}
block|}
if|if
condition|(
name|ix
operator|<
literal|0x403c0000
condition|)
block|{
comment|/* |x|<28 */
name|x
operator|=
name|fabs
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|s
operator|=
name|one
operator|/
operator|(
name|x
operator|*
name|x
operator|)
expr_stmt|;
if|if
condition|(
name|ix
operator|<
literal|0x4006DB6D
condition|)
block|{
comment|/* |x|< 1/.35 ~ 2.857143*/
name|R
operator|=
name|ra0
operator|+
name|s
operator|*
operator|(
name|ra1
operator|+
name|s
operator|*
operator|(
name|ra2
operator|+
name|s
operator|*
operator|(
name|ra3
operator|+
name|s
operator|*
operator|(
name|ra4
operator|+
name|s
operator|*
operator|(
name|ra5
operator|+
name|s
operator|*
operator|(
name|ra6
operator|+
name|s
operator|*
name|ra7
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|S
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|sa1
operator|+
name|s
operator|*
operator|(
name|sa2
operator|+
name|s
operator|*
operator|(
name|sa3
operator|+
name|s
operator|*
operator|(
name|sa4
operator|+
name|s
operator|*
operator|(
name|sa5
operator|+
name|s
operator|*
operator|(
name|sa6
operator|+
name|s
operator|*
operator|(
name|sa7
operator|+
name|s
operator|*
name|sa8
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
block|}
else|else
block|{
comment|/* |x|>= 1/.35 ~ 2.857143 */
if|if
condition|(
name|hx
operator|<
literal|0
operator|&&
name|ix
operator|>=
literal|0x40180000
condition|)
return|return
name|two
operator|-
name|tiny
return|;
comment|/* x< -6 */
name|R
operator|=
name|rb0
operator|+
name|s
operator|*
operator|(
name|rb1
operator|+
name|s
operator|*
operator|(
name|rb2
operator|+
name|s
operator|*
operator|(
name|rb3
operator|+
name|s
operator|*
operator|(
name|rb4
operator|+
name|s
operator|*
operator|(
name|rb5
operator|+
name|s
operator|*
name|rb6
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|S
operator|=
name|one
operator|+
name|s
operator|*
operator|(
name|sb1
operator|+
name|s
operator|*
operator|(
name|sb2
operator|+
name|s
operator|*
operator|(
name|sb3
operator|+
name|s
operator|*
operator|(
name|sb4
operator|+
name|s
operator|*
operator|(
name|sb5
operator|+
name|s
operator|*
operator|(
name|sb6
operator|+
name|s
operator|*
name|sb7
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
block|}
name|z
operator|=
name|x
expr_stmt|;
name|SET_LOW_WORD
argument_list|(
name|z
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|r
operator|=
name|__ieee754_exp
argument_list|(
operator|-
name|z
operator|*
name|z
operator|-
literal|0.5625
argument_list|)
operator|*
name|__ieee754_exp
argument_list|(
operator|(
name|z
operator|-
name|x
operator|)
operator|*
operator|(
name|z
operator|+
name|x
operator|)
operator|+
name|R
operator|/
name|S
argument_list|)
expr_stmt|;
if|if
condition|(
name|hx
operator|>
literal|0
condition|)
return|return
name|r
operator|/
name|x
return|;
else|else
return|return
name|two
operator|-
name|r
operator|/
name|x
return|;
block|}
else|else
block|{
if|if
condition|(
name|hx
operator|>
literal|0
condition|)
return|return
name|tiny
operator|*
name|tiny
return|;
else|else
return|return
name|two
operator|-
name|tiny
return|;
block|}
block|}
end_function

end_unit

