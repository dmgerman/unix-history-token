begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2009-2013 Steven G. Kargl  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice unmodified, this list of conditions, and the following  *    disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR  * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES  * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,  * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT  * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,  * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY  * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF  * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  *  * Optimized by Bruce D. Evans.  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_comment
comment|/**  * Compute the exponential of x for Intel 80-bit format.  This is based on:  *  *   PTP Tang, "Table-driven implementation of the exponential function  *   in IEEE floating-point arithmetic," ACM Trans. Math. Soft., 15,  *   144-157 (1989).  *  * where the 32 table entries have been expanded to INTERVALS (see below).  */
end_comment

begin_include
include|#
directive|include
file|<float.h>
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|__i386__
end_ifdef

begin_include
include|#
directive|include
file|<ieeefp.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|"fpmath.h"
end_include

begin_include
include|#
directive|include
file|"math.h"
end_include

begin_include
include|#
directive|include
file|"math_private.h"
end_include

begin_define
define|#
directive|define
name|INTERVALS
value|128
end_define

begin_define
define|#
directive|define
name|LOG2_INTERVALS
value|7
end_define

begin_define
define|#
directive|define
name|BIAS
value|(LDBL_MAX_EXP - 1)
end_define

begin_decl_stmt
specifier|static
specifier|const
name|long
name|double
name|huge
init|=
literal|0x1p10000L
decl_stmt|,
name|twom10000
init|=
literal|0x1p
operator|-
literal|10000L
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* XXX Prevent gcc from erroneously constant folding this: */
end_comment

begin_decl_stmt
specifier|static
specifier|volatile
specifier|const
name|long
name|double
name|tiny
init|=
literal|0x1p
operator|-
literal|10000L
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|union
name|IEEEl2bits
comment|/* log(2**16384 - 0.5) rounded towards zero: */
comment|/* log(2**16384 - 0.5 + 1) rounded towards zero for expm1l() is the same: */
name|o_thresholdu
init|=
name|LD80C
argument_list|(
literal|0xb17217f7d1cf79ab
argument_list|,
literal|13
argument_list|,
literal|11356.5234062941439488L
argument_list|)
decl_stmt|,
define|#
directive|define
name|o_threshold
value|(o_thresholdu.e)
comment|/* log(2**(-16381-64-1)) rounded towards zero: */
name|u_thresholdu
init|=
name|LD80C
argument_list|(
literal|0xb21dfe7f09e2baa9
argument_list|,
literal|13
argument_list|,
operator|-
literal|11399.4985314888605581L
argument_list|)
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|u_threshold
value|(u_thresholdu.e)
end_define

begin_decl_stmt
specifier|static
specifier|const
name|double
comment|/*  * ln2/INTERVALS = L1+L2 (hi+lo decomposition for multiplication).  L1 must  * have at least 22 (= log2(|LDBL_MIN_EXP-extras|) + log2(INTERVALS)) lowest  * bits zero so that multiplication of it by n is exact.  */
name|INV_L
init|=
literal|1.8466496523378731e+2
decl_stmt|,
comment|/*  0x171547652b82fe.0p-45 */
name|L1
init|=
literal|5.4152123484527692e-3
decl_stmt|,
comment|/*  0x162e42ff000000.0p-60 */
name|L2
init|=
operator|-
literal|3.2819649005320973e-13
decl_stmt|,
comment|/* -0x1718432a1b0e26.0p-94 */
comment|/*  * Domain [-0.002708, 0.002708], range ~[-5.7136e-24, 5.7110e-24]:  * |exp(x) - p(x)|< 2**-77.2  * (0.002708 is ln2/(2*INTERVALS) rounded up a little).  */
name|A2
init|=
literal|0.5
decl_stmt|,
name|A3
init|=
literal|1.6666666666666119e-1
decl_stmt|,
comment|/*  0x15555555555490.0p-55 */
name|A4
init|=
literal|4.1666666666665887e-2
decl_stmt|,
comment|/*  0x155555555554e5.0p-57 */
name|A5
init|=
literal|8.3333354987869413e-3
decl_stmt|,
comment|/*  0x1111115b789919.0p-59 */
name|A6
init|=
literal|1.3888891738560272e-3
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  0x16c16c651633ae.0p-62 */
end_comment

begin_comment
comment|/*  * 2^(i/INTERVALS) for i in [0,INTERVALS] is represented by two values where  * the first 53 bits of the significand are stored in hi and the next 53  * bits are in lo.  Tang's paper states that the trailing 6 bits of hi must  * be zero for his algorithm in both single and double precision, because  * the table is re-used in the implementation of expm1() where a floating  * point addition involving hi must be exact.  Here hi is double, so  * converting it to long double gives 11 trailing zero bits.  */
end_comment

begin_struct
specifier|static
specifier|const
struct|struct
block|{
name|double
name|hi
decl_stmt|;
name|double
name|lo
decl_stmt|;
block|}
name|tbl
index|[
name|INTERVALS
index|]
init|=
block|{
literal|0x1p
operator|+
literal|0
block|,
literal|0x0p
operator|+
literal|0
block|,
literal|0x1
literal|.0163da9fb3335p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|b61299ab8cdb7p
operator|-
literal|54
block|,
literal|0x1
literal|.02c9a3e778060p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|dcdef95949ef4p
operator|-
literal|53
block|,
literal|0x1
literal|.04315e86e7f84p
operator|+
literal|0
block|,
literal|0x1
literal|.7ae71f3441b49p
operator|-
literal|53
block|,
literal|0x1
literal|.059b0d3158574p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|d73e2a475b465p
operator|-
literal|55
block|,
literal|0x1
literal|.0706b29ddf6ddp
operator|+
literal|0
block|,
literal|0x1
literal|.8db880753b0f6p
operator|-
literal|53
block|,
literal|0x1
literal|.0874518759bc8p
operator|+
literal|0
block|,
literal|0x1
literal|.186be4bb284ffp
operator|-
literal|57
block|,
literal|0x1
literal|.09e3ecac6f383p
operator|+
literal|0
block|,
literal|0x1
literal|.1487818316136p
operator|-
literal|54
block|,
literal|0x1
literal|.0b5586cf9890fp
operator|+
literal|0
block|,
literal|0x1
literal|.8a62e4adc610bp
operator|-
literal|54
block|,
literal|0x1
literal|.0cc922b7247f7p
operator|+
literal|0
block|,
literal|0x1
literal|.01edc16e24f71p
operator|-
literal|54
block|,
literal|0x1
literal|.0e3ec32d3d1a2p
operator|+
literal|0
block|,
literal|0x1
literal|.03a1727c57b53p
operator|-
literal|59
block|,
literal|0x1
literal|.0fb66affed31ap
operator|+
literal|0
block|,
literal|0x1
operator|.
name|e464123bb1428p
operator|-
literal|53
block|,
literal|0x1
literal|.11301d0125b50p
operator|+
literal|0
block|,
literal|0x1
literal|.49d77e35db263p
operator|-
literal|53
block|,
literal|0x1
literal|.12abdc06c31cbp
operator|+
literal|0
block|,
literal|0x1
operator|.
name|f72575a649ad2p
operator|-
literal|53
block|,
literal|0x1
literal|.1429aaea92ddfp
operator|+
literal|0
block|,
literal|0x1
literal|.66820328764b1p
operator|-
literal|53
block|,
literal|0x1
literal|.15a98c8a58e51p
operator|+
literal|0
block|,
literal|0x1
literal|.2406ab9eeab0ap
operator|-
literal|55
block|,
literal|0x1
literal|.172b83c7d517ap
operator|+
literal|0
block|,
literal|0x1
operator|.
name|b9bef918a1d63p
operator|-
literal|53
block|,
literal|0x1
literal|.18af9388c8de9p
operator|+
literal|0
block|,
literal|0x1
literal|.777ee1734784ap
operator|-
literal|53
block|,
literal|0x1
literal|.1a35beb6fcb75p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|e5b4c7b4968e4p
operator|-
literal|55
block|,
literal|0x1
literal|.1bbe084045cd3p
operator|+
literal|0
block|,
literal|0x1
literal|.3563ce56884fcp
operator|-
literal|53
block|,
literal|0x1
literal|.1d4873168b9aap
operator|+
literal|0
block|,
literal|0x1
operator|.
name|e016e00a2643cp
operator|-
literal|54
block|,
literal|0x1
literal|.1ed5022fcd91cp
operator|+
literal|0
block|,
literal|0x1
literal|.71033fec2243ap
operator|-
literal|53
block|,
literal|0x1
literal|.2063b88628cd6p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|dc775814a8495p
operator|-
literal|55
block|,
literal|0x1
literal|.21f49917ddc96p
operator|+
literal|0
block|,
literal|0x1
literal|.2a97e9494a5eep
operator|-
literal|55
block|,
literal|0x1
literal|.2387a6e756238p
operator|+
literal|0
block|,
literal|0x1
literal|.9b07eb6c70573p
operator|-
literal|54
block|,
literal|0x1
literal|.251ce4fb2a63fp
operator|+
literal|0
block|,
literal|0x1
operator|.
name|ac155bef4f4a4p
operator|-
literal|55
block|,
literal|0x1
literal|.26b4565e27cddp
operator|+
literal|0
block|,
literal|0x1
literal|.2bd339940e9d9p
operator|-
literal|55
block|,
literal|0x1
literal|.284dfe1f56380p
operator|+
literal|0
block|,
literal|0x1
literal|.2d9e2b9e07941p
operator|-
literal|53
block|,
literal|0x1
literal|.29e9df51fdee1p
operator|+
literal|0
block|,
literal|0x1
literal|.612e8afad1255p
operator|-
literal|55
block|,
literal|0x1
literal|.2b87fd0dad98fp
operator|+
literal|0
block|,
literal|0x1
operator|.
name|fbbd48ca71f95p
operator|-
literal|53
block|,
literal|0x1
literal|.2d285a6e4030bp
operator|+
literal|0
block|,
literal|0x1
literal|.0024754db41d5p
operator|-
literal|54
block|,
literal|0x1
literal|.2ecafa93e2f56p
operator|+
literal|0
block|,
literal|0x1
literal|.1ca0f45d52383p
operator|-
literal|56
block|,
literal|0x1
literal|.306fe0a31b715p
operator|+
literal|0
block|,
literal|0x1
literal|.6f46ad23182e4p
operator|-
literal|55
block|,
literal|0x1
literal|.32170fc4cd831p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|a9ce78e18047cp
operator|-
literal|55
block|,
literal|0x1
literal|.33c08b26416ffp
operator|+
literal|0
block|,
literal|0x1
literal|.32721843659a6p
operator|-
literal|54
block|,
literal|0x1
literal|.356c55f929ff0p
operator|+
literal|0
block|,
literal|0x1
literal|.928c468ec6e76p
operator|-
literal|53
block|,
literal|0x1
literal|.371a7373aa9cap
operator|+
literal|0
block|,
literal|0x1
literal|.4e28aa05e8a8fp
operator|-
literal|53
block|,
literal|0x1
literal|.38cae6d05d865p
operator|+
literal|0
block|,
literal|0x1
literal|.0b53961b37da2p
operator|-
literal|53
block|,
literal|0x1
literal|.3a7db34e59ff6p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|d43792533c144p
operator|-
literal|53
block|,
literal|0x1
literal|.3c32dc313a8e4p
operator|+
literal|0
block|,
literal|0x1
literal|.08003e4516b1ep
operator|-
literal|53
block|,
literal|0x1
literal|.3dea64c123422p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|ada0911f09ebcp
operator|-
literal|55
block|,
literal|0x1
literal|.3fa4504ac801bp
operator|+
literal|0
block|,
literal|0x1
literal|.417ee03548306p
operator|-
literal|53
block|,
literal|0x1
literal|.4160a21f72e29p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|f0864b71e7b6cp
operator|-
literal|53
block|,
literal|0x1
literal|.431f5d950a896p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|b8e088728219ap
operator|-
literal|53
block|,
literal|0x1
literal|.44e086061892dp
operator|+
literal|0
block|,
literal|0x1
literal|.89b7a04ef80d0p
operator|-
literal|59
block|,
literal|0x1
literal|.46a41ed1d0057p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|c944bd1648a76p
operator|-
literal|54
block|,
literal|0x1
literal|.486a2b5c13cd0p
operator|+
literal|0
block|,
literal|0x1
literal|.3c1a3b69062f0p
operator|-
literal|56
block|,
literal|0x1
literal|.4a32af0d7d3dep
operator|+
literal|0
block|,
literal|0x1
literal|.9cb62f3d1be56p
operator|-
literal|54
block|,
literal|0x1
literal|.4bfdad5362a27p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|d4397afec42e2p
operator|-
literal|56
block|,
literal|0x1
literal|.4dcb299fddd0dp
operator|+
literal|0
block|,
literal|0x1
literal|.8ecdbbc6a7833p
operator|-
literal|54
block|,
literal|0x1
literal|.4f9b2769d2ca6p
operator|+
literal|0
block|,
literal|0x1
literal|.5a67b16d3540ep
operator|-
literal|53
block|,
literal|0x1
literal|.516daa2cf6641p
operator|+
literal|0
block|,
literal|0x1
literal|.8225ea5909b04p
operator|-
literal|53
block|,
literal|0x1
literal|.5342b569d4f81p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|be1507893b0d5p
operator|-
literal|53
block|,
literal|0x1
literal|.551a4ca5d920ep
operator|+
literal|0
block|,
literal|0x1
literal|.8a5d8c4048699p
operator|-
literal|53
block|,
literal|0x1
literal|.56f4736b527dap
operator|+
literal|0
block|,
literal|0x1
literal|.9bb2c011d93adp
operator|-
literal|54
block|,
literal|0x1
literal|.58d12d497c7fdp
operator|+
literal|0
block|,
literal|0x1
literal|.295e15b9a1de8p
operator|-
literal|55
block|,
literal|0x1
literal|.5ab07dd485429p
operator|+
literal|0
block|,
literal|0x1
literal|.6324c054647adp
operator|-
literal|54
block|,
literal|0x1
literal|.5c9268a5946b7p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|c4b1b816986a2p
operator|-
literal|60
block|,
literal|0x1
literal|.5e76f15ad2148p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|ba6f93080e65ep
operator|-
literal|54
block|,
literal|0x1
literal|.605e1b976dc08p
operator|+
literal|0
block|,
literal|0x1
literal|.60edeb25490dcp
operator|-
literal|53
block|,
literal|0x1
literal|.6247eb03a5584p
operator|+
literal|0
block|,
literal|0x1
literal|.63e1f40dfa5b5p
operator|-
literal|53
block|,
literal|0x1
literal|.6434634ccc31fp
operator|+
literal|0
block|,
literal|0x1
literal|.8edf0e2989db3p
operator|-
literal|53
block|,
literal|0x1
literal|.6623882552224p
operator|+
literal|0
block|,
literal|0x1
literal|.224fb3c5371e6p
operator|-
literal|53
block|,
literal|0x1
literal|.68155d44ca973p
operator|+
literal|0
block|,
literal|0x1
literal|.038ae44f73e65p
operator|-
literal|57
block|,
literal|0x1
literal|.6a09e667f3bccp
operator|+
literal|0
block|,
literal|0x1
literal|.21165f626cdd5p
operator|-
literal|53
block|,
literal|0x1
literal|.6c012750bdabep
operator|+
literal|0
block|,
literal|0x1
operator|.
name|daed533001e9ep
operator|-
literal|53
block|,
literal|0x1
literal|.6dfb23c651a2ep
operator|+
literal|0
block|,
literal|0x1
operator|.
name|e441c597c3775p
operator|-
literal|53
block|,
literal|0x1
literal|.6ff7df9519483p
operator|+
literal|0
block|,
literal|0x1
literal|.9f0fc369e7c42p
operator|-
literal|53
block|,
literal|0x1
literal|.71f75e8ec5f73p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|ba46e1e5de15ap
operator|-
literal|53
block|,
literal|0x1
literal|.73f9a48a58173p
operator|+
literal|0
block|,
literal|0x1
literal|.7ab9349cd1562p
operator|-
literal|53
block|,
literal|0x1
literal|.75feb564267c8p
operator|+
literal|0
block|,
literal|0x1
literal|.7edd354674916p
operator|-
literal|53
block|,
literal|0x1
literal|.780694fde5d3fp
operator|+
literal|0
block|,
literal|0x1
literal|.866b80a02162dp
operator|-
literal|54
block|,
literal|0x1
literal|.7a11473eb0186p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|afaa2047ed9b4p
operator|-
literal|53
block|,
literal|0x1
literal|.7c1ed0130c132p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|f124cd1164dd6p
operator|-
literal|54
block|,
literal|0x1
literal|.7e2f336cf4e62p
operator|+
literal|0
block|,
literal|0x1
literal|.05d02ba15797ep
operator|-
literal|56
block|,
literal|0x1
literal|.80427543e1a11p
operator|+
literal|0
block|,
literal|0x1
literal|.6c1bccec9346bp
operator|-
literal|53
block|,
literal|0x1
literal|.82589994cce12p
operator|+
literal|0
block|,
literal|0x1
literal|.159f115f56694p
operator|-
literal|53
block|,
literal|0x1
literal|.8471a4623c7acp
operator|+
literal|0
block|,
literal|0x1
literal|.9ca5ed72f8c81p
operator|-
literal|53
block|,
literal|0x1
literal|.868d99b4492ecp
operator|+
literal|0
block|,
literal|0x1
literal|.01c83b21584a3p
operator|-
literal|53
block|,
literal|0x1
literal|.88ac7d98a6699p
operator|+
literal|0
block|,
literal|0x1
literal|.994c2f37cb53ap
operator|-
literal|54
block|,
literal|0x1
literal|.8ace5422aa0dbp
operator|+
literal|0
block|,
literal|0x1
literal|.6e9f156864b27p
operator|-
literal|54
block|,
literal|0x1
literal|.8cf3216b5448bp
operator|+
literal|0
block|,
literal|0x1
operator|.
name|de55439a2c38bp
operator|-
literal|53
block|,
literal|0x1
literal|.8f1ae99157736p
operator|+
literal|0
block|,
literal|0x1
literal|.5cc13a2e3976cp
operator|-
literal|55
block|,
literal|0x1
literal|.9145b0b91ffc5p
operator|+
literal|0
block|,
literal|0x1
literal|.114c368d3ed6ep
operator|-
literal|53
block|,
literal|0x1
literal|.93737b0cdc5e4p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|e8a0387e4a814p
operator|-
literal|53
block|,
literal|0x1
literal|.95a44cbc8520ep
operator|+
literal|0
block|,
literal|0x1
operator|.
name|d36906d2b41f9p
operator|-
literal|53
block|,
literal|0x1
literal|.97d829fde4e4fp
operator|+
literal|0
block|,
literal|0x1
literal|.173d241f23d18p
operator|-
literal|53
block|,
literal|0x1
literal|.9a0f170ca07b9p
operator|+
literal|0
block|,
literal|0x1
literal|.7462137188ce7p
operator|-
literal|53
block|,
literal|0x1
literal|.9c49182a3f090p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|c7c46b071f2bep
operator|-
literal|56
block|,
literal|0x1
literal|.9e86319e32323p
operator|+
literal|0
block|,
literal|0x1
literal|.824ca78e64c6ep
operator|-
literal|56
block|,
literal|0x1
operator|.
name|a0c667b5de564p
operator|+
literal|0
block|,
literal|0x1
literal|.6535b51719567p
operator|-
literal|53
block|,
literal|0x1
operator|.
name|a309bec4a2d33p
operator|+
literal|0
block|,
literal|0x1
literal|.6305c7ddc36abp
operator|-
literal|54
block|,
literal|0x1
operator|.
name|a5503b23e255cp
operator|+
literal|0
block|,
literal|0x1
literal|.1684892395f0fp
operator|-
literal|53
block|,
literal|0x1
operator|.
name|a799e1330b358p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|bcb7ecac563c7p
operator|-
literal|54
block|,
literal|0x1
operator|.
name|a9e6b5579fdbfp
operator|+
literal|0
block|,
literal|0x1
literal|.0fac90ef7fd31p
operator|-
literal|54
block|,
literal|0x1
operator|.
name|ac36bbfd3f379p
operator|+
literal|0
block|,
literal|0x1
literal|.81b72cd4624ccp
operator|-
literal|53
block|,
literal|0x1
operator|.
name|ae89f995ad3adp
operator|+
literal|0
block|,
literal|0x1
literal|.7a1cd345dcc81p
operator|-
literal|54
block|,
literal|0x1
operator|.
name|b0e07298db665p
operator|+
literal|0
block|,
literal|0x1
literal|.2108559bf8deep
operator|-
literal|53
block|,
literal|0x1
operator|.
name|b33a2b84f15fap
operator|+
literal|0
block|,
literal|0x1
operator|.
name|ed7fa1cf7b290p
operator|-
literal|53
block|,
literal|0x1
operator|.
name|b59728de55939p
operator|+
literal|0
block|,
literal|0x1
literal|.1c7102222c90ep
operator|-
literal|53
block|,
literal|0x1
operator|.
name|b7f76f2fb5e46p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|d54f610356a79p
operator|-
literal|53
block|,
literal|0x1
operator|.
name|ba5b030a10649p
operator|+
literal|0
block|,
literal|0x1
literal|.0819678d5eb69p
operator|-
literal|53
block|,
literal|0x1
operator|.
name|bcc1e904bc1d2p
operator|+
literal|0
block|,
literal|0x1
literal|.23dd07a2d9e84p
operator|-
literal|55
block|,
literal|0x1
operator|.
name|bf2c25bd71e08p
operator|+
literal|0
block|,
literal|0x1
literal|.0811ae04a31c7p
operator|-
literal|53
block|,
literal|0x1
operator|.
name|c199bdd85529cp
operator|+
literal|0
block|,
literal|0x1
literal|.11065895048ddp
operator|-
literal|55
block|,
literal|0x1
operator|.
name|c40ab5fffd07ap
operator|+
literal|0
block|,
literal|0x1
operator|.
name|b4537e083c60ap
operator|-
literal|54
block|,
literal|0x1
operator|.
name|c67f12e57d14bp
operator|+
literal|0
block|,
literal|0x1
literal|.2884dff483cadp
operator|-
literal|54
block|,
literal|0x1
operator|.
name|c8f6d9406e7b5p
operator|+
literal|0
block|,
literal|0x1
literal|.1acbc48805c44p
operator|-
literal|56
block|,
literal|0x1
operator|.
name|cb720dcef9069p
operator|+
literal|0
block|,
literal|0x1
literal|.503cbd1e949dbp
operator|-
literal|56
block|,
literal|0x1
operator|.
name|cdf0b555dc3f9p
operator|+
literal|0
block|,
literal|0x1
literal|.889f12b1f58a3p
operator|-
literal|53
block|,
literal|0x1
operator|.
name|d072d4a07897bp
operator|+
literal|0
block|,
literal|0x1
literal|.1a1e45e4342b2p
operator|-
literal|53
block|,
literal|0x1
operator|.
name|d2f87080d89f1p
operator|+
literal|0
block|,
literal|0x1
literal|.15bc247313d44p
operator|-
literal|53
block|,
literal|0x1
operator|.
name|d5818dcfba487p
operator|+
literal|0
block|,
literal|0x1
literal|.2ed02d75b3707p
operator|-
literal|55
block|,
literal|0x1
operator|.
name|d80e316c98397p
operator|+
literal|0
block|,
literal|0x1
literal|.7709f3a09100cp
operator|-
literal|53
block|,
literal|0x1
operator|.
name|da9e603db3285p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|c2300696db532p
operator|-
literal|54
block|,
literal|0x1
operator|.
name|dd321f301b460p
operator|+
literal|0
block|,
literal|0x1
literal|.2da5778f018c3p
operator|-
literal|54
block|,
literal|0x1
operator|.
name|dfc97337b9b5ep
operator|+
literal|0
block|,
literal|0x1
literal|.72d195873da52p
operator|-
literal|53
block|,
literal|0x1
operator|.
name|e264614f5a128p
operator|+
literal|0
block|,
literal|0x1
literal|.424ec3f42f5b5p
operator|-
literal|53
block|,
literal|0x1
operator|.
name|e502ee78b3ff6p
operator|+
literal|0
block|,
literal|0x1
literal|.39e8980a9cc8fp
operator|-
literal|55
block|,
literal|0x1
operator|.
name|e7a51fbc74c83p
operator|+
literal|0
block|,
literal|0x1
literal|.2d522ca0c8de2p
operator|-
literal|54
block|,
literal|0x1
operator|.
name|ea4afa2a490d9p
operator|+
literal|0
block|,
literal|0x1
literal|.0b1ee7431ebb6p
operator|-
literal|53
block|,
literal|0x1
operator|.
name|ecf482d8e67f0p
operator|+
literal|0
block|,
literal|0x1
literal|.1b60625f7293ap
operator|-
literal|53
block|,
literal|0x1
operator|.
name|efa1bee615a27p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|dc7f486a4b6b0p
operator|-
literal|54
block|,
literal|0x1
operator|.
name|f252b376bba97p
operator|+
literal|0
block|,
literal|0x1
literal|.3a1a5bf0d8e43p
operator|-
literal|54
block|,
literal|0x1
operator|.
name|f50765b6e4540p
operator|+
literal|0
block|,
literal|0x1
literal|.9d3e12dd8a18bp
operator|-
literal|54
block|,
literal|0x1
operator|.
name|f7bfdad9cbe13p
operator|+
literal|0
block|,
literal|0x1
literal|.1227697fce57bp
operator|-
literal|53
block|,
literal|0x1
operator|.
name|fa7c1819e90d8p
operator|+
literal|0
block|,
literal|0x1
literal|.74853f3a5931ep
operator|-
literal|55
block|,
literal|0x1
operator|.
name|fd3c22b8f71f1p
operator|+
literal|0
block|,
literal|0x1
literal|.2eb74966579e7p
operator|-
literal|57
block|}
struct|;
end_struct

begin_function
name|long
name|double
name|expl
parameter_list|(
name|long
name|double
name|x
parameter_list|)
block|{
name|union
name|IEEEl2bits
name|u
decl_stmt|,
name|v
decl_stmt|;
name|long
name|double
name|fn
decl_stmt|,
name|q
decl_stmt|,
name|r
decl_stmt|,
name|r1
decl_stmt|,
name|r2
decl_stmt|,
name|t
decl_stmt|,
name|twopk
decl_stmt|,
name|twopkp10000
decl_stmt|;
name|long
name|double
name|z
decl_stmt|;
name|int
name|k
decl_stmt|,
name|n
decl_stmt|,
name|n2
decl_stmt|;
name|uint16_t
name|hx
decl_stmt|,
name|ix
decl_stmt|;
comment|/* Filter out exceptional cases. */
name|u
operator|.
name|e
operator|=
name|x
expr_stmt|;
name|hx
operator|=
name|u
operator|.
name|xbits
operator|.
name|expsign
expr_stmt|;
name|ix
operator|=
name|hx
operator|&
literal|0x7fff
expr_stmt|;
if|if
condition|(
name|ix
operator|>=
name|BIAS
operator|+
literal|13
condition|)
block|{
comment|/* |x|>= 8192 or x is NaN */
if|if
condition|(
name|ix
operator|==
name|BIAS
operator|+
name|LDBL_MAX_EXP
condition|)
block|{
if|if
condition|(
name|hx
operator|&
literal|0x8000
condition|)
comment|/* x is -Inf, -NaN or unsupported */
return|return
operator|(
operator|-
literal|1
operator|/
name|x
operator|)
return|;
return|return
operator|(
name|x
operator|+
name|x
operator|)
return|;
comment|/* x is +Inf, +NaN or unsupported */
block|}
if|if
condition|(
name|x
operator|>
name|o_threshold
condition|)
return|return
operator|(
name|huge
operator|*
name|huge
operator|)
return|;
if|if
condition|(
name|x
operator|<
name|u_threshold
condition|)
return|return
operator|(
name|tiny
operator|*
name|tiny
operator|)
return|;
block|}
elseif|else
if|if
condition|(
name|ix
operator|<
name|BIAS
operator|-
literal|65
condition|)
block|{
comment|/* |x|< 0x1p-65 (includes pseudos) */
return|return
operator|(
literal|1
operator|+
name|x
operator|)
return|;
comment|/* 1 with inexact iff x != 0 */
block|}
name|ENTERI
argument_list|()
expr_stmt|;
comment|/* Reduce x to (k*ln2 + endpoint[n2] + r1 + r2). */
comment|/* Use a specialized rint() to get fn.  Assume round-to-nearest. */
name|fn
operator|=
name|x
operator|*
name|INV_L
operator|+
literal|0x1
literal|.8p63
operator|-
literal|0x1
literal|.8p63
expr_stmt|;
name|r
operator|=
name|x
operator|-
name|fn
operator|*
name|L1
operator|-
name|fn
operator|*
name|L2
expr_stmt|;
comment|/* r = r1 + r2 done independently. */
if|#
directive|if
name|defined
argument_list|(
name|HAVE_EFFICIENT_IRINTL
argument_list|)
name|n
operator|=
name|irintl
argument_list|(
name|fn
argument_list|)
expr_stmt|;
elif|#
directive|elif
name|defined
argument_list|(
name|HAVE_EFFICIENT_IRINT
argument_list|)
name|n
operator|=
name|irint
argument_list|(
name|fn
argument_list|)
expr_stmt|;
else|#
directive|else
name|n
operator|=
operator|(
name|int
operator|)
name|fn
expr_stmt|;
endif|#
directive|endif
name|n2
operator|=
operator|(
name|unsigned
operator|)
name|n
operator|%
name|INTERVALS
expr_stmt|;
comment|/* Depend on the sign bit being propagated: */
name|k
operator|=
name|n
operator|>>
name|LOG2_INTERVALS
expr_stmt|;
name|r1
operator|=
name|x
operator|-
name|fn
operator|*
name|L1
expr_stmt|;
name|r2
operator|=
name|fn
operator|*
operator|-
name|L2
expr_stmt|;
comment|/* Prepare scale factors. */
name|v
operator|.
name|e
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|k
operator|>=
name|LDBL_MIN_EXP
condition|)
block|{
name|v
operator|.
name|xbits
operator|.
name|expsign
operator|=
name|BIAS
operator|+
name|k
expr_stmt|;
name|twopk
operator|=
name|v
operator|.
name|e
expr_stmt|;
block|}
else|else
block|{
name|v
operator|.
name|xbits
operator|.
name|expsign
operator|=
name|BIAS
operator|+
name|k
operator|+
literal|10000
expr_stmt|;
name|twopkp10000
operator|=
name|v
operator|.
name|e
expr_stmt|;
block|}
comment|/* Evaluate expl(endpoint[n2] + r1 + r2) = tbl[n2] * expl(r1 + r2). */
name|z
operator|=
name|r
operator|*
name|r
expr_stmt|;
name|q
operator|=
name|r2
operator|+
name|z
operator|*
operator|(
name|A2
operator|+
name|r
operator|*
name|A3
operator|)
operator|+
name|z
operator|*
name|z
operator|*
operator|(
name|A4
operator|+
name|r
operator|*
name|A5
operator|)
operator|+
name|z
operator|*
name|z
operator|*
name|z
operator|*
name|A6
expr_stmt|;
name|t
operator|=
operator|(
name|long
name|double
operator|)
name|tbl
index|[
name|n2
index|]
operator|.
name|lo
operator|+
name|tbl
index|[
name|n2
index|]
operator|.
name|hi
expr_stmt|;
name|t
operator|=
name|tbl
index|[
name|n2
index|]
operator|.
name|lo
operator|+
name|t
operator|*
operator|(
name|q
operator|+
name|r1
operator|)
operator|+
name|tbl
index|[
name|n2
index|]
operator|.
name|hi
expr_stmt|;
comment|/* Scale by 2**k. */
if|if
condition|(
name|k
operator|>=
name|LDBL_MIN_EXP
condition|)
block|{
if|if
condition|(
name|k
operator|==
name|LDBL_MAX_EXP
condition|)
name|RETURNI
argument_list|(
name|t
operator|*
literal|2
operator|*
literal|0x1p16383L
argument_list|)
expr_stmt|;
name|RETURNI
argument_list|(
name|t
operator|*
name|twopk
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|RETURNI
argument_list|(
name|t
operator|*
name|twopkp10000
operator|*
name|twom10000
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/**  * Compute expm1l(x) for Intel 80-bit format.  This is based on:  *  *   PTP Tang, "Table-driven implementation of the Expm1 function  *   in IEEE floating-point arithmetic," ACM Trans. Math. Soft., 18,  *   211-222 (1992).  */
end_comment

begin_comment
comment|/*  * Our T1 and T2 are chosen to be approximately the points where method  * A and method B have the same accuracy.  Tang's T1 and T2 are the  * points where method A's accuracy changes by a full bit.  For Tang,  * this drop in accuracy makes method A immediately less accurate than  * method B, but our larger INTERVALS makes method A 2 bits more  * accurate so it remains the most accurate method significantly  * closer to the origin despite losing the full bit in our extended  * range for it.  */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|double
name|T1
init|=
operator|-
literal|0.1659
decl_stmt|,
comment|/* ~-30.625/128 * log(2) */
name|T2
init|=
literal|0.1659
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ~30.625/128 * log(2) */
end_comment

begin_comment
comment|/*  * Domain [-0.1659, 0.1659], range ~[-1.2027e-22, 3.4417e-22]:  * |(exp(x)-1-x-x**2/2)/x - p(x)|< 2**-71.2  */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|union
name|IEEEl2bits
name|B3
init|=
name|LD80C
argument_list|(
literal|0xaaaaaaaaaaaaaaab
argument_list|,
operator|-
literal|3
argument_list|,
literal|1.66666666666666666671e-1L
argument_list|)
decl_stmt|,
name|B4
init|=
name|LD80C
argument_list|(
literal|0xaaaaaaaaaaaaaaac
argument_list|,
operator|-
literal|5
argument_list|,
literal|4.16666666666666666712e-2L
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|B5
init|=
literal|8.3333333333333245e-3
decl_stmt|,
comment|/*  0x1.111111111110cp-7 */
name|B6
init|=
literal|1.3888888888888861e-3
decl_stmt|,
comment|/*  0x1.6c16c16c16c0ap-10 */
name|B7
init|=
literal|1.9841269841532042e-4
decl_stmt|,
comment|/*  0x1.a01a01a0319f9p-13 */
name|B8
init|=
literal|2.4801587302069236e-5
decl_stmt|,
comment|/*  0x1.a01a01a03cbbcp-16 */
name|B9
init|=
literal|2.7557316558468562e-6
decl_stmt|,
comment|/*  0x1.71de37fd33d67p-19 */
name|B10
init|=
literal|2.7557315829785151e-7
decl_stmt|,
comment|/*  0x1.27e4f91418144p-22 */
name|B11
init|=
literal|2.5063168199779829e-8
decl_stmt|,
comment|/*  0x1.ae94fabdc6b27p-26 */
name|B12
init|=
literal|2.0887164654459567e-9
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  0x1.1f122d6413fe1p-29 */
end_comment

begin_function
name|long
name|double
name|expm1l
parameter_list|(
name|long
name|double
name|x
parameter_list|)
block|{
name|union
name|IEEEl2bits
name|u
decl_stmt|,
name|v
decl_stmt|;
name|long
name|double
name|fn
decl_stmt|,
name|hx2_hi
decl_stmt|,
name|hx2_lo
decl_stmt|,
name|q
decl_stmt|,
name|r
decl_stmt|,
name|r1
decl_stmt|,
name|r2
decl_stmt|,
name|t
decl_stmt|,
name|twomk
decl_stmt|,
name|twopk
decl_stmt|,
name|x_hi
decl_stmt|;
name|long
name|double
name|x_lo
decl_stmt|,
name|x2
decl_stmt|,
name|z
decl_stmt|;
name|long
name|double
name|x4
decl_stmt|;
name|int
name|k
decl_stmt|,
name|n
decl_stmt|,
name|n2
decl_stmt|;
name|uint16_t
name|hx
decl_stmt|,
name|ix
decl_stmt|;
comment|/* Filter out exceptional cases. */
name|u
operator|.
name|e
operator|=
name|x
expr_stmt|;
name|hx
operator|=
name|u
operator|.
name|xbits
operator|.
name|expsign
expr_stmt|;
name|ix
operator|=
name|hx
operator|&
literal|0x7fff
expr_stmt|;
if|if
condition|(
name|ix
operator|>=
name|BIAS
operator|+
literal|6
condition|)
block|{
comment|/* |x|>= 64 or x is NaN */
if|if
condition|(
name|ix
operator|==
name|BIAS
operator|+
name|LDBL_MAX_EXP
condition|)
block|{
if|if
condition|(
name|hx
operator|&
literal|0x8000
condition|)
comment|/* x is -Inf, -NaN or unsupported */
return|return
operator|(
operator|-
literal|1
operator|/
name|x
operator|-
literal|1
operator|)
return|;
return|return
operator|(
name|x
operator|+
name|x
operator|)
return|;
comment|/* x is +Inf, +NaN or unsupported */
block|}
if|if
condition|(
name|x
operator|>
name|o_threshold
condition|)
return|return
operator|(
name|huge
operator|*
name|huge
operator|)
return|;
comment|/* 		 * expm1l() never underflows, but it must avoid 		 * unrepresentable large negative exponents.  We used a 		 * much smaller threshold for large |x| above than in 		 * expl() so as to handle not so large negative exponents 		 * in the same way as large ones here. 		 */
if|if
condition|(
name|hx
operator|&
literal|0x8000
condition|)
comment|/* x<= -64 */
return|return
operator|(
name|tiny
operator|-
literal|1
operator|)
return|;
comment|/* good for x< -65ln2 - eps */
block|}
name|ENTERI
argument_list|()
expr_stmt|;
if|if
condition|(
name|T1
operator|<
name|x
operator|&&
name|x
operator|<
name|T2
condition|)
block|{
if|if
condition|(
name|ix
operator|<
name|BIAS
operator|-
literal|64
condition|)
block|{
comment|/* |x|< 0x1p-64 (includes pseudos) */
comment|/* x (rounded) with inexact if x != 0: */
name|RETURNI
argument_list|(
name|x
operator|==
literal|0
condition|?
name|x
else|:
operator|(
literal|0x1p100
operator|*
name|x
operator|+
name|fabsl
argument_list|(
name|x
argument_list|)
operator|)
operator|*
literal|0x1p
operator|-
literal|100
argument_list|)
expr_stmt|;
block|}
name|x2
operator|=
name|x
operator|*
name|x
expr_stmt|;
name|x4
operator|=
name|x2
operator|*
name|x2
expr_stmt|;
name|q
operator|=
name|x4
operator|*
operator|(
name|x2
operator|*
operator|(
name|x4
operator|*
comment|/* 		     * XXX the number of terms is no longer good for 		     * pairwise grouping of all except B3, and the 		     * grouping is no longer from highest down. 		     */
operator|(
name|x2
operator|*
name|B12
operator|+
operator|(
name|x
operator|*
name|B11
operator|+
name|B10
operator|)
operator|)
operator|+
operator|(
name|x2
operator|*
operator|(
name|x
operator|*
name|B9
operator|+
name|B8
operator|)
operator|+
operator|(
name|x
operator|*
name|B7
operator|+
name|B6
operator|)
operator|)
operator|)
operator|+
operator|(
name|x
operator|*
name|B5
operator|+
name|B4
operator|.
name|e
operator|)
operator|)
operator|+
name|x2
operator|*
name|x
operator|*
name|B3
operator|.
name|e
expr_stmt|;
name|x_hi
operator|=
operator|(
name|float
operator|)
name|x
expr_stmt|;
name|x_lo
operator|=
name|x
operator|-
name|x_hi
expr_stmt|;
name|hx2_hi
operator|=
name|x_hi
operator|*
name|x_hi
operator|/
literal|2
expr_stmt|;
name|hx2_lo
operator|=
name|x_lo
operator|*
operator|(
name|x
operator|+
name|x_hi
operator|)
operator|/
literal|2
expr_stmt|;
if|if
condition|(
name|ix
operator|>=
name|BIAS
operator|-
literal|7
condition|)
name|RETURNI
argument_list|(
name|hx2_lo
operator|+
name|x_lo
operator|+
name|q
operator|+
operator|(
name|hx2_hi
operator|+
name|x_hi
operator|)
argument_list|)
expr_stmt|;
else|else
name|RETURNI
argument_list|(
name|hx2_lo
operator|+
name|q
operator|+
name|hx2_hi
operator|+
name|x
argument_list|)
expr_stmt|;
block|}
comment|/* Reduce x to (k*ln2 + endpoint[n2] + r1 + r2). */
comment|/* Use a specialized rint() to get fn.  Assume round-to-nearest. */
name|fn
operator|=
name|x
operator|*
name|INV_L
operator|+
literal|0x1
literal|.8p63
operator|-
literal|0x1
literal|.8p63
expr_stmt|;
if|#
directive|if
name|defined
argument_list|(
name|HAVE_EFFICIENT_IRINTL
argument_list|)
name|n
operator|=
name|irintl
argument_list|(
name|fn
argument_list|)
expr_stmt|;
elif|#
directive|elif
name|defined
argument_list|(
name|HAVE_EFFICIENT_IRINT
argument_list|)
name|n
operator|=
name|irint
argument_list|(
name|fn
argument_list|)
expr_stmt|;
else|#
directive|else
name|n
operator|=
operator|(
name|int
operator|)
name|fn
expr_stmt|;
endif|#
directive|endif
name|n2
operator|=
operator|(
name|unsigned
operator|)
name|n
operator|%
name|INTERVALS
expr_stmt|;
name|k
operator|=
name|n
operator|>>
name|LOG2_INTERVALS
expr_stmt|;
name|r1
operator|=
name|x
operator|-
name|fn
operator|*
name|L1
expr_stmt|;
name|r2
operator|=
name|fn
operator|*
operator|-
name|L2
expr_stmt|;
name|r
operator|=
name|r1
operator|+
name|r2
expr_stmt|;
comment|/* Prepare scale factor. */
name|v
operator|.
name|e
operator|=
literal|1
expr_stmt|;
name|v
operator|.
name|xbits
operator|.
name|expsign
operator|=
name|BIAS
operator|+
name|k
expr_stmt|;
name|twopk
operator|=
name|v
operator|.
name|e
expr_stmt|;
comment|/* 	 * Evaluate lower terms of 	 * expl(endpoint[n2] + r1 + r2) = tbl[n2] * expl(r1 + r2). 	 */
name|z
operator|=
name|r
operator|*
name|r
expr_stmt|;
name|q
operator|=
name|r2
operator|+
name|z
operator|*
operator|(
name|A2
operator|+
name|r
operator|*
name|A3
operator|)
operator|+
name|z
operator|*
name|z
operator|*
operator|(
name|A4
operator|+
name|r
operator|*
name|A5
operator|)
operator|+
name|z
operator|*
name|z
operator|*
name|z
operator|*
name|A6
expr_stmt|;
name|t
operator|=
operator|(
name|long
name|double
operator|)
name|tbl
index|[
name|n2
index|]
operator|.
name|lo
operator|+
name|tbl
index|[
name|n2
index|]
operator|.
name|hi
expr_stmt|;
if|if
condition|(
name|k
operator|==
literal|0
condition|)
block|{
name|t
operator|=
name|tbl
index|[
name|n2
index|]
operator|.
name|lo
operator|*
operator|(
name|r1
operator|+
literal|1
operator|)
operator|+
name|t
operator|*
name|q
operator|+
name|tbl
index|[
name|n2
index|]
operator|.
name|hi
operator|*
name|r1
operator|+
operator|(
name|tbl
index|[
name|n2
index|]
operator|.
name|hi
operator|-
literal|1
operator|)
expr_stmt|;
name|RETURNI
argument_list|(
name|t
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|k
operator|==
operator|-
literal|1
condition|)
block|{
name|t
operator|=
name|tbl
index|[
name|n2
index|]
operator|.
name|lo
operator|*
operator|(
name|r1
operator|+
literal|1
operator|)
operator|+
name|t
operator|*
name|q
operator|+
name|tbl
index|[
name|n2
index|]
operator|.
name|hi
operator|*
name|r1
operator|+
operator|(
name|tbl
index|[
name|n2
index|]
operator|.
name|hi
operator|-
literal|2
operator|)
expr_stmt|;
name|RETURNI
argument_list|(
name|t
operator|/
literal|2
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|k
operator|<
operator|-
literal|7
condition|)
block|{
name|t
operator|=
name|tbl
index|[
name|n2
index|]
operator|.
name|lo
operator|+
name|t
operator|*
operator|(
name|q
operator|+
name|r1
operator|)
operator|+
name|tbl
index|[
name|n2
index|]
operator|.
name|hi
expr_stmt|;
name|RETURNI
argument_list|(
name|t
operator|*
name|twopk
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|k
operator|>
literal|2
operator|*
name|LDBL_MANT_DIG
operator|-
literal|1
condition|)
block|{
name|t
operator|=
name|tbl
index|[
name|n2
index|]
operator|.
name|lo
operator|+
name|t
operator|*
operator|(
name|q
operator|+
name|r1
operator|)
operator|+
name|tbl
index|[
name|n2
index|]
operator|.
name|hi
expr_stmt|;
if|if
condition|(
name|k
operator|==
name|LDBL_MAX_EXP
condition|)
name|RETURNI
argument_list|(
name|t
operator|*
literal|2
operator|*
literal|0x1p16383L
operator|-
literal|1
argument_list|)
expr_stmt|;
name|RETURNI
argument_list|(
name|t
operator|*
name|twopk
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
name|v
operator|.
name|xbits
operator|.
name|expsign
operator|=
name|BIAS
operator|-
name|k
expr_stmt|;
name|twomk
operator|=
name|v
operator|.
name|e
expr_stmt|;
if|if
condition|(
name|k
operator|>
name|LDBL_MANT_DIG
operator|-
literal|1
condition|)
name|t
operator|=
name|tbl
index|[
name|n2
index|]
operator|.
name|lo
operator|-
name|twomk
operator|+
name|t
operator|*
operator|(
name|q
operator|+
name|r1
operator|)
operator|+
name|tbl
index|[
name|n2
index|]
operator|.
name|hi
expr_stmt|;
else|else
name|t
operator|=
name|tbl
index|[
name|n2
index|]
operator|.
name|lo
operator|+
name|t
operator|*
operator|(
name|q
operator|+
name|r1
operator|)
operator|+
operator|(
name|tbl
index|[
name|n2
index|]
operator|.
name|hi
operator|-
name|twomk
operator|)
expr_stmt|;
name|RETURNI
argument_list|(
name|t
operator|*
name|twopk
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

