begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2009-2012 Steven G. Kargl  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice unmodified, this list of conditions, and the following  *    disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR  * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES  * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,  * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT  * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,  * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY  * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF  * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  *  * Optimized by Bruce D. Evans.  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_comment
comment|/*  * Compute the exponential of x for Intel 80-bit format.  This is based on:  *  *   PTP Tang, "Table-driven implementation of the exponential function  *   in IEEE floating-point arithmetic," ACM Trans. Math. Soft., 15,  *   144-157 (1989).  *  * where the 32 table entries have been expanded to NUM (see below).  */
end_comment

begin_include
include|#
directive|include
file|<float.h>
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|__i386__
end_ifdef

begin_include
include|#
directive|include
file|<ieeefp.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|"math.h"
end_include

begin_define
define|#
directive|define
name|FPSETPREC
end_define

begin_ifdef
ifdef|#
directive|ifdef
name|NO_FPSETPREC
end_ifdef

begin_undef
undef|#
directive|undef
name|FPSETPREC
end_undef

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|"math_private.h"
end_include

begin_include
include|#
directive|include
file|"fpmath.h"
end_include

begin_define
define|#
directive|define
name|BIAS
value|(LDBL_MAX_EXP - 1)
end_define

begin_decl_stmt
specifier|static
specifier|const
name|long
name|double
name|huge
init|=
literal|0x1p10000L
decl_stmt|,
name|twom10000
init|=
literal|0x1p
operator|-
literal|10000L
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* XXX Prevent gcc from erroneously constant folding this: */
end_comment

begin_decl_stmt
specifier|static
specifier|volatile
specifier|const
name|long
name|double
name|tiny
init|=
literal|0x1p
operator|-
literal|10000L
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|union
name|IEEEl2bits
comment|/* log(2**16384 - 0.5) rounded towards zero: */
name|o_threshold
init|=
name|LD80C
argument_list|(
literal|0xb17217f7d1cf79ab
argument_list|,
literal|13
argument_list|,
literal|0
argument_list|,
literal|11356.5234062941439488L
argument_list|)
decl_stmt|,
comment|/* log(2**(-16381-64-1)) rounded towards zero: */
name|u_threshold
init|=
name|LD80C
argument_list|(
literal|0xb21dfe7f09e2baa9
argument_list|,
literal|13
argument_list|,
literal|1
argument_list|,
operator|-
literal|11399.4985314888605581L
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|__aligned
argument_list|(
literal|64
argument_list|)
comment|/*  * ln2/NUM = L1+L2 (hi+lo decomposition for multiplication).  L1 must have  * at least 22 (= log2(|LDBL_MIN_EXP-extras|) + log2(NUM)) lowest bits zero  * so that multiplication of it by n is exact.  */
name|L1
init|=
literal|5.4152123484527692e-3
decl_stmt|,
comment|/*  0x162e42ff000000.0p-60 */
name|L2
init|=
operator|-
literal|3.2819649005320973e-13
decl_stmt|,
comment|/* -0x1718432a1b0e26.0p-94 */
name|INV_L
init|=
literal|1.8466496523378731e+2
decl_stmt|,
comment|/*  0x171547652b82fe.0p-45 */
comment|/*  * Domain [-0.002708, 0.002708], range ~[-5.7136e-24, 5.7110e-24]:  * |exp(x) - p(x)|< 2**-77.2  * (0.002708 is ln2/(2*NUM) rounded up a little).  */
name|P2
init|=
literal|0.5
decl_stmt|,
name|P3
init|=
literal|1.6666666666666119e-1
decl_stmt|,
comment|/*  0x15555555555490.0p-55 */
name|P4
init|=
literal|4.1666666666665887e-2
decl_stmt|,
comment|/*  0x155555555554e5.0p-57 */
name|P5
init|=
literal|8.3333354987869413e-3
decl_stmt|,
comment|/*  0x1111115b789919.0p-59 */
name|P6
init|=
literal|1.3888891738560272e-3
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*  0x16c16c651633ae.0p-62 */
end_comment

begin_comment
comment|/*  * 2^(i/NUM) for i in [0,NUM] is represented by two values where the  * first 47 (?!) bits of the significand is stored in hi and the next 53  * bits are in lo.  */
end_comment

begin_define
define|#
directive|define
name|NUM
value|128
end_define

begin_struct
specifier|static
specifier|const
struct|struct
block|{
name|double
name|hi
decl_stmt|;
name|double
name|lo
decl_stmt|;
block|}
name|s
index|[
name|NUM
index|]
name|__aligned
argument_list|(
literal|16
argument_list|)
init|=
block|{
literal|0x1p
operator|+
literal|0
block|,
literal|0x0p
operator|+
literal|0
block|,
literal|0x1
literal|.0163da9fb330p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|ab6c25335719bp
operator|-
literal|47
block|,
literal|0x1
literal|.02c9a3e77804p
operator|+
literal|0
block|,
literal|0x1
literal|.07737be56527cp
operator|-
literal|47
block|,
literal|0x1
literal|.04315e86e7f8p
operator|+
literal|0
block|,
literal|0x1
literal|.2f5ce3e688369p
operator|-
literal|50
block|,
literal|0x1
literal|.059b0d315854p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|a1d73e2a475b4p
operator|-
literal|47
block|,
literal|0x1
literal|.0706b29ddf6cp
operator|+
literal|0
block|,
literal|0x1
operator|.
name|dc6dc403a9d88p
operator|-
literal|48
block|,
literal|0x1
literal|.0874518759bcp
operator|+
literal|0
block|,
literal|0x1
literal|.01186be4bb285p
operator|-
literal|49
block|,
literal|0x1
literal|.09e3ecac6f38p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|a290f03062c27p
operator|-
literal|51
block|,
literal|0x1
literal|.0b5586cf9890p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|ec5317256e308p
operator|-
literal|49
block|,
literal|0x1
literal|.0cc922b7247cp
operator|+
literal|0
block|,
literal|0x1
operator|.
name|ba03db82dc49fp
operator|-
literal|47
block|,
literal|0x1
literal|.0e3ec32d3d18p
operator|+
literal|0
block|,
literal|0x1
literal|.10103a1727c58p
operator|-
literal|47
block|,
literal|0x1
literal|.0fb66affed30p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|af232091dd8a1p
operator|-
literal|48
block|,
literal|0x1
literal|.11301d0125b4p
operator|+
literal|0
block|,
literal|0x1
literal|.0a4ebbf1aed93p
operator|-
literal|48
block|,
literal|0x1
literal|.12abdc06c31cp
operator|+
literal|0
block|,
literal|0x1
literal|.7f72575a649adp
operator|-
literal|49
block|,
literal|0x1
literal|.1429aaea92dcp
operator|+
literal|0
block|,
literal|0x1
operator|.
name|fb34101943b26p
operator|-
literal|48
block|,
literal|0x1
literal|.15a98c8a58e4p
operator|+
literal|0
block|,
literal|0x1
literal|.12480d573dd56p
operator|-
literal|48
block|,
literal|0x1
literal|.172b83c7d514p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|d6e6fbe462876p
operator|-
literal|47
block|,
literal|0x1
literal|.18af9388c8dcp
operator|+
literal|0
block|,
literal|0x1
literal|.4dddfb85cd1e1p
operator|-
literal|47
block|,
literal|0x1
literal|.1a35beb6fcb4p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|a9e5b4c7b4969p
operator|-
literal|47
block|,
literal|0x1
literal|.1bbe084045ccp
operator|+
literal|0
block|,
literal|0x1
literal|.39ab1e72b4428p
operator|-
literal|48
block|,
literal|0x1
literal|.1d4873168b98p
operator|+
literal|0
block|,
literal|0x1
literal|.53c02dc0144c8p
operator|-
literal|47
block|,
literal|0x1
literal|.1ed5022fcd90p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|cb8819ff61122p
operator|-
literal|48
block|,
literal|0x1
literal|.2063b88628ccp
operator|+
literal|0
block|,
literal|0x1
literal|.63b8eeb029509p
operator|-
literal|48
block|,
literal|0x1
literal|.21f49917ddc8p
operator|+
literal|0
block|,
literal|0x1
literal|.62552fd29294cp
operator|-
literal|48
block|,
literal|0x1
literal|.2387a6e75620p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|c3360fd6d8e0bp
operator|-
literal|47
block|,
literal|0x1
literal|.251ce4fb2a60p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|f9ac155bef4f5p
operator|-
literal|47
block|,
literal|0x1
literal|.26b4565e27ccp
operator|+
literal|0
block|,
literal|0x1
operator|.
name|d257a673281d4p
operator|-
literal|48
block|,
literal|0x1
literal|.284dfe1f5638p
operator|+
literal|0
block|,
literal|0x1
literal|.2d9e2b9e07941p
operator|-
literal|53
block|,
literal|0x1
literal|.29e9df51fdecp
operator|+
literal|0
block|,
literal|0x1
literal|.09612e8afad12p
operator|-
literal|47
block|,
literal|0x1
literal|.2b87fd0dad98p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|ffbbd48ca71f9p
operator|-
literal|49
block|,
literal|0x1
literal|.2d285a6e4030p
operator|+
literal|0
block|,
literal|0x1
literal|.680123aa6da0fp
operator|-
literal|49
block|,
literal|0x1
literal|.2ecafa93e2f4p
operator|+
literal|0
block|,
literal|0x1
literal|.611ca0f45d524p
operator|-
literal|48
block|,
literal|0x1
literal|.306fe0a31b70p
operator|+
literal|0
block|,
literal|0x1
literal|.52de8d5a46306p
operator|-
literal|48
block|,
literal|0x1
literal|.32170fc4cd80p
operator|+
literal|0
block|,
literal|0x1
literal|.89a9ce78e1804p
operator|-
literal|47
block|,
literal|0x1
literal|.33c08b26416cp
operator|+
literal|0
block|,
literal|0x1
operator|.
name|fa64e43086cb3p
operator|-
literal|47
block|,
literal|0x1
literal|.356c55f929fcp
operator|+
literal|0
block|,
literal|0x1
literal|.864a311a3b1bap
operator|-
literal|47
block|,
literal|0x1
literal|.371a7373aa9cp
operator|+
literal|0
block|,
literal|0x1
literal|.54e28aa05e8a9p
operator|-
literal|49
block|,
literal|0x1
literal|.38cae6d05d84p
operator|+
literal|0
block|,
literal|0x1
literal|.2c2d4e586cdf7p
operator|-
literal|47
block|,
literal|0x1
literal|.3a7db34e59fcp
operator|+
literal|0
block|,
literal|0x1
operator|.
name|b750de494cf05p
operator|-
literal|47
block|,
literal|0x1
literal|.3c32dc313a8cp
operator|+
literal|0
block|,
literal|0x1
literal|.242000f9145acp
operator|-
literal|47
block|,
literal|0x1
literal|.3dea64c12340p
operator|+
literal|0
block|,
literal|0x1
literal|.11ada0911f09fp
operator|-
literal|47
block|,
literal|0x1
literal|.3fa4504ac800p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|ba0bf701aa418p
operator|-
literal|48
block|,
literal|0x1
literal|.4160a21f72e0p
operator|+
literal|0
block|,
literal|0x1
literal|.4fc2192dc79eep
operator|-
literal|47
block|,
literal|0x1
literal|.431f5d950a88p
operator|+
literal|0
block|,
literal|0x1
literal|.6dc704439410dp
operator|-
literal|48
block|,
literal|0x1
literal|.44e086061890p
operator|+
literal|0
block|,
literal|0x1
literal|.68189b7a04ef8p
operator|-
literal|47
block|,
literal|0x1
literal|.46a41ed1d004p
operator|+
literal|0
block|,
literal|0x1
literal|.772512f45922ap
operator|-
literal|48
block|,
literal|0x1
literal|.486a2b5c13ccp
operator|+
literal|0
block|,
literal|0x1
literal|.013c1a3b69063p
operator|-
literal|48
block|,
literal|0x1
literal|.4a32af0d7d3cp
operator|+
literal|0
block|,
literal|0x1
operator|.
name|e672d8bcf46f9p
operator|-
literal|48
block|,
literal|0x1
literal|.4bfdad5362a0p
operator|+
literal|0
block|,
literal|0x1
literal|.38ea1cbd7f621p
operator|-
literal|47
block|,
literal|0x1
literal|.4dcb299fddd0p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|ac766dde353c2p
operator|-
literal|49
block|,
literal|0x1
literal|.4f9b2769d2c8p
operator|+
literal|0
block|,
literal|0x1
literal|.35699ec5b4d50p
operator|-
literal|47
block|,
literal|0x1
literal|.516daa2cf664p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|c112f52c84d82p
operator|-
literal|52
block|,
literal|0x1
literal|.5342b569d4f8p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|df0a83c49d86ap
operator|-
literal|52
block|,
literal|0x1
literal|.551a4ca5d920p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|d8a5d8c40486ap
operator|-
literal|49
block|,
literal|0x1
literal|.56f4736b527cp
operator|+
literal|0
block|,
literal|0x1
operator|.
name|a66ecb004764fp
operator|-
literal|48
block|,
literal|0x1
literal|.58d12d497c7cp
operator|+
literal|0
block|,
literal|0x1
operator|.
name|e9295e15b9a1ep
operator|-
literal|47
block|,
literal|0x1
literal|.5ab07dd48540p
operator|+
literal|0
block|,
literal|0x1
literal|.4ac64980a8c8fp
operator|-
literal|47
block|,
literal|0x1
literal|.5c9268a59468p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|b80e258dc0b4cp
operator|-
literal|47
block|,
literal|0x1
literal|.5e76f15ad214p
operator|+
literal|0
block|,
literal|0x1
literal|.0dd37c9840733p
operator|-
literal|49
block|,
literal|0x1
literal|.605e1b976dc0p
operator|+
literal|0
block|,
literal|0x1
literal|.160edeb25490ep
operator|-
literal|49
block|,
literal|0x1
literal|.6247eb03a558p
operator|+
literal|0
block|,
literal|0x1
literal|.2c7c3e81bf4b7p
operator|-
literal|50
block|,
literal|0x1
literal|.6434634ccc30p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|fc76f8714c4eep
operator|-
literal|48
block|,
literal|0x1
literal|.662388255220p
operator|+
literal|0
block|,
literal|0x1
literal|.24893ecf14dc8p
operator|-
literal|47
block|,
literal|0x1
literal|.68155d44ca94p
operator|+
literal|0
block|,
literal|0x1
literal|.9840e2b913dd0p
operator|-
literal|47
block|,
literal|0x1
literal|.6a09e667f3bcp
operator|+
literal|0
block|,
literal|0x1
literal|.921165f626cddp
operator|-
literal|49
block|,
literal|0x1
literal|.6c012750bda8p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|f76bb54cc007ap
operator|-
literal|47
block|,
literal|0x1
literal|.6dfb23c651a0p
operator|+
literal|0
block|,
literal|0x1
literal|.779107165f0dep
operator|-
literal|47
block|,
literal|0x1
literal|.6ff7df951948p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|e7c3f0da79f11p
operator|-
literal|51
block|,
literal|0x1
literal|.71f75e8ec5f4p
operator|+
literal|0
block|,
literal|0x1
literal|.9ee91b8797785p
operator|-
literal|47
block|,
literal|0x1
literal|.73f9a48a5814p
operator|+
literal|0
block|,
literal|0x1
literal|.9deae4d273456p
operator|-
literal|47
block|,
literal|0x1
literal|.75feb564267cp
operator|+
literal|0
block|,
literal|0x1
literal|.17edd35467491p
operator|-
literal|49
block|,
literal|0x1
literal|.780694fde5d0p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|fb0cd7014042cp
operator|-
literal|47
block|,
literal|0x1
literal|.7a11473eb018p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|b5f54408fdb37p
operator|-
literal|50
block|,
literal|0x1
literal|.7c1ed0130c10p
operator|+
literal|0
block|,
literal|0x1
literal|.93e2499a22c9cp
operator|-
literal|47
block|,
literal|0x1
literal|.7e2f336cf4e4p
operator|+
literal|0
block|,
literal|0x1
literal|.1082e815d0abdp
operator|-
literal|47
block|,
literal|0x1
literal|.80427543e1a0p
operator|+
literal|0
block|,
literal|0x1
literal|.1b60de67649a3p
operator|-
literal|48
block|,
literal|0x1
literal|.82589994cce0p
operator|+
literal|0
block|,
literal|0x1
literal|.28acf88afab35p
operator|-
literal|48
block|,
literal|0x1
literal|.8471a4623c78p
operator|+
literal|0
block|,
literal|0x1
literal|.667297b5cbe32p
operator|-
literal|47
block|,
literal|0x1
literal|.868d99b4492cp
operator|+
literal|0
block|,
literal|0x1
literal|.640720ec85613p
operator|-
literal|47
block|,
literal|0x1
literal|.88ac7d98a668p
operator|+
literal|0
block|,
literal|0x1
literal|.966530bcdf2d5p
operator|-
literal|48
block|,
literal|0x1
literal|.8ace5422aa0cp
operator|+
literal|0
block|,
literal|0x1
operator|.
name|b5ba7c55a192dp
operator|-
literal|48
block|,
literal|0x1
literal|.8cf3216b5448p
operator|+
literal|0
block|,
literal|0x1
literal|.7de55439a2c39p
operator|-
literal|49
block|,
literal|0x1
literal|.8f1ae9915770p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|b15cc13a2e397p
operator|-
literal|47
block|,
literal|0x1
literal|.9145b0b91ffcp
operator|+
literal|0
block|,
literal|0x1
literal|.622986d1a7daep
operator|-
literal|50
block|,
literal|0x1
literal|.93737b0cdc5cp
operator|+
literal|0
block|,
literal|0x1
literal|.27a280e1f92a0p
operator|-
literal|47
block|,
literal|0x1
literal|.95a44cbc8520p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|dd36906d2b420p
operator|-
literal|49
block|,
literal|0x1
literal|.97d829fde4e4p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|f173d241f23d1p
operator|-
literal|49
block|,
literal|0x1
literal|.9a0f170ca078p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|cdd1884dc6234p
operator|-
literal|47
block|,
literal|0x1
literal|.9c49182a3f08p
operator|+
literal|0
block|,
literal|0x1
literal|.01c7c46b071f3p
operator|-
literal|48
block|,
literal|0x1
literal|.9e86319e3230p
operator|+
literal|0
block|,
literal|0x1
literal|.18c12653c7326p
operator|-
literal|47
block|,
literal|0x1
operator|.
name|a0c667b5de54p
operator|+
literal|0
block|,
literal|0x1
literal|.2594d6d45c656p
operator|-
literal|47
block|,
literal|0x1
operator|.
name|a309bec4a2d0p
operator|+
literal|0
block|,
literal|0x1
literal|.9ac60b8fbb86dp
operator|-
literal|47
block|,
literal|0x1
operator|.
name|a5503b23e254p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|c8b424491caf8p
operator|-
literal|48
block|,
literal|0x1
operator|.
name|a799e1330b34p
operator|+
literal|0
block|,
literal|0x1
literal|.86f2dfb2b158fp
operator|-
literal|48
block|,
literal|0x1
operator|.
name|a9e6b5579fd8p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|fa1f5921deffap
operator|-
literal|47
block|,
literal|0x1
operator|.
name|ac36bbfd3f34p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|ce06dcb351893p
operator|-
literal|47
block|,
literal|0x1
operator|.
name|ae89f995ad38p
operator|+
literal|0
block|,
literal|0x1
literal|.6af439a68bb99p
operator|-
literal|47
block|,
literal|0x1
operator|.
name|b0e07298db64p
operator|+
literal|0
block|,
literal|0x1
literal|.2c8421566fe38p
operator|-
literal|47
block|,
literal|0x1
operator|.
name|b33a2b84f15cp
operator|+
literal|0
block|,
literal|0x1
operator|.
name|d7b5fe873decap
operator|-
literal|47
block|,
literal|0x1
operator|.
name|b59728de5590p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|cc71c40888b24p
operator|-
literal|47
block|,
literal|0x1
operator|.
name|b7f76f2fb5e4p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|baa9ec206ad4fp
operator|-
literal|50
block|,
literal|0x1
operator|.
name|ba5b030a1064p
operator|+
literal|0
block|,
literal|0x1
literal|.30819678d5eb7p
operator|-
literal|49
block|,
literal|0x1
operator|.
name|bcc1e904bc1cp
operator|+
literal|0
block|,
literal|0x1
literal|.2247ba0f45b3dp
operator|-
literal|48
block|,
literal|0x1
operator|.
name|bf2c25bd71e0p
operator|+
literal|0
block|,
literal|0x1
literal|.10811ae04a31cp
operator|-
literal|49
block|,
literal|0x1
operator|.
name|c199bdd85528p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|c2220cb12a092p
operator|-
literal|48
block|,
literal|0x1
operator|.
name|c40ab5fffd04p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|d368a6fc1078cp
operator|-
literal|47
block|,
literal|0x1
operator|.
name|c67f12e57d14p
operator|+
literal|0
block|,
literal|0x1
literal|.694426ffa41e5p
operator|-
literal|49
block|,
literal|0x1
operator|.
name|c8f6d9406e78p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|a88d65e24402ep
operator|-
literal|47
block|,
literal|0x1
operator|.
name|cb720dcef904p
operator|+
literal|0
block|,
literal|0x1
literal|.48a81e5e8f4a5p
operator|-
literal|47
block|,
literal|0x1
operator|.
name|cdf0b555dc3cp
operator|+
literal|0
block|,
literal|0x1
operator|.
name|ce227c4ac7d63p
operator|-
literal|47
block|,
literal|0x1
operator|.
name|d072d4a07894p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|dc68791790d0bp
operator|-
literal|47
block|,
literal|0x1
operator|.
name|d2f87080d89cp
operator|+
literal|0
block|,
literal|0x1
literal|.8c56f091cc4f5p
operator|-
literal|47
block|,
literal|0x1
operator|.
name|d5818dcfba48p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|c976816bad9b8p
operator|-
literal|50
block|,
literal|0x1
operator|.
name|d80e316c9838p
operator|+
literal|0
block|,
literal|0x1
literal|.7bb84f9d04880p
operator|-
literal|48
block|,
literal|0x1
operator|.
name|da9e603db328p
operator|+
literal|0
block|,
literal|0x1
literal|.5c2300696db53p
operator|-
literal|50
block|,
literal|0x1
operator|.
name|dd321f301b44p
operator|+
literal|0
block|,
literal|0x1
literal|.025b4aef1e032p
operator|-
literal|47
block|,
literal|0x1
operator|.
name|dfc97337b9b4p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|eb968cac39ed3p
operator|-
literal|48
block|,
literal|0x1
operator|.
name|e264614f5a10p
operator|+
literal|0
block|,
literal|0x1
literal|.45093b0fd0bd7p
operator|-
literal|47
block|,
literal|0x1
operator|.
name|e502ee78b3fcp
operator|+
literal|0
block|,
literal|0x1
operator|.
name|b139e8980a9cdp
operator|-
literal|47
block|,
literal|0x1
operator|.
name|e7a51fbc74c8p
operator|+
literal|0
block|,
literal|0x1
operator|.
name|a5aa4594191bcp
operator|-
literal|51
block|,
literal|0x1
operator|.
name|ea4afa2a490cp
operator|+
literal|0
block|,
literal|0x1
literal|.9858f73a18f5ep
operator|-
literal|48
block|,
literal|0x1
operator|.
name|ecf482d8e67cp
operator|+
literal|0
block|,
literal|0x1
literal|.846d81897dca5p
operator|-
literal|47
block|,
literal|0x1
operator|.
name|efa1bee615a0p
operator|+
literal|0
block|,
literal|0x1
literal|.3bb8fe90d496dp
operator|-
literal|47
block|,
literal|0x1
operator|.
name|f252b376bba8p
operator|+
literal|0
block|,
literal|0x1
literal|.74e8696fc3639p
operator|-
literal|48
block|,
literal|0x1
operator|.
name|f50765b6e454p
operator|+
literal|0
block|,
literal|0x1
literal|.9d3e12dd8a18bp
operator|-
literal|54
block|,
literal|0x1
operator|.
name|f7bfdad9cbe0p
operator|+
literal|0
block|,
literal|0x1
literal|.38913b4bfe72cp
operator|-
literal|48
block|,
literal|0x1
operator|.
name|fa7c1819e90cp
operator|+
literal|0
block|,
literal|0x1
literal|.82e90a7e74b26p
operator|-
literal|48
block|,
literal|0x1
operator|.
name|fd3c22b8f71cp
operator|+
literal|0
block|,
literal|0x1
literal|.884badd25995ep
operator|-
literal|47
block|}
struct|;
end_struct

begin_function
name|long
name|double
name|expl
parameter_list|(
name|long
name|double
name|x
parameter_list|)
block|{
name|union
name|IEEEl2bits
name|u
decl_stmt|,
name|v
decl_stmt|;
name|long
name|double
name|fn
decl_stmt|,
name|r
decl_stmt|,
name|r1
decl_stmt|,
name|r2
decl_stmt|,
name|q
decl_stmt|,
name|t
decl_stmt|,
name|t23
decl_stmt|,
name|t45
decl_stmt|,
name|twopk
decl_stmt|,
name|twopkp10000
decl_stmt|,
name|z
decl_stmt|;
name|int
name|k
decl_stmt|,
name|n
decl_stmt|,
name|n2
decl_stmt|;
name|uint16_t
name|hx
decl_stmt|,
name|ix
decl_stmt|;
comment|/* Filter out exceptional cases. */
name|u
operator|.
name|e
operator|=
name|x
expr_stmt|;
name|hx
operator|=
name|u
operator|.
name|xbits
operator|.
name|expsign
expr_stmt|;
name|ix
operator|=
name|hx
operator|&
literal|0x7fff
expr_stmt|;
if|if
condition|(
name|ix
operator|>=
name|BIAS
operator|+
literal|13
condition|)
block|{
comment|/* |x|>= 8192 or x is NaN */
if|if
condition|(
name|ix
operator|==
name|BIAS
operator|+
name|LDBL_MAX_EXP
condition|)
block|{
if|if
condition|(
name|hx
operator|&
literal|0x8000
operator|&&
name|u
operator|.
name|xbits
operator|.
name|man
operator|==
literal|1ULL
operator|<<
literal|63
condition|)
return|return
operator|(
literal|0.0L
operator|)
return|;
comment|/* x is -Inf */
return|return
operator|(
name|x
operator|+
name|x
operator|)
return|;
comment|/* x is +Inf, NaN or unsupported */
block|}
if|if
condition|(
name|x
operator|>
name|o_threshold
operator|.
name|e
condition|)
return|return
operator|(
name|huge
operator|*
name|huge
operator|)
return|;
if|if
condition|(
name|x
operator|<
name|u_threshold
operator|.
name|e
condition|)
return|return
operator|(
name|tiny
operator|*
name|tiny
operator|)
return|;
block|}
elseif|else
if|if
condition|(
name|ix
operator|<=
name|BIAS
operator|-
literal|34
condition|)
block|{
comment|/* |x|< 0x1p-33 */
comment|/* includes pseudo-denormals */
if|if
condition|(
name|huge
operator|+
name|x
operator|>
literal|1.0L
condition|)
comment|/* trigger inexact iff x != 0 */
return|return
operator|(
literal|1.0L
operator|+
name|x
operator|)
return|;
block|}
name|ENTERI
argument_list|()
expr_stmt|;
comment|/* Reduce x to (k*ln2 + midpoint[n2] + r1 + r2). */
comment|/* Use a specialized rint() to get fn.  Assume round-to-nearest. */
name|fn
operator|=
name|x
operator|*
name|INV_L
operator|+
literal|0x1
literal|.8p63
operator|-
literal|0x1
literal|.8p63
expr_stmt|;
name|r
operator|=
name|x
operator|-
name|fn
operator|*
name|L1
operator|-
name|fn
operator|*
name|L2
expr_stmt|;
comment|/* r = r1 + r2 done independently. */
if|#
directive|if
name|defined
argument_list|(
name|HAVE_EFFICIENT_IRINTL
argument_list|)
name|n
operator|=
name|irintl
argument_list|(
name|fn
argument_list|)
expr_stmt|;
elif|#
directive|elif
name|defined
argument_list|(
name|HAVE_EFFICIENT_IRINT
argument_list|)
name|n
operator|=
name|irint
argument_list|(
name|fn
argument_list|)
expr_stmt|;
else|#
directive|else
name|n
operator|=
operator|(
name|int
operator|)
name|fn
expr_stmt|;
endif|#
directive|endif
name|n2
operator|=
operator|(
name|unsigned
operator|)
name|n
operator|%
name|NUM
expr_stmt|;
comment|/* Tang's j. */
name|k
operator|=
operator|(
name|n
operator|-
name|n2
operator|)
operator|/
name|NUM
expr_stmt|;
name|r1
operator|=
name|x
operator|-
name|fn
operator|*
name|L1
expr_stmt|;
name|r2
operator|=
operator|-
name|fn
operator|*
name|L2
expr_stmt|;
comment|/* Prepare scale factors. */
name|v
operator|.
name|xbits
operator|.
name|man
operator|=
literal|1ULL
operator|<<
literal|63
expr_stmt|;
if|if
condition|(
name|k
operator|>=
name|LDBL_MIN_EXP
condition|)
block|{
name|v
operator|.
name|xbits
operator|.
name|expsign
operator|=
name|BIAS
operator|+
name|k
expr_stmt|;
name|twopk
operator|=
name|v
operator|.
name|e
expr_stmt|;
block|}
else|else
block|{
name|v
operator|.
name|xbits
operator|.
name|expsign
operator|=
name|BIAS
operator|+
name|k
operator|+
literal|10000
expr_stmt|;
name|twopkp10000
operator|=
name|v
operator|.
name|e
expr_stmt|;
block|}
comment|/* Evaluate expl(midpoint[n2] + r1 + r2) = s[n2] * expl(r1 + r2). */
comment|/* Here q = q(r), not q(r1), since r1 is lopped like L1. */
name|t45
operator|=
name|r
operator|*
name|P5
operator|+
name|P4
expr_stmt|;
name|z
operator|=
name|r
operator|*
name|r
expr_stmt|;
name|t23
operator|=
name|r
operator|*
name|P3
operator|+
name|P2
expr_stmt|;
name|q
operator|=
name|r2
operator|+
name|z
operator|*
name|t23
operator|+
name|z
operator|*
name|z
operator|*
name|t45
operator|+
name|z
operator|*
name|z
operator|*
name|z
operator|*
name|P6
expr_stmt|;
name|t
operator|=
operator|(
name|long
name|double
operator|)
name|s
index|[
name|n2
index|]
operator|.
name|lo
operator|+
name|s
index|[
name|n2
index|]
operator|.
name|hi
expr_stmt|;
name|t
operator|=
name|s
index|[
name|n2
index|]
operator|.
name|lo
operator|+
name|t
operator|*
operator|(
name|q
operator|+
name|r1
operator|)
operator|+
name|s
index|[
name|n2
index|]
operator|.
name|hi
expr_stmt|;
comment|/* Scale by 2**k. */
if|if
condition|(
name|k
operator|>=
name|LDBL_MIN_EXP
condition|)
block|{
if|if
condition|(
name|k
operator|==
name|LDBL_MAX_EXP
condition|)
name|RETURNI
argument_list|(
name|t
operator|*
literal|2.0L
operator|*
literal|0x1p16383L
argument_list|)
expr_stmt|;
name|RETURNI
argument_list|(
name|t
operator|*
name|twopk
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|RETURNI
argument_list|(
name|t
operator|*
name|twopkp10000
operator|*
name|twom10000
argument_list|)
expr_stmt|;
block|}
block|}
end_function

end_unit

