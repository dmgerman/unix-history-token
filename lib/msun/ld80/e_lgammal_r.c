begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* @(#)e_lgamma_r.c 1.3 95/01/18 */
end_comment

begin_comment
comment|/*  * ====================================================  * Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  *  * Developed at SunSoft, a Sun Microsystems, Inc. business.  * Permission to use, copy, modify, and distribute this  * software is freely granted, provided that this notice  * is preserved.  * ====================================================  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_comment
comment|/*  * See e_lgamma_r.c for complete comments.  *  * Converted to long double by Steven G. Kargl.  */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|__i386__
end_ifdef

begin_include
include|#
directive|include
file|<ieeefp.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|"fpmath.h"
end_include

begin_include
include|#
directive|include
file|"math.h"
end_include

begin_include
include|#
directive|include
file|"math_private.h"
end_include

begin_decl_stmt
specifier|static
specifier|const
specifier|volatile
name|double
name|vzero
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|double
name|zero
init|=
literal|0
decl_stmt|,
name|half
init|=
literal|0.5
decl_stmt|,
name|one
init|=
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|union
name|IEEEl2bits
name|piu
init|=
name|LD80C
argument_list|(
literal|0xc90fdaa22168c235
argument_list|,
literal|1
argument_list|,
literal|3.14159265358979323851e+00L
argument_list|)
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|pi
value|(piu.e)
end_define

begin_comment
comment|/*  * Domain y in [0x1p-70, 0.27], range ~[-4.5264e-22, 4.5264e-22]:  * |(lgamma(2 - y) + y / 2) / y - a(y)|< 2**-70.9  */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|union
name|IEEEl2bits
name|a0u
init|=
name|LD80C
argument_list|(
literal|0x9e233f1bed863d26
argument_list|,
operator|-
literal|4
argument_list|,
literal|7.72156649015328606028e-02L
argument_list|)
decl_stmt|,
name|a1u
init|=
name|LD80C
argument_list|(
literal|0xa51a6625307d3249
argument_list|,
operator|-
literal|2
argument_list|,
literal|3.22467033424113218889e-01L
argument_list|)
decl_stmt|,
name|a2u
init|=
name|LD80C
argument_list|(
literal|0x89f000d2abafda8c
argument_list|,
operator|-
literal|4
argument_list|,
literal|6.73523010531979398946e-02L
argument_list|)
decl_stmt|,
name|a3u
init|=
name|LD80C
argument_list|(
literal|0xa8991563eca75f26
argument_list|,
operator|-
literal|6
argument_list|,
literal|2.05808084277991211934e-02L
argument_list|)
decl_stmt|,
name|a4u
init|=
name|LD80C
argument_list|(
literal|0xf2027e10634ce6b6
argument_list|,
operator|-
literal|8
argument_list|,
literal|7.38555102796070454026e-03L
argument_list|)
decl_stmt|,
name|a5u
init|=
name|LD80C
argument_list|(
literal|0xbd6eb76dd22187f4
argument_list|,
operator|-
literal|9
argument_list|,
literal|2.89051035162703932972e-03L
argument_list|)
decl_stmt|,
name|a6u
init|=
name|LD80C
argument_list|(
literal|0x9c562ab05e0458ed
argument_list|,
operator|-
literal|10
argument_list|,
literal|1.19275351624639999297e-03L
argument_list|)
decl_stmt|,
name|a7u
init|=
name|LD80C
argument_list|(
literal|0x859baed93ee48e46
argument_list|,
operator|-
literal|11
argument_list|,
literal|5.09674593842117925320e-04L
argument_list|)
decl_stmt|,
name|a8u
init|=
name|LD80C
argument_list|(
literal|0xe9f28a4432949af2
argument_list|,
operator|-
literal|13
argument_list|,
literal|2.23109648015769155122e-04L
argument_list|)
decl_stmt|,
name|a9u
init|=
name|LD80C
argument_list|(
literal|0xd12ad0d9b93c6bb0
argument_list|,
operator|-
literal|14
argument_list|,
literal|9.97387167479808509830e-05L
argument_list|)
decl_stmt|,
name|a10u
init|=
name|LD80C
argument_list|(
literal|0xb7522643c78a219b
argument_list|,
operator|-
literal|15
argument_list|,
literal|4.37071076331030136818e-05L
argument_list|)
decl_stmt|,
name|a11u
init|=
name|LD80C
argument_list|(
literal|0xca024dcdece2cb79
argument_list|,
operator|-
literal|16
argument_list|,
literal|2.40813493372040143061e-05L
argument_list|)
decl_stmt|,
name|a12u
init|=
name|LD80C
argument_list|(
literal|0xbb90fb6968ebdbf9
argument_list|,
operator|-
literal|19
argument_list|,
literal|2.79495621083634031729e-06L
argument_list|)
decl_stmt|,
name|a13u
init|=
name|LD80C
argument_list|(
literal|0xba1c9ffeeae07b37
argument_list|,
operator|-
literal|17
argument_list|,
literal|1.10931287015513924136e-05L
argument_list|)
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|a0
value|(a0u.e)
end_define

begin_define
define|#
directive|define
name|a1
value|(a1u.e)
end_define

begin_define
define|#
directive|define
name|a2
value|(a2u.e)
end_define

begin_define
define|#
directive|define
name|a3
value|(a3u.e)
end_define

begin_define
define|#
directive|define
name|a4
value|(a4u.e)
end_define

begin_define
define|#
directive|define
name|a5
value|(a5u.e)
end_define

begin_define
define|#
directive|define
name|a6
value|(a6u.e)
end_define

begin_define
define|#
directive|define
name|a7
value|(a7u.e)
end_define

begin_define
define|#
directive|define
name|a8
value|(a8u.e)
end_define

begin_define
define|#
directive|define
name|a9
value|(a9u.e)
end_define

begin_define
define|#
directive|define
name|a10
value|(a10u.e)
end_define

begin_define
define|#
directive|define
name|a11
value|(a11u.e)
end_define

begin_define
define|#
directive|define
name|a12
value|(a12u.e)
end_define

begin_define
define|#
directive|define
name|a13
value|(a13u.e)
end_define

begin_comment
comment|/*  * Domain x in [tc-0.24, tc+0.28], range ~[-6.1205e-22, 6.1205e-22]:  * |(lgamma(x) - tf) -  t(x - tc)|< 2**-70.5  */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|union
name|IEEEl2bits
name|tcu
init|=
name|LD80C
argument_list|(
literal|0xbb16c31ab5f1fb71
argument_list|,
literal|0
argument_list|,
literal|1.46163214496836234128e+00L
argument_list|)
decl_stmt|,
name|tfu
init|=
name|LD80C
argument_list|(
literal|0xf8cdcde61c520e0f
argument_list|,
operator|-
literal|4
argument_list|,
operator|-
literal|1.21486290535849608093e-01L
argument_list|)
decl_stmt|,
name|ttu
init|=
name|LD80C
argument_list|(
literal|0xd46ee54b27d4de99
argument_list|,
operator|-
literal|69
argument_list|,
operator|-
literal|2.81152980996018785880e-21L
argument_list|)
decl_stmt|,
name|t0u
init|=
name|LD80C
argument_list|(
literal|0x80b9406556a62a6b
argument_list|,
operator|-
literal|68
argument_list|,
literal|3.40728634996055147231e-21L
argument_list|)
decl_stmt|,
name|t1u
init|=
name|LD80C
argument_list|(
literal|0xc7e9c6f6df3f8c39
argument_list|,
operator|-
literal|67
argument_list|,
operator|-
literal|1.05833162742737073665e-20L
argument_list|)
decl_stmt|,
name|t2u
init|=
name|LD80C
argument_list|(
literal|0xf7b95e4771c55d51
argument_list|,
operator|-
literal|2
argument_list|,
literal|4.83836122723810583532e-01L
argument_list|)
decl_stmt|,
name|t3u
init|=
name|LD80C
argument_list|(
literal|0x97213c6e35e119ff
argument_list|,
operator|-
literal|3
argument_list|,
operator|-
literal|1.47587722994530691476e-01L
argument_list|)
decl_stmt|,
name|t4u
init|=
name|LD80C
argument_list|(
literal|0x845a14a6a81dc94b
argument_list|,
operator|-
literal|4
argument_list|,
literal|6.46249402389135358063e-02L
argument_list|)
decl_stmt|,
name|t5u
init|=
name|LD80C
argument_list|(
literal|0x864d46fa89997796
argument_list|,
operator|-
literal|5
argument_list|,
operator|-
literal|3.27885410884846056084e-02L
argument_list|)
decl_stmt|,
name|t6u
init|=
name|LD80C
argument_list|(
literal|0x93373cbd00297438
argument_list|,
operator|-
literal|6
argument_list|,
literal|1.79706751150707171293e-02L
argument_list|)
decl_stmt|,
name|t7u
init|=
name|LD80C
argument_list|(
literal|0xa8fcfca7eddc8d1d
argument_list|,
operator|-
literal|7
argument_list|,
operator|-
literal|1.03142230361450732547e-02L
argument_list|)
decl_stmt|,
name|t8u
init|=
name|LD80C
argument_list|(
literal|0xc7e7015ff4bc45af
argument_list|,
operator|-
literal|8
argument_list|,
literal|6.10053603296546099193e-03L
argument_list|)
decl_stmt|,
name|t9u
init|=
name|LD80C
argument_list|(
literal|0xf178d2247adc5093
argument_list|,
operator|-
literal|9
argument_list|,
operator|-
literal|3.68456964904901200152e-03L
argument_list|)
decl_stmt|,
name|t10u
init|=
name|LD80C
argument_list|(
literal|0x94188d58f12e5e9f
argument_list|,
operator|-
literal|9
argument_list|,
literal|2.25976420273774583089e-03L
argument_list|)
decl_stmt|,
name|t11u
init|=
name|LD80C
argument_list|(
literal|0xb7cbaef14e1406f1
argument_list|,
operator|-
literal|10
argument_list|,
operator|-
literal|1.40224943666225639823e-03L
argument_list|)
decl_stmt|,
name|t12u
init|=
name|LD80C
argument_list|(
literal|0xe63a671e6704ea4d
argument_list|,
operator|-
literal|11
argument_list|,
literal|8.78250640744776944887e-04L
argument_list|)
decl_stmt|,
name|t13u
init|=
name|LD80C
argument_list|(
literal|0x914b6c9cae61783e
argument_list|,
operator|-
literal|11
argument_list|,
operator|-
literal|5.54255012657716808811e-04L
argument_list|)
decl_stmt|,
name|t14u
init|=
name|LD80C
argument_list|(
literal|0xb858f5bdb79276fe
argument_list|,
operator|-
literal|12
argument_list|,
literal|3.51614951536825927370e-04L
argument_list|)
decl_stmt|,
name|t15u
init|=
name|LD80C
argument_list|(
literal|0xea73e744c34b9591
argument_list|,
operator|-
literal|13
argument_list|,
operator|-
literal|2.23591563824520112236e-04L
argument_list|)
decl_stmt|,
name|t16u
init|=
name|LD80C
argument_list|(
literal|0x99aeabb0d67ba835
argument_list|,
operator|-
literal|13
argument_list|,
literal|1.46562869351659194136e-04L
argument_list|)
decl_stmt|,
name|t17u
init|=
name|LD80C
argument_list|(
literal|0xd7c6938325db2024
argument_list|,
operator|-
literal|14
argument_list|,
operator|-
literal|1.02889866046435680588e-04L
argument_list|)
decl_stmt|,
name|t18u
init|=
name|LD80C
argument_list|(
literal|0xe24cb1e3b0474775
argument_list|,
operator|-
literal|15
argument_list|,
literal|5.39540265505221957652e-05L
argument_list|)
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|tc
value|(tcu.e)
end_define

begin_define
define|#
directive|define
name|tf
value|(tfu.e)
end_define

begin_define
define|#
directive|define
name|tt
value|(ttu.e)
end_define

begin_define
define|#
directive|define
name|t0
value|(t0u.e)
end_define

begin_define
define|#
directive|define
name|t1
value|(t1u.e)
end_define

begin_define
define|#
directive|define
name|t2
value|(t2u.e)
end_define

begin_define
define|#
directive|define
name|t3
value|(t3u.e)
end_define

begin_define
define|#
directive|define
name|t4
value|(t4u.e)
end_define

begin_define
define|#
directive|define
name|t5
value|(t5u.e)
end_define

begin_define
define|#
directive|define
name|t6
value|(t6u.e)
end_define

begin_define
define|#
directive|define
name|t7
value|(t7u.e)
end_define

begin_define
define|#
directive|define
name|t8
value|(t8u.e)
end_define

begin_define
define|#
directive|define
name|t9
value|(t9u.e)
end_define

begin_define
define|#
directive|define
name|t10
value|(t10u.e)
end_define

begin_define
define|#
directive|define
name|t11
value|(t11u.e)
end_define

begin_define
define|#
directive|define
name|t12
value|(t12u.e)
end_define

begin_define
define|#
directive|define
name|t13
value|(t13u.e)
end_define

begin_define
define|#
directive|define
name|t14
value|(t14u.e)
end_define

begin_define
define|#
directive|define
name|t15
value|(t15u.e)
end_define

begin_define
define|#
directive|define
name|t16
value|(t16u.e)
end_define

begin_define
define|#
directive|define
name|t17
value|(t17u.e)
end_define

begin_define
define|#
directive|define
name|t18
value|(t18u.e)
end_define

begin_comment
comment|/*  * Domain y in [-0.1, 0.232], range ~[-8.1938e-22, 8.3815e-22]:  * |(lgamma(1 + y) + 0.5 * y) / y - u(y) / v(y)|< 2**-71.2  */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|union
name|IEEEl2bits
name|u0u
init|=
name|LD80C
argument_list|(
literal|0x9e233f1bed863d27
argument_list|,
operator|-
literal|4
argument_list|,
operator|-
literal|7.72156649015328606095e-02L
argument_list|)
decl_stmt|,
name|u1u
init|=
name|LD80C
argument_list|(
literal|0x98280ee45e4ddd3d
argument_list|,
operator|-
literal|1
argument_list|,
literal|5.94361239198682739769e-01L
argument_list|)
decl_stmt|,
name|u2u
init|=
name|LD80C
argument_list|(
literal|0xe330c8ead4130733
argument_list|,
literal|0
argument_list|,
literal|1.77492629495841234275e+00L
argument_list|)
decl_stmt|,
name|u3u
init|=
name|LD80C
argument_list|(
literal|0xd4a213f1a002ec52
argument_list|,
literal|0
argument_list|,
literal|1.66119622514818078064e+00L
argument_list|)
decl_stmt|,
name|u4u
init|=
name|LD80C
argument_list|(
literal|0xa5a9ca6f5bc62163
argument_list|,
operator|-
literal|1
argument_list|,
literal|6.47122051417476492989e-01L
argument_list|)
decl_stmt|,
name|u5u
init|=
name|LD80C
argument_list|(
literal|0xc980e49cd5b019e6
argument_list|,
operator|-
literal|4
argument_list|,
literal|9.83903751718671509455e-02L
argument_list|)
decl_stmt|,
name|u6u
init|=
name|LD80C
argument_list|(
literal|0xff636a8bdce7025b
argument_list|,
operator|-
literal|9
argument_list|,
literal|3.89691687802305743450e-03L
argument_list|)
decl_stmt|,
name|v1u
init|=
name|LD80C
argument_list|(
literal|0xbd109c533a19fbf5
argument_list|,
literal|1
argument_list|,
literal|2.95413883330948556544e+00L
argument_list|)
decl_stmt|,
name|v2u
init|=
name|LD80C
argument_list|(
literal|0xd295cbf96f31f099
argument_list|,
literal|1
argument_list|,
literal|3.29039286955665403176e+00L
argument_list|)
decl_stmt|,
name|v3u
init|=
name|LD80C
argument_list|(
literal|0xdab8bcfee40496cb
argument_list|,
literal|0
argument_list|,
literal|1.70876276441416471410e+00L
argument_list|)
decl_stmt|,
name|v4u
init|=
name|LD80C
argument_list|(
literal|0xd2f2dc3638567e9f
argument_list|,
operator|-
literal|2
argument_list|,
literal|4.12009126299534668571e-01L
argument_list|)
decl_stmt|,
name|v5u
init|=
name|LD80C
argument_list|(
literal|0xa07d9b0851070f41
argument_list|,
operator|-
literal|5
argument_list|,
literal|3.91822868305682491442e-02L
argument_list|)
decl_stmt|,
name|v6u
init|=
name|LD80C
argument_list|(
literal|0xe3cd8318f7adb2c4
argument_list|,
operator|-
literal|11
argument_list|,
literal|8.68998648222144351114e-04L
argument_list|)
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|u0
value|(u0u.e)
end_define

begin_define
define|#
directive|define
name|u1
value|(u1u.e)
end_define

begin_define
define|#
directive|define
name|u2
value|(u2u.e)
end_define

begin_define
define|#
directive|define
name|u3
value|(u3u.e)
end_define

begin_define
define|#
directive|define
name|u4
value|(u4u.e)
end_define

begin_define
define|#
directive|define
name|u5
value|(u5u.e)
end_define

begin_define
define|#
directive|define
name|u6
value|(u6u.e)
end_define

begin_define
define|#
directive|define
name|v1
value|(v1u.e)
end_define

begin_define
define|#
directive|define
name|v2
value|(v2u.e)
end_define

begin_define
define|#
directive|define
name|v3
value|(v3u.e)
end_define

begin_define
define|#
directive|define
name|v4
value|(v4u.e)
end_define

begin_define
define|#
directive|define
name|v5
value|(v5u.e)
end_define

begin_define
define|#
directive|define
name|v6
value|(v6u.e)
end_define

begin_comment
comment|/*  * Domain x in (2, 3], range ~[-3.3648e-22, 3.4416e-22]:  * |(lgamma(y+2) - 0.5 * y) / y - s(y)/r(y)|< 2**-72.3  * with y = x - 2.  */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|union
name|IEEEl2bits
name|s0u
init|=
name|LD80C
argument_list|(
literal|0x9e233f1bed863d27
argument_list|,
operator|-
literal|4
argument_list|,
operator|-
literal|7.72156649015328606095e-02L
argument_list|)
decl_stmt|,
name|s1u
init|=
name|LD80C
argument_list|(
literal|0xd3ff0dcc7fa91f94
argument_list|,
operator|-
literal|3
argument_list|,
literal|2.07027640921219389860e-01L
argument_list|)
decl_stmt|,
name|s2u
init|=
name|LD80C
argument_list|(
literal|0xb2bb62782478ef31
argument_list|,
operator|-
literal|2
argument_list|,
literal|3.49085881391362090549e-01L
argument_list|)
decl_stmt|,
name|s3u
init|=
name|LD80C
argument_list|(
literal|0xb49f7438c4611a74
argument_list|,
operator|-
literal|3
argument_list|,
literal|1.76389518704213357954e-01L
argument_list|)
decl_stmt|,
name|s4u
init|=
name|LD80C
argument_list|(
literal|0x9a957008fa27ecf9
argument_list|,
operator|-
literal|5
argument_list|,
literal|3.77401710862930008071e-02L
argument_list|)
decl_stmt|,
name|s5u
init|=
name|LD80C
argument_list|(
literal|0xda9b389a6ca7a7ac
argument_list|,
operator|-
literal|9
argument_list|,
literal|3.33566791452943399399e-03L
argument_list|)
decl_stmt|,
name|s6u
init|=
name|LD80C
argument_list|(
literal|0xbc7a2263faf59c14
argument_list|,
operator|-
literal|14
argument_list|,
literal|8.98728786745638844395e-05L
argument_list|)
decl_stmt|,
name|r1u
init|=
name|LD80C
argument_list|(
literal|0xbf5cff5b11477d4d
argument_list|,
literal|0
argument_list|,
literal|1.49502555796294337722e+00L
argument_list|)
decl_stmt|,
name|r2u
init|=
name|LD80C
argument_list|(
literal|0xd9aec89de08e3da6
argument_list|,
operator|-
literal|1
argument_list|,
literal|8.50323236984473285866e-01L
argument_list|)
decl_stmt|,
name|r3u
init|=
name|LD80C
argument_list|(
literal|0xeab7ae5057c443f9
argument_list|,
operator|-
literal|3
argument_list|,
literal|2.29216312078225806131e-01L
argument_list|)
decl_stmt|,
name|r4u
init|=
name|LD80C
argument_list|(
literal|0xf29707d9bd2b1e37
argument_list|,
operator|-
literal|6
argument_list|,
literal|2.96130326586640089145e-02L
argument_list|)
decl_stmt|,
name|r5u
init|=
name|LD80C
argument_list|(
literal|0xd376c2f09736c5a3
argument_list|,
operator|-
literal|10
argument_list|,
literal|1.61334161411590662495e-03L
argument_list|)
decl_stmt|,
name|r6u
init|=
name|LD80C
argument_list|(
literal|0xc985983d0cd34e3d
argument_list|,
operator|-
literal|16
argument_list|,
literal|2.40232770710953450636e-05L
argument_list|)
decl_stmt|,
name|r7u
init|=
name|LD80C
argument_list|(
literal|0xe5c7a4f7fc2ef13d
argument_list|,
operator|-
literal|25
argument_list|,
operator|-
literal|5.34997929289167573510e-08L
argument_list|)
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|s0
value|(s0u.e)
end_define

begin_define
define|#
directive|define
name|s1
value|(s1u.e)
end_define

begin_define
define|#
directive|define
name|s2
value|(s2u.e)
end_define

begin_define
define|#
directive|define
name|s3
value|(s3u.e)
end_define

begin_define
define|#
directive|define
name|s4
value|(s4u.e)
end_define

begin_define
define|#
directive|define
name|s5
value|(s5u.e)
end_define

begin_define
define|#
directive|define
name|s6
value|(s6u.e)
end_define

begin_define
define|#
directive|define
name|r1
value|(r1u.e)
end_define

begin_define
define|#
directive|define
name|r2
value|(r2u.e)
end_define

begin_define
define|#
directive|define
name|r3
value|(r3u.e)
end_define

begin_define
define|#
directive|define
name|r4
value|(r4u.e)
end_define

begin_define
define|#
directive|define
name|r5
value|(r5u.e)
end_define

begin_define
define|#
directive|define
name|r6
value|(r6u.e)
end_define

begin_define
define|#
directive|define
name|r7
value|(r7u.e)
end_define

begin_comment
comment|/*  * Domain z in [8, 0x1p70], range ~[-3.0235e-22, 3.0563e-22]:  * |lgamma(x) - (x - 0.5) * (log(x) - 1) - w(1/x)|< 2**-71.7  */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|union
name|IEEEl2bits
name|w0u
init|=
name|LD80C
argument_list|(
literal|0xd67f1c864beb4a69
argument_list|,
operator|-
literal|2
argument_list|,
literal|4.18938533204672741776e-01L
argument_list|)
decl_stmt|,
name|w1u
init|=
name|LD80C
argument_list|(
literal|0xaaaaaaaaaaaaaaa1
argument_list|,
operator|-
literal|4
argument_list|,
literal|8.33333333333333332678e-02L
argument_list|)
decl_stmt|,
name|w2u
init|=
name|LD80C
argument_list|(
literal|0xb60b60b60b5491c9
argument_list|,
operator|-
literal|9
argument_list|,
operator|-
literal|2.77777777777760927870e-03L
argument_list|)
decl_stmt|,
name|w3u
init|=
name|LD80C
argument_list|(
literal|0xd00d00cf58aede4c
argument_list|,
operator|-
literal|11
argument_list|,
literal|7.93650793490637233668e-04L
argument_list|)
decl_stmt|,
name|w4u
init|=
name|LD80C
argument_list|(
literal|0x9c09bf626783d4a5
argument_list|,
operator|-
literal|11
argument_list|,
operator|-
literal|5.95238023926039051268e-04L
argument_list|)
decl_stmt|,
name|w5u
init|=
name|LD80C
argument_list|(
literal|0xdca7cadc5baa517b
argument_list|,
operator|-
literal|11
argument_list|,
literal|8.41733700408000822962e-04L
argument_list|)
decl_stmt|,
name|w6u
init|=
name|LD80C
argument_list|(
literal|0xfb060e361e1ffd07
argument_list|,
operator|-
literal|10
argument_list|,
operator|-
literal|1.91515849570245136604e-03L
argument_list|)
decl_stmt|,
name|w7u
init|=
name|LD80C
argument_list|(
literal|0xcbd5101bb58d1f2b
argument_list|,
operator|-
literal|8
argument_list|,
literal|6.22046743903262649294e-03L
argument_list|)
decl_stmt|,
name|w8u
init|=
name|LD80C
argument_list|(
literal|0xad27a668d32c821b
argument_list|,
operator|-
literal|6
argument_list|,
operator|-
literal|2.11370706734662081843e-02L
argument_list|)
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|w0
value|(w0u.e)
end_define

begin_define
define|#
directive|define
name|w1
value|(w1u.e)
end_define

begin_define
define|#
directive|define
name|w2
value|(w2u.e)
end_define

begin_define
define|#
directive|define
name|w3
value|(w3u.e)
end_define

begin_define
define|#
directive|define
name|w4
value|(w4u.e)
end_define

begin_define
define|#
directive|define
name|w5
value|(w5u.e)
end_define

begin_define
define|#
directive|define
name|w6
value|(w6u.e)
end_define

begin_define
define|#
directive|define
name|w7
value|(w7u.e)
end_define

begin_define
define|#
directive|define
name|w8
value|(w8u.e)
end_define

begin_function
specifier|static
name|long
name|double
name|sin_pil
parameter_list|(
name|long
name|double
name|x
parameter_list|)
block|{
specifier|volatile
name|long
name|double
name|vz
decl_stmt|;
name|long
name|double
name|y
decl_stmt|,
name|z
decl_stmt|;
name|uint64_t
name|n
decl_stmt|;
name|uint16_t
name|hx
decl_stmt|;
name|y
operator|=
operator|-
name|x
expr_stmt|;
name|vz
operator|=
name|y
operator|+
literal|0x1p63
expr_stmt|;
name|z
operator|=
name|vz
operator|-
literal|0x1p63
expr_stmt|;
if|if
condition|(
name|z
operator|==
name|y
condition|)
return|return
name|zero
return|;
name|vz
operator|=
name|y
operator|+
literal|0x1p61
expr_stmt|;
name|EXTRACT_LDBL80_WORDS
argument_list|(
name|hx
argument_list|,
name|n
argument_list|,
name|vz
argument_list|)
expr_stmt|;
name|z
operator|=
name|vz
operator|-
literal|0x1p61
expr_stmt|;
if|if
condition|(
name|z
operator|>
name|y
condition|)
block|{
name|z
operator|-=
literal|0.25
expr_stmt|;
comment|/* adjust to round down */
name|n
operator|--
expr_stmt|;
block|}
name|n
operator|&=
literal|7
expr_stmt|;
comment|/* octant of y mod 2 */
name|y
operator|=
name|y
operator|-
name|z
operator|+
name|n
operator|*
literal|0.25
expr_stmt|;
comment|/* y mod 2 */
switch|switch
condition|(
name|n
condition|)
block|{
case|case
literal|0
case|:
name|y
operator|=
name|__kernel_sinl
argument_list|(
name|pi
operator|*
name|y
argument_list|,
name|zero
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
literal|1
case|:
case|case
literal|2
case|:
name|y
operator|=
name|__kernel_cosl
argument_list|(
name|pi
operator|*
operator|(
literal|0.5
operator|-
name|y
operator|)
argument_list|,
name|zero
argument_list|)
expr_stmt|;
break|break;
case|case
literal|3
case|:
case|case
literal|4
case|:
name|y
operator|=
name|__kernel_sinl
argument_list|(
name|pi
operator|*
operator|(
name|one
operator|-
name|y
operator|)
argument_list|,
name|zero
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
case|case
literal|5
case|:
case|case
literal|6
case|:
name|y
operator|=
operator|-
name|__kernel_cosl
argument_list|(
name|pi
operator|*
operator|(
name|y
operator|-
literal|1.5
operator|)
argument_list|,
name|zero
argument_list|)
expr_stmt|;
break|break;
default|default:
name|y
operator|=
name|__kernel_sinl
argument_list|(
name|pi
operator|*
operator|(
name|y
operator|-
literal|2.0
operator|)
argument_list|,
name|zero
argument_list|,
literal|0
argument_list|)
expr_stmt|;
break|break;
block|}
return|return
operator|-
name|y
return|;
block|}
end_function

begin_function
name|long
name|double
name|lgammal_r
parameter_list|(
name|long
name|double
name|x
parameter_list|,
name|int
modifier|*
name|signgamp
parameter_list|)
block|{
name|long
name|double
name|nadj
decl_stmt|,
name|p
decl_stmt|,
name|p1
decl_stmt|,
name|p2
decl_stmt|,
name|q
decl_stmt|,
name|r
decl_stmt|,
name|t
decl_stmt|,
name|w
decl_stmt|,
name|y
decl_stmt|,
name|z
decl_stmt|;
name|uint64_t
name|lx
decl_stmt|;
name|int
name|i
decl_stmt|;
name|uint16_t
name|hx
decl_stmt|,
name|ix
decl_stmt|;
name|EXTRACT_LDBL80_WORDS
argument_list|(
name|hx
argument_list|,
name|lx
argument_list|,
name|x
argument_list|)
expr_stmt|;
comment|/* purge +-Inf and NaNs */
operator|*
name|signgamp
operator|=
literal|1
expr_stmt|;
name|ix
operator|=
name|hx
operator|&
literal|0x7fff
expr_stmt|;
if|if
condition|(
name|ix
operator|==
literal|0x7fff
condition|)
return|return
name|x
operator|*
name|x
return|;
name|ENTERI
argument_list|()
expr_stmt|;
comment|/* purge +-0 and tiny arguments */
operator|*
name|signgamp
operator|=
literal|1
operator|-
literal|2
operator|*
operator|(
name|hx
operator|>>
literal|15
operator|)
expr_stmt|;
if|if
condition|(
name|ix
operator|<
literal|0x3fff
operator|-
literal|67
condition|)
block|{
comment|/* |x|<2**-(p+3), return -log(|x|) */
if|if
condition|(
operator|(
name|ix
operator||
name|lx
operator|)
operator|==
literal|0
condition|)
name|RETURNI
argument_list|(
name|one
operator|/
name|vzero
argument_list|)
expr_stmt|;
name|RETURNI
argument_list|(
operator|-
name|logl
argument_list|(
name|fabsl
argument_list|(
name|x
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
comment|/* purge negative integers and start evaluation for other x< 0 */
if|if
condition|(
name|hx
operator|&
literal|0x8000
condition|)
block|{
operator|*
name|signgamp
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|ix
operator|>=
literal|0x3fff
operator|+
literal|63
condition|)
comment|/* |x|>=2**(p-1), must be -integer */
name|RETURNI
argument_list|(
name|one
operator|/
name|vzero
argument_list|)
expr_stmt|;
name|t
operator|=
name|sin_pil
argument_list|(
name|x
argument_list|)
expr_stmt|;
if|if
condition|(
name|t
operator|==
name|zero
condition|)
name|RETURNI
argument_list|(
name|one
operator|/
name|vzero
argument_list|)
expr_stmt|;
comment|/* -integer */
name|nadj
operator|=
name|logl
argument_list|(
name|pi
operator|/
name|fabsl
argument_list|(
name|t
operator|*
name|x
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|t
operator|<
name|zero
condition|)
operator|*
name|signgamp
operator|=
operator|-
literal|1
expr_stmt|;
name|x
operator|=
operator|-
name|x
expr_stmt|;
block|}
comment|/* purge 1 and 2 */
if|if
condition|(
operator|(
name|ix
operator|==
literal|0x3fff
operator|||
name|ix
operator|==
literal|0x4000
operator|)
operator|&&
name|lx
operator|==
literal|0x8000000000000000ULL
condition|)
name|r
operator|=
literal|0
expr_stmt|;
comment|/* for x< 2.0 */
elseif|else
if|if
condition|(
name|ix
operator|<
literal|0x4000
condition|)
block|{
comment|/*      * XXX Supposedly, one can use the following information to replace the      * XXX FP rational expressions.  A similar approach is appropriate      * XXX for ld128, but one (may need?) needs to consider llx, too.      *      * 8.9999961853027344e-01 3ffe e666600000000000      * 7.3159980773925781e-01 3ffe bb4a200000000000      * 2.3163998126983643e-01 3ffc ed33080000000000      * 1.7316312789916992e+00 3fff dda6180000000000      * 1.2316322326660156e+00 3fff 9da6200000000000      */
if|if
condition|(
name|x
operator|<
literal|8.9999961853027344e-01
condition|)
block|{
name|r
operator|=
operator|-
name|logl
argument_list|(
name|x
argument_list|)
expr_stmt|;
if|if
condition|(
name|x
operator|>=
literal|7.3159980773925781e-01
condition|)
block|{
name|y
operator|=
literal|1
operator|-
name|x
expr_stmt|;
name|i
operator|=
literal|0
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|x
operator|>=
literal|2.3163998126983643e-01
condition|)
block|{
name|y
operator|=
name|x
operator|-
operator|(
name|tc
operator|-
literal|1
operator|)
expr_stmt|;
name|i
operator|=
literal|1
expr_stmt|;
block|}
else|else
block|{
name|y
operator|=
name|x
expr_stmt|;
name|i
operator|=
literal|2
expr_stmt|;
block|}
block|}
else|else
block|{
name|r
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|x
operator|>=
literal|1.7316312789916992e+00
condition|)
block|{
name|y
operator|=
literal|2
operator|-
name|x
expr_stmt|;
name|i
operator|=
literal|0
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|x
operator|>=
literal|1.2316322326660156e+00
condition|)
block|{
name|y
operator|=
name|x
operator|-
name|tc
expr_stmt|;
name|i
operator|=
literal|1
expr_stmt|;
block|}
else|else
block|{
name|y
operator|=
name|x
operator|-
literal|1
expr_stmt|;
name|i
operator|=
literal|2
expr_stmt|;
block|}
block|}
switch|switch
condition|(
name|i
condition|)
block|{
case|case
literal|0
case|:
name|z
operator|=
name|y
operator|*
name|y
expr_stmt|;
name|p1
operator|=
name|a0
operator|+
name|z
operator|*
operator|(
name|a2
operator|+
name|z
operator|*
operator|(
name|a4
operator|+
name|z
operator|*
operator|(
name|a6
operator|+
name|z
operator|*
operator|(
name|a8
operator|+
name|z
operator|*
operator|(
name|a10
operator|+
name|z
operator|*
name|a12
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|p2
operator|=
name|z
operator|*
operator|(
name|a1
operator|+
name|z
operator|*
operator|(
name|a3
operator|+
name|z
operator|*
operator|(
name|a5
operator|+
name|z
operator|*
operator|(
name|a7
operator|+
name|z
operator|*
operator|(
name|a9
operator|+
name|z
operator|*
operator|(
name|a11
operator|+
name|z
operator|*
name|a13
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|p
operator|=
name|y
operator|*
name|p1
operator|+
name|p2
expr_stmt|;
name|r
operator|+=
name|p
operator|-
name|y
operator|/
literal|2
expr_stmt|;
break|break;
case|case
literal|1
case|:
name|p
operator|=
name|t0
operator|+
name|y
operator|*
name|t1
operator|+
name|tt
operator|+
name|y
operator|*
name|y
operator|*
operator|(
name|t2
operator|+
name|y
operator|*
operator|(
name|t3
operator|+
name|y
operator|*
operator|(
name|t4
operator|+
name|y
operator|*
operator|(
name|t5
operator|+
name|y
operator|*
operator|(
name|t6
operator|+
name|y
operator|*
operator|(
name|t7
operator|+
name|y
operator|*
operator|(
name|t8
operator|+
name|y
operator|*
operator|(
name|t9
operator|+
name|y
operator|*
operator|(
name|t10
operator|+
name|y
operator|*
operator|(
name|t11
operator|+
name|y
operator|*
operator|(
name|t12
operator|+
name|y
operator|*
operator|(
name|t13
operator|+
name|y
operator|*
operator|(
name|t14
operator|+
name|y
operator|*
operator|(
name|t15
operator|+
name|y
operator|*
operator|(
name|t16
operator|+
name|y
operator|*
operator|(
name|t17
operator|+
name|y
operator|*
name|t18
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|r
operator|+=
name|tf
operator|+
name|p
expr_stmt|;
break|break;
case|case
literal|2
case|:
name|p1
operator|=
name|y
operator|*
operator|(
name|u0
operator|+
name|y
operator|*
operator|(
name|u1
operator|+
name|y
operator|*
operator|(
name|u2
operator|+
name|y
operator|*
operator|(
name|u3
operator|+
name|y
operator|*
operator|(
name|u4
operator|+
name|y
operator|*
operator|(
name|u5
operator|+
name|y
operator|*
name|u6
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|p2
operator|=
literal|1
operator|+
name|y
operator|*
operator|(
name|v1
operator|+
name|y
operator|*
operator|(
name|v2
operator|+
name|y
operator|*
operator|(
name|v3
operator|+
name|y
operator|*
operator|(
name|v4
operator|+
name|y
operator|*
operator|(
name|v5
operator|+
name|y
operator|*
name|v6
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|r
operator|+=
name|p1
operator|/
name|p2
operator|-
name|y
operator|/
literal|2
expr_stmt|;
block|}
block|}
comment|/* x< 8.0 */
elseif|else
if|if
condition|(
name|ix
operator|<
literal|0x4002
condition|)
block|{
name|i
operator|=
name|x
expr_stmt|;
name|y
operator|=
name|x
operator|-
name|i
expr_stmt|;
name|p
operator|=
name|y
operator|*
operator|(
name|s0
operator|+
name|y
operator|*
operator|(
name|s1
operator|+
name|y
operator|*
operator|(
name|s2
operator|+
name|y
operator|*
operator|(
name|s3
operator|+
name|y
operator|*
operator|(
name|s4
operator|+
name|y
operator|*
operator|(
name|s5
operator|+
name|y
operator|*
name|s6
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|q
operator|=
literal|1
operator|+
name|y
operator|*
operator|(
name|r1
operator|+
name|y
operator|*
operator|(
name|r2
operator|+
name|y
operator|*
operator|(
name|r3
operator|+
name|y
operator|*
operator|(
name|r4
operator|+
name|y
operator|*
operator|(
name|r5
operator|+
name|y
operator|*
operator|(
name|r6
operator|+
name|y
operator|*
name|r7
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|r
operator|=
name|y
operator|/
literal|2
operator|+
name|p
operator|/
name|q
expr_stmt|;
name|z
operator|=
literal|1
expr_stmt|;
comment|/* lgamma(1+s) = log(s) + lgamma(s) */
switch|switch
condition|(
name|i
condition|)
block|{
case|case
literal|7
case|:
name|z
operator|*=
operator|(
name|y
operator|+
literal|6
operator|)
expr_stmt|;
comment|/* FALLTHRU */
case|case
literal|6
case|:
name|z
operator|*=
operator|(
name|y
operator|+
literal|5
operator|)
expr_stmt|;
comment|/* FALLTHRU */
case|case
literal|5
case|:
name|z
operator|*=
operator|(
name|y
operator|+
literal|4
operator|)
expr_stmt|;
comment|/* FALLTHRU */
case|case
literal|4
case|:
name|z
operator|*=
operator|(
name|y
operator|+
literal|3
operator|)
expr_stmt|;
comment|/* FALLTHRU */
case|case
literal|3
case|:
name|z
operator|*=
operator|(
name|y
operator|+
literal|2
operator|)
expr_stmt|;
comment|/* FALLTHRU */
name|r
operator|+=
name|logl
argument_list|(
name|z
argument_list|)
expr_stmt|;
break|break;
block|}
comment|/* 8.0<= x< 2**(p+3) */
block|}
elseif|else
if|if
condition|(
name|ix
operator|<
literal|0x3fff
operator|+
literal|67
condition|)
block|{
name|t
operator|=
name|logl
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|z
operator|=
name|one
operator|/
name|x
expr_stmt|;
name|y
operator|=
name|z
operator|*
name|z
expr_stmt|;
name|w
operator|=
name|w0
operator|+
name|z
operator|*
operator|(
name|w1
operator|+
name|y
operator|*
operator|(
name|w2
operator|+
name|y
operator|*
operator|(
name|w3
operator|+
name|y
operator|*
operator|(
name|w4
operator|+
name|y
operator|*
operator|(
name|w5
operator|+
name|y
operator|*
operator|(
name|w6
operator|+
name|y
operator|*
operator|(
name|w7
operator|+
name|y
operator|*
name|w8
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
operator|)
expr_stmt|;
name|r
operator|=
operator|(
name|x
operator|-
name|half
operator|)
operator|*
operator|(
name|t
operator|-
name|one
operator|)
operator|+
name|w
expr_stmt|;
comment|/* 2**(p+3)<= x<= inf */
block|}
else|else
name|r
operator|=
name|x
operator|*
operator|(
name|logl
argument_list|(
name|x
argument_list|)
operator|-
literal|1
operator|)
expr_stmt|;
if|if
condition|(
name|hx
operator|&
literal|0x8000
condition|)
name|r
operator|=
name|nadj
operator|-
name|r
expr_stmt|;
name|RETURNI
argument_list|(
name|r
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

