begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright 1997 Sean Eric Fagan  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  * 3. All advertising materials mentioning features or use of this software  *    must display the following acknowledgement:  *	This product includes software developed by Sean Eric Fagan  * 4. Neither the name of the author may be used to endorse or promote  *    products derived from this software without specific prior written  *    permission.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_comment
comment|/*  * This file has routines used to print out system calls and their  * arguments.  */
end_comment

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|<sys/event.h>
end_include

begin_include
include|#
directive|include
file|<sys/ioccom.h>
end_include

begin_include
include|#
directive|include
file|<sys/mount.h>
end_include

begin_include
include|#
directive|include
file|<sys/ptrace.h>
end_include

begin_include
include|#
directive|include
file|<sys/resource.h>
end_include

begin_include
include|#
directive|include
file|<sys/socket.h>
end_include

begin_include
include|#
directive|include
file|<sys/stat.h>
end_include

begin_include
include|#
directive|include
file|<sys/un.h>
end_include

begin_include
include|#
directive|include
file|<sys/wait.h>
end_include

begin_include
include|#
directive|include
file|<machine/sysarch.h>
end_include

begin_include
include|#
directive|include
file|<netinet/in.h>
end_include

begin_include
include|#
directive|include
file|<arpa/inet.h>
end_include

begin_include
include|#
directive|include
file|<assert.h>
end_include

begin_include
include|#
directive|include
file|<ctype.h>
end_include

begin_include
include|#
directive|include
file|<err.h>
end_include

begin_include
include|#
directive|include
file|<fcntl.h>
end_include

begin_include
include|#
directive|include
file|<poll.h>
end_include

begin_include
include|#
directive|include
file|<signal.h>
end_include

begin_include
include|#
directive|include
file|<stdbool.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<sysdecode.h>
end_include

begin_include
include|#
directive|include
file|<unistd.h>
end_include

begin_include
include|#
directive|include
file|<vis.h>
end_include

begin_include
include|#
directive|include
file|<contrib/cloudabi/cloudabi_types_common.h>
end_include

begin_include
include|#
directive|include
file|"truss.h"
end_include

begin_include
include|#
directive|include
file|"extern.h"
end_include

begin_include
include|#
directive|include
file|"syscall.h"
end_include

begin_comment
comment|/*  * This should probably be in its own file, sorted alphabetically.  */
end_comment

begin_decl_stmt
specifier|static
name|struct
name|syscall
name|decoded_syscalls
index|[]
init|=
block|{
comment|/* Native ABI */
block|{
operator|.
name|name
operator|=
literal|"__getcwd"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|OUT
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"_umtx_op"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|5
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|,
block|{
name|Umtxop
block|,
literal|1
block|}
block|,
block|{
name|LongHex
block|,
literal|2
block|}
block|,
block|{
name|Ptr
block|,
literal|3
block|}
block|,
block|{
name|Ptr
block|,
literal|4
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"accept"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Sockaddr
operator||
name|OUT
block|,
literal|1
block|}
block|,
block|{
name|Ptr
operator||
name|OUT
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"access"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|Accessmode
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"bind"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Sockaddr
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"bindat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Atfd
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|Sockaddr
operator||
name|IN
block|,
literal|2
block|}
block|,
block|{
name|Int
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"break"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cap_fcntls_get"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|CapFcntlRights
operator||
name|OUT
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cap_fcntls_limit"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|CapFcntlRights
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"chdir"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"chflags"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|FileFlags
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"chflagsat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Atfd
block|,
literal|0
block|}
block|,
block|{
name|Name
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|FileFlags
block|,
literal|2
block|}
block|,
block|{
name|Atflags
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"chmod"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|,
block|{
name|Octal
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"chown"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"chroot"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"clock_gettime"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Timespec
operator||
name|OUT
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"close"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"connect"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Sockaddr
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"connectat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Atfd
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|Sockaddr
operator||
name|IN
block|,
literal|2
block|}
block|,
block|{
name|Int
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"eaccess"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|Accessmode
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"execve"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|ExecArgs
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|ExecEnv
operator||
name|IN
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"exit"
block|,
operator|.
name|ret_type
operator|=
literal|0
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Hex
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"faccessat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Atfd
block|,
literal|0
block|}
block|,
block|{
name|Name
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|Accessmode
block|,
literal|2
block|}
block|,
block|{
name|Atflags
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"fchflags"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|FileFlags
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"fchmod"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Octal
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"fchmodat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Atfd
block|,
literal|0
block|}
block|,
block|{
name|Name
block|,
literal|1
block|}
block|,
block|{
name|Octal
block|,
literal|2
block|}
block|,
block|{
name|Atflags
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"fchown"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"fchownat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|5
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Atfd
block|,
literal|0
block|}
block|,
block|{
name|Name
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|,
block|{
name|Int
block|,
literal|3
block|}
block|,
block|{
name|Atflags
block|,
literal|4
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"fcntl"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Fcntl
block|,
literal|1
block|}
block|,
block|{
name|Fcntlflag
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"flock"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Flockop
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"fstat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Stat
operator||
name|OUT
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"fstatat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Atfd
block|,
literal|0
block|}
block|,
block|{
name|Name
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|Stat
operator||
name|OUT
block|,
literal|2
block|}
block|,
block|{
name|Atflags
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"fstatfs"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|StatFs
operator||
name|OUT
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"ftruncate"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|QuadHex
operator||
name|IN
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"futimens"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Timespec2
operator||
name|IN
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"futimes"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Timeval2
operator||
name|IN
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"futimesat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Atfd
block|,
literal|0
block|}
block|,
block|{
name|Name
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|Timeval2
operator||
name|IN
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"getitimer"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Itimerval
operator||
name|OUT
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"getpeername"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Sockaddr
operator||
name|OUT
block|,
literal|1
block|}
block|,
block|{
name|Ptr
operator||
name|OUT
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"getpgid"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"getrlimit"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Resource
block|,
literal|0
block|}
block|,
block|{
name|Rlimit
operator||
name|OUT
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"getrusage"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Rusage
operator||
name|OUT
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"getsid"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"getsockname"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Sockaddr
operator||
name|OUT
block|,
literal|1
block|}
block|,
block|{
name|Ptr
operator||
name|OUT
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"gettimeofday"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Timeval
operator||
name|OUT
block|,
literal|0
block|}
block|,
block|{
name|Ptr
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"ioctl"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Ioctl
block|,
literal|1
block|}
block|,
block|{
name|Hex
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"kevent"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|6
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Kevent
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|,
block|{
name|Kevent
operator||
name|OUT
block|,
literal|3
block|}
block|,
block|{
name|Int
block|,
literal|4
block|}
block|,
block|{
name|Timespec
block|,
literal|5
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"kill"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|Signal
operator||
name|IN
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"kldfind"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"kldfirstmod"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"kldload"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"kldnext"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"kldstat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Ptr
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"kldunload"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"kse_release"
block|,
operator|.
name|ret_type
operator|=
literal|0
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Timespec
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"lchflags"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|FileFlags
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"lchmod"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|,
block|{
name|Octal
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"lchown"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"link"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|,
block|{
name|Name
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"linkat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|5
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Atfd
block|,
literal|0
block|}
block|,
block|{
name|Name
block|,
literal|1
block|}
block|,
block|{
name|Atfd
block|,
literal|2
block|}
block|,
block|{
name|Name
block|,
literal|3
block|}
block|,
block|{
name|Atflags
block|,
literal|4
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"lseek"
block|,
operator|.
name|ret_type
operator|=
literal|2
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|QuadHex
block|,
literal|1
block|}
block|,
block|{
name|Whence
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"lstat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|Stat
operator||
name|OUT
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"lutimes"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|Timeval2
operator||
name|IN
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"mkdir"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|,
block|{
name|Octal
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"mkdirat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Atfd
block|,
literal|0
block|}
block|,
block|{
name|Name
block|,
literal|1
block|}
block|,
block|{
name|Octal
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"mkfifo"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|,
block|{
name|Octal
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"mkfifoat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Atfd
block|,
literal|0
block|}
block|,
block|{
name|Name
block|,
literal|1
block|}
block|,
block|{
name|Octal
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"mknod"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|,
block|{
name|Octal
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"mknodat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Atfd
block|,
literal|0
block|}
block|,
block|{
name|Name
block|,
literal|1
block|}
block|,
block|{
name|Octal
block|,
literal|2
block|}
block|,
block|{
name|Int
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"mmap"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|6
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|Mprot
block|,
literal|2
block|}
block|,
block|{
name|Mmapflags
block|,
literal|3
block|}
block|,
block|{
name|Int
block|,
literal|4
block|}
block|,
block|{
name|QuadHex
block|,
literal|5
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"modfind"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"mount"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|,
block|{
name|Name
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|,
block|{
name|Ptr
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"mprotect"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|Mprot
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"munmap"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"nanosleep"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Timespec
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"open"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|Open
block|,
literal|1
block|}
block|,
block|{
name|Octal
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"openat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Atfd
block|,
literal|0
block|}
block|,
block|{
name|Name
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|Open
block|,
literal|2
block|}
block|,
block|{
name|Octal
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"pathconf"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|Pathconf
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"pipe"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|PipeFds
operator||
name|OUT
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"pipe2"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|,
block|{
name|Pipe2
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"poll"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Pollfd
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"posix_fadvise"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|QuadHex
block|,
literal|1
block|}
block|,
block|{
name|QuadHex
block|,
literal|2
block|}
block|,
block|{
name|Fadvice
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"posix_openpt"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Open
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"procctl"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Idtype
block|,
literal|0
block|}
block|,
block|{
name|Quad
block|,
literal|1
block|}
block|,
block|{
name|Procctl
block|,
literal|2
block|}
block|,
block|{
name|Ptr
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"read"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|BinString
operator||
name|OUT
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"readlink"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|,
block|{
name|Readlinkres
operator||
name|OUT
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"readlinkat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Atfd
block|,
literal|0
block|}
block|,
block|{
name|Name
block|,
literal|1
block|}
block|,
block|{
name|Readlinkres
operator||
name|OUT
block|,
literal|2
block|}
block|,
block|{
name|Int
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"recvfrom"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|6
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|BinString
operator||
name|OUT
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|,
block|{
name|Hex
block|,
literal|3
block|}
block|,
block|{
name|Sockaddr
operator||
name|OUT
block|,
literal|4
block|}
block|,
block|{
name|Ptr
operator||
name|OUT
block|,
literal|5
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"rename"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|,
block|{
name|Name
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"renameat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Atfd
block|,
literal|0
block|}
block|,
block|{
name|Name
block|,
literal|1
block|}
block|,
block|{
name|Atfd
block|,
literal|2
block|}
block|,
block|{
name|Name
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"rfork"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Rforkflags
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"rmdir"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"select"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|5
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Fd_set
block|,
literal|1
block|}
block|,
block|{
name|Fd_set
block|,
literal|2
block|}
block|,
block|{
name|Fd_set
block|,
literal|3
block|}
block|,
block|{
name|Timeval
block|,
literal|4
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"sendto"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|6
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|BinString
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|,
block|{
name|Hex
block|,
literal|3
block|}
block|,
block|{
name|Sockaddr
operator||
name|IN
block|,
literal|4
block|}
block|,
block|{
name|Ptr
operator||
name|IN
block|,
literal|5
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"setitimer"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Itimerval
block|,
literal|1
block|}
block|,
block|{
name|Itimerval
operator||
name|OUT
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"setrlimit"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Resource
block|,
literal|0
block|}
block|,
block|{
name|Rlimit
operator||
name|IN
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"shutdown"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Shutdown
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"sigaction"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Signal
block|,
literal|0
block|}
block|,
block|{
name|Sigaction
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|Sigaction
operator||
name|OUT
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"sigpending"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Sigset
operator||
name|OUT
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"sigprocmask"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Sigprocmask
block|,
literal|0
block|}
block|,
block|{
name|Sigset
block|,
literal|1
block|}
block|,
block|{
name|Sigset
operator||
name|OUT
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"sigqueue"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Signal
block|,
literal|1
block|}
block|,
block|{
name|LongHex
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"sigreturn"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"sigsuspend"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Sigset
operator||
name|IN
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"sigtimedwait"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Sigset
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|Ptr
block|,
literal|1
block|}
block|,
block|{
name|Timespec
operator||
name|IN
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"sigwait"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Sigset
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|Ptr
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"sigwaitinfo"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Sigset
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|Ptr
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"socket"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Sockdomain
block|,
literal|0
block|}
block|,
block|{
name|Socktype
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"stat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|Stat
operator||
name|OUT
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"statfs"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|StatFs
operator||
name|OUT
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"symlink"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|,
block|{
name|Name
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"symlinkat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|,
block|{
name|Atfd
block|,
literal|1
block|}
block|,
block|{
name|Name
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"sysarch"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Sysarch
block|,
literal|0
block|}
block|,
block|{
name|Ptr
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"thr_kill"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Long
block|,
literal|0
block|}
block|,
block|{
name|Signal
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"thr_self"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"truncate"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|QuadHex
operator||
name|IN
block|,
literal|1
block|}
block|}
block|}
block|,
if|#
directive|if
literal|0
comment|/* Does not exist */
block|{ .name = "umount", .ret_type = 1, .nargs = 2, 	  .args = { { Name, 0 }, { Int, 2 } } },
endif|#
directive|endif
block|{
operator|.
name|name
operator|=
literal|"unlink"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"unlinkat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Atfd
block|,
literal|0
block|}
block|,
block|{
name|Name
block|,
literal|1
block|}
block|,
block|{
name|Atflags
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"unmount"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"utimensat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Atfd
block|,
literal|0
block|}
block|,
block|{
name|Name
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|Timespec2
operator||
name|IN
block|,
literal|2
block|}
block|,
block|{
name|Atflags
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"utimes"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|Timeval2
operator||
name|IN
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"utrace"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Utrace
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"wait4"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|ExitStatus
operator||
name|OUT
block|,
literal|1
block|}
block|,
block|{
name|Waitoptions
block|,
literal|2
block|}
block|,
block|{
name|Rusage
operator||
name|OUT
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"wait6"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|6
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Idtype
block|,
literal|0
block|}
block|,
block|{
name|Quad
block|,
literal|1
block|}
block|,
block|{
name|ExitStatus
operator||
name|OUT
block|,
literal|2
block|}
block|,
block|{
name|Waitoptions
block|,
literal|3
block|}
block|,
block|{
name|Rusage
operator||
name|OUT
block|,
literal|4
block|}
block|,
block|{
name|Ptr
block|,
literal|5
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"write"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|BinString
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|}
block|}
block|,
comment|/* Linux ABI */
block|{
operator|.
name|name
operator|=
literal|"linux_access"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|,
block|{
name|Accessmode
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"linux_execve"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|ExecArgs
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|ExecEnv
operator||
name|IN
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"linux_lseek"
block|,
operator|.
name|ret_type
operator|=
literal|2
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|Whence
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"linux_mkdir"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"linux_newfstat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Ptr
operator||
name|OUT
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"linux_newstat"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|Ptr
operator||
name|OUT
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"linux_open"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|,
block|{
name|Hex
block|,
literal|1
block|}
block|,
block|{
name|Octal
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"linux_readlink"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
block|,
literal|0
block|}
block|,
block|{
name|Name
operator||
name|OUT
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"linux_socketcall"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|LinuxSockArgs
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"linux_stat64"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Name
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|Ptr
operator||
name|OUT
block|,
literal|1
block|}
block|}
block|}
block|,
comment|/* CloudABI system calls. */
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_clock_res_get"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|CloudABIClockID
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_clock_time_get"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|CloudABIClockID
block|,
literal|0
block|}
block|,
block|{
name|CloudABITimestamp
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_condvar_signal"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|,
block|{
name|CloudABIMFlags
block|,
literal|1
block|}
block|,
block|{
name|UInt
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_fd_close"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_fd_create1"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|CloudABIFileType
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_fd_create2"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|CloudABIFileType
block|,
literal|0
block|}
block|,
block|{
name|PipeFds
operator||
name|OUT
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_fd_datasync"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_fd_dup"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_fd_replace"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_fd_seek"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|CloudABIWhence
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_fd_stat_get"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|CloudABIFDStat
operator||
name|OUT
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_fd_stat_put"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|CloudABIFDStat
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|ClouduABIFDSFlags
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_fd_sync"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_file_advise"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|,
block|{
name|CloudABIAdvice
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_file_allocate"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_file_create"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|BinString
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|CloudABIFileType
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_file_link"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|CloudABILookup
block|,
literal|0
block|}
block|,
block|{
name|BinString
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|3
block|}
block|,
block|{
name|BinString
operator||
name|IN
block|,
literal|4
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_file_open"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|BinString
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|CloudABIOFlags
block|,
literal|3
block|}
block|,
block|{
name|CloudABIFDStat
operator||
name|IN
block|,
literal|4
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_file_readdir"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|BinString
operator||
name|OUT
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|,
block|{
name|Int
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_file_readlink"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|BinString
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|BinString
operator||
name|OUT
block|,
literal|3
block|}
block|,
block|{
name|Int
block|,
literal|4
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_file_rename"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|BinString
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|3
block|}
block|,
block|{
name|BinString
operator||
name|IN
block|,
literal|4
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_file_stat_fget"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|CloudABIFileStat
operator||
name|OUT
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_file_stat_fput"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|CloudABIFileStat
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|CloudABIFSFlags
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_file_stat_get"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|CloudABILookup
block|,
literal|0
block|}
block|,
block|{
name|BinString
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|CloudABIFileStat
operator||
name|OUT
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_file_stat_put"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|4
block|,
operator|.
name|args
operator|=
block|{
block|{
name|CloudABILookup
block|,
literal|0
block|}
block|,
block|{
name|BinString
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|CloudABIFileStat
operator||
name|IN
block|,
literal|3
block|}
block|,
block|{
name|CloudABIFSFlags
block|,
literal|4
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_file_symlink"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|BinString
operator||
name|IN
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|,
block|{
name|BinString
operator||
name|IN
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_file_unlink"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|BinString
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|CloudABIULFlags
block|,
literal|3
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_lock_unlock"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|,
block|{
name|CloudABIMFlags
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_mem_advise"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|CloudABIAdvice
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_mem_lock"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_mem_map"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|6
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|CloudABIMProt
block|,
literal|2
block|}
block|,
block|{
name|CloudABIMFlags
block|,
literal|3
block|}
block|,
block|{
name|Int
block|,
literal|4
block|}
block|,
block|{
name|Int
block|,
literal|5
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_mem_protect"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|CloudABIMProt
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_mem_sync"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|CloudABIMSFlags
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_mem_unlock"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_mem_unmap"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_proc_exec"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|5
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|BinString
operator||
name|IN
block|,
literal|1
block|}
block|,
block|{
name|Int
block|,
literal|2
block|}
block|,
block|{
name|IntArray
block|,
literal|3
block|}
block|,
block|{
name|Int
block|,
literal|4
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_proc_exit"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_proc_fork"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|0
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_proc_raise"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|1
block|,
operator|.
name|args
operator|=
block|{
block|{
name|CloudABISignal
block|,
literal|0
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_random_get"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|BinString
operator||
name|OUT
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_sock_accept"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|CloudABISockStat
operator||
name|OUT
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_sock_bind"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|BinString
operator||
name|IN
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_sock_connect"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|,
block|{
name|BinString
operator||
name|IN
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_sock_listen"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|Int
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_sock_shutdown"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|CloudABISDFlags
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_sock_stat_get"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|3
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Int
block|,
literal|0
block|}
block|,
block|{
name|CloudABISockStat
operator||
name|OUT
block|,
literal|1
block|}
block|,
block|{
name|CloudABISSFlags
block|,
literal|2
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_thread_exit"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|2
block|,
operator|.
name|args
operator|=
block|{
block|{
name|Ptr
block|,
literal|0
block|}
block|,
block|{
name|CloudABIMFlags
block|,
literal|1
block|}
block|}
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|"cloudabi_sys_thread_yield"
block|,
operator|.
name|ret_type
operator|=
literal|1
block|,
operator|.
name|nargs
operator|=
literal|0
block|}
block|,
block|{
operator|.
name|name
operator|=
literal|0
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_expr_stmt
specifier|static
name|STAILQ_HEAD
argument_list|(
argument_list|,
argument|syscall
argument_list|)
name|syscalls
expr_stmt|;
end_expr_stmt

begin_comment
comment|/* Xlat idea taken from strace */
end_comment

begin_struct
struct|struct
name|xlat
block|{
name|int
name|val
decl_stmt|;
specifier|const
name|char
modifier|*
name|str
decl_stmt|;
block|}
struct|;
end_struct

begin_define
define|#
directive|define
name|X
parameter_list|(
name|a
parameter_list|)
value|{ a, #a },
end_define

begin_define
define|#
directive|define
name|XEND
value|{ 0, NULL }
end_define

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|kevent_filters
index|[]
init|=
block|{
name|X
argument_list|(
argument|EVFILT_READ
argument_list|)
name|X
argument_list|(
argument|EVFILT_WRITE
argument_list|)
name|X
argument_list|(
argument|EVFILT_AIO
argument_list|)
name|X
argument_list|(
argument|EVFILT_VNODE
argument_list|)
name|X
argument_list|(
argument|EVFILT_PROC
argument_list|)
name|X
argument_list|(
argument|EVFILT_SIGNAL
argument_list|)
name|X
argument_list|(
argument|EVFILT_TIMER
argument_list|)
name|X
argument_list|(
argument|EVFILT_PROCDESC
argument_list|)
name|X
argument_list|(
argument|EVFILT_FS
argument_list|)
name|X
argument_list|(
argument|EVFILT_LIO
argument_list|)
name|X
argument_list|(
argument|EVFILT_USER
argument_list|)
name|X
argument_list|(
argument|EVFILT_SENDFILE
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|kevent_flags
index|[]
init|=
block|{
name|X
argument_list|(
argument|EV_ADD
argument_list|)
name|X
argument_list|(
argument|EV_DELETE
argument_list|)
name|X
argument_list|(
argument|EV_ENABLE
argument_list|)
name|X
argument_list|(
argument|EV_DISABLE
argument_list|)
name|X
argument_list|(
argument|EV_ONESHOT
argument_list|)
name|X
argument_list|(
argument|EV_CLEAR
argument_list|)
name|X
argument_list|(
argument|EV_RECEIPT
argument_list|)
name|X
argument_list|(
argument|EV_DISPATCH
argument_list|)
name|X
argument_list|(
argument|EV_FORCEONESHOT
argument_list|)
name|X
argument_list|(
argument|EV_DROP
argument_list|)
name|X
argument_list|(
argument|EV_FLAG1
argument_list|)
name|X
argument_list|(
argument|EV_ERROR
argument_list|)
name|X
argument_list|(
argument|EV_EOF
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|kevent_user_ffctrl
index|[]
init|=
block|{
name|X
argument_list|(
argument|NOTE_FFNOP
argument_list|)
name|X
argument_list|(
argument|NOTE_FFAND
argument_list|)
name|X
argument_list|(
argument|NOTE_FFOR
argument_list|)
name|X
argument_list|(
argument|NOTE_FFCOPY
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|kevent_rdwr_fflags
index|[]
init|=
block|{
name|X
argument_list|(
argument|NOTE_LOWAT
argument_list|)
name|X
argument_list|(
argument|NOTE_FILE_POLL
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|kevent_vnode_fflags
index|[]
init|=
block|{
name|X
argument_list|(
argument|NOTE_DELETE
argument_list|)
name|X
argument_list|(
argument|NOTE_WRITE
argument_list|)
name|X
argument_list|(
argument|NOTE_EXTEND
argument_list|)
name|X
argument_list|(
argument|NOTE_ATTRIB
argument_list|)
name|X
argument_list|(
argument|NOTE_LINK
argument_list|)
name|X
argument_list|(
argument|NOTE_RENAME
argument_list|)
name|X
argument_list|(
argument|NOTE_REVOKE
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|kevent_proc_fflags
index|[]
init|=
block|{
name|X
argument_list|(
argument|NOTE_EXIT
argument_list|)
name|X
argument_list|(
argument|NOTE_FORK
argument_list|)
name|X
argument_list|(
argument|NOTE_EXEC
argument_list|)
name|X
argument_list|(
argument|NOTE_TRACK
argument_list|)
name|X
argument_list|(
argument|NOTE_TRACKERR
argument_list|)
name|X
argument_list|(
argument|NOTE_CHILD
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|kevent_timer_fflags
index|[]
init|=
block|{
name|X
argument_list|(
argument|NOTE_SECONDS
argument_list|)
name|X
argument_list|(
argument|NOTE_MSECONDS
argument_list|)
name|X
argument_list|(
argument|NOTE_USECONDS
argument_list|)
name|X
argument_list|(
argument|NOTE_NSECONDS
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|poll_flags
index|[]
init|=
block|{
name|X
argument_list|(
argument|POLLSTANDARD
argument_list|)
name|X
argument_list|(
argument|POLLIN
argument_list|)
name|X
argument_list|(
argument|POLLPRI
argument_list|)
name|X
argument_list|(
argument|POLLOUT
argument_list|)
name|X
argument_list|(
argument|POLLERR
argument_list|)
name|X
argument_list|(
argument|POLLHUP
argument_list|)
name|X
argument_list|(
argument|POLLNVAL
argument_list|)
name|X
argument_list|(
argument|POLLRDNORM
argument_list|)
name|X
argument_list|(
argument|POLLRDBAND
argument_list|)
name|X
argument_list|(
argument|POLLWRBAND
argument_list|)
name|X
argument_list|(
argument|POLLINIGNEOF
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|sigaction_flags
index|[]
init|=
block|{
name|X
argument_list|(
argument|SA_ONSTACK
argument_list|)
name|X
argument_list|(
argument|SA_RESTART
argument_list|)
name|X
argument_list|(
argument|SA_RESETHAND
argument_list|)
name|X
argument_list|(
argument|SA_NOCLDSTOP
argument_list|)
name|X
argument_list|(
argument|SA_NODEFER
argument_list|)
name|X
argument_list|(
argument|SA_NOCLDWAIT
argument_list|)
name|X
argument_list|(
argument|SA_SIGINFO
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|pathconf_arg
index|[]
init|=
block|{
name|X
argument_list|(
argument|_PC_LINK_MAX
argument_list|)
name|X
argument_list|(
argument|_PC_MAX_CANON
argument_list|)
name|X
argument_list|(
argument|_PC_MAX_INPUT
argument_list|)
name|X
argument_list|(
argument|_PC_NAME_MAX
argument_list|)
name|X
argument_list|(
argument|_PC_PATH_MAX
argument_list|)
name|X
argument_list|(
argument|_PC_PIPE_BUF
argument_list|)
name|X
argument_list|(
argument|_PC_CHOWN_RESTRICTED
argument_list|)
name|X
argument_list|(
argument|_PC_NO_TRUNC
argument_list|)
name|X
argument_list|(
argument|_PC_VDISABLE
argument_list|)
name|X
argument_list|(
argument|_PC_ASYNC_IO
argument_list|)
name|X
argument_list|(
argument|_PC_PRIO_IO
argument_list|)
name|X
argument_list|(
argument|_PC_SYNC_IO
argument_list|)
name|X
argument_list|(
argument|_PC_ALLOC_SIZE_MIN
argument_list|)
name|X
argument_list|(
argument|_PC_FILESIZEBITS
argument_list|)
name|X
argument_list|(
argument|_PC_REC_INCR_XFER_SIZE
argument_list|)
name|X
argument_list|(
argument|_PC_REC_MAX_XFER_SIZE
argument_list|)
name|X
argument_list|(
argument|_PC_REC_MIN_XFER_SIZE
argument_list|)
name|X
argument_list|(
argument|_PC_REC_XFER_ALIGN
argument_list|)
name|X
argument_list|(
argument|_PC_SYMLINK_MAX
argument_list|)
name|X
argument_list|(
argument|_PC_ACL_EXTENDED
argument_list|)
name|X
argument_list|(
argument|_PC_ACL_PATH_MAX
argument_list|)
name|X
argument_list|(
argument|_PC_CAP_PRESENT
argument_list|)
name|X
argument_list|(
argument|_PC_INF_PRESENT
argument_list|)
name|X
argument_list|(
argument|_PC_MAC_PRESENT
argument_list|)
name|X
argument_list|(
argument|_PC_ACL_NFS4
argument_list|)
name|X
argument_list|(
argument|_PC_MIN_HOLE_SIZE
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|at_flags
index|[]
init|=
block|{
name|X
argument_list|(
argument|AT_EACCESS
argument_list|)
name|X
argument_list|(
argument|AT_SYMLINK_NOFOLLOW
argument_list|)
name|X
argument_list|(
argument|AT_SYMLINK_FOLLOW
argument_list|)
name|X
argument_list|(
argument|AT_REMOVEDIR
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|sysarch_ops
index|[]
init|=
block|{
if|#
directive|if
name|defined
argument_list|(
name|__i386__
argument_list|)
operator|||
name|defined
argument_list|(
name|__amd64__
argument_list|)
name|X
argument_list|(
argument|I386_GET_LDT
argument_list|)
name|X
argument_list|(
argument|I386_SET_LDT
argument_list|)
name|X
argument_list|(
argument|I386_GET_IOPERM
argument_list|)
name|X
argument_list|(
argument|I386_SET_IOPERM
argument_list|)
name|X
argument_list|(
argument|I386_VM86
argument_list|)
name|X
argument_list|(
argument|I386_GET_FSBASE
argument_list|)
name|X
argument_list|(
argument|I386_SET_FSBASE
argument_list|)
name|X
argument_list|(
argument|I386_GET_GSBASE
argument_list|)
name|X
argument_list|(
argument|I386_SET_GSBASE
argument_list|)
name|X
argument_list|(
argument|I386_GET_XFPUSTATE
argument_list|)
name|X
argument_list|(
argument|AMD64_GET_FSBASE
argument_list|)
name|X
argument_list|(
argument|AMD64_SET_FSBASE
argument_list|)
name|X
argument_list|(
argument|AMD64_GET_GSBASE
argument_list|)
name|X
argument_list|(
argument|AMD64_SET_GSBASE
argument_list|)
name|X
argument_list|(
argument|AMD64_GET_XFPUSTATE
argument_list|)
endif|#
directive|endif
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|linux_socketcall_ops
index|[]
init|=
block|{
name|X
argument_list|(
argument|LINUX_SOCKET
argument_list|)
name|X
argument_list|(
argument|LINUX_BIND
argument_list|)
name|X
argument_list|(
argument|LINUX_CONNECT
argument_list|)
name|X
argument_list|(
argument|LINUX_LISTEN
argument_list|)
name|X
argument_list|(
argument|LINUX_ACCEPT
argument_list|)
name|X
argument_list|(
argument|LINUX_GETSOCKNAME
argument_list|)
name|X
argument_list|(
argument|LINUX_GETPEERNAME
argument_list|)
name|X
argument_list|(
argument|LINUX_SOCKETPAIR
argument_list|)
name|X
argument_list|(
argument|LINUX_SEND
argument_list|)
name|X
argument_list|(
argument|LINUX_RECV
argument_list|)
name|X
argument_list|(
argument|LINUX_SENDTO
argument_list|)
name|X
argument_list|(
argument|LINUX_RECVFROM
argument_list|)
name|X
argument_list|(
argument|LINUX_SHUTDOWN
argument_list|)
name|X
argument_list|(
argument|LINUX_SETSOCKOPT
argument_list|)
name|X
argument_list|(
argument|LINUX_GETSOCKOPT
argument_list|)
name|X
argument_list|(
argument|LINUX_SENDMSG
argument_list|)
name|X
argument_list|(
argument|LINUX_RECVMSG
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_undef
undef|#
directive|undef
name|X
end_undef

begin_define
define|#
directive|define
name|X
parameter_list|(
name|a
parameter_list|)
value|{ CLOUDABI_##a, #a },
end_define

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_advice
index|[]
init|=
block|{
name|X
argument_list|(
argument|ADVICE_DONTNEED
argument_list|)
name|X
argument_list|(
argument|ADVICE_NOREUSE
argument_list|)
name|X
argument_list|(
argument|ADVICE_NORMAL
argument_list|)
name|X
argument_list|(
argument|ADVICE_RANDOM
argument_list|)
name|X
argument_list|(
argument|ADVICE_SEQUENTIAL
argument_list|)
name|X
argument_list|(
argument|ADVICE_WILLNEED
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_clockid
index|[]
init|=
block|{
name|X
argument_list|(
argument|CLOCK_MONOTONIC
argument_list|)
name|X
argument_list|(
argument|CLOCK_PROCESS_CPUTIME_ID
argument_list|)
name|X
argument_list|(
argument|CLOCK_REALTIME
argument_list|)
name|X
argument_list|(
argument|CLOCK_THREAD_CPUTIME_ID
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_errno
index|[]
init|=
block|{
name|X
argument_list|(
argument|E2BIG
argument_list|)
name|X
argument_list|(
argument|EACCES
argument_list|)
name|X
argument_list|(
argument|EADDRINUSE
argument_list|)
name|X
argument_list|(
argument|EADDRNOTAVAIL
argument_list|)
name|X
argument_list|(
argument|EAFNOSUPPORT
argument_list|)
name|X
argument_list|(
argument|EAGAIN
argument_list|)
name|X
argument_list|(
argument|EALREADY
argument_list|)
name|X
argument_list|(
argument|EBADF
argument_list|)
name|X
argument_list|(
argument|EBADMSG
argument_list|)
name|X
argument_list|(
argument|EBUSY
argument_list|)
name|X
argument_list|(
argument|ECANCELED
argument_list|)
name|X
argument_list|(
argument|ECHILD
argument_list|)
name|X
argument_list|(
argument|ECONNABORTED
argument_list|)
name|X
argument_list|(
argument|ECONNREFUSED
argument_list|)
name|X
argument_list|(
argument|ECONNRESET
argument_list|)
name|X
argument_list|(
argument|EDEADLK
argument_list|)
name|X
argument_list|(
argument|EDESTADDRREQ
argument_list|)
name|X
argument_list|(
argument|EDOM
argument_list|)
name|X
argument_list|(
argument|EDQUOT
argument_list|)
name|X
argument_list|(
argument|EEXIST
argument_list|)
name|X
argument_list|(
argument|EFAULT
argument_list|)
name|X
argument_list|(
argument|EFBIG
argument_list|)
name|X
argument_list|(
argument|EHOSTUNREACH
argument_list|)
name|X
argument_list|(
argument|EIDRM
argument_list|)
name|X
argument_list|(
argument|EILSEQ
argument_list|)
name|X
argument_list|(
argument|EINPROGRESS
argument_list|)
name|X
argument_list|(
argument|EINTR
argument_list|)
name|X
argument_list|(
argument|EINVAL
argument_list|)
name|X
argument_list|(
argument|EIO
argument_list|)
name|X
argument_list|(
argument|EISCONN
argument_list|)
name|X
argument_list|(
argument|EISDIR
argument_list|)
name|X
argument_list|(
argument|ELOOP
argument_list|)
name|X
argument_list|(
argument|EMFILE
argument_list|)
name|X
argument_list|(
argument|EMLINK
argument_list|)
name|X
argument_list|(
argument|EMSGSIZE
argument_list|)
name|X
argument_list|(
argument|EMULTIHOP
argument_list|)
name|X
argument_list|(
argument|ENAMETOOLONG
argument_list|)
name|X
argument_list|(
argument|ENETDOWN
argument_list|)
name|X
argument_list|(
argument|ENETRESET
argument_list|)
name|X
argument_list|(
argument|ENETUNREACH
argument_list|)
name|X
argument_list|(
argument|ENFILE
argument_list|)
name|X
argument_list|(
argument|ENOBUFS
argument_list|)
name|X
argument_list|(
argument|ENODEV
argument_list|)
name|X
argument_list|(
argument|ENOENT
argument_list|)
name|X
argument_list|(
argument|ENOEXEC
argument_list|)
name|X
argument_list|(
argument|ENOLCK
argument_list|)
name|X
argument_list|(
argument|ENOLINK
argument_list|)
name|X
argument_list|(
argument|ENOMEM
argument_list|)
name|X
argument_list|(
argument|ENOMSG
argument_list|)
name|X
argument_list|(
argument|ENOPROTOOPT
argument_list|)
name|X
argument_list|(
argument|ENOSPC
argument_list|)
name|X
argument_list|(
argument|ENOSYS
argument_list|)
name|X
argument_list|(
argument|ENOTCONN
argument_list|)
name|X
argument_list|(
argument|ENOTDIR
argument_list|)
name|X
argument_list|(
argument|ENOTEMPTY
argument_list|)
name|X
argument_list|(
argument|ENOTRECOVERABLE
argument_list|)
name|X
argument_list|(
argument|ENOTSOCK
argument_list|)
name|X
argument_list|(
argument|ENOTSUP
argument_list|)
name|X
argument_list|(
argument|ENOTTY
argument_list|)
name|X
argument_list|(
argument|ENXIO
argument_list|)
name|X
argument_list|(
argument|EOVERFLOW
argument_list|)
name|X
argument_list|(
argument|EOWNERDEAD
argument_list|)
name|X
argument_list|(
argument|EPERM
argument_list|)
name|X
argument_list|(
argument|EPIPE
argument_list|)
name|X
argument_list|(
argument|EPROTO
argument_list|)
name|X
argument_list|(
argument|EPROTONOSUPPORT
argument_list|)
name|X
argument_list|(
argument|EPROTOTYPE
argument_list|)
name|X
argument_list|(
argument|ERANGE
argument_list|)
name|X
argument_list|(
argument|EROFS
argument_list|)
name|X
argument_list|(
argument|ESPIPE
argument_list|)
name|X
argument_list|(
argument|ESRCH
argument_list|)
name|X
argument_list|(
argument|ESTALE
argument_list|)
name|X
argument_list|(
argument|ETIMEDOUT
argument_list|)
name|X
argument_list|(
argument|ETXTBSY
argument_list|)
name|X
argument_list|(
argument|EXDEV
argument_list|)
name|X
argument_list|(
argument|ENOTCAPABLE
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_fdflags
index|[]
init|=
block|{
name|X
argument_list|(
argument|FDFLAG_APPEND
argument_list|)
name|X
argument_list|(
argument|FDFLAG_DSYNC
argument_list|)
name|X
argument_list|(
argument|FDFLAG_NONBLOCK
argument_list|)
name|X
argument_list|(
argument|FDFLAG_RSYNC
argument_list|)
name|X
argument_list|(
argument|FDFLAG_SYNC
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_fdsflags
index|[]
init|=
block|{
name|X
argument_list|(
argument|FDSTAT_FLAGS
argument_list|)
name|X
argument_list|(
argument|FDSTAT_RIGHTS
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_filetype
index|[]
init|=
block|{
name|X
argument_list|(
argument|FILETYPE_UNKNOWN
argument_list|)
name|X
argument_list|(
argument|FILETYPE_BLOCK_DEVICE
argument_list|)
name|X
argument_list|(
argument|FILETYPE_CHARACTER_DEVICE
argument_list|)
name|X
argument_list|(
argument|FILETYPE_DIRECTORY
argument_list|)
name|X
argument_list|(
argument|FILETYPE_FIFO
argument_list|)
name|X
argument_list|(
argument|FILETYPE_POLL
argument_list|)
name|X
argument_list|(
argument|FILETYPE_PROCESS
argument_list|)
name|X
argument_list|(
argument|FILETYPE_REGULAR_FILE
argument_list|)
name|X
argument_list|(
argument|FILETYPE_SHARED_MEMORY
argument_list|)
name|X
argument_list|(
argument|FILETYPE_SOCKET_DGRAM
argument_list|)
name|X
argument_list|(
argument|FILETYPE_SOCKET_SEQPACKET
argument_list|)
name|X
argument_list|(
argument|FILETYPE_SOCKET_STREAM
argument_list|)
name|X
argument_list|(
argument|FILETYPE_SYMBOLIC_LINK
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_fsflags
index|[]
init|=
block|{
name|X
argument_list|(
argument|FILESTAT_ATIM
argument_list|)
name|X
argument_list|(
argument|FILESTAT_ATIM_NOW
argument_list|)
name|X
argument_list|(
argument|FILESTAT_MTIM
argument_list|)
name|X
argument_list|(
argument|FILESTAT_MTIM_NOW
argument_list|)
name|X
argument_list|(
argument|FILESTAT_SIZE
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_mflags
index|[]
init|=
block|{
name|X
argument_list|(
argument|MAP_ANON
argument_list|)
name|X
argument_list|(
argument|MAP_FIXED
argument_list|)
name|X
argument_list|(
argument|MAP_PRIVATE
argument_list|)
name|X
argument_list|(
argument|MAP_SHARED
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_mprot
index|[]
init|=
block|{
name|X
argument_list|(
argument|PROT_EXEC
argument_list|)
name|X
argument_list|(
argument|PROT_WRITE
argument_list|)
name|X
argument_list|(
argument|PROT_READ
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_msflags
index|[]
init|=
block|{
name|X
argument_list|(
argument|MS_ASYNC
argument_list|)
name|X
argument_list|(
argument|MS_INVALIDATE
argument_list|)
name|X
argument_list|(
argument|MS_SYNC
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_oflags
index|[]
init|=
block|{
name|X
argument_list|(
argument|O_CREAT
argument_list|)
name|X
argument_list|(
argument|O_DIRECTORY
argument_list|)
name|X
argument_list|(
argument|O_EXCL
argument_list|)
name|X
argument_list|(
argument|O_TRUNC
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_sa_family
index|[]
init|=
block|{
name|X
argument_list|(
argument|AF_UNSPEC
argument_list|)
name|X
argument_list|(
argument|AF_INET
argument_list|)
name|X
argument_list|(
argument|AF_INET6
argument_list|)
name|X
argument_list|(
argument|AF_UNIX
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_sdflags
index|[]
init|=
block|{
name|X
argument_list|(
argument|SHUT_RD
argument_list|)
name|X
argument_list|(
argument|SHUT_WR
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_signal
index|[]
init|=
block|{
name|X
argument_list|(
argument|SIGABRT
argument_list|)
name|X
argument_list|(
argument|SIGALRM
argument_list|)
name|X
argument_list|(
argument|SIGBUS
argument_list|)
name|X
argument_list|(
argument|SIGCHLD
argument_list|)
name|X
argument_list|(
argument|SIGCONT
argument_list|)
name|X
argument_list|(
argument|SIGFPE
argument_list|)
name|X
argument_list|(
argument|SIGHUP
argument_list|)
name|X
argument_list|(
argument|SIGILL
argument_list|)
name|X
argument_list|(
argument|SIGINT
argument_list|)
name|X
argument_list|(
argument|SIGKILL
argument_list|)
name|X
argument_list|(
argument|SIGPIPE
argument_list|)
name|X
argument_list|(
argument|SIGQUIT
argument_list|)
name|X
argument_list|(
argument|SIGSEGV
argument_list|)
name|X
argument_list|(
argument|SIGSTOP
argument_list|)
name|X
argument_list|(
argument|SIGSYS
argument_list|)
name|X
argument_list|(
argument|SIGTERM
argument_list|)
name|X
argument_list|(
argument|SIGTRAP
argument_list|)
name|X
argument_list|(
argument|SIGTSTP
argument_list|)
name|X
argument_list|(
argument|SIGTTIN
argument_list|)
name|X
argument_list|(
argument|SIGTTOU
argument_list|)
name|X
argument_list|(
argument|SIGURG
argument_list|)
name|X
argument_list|(
argument|SIGUSR1
argument_list|)
name|X
argument_list|(
argument|SIGUSR2
argument_list|)
name|X
argument_list|(
argument|SIGVTALRM
argument_list|)
name|X
argument_list|(
argument|SIGXCPU
argument_list|)
name|X
argument_list|(
argument|SIGXFSZ
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_ssflags
index|[]
init|=
block|{
name|X
argument_list|(
argument|SOCKSTAT_CLEAR_ERROR
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_ssstate
index|[]
init|=
block|{
name|X
argument_list|(
argument|SOCKSTATE_ACCEPTCONN
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_ulflags
index|[]
init|=
block|{
name|X
argument_list|(
argument|UNLINK_REMOVEDIR
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|xlat
name|cloudabi_whence
index|[]
init|=
block|{
name|X
argument_list|(
argument|WHENCE_CUR
argument_list|)
name|X
argument_list|(
argument|WHENCE_END
argument_list|)
name|X
argument_list|(
argument|WHENCE_SET
argument_list|)
name|XEND
block|}
decl_stmt|;
end_decl_stmt

begin_undef
undef|#
directive|undef
name|X
end_undef

begin_undef
undef|#
directive|undef
name|XEND
end_undef

begin_comment
comment|/*  * Searches an xlat array for a value, and returns it if found.  Otherwise  * return a string representation.  */
end_comment

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|lookup
parameter_list|(
name|struct
name|xlat
modifier|*
name|xlat
parameter_list|,
name|int
name|val
parameter_list|,
name|int
name|base
parameter_list|)
block|{
specifier|static
name|char
name|tmp
index|[
literal|16
index|]
decl_stmt|;
for|for
control|(
init|;
name|xlat
operator|->
name|str
operator|!=
name|NULL
condition|;
name|xlat
operator|++
control|)
if|if
condition|(
name|xlat
operator|->
name|val
operator|==
name|val
condition|)
return|return
operator|(
name|xlat
operator|->
name|str
operator|)
return|;
switch|switch
condition|(
name|base
condition|)
block|{
case|case
literal|8
case|:
name|sprintf
argument_list|(
name|tmp
argument_list|,
literal|"0%o"
argument_list|,
name|val
argument_list|)
expr_stmt|;
break|break;
case|case
literal|16
case|:
name|sprintf
argument_list|(
name|tmp
argument_list|,
literal|"0x%x"
argument_list|,
name|val
argument_list|)
expr_stmt|;
break|break;
case|case
literal|10
case|:
name|sprintf
argument_list|(
name|tmp
argument_list|,
literal|"%u"
argument_list|,
name|val
argument_list|)
expr_stmt|;
break|break;
default|default:
name|errx
argument_list|(
literal|1
argument_list|,
literal|"Unknown lookup base"
argument_list|)
expr_stmt|;
break|break;
block|}
return|return
operator|(
name|tmp
operator|)
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|xlookup
parameter_list|(
name|struct
name|xlat
modifier|*
name|xlat
parameter_list|,
name|int
name|val
parameter_list|)
block|{
return|return
operator|(
name|lookup
argument_list|(
name|xlat
argument_list|,
name|val
argument_list|,
literal|16
argument_list|)
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Searches an xlat array containing bitfield values.  Remaining bits  * set after removing the known ones are printed at the end:  * IN|0x400.  */
end_comment

begin_function
specifier|static
name|char
modifier|*
name|xlookup_bits
parameter_list|(
name|struct
name|xlat
modifier|*
name|xlat
parameter_list|,
name|int
name|val
parameter_list|)
block|{
name|int
name|len
decl_stmt|,
name|rem
decl_stmt|;
specifier|static
name|char
name|str
index|[
literal|512
index|]
decl_stmt|;
name|len
operator|=
literal|0
expr_stmt|;
name|rem
operator|=
name|val
expr_stmt|;
for|for
control|(
init|;
name|xlat
operator|->
name|str
operator|!=
name|NULL
condition|;
name|xlat
operator|++
control|)
block|{
if|if
condition|(
operator|(
name|xlat
operator|->
name|val
operator|&
name|rem
operator|)
operator|==
name|xlat
operator|->
name|val
condition|)
block|{
comment|/* 			 * Don't print the "all-bits-zero" string unless all 			 * bits are really zero. 			 */
if|if
condition|(
name|xlat
operator|->
name|val
operator|==
literal|0
operator|&&
name|val
operator|!=
literal|0
condition|)
continue|continue;
name|len
operator|+=
name|sprintf
argument_list|(
name|str
operator|+
name|len
argument_list|,
literal|"%s|"
argument_list|,
name|xlat
operator|->
name|str
argument_list|)
expr_stmt|;
name|rem
operator|&=
operator|~
operator|(
name|xlat
operator|->
name|val
operator|)
expr_stmt|;
block|}
block|}
comment|/* 	 * If we have leftover bits or didn't match anything, print 	 * the remainder. 	 */
if|if
condition|(
name|rem
operator|||
name|len
operator|==
literal|0
condition|)
name|len
operator|+=
name|sprintf
argument_list|(
name|str
operator|+
name|len
argument_list|,
literal|"0x%x"
argument_list|,
name|rem
argument_list|)
expr_stmt|;
if|if
condition|(
name|len
operator|&&
name|str
index|[
name|len
operator|-
literal|1
index|]
operator|==
literal|'|'
condition|)
name|len
operator|--
expr_stmt|;
name|str
index|[
name|len
index|]
operator|=
literal|0
expr_stmt|;
return|return
operator|(
name|str
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|print_integer_arg
parameter_list|(
specifier|const
name|char
modifier|*
function_decl|(
modifier|*
name|decoder
function_decl|)
parameter_list|(
name|int
parameter_list|)
parameter_list|,
name|FILE
modifier|*
name|fp
parameter_list|,
name|int
name|value
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|str
decl_stmt|;
name|str
operator|=
name|decoder
argument_list|(
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
name|str
operator|!=
name|NULL
condition|)
name|fputs
argument_list|(
name|str
argument_list|,
name|fp
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%d"
argument_list|,
name|value
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|print_mask_arg
parameter_list|(
name|bool
function_decl|(
modifier|*
name|decoder
function_decl|)
parameter_list|(
name|FILE
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
modifier|*
parameter_list|)
parameter_list|,
name|FILE
modifier|*
name|fp
parameter_list|,
name|int
name|value
parameter_list|)
block|{
name|int
name|rem
decl_stmt|;
if|if
condition|(
operator|!
name|decoder
argument_list|(
name|fp
argument_list|,
name|value
argument_list|,
operator|&
name|rem
argument_list|)
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%x"
argument_list|,
name|rem
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|rem
operator|!=
literal|0
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"|0x%x"
argument_list|,
name|rem
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|print_mask_arg32
parameter_list|(
name|bool
function_decl|(
modifier|*
name|decoder
function_decl|)
parameter_list|(
name|FILE
modifier|*
parameter_list|,
name|uint32_t
parameter_list|,
name|uint32_t
modifier|*
parameter_list|)
parameter_list|,
name|FILE
modifier|*
name|fp
parameter_list|,
name|uint32_t
name|value
parameter_list|)
block|{
name|uint32_t
name|rem
decl_stmt|;
if|if
condition|(
operator|!
name|decoder
argument_list|(
name|fp
argument_list|,
name|value
argument_list|,
operator|&
name|rem
argument_list|)
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%x"
argument_list|,
name|rem
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|rem
operator|!=
literal|0
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"|0x%x"
argument_list|,
name|rem
argument_list|)
expr_stmt|;
block|}
end_function

begin_ifndef
ifndef|#
directive|ifndef
name|__LP64__
end_ifndef

begin_comment
comment|/*  * Add argument padding to subsequent system calls afater a Quad  * syscall arguments as needed.  This used to be done by hand in the  * decoded_syscalls table which was ugly and error prone.  It is  * simpler to do the fixup of offsets at initalization time than when  * decoding arguments.  */
end_comment

begin_function
specifier|static
name|void
name|quad_fixup
parameter_list|(
name|struct
name|syscall
modifier|*
name|sc
parameter_list|)
block|{
name|int
name|offset
decl_stmt|,
name|prev
decl_stmt|;
name|u_int
name|i
decl_stmt|;
name|offset
operator|=
literal|0
expr_stmt|;
name|prev
operator|=
operator|-
literal|1
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|sc
operator|->
name|nargs
condition|;
name|i
operator|++
control|)
block|{
comment|/* This arg type is a dummy that doesn't use offset. */
if|if
condition|(
operator|(
name|sc
operator|->
name|args
index|[
name|i
index|]
operator|.
name|type
operator|&
name|ARG_MASK
operator|)
operator|==
name|PipeFds
condition|)
continue|continue;
name|assert
argument_list|(
name|prev
operator|<
name|sc
operator|->
name|args
index|[
name|i
index|]
operator|.
name|offset
argument_list|)
expr_stmt|;
name|prev
operator|=
name|sc
operator|->
name|args
index|[
name|i
index|]
operator|.
name|offset
expr_stmt|;
name|sc
operator|->
name|args
index|[
name|i
index|]
operator|.
name|offset
operator|+=
name|offset
expr_stmt|;
switch|switch
condition|(
name|sc
operator|->
name|args
index|[
name|i
index|]
operator|.
name|type
operator|&
name|ARG_MASK
condition|)
block|{
case|case
name|Quad
case|:
case|case
name|QuadHex
case|:
ifdef|#
directive|ifdef
name|__powerpc__
comment|/* 			 * 64-bit arguments on 32-bit powerpc must be 			 * 64-bit aligned.  If the current offset is 			 * not aligned, the calling convention inserts 			 * a 32-bit pad argument that should be skipped. 			 */
if|if
condition|(
name|sc
operator|->
name|args
index|[
name|i
index|]
operator|.
name|offset
operator|%
literal|2
operator|==
literal|1
condition|)
block|{
name|sc
operator|->
name|args
index|[
name|i
index|]
operator|.
name|offset
operator|++
expr_stmt|;
name|offset
operator|++
expr_stmt|;
block|}
endif|#
directive|endif
name|offset
operator|++
expr_stmt|;
default|default:
break|break;
block|}
block|}
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_function
name|void
name|init_syscalls
parameter_list|(
name|void
parameter_list|)
block|{
name|struct
name|syscall
modifier|*
name|sc
decl_stmt|;
name|STAILQ_INIT
argument_list|(
operator|&
name|syscalls
argument_list|)
expr_stmt|;
for|for
control|(
name|sc
operator|=
name|decoded_syscalls
init|;
name|sc
operator|->
name|name
operator|!=
name|NULL
condition|;
name|sc
operator|++
control|)
block|{
ifndef|#
directive|ifndef
name|__LP64__
name|quad_fixup
argument_list|(
name|sc
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|STAILQ_INSERT_HEAD
argument_list|(
operator|&
name|syscalls
argument_list|,
name|sc
argument_list|,
name|entries
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|struct
name|syscall
modifier|*
name|find_syscall
parameter_list|(
name|struct
name|procabi
modifier|*
name|abi
parameter_list|,
name|u_int
name|number
parameter_list|)
block|{
name|struct
name|extra_syscall
modifier|*
name|es
decl_stmt|;
if|if
condition|(
name|number
operator|<
name|nitems
argument_list|(
name|abi
operator|->
name|syscalls
argument_list|)
condition|)
return|return
operator|(
name|abi
operator|->
name|syscalls
index|[
name|number
index|]
operator|)
return|;
name|STAILQ_FOREACH
argument_list|(
argument|es
argument_list|,
argument|&abi->extra_syscalls
argument_list|,
argument|entries
argument_list|)
block|{
if|if
condition|(
name|es
operator|->
name|number
operator|==
name|number
condition|)
return|return
operator|(
name|es
operator|->
name|sc
operator|)
return|;
block|}
return|return
operator|(
name|NULL
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|add_syscall
parameter_list|(
name|struct
name|procabi
modifier|*
name|abi
parameter_list|,
name|u_int
name|number
parameter_list|,
name|struct
name|syscall
modifier|*
name|sc
parameter_list|)
block|{
name|struct
name|extra_syscall
modifier|*
name|es
decl_stmt|;
if|if
condition|(
name|number
operator|<
name|nitems
argument_list|(
name|abi
operator|->
name|syscalls
argument_list|)
condition|)
block|{
name|assert
argument_list|(
name|abi
operator|->
name|syscalls
index|[
name|number
index|]
operator|==
name|NULL
argument_list|)
expr_stmt|;
name|abi
operator|->
name|syscalls
index|[
name|number
index|]
operator|=
name|sc
expr_stmt|;
block|}
else|else
block|{
name|es
operator|=
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
operator|*
name|es
argument_list|)
argument_list|)
expr_stmt|;
name|es
operator|->
name|sc
operator|=
name|sc
expr_stmt|;
name|es
operator|->
name|number
operator|=
name|number
expr_stmt|;
name|STAILQ_INSERT_TAIL
argument_list|(
operator|&
name|abi
operator|->
name|extra_syscalls
argument_list|,
name|es
argument_list|,
name|entries
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*  * If/when the list gets big, it might be desirable to do it  * as a hash table or binary search.  */
end_comment

begin_function
name|struct
name|syscall
modifier|*
name|get_syscall
parameter_list|(
name|struct
name|threadinfo
modifier|*
name|t
parameter_list|,
name|u_int
name|number
parameter_list|,
name|u_int
name|nargs
parameter_list|)
block|{
name|struct
name|syscall
modifier|*
name|sc
decl_stmt|;
specifier|const
name|char
modifier|*
name|name
decl_stmt|;
name|char
modifier|*
name|new_name
decl_stmt|;
name|u_int
name|i
decl_stmt|;
name|sc
operator|=
name|find_syscall
argument_list|(
name|t
operator|->
name|proc
operator|->
name|abi
argument_list|,
name|number
argument_list|)
expr_stmt|;
if|if
condition|(
name|sc
operator|!=
name|NULL
condition|)
return|return
operator|(
name|sc
operator|)
return|;
name|name
operator|=
name|sysdecode_syscallname
argument_list|(
name|t
operator|->
name|proc
operator|->
name|abi
operator|->
name|abi
argument_list|,
name|number
argument_list|)
expr_stmt|;
if|if
condition|(
name|name
operator|==
name|NULL
condition|)
block|{
name|asprintf
argument_list|(
operator|&
name|new_name
argument_list|,
literal|"#%d"
argument_list|,
name|number
argument_list|)
expr_stmt|;
name|name
operator|=
name|new_name
expr_stmt|;
block|}
else|else
name|new_name
operator|=
name|NULL
expr_stmt|;
name|STAILQ_FOREACH
argument_list|(
argument|sc
argument_list|,
argument|&syscalls
argument_list|,
argument|entries
argument_list|)
block|{
if|if
condition|(
name|strcmp
argument_list|(
name|name
argument_list|,
name|sc
operator|->
name|name
argument_list|)
operator|==
literal|0
condition|)
block|{
name|add_syscall
argument_list|(
name|t
operator|->
name|proc
operator|->
name|abi
argument_list|,
name|number
argument_list|,
name|sc
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|new_name
argument_list|)
expr_stmt|;
return|return
operator|(
name|sc
operator|)
return|;
block|}
block|}
comment|/* It is unknown.  Add it into the list. */
if|#
directive|if
name|DEBUG
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"unknown syscall %s -- setting args to %d\n"
argument_list|,
name|name
argument_list|,
name|nargs
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|sc
operator|=
name|calloc
argument_list|(
literal|1
argument_list|,
sizeof|sizeof
argument_list|(
expr|struct
name|syscall
argument_list|)
argument_list|)
expr_stmt|;
name|sc
operator|->
name|name
operator|=
name|name
expr_stmt|;
if|if
condition|(
name|new_name
operator|!=
name|NULL
condition|)
name|sc
operator|->
name|unknown
operator|=
name|true
expr_stmt|;
name|sc
operator|->
name|ret_type
operator|=
literal|1
expr_stmt|;
name|sc
operator|->
name|nargs
operator|=
name|nargs
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nargs
condition|;
name|i
operator|++
control|)
block|{
name|sc
operator|->
name|args
index|[
name|i
index|]
operator|.
name|offset
operator|=
name|i
expr_stmt|;
comment|/* Treat all unknown arguments as LongHex. */
name|sc
operator|->
name|args
index|[
name|i
index|]
operator|.
name|type
operator|=
name|LongHex
expr_stmt|;
block|}
name|STAILQ_INSERT_HEAD
argument_list|(
operator|&
name|syscalls
argument_list|,
name|sc
argument_list|,
name|entries
argument_list|)
expr_stmt|;
name|add_syscall
argument_list|(
name|t
operator|->
name|proc
operator|->
name|abi
argument_list|,
name|number
argument_list|,
name|sc
argument_list|)
expr_stmt|;
return|return
operator|(
name|sc
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Copy a fixed amount of bytes from the process.  */
end_comment

begin_function
specifier|static
name|int
name|get_struct
parameter_list|(
name|pid_t
name|pid
parameter_list|,
name|void
modifier|*
name|offset
parameter_list|,
name|void
modifier|*
name|buf
parameter_list|,
name|int
name|len
parameter_list|)
block|{
name|struct
name|ptrace_io_desc
name|iorequest
decl_stmt|;
name|iorequest
operator|.
name|piod_op
operator|=
name|PIOD_READ_D
expr_stmt|;
name|iorequest
operator|.
name|piod_offs
operator|=
name|offset
expr_stmt|;
name|iorequest
operator|.
name|piod_addr
operator|=
name|buf
expr_stmt|;
name|iorequest
operator|.
name|piod_len
operator|=
name|len
expr_stmt|;
if|if
condition|(
name|ptrace
argument_list|(
name|PT_IO
argument_list|,
name|pid
argument_list|,
operator|(
name|caddr_t
operator|)
operator|&
name|iorequest
argument_list|,
literal|0
argument_list|)
operator|<
literal|0
condition|)
return|return
operator|(
operator|-
literal|1
operator|)
return|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_define
define|#
directive|define
name|MAXSIZE
value|4096
end_define

begin_comment
comment|/*  * Copy a string from the process.  Note that it is  * expected to be a C string, but if max is set, it will  * only get that much.  */
end_comment

begin_function
specifier|static
name|char
modifier|*
name|get_string
parameter_list|(
name|pid_t
name|pid
parameter_list|,
name|void
modifier|*
name|addr
parameter_list|,
name|int
name|max
parameter_list|)
block|{
name|struct
name|ptrace_io_desc
name|iorequest
decl_stmt|;
name|char
modifier|*
name|buf
decl_stmt|,
modifier|*
name|nbuf
decl_stmt|;
name|size_t
name|offset
decl_stmt|,
name|size
decl_stmt|,
name|totalsize
decl_stmt|;
name|offset
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|max
condition|)
name|size
operator|=
name|max
operator|+
literal|1
expr_stmt|;
else|else
block|{
comment|/* Read up to the end of the current page. */
name|size
operator|=
name|PAGE_SIZE
operator|-
operator|(
operator|(
name|uintptr_t
operator|)
name|addr
operator|%
name|PAGE_SIZE
operator|)
expr_stmt|;
if|if
condition|(
name|size
operator|>
name|MAXSIZE
condition|)
name|size
operator|=
name|MAXSIZE
expr_stmt|;
block|}
name|totalsize
operator|=
name|size
expr_stmt|;
name|buf
operator|=
name|malloc
argument_list|(
name|totalsize
argument_list|)
expr_stmt|;
if|if
condition|(
name|buf
operator|==
name|NULL
condition|)
return|return
operator|(
name|NULL
operator|)
return|;
for|for
control|(
init|;
condition|;
control|)
block|{
name|iorequest
operator|.
name|piod_op
operator|=
name|PIOD_READ_D
expr_stmt|;
name|iorequest
operator|.
name|piod_offs
operator|=
operator|(
name|char
operator|*
operator|)
name|addr
operator|+
name|offset
expr_stmt|;
name|iorequest
operator|.
name|piod_addr
operator|=
name|buf
operator|+
name|offset
expr_stmt|;
name|iorequest
operator|.
name|piod_len
operator|=
name|size
expr_stmt|;
if|if
condition|(
name|ptrace
argument_list|(
name|PT_IO
argument_list|,
name|pid
argument_list|,
operator|(
name|caddr_t
operator|)
operator|&
name|iorequest
argument_list|,
literal|0
argument_list|)
operator|<
literal|0
condition|)
block|{
name|free
argument_list|(
name|buf
argument_list|)
expr_stmt|;
return|return
operator|(
name|NULL
operator|)
return|;
block|}
if|if
condition|(
name|memchr
argument_list|(
name|buf
operator|+
name|offset
argument_list|,
literal|'\0'
argument_list|,
name|size
argument_list|)
operator|!=
name|NULL
condition|)
return|return
operator|(
name|buf
operator|)
return|;
name|offset
operator|+=
name|size
expr_stmt|;
if|if
condition|(
name|totalsize
operator|<
name|MAXSIZE
operator|&&
name|max
operator|==
literal|0
condition|)
block|{
name|size
operator|=
name|MAXSIZE
operator|-
name|totalsize
expr_stmt|;
if|if
condition|(
name|size
operator|>
name|PAGE_SIZE
condition|)
name|size
operator|=
name|PAGE_SIZE
expr_stmt|;
name|nbuf
operator|=
name|realloc
argument_list|(
name|buf
argument_list|,
name|totalsize
operator|+
name|size
argument_list|)
expr_stmt|;
if|if
condition|(
name|nbuf
operator|==
name|NULL
condition|)
block|{
name|buf
index|[
name|totalsize
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
return|return
operator|(
name|buf
operator|)
return|;
block|}
name|buf
operator|=
name|nbuf
expr_stmt|;
name|totalsize
operator|+=
name|size
expr_stmt|;
block|}
else|else
block|{
name|buf
index|[
name|totalsize
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
return|return
operator|(
name|buf
operator|)
return|;
block|}
block|}
block|}
end_function

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|strsig2
parameter_list|(
name|int
name|sig
parameter_list|)
block|{
specifier|static
name|char
name|tmp
index|[
literal|32
index|]
decl_stmt|;
specifier|const
name|char
modifier|*
name|signame
decl_stmt|;
name|signame
operator|=
name|sysdecode_signal
argument_list|(
name|sig
argument_list|)
expr_stmt|;
if|if
condition|(
name|signame
operator|==
name|NULL
condition|)
block|{
name|snprintf
argument_list|(
name|tmp
argument_list|,
sizeof|sizeof
argument_list|(
name|tmp
argument_list|)
argument_list|,
literal|"%d"
argument_list|,
name|sig
argument_list|)
expr_stmt|;
name|signame
operator|=
name|tmp
expr_stmt|;
block|}
return|return
operator|(
name|signame
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
name|print_kevent
parameter_list|(
name|FILE
modifier|*
name|fp
parameter_list|,
name|struct
name|kevent
modifier|*
name|ke
parameter_list|,
name|int
name|input
parameter_list|)
block|{
switch|switch
condition|(
name|ke
operator|->
name|filter
condition|)
block|{
case|case
name|EVFILT_READ
case|:
case|case
name|EVFILT_WRITE
case|:
case|case
name|EVFILT_VNODE
case|:
case|case
name|EVFILT_PROC
case|:
case|case
name|EVFILT_TIMER
case|:
case|case
name|EVFILT_PROCDESC
case|:
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%ju"
argument_list|,
operator|(
name|uintmax_t
operator|)
name|ke
operator|->
name|ident
argument_list|)
expr_stmt|;
break|break;
case|case
name|EVFILT_SIGNAL
case|:
name|fputs
argument_list|(
name|strsig2
argument_list|(
name|ke
operator|->
name|ident
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
default|default:
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%p"
argument_list|,
operator|(
name|void
operator|*
operator|)
name|ke
operator|->
name|ident
argument_list|)
expr_stmt|;
block|}
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|",%s,%s,"
argument_list|,
name|xlookup
argument_list|(
name|kevent_filters
argument_list|,
name|ke
operator|->
name|filter
argument_list|)
argument_list|,
name|xlookup_bits
argument_list|(
name|kevent_flags
argument_list|,
name|ke
operator|->
name|flags
argument_list|)
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|ke
operator|->
name|filter
condition|)
block|{
case|case
name|EVFILT_READ
case|:
case|case
name|EVFILT_WRITE
case|:
name|fputs
argument_list|(
name|xlookup_bits
argument_list|(
name|kevent_rdwr_fflags
argument_list|,
name|ke
operator|->
name|fflags
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|EVFILT_VNODE
case|:
name|fputs
argument_list|(
name|xlookup_bits
argument_list|(
name|kevent_vnode_fflags
argument_list|,
name|ke
operator|->
name|fflags
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|EVFILT_PROC
case|:
case|case
name|EVFILT_PROCDESC
case|:
name|fputs
argument_list|(
name|xlookup_bits
argument_list|(
name|kevent_proc_fflags
argument_list|,
name|ke
operator|->
name|fflags
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|EVFILT_TIMER
case|:
name|fputs
argument_list|(
name|xlookup_bits
argument_list|(
name|kevent_timer_fflags
argument_list|,
name|ke
operator|->
name|fflags
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|EVFILT_USER
case|:
block|{
name|int
name|ctrl
decl_stmt|,
name|data
decl_stmt|;
name|ctrl
operator|=
name|ke
operator|->
name|fflags
operator|&
name|NOTE_FFCTRLMASK
expr_stmt|;
name|data
operator|=
name|ke
operator|->
name|fflags
operator|&
name|NOTE_FFLAGSMASK
expr_stmt|;
if|if
condition|(
name|input
condition|)
block|{
name|fputs
argument_list|(
name|xlookup
argument_list|(
name|kevent_user_ffctrl
argument_list|,
name|ctrl
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
if|if
condition|(
name|ke
operator|->
name|fflags
operator|&
name|NOTE_TRIGGER
condition|)
name|fputs
argument_list|(
literal|"|NOTE_TRIGGER"
argument_list|,
name|fp
argument_list|)
expr_stmt|;
if|if
condition|(
name|data
operator|!=
literal|0
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"|%#x"
argument_list|,
name|data
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%#x"
argument_list|,
name|data
argument_list|)
expr_stmt|;
block|}
break|break;
block|}
default|default:
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%#x"
argument_list|,
name|ke
operator|->
name|fflags
argument_list|)
expr_stmt|;
block|}
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|",%p,%p"
argument_list|,
operator|(
name|void
operator|*
operator|)
name|ke
operator|->
name|data
argument_list|,
operator|(
name|void
operator|*
operator|)
name|ke
operator|->
name|udata
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|print_utrace
parameter_list|(
name|FILE
modifier|*
name|fp
parameter_list|,
name|void
modifier|*
name|utrace_addr
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
name|unsigned
name|char
modifier|*
name|utrace_buffer
decl_stmt|;
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ "
argument_list|)
expr_stmt|;
if|if
condition|(
name|sysdecode_utrace
argument_list|(
name|fp
argument_list|,
name|utrace_addr
argument_list|,
name|len
argument_list|)
condition|)
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|" }"
argument_list|)
expr_stmt|;
return|return;
block|}
name|utrace_buffer
operator|=
name|utrace_addr
expr_stmt|;
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%zu:"
argument_list|,
name|len
argument_list|)
expr_stmt|;
while|while
condition|(
name|len
operator|--
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|" %02x"
argument_list|,
operator|*
name|utrace_buffer
operator|++
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|" }"
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * Converts a syscall argument into a string.  Said string is  * allocated via malloc(), so needs to be free()'d.  sc is  * a pointer to the syscall description (see above); args is  * an array of all of the system call arguments.  */
end_comment

begin_function
name|char
modifier|*
name|print_arg
parameter_list|(
name|struct
name|syscall_args
modifier|*
name|sc
parameter_list|,
name|unsigned
name|long
modifier|*
name|args
parameter_list|,
name|long
modifier|*
name|retval
parameter_list|,
name|struct
name|trussinfo
modifier|*
name|trussinfo
parameter_list|)
block|{
name|FILE
modifier|*
name|fp
decl_stmt|;
name|char
modifier|*
name|tmp
decl_stmt|;
name|size_t
name|tmplen
decl_stmt|;
name|pid_t
name|pid
decl_stmt|;
name|fp
operator|=
name|open_memstream
argument_list|(
operator|&
name|tmp
argument_list|,
operator|&
name|tmplen
argument_list|)
expr_stmt|;
name|pid
operator|=
name|trussinfo
operator|->
name|curthread
operator|->
name|proc
operator|->
name|pid
expr_stmt|;
switch|switch
condition|(
name|sc
operator|->
name|type
operator|&
name|ARG_MASK
condition|)
block|{
case|case
name|Hex
case|:
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%x"
argument_list|,
operator|(
name|int
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Octal
case|:
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0%o"
argument_list|,
operator|(
name|int
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Int
case|:
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%d"
argument_list|,
operator|(
name|int
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|UInt
case|:
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%u"
argument_list|,
operator|(
name|unsigned
name|int
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|LongHex
case|:
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Long
case|:
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%ld"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Name
case|:
block|{
comment|/* NULL-terminated string. */
name|char
modifier|*
name|tmp2
decl_stmt|;
name|tmp2
operator|=
name|get_string
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"\"%s\""
argument_list|,
name|tmp2
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|tmp2
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|BinString
case|:
block|{
comment|/* 		 * Binary block of data that might have printable characters. 		 * XXX If type|OUT, assume that the length is the syscall's 		 * return value.  Otherwise, assume that the length of the block 		 * is in the next syscall argument. 		 */
name|int
name|max_string
init|=
name|trussinfo
operator|->
name|strsize
decl_stmt|;
name|char
name|tmp2
index|[
name|max_string
operator|+
literal|1
index|]
decl_stmt|,
modifier|*
name|tmp3
decl_stmt|;
name|int
name|len
decl_stmt|;
name|int
name|truncated
init|=
literal|0
decl_stmt|;
if|if
condition|(
name|sc
operator|->
name|type
operator|&
name|OUT
condition|)
name|len
operator|=
name|retval
index|[
literal|0
index|]
expr_stmt|;
else|else
name|len
operator|=
name|args
index|[
name|sc
operator|->
name|offset
operator|+
literal|1
index|]
expr_stmt|;
comment|/* 		 * Don't print more than max_string characters, to avoid word 		 * wrap.  If we have to truncate put some ... after the string. 		 */
if|if
condition|(
name|len
operator|>
name|max_string
condition|)
block|{
name|len
operator|=
name|max_string
expr_stmt|;
name|truncated
operator|=
literal|1
expr_stmt|;
block|}
if|if
condition|(
name|len
operator|&&
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|&
name|tmp2
argument_list|,
name|len
argument_list|)
operator|!=
operator|-
literal|1
condition|)
block|{
name|tmp3
operator|=
name|malloc
argument_list|(
name|len
operator|*
literal|4
operator|+
literal|1
argument_list|)
expr_stmt|;
while|while
condition|(
name|len
condition|)
block|{
if|if
condition|(
name|strvisx
argument_list|(
name|tmp3
argument_list|,
name|tmp2
argument_list|,
name|len
argument_list|,
name|VIS_CSTYLE
operator||
name|VIS_TAB
operator||
name|VIS_NL
argument_list|)
operator|<=
name|max_string
condition|)
break|break;
name|len
operator|--
expr_stmt|;
name|truncated
operator|=
literal|1
expr_stmt|;
block|}
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"\"%s\"%s"
argument_list|,
name|tmp3
argument_list|,
name|truncated
condition|?
literal|"..."
else|:
literal|""
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|tmp3
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
block|}
break|break;
block|}
case|case
name|ExecArgs
case|:
case|case
name|ExecEnv
case|:
case|case
name|StringArray
case|:
block|{
name|uintptr_t
name|addr
decl_stmt|;
union|union
block|{
name|char
modifier|*
name|strarray
index|[
literal|0
index|]
decl_stmt|;
name|char
name|buf
index|[
name|PAGE_SIZE
index|]
decl_stmt|;
block|}
name|u
union|;
name|char
modifier|*
name|string
decl_stmt|;
name|size_t
name|len
decl_stmt|;
name|u_int
name|first
decl_stmt|,
name|i
decl_stmt|;
comment|/* 		 * Only parse argv[] and environment arrays from exec calls 		 * if requested. 		 */
if|if
condition|(
operator|(
operator|(
name|sc
operator|->
name|type
operator|&
name|ARG_MASK
operator|)
operator|==
name|ExecArgs
operator|&&
operator|(
name|trussinfo
operator|->
name|flags
operator|&
name|EXECVEARGS
operator|)
operator|==
literal|0
operator|)
operator|||
operator|(
operator|(
name|sc
operator|->
name|type
operator|&
name|ARG_MASK
operator|)
operator|==
name|ExecEnv
operator|&&
operator|(
name|trussinfo
operator|->
name|flags
operator|&
name|EXECVEENVS
operator|)
operator|==
literal|0
operator|)
condition|)
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
comment|/* 		 * Read a page of pointers at a time.  Punt if the top-level 		 * pointer is not aligned.  Note that the first read is of 		 * a partial page. 		 */
name|addr
operator|=
name|args
index|[
name|sc
operator|->
name|offset
index|]
expr_stmt|;
if|if
condition|(
name|addr
operator|%
sizeof|sizeof
argument_list|(
name|char
operator|*
argument_list|)
operator|!=
literal|0
condition|)
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
name|len
operator|=
name|PAGE_SIZE
operator|-
operator|(
name|addr
operator|&
name|PAGE_MASK
operator|)
expr_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|addr
argument_list|,
name|u
operator|.
name|buf
argument_list|,
name|len
argument_list|)
operator|==
operator|-
literal|1
condition|)
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
name|fputc
argument_list|(
literal|'['
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|first
operator|=
literal|1
expr_stmt|;
name|i
operator|=
literal|0
expr_stmt|;
while|while
condition|(
name|u
operator|.
name|strarray
index|[
name|i
index|]
operator|!=
name|NULL
condition|)
block|{
name|string
operator|=
name|get_string
argument_list|(
name|pid
argument_list|,
name|u
operator|.
name|strarray
index|[
name|i
index|]
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%s \"%s\""
argument_list|,
name|first
condition|?
literal|""
else|:
literal|","
argument_list|,
name|string
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|string
argument_list|)
expr_stmt|;
name|first
operator|=
literal|0
expr_stmt|;
name|i
operator|++
expr_stmt|;
if|if
condition|(
name|i
operator|==
name|len
operator|/
sizeof|sizeof
argument_list|(
name|char
operator|*
argument_list|)
condition|)
block|{
name|addr
operator|+=
name|len
expr_stmt|;
name|len
operator|=
name|PAGE_SIZE
expr_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|addr
argument_list|,
name|u
operator|.
name|buf
argument_list|,
name|len
argument_list|)
operator|==
operator|-
literal|1
condition|)
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|",<inval>"
argument_list|)
expr_stmt|;
break|break;
block|}
name|i
operator|=
literal|0
expr_stmt|;
block|}
block|}
name|fputs
argument_list|(
literal|" ]"
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
block|}
ifdef|#
directive|ifdef
name|__LP64__
case|case
name|Quad
case|:
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%ld"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|QuadHex
case|:
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
else|#
directive|else
case|case
name|Quad
case|:
case|case
name|QuadHex
case|:
block|{
name|unsigned
name|long
name|long
name|ll
decl_stmt|;
if|#
directive|if
name|_BYTE_ORDER
operator|==
name|_LITTLE_ENDIAN
name|ll
operator|=
operator|(
name|unsigned
name|long
name|long
operator|)
name|args
index|[
name|sc
operator|->
name|offset
operator|+
literal|1
index|]
operator|<<
literal|32
operator||
name|args
index|[
name|sc
operator|->
name|offset
index|]
expr_stmt|;
else|#
directive|else
name|ll
operator|=
operator|(
name|unsigned
name|long
name|long
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
operator|<<
literal|32
operator||
name|args
index|[
name|sc
operator|->
name|offset
operator|+
literal|1
index|]
expr_stmt|;
endif|#
directive|endif
if|if
condition|(
operator|(
name|sc
operator|->
name|type
operator|&
name|ARG_MASK
operator|)
operator|==
name|Quad
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%lld"
argument_list|,
name|ll
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%llx"
argument_list|,
name|ll
argument_list|)
expr_stmt|;
break|break;
block|}
endif|#
directive|endif
case|case
name|Ptr
case|:
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Readlinkres
case|:
block|{
name|char
modifier|*
name|tmp2
decl_stmt|;
if|if
condition|(
name|retval
index|[
literal|0
index|]
operator|==
operator|-
literal|1
condition|)
break|break;
name|tmp2
operator|=
name|get_string
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
name|retval
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"\"%s\""
argument_list|,
name|tmp2
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|tmp2
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Ioctl
case|:
block|{
specifier|const
name|char
modifier|*
name|temp
decl_stmt|;
name|unsigned
name|long
name|cmd
decl_stmt|;
name|cmd
operator|=
name|args
index|[
name|sc
operator|->
name|offset
index|]
expr_stmt|;
name|temp
operator|=
name|sysdecode_ioctlname
argument_list|(
name|cmd
argument_list|)
expr_stmt|;
if|if
condition|(
name|temp
condition|)
name|fputs
argument_list|(
name|temp
argument_list|,
name|fp
argument_list|)
expr_stmt|;
else|else
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx { IO%s%s 0x%lx('%c'), %lu, %lu }"
argument_list|,
name|cmd
argument_list|,
name|cmd
operator|&
name|IOC_OUT
condition|?
literal|"R"
else|:
literal|""
argument_list|,
name|cmd
operator|&
name|IOC_IN
condition|?
literal|"W"
else|:
literal|""
argument_list|,
name|IOCGROUP
argument_list|(
name|cmd
argument_list|)
argument_list|,
name|isprint
argument_list|(
name|IOCGROUP
argument_list|(
name|cmd
argument_list|)
argument_list|)
condition|?
operator|(
name|char
operator|)
name|IOCGROUP
argument_list|(
name|cmd
argument_list|)
else|:
literal|'?'
argument_list|,
name|cmd
operator|&
literal|0xFF
argument_list|,
name|IOCPARM_LEN
argument_list|(
name|cmd
argument_list|)
argument_list|)
expr_stmt|;
block|}
break|break;
block|}
case|case
name|Timespec
case|:
block|{
name|struct
name|timespec
name|ts
decl_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|&
name|ts
argument_list|,
sizeof|sizeof
argument_list|(
name|ts
argument_list|)
argument_list|)
operator|!=
operator|-
literal|1
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ %jd.%09ld }"
argument_list|,
operator|(
name|intmax_t
operator|)
name|ts
operator|.
name|tv_sec
argument_list|,
name|ts
operator|.
name|tv_nsec
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Timespec2
case|:
block|{
name|struct
name|timespec
name|ts
index|[
literal|2
index|]
decl_stmt|;
specifier|const
name|char
modifier|*
name|sep
decl_stmt|;
name|unsigned
name|int
name|i
decl_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|&
name|ts
argument_list|,
sizeof|sizeof
argument_list|(
name|ts
argument_list|)
argument_list|)
operator|!=
operator|-
literal|1
condition|)
block|{
name|fputs
argument_list|(
literal|"{ "
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|sep
operator|=
literal|""
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nitems
argument_list|(
name|ts
argument_list|)
condition|;
name|i
operator|++
control|)
block|{
name|fputs
argument_list|(
name|sep
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|sep
operator|=
literal|", "
expr_stmt|;
switch|switch
condition|(
name|ts
index|[
name|i
index|]
operator|.
name|tv_nsec
condition|)
block|{
case|case
name|UTIME_NOW
case|:
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"UTIME_NOW"
argument_list|)
expr_stmt|;
break|break;
case|case
name|UTIME_OMIT
case|:
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"UTIME_OMIT"
argument_list|)
expr_stmt|;
break|break;
default|default:
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%jd.%09ld"
argument_list|,
operator|(
name|intmax_t
operator|)
name|ts
index|[
name|i
index|]
operator|.
name|tv_sec
argument_list|,
name|ts
index|[
name|i
index|]
operator|.
name|tv_nsec
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
name|fputs
argument_list|(
literal|" }"
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Timeval
case|:
block|{
name|struct
name|timeval
name|tv
decl_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|&
name|tv
argument_list|,
sizeof|sizeof
argument_list|(
name|tv
argument_list|)
argument_list|)
operator|!=
operator|-
literal|1
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ %jd.%06ld }"
argument_list|,
operator|(
name|intmax_t
operator|)
name|tv
operator|.
name|tv_sec
argument_list|,
name|tv
operator|.
name|tv_usec
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Timeval2
case|:
block|{
name|struct
name|timeval
name|tv
index|[
literal|2
index|]
decl_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|&
name|tv
argument_list|,
sizeof|sizeof
argument_list|(
name|tv
argument_list|)
argument_list|)
operator|!=
operator|-
literal|1
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ %jd.%06ld, %jd.%06ld }"
argument_list|,
operator|(
name|intmax_t
operator|)
name|tv
index|[
literal|0
index|]
operator|.
name|tv_sec
argument_list|,
name|tv
index|[
literal|0
index|]
operator|.
name|tv_usec
argument_list|,
operator|(
name|intmax_t
operator|)
name|tv
index|[
literal|1
index|]
operator|.
name|tv_sec
argument_list|,
name|tv
index|[
literal|1
index|]
operator|.
name|tv_usec
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Itimerval
case|:
block|{
name|struct
name|itimerval
name|itv
decl_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|&
name|itv
argument_list|,
sizeof|sizeof
argument_list|(
name|itv
argument_list|)
argument_list|)
operator|!=
operator|-
literal|1
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ %jd.%06ld, %jd.%06ld }"
argument_list|,
operator|(
name|intmax_t
operator|)
name|itv
operator|.
name|it_interval
operator|.
name|tv_sec
argument_list|,
name|itv
operator|.
name|it_interval
operator|.
name|tv_usec
argument_list|,
operator|(
name|intmax_t
operator|)
name|itv
operator|.
name|it_value
operator|.
name|tv_sec
argument_list|,
name|itv
operator|.
name|it_value
operator|.
name|tv_usec
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|LinuxSockArgs
case|:
block|{
name|struct
name|linux_socketcall_args
name|largs
decl_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|(
name|void
operator|*
operator|)
operator|&
name|largs
argument_list|,
sizeof|sizeof
argument_list|(
name|largs
argument_list|)
argument_list|)
operator|!=
operator|-
literal|1
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ %s, 0x%lx }"
argument_list|,
name|lookup
argument_list|(
name|linux_socketcall_ops
argument_list|,
name|largs
operator|.
name|what
argument_list|,
literal|10
argument_list|)
argument_list|,
operator|(
name|long
name|unsigned
name|int
operator|)
name|largs
operator|.
name|args
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Pollfd
case|:
block|{
comment|/* 		 * XXX: A Pollfd argument expects the /next/ syscall argument 		 * to be the number of fds in the array. This matches the poll 		 * syscall. 		 */
name|struct
name|pollfd
modifier|*
name|pfd
decl_stmt|;
name|int
name|numfds
init|=
name|args
index|[
name|sc
operator|->
name|offset
operator|+
literal|1
index|]
decl_stmt|;
name|size_t
name|bytes
init|=
sizeof|sizeof
argument_list|(
expr|struct
name|pollfd
argument_list|)
operator|*
name|numfds
decl_stmt|;
name|int
name|i
decl_stmt|;
if|if
condition|(
operator|(
name|pfd
operator|=
name|malloc
argument_list|(
name|bytes
argument_list|)
operator|)
operator|==
name|NULL
condition|)
name|err
argument_list|(
literal|1
argument_list|,
literal|"Cannot malloc %zu bytes for pollfd array"
argument_list|,
name|bytes
argument_list|)
expr_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
name|pfd
argument_list|,
name|bytes
argument_list|)
operator|!=
operator|-
literal|1
condition|)
block|{
name|fputs
argument_list|(
literal|"{"
argument_list|,
name|fp
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|numfds
condition|;
name|i
operator|++
control|)
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|" %d/%s"
argument_list|,
name|pfd
index|[
name|i
index|]
operator|.
name|fd
argument_list|,
name|xlookup_bits
argument_list|(
name|poll_flags
argument_list|,
name|pfd
index|[
name|i
index|]
operator|.
name|events
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|fputs
argument_list|(
literal|" }"
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
block|}
name|free
argument_list|(
name|pfd
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Fd_set
case|:
block|{
comment|/* 		 * XXX: A Fd_set argument expects the /first/ syscall argument 		 * to be the number of fds in the array.  This matches the 		 * select syscall. 		 */
name|fd_set
modifier|*
name|fds
decl_stmt|;
name|int
name|numfds
init|=
name|args
index|[
literal|0
index|]
decl_stmt|;
name|size_t
name|bytes
init|=
name|_howmany
argument_list|(
name|numfds
argument_list|,
name|_NFDBITS
argument_list|)
operator|*
name|_NFDBITS
decl_stmt|;
name|int
name|i
decl_stmt|;
if|if
condition|(
operator|(
name|fds
operator|=
name|malloc
argument_list|(
name|bytes
argument_list|)
operator|)
operator|==
name|NULL
condition|)
name|err
argument_list|(
literal|1
argument_list|,
literal|"Cannot malloc %zu bytes for fd_set array"
argument_list|,
name|bytes
argument_list|)
expr_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
name|fds
argument_list|,
name|bytes
argument_list|)
operator|!=
operator|-
literal|1
condition|)
block|{
name|fputs
argument_list|(
literal|"{"
argument_list|,
name|fp
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|numfds
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|FD_ISSET
argument_list|(
name|i
argument_list|,
name|fds
argument_list|)
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|" %d"
argument_list|,
name|i
argument_list|)
expr_stmt|;
block|}
name|fputs
argument_list|(
literal|" }"
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|fds
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Signal
case|:
name|fputs
argument_list|(
name|strsig2
argument_list|(
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|Sigset
case|:
block|{
name|long
name|sig
decl_stmt|;
name|sigset_t
name|ss
decl_stmt|;
name|int
name|i
decl_stmt|,
name|first
decl_stmt|;
name|sig
operator|=
name|args
index|[
name|sc
operator|->
name|offset
index|]
expr_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|(
name|void
operator|*
operator|)
operator|&
name|ss
argument_list|,
sizeof|sizeof
argument_list|(
name|ss
argument_list|)
argument_list|)
operator|==
operator|-
literal|1
condition|)
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
name|fputs
argument_list|(
literal|"{ "
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|first
operator|=
literal|1
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<
name|sys_nsig
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|sigismember
argument_list|(
operator|&
name|ss
argument_list|,
name|i
argument_list|)
condition|)
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%s%s"
argument_list|,
operator|!
name|first
condition|?
literal|"|"
else|:
literal|""
argument_list|,
name|strsig2
argument_list|(
name|i
argument_list|)
argument_list|)
expr_stmt|;
name|first
operator|=
literal|0
expr_stmt|;
block|}
block|}
if|if
condition|(
operator|!
name|first
condition|)
name|fputc
argument_list|(
literal|' '
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|fputc
argument_list|(
literal|'}'
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Sigprocmask
case|:
name|print_integer_arg
argument_list|(
name|sysdecode_sigprocmask_how
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Fcntlflag
case|:
comment|/* XXX: Output depends on the value of the previous argument. */
if|if
condition|(
name|sysdecode_fcntl_arg_p
argument_list|(
name|args
index|[
name|sc
operator|->
name|offset
operator|-
literal|1
index|]
argument_list|)
condition|)
name|sysdecode_fcntl_arg
argument_list|(
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
operator|-
literal|1
index|]
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
literal|16
argument_list|)
expr_stmt|;
break|break;
case|case
name|Open
case|:
name|print_mask_arg
argument_list|(
name|sysdecode_open_flags
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Fcntl
case|:
name|print_integer_arg
argument_list|(
name|sysdecode_fcntl_cmd
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Mprot
case|:
name|print_mask_arg
argument_list|(
name|sysdecode_mmap_prot
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Mmapflags
case|:
name|print_mask_arg
argument_list|(
name|sysdecode_mmap_flags
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Whence
case|:
name|print_integer_arg
argument_list|(
name|sysdecode_whence
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Sockdomain
case|:
name|print_integer_arg
argument_list|(
name|sysdecode_socketdomain
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Socktype
case|:
name|print_mask_arg
argument_list|(
name|sysdecode_socket_type
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Shutdown
case|:
name|print_integer_arg
argument_list|(
name|sysdecode_shutdown_how
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Resource
case|:
name|print_integer_arg
argument_list|(
name|sysdecode_rlimit
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Pathconf
case|:
name|fputs
argument_list|(
name|xlookup
argument_list|(
name|pathconf_arg
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|Rforkflags
case|:
name|print_mask_arg
argument_list|(
name|sysdecode_rfork_flags
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Sockaddr
case|:
block|{
name|char
name|addr
index|[
literal|64
index|]
decl_stmt|;
name|struct
name|sockaddr_in
modifier|*
name|lsin
decl_stmt|;
name|struct
name|sockaddr_in6
modifier|*
name|lsin6
decl_stmt|;
name|struct
name|sockaddr_un
modifier|*
name|sun
decl_stmt|;
name|struct
name|sockaddr
modifier|*
name|sa
decl_stmt|;
name|socklen_t
name|len
decl_stmt|;
name|u_char
modifier|*
name|q
decl_stmt|;
if|if
condition|(
name|args
index|[
name|sc
operator|->
name|offset
index|]
operator|==
literal|0
condition|)
block|{
name|fputs
argument_list|(
literal|"NULL"
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
block|}
comment|/* 		 * Extract the address length from the next argument.  If 		 * this is an output sockaddr (OUT is set), then the 		 * next argument is a pointer to a socklen_t.  Otherwise 		 * the next argument contains a socklen_t by value. 		 */
if|if
condition|(
name|sc
operator|->
name|type
operator|&
name|OUT
condition|)
block|{
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
operator|+
literal|1
index|]
argument_list|,
operator|&
name|len
argument_list|,
sizeof|sizeof
argument_list|(
name|len
argument_list|)
argument_list|)
operator|==
operator|-
literal|1
condition|)
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
else|else
name|len
operator|=
name|args
index|[
name|sc
operator|->
name|offset
operator|+
literal|1
index|]
expr_stmt|;
comment|/* If the length is too small, just bail. */
if|if
condition|(
name|len
operator|<
sizeof|sizeof
argument_list|(
operator|*
name|sa
argument_list|)
condition|)
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
name|sa
operator|=
name|calloc
argument_list|(
literal|1
argument_list|,
name|len
argument_list|)
expr_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
name|sa
argument_list|,
name|len
argument_list|)
operator|==
operator|-
literal|1
condition|)
block|{
name|free
argument_list|(
name|sa
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
switch|switch
condition|(
name|sa
operator|->
name|sa_family
condition|)
block|{
case|case
name|AF_INET
case|:
if|if
condition|(
name|len
operator|<
sizeof|sizeof
argument_list|(
operator|*
name|lsin
argument_list|)
condition|)
goto|goto
name|sockaddr_short
goto|;
name|lsin
operator|=
operator|(
expr|struct
name|sockaddr_in
operator|*
operator|)
operator|(
name|void
operator|*
operator|)
name|sa
expr_stmt|;
name|inet_ntop
argument_list|(
name|AF_INET
argument_list|,
operator|&
name|lsin
operator|->
name|sin_addr
argument_list|,
name|addr
argument_list|,
sizeof|sizeof
argument_list|(
name|addr
argument_list|)
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ AF_INET %s:%d }"
argument_list|,
name|addr
argument_list|,
name|htons
argument_list|(
name|lsin
operator|->
name|sin_port
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|AF_INET6
case|:
if|if
condition|(
name|len
operator|<
sizeof|sizeof
argument_list|(
operator|*
name|lsin6
argument_list|)
condition|)
goto|goto
name|sockaddr_short
goto|;
name|lsin6
operator|=
operator|(
expr|struct
name|sockaddr_in6
operator|*
operator|)
operator|(
name|void
operator|*
operator|)
name|sa
expr_stmt|;
name|inet_ntop
argument_list|(
name|AF_INET6
argument_list|,
operator|&
name|lsin6
operator|->
name|sin6_addr
argument_list|,
name|addr
argument_list|,
sizeof|sizeof
argument_list|(
name|addr
argument_list|)
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ AF_INET6 [%s]:%d }"
argument_list|,
name|addr
argument_list|,
name|htons
argument_list|(
name|lsin6
operator|->
name|sin6_port
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|AF_UNIX
case|:
name|sun
operator|=
operator|(
expr|struct
name|sockaddr_un
operator|*
operator|)
name|sa
expr_stmt|;
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ AF_UNIX \"%.*s\" }"
argument_list|,
call|(
name|int
call|)
argument_list|(
name|len
operator|-
name|offsetof
argument_list|(
expr|struct
name|sockaddr_un
argument_list|,
name|sun_path
argument_list|)
argument_list|)
argument_list|,
name|sun
operator|->
name|sun_path
argument_list|)
expr_stmt|;
break|break;
default|default:
name|sockaddr_short
label|:
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ sa_len = %d, sa_family = %d, sa_data = {"
argument_list|,
operator|(
name|int
operator|)
name|sa
operator|->
name|sa_len
argument_list|,
operator|(
name|int
operator|)
name|sa
operator|->
name|sa_family
argument_list|)
expr_stmt|;
for|for
control|(
name|q
operator|=
operator|(
name|u_char
operator|*
operator|)
name|sa
operator|->
name|sa_data
init|;
name|q
operator|<
operator|(
name|u_char
operator|*
operator|)
name|sa
operator|+
name|len
condition|;
name|q
operator|++
control|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%s 0x%02x"
argument_list|,
name|q
operator|==
operator|(
name|u_char
operator|*
operator|)
name|sa
operator|->
name|sa_data
condition|?
literal|""
else|:
literal|","
argument_list|,
operator|*
name|q
argument_list|)
expr_stmt|;
name|fputs
argument_list|(
literal|" } }"
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
name|free
argument_list|(
name|sa
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Sigaction
case|:
block|{
name|struct
name|sigaction
name|sa
decl_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|&
name|sa
argument_list|,
sizeof|sizeof
argument_list|(
name|sa
argument_list|)
argument_list|)
operator|!=
operator|-
literal|1
condition|)
block|{
name|fputs
argument_list|(
literal|"{ "
argument_list|,
name|fp
argument_list|)
expr_stmt|;
if|if
condition|(
name|sa
operator|.
name|sa_handler
operator|==
name|SIG_DFL
condition|)
name|fputs
argument_list|(
literal|"SIG_DFL"
argument_list|,
name|fp
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|sa
operator|.
name|sa_handler
operator|==
name|SIG_IGN
condition|)
name|fputs
argument_list|(
literal|"SIG_IGN"
argument_list|,
name|fp
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%p"
argument_list|,
name|sa
operator|.
name|sa_handler
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|" %s ss_t }"
argument_list|,
name|xlookup_bits
argument_list|(
name|sigaction_flags
argument_list|,
name|sa
operator|.
name|sa_flags
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Kevent
case|:
block|{
comment|/* 		 * XXX XXX: The size of the array is determined by either the 		 * next syscall argument, or by the syscall return value, 		 * depending on which argument number we are.  This matches the 		 * kevent syscall, but luckily that's the only syscall that uses 		 * them. 		 */
name|struct
name|kevent
modifier|*
name|ke
decl_stmt|;
name|int
name|numevents
init|=
operator|-
literal|1
decl_stmt|;
name|size_t
name|bytes
decl_stmt|;
name|int
name|i
decl_stmt|;
if|if
condition|(
name|sc
operator|->
name|offset
operator|==
literal|1
condition|)
name|numevents
operator|=
name|args
index|[
name|sc
operator|->
name|offset
operator|+
literal|1
index|]
expr_stmt|;
elseif|else
if|if
condition|(
name|sc
operator|->
name|offset
operator|==
literal|3
operator|&&
name|retval
index|[
literal|0
index|]
operator|!=
operator|-
literal|1
condition|)
name|numevents
operator|=
name|retval
index|[
literal|0
index|]
expr_stmt|;
if|if
condition|(
name|numevents
operator|>=
literal|0
condition|)
block|{
name|bytes
operator|=
sizeof|sizeof
argument_list|(
expr|struct
name|kevent
argument_list|)
operator|*
name|numevents
expr_stmt|;
if|if
condition|(
operator|(
name|ke
operator|=
name|malloc
argument_list|(
name|bytes
argument_list|)
operator|)
operator|==
name|NULL
condition|)
name|err
argument_list|(
literal|1
argument_list|,
literal|"Cannot malloc %zu bytes for kevent array"
argument_list|,
name|bytes
argument_list|)
expr_stmt|;
block|}
else|else
name|ke
operator|=
name|NULL
expr_stmt|;
if|if
condition|(
name|numevents
operator|>=
literal|0
operator|&&
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
name|ke
argument_list|,
name|bytes
argument_list|)
operator|!=
operator|-
literal|1
condition|)
block|{
name|fputc
argument_list|(
literal|'{'
argument_list|,
name|fp
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|numevents
condition|;
name|i
operator|++
control|)
block|{
name|fputc
argument_list|(
literal|' '
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|print_kevent
argument_list|(
name|fp
argument_list|,
operator|&
name|ke
index|[
name|i
index|]
argument_list|,
name|sc
operator|->
name|offset
operator|==
literal|1
argument_list|)
expr_stmt|;
block|}
name|fputs
argument_list|(
literal|" }"
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
block|}
name|free
argument_list|(
name|ke
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Stat
case|:
block|{
name|struct
name|stat
name|st
decl_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|&
name|st
argument_list|,
sizeof|sizeof
argument_list|(
name|st
argument_list|)
argument_list|)
operator|!=
operator|-
literal|1
condition|)
block|{
name|char
name|mode
index|[
literal|12
index|]
decl_stmt|;
name|strmode
argument_list|(
name|st
operator|.
name|st_mode
argument_list|,
name|mode
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ mode=%s,inode=%ju,size=%jd,blksize=%ld }"
argument_list|,
name|mode
argument_list|,
operator|(
name|uintmax_t
operator|)
name|st
operator|.
name|st_ino
argument_list|,
operator|(
name|intmax_t
operator|)
name|st
operator|.
name|st_size
argument_list|,
operator|(
name|long
operator|)
name|st
operator|.
name|st_blksize
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
block|}
break|break;
block|}
case|case
name|StatFs
case|:
block|{
name|unsigned
name|int
name|i
decl_stmt|;
name|struct
name|statfs
name|buf
decl_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|&
name|buf
argument_list|,
sizeof|sizeof
argument_list|(
name|buf
argument_list|)
argument_list|)
operator|!=
operator|-
literal|1
condition|)
block|{
name|char
name|fsid
index|[
literal|17
index|]
decl_stmt|;
name|bzero
argument_list|(
name|fsid
argument_list|,
sizeof|sizeof
argument_list|(
name|fsid
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|buf
operator|.
name|f_fsid
operator|.
name|val
index|[
literal|0
index|]
operator|!=
literal|0
operator|||
name|buf
operator|.
name|f_fsid
operator|.
name|val
index|[
literal|1
index|]
operator|!=
literal|0
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
sizeof|sizeof
argument_list|(
name|buf
operator|.
name|f_fsid
argument_list|)
condition|;
name|i
operator|++
control|)
name|snprintf
argument_list|(
operator|&
name|fsid
index|[
name|i
operator|*
literal|2
index|]
argument_list|,
sizeof|sizeof
argument_list|(
name|fsid
argument_list|)
operator|-
operator|(
name|i
operator|*
literal|2
operator|)
argument_list|,
literal|"%02x"
argument_list|,
operator|(
operator|(
name|u_char
operator|*
operator|)
operator|&
name|buf
operator|.
name|f_fsid
operator|)
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ fstypename=%s,mntonname=%s,mntfromname=%s,"
literal|"fsid=%s }"
argument_list|,
name|buf
operator|.
name|f_fstypename
argument_list|,
name|buf
operator|.
name|f_mntonname
argument_list|,
name|buf
operator|.
name|f_mntfromname
argument_list|,
name|fsid
argument_list|)
expr_stmt|;
block|}
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Rusage
case|:
block|{
name|struct
name|rusage
name|ru
decl_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|&
name|ru
argument_list|,
sizeof|sizeof
argument_list|(
name|ru
argument_list|)
argument_list|)
operator|!=
operator|-
literal|1
condition|)
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ u=%jd.%06ld,s=%jd.%06ld,in=%ld,out=%ld }"
argument_list|,
operator|(
name|intmax_t
operator|)
name|ru
operator|.
name|ru_utime
operator|.
name|tv_sec
argument_list|,
name|ru
operator|.
name|ru_utime
operator|.
name|tv_usec
argument_list|,
operator|(
name|intmax_t
operator|)
name|ru
operator|.
name|ru_stime
operator|.
name|tv_sec
argument_list|,
name|ru
operator|.
name|ru_stime
operator|.
name|tv_usec
argument_list|,
name|ru
operator|.
name|ru_inblock
argument_list|,
name|ru
operator|.
name|ru_oublock
argument_list|)
expr_stmt|;
block|}
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Rlimit
case|:
block|{
name|struct
name|rlimit
name|rl
decl_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|&
name|rl
argument_list|,
sizeof|sizeof
argument_list|(
name|rl
argument_list|)
argument_list|)
operator|!=
operator|-
literal|1
condition|)
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ cur=%ju,max=%ju }"
argument_list|,
name|rl
operator|.
name|rlim_cur
argument_list|,
name|rl
operator|.
name|rlim_max
argument_list|)
expr_stmt|;
block|}
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|ExitStatus
case|:
block|{
name|int
name|status
decl_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|&
name|status
argument_list|,
sizeof|sizeof
argument_list|(
name|status
argument_list|)
argument_list|)
operator|!=
operator|-
literal|1
condition|)
block|{
name|fputs
argument_list|(
literal|"{ "
argument_list|,
name|fp
argument_list|)
expr_stmt|;
if|if
condition|(
name|WIFCONTINUED
argument_list|(
name|status
argument_list|)
condition|)
name|fputs
argument_list|(
literal|"CONTINUED"
argument_list|,
name|fp
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|WIFEXITED
argument_list|(
name|status
argument_list|)
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"EXITED,val=%d"
argument_list|,
name|WEXITSTATUS
argument_list|(
name|status
argument_list|)
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|WIFSIGNALED
argument_list|(
name|status
argument_list|)
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"SIGNALED,sig=%s%s"
argument_list|,
name|strsig2
argument_list|(
name|WTERMSIG
argument_list|(
name|status
argument_list|)
argument_list|)
argument_list|,
name|WCOREDUMP
argument_list|(
name|status
argument_list|)
condition|?
literal|",cored"
else|:
literal|""
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"STOPPED,sig=%s"
argument_list|,
name|strsig2
argument_list|(
name|WTERMSIG
argument_list|(
name|status
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|fputs
argument_list|(
literal|" }"
argument_list|,
name|fp
argument_list|)
expr_stmt|;
block|}
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Waitoptions
case|:
name|print_mask_arg
argument_list|(
name|sysdecode_wait6_options
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Idtype
case|:
name|print_integer_arg
argument_list|(
name|sysdecode_idtype
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Procctl
case|:
name|print_integer_arg
argument_list|(
name|sysdecode_procctl_cmd
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Umtxop
case|:
name|print_integer_arg
argument_list|(
name|sysdecode_umtx_op
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Atfd
case|:
name|print_integer_arg
argument_list|(
name|sysdecode_atfd
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Atflags
case|:
name|fputs
argument_list|(
name|xlookup_bits
argument_list|(
name|at_flags
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|Accessmode
case|:
name|print_mask_arg
argument_list|(
name|sysdecode_access_mode
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|Sysarch
case|:
name|fputs
argument_list|(
name|xlookup
argument_list|(
name|sysarch_ops
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|PipeFds
case|:
comment|/* 		 * The pipe() system call in the kernel returns its 		 * two file descriptors via return values.  However, 		 * the interface exposed by libc is that pipe() 		 * accepts a pointer to an array of descriptors. 		 * Format the output to match the libc API by printing 		 * the returned file descriptors as a fake argument. 		 * 		 * Overwrite the first retval to signal a successful 		 * return as well. 		 */
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ %ld, %ld }"
argument_list|,
name|retval
index|[
literal|0
index|]
argument_list|,
name|retval
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|retval
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
break|break;
case|case
name|Utrace
case|:
block|{
name|size_t
name|len
decl_stmt|;
name|void
modifier|*
name|utrace_addr
decl_stmt|;
name|len
operator|=
name|args
index|[
name|sc
operator|->
name|offset
operator|+
literal|1
index|]
expr_stmt|;
name|utrace_addr
operator|=
name|calloc
argument_list|(
literal|1
argument_list|,
name|len
argument_list|)
expr_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|(
name|void
operator|*
operator|)
name|utrace_addr
argument_list|,
name|len
argument_list|)
operator|!=
operator|-
literal|1
condition|)
name|print_utrace
argument_list|(
name|fp
argument_list|,
name|utrace_addr
argument_list|,
name|len
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|utrace_addr
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|IntArray
case|:
block|{
name|int
name|descriptors
index|[
literal|16
index|]
decl_stmt|;
name|unsigned
name|long
name|i
decl_stmt|,
name|ndescriptors
decl_stmt|;
name|bool
name|truncated
decl_stmt|;
name|ndescriptors
operator|=
name|args
index|[
name|sc
operator|->
name|offset
operator|+
literal|1
index|]
expr_stmt|;
name|truncated
operator|=
name|false
expr_stmt|;
if|if
condition|(
name|ndescriptors
operator|>
name|nitems
argument_list|(
name|descriptors
argument_list|)
condition|)
block|{
name|ndescriptors
operator|=
name|nitems
argument_list|(
name|descriptors
argument_list|)
expr_stmt|;
name|truncated
operator|=
name|true
expr_stmt|;
block|}
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
name|descriptors
argument_list|,
name|ndescriptors
operator|*
sizeof|sizeof
argument_list|(
name|descriptors
index|[
literal|0
index|]
argument_list|)
argument_list|)
operator|!=
operator|-
literal|1
condition|)
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{"
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ndescriptors
condition|;
name|i
operator|++
control|)
name|fprintf
argument_list|(
name|fp
argument_list|,
name|i
operator|==
literal|0
condition|?
literal|" %d"
else|:
literal|", %d"
argument_list|,
name|descriptors
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|fp
argument_list|,
name|truncated
condition|?
literal|", ... }"
else|:
literal|" }"
argument_list|)
expr_stmt|;
block|}
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Pipe2
case|:
name|print_mask_arg
argument_list|(
name|sysdecode_pipe2_flags
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|CapFcntlRights
case|:
block|{
name|uint32_t
name|rights
decl_stmt|;
if|if
condition|(
name|sc
operator|->
name|type
operator|&
name|OUT
condition|)
block|{
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|&
name|rights
argument_list|,
sizeof|sizeof
argument_list|(
name|rights
argument_list|)
argument_list|)
operator|==
operator|-
literal|1
condition|)
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
else|else
name|rights
operator|=
name|args
index|[
name|sc
operator|->
name|offset
index|]
expr_stmt|;
name|print_mask_arg32
argument_list|(
name|sysdecode_cap_fcntlrights
argument_list|,
name|fp
argument_list|,
name|rights
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Fadvice
case|:
name|print_integer_arg
argument_list|(
name|sysdecode_fadvice
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|FileFlags
case|:
block|{
name|fflags_t
name|rem
decl_stmt|;
if|if
condition|(
operator|!
name|sysdecode_fileflags
argument_list|(
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|&
name|rem
argument_list|)
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%x"
argument_list|,
name|rem
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|rem
operator|!=
literal|0
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"|0x%x"
argument_list|,
name|rem
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|Flockop
case|:
name|print_mask_arg
argument_list|(
name|sysdecode_flock_operation
argument_list|,
name|fp
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|CloudABIAdvice
case|:
name|fputs
argument_list|(
name|xlookup
argument_list|(
name|cloudabi_advice
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|CloudABIClockID
case|:
name|fputs
argument_list|(
name|xlookup
argument_list|(
name|cloudabi_clockid
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|ClouduABIFDSFlags
case|:
name|fputs
argument_list|(
name|xlookup_bits
argument_list|(
name|cloudabi_fdsflags
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|CloudABIFDStat
case|:
block|{
name|cloudabi_fdstat_t
name|fds
decl_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|&
name|fds
argument_list|,
sizeof|sizeof
argument_list|(
name|fds
argument_list|)
argument_list|)
operator|!=
operator|-
literal|1
condition|)
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ %s, "
argument_list|,
name|xlookup
argument_list|(
name|cloudabi_filetype
argument_list|,
name|fds
operator|.
name|fs_filetype
argument_list|)
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%s, ... }"
argument_list|,
name|xlookup_bits
argument_list|(
name|cloudabi_fdflags
argument_list|,
name|fds
operator|.
name|fs_flags
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|CloudABIFileStat
case|:
block|{
name|cloudabi_filestat_t
name|fsb
decl_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|&
name|fsb
argument_list|,
sizeof|sizeof
argument_list|(
name|fsb
argument_list|)
argument_list|)
operator|!=
operator|-
literal|1
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ %s, %ju }"
argument_list|,
name|xlookup
argument_list|(
name|cloudabi_filetype
argument_list|,
name|fsb
operator|.
name|st_filetype
argument_list|)
argument_list|,
operator|(
name|uintmax_t
operator|)
name|fsb
operator|.
name|st_size
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|CloudABIFileType
case|:
name|fputs
argument_list|(
name|xlookup
argument_list|(
name|cloudabi_filetype
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|CloudABIFSFlags
case|:
name|fputs
argument_list|(
name|xlookup_bits
argument_list|(
name|cloudabi_fsflags
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|CloudABILookup
case|:
if|if
condition|(
operator|(
name|args
index|[
name|sc
operator|->
name|offset
index|]
operator|&
name|CLOUDABI_LOOKUP_SYMLINK_FOLLOW
operator|)
operator|!=
literal|0
condition|)
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%d|LOOKUP_SYMLINK_FOLLOW"
argument_list|,
operator|(
name|int
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%d"
argument_list|,
operator|(
name|int
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|CloudABIMFlags
case|:
name|fputs
argument_list|(
name|xlookup_bits
argument_list|(
name|cloudabi_mflags
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|CloudABIMProt
case|:
name|fputs
argument_list|(
name|xlookup_bits
argument_list|(
name|cloudabi_mprot
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|CloudABIMSFlags
case|:
name|fputs
argument_list|(
name|xlookup_bits
argument_list|(
name|cloudabi_msflags
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|CloudABIOFlags
case|:
name|fputs
argument_list|(
name|xlookup_bits
argument_list|(
name|cloudabi_oflags
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|CloudABISDFlags
case|:
name|fputs
argument_list|(
name|xlookup_bits
argument_list|(
name|cloudabi_sdflags
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|CloudABISignal
case|:
name|fputs
argument_list|(
name|xlookup
argument_list|(
name|cloudabi_signal
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|CloudABISockStat
case|:
block|{
name|cloudabi_sockstat_t
name|ss
decl_stmt|;
if|if
condition|(
name|get_struct
argument_list|(
name|pid
argument_list|,
operator|(
name|void
operator|*
operator|)
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|,
operator|&
name|ss
argument_list|,
sizeof|sizeof
argument_list|(
name|ss
argument_list|)
argument_list|)
operator|!=
operator|-
literal|1
condition|)
block|{
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"{ %s, "
argument_list|,
name|xlookup
argument_list|(
name|cloudabi_sa_family
argument_list|,
name|ss
operator|.
name|ss_sockname
operator|.
name|sa_family
argument_list|)
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%s, "
argument_list|,
name|xlookup
argument_list|(
name|cloudabi_sa_family
argument_list|,
name|ss
operator|.
name|ss_peername
operator|.
name|sa_family
argument_list|)
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%s, "
argument_list|,
name|xlookup
argument_list|(
name|cloudabi_errno
argument_list|,
name|ss
operator|.
name|ss_error
argument_list|)
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%s }"
argument_list|,
name|xlookup_bits
argument_list|(
name|cloudabi_ssstate
argument_list|,
name|ss
operator|.
name|ss_state
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"0x%lx"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
case|case
name|CloudABISSFlags
case|:
name|fputs
argument_list|(
name|xlookup_bits
argument_list|(
name|cloudabi_ssflags
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|CloudABITimestamp
case|:
name|fprintf
argument_list|(
name|fp
argument_list|,
literal|"%lu.%09lus"
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
operator|/
literal|1000000000
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
operator|%
literal|1000000000
argument_list|)
expr_stmt|;
break|break;
case|case
name|CloudABIULFlags
case|:
name|fputs
argument_list|(
name|xlookup_bits
argument_list|(
name|cloudabi_ulflags
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
case|case
name|CloudABIWhence
case|:
name|fputs
argument_list|(
name|xlookup
argument_list|(
name|cloudabi_whence
argument_list|,
name|args
index|[
name|sc
operator|->
name|offset
index|]
argument_list|)
argument_list|,
name|fp
argument_list|)
expr_stmt|;
break|break;
default|default:
name|errx
argument_list|(
literal|1
argument_list|,
literal|"Invalid argument type %d\n"
argument_list|,
name|sc
operator|->
name|type
operator|&
name|ARG_MASK
argument_list|)
expr_stmt|;
block|}
name|fclose
argument_list|(
name|fp
argument_list|)
expr_stmt|;
return|return
operator|(
name|tmp
operator|)
return|;
block|}
end_function

begin_comment
comment|/*  * Print (to outfile) the system call and its arguments.  */
end_comment

begin_function
name|void
name|print_syscall
parameter_list|(
name|struct
name|trussinfo
modifier|*
name|trussinfo
parameter_list|)
block|{
name|struct
name|threadinfo
modifier|*
name|t
decl_stmt|;
specifier|const
name|char
modifier|*
name|name
decl_stmt|;
name|char
modifier|*
modifier|*
name|s_args
decl_stmt|;
name|int
name|i
decl_stmt|,
name|len
decl_stmt|,
name|nargs
decl_stmt|;
name|t
operator|=
name|trussinfo
operator|->
name|curthread
expr_stmt|;
name|name
operator|=
name|t
operator|->
name|cs
operator|.
name|sc
operator|->
name|name
expr_stmt|;
name|nargs
operator|=
name|t
operator|->
name|cs
operator|.
name|nargs
expr_stmt|;
name|s_args
operator|=
name|t
operator|->
name|cs
operator|.
name|s_args
expr_stmt|;
name|len
operator|=
name|print_line_prefix
argument_list|(
name|trussinfo
argument_list|)
expr_stmt|;
name|len
operator|+=
name|fprintf
argument_list|(
name|trussinfo
operator|->
name|outfile
argument_list|,
literal|"%s("
argument_list|,
name|name
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nargs
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|s_args
index|[
name|i
index|]
operator|!=
name|NULL
condition|)
name|len
operator|+=
name|fprintf
argument_list|(
name|trussinfo
operator|->
name|outfile
argument_list|,
literal|"%s"
argument_list|,
name|s_args
index|[
name|i
index|]
argument_list|)
expr_stmt|;
else|else
name|len
operator|+=
name|fprintf
argument_list|(
name|trussinfo
operator|->
name|outfile
argument_list|,
literal|"<missing argument>"
argument_list|)
expr_stmt|;
name|len
operator|+=
name|fprintf
argument_list|(
name|trussinfo
operator|->
name|outfile
argument_list|,
literal|"%s"
argument_list|,
name|i
operator|<
operator|(
name|nargs
operator|-
literal|1
operator|)
condition|?
literal|","
else|:
literal|""
argument_list|)
expr_stmt|;
block|}
name|len
operator|+=
name|fprintf
argument_list|(
name|trussinfo
operator|->
name|outfile
argument_list|,
literal|")"
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|6
operator|-
operator|(
name|len
operator|/
literal|8
operator|)
condition|;
name|i
operator|++
control|)
name|fprintf
argument_list|(
name|trussinfo
operator|->
name|outfile
argument_list|,
literal|"\t"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|print_syscall_ret
parameter_list|(
name|struct
name|trussinfo
modifier|*
name|trussinfo
parameter_list|,
name|int
name|errorp
parameter_list|,
name|long
modifier|*
name|retval
parameter_list|)
block|{
name|struct
name|timespec
name|timediff
decl_stmt|;
name|struct
name|threadinfo
modifier|*
name|t
decl_stmt|;
name|struct
name|syscall
modifier|*
name|sc
decl_stmt|;
name|int
name|error
decl_stmt|;
name|t
operator|=
name|trussinfo
operator|->
name|curthread
expr_stmt|;
name|sc
operator|=
name|t
operator|->
name|cs
operator|.
name|sc
expr_stmt|;
if|if
condition|(
name|trussinfo
operator|->
name|flags
operator|&
name|COUNTONLY
condition|)
block|{
name|timespecsubt
argument_list|(
operator|&
name|t
operator|->
name|after
argument_list|,
operator|&
name|t
operator|->
name|before
argument_list|,
operator|&
name|timediff
argument_list|)
expr_stmt|;
name|timespecadd
argument_list|(
operator|&
name|sc
operator|->
name|time
argument_list|,
operator|&
name|timediff
argument_list|,
operator|&
name|sc
operator|->
name|time
argument_list|)
expr_stmt|;
name|sc
operator|->
name|ncalls
operator|++
expr_stmt|;
if|if
condition|(
name|errorp
condition|)
name|sc
operator|->
name|nerror
operator|++
expr_stmt|;
return|return;
block|}
name|print_syscall
argument_list|(
name|trussinfo
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|trussinfo
operator|->
name|outfile
argument_list|)
expr_stmt|;
if|if
condition|(
name|retval
operator|==
name|NULL
condition|)
block|{
comment|/* 		 * This system call resulted in the current thread's exit, 		 * so there is no return value or error to display. 		 */
name|fprintf
argument_list|(
name|trussinfo
operator|->
name|outfile
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|errorp
condition|)
block|{
name|error
operator|=
name|sysdecode_abi_to_freebsd_errno
argument_list|(
name|t
operator|->
name|proc
operator|->
name|abi
operator|->
name|abi
argument_list|,
name|retval
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|trussinfo
operator|->
name|outfile
argument_list|,
literal|" ERR#%ld '%s'\n"
argument_list|,
name|retval
index|[
literal|0
index|]
argument_list|,
name|error
operator|==
name|INT_MAX
condition|?
literal|"Unknown error"
else|:
name|strerror
argument_list|(
name|error
argument_list|)
argument_list|)
expr_stmt|;
block|}
ifndef|#
directive|ifndef
name|__LP64__
elseif|else
if|if
condition|(
name|sc
operator|->
name|ret_type
operator|==
literal|2
condition|)
block|{
name|off_t
name|off
decl_stmt|;
if|#
directive|if
name|_BYTE_ORDER
operator|==
name|_LITTLE_ENDIAN
name|off
operator|=
operator|(
name|off_t
operator|)
name|retval
index|[
literal|1
index|]
operator|<<
literal|32
operator||
name|retval
index|[
literal|0
index|]
expr_stmt|;
else|#
directive|else
name|off
operator|=
operator|(
name|off_t
operator|)
name|retval
index|[
literal|0
index|]
operator|<<
literal|32
operator||
name|retval
index|[
literal|1
index|]
expr_stmt|;
endif|#
directive|endif
name|fprintf
argument_list|(
name|trussinfo
operator|->
name|outfile
argument_list|,
literal|" = %jd (0x%jx)\n"
argument_list|,
operator|(
name|intmax_t
operator|)
name|off
argument_list|,
operator|(
name|intmax_t
operator|)
name|off
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
else|else
name|fprintf
argument_list|(
name|trussinfo
operator|->
name|outfile
argument_list|,
literal|" = %ld (0x%lx)\n"
argument_list|,
name|retval
index|[
literal|0
index|]
argument_list|,
name|retval
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|print_summary
parameter_list|(
name|struct
name|trussinfo
modifier|*
name|trussinfo
parameter_list|)
block|{
name|struct
name|timespec
name|total
init|=
block|{
literal|0
block|,
literal|0
block|}
decl_stmt|;
name|struct
name|syscall
modifier|*
name|sc
decl_stmt|;
name|int
name|ncall
decl_stmt|,
name|nerror
decl_stmt|;
name|fprintf
argument_list|(
name|trussinfo
operator|->
name|outfile
argument_list|,
literal|"%-20s%15s%8s%8s\n"
argument_list|,
literal|"syscall"
argument_list|,
literal|"seconds"
argument_list|,
literal|"calls"
argument_list|,
literal|"errors"
argument_list|)
expr_stmt|;
name|ncall
operator|=
name|nerror
operator|=
literal|0
expr_stmt|;
name|STAILQ_FOREACH
argument_list|(
argument|sc
argument_list|,
argument|&syscalls
argument_list|,
argument|entries
argument_list|)
if|if
condition|(
name|sc
operator|->
name|ncalls
condition|)
block|{
name|fprintf
argument_list|(
name|trussinfo
operator|->
name|outfile
argument_list|,
literal|"%-20s%5jd.%09ld%8d%8d\n"
argument_list|,
name|sc
operator|->
name|name
argument_list|,
operator|(
name|intmax_t
operator|)
name|sc
operator|->
name|time
operator|.
name|tv_sec
argument_list|,
name|sc
operator|->
name|time
operator|.
name|tv_nsec
argument_list|,
name|sc
operator|->
name|ncalls
argument_list|,
name|sc
operator|->
name|nerror
argument_list|)
expr_stmt|;
name|timespecadd
argument_list|(
operator|&
name|total
argument_list|,
operator|&
name|sc
operator|->
name|time
argument_list|,
operator|&
name|total
argument_list|)
expr_stmt|;
name|ncall
operator|+=
name|sc
operator|->
name|ncalls
expr_stmt|;
name|nerror
operator|+=
name|sc
operator|->
name|nerror
expr_stmt|;
block|}
name|fprintf
argument_list|(
name|trussinfo
operator|->
name|outfile
argument_list|,
literal|"%20s%15s%8s%8s\n"
argument_list|,
literal|""
argument_list|,
literal|"-------------"
argument_list|,
literal|"-------"
argument_list|,
literal|"-------"
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|trussinfo
operator|->
name|outfile
argument_list|,
literal|"%-20s%5jd.%09ld%8d%8d\n"
argument_list|,
literal|""
argument_list|,
operator|(
name|intmax_t
operator|)
name|total
operator|.
name|tv_sec
argument_list|,
name|total
operator|.
name|tv_nsec
argument_list|,
name|ncall
argument_list|,
name|nerror
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

