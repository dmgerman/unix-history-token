begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2015  * The Regents of the University of California.  All rights reserved.  * Michael Tuexen.  All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  * 3. Neither the name of the University nor the names of its contributors  *    may be used to endorse or promote products derived from this software  *    without specific prior written permission.  *  * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|<sys/socket.h>
end_include

begin_include
include|#
directive|include
file|<sys/sysctl.h>
end_include

begin_include
include|#
directive|include
file|<netinet/sctp.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|"systat.h"
end_include

begin_include
include|#
directive|include
file|"extern.h"
end_include

begin_include
include|#
directive|include
file|"mode.h"
end_include

begin_decl_stmt
specifier|static
name|struct
name|sctpstat
name|curstat
decl_stmt|,
name|initstat
decl_stmt|,
name|oldstat
decl_stmt|;
end_decl_stmt

begin_comment
comment|/*- --0         1         2         3         4         5         6         7 --0123456789012345678901234567890123456789012345678901234567890123456789012345 00             SCTP Associations                     SCTP Packets 01999999999999 associations initiated   999999999999 packets sent 02999999999999 associations accepted    999999999999 packets received 03999999999999 associations established 999999999999 - out of the blue 04999999999999 associations restarted   999999999999 - bad vtag 05999999999999 associations terminated  999999999999 - bad crc32c 06999999999999 associations aborted 07 08             SCTP Timers                           SCTP Chunks 09999999999999 init timeouts            999999999999 control chunks sent 10999999999999 cookie timeouts          999999999999 data chunks sent 11999999999999 data timeouts            999999999999 - ordered 12999999999999 delayed sack timeouts    999999999999 - unordered 13999999999999 shutdown timeouts        999999999999 control chunks received 14999999999999 shutdown-ack timeouts    999999999999 data chunks received 15999999999999 shutdown guard timeouts  999999999999 - ordered 16999999999999 heartbeat timeouts       999999999999 - unordered 17999999999999 path MTU timeouts 18999999999999 autoclose timeouts                    SCTP user messages 19999999999999 asconf timeouts          999999999999 fragmented 20999999999999 stream reset timeouts    999999999999 reassembled --0123456789012345678901234567890123456789012345678901234567890123456789012345 --0         1         2         3         4         5         6         7 */
end_comment

begin_function
name|WINDOW
modifier|*
name|opensctp
parameter_list|(
name|void
parameter_list|)
block|{
return|return
operator|(
name|subwin
argument_list|(
name|stdscr
argument_list|,
name|LINES
operator|-
literal|3
operator|-
literal|1
argument_list|,
literal|0
argument_list|,
name|MAINWIN_ROW
argument_list|,
literal|0
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
name|void
name|closesctp
parameter_list|(
name|WINDOW
modifier|*
name|w
parameter_list|)
block|{
if|if
condition|(
name|w
operator|!=
name|NULL
condition|)
block|{
name|wclear
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|delwin
argument_list|(
name|w
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
name|labelsctp
parameter_list|(
name|void
parameter_list|)
block|{
name|wmove
argument_list|(
name|wnd
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|wclrtoeol
argument_list|(
name|wnd
argument_list|)
expr_stmt|;
define|#
directive|define
name|L
parameter_list|(
name|row
parameter_list|,
name|str
parameter_list|)
value|mvwprintw(wnd, row, 13, str)
define|#
directive|define
name|R
parameter_list|(
name|row
parameter_list|,
name|str
parameter_list|)
value|mvwprintw(wnd, row, 51, str);
name|L
argument_list|(
literal|0
argument_list|,
literal|"SCTP Associations"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|0
argument_list|,
literal|"SCTP Packets"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|1
argument_list|,
literal|"associations initiated"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|1
argument_list|,
literal|"packets sent"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|2
argument_list|,
literal|"associations accepted"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|2
argument_list|,
literal|"packets received"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|3
argument_list|,
literal|"associations established"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|3
argument_list|,
literal|"- out of the blue"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|4
argument_list|,
literal|"associations restarted"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|4
argument_list|,
literal|"- bad vtag"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|5
argument_list|,
literal|"associations terminated"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|5
argument_list|,
literal|"- bad crc32c"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|6
argument_list|,
literal|"associations aborted"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|8
argument_list|,
literal|"SCTP Timers"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|8
argument_list|,
literal|"SCTP Chunks"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|9
argument_list|,
literal|"init timeouts"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|9
argument_list|,
literal|"control chunks sent"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|10
argument_list|,
literal|"cookie timeouts"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|10
argument_list|,
literal|"data chunks sent"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|11
argument_list|,
literal|"data timeouts"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|11
argument_list|,
literal|"- ordered"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|12
argument_list|,
literal|"delayed sack timeouts"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|12
argument_list|,
literal|"- unordered"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|13
argument_list|,
literal|"shutdown timeouts"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|13
argument_list|,
literal|"control chunks received"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|14
argument_list|,
literal|"shutdown-ack timeouts"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|14
argument_list|,
literal|"data chunks received"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|15
argument_list|,
literal|"shutdown guard timeouts"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|15
argument_list|,
literal|"- ordered"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|16
argument_list|,
literal|"heartbeat timeouts"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|16
argument_list|,
literal|"- unordered"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|17
argument_list|,
literal|"path MTU timeouts"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|18
argument_list|,
literal|"autoclose timeouts"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|18
argument_list|,
literal|"SCTP User Messages"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|19
argument_list|,
literal|"asconf timeouts"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|19
argument_list|,
literal|"fragmented"
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|20
argument_list|,
literal|"stream reset timeouts"
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|20
argument_list|,
literal|"reassembled"
argument_list|)
expr_stmt|;
undef|#
directive|undef
name|L
undef|#
directive|undef
name|R
block|}
end_function

begin_function
specifier|static
name|void
name|domode
parameter_list|(
name|struct
name|sctpstat
modifier|*
name|ret
parameter_list|)
block|{
specifier|const
name|struct
name|sctpstat
modifier|*
name|sub
decl_stmt|;
name|int
name|divisor
init|=
literal|1
decl_stmt|;
switch|switch
condition|(
name|currentmode
condition|)
block|{
case|case
name|display_RATE
case|:
name|sub
operator|=
operator|&
name|oldstat
expr_stmt|;
name|divisor
operator|=
operator|(
name|delay
operator|>
literal|1000000
operator|)
condition|?
name|delay
operator|/
literal|1000000
else|:
literal|1
expr_stmt|;
break|break;
case|case
name|display_DELTA
case|:
name|sub
operator|=
operator|&
name|oldstat
expr_stmt|;
break|break;
case|case
name|display_SINCE
case|:
name|sub
operator|=
operator|&
name|initstat
expr_stmt|;
break|break;
default|default:
operator|*
name|ret
operator|=
name|curstat
expr_stmt|;
return|return;
block|}
define|#
directive|define
name|DO
parameter_list|(
name|stat
parameter_list|)
value|ret->stat = (curstat.stat - sub->stat) / divisor
name|DO
argument_list|(
name|sctps_currestab
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_activeestab
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_restartestab
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_collisionestab
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_passiveestab
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_aborted
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_shutdown
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_outoftheblue
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_checksumerrors
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_outcontrolchunks
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_outorderchunks
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_outunorderchunks
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_incontrolchunks
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_inorderchunks
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_inunorderchunks
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_fragusrmsgs
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_reasmusrmsgs
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_outpackets
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_inpackets
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvpackets
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvdatagrams
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvpktwithdata
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvsacks
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvdata
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvdupdata
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvheartbeat
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvheartbeatack
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvecne
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvauth
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvauthmissing
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvivalhmacid
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvivalkeyid
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvauthfailed
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvexpress
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvexpressm
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvnocrc
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvswcrc
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_recvhwcrc
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_sendpackets
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_sendsacks
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_senddata
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_sendretransdata
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_sendfastretrans
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_sendmultfastretrans
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_sendheartbeat
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_sendecne
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_sendauth
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_senderrors
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_sendnocrc
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_sendswcrc
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_sendhwcrc
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_pdrpfmbox
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_pdrpfehos
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_pdrpmbda
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_pdrpmbct
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_pdrpbwrpt
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_pdrpcrupt
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_pdrpnedat
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_pdrppdbrk
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_pdrptsnnf
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_pdrpdnfnd
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_pdrpdiwnp
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_pdrpdizrw
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_pdrpbadd
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_pdrpmark
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timoiterator
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timodata
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timowindowprobe
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timoinit
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timosack
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timoshutdown
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timoheartbeat
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timocookie
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timosecret
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timopathmtu
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timoshutdownack
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timoshutdownguard
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timostrmrst
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timoearlyfr
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timoasconf
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timodelprim
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timoautoclose
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timoassockill
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_timoinpkill
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_hdrops
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_badsum
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_noport
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_badvtag
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_badsid
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_nomem
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_fastretransinrtt
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_markedretrans
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_naglesent
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_naglequeued
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_maxburstqueued
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_ifnomemqueued
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_windowprobed
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_lowlevelerr
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_lowlevelerrusr
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_datadropchklmt
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_datadroprwnd
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_ecnereducedcwnd
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_vtagexpress
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_vtagbogus
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_primary_randry
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_cmt_randry
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_slowpath_sack
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_wu_sacks_sent
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_sends_with_flags
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_sends_with_unord
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_sends_with_eof
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_sends_with_abort
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_protocol_drain_calls
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_protocol_drains_done
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_read_peeks
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_cached_chk
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_cached_strmoq
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_left_abandon
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_send_burst_avoid
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_send_cwnd_avoid
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_fwdtsn_map_over
argument_list|)
expr_stmt|;
name|DO
argument_list|(
name|sctps_queue_upd_ecne
argument_list|)
expr_stmt|;
undef|#
directive|undef
name|DO
block|}
end_function

begin_function
name|void
name|showsctp
parameter_list|(
name|void
parameter_list|)
block|{
name|struct
name|sctpstat
name|stats
decl_stmt|;
name|memset
argument_list|(
operator|&
name|stats
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
name|stats
argument_list|)
expr_stmt|;
name|domode
argument_list|(
operator|&
name|stats
argument_list|)
expr_stmt|;
define|#
directive|define
name|DO
parameter_list|(
name|stat
parameter_list|,
name|row
parameter_list|,
name|col
parameter_list|)
define|\
value|mvwprintw(wnd, row, col, "%12lu", stats.stat)
define|#
directive|define
name|L
parameter_list|(
name|row
parameter_list|,
name|stat
parameter_list|)
value|DO(stat, row, 0)
define|#
directive|define
name|R
parameter_list|(
name|row
parameter_list|,
name|stat
parameter_list|)
value|DO(stat, row, 38)
name|L
argument_list|(
literal|1
argument_list|,
name|sctps_activeestab
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|1
argument_list|,
name|sctps_outpackets
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|2
argument_list|,
name|sctps_passiveestab
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|2
argument_list|,
name|sctps_inpackets
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|3
argument_list|,
name|sctps_currestab
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|3
argument_list|,
name|sctps_outoftheblue
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|4
argument_list|,
name|sctps_restartestab
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|4
argument_list|,
name|sctps_badvtag
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|5
argument_list|,
name|sctps_shutdown
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|5
argument_list|,
name|sctps_checksumerrors
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|6
argument_list|,
name|sctps_aborted
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|9
argument_list|,
name|sctps_timoinit
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|9
argument_list|,
name|sctps_outcontrolchunks
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|10
argument_list|,
name|sctps_timocookie
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|10
argument_list|,
name|sctps_senddata
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|11
argument_list|,
name|sctps_timodata
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|11
argument_list|,
name|sctps_outorderchunks
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|12
argument_list|,
name|sctps_timosack
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|12
argument_list|,
name|sctps_outunorderchunks
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|13
argument_list|,
name|sctps_timoshutdown
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|13
argument_list|,
name|sctps_incontrolchunks
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|14
argument_list|,
name|sctps_timoshutdownack
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|14
argument_list|,
name|sctps_recvdata
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|15
argument_list|,
name|sctps_timoshutdownguard
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|15
argument_list|,
name|sctps_inorderchunks
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|16
argument_list|,
name|sctps_timoheartbeat
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|16
argument_list|,
name|sctps_inunorderchunks
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|17
argument_list|,
name|sctps_timopathmtu
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|18
argument_list|,
name|sctps_timoautoclose
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|19
argument_list|,
name|sctps_timoasconf
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|19
argument_list|,
name|sctps_fragusrmsgs
argument_list|)
expr_stmt|;
name|L
argument_list|(
literal|20
argument_list|,
name|sctps_timostrmrst
argument_list|)
expr_stmt|;
name|R
argument_list|(
literal|20
argument_list|,
name|sctps_reasmusrmsgs
argument_list|)
expr_stmt|;
undef|#
directive|undef
name|DO
undef|#
directive|undef
name|L
undef|#
directive|undef
name|R
block|}
end_function

begin_function
name|int
name|initsctp
parameter_list|(
name|void
parameter_list|)
block|{
name|size_t
name|len
decl_stmt|;
specifier|const
name|char
modifier|*
name|name
init|=
literal|"net.inet.sctp.stats"
decl_stmt|;
name|len
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|sysctlbyname
argument_list|(
name|name
argument_list|,
name|NULL
argument_list|,
operator|&
name|len
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|)
operator|<
literal|0
condition|)
block|{
name|error
argument_list|(
literal|"sysctl getting sctpstat size failed"
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
name|len
operator|>
sizeof|sizeof
name|curstat
condition|)
block|{
name|error
argument_list|(
literal|"sctpstat structure has grown--recompile systat!"
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
name|sysctlbyname
argument_list|(
name|name
argument_list|,
operator|&
name|initstat
argument_list|,
operator|&
name|len
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|)
operator|<
literal|0
condition|)
block|{
name|error
argument_list|(
literal|"sysctl getting sctpstat failed"
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
name|oldstat
operator|=
name|initstat
expr_stmt|;
return|return
literal|1
return|;
block|}
end_function

begin_function
name|void
name|resetsctp
parameter_list|(
name|void
parameter_list|)
block|{
name|size_t
name|len
decl_stmt|;
specifier|const
name|char
modifier|*
name|name
init|=
literal|"net.inet.sctp.stats"
decl_stmt|;
name|len
operator|=
sizeof|sizeof
name|initstat
expr_stmt|;
if|if
condition|(
name|sysctlbyname
argument_list|(
name|name
argument_list|,
operator|&
name|initstat
argument_list|,
operator|&
name|len
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|)
operator|<
literal|0
condition|)
block|{
name|error
argument_list|(
literal|"sysctl getting sctpstat failed"
argument_list|)
expr_stmt|;
block|}
name|oldstat
operator|=
name|initstat
expr_stmt|;
block|}
end_function

begin_function
name|void
name|fetchsctp
parameter_list|(
name|void
parameter_list|)
block|{
name|size_t
name|len
decl_stmt|;
specifier|const
name|char
modifier|*
name|name
init|=
literal|"net.inet.sctp.stats"
decl_stmt|;
name|oldstat
operator|=
name|curstat
expr_stmt|;
name|len
operator|=
sizeof|sizeof
name|curstat
expr_stmt|;
if|if
condition|(
name|sysctlbyname
argument_list|(
name|name
argument_list|,
operator|&
name|curstat
argument_list|,
operator|&
name|len
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|)
operator|<
literal|0
condition|)
block|{
name|error
argument_list|(
literal|"sysctl getting sctpstat failed"
argument_list|)
expr_stmt|;
block|}
return|return;
block|}
end_function

end_unit

