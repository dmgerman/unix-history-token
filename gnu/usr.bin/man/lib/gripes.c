begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * gripes.c  *  * Copyright (c) 1990, 1991, John W. Eaton.  *  * You may distribute under the terms of the GNU General Public  * License as specified in the file COPYING that comes with the man  * distribution.  *  * John W. Eaton  * jwe@che.utexas.edu  * Department of Chemical Engineering  * The University of Texas at Austin  * Austin, Texas  78712  */
end_comment

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|"gripes.h"
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|STDC_HEADERS
end_ifdef

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_else
else|#
directive|else
end_else

begin_function_decl
specifier|extern
name|int
name|fprintf
parameter_list|()
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|int
name|fflush
parameter_list|()
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|int
name|exit
parameter_list|()
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
specifier|extern
name|char
modifier|*
name|prognam
decl_stmt|;
end_decl_stmt

begin_function
name|void
name|gripe_no_name
parameter_list|(
name|section
parameter_list|)
name|char
modifier|*
name|section
decl_stmt|;
block|{
if|if
condition|(
name|section
condition|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"What manual page do you want from section %s?\n"
argument_list|,
name|section
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"What manual page do you want?\n"
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stderr
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|gripe_reading_man_file
parameter_list|(
name|name
parameter_list|)
name|char
modifier|*
name|name
decl_stmt|;
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Read access denied for file %s\n"
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stderr
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|gripe_converting_name
parameter_list|(
name|name
parameter_list|,
name|to_cat
parameter_list|)
name|char
modifier|*
name|name
decl_stmt|;
name|int
name|to_cat
decl_stmt|;
block|{
if|if
condition|(
name|to_cat
condition|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Error converting %s to cat name\n"
argument_list|,
name|name
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Error converting %s to man name\n"
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stderr
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|gripe_system_command
parameter_list|(
name|status
parameter_list|)
name|int
name|status
decl_stmt|;
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Error executing formatting or display command.\n"
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"system command exited with status %d\n"
argument_list|,
name|status
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stderr
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|gripe_not_found
parameter_list|(
name|name
parameter_list|,
name|section
parameter_list|)
name|char
modifier|*
name|name
decl_stmt|,
decl|*
name|section
decl_stmt|;
end_function

begin_block
block|{
if|if
condition|(
name|section
condition|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"No entry for %s in section %s of the manual\n"
argument_list|,
name|name
argument_list|,
name|section
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"No manual entry for %s\n"
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stderr
argument_list|)
expr_stmt|;
block|}
end_block

begin_function
name|void
name|gripe_incompatible
parameter_list|(
name|s
parameter_list|)
name|char
modifier|*
name|s
decl_stmt|;
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: incompatible options %s\n"
argument_list|,
name|prognam
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stderr
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|gripe_getting_mp_config
parameter_list|(
name|file
parameter_list|)
name|char
modifier|*
name|file
decl_stmt|;
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: unable to find the file %s\n"
argument_list|,
name|prognam
argument_list|,
name|file
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stderr
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|gripe_reading_mp_config
parameter_list|(
name|file
parameter_list|)
name|char
modifier|*
name|file
decl_stmt|;
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: unable to make sense of the file %s\n"
argument_list|,
name|prognam
argument_list|,
name|file
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stderr
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|gripe_invalid_section
parameter_list|(
name|section
parameter_list|)
name|char
modifier|*
name|section
decl_stmt|;
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: invalid section (%s) selected\n"
argument_list|,
name|prognam
argument_list|,
name|section
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stderr
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|gripe_manpath
parameter_list|()
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: manpath is null\n"
argument_list|,
name|prognam
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stderr
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|gripe_alloc
parameter_list|(
name|bytes
parameter_list|,
name|object
parameter_list|)
name|int
name|bytes
decl_stmt|;
name|char
modifier|*
name|object
decl_stmt|;
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: can't malloc %d bytes for %s\n"
argument_list|,
name|prognam
argument_list|,
name|bytes
argument_list|,
name|object
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stderr
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|gripe_roff_command_from_file
parameter_list|(
name|file
parameter_list|)
name|char
modifier|*
name|file
decl_stmt|;
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Error parsing *roff command from file %s\n"
argument_list|,
name|file
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stderr
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|gripe_roff_command_from_env
parameter_list|()
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Error parsing MANROFFSEQ.  Using system defaults.\n"
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stderr
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
name|gripe_roff_command_from_command_line
parameter_list|()
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Error parsing *roff command from command line.\n"
argument_list|)
expr_stmt|;
name|fflush
argument_list|(
name|stderr
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

