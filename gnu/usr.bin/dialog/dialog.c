begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  *  dialog - Display simple dialog boxes from shell scripts  *  *  AUTHOR: Savio Lam (lam836@cs.cuhk.hk)  *  *  This program is free software; you can redistribute it and/or  *  modify it under the terms of the GNU General Public License  *  as published by the Free Software Foundation; either version 2  *  of the License, or (at your option) any later version.  *  *  This program is distributed in the hope that it will be useful,  *  but WITHOUT ANY WARRANTY; without even the implied warranty of  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  *  GNU General Public License for more details.  *  *  You should have received a copy of the GNU General Public License  *  along with this program; if not, write to the Free Software  *  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.  *  * $FreeBSD$  *  *  *  HISTORY:  *  *  17/12/93 - Version 0.1 released.  *  *  19/12/93 - menu will now scroll if there are more items than can fit  *             on the screen.  *           - added 'checklist', a dialog box with a list of options that  *             can be turned on or off. A list of options that are on is  *             returned on exit.  *  *  20/12/93 - Version 0.15 released.  *  *  29/12/93 - Incorporated patch from Patrick J. Volkerding  *             (volkerdi@mhd1.moorhead.msus.edu) that made these changes:  *             - increased MAX_LEN to 2048  *             - added 'infobox', equivalent to a message box without pausing  *             - added option '--clear' that will clear the screen  *             - Explicit line breaking when printing prompt text can be  *               invoked by real newline '\n' besides the string "\n"  *           - an optional parameter '--title<string>' can be used to  *             specify a title string for the dialog box  *  *  03/01/94 - added 'textbox', a dialog box for displaying text from a file.  *           - Version 0.2 released.  *  *  04/01/94 - some fixes and improvements for 'textbox':  *             - fixed a bug that will cause a segmentation violation when a  *               line is longer than MAX_LEN characters. Lines will now be  *               truncated if they are longer than MAX_LEN characters.  *             - removed wrefresh() from print_line(). This will increase  *               efficiency of print_page() which calls print_line().  *             - display current position in the form of percentage into file.  *           - Version 0.21 released.  *  *  05/01/94 - some changes for faster screen update.  *  *  07/01/94 - much more flexible color settings. Can use all 16 colors  *             (8 normal, 8 highlight) of the Linux console.  *  *  08/01/94 - added run-time configuration using configuration file.  *  *  09/01/94 - some minor bug fixes and cleanups for menubox, checklist and  *             textbox.  *  *  11/01/94 - added a man page.  *  *  13/01/94 - some changes for easier porting to other Unix systems (tested  *             on Ultrix, SunOS and HPUX)  *           - Version 0.3 released.  *  *  08/06/94 - Patches by Stuart Herbert - S.Herbert@shef.ac.uk  * 	       Fixed attr_clear and the textbox stuff to work with ncurses 1.8.5  * 	       Fixed the wordwrap routine - it'll actually wrap properly now  *	       Added a more 3D look to everything - having your own rc file could  *	         prove 'interesting' to say the least :-)  *             Added radiolist option  *	     - Version 0.4 released.  *  *  09/28/98 - Patches by Anatoly A. Orehovsky - tolik@mpeks.tomsk.su  *             Added ftree and tree options  *  */
end_comment

begin_include
include|#
directive|include
file|<sys/types.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<sys/wait.h>
end_include

begin_include
include|#
directive|include
file|<dialog.h>
end_include

begin_function_decl
name|void
name|Usage
parameter_list|(
name|char
modifier|*
name|name
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|int
name|main
parameter_list|(
name|int
name|argc
parameter_list|,
name|char
modifier|*
name|argv
index|[]
parameter_list|)
block|{
name|int
name|offset
init|=
literal|0
decl_stmt|,
name|clear_screen
init|=
literal|0
decl_stmt|,
name|end_common_opts
init|=
literal|0
decl_stmt|,
name|retval
decl_stmt|;
name|unsigned
name|char
modifier|*
name|title
init|=
name|NULL
decl_stmt|;
name|unsigned
name|char
name|result
index|[
name|MAX_LEN
index|]
decl_stmt|;
name|char
modifier|*
name|hline
init|=
name|NULL
decl_stmt|,
modifier|*
name|hfile
init|=
name|NULL
decl_stmt|;
if|if
condition|(
name|argc
operator|<
literal|2
condition|)
block|{
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|argv
index|[
literal|1
index|]
argument_list|,
literal|"--create-rc"
argument_list|)
condition|)
block|{
ifdef|#
directive|ifdef
name|HAVE_NCURSES
if|if
condition|(
name|argc
operator|!=
literal|3
condition|)
block|{
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
name|dialog_create_rc
argument_list|(
name|argv
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
else|#
directive|else
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"\nThis option is currently unsupported on your system.\n"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
endif|#
directive|endif
block|}
while|while
condition|(
name|offset
operator|<
name|argc
operator|-
literal|1
operator|&&
operator|!
name|end_common_opts
condition|)
block|{
comment|/* Common options */
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|1
index|]
argument_list|,
literal|"--title"
argument_list|)
condition|)
block|{
if|if
condition|(
name|argc
operator|-
name|offset
operator|<
literal|3
operator|||
name|title
operator|!=
name|NULL
condition|)
block|{
comment|/* No two "--title" please! */
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|title
operator|=
name|argv
index|[
name|offset
operator|+
literal|2
index|]
expr_stmt|;
name|offset
operator|+=
literal|2
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|1
index|]
argument_list|,
literal|"--hline"
argument_list|)
condition|)
block|{
if|if
condition|(
name|argc
operator|-
name|offset
operator|<
literal|3
operator|||
name|hline
operator|!=
name|NULL
condition|)
block|{
comment|/* No two "--hline" please! */
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|hline
operator|=
name|argv
index|[
name|offset
operator|+
literal|2
index|]
expr_stmt|;
name|use_helpline
argument_list|(
name|hline
argument_list|)
expr_stmt|;
name|offset
operator|+=
literal|2
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|1
index|]
argument_list|,
literal|"--hfile"
argument_list|)
condition|)
block|{
if|if
condition|(
name|argc
operator|-
name|offset
operator|<
literal|3
operator|||
name|hfile
operator|!=
name|NULL
condition|)
block|{
comment|/* No two "--hfile" please! */
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|hfile
operator|=
name|argv
index|[
name|offset
operator|+
literal|2
index|]
expr_stmt|;
name|use_helpfile
argument_list|(
name|hfile
argument_list|)
expr_stmt|;
name|offset
operator|+=
literal|2
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|1
index|]
argument_list|,
literal|"--clear"
argument_list|)
condition|)
block|{
if|if
condition|(
name|clear_screen
condition|)
block|{
comment|/* Hey, "--clear" can't appear twice! */
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|argc
operator|==
literal|2
condition|)
block|{
comment|/* we only want to clear the screen */
name|init_dialog
argument_list|()
expr_stmt|;
name|dialog_update
argument_list|()
expr_stmt|;
comment|/* init_dialog() will clear the screen for us */
name|end_dialog
argument_list|()
expr_stmt|;
return|return
literal|0
return|;
block|}
else|else
block|{
name|clear_screen
operator|=
literal|1
expr_stmt|;
name|offset
operator|++
expr_stmt|;
block|}
block|}
else|else
comment|/* no more common options */
name|end_common_opts
operator|=
literal|1
expr_stmt|;
block|}
if|if
condition|(
name|argc
operator|-
literal|1
operator|==
name|offset
condition|)
block|{
comment|/* no more options */
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
comment|/* Box options */
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|1
index|]
argument_list|,
literal|"--yesno"
argument_list|)
condition|)
block|{
if|if
condition|(
name|argc
operator|-
name|offset
operator|!=
literal|5
condition|)
block|{
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
name|init_dialog
argument_list|()
expr_stmt|;
name|retval
operator|=
name|dialog_yesno
argument_list|(
name|title
argument_list|,
name|argv
index|[
name|offset
operator|+
literal|2
index|]
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|3
index|]
argument_list|)
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|4
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|dialog_update
argument_list|()
expr_stmt|;
if|if
condition|(
name|clear_screen
condition|)
comment|/* clear screen before exit */
name|dialog_clear
argument_list|()
expr_stmt|;
name|end_dialog
argument_list|()
expr_stmt|;
return|return
name|retval
return|;
block|}
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|1
index|]
argument_list|,
literal|"--msgbox"
argument_list|)
condition|)
block|{
if|if
condition|(
name|argc
operator|-
name|offset
operator|!=
literal|5
condition|)
block|{
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
name|init_dialog
argument_list|()
expr_stmt|;
name|retval
operator|=
name|dialog_msgbox
argument_list|(
name|title
argument_list|,
name|argv
index|[
name|offset
operator|+
literal|2
index|]
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|3
index|]
argument_list|)
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|4
index|]
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|dialog_update
argument_list|()
expr_stmt|;
if|if
condition|(
name|clear_screen
condition|)
comment|/* clear screen before exit */
name|dialog_clear
argument_list|()
expr_stmt|;
name|end_dialog
argument_list|()
expr_stmt|;
return|return
name|retval
return|;
block|}
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|1
index|]
argument_list|,
literal|"--prgbox"
argument_list|)
condition|)
block|{
if|if
condition|(
name|argc
operator|-
name|offset
operator|!=
literal|5
condition|)
block|{
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
name|init_dialog
argument_list|()
expr_stmt|;
name|retval
operator|=
name|dialog_prgbox
argument_list|(
name|title
argument_list|,
name|argv
index|[
name|offset
operator|+
literal|2
index|]
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|3
index|]
argument_list|)
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|4
index|]
argument_list|)
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|dialog_update
argument_list|()
expr_stmt|;
if|if
condition|(
name|clear_screen
condition|)
comment|/* clear screen before exit */
name|dialog_clear
argument_list|()
expr_stmt|;
name|end_dialog
argument_list|()
expr_stmt|;
return|return
name|WEXITSTATUS
argument_list|(
name|retval
argument_list|)
return|;
block|}
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|1
index|]
argument_list|,
literal|"--infobox"
argument_list|)
condition|)
block|{
if|if
condition|(
name|argc
operator|-
name|offset
operator|!=
literal|5
condition|)
block|{
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
name|init_dialog
argument_list|()
expr_stmt|;
name|retval
operator|=
name|dialog_msgbox
argument_list|(
name|title
argument_list|,
name|argv
index|[
name|offset
operator|+
literal|2
index|]
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|3
index|]
argument_list|)
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|4
index|]
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|dialog_update
argument_list|()
expr_stmt|;
if|if
condition|(
name|clear_screen
condition|)
comment|/* clear screen before exit */
name|dialog_clear
argument_list|()
expr_stmt|;
name|end_dialog
argument_list|()
expr_stmt|;
return|return
name|retval
return|;
block|}
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|1
index|]
argument_list|,
literal|"--textbox"
argument_list|)
condition|)
block|{
if|if
condition|(
name|argc
operator|-
name|offset
operator|!=
literal|5
condition|)
block|{
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
name|init_dialog
argument_list|()
expr_stmt|;
name|retval
operator|=
name|dialog_textbox
argument_list|(
name|title
argument_list|,
name|argv
index|[
name|offset
operator|+
literal|2
index|]
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|3
index|]
argument_list|)
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|4
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|dialog_update
argument_list|()
expr_stmt|;
if|if
condition|(
name|clear_screen
condition|)
comment|/* clear screen before exit */
name|dialog_clear
argument_list|()
expr_stmt|;
name|end_dialog
argument_list|()
expr_stmt|;
return|return
name|retval
return|;
block|}
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|1
index|]
argument_list|,
literal|"--menu"
argument_list|)
condition|)
block|{
if|if
condition|(
name|argc
operator|-
name|offset
operator|<
literal|8
operator|||
operator|(
operator|(
name|argc
operator|-
name|offset
operator|)
operator|%
literal|2
operator|)
condition|)
block|{
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
name|init_dialog
argument_list|()
expr_stmt|;
name|retval
operator|=
name|dialog_menu
argument_list|(
name|title
argument_list|,
name|argv
index|[
name|offset
operator|+
literal|2
index|]
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|3
index|]
argument_list|)
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|4
index|]
argument_list|)
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|5
index|]
argument_list|)
argument_list|,
operator|(
name|argc
operator|-
name|offset
operator|-
literal|6
operator|)
operator|/
literal|2
argument_list|,
name|argv
operator|+
name|offset
operator|+
literal|6
argument_list|,
name|result
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|dialog_update
argument_list|()
expr_stmt|;
if|if
condition|(
name|retval
operator|==
literal|0
condition|)
name|fputs
argument_list|(
name|result
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
if|if
condition|(
name|clear_screen
condition|)
comment|/* clear screen before exit */
name|dialog_clear
argument_list|()
expr_stmt|;
name|end_dialog
argument_list|()
expr_stmt|;
return|return
name|retval
return|;
block|}
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|1
index|]
argument_list|,
literal|"--checklist"
argument_list|)
condition|)
block|{
if|if
condition|(
name|argc
operator|-
name|offset
operator|<
literal|9
operator|||
operator|(
operator|(
name|argc
operator|-
name|offset
operator|-
literal|6
operator|)
operator|%
literal|3
operator|)
condition|)
block|{
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
name|init_dialog
argument_list|()
expr_stmt|;
name|retval
operator|=
name|dialog_checklist
argument_list|(
name|title
argument_list|,
name|argv
index|[
name|offset
operator|+
literal|2
index|]
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|3
index|]
argument_list|)
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|4
index|]
argument_list|)
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|5
index|]
argument_list|)
argument_list|,
operator|(
name|argc
operator|-
name|offset
operator|-
literal|6
operator|)
operator|/
literal|3
argument_list|,
name|argv
operator|+
name|offset
operator|+
literal|6
argument_list|,
name|result
argument_list|)
expr_stmt|;
name|dialog_update
argument_list|()
expr_stmt|;
if|if
condition|(
name|retval
operator|==
literal|0
condition|)
block|{
name|unsigned
name|char
modifier|*
name|s
decl_stmt|,
modifier|*
name|h
decl_stmt|;
name|int
name|first
decl_stmt|;
name|h
operator|=
name|result
expr_stmt|;
name|first
operator|=
literal|1
expr_stmt|;
while|while
condition|(
operator|(
name|s
operator|=
name|strchr
argument_list|(
name|h
argument_list|,
literal|'\n'
argument_list|)
operator|)
operator|!=
name|NULL
condition|)
block|{
operator|*
name|s
operator|++
operator|=
literal|'\0'
expr_stmt|;
if|if
condition|(
operator|!
name|first
condition|)
name|fputc
argument_list|(
literal|' '
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
else|else
name|first
operator|=
literal|0
expr_stmt|;
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"\"%s\""
argument_list|,
name|h
argument_list|)
expr_stmt|;
name|h
operator|=
name|s
expr_stmt|;
block|}
block|}
if|if
condition|(
name|clear_screen
condition|)
comment|/* clear screen before exit */
name|dialog_clear
argument_list|()
expr_stmt|;
name|end_dialog
argument_list|()
expr_stmt|;
return|return
name|retval
return|;
block|}
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|1
index|]
argument_list|,
literal|"--radiolist"
argument_list|)
condition|)
block|{
if|if
condition|(
name|argc
operator|-
name|offset
operator|<
literal|9
operator|||
operator|(
operator|(
name|argc
operator|-
name|offset
operator|-
literal|6
operator|)
operator|%
literal|3
operator|)
condition|)
block|{
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
name|init_dialog
argument_list|()
expr_stmt|;
name|retval
operator|=
name|dialog_radiolist
argument_list|(
name|title
argument_list|,
name|argv
index|[
name|offset
operator|+
literal|2
index|]
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|3
index|]
argument_list|)
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|4
index|]
argument_list|)
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|5
index|]
argument_list|)
argument_list|,
operator|(
name|argc
operator|-
name|offset
operator|-
literal|6
operator|)
operator|/
literal|3
argument_list|,
name|argv
operator|+
name|offset
operator|+
literal|6
argument_list|,
name|result
argument_list|)
expr_stmt|;
name|dialog_update
argument_list|()
expr_stmt|;
if|if
condition|(
name|retval
operator|==
literal|0
condition|)
name|fputs
argument_list|(
name|result
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
if|if
condition|(
name|clear_screen
condition|)
comment|/* clear screen before exit */
name|dialog_clear
argument_list|()
expr_stmt|;
name|end_dialog
argument_list|()
expr_stmt|;
return|return
name|retval
return|;
block|}
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|1
index|]
argument_list|,
literal|"--inputbox"
argument_list|)
condition|)
block|{
if|if
condition|(
name|argc
operator|-
name|offset
operator|!=
literal|5
operator|&&
name|argc
operator|-
name|offset
operator|!=
literal|6
condition|)
block|{
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|argc
operator|-
name|offset
operator|==
literal|6
condition|)
name|strcpy
argument_list|(
name|result
argument_list|,
name|argv
index|[
name|offset
operator|+
literal|5
index|]
argument_list|)
expr_stmt|;
else|else
operator|*
name|result
operator|=
literal|'\0'
expr_stmt|;
name|init_dialog
argument_list|()
expr_stmt|;
name|retval
operator|=
name|dialog_inputbox
argument_list|(
name|title
argument_list|,
name|argv
index|[
name|offset
operator|+
literal|2
index|]
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|3
index|]
argument_list|)
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|4
index|]
argument_list|)
argument_list|,
name|result
argument_list|)
expr_stmt|;
name|dialog_update
argument_list|()
expr_stmt|;
if|if
condition|(
name|retval
operator|==
literal|0
condition|)
name|fputs
argument_list|(
name|result
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
if|if
condition|(
name|clear_screen
condition|)
comment|/* clear screen before exit */
name|dialog_clear
argument_list|()
expr_stmt|;
name|end_dialog
argument_list|()
expr_stmt|;
return|return
name|retval
return|;
block|}
comment|/* ftree and tree options */
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|1
index|]
argument_list|,
literal|"--ftree"
argument_list|)
condition|)
block|{
name|unsigned
name|char
modifier|*
name|tresult
decl_stmt|;
if|if
condition|(
name|argc
operator|-
name|offset
operator|!=
literal|8
condition|)
block|{
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
name|init_dialog
argument_list|()
expr_stmt|;
name|retval
operator|=
name|dialog_ftree
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|2
index|]
argument_list|,
operator|*
name|argv
index|[
name|offset
operator|+
literal|3
index|]
argument_list|,
name|title
argument_list|,
name|argv
index|[
name|offset
operator|+
literal|4
index|]
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|5
index|]
argument_list|)
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|6
index|]
argument_list|)
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|7
index|]
argument_list|)
argument_list|,
operator|&
name|tresult
argument_list|)
expr_stmt|;
name|dialog_update
argument_list|()
expr_stmt|;
if|if
condition|(
operator|!
name|retval
condition|)
block|{
name|fputs
argument_list|(
name|tresult
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|tresult
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|clear_screen
condition|)
comment|/* clear screen before exit */
name|dialog_clear
argument_list|()
expr_stmt|;
name|end_dialog
argument_list|()
expr_stmt|;
return|return
name|retval
return|;
block|}
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|1
index|]
argument_list|,
literal|"--tree"
argument_list|)
condition|)
block|{
name|unsigned
name|char
modifier|*
name|tresult
decl_stmt|;
if|if
condition|(
name|argc
operator|-
name|offset
operator|<
literal|8
condition|)
block|{
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
name|init_dialog
argument_list|()
expr_stmt|;
name|retval
operator|=
name|dialog_tree
argument_list|(
operator|(
name|unsigned
name|char
operator|*
operator|*
operator|)
name|argv
operator|+
name|offset
operator|+
literal|7
argument_list|,
name|argc
operator|-
name|offset
operator|-
literal|7
argument_list|,
operator|*
name|argv
index|[
name|offset
operator|+
literal|2
index|]
argument_list|,
name|title
argument_list|,
name|argv
index|[
name|offset
operator|+
literal|3
index|]
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|4
index|]
argument_list|)
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|5
index|]
argument_list|)
argument_list|,
name|atoi
argument_list|(
name|argv
index|[
name|offset
operator|+
literal|6
index|]
argument_list|)
argument_list|,
operator|&
name|tresult
argument_list|)
expr_stmt|;
name|dialog_update
argument_list|()
expr_stmt|;
if|if
condition|(
operator|!
name|retval
condition|)
name|fputs
argument_list|(
name|tresult
argument_list|,
name|stderr
argument_list|)
expr_stmt|;
if|if
condition|(
name|clear_screen
condition|)
comment|/* clear screen before exit */
name|dialog_clear
argument_list|()
expr_stmt|;
name|end_dialog
argument_list|()
expr_stmt|;
return|return
name|retval
return|;
block|}
name|Usage
argument_list|(
name|argv
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* End of main() */
end_comment

begin_comment
comment|/*  * Print program usage  */
end_comment

begin_function
name|void
name|Usage
parameter_list|(
name|char
modifier|*
name|name
parameter_list|)
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"\ \ndialog version 0.3, by Savio Lam (lam836@cs.cuhk.hk).\ \n  patched to version %s by Stuart Herbert (S.Herbert@shef.ac.uk)\ \n  Changes Copyright (C) 1995 by Andrey A. Chernov, Moscow, Russia\ \n  patched by Anatoly A. Orehovsky (tolik@mpeks.tomsk.su)\ \n\ \n* Display dialog boxes from shell scripts *\ \n\ \nUsage: %s --clear\ \n       %s --create-rc<file>\ \n       %s [--title<title>] [--clear] [--hline<line>] [--hfile<file>]\\\ \n<Box options>\ \n\ \nBox options:\ \n\ \n  --yesno<text><height><width>\ \n  --msgbox<text><height><width>\ \n  --prgbox    \"<command line>\"<height><width>\ \n  --infobox<text><height><width>\ \n  --inputbox<text><height><width> [<init string>]\ \n  --textbox<file><height><width>\ \n  --menu<text><height><width><menu height><tag1><item1>...\ \n  --checklist<text><height><width><list height><tag1><item1><status1>...\ \n  --radiolist<text><height><width><list height><tag1><item1><status1>...\ \n  --ftree<file><FS><text><height><width><menu height>\ \n  --tree<FS><text><height><width><menu height><item1>...\n"
argument_list|,
name|VERSION
argument_list|,
name|name
argument_list|,
name|name
argument_list|,
name|name
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* End of Usage() */
end_comment

end_unit

