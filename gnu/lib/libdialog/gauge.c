begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * gauge.c  *  * progress indicator for libdialog  *  *  * Copyright (c) 1995, Marc van Kempen  *  * All rights reserved.  *  * This software may be used, modified, copied, distributed, and  * sold, in both source and binary form provided that the above  * copyright and these terms are retained, verbatim, as the first  * lines of this file.  Under no circumstances is the author  * responsible for the proper functioning of this software, nor does  * the author assume any responsibility for damages incurred with  * its use.  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_include
include|#
directive|include
file|"dialog.h"
end_include

begin_function
name|void
name|dialog_gauge
parameter_list|(
name|char
modifier|*
name|title
parameter_list|,
name|char
modifier|*
name|prompt
parameter_list|,
name|int
name|y
parameter_list|,
name|int
name|x
parameter_list|,
name|int
name|height
parameter_list|,
name|int
name|width
parameter_list|,
name|int
name|perc
parameter_list|)
comment|/*  * Desc: display a progress bar, progress indicated by<perc>  */
block|{
name|WINDOW
modifier|*
name|gw
decl_stmt|;
name|int
name|glen
decl_stmt|,
name|i
decl_stmt|;
name|char
name|percs
index|[
literal|5
index|]
decl_stmt|;
name|gw
operator|=
name|newwin
argument_list|(
name|height
argument_list|,
name|width
argument_list|,
name|y
argument_list|,
name|x
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|gw
condition|)
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"dialog_gauge: Error creating window (%d, %d, %d, %d)"
argument_list|,
name|height
argument_list|,
name|width
argument_list|,
name|y
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|exit
argument_list|(
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
name|draw_box
argument_list|(
name|gw
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|height
argument_list|,
name|width
argument_list|,
name|dialog_attr
argument_list|,
name|border_attr
argument_list|)
expr_stmt|;
name|draw_shadow
argument_list|(
name|stdscr
argument_list|,
name|y
argument_list|,
name|x
argument_list|,
name|height
argument_list|,
name|width
argument_list|)
expr_stmt|;
name|wattrset
argument_list|(
name|gw
argument_list|,
name|title_attr
argument_list|)
expr_stmt|;
if|if
condition|(
name|title
condition|)
block|{
name|wmove
argument_list|(
name|gw
argument_list|,
literal|0
argument_list|,
operator|(
name|width
operator|-
name|strlen
argument_list|(
name|title
argument_list|)
operator|)
operator|/
literal|2
operator|-
literal|1
argument_list|)
expr_stmt|;
name|waddstr
argument_list|(
name|gw
argument_list|,
literal|"[ "
argument_list|)
expr_stmt|;
name|waddstr
argument_list|(
name|gw
argument_list|,
name|title
argument_list|)
expr_stmt|;
name|waddstr
argument_list|(
name|gw
argument_list|,
literal|" ]"
argument_list|)
expr_stmt|;
block|}
name|wattrset
argument_list|(
name|gw
argument_list|,
name|dialog_attr
argument_list|)
expr_stmt|;
if|if
condition|(
name|prompt
condition|)
block|{
name|wmove
argument_list|(
name|gw
argument_list|,
literal|1
argument_list|,
operator|(
name|width
operator|-
name|strlen
argument_list|(
name|prompt
argument_list|)
operator|)
operator|/
literal|2
operator|-
literal|1
argument_list|)
expr_stmt|;
name|waddstr
argument_list|(
name|gw
argument_list|,
name|prompt
argument_list|)
expr_stmt|;
block|}
name|draw_box
argument_list|(
name|gw
argument_list|,
literal|2
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|width
operator|-
literal|4
argument_list|,
name|dialog_attr
argument_list|,
name|border_attr
argument_list|)
expr_stmt|;
name|glen
operator|=
call|(
name|int
call|)
argument_list|(
operator|(
name|float
operator|)
name|perc
operator|/
literal|100
operator|*
operator|(
name|width
operator|-
literal|6
operator|)
argument_list|)
expr_stmt|;
name|wattrset
argument_list|(
name|gw
argument_list|,
name|dialog_attr
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|percs
argument_list|,
literal|"%3d%%"
argument_list|,
name|perc
argument_list|)
expr_stmt|;
name|wmove
argument_list|(
name|gw
argument_list|,
literal|5
argument_list|,
name|width
operator|/
literal|2
operator|-
literal|2
argument_list|)
expr_stmt|;
name|waddstr
argument_list|(
name|gw
argument_list|,
name|percs
argument_list|)
expr_stmt|;
name|wattrset
argument_list|(
name|gw
argument_list|,
name|A_BOLD
argument_list|)
expr_stmt|;
name|wmove
argument_list|(
name|gw
argument_list|,
literal|3
argument_list|,
literal|3
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|glen
condition|;
name|i
operator|++
control|)
name|waddch
argument_list|(
name|gw
argument_list|,
literal|' '
argument_list|)
expr_stmt|;
name|wrefresh
argument_list|(
name|gw
argument_list|)
expr_stmt|;
name|delwin
argument_list|(
name|gw
argument_list|)
expr_stmt|;
return|return;
block|}
end_function

begin_comment
comment|/* dialog_gauge() */
end_comment

end_unit

