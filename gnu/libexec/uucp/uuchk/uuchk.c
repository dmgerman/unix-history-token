begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* uuchk.c    Display what we think the permissions of systems are.     Copyright (C) 1991, 1992, 1993, 1994 Ian Lance Taylor     This file is part of the Taylor UUCP package.     This program is free software; you can redistribute it and/or    modify it under the terms of the GNU General Public License as    published by the Free Software Foundation; either version 2 of the    License, or (at your option) any later version.     This program is distributed in the hope that it will be useful, but    WITHOUT ANY WARRANTY; without even the implied warranty of    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU    General Public License for more details.     You should have received a copy of the GNU General Public License    along with this program; if not, write to the Free Software    Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.     The author of the program may be contacted at ian@airs.com or    c/o Cygnus Support, Building 200, 1 Kendall Square, Cambridge, MA 02139.    */
end_comment

begin_include
include|#
directive|include
file|"uucp.h"
end_include

begin_if
if|#
directive|if
name|USE_RCS_ID
end_if

begin_decl_stmt
specifier|const
name|char
name|uuchk_rcsid
index|[]
init|=
literal|"$Id: uuchk.c,v 1.52 1994/05/02 03:43:02 ian Rel $"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|"getopt.h"
end_include

begin_include
include|#
directive|include
file|"uuconf.h"
end_include

begin_escape
end_escape

begin_comment
comment|/* Local functions.  */
end_comment

begin_decl_stmt
specifier|static
name|void
name|ukusage
name|P
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ukhelp
name|P
argument_list|(
operator|(
name|void
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ukshow
name|P
argument_list|(
operator|(
specifier|const
expr|struct
name|uuconf_system
operator|*
name|qsys
operator|,
name|pointer
name|puuconf
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|ikshow_port
name|P
argument_list|(
operator|(
expr|struct
name|uuconf_port
operator|*
name|qport
operator|,
name|pointer
name|pinfo
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ukshow_dialer
name|P
argument_list|(
operator|(
expr|struct
name|uuconf_dialer
operator|*
name|qdial
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ukshow_chat
name|P
argument_list|(
operator|(
specifier|const
expr|struct
name|uuconf_chat
operator|*
name|qchat
operator|,
specifier|const
name|char
operator|*
name|zhdr
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ukshow_size
name|P
argument_list|(
operator|(
expr|struct
name|uuconf_timespan
operator|*
name|q
operator|,
name|boolean
name|fcall
operator|,
name|boolean
name|flocal
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ukshow_reliable
name|P
argument_list|(
operator|(
name|int
name|i
operator|,
specifier|const
name|char
operator|*
name|zhdr
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ukshow_proto_params
name|P
argument_list|(
operator|(
expr|struct
name|uuconf_proto_param
operator|*
name|pas
operator|,
name|int
name|cindent
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ukshow_time
name|P
argument_list|(
operator|(
specifier|const
expr|struct
name|uuconf_timespan
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|struct
name|uuconf_timespan
modifier|*
name|qcompress_span
name|P
argument_list|(
operator|(
expr|struct
name|uuconf_timespan
operator|*
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|void
name|ukuuconf_error
name|P
argument_list|(
operator|(
name|pointer
name|puuconf
operator|,
name|int
name|iret
operator|)
argument_list|)
decl_stmt|;
end_decl_stmt

begin_escape
end_escape

begin_comment
comment|/* Structure used to pass uuconf pointer into ikshow_port and also let    it record whether any ports were found.  */
end_comment

begin_struct
struct|struct
name|sinfo
block|{
comment|/* The uuconf global pointer.  */
name|pointer
name|puuconf
decl_stmt|;
comment|/* The system.  */
specifier|const
name|struct
name|uuconf_system
modifier|*
name|qsys
decl_stmt|;
comment|/* Whether any ports were seen.  */
name|boolean
name|fgot
decl_stmt|;
block|}
struct|;
end_struct

begin_escape
end_escape

begin_comment
comment|/* Program name.  */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|char
modifier|*
name|zKprogram
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Long getopt options.  */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|struct
name|option
name|asKlongopts
index|[]
init|=
block|{
block|{
literal|"config"
block|,
name|required_argument
block|,
name|NULL
block|,
literal|'I'
block|}
block|,
block|{
literal|"debug"
block|,
name|required_argument
block|,
name|NULL
block|,
literal|'x'
block|}
block|,
block|{
literal|"version"
block|,
name|no_argument
block|,
name|NULL
block|,
literal|'v'
block|}
block|,
block|{
literal|"help"
block|,
name|no_argument
block|,
name|NULL
block|,
literal|1
block|}
block|,
block|{
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
name|int
name|main
parameter_list|(
name|argc
parameter_list|,
name|argv
parameter_list|)
name|int
name|argc
decl_stmt|;
name|char
modifier|*
modifier|*
name|argv
decl_stmt|;
block|{
name|int
name|iopt
decl_stmt|;
comment|/* The configuration file name.  */
specifier|const
name|char
modifier|*
name|zconfig
init|=
name|NULL
decl_stmt|;
name|int
name|iret
decl_stmt|;
name|pointer
name|puuconf
decl_stmt|;
name|char
modifier|*
modifier|*
name|pzsystems
decl_stmt|;
name|zKprogram
operator|=
name|argv
index|[
literal|0
index|]
expr_stmt|;
while|while
condition|(
operator|(
name|iopt
operator|=
name|getopt_long
argument_list|(
name|argc
argument_list|,
name|argv
argument_list|,
literal|"I:vx:"
argument_list|,
name|asKlongopts
argument_list|,
operator|(
name|int
operator|*
operator|)
name|NULL
argument_list|)
operator|)
operator|!=
name|EOF
condition|)
block|{
switch|switch
condition|(
name|iopt
condition|)
block|{
case|case
literal|'I'
case|:
comment|/* Set the configuration file name.  */
name|zconfig
operator|=
name|optarg
expr_stmt|;
break|break;
case|case
literal|'x'
case|:
comment|/* Set the debugging level.  There is actually no debugging 	     information for this program.  */
break|break;
case|case
literal|'v'
case|:
comment|/* Print version and exit.  */
name|printf
argument_list|(
literal|"%s: Taylor UUCP %s, copyright (C) 1991, 1992, 1993, 1994 Ian Lance Taylor\n"
argument_list|,
name|zKprogram
argument_list|,
name|VERSION
argument_list|)
expr_stmt|;
name|exit
argument_list|(
name|EXIT_SUCCESS
argument_list|)
expr_stmt|;
comment|/*NOTREACHED*/
case|case
literal|1
case|:
comment|/* --help.  */
name|ukhelp
argument_list|()
expr_stmt|;
name|exit
argument_list|(
name|EXIT_SUCCESS
argument_list|)
expr_stmt|;
comment|/*NOTREACHED*/
case|case
literal|0
case|:
comment|/* Long option found and flag set.  */
break|break;
default|default:
name|ukusage
argument_list|()
expr_stmt|;
comment|/*NOTREACHED*/
block|}
block|}
if|if
condition|(
name|optind
operator|!=
name|argc
condition|)
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: too many arguments"
argument_list|,
name|zKprogram
argument_list|)
expr_stmt|;
name|ukusage
argument_list|()
expr_stmt|;
block|}
name|iret
operator|=
name|uuconf_init
argument_list|(
operator|&
name|puuconf
argument_list|,
operator|(
specifier|const
name|char
operator|*
operator|)
name|NULL
argument_list|,
name|zconfig
argument_list|)
expr_stmt|;
if|if
condition|(
name|iret
operator|!=
name|UUCONF_SUCCESS
condition|)
name|ukuuconf_error
argument_list|(
name|puuconf
argument_list|,
name|iret
argument_list|)
expr_stmt|;
name|iret
operator|=
name|uuconf_system_names
argument_list|(
name|puuconf
argument_list|,
operator|&
name|pzsystems
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
if|if
condition|(
name|iret
operator|!=
name|UUCONF_SUCCESS
condition|)
name|ukuuconf_error
argument_list|(
name|puuconf
argument_list|,
name|iret
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
name|pzsystems
operator|==
name|NULL
condition|)
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: no systems found\n"
argument_list|,
name|zKprogram
argument_list|)
expr_stmt|;
name|exit
argument_list|(
name|EXIT_FAILURE
argument_list|)
expr_stmt|;
block|}
while|while
condition|(
operator|*
name|pzsystems
operator|!=
name|NULL
condition|)
block|{
name|struct
name|uuconf_system
name|ssys
decl_stmt|;
name|iret
operator|=
name|uuconf_system_info
argument_list|(
name|puuconf
argument_list|,
operator|*
name|pzsystems
argument_list|,
operator|&
name|ssys
argument_list|)
expr_stmt|;
if|if
condition|(
name|iret
operator|!=
name|UUCONF_SUCCESS
condition|)
name|ukuuconf_error
argument_list|(
name|puuconf
argument_list|,
name|iret
argument_list|)
expr_stmt|;
else|else
name|ukshow
argument_list|(
operator|&
name|ssys
argument_list|,
name|puuconf
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|uuconf_system_free
argument_list|(
name|puuconf
argument_list|,
operator|&
name|ssys
argument_list|)
expr_stmt|;
operator|++
name|pzsystems
expr_stmt|;
if|if
condition|(
operator|*
name|pzsystems
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
name|exit
argument_list|(
name|EXIT_SUCCESS
argument_list|)
expr_stmt|;
comment|/* Avoid errors about not returning a value.  */
return|return
literal|0
return|;
block|}
end_function

begin_comment
comment|/* Print a usage message and die.  */
end_comment

begin_function
specifier|static
name|void
name|ukusage
parameter_list|()
block|{
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Usage: %s [{-I,--config} file]\n"
argument_list|,
name|zKprogram
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Use %s --help for help\n"
argument_list|,
name|zKprogram
argument_list|)
expr_stmt|;
name|exit
argument_list|(
name|EXIT_FAILURE
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* Print a help message.  */
end_comment

begin_function
specifier|static
name|void
name|ukhelp
parameter_list|()
block|{
name|printf
argument_list|(
literal|"Taylor UUCP %s, copyright (C) 1991, 1992, 1993, 1994 Ian Lance Taylor\n"
argument_list|,
name|VERSION
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"Usage: %s [{-I,--config} file] [-v] [--version] [--help]\n"
argument_list|,
name|zKprogram
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|" -I,--config file: Set configuration file to use\n"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|" -v,--version: Print version and exit\n"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|" --help: Print help and exit\n"
argument_list|)
expr_stmt|;
block|}
end_function

begin_escape
end_escape

begin_comment
comment|/* Dump out the information for a system.  */
end_comment

begin_function
specifier|static
name|void
name|ukshow
parameter_list|(
name|qsys
parameter_list|,
name|puuconf
parameter_list|)
specifier|const
name|struct
name|uuconf_system
modifier|*
name|qsys
decl_stmt|;
name|pointer
name|puuconf
decl_stmt|;
block|{
name|char
modifier|*
modifier|*
name|pz
decl_stmt|;
name|int
name|i
decl_stmt|;
name|int
name|iret
decl_stmt|;
name|printf
argument_list|(
literal|"System: %s"
argument_list|,
name|qsys
operator|->
name|uuconf_zname
argument_list|)
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_pzalias
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|" ("
argument_list|)
expr_stmt|;
for|for
control|(
name|pz
operator|=
name|qsys
operator|->
name|uuconf_pzalias
init|;
operator|*
name|pz
operator|!=
name|NULL
condition|;
name|pz
operator|++
control|)
block|{
name|printf
argument_list|(
literal|"%s"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
if|if
condition|(
name|pz
index|[
literal|1
index|]
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|" "
argument_list|)
expr_stmt|;
block|}
name|printf
argument_list|(
literal|")"
argument_list|)
expr_stmt|;
block|}
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|qsys
operator|!=
name|NULL
condition|;
name|qsys
operator|=
name|qsys
operator|->
name|uuconf_qalternate
operator|,
name|i
operator|++
control|)
block|{
name|boolean
name|fcall
decl_stmt|,
name|fcalled
decl_stmt|;
name|struct
name|uuconf_timespan
modifier|*
name|qtime
decl_stmt|,
modifier|*
name|qspan
decl_stmt|;
if|if
condition|(
name|i
operator|!=
literal|0
operator|||
name|qsys
operator|->
name|uuconf_qalternate
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"Alternate %d"
argument_list|,
name|i
argument_list|)
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_zalternate
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|" (%s)"
argument_list|,
name|qsys
operator|->
name|uuconf_zalternate
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
comment|/* See if this alternate could be used when calling out.  */
name|fcall
operator|=
name|qsys
operator|->
name|uuconf_fcall
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_qtimegrade
operator|==
name|NULL
condition|)
name|fcall
operator|=
name|FALSE
expr_stmt|;
comment|/* See if this alternate could be used when calling in.  */
name|fcalled
operator|=
name|qsys
operator|->
name|uuconf_fcalled
expr_stmt|;
if|if
condition|(
operator|!
name|fcall
operator|&&
operator|!
name|fcalled
condition|)
block|{
name|printf
argument_list|(
literal|" This alternate is never used\n"
argument_list|)
expr_stmt|;
continue|continue;
block|}
if|if
condition|(
name|fcalled
condition|)
block|{
if|if
condition|(
name|qsys
operator|->
name|uuconf_zcalled_login
operator|!=
name|NULL
operator|&&
name|strcmp
argument_list|(
name|qsys
operator|->
name|uuconf_zcalled_login
argument_list|,
literal|"ANY"
argument_list|)
operator|!=
literal|0
condition|)
block|{
if|if
condition|(
name|i
operator|==
literal|0
operator|&&
name|qsys
operator|->
name|uuconf_qalternate
operator|==
name|NULL
condition|)
name|printf
argument_list|(
literal|" Caller must log in as %s\n"
argument_list|,
name|qsys
operator|->
name|uuconf_zcalled_login
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|" When called using login name %s\n"
argument_list|,
name|qsys
operator|->
name|uuconf_zcalled_login
argument_list|)
expr_stmt|;
block|}
else|else
name|printf
argument_list|(
literal|" When called using any login name\n"
argument_list|)
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_zlocalname
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|" Will use %s as name of local system\n"
argument_list|,
name|qsys
operator|->
name|uuconf_zlocalname
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|fcalled
operator|&&
name|qsys
operator|->
name|uuconf_fcallback
condition|)
block|{
name|printf
argument_list|(
literal|" If called, will call back\n"
argument_list|)
expr_stmt|;
name|fcalled
operator|=
name|FALSE
expr_stmt|;
block|}
if|if
condition|(
name|fcall
condition|)
block|{
name|struct
name|sinfo
name|si
decl_stmt|;
if|if
condition|(
name|i
operator|==
literal|0
operator|&&
name|qsys
operator|->
name|uuconf_qalternate
operator|==
name|NULL
condition|)
name|printf
argument_list|(
literal|" Call out"
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|" This alternate applies when calling"
argument_list|)
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_zport
operator|!=
name|NULL
operator|||
name|qsys
operator|->
name|uuconf_qport
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|" using "
argument_list|)
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_zport
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|"port %s"
argument_list|,
name|qsys
operator|->
name|uuconf_zport
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"a specially defined port"
argument_list|)
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_ibaud
operator|!=
literal|0
condition|)
block|{
name|printf
argument_list|(
literal|" at speed %ld"
argument_list|,
name|qsys
operator|->
name|uuconf_ibaud
argument_list|)
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_ihighbaud
operator|!=
literal|0
condition|)
name|printf
argument_list|(
literal|" to %ld"
argument_list|,
name|qsys
operator|->
name|uuconf_ihighbaud
argument_list|)
expr_stmt|;
block|}
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|qsys
operator|->
name|uuconf_ibaud
operator|!=
literal|0
condition|)
block|{
name|printf
argument_list|(
literal|" at speed %ld"
argument_list|,
name|qsys
operator|->
name|uuconf_ibaud
argument_list|)
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_ihighbaud
operator|!=
literal|0
condition|)
name|printf
argument_list|(
literal|" to %ld"
argument_list|,
name|qsys
operator|->
name|uuconf_ihighbaud
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
else|else
name|printf
argument_list|(
literal|" using any port\n"
argument_list|)
expr_stmt|;
name|si
operator|.
name|puuconf
operator|=
name|puuconf
expr_stmt|;
name|si
operator|.
name|qsys
operator|=
name|qsys
expr_stmt|;
name|si
operator|.
name|fgot
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_qport
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|" The port is defined as:\n"
argument_list|)
expr_stmt|;
operator|(
name|void
operator|)
name|ikshow_port
argument_list|(
name|qsys
operator|->
name|uuconf_qport
argument_list|,
operator|(
name|pointer
operator|)
operator|&
name|si
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|struct
name|uuconf_port
name|sdummy
decl_stmt|;
name|printf
argument_list|(
literal|" The possible ports are:\n"
argument_list|)
expr_stmt|;
name|iret
operator|=
name|uuconf_find_port
argument_list|(
name|puuconf
argument_list|,
name|qsys
operator|->
name|uuconf_zport
argument_list|,
name|qsys
operator|->
name|uuconf_ibaud
argument_list|,
name|qsys
operator|->
name|uuconf_ihighbaud
argument_list|,
name|ikshow_port
argument_list|,
operator|(
name|pointer
operator|)
operator|&
name|si
argument_list|,
operator|&
name|sdummy
argument_list|)
expr_stmt|;
if|if
condition|(
name|iret
operator|!=
name|UUCONF_NOT_FOUND
condition|)
name|ukuuconf_error
argument_list|(
name|puuconf
argument_list|,
name|iret
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|si
operator|.
name|fgot
condition|)
name|printf
argument_list|(
literal|" *** There are no matching ports\n"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|qsys
operator|->
name|uuconf_zphone
operator|!=
name|NULL
condition|)
block|{
if|if
condition|(
operator|(
name|qsys
operator|->
name|uuconf_zport
operator|!=
name|NULL
operator|&&
name|strcmp
argument_list|(
name|qsys
operator|->
name|uuconf_zport
argument_list|,
literal|"TCP"
argument_list|)
operator|==
literal|0
operator|)
operator|||
operator|(
name|qsys
operator|->
name|uuconf_qport
operator|!=
name|NULL
operator|&&
operator|(
name|qsys
operator|->
name|uuconf_qport
operator|->
name|uuconf_ttype
operator|==
name|UUCONF_PORTTYPE_TCP
operator|||
name|qsys
operator|->
name|uuconf_qport
operator|->
name|uuconf_ttype
operator|==
name|UUCONF_PORTTYPE_TLI
operator|)
operator|)
condition|)
name|printf
argument_list|(
literal|" Remote address %s\n"
argument_list|,
name|qsys
operator|->
name|uuconf_zphone
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|" Phone number %s\n"
argument_list|,
name|qsys
operator|->
name|uuconf_zphone
argument_list|)
expr_stmt|;
block|}
name|ukshow_chat
argument_list|(
operator|&
name|qsys
operator|->
name|uuconf_schat
argument_list|,
literal|" Chat"
argument_list|)
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_zcall_login
operator|!=
name|NULL
operator|||
name|qsys
operator|->
name|uuconf_zcall_password
operator|!=
name|NULL
condition|)
block|{
name|char
modifier|*
name|zlogin
decl_stmt|,
modifier|*
name|zpass
decl_stmt|;
name|iret
operator|=
name|uuconf_callout
argument_list|(
name|puuconf
argument_list|,
name|qsys
argument_list|,
operator|&
name|zlogin
argument_list|,
operator|&
name|zpass
argument_list|)
expr_stmt|;
if|if
condition|(
name|iret
operator|==
name|UUCONF_NOT_FOUND
condition|)
name|printf
argument_list|(
literal|" Can not determine login name or password\n"
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|UUCONF_ERROR_VALUE
argument_list|(
name|iret
argument_list|)
operator|==
name|UUCONF_FOPEN_FAILED
condition|)
name|printf
argument_list|(
literal|" Can not read call out file\n"
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|iret
operator|!=
name|UUCONF_SUCCESS
condition|)
name|ukuuconf_error
argument_list|(
name|puuconf
argument_list|,
name|iret
argument_list|)
expr_stmt|;
else|else
block|{
if|if
condition|(
name|zlogin
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|" Login name %s\n"
argument_list|,
name|zlogin
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|pointer
operator|)
name|zlogin
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|zpass
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|" Password %s\n"
argument_list|,
name|zpass
argument_list|)
expr_stmt|;
name|free
argument_list|(
operator|(
name|pointer
operator|)
name|zpass
argument_list|)
expr_stmt|;
block|}
block|}
block|}
name|qtime
operator|=
name|qcompress_span
argument_list|(
name|qsys
operator|->
name|uuconf_qtimegrade
argument_list|)
expr_stmt|;
for|for
control|(
name|qspan
operator|=
name|qtime
init|;
name|qspan
operator|!=
name|NULL
condition|;
name|qspan
operator|=
name|qspan
operator|->
name|uuconf_qnext
control|)
block|{
name|printf
argument_list|(
literal|" "
argument_list|)
expr_stmt|;
name|ukshow_time
argument_list|(
name|qspan
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|" may call if "
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|char
operator|)
name|qspan
operator|->
name|uuconf_ival
operator|==
name|UUCONF_GRADE_LOW
condition|)
name|printf
argument_list|(
literal|"any work"
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"work grade %c or higher"
argument_list|,
operator|(
name|char
operator|)
name|qspan
operator|->
name|uuconf_ival
argument_list|)
expr_stmt|;
if|if
condition|(
name|qspan
operator|->
name|uuconf_cretry
operator|!=
literal|0
condition|)
name|printf
argument_list|(
literal|" (retry %d)"
argument_list|,
name|qspan
operator|->
name|uuconf_cretry
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|qsys
operator|->
name|uuconf_qcalltimegrade
operator|!=
name|NULL
condition|)
block|{
name|boolean
name|fprint
decl_stmt|,
name|fother
decl_stmt|;
name|qtime
operator|=
name|qcompress_span
argument_list|(
name|qsys
operator|->
name|uuconf_qcalltimegrade
argument_list|)
expr_stmt|;
name|fprint
operator|=
name|FALSE
expr_stmt|;
name|fother
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
name|qtime
operator|->
name|uuconf_istart
operator|!=
literal|0
condition|)
name|fother
operator|=
name|TRUE
expr_stmt|;
for|for
control|(
name|qspan
operator|=
name|qtime
init|;
name|qspan
operator|!=
name|NULL
condition|;
name|qspan
operator|=
name|qspan
operator|->
name|uuconf_qnext
control|)
block|{
if|if
condition|(
operator|(
name|char
operator|)
name|qspan
operator|->
name|uuconf_ival
operator|==
name|UUCONF_GRADE_LOW
condition|)
block|{
name|fother
operator|=
name|TRUE
expr_stmt|;
continue|continue;
block|}
name|fprint
operator|=
name|TRUE
expr_stmt|;
name|printf
argument_list|(
literal|" "
argument_list|)
expr_stmt|;
name|ukshow_time
argument_list|(
name|qspan
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|" may accept work grade %c or higher\n"
argument_list|,
operator|(
name|char
operator|)
name|qspan
operator|->
name|uuconf_ival
argument_list|)
expr_stmt|;
if|if
condition|(
name|qspan
operator|->
name|uuconf_qnext
operator|==
name|NULL
condition|)
block|{
if|if
condition|(
name|qspan
operator|->
name|uuconf_iend
operator|!=
literal|7
operator|*
literal|24
operator|*
literal|60
condition|)
name|fother
operator|=
name|TRUE
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|qspan
operator|->
name|uuconf_iend
operator|!=
name|qspan
operator|->
name|uuconf_qnext
operator|->
name|uuconf_istart
condition|)
name|fother
operator|=
name|TRUE
expr_stmt|;
block|}
block|}
if|if
condition|(
name|fprint
operator|&&
name|fother
condition|)
name|printf
argument_list|(
literal|" (At other times may accept any work)\n"
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|qsys
operator|->
name|uuconf_fsequence
condition|)
name|printf
argument_list|(
literal|" Sequence numbers are used\n"
argument_list|)
expr_stmt|;
if|if
condition|(
name|fcalled
condition|)
name|ukshow_chat
argument_list|(
operator|&
name|qsys
operator|->
name|uuconf_scalled_chat
argument_list|,
literal|" When called, chat"
argument_list|)
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_zdebug
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|" Debugging level %s\n"
argument_list|,
name|qsys
operator|->
name|uuconf_zdebug
argument_list|)
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_zmax_remote_debug
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|" Max remote debugging level %s\n"
argument_list|,
name|qsys
operator|->
name|uuconf_zmax_remote_debug
argument_list|)
expr_stmt|;
if|if
condition|(
name|fcall
condition|)
block|{
name|ukshow_size
argument_list|(
name|qsys
operator|->
name|uuconf_qcall_local_size
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|ukshow_size
argument_list|(
name|qsys
operator|->
name|uuconf_qcall_remote_size
argument_list|,
name|TRUE
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|fcalled
condition|)
block|{
name|ukshow_size
argument_list|(
name|qsys
operator|->
name|uuconf_qcalled_local_size
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|ukshow_size
argument_list|(
name|qsys
operator|->
name|uuconf_qcalled_remote_size
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|fcall
condition|)
name|printf
argument_list|(
literal|" May %smake local requests when calling\n"
argument_list|,
name|qsys
operator|->
name|uuconf_fcall_transfer
condition|?
literal|""
else|:
literal|"not "
argument_list|)
expr_stmt|;
if|if
condition|(
name|fcalled
condition|)
name|printf
argument_list|(
literal|" May %smake local requests when called\n"
argument_list|,
name|qsys
operator|->
name|uuconf_fcalled_transfer
condition|?
literal|""
else|:
literal|"not "
argument_list|)
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_fcall_transfer
operator|||
name|qsys
operator|->
name|uuconf_fcalled_transfer
condition|)
block|{
name|printf
argument_list|(
literal|" May send by local request:"
argument_list|)
expr_stmt|;
for|for
control|(
name|pz
operator|=
name|qsys
operator|->
name|uuconf_pzlocal_send
init|;
operator|*
name|pz
operator|!=
name|NULL
condition|;
name|pz
operator|++
control|)
name|printf
argument_list|(
literal|" %s"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|qsys
operator|->
name|uuconf_fsend_request
condition|)
name|printf
argument_list|(
literal|" May not send files by remote request\n"
argument_list|)
expr_stmt|;
else|else
block|{
name|printf
argument_list|(
literal|" May send by remote request:"
argument_list|)
expr_stmt|;
for|for
control|(
name|pz
operator|=
name|qsys
operator|->
name|uuconf_pzremote_send
init|;
operator|*
name|pz
operator|!=
name|NULL
condition|;
name|pz
operator|++
control|)
name|printf
argument_list|(
literal|" %s"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|qsys
operator|->
name|uuconf_fcall_transfer
operator|||
name|qsys
operator|->
name|uuconf_fcalled_transfer
condition|)
block|{
name|printf
argument_list|(
literal|" May accept by local request:"
argument_list|)
expr_stmt|;
for|for
control|(
name|pz
operator|=
name|qsys
operator|->
name|uuconf_pzlocal_receive
init|;
operator|*
name|pz
operator|!=
name|NULL
condition|;
name|pz
operator|++
control|)
name|printf
argument_list|(
literal|" %s"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|qsys
operator|->
name|uuconf_frec_request
condition|)
name|printf
argument_list|(
literal|" May not receive files by remote request\n"
argument_list|)
expr_stmt|;
else|else
block|{
name|printf
argument_list|(
literal|" May receive by remote request:"
argument_list|)
expr_stmt|;
for|for
control|(
name|pz
operator|=
name|qsys
operator|->
name|uuconf_pzremote_receive
init|;
operator|*
name|pz
operator|!=
name|NULL
condition|;
name|pz
operator|++
control|)
name|printf
argument_list|(
literal|" %s"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
name|printf
argument_list|(
literal|" May execute"
argument_list|)
expr_stmt|;
for|for
control|(
name|pz
operator|=
name|qsys
operator|->
name|uuconf_pzcmds
init|;
operator|*
name|pz
operator|!=
name|NULL
condition|;
name|pz
operator|++
control|)
name|printf
argument_list|(
literal|" %s"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|" Execution path"
argument_list|)
expr_stmt|;
for|for
control|(
name|pz
operator|=
name|qsys
operator|->
name|uuconf_pzpath
init|;
operator|*
name|pz
operator|!=
name|NULL
condition|;
name|pz
operator|++
control|)
name|printf
argument_list|(
literal|" %s"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_cfree_space
operator|!=
literal|0
condition|)
name|printf
argument_list|(
literal|" Will leave %ld bytes available\n"
argument_list|,
name|qsys
operator|->
name|uuconf_cfree_space
argument_list|)
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_zpubdir
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|" Public directory is %s\n"
argument_list|,
name|qsys
operator|->
name|uuconf_zpubdir
argument_list|)
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_pzforward_from
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|" May forward from"
argument_list|)
expr_stmt|;
for|for
control|(
name|pz
operator|=
name|qsys
operator|->
name|uuconf_pzforward_from
init|;
operator|*
name|pz
operator|!=
name|NULL
condition|;
name|pz
operator|++
control|)
name|printf
argument_list|(
literal|" %s"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|qsys
operator|->
name|uuconf_pzforward_to
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|" May forward to"
argument_list|)
expr_stmt|;
for|for
control|(
name|pz
operator|=
name|qsys
operator|->
name|uuconf_pzforward_to
init|;
operator|*
name|pz
operator|!=
name|NULL
condition|;
name|pz
operator|++
control|)
name|printf
argument_list|(
literal|" %s"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|qsys
operator|->
name|uuconf_zprotocols
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|" Will use protocols %s\n"
argument_list|,
name|qsys
operator|->
name|uuconf_zprotocols
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|" Will use any known protocol\n"
argument_list|)
expr_stmt|;
if|if
condition|(
name|qsys
operator|->
name|uuconf_qproto_params
operator|!=
name|NULL
condition|)
name|ukshow_proto_params
argument_list|(
name|qsys
operator|->
name|uuconf_qproto_params
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* Show information about a port.  */
end_comment

begin_comment
comment|/*ARGSUSED*/
end_comment

begin_function
specifier|static
name|int
name|ikshow_port
parameter_list|(
name|qport
parameter_list|,
name|pinfo
parameter_list|)
name|struct
name|uuconf_port
modifier|*
name|qport
decl_stmt|;
name|pointer
name|pinfo
decl_stmt|;
block|{
name|struct
name|sinfo
modifier|*
name|qi
init|=
operator|(
expr|struct
name|sinfo
operator|*
operator|)
name|pinfo
decl_stmt|;
name|char
modifier|*
modifier|*
name|pz
decl_stmt|;
name|struct
name|uuconf_modem_port
modifier|*
name|qmodem
decl_stmt|;
name|struct
name|uuconf_tcp_port
modifier|*
name|qtcp
decl_stmt|;
name|struct
name|uuconf_tli_port
modifier|*
name|qtli
decl_stmt|;
name|struct
name|uuconf_pipe_port
modifier|*
name|qpipe
decl_stmt|;
name|qi
operator|->
name|fgot
operator|=
name|TRUE
expr_stmt|;
name|printf
argument_list|(
literal|"  Port name %s\n"
argument_list|,
name|qport
operator|->
name|uuconf_zname
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|qport
operator|->
name|uuconf_ttype
condition|)
block|{
case|case
name|UUCONF_PORTTYPE_STDIN
case|:
name|printf
argument_list|(
literal|"   Port type stdin\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|UUCONF_PORTTYPE_DIRECT
case|:
name|printf
argument_list|(
literal|"   Port type direct\n"
argument_list|)
expr_stmt|;
if|if
condition|(
name|qport
operator|->
name|uuconf_u
operator|.
name|uuconf_sdirect
operator|.
name|uuconf_zdevice
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|"   Device %s\n"
argument_list|,
name|qport
operator|->
name|uuconf_u
operator|.
name|uuconf_sdirect
operator|.
name|uuconf_zdevice
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"   Using port name as device name\n"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"   Speed %ld\n"
argument_list|,
name|qport
operator|->
name|uuconf_u
operator|.
name|uuconf_sdirect
operator|.
name|uuconf_ibaud
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"   Carrier %savailable\n"
argument_list|,
name|qport
operator|->
name|uuconf_u
operator|.
name|uuconf_sdirect
operator|.
name|uuconf_fcarrier
condition|?
literal|""
else|:
literal|"not "
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"   Hardware flow control %savailable\n"
argument_list|,
name|qport
operator|->
name|uuconf_u
operator|.
name|uuconf_sdirect
operator|.
name|uuconf_fhardflow
condition|?
literal|""
else|:
literal|"not "
argument_list|)
expr_stmt|;
break|break;
case|case
name|UUCONF_PORTTYPE_MODEM
case|:
name|qmodem
operator|=
operator|&
name|qport
operator|->
name|uuconf_u
operator|.
name|uuconf_smodem
expr_stmt|;
name|printf
argument_list|(
literal|"   Port type modem\n"
argument_list|)
expr_stmt|;
if|if
condition|(
name|qmodem
operator|->
name|uuconf_zdevice
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|"   Device %s\n"
argument_list|,
name|qmodem
operator|->
name|uuconf_zdevice
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"   Using port name as device name\n"
argument_list|)
expr_stmt|;
if|if
condition|(
name|qmodem
operator|->
name|uuconf_zdial_device
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|"   Dial device %s\n"
argument_list|,
name|qmodem
operator|->
name|uuconf_zdial_device
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"   Speed %ld\n"
argument_list|,
name|qmodem
operator|->
name|uuconf_ibaud
argument_list|)
expr_stmt|;
if|if
condition|(
name|qmodem
operator|->
name|uuconf_ilowbaud
operator|!=
name|qmodem
operator|->
name|uuconf_ihighbaud
condition|)
name|printf
argument_list|(
literal|"   Speed range %ld to %ld\n"
argument_list|,
name|qmodem
operator|->
name|uuconf_ilowbaud
argument_list|,
name|qmodem
operator|->
name|uuconf_ihighbaud
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"   Carrier %savailable\n"
argument_list|,
name|qmodem
operator|->
name|uuconf_fcarrier
condition|?
literal|""
else|:
literal|"not "
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"   Hardware flow control %savailable\n"
argument_list|,
name|qmodem
operator|->
name|uuconf_fhardflow
condition|?
literal|""
else|:
literal|"not "
argument_list|)
expr_stmt|;
if|if
condition|(
name|qmodem
operator|->
name|uuconf_qdialer
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"   Specially defined dialer\n"
argument_list|)
expr_stmt|;
name|ukshow_dialer
argument_list|(
name|qmodem
operator|->
name|uuconf_qdialer
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|qmodem
operator|->
name|uuconf_pzdialer
operator|!=
name|NULL
operator|&&
name|qmodem
operator|->
name|uuconf_pzdialer
index|[
literal|0
index|]
operator|!=
name|NULL
condition|)
block|{
name|struct
name|uuconf_dialer
name|sdial
decl_stmt|;
name|int
name|iret
decl_stmt|;
comment|/* This might be a single dialer name, or it might be a 	     sequence of dialer/token pairs.  */
if|if
condition|(
name|qmodem
operator|->
name|uuconf_pzdialer
index|[
literal|1
index|]
operator|==
name|NULL
operator|||
name|qmodem
operator|->
name|uuconf_pzdialer
index|[
literal|2
index|]
operator|==
name|NULL
condition|)
block|{
name|iret
operator|=
name|uuconf_dialer_info
argument_list|(
name|qi
operator|->
name|puuconf
argument_list|,
name|qmodem
operator|->
name|uuconf_pzdialer
index|[
literal|0
index|]
argument_list|,
operator|&
name|sdial
argument_list|)
expr_stmt|;
if|if
condition|(
name|iret
operator|==
name|UUCONF_NOT_FOUND
condition|)
name|printf
argument_list|(
literal|"   *** No dialer %s\n"
argument_list|,
name|qmodem
operator|->
name|uuconf_pzdialer
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|iret
operator|!=
name|UUCONF_SUCCESS
condition|)
name|ukuuconf_error
argument_list|(
name|qi
operator|->
name|puuconf
argument_list|,
name|iret
argument_list|)
expr_stmt|;
else|else
block|{
name|printf
argument_list|(
literal|"   Dialer %s\n"
argument_list|,
name|qmodem
operator|->
name|uuconf_pzdialer
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|ukshow_dialer
argument_list|(
operator|&
name|sdial
argument_list|)
expr_stmt|;
if|if
condition|(
name|qmodem
operator|->
name|uuconf_pzdialer
index|[
literal|1
index|]
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|"   Token %s\n"
argument_list|,
name|qmodem
operator|->
name|uuconf_pzdialer
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
name|pz
operator|=
name|qmodem
operator|->
name|uuconf_pzdialer
expr_stmt|;
while|while
condition|(
operator|*
name|pz
operator|!=
name|NULL
condition|)
block|{
name|iret
operator|=
name|uuconf_dialer_info
argument_list|(
name|qi
operator|->
name|puuconf
argument_list|,
operator|*
name|pz
argument_list|,
operator|&
name|sdial
argument_list|)
expr_stmt|;
if|if
condition|(
name|iret
operator|==
name|UUCONF_NOT_FOUND
condition|)
name|printf
argument_list|(
literal|"   *** No dialer %s\n"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|iret
operator|!=
name|UUCONF_SUCCESS
condition|)
name|ukuuconf_error
argument_list|(
name|qi
operator|->
name|puuconf
argument_list|,
name|iret
argument_list|)
expr_stmt|;
else|else
block|{
name|printf
argument_list|(
literal|"   Dialer %s\n"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
name|ukshow_dialer
argument_list|(
operator|&
name|sdial
argument_list|)
expr_stmt|;
block|}
operator|++
name|pz
expr_stmt|;
if|if
condition|(
operator|*
name|pz
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"   Token %s\n"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
operator|++
name|pz
expr_stmt|;
block|}
block|}
block|}
block|}
else|else
name|printf
argument_list|(
literal|"   *** No dialer information\n"
argument_list|)
expr_stmt|;
break|break;
case|case
name|UUCONF_PORTTYPE_TCP
case|:
name|qtcp
operator|=
operator|&
name|qport
operator|->
name|uuconf_u
operator|.
name|uuconf_stcp
expr_stmt|;
name|printf
argument_list|(
literal|"   Port type tcp\n"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"   TCP service %s\n"
argument_list|,
name|qtcp
operator|->
name|uuconf_zport
argument_list|)
expr_stmt|;
if|if
condition|(
name|qtcp
operator|->
name|uuconf_pzdialer
operator|!=
name|NULL
operator|&&
name|qtcp
operator|->
name|uuconf_pzdialer
index|[
literal|0
index|]
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"   Dialer sequence"
argument_list|)
expr_stmt|;
for|for
control|(
name|pz
operator|=
name|qtcp
operator|->
name|uuconf_pzdialer
init|;
operator|*
name|pz
operator|!=
name|NULL
condition|;
name|pz
operator|++
control|)
name|printf
argument_list|(
literal|" %s"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|UUCONF_PORTTYPE_TLI
case|:
name|qtli
operator|=
operator|&
name|qport
operator|->
name|uuconf_u
operator|.
name|uuconf_stli
expr_stmt|;
name|printf
argument_list|(
literal|"   Port type TLI%s\n"
argument_list|,
name|qtli
operator|->
name|uuconf_fstream
condition|?
literal|"S"
else|:
literal|""
argument_list|)
expr_stmt|;
if|if
condition|(
name|qtli
operator|->
name|uuconf_zdevice
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|"   Device %s\n"
argument_list|,
name|qtli
operator|->
name|uuconf_zdevice
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"   Using port name as device name\n"
argument_list|)
expr_stmt|;
if|if
condition|(
name|qtli
operator|->
name|uuconf_pzpush
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"   Push"
argument_list|)
expr_stmt|;
for|for
control|(
name|pz
operator|=
name|qtli
operator|->
name|uuconf_pzpush
init|;
operator|*
name|pz
operator|!=
name|NULL
condition|;
name|pz
operator|++
control|)
name|printf
argument_list|(
literal|" %s"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|qtli
operator|->
name|uuconf_pzdialer
operator|!=
name|NULL
operator|&&
name|qtli
operator|->
name|uuconf_pzdialer
index|[
literal|0
index|]
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"   Dialer sequence"
argument_list|)
expr_stmt|;
for|for
control|(
name|pz
operator|=
name|qtli
operator|->
name|uuconf_pzdialer
init|;
operator|*
name|pz
operator|!=
name|NULL
condition|;
name|pz
operator|++
control|)
name|printf
argument_list|(
literal|" %s"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|qtli
operator|->
name|uuconf_zservaddr
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|"   Server address %s\n"
argument_list|,
name|qtli
operator|->
name|uuconf_zservaddr
argument_list|)
expr_stmt|;
break|break;
case|case
name|UUCONF_PORTTYPE_PIPE
case|:
name|qpipe
operator|=
operator|&
name|qport
operator|->
name|uuconf_u
operator|.
name|uuconf_spipe
expr_stmt|;
name|printf
argument_list|(
literal|"   Port type pipe\n"
argument_list|)
expr_stmt|;
if|if
condition|(
name|qpipe
operator|->
name|uuconf_pzcmd
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"   Command"
argument_list|)
expr_stmt|;
for|for
control|(
name|pz
operator|=
name|qpipe
operator|->
name|uuconf_pzcmd
init|;
operator|*
name|pz
operator|!=
name|NULL
condition|;
name|pz
operator|++
control|)
name|printf
argument_list|(
literal|" %s"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
break|break;
default|default:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"   CAN'T HAPPEN\n"
argument_list|)
expr_stmt|;
break|break;
block|}
if|if
condition|(
name|qport
operator|->
name|uuconf_zprotocols
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|"   Will use protocols %s\n"
argument_list|,
name|qport
operator|->
name|uuconf_zprotocols
argument_list|)
expr_stmt|;
if|if
condition|(
name|qport
operator|->
name|uuconf_zlockname
operator|!=
name|NULL
condition|)
name|printf
argument_list|(
literal|"   Will use lockname %s\n"
argument_list|,
name|qport
operator|->
name|uuconf_zlockname
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|qport
operator|->
name|uuconf_ireliable
operator|&
name|UUCONF_RELIABLE_SPECIFIED
operator|)
operator|!=
literal|0
condition|)
name|ukshow_reliable
argument_list|(
name|qport
operator|->
name|uuconf_ireliable
argument_list|,
literal|"   "
argument_list|)
expr_stmt|;
if|if
condition|(
name|qport
operator|->
name|uuconf_qproto_params
operator|!=
name|NULL
condition|)
name|ukshow_proto_params
argument_list|(
name|qport
operator|->
name|uuconf_qproto_params
argument_list|,
literal|3
argument_list|)
expr_stmt|;
comment|/* Return NOT_FOUND to force find_port to continue searching.  */
return|return
name|UUCONF_NOT_FOUND
return|;
block|}
end_function

begin_comment
comment|/* Show information about a dialer.  */
end_comment

begin_function
specifier|static
name|void
name|ukshow_dialer
parameter_list|(
name|q
parameter_list|)
name|struct
name|uuconf_dialer
modifier|*
name|q
decl_stmt|;
block|{
name|ukshow_chat
argument_list|(
operator|&
name|q
operator|->
name|uuconf_schat
argument_list|,
literal|"    Chat"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"    Wait for dialtone %s\n"
argument_list|,
name|q
operator|->
name|uuconf_zdialtone
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"    Pause while dialing %s\n"
argument_list|,
name|q
operator|->
name|uuconf_zpause
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"    Carrier %savailable\n"
argument_list|,
name|q
operator|->
name|uuconf_fcarrier
condition|?
literal|""
else|:
literal|"not "
argument_list|)
expr_stmt|;
if|if
condition|(
name|q
operator|->
name|uuconf_fcarrier
condition|)
name|printf
argument_list|(
literal|"    Wait %d seconds for carrier\n"
argument_list|,
name|q
operator|->
name|uuconf_ccarrier_wait
argument_list|)
expr_stmt|;
if|if
condition|(
name|q
operator|->
name|uuconf_fdtr_toggle
condition|)
block|{
name|printf
argument_list|(
literal|"    Toggle DTR"
argument_list|)
expr_stmt|;
if|if
condition|(
name|q
operator|->
name|uuconf_fdtr_toggle_wait
condition|)
name|printf
argument_list|(
literal|" and wait"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
name|ukshow_chat
argument_list|(
operator|&
name|q
operator|->
name|uuconf_scomplete
argument_list|,
literal|"    When complete chat"
argument_list|)
expr_stmt|;
name|ukshow_chat
argument_list|(
operator|&
name|q
operator|->
name|uuconf_sabort
argument_list|,
literal|"    When aborting chat"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|q
operator|->
name|uuconf_ireliable
operator|&
name|UUCONF_RELIABLE_SPECIFIED
operator|)
operator|!=
literal|0
condition|)
name|ukshow_reliable
argument_list|(
name|q
operator|->
name|uuconf_ireliable
argument_list|,
literal|"   "
argument_list|)
expr_stmt|;
if|if
condition|(
name|q
operator|->
name|uuconf_qproto_params
operator|!=
name|NULL
condition|)
name|ukshow_proto_params
argument_list|(
name|q
operator|->
name|uuconf_qproto_params
argument_list|,
literal|4
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* Show a chat script.  */
end_comment

begin_function
specifier|static
name|void
name|ukshow_chat
parameter_list|(
name|qchat
parameter_list|,
name|zhdr
parameter_list|)
specifier|const
name|struct
name|uuconf_chat
modifier|*
name|qchat
decl_stmt|;
specifier|const
name|char
modifier|*
name|zhdr
decl_stmt|;
block|{
name|char
modifier|*
modifier|*
name|pz
decl_stmt|;
if|if
condition|(
name|qchat
operator|->
name|uuconf_pzprogram
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"%s program"
argument_list|,
name|zhdr
argument_list|)
expr_stmt|;
for|for
control|(
name|pz
operator|=
name|qchat
operator|->
name|uuconf_pzprogram
init|;
operator|*
name|pz
operator|!=
name|NULL
condition|;
name|pz
operator|++
control|)
name|printf
argument_list|(
literal|" %s"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|qchat
operator|->
name|uuconf_pzchat
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"%s script"
argument_list|,
name|zhdr
argument_list|)
expr_stmt|;
for|for
control|(
name|pz
operator|=
name|qchat
operator|->
name|uuconf_pzchat
init|;
operator|*
name|pz
operator|!=
name|NULL
condition|;
name|pz
operator|++
control|)
block|{
if|if
condition|(
operator|(
operator|*
name|pz
operator|)
index|[
literal|0
index|]
operator|!=
literal|'-'
operator|||
name|pz
operator|==
name|qchat
operator|->
name|uuconf_pzchat
condition|)
name|printf
argument_list|(
literal|" "
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"%s"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
block|}
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"%s script timeout %d\n"
argument_list|,
name|zhdr
argument_list|,
name|qchat
operator|->
name|uuconf_ctimeout
argument_list|)
expr_stmt|;
if|if
condition|(
name|qchat
operator|->
name|uuconf_pzfail
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"%s failure strings"
argument_list|,
name|zhdr
argument_list|)
expr_stmt|;
for|for
control|(
name|pz
operator|=
name|qchat
operator|->
name|uuconf_pzfail
init|;
operator|*
name|pz
operator|!=
name|NULL
condition|;
name|pz
operator|++
control|)
name|printf
argument_list|(
literal|" %s"
argument_list|,
operator|*
name|pz
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|qchat
operator|->
name|uuconf_fstrip
condition|)
name|printf
argument_list|(
literal|"%s script incoming bytes stripped to seven bits\n"
argument_list|,
name|zhdr
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/* Show a size/time restriction.  */
end_comment

begin_function
specifier|static
name|void
name|ukshow_size
parameter_list|(
name|qspan
parameter_list|,
name|fcall
parameter_list|,
name|flocal
parameter_list|)
name|struct
name|uuconf_timespan
modifier|*
name|qspan
decl_stmt|;
name|boolean
name|fcall
decl_stmt|;
name|boolean
name|flocal
decl_stmt|;
block|{
name|struct
name|uuconf_timespan
modifier|*
name|q
decl_stmt|;
name|boolean
name|fother
decl_stmt|;
name|qspan
operator|=
name|qcompress_span
argument_list|(
name|qspan
argument_list|)
expr_stmt|;
if|if
condition|(
name|qspan
operator|==
name|NULL
condition|)
return|return;
name|printf
argument_list|(
literal|" If call%s the following applies to a %s request:\n"
argument_list|,
name|fcall
condition|?
literal|"ing"
else|:
literal|"ed"
argument_list|,
name|flocal
condition|?
literal|"local"
else|:
literal|"remote"
argument_list|)
expr_stmt|;
name|fother
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
name|qspan
operator|->
name|uuconf_istart
operator|>=
literal|60
condition|)
name|fother
operator|=
name|TRUE
expr_stmt|;
for|for
control|(
name|q
operator|=
name|qspan
init|;
name|q
operator|!=
name|NULL
condition|;
name|q
operator|=
name|q
operator|->
name|uuconf_qnext
control|)
block|{
name|printf
argument_list|(
literal|"  "
argument_list|)
expr_stmt|;
name|ukshow_time
argument_list|(
name|q
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|" may transfer files %ld bytes or smaller\n"
argument_list|,
name|q
operator|->
name|uuconf_ival
argument_list|)
expr_stmt|;
if|if
condition|(
name|q
operator|->
name|uuconf_qnext
operator|==
name|NULL
condition|)
block|{
if|if
condition|(
name|q
operator|->
name|uuconf_iend
operator|<=
literal|6
operator|*
literal|24
operator|*
literal|60
operator|+
literal|23
operator|*
literal|60
condition|)
name|fother
operator|=
name|TRUE
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|q
operator|->
name|uuconf_iend
operator|+
literal|60
operator|<=
name|q
operator|->
name|uuconf_qnext
operator|->
name|uuconf_istart
condition|)
name|fother
operator|=
name|TRUE
expr_stmt|;
block|}
block|}
if|if
condition|(
name|fother
condition|)
name|printf
argument_list|(
literal|"  (At other times may send files of any size)\n"
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* Show reliability information.  */
end_comment

begin_function
specifier|static
name|void
name|ukshow_reliable
parameter_list|(
name|i
parameter_list|,
name|zhdr
parameter_list|)
name|int
name|i
decl_stmt|;
specifier|const
name|char
modifier|*
name|zhdr
decl_stmt|;
block|{
name|printf
argument_list|(
literal|"%sCharacteristics:"
argument_list|,
name|zhdr
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|i
operator|&
name|UUCONF_RELIABLE_EIGHT
operator|)
operator|!=
literal|0
condition|)
name|printf
argument_list|(
literal|" eight-bit-clean"
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|" not-eight-bit-clean"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|i
operator|&
name|UUCONF_RELIABLE_RELIABLE
operator|)
operator|!=
literal|0
condition|)
name|printf
argument_list|(
literal|" reliable"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|i
operator|&
name|UUCONF_RELIABLE_ENDTOEND
operator|)
operator|!=
literal|0
condition|)
name|printf
argument_list|(
literal|" end-to-end"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|i
operator|&
name|UUCONF_RELIABLE_FULLDUPLEX
operator|)
operator|!=
literal|0
condition|)
name|printf
argument_list|(
literal|" fullduplex"
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|" halfduplex"
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* Show protocol parameters.  */
end_comment

begin_function
specifier|static
name|void
name|ukshow_proto_params
parameter_list|(
name|pas
parameter_list|,
name|cindent
parameter_list|)
name|struct
name|uuconf_proto_param
modifier|*
name|pas
decl_stmt|;
name|int
name|cindent
decl_stmt|;
block|{
name|struct
name|uuconf_proto_param
modifier|*
name|q
decl_stmt|;
for|for
control|(
name|q
operator|=
name|pas
init|;
name|q
operator|->
name|uuconf_bproto
operator|!=
literal|'\0'
condition|;
name|q
operator|++
control|)
block|{
name|int
name|i
decl_stmt|;
name|struct
name|uuconf_proto_param_entry
modifier|*
name|qe
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|cindent
condition|;
name|i
operator|++
control|)
name|printf
argument_list|(
literal|" "
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"For protocol %c will use the following parameters\n"
argument_list|,
name|q
operator|->
name|uuconf_bproto
argument_list|)
expr_stmt|;
for|for
control|(
name|qe
operator|=
name|q
operator|->
name|uuconf_qentries
init|;
name|qe
operator|->
name|uuconf_cargs
operator|>
literal|0
condition|;
name|qe
operator|++
control|)
block|{
name|int
name|ia
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|cindent
condition|;
name|i
operator|++
control|)
name|printf
argument_list|(
literal|" "
argument_list|)
expr_stmt|;
for|for
control|(
name|ia
operator|=
literal|0
init|;
name|ia
operator|<
name|qe
operator|->
name|uuconf_cargs
condition|;
name|ia
operator|++
control|)
name|printf
argument_list|(
literal|" %s"
argument_list|,
name|qe
operator|->
name|uuconf_pzargs
index|[
name|ia
index|]
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_escape
end_escape

begin_comment
comment|/* Display a time span.  */
end_comment

begin_function
specifier|static
name|void
name|ukshow_time
parameter_list|(
name|q
parameter_list|)
specifier|const
name|struct
name|uuconf_timespan
modifier|*
name|q
decl_stmt|;
block|{
name|int
name|idaystart
decl_stmt|,
name|idayend
decl_stmt|;
name|int
name|ihourstart
decl_stmt|,
name|ihourend
decl_stmt|;
name|int
name|iminutestart
decl_stmt|,
name|iminuteend
decl_stmt|;
specifier|const
name|char
modifier|*
specifier|const
name|zdays
init|=
literal|"Sun\0Mon\0Tue\0Wed\0Thu\0Fri\0Sat\0Sun"
decl_stmt|;
if|if
condition|(
name|q
operator|->
name|uuconf_istart
operator|==
literal|0
operator|&&
name|q
operator|->
name|uuconf_iend
operator|==
literal|7
operator|*
literal|24
operator|*
literal|60
condition|)
block|{
name|printf
argument_list|(
literal|"At any time"
argument_list|)
expr_stmt|;
return|return;
block|}
name|idaystart
operator|=
name|q
operator|->
name|uuconf_istart
operator|/
operator|(
literal|24
operator|*
literal|60
operator|)
expr_stmt|;
name|ihourstart
operator|=
operator|(
name|q
operator|->
name|uuconf_istart
operator|%
operator|(
literal|24
operator|*
literal|60
operator|)
operator|)
operator|/
literal|60
expr_stmt|;
name|iminutestart
operator|=
name|q
operator|->
name|uuconf_istart
operator|%
literal|60
expr_stmt|;
name|idayend
operator|=
name|q
operator|->
name|uuconf_iend
operator|/
operator|(
literal|24
operator|*
literal|60
operator|)
expr_stmt|;
name|ihourend
operator|=
operator|(
name|q
operator|->
name|uuconf_iend
operator|%
operator|(
literal|24
operator|*
literal|60
operator|)
operator|)
operator|/
literal|60
expr_stmt|;
name|iminuteend
operator|=
name|q
operator|->
name|uuconf_iend
operator|%
literal|60
expr_stmt|;
if|if
condition|(
name|idaystart
operator|==
name|idayend
condition|)
name|printf
argument_list|(
literal|"%s from %02d:%02d to %02d:%02d"
argument_list|,
name|zdays
operator|+
name|idaystart
operator|*
literal|4
argument_list|,
name|ihourstart
argument_list|,
name|iminutestart
argument_list|,
name|ihourend
argument_list|,
name|iminuteend
argument_list|)
expr_stmt|;
else|else
name|printf
argument_list|(
literal|"From %s %02d:%02d to %s %02d:%02d"
argument_list|,
name|zdays
operator|+
name|idaystart
operator|*
literal|4
argument_list|,
name|ihourstart
argument_list|,
name|iminutestart
argument_list|,
name|zdays
operator|+
name|idayend
operator|*
literal|4
argument_list|,
name|ihourend
argument_list|,
name|iminuteend
argument_list|)
expr_stmt|;
block|}
end_function

begin_escape
end_escape

begin_comment
comment|/* Compress a time span by merging any two adjacent spans with    identical values.  This isn't necessary for uucico, but it looks    nicer when printed out.  */
end_comment

begin_function
specifier|static
name|struct
name|uuconf_timespan
modifier|*
name|qcompress_span
parameter_list|(
name|qlist
parameter_list|)
name|struct
name|uuconf_timespan
modifier|*
name|qlist
decl_stmt|;
block|{
name|struct
name|uuconf_timespan
modifier|*
modifier|*
name|pq
decl_stmt|;
name|pq
operator|=
operator|&
name|qlist
expr_stmt|;
while|while
condition|(
operator|*
name|pq
operator|!=
name|NULL
condition|)
block|{
if|if
condition|(
operator|(
operator|*
name|pq
operator|)
operator|->
name|uuconf_qnext
operator|!=
name|NULL
operator|&&
operator|(
operator|*
name|pq
operator|)
operator|->
name|uuconf_iend
operator|==
operator|(
operator|*
name|pq
operator|)
operator|->
name|uuconf_qnext
operator|->
name|uuconf_istart
operator|&&
operator|(
operator|*
name|pq
operator|)
operator|->
name|uuconf_ival
operator|==
operator|(
operator|*
name|pq
operator|)
operator|->
name|uuconf_qnext
operator|->
name|uuconf_ival
condition|)
block|{
name|struct
name|uuconf_timespan
modifier|*
name|qnext
decl_stmt|;
name|qnext
operator|=
operator|(
operator|*
name|pq
operator|)
operator|->
name|uuconf_qnext
expr_stmt|;
operator|(
operator|*
name|pq
operator|)
operator|->
name|uuconf_qnext
operator|=
name|qnext
operator|->
name|uuconf_qnext
expr_stmt|;
operator|(
operator|*
name|pq
operator|)
operator|->
name|uuconf_iend
operator|=
name|qnext
operator|->
name|uuconf_iend
expr_stmt|;
block|}
else|else
name|pq
operator|=
operator|&
operator|(
operator|*
name|pq
operator|)
operator|->
name|uuconf_qnext
expr_stmt|;
block|}
return|return
name|qlist
return|;
block|}
end_function

begin_escape
end_escape

begin_comment
comment|/* Display a uuconf error and exit.  */
end_comment

begin_function
specifier|static
name|void
name|ukuuconf_error
parameter_list|(
name|puuconf
parameter_list|,
name|iret
parameter_list|)
name|pointer
name|puuconf
decl_stmt|;
name|int
name|iret
decl_stmt|;
block|{
name|char
name|ab
index|[
literal|512
index|]
decl_stmt|;
operator|(
name|void
operator|)
name|uuconf_error_string
argument_list|(
name|puuconf
argument_list|,
name|iret
argument_list|,
name|ab
argument_list|,
sizeof|sizeof
name|ab
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|iret
operator|&
name|UUCONF_ERROR_FILENAME
operator|)
operator|==
literal|0
condition|)
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s: %s\n"
argument_list|,
name|zKprogram
argument_list|,
name|ab
argument_list|)
expr_stmt|;
else|else
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%s:%s\n"
argument_list|,
name|zKprogram
argument_list|,
name|ab
argument_list|)
expr_stmt|;
name|exit
argument_list|(
name|EXIT_FAILURE
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

