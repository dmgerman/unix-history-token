begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* Copyright    Massachusetts Institute of Technology    1984, 1985	*/
end_comment

begin_include
include|#
directive|include
file|<X/Xlib.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<sgtty.h>
end_include

begin_define
define|#
directive|define
name|MAZE_SIZE
value|36
end_define

begin_define
define|#
directive|define
name|PIXSIZE
value|768
end_define

begin_define
define|#
directive|define
name|SCANSIZE
value|(PIXSIZE/16)
end_define

begin_define
define|#
directive|define
name|HALFSIZE
value|(SCANSIZE/2)
end_define

begin_define
define|#
directive|define
name|CENTER
value|(PIXSIZE/2)
end_define

begin_define
define|#
directive|define
name|SIDE
value|(PIXSIZE/3)
end_define

begin_define
define|#
directive|define
name|MASK_SIZE
value|((PIXSIZE*PIXSIZE)/16)
end_define

begin_define
define|#
directive|define
name|STRIP_SIZE
value|(((PIXSIZE/6)*PIXSIZE)/16)
end_define

begin_struct
struct|struct
name|room
block|{
name|struct
name|room
modifier|*
name|north
decl_stmt|;
name|struct
name|room
modifier|*
name|south
decl_stmt|;
name|struct
name|room
modifier|*
name|east
decl_stmt|;
name|struct
name|room
modifier|*
name|west
decl_stmt|;
block|}
struct|;
end_struct

begin_function
name|struct
name|room
modifier|*
name|front
parameter_list|(
name|dir
parameter_list|,
name|rm
parameter_list|)
name|int
name|dir
decl_stmt|;
name|struct
name|room
modifier|*
name|rm
decl_stmt|;
block|{
if|if
condition|(
name|rm
operator|==
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"NULL room\n"
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
switch|switch
condition|(
name|dir
condition|)
block|{
case|case
literal|2
case|:
return|return
operator|(
name|rm
operator|->
name|south
operator|)
return|;
case|case
literal|1
case|:
return|return
operator|(
name|rm
operator|->
name|east
operator|)
return|;
case|case
literal|0
case|:
return|return
operator|(
name|rm
operator|->
name|north
operator|)
return|;
case|case
literal|3
case|:
return|return
operator|(
name|rm
operator|->
name|west
operator|)
return|;
default|default:
name|printf
argument_list|(
literal|"dir = %d\n"
argument_list|,
name|dir
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|struct
name|room
modifier|*
name|left
parameter_list|(
name|dir
parameter_list|,
name|rm
parameter_list|)
name|int
name|dir
decl_stmt|;
name|struct
name|room
modifier|*
name|rm
decl_stmt|;
block|{
return|return
operator|(
name|front
argument_list|(
operator|(
name|dir
operator|+
literal|3
operator|)
operator|%
literal|4
argument_list|,
name|rm
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
name|struct
name|room
modifier|*
name|right
parameter_list|(
name|dir
parameter_list|,
name|rm
parameter_list|)
name|int
name|dir
decl_stmt|;
name|struct
name|room
modifier|*
name|rm
decl_stmt|;
block|{
return|return
operator|(
name|front
argument_list|(
operator|(
name|dir
operator|+
literal|1
operator|)
operator|%
literal|4
argument_list|,
name|rm
argument_list|)
operator|)
return|;
block|}
end_function

begin_decl_stmt
name|Window
name|win
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|forepix
decl_stmt|,
name|backpix
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|Bitmap
name|pat
index|[
literal|20
index|]
decl_stmt|;
end_decl_stmt

begin_function
name|main
parameter_list|(
name|argc
parameter_list|,
name|argv
parameter_list|)
name|int
name|argc
decl_stmt|;
name|char
modifier|*
modifier|*
name|argv
decl_stmt|;
block|{
name|int
name|dir
decl_stmt|,
name|i
decl_stmt|,
name|fd
decl_stmt|,
name|moved
decl_stmt|;
name|struct
name|room
name|m
index|[
name|MAZE_SIZE
index|]
decl_stmt|,
modifier|*
name|this_room
decl_stmt|,
modifier|*
name|next_room
decl_stmt|;
name|char
name|c
decl_stmt|;
name|XEvent
name|ev
decl_stmt|;
name|char
modifier|*
name|str
decl_stmt|,
modifier|*
name|prog
decl_stmt|;
name|char
modifier|*
name|maze_file
init|=
name|NULL
decl_stmt|;
name|char
modifier|*
name|display
init|=
name|NULL
decl_stmt|;
name|int
name|nbytes
decl_stmt|;
name|int
name|bwidth
decl_stmt|;
name|char
modifier|*
name|fore_color
decl_stmt|,
modifier|*
name|back_color
decl_stmt|,
modifier|*
name|brdr_color
decl_stmt|;
name|Pixmap
name|bground
decl_stmt|,
name|border
decl_stmt|;
name|int
name|reverse
init|=
literal|0
decl_stmt|;
name|ColorDef
name|cdef
decl_stmt|;
name|WindowInfo
name|info
decl_stmt|;
name|prog
operator|=
operator|*
name|argv
expr_stmt|;
if|if
condition|(
operator|(
name|str
operator|=
name|XGetDefault
argument_list|(
name|prog
argument_list|,
literal|"ReverseVideo"
argument_list|)
operator|)
operator|&&
name|strcmp
argument_list|(
name|str
argument_list|,
literal|"on"
argument_list|)
operator|==
literal|0
condition|)
name|reverse
operator|=
literal|1
expr_stmt|;
name|bwidth
operator|=
literal|2
expr_stmt|;
if|if
condition|(
name|str
operator|=
name|XGetDefault
argument_list|(
name|prog
argument_list|,
literal|"BorderWidth"
argument_list|)
condition|)
name|bwidth
operator|=
name|atoi
argument_list|(
name|str
argument_list|)
expr_stmt|;
name|fore_color
operator|=
name|XGetDefault
argument_list|(
name|prog
argument_list|,
literal|"ForeGround"
argument_list|)
expr_stmt|;
name|back_color
operator|=
name|XGetDefault
argument_list|(
name|prog
argument_list|,
literal|"BackGround"
argument_list|)
expr_stmt|;
name|brdr_color
operator|=
name|XGetDefault
argument_list|(
name|prog
argument_list|,
literal|"Border"
argument_list|)
expr_stmt|;
for|for
control|(
name|argv
operator|++
init|;
operator|--
name|argc
condition|;
name|argv
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"-rv"
argument_list|)
condition|)
block|{
name|reverse
operator|=
literal|1
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"-fg"
argument_list|)
operator|&&
name|argc
condition|)
block|{
name|argv
operator|++
expr_stmt|;
name|argc
operator|--
expr_stmt|;
name|fore_color
operator|=
operator|*
name|argv
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"-bg"
argument_list|)
operator|&&
name|argc
condition|)
block|{
name|argv
operator|++
expr_stmt|;
name|argc
operator|--
expr_stmt|;
name|back_color
operator|=
operator|*
name|argv
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
operator|*
name|argv
argument_list|,
literal|"-bd"
argument_list|)
operator|&&
name|argc
condition|)
block|{
name|argv
operator|++
expr_stmt|;
name|argc
operator|--
expr_stmt|;
name|brdr_color
operator|=
operator|*
name|argv
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|index
argument_list|(
operator|*
name|argv
argument_list|,
literal|':'
argument_list|)
condition|)
block|{
name|display
operator|=
operator|*
name|argv
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|*
operator|*
name|argv
operator|==
literal|'-'
operator|||
name|maze_file
operator|!=
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"usage: maze [-rv] [-fg<color>] [-bg<color>] [-bd<color>] [host:display] [file]\n"
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|maze_file
operator|=
operator|*
name|argv
expr_stmt|;
block|}
block|}
if|if
condition|(
operator|!
name|XOpenDisplay
argument_list|(
name|display
argument_list|)
condition|)
block|{
name|perror
argument_list|(
name|prog
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|reverse
condition|)
block|{
name|forepix
operator|=
name|BlackPixel
expr_stmt|;
name|backpix
operator|=
name|WhitePixel
expr_stmt|;
name|bground
operator|=
name|WhitePixmap
expr_stmt|;
name|border
operator|=
name|BlackPixmap
expr_stmt|;
block|}
else|else
block|{
name|forepix
operator|=
name|WhitePixel
expr_stmt|;
name|backpix
operator|=
name|BlackPixel
expr_stmt|;
name|bground
operator|=
name|BlackPixmap
expr_stmt|;
name|border
operator|=
name|WhitePixmap
expr_stmt|;
block|}
if|if
condition|(
name|DisplayCells
argument_list|()
operator|>
literal|2
condition|)
block|{
if|if
condition|(
name|fore_color
operator|&&
name|XParseColor
argument_list|(
name|fore_color
argument_list|,
operator|&
name|cdef
argument_list|)
operator|&&
name|XGetHardwareColor
argument_list|(
operator|&
name|cdef
argument_list|)
condition|)
name|forepix
operator|=
name|cdef
operator|.
name|pixel
expr_stmt|;
if|if
condition|(
name|back_color
operator|&&
name|XParseColor
argument_list|(
name|back_color
argument_list|,
operator|&
name|cdef
argument_list|)
operator|&&
name|XGetHardwareColor
argument_list|(
operator|&
name|cdef
argument_list|)
condition|)
name|bground
operator|=
name|XMakeTile
argument_list|(
name|backpix
operator|=
name|cdef
operator|.
name|pixel
argument_list|)
expr_stmt|;
if|if
condition|(
name|brdr_color
operator|&&
name|XParseColor
argument_list|(
name|brdr_color
argument_list|,
operator|&
name|cdef
argument_list|)
operator|&&
name|XGetHardwareColor
argument_list|(
operator|&
name|cdef
argument_list|)
condition|)
name|border
operator|=
name|XMakeTile
argument_list|(
name|cdef
operator|.
name|pixel
argument_list|)
expr_stmt|;
block|}
name|get_maze
argument_list|(
name|m
argument_list|,
name|maze_file
argument_list|)
expr_stmt|;
name|this_room
operator|=
operator|&
name|m
index|[
literal|0
index|]
expr_stmt|;
name|next_room
operator|=
name|NULL
expr_stmt|;
name|dir
operator|=
literal|1
expr_stmt|;
name|XQueryWindow
argument_list|(
name|RootWindow
argument_list|,
operator|&
name|info
argument_list|)
expr_stmt|;
name|win
operator|=
name|XCreateWindow
argument_list|(
name|RootWindow
argument_list|,
operator|(
name|info
operator|.
name|width
operator|-
name|PIXSIZE
operator|-
operator|(
name|bwidth
operator|<<
literal|1
operator|)
operator|)
operator|>>
literal|1
argument_list|,
operator|(
name|info
operator|.
name|height
operator|-
name|PIXSIZE
operator|-
operator|(
name|bwidth
operator|<<
literal|1
operator|)
operator|)
operator|>>
literal|1
argument_list|,
name|PIXSIZE
argument_list|,
name|PIXSIZE
argument_list|,
name|bwidth
argument_list|,
name|border
argument_list|,
name|bground
argument_list|)
expr_stmt|;
name|XMapWindow
argument_list|(
name|win
argument_list|)
expr_stmt|;
name|XSelectInput
argument_list|(
name|win
argument_list|,
name|ButtonPressed
operator||
name|KeyPressed
operator||
name|ExposeWindow
argument_list|)
expr_stmt|;
name|set_up_maze
argument_list|()
expr_stmt|;
while|while
condition|(
literal|1
condition|)
block|{
name|XClear
argument_list|(
name|win
argument_list|)
expr_stmt|;
name|next_room
operator|=
name|this_room
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|9
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|right
argument_list|(
name|dir
argument_list|,
name|next_room
argument_list|)
operator|!=
name|NULL
condition|)
name|draw_pass
argument_list|(
name|i
operator|-
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
else|else
name|draw_wall
argument_list|(
name|i
operator|-
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|left
argument_list|(
name|dir
argument_list|,
name|next_room
argument_list|)
operator|!=
name|NULL
condition|)
name|draw_pass
argument_list|(
name|i
operator|-
literal|1
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
else|else
name|draw_wall
argument_list|(
name|i
operator|-
literal|1
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|next_room
operator|=
name|front
argument_list|(
name|dir
argument_list|,
name|next_room
argument_list|)
operator|)
operator|==
name|NULL
condition|)
block|{
name|draw_block
argument_list|(
name|i
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
if|if
condition|(
name|i
operator|==
literal|9
condition|)
name|XPixSet
argument_list|(
name|win
argument_list|,
name|CENTER
operator|-
literal|1
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|PIXSIZE
argument_list|,
name|backpix
argument_list|)
expr_stmt|;
name|moved
operator|=
literal|0
expr_stmt|;
while|while
condition|(
operator|!
name|moved
condition|)
block|{
name|XNextEvent
argument_list|(
operator|&
name|ev
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|ev
operator|.
name|type
condition|)
block|{
case|case
name|ButtonPressed
case|:
switch|switch
condition|(
operator|(
operator|(
name|XButtonPressedEvent
operator|*
operator|)
operator|&
name|ev
operator|)
operator|->
name|detail
operator|&
name|ValueMask
condition|)
block|{
case|case
name|LeftButton
case|:
name|str
operator|=
literal|"l"
expr_stmt|;
break|break;
case|case
name|MiddleButton
case|:
if|if
condition|(
operator|(
operator|(
name|XButtonPressedEvent
operator|*
operator|)
operator|&
name|ev
operator|)
operator|->
name|detail
operator|&
name|ShiftMask
condition|)
name|str
operator|=
literal|"b"
expr_stmt|;
else|else
name|str
operator|=
literal|"f"
expr_stmt|;
break|break;
case|case
name|RightButton
case|:
name|str
operator|=
literal|"r"
expr_stmt|;
break|break;
block|}
name|nbytes
operator|=
literal|1
expr_stmt|;
break|break;
case|case
name|KeyPressed
case|:
name|str
operator|=
name|XLookupMapping
argument_list|(
operator|&
name|ev
argument_list|,
operator|&
name|nbytes
argument_list|)
expr_stmt|;
break|break;
case|case
name|ExposeWindow
case|:
name|XSync
argument_list|(
literal|0
argument_list|)
expr_stmt|;
while|while
condition|(
name|QLength
argument_list|()
condition|)
block|{
name|XPeekEvent
argument_list|(
operator|&
name|ev
argument_list|)
expr_stmt|;
if|if
condition|(
name|ev
operator|.
name|type
operator|!=
name|ExposeWindow
condition|)
break|break;
name|XNextEvent
argument_list|(
operator|&
name|ev
argument_list|)
expr_stmt|;
block|}
name|nbytes
operator|=
literal|0
expr_stmt|;
name|moved
operator|++
expr_stmt|;
block|}
if|if
condition|(
name|nbytes
operator|==
literal|1
condition|)
switch|switch
condition|(
operator|*
name|str
condition|)
block|{
case|case
literal|'r'
case|:
name|dir
operator|=
operator|(
name|dir
operator|+
literal|1
operator|)
operator|%
literal|4
expr_stmt|;
name|moved
operator|++
expr_stmt|;
break|break;
case|case
literal|'l'
case|:
name|dir
operator|=
operator|(
name|dir
operator|+
literal|3
operator|)
operator|%
literal|4
expr_stmt|;
name|moved
operator|++
expr_stmt|;
break|break;
case|case
literal|'f'
case|:
name|next_room
operator|=
name|front
argument_list|(
name|dir
argument_list|,
name|this_room
argument_list|)
expr_stmt|;
if|if
condition|(
name|next_room
operator|!=
name|NULL
condition|)
block|{
name|this_room
operator|=
name|next_room
expr_stmt|;
name|moved
operator|++
expr_stmt|;
block|}
break|break;
case|case
literal|'b'
case|:
name|next_room
operator|=
name|front
argument_list|(
operator|(
name|dir
operator|+
literal|2
operator|)
operator|%
literal|4
argument_list|,
name|this_room
argument_list|)
expr_stmt|;
if|if
condition|(
name|next_room
operator|!=
name|NULL
condition|)
block|{
name|this_room
operator|=
name|next_room
expr_stmt|;
name|moved
operator|++
expr_stmt|;
block|}
break|break;
case|case
literal|'q'
case|:
name|exit
argument_list|(
literal|0
argument_list|)
expr_stmt|;
default|default:
break|break;
block|}
block|}
block|}
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|notdef
end_ifdef

begin_define
define|#
directive|define
name|MAZE_SIDE
value|6
end_define

begin_macro
name|print_maze
argument_list|(
argument|m
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|room
name|m
index|[
name|MAZE_SIZE
index|]
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|int
name|x
decl_stmt|,
name|y
decl_stmt|;
for|for
control|(
name|x
operator|=
literal|0
init|;
name|x
operator|<
name|MAZE_SIDE
condition|;
name|x
operator|++
control|)
block|{
for|for
control|(
name|y
operator|=
literal|0
init|;
name|y
operator|<
name|MAZE_SIDE
condition|;
name|y
operator|++
control|)
block|{
if|if
condition|(
name|m
index|[
literal|6
operator|*
name|x
operator|+
name|y
index|]
operator|.
name|north
operator|==
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"+--+"
argument_list|)
expr_stmt|;
block|}
else|else
name|printf
argument_list|(
literal|"+  +"
argument_list|)
expr_stmt|;
block|}
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
for|for
control|(
name|y
operator|=
literal|0
init|;
name|y
operator|<
name|MAZE_SIDE
condition|;
name|y
operator|++
control|)
block|{
if|if
condition|(
name|m
index|[
literal|6
operator|*
name|x
operator|+
name|y
index|]
operator|.
name|west
operator|==
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"|  "
argument_list|)
expr_stmt|;
block|}
else|else
name|printf
argument_list|(
literal|"   "
argument_list|)
expr_stmt|;
if|if
condition|(
name|m
index|[
literal|6
operator|*
name|x
operator|+
name|y
index|]
operator|.
name|east
operator|==
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"|"
argument_list|)
expr_stmt|;
block|}
else|else
name|printf
argument_list|(
literal|" "
argument_list|)
expr_stmt|;
block|}
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
for|for
control|(
name|y
operator|=
literal|0
init|;
name|y
operator|<
name|MAZE_SIDE
condition|;
name|y
operator|++
control|)
block|{
if|if
condition|(
name|m
index|[
literal|6
operator|*
name|x
operator|+
name|y
index|]
operator|.
name|south
operator|==
name|NULL
condition|)
block|{
name|printf
argument_list|(
literal|"+--+"
argument_list|)
expr_stmt|;
block|}
else|else
name|printf
argument_list|(
literal|"+  +"
argument_list|)
expr_stmt|;
block|}
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
block|}
end_block

begin_endif
endif|#
directive|endif
end_endif

begin_macro
name|draw_wall
argument_list|(
argument|dist
argument_list|,
argument|side
argument_list|)
end_macro

begin_decl_stmt
name|int
name|dist
decl_stmt|,
name|side
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|int
name|x3
decl_stmt|,
name|x4
decl_stmt|;
name|x3
operator|=
name|SIDE
operator|>>
name|dist
expr_stmt|;
name|x4
operator|=
name|SIDE
operator|>>
operator|(
name|dist
operator|+
literal|1
operator|)
expr_stmt|;
if|if
condition|(
name|x3
operator|>
name|CENTER
condition|)
block|{
name|x4
operator|>>=
literal|1
expr_stmt|;
if|if
condition|(
name|side
operator|<
literal|0
condition|)
block|{
name|XPixFill
argument_list|(
name|win
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|x4
argument_list|,
name|PIXSIZE
argument_list|,
name|forepix
argument_list|,
name|pat
index|[
literal|0
index|]
argument_list|,
name|GXcopy
argument_list|,
name|AllPlanes
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|XPixFill
argument_list|(
name|win
argument_list|,
name|PIXSIZE
operator|-
name|x4
operator|+
literal|1
argument_list|,
literal|0
argument_list|,
name|x4
operator|-
literal|1
argument_list|,
name|PIXSIZE
argument_list|,
name|forepix
argument_list|,
name|pat
index|[
literal|19
operator|-
name|dist
operator|-
literal|1
index|]
argument_list|,
name|GXcopy
argument_list|,
name|AllPlanes
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
if|if
condition|(
name|side
operator|<
literal|0
condition|)
block|{
name|XPixFill
argument_list|(
name|win
argument_list|,
name|CENTER
operator|-
name|x3
operator|+
literal|1
argument_list|,
literal|0
argument_list|,
name|x4
operator|-
literal|1
argument_list|,
name|PIXSIZE
argument_list|,
name|forepix
argument_list|,
name|pat
index|[
name|dist
operator|+
literal|1
index|]
argument_list|,
name|GXcopy
argument_list|,
name|AllPlanes
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|XPixFill
argument_list|(
name|win
argument_list|,
name|CENTER
operator|+
name|x4
operator|+
literal|1
argument_list|,
literal|0
argument_list|,
name|x4
operator|-
literal|1
argument_list|,
name|PIXSIZE
argument_list|,
name|forepix
argument_list|,
name|pat
index|[
literal|19
operator|-
name|dist
operator|-
literal|1
index|]
argument_list|,
name|GXcopy
argument_list|,
name|AllPlanes
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_block

begin_macro
name|draw_pass
argument_list|(
argument|dist
argument_list|,
argument|side
argument_list|)
end_macro

begin_decl_stmt
name|int
name|dist
decl_stmt|,
name|side
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|int
name|x3
decl_stmt|,
name|x4
decl_stmt|,
name|i
decl_stmt|;
name|x3
operator|=
name|SIDE
operator|>>
name|dist
expr_stmt|;
name|x4
operator|=
name|SIDE
operator|>>
operator|(
name|dist
operator|+
literal|1
operator|)
expr_stmt|;
if|if
condition|(
name|side
operator|<
literal|0
condition|)
block|{
name|XPixSet
argument_list|(
name|win
argument_list|,
name|CENTER
operator|-
name|x3
argument_list|,
name|CENTER
operator|-
name|x4
argument_list|,
name|x4
argument_list|,
name|x3
argument_list|,
name|forepix
argument_list|)
expr_stmt|;
name|XPixSet
argument_list|(
name|win
argument_list|,
name|CENTER
operator|-
name|x3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|PIXSIZE
argument_list|,
name|backpix
argument_list|)
expr_stmt|;
name|XPixSet
argument_list|(
name|win
argument_list|,
name|CENTER
operator|-
name|x4
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|PIXSIZE
argument_list|,
name|backpix
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|XPixSet
argument_list|(
name|win
argument_list|,
name|CENTER
operator|+
name|x4
argument_list|,
name|CENTER
operator|-
name|x4
argument_list|,
name|x4
argument_list|,
name|x3
argument_list|,
name|forepix
argument_list|)
expr_stmt|;
name|XPixSet
argument_list|(
name|win
argument_list|,
name|CENTER
operator|+
name|x4
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|PIXSIZE
argument_list|,
name|backpix
argument_list|)
expr_stmt|;
name|XPixSet
argument_list|(
name|win
argument_list|,
name|CENTER
operator|+
name|x3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|PIXSIZE
argument_list|,
name|backpix
argument_list|)
expr_stmt|;
block|}
block|}
end_block

begin_macro
name|draw_block
argument_list|(
argument|dist
argument_list|)
end_macro

begin_decl_stmt
name|int
name|dist
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|int
name|x3
decl_stmt|,
name|x4
decl_stmt|,
name|i
decl_stmt|;
name|Vertex
name|verts
index|[
literal|5
index|]
decl_stmt|;
name|x3
operator|=
name|SIDE
operator|>>
name|dist
expr_stmt|;
name|x4
operator|=
name|SIDE
operator|>>
operator|(
name|dist
operator|+
literal|1
operator|)
expr_stmt|;
name|XPixSet
argument_list|(
name|win
argument_list|,
name|CENTER
operator|-
name|x3
operator|+
literal|1
argument_list|,
name|CENTER
operator|-
name|x3
argument_list|,
literal|2
operator|*
name|x3
operator|-
literal|1
argument_list|,
literal|2
operator|*
name|x3
argument_list|,
name|forepix
argument_list|)
expr_stmt|;
block|}
end_block

begin_decl_stmt
name|int
name|default_maze
index|[]
init|=
block|{
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|6
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|2
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|8
block|,
literal|1
block|,
operator|-
literal|1
block|,
literal|4
block|,
literal|9
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|5
block|,
operator|-
literal|1
block|,
literal|3
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|4
block|,
literal|0
block|,
literal|7
block|,
literal|12
block|,
literal|11
block|,
operator|-
literal|1
block|,
literal|8
block|,
operator|-
literal|1
block|,
literal|6
block|,
literal|2
block|,
literal|9
block|,
operator|-
literal|1
block|,
literal|7
block|,
literal|3
block|,
literal|10
block|,
operator|-
literal|1
block|,
literal|8
block|,
operator|-
literal|1
block|,
literal|11
block|,
literal|16
block|,
literal|9
block|,
operator|-
literal|1
block|,
literal|6
block|,
operator|-
literal|1
block|,
literal|10
block|,
literal|6
block|,
operator|-
literal|1
block|,
literal|18
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|14
block|,
literal|19
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|15
block|,
literal|20
block|,
literal|13
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|21
block|,
operator|-
literal|1
block|,
literal|10
block|,
literal|17
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|16
block|,
literal|12
block|,
literal|19
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|13
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|18
block|,
literal|14
block|,
operator|-
literal|1
block|,
literal|26
block|,
operator|-
literal|1
block|,
literal|15
block|,
literal|22
block|,
literal|27
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|23
block|,
literal|28
block|,
literal|21
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|22
block|,
operator|-
literal|1
block|,
literal|25
block|,
literal|30
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|31
block|,
literal|24
block|,
literal|20
block|,
literal|27
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|21
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|26
block|,
literal|22
block|,
literal|29
block|,
literal|34
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|28
block|,
literal|24
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|25
block|,
literal|32
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|33
block|,
operator|-
literal|1
block|,
literal|31
block|,
operator|-
literal|1
block|,
literal|34
block|,
operator|-
literal|1
block|,
literal|32
block|,
literal|28
block|,
literal|35
block|,
operator|-
literal|1
block|,
literal|33
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|34
block|}
decl_stmt|;
end_decl_stmt

begin_macro
name|get_maze
argument_list|(
argument|m
argument_list|,
argument|maze_file
argument_list|)
end_macro

begin_decl_stmt
name|struct
name|room
name|m
index|[
name|MAZE_SIZE
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|maze_file
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|FILE
modifier|*
name|fp
decl_stmt|;
name|int
name|i
decl_stmt|,
name|j
decl_stmt|,
name|n
decl_stmt|,
name|e
decl_stmt|,
name|s
decl_stmt|,
name|w
decl_stmt|;
if|if
condition|(
name|maze_file
operator|==
name|NULL
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|j
operator|=
literal|0
init|;
name|i
operator|<
name|MAZE_SIZE
condition|;
name|i
operator|++
control|)
block|{
name|n
operator|=
name|default_maze
index|[
name|j
operator|++
index|]
expr_stmt|;
name|e
operator|=
name|default_maze
index|[
name|j
operator|++
index|]
expr_stmt|;
name|s
operator|=
name|default_maze
index|[
name|j
operator|++
index|]
expr_stmt|;
name|w
operator|=
name|default_maze
index|[
name|j
operator|++
index|]
expr_stmt|;
if|if
condition|(
name|n
operator|==
operator|-
literal|1
condition|)
name|m
index|[
name|i
index|]
operator|.
name|north
operator|=
name|NULL
expr_stmt|;
else|else
name|m
index|[
name|i
index|]
operator|.
name|north
operator|=
operator|&
name|m
index|[
name|n
index|]
expr_stmt|;
if|if
condition|(
name|s
operator|==
operator|-
literal|1
condition|)
name|m
index|[
name|i
index|]
operator|.
name|south
operator|=
name|NULL
expr_stmt|;
else|else
name|m
index|[
name|i
index|]
operator|.
name|south
operator|=
operator|&
name|m
index|[
name|s
index|]
expr_stmt|;
if|if
condition|(
name|e
operator|==
operator|-
literal|1
condition|)
name|m
index|[
name|i
index|]
operator|.
name|east
operator|=
name|NULL
expr_stmt|;
else|else
name|m
index|[
name|i
index|]
operator|.
name|east
operator|=
operator|&
name|m
index|[
name|e
index|]
expr_stmt|;
if|if
condition|(
name|w
operator|==
operator|-
literal|1
condition|)
name|m
index|[
name|i
index|]
operator|.
name|west
operator|=
name|NULL
expr_stmt|;
else|else
name|m
index|[
name|i
index|]
operator|.
name|west
operator|=
operator|&
name|m
index|[
name|w
index|]
expr_stmt|;
block|}
return|return;
block|}
if|if
condition|(
operator|(
name|fp
operator|=
name|fopen
argument_list|(
name|maze_file
argument_list|,
literal|"r"
argument_list|)
operator|)
operator|==
name|NULL
condition|)
block|{
name|perror
argument_list|(
literal|"maze"
argument_list|)
expr_stmt|;
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|MAZE_SIZE
condition|;
name|i
operator|++
control|)
block|{
name|fscanf
argument_list|(
name|fp
argument_list|,
literal|"%d,%d,%d,%d\n"
argument_list|,
operator|&
name|n
argument_list|,
operator|&
name|e
argument_list|,
operator|&
name|s
argument_list|,
operator|&
name|w
argument_list|)
expr_stmt|;
if|if
condition|(
name|n
operator|==
operator|-
literal|1
condition|)
name|m
index|[
name|i
index|]
operator|.
name|north
operator|=
name|NULL
expr_stmt|;
else|else
name|m
index|[
name|i
index|]
operator|.
name|north
operator|=
operator|&
name|m
index|[
name|n
index|]
expr_stmt|;
if|if
condition|(
name|s
operator|==
operator|-
literal|1
condition|)
name|m
index|[
name|i
index|]
operator|.
name|south
operator|=
name|NULL
expr_stmt|;
else|else
name|m
index|[
name|i
index|]
operator|.
name|south
operator|=
operator|&
name|m
index|[
name|s
index|]
expr_stmt|;
if|if
condition|(
name|e
operator|==
operator|-
literal|1
condition|)
name|m
index|[
name|i
index|]
operator|.
name|east
operator|=
name|NULL
expr_stmt|;
else|else
name|m
index|[
name|i
index|]
operator|.
name|east
operator|=
operator|&
name|m
index|[
name|e
index|]
expr_stmt|;
if|if
condition|(
name|w
operator|==
operator|-
literal|1
condition|)
name|m
index|[
name|i
index|]
operator|.
name|west
operator|=
name|NULL
expr_stmt|;
else|else
name|m
index|[
name|i
index|]
operator|.
name|west
operator|=
operator|&
name|m
index|[
name|w
index|]
expr_stmt|;
block|}
name|fclose
argument_list|(
name|fp
argument_list|)
expr_stmt|;
block|}
end_block

begin_macro
name|set_up_maze
argument_list|()
end_macro

begin_block
block|{
name|Bitmap
name|b
decl_stmt|;
name|int
name|i
decl_stmt|,
name|bound
index|[
literal|21
index|]
decl_stmt|,
name|top
index|[
literal|21
index|]
decl_stmt|,
name|k
decl_stmt|,
name|j
decl_stmt|,
name|x
decl_stmt|;
name|short
modifier|*
name|strips
index|[
literal|21
index|]
decl_stmt|,
modifier|*
name|mask
decl_stmt|;
name|bound
index|[
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|bound
index|[
literal|10
index|]
operator|=
name|CENTER
expr_stmt|;
name|bound
index|[
literal|20
index|]
operator|=
name|PIXSIZE
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<
literal|10
condition|;
name|i
operator|++
control|)
block|{
name|bound
index|[
literal|10
operator|-
name|i
index|]
operator|=
name|CENTER
operator|-
operator|(
name|SIDE
operator|/
operator|(
literal|1
operator|<<
operator|(
literal|9
operator|-
name|i
operator|)
operator|)
operator|)
expr_stmt|;
name|bound
index|[
literal|10
operator|+
name|i
index|]
operator|=
name|CENTER
operator|+
operator|(
name|SIDE
operator|/
operator|(
literal|1
operator|<<
operator|(
literal|9
operator|-
name|i
operator|)
operator|)
operator|)
expr_stmt|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|21
condition|;
name|i
operator|++
control|)
name|top
index|[
name|i
index|]
operator|=
literal|0
expr_stmt|;
name|mask
operator|=
operator|(
name|short
operator|*
operator|)
name|calloc
argument_list|(
name|MASK_SIZE
argument_list|,
sizeof|sizeof
argument_list|(
name|short
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|21
condition|;
name|i
operator|++
control|)
name|strips
index|[
name|i
index|]
operator|=
operator|(
name|short
operator|*
operator|)
name|malloc
argument_list|(
name|STRIP_SIZE
operator|*
sizeof|sizeof
argument_list|(
name|short
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|HALFSIZE
condition|;
name|i
operator|++
control|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|16
condition|;
name|j
operator|++
control|)
block|{
name|mask
index|[
name|SCANSIZE
operator|*
operator|(
literal|16
operator|*
name|i
operator|+
name|j
operator|)
operator|+
name|i
index|]
operator|=
literal|0xaaaa
operator|>>
operator|(
literal|15
operator|-
name|j
operator|)
expr_stmt|;
name|mask
index|[
name|SCANSIZE
operator|*
operator|(
literal|16
operator|*
name|i
operator|+
name|j
operator|)
operator|+
name|SCANSIZE
operator|-
literal|1
operator|-
name|i
index|]
operator|=
literal|0xaaaa
operator|<<
operator|(
literal|15
operator|-
name|j
operator|)
expr_stmt|;
name|mask
index|[
name|SCANSIZE
operator|*
operator|(
name|PIXSIZE
operator|-
literal|1
operator|-
literal|16
operator|*
name|i
operator|-
name|j
operator|)
operator|+
name|i
index|]
operator|=
literal|0x5555
operator|>>
operator|(
literal|15
operator|-
name|j
operator|)
expr_stmt|;
name|mask
index|[
name|SCANSIZE
operator|*
operator|(
name|PIXSIZE
operator|-
literal|1
operator|-
literal|16
operator|*
name|i
operator|-
name|j
operator|)
operator|+
name|SCANSIZE
operator|-
literal|1
operator|-
name|i
index|]
operator|=
literal|0x5555
operator|<<
operator|(
literal|15
operator|-
name|j
operator|)
expr_stmt|;
block|}
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
operator|(
name|HALFSIZE
operator|-
literal|1
operator|)
condition|;
name|i
operator|++
control|)
block|{
for|for
control|(
name|j
operator|=
operator|(
name|i
operator|+
literal|1
operator|)
operator|*
literal|16
init|;
name|j
operator|<
name|CENTER
condition|;
name|j
operator|++
control|)
block|{
if|if
condition|(
operator|(
name|j
operator|%
literal|2
operator|)
operator|==
literal|1
condition|)
block|{
name|mask
index|[
name|SCANSIZE
operator|*
name|j
operator|+
name|i
index|]
operator|=
literal|0xaaaa
expr_stmt|;
name|mask
index|[
name|SCANSIZE
operator|*
name|j
operator|+
name|SCANSIZE
operator|-
literal|1
operator|-
name|i
index|]
operator|=
literal|0xaaaa
expr_stmt|;
name|mask
index|[
name|SCANSIZE
operator|*
operator|(
name|PIXSIZE
operator|-
literal|1
operator|-
name|j
operator|)
operator|+
name|i
index|]
operator|=
literal|0x5555
expr_stmt|;
name|mask
index|[
name|SCANSIZE
operator|*
operator|(
name|PIXSIZE
operator|-
literal|1
operator|-
name|j
operator|)
operator|+
name|SCANSIZE
operator|-
literal|1
operator|-
name|i
index|]
operator|=
literal|0x5555
expr_stmt|;
block|}
else|else
block|{
name|mask
index|[
name|SCANSIZE
operator|*
name|j
operator|+
name|i
index|]
operator|=
literal|0x5555
expr_stmt|;
name|mask
index|[
name|SCANSIZE
operator|*
name|j
operator|+
name|SCANSIZE
operator|-
literal|1
operator|-
name|i
index|]
operator|=
literal|0x5555
expr_stmt|;
name|mask
index|[
name|SCANSIZE
operator|*
operator|(
name|PIXSIZE
operator|-
literal|1
operator|-
name|j
operator|)
operator|+
name|i
index|]
operator|=
literal|0xaaaa
expr_stmt|;
name|mask
index|[
name|SCANSIZE
operator|*
operator|(
name|PIXSIZE
operator|-
literal|1
operator|-
name|j
operator|)
operator|+
name|SCANSIZE
operator|-
literal|1
operator|-
name|i
index|]
operator|=
literal|0xaaaa
expr_stmt|;
block|}
block|}
block|}
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|PIXSIZE
condition|;
name|j
operator|++
control|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|SCANSIZE
condition|;
name|i
operator|++
control|)
block|{
for|for
control|(
name|k
operator|=
literal|1
init|;
name|k
operator|<
literal|21
condition|;
name|k
operator|++
control|)
block|{
if|if
condition|(
operator|(
name|i
operator|*
literal|16
operator|)
operator|<
name|bound
index|[
name|k
index|]
condition|)
block|{
name|strips
index|[
name|k
operator|-
literal|1
index|]
index|[
name|top
index|[
name|k
operator|-
literal|1
index|]
operator|++
index|]
operator|=
name|mask
index|[
name|SCANSIZE
operator|*
name|j
operator|+
name|i
index|]
expr_stmt|;
break|break;
block|}
block|}
block|}
block|}
for|for
control|(
name|i
operator|=
literal|5
init|;
name|i
operator|<
literal|15
condition|;
name|i
operator|++
control|)
name|top
index|[
name|i
index|]
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|PIXSIZE
condition|;
name|i
operator|++
control|)
block|{
name|strips
index|[
literal|5
index|]
index|[
name|top
index|[
literal|5
index|]
operator|++
index|]
operator|=
name|mask
index|[
name|SCANSIZE
operator|*
name|i
operator|+
name|HALFSIZE
operator|-
literal|1
index|]
expr_stmt|;
name|strips
index|[
literal|6
index|]
index|[
name|top
index|[
literal|6
index|]
operator|++
index|]
operator|=
name|mask
index|[
name|SCANSIZE
operator|*
name|i
operator|+
name|HALFSIZE
operator|-
literal|1
index|]
operator|>>
literal|8
expr_stmt|;
name|strips
index|[
literal|7
index|]
index|[
name|top
index|[
literal|7
index|]
operator|++
index|]
operator|=
name|mask
index|[
name|SCANSIZE
operator|*
name|i
operator|+
name|HALFSIZE
operator|-
literal|1
index|]
operator|>>
literal|12
expr_stmt|;
name|strips
index|[
literal|8
index|]
index|[
name|top
index|[
literal|8
index|]
operator|++
index|]
operator|=
name|mask
index|[
name|SCANSIZE
operator|*
name|i
operator|+
name|HALFSIZE
operator|-
literal|1
index|]
operator|>>
literal|14
expr_stmt|;
name|strips
index|[
literal|9
index|]
index|[
name|top
index|[
literal|9
index|]
operator|++
index|]
operator|=
name|mask
index|[
name|SCANSIZE
operator|*
name|i
operator|+
name|HALFSIZE
operator|-
literal|1
index|]
operator|>>
literal|15
expr_stmt|;
name|strips
index|[
literal|10
index|]
index|[
name|top
index|[
literal|10
index|]
operator|++
index|]
operator|=
name|mask
index|[
name|SCANSIZE
operator|*
name|i
operator|+
name|HALFSIZE
index|]
expr_stmt|;
name|strips
index|[
literal|11
index|]
index|[
name|top
index|[
literal|11
index|]
operator|++
index|]
operator|=
name|mask
index|[
name|SCANSIZE
operator|*
name|i
operator|+
name|HALFSIZE
index|]
operator|>>
literal|1
expr_stmt|;
name|strips
index|[
literal|12
index|]
index|[
name|top
index|[
literal|12
index|]
operator|++
index|]
operator|=
name|mask
index|[
name|SCANSIZE
operator|*
name|i
operator|+
name|HALFSIZE
index|]
operator|>>
literal|2
expr_stmt|;
name|strips
index|[
literal|13
index|]
index|[
name|top
index|[
literal|13
index|]
operator|++
index|]
operator|=
name|mask
index|[
name|SCANSIZE
operator|*
name|i
operator|+
name|HALFSIZE
index|]
operator|>>
literal|4
expr_stmt|;
name|strips
index|[
literal|14
index|]
index|[
name|top
index|[
literal|14
index|]
operator|++
index|]
operator|=
name|mask
index|[
name|SCANSIZE
operator|*
name|i
operator|+
name|HALFSIZE
index|]
operator|>>
literal|8
expr_stmt|;
block|}
for|for
control|(
name|k
operator|=
literal|1
init|;
name|k
operator|<
literal|21
condition|;
name|k
operator|++
control|)
block|{
if|if
condition|(
name|bound
index|[
name|k
index|]
operator|!=
name|bound
index|[
name|k
operator|-
literal|1
index|]
condition|)
block|{
name|pat
index|[
name|k
operator|-
literal|1
index|]
operator|=
name|XStoreBitmap
argument_list|(
name|bound
index|[
name|k
index|]
operator|-
name|bound
index|[
name|k
operator|-
literal|1
index|]
argument_list|,
name|PIXSIZE
argument_list|,
name|strips
index|[
name|k
operator|-
literal|1
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|pat
index|[
name|k
operator|-
literal|1
index|]
operator|==
name|NULL
condition|)
name|exit
argument_list|(
literal|1
argument_list|)
expr_stmt|;
block|}
else|else
name|pat
index|[
name|k
operator|-
literal|1
index|]
operator|=
name|NULL
expr_stmt|;
block|}
name|free
argument_list|(
name|mask
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|21
condition|;
name|i
operator|++
control|)
name|free
argument_list|(
name|strips
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
end_block

end_unit

