begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* fcrypt.c */
end_comment

begin_comment
comment|/* Copyright (C) 1993 Eric Young - see README for more details */
end_comment

begin_comment
comment|/*-  *	$Id: fcrypt.c,v 1.2 1994/07/19 19:21:58 g89r4222 Exp $  */
end_comment

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_comment
comment|/* Eric Young.  * This version of crypt has been developed from my MIT compatable  * DES library.  * The library is available at pub/DES at ftp.psy.uq.oz.au  * eay@psych.psy.uq.oz.au  */
end_comment

begin_typedef
typedef|typedef
name|unsigned
name|char
name|des_cblock
index|[
literal|8
index|]
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
name|des_ks_struct
block|{
union|union
block|{
name|des_cblock
name|_
decl_stmt|;
comment|/* make sure things are correct size on machines with 		 * 8 byte longs */
name|unsigned
name|long
name|pad
index|[
literal|2
index|]
decl_stmt|;
block|}
name|ks
union|;
define|#
directive|define
name|_
value|ks._
block|}
name|des_key_schedule
index|[
literal|16
index|]
typedef|;
end_typedef

begin_define
define|#
directive|define
name|DES_KEY_SZ
value|(sizeof(des_cblock))
end_define

begin_define
define|#
directive|define
name|DES_ENCRYPT
value|1
end_define

begin_define
define|#
directive|define
name|DES_DECRYPT
value|0
end_define

begin_define
define|#
directive|define
name|ITERATIONS
value|16
end_define

begin_define
define|#
directive|define
name|HALF_ITERATIONS
value|8
end_define

begin_define
define|#
directive|define
name|c2l
parameter_list|(
name|c
parameter_list|,
name|l
parameter_list|)
value|(l =((unsigned long)(*((c)++)))    , \ 			 l|=((unsigned long)(*((c)++)))<< 8, \ 			 l|=((unsigned long)(*((c)++)))<<16, \ 			 l|=((unsigned long)(*((c)++)))<<24)
end_define

begin_define
define|#
directive|define
name|l2c
parameter_list|(
name|l
parameter_list|,
name|c
parameter_list|)
value|(*((c)++)=(unsigned char)(((l)    )&0xff), \ 			 *((c)++)=(unsigned char)(((l)>> 8)&0xff), \ 			 *((c)++)=(unsigned char)(((l)>>16)&0xff), \ 			 *((c)++)=(unsigned char)(((l)>>24)&0xff))
end_define

begin_decl_stmt
specifier|static
name|unsigned
name|long
name|SPtrans
index|[
literal|8
index|]
index|[
literal|64
index|]
init|=
block|{
comment|/* nibble 0 */
literal|0x00820200
block|,
literal|0x00020000
block|,
literal|0x80800000
block|,
literal|0x80820200
block|,
literal|0x00800000
block|,
literal|0x80020200
block|,
literal|0x80020000
block|,
literal|0x80800000
block|,
literal|0x80020200
block|,
literal|0x00820200
block|,
literal|0x00820000
block|,
literal|0x80000200
block|,
literal|0x80800200
block|,
literal|0x00800000
block|,
literal|0x00000000
block|,
literal|0x80020000
block|,
literal|0x00020000
block|,
literal|0x80000000
block|,
literal|0x00800200
block|,
literal|0x00020200
block|,
literal|0x80820200
block|,
literal|0x00820000
block|,
literal|0x80000200
block|,
literal|0x00800200
block|,
literal|0x80000000
block|,
literal|0x00000200
block|,
literal|0x00020200
block|,
literal|0x80820000
block|,
literal|0x00000200
block|,
literal|0x80800200
block|,
literal|0x80820000
block|,
literal|0x00000000
block|,
literal|0x00000000
block|,
literal|0x80820200
block|,
literal|0x00800200
block|,
literal|0x80020000
block|,
literal|0x00820200
block|,
literal|0x00020000
block|,
literal|0x80000200
block|,
literal|0x00800200
block|,
literal|0x80820000
block|,
literal|0x00000200
block|,
literal|0x00020200
block|,
literal|0x80800000
block|,
literal|0x80020200
block|,
literal|0x80000000
block|,
literal|0x80800000
block|,
literal|0x00820000
block|,
literal|0x80820200
block|,
literal|0x00020200
block|,
literal|0x00820000
block|,
literal|0x80800200
block|,
literal|0x00800000
block|,
literal|0x80000200
block|,
literal|0x80020000
block|,
literal|0x00000000
block|,
literal|0x00020000
block|,
literal|0x00800000
block|,
literal|0x80800200
block|,
literal|0x00820200
block|,
literal|0x80000000
block|,
literal|0x80820000
block|,
literal|0x00000200
block|,
literal|0x80020200
block|,
comment|/* nibble 1 */
literal|0x10042004
block|,
literal|0x00000000
block|,
literal|0x00042000
block|,
literal|0x10040000
block|,
literal|0x10000004
block|,
literal|0x00002004
block|,
literal|0x10002000
block|,
literal|0x00042000
block|,
literal|0x00002000
block|,
literal|0x10040004
block|,
literal|0x00000004
block|,
literal|0x10002000
block|,
literal|0x00040004
block|,
literal|0x10042000
block|,
literal|0x10040000
block|,
literal|0x00000004
block|,
literal|0x00040000
block|,
literal|0x10002004
block|,
literal|0x10040004
block|,
literal|0x00002000
block|,
literal|0x00042004
block|,
literal|0x10000000
block|,
literal|0x00000000
block|,
literal|0x00040004
block|,
literal|0x10002004
block|,
literal|0x00042004
block|,
literal|0x10042000
block|,
literal|0x10000004
block|,
literal|0x10000000
block|,
literal|0x00040000
block|,
literal|0x00002004
block|,
literal|0x10042004
block|,
literal|0x00040004
block|,
literal|0x10042000
block|,
literal|0x10002000
block|,
literal|0x00042004
block|,
literal|0x10042004
block|,
literal|0x00040004
block|,
literal|0x10000004
block|,
literal|0x00000000
block|,
literal|0x10000000
block|,
literal|0x00002004
block|,
literal|0x00040000
block|,
literal|0x10040004
block|,
literal|0x00002000
block|,
literal|0x10000000
block|,
literal|0x00042004
block|,
literal|0x10002004
block|,
literal|0x10042000
block|,
literal|0x00002000
block|,
literal|0x00000000
block|,
literal|0x10000004
block|,
literal|0x00000004
block|,
literal|0x10042004
block|,
literal|0x00042000
block|,
literal|0x10040000
block|,
literal|0x10040004
block|,
literal|0x00040000
block|,
literal|0x00002004
block|,
literal|0x10002000
block|,
literal|0x10002004
block|,
literal|0x00000004
block|,
literal|0x10040000
block|,
literal|0x00042000
block|,
comment|/* nibble 2 */
literal|0x41000000
block|,
literal|0x01010040
block|,
literal|0x00000040
block|,
literal|0x41000040
block|,
literal|0x40010000
block|,
literal|0x01000000
block|,
literal|0x41000040
block|,
literal|0x00010040
block|,
literal|0x01000040
block|,
literal|0x00010000
block|,
literal|0x01010000
block|,
literal|0x40000000
block|,
literal|0x41010040
block|,
literal|0x40000040
block|,
literal|0x40000000
block|,
literal|0x41010000
block|,
literal|0x00000000
block|,
literal|0x40010000
block|,
literal|0x01010040
block|,
literal|0x00000040
block|,
literal|0x40000040
block|,
literal|0x41010040
block|,
literal|0x00010000
block|,
literal|0x41000000
block|,
literal|0x41010000
block|,
literal|0x01000040
block|,
literal|0x40010040
block|,
literal|0x01010000
block|,
literal|0x00010040
block|,
literal|0x00000000
block|,
literal|0x01000000
block|,
literal|0x40010040
block|,
literal|0x01010040
block|,
literal|0x00000040
block|,
literal|0x40000000
block|,
literal|0x00010000
block|,
literal|0x40000040
block|,
literal|0x40010000
block|,
literal|0x01010000
block|,
literal|0x41000040
block|,
literal|0x00000000
block|,
literal|0x01010040
block|,
literal|0x00010040
block|,
literal|0x41010000
block|,
literal|0x40010000
block|,
literal|0x01000000
block|,
literal|0x41010040
block|,
literal|0x40000000
block|,
literal|0x40010040
block|,
literal|0x41000000
block|,
literal|0x01000000
block|,
literal|0x41010040
block|,
literal|0x00010000
block|,
literal|0x01000040
block|,
literal|0x41000040
block|,
literal|0x00010040
block|,
literal|0x01000040
block|,
literal|0x00000000
block|,
literal|0x41010000
block|,
literal|0x40000040
block|,
literal|0x41000000
block|,
literal|0x40010040
block|,
literal|0x00000040
block|,
literal|0x01010000
block|,
comment|/* nibble 3 */
literal|0x00100402
block|,
literal|0x04000400
block|,
literal|0x00000002
block|,
literal|0x04100402
block|,
literal|0x00000000
block|,
literal|0x04100000
block|,
literal|0x04000402
block|,
literal|0x00100002
block|,
literal|0x04100400
block|,
literal|0x04000002
block|,
literal|0x04000000
block|,
literal|0x00000402
block|,
literal|0x04000002
block|,
literal|0x00100402
block|,
literal|0x00100000
block|,
literal|0x04000000
block|,
literal|0x04100002
block|,
literal|0x00100400
block|,
literal|0x00000400
block|,
literal|0x00000002
block|,
literal|0x00100400
block|,
literal|0x04000402
block|,
literal|0x04100000
block|,
literal|0x00000400
block|,
literal|0x00000402
block|,
literal|0x00000000
block|,
literal|0x00100002
block|,
literal|0x04100400
block|,
literal|0x04000400
block|,
literal|0x04100002
block|,
literal|0x04100402
block|,
literal|0x00100000
block|,
literal|0x04100002
block|,
literal|0x00000402
block|,
literal|0x00100000
block|,
literal|0x04000002
block|,
literal|0x00100400
block|,
literal|0x04000400
block|,
literal|0x00000002
block|,
literal|0x04100000
block|,
literal|0x04000402
block|,
literal|0x00000000
block|,
literal|0x00000400
block|,
literal|0x00100002
block|,
literal|0x00000000
block|,
literal|0x04100002
block|,
literal|0x04100400
block|,
literal|0x00000400
block|,
literal|0x04000000
block|,
literal|0x04100402
block|,
literal|0x00100402
block|,
literal|0x00100000
block|,
literal|0x04100402
block|,
literal|0x00000002
block|,
literal|0x04000400
block|,
literal|0x00100402
block|,
literal|0x00100002
block|,
literal|0x00100400
block|,
literal|0x04100000
block|,
literal|0x04000402
block|,
literal|0x00000402
block|,
literal|0x04000000
block|,
literal|0x04000002
block|,
literal|0x04100400
block|,
comment|/* nibble 4 */
literal|0x02000000
block|,
literal|0x00004000
block|,
literal|0x00000100
block|,
literal|0x02004108
block|,
literal|0x02004008
block|,
literal|0x02000100
block|,
literal|0x00004108
block|,
literal|0x02004000
block|,
literal|0x00004000
block|,
literal|0x00000008
block|,
literal|0x02000008
block|,
literal|0x00004100
block|,
literal|0x02000108
block|,
literal|0x02004008
block|,
literal|0x02004100
block|,
literal|0x00000000
block|,
literal|0x00004100
block|,
literal|0x02000000
block|,
literal|0x00004008
block|,
literal|0x00000108
block|,
literal|0x02000100
block|,
literal|0x00004108
block|,
literal|0x00000000
block|,
literal|0x02000008
block|,
literal|0x00000008
block|,
literal|0x02000108
block|,
literal|0x02004108
block|,
literal|0x00004008
block|,
literal|0x02004000
block|,
literal|0x00000100
block|,
literal|0x00000108
block|,
literal|0x02004100
block|,
literal|0x02004100
block|,
literal|0x02000108
block|,
literal|0x00004008
block|,
literal|0x02004000
block|,
literal|0x00004000
block|,
literal|0x00000008
block|,
literal|0x02000008
block|,
literal|0x02000100
block|,
literal|0x02000000
block|,
literal|0x00004100
block|,
literal|0x02004108
block|,
literal|0x00000000
block|,
literal|0x00004108
block|,
literal|0x02000000
block|,
literal|0x00000100
block|,
literal|0x00004008
block|,
literal|0x02000108
block|,
literal|0x00000100
block|,
literal|0x00000000
block|,
literal|0x02004108
block|,
literal|0x02004008
block|,
literal|0x02004100
block|,
literal|0x00000108
block|,
literal|0x00004000
block|,
literal|0x00004100
block|,
literal|0x02004008
block|,
literal|0x02000100
block|,
literal|0x00000108
block|,
literal|0x00000008
block|,
literal|0x00004108
block|,
literal|0x02004000
block|,
literal|0x02000008
block|,
comment|/* nibble 5 */
literal|0x20000010
block|,
literal|0x00080010
block|,
literal|0x00000000
block|,
literal|0x20080800
block|,
literal|0x00080010
block|,
literal|0x00000800
block|,
literal|0x20000810
block|,
literal|0x00080000
block|,
literal|0x00000810
block|,
literal|0x20080810
block|,
literal|0x00080800
block|,
literal|0x20000000
block|,
literal|0x20000800
block|,
literal|0x20000010
block|,
literal|0x20080000
block|,
literal|0x00080810
block|,
literal|0x00080000
block|,
literal|0x20000810
block|,
literal|0x20080010
block|,
literal|0x00000000
block|,
literal|0x00000800
block|,
literal|0x00000010
block|,
literal|0x20080800
block|,
literal|0x20080010
block|,
literal|0x20080810
block|,
literal|0x20080000
block|,
literal|0x20000000
block|,
literal|0x00000810
block|,
literal|0x00000010
block|,
literal|0x00080800
block|,
literal|0x00080810
block|,
literal|0x20000800
block|,
literal|0x00000810
block|,
literal|0x20000000
block|,
literal|0x20000800
block|,
literal|0x00080810
block|,
literal|0x20080800
block|,
literal|0x00080010
block|,
literal|0x00000000
block|,
literal|0x20000800
block|,
literal|0x20000000
block|,
literal|0x00000800
block|,
literal|0x20080010
block|,
literal|0x00080000
block|,
literal|0x00080010
block|,
literal|0x20080810
block|,
literal|0x00080800
block|,
literal|0x00000010
block|,
literal|0x20080810
block|,
literal|0x00080800
block|,
literal|0x00080000
block|,
literal|0x20000810
block|,
literal|0x20000010
block|,
literal|0x20080000
block|,
literal|0x00080810
block|,
literal|0x00000000
block|,
literal|0x00000800
block|,
literal|0x20000010
block|,
literal|0x20000810
block|,
literal|0x20080800
block|,
literal|0x20080000
block|,
literal|0x00000810
block|,
literal|0x00000010
block|,
literal|0x20080010
block|,
comment|/* nibble 6 */
literal|0x00001000
block|,
literal|0x00000080
block|,
literal|0x00400080
block|,
literal|0x00400001
block|,
literal|0x00401081
block|,
literal|0x00001001
block|,
literal|0x00001080
block|,
literal|0x00000000
block|,
literal|0x00400000
block|,
literal|0x00400081
block|,
literal|0x00000081
block|,
literal|0x00401000
block|,
literal|0x00000001
block|,
literal|0x00401080
block|,
literal|0x00401000
block|,
literal|0x00000081
block|,
literal|0x00400081
block|,
literal|0x00001000
block|,
literal|0x00001001
block|,
literal|0x00401081
block|,
literal|0x00000000
block|,
literal|0x00400080
block|,
literal|0x00400001
block|,
literal|0x00001080
block|,
literal|0x00401001
block|,
literal|0x00001081
block|,
literal|0x00401080
block|,
literal|0x00000001
block|,
literal|0x00001081
block|,
literal|0x00401001
block|,
literal|0x00000080
block|,
literal|0x00400000
block|,
literal|0x00001081
block|,
literal|0x00401000
block|,
literal|0x00401001
block|,
literal|0x00000081
block|,
literal|0x00001000
block|,
literal|0x00000080
block|,
literal|0x00400000
block|,
literal|0x00401001
block|,
literal|0x00400081
block|,
literal|0x00001081
block|,
literal|0x00001080
block|,
literal|0x00000000
block|,
literal|0x00000080
block|,
literal|0x00400001
block|,
literal|0x00000001
block|,
literal|0x00400080
block|,
literal|0x00000000
block|,
literal|0x00400081
block|,
literal|0x00400080
block|,
literal|0x00001080
block|,
literal|0x00000081
block|,
literal|0x00001000
block|,
literal|0x00401081
block|,
literal|0x00400000
block|,
literal|0x00401080
block|,
literal|0x00000001
block|,
literal|0x00001001
block|,
literal|0x00401081
block|,
literal|0x00400001
block|,
literal|0x00401080
block|,
literal|0x00401000
block|,
literal|0x00001001
block|,
comment|/* nibble 7 */
literal|0x08200020
block|,
literal|0x08208000
block|,
literal|0x00008020
block|,
literal|0x00000000
block|,
literal|0x08008000
block|,
literal|0x00200020
block|,
literal|0x08200000
block|,
literal|0x08208020
block|,
literal|0x00000020
block|,
literal|0x08000000
block|,
literal|0x00208000
block|,
literal|0x00008020
block|,
literal|0x00208020
block|,
literal|0x08008020
block|,
literal|0x08000020
block|,
literal|0x08200000
block|,
literal|0x00008000
block|,
literal|0x00208020
block|,
literal|0x00200020
block|,
literal|0x08008000
block|,
literal|0x08208020
block|,
literal|0x08000020
block|,
literal|0x00000000
block|,
literal|0x00208000
block|,
literal|0x08000000
block|,
literal|0x00200000
block|,
literal|0x08008020
block|,
literal|0x08200020
block|,
literal|0x00200000
block|,
literal|0x00008000
block|,
literal|0x08208000
block|,
literal|0x00000020
block|,
literal|0x00200000
block|,
literal|0x00008000
block|,
literal|0x08000020
block|,
literal|0x08208020
block|,
literal|0x00008020
block|,
literal|0x08000000
block|,
literal|0x00000000
block|,
literal|0x00208000
block|,
literal|0x08200020
block|,
literal|0x08008020
block|,
literal|0x08008000
block|,
literal|0x00200020
block|,
literal|0x08208000
block|,
literal|0x00000020
block|,
literal|0x00200020
block|,
literal|0x08008000
block|,
literal|0x08208020
block|,
literal|0x00200000
block|,
literal|0x08200000
block|,
literal|0x08000020
block|,
literal|0x00208000
block|,
literal|0x00008020
block|,
literal|0x08008020
block|,
literal|0x08200000
block|,
literal|0x00000020
block|,
literal|0x08208000
block|,
literal|0x00208020
block|,
literal|0x00000000
block|,
literal|0x08000000
block|,
literal|0x08200020
block|,
literal|0x00008000
block|,
literal|0x00208020
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|unsigned
name|long
name|skb
index|[
literal|8
index|]
index|[
literal|64
index|]
init|=
block|{
comment|/* for C bits (numbered as per FIPS 46) 1 2 3 4 5 6 */
literal|0x00000000
block|,
literal|0x00000010
block|,
literal|0x20000000
block|,
literal|0x20000010
block|,
literal|0x00010000
block|,
literal|0x00010010
block|,
literal|0x20010000
block|,
literal|0x20010010
block|,
literal|0x00000800
block|,
literal|0x00000810
block|,
literal|0x20000800
block|,
literal|0x20000810
block|,
literal|0x00010800
block|,
literal|0x00010810
block|,
literal|0x20010800
block|,
literal|0x20010810
block|,
literal|0x00000020
block|,
literal|0x00000030
block|,
literal|0x20000020
block|,
literal|0x20000030
block|,
literal|0x00010020
block|,
literal|0x00010030
block|,
literal|0x20010020
block|,
literal|0x20010030
block|,
literal|0x00000820
block|,
literal|0x00000830
block|,
literal|0x20000820
block|,
literal|0x20000830
block|,
literal|0x00010820
block|,
literal|0x00010830
block|,
literal|0x20010820
block|,
literal|0x20010830
block|,
literal|0x00080000
block|,
literal|0x00080010
block|,
literal|0x20080000
block|,
literal|0x20080010
block|,
literal|0x00090000
block|,
literal|0x00090010
block|,
literal|0x20090000
block|,
literal|0x20090010
block|,
literal|0x00080800
block|,
literal|0x00080810
block|,
literal|0x20080800
block|,
literal|0x20080810
block|,
literal|0x00090800
block|,
literal|0x00090810
block|,
literal|0x20090800
block|,
literal|0x20090810
block|,
literal|0x00080020
block|,
literal|0x00080030
block|,
literal|0x20080020
block|,
literal|0x20080030
block|,
literal|0x00090020
block|,
literal|0x00090030
block|,
literal|0x20090020
block|,
literal|0x20090030
block|,
literal|0x00080820
block|,
literal|0x00080830
block|,
literal|0x20080820
block|,
literal|0x20080830
block|,
literal|0x00090820
block|,
literal|0x00090830
block|,
literal|0x20090820
block|,
literal|0x20090830
block|,
comment|/* for C bits (numbered as per FIPS 46) 7 8 10 11 12 13 */
literal|0x00000000
block|,
literal|0x02000000
block|,
literal|0x00002000
block|,
literal|0x02002000
block|,
literal|0x00200000
block|,
literal|0x02200000
block|,
literal|0x00202000
block|,
literal|0x02202000
block|,
literal|0x00000004
block|,
literal|0x02000004
block|,
literal|0x00002004
block|,
literal|0x02002004
block|,
literal|0x00200004
block|,
literal|0x02200004
block|,
literal|0x00202004
block|,
literal|0x02202004
block|,
literal|0x00000400
block|,
literal|0x02000400
block|,
literal|0x00002400
block|,
literal|0x02002400
block|,
literal|0x00200400
block|,
literal|0x02200400
block|,
literal|0x00202400
block|,
literal|0x02202400
block|,
literal|0x00000404
block|,
literal|0x02000404
block|,
literal|0x00002404
block|,
literal|0x02002404
block|,
literal|0x00200404
block|,
literal|0x02200404
block|,
literal|0x00202404
block|,
literal|0x02202404
block|,
literal|0x10000000
block|,
literal|0x12000000
block|,
literal|0x10002000
block|,
literal|0x12002000
block|,
literal|0x10200000
block|,
literal|0x12200000
block|,
literal|0x10202000
block|,
literal|0x12202000
block|,
literal|0x10000004
block|,
literal|0x12000004
block|,
literal|0x10002004
block|,
literal|0x12002004
block|,
literal|0x10200004
block|,
literal|0x12200004
block|,
literal|0x10202004
block|,
literal|0x12202004
block|,
literal|0x10000400
block|,
literal|0x12000400
block|,
literal|0x10002400
block|,
literal|0x12002400
block|,
literal|0x10200400
block|,
literal|0x12200400
block|,
literal|0x10202400
block|,
literal|0x12202400
block|,
literal|0x10000404
block|,
literal|0x12000404
block|,
literal|0x10002404
block|,
literal|0x12002404
block|,
literal|0x10200404
block|,
literal|0x12200404
block|,
literal|0x10202404
block|,
literal|0x12202404
block|,
comment|/* for C bits (numbered as per FIPS 46) 14 15 16 17 19 20 */
literal|0x00000000
block|,
literal|0x00000001
block|,
literal|0x00040000
block|,
literal|0x00040001
block|,
literal|0x01000000
block|,
literal|0x01000001
block|,
literal|0x01040000
block|,
literal|0x01040001
block|,
literal|0x00000002
block|,
literal|0x00000003
block|,
literal|0x00040002
block|,
literal|0x00040003
block|,
literal|0x01000002
block|,
literal|0x01000003
block|,
literal|0x01040002
block|,
literal|0x01040003
block|,
literal|0x00000200
block|,
literal|0x00000201
block|,
literal|0x00040200
block|,
literal|0x00040201
block|,
literal|0x01000200
block|,
literal|0x01000201
block|,
literal|0x01040200
block|,
literal|0x01040201
block|,
literal|0x00000202
block|,
literal|0x00000203
block|,
literal|0x00040202
block|,
literal|0x00040203
block|,
literal|0x01000202
block|,
literal|0x01000203
block|,
literal|0x01040202
block|,
literal|0x01040203
block|,
literal|0x08000000
block|,
literal|0x08000001
block|,
literal|0x08040000
block|,
literal|0x08040001
block|,
literal|0x09000000
block|,
literal|0x09000001
block|,
literal|0x09040000
block|,
literal|0x09040001
block|,
literal|0x08000002
block|,
literal|0x08000003
block|,
literal|0x08040002
block|,
literal|0x08040003
block|,
literal|0x09000002
block|,
literal|0x09000003
block|,
literal|0x09040002
block|,
literal|0x09040003
block|,
literal|0x08000200
block|,
literal|0x08000201
block|,
literal|0x08040200
block|,
literal|0x08040201
block|,
literal|0x09000200
block|,
literal|0x09000201
block|,
literal|0x09040200
block|,
literal|0x09040201
block|,
literal|0x08000202
block|,
literal|0x08000203
block|,
literal|0x08040202
block|,
literal|0x08040203
block|,
literal|0x09000202
block|,
literal|0x09000203
block|,
literal|0x09040202
block|,
literal|0x09040203
block|,
comment|/* for C bits (numbered as per FIPS 46) 21 23 24 26 27 28 */
literal|0x00000000
block|,
literal|0x00100000
block|,
literal|0x00000100
block|,
literal|0x00100100
block|,
literal|0x00000008
block|,
literal|0x00100008
block|,
literal|0x00000108
block|,
literal|0x00100108
block|,
literal|0x00001000
block|,
literal|0x00101000
block|,
literal|0x00001100
block|,
literal|0x00101100
block|,
literal|0x00001008
block|,
literal|0x00101008
block|,
literal|0x00001108
block|,
literal|0x00101108
block|,
literal|0x04000000
block|,
literal|0x04100000
block|,
literal|0x04000100
block|,
literal|0x04100100
block|,
literal|0x04000008
block|,
literal|0x04100008
block|,
literal|0x04000108
block|,
literal|0x04100108
block|,
literal|0x04001000
block|,
literal|0x04101000
block|,
literal|0x04001100
block|,
literal|0x04101100
block|,
literal|0x04001008
block|,
literal|0x04101008
block|,
literal|0x04001108
block|,
literal|0x04101108
block|,
literal|0x00020000
block|,
literal|0x00120000
block|,
literal|0x00020100
block|,
literal|0x00120100
block|,
literal|0x00020008
block|,
literal|0x00120008
block|,
literal|0x00020108
block|,
literal|0x00120108
block|,
literal|0x00021000
block|,
literal|0x00121000
block|,
literal|0x00021100
block|,
literal|0x00121100
block|,
literal|0x00021008
block|,
literal|0x00121008
block|,
literal|0x00021108
block|,
literal|0x00121108
block|,
literal|0x04020000
block|,
literal|0x04120000
block|,
literal|0x04020100
block|,
literal|0x04120100
block|,
literal|0x04020008
block|,
literal|0x04120008
block|,
literal|0x04020108
block|,
literal|0x04120108
block|,
literal|0x04021000
block|,
literal|0x04121000
block|,
literal|0x04021100
block|,
literal|0x04121100
block|,
literal|0x04021008
block|,
literal|0x04121008
block|,
literal|0x04021108
block|,
literal|0x04121108
block|,
comment|/* for D bits (numbered as per FIPS 46) 1 2 3 4 5 6 */
literal|0x00000000
block|,
literal|0x10000000
block|,
literal|0x00010000
block|,
literal|0x10010000
block|,
literal|0x00000004
block|,
literal|0x10000004
block|,
literal|0x00010004
block|,
literal|0x10010004
block|,
literal|0x20000000
block|,
literal|0x30000000
block|,
literal|0x20010000
block|,
literal|0x30010000
block|,
literal|0x20000004
block|,
literal|0x30000004
block|,
literal|0x20010004
block|,
literal|0x30010004
block|,
literal|0x00100000
block|,
literal|0x10100000
block|,
literal|0x00110000
block|,
literal|0x10110000
block|,
literal|0x00100004
block|,
literal|0x10100004
block|,
literal|0x00110004
block|,
literal|0x10110004
block|,
literal|0x20100000
block|,
literal|0x30100000
block|,
literal|0x20110000
block|,
literal|0x30110000
block|,
literal|0x20100004
block|,
literal|0x30100004
block|,
literal|0x20110004
block|,
literal|0x30110004
block|,
literal|0x00001000
block|,
literal|0x10001000
block|,
literal|0x00011000
block|,
literal|0x10011000
block|,
literal|0x00001004
block|,
literal|0x10001004
block|,
literal|0x00011004
block|,
literal|0x10011004
block|,
literal|0x20001000
block|,
literal|0x30001000
block|,
literal|0x20011000
block|,
literal|0x30011000
block|,
literal|0x20001004
block|,
literal|0x30001004
block|,
literal|0x20011004
block|,
literal|0x30011004
block|,
literal|0x00101000
block|,
literal|0x10101000
block|,
literal|0x00111000
block|,
literal|0x10111000
block|,
literal|0x00101004
block|,
literal|0x10101004
block|,
literal|0x00111004
block|,
literal|0x10111004
block|,
literal|0x20101000
block|,
literal|0x30101000
block|,
literal|0x20111000
block|,
literal|0x30111000
block|,
literal|0x20101004
block|,
literal|0x30101004
block|,
literal|0x20111004
block|,
literal|0x30111004
block|,
comment|/* for D bits (numbered as per FIPS 46) 8 9 11 12 13 14 */
literal|0x00000000
block|,
literal|0x08000000
block|,
literal|0x00000008
block|,
literal|0x08000008
block|,
literal|0x00000400
block|,
literal|0x08000400
block|,
literal|0x00000408
block|,
literal|0x08000408
block|,
literal|0x00020000
block|,
literal|0x08020000
block|,
literal|0x00020008
block|,
literal|0x08020008
block|,
literal|0x00020400
block|,
literal|0x08020400
block|,
literal|0x00020408
block|,
literal|0x08020408
block|,
literal|0x00000001
block|,
literal|0x08000001
block|,
literal|0x00000009
block|,
literal|0x08000009
block|,
literal|0x00000401
block|,
literal|0x08000401
block|,
literal|0x00000409
block|,
literal|0x08000409
block|,
literal|0x00020001
block|,
literal|0x08020001
block|,
literal|0x00020009
block|,
literal|0x08020009
block|,
literal|0x00020401
block|,
literal|0x08020401
block|,
literal|0x00020409
block|,
literal|0x08020409
block|,
literal|0x02000000
block|,
literal|0x0A000000
block|,
literal|0x02000008
block|,
literal|0x0A000008
block|,
literal|0x02000400
block|,
literal|0x0A000400
block|,
literal|0x02000408
block|,
literal|0x0A000408
block|,
literal|0x02020000
block|,
literal|0x0A020000
block|,
literal|0x02020008
block|,
literal|0x0A020008
block|,
literal|0x02020400
block|,
literal|0x0A020400
block|,
literal|0x02020408
block|,
literal|0x0A020408
block|,
literal|0x02000001
block|,
literal|0x0A000001
block|,
literal|0x02000009
block|,
literal|0x0A000009
block|,
literal|0x02000401
block|,
literal|0x0A000401
block|,
literal|0x02000409
block|,
literal|0x0A000409
block|,
literal|0x02020001
block|,
literal|0x0A020001
block|,
literal|0x02020009
block|,
literal|0x0A020009
block|,
literal|0x02020401
block|,
literal|0x0A020401
block|,
literal|0x02020409
block|,
literal|0x0A020409
block|,
comment|/* for D bits (numbered as per FIPS 46) 16 17 18 19 20 21 */
literal|0x00000000
block|,
literal|0x00000100
block|,
literal|0x00080000
block|,
literal|0x00080100
block|,
literal|0x01000000
block|,
literal|0x01000100
block|,
literal|0x01080000
block|,
literal|0x01080100
block|,
literal|0x00000010
block|,
literal|0x00000110
block|,
literal|0x00080010
block|,
literal|0x00080110
block|,
literal|0x01000010
block|,
literal|0x01000110
block|,
literal|0x01080010
block|,
literal|0x01080110
block|,
literal|0x00200000
block|,
literal|0x00200100
block|,
literal|0x00280000
block|,
literal|0x00280100
block|,
literal|0x01200000
block|,
literal|0x01200100
block|,
literal|0x01280000
block|,
literal|0x01280100
block|,
literal|0x00200010
block|,
literal|0x00200110
block|,
literal|0x00280010
block|,
literal|0x00280110
block|,
literal|0x01200010
block|,
literal|0x01200110
block|,
literal|0x01280010
block|,
literal|0x01280110
block|,
literal|0x00000200
block|,
literal|0x00000300
block|,
literal|0x00080200
block|,
literal|0x00080300
block|,
literal|0x01000200
block|,
literal|0x01000300
block|,
literal|0x01080200
block|,
literal|0x01080300
block|,
literal|0x00000210
block|,
literal|0x00000310
block|,
literal|0x00080210
block|,
literal|0x00080310
block|,
literal|0x01000210
block|,
literal|0x01000310
block|,
literal|0x01080210
block|,
literal|0x01080310
block|,
literal|0x00200200
block|,
literal|0x00200300
block|,
literal|0x00280200
block|,
literal|0x00280300
block|,
literal|0x01200200
block|,
literal|0x01200300
block|,
literal|0x01280200
block|,
literal|0x01280300
block|,
literal|0x00200210
block|,
literal|0x00200310
block|,
literal|0x00280210
block|,
literal|0x00280310
block|,
literal|0x01200210
block|,
literal|0x01200310
block|,
literal|0x01280210
block|,
literal|0x01280310
block|,
comment|/* for D bits (numbered as per FIPS 46) 22 23 24 25 27 28 */
literal|0x00000000
block|,
literal|0x04000000
block|,
literal|0x00040000
block|,
literal|0x04040000
block|,
literal|0x00000002
block|,
literal|0x04000002
block|,
literal|0x00040002
block|,
literal|0x04040002
block|,
literal|0x00002000
block|,
literal|0x04002000
block|,
literal|0x00042000
block|,
literal|0x04042000
block|,
literal|0x00002002
block|,
literal|0x04002002
block|,
literal|0x00042002
block|,
literal|0x04042002
block|,
literal|0x00000020
block|,
literal|0x04000020
block|,
literal|0x00040020
block|,
literal|0x04040020
block|,
literal|0x00000022
block|,
literal|0x04000022
block|,
literal|0x00040022
block|,
literal|0x04040022
block|,
literal|0x00002020
block|,
literal|0x04002020
block|,
literal|0x00042020
block|,
literal|0x04042020
block|,
literal|0x00002022
block|,
literal|0x04002022
block|,
literal|0x00042022
block|,
literal|0x04042022
block|,
literal|0x00000800
block|,
literal|0x04000800
block|,
literal|0x00040800
block|,
literal|0x04040800
block|,
literal|0x00000802
block|,
literal|0x04000802
block|,
literal|0x00040802
block|,
literal|0x04040802
block|,
literal|0x00002800
block|,
literal|0x04002800
block|,
literal|0x00042800
block|,
literal|0x04042800
block|,
literal|0x00002802
block|,
literal|0x04002802
block|,
literal|0x00042802
block|,
literal|0x04042802
block|,
literal|0x00000820
block|,
literal|0x04000820
block|,
literal|0x00040820
block|,
literal|0x04040820
block|,
literal|0x00000822
block|,
literal|0x04000822
block|,
literal|0x00040822
block|,
literal|0x04040822
block|,
literal|0x00002820
block|,
literal|0x04002820
block|,
literal|0x00042820
block|,
literal|0x04042820
block|,
literal|0x00002822
block|,
literal|0x04002822
block|,
literal|0x00042822
block|,
literal|0x04042822
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* See ecb_encrypt.c for a pseudo description of these macros. */
end_comment

begin_define
define|#
directive|define
name|PERM_OP
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|,
name|t
parameter_list|,
name|n
parameter_list|,
name|m
parameter_list|)
value|((t)=((((a)>>(n))^(b))&(m)),\ 	(b)^=(t),\ 	(a)^=((t)<<(n)))
end_define

begin_define
define|#
directive|define
name|HPERM_OP
parameter_list|(
name|a
parameter_list|,
name|t
parameter_list|,
name|n
parameter_list|,
name|m
parameter_list|)
value|((t)=((((a)<<(16-(n)))^(a))&(m)),\ 	(a)=(a)^(t)^(t>>(16-(n))))\  static char shifts2[16]={0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0};
end_define

begin_function_decl
specifier|static
name|int
name|body
parameter_list|()
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|int
name|des_set___key
parameter_list|()
function_decl|;
end_function_decl

begin_function
specifier|static
name|int
name|des_set___key
parameter_list|(
name|key
parameter_list|,
name|schedule
parameter_list|)
name|des_cblock
modifier|*
name|key
decl_stmt|;
name|des_key_schedule
name|schedule
decl_stmt|;
block|{
specifier|register
name|unsigned
name|long
name|c
decl_stmt|,
name|d
decl_stmt|,
name|t
decl_stmt|,
name|s
decl_stmt|;
specifier|register
name|unsigned
name|char
modifier|*
name|in
decl_stmt|;
specifier|register
name|unsigned
name|long
modifier|*
name|k
decl_stmt|;
specifier|register
name|int
name|i
decl_stmt|;
name|k
operator|=
operator|(
name|unsigned
name|long
operator|*
operator|)
name|schedule
expr_stmt|;
name|in
operator|=
operator|(
name|unsigned
name|char
operator|*
operator|)
name|key
expr_stmt|;
name|c2l
argument_list|(
name|in
argument_list|,
name|c
argument_list|)
expr_stmt|;
name|c2l
argument_list|(
name|in
argument_list|,
name|d
argument_list|)
expr_stmt|;
comment|/* I now do it in 47 simple operations :-) 	 * Thanks to John Fletcher (john_fletcher@lccmail.ocf.llnl.gov) 	 * for the inspiration. :-) */
name|PERM_OP
argument_list|(
name|d
argument_list|,
name|c
argument_list|,
name|t
argument_list|,
literal|4
argument_list|,
literal|0x0f0f0f0f
argument_list|)
expr_stmt|;
name|HPERM_OP
argument_list|(
name|c
argument_list|,
name|t
argument_list|,
operator|-
literal|2
argument_list|,
literal|0xcccc0000
argument_list|)
expr_stmt|;
name|HPERM_OP
argument_list|(
name|d
argument_list|,
name|t
argument_list|,
operator|-
literal|2
argument_list|,
literal|0xcccc0000
argument_list|)
expr_stmt|;
name|PERM_OP
argument_list|(
name|d
argument_list|,
name|c
argument_list|,
name|t
argument_list|,
literal|1
argument_list|,
literal|0x55555555
argument_list|)
expr_stmt|;
name|PERM_OP
argument_list|(
name|c
argument_list|,
name|d
argument_list|,
name|t
argument_list|,
literal|8
argument_list|,
literal|0x00ff00ff
argument_list|)
expr_stmt|;
name|PERM_OP
argument_list|(
name|d
argument_list|,
name|c
argument_list|,
name|t
argument_list|,
literal|1
argument_list|,
literal|0x55555555
argument_list|)
expr_stmt|;
name|d
operator|=
operator|(
operator|(
operator|(
name|d
operator|&
literal|0x000000ff
operator|)
operator|<<
literal|16
operator|)
operator||
operator|(
name|d
operator|&
literal|0x0000ff00
operator|)
operator||
operator|(
operator|(
name|d
operator|&
literal|0x00ff0000
operator|)
operator|>>
literal|16
operator|)
operator||
operator|(
operator|(
name|c
operator|&
literal|0xf0000000
operator|)
operator|>>
literal|4
operator|)
operator|)
expr_stmt|;
name|c
operator|&=
literal|0x0fffffff
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ITERATIONS
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|shifts2
index|[
name|i
index|]
condition|)
block|{
name|c
operator|=
operator|(
operator|(
name|c
operator|>>
literal|2
operator|)
operator||
operator|(
name|c
operator|<<
literal|26
operator|)
operator|)
expr_stmt|;
name|d
operator|=
operator|(
operator|(
name|d
operator|>>
literal|2
operator|)
operator||
operator|(
name|d
operator|<<
literal|26
operator|)
operator|)
expr_stmt|;
block|}
else|else
block|{
name|c
operator|=
operator|(
operator|(
name|c
operator|>>
literal|1
operator|)
operator||
operator|(
name|c
operator|<<
literal|27
operator|)
operator|)
expr_stmt|;
name|d
operator|=
operator|(
operator|(
name|d
operator|>>
literal|1
operator|)
operator||
operator|(
name|d
operator|<<
literal|27
operator|)
operator|)
expr_stmt|;
block|}
name|c
operator|&=
literal|0x0fffffff
expr_stmt|;
name|d
operator|&=
literal|0x0fffffff
expr_stmt|;
comment|/* could be a few less shifts but I am to lazy at this 		 * point in time to investigate */
name|s
operator|=
name|skb
index|[
literal|0
index|]
index|[
operator|(
name|c
operator|)
operator|&
literal|0x3f
index|]
operator||
name|skb
index|[
literal|1
index|]
index|[
operator|(
operator|(
name|c
operator|>>
literal|6
operator|)
operator|&
literal|0x03
operator|)
operator||
operator|(
operator|(
name|c
operator|>>
literal|7
operator|)
operator|&
literal|0x3c
operator|)
index|]
operator||
name|skb
index|[
literal|2
index|]
index|[
operator|(
operator|(
name|c
operator|>>
literal|13
operator|)
operator|&
literal|0x0f
operator|)
operator||
operator|(
operator|(
name|c
operator|>>
literal|14
operator|)
operator|&
literal|0x30
operator|)
index|]
operator||
name|skb
index|[
literal|3
index|]
index|[
operator|(
operator|(
name|c
operator|>>
literal|20
operator|)
operator|&
literal|0x01
operator|)
operator||
operator|(
operator|(
name|c
operator|>>
literal|21
operator|)
operator|&
literal|0x06
operator|)
operator||
operator|(
operator|(
name|c
operator|>>
literal|22
operator|)
operator|&
literal|0x38
operator|)
index|]
expr_stmt|;
name|t
operator|=
name|skb
index|[
literal|4
index|]
index|[
operator|(
name|d
operator|)
operator|&
literal|0x3f
index|]
operator||
name|skb
index|[
literal|5
index|]
index|[
operator|(
operator|(
name|d
operator|>>
literal|7
operator|)
operator|&
literal|0x03
operator|)
operator||
operator|(
operator|(
name|d
operator|>>
literal|8
operator|)
operator|&
literal|0x3c
operator|)
index|]
operator||
name|skb
index|[
literal|6
index|]
index|[
operator|(
name|d
operator|>>
literal|15
operator|)
operator|&
literal|0x3f
index|]
operator||
name|skb
index|[
literal|7
index|]
index|[
operator|(
operator|(
name|d
operator|>>
literal|21
operator|)
operator|&
literal|0x0f
operator|)
operator||
operator|(
operator|(
name|d
operator|>>
literal|22
operator|)
operator|&
literal|0x30
operator|)
index|]
expr_stmt|;
comment|/* table contained 0213 4657 */
operator|*
operator|(
name|k
operator|++
operator|)
operator|=
operator|(
operator|(
name|t
operator|<<
literal|16
operator|)
operator||
operator|(
name|s
operator|&
literal|0x0000ffff
operator|)
operator|)
operator|&
literal|0xffffffff
expr_stmt|;
name|s
operator|=
operator|(
operator|(
name|s
operator|>>
literal|16
operator|)
operator||
operator|(
name|t
operator|&
literal|0xffff0000
operator|)
operator|)
expr_stmt|;
name|s
operator|=
operator|(
name|s
operator|<<
literal|4
operator|)
operator||
operator|(
name|s
operator|>>
literal|28
operator|)
expr_stmt|;
operator|*
operator|(
name|k
operator|++
operator|)
operator|=
name|s
operator|&
literal|0xffffffff
expr_stmt|;
block|}
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_comment
comment|/******************************************************************  * modified stuff for crypt.  ******************************************************************/
end_comment

begin_comment
comment|/* The changes to this macro may help or hinder, depending on the  * compiler and the achitecture.  gcc2 always seems to do well :-).   * Inspired by Dana How<how@isl.stanford.edu>  * DO NOT use the alternative version on machines with 8 byte longs.  */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|ALT_ECB
end_ifdef

begin_define
define|#
directive|define
name|D_ENCRYPT
parameter_list|(
name|L
parameter_list|,
name|R
parameter_list|,
name|S
parameter_list|)
define|\
value|v=(R^(R>>16)); \ 	u=(v&E0); \ 	v=(v&E1); \ 	u=((u^(u<<16))^R^s[S  ])<<2; \ 	t=(v^(v<<16))^R^s[S+1]; \ 	t=(t>>2)|(t<<30); \ 	L^= \ 	*(unsigned long *)(des_SP+0x0100+((t    )&0xfc))+ \ 	*(unsigned long *)(des_SP+0x0300+((t>> 8)&0xfc))+ \ 	*(unsigned long *)(des_SP+0x0500+((t>>16)&0xfc))+ \ 	*(unsigned long *)(des_SP+0x0700+((t>>24)&0xfc))+ \ 	*(unsigned long *)(des_SP+       ((u    )&0xfc))+ \   	*(unsigned long *)(des_SP+0x0200+((u>> 8)&0xfc))+ \   	*(unsigned long *)(des_SP+0x0400+((u>>16)&0xfc))+ \  	*(unsigned long *)(des_SP+0x0600+((u>>24)&0xfc));
end_define

begin_else
else|#
directive|else
end_else

begin_comment
comment|/* original version */
end_comment

begin_define
define|#
directive|define
name|D_ENCRYPT
parameter_list|(
name|L
parameter_list|,
name|R
parameter_list|,
name|S
parameter_list|)
define|\
value|v=(R^(R>>16)); \ 	u=(v&E0); \ 	v=(v&E1); \ 	u=(u^(u<<16))^R^s[S  ]; \ 	t=(v^(v<<16))^R^s[S+1]; \ 	t=(t>>4)|(t<<28); \ 	L^=	SPtrans[1][(t    )&0x3f]| \ 		SPtrans[3][(t>> 8)&0x3f]| \ 		SPtrans[5][(t>>16)&0x3f]| \ 		SPtrans[7][(t>>24)&0x3f]| \ 		SPtrans[0][(u    )&0x3f]| \ 		SPtrans[2][(u>> 8)&0x3f]| \ 		SPtrans[4][(u>>16)&0x3f]| \ 		SPtrans[6][(u>>24)&0x3f];
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
name|unsigned
name|char
name|con_salt
index|[
literal|128
index|]
init|=
block|{
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x01
block|,
literal|0x02
block|,
literal|0x03
block|,
literal|0x04
block|,
literal|0x05
block|,
literal|0x06
block|,
literal|0x07
block|,
literal|0x08
block|,
literal|0x09
block|,
literal|0x0A
block|,
literal|0x0B
block|,
literal|0x05
block|,
literal|0x06
block|,
literal|0x07
block|,
literal|0x08
block|,
literal|0x09
block|,
literal|0x0A
block|,
literal|0x0B
block|,
literal|0x0C
block|,
literal|0x0D
block|,
literal|0x0E
block|,
literal|0x0F
block|,
literal|0x10
block|,
literal|0x11
block|,
literal|0x12
block|,
literal|0x13
block|,
literal|0x14
block|,
literal|0x15
block|,
literal|0x16
block|,
literal|0x17
block|,
literal|0x18
block|,
literal|0x19
block|,
literal|0x1A
block|,
literal|0x1B
block|,
literal|0x1C
block|,
literal|0x1D
block|,
literal|0x1E
block|,
literal|0x1F
block|,
literal|0x20
block|,
literal|0x21
block|,
literal|0x22
block|,
literal|0x23
block|,
literal|0x24
block|,
literal|0x25
block|,
literal|0x20
block|,
literal|0x21
block|,
literal|0x22
block|,
literal|0x23
block|,
literal|0x24
block|,
literal|0x25
block|,
literal|0x26
block|,
literal|0x27
block|,
literal|0x28
block|,
literal|0x29
block|,
literal|0x2A
block|,
literal|0x2B
block|,
literal|0x2C
block|,
literal|0x2D
block|,
literal|0x2E
block|,
literal|0x2F
block|,
literal|0x30
block|,
literal|0x31
block|,
literal|0x32
block|,
literal|0x33
block|,
literal|0x34
block|,
literal|0x35
block|,
literal|0x36
block|,
literal|0x37
block|,
literal|0x38
block|,
literal|0x39
block|,
literal|0x3A
block|,
literal|0x3B
block|,
literal|0x3C
block|,
literal|0x3D
block|,
literal|0x3E
block|,
literal|0x3F
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|,
literal|0x00
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|unsigned
name|char
name|cov_2char
index|[
literal|64
index|]
init|=
block|{
literal|0x2E
block|,
literal|0x2F
block|,
literal|0x30
block|,
literal|0x31
block|,
literal|0x32
block|,
literal|0x33
block|,
literal|0x34
block|,
literal|0x35
block|,
literal|0x36
block|,
literal|0x37
block|,
literal|0x38
block|,
literal|0x39
block|,
literal|0x41
block|,
literal|0x42
block|,
literal|0x43
block|,
literal|0x44
block|,
literal|0x45
block|,
literal|0x46
block|,
literal|0x47
block|,
literal|0x48
block|,
literal|0x49
block|,
literal|0x4A
block|,
literal|0x4B
block|,
literal|0x4C
block|,
literal|0x4D
block|,
literal|0x4E
block|,
literal|0x4F
block|,
literal|0x50
block|,
literal|0x51
block|,
literal|0x52
block|,
literal|0x53
block|,
literal|0x54
block|,
literal|0x55
block|,
literal|0x56
block|,
literal|0x57
block|,
literal|0x58
block|,
literal|0x59
block|,
literal|0x5A
block|,
literal|0x61
block|,
literal|0x62
block|,
literal|0x63
block|,
literal|0x64
block|,
literal|0x65
block|,
literal|0x66
block|,
literal|0x67
block|,
literal|0x68
block|,
literal|0x69
block|,
literal|0x6A
block|,
literal|0x6B
block|,
literal|0x6C
block|,
literal|0x6D
block|,
literal|0x6E
block|,
literal|0x6F
block|,
literal|0x70
block|,
literal|0x71
block|,
literal|0x72
block|,
literal|0x73
block|,
literal|0x74
block|,
literal|0x75
block|,
literal|0x76
block|,
literal|0x77
block|,
literal|0x78
block|,
literal|0x79
block|,
literal|0x7A
block|}
decl_stmt|;
end_decl_stmt

begin_function
name|char
modifier|*
name|crypt
parameter_list|(
name|buf
parameter_list|,
name|salt
parameter_list|)
name|char
modifier|*
name|buf
decl_stmt|;
name|char
modifier|*
name|salt
decl_stmt|;
block|{
name|unsigned
name|int
name|i
decl_stmt|,
name|j
decl_stmt|,
name|x
decl_stmt|,
name|y
decl_stmt|;
name|unsigned
name|long
name|Eswap0
init|=
literal|0
decl_stmt|,
name|Eswap1
init|=
literal|0
decl_stmt|;
name|unsigned
name|long
name|out
index|[
literal|2
index|]
decl_stmt|,
name|ll
decl_stmt|;
name|des_cblock
name|key
decl_stmt|;
name|des_key_schedule
name|ks
decl_stmt|;
specifier|static
name|unsigned
name|char
name|buff
index|[
literal|20
index|]
decl_stmt|;
name|unsigned
name|char
name|bb
index|[
literal|9
index|]
decl_stmt|;
name|unsigned
name|char
modifier|*
name|b
init|=
name|bb
decl_stmt|;
name|unsigned
name|char
name|c
decl_stmt|,
name|u
decl_stmt|;
comment|/* eay 25/08/92 	 * If you call crypt("pwd","*") as often happens when you 	 * have * as the pwd field in /etc/passwd, the function 	 * returns *\0XXXXXXXXX 	 * The \0 makes the string look like * so the pwd "*" would 	 * crypt to "*".  This was found when replacing the crypt in 	 * our shared libraries.  People found that the disbled 	 * accounts effectivly had no passwd :-(. */
if|if
condition|(
name|salt
index|[
literal|0
index|]
operator|==
literal|'\0'
condition|)
name|salt
index|[
literal|0
index|]
operator|=
literal|'A'
expr_stmt|;
if|if
condition|(
name|salt
index|[
literal|1
index|]
operator|==
literal|'\0'
condition|)
name|salt
index|[
literal|1
index|]
operator|=
literal|'A'
expr_stmt|;
name|x
operator|=
name|buff
index|[
literal|0
index|]
operator|=
name|salt
index|[
literal|0
index|]
expr_stmt|;
name|Eswap0
operator|=
name|con_salt
index|[
name|x
index|]
expr_stmt|;
name|x
operator|=
name|buff
index|[
literal|1
index|]
operator|=
name|salt
index|[
literal|1
index|]
expr_stmt|;
name|Eswap1
operator|=
name|con_salt
index|[
name|x
index|]
operator|<<
literal|4
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|8
condition|;
name|i
operator|++
control|)
block|{
name|c
operator|=
operator|*
operator|(
name|buf
operator|++
operator|)
expr_stmt|;
if|if
condition|(
operator|!
name|c
condition|)
break|break;
name|key
index|[
name|i
index|]
operator|=
operator|(
name|c
operator|<<
literal|1
operator|)
expr_stmt|;
block|}
for|for
control|(
init|;
name|i
operator|<
literal|8
condition|;
name|i
operator|++
control|)
name|key
index|[
name|i
index|]
operator|=
literal|0
expr_stmt|;
name|des_set___key
argument_list|(
operator|(
name|des_cblock
operator|*
operator|)
operator|(
name|key
operator|)
argument_list|,
name|ks
argument_list|)
expr_stmt|;
name|body
argument_list|(
operator|&
name|out
index|[
literal|0
index|]
argument_list|,
operator|&
name|out
index|[
literal|1
index|]
argument_list|,
name|ks
argument_list|,
name|Eswap0
argument_list|,
name|Eswap1
argument_list|)
expr_stmt|;
name|ll
operator|=
name|out
index|[
literal|0
index|]
expr_stmt|;
name|l2c
argument_list|(
name|ll
argument_list|,
name|b
argument_list|)
expr_stmt|;
name|ll
operator|=
name|out
index|[
literal|1
index|]
expr_stmt|;
name|l2c
argument_list|(
name|ll
argument_list|,
name|b
argument_list|)
expr_stmt|;
name|y
operator|=
literal|0
expr_stmt|;
name|u
operator|=
literal|0x80
expr_stmt|;
name|bb
index|[
literal|8
index|]
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|2
init|;
name|i
operator|<
literal|13
condition|;
name|i
operator|++
control|)
block|{
name|c
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|6
condition|;
name|j
operator|++
control|)
block|{
name|c
operator|<<=
literal|1
expr_stmt|;
if|if
condition|(
name|bb
index|[
name|y
index|]
operator|&
name|u
condition|)
name|c
operator||=
literal|1
expr_stmt|;
name|u
operator|>>=
literal|1
expr_stmt|;
if|if
condition|(
operator|!
name|u
condition|)
block|{
name|y
operator|++
expr_stmt|;
name|u
operator|=
literal|0x80
expr_stmt|;
block|}
block|}
name|buff
index|[
name|i
index|]
operator|=
name|cov_2char
index|[
name|c
index|]
expr_stmt|;
block|}
return|return
operator|(
operator|(
name|char
operator|*
operator|)
name|buff
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|body
parameter_list|(
name|out0
parameter_list|,
name|out1
parameter_list|,
name|ks
parameter_list|,
name|Eswap0
parameter_list|,
name|Eswap1
parameter_list|)
name|unsigned
name|long
modifier|*
name|out0
decl_stmt|,
decl|*
name|out1
decl_stmt|;
end_function

begin_decl_stmt
name|des_key_schedule
modifier|*
name|ks
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|unsigned
name|long
name|Eswap0
decl_stmt|,
name|Eswap1
decl_stmt|;
end_decl_stmt

begin_block
block|{
specifier|register
name|unsigned
name|long
name|l
decl_stmt|,
name|r
decl_stmt|,
name|t
decl_stmt|,
name|u
decl_stmt|,
name|v
decl_stmt|;
ifdef|#
directive|ifdef
name|ALT_ECB
specifier|register
name|unsigned
name|char
modifier|*
name|des_SP
init|=
operator|(
name|unsigned
name|char
operator|*
operator|)
name|SPtrans
decl_stmt|;
endif|#
directive|endif
specifier|register
name|unsigned
name|long
modifier|*
name|s
decl_stmt|;
specifier|register
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
specifier|register
name|unsigned
name|long
name|E0
decl_stmt|,
name|E1
decl_stmt|;
name|l
operator|=
literal|0
expr_stmt|;
name|r
operator|=
literal|0
expr_stmt|;
name|s
operator|=
operator|(
name|unsigned
name|long
operator|*
operator|)
name|ks
expr_stmt|;
name|E0
operator|=
name|Eswap0
expr_stmt|;
name|E1
operator|=
name|Eswap1
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|25
condition|;
name|j
operator|++
control|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
operator|(
name|ITERATIONS
operator|*
literal|2
operator|)
condition|;
name|i
operator|+=
literal|4
control|)
block|{
name|D_ENCRYPT
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
name|i
argument_list|)
expr_stmt|;
comment|/*  1 */
name|D_ENCRYPT
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
name|i
operator|+
literal|2
argument_list|)
expr_stmt|;
comment|/*  2 */
block|}
name|t
operator|=
name|l
expr_stmt|;
name|l
operator|=
name|r
expr_stmt|;
name|r
operator|=
name|t
expr_stmt|;
block|}
name|t
operator|=
name|r
expr_stmt|;
name|r
operator|=
operator|(
name|l
operator|>>
literal|1
operator|)
operator||
operator|(
name|l
operator|<<
literal|31
operator|)
expr_stmt|;
name|l
operator|=
operator|(
name|t
operator|>>
literal|1
operator|)
operator||
operator|(
name|t
operator|<<
literal|31
operator|)
expr_stmt|;
comment|/* clear the top bits on machines with 8byte longs */
name|l
operator|&=
literal|0xffffffff
expr_stmt|;
name|r
operator|&=
literal|0xffffffff
expr_stmt|;
name|PERM_OP
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
name|t
argument_list|,
literal|1
argument_list|,
literal|0x55555555
argument_list|)
expr_stmt|;
name|PERM_OP
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
name|t
argument_list|,
literal|8
argument_list|,
literal|0x00ff00ff
argument_list|)
expr_stmt|;
name|PERM_OP
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
name|t
argument_list|,
literal|2
argument_list|,
literal|0x33333333
argument_list|)
expr_stmt|;
name|PERM_OP
argument_list|(
name|l
argument_list|,
name|r
argument_list|,
name|t
argument_list|,
literal|16
argument_list|,
literal|0x0000ffff
argument_list|)
expr_stmt|;
name|PERM_OP
argument_list|(
name|r
argument_list|,
name|l
argument_list|,
name|t
argument_list|,
literal|4
argument_list|,
literal|0x0f0f0f0f
argument_list|)
expr_stmt|;
operator|*
name|out0
operator|=
name|l
expr_stmt|;
operator|*
name|out1
operator|=
name|r
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_block

end_unit

