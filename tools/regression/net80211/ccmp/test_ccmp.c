begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (c) 2004 Sam Leffler, Errno Consulting  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  * 3. The name of the author may not be used to endorse or promote products  *    derived from this software without specific prior written permission.  *  * Alternatively, this software may be distributed under the terms of the  * GNU General Public License ("GPL") version 2 as published by the Free  * Software Foundation.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR  * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES  * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,  * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT  * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,  * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY  * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF  * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.  *  * $FreeBSD$  */
end_comment

begin_comment
comment|/*  * CCMP test module.  *  * Test vectors come from section I.7.4 of P802.11i/D7.0, October 2003.  *  * To use this tester load the net80211 layer (either as a module or  * by statically configuring it into your kernel), then kldload this  * module.  It should automatically run all test cases and print  * information for each.  To run one or more tests you can specify a  * tests parameter to the module that is a bit mask of the set of tests  * you want; e.g. insmod ccmp_test tests=7 will run only test mpdu's  * 1, 2, and 3.  */
end_comment

begin_include
include|#
directive|include
file|<sys/param.h>
end_include

begin_include
include|#
directive|include
file|<sys/kernel.h>
end_include

begin_include
include|#
directive|include
file|<sys/systm.h>
end_include

begin_include
include|#
directive|include
file|<sys/mbuf.h>
end_include

begin_include
include|#
directive|include
file|<sys/module.h>
end_include

begin_include
include|#
directive|include
file|<sys/socket.h>
end_include

begin_include
include|#
directive|include
file|<net/if.h>
end_include

begin_include
include|#
directive|include
file|<net/if_media.h>
end_include

begin_include
include|#
directive|include
file|<net80211/ieee80211_var.h>
end_include

begin_comment
comment|/* ==== CCMP test mpdu   1 ====  -- MPDU Fields  7  Version  = 0 8  Type     = 2   SubType  = 0  Data 9  ToDS     = 0   FromDS   = 0 10  MoreFrag = 0   Retry    = 1 11  PwrMgt   = 0   moreData = 0 12  Encrypt  = 1 13  Order    = 0 14  Duration = 11459 15  A1 = 0f-d2-e1-28-a5-7c    DA 16  A2 = 50-30-f1-84-44-08    SA 17  A3 = ab-ae-a5-b8-fc-ba    BSSID 18  SC = 0x3380 19  seqNum = 824 (0x0338)  fraqNum = 0 (0x00) 20  Algorithm = AES_CCM 21  Key ID = 0 22  TK = c9 7c 1f 67 ce 37 11 85  51 4a 8a 19 f2 bd d5 2f 23  PN = 199027030681356  (0xB5039776E70C) 24  802.11 Header =  08 48 c3 2c 0f d2 e1 28 a5 7c 50 30 f1 84 44 08 25  	ab ae a5 b8 fc ba 80 33 26  Muted 802.11 Header =  08 40 0f d2 e1 28 a5 7c 50 30 f1 84 44 08 27  	ab ae a5 b8 fc ba 00 00 28  CCMP Header =  0c e7 00 20 76 97 03 b5 29  CCM Nonce = 00 50 30 f1 84 44 08 b5  03 97 76 e7 0c 30 Plaintext Data = f8 ba 1a 55 d0 2f 85 ae 96 7b b6 2f b6 cd a8 eb 1	7e 78 a0 50 2  CCM MIC =  78 45 ce 0b 16 f9 76 23 3  -- Encrypted MPDU with FCS 4  08 48 c3 2c 0f d2 e1 28 a5 7c 50 30 f1 84 44 08 ab ae a5 b8 fc ba 5  80 33 0c e7 00 20 76 97 03 b5 f3 d0 a2 fe 9a 3d bf 23 42 a6 43 e4 6  32 46 e8 0c 3c 04 d0 19 78 45 ce 0b 16 f9 76 23 1d 99 f0 66 */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test1_key
index|[]
init|=
block|{
comment|/* TK */
literal|0xc9
block|,
literal|0x7c
block|,
literal|0x1f
block|,
literal|0x67
block|,
literal|0xce
block|,
literal|0x37
block|,
literal|0x11
block|,
literal|0x85
block|,
literal|0x51
block|,
literal|0x4a
block|,
literal|0x8a
block|,
literal|0x19
block|,
literal|0xf2
block|,
literal|0xbd
block|,
literal|0xd5
block|,
literal|0x2f
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test1_plaintext
index|[]
init|=
block|{
comment|/* Plaintext MPDU w/o MIC */
literal|0x08
block|,
literal|0x48
block|,
literal|0xc3
block|,
literal|0x2c
block|,
literal|0x0f
block|,
literal|0xd2
block|,
literal|0xe1
block|,
literal|0x28
block|,
comment|/* 802.11 Header */
literal|0xa5
block|,
literal|0x7c
block|,
literal|0x50
block|,
literal|0x30
block|,
literal|0xf1
block|,
literal|0x84
block|,
literal|0x44
block|,
literal|0x08
block|,
literal|0xab
block|,
literal|0xae
block|,
literal|0xa5
block|,
literal|0xb8
block|,
literal|0xfc
block|,
literal|0xba
block|,
literal|0x80
block|,
literal|0x33
block|,
literal|0xf8
block|,
literal|0xba
block|,
literal|0x1a
block|,
literal|0x55
block|,
literal|0xd0
block|,
literal|0x2f
block|,
literal|0x85
block|,
literal|0xae
block|,
comment|/* Plaintext Data */
literal|0x96
block|,
literal|0x7b
block|,
literal|0xb6
block|,
literal|0x2f
block|,
literal|0xb6
block|,
literal|0xcd
block|,
literal|0xa8
block|,
literal|0xeb
block|,
literal|0x7e
block|,
literal|0x78
block|,
literal|0xa0
block|,
literal|0x50
block|,  }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test1_encrypted
index|[]
init|=
block|{
comment|/* Encrypted MPDU with MIC */
literal|0x08
block|,
literal|0x48
block|,
literal|0xc3
block|,
literal|0x2c
block|,
literal|0x0f
block|,
literal|0xd2
block|,
literal|0xe1
block|,
literal|0x28
block|,
literal|0xa5
block|,
literal|0x7c
block|,
literal|0x50
block|,
literal|0x30
block|,
literal|0xf1
block|,
literal|0x84
block|,
literal|0x44
block|,
literal|0x08
block|,
literal|0xab
block|,
literal|0xae
block|,
literal|0xa5
block|,
literal|0xb8
block|,
literal|0xfc
block|,
literal|0xba
block|,
literal|0x80
block|,
literal|0x33
block|,
literal|0x0c
block|,
literal|0xe7
block|,
literal|0x00
block|,
literal|0x20
block|,
literal|0x76
block|,
literal|0x97
block|,
literal|0x03
block|,
literal|0xb5
block|,
literal|0xf3
block|,
literal|0xd0
block|,
literal|0xa2
block|,
literal|0xfe
block|,
literal|0x9a
block|,
literal|0x3d
block|,
literal|0xbf
block|,
literal|0x23
block|,
literal|0x42
block|,
literal|0xa6
block|,
literal|0x43
block|,
literal|0xe4
block|,
literal|0x32
block|,
literal|0x46
block|,
literal|0xe8
block|,
literal|0x0c
block|,
literal|0x3c
block|,
literal|0x04
block|,
literal|0xd0
block|,
literal|0x19
block|,
literal|0x78
block|,
literal|0x45
block|,
literal|0xce
block|,
literal|0x0b
block|,
literal|0x16
block|,
literal|0xf9
block|,
literal|0x76
block|,
literal|0x23
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ==== CCMP test mpdu   2 ====  -- MPDU Fields   9  Version  = 0 10  Type     = 2   SubType  = 3  Data+CF-Ack+CF-Poll 11  ToDS     = 0   FromDS   = 0 12  MoreFrag = 0   Retry    = 0 13  PwrMgt   = 0   moreData = 0 14  Encrypt  = 1 15  Order    = 1 16  Duration = 20842 17  A1 = ea-10-0c-84-68-50    DA 18  A2 = ee-c1-76-2c-88-de    SA 19  A3 = af-2e-e9-f4-6a-07    BSSID 20  SC = 0xCCE0 21  seqNum = 3278 (0x0CCE)  fraqNum = 0 (0x00) 22  Algorithm = AES_CCM 23  Key ID = 2 24  TK = 8f 7a 05 3f a5 77 a5 59  75 29 27 20 97 a6 03 d5 25  PN = 54923164817386  (0x31F3CBBA97EA) 26  802.11 Header =  38 c0 6a 51 ea 10 0c 84 68 50 ee c1 76 2c 88 de 27  	af 2e e9 f4 6a 07 e0 cc 28  Muted 802.11 Header =  08 c0 ea 10 0c 84 68 50 ee c1 76 2c 88 de 29  	af 2e e9 f4 6a 07 00 00 30  CCMP Header =  ea 97 00 a0 ba cb f3 31 31  CCM Nonce = 00 ee c1 76 2c 88 de 31  f3 cb ba 97 ea 32  Plaintext Data = 83 a0 63 4b 5e d7 62 7e b9 df 22 5e 05 74 03 42 33  	de 19 41 17 34  CCM MIC =  54 2f bf 8d a0 6a a4 ae 35  -- Encrypted MPDU with FCS 36  38 c0 6a 51 ea 10 0c 84 68 50 ee c1 76 2c 88 de af 2e e9 f4 6a 07 37  e0 cc ea 97 00 a0 ba cb f3 31 81 4b 69 65 d0 5b f2 b2 ed 38 d4 be 38  b0 69 fe 82 71 4a 61 0b 54 2f bf 8d a0 6a a4 ae 25 3c 47 38 */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test2_key
index|[]
init|=
block|{
comment|/* TK */
literal|0x8f
block|,
literal|0x7a
block|,
literal|0x05
block|,
literal|0x3f
block|,
literal|0xa5
block|,
literal|0x77
block|,
literal|0xa5
block|,
literal|0x59
block|,
literal|0x75
block|,
literal|0x29
block|,
literal|0x27
block|,
literal|0x20
block|,
literal|0x97
block|,
literal|0xa6
block|,
literal|0x03
block|,
literal|0xd5
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test2_plaintext
index|[]
init|=
block|{
comment|/* Plaintext MPDU w/o MIC */
literal|0x38
block|,
literal|0xc0
block|,
literal|0x6a
block|,
literal|0x51
block|,
literal|0xea
block|,
literal|0x10
block|,
literal|0x0c
block|,
literal|0x84
block|,
literal|0x68
block|,
literal|0x50
block|,
literal|0xee
block|,
literal|0xc1
block|,
literal|0x76
block|,
literal|0x2c
block|,
literal|0x88
block|,
literal|0xde
block|,
literal|0xaf
block|,
literal|0x2e
block|,
literal|0xe9
block|,
literal|0xf4
block|,
literal|0x6a
block|,
literal|0x07
block|,
literal|0xe0
block|,
literal|0xcc
block|,
literal|0x83
block|,
literal|0xa0
block|,
literal|0x63
block|,
literal|0x4b
block|,
literal|0x5e
block|,
literal|0xd7
block|,
literal|0x62
block|,
literal|0x7e
block|,
literal|0xb9
block|,
literal|0xdf
block|,
literal|0x22
block|,
literal|0x5e
block|,
literal|0x05
block|,
literal|0x74
block|,
literal|0x03
block|,
literal|0x42
block|,
literal|0xde
block|,
literal|0x19
block|,
literal|0x41
block|,
literal|0x17
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test2_encrypted
index|[]
init|=
block|{
comment|/* Encrypted MPDU with MIC */
literal|0x38
block|,
literal|0xc0
block|,
literal|0x6a
block|,
literal|0x51
block|,
literal|0xea
block|,
literal|0x10
block|,
literal|0x0c
block|,
literal|0x84
block|,
literal|0x68
block|,
literal|0x50
block|,
literal|0xee
block|,
literal|0xc1
block|,
literal|0x76
block|,
literal|0x2c
block|,
literal|0x88
block|,
literal|0xde
block|,
literal|0xaf
block|,
literal|0x2e
block|,
literal|0xe9
block|,
literal|0xf4
block|,
literal|0x6a
block|,
literal|0x07
block|,
literal|0xe0
block|,
literal|0xcc
block|,
literal|0xea
block|,
literal|0x97
block|,
literal|0x00
block|,
literal|0xa0
block|,
literal|0xba
block|,
literal|0xcb
block|,
literal|0xf3
block|,
literal|0x31
block|,
literal|0x81
block|,
literal|0x4b
block|,
literal|0x69
block|,
literal|0x65
block|,
literal|0xd0
block|,
literal|0x5b
block|,
literal|0xf2
block|,
literal|0xb2
block|,
literal|0xed
block|,
literal|0x38
block|,
literal|0xd4
block|,
literal|0xbe
block|,
literal|0xb0
block|,
literal|0x69
block|,
literal|0xfe
block|,
literal|0x82
block|,
literal|0x71
block|,
literal|0x4a
block|,
literal|0x61
block|,
literal|0x0b
block|,
literal|0x54
block|,
literal|0x2f
block|,
literal|0xbf
block|,
literal|0x8d
block|,
literal|0xa0
block|,
literal|0x6a
block|,
literal|0xa4
block|,
literal|0xae
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ==== CCMP test mpdu   3 ====  -- MPDU Fields  41  Version  = 0 42  Type     = 2   SubType  = 11 43  ToDS     = 0   FromDS   = 0 44  MoreFrag = 0   Retry    = 1 45  PwrMgt   = 0   moreData = 0 46  Encrypt  = 1 47  Order    = 1 48  Duration = 25052 49  A1 = d9-57-7d-f7-63-c8    DA 50 A2 = b6-a8-8a-df-36-91    SA 1  A3 = dc-4a-8b-ca-94-dd    BSSID 2  SC = 0x8260 3  seqNum = 2086 (0x0826)  fraqNum = 0 (0x00) 4  QC = 0x0000 5  MSDU Priority = 0 (0x0) 6  Algorithm = AES_CCM 7  Key ID = 2 8  TK = 40 cf b7 a6 2e 88 01 3b  d6 d3 af fc c1 91 04 1e 9  PN = 52624639632814  (0x2FDCA0F3A5AE) 10  802.11 Header =  b8 c8 dc 61 d9 57 7d f7 63 c8 b6 a8 8a df 36 91 11  	dc 4a 8b ca 94 dd 60 82 20 85 12  Muted 802.11 Header =  88 c0 d9 57 7d f7 63 c8 b6 a8 8a df 36 91 13  	dc 4a 8b ca 94 dd 00 00 00 00 14  CCMP Header =  ae a5 00 a0 f3 a0 dc 2f 15  CCM Nonce = 00 b6 a8 8a df 36 91 2f dc a0 f3 a5 ae 16  Plaintext Data  = 2c 1b d0 36 83 1c 95 49 6c 5f 4d bf 3d 55 9e 72 17  	de 80 2a 18 18  CCM MIC =  fd 1f 1f 61 a9 fb 4b b3 19  -- Encrypted MPDU with FCS 20  b8 c8 dc 61 d9 57 7d f7 63 c8 b6 a8 8a df 36 91 dc 4a 8b ca 94 dd 21  60 82 20 85 ae a5 00 a0 f3 a0 dc 2f 89 d8 58 03 40 b6 26 a0 b6 d4 22  d0 13 bf 18 f2 91 b8 96 46 c8 fd 1f 1f 61 a9 fb 4b b3 60 3f 5a ad */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test3_key
index|[]
init|=
block|{
comment|/* TK */
literal|0x40
block|,
literal|0xcf
block|,
literal|0xb7
block|,
literal|0xa6
block|,
literal|0x2e
block|,
literal|0x88
block|,
literal|0x01
block|,
literal|0x3b
block|,
literal|0xd6
block|,
literal|0xd3
block|,
literal|0xaf
block|,
literal|0xfc
block|,
literal|0xc1
block|,
literal|0x91
block|,
literal|0x04
block|,
literal|0x1e
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test3_plaintext
index|[]
init|=
block|{
comment|/* Plaintext MPDU w/o MIC */
literal|0xb8
block|,
literal|0xc8
block|,
literal|0xdc
block|,
literal|0x61
block|,
literal|0xd9
block|,
literal|0x57
block|,
literal|0x7d
block|,
literal|0xf7
block|,
literal|0x63
block|,
literal|0xc8
block|,
literal|0xb6
block|,
literal|0xa8
block|,
literal|0x8a
block|,
literal|0xdf
block|,
literal|0x36
block|,
literal|0x91
block|,
literal|0xdc
block|,
literal|0x4a
block|,
literal|0x8b
block|,
literal|0xca
block|,
literal|0x94
block|,
literal|0xdd
block|,
literal|0x60
block|,
literal|0x82
block|,
literal|0x20
block|,
literal|0x85
block|,
literal|0x2c
block|,
literal|0x1b
block|,
literal|0xd0
block|,
literal|0x36
block|,
literal|0x83
block|,
literal|0x1c
block|,
literal|0x95
block|,
literal|0x49
block|,
literal|0x6c
block|,
literal|0x5f
block|,
literal|0x4d
block|,
literal|0xbf
block|,
literal|0x3d
block|,
literal|0x55
block|,
literal|0x9e
block|,
literal|0x72
block|,
literal|0xde
block|,
literal|0x80
block|,
literal|0x2a
block|,
literal|0x18
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test3_encrypted
index|[]
init|=
block|{
comment|/* Encrypted MPDU with MIC */
literal|0xb8
block|,
literal|0xc8
block|,
literal|0xdc
block|,
literal|0x61
block|,
literal|0xd9
block|,
literal|0x57
block|,
literal|0x7d
block|,
literal|0xf7
block|,
literal|0x63
block|,
literal|0xc8
block|,
literal|0xb6
block|,
literal|0xa8
block|,
literal|0x8a
block|,
literal|0xdf
block|,
literal|0x36
block|,
literal|0x91
block|,
literal|0xdc
block|,
literal|0x4a
block|,
literal|0x8b
block|,
literal|0xca
block|,
literal|0x94
block|,
literal|0xdd
block|,
literal|0x60
block|,
literal|0x82
block|,
literal|0x20
block|,
literal|0x85
block|,
literal|0xae
block|,
literal|0xa5
block|,
literal|0x00
block|,
literal|0xa0
block|,
literal|0xf3
block|,
literal|0xa0
block|,
literal|0xdc
block|,
literal|0x2f
block|,
literal|0x89
block|,
literal|0xd8
block|,
literal|0x58
block|,
literal|0x03
block|,
literal|0x40
block|,
literal|0xb6
block|,
literal|0x26
block|,
literal|0xa0
block|,
literal|0xb6
block|,
literal|0xd4
block|,
literal|0xd0
block|,
literal|0x13
block|,
literal|0xbf
block|,
literal|0x18
block|,
literal|0xf2
block|,
literal|0x91
block|,
literal|0xb8
block|,
literal|0x96
block|,
literal|0x46
block|,
literal|0xc8
block|,
literal|0xfd
block|,
literal|0x1f
block|,
literal|0x1f
block|,
literal|0x61
block|,
literal|0xa9
block|,
literal|0xfb
block|,
literal|0x4b
block|,
literal|0xb3
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ==== CCMP test mpdu  4 ====   -- MPDU Fields 25  Version  = 0 26  Type     = 2   SubType  = 10 27  ToDS     = 0   FromDS   = 1 28  MoreFrag = 0   Retry    = 1 29  PwrMgt   = 0   moreData = 0 30  Encrypt  = 1 31  Order    = 1 32  Duration = 4410 33  A1 = 71-2a-9d-df-11-db    DA 34  A2 = 8e-f8-22-73-47-01    BSSID 35  A3 = 59-14-0d-d6-46-a2    SA 36  SC = 0x2FC0 37  seqNum = 764 (0x02FC)  fraqNum = 0 (0x00) 38  QC = 0x0007 39  MSDU Priority = 7 (0x0) 40  Algorithm = AES_CCM 41  Key ID = 0 42  TK = 8c 89 a2 eb c9 6c 76 02  70 7f cf 24 b3 2d 38 33 43  PN = 270963670912995  (0xF670A55A0FE3) 44  802.11 Header =  a8 ca 3a 11 71 2a 9d df 11 db 8e f8 22 73 47 01 45  	59 14 0d d6 46 a2 c0 2f 67 a5 46  Muted 802.11 Header =  88 c2 71 2a 9d df 11 db 8e f8 22 73 47 01 47  	59 14 0d d6 46 a2 00 00 07 00 48  CCMP Header =  e3 0f 00 20 5a a5 70 f6 49  CCM Nonce = 07 8e f8 22 73 47 01 f6  70 a5 5a 0f e3 50  Plaintext Data = 4f ad 2b 1c 29 0f a5 eb d8 72 fb c3 f3 a0 74 89 51  	8f 8b 2f bb 52  CCM MIC =  31 fc 88 00 4f 35 ee 3d -- Encrypted MPDU with FCS 2  a8 ca 3a 11 71 2a 9d df 11 db 8e f8 22 73 47 01 59 14 0d d6 46 a2 3  c0 2f 67 a5 e3 0f 00 20 5a a5 70 f6 9d 59 b1 5f 37 14 48 c2 30 f4 4  d7 39 05 2e 13 ab 3b 1a 7b 10 31 fc 88 00 4f 35 ee 3d 45 a7 4a 30 */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test4_key
index|[]
init|=
block|{
comment|/* TK */
literal|0x8c
block|,
literal|0x89
block|,
literal|0xa2
block|,
literal|0xeb
block|,
literal|0xc9
block|,
literal|0x6c
block|,
literal|0x76
block|,
literal|0x02
block|,
literal|0x70
block|,
literal|0x7f
block|,
literal|0xcf
block|,
literal|0x24
block|,
literal|0xb3
block|,
literal|0x2d
block|,
literal|0x38
block|,
literal|0x33
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test4_plaintext
index|[]
init|=
block|{
comment|/* Plaintext MPDU w/o MIC */
literal|0xa8
block|,
literal|0xca
block|,
literal|0x3a
block|,
literal|0x11
block|,
literal|0x71
block|,
literal|0x2a
block|,
literal|0x9d
block|,
literal|0xdf
block|,
literal|0x11
block|,
literal|0xdb
block|,
literal|0x8e
block|,
literal|0xf8
block|,
literal|0x22
block|,
literal|0x73
block|,
literal|0x47
block|,
literal|0x01
block|,
literal|0x59
block|,
literal|0x14
block|,
literal|0x0d
block|,
literal|0xd6
block|,
literal|0x46
block|,
literal|0xa2
block|,
literal|0xc0
block|,
literal|0x2f
block|,
literal|0x67
block|,
literal|0xa5
block|,
literal|0x4f
block|,
literal|0xad
block|,
literal|0x2b
block|,
literal|0x1c
block|,
literal|0x29
block|,
literal|0x0f
block|,
literal|0xa5
block|,
literal|0xeb
block|,
literal|0xd8
block|,
literal|0x72
block|,
literal|0xfb
block|,
literal|0xc3
block|,
literal|0xf3
block|,
literal|0xa0
block|,
literal|0x74
block|,
literal|0x89
block|,
literal|0x8f
block|,
literal|0x8b
block|,
literal|0x2f
block|,
literal|0xbb
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test4_encrypted
index|[]
init|=
block|{
comment|/* Encrypted MPDU with MIC */
literal|0xa8
block|,
literal|0xca
block|,
literal|0x3a
block|,
literal|0x11
block|,
literal|0x71
block|,
literal|0x2a
block|,
literal|0x9d
block|,
literal|0xdf
block|,
literal|0x11
block|,
literal|0xdb
block|,
literal|0x8e
block|,
literal|0xf8
block|,
literal|0x22
block|,
literal|0x73
block|,
literal|0x47
block|,
literal|0x01
block|,
literal|0x59
block|,
literal|0x14
block|,
literal|0x0d
block|,
literal|0xd6
block|,
literal|0x46
block|,
literal|0xa2
block|,
literal|0xc0
block|,
literal|0x2f
block|,
literal|0x67
block|,
literal|0xa5
block|,
literal|0xe3
block|,
literal|0x0f
block|,
literal|0x00
block|,
literal|0x20
block|,
literal|0x5a
block|,
literal|0xa5
block|,
literal|0x70
block|,
literal|0xf6
block|,
literal|0x9d
block|,
literal|0x59
block|,
literal|0xb1
block|,
literal|0x5f
block|,
literal|0x37
block|,
literal|0x14
block|,
literal|0x48
block|,
literal|0xc2
block|,
literal|0x30
block|,
literal|0xf4
block|,
literal|0xd7
block|,
literal|0x39
block|,
literal|0x05
block|,
literal|0x2e
block|,
literal|0x13
block|,
literal|0xab
block|,
literal|0x3b
block|,
literal|0x1a
block|,
literal|0x7b
block|,
literal|0x10
block|,
literal|0x31
block|,
literal|0xfc
block|,
literal|0x88
block|,
literal|0x00
block|,
literal|0x4f
block|,
literal|0x35
block|,
literal|0xee
block|,
literal|0x3d
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ==== CCMP test mpdu   5 ====  -- MPDU Fields  7  Version  = 0 8  Type     = 2   SubType  = 8 9  ToDS     = 0   FromDS   = 1 10  MoreFrag = 0   Retry    = 1 11  PwrMgt   = 1   moreData = 0 12  Encrypt  = 1 13  Order    = 1 14  Duration = 16664 15  A1 = 45-de-c6-9a-74-80    DA 16  A2 = f3-51-94-6b-c9-6b    BSSID 17  A3 = e2-76-fb-e6-c1-27    SA 18  SC = 0xF280 19  seqNum = 3880 (0x0F28)  fraqNum = 0 (0x00) 20  QC = 0x000b 21  MSDU Priority = 0 (0x0) 22  Algorithm = AES_CCM 23  Key ID = 2 24  TK = a5 74 d5 14 3b b2 5e fd  de ff 30 12 2f df d0 66 25  PN = 184717420531255  (0xA7FFE03C0E37) 26  802.11 Header =  88 da 18 41 45 de c6 9a 74 80 f3 51 94 6b c9 6b 27  	e2 76 fb e6 c1 27 80 f2 4b 19 28  Muted 802.11 Header =  88 c2 45 de c6 9a 74 80 f3 51 94 6b c9 6b 29  	e2 76 fb e6 c1 27 00 00 0b 00 30  CCMP Header =  37 0e 00 a0 3c e0 ff a7 31  CCM Nonce = 0b f3 51 94 6b c9 6b a7 ff e0 3c 0e 37 32  Plaintext Data = 28 96 9b 95 4f 26 3a 80 18 a9 ef 70 a8 b0 51 46 33  	24 81 92 2e 34  CCM MIC =  ce 0c 3b e1 97 d3 05 eb 35  -- Encrypted MPDU with FCS 36  88 da 18 41 45 de c6 9a 74 80 f3 51 94 6b c9 6b e2 76 fb e6 c1 27 37  80 f2 4b 19 37 0e 00 a0 3c e0 ff a7 eb 4a e4 95 6a 80 1d a9 62 4b 38  7e 0c 18 b2 3e 61 5e c0 3a f6 ce 0c 3b e1 97 d3 05 eb c8 9e a1 b5 */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test5_key
index|[]
init|=
block|{
comment|/* TK */
literal|0xa5
block|,
literal|0x74
block|,
literal|0xd5
block|,
literal|0x14
block|,
literal|0x3b
block|,
literal|0xb2
block|,
literal|0x5e
block|,
literal|0xfd
block|,
literal|0xde
block|,
literal|0xff
block|,
literal|0x30
block|,
literal|0x12
block|,
literal|0x2f
block|,
literal|0xdf
block|,
literal|0xd0
block|,
literal|0x66
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test5_plaintext
index|[]
init|=
block|{
comment|/* Plaintext MPDU w/o MIC */
literal|0x88
block|,
literal|0xda
block|,
literal|0x18
block|,
literal|0x41
block|,
literal|0x45
block|,
literal|0xde
block|,
literal|0xc6
block|,
literal|0x9a
block|,
literal|0x74
block|,
literal|0x80
block|,
literal|0xf3
block|,
literal|0x51
block|,
literal|0x94
block|,
literal|0x6b
block|,
literal|0xc9
block|,
literal|0x6b
block|,
literal|0xe2
block|,
literal|0x76
block|,
literal|0xfb
block|,
literal|0xe6
block|,
literal|0xc1
block|,
literal|0x27
block|,
literal|0x80
block|,
literal|0xf2
block|,
literal|0x4b
block|,
literal|0x19
block|,
literal|0x28
block|,
literal|0x96
block|,
literal|0x9b
block|,
literal|0x95
block|,
literal|0x4f
block|,
literal|0x26
block|,
literal|0x3a
block|,
literal|0x80
block|,
literal|0x18
block|,
literal|0xa9
block|,
literal|0xef
block|,
literal|0x70
block|,
literal|0xa8
block|,
literal|0xb0
block|,
literal|0x51
block|,
literal|0x46
block|,
literal|0x24
block|,
literal|0x81
block|,
literal|0x92
block|,
literal|0x2e
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test5_encrypted
index|[]
init|=
block|{
comment|/* Encrypted MPDU with MIC */
literal|0x88
block|,
literal|0xda
block|,
literal|0x18
block|,
literal|0x41
block|,
literal|0x45
block|,
literal|0xde
block|,
literal|0xc6
block|,
literal|0x9a
block|,
literal|0x74
block|,
literal|0x80
block|,
literal|0xf3
block|,
literal|0x51
block|,
literal|0x94
block|,
literal|0x6b
block|,
literal|0xc9
block|,
literal|0x6b
block|,
literal|0xe2
block|,
literal|0x76
block|,
literal|0xfb
block|,
literal|0xe6
block|,
literal|0xc1
block|,
literal|0x27
block|,
literal|0x80
block|,
literal|0xf2
block|,
literal|0x4b
block|,
literal|0x19
block|,
literal|0x37
block|,
literal|0x0e
block|,
literal|0x00
block|,
literal|0xa0
block|,
literal|0x3c
block|,
literal|0xe0
block|,
literal|0xff
block|,
literal|0xa7
block|,
literal|0xeb
block|,
literal|0x4a
block|,
literal|0xe4
block|,
literal|0x95
block|,
literal|0x6a
block|,
literal|0x80
block|,
literal|0x1d
block|,
literal|0xa9
block|,
literal|0x62
block|,
literal|0x4b
block|,
literal|0x7e
block|,
literal|0x0c
block|,
literal|0x18
block|,
literal|0xb2
block|,
literal|0x3e
block|,
literal|0x61
block|,
literal|0x5e
block|,
literal|0xc0
block|,
literal|0x3a
block|,
literal|0xf6
block|,
literal|0xce
block|,
literal|0x0c
block|,
literal|0x3b
block|,
literal|0xe1
block|,
literal|0x97
block|,
literal|0xd3
block|,
literal|0x05
block|,
literal|0xeb
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ==== CCMP test mpdu   6 ====  -- MPDU Fields  41  Version  = 0 42  Type     = 2   SubType  = 8 43  ToDS     = 0   FromDS   = 1 44  MoreFrag = 0   Retry    = 0 45  PwrMgt   = 1   moreData = 0 46  Encrypt  = 1 47  Order    = 0 48  Duration = 8161 49  A1 = 5a-f2-84-30-fd-ab    DA 50  A2 = bf-f9-43-b9-f9-a6    BSSID 1   A3 = ab-1d-98-c7-fe-73    SA 2  SC = 0x7150 3  seqNum = 1813 (0x0715)  fraqNum = 0 (0x00) 4  QC = 0x000d 5  PSDU Priority = 13 (0xd) 6  Algorithm = AES_CCM 7  Key ID = 1 8  TK = f7 1e ea 4e 1f 58 80 4b 97 17 23 0a d0 61 46 41 9  PN    = 118205765159305  (0x6B81ECA48989) 10  802.11 Header =  88 52 e1 1f 5a f2 84 30 fd ab bf f9 43 b9 f9 a6 11  	ab 1d 98 c7 fe 73 50 71  3d 6a 12  Muted 802.11 Header =  88 42 5a f2 84 30 fd ab bf f9 43 b9 f9 a6 13  	ab 1d 98 c7 fe 73 00 00 0d 00 14  CCMP Header =  89 89 00 60 a4 ec 81 6b 15  CCM Nonce = 0d bf f9 43 b9 f9 a6 6b  81 ec a4 89 89 16  Plaintext Data = ab fd a2 2d 3a 0b fc 9c c1 fc 07 93 63 c2 fc a1 17  	43 e6 eb 1d 18  CCM MIC =  30 9a 8d 5c 46 6b bb 71 19  -- Encrypted MPDU with FCS 20  88 52 e1 1f 5a f2 84 30 fd ab bf f9 43 b9 f9 a6 ab 1d 98 c7 fe 73 21  50 71 3d 6a 89 89 00 60 a4 ec 81 6b 9a 70 9b 60 a3 9d 40 b1 df b6 22  12 e1 8b 5f 11 4b ad b6 cc 86 30 9a 8d 5c 46 6b bb 71 86 c0 4e 97 */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test6_key
index|[]
init|=
block|{
comment|/* TK */
literal|0xf7
block|,
literal|0x1e
block|,
literal|0xea
block|,
literal|0x4e
block|,
literal|0x1f
block|,
literal|0x58
block|,
literal|0x80
block|,
literal|0x4b
block|,
literal|0x97
block|,
literal|0x17
block|,
literal|0x23
block|,
literal|0x0a
block|,
literal|0xd0
block|,
literal|0x61
block|,
literal|0x46
block|,
literal|0x41
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test6_plaintext
index|[]
init|=
block|{
comment|/* Plaintext MPDU w/o MIC */
literal|0x88
block|,
literal|0x52
block|,
literal|0xe1
block|,
literal|0x1f
block|,
literal|0x5a
block|,
literal|0xf2
block|,
literal|0x84
block|,
literal|0x30
block|,
literal|0xfd
block|,
literal|0xab
block|,
literal|0xbf
block|,
literal|0xf9
block|,
literal|0x43
block|,
literal|0xb9
block|,
literal|0xf9
block|,
literal|0xa6
block|,
literal|0xab
block|,
literal|0x1d
block|,
literal|0x98
block|,
literal|0xc7
block|,
literal|0xfe
block|,
literal|0x73
block|,
literal|0x50
block|,
literal|0x71
block|,
literal|0x3d
block|,
literal|0x6a
block|,
literal|0xab
block|,
literal|0xfd
block|,
literal|0xa2
block|,
literal|0x2d
block|,
literal|0x3a
block|,
literal|0x0b
block|,
literal|0xfc
block|,
literal|0x9c
block|,
literal|0xc1
block|,
literal|0xfc
block|,
literal|0x07
block|,
literal|0x93
block|,
literal|0x63
block|,
literal|0xc2
block|,
literal|0xfc
block|,
literal|0xa1
block|,
literal|0x43
block|,
literal|0xe6
block|,
literal|0xeb
block|,
literal|0x1d
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test6_encrypted
index|[]
init|=
block|{
comment|/* Encrypted MPDU with MIC */
literal|0x88
block|,
literal|0x52
block|,
literal|0xe1
block|,
literal|0x1f
block|,
literal|0x5a
block|,
literal|0xf2
block|,
literal|0x84
block|,
literal|0x30
block|,
literal|0xfd
block|,
literal|0xab
block|,
literal|0xbf
block|,
literal|0xf9
block|,
literal|0x43
block|,
literal|0xb9
block|,
literal|0xf9
block|,
literal|0xa6
block|,
literal|0xab
block|,
literal|0x1d
block|,
literal|0x98
block|,
literal|0xc7
block|,
literal|0xfe
block|,
literal|0x73
block|,
literal|0x50
block|,
literal|0x71
block|,
literal|0x3d
block|,
literal|0x6a
block|,
literal|0x89
block|,
literal|0x89
block|,
literal|0x00
block|,
literal|0x60
block|,
literal|0xa4
block|,
literal|0xec
block|,
literal|0x81
block|,
literal|0x6b
block|,
literal|0x9a
block|,
literal|0x70
block|,
literal|0x9b
block|,
literal|0x60
block|,
literal|0xa3
block|,
literal|0x9d
block|,
literal|0x40
block|,
literal|0xb1
block|,
literal|0xdf
block|,
literal|0xb6
block|,
literal|0x12
block|,
literal|0xe1
block|,
literal|0x8b
block|,
literal|0x5f
block|,
literal|0x11
block|,
literal|0x4b
block|,
literal|0xad
block|,
literal|0xb6
block|,
literal|0xcc
block|,
literal|0x86
block|,
literal|0x30
block|,
literal|0x9a
block|,
literal|0x8d
block|,
literal|0x5c
block|,
literal|0x46
block|,
literal|0x6b
block|,
literal|0xbb
block|,
literal|0x71
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ==== CCMP test mpdu   7 ====  -- MPDU Fields  25  Version  = 0 26  Type     = 2   SubType  = 1  Data+CF-Ack 27  ToDS     = 1   FromDS   = 0 28  MoreFrag = 0   Retry    = 1 29  PwrMgt   = 1   moreData = 1 30  Encrypt  = 1 31  Order    = 0 32  Duration = 18049 33  A1 = 9b-50-f4-fd-56-f6    BSSID 34  A2 = ef-ec-95-20-16-91    SA 35  A3 = 83-57-0c-4c-cd-ee    DA 36  SC = 0xA020 37  seqNum = 2562 (0x0A02)  fraqNum = 0 (0x00) 38  Algorithm = AES_CCM 39  Key ID = 3 40  TK = 1b db 34 98 0e 03 81 24 a1 db 1a 89 2b ec 36 6a 41  PN = 104368786630435  (0x5EEC4073E723) 42  Header =  18 79 81 46 9b 50 f4 fd 56 f6 ef ec 95 20 16 91 83 57 43  	0c 4c cd ee 20 a0 44  Muted MAC Header =  08 41 9b 50 f4 fd 56 f6 ef ec 95 20 16 91 45  	83 57 0c 4c cd ee 00 00 46  CCMP Header =  23 e7 00 e0 73 40 ec 5e 47  CCM Nonce = 00 ef ec 95 20 16 91 5e ec 40 73 e7 23 48  Plaintext Data = 98 be ca 86 f4 b3 8d a2 0c fd f2 47 24 c5 8e b8 49  	35 66 53 39 50  CCM MIC =  2d 09 57 ec fa be 95 b9 -- Encrypted MPDU with FCS 1  18 79 81 46 9b 50 f4 fd 56 f6 ef ec 95 20 16 91 83 57 0c 4c cd ee 2  20 a0 23 e7 00 e0 73 40 ec 5e 12 c5 37 eb f3 ab 58 4e f1 fe f9 a1 3  f3 54 7a 8c 13 b3 22 5a 2d 09 57 ec fa be 95 b9 aa fa 0c c8 */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test7_key
index|[]
init|=
block|{
comment|/* TK */
literal|0x1b
block|,
literal|0xdb
block|,
literal|0x34
block|,
literal|0x98
block|,
literal|0x0e
block|,
literal|0x03
block|,
literal|0x81
block|,
literal|0x24
block|,
literal|0xa1
block|,
literal|0xdb
block|,
literal|0x1a
block|,
literal|0x89
block|,
literal|0x2b
block|,
literal|0xec
block|,
literal|0x36
block|,
literal|0x6a
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test7_plaintext
index|[]
init|=
block|{
comment|/* Plaintext MPDU w/o MIC */
literal|0x18
block|,
literal|0x79
block|,
literal|0x81
block|,
literal|0x46
block|,
literal|0x9b
block|,
literal|0x50
block|,
literal|0xf4
block|,
literal|0xfd
block|,
literal|0x56
block|,
literal|0xf6
block|,
literal|0xef
block|,
literal|0xec
block|,
literal|0x95
block|,
literal|0x20
block|,
literal|0x16
block|,
literal|0x91
block|,
literal|0x83
block|,
literal|0x57
block|,
literal|0x0c
block|,
literal|0x4c
block|,
literal|0xcd
block|,
literal|0xee
block|,
literal|0x20
block|,
literal|0xa0
block|,
literal|0x98
block|,
literal|0xbe
block|,
literal|0xca
block|,
literal|0x86
block|,
literal|0xf4
block|,
literal|0xb3
block|,
literal|0x8d
block|,
literal|0xa2
block|,
literal|0x0c
block|,
literal|0xfd
block|,
literal|0xf2
block|,
literal|0x47
block|,
literal|0x24
block|,
literal|0xc5
block|,
literal|0x8e
block|,
literal|0xb8
block|,
literal|0x35
block|,
literal|0x66
block|,
literal|0x53
block|,
literal|0x39
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test7_encrypted
index|[]
init|=
block|{
comment|/* Encrypted MPDU with MIC */
literal|0x18
block|,
literal|0x79
block|,
literal|0x81
block|,
literal|0x46
block|,
literal|0x9b
block|,
literal|0x50
block|,
literal|0xf4
block|,
literal|0xfd
block|,
literal|0x56
block|,
literal|0xf6
block|,
literal|0xef
block|,
literal|0xec
block|,
literal|0x95
block|,
literal|0x20
block|,
literal|0x16
block|,
literal|0x91
block|,
literal|0x83
block|,
literal|0x57
block|,
literal|0x0c
block|,
literal|0x4c
block|,
literal|0xcd
block|,
literal|0xee
block|,
literal|0x20
block|,
literal|0xa0
block|,
literal|0x23
block|,
literal|0xe7
block|,
literal|0x00
block|,
literal|0xe0
block|,
literal|0x73
block|,
literal|0x40
block|,
literal|0xec
block|,
literal|0x5e
block|,
literal|0x12
block|,
literal|0xc5
block|,
literal|0x37
block|,
literal|0xeb
block|,
literal|0xf3
block|,
literal|0xab
block|,
literal|0x58
block|,
literal|0x4e
block|,
literal|0xf1
block|,
literal|0xfe
block|,
literal|0xf9
block|,
literal|0xa1
block|,
literal|0xf3
block|,
literal|0x54
block|,
literal|0x7a
block|,
literal|0x8c
block|,
literal|0x13
block|,
literal|0xb3
block|,
literal|0x22
block|,
literal|0x5a
block|,
literal|0x2d
block|,
literal|0x09
block|,
literal|0x57
block|,
literal|0xec
block|,
literal|0xfa
block|,
literal|0xbe
block|,
literal|0x95
block|,
literal|0xb9
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ==== CCMP test mpdu   8 ====  -- MPDU Fields  6  Version  = 0 7  Type     = 2   SubType  = 11 8  ToDS     = 1   FromDS   = 0 9  MoreFrag = 0   Retry    = 1 10  PwrMgt   = 1   moreData = 0 11  Encrypt  = 1 12  Order    = 1 13  Duration = 29260 14  A1 = 55-2d-5f-72-bb-70    BSSID 15  A2 = ca-3f-3a-ae-60-c4    SA 16  A3 = 8b-a9-b5-f8-2c-2f    DA 17  SC = 0xEB50 18  seqNum = 3765 (0x0EB5)  fraqNum = 0 (0x00) 19  QC = 0x000a 20  MSDU Priority = 10 (0xa) 21  Algorithm = AES_CCM 22  Key ID = 2 23  TK = 6e ac 1b f5 4b d5 4e db 23 21 75 43 03 02 4c 71 24  PN    = 227588596223197  (0xCEFD996ECCDD) 25  802.11 Header =  b8 d9 4c 72 55 2d 5f 72 bb 70 ca 3f 3a ae 60 c4 26  	8b a9 b5 f8 2c 2f 50 eb 2a 55 27  Muted 802.11 Header =  88 c1 55 2d 5f 72 bb 70 ca 3f 3a ae 60 c4 28  	8b a9 b5 f8 2c 2f 00 00 0a 00 29  CCMP Header =  dd cc 00 a0 6e 99 fd ce 30  CCM Nonce = 0a ca 3f 3a ae 60 c4 ce fd 99 6e cc dd 31  Plaintext Data = 57 cb 5c 0e 5f cd 88 5e 9a 42 39 e9 b9 ca d6 0d 32  	64 37 59 79 33  CCM MIC =  6d ba 8e f7 f0 80 87 dd -- Encrypted MPDU with FCS 35  b8 d9 4c 72 55 2d 5f 72 bb 70 ca 3f 3a ae 60 c4 8b a9 b5 f8 2c 2f 36  50 eb 2a 55 dd cc 00 a0 6e 99 fd ce 4b f2 81 ef 8e c7 73 9f 91 59 37  1b 97 a8 7d c1 4b 3f a1 74 62 6d ba 8e f7 f0 80 87 dd 0c 65 74 3f */
end_comment

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test8_key
index|[]
init|=
block|{
comment|/* TK */
literal|0x6e
block|,
literal|0xac
block|,
literal|0x1b
block|,
literal|0xf5
block|,
literal|0x4b
block|,
literal|0xd5
block|,
literal|0x4e
block|,
literal|0xdb
block|,
literal|0x23
block|,
literal|0x21
block|,
literal|0x75
block|,
literal|0x43
block|,
literal|0x03
block|,
literal|0x02
block|,
literal|0x4c
block|,
literal|0x71
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test8_plaintext
index|[]
init|=
block|{
comment|/* Plaintext MPDU w/o MIC */
literal|0xb8
block|,
literal|0xd9
block|,
literal|0x4c
block|,
literal|0x72
block|,
literal|0x55
block|,
literal|0x2d
block|,
literal|0x5f
block|,
literal|0x72
block|,
literal|0xbb
block|,
literal|0x70
block|,
literal|0xca
block|,
literal|0x3f
block|,
literal|0x3a
block|,
literal|0xae
block|,
literal|0x60
block|,
literal|0xc4
block|,
literal|0x8b
block|,
literal|0xa9
block|,
literal|0xb5
block|,
literal|0xf8
block|,
literal|0x2c
block|,
literal|0x2f
block|,
literal|0x50
block|,
literal|0xeb
block|,
literal|0x2a
block|,
literal|0x55
block|,
literal|0x57
block|,
literal|0xcb
block|,
literal|0x5c
block|,
literal|0x0e
block|,
literal|0x5f
block|,
literal|0xcd
block|,
literal|0x88
block|,
literal|0x5e
block|,
literal|0x9a
block|,
literal|0x42
block|,
literal|0x39
block|,
literal|0xe9
block|,
literal|0xb9
block|,
literal|0xca
block|,
literal|0xd6
block|,
literal|0x0d
block|,
literal|0x64
block|,
literal|0x37
block|,
literal|0x59
block|,
literal|0x79
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
specifier|const
name|u_int8_t
name|test8_encrypted
index|[]
init|=
block|{
comment|/* Encrypted MPDU with MIC */
literal|0xb8
block|,
literal|0xd9
block|,
literal|0x4c
block|,
literal|0x72
block|,
literal|0x55
block|,
literal|0x2d
block|,
literal|0x5f
block|,
literal|0x72
block|,
literal|0xbb
block|,
literal|0x70
block|,
literal|0xca
block|,
literal|0x3f
block|,
literal|0x3a
block|,
literal|0xae
block|,
literal|0x60
block|,
literal|0xc4
block|,
literal|0x8b
block|,
literal|0xa9
block|,
literal|0xb5
block|,
literal|0xf8
block|,
literal|0x2c
block|,
literal|0x2f
block|,
literal|0x50
block|,
literal|0xeb
block|,
literal|0x2a
block|,
literal|0x55
block|,
literal|0xdd
block|,
literal|0xcc
block|,
literal|0x00
block|,
literal|0xa0
block|,
literal|0x6e
block|,
literal|0x99
block|,
literal|0xfd
block|,
literal|0xce
block|,
literal|0x4b
block|,
literal|0xf2
block|,
literal|0x81
block|,
literal|0xef
block|,
literal|0x8e
block|,
literal|0xc7
block|,
literal|0x73
block|,
literal|0x9f
block|,
literal|0x91
block|,
literal|0x59
block|,
literal|0x1b
block|,
literal|0x97
block|,
literal|0xa8
block|,
literal|0x7d
block|,
literal|0xc1
block|,
literal|0x4b
block|,
literal|0x3f
block|,
literal|0xa1
block|,
literal|0x74
block|,
literal|0x62
block|,
literal|0x6d
block|,
literal|0xba
block|,
literal|0x8e
block|,
literal|0xf7
block|,
literal|0xf0
block|,
literal|0x80
block|,
literal|0x87
block|,
literal|0xdd
block|, }
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|TEST
parameter_list|(
name|n
parameter_list|,
name|name
parameter_list|,
name|cipher
parameter_list|,
name|keyix
parameter_list|,
name|pn
parameter_list|)
value|{ \ 	name, IEEE80211_CIPHER_##cipher,keyix, pn##LL, \ 	test##n##_key,   sizeof(test##n##_key), \ 	test##n##_plaintext, sizeof(test##n##_plaintext), \ 	test##n##_encrypted, sizeof(test##n##_encrypted) \ }
end_define

begin_struct
struct|struct
name|ciphertest
block|{
specifier|const
name|char
modifier|*
name|name
decl_stmt|;
name|int
name|cipher
decl_stmt|;
name|int
name|keyix
decl_stmt|;
name|u_int64_t
name|pn
decl_stmt|;
specifier|const
name|u_int8_t
modifier|*
name|key
decl_stmt|;
name|size_t
name|key_len
decl_stmt|;
specifier|const
name|u_int8_t
modifier|*
name|plaintext
decl_stmt|;
name|size_t
name|plaintext_len
decl_stmt|;
specifier|const
name|u_int8_t
modifier|*
name|encrypted
decl_stmt|;
name|size_t
name|encrypted_len
decl_stmt|;
block|}
name|ccmptests
index|[]
init|=
block|{
name|TEST
argument_list|(
literal|1
argument_list|,
literal|"CCMP test mpdu 1"
argument_list|,
name|AES_CCM
argument_list|,
literal|0
argument_list|,
literal|199027030681356
argument_list|)
block|,
name|TEST
argument_list|(
literal|2
argument_list|,
literal|"CCMP test mpdu 2"
argument_list|,
name|AES_CCM
argument_list|,
literal|2
argument_list|,
literal|54923164817386
argument_list|)
block|,
name|TEST
argument_list|(
literal|3
argument_list|,
literal|"CCMP test mpdu 3"
argument_list|,
name|AES_CCM
argument_list|,
literal|2
argument_list|,
literal|52624639632814
argument_list|)
block|,
name|TEST
argument_list|(
literal|4
argument_list|,
literal|"CCMP test mpdu 4"
argument_list|,
name|AES_CCM
argument_list|,
literal|0
argument_list|,
literal|270963670912995
argument_list|)
block|,
name|TEST
argument_list|(
literal|5
argument_list|,
literal|"CCMP test mpdu 5"
argument_list|,
name|AES_CCM
argument_list|,
literal|2
argument_list|,
literal|184717420531255
argument_list|)
block|,
name|TEST
argument_list|(
literal|6
argument_list|,
literal|"CCMP test mpdu 6"
argument_list|,
name|AES_CCM
argument_list|,
literal|1
argument_list|,
literal|118205765159305
argument_list|)
block|,
name|TEST
argument_list|(
literal|7
argument_list|,
literal|"CCMP test mpdu 7"
argument_list|,
name|AES_CCM
argument_list|,
literal|3
argument_list|,
literal|104368786630435
argument_list|)
block|,
name|TEST
argument_list|(
literal|8
argument_list|,
literal|"CCMP test mpdu 8"
argument_list|,
name|AES_CCM
argument_list|,
literal|2
argument_list|,
literal|227588596223197
argument_list|)
block|, }
struct|;
end_struct

begin_function
specifier|static
name|void
name|dumpdata
parameter_list|(
specifier|const
name|char
modifier|*
name|tag
parameter_list|,
specifier|const
name|void
modifier|*
name|p
parameter_list|,
name|size_t
name|len
parameter_list|)
block|{
name|int
name|i
decl_stmt|;
name|printf
argument_list|(
literal|"%s: 0x%p len %u"
argument_list|,
name|tag
argument_list|,
name|p
argument_list|,
name|len
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
operator|(
name|i
operator|%
literal|16
operator|)
operator|==
literal|0
condition|)
name|printf
argument_list|(
literal|"\n%03d:"
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|" %02x"
argument_list|,
operator|(
operator|(
specifier|const
name|u_int8_t
operator|*
operator|)
name|p
operator|)
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
name|printf
argument_list|(
literal|"\n"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|cmpfail
parameter_list|(
specifier|const
name|void
modifier|*
name|gen
parameter_list|,
name|size_t
name|genlen
parameter_list|,
specifier|const
name|void
modifier|*
name|ref
parameter_list|,
name|size_t
name|reflen
parameter_list|)
block|{
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|genlen
condition|;
name|i
operator|++
control|)
if|if
condition|(
operator|(
operator|(
specifier|const
name|u_int8_t
operator|*
operator|)
name|gen
operator|)
index|[
name|i
index|]
operator|!=
operator|(
operator|(
specifier|const
name|u_int8_t
operator|*
operator|)
name|ref
operator|)
index|[
name|i
index|]
condition|)
block|{
name|printf
argument_list|(
literal|"first difference at byte %u\n"
argument_list|,
name|i
argument_list|)
expr_stmt|;
break|break;
block|}
name|dumpdata
argument_list|(
literal|"Generated"
argument_list|,
name|gen
argument_list|,
name|genlen
argument_list|)
expr_stmt|;
name|dumpdata
argument_list|(
literal|"Reference"
argument_list|,
name|ref
argument_list|,
name|reflen
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
name|printtest
parameter_list|(
specifier|const
name|struct
name|ciphertest
modifier|*
name|t
parameter_list|)
block|{
name|printf
argument_list|(
literal|"keyix %u pn %llu key_len %u plaintext_len %u\n"
argument_list|,
name|t
operator|->
name|keyix
argument_list|,
name|t
operator|->
name|pn
argument_list|,
name|t
operator|->
name|key_len
argument_list|,
name|t
operator|->
name|plaintext_len
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|int
name|runtest
parameter_list|(
name|struct
name|ieee80211com
modifier|*
name|ic
parameter_list|,
name|struct
name|ciphertest
modifier|*
name|t
parameter_list|)
block|{
name|struct
name|ieee80211_key
name|key
decl_stmt|;
name|struct
name|mbuf
modifier|*
name|m
init|=
name|NULL
decl_stmt|;
specifier|const
name|struct
name|ieee80211_cipher
modifier|*
name|cip
decl_stmt|;
name|u_int8_t
name|mac
index|[
name|IEEE80211_ADDR_LEN
index|]
decl_stmt|;
name|printf
argument_list|(
literal|"%s: "
argument_list|,
name|t
operator|->
name|name
argument_list|)
expr_stmt|;
comment|/* 	 * Setup key. 	 */
name|memset
argument_list|(
operator|&
name|key
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|key
argument_list|)
argument_list|)
expr_stmt|;
name|key
operator|.
name|wk_flags
operator|=
name|IEEE80211_KEY_XMIT
operator||
name|IEEE80211_KEY_RECV
expr_stmt|;
name|key
operator|.
name|wk_cipher
operator|=
operator|&
name|ieee80211_cipher_none
expr_stmt|;
if|if
condition|(
operator|!
name|ieee80211_crypto_newkey
argument_list|(
name|ic
argument_list|,
name|t
operator|->
name|cipher
argument_list|,
name|IEEE80211_KEY_XMIT
operator||
name|IEEE80211_KEY_RECV
argument_list|,
operator|&
name|key
argument_list|)
condition|)
block|{
name|printf
argument_list|(
literal|"FAIL: ieee80211_crypto_newkey failed\n"
argument_list|)
expr_stmt|;
goto|goto
name|bad
goto|;
block|}
name|memcpy
argument_list|(
name|key
operator|.
name|wk_key
argument_list|,
name|t
operator|->
name|key
argument_list|,
name|t
operator|->
name|key_len
argument_list|)
expr_stmt|;
name|key
operator|.
name|wk_keylen
operator|=
name|t
operator|->
name|key_len
expr_stmt|;
name|key
operator|.
name|wk_keyrsc
operator|=
literal|0
expr_stmt|;
name|key
operator|.
name|wk_keytsc
operator|=
name|t
operator|->
name|pn
operator|-
literal|1
expr_stmt|;
comment|/* PN-1 since we do encap */
if|if
condition|(
operator|!
name|ieee80211_crypto_setkey
argument_list|(
name|ic
argument_list|,
operator|&
name|key
argument_list|,
name|mac
argument_list|)
condition|)
block|{
name|printf
argument_list|(
literal|"FAIL: ieee80211_crypto_setkey failed\n"
argument_list|)
expr_stmt|;
goto|goto
name|bad
goto|;
block|}
comment|/* 	 * Craft frame from plaintext data. 	 */
name|cip
operator|=
name|key
operator|.
name|wk_cipher
expr_stmt|;
name|m
operator|=
name|m_getcl
argument_list|(
name|M_NOWAIT
argument_list|,
name|MT_HEADER
argument_list|,
name|M_PKTHDR
argument_list|)
expr_stmt|;
name|m
operator|->
name|m_data
operator|+=
name|cip
operator|->
name|ic_header
expr_stmt|;
name|memcpy
argument_list|(
name|mtod
argument_list|(
name|m
argument_list|,
name|void
operator|*
argument_list|)
argument_list|,
name|t
operator|->
name|plaintext
argument_list|,
name|t
operator|->
name|plaintext_len
argument_list|)
expr_stmt|;
name|m
operator|->
name|m_len
operator|=
name|t
operator|->
name|plaintext_len
expr_stmt|;
name|m
operator|->
name|m_pkthdr
operator|.
name|len
operator|=
name|m
operator|->
name|m_len
expr_stmt|;
comment|/* 	 * Encrypt frame w/ MIC. 	 */
if|if
condition|(
operator|!
name|cip
operator|->
name|ic_encap
argument_list|(
operator|&
name|key
argument_list|,
name|m
argument_list|,
name|t
operator|->
name|keyix
operator|<<
literal|6
argument_list|)
condition|)
block|{
name|printtest
argument_list|(
name|t
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"FAIL: ccmp encap failed\n"
argument_list|)
expr_stmt|;
goto|goto
name|bad
goto|;
block|}
comment|/* 	 * Verify: frame length, frame contents. 	 */
if|if
condition|(
name|m
operator|->
name|m_pkthdr
operator|.
name|len
operator|!=
name|t
operator|->
name|encrypted_len
condition|)
block|{
name|printf
argument_list|(
literal|"FAIL: encap data length mismatch\n"
argument_list|)
expr_stmt|;
name|printtest
argument_list|(
name|t
argument_list|)
expr_stmt|;
name|cmpfail
argument_list|(
name|mtod
argument_list|(
name|m
argument_list|,
specifier|const
name|void
operator|*
argument_list|)
argument_list|,
name|m
operator|->
name|m_pkthdr
operator|.
name|len
argument_list|,
name|t
operator|->
name|encrypted
argument_list|,
name|t
operator|->
name|encrypted_len
argument_list|)
expr_stmt|;
goto|goto
name|bad
goto|;
block|}
elseif|else
if|if
condition|(
name|memcmp
argument_list|(
name|mtod
argument_list|(
name|m
argument_list|,
specifier|const
name|void
operator|*
argument_list|)
argument_list|,
name|t
operator|->
name|encrypted
argument_list|,
name|t
operator|->
name|encrypted_len
argument_list|)
condition|)
block|{
name|printf
argument_list|(
literal|"FAIL: encrypt data does not compare\n"
argument_list|)
expr_stmt|;
name|printtest
argument_list|(
name|t
argument_list|)
expr_stmt|;
name|cmpfail
argument_list|(
name|mtod
argument_list|(
name|m
argument_list|,
specifier|const
name|void
operator|*
argument_list|)
argument_list|,
name|m
operator|->
name|m_pkthdr
operator|.
name|len
argument_list|,
name|t
operator|->
name|encrypted
argument_list|,
name|t
operator|->
name|encrypted_len
argument_list|)
expr_stmt|;
name|dumpdata
argument_list|(
literal|"Plaintext"
argument_list|,
name|t
operator|->
name|plaintext
argument_list|,
name|t
operator|->
name|plaintext_len
argument_list|)
expr_stmt|;
goto|goto
name|bad
goto|;
block|}
comment|/* 	 * Decrypt frame; strip MIC. 	 */
if|if
condition|(
operator|!
name|cip
operator|->
name|ic_decap
argument_list|(
operator|&
name|key
argument_list|,
name|m
argument_list|)
condition|)
block|{
name|printf
argument_list|(
literal|"FAIL: ccmp decap failed\n"
argument_list|)
expr_stmt|;
name|printtest
argument_list|(
name|t
argument_list|)
expr_stmt|;
name|cmpfail
argument_list|(
name|mtod
argument_list|(
name|m
argument_list|,
specifier|const
name|void
operator|*
argument_list|)
argument_list|,
name|m
operator|->
name|m_len
argument_list|,
name|t
operator|->
name|plaintext
argument_list|,
name|t
operator|->
name|plaintext_len
argument_list|)
expr_stmt|;
goto|goto
name|bad
goto|;
block|}
comment|/* 	 * Verify: frame length, frame contents. 	 */
if|if
condition|(
name|m
operator|->
name|m_pkthdr
operator|.
name|len
operator|!=
name|t
operator|->
name|plaintext_len
condition|)
block|{
name|printf
argument_list|(
literal|"FAIL: decap botch; length mismatch\n"
argument_list|)
expr_stmt|;
name|printtest
argument_list|(
name|t
argument_list|)
expr_stmt|;
name|cmpfail
argument_list|(
name|mtod
argument_list|(
name|m
argument_list|,
specifier|const
name|void
operator|*
argument_list|)
argument_list|,
name|m
operator|->
name|m_pkthdr
operator|.
name|len
argument_list|,
name|t
operator|->
name|plaintext
argument_list|,
name|t
operator|->
name|plaintext_len
argument_list|)
expr_stmt|;
goto|goto
name|bad
goto|;
block|}
elseif|else
if|if
condition|(
name|memcmp
argument_list|(
name|mtod
argument_list|(
name|m
argument_list|,
specifier|const
name|void
operator|*
argument_list|)
argument_list|,
name|t
operator|->
name|plaintext
argument_list|,
name|t
operator|->
name|plaintext_len
argument_list|)
condition|)
block|{
name|printf
argument_list|(
literal|"FAIL: decap botch; data does not compare\n"
argument_list|)
expr_stmt|;
name|printtest
argument_list|(
name|t
argument_list|)
expr_stmt|;
name|cmpfail
argument_list|(
name|mtod
argument_list|(
name|m
argument_list|,
specifier|const
name|void
operator|*
argument_list|)
argument_list|,
name|m
operator|->
name|m_pkthdr
operator|.
name|len
argument_list|,
name|t
operator|->
name|plaintext
argument_list|,
name|t_plaintext_len
argument_list|)
expr_stmt|;
goto|goto
name|bad
goto|;
block|}
name|m_freem
argument_list|(
name|m
argument_list|)
expr_stmt|;
name|ieee80211_crypto_delkey
argument_list|(
name|ic
argument_list|,
operator|&
name|key
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"PASS\n"
argument_list|)
expr_stmt|;
return|return
literal|1
return|;
name|bad
label|:
if|if
condition|(
name|m
operator|!=
name|NULL
condition|)
name|m_freem
argument_list|(
name|m
argument_list|)
expr_stmt|;
name|ieee80211_crypto_delkey
argument_list|(
name|ic
argument_list|,
operator|&
name|key
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_comment
comment|/*  * Module glue.  */
end_comment

begin_decl_stmt
specifier|static
name|int
name|tests
init|=
operator|-
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|static
name|int
name|debug
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|int
name|init_crypto_ccmp_test
parameter_list|(
name|void
parameter_list|)
block|{
define|#
directive|define
name|N
parameter_list|(
name|a
parameter_list|)
value|(sizeof(a)/sizeof(a[0]))
name|struct
name|ieee80211com
name|ic
decl_stmt|;
name|int
name|i
decl_stmt|,
name|pass
decl_stmt|,
name|total
decl_stmt|;
name|memset
argument_list|(
operator|&
name|ic
argument_list|,
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|ic
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|debug
condition|)
name|ic
operator|.
name|ic_debug
operator|=
name|IEEE80211_MSG_CRYPTO
expr_stmt|;
name|ieee80211_crypto_attach
argument_list|(
operator|&
name|ic
argument_list|)
expr_stmt|;
name|pass
operator|=
literal|0
expr_stmt|;
name|total
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|N
argument_list|(
name|ccmptests
argument_list|)
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|tests
operator|&
operator|(
literal|1
operator|<<
name|i
operator|)
condition|)
block|{
name|total
operator|++
expr_stmt|;
name|pass
operator|+=
name|runtest
argument_list|(
operator|&
name|ic
argument_list|,
operator|&
name|ccmptests
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
name|printf
argument_list|(
literal|"%u of %u 802.11i AES-CCMP test vectors passed\n"
argument_list|,
name|pass
argument_list|,
name|total
argument_list|)
expr_stmt|;
name|ieee80211_crypto_detach
argument_list|(
operator|&
name|ic
argument_list|)
expr_stmt|;
return|return
operator|(
name|pass
operator|==
name|total
condition|?
literal|0
else|:
operator|-
literal|1
operator|)
return|;
undef|#
directive|undef
name|N
block|}
end_function

begin_function
specifier|static
name|int
name|test_ccmp_modevent
parameter_list|(
name|module_t
name|mod
parameter_list|,
name|int
name|type
parameter_list|,
name|void
modifier|*
name|unused
parameter_list|)
block|{
switch|switch
condition|(
name|type
condition|)
block|{
case|case
name|MOD_LOAD
case|:
operator|(
name|void
operator|)
name|init_crypto_ccmp_test
argument_list|()
expr_stmt|;
return|return
literal|0
return|;
case|case
name|MOD_UNLOAD
case|:
return|return
literal|0
return|;
block|}
return|return
name|EINVAL
return|;
block|}
end_function

begin_decl_stmt
specifier|static
name|moduledata_t
name|test_ccmp_mod
init|=
block|{
literal|"test_ccmp"
block|,
name|test_ccmp_modevent
block|,
literal|0
block|}
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|DECLARE_MODULE
argument_list|(
name|test_ccmp
argument_list|,
name|test_ccmp_mod
argument_list|,
name|SI_SUB_DRIVERS
argument_list|,
name|SI_ORDER_FIRST
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|MODULE_VERSION
argument_list|(
name|test_ccmp
argument_list|,
literal|1
argument_list|)
expr_stmt|;
end_expr_stmt

begin_expr_stmt
name|MODULE_DEPEND
argument_list|(
name|test_ccmp
argument_list|,
name|wlan
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
end_expr_stmt

end_unit

