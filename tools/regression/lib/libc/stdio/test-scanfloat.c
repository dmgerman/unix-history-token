begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*-  * Copyright (C) 2003, 2005 David Schultz<das@FreeBSD.org>  * All rights reserved.  *  * Redistribution and use in source and binary forms, with or without  * modification, are permitted provided that the following conditions  * are met:  * 1. Redistributions of source code must retain the above copyright  *    notice, this list of conditions and the following disclaimer.  * 2. Redistributions in binary form must reproduce the above copyright  *    notice, this list of conditions and the following disclaimer in the  *    documentation and/or other materials provided with the distribution.  *  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND  * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE  * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE  * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL  * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS  * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT  * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY  * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF  * SUCH DAMAGE.  */
end_comment

begin_comment
comment|/*  * Test for scanf() floating point formats.  */
end_comment

begin_include
include|#
directive|include
file|<sys/cdefs.h>
end_include

begin_expr_stmt
name|__FBSDID
argument_list|(
literal|"$FreeBSD$"
argument_list|)
expr_stmt|;
end_expr_stmt

begin_include
include|#
directive|include
file|<assert.h>
end_include

begin_include
include|#
directive|include
file|<fenv.h>
end_include

begin_include
include|#
directive|include
file|<float.h>
end_include

begin_include
include|#
directive|include
file|<locale.h>
end_include

begin_include
include|#
directive|include
file|<math.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_define
define|#
directive|define
name|eq
parameter_list|(
name|type
parameter_list|,
name|a
parameter_list|,
name|b
parameter_list|)
value|_eq(type##_EPSILON, (a), (b))
end_define

begin_function_decl
specifier|static
name|int
name|_eq
parameter_list|(
name|long
name|double
name|epsilon
parameter_list|,
name|long
name|double
name|a
parameter_list|,
name|long
name|double
name|b
parameter_list|)
function_decl|;
end_function_decl

begin_decl_stmt
specifier|extern
name|int
name|__scanfdebug
decl_stmt|;
end_decl_stmt

begin_function
name|int
name|main
parameter_list|(
name|int
name|argc
parameter_list|,
name|char
modifier|*
name|argv
index|[]
parameter_list|)
block|{
name|char
name|buf
index|[
literal|128
index|]
decl_stmt|;
name|long
name|double
name|ld
init|=
literal|0.0
decl_stmt|;
name|double
name|d
init|=
literal|0.0
decl_stmt|;
name|float
name|f
init|=
literal|0.0
decl_stmt|;
name|printf
argument_list|(
literal|"1..3\n"
argument_list|)
expr_stmt|;
name|buf
index|[
literal|0
index|]
operator|=
literal|'\0'
expr_stmt|;
name|assert
argument_list|(
name|setlocale
argument_list|(
name|LC_NUMERIC
argument_list|,
literal|""
argument_list|)
argument_list|)
expr_stmt|;
name|__scanfdebug
operator|=
literal|1
expr_stmt|;
comment|/* 	 * Various tests for normalized numbers 	 */
name|sscanf
argument_list|(
literal|"3.141592"
argument_list|,
literal|"%e"
argument_list|,
operator|&
name|f
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|eq
argument_list|(
name|FLT
argument_list|,
name|f
argument_list|,
literal|3.141592
argument_list|)
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"3.141592653589793"
argument_list|,
literal|"%lf"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|eq
argument_list|(
name|DBL
argument_list|,
name|d
argument_list|,
literal|3.141592653589793
argument_list|)
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"1.234568e+06"
argument_list|,
literal|"%E"
argument_list|,
operator|&
name|f
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|eq
argument_list|(
name|FLT
argument_list|,
name|f
argument_list|,
literal|1.234568e+06
argument_list|)
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"-1.234568e6"
argument_list|,
literal|"%lF"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|eq
argument_list|(
name|DBL
argument_list|,
name|d
argument_list|,
operator|-
literal|1.234568e6
argument_list|)
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"+1.234568e-52"
argument_list|,
literal|"%LG"
argument_list|,
operator|&
name|ld
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|eq
argument_list|(
name|LDBL
argument_list|,
name|ld
argument_list|,
literal|1.234568e-52L
argument_list|)
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"0.1"
argument_list|,
literal|"%la"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|eq
argument_list|(
name|DBL
argument_list|,
name|d
argument_list|,
literal|0.1
argument_list|)
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"00.2"
argument_list|,
literal|"%lA"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|eq
argument_list|(
name|DBL
argument_list|,
name|d
argument_list|,
literal|0.2
argument_list|)
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"123456"
argument_list|,
literal|"%5le%s"
argument_list|,
operator|&
name|d
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|eq
argument_list|(
name|DBL
argument_list|,
name|d
argument_list|,
literal|12345.
argument_list|)
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|strcmp
argument_list|(
name|buf
argument_list|,
literal|"6"
argument_list|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"1.0Q"
argument_list|,
literal|"%*5le%s"
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|strcmp
argument_list|(
name|buf
argument_list|,
literal|"Q"
argument_list|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"-1.23e"
argument_list|,
literal|"%e%s"
argument_list|,
operator|&
name|f
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|eq
argument_list|(
name|FLT
argument_list|,
name|f
argument_list|,
operator|-
literal|1.23
argument_list|)
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|strcmp
argument_list|(
name|buf
argument_list|,
literal|"e"
argument_list|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"1.25e+"
argument_list|,
literal|"%le%s"
argument_list|,
operator|&
name|d
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|eq
argument_list|(
name|DBL
argument_list|,
name|d
argument_list|,
literal|1.25
argument_list|)
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|strcmp
argument_list|(
name|buf
argument_list|,
literal|"e+"
argument_list|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"1.23E4E5"
argument_list|,
literal|"%le%s"
argument_list|,
operator|&
name|d
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|eq
argument_list|(
name|DBL
argument_list|,
name|d
argument_list|,
literal|1.23e4
argument_list|)
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|strcmp
argument_list|(
name|buf
argument_list|,
literal|"E5"
argument_list|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"12e6"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|eq
argument_list|(
name|DBL
argument_list|,
name|d
argument_list|,
literal|12e6
argument_list|)
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"1.a"
argument_list|,
literal|"%le%s"
argument_list|,
operator|&
name|d
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|eq
argument_list|(
name|DBL
argument_list|,
name|d
argument_list|,
literal|1.0
argument_list|)
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|strcmp
argument_list|(
name|buf
argument_list|,
literal|"a"
argument_list|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|".0p4"
argument_list|,
literal|"%le%s"
argument_list|,
operator|&
name|d
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|eq
argument_list|(
name|DBL
argument_list|,
name|d
argument_list|,
literal|0.0
argument_list|)
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|strcmp
argument_list|(
name|buf
argument_list|,
literal|"p4"
argument_list|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|d
operator|=
literal|0.25
expr_stmt|;
name|assert
argument_list|(
name|sscanf
argument_list|(
literal|"."
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0.25
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"0x08"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0x8p0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"0x90a.bcdefP+09a"
argument_list|,
literal|"%le%s"
argument_list|,
operator|&
name|d
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0x90a
operator|.
name|bcdefp
operator|+
literal|09
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|strcmp
argument_list|(
name|buf
argument_list|,
literal|"a"
argument_list|)
operator|==
literal|0
argument_list|)
expr_stmt|;
if|#
directive|if
operator|(
name|LDBL_MANT_DIG
operator|>
name|DBL_MANT_DIG
operator|)
operator|&&
operator|!
name|defined
argument_list|(
name|__i386__
argument_list|)
name|sscanf
argument_list|(
literal|"3.14159265358979323846"
argument_list|,
literal|"%Lg"
argument_list|,
operator|&
name|ld
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|eq
argument_list|(
name|LDBL
argument_list|,
name|ld
argument_list|,
literal|3.14159265358979323846L
argument_list|)
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"  0X.0123456789abcdefffp-3g"
argument_list|,
literal|"%Le%s"
argument_list|,
operator|&
name|ld
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|ld
operator|==
literal|0x0
literal|.0123456789abcdefffp
operator|-
literal|3L
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|strcmp
argument_list|(
name|buf
argument_list|,
literal|"g"
argument_list|)
operator|==
literal|0
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|sscanf
argument_list|(
literal|"0xg"
argument_list|,
literal|"%le%s"
argument_list|,
operator|&
name|d
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0.0
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|strcmp
argument_list|(
name|buf
argument_list|,
literal|"xg"
argument_list|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|setlocale
argument_list|(
name|LC_NUMERIC
argument_list|,
literal|"ru_RU.ISO8859-5"
argument_list|)
argument_list|)
expr_stmt|;
comment|/* decimalpoint==, */
name|sscanf
argument_list|(
literal|"1.23"
argument_list|,
literal|"%le%s"
argument_list|,
operator|&
name|d
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|1.0
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|strcmp
argument_list|(
name|buf
argument_list|,
literal|".23"
argument_list|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"1,23"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|1.23
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|setlocale
argument_list|(
name|LC_NUMERIC
argument_list|,
literal|""
argument_list|)
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"ok 1 - scanfloat\n"
argument_list|)
expr_stmt|;
comment|/* 	 * Infinity and NaN tests 	 */
name|sscanf
argument_list|(
literal|"-Inf"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|<
literal|0.0
operator|&&
name|isinf
argument_list|(
name|d
argument_list|)
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"iNfInItY and beyond"
argument_list|,
literal|"%le%s"
argument_list|,
operator|&
name|d
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|>
literal|0.0
operator|&&
name|isinf
argument_list|(
name|d
argument_list|)
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|strcmp
argument_list|(
name|buf
argument_list|,
literal|" and beyond"
argument_list|)
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"NaN"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|isnan
argument_list|(
name|d
argument_list|)
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"NAN(123Y"
argument_list|,
literal|"%le%s"
argument_list|,
operator|&
name|d
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|isnan
argument_list|(
name|d
argument_list|)
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|strcmp
argument_list|(
name|buf
argument_list|,
literal|"(123Y"
argument_list|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"nan(f00f)plugh"
argument_list|,
literal|"%le%s"
argument_list|,
operator|&
name|d
argument_list|,
name|buf
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|isnan
argument_list|(
name|d
argument_list|)
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|strcmp
argument_list|(
name|buf
argument_list|,
literal|"plugh"
argument_list|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"-nan"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|isnan
argument_list|(
name|d
argument_list|)
argument_list|)
expr_stmt|;
comment|/* Only quiet NaNs should be returned. */
name|sscanf
argument_list|(
literal|"NaN"
argument_list|,
literal|"%e"
argument_list|,
operator|&
name|f
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"nan"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"nan"
argument_list|,
literal|"%Le"
argument_list|,
operator|&
name|ld
argument_list|)
expr_stmt|;
name|feclearexcept
argument_list|(
name|FE_ALL_EXCEPT
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|f
operator|!=
name|f
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|!=
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|ld
operator|!=
name|ld
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|fetestexcept
argument_list|(
name|FE_INVALID
argument_list|)
operator|==
literal|0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"nan(1234)"
argument_list|,
literal|"%e"
argument_list|,
operator|&
name|f
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"nan(1234)"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"nan(1234)"
argument_list|,
literal|"%Le"
argument_list|,
operator|&
name|ld
argument_list|)
expr_stmt|;
name|feclearexcept
argument_list|(
name|FE_ALL_EXCEPT
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|f
operator|!=
name|f
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|!=
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|ld
operator|!=
name|ld
argument_list|)
expr_stmt|;
if|#
directive|if
literal|0
comment|/* 	 * POSIX says we should only generate quiet NaNs, but the gdtoa 	 * author convincingly argues that if you ask for a NaN format 	 * based on some implementation-defined string, you should get 	 * what you asked for, even if it's a signaling NaN. 	 */
block|assert(fetestexcept(FE_INVALID) == 0);
endif|#
directive|endif
name|printf
argument_list|(
literal|"ok 2 - scanfloat\n"
argument_list|)
expr_stmt|;
comment|/* 	 * Rounding tests 	 */
name|fesetround
argument_list|(
name|FE_DOWNWARD
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"1.999999999999999999999999999999999"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|<
literal|2.0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"0x1.ffffffffffffffp0"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|<
literal|2.0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"1.999999999999999999999999999999999"
argument_list|,
literal|"%Le"
argument_list|,
operator|&
name|ld
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|ld
operator|<
literal|2.0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"1.0571892669084007"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0x1
literal|.0ea3f4af0dc59p0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"-1.0571892669084007"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
operator|-
literal|0x1
literal|.0ea3f4af0dc5ap0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"1.0571892669084010"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0x1
literal|.0ea3f4af0dc5ap0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"0x1.23p-5000"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0.0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"0x1.2345678p-1050"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0x1
literal|.234567p
operator|-
literal|1050
argument_list|)
expr_stmt|;
name|fesetround
argument_list|(
name|FE_UPWARD
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"1.0571892669084007"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0x1
literal|.0ea3f4af0dc5ap0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"-1.0571892669084007"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
operator|-
literal|0x1
literal|.0ea3f4af0dc59p0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"1.0571892669084010"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0x1
literal|.0ea3f4af0dc5bp0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"0x1.23p-5000"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0x1p
operator|-
literal|1074
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"0x1.2345678p-1050"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0x1
literal|.234568p
operator|-
literal|1050
argument_list|)
expr_stmt|;
name|fesetround
argument_list|(
name|FE_TOWARDZERO
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"1.0571892669084007"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0x1
literal|.0ea3f4af0dc59p0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"-1.0571892669084007"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
operator|-
literal|0x1
literal|.0ea3f4af0dc59p0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"1.0571892669084010"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0x1
literal|.0ea3f4af0dc5ap0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"0x1.23p-5000"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0.0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"0x1.2345678p-1050"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0x1
literal|.234567p
operator|-
literal|1050
argument_list|)
expr_stmt|;
name|fesetround
argument_list|(
name|FE_TONEAREST
argument_list|)
expr_stmt|;
comment|/* 1.0571892669084007 is slightly closer to 0x1.0ea3f4af0dc59p0 */
name|sscanf
argument_list|(
literal|"1.0571892669084007"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0x1
literal|.0ea3f4af0dc59p0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"-1.0571892669084007"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
operator|-
literal|0x1
literal|.0ea3f4af0dc59p0
argument_list|)
expr_stmt|;
name|sscanf
argument_list|(
literal|"1.0571892669084010"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0x1
literal|.0ea3f4af0dc5bp0
argument_list|)
expr_stmt|;
comment|/* strtod() should round small numbers to 0. */
name|sscanf
argument_list|(
literal|"0x1.23p-5000"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0.0
argument_list|)
expr_stmt|;
comment|/* Extra digits in a denormal shouldn't break anything. */
name|sscanf
argument_list|(
literal|"0x1.2345678p-1050"
argument_list|,
literal|"%le"
argument_list|,
operator|&
name|d
argument_list|)
expr_stmt|;
name|assert
argument_list|(
name|d
operator|==
literal|0x1
literal|.234568p
operator|-
literal|1050
argument_list|)
expr_stmt|;
name|printf
argument_list|(
literal|"ok 3 - scanfloat\n"
argument_list|)
expr_stmt|;
return|return
operator|(
literal|0
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
name|_eq
parameter_list|(
name|long
name|double
name|epsilon
parameter_list|,
name|long
name|double
name|a
parameter_list|,
name|long
name|double
name|b
parameter_list|)
block|{
name|long
name|double
name|delta
decl_stmt|;
name|delta
operator|=
name|a
operator|-
name|b
expr_stmt|;
if|if
condition|(
name|delta
operator|<
literal|0
condition|)
comment|/* XXX no fabsl() */
name|delta
operator|=
operator|-
name|delta
expr_stmt|;
return|return
operator|(
name|delta
operator|<=
name|epsilon
operator|)
return|;
block|}
end_function

end_unit

