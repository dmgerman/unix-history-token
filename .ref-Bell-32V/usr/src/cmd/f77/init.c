begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_include
include|#
directive|include
file|"defs"
end_include

begin_decl_stmt
name|FILEP
name|infile
init|=
block|{
name|stdin
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|FILEP
name|diagfile
init|=
block|{
name|stderr
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|FILEP
name|textfile
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|FILEP
name|asmfile
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|FILEP
name|initfile
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|long
name|int
name|headoffset
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
name|token
index|[
literal|100
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|toklen
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|lineno
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|infname
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|needkwd
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|labelblock
modifier|*
name|thislabel
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|nowarnflag
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|ftn66flag
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|profileflag
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|optimflag
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|shiftcase
init|=
name|YES
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|undeftype
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|shortsubs
init|=
name|YES
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|onetripflag
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|checksubs
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|debugflag
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nerr
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nwarn
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|ndata
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|saveall
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|substars
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|parstate
init|=
name|OUTSIDE
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|headerdone
init|=
name|NO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|blklevel
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|impltype
index|[
literal|26
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|implleng
index|[
literal|26
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|implstg
index|[
literal|26
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|tyint
init|=
name|TYLONG
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|tylogical
init|=
name|TYLONG
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|ftnint
name|typesize
index|[
name|NTYPES
index|]
init|=
block|{
literal|1
block|,
name|SZADDR
block|,
name|SZSHORT
block|,
name|SZLONG
block|,
name|SZLONG
block|,
literal|2
operator|*
name|SZLONG
block|,
literal|2
operator|*
name|SZLONG
block|,
literal|4
operator|*
name|SZLONG
block|,
name|SZLONG
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|typealign
index|[
name|NTYPES
index|]
init|=
block|{
literal|1
block|,
name|ALIADDR
block|,
name|ALISHORT
block|,
name|ALILONG
block|,
name|ALILONG
block|,
name|ALIDOUBLE
block|,
name|ALILONG
block|,
name|ALIDOUBLE
block|,
name|ALILONG
block|,
literal|1
block|,
literal|1
block|,
literal|1
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|procno
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|proctype
init|=
name|TYUNKNOWN
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|char
modifier|*
name|procname
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|rtvlabel
index|[
name|NTYPES
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|fudgelabel
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|addrblock
modifier|*
name|typeaddr
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|addrblock
modifier|*
name|retslot
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|cxslot
init|=
operator|-
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|chslot
init|=
operator|-
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|chlgslot
init|=
operator|-
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|procclass
init|=
name|CLUNKNOWN
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nentry
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|multitype
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|ftnint
name|procleng
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|lastlabno
init|=
literal|10
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|lastvarno
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|lastargslot
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|argloc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|ftnint
name|autoleng
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|ftnint
name|bssleng
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|retlabel
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|ret0label
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|ctlframe
name|ctls
index|[
name|MAXCTL
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|ctlframe
modifier|*
name|ctlstack
init|=
name|ctls
operator|-
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|ctlframe
modifier|*
name|lastctl
init|=
name|ctls
operator|+
name|MAXCTL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|nameblock
modifier|*
name|regnamep
index|[
name|MAXREGVAR
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|highregvar
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nregvar
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|extsym
name|extsymtab
index|[
name|MAXEXT
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|extsym
modifier|*
name|nextext
init|=
name|extsymtab
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|extsym
modifier|*
name|lastext
init|=
name|extsymtab
operator|+
name|MAXEXT
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|equivblock
name|eqvclass
index|[
name|MAXEQUIV
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|hashentry
name|hashtab
index|[
name|MAXHASH
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|hashentry
modifier|*
name|lasthash
init|=
name|hashtab
operator|+
name|MAXHASH
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|labelblock
name|labeltab
index|[
name|MAXSTNO
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|labelblock
modifier|*
name|labtabend
init|=
name|labeltab
operator|+
name|MAXSTNO
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|labelblock
modifier|*
name|highlabtab
init|=
name|labeltab
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|rplblock
modifier|*
name|rpllist
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|chainp
name|curdtp
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|toomanyinit
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|ftnint
name|curdtelt
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|chainp
name|templist
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|chainp
name|holdtemps
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|dorange
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|entrypoint
modifier|*
name|entries
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|chainp
name|chains
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|flag
name|inioctl
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|addrblock
modifier|*
name|ioblkp
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|iostmt
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nioctl
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nequiv
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nintnames
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nextnames
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|struct
name|literal
name|litpool
index|[
name|MAXLITERALS
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|nliterals
decl_stmt|;
end_decl_stmt

begin_macro
name|fileinit
argument_list|()
end_macro

begin_block
block|{
name|procno
operator|=
literal|0
expr_stmt|;
name|lastlabno
operator|=
literal|10
expr_stmt|;
name|lastvarno
operator|=
literal|0
expr_stmt|;
name|nextext
operator|=
name|extsymtab
expr_stmt|;
name|nliterals
operator|=
literal|0
expr_stmt|;
name|nerr
operator|=
literal|0
expr_stmt|;
name|ndata
operator|=
literal|0
expr_stmt|;
block|}
end_block

begin_macro
name|procinit
argument_list|()
end_macro

begin_block
block|{
specifier|register
name|struct
name|nameblock
modifier|*
name|p
decl_stmt|;
specifier|register
name|struct
name|dimblock
modifier|*
name|q
decl_stmt|;
specifier|register
name|struct
name|hashentry
modifier|*
name|hp
decl_stmt|;
specifier|register
name|struct
name|labelblock
modifier|*
name|lp
decl_stmt|;
name|chainp
name|cp
decl_stmt|;
name|int
name|i
decl_stmt|;
name|pruse
argument_list|(
name|asmfile
argument_list|,
name|USECONST
argument_list|)
expr_stmt|;
if|#
directive|if
name|FAMILY
operator|==
name|SCJ
name|p2pass
argument_list|(
name|USETEXT
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|parstate
operator|=
name|OUTSIDE
expr_stmt|;
name|headerdone
operator|=
name|NO
expr_stmt|;
name|blklevel
operator|=
literal|1
expr_stmt|;
name|saveall
operator|=
name|NO
expr_stmt|;
name|substars
operator|=
name|NO
expr_stmt|;
name|nwarn
operator|=
literal|0
expr_stmt|;
name|thislabel
operator|=
name|NULL
expr_stmt|;
name|needkwd
operator|=
literal|0
expr_stmt|;
operator|++
name|procno
expr_stmt|;
name|proctype
operator|=
name|TYUNKNOWN
expr_stmt|;
name|procname
operator|=
literal|"MAIN_    "
expr_stmt|;
name|procclass
operator|=
name|CLUNKNOWN
expr_stmt|;
name|nentry
operator|=
literal|0
expr_stmt|;
name|multitype
operator|=
name|NO
expr_stmt|;
name|typeaddr
operator|=
name|NULL
expr_stmt|;
name|retslot
operator|=
name|NULL
expr_stmt|;
name|cxslot
operator|=
operator|-
literal|1
expr_stmt|;
name|chslot
operator|=
operator|-
literal|1
expr_stmt|;
name|chlgslot
operator|=
operator|-
literal|1
expr_stmt|;
name|procleng
operator|=
literal|0
expr_stmt|;
name|blklevel
operator|=
literal|1
expr_stmt|;
name|lastargslot
operator|=
literal|0
expr_stmt|;
if|#
directive|if
name|TARGET
operator|==
name|PDP11
name|autoleng
operator|=
literal|6
expr_stmt|;
else|#
directive|else
name|autoleng
operator|=
literal|0
expr_stmt|;
endif|#
directive|endif
for|for
control|(
name|lp
operator|=
name|labeltab
init|;
name|lp
operator|<
name|labtabend
condition|;
operator|++
name|lp
control|)
name|lp
operator|->
name|stateno
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|hp
operator|=
name|hashtab
init|;
name|hp
operator|<
name|lasthash
condition|;
operator|++
name|hp
control|)
if|if
condition|(
name|p
operator|=
name|hp
operator|->
name|varp
condition|)
block|{
name|frexpr
argument_list|(
name|p
operator|->
name|vleng
argument_list|)
expr_stmt|;
if|if
condition|(
name|q
operator|=
name|p
operator|->
name|vdim
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|q
operator|->
name|ndim
condition|;
operator|++
name|i
control|)
block|{
name|frexpr
argument_list|(
name|q
operator|->
name|dims
index|[
name|i
index|]
operator|.
name|dimsize
argument_list|)
expr_stmt|;
name|frexpr
argument_list|(
name|q
operator|->
name|dims
index|[
name|i
index|]
operator|.
name|dimexpr
argument_list|)
expr_stmt|;
block|}
name|frexpr
argument_list|(
name|q
operator|->
name|nelt
argument_list|)
expr_stmt|;
name|frexpr
argument_list|(
name|q
operator|->
name|baseoffset
argument_list|)
expr_stmt|;
name|frexpr
argument_list|(
name|q
operator|->
name|basexpr
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|q
argument_list|)
expr_stmt|;
block|}
name|free
argument_list|(
name|p
argument_list|)
expr_stmt|;
name|hp
operator|->
name|varp
operator|=
name|NULL
expr_stmt|;
block|}
name|nintnames
operator|=
literal|0
expr_stmt|;
name|highlabtab
operator|=
name|labeltab
expr_stmt|;
name|ctlstack
operator|=
name|ctls
operator|-
literal|1
expr_stmt|;
for|for
control|(
name|cp
operator|=
name|templist
init|;
name|cp
condition|;
name|cp
operator|=
name|cp
operator|->
name|nextp
control|)
name|free
argument_list|(
name|cp
operator|->
name|datap
argument_list|)
expr_stmt|;
name|frchain
argument_list|(
operator|&
name|templist
argument_list|)
expr_stmt|;
name|holdtemps
operator|=
name|NULL
expr_stmt|;
name|dorange
operator|=
literal|0
expr_stmt|;
name|nregvar
operator|=
literal|0
expr_stmt|;
name|highregvar
operator|=
literal|0
expr_stmt|;
name|entries
operator|=
name|NULL
expr_stmt|;
name|rpllist
operator|=
name|NULL
expr_stmt|;
name|inioctl
operator|=
name|NO
expr_stmt|;
name|ioblkp
operator|=
name|NULL
expr_stmt|;
name|nequiv
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|NTYPES
condition|;
operator|++
name|i
control|)
name|rtvlabel
index|[
name|i
index|]
operator|=
literal|0
expr_stmt|;
name|fudgelabel
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|undeftype
condition|)
name|setimpl
argument_list|(
name|TYUNKNOWN
argument_list|,
operator|(
name|ftnint
operator|)
literal|0
argument_list|,
literal|'a'
argument_list|,
literal|'z'
argument_list|)
expr_stmt|;
else|else
block|{
name|setimpl
argument_list|(
name|TYREAL
argument_list|,
operator|(
name|ftnint
operator|)
literal|0
argument_list|,
literal|'a'
argument_list|,
literal|'z'
argument_list|)
expr_stmt|;
name|setimpl
argument_list|(
name|tyint
argument_list|,
operator|(
name|ftnint
operator|)
literal|0
argument_list|,
literal|'i'
argument_list|,
literal|'n'
argument_list|)
expr_stmt|;
block|}
name|setimpl
argument_list|(
operator|-
name|STGBSS
argument_list|,
operator|(
name|ftnint
operator|)
literal|0
argument_list|,
literal|'a'
argument_list|,
literal|'z'
argument_list|)
expr_stmt|;
comment|/* set class */
name|setlog
argument_list|()
expr_stmt|;
block|}
end_block

begin_macro
name|setimpl
argument_list|(
argument|type
argument_list|,
argument|length
argument_list|,
argument|c1
argument_list|,
argument|c2
argument_list|)
end_macro

begin_decl_stmt
name|int
name|type
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|ftnint
name|length
decl_stmt|;
end_decl_stmt

begin_decl_stmt
name|int
name|c1
decl_stmt|,
name|c2
decl_stmt|;
end_decl_stmt

begin_block
block|{
name|int
name|i
decl_stmt|;
name|char
name|buff
index|[
literal|100
index|]
decl_stmt|;
if|if
condition|(
name|c1
operator|==
literal|0
operator|||
name|c2
operator|==
literal|0
condition|)
return|return;
if|if
condition|(
name|c1
operator|>
name|c2
condition|)
name|err
argument_list|(
name|sprintf
argument_list|(
name|buff
argument_list|,
literal|"characters out of order in implicit:%c-%c"
argument_list|,
name|c1
argument_list|,
name|c2
argument_list|)
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|type
operator|<
literal|0
condition|)
for|for
control|(
name|i
operator|=
name|c1
init|;
name|i
operator|<=
name|c2
condition|;
operator|++
name|i
control|)
name|implstg
index|[
name|i
operator|-
literal|'a'
index|]
operator|=
operator|-
name|type
expr_stmt|;
else|else
block|{
name|type
operator|=
name|lengtype
argument_list|(
name|type
argument_list|,
operator|(
name|int
operator|)
name|length
argument_list|)
expr_stmt|;
if|if
condition|(
name|type
operator|!=
name|TYCHAR
condition|)
name|length
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|i
operator|=
name|c1
init|;
name|i
operator|<=
name|c2
condition|;
operator|++
name|i
control|)
block|{
name|impltype
index|[
name|i
operator|-
literal|'a'
index|]
operator|=
name|type
expr_stmt|;
name|implleng
index|[
name|i
operator|-
literal|'a'
index|]
operator|=
name|length
expr_stmt|;
block|}
block|}
block|}
end_block

end_unit

