begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* Assembler interface for targets using CGEN. -*- C -*-    CGEN: Cpu tools GENerator     THIS FILE IS MACHINE GENERATED WITH CGEN.    - the resultant file is machine generated, cgen-asm.in isn't     Copyright 1996, 1997, 1998, 1999, 2000, 2001, 2005    Free Software Foundation, Inc.     This file is part of the GNU Binutils and GDB, the GNU debugger.     This program is free software; you can redistribute it and/or modify    it under the terms of the GNU General Public License as published by    the Free Software Foundation; either version 2, or (at your option)    any later version.     This program is distributed in the hope that it will be useful,    but WITHOUT ANY WARRANTY; without even the implied warranty of    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    GNU General Public License for more details.     You should have received a copy of the GNU General Public License    along with this program; if not, write to the Free Software Foundation, Inc.,    51 Franklin Street - Fifth Floor, Boston, MA 02110-1301, USA.  */
end_comment

begin_comment
comment|/* ??? Eventually more and more of this stuff can go to cpu-independent files.    Keep that in mind.  */
end_comment

begin_include
include|#
directive|include
file|"sysdep.h"
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|"ansidecl.h"
end_include

begin_include
include|#
directive|include
file|"bfd.h"
end_include

begin_include
include|#
directive|include
file|"symcat.h"
end_include

begin_include
include|#
directive|include
file|"frv-desc.h"
end_include

begin_include
include|#
directive|include
file|"frv-opc.h"
end_include

begin_include
include|#
directive|include
file|"opintl.h"
end_include

begin_include
include|#
directive|include
file|"xregex.h"
end_include

begin_include
include|#
directive|include
file|"libiberty.h"
end_include

begin_include
include|#
directive|include
file|"safe-ctype.h"
end_include

begin_undef
undef|#
directive|undef
name|min
end_undef

begin_define
define|#
directive|define
name|min
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|((a)< (b) ? (a) : (b))
end_define

begin_undef
undef|#
directive|undef
name|max
end_undef

begin_define
define|#
directive|define
name|max
parameter_list|(
name|a
parameter_list|,
name|b
parameter_list|)
value|((a)> (b) ? (a) : (b))
end_define

begin_function_decl
specifier|static
specifier|const
name|char
modifier|*
name|parse_insn_normal
parameter_list|(
name|CGEN_CPU_DESC
parameter_list|,
specifier|const
name|CGEN_INSN
modifier|*
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
parameter_list|,
name|CGEN_FIELDS
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_escape
end_escape

begin_comment
comment|/* -- assembler routines inserted here.  */
end_comment

begin_comment
comment|/* -- asm.c */
end_comment

begin_function
specifier|inline
specifier|static
specifier|const
name|char
modifier|*
name|parse_symbolic_address
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|,
name|int
name|opindex
parameter_list|,
name|int
name|opinfo
parameter_list|,
name|enum
name|cgen_parse_operand_result
modifier|*
name|resultp
parameter_list|,
name|bfd_vma
modifier|*
name|valuep
parameter_list|)
block|{
name|enum
name|cgen_parse_operand_result
name|result_type
decl_stmt|;
specifier|const
name|char
modifier|*
name|errmsg
init|=
call|(
modifier|*
name|cd
operator|->
name|parse_operand_fn
call|)
argument_list|(
name|cd
argument_list|,
name|CGEN_PARSE_OPERAND_SYMBOLIC
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|opinfo
argument_list|,
operator|&
name|result_type
argument_list|,
name|valuep
argument_list|)
decl_stmt|;
if|if
condition|(
name|errmsg
operator|==
name|NULL
operator|&&
name|result_type
operator|!=
name|CGEN_PARSE_OPERAND_RESULT_QUEUED
condition|)
return|return
literal|"symbolic expression required"
return|;
if|if
condition|(
name|resultp
condition|)
operator|*
name|resultp
operator|=
name|result_type
expr_stmt|;
return|return
name|errmsg
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|parse_ldd_annotation
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|,
name|int
name|opindex
parameter_list|,
name|unsigned
name|long
modifier|*
name|valuep
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|errmsg
decl_stmt|;
name|enum
name|cgen_parse_operand_result
name|result_type
decl_stmt|;
name|bfd_vma
name|value
decl_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|==
literal|'#'
operator|||
operator|*
operator|*
name|strp
operator|==
literal|'%'
condition|)
block|{
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"tlsdesc("
argument_list|,
literal|8
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|9
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_TLSDESC_RELAX
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
if|if
condition|(
name|valuep
condition|)
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
operator|++
operator|*
name|strp
expr_stmt|;
if|if
condition|(
name|errmsg
condition|)
return|return
name|errmsg
return|;
block|}
block|}
while|while
condition|(
operator|*
operator|*
name|strp
operator|==
literal|' '
operator|||
operator|*
operator|*
name|strp
operator|==
literal|'\t'
condition|)
operator|++
operator|*
name|strp
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|'@'
condition|)
return|return
literal|"missing `@'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
return|return
name|NULL
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|parse_call_annotation
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|,
name|int
name|opindex
parameter_list|,
name|unsigned
name|long
modifier|*
name|valuep
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|errmsg
decl_stmt|;
name|enum
name|cgen_parse_operand_result
name|result_type
decl_stmt|;
name|bfd_vma
name|value
decl_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|==
literal|'#'
operator|||
operator|*
operator|*
name|strp
operator|==
literal|'%'
condition|)
block|{
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gettlsoff("
argument_list|,
literal|10
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|11
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GETTLSOFF_RELAX
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
if|if
condition|(
name|valuep
condition|)
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
operator|++
operator|*
name|strp
expr_stmt|;
if|if
condition|(
name|errmsg
condition|)
return|return
name|errmsg
return|;
block|}
block|}
while|while
condition|(
operator|*
operator|*
name|strp
operator|==
literal|' '
operator|||
operator|*
operator|*
name|strp
operator|==
literal|'\t'
condition|)
operator|++
operator|*
name|strp
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|'@'
condition|)
return|return
literal|"missing `@'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
return|return
name|NULL
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|parse_ld_annotation
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|,
name|int
name|opindex
parameter_list|,
name|unsigned
name|long
modifier|*
name|valuep
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|errmsg
decl_stmt|;
name|enum
name|cgen_parse_operand_result
name|result_type
decl_stmt|;
name|bfd_vma
name|value
decl_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|==
literal|'#'
operator|||
operator|*
operator|*
name|strp
operator|==
literal|'%'
condition|)
block|{
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"tlsoff("
argument_list|,
literal|7
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|8
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_TLSOFF_RELAX
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
if|if
condition|(
name|valuep
condition|)
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
operator|++
operator|*
name|strp
expr_stmt|;
if|if
condition|(
name|errmsg
condition|)
return|return
name|errmsg
return|;
block|}
block|}
while|while
condition|(
operator|*
operator|*
name|strp
operator|==
literal|' '
operator|||
operator|*
operator|*
name|strp
operator|==
literal|'\t'
condition|)
operator|++
operator|*
name|strp
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|'@'
condition|)
return|return
literal|"missing `@'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
return|return
name|NULL
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|parse_ulo16
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|,
name|int
name|opindex
parameter_list|,
name|unsigned
name|long
modifier|*
name|valuep
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|errmsg
decl_stmt|;
name|enum
name|cgen_parse_operand_result
name|result_type
decl_stmt|;
name|bfd_vma
name|value
decl_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|==
literal|'#'
operator|||
operator|*
operator|*
name|strp
operator|==
literal|'%'
condition|)
block|{
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"lo("
argument_list|,
literal|3
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|4
expr_stmt|;
name|errmsg
operator|=
name|cgen_parse_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_LO16
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing `)'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
if|if
condition|(
name|errmsg
operator|==
name|NULL
operator|&&
name|result_type
operator|==
name|CGEN_PARSE_OPERAND_RESULT_NUMBER
condition|)
name|value
operator|&=
literal|0xffff
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gprello("
argument_list|,
literal|8
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|9
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GPRELLO
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gotlo("
argument_list|,
literal|6
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|7
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTLO
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gotfuncdesclo("
argument_list|,
literal|14
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|15
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_FUNCDESC_GOTLO
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gotofflo("
argument_list|,
literal|9
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|10
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTOFFLO
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gotofffuncdesclo("
argument_list|,
literal|17
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|18
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_FUNCDESC_GOTOFFLO
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gottlsdesclo("
argument_list|,
literal|13
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|14
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTTLSDESCLO
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"tlsmofflo("
argument_list|,
literal|10
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|11
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_TLSMOFFLO
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gottlsofflo("
argument_list|,
literal|12
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|13
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTTLSOFFLO
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
block|}
return|return
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|valuep
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|parse_uslo16
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|,
name|int
name|opindex
parameter_list|,
name|signed
name|long
modifier|*
name|valuep
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|errmsg
decl_stmt|;
name|enum
name|cgen_parse_operand_result
name|result_type
decl_stmt|;
name|bfd_vma
name|value
decl_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|==
literal|'#'
operator|||
operator|*
operator|*
name|strp
operator|==
literal|'%'
condition|)
block|{
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"lo("
argument_list|,
literal|3
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|4
expr_stmt|;
name|errmsg
operator|=
name|cgen_parse_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_LO16
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing `)'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
if|if
condition|(
name|errmsg
operator|==
name|NULL
operator|&&
name|result_type
operator|==
name|CGEN_PARSE_OPERAND_RESULT_NUMBER
condition|)
name|value
operator|&=
literal|0xffff
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gprello("
argument_list|,
literal|8
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|9
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GPRELLO
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gotlo("
argument_list|,
literal|6
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|7
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTLO
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gotfuncdesclo("
argument_list|,
literal|14
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|15
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_FUNCDESC_GOTLO
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gotofflo("
argument_list|,
literal|9
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|10
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTOFFLO
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gotofffuncdesclo("
argument_list|,
literal|17
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|18
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_FUNCDESC_GOTOFFLO
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gottlsdesclo("
argument_list|,
literal|13
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|14
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTTLSDESCLO
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"tlsmofflo("
argument_list|,
literal|10
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|11
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_TLSMOFFLO
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gottlsofflo("
argument_list|,
literal|12
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|13
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTTLSOFFLO
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
block|}
return|return
name|cgen_parse_signed_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|valuep
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|parse_uhi16
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|,
name|int
name|opindex
parameter_list|,
name|unsigned
name|long
modifier|*
name|valuep
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|errmsg
decl_stmt|;
name|enum
name|cgen_parse_operand_result
name|result_type
decl_stmt|;
name|bfd_vma
name|value
decl_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|==
literal|'#'
operator|||
operator|*
operator|*
name|strp
operator|==
literal|'%'
condition|)
block|{
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"hi("
argument_list|,
literal|3
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|4
expr_stmt|;
name|errmsg
operator|=
name|cgen_parse_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_HI16
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing `)'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
if|if
condition|(
name|errmsg
operator|==
name|NULL
operator|&&
name|result_type
operator|==
name|CGEN_PARSE_OPERAND_RESULT_NUMBER
condition|)
block|{
comment|/* If bfd_vma is wider than 32 bits, but we have a sign- 		 or zero-extension, truncate it.  */
if|if
condition|(
name|value
operator|>=
operator|-
operator|(
operator|(
name|bfd_vma
operator|)
literal|1
operator|<<
literal|31
operator|)
operator|||
name|value
operator|<=
operator|(
operator|(
name|bfd_vma
operator|)
literal|1
operator|<<
literal|31
operator|)
operator|-
operator|(
name|bfd_vma
operator|)
literal|1
condition|)
name|value
operator|&=
operator|(
operator|(
operator|(
name|bfd_vma
operator|)
literal|1
operator|<<
literal|16
operator|)
operator|<<
literal|16
operator|)
operator|-
literal|1
expr_stmt|;
name|value
operator|>>=
literal|16
expr_stmt|;
block|}
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gprelhi("
argument_list|,
literal|8
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|9
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GPRELHI
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gothi("
argument_list|,
literal|6
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|7
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTHI
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gotfuncdeschi("
argument_list|,
literal|14
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|15
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_FUNCDESC_GOTHI
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gotoffhi("
argument_list|,
literal|9
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|10
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTOFFHI
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gotofffuncdeschi("
argument_list|,
literal|17
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|18
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_FUNCDESC_GOTOFFHI
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gottlsdeschi("
argument_list|,
literal|13
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|14
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTTLSDESCHI
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"tlsmoffhi("
argument_list|,
literal|10
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|11
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_TLSMOFFHI
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gottlsoffhi("
argument_list|,
literal|12
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|13
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTTLSOFFHI
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
block|}
return|return
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|valuep
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|long
name|parse_register_number
parameter_list|(
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|)
block|{
name|int
name|regno
decl_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|<
literal|'0'
operator|||
operator|*
operator|*
name|strp
operator|>
literal|'9'
condition|)
return|return
operator|-
literal|1
return|;
comment|/* error */
name|regno
operator|=
operator|*
operator|*
name|strp
operator|-
literal|'0'
expr_stmt|;
for|for
control|(
operator|++
operator|*
name|strp
init|;
operator|*
operator|*
name|strp
operator|>=
literal|'0'
operator|&&
operator|*
operator|*
name|strp
operator|<=
literal|'9'
condition|;
operator|++
operator|*
name|strp
control|)
name|regno
operator|=
name|regno
operator|*
literal|10
operator|+
operator|(
operator|*
operator|*
name|strp
operator|-
literal|'0'
operator|)
expr_stmt|;
return|return
name|regno
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|parse_spr
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|,
name|CGEN_KEYWORD
modifier|*
name|table
parameter_list|,
name|long
modifier|*
name|valuep
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|save_strp
decl_stmt|;
name|long
name|regno
decl_stmt|;
comment|/* Check for spr index notation.  */
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
argument_list|,
literal|"spr["
argument_list|,
literal|4
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|4
expr_stmt|;
name|regno
operator|=
name|parse_register_number
argument_list|(
name|strp
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|']'
condition|)
return|return
name|_
argument_list|(
literal|"missing `]'"
argument_list|)
return|;
operator|++
operator|*
name|strp
expr_stmt|;
if|if
condition|(
operator|!
name|spr_valid
argument_list|(
name|regno
argument_list|)
condition|)
return|return
name|_
argument_list|(
literal|"Special purpose register number is out of range"
argument_list|)
return|;
operator|*
name|valuep
operator|=
name|regno
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|save_strp
operator|=
operator|*
name|strp
expr_stmt|;
name|regno
operator|=
name|parse_register_number
argument_list|(
name|strp
argument_list|)
expr_stmt|;
if|if
condition|(
name|regno
operator|!=
operator|-
literal|1
condition|)
block|{
if|if
condition|(
operator|!
name|spr_valid
argument_list|(
name|regno
argument_list|)
condition|)
return|return
name|_
argument_list|(
literal|"Special purpose register number is out of range"
argument_list|)
return|;
operator|*
name|valuep
operator|=
name|regno
expr_stmt|;
return|return
name|NULL
return|;
block|}
operator|*
name|strp
operator|=
name|save_strp
expr_stmt|;
return|return
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|table
argument_list|,
name|valuep
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|parse_d12
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|,
name|int
name|opindex
parameter_list|,
name|long
modifier|*
name|valuep
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|errmsg
decl_stmt|;
name|enum
name|cgen_parse_operand_result
name|result_type
decl_stmt|;
name|bfd_vma
name|value
decl_stmt|;
comment|/* Check for small data reference.  */
if|if
condition|(
operator|*
operator|*
name|strp
operator|==
literal|'#'
operator|||
operator|*
operator|*
name|strp
operator|==
literal|'%'
condition|)
block|{
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gprel12("
argument_list|,
literal|8
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|9
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GPREL12
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing `)'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"got12("
argument_list|,
literal|6
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|7
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOT12
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gotfuncdesc12("
argument_list|,
literal|14
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|15
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_FUNCDESC_GOT12
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gotoff12("
argument_list|,
literal|9
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|10
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTOFF12
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gotofffuncdesc12("
argument_list|,
literal|17
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|18
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_FUNCDESC_GOTOFF12
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gottlsdesc12("
argument_list|,
literal|13
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|14
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTTLSDESC12
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"tlsmoff12("
argument_list|,
literal|10
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|11
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_TLSMOFF12
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gottlsoff12("
argument_list|,
literal|12
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|13
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTTLSOFF12
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
block|}
return|return
name|cgen_parse_signed_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|valuep
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|parse_s12
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|,
name|int
name|opindex
parameter_list|,
name|long
modifier|*
name|valuep
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|errmsg
decl_stmt|;
name|enum
name|cgen_parse_operand_result
name|result_type
decl_stmt|;
name|bfd_vma
name|value
decl_stmt|;
comment|/* Check for small data reference.  */
if|if
condition|(
operator|*
operator|*
name|strp
operator|==
literal|'#'
operator|||
operator|*
operator|*
name|strp
operator|==
literal|'%'
condition|)
block|{
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gprel12("
argument_list|,
literal|8
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|9
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GPREL12
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing `)'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"got12("
argument_list|,
literal|6
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|7
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOT12
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gotfuncdesc12("
argument_list|,
literal|14
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|15
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_FUNCDESC_GOT12
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gotoff12("
argument_list|,
literal|9
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|10
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTOFF12
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gotofffuncdesc12("
argument_list|,
literal|17
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|18
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_FUNCDESC_GOTOFF12
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gottlsdesc12("
argument_list|,
literal|13
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|14
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTTLSDESC12
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"tlsmoff12("
argument_list|,
literal|10
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|11
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_TLSMOFF12
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
elseif|else
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gottlsoff12("
argument_list|,
literal|12
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|13
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GOTTLSOFF12
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing ')'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
block|}
if|if
condition|(
operator|*
operator|*
name|strp
operator|==
literal|'#'
condition|)
operator|++
operator|*
name|strp
expr_stmt|;
return|return
name|cgen_parse_signed_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|valuep
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|parse_u12
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|,
name|int
name|opindex
parameter_list|,
name|long
modifier|*
name|valuep
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|errmsg
decl_stmt|;
name|enum
name|cgen_parse_operand_result
name|result_type
decl_stmt|;
name|bfd_vma
name|value
decl_stmt|;
comment|/* Check for small data reference.  */
if|if
condition|(
operator|(
operator|*
operator|*
name|strp
operator|==
literal|'#'
operator|||
operator|*
operator|*
name|strp
operator|==
literal|'%'
operator|)
operator|&&
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gprel12("
argument_list|,
literal|8
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|9
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GPRELU12
argument_list|,
operator|&
name|result_type
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
literal|"missing `)'"
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
else|else
block|{
if|if
condition|(
operator|*
operator|*
name|strp
operator|==
literal|'#'
condition|)
operator|++
operator|*
name|strp
expr_stmt|;
return|return
name|cgen_parse_signed_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|valuep
argument_list|)
return|;
block|}
block|}
end_function

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|parse_A
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|,
name|int
name|opindex
parameter_list|,
name|unsigned
name|long
modifier|*
name|valuep
parameter_list|,
name|unsigned
name|long
name|A
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|errmsg
decl_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|==
literal|'#'
condition|)
operator|++
operator|*
name|strp
expr_stmt|;
name|errmsg
operator|=
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|valuep
argument_list|)
expr_stmt|;
if|if
condition|(
name|errmsg
condition|)
return|return
name|errmsg
return|;
if|if
condition|(
operator|*
name|valuep
operator|!=
name|A
condition|)
return|return
name|_
argument_list|(
literal|"Value of A operand must be 0 or 1"
argument_list|)
return|;
return|return
name|NULL
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|parse_A0
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|,
name|int
name|opindex
parameter_list|,
name|unsigned
name|long
modifier|*
name|valuep
parameter_list|)
block|{
return|return
name|parse_A
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|valuep
argument_list|,
literal|0
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|parse_A1
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|,
name|int
name|opindex
parameter_list|,
name|unsigned
name|long
modifier|*
name|valuep
parameter_list|)
block|{
return|return
name|parse_A
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|valuep
argument_list|,
literal|1
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|parse_even_register
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strP
parameter_list|,
name|CGEN_KEYWORD
modifier|*
name|tableP
parameter_list|,
name|long
modifier|*
name|valueP
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|errmsg
decl_stmt|;
specifier|const
name|char
modifier|*
name|saved_star_strP
init|=
operator|*
name|strP
decl_stmt|;
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strP
argument_list|,
name|tableP
argument_list|,
name|valueP
argument_list|)
expr_stmt|;
if|if
condition|(
name|errmsg
operator|==
name|NULL
operator|&&
operator|(
operator|(
operator|*
name|valueP
operator|)
operator|&
literal|1
operator|)
condition|)
block|{
name|errmsg
operator|=
name|_
argument_list|(
literal|"register number must be even"
argument_list|)
expr_stmt|;
operator|*
name|strP
operator|=
name|saved_star_strP
expr_stmt|;
block|}
return|return
name|errmsg
return|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|parse_call_label
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|,
name|int
name|opindex
parameter_list|,
name|int
name|opinfo
parameter_list|,
name|enum
name|cgen_parse_operand_result
modifier|*
name|resultp
parameter_list|,
name|bfd_vma
modifier|*
name|valuep
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|errmsg
decl_stmt|;
name|bfd_vma
name|value
decl_stmt|;
comment|/* Check for small data reference.  */
if|if
condition|(
name|opinfo
operator|==
literal|0
operator|&&
operator|(
operator|*
operator|*
name|strp
operator|==
literal|'#'
operator|||
operator|*
operator|*
name|strp
operator|==
literal|'%'
operator|)
condition|)
block|{
if|if
condition|(
name|strncasecmp
argument_list|(
operator|*
name|strp
operator|+
literal|1
argument_list|,
literal|"gettlsoff("
argument_list|,
literal|10
argument_list|)
operator|==
literal|0
condition|)
block|{
operator|*
name|strp
operator|+=
literal|11
expr_stmt|;
name|errmsg
operator|=
name|parse_symbolic_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|BFD_RELOC_FRV_GETTLSOFF
argument_list|,
name|resultp
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
operator|*
name|strp
operator|!=
literal|')'
condition|)
return|return
name|_
argument_list|(
literal|"missing `)'"
argument_list|)
return|;
operator|++
operator|*
name|strp
expr_stmt|;
operator|*
name|valuep
operator|=
name|value
expr_stmt|;
return|return
name|errmsg
return|;
block|}
block|}
return|return
name|cgen_parse_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|opindex
argument_list|,
name|opinfo
argument_list|,
name|resultp
argument_list|,
name|valuep
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/* -- */
end_comment

begin_function_decl
specifier|const
name|char
modifier|*
name|frv_cgen_parse_operand
parameter_list|(
name|CGEN_CPU_DESC
parameter_list|,
name|int
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
parameter_list|,
name|CGEN_FIELDS
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* Main entry point for operand parsing.     This function is basically just a big switch statement.  Earlier versions    used tables to look up the function to use, but    - if the table contains both assembler and disassembler functions then      the disassembler contains much of the assembler and vice-versa,    - there's a lot of inlining possibilities as things grow,    - using a switch statement avoids the function call overhead.     This function could be moved into `parse_insn_normal', but keeping it    separate makes clear the interface between `parse_insn_normal' and each of    the handlers.  */
end_comment

begin_function
specifier|const
name|char
modifier|*
name|frv_cgen_parse_operand
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
name|int
name|opindex
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|,
name|CGEN_FIELDS
modifier|*
name|fields
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|errmsg
init|=
name|NULL
decl_stmt|;
comment|/* Used by scalar operands that still need to be parsed.  */
name|long
name|junk
name|ATTRIBUTE_UNUSED
decl_stmt|;
switch|switch
condition|(
name|opindex
condition|)
block|{
case|case
name|FRV_OPERAND_A0
case|:
name|errmsg
operator|=
name|parse_A0
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_A0
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_A
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_A1
case|:
name|errmsg
operator|=
name|parse_A1
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_A1
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_A
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_ACC40SI
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_acc_names
argument_list|,
operator|&
name|fields
operator|->
name|f_ACC40Si
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_ACC40SK
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_acc_names
argument_list|,
operator|&
name|fields
operator|->
name|f_ACC40Sk
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_ACC40UI
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_acc_names
argument_list|,
operator|&
name|fields
operator|->
name|f_ACC40Ui
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_ACC40UK
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_acc_names
argument_list|,
operator|&
name|fields
operator|->
name|f_ACC40Uk
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_ACCGI
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_accg_names
argument_list|,
operator|&
name|fields
operator|->
name|f_ACCGi
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_ACCGK
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_accg_names
argument_list|,
operator|&
name|fields
operator|->
name|f_ACCGk
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_CCI
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_cccr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_CCi
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_CPRDOUBLEK
case|:
name|errmsg
operator|=
name|parse_even_register
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_cpr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_CPRk
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_CPRI
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_cpr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_CPRi
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_CPRJ
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_cpr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_CPRj
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_CPRK
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_cpr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_CPRk
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_CRI
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_cccr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_CRi
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_CRJ
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_cccr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_CRj
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_CRJ_FLOAT
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_cccr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_CRj_float
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_CRJ_INT
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_cccr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_CRj_int
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_CRK
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_cccr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_CRk
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FCCI_1
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fccr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FCCi_1
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FCCI_2
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fccr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FCCi_2
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FCCI_3
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fccr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FCCi_3
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FCCK
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fccr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FCCk
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FRDOUBLEI
case|:
name|errmsg
operator|=
name|parse_even_register
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FRi
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FRDOUBLEJ
case|:
name|errmsg
operator|=
name|parse_even_register
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FRj
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FRDOUBLEK
case|:
name|errmsg
operator|=
name|parse_even_register
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FRk
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FRI
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FRi
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FRINTI
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FRi
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FRINTIEVEN
case|:
name|errmsg
operator|=
name|parse_even_register
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FRi
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FRINTJ
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FRj
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FRINTJEVEN
case|:
name|errmsg
operator|=
name|parse_even_register
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FRj
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FRINTK
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FRk
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FRINTKEVEN
case|:
name|errmsg
operator|=
name|parse_even_register
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FRk
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FRJ
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FRj
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FRK
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FRk
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FRKHI
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FRk
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_FRKLO
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_fr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_FRk
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_GRDOUBLEK
case|:
name|errmsg
operator|=
name|parse_even_register
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_gr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_GRk
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_GRI
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_gr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_GRi
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_GRJ
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_gr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_GRj
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_GRK
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_gr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_GRk
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_GRKHI
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_gr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_GRk
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_GRKLO
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_gr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_GRk
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_ICCI_1
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_iccr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_ICCi_1
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_ICCI_2
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_iccr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_ICCi_2
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_ICCI_3
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_iccr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_ICCi_3
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_LI
case|:
name|errmsg
operator|=
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_LI
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_LI
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_LRAD
case|:
name|errmsg
operator|=
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_LRAD
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_LRAD
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_LRAE
case|:
name|errmsg
operator|=
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_LRAE
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_LRAE
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_LRAS
case|:
name|errmsg
operator|=
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_LRAS
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_LRAS
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_TLBPRL
case|:
name|errmsg
operator|=
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_TLBPRL
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_TLBPRL
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_TLBPROPX
case|:
name|errmsg
operator|=
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_TLBPROPX
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_TLBPRopx
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_AE
case|:
name|errmsg
operator|=
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_AE
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_ae
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_CALLANN
case|:
name|errmsg
operator|=
name|parse_call_annotation
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_CALLANN
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_reloc_ann
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_CCOND
case|:
name|errmsg
operator|=
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_CCOND
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_ccond
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_COND
case|:
name|errmsg
operator|=
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_COND
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_cond
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_D12
case|:
name|errmsg
operator|=
name|parse_d12
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_D12
argument_list|,
operator|(
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_d12
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_DEBUG
case|:
name|errmsg
operator|=
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_DEBUG
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_debug
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_EIR
case|:
name|errmsg
operator|=
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_EIR
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_eir
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_HINT
case|:
name|errmsg
operator|=
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_HINT
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_hint
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_HINT_NOT_TAKEN
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_h_hint_not_taken
argument_list|,
operator|&
name|fields
operator|->
name|f_hint
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_HINT_TAKEN
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_h_hint_taken
argument_list|,
operator|&
name|fields
operator|->
name|f_hint
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_LABEL16
case|:
block|{
name|bfd_vma
name|value
init|=
literal|0
decl_stmt|;
name|errmsg
operator|=
name|cgen_parse_address
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_LABEL16
argument_list|,
literal|0
argument_list|,
name|NULL
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
name|fields
operator|->
name|f_label16
operator|=
name|value
expr_stmt|;
block|}
break|break;
case|case
name|FRV_OPERAND_LABEL24
case|:
block|{
name|bfd_vma
name|value
init|=
literal|0
decl_stmt|;
name|errmsg
operator|=
name|parse_call_label
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_LABEL24
argument_list|,
literal|0
argument_list|,
name|NULL
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
name|fields
operator|->
name|f_label24
operator|=
name|value
expr_stmt|;
block|}
break|break;
case|case
name|FRV_OPERAND_LDANN
case|:
name|errmsg
operator|=
name|parse_ld_annotation
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_LDANN
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_reloc_ann
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_LDDANN
case|:
name|errmsg
operator|=
name|parse_ldd_annotation
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_LDDANN
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_reloc_ann
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_LOCK
case|:
name|errmsg
operator|=
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_LOCK
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_lock
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_PACK
case|:
name|errmsg
operator|=
name|cgen_parse_keyword
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_h_pack
argument_list|,
operator|&
name|fields
operator|->
name|f_pack
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_S10
case|:
name|errmsg
operator|=
name|cgen_parse_signed_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_S10
argument_list|,
operator|(
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_s10
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_S12
case|:
name|errmsg
operator|=
name|parse_s12
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_S12
argument_list|,
operator|(
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_d12
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_S16
case|:
name|errmsg
operator|=
name|cgen_parse_signed_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_S16
argument_list|,
operator|(
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_s16
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_S5
case|:
name|errmsg
operator|=
name|cgen_parse_signed_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_S5
argument_list|,
operator|(
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_s5
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_S6
case|:
name|errmsg
operator|=
name|cgen_parse_signed_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_S6
argument_list|,
operator|(
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_s6
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_S6_1
case|:
name|errmsg
operator|=
name|cgen_parse_signed_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_S6_1
argument_list|,
operator|(
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_s6_1
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_SLO16
case|:
name|errmsg
operator|=
name|parse_uslo16
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_SLO16
argument_list|,
operator|(
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_s16
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_SPR
case|:
name|errmsg
operator|=
name|parse_spr
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
operator|&
name|frv_cgen_opval_spr_names
argument_list|,
operator|&
name|fields
operator|->
name|f_spr
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_U12
case|:
name|errmsg
operator|=
name|parse_u12
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_U12
argument_list|,
operator|(
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_u12
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_U16
case|:
name|errmsg
operator|=
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_U16
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_u16
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_U6
case|:
name|errmsg
operator|=
name|cgen_parse_unsigned_integer
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_U6
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_u6
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_UHI16
case|:
name|errmsg
operator|=
name|parse_uhi16
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_UHI16
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_u16
operator|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|FRV_OPERAND_ULO16
case|:
name|errmsg
operator|=
name|parse_ulo16
argument_list|(
name|cd
argument_list|,
name|strp
argument_list|,
name|FRV_OPERAND_ULO16
argument_list|,
operator|(
name|unsigned
name|long
operator|*
operator|)
operator|(
operator|&
name|fields
operator|->
name|f_u16
operator|)
argument_list|)
expr_stmt|;
break|break;
default|default :
comment|/* xgettext:c-format */
name|fprintf
argument_list|(
name|stderr
argument_list|,
name|_
argument_list|(
literal|"Unrecognized field %d while parsing.\n"
argument_list|)
argument_list|,
name|opindex
argument_list|)
expr_stmt|;
name|abort
argument_list|()
expr_stmt|;
block|}
return|return
name|errmsg
return|;
block|}
end_function

begin_decl_stmt
name|cgen_parse_fn
modifier|*
specifier|const
name|frv_cgen_parse_handlers
index|[]
init|=
block|{
name|parse_insn_normal
block|, }
decl_stmt|;
end_decl_stmt

begin_function
name|void
name|frv_cgen_init_asm
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|)
block|{
name|frv_cgen_init_opcode_table
argument_list|(
name|cd
argument_list|)
expr_stmt|;
name|frv_cgen_init_ibld_table
argument_list|(
name|cd
argument_list|)
expr_stmt|;
name|cd
operator|->
name|parse_handlers
operator|=
operator|&
name|frv_cgen_parse_handlers
index|[
literal|0
index|]
expr_stmt|;
name|cd
operator|->
name|parse_operand
operator|=
name|frv_cgen_parse_operand
expr_stmt|;
block|}
end_function

begin_escape
end_escape

begin_comment
comment|/* Regex construction routine.     This translates an opcode syntax string into a regex string,    by replacing any non-character syntax element (such as an    opcode) with the pattern '.*'     It then compiles the regex and stores it in the opcode, for    later use by frv_cgen_assemble_insn     Returns NULL for success, an error message for failure.  */
end_comment

begin_function
name|char
modifier|*
name|frv_cgen_build_insn_regex
parameter_list|(
name|CGEN_INSN
modifier|*
name|insn
parameter_list|)
block|{
name|CGEN_OPCODE
modifier|*
name|opc
init|=
operator|(
name|CGEN_OPCODE
operator|*
operator|)
name|CGEN_INSN_OPCODE
argument_list|(
name|insn
argument_list|)
decl_stmt|;
specifier|const
name|char
modifier|*
name|mnem
init|=
name|CGEN_INSN_MNEMONIC
argument_list|(
name|insn
argument_list|)
decl_stmt|;
name|char
name|rxbuf
index|[
name|CGEN_MAX_RX_ELEMENTS
index|]
decl_stmt|;
name|char
modifier|*
name|rx
init|=
name|rxbuf
decl_stmt|;
specifier|const
name|CGEN_SYNTAX_CHAR_TYPE
modifier|*
name|syn
decl_stmt|;
name|int
name|reg_err
decl_stmt|;
name|syn
operator|=
name|CGEN_SYNTAX_STRING
argument_list|(
name|CGEN_OPCODE_SYNTAX
argument_list|(
name|opc
argument_list|)
argument_list|)
expr_stmt|;
comment|/* Mnemonics come first in the syntax string.  */
if|if
condition|(
operator|!
name|CGEN_SYNTAX_MNEMONIC_P
argument_list|(
operator|*
name|syn
argument_list|)
condition|)
return|return
name|_
argument_list|(
literal|"missing mnemonic in syntax string"
argument_list|)
return|;
operator|++
name|syn
expr_stmt|;
comment|/* Generate a case sensitive regular expression that emulates case      insensitive matching in the "C" locale.  We cannot generate a case      insensitive regular expression because in Turkish locales, 'i' and 'I'      are not equal modulo case conversion.  */
comment|/* Copy the literal mnemonic out of the insn.  */
for|for
control|(
init|;
operator|*
name|mnem
condition|;
name|mnem
operator|++
control|)
block|{
name|char
name|c
init|=
operator|*
name|mnem
decl_stmt|;
if|if
condition|(
name|ISALPHA
argument_list|(
name|c
argument_list|)
condition|)
block|{
operator|*
name|rx
operator|++
operator|=
literal|'['
expr_stmt|;
operator|*
name|rx
operator|++
operator|=
name|TOLOWER
argument_list|(
name|c
argument_list|)
expr_stmt|;
operator|*
name|rx
operator|++
operator|=
name|TOUPPER
argument_list|(
name|c
argument_list|)
expr_stmt|;
operator|*
name|rx
operator|++
operator|=
literal|']'
expr_stmt|;
block|}
else|else
operator|*
name|rx
operator|++
operator|=
name|c
expr_stmt|;
block|}
comment|/* Copy any remaining literals from the syntax string into the rx.  */
for|for
control|(
init|;
operator|*
name|syn
operator|!=
literal|0
operator|&&
name|rx
operator|<=
name|rxbuf
operator|+
operator|(
name|CGEN_MAX_RX_ELEMENTS
operator|-
literal|7
operator|-
literal|4
operator|)
condition|;
operator|++
name|syn
control|)
block|{
if|if
condition|(
name|CGEN_SYNTAX_CHAR_P
argument_list|(
operator|*
name|syn
argument_list|)
condition|)
block|{
name|char
name|c
init|=
name|CGEN_SYNTAX_CHAR
argument_list|(
operator|*
name|syn
argument_list|)
decl_stmt|;
switch|switch
condition|(
name|c
condition|)
block|{
comment|/* Escape any regex metacharacters in the syntax.  */
case|case
literal|'.'
case|:
case|case
literal|'['
case|:
case|case
literal|'\\'
case|:
case|case
literal|'*'
case|:
case|case
literal|'^'
case|:
case|case
literal|'$'
case|:
ifdef|#
directive|ifdef
name|CGEN_ESCAPE_EXTENDED_REGEX
case|case
literal|'?'
case|:
case|case
literal|'{'
case|:
case|case
literal|'}'
case|:
case|case
literal|'('
case|:
case|case
literal|')'
case|:
case|case
literal|'*'
case|:
case|case
literal|'|'
case|:
case|case
literal|'+'
case|:
case|case
literal|']'
case|:
endif|#
directive|endif
operator|*
name|rx
operator|++
operator|=
literal|'\\'
expr_stmt|;
operator|*
name|rx
operator|++
operator|=
name|c
expr_stmt|;
break|break;
default|default:
if|if
condition|(
name|ISALPHA
argument_list|(
name|c
argument_list|)
condition|)
block|{
operator|*
name|rx
operator|++
operator|=
literal|'['
expr_stmt|;
operator|*
name|rx
operator|++
operator|=
name|TOLOWER
argument_list|(
name|c
argument_list|)
expr_stmt|;
operator|*
name|rx
operator|++
operator|=
name|TOUPPER
argument_list|(
name|c
argument_list|)
expr_stmt|;
operator|*
name|rx
operator|++
operator|=
literal|']'
expr_stmt|;
block|}
else|else
operator|*
name|rx
operator|++
operator|=
name|c
expr_stmt|;
break|break;
block|}
block|}
else|else
block|{
comment|/* Replace non-syntax fields with globs.  */
operator|*
name|rx
operator|++
operator|=
literal|'.'
expr_stmt|;
operator|*
name|rx
operator|++
operator|=
literal|'*'
expr_stmt|;
block|}
block|}
comment|/* Trailing whitespace ok.  */
operator|*
name|rx
operator|++
operator|=
literal|'['
expr_stmt|;
operator|*
name|rx
operator|++
operator|=
literal|' '
expr_stmt|;
operator|*
name|rx
operator|++
operator|=
literal|'\t'
expr_stmt|;
operator|*
name|rx
operator|++
operator|=
literal|']'
expr_stmt|;
operator|*
name|rx
operator|++
operator|=
literal|'*'
expr_stmt|;
comment|/* But anchor it after that.  */
operator|*
name|rx
operator|++
operator|=
literal|'$'
expr_stmt|;
operator|*
name|rx
operator|=
literal|'\0'
expr_stmt|;
name|CGEN_INSN_RX
argument_list|(
name|insn
argument_list|)
operator|=
name|xmalloc
argument_list|(
sizeof|sizeof
argument_list|(
name|regex_t
argument_list|)
argument_list|)
expr_stmt|;
name|reg_err
operator|=
name|regcomp
argument_list|(
operator|(
name|regex_t
operator|*
operator|)
name|CGEN_INSN_RX
argument_list|(
name|insn
argument_list|)
argument_list|,
name|rxbuf
argument_list|,
name|REG_NOSUB
argument_list|)
expr_stmt|;
if|if
condition|(
name|reg_err
operator|==
literal|0
condition|)
return|return
name|NULL
return|;
else|else
block|{
specifier|static
name|char
name|msg
index|[
literal|80
index|]
decl_stmt|;
name|regerror
argument_list|(
name|reg_err
argument_list|,
operator|(
name|regex_t
operator|*
operator|)
name|CGEN_INSN_RX
argument_list|(
name|insn
argument_list|)
argument_list|,
name|msg
argument_list|,
literal|80
argument_list|)
expr_stmt|;
name|regfree
argument_list|(
operator|(
name|regex_t
operator|*
operator|)
name|CGEN_INSN_RX
argument_list|(
name|insn
argument_list|)
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|CGEN_INSN_RX
argument_list|(
name|insn
argument_list|)
argument_list|)
expr_stmt|;
operator|(
name|CGEN_INSN_RX
argument_list|(
name|insn
argument_list|)
operator|)
operator|=
name|NULL
expr_stmt|;
return|return
name|msg
return|;
block|}
block|}
end_function

begin_escape
end_escape

begin_comment
comment|/* Default insn parser.     The syntax string is scanned and operands are parsed and stored in FIELDS.    Relocs are queued as we go via other callbacks.     ??? Note that this is currently an all-or-nothing parser.  If we fail to    parse the instruction, we return 0 and the caller will start over from    the beginning.  Backtracking will be necessary in parsing subexpressions,    but that can be handled there.  Not handling backtracking here may get    expensive in the case of the m68k.  Deal with later.     Returns NULL for success, an error message for failure.  */
end_comment

begin_function
specifier|static
specifier|const
name|char
modifier|*
name|parse_insn_normal
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|CGEN_INSN
modifier|*
name|insn
parameter_list|,
specifier|const
name|char
modifier|*
modifier|*
name|strp
parameter_list|,
name|CGEN_FIELDS
modifier|*
name|fields
parameter_list|)
block|{
comment|/* ??? Runtime added insns not handled yet.  */
specifier|const
name|CGEN_SYNTAX
modifier|*
name|syntax
init|=
name|CGEN_INSN_SYNTAX
argument_list|(
name|insn
argument_list|)
decl_stmt|;
specifier|const
name|char
modifier|*
name|str
init|=
operator|*
name|strp
decl_stmt|;
specifier|const
name|char
modifier|*
name|errmsg
decl_stmt|;
specifier|const
name|char
modifier|*
name|p
decl_stmt|;
specifier|const
name|CGEN_SYNTAX_CHAR_TYPE
modifier|*
name|syn
decl_stmt|;
ifdef|#
directive|ifdef
name|CGEN_MNEMONIC_OPERANDS
comment|/* FIXME: wip */
name|int
name|past_opcode_p
decl_stmt|;
endif|#
directive|endif
comment|/* For now we assume the mnemonic is first (there are no leading operands).      We can parse it without needing to set up operand parsing.      GAS's input scrubber will ensure mnemonics are lowercase, but we may      not be called from GAS.  */
name|p
operator|=
name|CGEN_INSN_MNEMONIC
argument_list|(
name|insn
argument_list|)
expr_stmt|;
while|while
condition|(
operator|*
name|p
operator|&&
name|TOLOWER
argument_list|(
operator|*
name|p
argument_list|)
operator|==
name|TOLOWER
argument_list|(
operator|*
name|str
argument_list|)
condition|)
operator|++
name|p
operator|,
operator|++
name|str
expr_stmt|;
if|if
condition|(
operator|*
name|p
condition|)
return|return
name|_
argument_list|(
literal|"unrecognized instruction"
argument_list|)
return|;
ifndef|#
directive|ifndef
name|CGEN_MNEMONIC_OPERANDS
if|if
condition|(
operator|*
name|str
operator|&&
operator|!
name|ISSPACE
argument_list|(
operator|*
name|str
argument_list|)
condition|)
return|return
name|_
argument_list|(
literal|"unrecognized instruction"
argument_list|)
return|;
endif|#
directive|endif
name|CGEN_INIT_PARSE
argument_list|(
name|cd
argument_list|)
expr_stmt|;
name|cgen_init_parse_operand
argument_list|(
name|cd
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|CGEN_MNEMONIC_OPERANDS
name|past_opcode_p
operator|=
literal|0
expr_stmt|;
endif|#
directive|endif
comment|/* We don't check for (*str != '\0') here because we want to parse      any trailing fake arguments in the syntax string.  */
name|syn
operator|=
name|CGEN_SYNTAX_STRING
argument_list|(
name|syntax
argument_list|)
expr_stmt|;
comment|/* Mnemonics come first for now, ensure valid string.  */
if|if
condition|(
operator|!
name|CGEN_SYNTAX_MNEMONIC_P
argument_list|(
operator|*
name|syn
argument_list|)
condition|)
name|abort
argument_list|()
expr_stmt|;
operator|++
name|syn
expr_stmt|;
while|while
condition|(
operator|*
name|syn
operator|!=
literal|0
condition|)
block|{
comment|/* Non operand chars must match exactly.  */
if|if
condition|(
name|CGEN_SYNTAX_CHAR_P
argument_list|(
operator|*
name|syn
argument_list|)
condition|)
block|{
comment|/* FIXME: While we allow for non-GAS callers above, we assume the 	     first char after the mnemonic part is a space.  */
comment|/* FIXME: We also take inappropriate advantage of the fact that 	     GAS's input scrubber will remove extraneous blanks.  */
if|if
condition|(
name|TOLOWER
argument_list|(
operator|*
name|str
argument_list|)
operator|==
name|TOLOWER
argument_list|(
name|CGEN_SYNTAX_CHAR
argument_list|(
operator|*
name|syn
argument_list|)
argument_list|)
condition|)
block|{
ifdef|#
directive|ifdef
name|CGEN_MNEMONIC_OPERANDS
if|if
condition|(
name|CGEN_SYNTAX_CHAR
argument_list|(
operator|*
name|syn
argument_list|)
operator|==
literal|' '
condition|)
name|past_opcode_p
operator|=
literal|1
expr_stmt|;
endif|#
directive|endif
operator|++
name|syn
expr_stmt|;
operator|++
name|str
expr_stmt|;
block|}
elseif|else
if|if
condition|(
operator|*
name|str
condition|)
block|{
comment|/* Syntax char didn't match.  Can't be this insn.  */
specifier|static
name|char
name|msg
index|[
literal|80
index|]
decl_stmt|;
comment|/* xgettext:c-format */
name|sprintf
argument_list|(
name|msg
argument_list|,
name|_
argument_list|(
literal|"syntax error (expected char `%c', found `%c')"
argument_list|)
argument_list|,
name|CGEN_SYNTAX_CHAR
argument_list|(
operator|*
name|syn
argument_list|)
argument_list|,
operator|*
name|str
argument_list|)
expr_stmt|;
return|return
name|msg
return|;
block|}
else|else
block|{
comment|/* Ran out of input.  */
specifier|static
name|char
name|msg
index|[
literal|80
index|]
decl_stmt|;
comment|/* xgettext:c-format */
name|sprintf
argument_list|(
name|msg
argument_list|,
name|_
argument_list|(
literal|"syntax error (expected char `%c', found end of instruction)"
argument_list|)
argument_list|,
name|CGEN_SYNTAX_CHAR
argument_list|(
operator|*
name|syn
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|msg
return|;
block|}
continue|continue;
block|}
comment|/* We have an operand of some sort.  */
name|errmsg
operator|=
name|cd
operator|->
name|parse_operand
argument_list|(
name|cd
argument_list|,
name|CGEN_SYNTAX_FIELD
argument_list|(
operator|*
name|syn
argument_list|)
argument_list|,
operator|&
name|str
argument_list|,
name|fields
argument_list|)
expr_stmt|;
if|if
condition|(
name|errmsg
condition|)
return|return
name|errmsg
return|;
comment|/* Done with this operand, continue with next one.  */
operator|++
name|syn
expr_stmt|;
block|}
comment|/* If we're at the end of the syntax string, we're done.  */
if|if
condition|(
operator|*
name|syn
operator|==
literal|0
condition|)
block|{
comment|/* FIXME: For the moment we assume a valid `str' can only contain 	 blanks now.  IE: We needn't try again with a longer version of 	 the insn and it is assumed that longer versions of insns appear 	 before shorter ones (eg: lsr r2,r3,1 vs lsr r2,r3).  */
while|while
condition|(
name|ISSPACE
argument_list|(
operator|*
name|str
argument_list|)
condition|)
operator|++
name|str
expr_stmt|;
if|if
condition|(
operator|*
name|str
operator|!=
literal|'\0'
condition|)
return|return
name|_
argument_list|(
literal|"junk at end of line"
argument_list|)
return|;
comment|/* FIXME: would like to include `str' */
return|return
name|NULL
return|;
block|}
comment|/* We couldn't parse it.  */
return|return
name|_
argument_list|(
literal|"unrecognized instruction"
argument_list|)
return|;
block|}
end_function

begin_escape
end_escape

begin_comment
comment|/* Main entry point.    This routine is called for each instruction to be assembled.    STR points to the insn to be assembled.    We assume all necessary tables have been initialized.    The assembled instruction, less any fixups, is stored in BUF.    Remember that if CGEN_INT_INSN_P then BUF is an int and thus the value    still needs to be converted to target byte order, otherwise BUF is an array    of bytes in target byte order.    The result is a pointer to the insn's entry in the opcode table,    or NULL if an error occured (an error message will have already been    printed).     Note that when processing (non-alias) macro-insns,    this function recurses.     ??? It's possible to make this cpu-independent.    One would have to deal with a few minor things.    At this point in time doing so would be more of a curiosity than useful    [for example this file isn't _that_ big], but keeping the possibility in    mind helps keep the design clean.  */
end_comment

begin_function
specifier|const
name|CGEN_INSN
modifier|*
name|frv_cgen_assemble_insn
parameter_list|(
name|CGEN_CPU_DESC
name|cd
parameter_list|,
specifier|const
name|char
modifier|*
name|str
parameter_list|,
name|CGEN_FIELDS
modifier|*
name|fields
parameter_list|,
name|CGEN_INSN_BYTES_PTR
name|buf
parameter_list|,
name|char
modifier|*
modifier|*
name|errmsg
parameter_list|)
block|{
specifier|const
name|char
modifier|*
name|start
decl_stmt|;
name|CGEN_INSN_LIST
modifier|*
name|ilist
decl_stmt|;
specifier|const
name|char
modifier|*
name|parse_errmsg
init|=
name|NULL
decl_stmt|;
specifier|const
name|char
modifier|*
name|insert_errmsg
init|=
name|NULL
decl_stmt|;
name|int
name|recognized_mnemonic
init|=
literal|0
decl_stmt|;
comment|/* Skip leading white space.  */
while|while
condition|(
name|ISSPACE
argument_list|(
operator|*
name|str
argument_list|)
condition|)
operator|++
name|str
expr_stmt|;
comment|/* The instructions are stored in hashed lists.      Get the first in the list.  */
name|ilist
operator|=
name|CGEN_ASM_LOOKUP_INSN
argument_list|(
name|cd
argument_list|,
name|str
argument_list|)
expr_stmt|;
comment|/* Keep looking until we find a match.  */
name|start
operator|=
name|str
expr_stmt|;
for|for
control|(
init|;
name|ilist
operator|!=
name|NULL
condition|;
name|ilist
operator|=
name|CGEN_ASM_NEXT_INSN
argument_list|(
name|ilist
argument_list|)
control|)
block|{
specifier|const
name|CGEN_INSN
modifier|*
name|insn
init|=
name|ilist
operator|->
name|insn
decl_stmt|;
name|recognized_mnemonic
operator|=
literal|1
expr_stmt|;
ifdef|#
directive|ifdef
name|CGEN_VALIDATE_INSN_SUPPORTED
comment|/* Not usually needed as unsupported opcodes 	 shouldn't be in the hash lists.  */
comment|/* Is this insn supported by the selected cpu?  */
if|if
condition|(
operator|!
name|frv_cgen_insn_supported
argument_list|(
name|cd
argument_list|,
name|insn
argument_list|)
condition|)
continue|continue;
endif|#
directive|endif
comment|/* If the RELAXED attribute is set, this is an insn that shouldn't be 	 chosen immediately.  Instead, it is used during assembler/linker 	 relaxation if possible.  */
if|if
condition|(
name|CGEN_INSN_ATTR_VALUE
argument_list|(
name|insn
argument_list|,
name|CGEN_INSN_RELAXED
argument_list|)
operator|!=
literal|0
condition|)
continue|continue;
name|str
operator|=
name|start
expr_stmt|;
comment|/* Skip this insn if str doesn't look right lexically.  */
if|if
condition|(
name|CGEN_INSN_RX
argument_list|(
name|insn
argument_list|)
operator|!=
name|NULL
operator|&&
name|regexec
argument_list|(
operator|(
name|regex_t
operator|*
operator|)
name|CGEN_INSN_RX
argument_list|(
name|insn
argument_list|)
argument_list|,
name|str
argument_list|,
literal|0
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|)
operator|==
name|REG_NOMATCH
condition|)
continue|continue;
comment|/* Allow parse/insert handlers to obtain length of insn.  */
name|CGEN_FIELDS_BITSIZE
argument_list|(
name|fields
argument_list|)
operator|=
name|CGEN_INSN_BITSIZE
argument_list|(
name|insn
argument_list|)
expr_stmt|;
name|parse_errmsg
operator|=
name|CGEN_PARSE_FN
argument_list|(
name|cd
argument_list|,
name|insn
argument_list|)
argument_list|(
name|cd
argument_list|,
name|insn
argument_list|,
operator|&
name|str
argument_list|,
name|fields
argument_list|)
expr_stmt|;
if|if
condition|(
name|parse_errmsg
operator|!=
name|NULL
condition|)
continue|continue;
comment|/* ??? 0 is passed for `pc'.  */
name|insert_errmsg
operator|=
name|CGEN_INSERT_FN
argument_list|(
name|cd
argument_list|,
name|insn
argument_list|)
argument_list|(
name|cd
argument_list|,
name|insn
argument_list|,
name|fields
argument_list|,
name|buf
argument_list|,
operator|(
name|bfd_vma
operator|)
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|insert_errmsg
operator|!=
name|NULL
condition|)
continue|continue;
comment|/* It is up to the caller to actually output the insn and any          queued relocs.  */
return|return
name|insn
return|;
block|}
block|{
specifier|static
name|char
name|errbuf
index|[
literal|150
index|]
decl_stmt|;
ifdef|#
directive|ifdef
name|CGEN_VERBOSE_ASSEMBLER_ERRORS
specifier|const
name|char
modifier|*
name|tmp_errmsg
decl_stmt|;
comment|/* If requesting verbose error messages, use insert_errmsg.        Failing that, use parse_errmsg.  */
name|tmp_errmsg
operator|=
operator|(
name|insert_errmsg
condition|?
name|insert_errmsg
else|:
name|parse_errmsg
condition|?
name|parse_errmsg
else|:
name|recognized_mnemonic
condition|?
name|_
argument_list|(
literal|"unrecognized form of instruction"
argument_list|)
else|:
name|_
argument_list|(
literal|"unrecognized instruction"
argument_list|)
operator|)
expr_stmt|;
if|if
condition|(
name|strlen
argument_list|(
name|start
argument_list|)
operator|>
literal|50
condition|)
comment|/* xgettext:c-format */
name|sprintf
argument_list|(
name|errbuf
argument_list|,
literal|"%s `%.50s...'"
argument_list|,
name|tmp_errmsg
argument_list|,
name|start
argument_list|)
expr_stmt|;
else|else
comment|/* xgettext:c-format */
name|sprintf
argument_list|(
name|errbuf
argument_list|,
literal|"%s `%.50s'"
argument_list|,
name|tmp_errmsg
argument_list|,
name|start
argument_list|)
expr_stmt|;
else|#
directive|else
if|if
condition|(
name|strlen
argument_list|(
name|start
argument_list|)
operator|>
literal|50
condition|)
comment|/* xgettext:c-format */
name|sprintf
argument_list|(
name|errbuf
argument_list|,
name|_
argument_list|(
literal|"bad instruction `%.50s...'"
argument_list|)
argument_list|,
name|start
argument_list|)
expr_stmt|;
else|else
comment|/* xgettext:c-format */
name|sprintf
argument_list|(
name|errbuf
argument_list|,
name|_
argument_list|(
literal|"bad instruction `%.50s'"
argument_list|)
argument_list|,
name|start
argument_list|)
expr_stmt|;
endif|#
directive|endif
operator|*
name|errmsg
operator|=
name|errbuf
expr_stmt|;
return|return
name|NULL
return|;
block|}
block|}
end_function

end_unit

