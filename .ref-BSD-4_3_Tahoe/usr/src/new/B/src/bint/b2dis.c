begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* Copyright (c) Stichting Mathematisch Centrum, Amsterdam, 1985. */
end_comment

begin_comment
comment|/*   $Header: b2dis.c,v 1.4 85/08/22 16:54:27 timo Exp $ */
end_comment

begin_include
include|#
directive|include
file|"b.h"
end_include

begin_include
include|#
directive|include
file|"b1obj.h"
end_include

begin_include
include|#
directive|include
file|"b2par.h"
end_include

begin_include
include|#
directive|include
file|"b2nod.h"
end_include

begin_decl_stmt
name|FILE
modifier|*
name|d_file
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|Indent
value|"    "
end_define

begin_decl_stmt
name|Hidden
name|intlet
name|ilevel
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_function
name|Hidden
name|Procedure
name|set_ilevel
parameter_list|()
block|{
name|intlet
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|ilevel
condition|;
name|i
operator|++
control|)
name|fprintf
argument_list|(
name|d_file
argument_list|,
name|Indent
argument_list|)
expr_stmt|;
block|}
end_function

begin_decl_stmt
name|Hidden
name|bool
name|new_line
init|=
name|Yes
decl_stmt|,
name|in_comment
init|=
name|No
decl_stmt|;
end_decl_stmt

begin_function
name|Hidden
name|Procedure
name|put_char
parameter_list|(
name|c
parameter_list|)
name|char
name|c
decl_stmt|;
block|{
if|if
condition|(
name|new_line
operator|&&
operator|!
name|in_comment
condition|)
name|set_ilevel
argument_list|()
expr_stmt|;
name|putc
argument_list|(
name|c
argument_list|,
name|d_file
argument_list|)
expr_stmt|;
name|new_line
operator|=
name|No
expr_stmt|;
block|}
end_function

begin_function
name|Hidden
name|Procedure
name|put_string
parameter_list|(
name|s
parameter_list|)
name|string
name|s
decl_stmt|;
block|{
if|if
condition|(
name|new_line
operator|&&
operator|!
name|in_comment
condition|)
name|set_ilevel
argument_list|()
expr_stmt|;
name|fprintf
argument_list|(
name|d_file
argument_list|,
literal|"%s"
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|new_line
operator|=
name|No
expr_stmt|;
block|}
end_function

begin_function
name|Hidden
name|Procedure
name|put_newline
parameter_list|()
block|{
name|putc
argument_list|(
literal|'\n'
argument_list|,
name|d_file
argument_list|)
expr_stmt|;
name|new_line
operator|=
name|Yes
expr_stmt|;
block|}
end_function

begin_define
define|#
directive|define
name|Putspace
value|put_char(' ')
end_define

begin_comment
comment|/* ******************************************************************** */
end_comment

begin_decl_stmt
name|Hidden
name|bool
name|displ_one_line
decl_stmt|,
name|stop_displ
decl_stmt|;
end_decl_stmt

begin_function
name|Visible
name|Procedure
name|display
parameter_list|(
name|f
parameter_list|,
name|v
parameter_list|,
name|one_line
parameter_list|)
name|FILE
modifier|*
name|f
decl_stmt|;
name|parsetree
name|v
decl_stmt|;
name|bool
name|one_line
decl_stmt|;
block|{
name|d_file
operator|=
name|f
expr_stmt|;
name|ilevel
operator|=
literal|0
expr_stmt|;
name|displ_one_line
operator|=
name|one_line
expr_stmt|;
name|stop_displ
operator|=
name|No
expr_stmt|;
name|new_line
operator|=
operator|!
name|one_line
expr_stmt|;
name|displ
argument_list|(
name|v
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|new_line
condition|)
name|put_newline
argument_list|()
expr_stmt|;
block|}
end_function

begin_comment
comment|/* ******************************************************************** */
end_comment

begin_decl_stmt
name|char
modifier|*
name|text
index|[]
init|=
block|{
comment|/* HOW_TO */
literal|"HOW'TO #h1:#c2#b34"
block|,
comment|/* YIELD */
literal|"YIELD 2:#c3#b45"
block|,
comment|/* TEST */
literal|"TEST 2:#c3#b45"
block|,
comment|/* REFINEMENT */
literal|"0:#c1#b23"
block|,
comment|/* SUITE */
literal|"1#c23"
block|,
comment|/* PUT */
literal|"PUT 0 IN 1"
block|,
comment|/* INSERT */
literal|"INSERT 0 IN 1"
block|,
comment|/* REMOVE */
literal|"REMOVE 0 FROM 1"
block|,
comment|/* CHOOSE */
literal|"CHOOSE 0 FROM 1"
block|,
comment|/* DRAW */
literal|"DRAW 0"
block|,
comment|/* SET_RANDOM */
literal|"SET'RANDOM 0"
block|,
comment|/* DELETE */
literal|"DELETE 0"
block|,
comment|/* CHECK */
literal|"CHECK 0"
block|,
comment|/* SHARE */
literal|"SHARE 0"
block|,
comment|/* WRITE */
literal|"WRITE #j"
block|,
comment|/* READ */
literal|"READ 0 EG 1"
block|,
comment|/* READ_RAW */
literal|"READ 0 RAW"
block|,
comment|/* IF */
literal|"IF 0:#c1#b2"
block|,
comment|/* WHILE */
literal|"WHILE 0:#c1#b2"
block|,
comment|/* FOR */
literal|"FOR 0 IN 1:#c2#b3"
block|,
comment|/* SELECT */
literal|"SELECT:#c0#b1"
block|,
comment|/* TEST_SUITE */
literal|"1#d:#c2#b34"
block|,
comment|/* ELSE */
literal|"ELSE:#c1#b2"
block|,
comment|/* QUIT */
literal|"QUIT"
block|,
comment|/* RETURN */
literal|"RETURN 0"
block|,
comment|/* REPORT */
literal|"REPORT 0"
block|,
comment|/* SUCCEED */
literal|"SUCCEED"
block|,
comment|/* FAIL */
literal|"FAIL"
block|,
comment|/* USER_COMMAND */
literal|"#h1"
block|,
comment|/* EXTENDED_COMMAND */
literal|"0 ..."
block|,
comment|/* TAG */
literal|"0"
block|,
comment|/* COMPOUND */
literal|"(0)"
block|,
comment|/* COLLATERAL */
literal|"#a0"
block|,
comment|/* SELECTION */
literal|"0[1]"
block|,
comment|/* BEHEAD */
literal|"0@1"
block|,
comment|/* CURTAIL */
literal|"0|1"
block|,
comment|/* UNPARSED */
literal|"1"
block|,
comment|/* MONF */
literal|"#l"
block|,
comment|/* DYAF */
literal|"#k"
block|,
comment|/* NUMBER */
literal|"1"
block|,
comment|/* TEXT_DIS */
literal|"#e"
block|,
comment|/* TEXT_LIT */
literal|"#f"
block|,
comment|/* TEXT_CONV */
literal|"`0`1"
block|,
comment|/* ELT_DIS */
literal|"{}"
block|,
comment|/* LIST_DIS */
literal|"{#i0}"
block|,
comment|/* RANGE_DIS */
literal|"{0..1}"
block|,
comment|/* TAB_DIS */
literal|"{#g0}"
block|,
comment|/* AND */
literal|"0 AND 1"
block|,
comment|/* OR */
literal|"0 OR 1"
block|,
comment|/* NOT */
literal|"NOT 0"
block|,
comment|/* SOME_IN */
literal|"SOME 0 IN 1 HAS 2"
block|,
comment|/* EACH_IN */
literal|"EACH 0 IN 1 HAS 2"
block|,
comment|/* NO_IN */
literal|"NO 0 IN 1 HAS 2"
block|,
comment|/* SOME_PARSING */
literal|"SOME 0 PARSING 1 HAS 2"
block|,
comment|/* EACH_PARSING */
literal|"EACH 0 PARSING 1 HAS 2"
block|,
comment|/* NO_PARSING */
literal|"NO 0 PARSING 1 HAS 2"
block|,
comment|/* MONPRD */
literal|"0 1"
block|,
comment|/* DYAPRD */
literal|"0 1 2"
block|,
comment|/* LESS_THAN */
literal|"0< 1"
block|,
comment|/* AT_MOST */
literal|"0<= 1"
block|,
comment|/* GREATER_THAN */
literal|"0> 1"
block|,
comment|/* AT_LEAST */
literal|"0>= 1"
block|,
comment|/* EQUAL */
literal|"0 = 1"
block|,
comment|/* UNEQUAL */
literal|"0<> 1"
block|,
comment|/* Nonode */
literal|""
block|,
comment|/* TAGformal */
literal|"0"
block|,
comment|/* TAGlocal */
literal|"0"
block|,
comment|/* TAGglobal */
literal|"0"
block|,
comment|/* TAGmystery */
literal|"0"
block|,
comment|/* TAGrefinement */
literal|"0"
block|,
comment|/* TAGzerfun */
literal|"0"
block|,
comment|/* TAGzerprd */
literal|"0"
block|, }
decl_stmt|;
end_decl_stmt

begin_define
define|#
directive|define
name|Is_digit
parameter_list|(
name|d
parameter_list|)
value|((d)>= '0'&& (d)<= '9')
end_define

begin_define
define|#
directive|define
name|Fld
parameter_list|(
name|v
parameter_list|,
name|t
parameter_list|)
value|*Branch(v, (*(t) - '0') + First_fieldnr)
end_define

begin_function
name|Hidden
name|Procedure
name|displ
parameter_list|(
name|v
parameter_list|)
name|value
name|v
decl_stmt|;
block|{
if|if
condition|(
name|Is_text
argument_list|(
name|v
argument_list|)
condition|)
name|put_string
argument_list|(
name|strval
argument_list|(
name|v
argument_list|)
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|Is_parsetree
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|string
name|t
init|=
name|text
index|[
name|nodetype
argument_list|(
name|v
argument_list|)
index|]
decl_stmt|;
while|while
condition|(
operator|*
name|t
condition|)
block|{
if|if
condition|(
name|Is_digit
argument_list|(
operator|*
name|t
argument_list|)
condition|)
name|displ
argument_list|(
name|Fld
argument_list|(
name|v
argument_list|,
name|t
argument_list|)
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
operator|*
name|t
operator|==
literal|'#'
condition|)
block|{
name|special
argument_list|(
name|v
argument_list|,
operator|&
name|t
argument_list|)
expr_stmt|;
if|if
condition|(
name|stop_displ
condition|)
return|return;
block|}
else|else
name|put_char
argument_list|(
operator|*
name|t
argument_list|)
expr_stmt|;
name|t
operator|++
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|Hidden
name|Procedure
name|special
parameter_list|(
name|v
parameter_list|,
name|t
parameter_list|)
name|parsetree
name|v
decl_stmt|;
name|string
modifier|*
name|t
decl_stmt|;
block|{
operator|(
operator|*
name|t
operator|)
operator|++
expr_stmt|;
switch|switch
condition|(
operator|*
operator|*
name|t
condition|)
block|{
case|case
literal|'a'
case|:
name|d_collateral
argument_list|(
name|Fld
argument_list|(
name|v
argument_list|,
operator|++
operator|*
name|t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'b'
case|:
name|indent
argument_list|(
name|Fld
argument_list|(
name|v
argument_list|,
operator|++
operator|*
name|t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'c'
case|:
name|d_comment
argument_list|(
name|Fld
argument_list|(
name|v
argument_list|,
operator|++
operator|*
name|t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'d'
case|:
comment|/* test suite */
operator|(
operator|*
name|t
operator|)
operator|++
expr_stmt|;
if|if
condition|(
operator|!
name|new_line
condition|)
comment|/* there was a command */
name|put_char
argument_list|(
operator|*
operator|*
name|t
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'e'
case|:
name|d_textdis
argument_list|(
name|v
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'f'
case|:
name|d_textlit
argument_list|(
name|v
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'g'
case|:
name|d_tabdis
argument_list|(
name|Fld
argument_list|(
name|v
argument_list|,
operator|++
operator|*
name|t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'h'
case|:
name|d_actfor_compound
argument_list|(
name|Fld
argument_list|(
name|v
argument_list|,
operator|++
operator|*
name|t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'i'
case|:
name|d_listdis
argument_list|(
name|Fld
argument_list|(
name|v
argument_list|,
operator|++
operator|*
name|t
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'j'
case|:
name|d_write
argument_list|(
name|v
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'k'
case|:
name|d_dyaf
argument_list|(
name|v
argument_list|)
expr_stmt|;
break|break;
case|case
literal|'l'
case|:
name|d_monf
argument_list|(
name|v
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
end_function

begin_function
name|Hidden
name|Procedure
name|indent
parameter_list|(
name|v
parameter_list|)
name|parsetree
name|v
decl_stmt|;
block|{
if|if
condition|(
name|displ_one_line
condition|)
block|{
name|stop_displ
operator|=
name|Yes
expr_stmt|;
return|return;
block|}
name|ilevel
operator|++
expr_stmt|;
name|displ
argument_list|(
name|v
argument_list|)
expr_stmt|;
name|ilevel
operator|--
expr_stmt|;
block|}
end_function

begin_function
name|Hidden
name|bool
name|no_space_before_comment
parameter_list|(
name|v
parameter_list|)
name|value
name|v
decl_stmt|;
block|{
name|value
name|c
decl_stmt|,
name|t
decl_stmt|;
name|bool
name|b
decl_stmt|;
name|c
operator|=
name|curtail
argument_list|(
name|v
argument_list|,
name|one
argument_list|)
expr_stmt|;
name|t
operator|=
name|mk_text
argument_list|(
literal|"\\"
argument_list|)
expr_stmt|;
name|b
operator|=
name|compare
argument_list|(
name|c
argument_list|,
name|t
argument_list|)
operator|==
literal|0
expr_stmt|;
name|release
argument_list|(
name|c
argument_list|)
expr_stmt|;
name|release
argument_list|(
name|t
argument_list|)
expr_stmt|;
return|return
name|b
return|;
block|}
end_function

begin_function
name|Hidden
name|Procedure
name|d_comment
parameter_list|(
name|v
parameter_list|)
name|value
name|v
decl_stmt|;
block|{
if|if
condition|(
name|v
operator|!=
name|Vnil
condition|)
block|{
name|in_comment
operator|=
name|Yes
expr_stmt|;
if|if
condition|(
operator|!
name|new_line
operator|&&
name|no_space_before_comment
argument_list|(
name|v
argument_list|)
condition|)
name|Putspace
expr_stmt|;
name|displ
argument_list|(
name|v
argument_list|)
expr_stmt|;
name|in_comment
operator|=
name|No
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|new_line
condition|)
name|put_newline
argument_list|()
expr_stmt|;
block|}
end_function

begin_decl_stmt
name|Hidden
name|value
name|quote
init|=
name|Vnil
decl_stmt|;
end_decl_stmt

begin_function
name|Hidden
name|Procedure
name|d_textdis
parameter_list|(
name|v
parameter_list|)
name|parsetree
name|v
decl_stmt|;
block|{
name|value
name|s_quote
init|=
name|quote
decl_stmt|;
name|quote
operator|=
operator|*
name|Branch
argument_list|(
name|v
argument_list|,
name|XDIS_QUOTE
argument_list|)
expr_stmt|;
name|displ
argument_list|(
name|quote
argument_list|)
expr_stmt|;
name|displ
argument_list|(
operator|*
name|Branch
argument_list|(
name|v
argument_list|,
name|XDIS_NEXT
argument_list|)
argument_list|)
expr_stmt|;
name|displ
argument_list|(
name|quote
argument_list|)
expr_stmt|;
name|quote
operator|=
name|s_quote
expr_stmt|;
block|}
end_function

begin_function
name|Hidden
name|Procedure
name|d_textlit
parameter_list|(
name|v
parameter_list|)
name|parsetree
name|v
decl_stmt|;
block|{
name|value
name|w
decl_stmt|;
name|displ
argument_list|(
name|w
operator|=
operator|*
name|Branch
argument_list|(
name|v
argument_list|,
name|XLIT_TEXT
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|character
argument_list|(
name|w
argument_list|)
condition|)
block|{
name|value
name|c
init|=
name|mk_text
argument_list|(
literal|"`"
argument_list|)
decl_stmt|;
if|if
condition|(
name|compare
argument_list|(
name|quote
argument_list|,
name|w
argument_list|)
operator|==
literal|0
operator|||
name|compare
argument_list|(
name|c
argument_list|,
name|w
argument_list|)
operator|==
literal|0
condition|)
name|displ
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|release
argument_list|(
name|c
argument_list|)
expr_stmt|;
block|}
name|displ
argument_list|(
operator|*
name|Branch
argument_list|(
name|v
argument_list|,
name|XLIT_NEXT
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|Hidden
name|Procedure
name|d_tabdis
parameter_list|(
name|v
parameter_list|)
name|value
name|v
decl_stmt|;
block|{
name|intlet
name|k
decl_stmt|,
name|len
init|=
name|Nfields
argument_list|(
name|v
argument_list|)
decl_stmt|;
name|k_Over_len
block|{
if|if
condition|(
name|k
operator|>
literal|0
condition|)
name|put_string
argument_list|(
literal|"; "
argument_list|)
expr_stmt|;
name|put_char
argument_list|(
literal|'['
argument_list|)
expr_stmt|;
name|displ
argument_list|(
operator|*
name|Field
argument_list|(
name|v
argument_list|,
name|k
argument_list|)
argument_list|)
expr_stmt|;
name|put_string
argument_list|(
literal|"]: "
argument_list|)
expr_stmt|;
name|displ
argument_list|(
operator|*
name|Field
argument_list|(
name|v
argument_list|,
operator|++
name|k
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|Hidden
name|Procedure
name|d_collateral
parameter_list|(
name|v
parameter_list|)
name|value
name|v
decl_stmt|;
block|{
name|intlet
name|k
decl_stmt|,
name|len
init|=
name|Nfields
argument_list|(
name|v
argument_list|)
decl_stmt|;
name|k_Over_len
block|{
if|if
condition|(
name|k
operator|>
literal|0
condition|)
name|put_string
argument_list|(
literal|", "
argument_list|)
expr_stmt|;
name|displ
argument_list|(
operator|*
name|Field
argument_list|(
name|v
argument_list|,
name|k
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|Hidden
name|Procedure
name|d_listdis
parameter_list|(
name|v
parameter_list|)
name|value
name|v
decl_stmt|;
block|{
name|intlet
name|k
decl_stmt|,
name|len
init|=
name|Nfields
argument_list|(
name|v
argument_list|)
decl_stmt|;
name|k_Over_len
block|{
if|if
condition|(
name|k
operator|>
literal|0
condition|)
name|put_string
argument_list|(
literal|"; "
argument_list|)
expr_stmt|;
name|displ
argument_list|(
operator|*
name|Field
argument_list|(
name|v
argument_list|,
name|k
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|Hidden
name|Procedure
name|d_actfor_compound
parameter_list|(
name|v
parameter_list|)
name|value
name|v
decl_stmt|;
block|{
while|while
condition|(
name|v
operator|!=
name|Vnil
condition|)
block|{
name|displ
argument_list|(
operator|*
name|Branch
argument_list|(
name|v
argument_list|,
name|ACT_KEYW
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
name|Branch
argument_list|(
name|v
argument_list|,
name|ACT_EXPR
argument_list|)
operator|!=
name|Vnil
condition|)
block|{
name|Putspace
expr_stmt|;
name|displ
argument_list|(
operator|*
name|Branch
argument_list|(
name|v
argument_list|,
name|ACT_EXPR
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|v
operator|=
operator|*
name|Branch
argument_list|(
name|v
argument_list|,
name|ACT_NEXT
argument_list|)
expr_stmt|;
if|if
condition|(
name|v
operator|!=
name|Vnil
condition|)
name|Putspace
expr_stmt|;
block|}
block|}
end_function

begin_function
name|Hidden
name|Procedure
name|d_write
parameter_list|(
name|v
parameter_list|)
name|parsetree
name|v
decl_stmt|;
block|{
name|value
name|l_lines
decl_stmt|,
name|e
decl_stmt|,
name|r_lines
decl_stmt|;
name|l_lines
operator|=
operator|*
name|Branch
argument_list|(
name|v
argument_list|,
name|WRT_L_LINES
argument_list|)
expr_stmt|;
name|e
operator|=
operator|*
name|Branch
argument_list|(
name|v
argument_list|,
name|WRT_EXPR
argument_list|)
expr_stmt|;
name|r_lines
operator|=
operator|*
name|Branch
argument_list|(
name|v
argument_list|,
name|WRT_R_LINES
argument_list|)
expr_stmt|;
name|displ
argument_list|(
name|l_lines
argument_list|)
expr_stmt|;
if|if
condition|(
name|e
operator|!=
name|NilTree
condition|)
block|{
name|value
name|n
init|=
name|size
argument_list|(
name|l_lines
argument_list|)
decl_stmt|;
if|if
condition|(
name|intval
argument_list|(
name|n
argument_list|)
operator|>
literal|0
condition|)
name|Putspace
expr_stmt|;
name|release
argument_list|(
name|n
argument_list|)
expr_stmt|;
name|displ
argument_list|(
name|e
argument_list|)
expr_stmt|;
name|n
operator|=
name|size
argument_list|(
name|r_lines
argument_list|)
expr_stmt|;
if|if
condition|(
name|intval
argument_list|(
name|n
argument_list|)
operator|>
literal|0
condition|)
name|Putspace
expr_stmt|;
name|release
argument_list|(
name|n
argument_list|)
expr_stmt|;
block|}
name|displ
argument_list|(
name|r_lines
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|Hidden
name|Procedure
name|d_dyaf
parameter_list|(
name|v
parameter_list|)
name|parsetree
name|v
decl_stmt|;
block|{
name|parsetree
name|l
decl_stmt|,
name|r
decl_stmt|;
name|value
name|name
decl_stmt|;
name|l
operator|=
operator|*
name|Branch
argument_list|(
name|v
argument_list|,
name|DYA_LEFT
argument_list|)
expr_stmt|;
name|r
operator|=
operator|*
name|Branch
argument_list|(
name|v
argument_list|,
name|DYA_RIGHT
argument_list|)
expr_stmt|;
name|name
operator|=
operator|*
name|Branch
argument_list|(
name|v
argument_list|,
name|DYA_NAME
argument_list|)
expr_stmt|;
name|displ
argument_list|(
name|l
argument_list|)
expr_stmt|;
if|if
condition|(
name|is_b_tag
argument_list|(
name|name
argument_list|)
operator|||
name|nodetype
argument_list|(
name|r
argument_list|)
operator|==
name|MONF
condition|)
block|{
name|Putspace
expr_stmt|;
name|displ
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|Putspace
expr_stmt|;
block|}
else|else
name|displ
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|displ
argument_list|(
name|r
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|Hidden
name|Procedure
name|d_monf
parameter_list|(
name|v
parameter_list|)
name|parsetree
name|v
decl_stmt|;
block|{
name|parsetree
name|r
decl_stmt|;
name|value
name|name
decl_stmt|;
name|name
operator|=
operator|*
name|Branch
argument_list|(
name|v
argument_list|,
name|MON_NAME
argument_list|)
expr_stmt|;
name|r
operator|=
operator|*
name|Branch
argument_list|(
name|v
argument_list|,
name|MON_RIGHT
argument_list|)
expr_stmt|;
name|displ
argument_list|(
name|name
argument_list|)
expr_stmt|;
if|if
condition|(
name|is_b_tag
argument_list|(
name|name
argument_list|)
condition|)
block|{
switch|switch
condition|(
name|nodetype
argument_list|(
name|r
argument_list|)
condition|)
block|{
case|case
name|MONF
case|:
if|if
condition|(
operator|!
name|is_b_tag
argument_list|(
operator|*
name|Branch
argument_list|(
name|r
argument_list|,
name|MON_NAME
argument_list|)
argument_list|)
condition|)
break|break;
case|case
name|SELECTION
case|:
case|case
name|BEHEAD
case|:
case|case
name|CURTAIL
case|:
case|case
name|TAG
case|:
case|case
name|TAGformal
case|:
case|case
name|TAGlocal
case|:
case|case
name|TAGglobal
case|:
case|case
name|TAGmystery
case|:
case|case
name|TAGrefinement
case|:
case|case
name|TAGzerfun
case|:
case|case
name|TAGzerprd
case|:
case|case
name|NUMBER
case|:
case|case
name|TEXT_DIS
case|:
name|Putspace
expr_stmt|;
break|break;
default|default:
break|break;
block|}
block|}
name|displ
argument_list|(
name|r
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

