begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_include
include|#
directive|include
file|"jove.h"
end_include

begin_include
include|#
directive|include
file|"list.h"
end_include

begin_function_decl
specifier|extern
name|char
modifier|*
name|emalloc
parameter_list|()
function_decl|;
end_function_decl

begin_function
name|private
name|List
modifier|*
name|list_new
parameter_list|()
block|{
name|List
modifier|*
name|new
decl_stmt|;
name|new
operator|=
operator|(
name|List
operator|*
operator|)
name|emalloc
argument_list|(
sizeof|sizeof
argument_list|(
name|List
argument_list|)
argument_list|)
expr_stmt|;
name|new
operator|->
name|car
operator|=
name|NIL
expr_stmt|;
return|return
name|new
return|;
block|}
end_function

begin_comment
comment|/* push an object to the beginning of list */
end_comment

begin_function
name|Element
modifier|*
name|list_push
parameter_list|(
name|list
parameter_list|,
name|element
parameter_list|)
specifier|register
name|List
modifier|*
modifier|*
name|list
decl_stmt|;
name|Element
modifier|*
name|element
decl_stmt|;
block|{
name|List
modifier|*
name|new
decl_stmt|;
name|new
operator|=
name|list_new
argument_list|()
expr_stmt|;
name|new
operator|->
name|cdr
operator|=
operator|*
name|list
expr_stmt|;
name|new
operator|->
name|car
operator|=
name|element
expr_stmt|;
operator|*
name|list
operator|=
name|new
expr_stmt|;
return|return
name|element
return|;
block|}
end_function

begin_function
name|Element
modifier|*
name|list_pop
parameter_list|(
name|list
parameter_list|)
name|List
modifier|*
modifier|*
name|list
decl_stmt|;
block|{
name|List
modifier|*
name|cell
decl_stmt|;
name|Element
modifier|*
name|element
decl_stmt|;
if|if
condition|(
operator|*
name|list
operator|==
name|NIL
condition|)
return|return
name|NIL
return|;
name|cell
operator|=
operator|*
name|list
expr_stmt|;
name|element
operator|=
name|cell
operator|->
name|car
expr_stmt|;
name|free
argument_list|(
operator|(
name|char
operator|*
operator|)
name|cell
argument_list|)
expr_stmt|;
operator|*
name|list
operator|=
operator|(
operator|*
name|list
operator|)
operator|->
name|cdr
expr_stmt|;
return|return
name|element
return|;
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|NEVER
end_ifdef

begin_function
name|Element
modifier|*
name|list_remove
parameter_list|(
name|list_head
parameter_list|,
name|element
parameter_list|)
name|List
modifier|*
modifier|*
name|list_head
decl_stmt|;
name|Element
modifier|*
name|element
decl_stmt|;
block|{
specifier|register
name|List
modifier|*
name|cp
init|=
operator|*
name|list_head
decl_stmt|,
modifier|*
name|prev
init|=
name|NIL
decl_stmt|;
while|while
condition|(
name|cp
operator|!=
name|NIL
condition|)
block|{
if|if
condition|(
name|cp
operator|->
name|car
operator|==
name|element
condition|)
break|break;
name|prev
operator|=
name|cp
expr_stmt|;
name|cp
operator|=
name|cp
operator|->
name|cdr
expr_stmt|;
block|}
if|if
condition|(
name|cp
operator|==
name|NIL
condition|)
return|return
name|NIL
return|;
if|if
condition|(
name|prev
operator|==
name|NIL
condition|)
operator|*
name|list_head
operator|=
operator|(
operator|*
name|list_head
operator|)
operator|->
name|cdr
expr_stmt|;
else|else
name|prev
operator|->
name|cdr
operator|=
name|cp
operator|->
name|cdr
expr_stmt|;
return|return
name|element
return|;
block|}
end_function

begin_function
name|Element
modifier|*
name|list_append
parameter_list|(
name|list
parameter_list|,
name|element
parameter_list|)
name|List
modifier|*
modifier|*
name|list
decl_stmt|;
name|Element
modifier|*
name|element
decl_stmt|;
block|{
name|List
modifier|*
name|new
decl_stmt|,
modifier|*
name|lp
decl_stmt|;
name|lp
operator|=
operator|*
name|list
expr_stmt|;
if|if
condition|(
name|lp
operator|==
name|NIL
condition|)
return|return
name|list_push
argument_list|(
name|list
argument_list|,
name|element
argument_list|)
return|;
while|while
condition|(
name|lp
operator|->
name|cdr
operator|!=
name|NIL
condition|)
name|lp
operator|=
name|lp
operator|->
name|cdr
expr_stmt|;
name|new
operator|=
name|list_new
argument_list|()
expr_stmt|;
name|lp
operator|->
name|cdr
operator|=
name|new
expr_stmt|;
name|new
operator|->
name|car
operator|=
name|element
expr_stmt|;
return|return
name|element
return|;
block|}
end_function

begin_function
name|Element
modifier|*
name|list_find
parameter_list|(
name|list
parameter_list|,
name|element
parameter_list|)
name|List
modifier|*
name|list
decl_stmt|;
name|Element
modifier|*
name|element
decl_stmt|;
block|{
while|while
condition|(
name|list
operator|!=
name|NIL
condition|)
if|if
condition|(
name|list
operator|->
name|car
operator|==
name|element
condition|)
return|return
name|element
return|;
return|return
name|NIL
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* NEVER */
end_comment

end_unit

