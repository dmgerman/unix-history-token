begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (c) 1982 Regents of the University of California.  * All rights reserved.  The Berkeley software License Agreement  * specifies the terms and conditions for redistribution.  */
end_comment

begin_ifndef
ifndef|#
directive|ifndef
name|lint
end_ifndef

begin_decl_stmt
specifier|static
name|char
name|sccsid
index|[]
init|=
literal|"@(#)floattab.c	5.1 (Berkeley) 4/30/85"
decl_stmt|;
end_decl_stmt

begin_endif
endif|#
directive|endif
endif|not lint
end_endif

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|"as.h"
end_include

begin_define
define|#
directive|define
name|N
value|NOTAKE
end_define

begin_decl_stmt
name|struct
name|ty_bigdesc
name|ty_bigdesc
index|[]
init|=
block|{
block|{
comment|/* TYPB */
block|{
literal|15
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|}
block|,
block|{
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
literal|0
block|}
block|,
block|{
name|N
block|,
name|N
block|}
block|,
block|{
name|N
block|,
name|N
block|}
block|,
literal|0
block|,
comment|/* mantissa lshift */
literal|0
block|,
comment|/* exponent rshift */
literal|8
block|,
comment|/* mantissa sig bits */
literal|0
block|,
comment|/* exponent sig bits */
literal|8
block|,
comment|/* exponent excess */
block|}
block|,
block|{
comment|/* TYPW */
block|{
literal|14
block|,
literal|15
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|}
block|,
block|{
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
literal|0
block|,
literal|1
block|}
block|,
block|{
name|N
block|,
name|N
block|}
block|,
block|{
name|N
block|,
name|N
block|}
block|,
literal|0
block|,
comment|/* mantissa lshift */
literal|0
block|,
comment|/* exponent rshift */
literal|16
block|,
comment|/* mantissa sig bits */
literal|0
block|,
comment|/* exponent sig bits */
literal|16
block|,
comment|/* exponent excess */
block|}
block|,
block|{
comment|/* TYPL */
block|{
literal|12
block|,
literal|13
block|,
literal|14
block|,
literal|15
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|}
block|,
block|{
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
literal|0
block|,
literal|1
block|,
literal|2
block|,
literal|3
block|}
block|,
block|{
name|N
block|,
name|N
block|}
block|,
block|{
name|N
block|,
name|N
block|}
block|,
literal|0
block|,
comment|/* mantissa lshift */
literal|0
block|,
comment|/* exponent rshift */
literal|32
block|,
comment|/* mantissa sig bits */
literal|0
block|,
comment|/* exponent sig bits */
literal|32
block|,
comment|/* exponent excess */
block|}
block|,
block|{
comment|/* TYPQ */
block|{
literal|8
block|,
literal|9
block|,
literal|10
block|,
literal|11
block|,
literal|12
block|,
literal|13
block|,
literal|14
block|,
literal|15
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|}
block|,
block|{
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
literal|0
block|,
literal|1
block|,
literal|2
block|,
literal|3
block|,
literal|4
block|,
literal|5
block|,
literal|6
block|,
literal|7
block|}
block|,
block|{
name|N
block|,
name|N
block|}
block|,
block|{
name|N
block|,
name|N
block|}
block|,
literal|0
block|,
comment|/* mantissa lshift */
literal|0
block|,
comment|/* exponent rshift */
literal|64
block|,
comment|/* mantissa sig bits */
literal|0
block|,
comment|/* exponent sig bits */
literal|64
block|,
comment|/* exponent excess */
block|}
block|,
block|{
comment|/* TYPO */
block|{
literal|0
block|,
literal|1
block|,
literal|2
block|,
literal|3
block|,
literal|4
block|,
literal|5
block|,
literal|6
block|,
literal|7
block|,
literal|8
block|,
literal|9
block|,
literal|10
block|,
literal|11
block|,
literal|12
block|,
literal|13
block|,
literal|14
block|,
literal|15
block|}
block|,
block|{
literal|0
block|,
literal|1
block|,
literal|2
block|,
literal|3
block|,
literal|4
block|,
literal|5
block|,
literal|6
block|,
literal|7
block|,
literal|8
block|,
literal|9
block|,
literal|10
block|,
literal|11
block|,
literal|12
block|,
literal|13
block|,
literal|14
block|,
literal|15
block|}
block|,
block|{
name|N
block|,
name|N
block|}
block|,
block|{
name|N
block|,
name|N
block|}
block|,
literal|0
block|,
comment|/* mantissa lshift */
literal|0
block|,
comment|/* exponent rshift */
literal|128
block|,
comment|/* mantissa sig bits */
literal|0
block|,
comment|/* exponent sig bits */
literal|128
block|,
comment|/* exponent excess */
block|}
block|,
block|{
comment|/* TYPF */
block|{
literal|15
block|,
name|N
block|,
literal|13
block|,
literal|14
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|}
block|,
block|{
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
literal|2
block|,
literal|3
block|,
literal|0
block|}
block|,
block|{
literal|0
block|,
literal|1
block|}
block|,
block|{
literal|0
block|,
literal|1
block|}
block|,
literal|1
block|,
comment|/* mantissa lshift */
literal|7
block|,
comment|/* exponent rshift */
literal|24
block|,
comment|/* mantissa sig bits */
literal|8
block|,
comment|/* exponent sig bits */
literal|128
comment|/* exponent excess */
block|}
block|,
block|{
comment|/* TYPD */
block|{
literal|15
block|,
name|N
block|,
literal|13
block|,
literal|14
block|,
literal|11
block|,
literal|12
block|,
literal|9
block|,
literal|10
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|}
block|,
block|{
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
literal|6
block|,
literal|7
block|,
literal|4
block|,
literal|5
block|,
literal|2
block|,
literal|3
block|,
literal|0
block|}
block|,
block|{
literal|0
block|,
literal|1
block|}
block|,
block|{
literal|0
block|,
literal|1
block|}
block|,
literal|1
block|,
comment|/* mantissa lshift */
literal|7
block|,
comment|/* exponent rshift */
literal|56
block|,
comment|/* mantissa sig bits */
literal|8
block|,
comment|/* exponent sig bits */
literal|128
comment|/* exponent excess */
block|}
block|,
block|{
comment|/* TYPG */
block|{
literal|15
block|,
name|N
block|,
literal|13
block|,
literal|14
block|,
literal|11
block|,
literal|12
block|,
literal|9
block|,
literal|10
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|}
block|,
block|{
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
name|N
block|,
literal|6
block|,
literal|7
block|,
literal|4
block|,
literal|5
block|,
literal|2
block|,
literal|3
block|,
literal|0
block|}
block|,
block|{
literal|0
block|,
literal|1
block|}
block|,
block|{
literal|0
block|,
literal|1
block|}
block|,
literal|4
block|,
comment|/* mantissa lshift */
literal|4
block|,
comment|/* exponent rshift */
literal|53
block|,
comment|/* mantissa sig bits */
literal|11
block|,
comment|/* exponent sig bits */
literal|1024
comment|/* exponent excess */
block|}
block|,
block|{
comment|/* TYPH */
block|{
name|N
block|,
name|N
block|,
literal|14
block|,
literal|15
block|,
literal|12
block|,
literal|13
block|,
literal|10
block|,
literal|11
block|,
literal|8
block|,
literal|9
block|,
literal|6
block|,
literal|7
block|,
literal|4
block|,
literal|5
block|,
literal|2
block|,
literal|3
block|}
block|,
block|{
name|N
block|,
name|N
block|,
literal|14
block|,
literal|15
block|,
literal|12
block|,
literal|13
block|,
literal|10
block|,
literal|11
block|,
literal|8
block|,
literal|9
block|,
literal|6
block|,
literal|7
block|,
literal|4
block|,
literal|5
block|,
literal|2
block|,
literal|3
block|}
block|,
block|{
literal|0
block|,
literal|1
block|}
block|,
block|{
literal|0
block|,
literal|1
block|}
block|,
literal|0
block|,
comment|/* mantissa lshift */
literal|0
block|,
comment|/* exponent rshift */
literal|113
block|,
comment|/* mantissa sig bits */
literal|15
block|,
comment|/* exponent sig bits */
literal|16384
comment|/* exponent excess */
block|}
block|,
block|{
literal|0
block|}
comment|/* TYPNONE */
block|}
decl_stmt|;
end_decl_stmt

begin_macro
name|cfloattab
argument_list|()
end_macro

begin_block
block|{
name|reg
name|struct
name|ty_bigdesc
modifier|*
name|p
decl_stmt|;
name|reg
name|int
name|i
decl_stmt|;
name|reg
name|int
name|j
decl_stmt|;
name|reg
name|int
name|k
decl_stmt|;
specifier|extern
name|int
name|ty_float
index|[]
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|TYPNONE
operator|-
literal|1
condition|;
name|i
operator|++
control|)
block|{
name|p
operator|=
operator|&
name|ty_bigdesc
index|[
name|i
index|]
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|16
condition|;
name|j
operator|++
control|)
block|{
if|if
condition|(
operator|(
operator|(
name|char
operator|)
name|p
operator|->
name|b_upmmap
index|[
name|j
index|]
operator|)
operator|!=
name|NOTAKE
condition|)
block|{
name|k
operator|=
name|p
operator|->
name|b_pmmap
index|[
name|p
operator|->
name|b_upmmap
index|[
name|j
index|]
index|]
expr_stmt|;
if|if
condition|(
name|j
operator|!=
name|k
condition|)
name|printf
argument_list|(
literal|"%s:p[up[%d]] == %d\n"
argument_list|,
name|ty_string
index|[
name|i
index|]
argument_list|,
name|j
argument_list|,
name|k
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|(
operator|(
name|char
operator|)
name|p
operator|->
name|b_pmmap
index|[
name|j
index|]
operator|)
operator|!=
name|NOTAKE
condition|)
block|{
name|k
operator|=
name|p
operator|->
name|b_upmmap
index|[
name|p
operator|->
name|b_pmmap
index|[
name|j
index|]
index|]
expr_stmt|;
if|if
condition|(
name|j
operator|!=
name|k
condition|)
name|printf
argument_list|(
literal|"%s:up[p[%d]] == %d\n"
argument_list|,
name|ty_string
index|[
name|i
index|]
argument_list|,
name|j
argument_list|,
name|k
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
operator|!
name|ty_float
index|[
name|i
index|]
condition|)
continue|continue;
name|k
operator|=
operator|(
name|p
operator|->
name|b_msigbits
operator|-
literal|1
operator|)
operator|+
name|p
operator|->
name|b_mlshift
expr_stmt|;
if|if
condition|(
name|k
operator|%
literal|8
condition|)
name|printf
argument_list|(
literal|"sigbits: %d, lshift: %d, excess: %d\n"
argument_list|,
name|p
operator|->
name|b_msigbits
argument_list|,
name|p
operator|->
name|b_mlshift
argument_list|,
name|k
operator|%
literal|8
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
literal|15
operator|-
operator|(
name|k
operator|/
literal|8
operator|)
operator|)
operator|<
literal|0
condition|)
name|printf
argument_list|(
literal|"lsbyte<= 0\n"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
literal|8
operator|-
operator|(
name|p
operator|->
name|b_mlshift
operator|+
literal|2
operator|)
operator|)
operator|<=
literal|0
condition|)
name|printf
argument_list|(
literal|"Shifted byte 15 into byte 14"
argument_list|)
expr_stmt|;
if|if
condition|(
literal|1
operator|<<
operator|(
name|p
operator|->
name|b_esigbits
operator|-
literal|1
operator|)
operator|!=
name|p
operator|->
name|b_eexcess
condition|)
name|printf
argument_list|(
literal|"sigbits == %d, excess = %d\n"
argument_list|,
name|p
operator|->
name|b_esigbits
argument_list|,
name|p
operator|->
name|b_eexcess
argument_list|)
expr_stmt|;
block|}
block|}
end_block

end_unit

